"use strict";var _react=require("react"),_react2=_interopRequireDefault(_react),_reactAddonsTestUtils=require("react-addons-test-utils"),_reactAddonsTestUtils2=_interopRequireDefault(_reactAddonsTestUtils),_sinon=require("sinon"),_sinon2=_interopRequireDefault(_sinon),_expect=require("expect"),_expect2=_interopRequireDefault(_expect),_ProgressBar=require("../../progress_bar/ProgressBar.js"),_Input=require("../../input/Input.js"),_Input2=_interopRequireDefault(_Input),_Slider=require("../Slider.js"),_Slider2=_interopRequireDefault(_Slider),_testing=require("../../utils/testing"),_testing2=_interopRequireDefault(_testing),_theme=require("../theme.css"),_theme2=_interopRequireDefault(_theme);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}describe("Slider",function(){var t,n=void 0,a=void 0,r=void 0;describe("#positionToValue",function(){before(function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:-500,max:500}));(n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)).setState({sliderStart:500,sliderLength:100})}),it("returns min when position is less than origin",function(){(0,_expect2.default)(n.positionToValue({x:400})).toEqual(-500)}),it("returns max when position is more and origin plus length",function(){(0,_expect2.default)(n.positionToValue({x:900})).toEqual(500)}),it("returns the proper position when the position is inside slider",function(){(0,_expect2.default)(n.positionToValue({x:520})).toEqual(-300)})}),describe("#trimValue",function(){before(function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:0,max:100,step:.1}));n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)}),it("rounds to the proper number",function(){(0,_expect2.default)(n.trimValue(57.16)).toEqual(57.2),(0,_expect2.default)(n.trimValue(57.12)).toEqual(57.1)}),it("returns min if number is less than min",function(){(0,_expect2.default)(n.trimValue(-57.16)).toEqual(0)}),it("returns max if number is more than max",function(){(0,_expect2.default)(n.trimValue(257.16)).toEqual(100)})}),describe("#valueForInput",function(){before(function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:0,max:100,step:.01}));n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)}),it("returns a fixed number when an integer is given",function(){(0,_expect2.default)(n.valueForInput(4)).toEqual("4.00")}),it("returns a fixed number when a float is given",function(){(0,_expect2.default)(n.valueForInput(4.06)).toEqual("4.06")})}),describe("#knobOffset",function(){it("returns the corresponding offset for a given value and slider length/start",function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:-500,max:500,value:-250}));(n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)).setState({sliderStart:500,sliderLength:100}),(0,_expect2.default)(n.knobOffset()).toEqual(25)})}),describe("#render",function(){it("contains a linear progress bar with proper properties",function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:100,max:1e3,value:140}));n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider),t=_reactAddonsTestUtils2.default.findRenderedComponentWithType(n,_ProgressBar.ProgressBar),(0,_expect2.default)(t.props.mode).toEqual("determinate"),(0,_expect2.default)(t.props.type).toEqual("linear"),(0,_expect2.default)(t.props.value).toEqual(140),(0,_expect2.default)(t.props.min).toEqual(100),(0,_expect2.default)(t.props.max).toEqual(1e3)}),it("contains an input component if its editable",function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{editable:!0,value:130}));n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider),a=_reactAddonsTestUtils2.default.findRenderedComponentWithType(n,_Input2.default),(0,_expect2.default)(parseInt(a.props.value)).toEqual(n.props.value)}),it("contains the proper number of snaps when snapped",function(){n=_testing2.default.shallowRenderComponent(_Slider.Slider,{editable:!0,pinned:!0,theme:_theme2.default}),(0,_expect2.default)(n.props.className).toContain(_theme2.default.ring),(0,_expect2.default)(n.props.className).toContain(_theme2.default.pinned),n=_testing2.default.shallowRenderComponent(_Slider.Slider,{editable:!0,value:50,theme:_theme2.default}),(0,_expect2.default)(n.props.className).toNotContain(_theme2.default.ring)})}),describe("#events",function(){beforeEach(function(){r=_sinon2.default.spy();var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{min:-500,max:500,onChange:r}));(n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)).setState({sliderStart:0,sliderLength:1e3}),n.handleResize=function(e,t){t()}}),it("sets pressed state when knob is clicked",function(){_reactAddonsTestUtils2.default.Simulate.mouseDown(n.refs.knob),(0,_expect2.default)(n.state.pressed).toEqual(!0)}),it("sets pressed state when knob is touched",function(){_reactAddonsTestUtils2.default.Simulate.touchStart(n.refs.knob,{touches:[{pageX:200}]}),(0,_expect2.default)(n.state.pressed).toEqual(!0)}),it("sets a proper value when the slider is clicked",function(){_reactAddonsTestUtils2.default.Simulate.mouseDown(n.refs.slider,{pageX:200}),(0,_expect2.default)(r.called).toEqual(!0),(0,_expect2.default)(r.getCall(0).args[0]).toEqual(-300)}),it("sets a proper value when the slider is touched",function(){_reactAddonsTestUtils2.default.Simulate.touchStart(n.refs.slider,{touches:[{pageX:200,pageY:0}]}),(0,_expect2.default)(r.called).toEqual(!0),(0,_expect2.default)(r.getCall(0).args[0]).toEqual(-300)}),it("changes input value when slider changes",function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{editable:!0,onChange:r}));(n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider)).setState({sliderStart:0,sliderLength:1e3}),n.handleResize=function(e,t){t()},a=_reactAddonsTestUtils2.default.findRenderedComponentWithType(n,_Input2.default),_reactAddonsTestUtils2.default.Simulate.mouseDown(n.refs.slider,{pageX:900}),(0,_expect2.default)(r.called).toEqual(!0),(0,_expect2.default)(r.getCall(0).args[0]).toEqual(90)}),it("changes its value when input is blurred",function(){var e=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{editable:!0,value:50,onChange:r}));n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(e,_Slider.Slider),a=_reactAddonsTestUtils2.default.findRenderedComponentWithType(n,_Input.Input),_reactAddonsTestUtils2.default.Simulate.change(a.refs.input,{target:{value:"80"}}),_reactAddonsTestUtils2.default.Simulate.blur(a.refs.input),(0,_expect2.default)(r.called).toEqual(!0),(0,_expect2.default)(r.getCall(0).args[0]).toEqual(80)}),it("calls onChange callback when the value is changed",function(){var e=_sinon2.default.spy(),t=_reactAddonsTestUtils2.default.renderIntoDocument(_react2.default.createElement(_Slider2.default,{onChange:e}));(n=_reactAddonsTestUtils2.default.findRenderedComponentWithType(t,_Slider.Slider)).setState({sliderStart:0,sliderLength:1e3}),_reactAddonsTestUtils2.default.Simulate.mouseDown(n.refs.slider,{pageX:900}),(0,_expect2.default)(e.called).toEqual(!0)})})});