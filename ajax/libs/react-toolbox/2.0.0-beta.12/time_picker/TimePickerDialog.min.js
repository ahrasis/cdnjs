"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_time=require("../utils/time"),_time2=_interopRequireDefault(_time),_Clock=require("./Clock"),_Clock2=_interopRequireDefault(_Clock);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var factory=function(r){var e=(_inherits(o,_react.Component),_createClass(o,[{key:"componentWillReceiveProps",value:function(e){e.value.getTime()!==this.state.displayTime.getTime()&&this.setState({displayTime:new Date(e.value.getTime())})}},{key:"componentDidUpdate",value:function(e){!e.active&&this.props.active&&setTimeout(this.clockNode.handleCalculateShape,1e3)}},{key:"formatHours",value:function(){return"ampm"===this.props.format?this.state.displayTime.getHours()%12||12:this.state.displayTime.getHours()}},{key:"renderAMPMLabels",value:function(){var e=this.props.theme;if("ampm"===this.props.format)return _react2.default.createElement("div",{className:e.ampm},_react2.default.createElement("span",{className:e.am,onClick:this.toggleTimeMode},"AM"),_react2.default.createElement("span",{className:e.pm,onClick:this.toggleTimeMode},"PM"))}},{key:"render",value:function(){var t=this,e=this.props.theme,a=this.state.display+"Display",s=_time2.default.getTimeMode(this.state.displayTime)+"Format",s=(0,_classnames2.default)([e.dialog,e[a],e[s]],this.props.className);return _react2.default.createElement(r,{actions:this.actions,active:this.props.active,className:s,onEscKeyDown:this.props.onEscKeyDown,onOverlayClick:this.props.onOverlayClick},_react2.default.createElement("header",{className:e.header},_react2.default.createElement("span",{id:"hours",className:e.hours,onClick:this.switchDisplay},("0"+this.formatHours()).slice(-2)),_react2.default.createElement("span",{className:e.separator},":"),_react2.default.createElement("span",{id:"minutes",className:e.minutes,onClick:this.switchDisplay},("0"+this.state.displayTime.getMinutes()).slice(-2)),this.renderAMPMLabels()),_react2.default.createElement(_Clock2.default,{ref:function(e){t.clockNode=e},display:this.state.display,format:this.props.format,onChange:this.handleClockChange,onHandMoved:this.handleHandMoved,theme:this.props.theme,time:this.state.displayTime}))}}]),o);function o(){var e,t;_classCallCheck(this,o);for(var a=arguments.length,s=Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=t=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(s)))).state={display:"hours",displayTime:new Date(t.props.value.getTime())},t.handleClockChange=function(e){t.setState({displayTime:e})},t.handleSelect=function(e){t.props.onSelect(t.state.displayTime,e)},t.toggleTimeMode=function(){t.setState({displayTime:_time2.default.toggleTimeMode(t.state.displayTime)})},t.handleHandMoved=function(){"hours"===t.state.display&&t.setState({display:"minutes"})},t.switchDisplay=function(e){t.setState({display:e.target.id})},t.actions=[{label:t.props.cancelLabel,className:t.props.theme.button,onClick:t.props.onDismiss},{label:t.props.okLabel,className:t.props.theme.button,name:t.props.name,onClick:t.handleSelect}],_possibleConstructorReturn(t,e)}return e.propTypes={active:_propTypes2.default.bool,cancelLabel:_propTypes2.default.string,className:_propTypes2.default.string,format:_propTypes2.default.oneOf(["24hr","ampm"]),name:_propTypes2.default.string,okLabel:_propTypes2.default.string,onDismiss:_propTypes2.default.func,onEscKeyDown:_propTypes2.default.func,onOverlayClick:_propTypes2.default.func,onSelect:_propTypes2.default.func,theme:_propTypes2.default.shape({am:_propTypes2.default.string,amFormat:_propTypes2.default.string,ampm:_propTypes2.default.string,button:_propTypes2.default.string,dialog:_propTypes2.default.string,header:_propTypes2.default.string,hours:_propTypes2.default.string,hoursDisplay:_propTypes2.default.string,minutes:_propTypes2.default.string,minutesDisplay:_propTypes2.default.string,pm:_propTypes2.default.string,pmFormat:_propTypes2.default.string,separator:_propTypes2.default.string}),value:_propTypes2.default.instanceOf(Date)},e.defaultProps={active:!1,cancelLabel:"Cancel",format:"24hr",okLabel:"Ok",value:new Date},e};exports.default=factory;