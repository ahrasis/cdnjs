"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactAddonsCssTransitionGroup=require("react-addons-css-transition-group"),_reactAddonsCssTransitionGroup2=_interopRequireDefault(_reactAddonsCssTransitionGroup),_utils=require("../utils/utils"),_time=require("../utils/time"),_time2=_interopRequireDefault(_time),_CalendarMonth=require("./CalendarMonth"),_CalendarMonth2=_interopRequireDefault(_CalendarMonth);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var DIRECTION_STEPS={left:-1,right:1},factory=function(a){var e=(_inherits(s,_react.Component),_createClass(s,[{key:"componentWillMount",value:function(){document.body.addEventListener("keydown",this.handleKeys)}},{key:"componentDidUpdate",value:function(){this.activeYearNode&&this.scrollToActive()}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("keydown",this.handleKeys)}},{key:"scrollToActive",value:function(){var e=this.yearsNode.offsetHeight/2+this.activeYearNode.offsetHeight/2;this.yearsNode.scrollTop=this.activeYearNode.offsetTop-e}},{key:"renderYears",value:function(){var a=this;return _react2.default.createElement("ul",{"data-react-toolbox":"years",className:this.props.theme.years,ref:function(e){a.yearsNode=e}},(0,_utils.range)(1900,2100).map(function(t){return _react2.default.createElement("li",{className:t===a.state.viewDate.getFullYear()?a.props.theme.active:"",id:t,key:t,onClick:a.handleYearClick,ref:function(e){t===a.state.viewDate.getFullYear()&&(a.activeYearNode=e)}},t)}))}},{key:"renderMonths",value:function(){var e=this.props.theme,t="left"===this.state.direction?"slideLeft":"slideRight",t=(0,_utils.getAnimationModule)(t,e);return _react2.default.createElement("div",{"data-react-toolbox":"calendar"},_react2.default.createElement(a,{id:"left",className:e.prev,icon:"chevron_left",onClick:this.changeViewMonth}),_react2.default.createElement(a,{id:"right",className:e.next,icon:"chevron_right",onClick:this.changeViewMonth}),_react2.default.createElement(_reactAddonsCssTransitionGroup2.default,{transitionName:t,transitionEnterTimeout:350,transitionLeaveTimeout:350},_react2.default.createElement(_CalendarMonth2.default,{enabledDates:this.props.enabledDates,disabledDates:this.props.disabledDates,key:this.state.viewDate.getMonth(),locale:this.props.locale,maxDate:this.props.maxDate,minDate:this.props.minDate,onDayClick:this.handleDayClick,selectedDate:this.props.selectedDate,sundayFirstDayOfWeek:this.props.sundayFirstDayOfWeek,theme:this.props.theme,viewDate:this.state.viewDate})))}},{key:"render",value:function(){return _react2.default.createElement("div",{className:this.props.theme.calendar},"months"===this.props.display?this.renderMonths():this.renderYears())}}]),s);function s(){var e,a;_classCallCheck(this,s);for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=a=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(r)))).state={viewDate:a.props.selectedDate},a.handleDayClick=function(e){a.props.onChange(_time2.default.setDay(a.state.viewDate,e),!0)},a.handleYearClick=function(e){e=parseInt(e.currentTarget.id,10),e=_time2.default.setYear(a.props.selectedDate,e);a.setState({viewDate:e}),a.props.onChange(e,!1)},a.handleKeys=function(e){var t=a.props.selectedDate;switch(37!==e.which&&38!==e.which&&39!==e.which&&40!==e.which&&13!==e.which||e.preventDefault(),e.which){case 13:a.props.handleSelect();break;case 37:a.handleDayArrowKey(_time2.default.addDays(t,-1));break;case 38:a.handleDayArrowKey(_time2.default.addDays(t,-7));break;case 39:a.handleDayArrowKey(_time2.default.addDays(t,1));break;case 40:a.handleDayArrowKey(_time2.default.addDays(t,7))}},a.handleDayArrowKey=function(e){a.setState({viewDate:e}),a.props.onChange(e,!1)},a.changeViewMonth=function(e){e=e.currentTarget.id;a.setState({direction:e,viewDate:_time2.default.addMonths(a.state.viewDate,DIRECTION_STEPS[e])})},_possibleConstructorReturn(a,e)}return e.propTypes={disabledDates:_react2.default.PropTypes.arrayOf(_react.PropTypes.instanceOf(Date)),display:_react.PropTypes.oneOf(["months","years"]),enabledDates:_react2.default.PropTypes.arrayOf(_react.PropTypes.instanceOf(Date)),handleSelect:_react.PropTypes.func,locale:_react2.default.PropTypes.oneOfType([_react2.default.PropTypes.string,_react2.default.PropTypes.object]),maxDate:_react.PropTypes.instanceOf(Date),minDate:_react.PropTypes.instanceOf(Date),onChange:_react.PropTypes.func,selectedDate:_react.PropTypes.instanceOf(Date),sundayFirstDayOfWeek:_react2.default.PropTypes.bool,theme:_react.PropTypes.shape({active:_react.PropTypes.string,calendar:_react.PropTypes.string,next:_react.PropTypes.string,prev:_react.PropTypes.string,years:_react.PropTypes.string})},e.defaultProps={display:"months",selectedDate:new Date},e};exports.default=factory;