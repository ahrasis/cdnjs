/*! Monio: io-helpers.mjs
    v0.12.0 (c) 2021 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
import{isPromise}from"./lib/util.mjs";var returnedValues=new WeakSet;export{applyIO};export{doIO};export{doIOBind};export{filterIOList};export{concatIOList};export{iif};export{elif};export{els};export{iReturn};export{wasReturned};export{liftIO};function applyIO(t,e){return IO((()=>t.run(e)))}function doIO(t,...e){return e.length>0?IO((n=>IO.do(t(n,...e)).run(n))):IO.do(t)}function doIOBind(t,e){var n=IO((()=>IO.do(t).run(e)));return(...r)=>r.length>0?IO((()=>IO.do(t(e,...r)).run(e))):n}function filterIOList(t,e){return e.reduce(((e,n)=>e.chain((e=>t(n).map((t=>t?[...e,n]:e))))),IO.of([]))}function concatIOList(t){return t.reduce(((t,e)=>t.map((t=>[...t,e]))),IO.of([]))}function iif(t,e,...n){return IO((r=>liftIO(r,t).chain((function doThens(t){return t?(Array.isArray(e)?e:[e]).reduce(((t,e)=>t.chain((t=>liftIO(r,t).chain((t=>returnedValues.has(t)?IO.of(t):liftIO(r,e)))))),IO.of()).chain((e=>IO.of(returnedValues.has(e)?e:t))):IO.of(t)})).chain(function doNextElse(t){return e=>!e&&t.length>0?liftIO(r,t[0]).chain(doNextElse(t.slice(1))):IO.of(e)}(n)).run(r)))}function elif(t,e){return iif(t,e)}function els(t){return iif(!0,t)}function iReturn(t){return IO((e=>liftIO(e,t).chain((t=>{var e={returned:t};return returnedValues.add(e),IO.of(e)})).run(e)))}function wasReturned(t){return returnedValues.has(t)}function liftIO(t,e){if(e&&"object"==typeof e&&"function"==typeof e.chain){if(IO.is(e))return e;{let t=e&&"object"==typeof e&&"function"==typeof e.then?e.fold(IO.of,IO.of):e.chain(IO.of);return IO.is(t)?t:IO.of(e)}}return"function"==typeof e?liftIO(t,e(t)):e&&"object"==typeof e&&"function"==typeof e.next?IO.do(e):IO.of(e)}