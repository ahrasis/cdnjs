"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Galleria=void 0;var _react=_interopRequireWildcard(require("react")),_reactDom=_interopRequireDefault(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ClassNames=require("../utils/ClassNames"),_UniqueComponentId=_interopRequireDefault(require("../utils/UniqueComponentId")),_GalleriaItem=require("./GalleriaItem"),_GalleriaThumbnails=require("./GalleriaThumbnails"),_DomHandler=_interopRequireDefault(require("../utils/DomHandler")),_reactTransitionGroup=require("react-transition-group"),_Ripple=require("../ripple/Ripple");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,i,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((i=o?Object.getOwnPropertyDescriptor(e,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]);return n.default=e,t&&t.set(e,n),n}function ownKeys(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var i=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,i?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Galleria=function(){_inherits(i,_react.Component);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).state={visible:!1,slideShowActive:!1},t.props.onItemChange||(t.state=_objectSpread(_objectSpread({},t.state),{},{activeIndex:e.activeIndex})),t.onActiveItemChange=t.onActiveItemChange.bind(_assertThisInitialized(t)),t.show=t.show.bind(_assertThisInitialized(t)),t.hide=t.hide.bind(_assertThisInitialized(t)),t.startSlideShow=t.startSlideShow.bind(_assertThisInitialized(t)),t.stopSlideShow=t.stopSlideShow.bind(_assertThisInitialized(t)),t.onEnter=t.onEnter.bind(_assertThisInitialized(t)),t.onEntering=t.onEntering.bind(_assertThisInitialized(t)),t.onExit=t.onExit.bind(_assertThisInitialized(t)),t.id=t.props.id||(0,_UniqueComponentId.default)(),t}return _createClass(i,[{key:"onActiveItemChange",value:function(e){this.props.onItemChange?this.props.onItemChange(e):this.setState({activeIndex:e.index})}},{key:"show",value:function(){this.setState({visible:!0})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"onEnter",value:function(){_DomHandler.default.addClass(document.body,"p-overflow-hidden")}},{key:"onEntering",value:function(){this.mask.style.zIndex=String(this.props.baseZIndex+_DomHandler.default.generateZIndex()),_DomHandler.default.addClass(this.mask,"p-component-overlay")}},{key:"onExit",value:function(){_DomHandler.default.removeClass(document.body,"p-overflow-hidden"),_DomHandler.default.addClass(this.mask,"p-galleria-mask-leave")}},{key:"isAutoPlayActive",value:function(){return this.state.slideShowActive}},{key:"startSlideShow",value:function(){var t=this;this.interval=setInterval(function(){var e=t.props.circular&&t.props.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1;t.onActiveItemChange({index:e})},this.props.transitionInterval),this.setState({slideShowActive:!0})}},{key:"stopSlideShow",value:function(){this.interval&&clearInterval(this.interval),this.setState({slideShowActive:!1})}},{key:"getPositionClassName",value:function(e,t){var r=["top","left","bottom","right"].find(function(e){return e===t});return r?"".concat(e,"-").concat(r):""}},{key:"isVertical",value:function(){return"left"===this.props.thumbnailsPosition||"right"===this.props.thumbnailsPosition}},{key:"componentWillUnmount",value:function(){this.state.slideShowActive&&this.stopSlideShow()}},{key:"renderHeader",value:function(){return this.props.header?_react.default.createElement("div",{className:"p-galleria-header"},this.props.header):null}},{key:"renderFooter",value:function(){return this.props.footer?_react.default.createElement("div",{className:"p-galleria-footer"},this.props.footer):null}},{key:"renderElement",value:function(){var t=this,e=this.isVertical(),r=this.props.showThumbnails&&this.getPositionClassName("p-galleria-thumbnails",this.props.thumbnailsPosition),i=this.props.showIndicators&&this.getPositionClassName("p-galleria-indicators",this.props.indicatorsPosition),n=(0,_ClassNames.classNames)("p-galleria p-component",this.props.className,{"p-galleria-fullscreen":this.props.fullScreen,"p-galleria-indicator-onitem":this.props.showIndicatorsOnItem,"p-galleria-item-nav-onhover":this.props.showItemNavigatorsOnHover&&!this.props.fullScreen},r,i),o=this.props.fullScreen&&_react.default.createElement("button",{type:"button",className:"p-galleria-close p-link",onClick:this.hide},_react.default.createElement("span",{className:"p-galleria-close-icon pi pi-times"}),_react.default.createElement(_Ripple.Ripple,null)),r=this.renderHeader(),i=this.renderFooter();return _react.default.createElement("div",{id:this.id,className:n,style:this.props.style},o,r,_react.default.createElement("div",{className:"p-galleria-content"},_react.default.createElement(_GalleriaItem.GalleriaItem,{ref:function(e){return t.previewContent=_reactDom.default.findDOMNode(e)},value:this.props.value,activeItemIndex:this.activeItemIndex,onActiveItemChange:this.onActiveItemChange,itemTemplate:this.props.item,circular:this.props.circular,caption:this.props.caption,showIndicators:this.props.showIndicators,changeItemOnIndicatorHover:this.props.changeItemOnIndicatorHover,indicator:this.props.indicator,showItemNavigators:this.props.showItemNavigators,autoPlay:this.props.autoPlay,slideShowActive:this.state.slideShowActive,startSlideShow:this.startSlideShow,stopSlideShow:this.stopSlideShow}),this.props.showThumbnails&&_react.default.createElement(_GalleriaThumbnails.GalleriaThumbnails,{containerId:this.id,value:this.props.value,activeItemIndex:this.activeItemIndex,onActiveItemChange:this.onActiveItemChange,itemTemplate:this.props.thumbnail,numVisible:this.props.numVisible,responsiveOptions:this.props.responsiveOptions,circular:this.props.circular,isVertical:e,contentHeight:this.props.verticalThumbnailViewPortHeight,showThumbnailNavigators:this.props.showThumbnailNavigators,autoPlay:this.props.autoPlay,slideShowActive:this.state.slideShowActive,stopSlideShow:this.stopSlideShow})),i)}},{key:"renderGalleria",value:function(){var t=this,e=this.renderElement();if(this.props.fullScreen){var r=(0,_ClassNames.classNames)("p-galleria-mask",{"p-galleria-visible":this.state.visible}),r=_react.default.createElement("div",{ref:function(e){return t.mask=e},className:r},_react.default.createElement(_reactTransitionGroup.CSSTransition,{classNames:"p-galleria",in:this.state.visible,timeout:{enter:150,exit:150},unmountOnExit:!0,onEnter:this.onEnter,onEntering:this.onEntering,onExit:this.onExit},e));return _reactDom.default.createPortal(r,document.body)}return e}},{key:"render",value:function(){return this.props.value&&0<this.props.value.length&&this.renderGalleria()}},{key:"activeItemIndex",get:function(){return(this.props.onItemChange?this.props:this.state).activeIndex}}]),i}();_defineProperty(exports.Galleria=Galleria,"defaultProps",{id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,onItemChange:null}),_defineProperty(Galleria,"propTypes",{id:_propTypes.default.string,value:_propTypes.default.any,activeIndex:_propTypes.default.number,fullScreen:_propTypes.default.bool,item:_propTypes.default.any,thumbnail:_propTypes.default.any,indicator:_propTypes.default.any,caption:_propTypes.default.any,className:_propTypes.default.string,style:_propTypes.default.object,header:_propTypes.default.any,footer:_propTypes.default.any,numVisible:_propTypes.default.number,responsiveOptions:_propTypes.default.array,showItemNavigators:_propTypes.default.bool,showThumbnailNavigators:_propTypes.default.bool,showItemNavigatorsOnHover:_propTypes.default.bool,changeItemOnIndicatorHover:_propTypes.default.bool,circular:_propTypes.default.bool,autoPlay:_propTypes.default.bool,transitionInterval:_propTypes.default.number,showThumbnails:_propTypes.default.bool,thumbnailsPosition:_propTypes.default.string,showIndicators:_propTypes.default.bool,showIndicatorsOnItem:_propTypes.default.bool,indicatorsPosition:_propTypes.default.string,baseZIndex:_propTypes.default.number,onItemChange:_propTypes.default.func});