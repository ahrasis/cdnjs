"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_popper=_interopRequireDefault(require("popper.js")),_utils=require("@material-ui/utils"),_styles=require("@material-ui/styles"),_Portal=_interopRequireDefault(require("../Portal")),_createChainedFunction=_interopRequireDefault(require("../utils/createChainedFunction")),_setRef=_interopRequireDefault(require("../utils/setRef")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEnhancedEffect=_interopRequireDefault(require("../utils/useEnhancedEffect"));function flipPlacement(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function getAnchorEl(e){return"function"==typeof e?e():e}const defaultPopperOptions={},Popper=React.forwardRef(function(e,t){const{anchorEl:r,children:o,container:n,disablePortal:p=!1,keepMounted:i=!1,modifiers:u,open:a,placement:l="bottom",popperOptions:s=defaultPopperOptions,popperRef:c,style:d,transition:f=!1}=e,_=(0,_objectWithoutPropertiesLoose2.default)(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition"]),h=React.useRef(null),m=(0,_useForkRef.default)(h,t),y=React.useRef(null),R=(0,_useForkRef.default)(y,c),b=React.useRef(R);(0,_useEnhancedEffect.default)(()=>{b.current=R},[R]),React.useImperativeHandle(c,()=>y.current,[]);const[E,T]=React.useState(!0),q=flipPlacement(l,(0,_styles.useTheme)()),[v,P]=React.useState(q);React.useEffect(()=>{y.current&&y.current.update()});const g=React.useCallback(()=>{if(!h.current||!r||!a)return;y.current&&(y.current.destroy(),b.current(null));const e=e=>{P(e.placement)},t=getAnchorEl(r);if("production"!==process.env.NODE_ENV&&t&&1===t.nodeType){const e=t.getBoundingClientRect();"test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom&&console.warn(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}const o=new _popper.default(getAnchorEl(r),h.current,(0,_extends2.default)({placement:q},s,{modifiers:(0,_extends2.default)({},p?{}:{preventOverflow:{boundariesElement:"viewport"}},u,s.modifiers),onCreate:(0,_createChainedFunction.default)(e,s.onCreate),onUpdate:(0,_createChainedFunction.default)(e,s.onUpdate)}));b.current(o)},[r,p,u,a,q,s]),O=React.useCallback(e=>{(0,_setRef.default)(m,e),g()},[m,g]),j=()=>{T(!1)},D=()=>{y.current&&(y.current.destroy(),b.current(null))},M=()=>{T(!0),D()};if(React.useEffect(()=>()=>{D()},[]),React.useEffect(()=>{a||f||D()},[a,f]),!i&&!a&&(!f||E))return null;const k={placement:v};return f&&(k.TransitionProps={in:a,onEnter:j,onExited:M}),React.createElement(_Portal.default,{disablePortal:p,container:n},React.createElement("div",(0,_extends2.default)({ref:O,role:"tooltip"},_,{style:(0,_extends2.default)({position:"fixed",top:0,left:0,display:a||!i||f?null:"none"},d)}),"function"==typeof o?o(k):o))});"production"!==process.env.NODE_ENV&&(Popper.propTypes={anchorEl:(0,_utils.chainPropTypes)(_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.object,_propTypes.default.func]),e=>{if(e.open){const t=getAnchorEl(e.anchorEl);if(t&&1===t.nodeType){const e=t.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}else if(!t||"number"!=typeof t.clientWidth||"number"!=typeof t.clientHeight||"function"!=typeof t.getBoundingClientRect)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","It should be an HTML element instance or a referenceObject ","(https://popper.js.org/docs/v1/#referenceObject)."].join("\n"))}return null}),children:_propTypes.default.oneOfType([_propTypes.default.node,_propTypes.default.func]),container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),disablePortal:_propTypes.default.bool,keepMounted:_propTypes.default.bool,modifiers:_propTypes.default.object,open:_propTypes.default.bool.isRequired,placement:_propTypes.default.oneOf(["bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:_propTypes.default.object,popperRef:_utils.refType,style:_propTypes.default.object,transition:_propTypes.default.bool});var _default=Popper;exports.default=_default;