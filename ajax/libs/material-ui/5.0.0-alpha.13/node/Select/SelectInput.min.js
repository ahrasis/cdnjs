"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),_utils=require("@material-ui/utils"),React=_interopRequireWildcard(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_capitalize=_interopRequireDefault(require("../utils/capitalize")),_Menu=_interopRequireDefault(require("../Menu/Menu")),_utils2=require("../InputBase/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useControlled=_interopRequireDefault(require("../utils/useControlled"));function areEqualValues(e,t){return"object"==typeof t&&null!==t?e===t:String(e)===String(t)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}const SelectInput=React.forwardRef(function(e,t){const{"aria-label":a,autoFocus:r,autoWidth:l,children:o,classes:n,className:u,defaultValue:p,disabled:s,displayEmpty:i,IconComponent:d,inputRef:c,labelId:f,MenuProps:_={},multiple:y,name:m,onBlur:v,onChange:b,onClose:R,onFocus:h,onOpen:T,open:q,readOnly:E,renderValue:D,SelectDisplayProps:g={},tabIndex:x,value:I,variant:P="standard"}=e,C=(0,_objectWithoutPropertiesLoose2.default)(e,["aria-label","autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"]),[O,M]=(0,_useControlled.default)({controlled:I,default:p,name:"Select"}),j=React.useRef(null),[w,S]=React.useState(null),{current:F}=React.useRef(null!=q),[N,V]=React.useState(),[W,k]=React.useState(!1),A=(0,_useForkRef.default)(t,c);React.useImperativeHandle(A,()=>({focus:()=>{w.focus()},node:j.current,value:O}),[w,O]),React.useEffect(()=>{r&&w&&w.focus()},[r,w]),React.useEffect(()=>{if(w){const e=(0,_ownerDocument.default)(w).getElementById(f);if(e){const t=()=>{getSelection().isCollapsed&&w.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}},[f,w]);const L=(e,t)=>{e?T&&T(t):R&&R(t),F||(V(l?null:w.clientWidth),k(e))},$=React.Children.toArray(o),B=null!==w&&(F?q:W);let U,K;delete C["aria-invalid"];const z=[];let H=!1,Y=!1;((0,_utils2.isFilled)({value:O})||i)&&(D?U=D(O):H=!0);const G=$.map(e=>{if(!React.isValidElement(e))return null;let t;if("production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(e)&&console.error(["Material-UI: The Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),y){if(!Array.isArray(O))throw new Error("production"!==process.env.NODE_ENV?"Material-UI: The `value` prop must be an array when using the `Select` component with `multiple`.":(0,_utils.formatMuiErrorMessage)(2));(t=O.some(t=>areEqualValues(t,e.props.value)))&&H&&z.push(e.props.children)}else(t=areEqualValues(O,e.props.value))&&H&&(K=e.props.children);return t&&(Y=!0),React.cloneElement(e,{"aria-selected":t?"true":void 0,onClick:(e=>t=>{let a;if(y){a=Array.isArray(O)?O.slice():[];const t=O.indexOf(e.props.value);-1===t?a.push(e.props.value):a.splice(t,1)}else a=e.props.value;e.props.onClick&&e.props.onClick(t),O!==a&&(M(a),b&&(t.persist(),Object.defineProperty(t,"target",{writable:!0,value:{value:a,name:m}}),b(t,e))),y||L(!1,t)})(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})});"production"!==process.env.NODE_ENV&&React.useEffect(()=>{if(!Y&&!y&&""!==O){const e=$.map(e=>e.props.value);console.warn([`Material-UI: You have provided an out-of-range value \`${O}\` for the select ${m?`(name="${m}") `:""}component.`,"Consider providing a value that matches one of the available options or ''.",`The available values are ${e.filter(e=>null!=e).map(e=>`\`${e}\``).join(", ")||'""'}.`].join("\n"))}},[Y,$,y,m,O]),H&&(U=y?z.join(", "):K);let J,Q=N;!l&&F&&w&&(Q=w.clientWidth),J=void 0!==x?x:s?null:0;const X=g.id||(m?`mui-component-select-${m}`:void 0);return React.createElement(React.Fragment,null,React.createElement("div",(0,_extends2.default)({className:(0,_clsx.default)(n.root,n.select,n.selectMenu,n[P],u,s&&n.disabled),ref:S,tabIndex:J,role:"button","aria-disabled":s?"true":void 0,"aria-expanded":B?"true":void 0,"aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[f,X].filter(Boolean).join(" ")||void 0,onKeyDown:e=>{E||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),L(!0,e))},onMouseDown:s||E?null:e=>{0===e.button&&(e.preventDefault(),w.focus(),L(!0,e))},onBlur:e=>{!B&&v&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:O,name:m}}),v(e))},onFocus:h},g,{id:X}),isEmpty(U)?React.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):U),React.createElement("input",(0,_extends2.default)({value:Array.isArray(O)?O.join(","):O,name:m,ref:j,"aria-hidden":!0,onChange:e=>{const t=$.map(e=>e.props.value).indexOf(e.target.value);if(-1===t)return;const a=$[t];M(a.props.value),b&&b(e,a)},tabIndex:-1,className:n.nativeInput,autoFocus:r},C)),React.createElement(d,{className:(0,_clsx.default)(n.icon,n[`icon${(0,_capitalize.default)(P)}`],B&&n.iconOpen,s&&n.disabled)}),React.createElement(_Menu.default,(0,_extends2.default)({id:`menu-${m||""}`,anchorEl:w,open:B,onClose:e=>{L(!1,e)}},_,{MenuListProps:(0,_extends2.default)({"aria-labelledby":f,role:"listbox",disableListWrap:!0},_.MenuListProps),PaperProps:(0,_extends2.default)({},_.PaperProps,{style:(0,_extends2.default)({minWidth:Q},null!=_.PaperProps?_.PaperProps.style:null)})}),G))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={"aria-label":_propTypes.default.string,autoFocus:_propTypes.default.bool,autoWidth:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object.isRequired,className:_propTypes.default.string,defaultValue:_propTypes.default.any,disabled:_propTypes.default.bool,displayEmpty:_propTypes.default.bool,IconComponent:_propTypes.default.elementType.isRequired,inputRef:_utils.refType,labelId:_propTypes.default.string,MenuProps:_propTypes.default.object,multiple:_propTypes.default.bool,name:_propTypes.default.string,onBlur:_propTypes.default.func,onChange:_propTypes.default.func,onClose:_propTypes.default.func,onFocus:_propTypes.default.func,onOpen:_propTypes.default.func,open:_propTypes.default.bool,readOnly:_propTypes.default.bool,renderValue:_propTypes.default.func,SelectDisplayProps:_propTypes.default.object,tabIndex:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),type:_propTypes.default.any,value:_propTypes.default.any,variant:_propTypes.default.oneOf(["standard","outlined","filled"])});var _default=SelectInput;exports.default=_default;