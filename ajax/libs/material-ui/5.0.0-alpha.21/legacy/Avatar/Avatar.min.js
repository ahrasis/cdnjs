import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import _defineProperty from"@babel/runtime/helpers/esm/defineProperty";import _extends from"@babel/runtime/helpers/esm/extends";import*as React from"react";import PropTypes from"prop-types";import clsx from"clsx";import{deepmerge}from"@material-ui/utils";import experimentalStyled from"../styles/experimentalStyled";import useThemeProps from"../styles/useThemeProps";import Person from"../internal/svg-icons/Person";import avatarClasses,{getAvatarUtilityClass}from"./avatarClasses";var overridesResolver=function(e,r){var t,a=e.variant,s=void 0===a?"circular":a;return deepmerge(r.root||{},_extends({},r[s],(_defineProperty(t={},"&.".concat(avatarClasses.colorDefault),r.colorDefault),_defineProperty(t,"& .".concat(avatarClasses.img),r.img),_defineProperty(t,"& .".concat(avatarClasses.fallback),r.fallback),t)))},useUtilityClasses=function(e){var r=e.classes,t=void 0===r?{}:r,a=e.variant,s=e.colorDefault;return{root:clsx(avatarClasses.root,t.root,getAvatarUtilityClass(a),s&&avatarClasses.colorDefault),img:clsx(avatarClasses.img,t.img),fallback:clsx(avatarClasses.fallback,t.fallback)}},AvatarRoot=experimentalStyled("div",{},{name:"MuiAvatar",slot:"Root",overridesResolver:overridesResolver})(function(e){var r=e.theme,t=e.styleProps;return _extends({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:r.typography.fontFamily,fontSize:r.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},"rounded"===t.variant&&{borderRadius:r.shape.borderRadius},"square"===t.variant&&{borderRadius:0},t.colorDefault&&{color:r.palette.background.default,backgroundColor:"light"===r.palette.mode?r.palette.grey[400]:r.palette.grey[600]})}),AvatarImg=experimentalStyled("img",{},{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),AvatarFallback=experimentalStyled(Person,{},{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function useLoaded(e){var r=e.src,t=e.srcSet,a=React.useState(!1),s=a[0],o=a[1];return React.useEffect(function(){if(r||t){o(!1);var e=!0,a=new Image;return a.src=r,t&&(a.srcset=t),a.onload=function(){e&&o("loaded")},a.onerror=function(){e&&o("error")},function(){e=!1}}},[r,t]),s}var Avatar=React.forwardRef(function(e,r){var t=useThemeProps({props:e,name:"MuiAvatar"}),a=t.alt,s=t.children,o=t.className,l=t.component,i=void 0===l?"div":l,n=t.imgProps,c=t.sizes,p=t.src,m=t.srcSet,d=t.variant,u=void 0===d?"circular":d,v=_objectWithoutProperties(t,["alt","children","className","component","imgProps","sizes","src","srcSet","variant"]),f=null,y=useLoaded({src:p,srcSet:m}),g=p||m,P=g&&"error"!==y,h=_extends({},t,{variant:u,colorDefault:!P}),b=useUtilityClasses(h);return f=P?React.createElement(AvatarImg,_extends({alt:a,src:p,srcSet:m,sizes:c,className:b.img},n)):null!=s?s:g&&a?a[0]:React.createElement(AvatarFallback,{className:b.fallback}),React.createElement(AvatarRoot,_extends({as:i,styleProps:h,className:clsx(b.root,o),ref:r},v),f)});"production"!==process.env.NODE_ENV&&(Avatar.propTypes={alt:PropTypes.string,children:PropTypes.node,classes:PropTypes.object,className:PropTypes.string,component:PropTypes.elementType,imgProps:PropTypes.object,sizes:PropTypes.string,src:PropTypes.string,srcSet:PropTypes.string,variant:PropTypes.oneOfType([PropTypes.oneOf(["circular","rounded","square"]),PropTypes.string])});export default Avatar;