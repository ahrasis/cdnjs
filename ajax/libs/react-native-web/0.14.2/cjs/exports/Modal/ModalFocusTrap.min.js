"use strict";exports.__esModule=!0,exports.default=void 0;var _react=_interopRequireWildcard(require("react")),_ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),_View=_interopRequireDefault(require("../View")),_createElement=_interopRequireDefault(require("../createElement")),_StyleSheet=_interopRequireDefault(require("../StyleSheet")),_UIManager=_interopRequireDefault(require("../UIManager"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e){Object.prototype.hasOwnProperty.call(e,c)&&((r=u?Object.getOwnPropertyDescriptor(e,c):null)&&(r.get||r.set)?Object.defineProperty(n,c,r):n[c]=e[c])}return n.default=e,t&&t.set(e,n),n}var FocusBracket=function(){return(0,_createElement.default)("div",{accessibilityRole:"none",tabIndex:0,style:styles.focusBracket})};function attemptFocus(e){if(!_ExecutionEnvironment.canUseDOM)return!1;try{e.focus()}catch(e){}return document.activeElement===e}function focusFirstDescendant(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(attemptFocus(r)||focusFirstDescendant(r))return!0}return!1}function focusLastDescendant(e){for(var t=e.childNodes.length-1;0<=t;t--){var r=e.childNodes[t];if(attemptFocus(r)||focusLastDescendant(r))return!0}return!1}var ModalFocusTrap=function(e){var t=e.active,r=e.children,n=(0,_react.useRef)(),u=(0,_react.useRef)({trapFocusInProgress:!1,lastFocusedElement:null});return(0,_react.useEffect)(function(){if(_ExecutionEnvironment.canUseDOM){var e=function(){if(null!=n.current&&!u.current.trapFocusInProgress&&t){try{var e;u.current.trapFocusInProgress=!0,document.activeElement instanceof Node&&!n.current.contains(document.activeElement)&&(e=focusFirstDescendant(n.current),u.current.lastFocusedElement===document.activeElement&&(e=focusLastDescendant(n.current)),!e&&null!=n.current&&document.activeElement&&_UIManager.default.focus(n.current))}finally{u.current.trapFocusInProgress=!1}u.current.lastFocusedElement=document.activeElement}};return e(),document.addEventListener("focus",e,!0),function(){return document.removeEventListener("focus",e,!0)}}},[t]),_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(FocusBracket,null),_react.default.createElement(_View.default,{ref:n},r),_react.default.createElement(FocusBracket,null))},_default=ModalFocusTrap;exports.default=ModalFocusTrap;var styles=_StyleSheet.default.create({focusBracket:{outlineStyle:"none"}});module.exports=exports.default;