!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.app={}))}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n=n||Promise)(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function i(t,e){var n,r,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}var a=(u.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},u);function u(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}var c,h,l,f="FirebaseError",d=(c=Error,e(h=g,l=c),h.prototype=null===l?Object.create(l):(p.prototype=l.prototype,new p),g);function p(){this.constructor=h}function g(t,e,n){return(e=c.call(this,e)||this).code=t,e.customData=n,e.name=f,Object.setPrototypeOf(e,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,m.prototype.create),e}var m=(v.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},s=this.service+"/"+t;t=(t=this.errors[t])?(r=i,t.replace(y,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+s+").";return new d(s,t,i)},v);function v(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var y=/\{\$([^}]+)}/g,w=(b.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},b.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},b.prototype.setServiceProps=function(t){return this.serviceProps=t,this},b);function b(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var E="[DEFAULT]",I=(_.prototype.get=function(t){void 0===t&&(t=E);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},_.prototype.getImmediate=function(t){var e=n({identifier:E,optional:!1},t),r=(t=e.identifier,e.optional),i=this.normalizeInstanceIdentifier(t);try{var s=this.getOrInitializeService(i);if(s)return s;if(r)return null;throw Error("Service "+this.name+" is not available")}catch(t){if(r)return null;throw t}},_.prototype.getComponent=function(){return this.component},_.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=t).instantiationMode)try{this.getOrInitializeService(E)}catch(t){}try{for(var r=s(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var a=o(i.value,2),u=a[0],c=a[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},_.prototype.clearInstance=function(t){void 0===t&&(t=E),this.instancesDeferred.delete(t),this.instances.delete(t)},_.prototype.delete=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2]}})})},_.prototype.isComponentSet=function(){return null!=this.component},_.prototype.getOrInitializeService=function(t){var e,n=this.instances.get(t);return!n&&this.component&&(n=this.component.instanceFactory(this.container,(e=t)===E?void 0:e),this.instances.set(t,n)),n||null},_.prototype.normalizeInstanceIdentifier=function(t){return!this.component||this.component.multipleInstances?t:E},_);function _(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var T=(S.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},S.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},S.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new I(t,this);return this.providers.set(t,e),e},S.prototype.getProviders=function(){return Array.from(this.providers.values())},S);function S(t){this.name=t,this.providers=new Map}function A(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var k,N=[];function R(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=C[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,A(["["+i+"]  "+t.name+":"],n))}}(D=k=k||{})[D.DEBUG=0]="DEBUG",D[D.VERBOSE=1]="VERBOSE",D[D.INFO=2]="INFO",D[D.WARN=3]="WARN",D[D.ERROR=4]="ERROR",D[D.SILENT=5]="SILENT";var O={debug:k.DEBUG,verbose:k.VERBOSE,info:k.INFO,warn:k.WARN,error:k.ERROR,silent:k.SILENT},P=k.INFO,C=((D={})[k.DEBUG]="log",D[k.VERBOSE]="log",D[k.INFO]="info",D[k.WARN]="warn",D[k.ERROR]="error",D),D=(Object.defineProperty(L.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in k))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),L.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?O[t]:t},Object.defineProperty(L.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),L.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.DEBUG],t)),this._logHandler.apply(this,A([this,k.DEBUG],t))},L.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.VERBOSE],t)),this._logHandler.apply(this,A([this,k.VERBOSE],t))},L.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.INFO],t)),this._logHandler.apply(this,A([this,k.INFO],t))},L.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.WARN],t)),this._logHandler.apply(this,A([this,k.WARN],t))},L.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.ERROR],t)),this._logHandler.apply(this,A([this,k.ERROR],t))},L);function L(t){this.name=t,this._logLevel=P,this._logHandler=R,this._userLogHandler=null,N.push(this)}var x=(U.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){return function(t){return"VERSION"===(null==(t=t.getComponent())?void 0:t.type)}(t)?(t=t.getImmediate()).library+"/"+t.version:null}).filter(function(t){return t}).join(" ")},U);function U(t){this.container=t}var M="@firebase/app",V=new D("@firebase/app"),F="[DEFAULT]",q=((D={})[M]="fire-core",D["@firebase/app-compat"]="fire-core-compat",D["@firebase/analytics"]="fire-analytics",D["@firebase/auth"]="fire-auth",D["@firebase/database"]="fire-rtdb",D["@firebase/functions"]="fire-fn",D["@firebase/functions-compat"]="fire-fn-compat",D["@firebase/installations"]="fire-iid",D["@firebase/messaging"]="fire-fcm",D["@firebase/performance"]="fire-perf",D["@firebase/remote-config"]="fire-rc",D["@firebase/storage"]="fire-gcs",D["@firebase/firestore"]="fire-fst",D["fire-js"]="fire-js",D.firebase="fire-js-all",D),j=new Map,B=new Map;function $(t,e){try{t.container.addComponent(e)}catch(n){V.debug("Component "+e.name+" failed to register with FirebaseApp "+t.name,n)}}function H(t){var e,n,r=t.name;if(B.has(r))return V.debug("There were multiple attempts to register component "+r+"."),!1;B.set(r,t);try{for(var i=s(j.values()),o=i.next();!o.done;o=i.next())$(o.value,t)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0}function G(t,e){return t.container.getProvider(e)}(D={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",D["bad-app-name"]="Illegal App name: '{$appName}",D["duplicate-app"]="Firebase App named '{$appName}' already exists",D["app-deleted"]="Firebase App named '{$appName}' already deleted",D["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",D["invalid-log-argument"]="First argument to `onLog` must be null or a function.",D=D;var z=new m("app","Firebase",D),W=(Object.defineProperty(K.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),K.prototype.checkDestroyed=function(){if(this.isDeleted)throw z.create("app-deleted",{appName:this.name_})},K);function K(t,e,r){var i=this;this.isDeleted=!1,this.options_=n({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=r,this.container.addComponent(new w("app-exp",function(){return i},"PUBLIC"))}function X(t,e,n){var r=null!==(i=q[t])&&void 0!==i?i:t;n&&(r+="-"+n);var i=r.match(/\s|\//);t=e.match(/\s|\//);if(i||t)return n=['Unable to register library "'+r+'" with version "'+e+'":'],i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&t&&n.push("and"),t&&n.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void V.warn(n.join(" "));H(new w(r+"-version",function(){return{library:r,version:e}},"VERSION"))}H(new w("platform-logger",function(t){return new x(t)},"PRIVATE")),X(M,"0.0.900-exp.1e0eb201d",void 0),X("fire-js",""),X("firebase","0.900.3","app"),t.SDK_VERSION="0.900.3",t._DEFAULT_ENTRY_NAME=F,t._addComponent=$,t._addOrOverwriteComponent=function(t,e){t.container.addOrOverwriteComponent(e)},t._apps=j,t._clearComponents=function(){B.clear()},t._components=B,t._getProvider=G,t._registerComponent=H,t._removeServiceInstance=function(t,e,n){void 0===n&&(n=F),G(t,e).clearInstance(n)},t.deleteApp=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return e=t.name,j.has(e)?(j.delete(e),[4,Promise.all(t.container.getProviders().map(function(t){return t.delete()}))]):[3,2];case 1:n.sent(),t.isDeleted=!0,n.label=2;case 2:return[2]}})})},t.getApp=function(t){void 0===t&&(t=F);var e=j.get(t);if(!e)throw z.create("no-app",{appName:t});return e},t.getApps=function(){return Array.from(j.values())},t.initializeApp=function(t,e){var r,i;void 0===e&&(e={}),"object"!=typeof e&&(e={name:e});var o=n({name:F,automaticDataCollectionEnabled:!1},e);if("string"!=typeof(e=o.name)||!e)throw z.create("bad-app-name",{appName:String(e)});if(j.has(e))throw z.create("duplicate-app",{appName:e});var a=new T(e);try{for(var u=s(B.values()),c=u.next();!c.done;c=u.next()){var h=c.value;a.addComponent(h)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return o=new W(t,o,a),j.set(e,o),o},t.onLog=function(t,e){if(null!==t&&"function"!=typeof t)throw z.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=0,r=N;n<r.length;n++)!function(n){var r=null;e&&e.level&&(r=O[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:k[n].toLowerCase(),message:o,args:i,type:e.name})}}(r[n])}(t,e)},t.registerVersion=X,t.setLogLevel=function(t){var e;e=t,N.forEach(function(t){t.setLogLevel(e)})},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.auth=t.firebase.auth||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function o(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var s=t[i],o=i+1<t.length,a=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=s>>2,l=(3&s)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var s=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==u)throw Error();var c=s<<2|o>>4;if(r.push(c),64!==a){var h=o<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){try{return c.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f="FirebaseError",d=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=f,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,p.prototype.create),s}return r(e,t),e}(Error),p=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(g,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").";return new d(i,a,r)},t}();var g=/\{\$([^}]+)}/g;function m(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var s=i[r];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}var v,y,w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=b),void 0===r.error&&(r.error=b),void 0===r.complete&&(r.complete=b);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function b(){}function E(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(y||(y={}));var I={debug:y.DEBUG,verbose:y.VERBOSE,info:y.INFO,warn:y.WARN,error:y.ERROR,silent:y.SILENT},_=y.INFO,T=((v={})[y.DEBUG]="log",v[y.VERBOSE]="log",v[y.INFO]="info",v[y.WARN]="warn",v[y.ERROR]="error",v),S=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=T[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,E(["["+i+"]  "+t.name+":"],n))}},A=function(){function t(t){this.name=t,this._logLevel=_,this._logHandler=S,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in y))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?I[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,E([this,y.DEBUG],t)),this._logHandler.apply(this,E([this,y.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,E([this,y.VERBOSE],t)),this._logHandler.apply(this,E([this,y.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,E([this,y.INFO],t)),this._logHandler.apply(this,E([this,y.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,E([this,y.WARN],t)),this._logHandler.apply(this,E([this,y.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,E([this,y.ERROR],t)),this._logHandler.apply(this,E([this,y.ERROR],t))},t}(),k=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function N(){return{}}var R=function(){var t;return(t={})["admin-restricted-operation"]="This operation is restricted to administrators only.",t["argument-error"]="",t["app-not-authorized"]="This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",t["app-not-installed"]="The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",t["captcha-check-failed"]="The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",t["code-expired"]="The SMS code has expired. Please re-send the verification code to try again.",t["cordova-not-ready"]="Cordova framework is not ready.",t["cors-unsupported"]="This browser is not supported.",t["credential-already-in-use"]="This credential is already associated with a different user account.",t["custom-token-mismatch"]="The custom token corresponds to a different audience.",t["requires-recent-login"]="This operation is sensitive and requires recent authentication. Log in again before retrying this request.",t["dynamic-link-not-activated"]="Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",t["email-change-needs-verification"]="Multi-factor users must always have a verified email.",t["email-already-in-use"]="The email address is already in use by another account.",t["emulator-config-failed"]='Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "useEmulator()" sooner.',t["expired-action-code"]="The action code has expired.",t["cancelled-popup-request"]="This operation has been cancelled due to another conflicting popup being opened.",t["internal-error"]="An internal AuthError has occurred.",t["invalid-app-credential"]="The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",t["invalid-app-id"]="The mobile app identifier is not registed for the current project.",t["invalid-user-token"]="This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",t["invalid-auth-event"]="An internal AuthError has occurred.",t["invalid-verification-code"]="The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.",t["invalid-continue-uri"]="The continue URL provided in the request is invalid.",t["invalid-cordova-configuration"]="The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",t["invalid-custom-token"]="The custom token format is incorrect. Please check the documentation.",t["invalid-dynamic-link-domain"]="The provided dynamic link domain is not configured or authorized for the current project.",t["invalid-email"]="The email address is badly formatted.",t["invalid-emulator-scheme"]="Emulator URL must start with a valid scheme (http:// or https://).",t["invalid-api-key"]="Your API key is invalid, please check you have copied it correctly.",t["invalid-cert-hash"]="The SHA-1 certificate hash provided is invalid.",t["invalid-credential"]="The supplied auth credential is malformed or has expired.",t["invalid-message-payload"]="The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",t["invalid-multi-factor-session"]="The request does not contain a valid proof of first factor successful sign-in.",t["invalid-oauth-provider"]="EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",t["invalid-oauth-client-id"]="The OAuth client ID provided is either invalid or does not match the specified API key.",t["unauthorized-domain"]="This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",t["invalid-action-code"]="The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",t["wrong-password"]="The password is invalid or the user does not have a password.",t["invalid-persistence-type"]="The specified persistence type is invalid. It can only be local, session or none.",t["invalid-phone-number"]="The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",t["invalid-provider-id"]="The specified provider ID is invalid.",t["invalid-recipient-email"]="The email corresponding to this action failed to send as the provided recipient email address is invalid.",t["invalid-sender"]="The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",t["invalid-verification-id"]="The verification ID used to create the phone auth credential is invalid.",t["invalid-tenant-id"]="The Auth instance's tenant ID is invalid.",t["missing-android-pkg-name"]="An Android Package Name must be provided if the Android App is required to be installed.",t["auth-domain-config-required"]="Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",t["missing-app-credential"]="The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",t["missing-verification-code"]="The phone auth credential was created with an empty SMS verification code.",t["missing-continue-uri"]="A continue URL must be provided in the request.",t["missing-iframe-start"]="An internal AuthError has occurred.",t["missing-ios-bundle-id"]="An iOS Bundle ID must be provided if an App Store ID is provided.",t["missing-or-invalid-nonce"]="The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",t["missing-multi-factor-info"]="No second factor identifier is provided.",t["missing-multi-factor-session"]="The request is missing proof of first factor successful sign-in.",t["missing-phone-number"]="To send verification codes, provide a phone number for the recipient.",t["missing-verification-id"]="The phone auth credential was created with an empty verification ID.",t["app-deleted"]="This instance of FirebaseApp has been deleted.",t["multi-factor-info-not-found"]="The user does not have a second factor matching the identifier provided.",t["multi-factor-auth-required"]="Proof of ownership of a second factor is required to complete sign-in.",t["account-exists-with-different-credential"]="An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",t["network-request-failed"]="A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",t["no-auth-event"]="An internal AuthError has occurred.",t["no-such-provider"]="User was not linked to an account with the given provider.",t["null-user"]="A null user object was provided as the argument for an operation which requires a non-null user object.",t["operation-not-allowed"]="The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",t["operation-not-supported-in-this-environment"]='This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',t["popup-blocked"]="Unable to establish a connection with the popup. It may have been blocked by the browser.",t["popup-closed-by-user"]="The popup has been closed by the user before finalizing the operation.",t["provider-already-linked"]="User can only be linked to one identity for the given provider.",t["quota-exceeded"]="The project's quota for this operation has been exceeded.",t["redirect-cancelled-by-user"]="The redirect operation has been cancelled by the user before finalizing.",t["redirect-operation-pending"]="A redirect sign-in operation is already pending.",t["rejected-credential"]="The request contains malformed or mismatching credentials.",t["second-factor-already-in-use"]="The second factor is already enrolled on this account.",t["maximum-second-factor-count-exceeded"]="The maximum allowed number of second factors on a user has been exceeded.",t["tenant-id-mismatch"]="The provided tenant ID does not match the Auth instance's tenant ID",t.timeout="The operation has timed out.",t["user-token-expired"]="The user's credential is no longer valid. The user must sign in again.",t["too-many-requests"]="We have blocked all requests from this device due to unusual activity. Try again later.",t["unauthorized-continue-uri"]="The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",t["unsupported-first-factor"]="Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",t["unsupported-persistence-type"]="The current environment does not support the specified persistence type.",t["unsupported-tenant-operation"]="This operation is not supported in a multi-tenant context.",t["unverified-email"]="The operation requires a verified email.",t["user-cancelled"]="The user did not grant your application the permissions it requested.",t["user-not-found"]="There is no user record corresponding to this identifier. The user may have been deleted.",t["user-disabled"]="The user account has been disabled by an administrator.",t["user-mismatch"]="The supplied credentials do not correspond to the previously signed in user.",t["user-signed-out"]="",t["weak-password"]="The password must be 6 characters long or more.",t["web-storage-unsupported"]="This browser is not supported or 3rd party cookies and data may be disabled.",t},O=N,P=new p("auth","Firebase",{}),C=new A("@firebase/auth-exp");function D(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];C.logLevel<=y.ERROR&&C.error.apply(C,u(["Auth ("+e.SDK_VERSION+"): "+t],n))}function L(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];throw U.apply(void 0,u([t],e))}function x(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return U.apply(void 0,u([t],e))}function U(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if("string"!=typeof t){var i=n[0],s=u(n.slice(1));return s[0]&&(s[0].appName=t.name),(e=t._errorFactory).create.apply(e,u([i],s))}return P.create.apply(P,u([t],n))}function M(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!t)throw U.apply(void 0,u([e],n))}function V(t){var e="INTERNAL ASSERTION FAILED: "+t;throw D(e),new Error(e)}function F(t,e){t||V(e)}var q=new Map;function j(t){F(t instanceof Function,"Expected a class definition");var e=q.get(t);return e?(F(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,q.set(t,e),e)}function B(t,n){void 0===t&&(t=e.getApp());var r=e._getProvider(t,"auth-exp").getImmediate();return function(t,e){var n=(null==e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(j);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap);t._initializeWithPersistence(r,null==e?void 0:e.popupRedirectResolver)}(r,n),r}var $=function(){function t(t,e){this.providerId=t,this.signInMethod=e}return t.prototype.toJSON=function(){return V("not implemented")},t.prototype._getIdTokenResponse=function(t){return V("not implemented")},t.prototype._linkToIdToken=function(t,e){return V("not implemented")},t.prototype._getReauthenticationResolver=function(t){return V("not implemented")},t}();function H(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function G(){return"http:"===z()||"https:"===z()}function z(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function W(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(G()||(t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0,"object"==typeof t&&void 0!==t.id)||"connection"in navigator))||navigator.onLine;var t}var K=function(){function t(t,e){this.shortDelay=t,this.longDelay=e,F(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())||"object"==typeof navigator&&"ReactNative"===navigator.product}return t.prototype.get=function(){return W()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)},t}();function X(t,e){F(t.emulator,"Emulator should always be set here");var n=t.emulator.url,r=new URL(n).toString();return e?""+r+(e.startsWith("/")?e.slice(1):e):r}var Y,J=function(){function t(){}return t.initialize=function(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)},t.fetch=function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void V("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t.headers=function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void V("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t.response=function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void V("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t}(),Q=((Y={}).CREDENTIAL_MISMATCH="custom-token-mismatch",Y.MISSING_CUSTOM_TOKEN="internal-error",Y.INVALID_IDENTIFIER="invalid-email",Y.MISSING_CONTINUE_URI="internal-error",Y.INVALID_PASSWORD="wrong-password",Y.MISSING_PASSWORD="internal-error",Y.EMAIL_EXISTS="email-already-in-use",Y.PASSWORD_LOGIN_DISABLED="operation-not-allowed",Y.INVALID_IDP_RESPONSE="invalid-credential",Y.INVALID_PENDING_TOKEN="invalid-credential",Y.FEDERATED_USER_ID_ALREADY_LINKED="credential-already-in-use",Y.MISSING_REQ_TYPE="internal-error",Y.EMAIL_NOT_FOUND="user-not-found",Y.RESET_PASSWORD_EXCEED_LIMIT="too-many-requests",Y.EXPIRED_OOB_CODE="expired-action-code",Y.INVALID_OOB_CODE="invalid-action-code",Y.MISSING_OOB_CODE="internal-error",Y.CREDENTIAL_TOO_OLD_LOGIN_AGAIN="requires-recent-login",Y.INVALID_ID_TOKEN="invalid-user-token",Y.TOKEN_EXPIRED="user-token-expired",Y.USER_NOT_FOUND="user-token-expired",Y.TOO_MANY_ATTEMPTS_TRY_LATER="too-many-requests",Y.INVALID_CODE="invalid-verification-code",Y.INVALID_SESSION_INFO="invalid-verification-id",Y.INVALID_TEMPORARY_PROOF="invalid-credential",Y.MISSING_SESSION_INFO="missing-verification-id",Y.SESSION_EXPIRED="code-expired",Y.MISSING_ANDROID_PACKAGE_NAME="missing-android-pkg-name",Y.UNAUTHORIZED_DOMAIN="unauthorized-continue-uri",Y.INVALID_OAUTH_CLIENT_ID="invalid-oauth-client-id",Y.ADMIN_ONLY_OPERATION="admin-restricted-operation",Y.INVALID_MFA_PENDING_CREDENTIAL="invalid-multi-factor-session",Y.MFA_ENROLLMENT_NOT_FOUND="multi-factor-info-not-found",Y.MISSING_MFA_ENROLLMENT_ID="missing-multi-factor-info",Y.MISSING_MFA_PENDING_CREDENTIAL="missing-multi-factor-session",Y.SECOND_FACTOR_EXISTS="second-factor-already-in-use",Y.SECOND_FACTOR_LIMIT_EXCEEDED="maximum-second-factor-count-exceeded",Y),Z=new K(3e4,6e4);function tt(t,e,n,r,s){return void 0===s&&(s={}),o(this,void 0,void 0,function(){return a(this,function(o){return[2,et(t,s,function(){var s={},o={};r&&("GET"===e?o=r:s={body:JSON.stringify(r)});var a=m(i({key:t.config.apiKey},o)).slice(1),u=new(J.headers());return u.set("Content-Type","application/json"),u.set("X-Client-Version",t.config.sdkClientVersion),t.languageCode&&u.set("X-Firebase-Locale",t.languageCode),J.fetch()(rt(t,t.config.apiHost,n,a),i({method:e,headers:u,referrerPolicy:"no-referrer"},s))})]})})}function et(t,e,n){return o(this,void 0,void 0,function(){var r,s,o,u,c,h,l;return a(this,function(a){switch(a.label){case 0:t._canInitEmulator=!1,r=i(i({},Q),e),a.label=1;case 1:return a.trys.push([1,4,,5]),s=new it(t),[4,Promise.race([n(),s.promise])];case 2:return o=a.sent(),s.clearNetworkTimeout(),[4,o.json()];case 3:if("needConfirmation"in(u=a.sent()))throw st(t,"account-exists-with-different-credential",u);if(o.ok)return[2,u];if("FEDERATED_USER_ID_ALREADY_LINKED"===(c=u.error.message.split(" : ")[0]))throw st(t,"credential-already-in-use",u);if("EMAIL_EXISTS"===c)throw st(t,"email-already-in-use",u);return h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-"),L(t,h),[3,5];case 4:if((l=a.sent())instanceof d)throw l;return L(t,"network-request-failed"),[3,5];case 5:return[2]}})})}function nt(t,e,n,r,i){return void 0===i&&(i={}),o(this,void 0,void 0,function(){var s;return a(this,function(o){switch(o.label){case 0:return[4,tt(t,e,n,r,i)];case 1:return"mfaPendingCredential"in(s=o.sent())&&L(t,"multi-factor-auth-required",{serverResponse:s}),[2,s]}})})}function rt(t,e,n,r){var i=""+e+n+"?"+r;return t.config.emulator?X(t.config,i):t.config.apiScheme+"://"+i}var it=function(){function t(t){var e=this;this.auth=t,this.timer=null,this.promise=new Promise(function(t,n){e.timer=setTimeout(function(){return n(x(e.auth,"timeout"))},Z.get())})}return t.prototype.clearNetworkTimeout=function(){clearTimeout(this.timer)},t}();function st(t,e,n){var r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=x(t,e,r);return i.customData._tokenResponse=n,i}function ot(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:resetPassword",e)]})})}function at(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}function ut(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:sendOobCode",e)]})})}var ct=function(t){function e(e,n,r,i){void 0===i&&(i=null);var s=t.call(this,"password",r)||this;return s.email=e,s.password=n,s.tenantId=i,s}return r(e,t),e._fromEmailAndPassword=function(t,n){return new e(t,n,"password")},e._fromEmailAndCode=function(t,n,r){return void 0===r&&(r=null),new e(t,n,"emailLink",r)},e.prototype.toJSON=function(){return{email:this.email,password:this.password,signInMethod:this.signInMethod,tenantId:this.tenantId}},e.fromJSON=function(t){var e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null},e.prototype._getIdTokenResponse=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(this.signInMethod){case"password":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPassword",e)]})})}(t,{returnSecureToken:!0,email:this.email,password:this.password})];case"emailLink":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithEmailLink",e)]})})}(t,{email:this.email,oobCode:this.password})];default:L(t,"internal-error")}return[2]})})},e.prototype._linkToIdToken=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(this.signInMethod){case"password":return[2,at(t,{idToken:e,returnSecureToken:!0,email:this.email,password:this.password})];case"emailLink":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithEmailLink",e)]})})}(t,{idToken:e,email:this.email,oobCode:this.password})];default:L(t,"internal-error")}return[2]})})},e.prototype._getReauthenticationResolver=function(t){return this._getIdTokenResponse(t)},e}($);function ht(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithIdp",e)]})})}var lt,ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pendingToken=null,e}return r(e,t),e._fromParams=function(t){var n=new e(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):L("argument-error"),n},e.prototype.toJSON=function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}},e.fromJSON=function(t){var n="string"==typeof t?JSON.parse(t):t,r=n.providerId,i=n.signInMethod,o=s(n,["providerId","signInMethod"]);if(!r||!i)return null;var a=new e(r,i);return Object.assign(a,o),a},e.prototype._getIdTokenResponse=function(t){return ht(t,this.buildRequest())},e.prototype._linkToIdToken=function(t,e){var n=this.buildRequest();return n.idToken=e,ht(t,n)},e.prototype._getReauthenticationResolver=function(t){var e=this.buildRequest();return e.autoCreate=!1,ht(t,e)},e.prototype.buildRequest=function(){var t={requestUri:"http://localhost",returnSecureToken:!0,postBody:null};if(this.pendingToken)t.pendingToken=this.pendingToken;else{var e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=m(e)}return t},e}($);var dt=((lt={}).USER_NOT_FOUND="user-not-found",lt);var pt=function(t){function e(e){var n=t.call(this,"phone","phone")||this;return n.params=e,n}return r(e,t),e._fromVerification=function(t,n){return new e({verificationId:t,verificationCode:n})},e._fromTokenResponse=function(t,n){return new e({phoneNumber:t,temporaryProof:n})},e.prototype._getIdTokenResponse=function(t){return function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",e)]})})}(t,this._makeVerificationRequest())},e.prototype._linkToIdToken=function(t,e){return function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",e)]})})}(t,i({idToken:e},this._makeVerificationRequest()))},e.prototype._getReauthenticationResolver=function(t){return function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){return n=i(i({},e),{operation:"REAUTH"}),[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",n,dt)]})})}(t,this._makeVerificationRequest())},e.prototype._makeVerificationRequest=function(){var t=this.params,e=t.temporaryProof,n=t.phoneNumber,r=t.verificationId,i=t.verificationCode;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}},e.prototype.toJSON=function(){var t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t},e.fromJSON=function(t){"string"==typeof t&&(t=JSON.parse(t));var n=t,r=n.verificationId,i=n.verificationCode,s=n.phoneNumber,o=n.temporaryProof;return i||r||s||o?new e({verificationId:r,verificationCode:i,phoneNumber:s,temporaryProof:o}):null},e}($),gt=function(){function t(){this.type="NONE",this.storage={}}return t.prototype._isAvailable=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,!0]})})},t.prototype._set=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return this.storage[t]=e,[2]})})},t.prototype._get=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return[2,void 0===(e=this.storage[t])?null:e]})})},t.prototype._remove=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return delete this.storage[t],[2]})})},t.prototype._addListener=function(t,e){},t.prototype._removeListener=function(t,e){},t.type="NONE",t}();var mt=function(){function t(t){var e=new URL(t),n=e.searchParams.get("apiKey"),r=e.searchParams.get("oobCode"),i=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(e.searchParams.get("mode"));M(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=e.searchParams.get("continueUrl"),this.languageCode=e.searchParams.get("languageCode"),this.tenantId=e.searchParams.get("tenantId")}return t.parseLink=function(e){var n=function(t){var e=new URL(t),n=e.searchParams.get("link"),r=n?new URL(n).searchParams.get("link"):null,i=e.searchParams.get("deep_link_id");return(i?new URL(i).searchParams.get("link"):null)||i||r||n||t}(e);try{return new t(n)}catch(t){return null}},t}();var vt=function(){function t(){this.providerId=t.PROVIDER_ID}return t.credential=function(t,e){return ct._fromEmailAndPassword(t,e)},t.credentialWithLink=function(t,e){var n=mt.parseLink(e);return M(n,"argument-error"),ct._fromEmailAndCode(t,n.code,n.tenantId)},t.PROVIDER_ID="password",t.EMAIL_PASSWORD_SIGN_IN_METHOD="password",t.EMAIL_LINK_SIGN_IN_METHOD="emailLink",t}(),yt=function(){function t(t){this.providerId=t,this.defaultLanguageCode=null,this.scopes=[],this.customParameters={}}return t.credentialFromJSON=function(t){var e="string"==typeof t?JSON.parse(t):t;return M("providerId"in e&&"signInMethod"in e,"argument-error"),ft._fromParams(e)},t.prototype.credential=function(t){return M(t.idToken&&t.accessToken,"argument-error"),ft._fromParams(i({providerId:this.providerId,signInMethod:this.providerId},t))},t.prototype.setDefaultLanguage=function(t){this.defaultLanguageCode=t},t.prototype.setCustomParameters=function(t){return this.customParameters=t,this},t.prototype.getCustomParameters=function(){return this.customParameters},t.prototype.addScope=function(t){return this.scopes.includes(t)||this.scopes.push(t),this},t.prototype.getScopes=function(){return u(this.scopes)},t}(),wt=function(t){function e(){return t.call(this,"facebook.com")||this}return r(e,t),e.credential=function(t){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.FACEBOOK_SIGN_IN_METHOD,accessToken:t})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!(n&&"oauthAccessToken"in n))return null;if(!n.oauthAccessToken)return null;try{return e.credential(n.oauthAccessToken)}catch(t){return null}},e.FACEBOOK_SIGN_IN_METHOD="facebook.com",e.PROVIDER_ID="facebook.com",e}(yt),bt=function(t){function e(){var e=t.call(this,"google.com")||this;return e.addScope("profile"),e}return r(e,t),e.credential=function(t,n){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!n)return null;var r=n,i=r.oauthIdToken,s=r.oauthAccessToken;if(!i&&!s)return null;try{return e.credential(i,s)}catch(t){return null}},e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}(yt),Et=function(t){function e(){return t.call(this,"github.com")||this}return r(e,t),e.credential=function(t){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GITHUB_SIGN_IN_METHOD,accessToken:t})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!(n&&"oauthAccessToken"in n))return null;if(!n.oauthAccessToken)return null;try{return e.credential(n.oauthAccessToken)}catch(t){return null}},e.GITHUB_SIGN_IN_METHOD="github.com",e.PROVIDER_ID="github.com",e}(yt),It=function(t){function e(){return t.call(this,"twitter.com")||this}return r(e,t),e.credential=function(t,n){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!n)return null;var r=n,i=r.oauthAccessToken,s=r.oauthTokenSecret;if(!i||!s)return null;try{return e.credential(i,s)}catch(t){return null}},e.TWITTER_SIGN_IN_METHOD="twitter.com",e.PROVIDER_ID="twitter.com",e}(yt);function _t(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signUp",e)]})})}function Tt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}function St(t){if(t)try{var e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function At(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var n,r,i,s,o;return a(this,function(a){switch(a.label){case 0:return n=t,[4,t.getIdToken(e)];case 1:return r=a.sent(),M((i=Nt(r))&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error"),s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider,[2,{claims:i,token:r,authTime:St(kt(i.auth_time)),issuedAtTime:St(kt(i.iat)),expirationTime:St(kt(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}]}})})}function kt(t){return 1e3*Number(t)}function Nt(t){var e=t.split("."),n=e[0],r=e[1],i=e[2];if(void 0===n||void 0===r||void 0===i)return D("JWT malformed, contained fewer than 3 sections"),null;try{var s=h(r);return s?JSON.parse(s):(D("Failed to decode base64 JWT payload"),null)}catch(t){return D("Caught error parsing JWT payload as JSON",t),null}}function Rt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:if(n)return[2,e];i.label=1;case 1:return i.trys.push([1,3,,6]),[4,e];case 2:return[2,i.sent()];case 3:return(r=i.sent())instanceof d&&function(t){var e=t.code;return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)?t.auth.currentUser!==t?[3,5]:[4,t.auth.signOut()]:[3,5];case 4:i.sent(),i.label=5;case 5:throw r;case 6:return[2]}})})}var Ot=function(){function t(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return t.prototype._start=function(){this.isRunning||(this.isRunning=!0,this.schedule())},t.prototype._stop=function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))},t.prototype.getInterval=function(t){var e;if(t){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;n=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,n)},t.prototype.schedule=function(t){var e=this;if(void 0===t&&(t=!1),this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(function(){return o(e,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.iteration()];case 1:return t.sent(),[2]}})})},n)}},t.prototype.iteration=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.user.getIdToken(!0)];case 1:return t.sent(),[3,3];case 2:return"auth/network-request-failed"===t.sent().code&&this.schedule(!0),[2];case 3:return this.schedule(),[2]}})})},t}(),Pt=function(){function t(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}return t.prototype._initializeTime=function(){this.lastSignInTime=St(this.lastLoginAt),this.creationTime=St(this.createdAt)},t.prototype._copy=function(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()},t.prototype.toJSON=function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}},t}();function Ct(t){var e;return o(this,void 0,void 0,function(){var n,r,i,c,h,l,f,d,p,g;return a(this,function(m){switch(m.label){case 0:return n=t.auth,[4,t.getIdToken()];case 1:return r=m.sent(),[4,Rt(t,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:lookup",e)]})})}(n,{idToken:r}))];case 2:return M(null==(i=m.sent())?void 0:i.users.length,n,"internal-error"),c=i.users[0],t._notifyReloadListener(c),h=(null===(e=c.providerUserInfo)||void 0===e?void 0:e.length)?c.providerUserInfo.map(function(t){var e=t.providerId,n=s(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],v=t.providerData,y=h,l=u(v.filter(function(t){return!y.some(function(e){return e.providerId===t.providerId})}),y),f=t.isAnonymous,d=!(t.email&&c.passwordHash||(null==l?void 0:l.length)),p=!!f&&d,g={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:l,metadata:new Pt(c.createdAt,c.lastLoginAt),isAnonymous:p},Object.assign(t,g),[2]}var v,y})})}function Dt(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,Ct(e=t)];case 1:return n.sent(),[4,e.auth._persistUserIfCurrent(e)];case 2:return n.sent(),e.auth._notifyListenersIfCurrent(e),[2]}})})}var Lt=function(){function t(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Object.defineProperty(t.prototype,"isExpired",{get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4},enumerable:!1,configurable:!0}),t.prototype.updateFromServerResponse=function(t){M(t.idToken,"internal-error"),M(void 0!==t.idToken,"internal-error"),M(void 0!==t.refreshToken,"internal-error");var e,n,r="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):(e=t.idToken,M(n=Nt(e),"internal-error"),M(void 0!==n.exp,"internal-error"),M(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)},t.prototype.getToken=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return M(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?[4,this.refresh(t,this.refreshToken)]:[3,2]:[2,this.accessToken];case 1:return n.sent(),[2,this.accessToken];case 2:return[2,null]}})})},t.prototype.clearRefreshToken=function(){this.refreshToken=null},t.prototype.refresh=function(t,e){return o(this,void 0,void 0,function(){var n,r,i,s;return a(this,function(u){switch(u.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,et(t,{},function(){var n=m({grant_type:"refresh_token",refresh_token:e}).slice(1),r=t.config,i=r.tokenApiHost,s=r.apiKey,o=r.sdkClientVersion,a=rt(t,i,"/v1/token","key="+s);return J.fetch()(a,{method:"POST",headers:{"X-Client-Version":o,"Content-Type":"application/x-www-form-urlencoded"},body:n})})];case 1:return[2,{accessToken:(n=r.sent()).access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}]}})})}(t,e)];case 1:return n=u.sent(),r=n.accessToken,i=n.refreshToken,s=n.expiresIn,this.updateTokensAndExpiration(r,i,Number(s)),[2]}})})},t.prototype.updateTokensAndExpiration=function(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n},t.fromJSON=function(e,n){var r=n.refreshToken,i=n.accessToken,s=n.expirationTime,o=new t;return r&&(M("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(M("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(M("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o},t.prototype.toJSON=function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}},t.prototype._assign=function(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime},t.prototype._clone=function(){return Object.assign(new t,this.toJSON())},t.prototype._performRefresh=function(){return V("not implemented")},t}();function xt(t,e){M("string"==typeof t||void 0===t,"internal-error",{appName:e})}var Ut=function(){function t(t){var e=t.uid,n=t.auth,r=t.stsTokenManager,i=s(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Ot(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new Pt(i.createdAt||void 0,i.lastLoginAt||void 0)}return t.prototype.getIdToken=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,Rt(this,this.stsTokenManager.getToken(this.auth,t))];case 1:return M(e=n.sent(),this.auth,"internal-error"),this.accessToken===e?[3,3]:(this.accessToken=e,[4,this.auth._persistUserIfCurrent(this)]);case 2:n.sent(),this.auth._notifyListenersIfCurrent(this),n.label=3;case 3:return[2,e]}})})},t.prototype.getIdTokenResult=function(t){return At(this,t)},t.prototype.reload=function(){return Dt(this)},t.prototype._assign=function(t){this!==t&&(M(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(function(t){return i({},t)}),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))},t.prototype._clone=function(){return new t(i(i({},this),{stsTokenManager:this.stsTokenManager._clone()}))},t.prototype._onReload=function(t){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)},t.prototype._notifyReloadListener=function(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t},t.prototype._startProactiveRefresh=function(){this.proactiveRefresh._start()},t.prototype._stopProactiveRefresh=function(){this.proactiveRefresh._stop()},t.prototype._updateTokensIfNecessary=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e?[4,Ct(this)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,this.auth._persistUserIfCurrent(this)];case 3:return r.sent(),n&&this.auth._notifyListenersIfCurrent(this),[2]}})})},t.prototype.delete=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.getIdToken()];case 1:return t=e.sent(),[4,Rt(this,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:delete",e)]})})}(this.auth,{idToken:t}))];case 2:return e.sent(),this.stsTokenManager.clearRefreshToken(),[2,this.auth.signOut()]}})})},t.prototype.toJSON=function(){return i({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(t){return i({},t)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON())},Object.defineProperty(t.prototype,"refreshToken",{get:function(){return this.stsTokenManager.refreshToken||""},enumerable:!1,configurable:!0}),t._fromJSON=function(e,n){var r,s,o,a,u,c,h,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,d=null!==(s=n.email)&&void 0!==s?s:void 0,p=null!==(o=n.phoneNumber)&&void 0!==o?o:void 0,g=null!==(a=n.photoURL)&&void 0!==a?a:void 0,m=null!==(u=n.tenantId)&&void 0!==u?u:void 0,v=null!==(c=n._redirectEventId)&&void 0!==c?c:void 0,y=null!==(h=n.createdAt)&&void 0!==h?h:void 0,w=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,E=n.emailVerified,I=n.isAnonymous,_=n.providerData,T=n.stsTokenManager;M(b&&T,e,"internal-error");var S=Lt.fromJSON(this.name,T);M("string"==typeof b,e,"internal-error"),xt(f,e.name),xt(d,e.name),M("boolean"==typeof E,e,"internal-error"),M("boolean"==typeof I,e,"internal-error"),xt(p,e.name),xt(g,e.name),xt(m,e.name),xt(v,e.name),xt(y,e.name),xt(w,e.name);var A=new t({uid:b,auth:e,email:d,emailVerified:E,displayName:f,isAnonymous:I,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:S,createdAt:y,lastLoginAt:w});return _&&Array.isArray(_)&&(A.providerData=_.map(function(t){return i({},t)})),v&&(A._redirectEventId=v),A},t._fromIdTokenResponse=function(e,n,r){return void 0===r&&(r=!1),o(this,void 0,void 0,function(){var i,s;return a(this,function(o){switch(o.label){case 0:return(i=new Lt).updateFromServerResponse(n),[4,Ct(s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r}))];case 1:return o.sent(),[2,s]}})})},t}(),Mt=function(){function t(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return t._fromIdTokenResponse=function(e,n,r,i){return void 0===i&&(i=!1),o(this,void 0,void 0,function(){var s,o;return a(this,function(a){switch(a.label){case 0:return[4,Ut._fromIdTokenResponse(e,r,i)];case 1:return s=a.sent(),o=Vt(r),[2,new t({user:s,providerId:o,_tokenResponse:r,operationType:n})]}})})},t._forOperation=function(e,n,r){return o(this,void 0,void 0,function(){var i;return a(this,function(s){switch(s.label){case 0:return[4,e._updateTokensIfNecessary(r,!0)];case 1:return s.sent(),i=Vt(r),[2,new t({user:e,providerId:i,_tokenResponse:r,operationType:n})]}})})},t}();function Vt(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}function Ft(t,e,n){return"firebase:"+t+":"+e+":"+n}var qt=function(){function t(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;var r=this.auth,i=r.config,s=r.name;this.fullUserKey=Ft(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ft("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return t.prototype.setCurrentUser=function(t){return this.persistence._set(this.fullUserKey,t.toJSON())},t.prototype.getCurrentUser=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.persistence._get(this.fullUserKey)];case 1:return[2,(t=e.sent())?Ut._fromJSON(this.auth,t):null]}})})},t.prototype.removeCurrentUser=function(){return this.persistence._remove(this.fullUserKey)},t.prototype.savePersistenceForRedirect=function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)},t.prototype.setPersistence=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return this.persistence.type===t.type?[2]:[4,this.getCurrentUser()];case 1:return e=n.sent(),[4,this.removeCurrentUser()];case 2:return n.sent(),this.persistence=t,e?[2,this.setCurrentUser(e)]:[2]}})})},t.prototype.delete=function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)},t.create=function(e,n,r){return void 0===r&&(r="authUser"),o(this,void 0,void 0,function(){var i,s,o,u;return a(this,function(a){switch(a.label){case 0:if(!n.length)return[2,new t(j(gt),e,r)];i=Ft(r,e.config.apiKey,e.name),s=0,o=n,a.label=1;case 1:return s<o.length?[4,(u=o[s])._get(i)]:[3,4];case 2:if(a.sent())return[2,new t(u,e,r)];a.label=3;case 3:return s++,[3,1];case 4:return[2,new t(n[0],e,r)]}})})},t}(),jt=function(){function t(t,e){this.app=t,this.config=e,this.currentUser=null,this.operations=Promise.resolve(),this.authStateSubscription=new $t(this),this.idTokenSubscription=new $t(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.redirectInitializerError=null,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=P,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.name=t.name}return t.prototype._initializeWithPersistence=function(t,e){var n=this;return this._initializationPromise=this.queue(function(){return o(n,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return this._deleted?[2]:(e&&(this._popupRedirectResolver=j(e)),n=this,[4,qt.create(this,t)]);case 1:return n.persistenceManager=r.sent(),this._deleted?[2]:[4,this.initializeCurrentUser(e)];case 2:return r.sent(),this._deleted?[2]:(this._isInitialized=!0,[2])}})})}),this._initializationPromise.then(function(){if(n.redirectInitializerError)throw n.redirectInitializerError})},t.prototype._onStorageEvent=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return this._deleted?[2]:[4,this.assertedPersistence.getCurrentUser()];case 1:return t=e.sent(),this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),[4,this.currentUser.getIdToken()]):[3,3]:[2];case 2:return e.sent(),[2];case 3:return[4,this._updateCurrentUser(t)];case 4:return e.sent(),[2]}})})},t.prototype.initializeCurrentUser=function(t){var e;return o(this,void 0,void 0,function(){var n,r,i,s;return a(this,function(o){switch(o.label){case 0:return[4,this.assertedPersistence.getCurrentUser()];case 1:return n=o.sent(),t&&this.config.authDomain?[4,this.getOrInitRedirectPersistenceManager()]:[3,4];case 2:return o.sent(),r=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,i=null==n?void 0:n._redirectEventId,[4,this.tryRedirectSignIn(t)];case 3:s=o.sent(),r&&r!==i||null==s||!s.user||(n=s.user),o.label=4;case 4:return n?n._redirectEventId?(M(this._popupRedirectResolver,this,"argument-error"),[4,this.getOrInitRedirectPersistenceManager()]):[2,this.reloadAndSetCurrentUserOrClear(n)]:[2,this.directlySetCurrentUser(null)];case 5:return o.sent(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?[2,this.directlySetCurrentUser(n)]:[2,this.reloadAndSetCurrentUserOrClear(n)]}})})},t.prototype.tryRedirectSignIn=function(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this._popupRedirectResolver._completeRedirectFn(this,t,!0)];case 2:return e=r.sent(),[3,5];case 3:return n=r.sent(),this.redirectInitializerError=n,[4,this._setRedirectUser(null)];case 4:return r.sent(),[3,5];case 5:return[2,e]}})})},t.prototype.reloadAndSetCurrentUserOrClear=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Ct(t)];case 1:return e.sent(),[3,3];case 2:return"auth/network-request-failed"!==e.sent().code?[2,this.directlySetCurrentUser(null)]:[3,3];case 3:return[2,this.directlySetCurrentUser(t)]}})})},t.prototype.useDeviceLanguage=function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var t=navigator;return t.languages&&t.languages[0]||t.language||null}()},t.prototype.useEmulator=function(t,e){M(this._canInitEmulator,this,"emulator-config-failed"),M(/^https?:\/\//.test(t),this,"invalid-emulator-scheme"),this.config.emulator={url:t},this.settings.appVerificationDisabledForTesting=!0,function(t){function e(){var t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#ff0000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||t||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}(!!(null==e?void 0:e.disableWarnings))},t.prototype._delete=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return this._deleted=!0,[2]})})},t.prototype.updateCurrentUser=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return M(!(e=t)||e.auth.name===this.name,this,"argument-error"),[2,this._updateCurrentUser(e&&e._clone())]})})},t.prototype._updateCurrentUser=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return this._deleted?[2]:(t&&M(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),[2,this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.directlySetCurrentUser(t)];case 1:return e.sent(),this.notifyAuthListeners(),[2]}})})})])})})},t.prototype.signOut=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.redirectPersistenceManager||this._popupRedirectResolver?[4,this._setRedirectUser(null)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this._updateCurrentUser(null)]}})})},t.prototype.setPersistence=function(t){var e=this;return this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.assertedPersistence.setPersistence(j(t))];case 1:return e.sent(),[2]}})})})},t.prototype._getPersistence=function(){return this.assertedPersistence.persistence.type},t.prototype._updateErrorMap=function(t){this._errorFactory=new p("auth","Firebase",t())},t.prototype.onAuthStateChanged=function(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)},t.prototype.onIdTokenChanged=function(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)},t.prototype.toJSON=function(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}},t.prototype._setRedirectUser=function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,this.getOrInitRedirectPersistenceManager(e)];case 1:return n=r.sent(),[2,null===t?n.removeCurrentUser():n.setCurrentUser(t)]}})})},t.prototype.getOrInitRedirectPersistenceManager=function(t){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:return this.redirectPersistenceManager?[3,3]:(M(e=t&&j(t)||this._popupRedirectResolver,this,"argument-error"),n=this,[4,qt.create(this,[j(e._redirectPersistence)],"redirectUser")]);case 1:return n.redirectPersistenceManager=i.sent(),r=this,[4,this.redirectPersistenceManager.getCurrentUser()];case 2:r.redirectUser=i.sent(),i.label=3;case 3:return[2,this.redirectPersistenceManager]}})})},t.prototype._redirectUserForId=function(t){var e,n;return o(this,void 0,void 0,function(){var r=this;return a(this,function(i){switch(i.label){case 0:return this._isInitialized?[4,this.queue(function(){return o(r,void 0,void 0,function(){return a(this,function(t){return[2]})})})]:[3,2];case 1:i.sent(),i.label=2;case 2:return(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?[2,this._currentUser]:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?[2,this.redirectUser]:[2,null]}})})},t.prototype._persistUserIfCurrent=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return t===this.currentUser?[2,this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){return[2,this.directlySetCurrentUser(t)]})})})]:[2]})})},t.prototype._notifyListenersIfCurrent=function(t){t===this.currentUser&&this.notifyAuthListeners()},t.prototype._key=function(){return this.config.authDomain+":"+this.config.apiKey+":"+this.name},t.prototype._startProactiveRefresh=function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()},t.prototype._stopProactiveRefresh=function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()},Object.defineProperty(t.prototype,"_currentUser",{get:function(){return this.currentUser},enumerable:!1,configurable:!0}),t.prototype.notifyAuthListeners=function(){var t,e;this._isInitialized&&(this.idTokenSubscription.next(this.currentUser),this.lastNotifiedUid!==(null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&(this.lastNotifiedUid=null===(e=this.currentUser)||void 0===e?void 0:e.uid,this.authStateSubscription.next(this.currentUser)))},t.prototype.registerStateListener=function(t,e,n,r){var i=this;if(this._deleted)return function(){};var s="function"==typeof e?e:e.next,o=this._isInitialized?Promise.resolve():this._initializationPromise;return M(o,this,"internal-error"),o.then(function(){return s(i.currentUser)}),"function"==typeof e?t.addObserver(e,n,r):t.addObserver(e)},t.prototype.directlySetCurrentUser=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?[4,this.assertedPersistence.setCurrentUser(t)]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.assertedPersistence.removeCurrentUser()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.queue=function(t){return this.operations=this.operations.then(t,t),this.operations},Object.defineProperty(t.prototype,"assertedPersistence",{get:function(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager},enumerable:!1,configurable:!0}),t}();function Bt(t){return t}var $t=function(){function t(t){var e,n,r=this;this.auth=t,this.observer=null,this.addObserver=(n=new w(function(t){return r.observer=t},e)).subscribe.bind(n)}return Object.defineProperty(t.prototype,"next",{get:function(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)},enumerable:!1,configurable:!0}),t}();var Ht=function(t){function e(n,r,i,s){var o,a=t.call(this,r.code,r.message)||this;return a.operationType=i,a.user=s,a.name="FirebaseError",Object.setPrototypeOf(a,e.prototype),a.appName=n.name,a.code=r.code,a.tenantId=null!==(o=n.tenantId)&&void 0!==o?o:void 0,a.serverResponse=r.customData.serverResponse,a}return r(e,t),e._fromErrorAndOperation=function(t,n,r,i){return new e(t,n,r,i)},e}(d);function Gt(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(function(n){if("auth/multi-factor-auth-required"===n.code)throw Ht._fromErrorAndOperation(t,n,e,r);throw n})}function zt(t){return new Set(t.map(function(t){return t.providerId}).filter(function(t){return!!t}))}function Wt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s,o,u,c;return a(this,function(a){switch(a.label){case 0:return i=Rt,s=[t],u=(o=e)._linkToIdToken,c=[t.auth],[4,t.getIdToken()];case 1:return[4,i.apply(void 0,s.concat([u.apply(o,c.concat([a.sent()])),n]))];case 2:return r=a.sent(),[2,Mt._forOperation(t,"link",r)]}})})}function Kt(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){switch(s.label){case 0:return[4,Ct(e)];case 1:return s.sent(),r=zt(e.providerData),i=!1===t?"provider-already-linked":"no-such-provider",M(r.has(n)===t,e.auth,i),[2]}})})}function Xt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s,o,u,c;return a(this,function(a){switch(a.label){case 0:r=t.auth,i="reauthenticate",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Rt(t,Gt(r,i,e,t),n)];case 2:return M((s=a.sent()).idToken,r,"internal-error"),M(o=Nt(s.idToken),r,"internal-error"),u=o.sub,M(t.uid===u,r,"user-mismatch"),[2,Mt._forOperation(t,i,s)];case 3:throw"auth/user-not-found"===(null==(c=a.sent())?void 0:c.code)&&L(r,"user-mismatch"),c;case 4:return[2]}})})}function Yt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return[4,Gt(t,r="signIn",e)];case 1:return i=o.sent(),[4,Mt._fromIdTokenResponse(t,r,i)];case 2:return s=o.sent(),n?[3,4]:[4,t._updateCurrentUser(s.user)];case 3:o.sent(),o.label=4;case 4:return[2,s]}})})}function Jt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,Yt(Bt(t),e)]})})}function Qt(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,Kt(!1,n=t,e.providerId)];case 1:return r.sent(),[2,Wt(n,e)]}})})}function Zt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,Xt(t,e)]})})}var te=function(){function t(t,e){this.factorId=t,this.uid=e.mfaEnrollmentId,this.enrollmentTime=new Date(e.enrolledAt).toUTCString(),this.displayName=e.displayName}return t._fromServerResponse=function(t,e){return"phoneInfo"in e?ee._fromServerResponse(t,e):L(t,"internal-error")},t}(),ee=function(t){function e(e){var n=t.call(this,"phone",e)||this;return n.phoneNumber=e.phoneInfo,n}return r(e,t),e._fromServerResponse=function(t,n){return new e(n)},e}(te);function ne(t,e,n){var r;M((null===(r=n.url)||void 0===r?void 0:r.length)>0,t,"invalid-continue-uri"),M(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(M(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iosBundleId=n.iOS.bundleId),n.android&&(M(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}function re(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return[4,ot(t,{oobCode:e})];case 1:switch(n=s.sent(),M(r=n.requestType,t,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":M(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":M(n.mfaInfo,t,"internal-error");default:M(n.email,t,"internal-error")}return i=null,n.mfaInfo&&(i=te._fromServerResponse(Bt(t),n.mfaInfo)),[2,{data:{email:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.newEmail:n.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.email:n.newEmail)||null,multiFactorInfo:i},operation:r}]}})})}function ie(t,e,n){return o(this,void 0,void 0,function(){var r,i,s,o;return a(this,function(a){switch(a.label){case 0:return r=t.auth,[4,t.getIdToken()];case 1:return i=a.sent(),s={idToken:i,returnSecureToken:!0},e&&(s.email=e),n&&(s.password=n),[4,Rt(t,at(r,s))];case 2:return o=a.sent(),[4,t._updateTokensIfNecessary(o,!0)];case 3:return a.sent(),[2]}})})}var se=function(){return function(t,e,n){void 0===n&&(n={}),this.isNewUser=t,this.providerId=e,this.profile=n}}(),oe=function(t){function e(e,n,r,i){var s=t.call(this,e,n,r)||this;return s.username=i,s}return r(e,t),e}(se),ae=function(t){function e(e,n){return t.call(this,e,"facebook.com",n)||this}return r(e,t),e}(se),ue=function(t){function e(e,n){return t.call(this,e,"github.com",n,"string"==typeof(null==n?void 0:n.login)?null==n?void 0:n.login:null)||this}return r(e,t),e}(oe),ce=function(t){function e(e,n){return t.call(this,e,"google.com",n)||this}return r(e,t),e}(se),he=function(t){function e(e,n,r){return t.call(this,e,"twitter.com",n,r)||this}return r(e,t),e}(oe);var le=function(){function t(t,e){this.type=t,this.credential=e}return t._fromIdtoken=function(e){return new t("enroll",e)},t._fromMfaPendingCredential=function(e){return new t("signin",e)},t.prototype.toJSON=function(){var t;return{multiFactorSession:(t={},t["enroll"===this.type?"idToken":"pendingCredential"]=this.credential,t)}},t.fromJSON=function(e){var n,r;if(null==e?void 0:e.multiFactorSession){if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return t._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(r=e.multiFactorSession)||void 0===r?void 0:r.idToken)return t._fromIdtoken(e.multiFactorSession.idToken)}return null},t}(),fe=function(){function t(t,e,n){this.session=t,this.hints=e,this.signInResolver=n}return t._fromError=function(e,n){var r=this,s=Bt(e),u=(n.serverResponse.mfaInfo||[]).map(function(t){return te._fromServerResponse(s,t)});M(n.serverResponse.mfaPendingCredential,s,"internal-error");var c=le._fromMfaPendingCredential(n.serverResponse.mfaPendingCredential);return new t(c,u,function(t){return o(r,void 0,void 0,function(){var e,r,o;return a(this,function(a){switch(a.label){case 0:return[4,t._process(s,c)];case 1:switch(e=a.sent(),delete n.serverResponse.mfaInfo,delete n.serverResponse.mfaPendingCredential,r=i(i({},n.serverResponse),{idToken:e.idToken,refreshToken:e.refreshToken}),n.operationType){case"signIn":return[3,2];case"reauthenticate":return[3,5]}return[3,6];case 2:return[4,Mt._fromIdTokenResponse(s,n.operationType,r)];case 3:return o=a.sent(),[4,s._updateCurrentUser(o.user)];case 4:return a.sent(),[2,o];case 5:return M(n.user,s,"internal-error"),[2,Mt._forOperation(n.user,n.operationType,r)];case 6:L(s,"internal-error"),a.label=7;case 7:return[2]}})})})},t.prototype.resolveSignIn=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return e=t,[2,this.signInResolver(e)]})})},t}();var de=function(){function t(t){var e=this;this.user=t,this.enrolledFactors=[],t._onReload(function(n){n.mfaInfo&&(e.enrolledFactors=n.mfaInfo.map(function(e){return te._fromServerResponse(t.auth,e)}))})}return t._fromUser=function(e){return new t(e)},t.prototype.getSession=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return e=(t=le)._fromIdtoken,[4,this.user.getIdToken()];case 1:return[2,e.apply(t,[n.sent()])]}})})},t.prototype.enroll=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=t,[4,this.getSession()];case 1:return r=s.sent(),[4,Rt(this.user,n._process(this.user.auth,r,e))];case 2:return i=s.sent(),[4,this.user._updateTokensIfNecessary(i)];case 3:return s.sent(),[2,this.user.reload()]}})})},t.prototype.unenroll=function(t){return o(this,void 0,void 0,function(){var e,n,r,s;return a(this,function(o){switch(o.label){case 0:return e="string"==typeof t?t:t.uid,[4,this.user.getIdToken()];case 1:return n=o.sent(),[4,Rt(this.user,(a=this.user.auth,u={idToken:n,mfaEnrollmentId:e},tt(a,"POST","/v2/accounts/mfaEnrollment:withdraw",i({tenantId:a.tenantId},u))))];case 2:return r=o.sent(),this.enrolledFactors=this.enrolledFactors.filter(function(t){return t.uid!==e}),[4,this.user._updateTokensIfNecessary(r)];case 3:o.sent(),o.label=4;case 4:return o.trys.push([4,6,,7]),[4,this.user.reload()];case 5:return o.sent(),[3,7];case 6:if("auth/user-token-expired"!==(s=o.sent()).code)throw s;return[3,7];case 7:return[2]}var a,u})})},t}(),pe=new WeakMap;var ge="0.0.900-exp.1e0eb201d";function me(t){var e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(be(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ve(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ie(e))return"Blackberry";if(_e(e))return"Webos";if(ye(e))return"Safari";if((e.includes("chrome/")||we(e))&&!e.includes("edge/"))return"Chrome";if(Ee(e))return"Android";var n=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function ve(t){return/firefox\//i.test(t)}function ye(t){var e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function we(t){return/crios\//i.test(t)}function be(t){return/iemobile/i.test(t)}function Ee(t){return/android/i.test(t)}function Ie(t){return/blackberry/i.test(t)}function _e(t){return/webos/i.test(t)}function Te(t){return/iphone|ipad|ipod/i.test(t)}function Se(){return((t=l()).indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0)&&10===document.documentMode;var t}function Ae(t){var n;switch(t){case"Browser":n=me(l());break;case"Worker":n=me(l())+"-"+t;break;default:n=t}return n+"/JsCore/"+e.SDK_VERSION+"/FirebaseCore-web"}var ke=function(){function t(t){this.auth=t,this.internalListeners=new Map}return t.prototype.getUid=function(){var t;return(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null},t.prototype.getToken=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.auth._initializationPromise];case 1:return e.sent(),this.auth.currentUser?[4,this.auth.currentUser.getIdToken(t)]:[2,null];case 2:return[2,{accessToken:e.sent()}]}})})},t.prototype.addAuthTokenListener=function(t){if(!this.internalListeners.has(t)){var e=this.auth.onIdTokenChanged(function(e){var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}},t.prototype.removeAuthTokenListener=function(t){var e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())},t.prototype.updateProactiveRefresh=function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()},t}();var Ne=function(){function t(t,e){this.storage=t,this.type=e}return t.prototype._isAvailable=function(){try{return this.storage?(this.storage.setItem("__sak","1"),this.storage.removeItem("__sak"),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}},t.prototype._set=function(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()},t.prototype._get=function(t){var e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)},t.prototype._remove=function(t){return this.storage.removeItem(t),Promise.resolve()},t}();var Re=function(t){function e(){var e,n=t.call(this,localStorage,"LOCAL")||this;return n.listeners={},n.localCache={},n.pollTimer=null,n.safariLocalStorageNotSynced=(ye(e=l())||Te(e))&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),n.fallbackToPolling=function(t){return void 0===t&&(t=l()),Te(t)||Ee(t)||_e(t)||Ie(t)||/windows phone/i.test(t)||be(t)}(),n.boundEventHandler=n.onStorageEvent.bind(n),n}return r(e,t),e.prototype.forAllChangedKeys=function(t){for(var e=0,n=Object.keys(this.listeners);e<n.length;e++){var r=n[e],i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}},e.prototype.onStorageEvent=function(t,e){var n=this;if(void 0===e&&(e=!1),t.key){var r=t.key;if(this.listeners[r]){if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(r,t.newValue):this.storage.removeItem(r);else if(this.localCache[r]===t.newValue&&!e)return}var s=function(){var t=n.storage.getItem(r);(e||n.localCache[r]!==t)&&n.notifyListeners(r,t)},o=this.storage.getItem(r);Se()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,10):s()}}else this.forAllChangedKeys(function(t,e,r){n.notifyListeners(t,r)})},e.prototype.notifyListeners=function(t,e){if(this.listeners[t]){this.localCache[t]=e;for(var n=0,r=Array.from(this.listeners[t]);n<r.length;n++){(0,r[n])(e?JSON.parse(e):e)}}},e.prototype.startPolling=function(){var t=this;this.stopPolling(),this.pollTimer=setInterval(function(){t.forAllChangedKeys(function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},1e3)},e.prototype.stopPolling=function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)},e.prototype.attachListener=function(){window.addEventListener("storage",this.boundEventHandler)},e.prototype.detachListener=function(){window.removeEventListener("storage",this.boundEventHandler)},e.prototype._addListener=function(t,e){this.localCache[t]=this.storage.getItem(t),0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]=this.listeners[t]||new Set,this.listeners[t].add(e)},e.prototype._removeListener=function(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&(delete this.listeners[t],delete this.localCache[t])),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())},e.type="LOCAL",e}(Ne);var Oe=function(){function t(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return t._getInstance=function(e){var n=this.receivers.find(function(t){return t.isListeningto(e)});if(n)return n;var r=new t(e);return this.receivers.push(r),r},t.prototype.isListeningto=function(t){return this.eventTarget===t},t.prototype.handleEvent=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,u,c,h=this;return a(this,function(l){switch(l.label){case 0:return n=(e=t).data,r=n.eventId,i=n.eventType,s=n.data,(null==(u=this.handlersMap[i])?void 0:u.size)?(e.ports[0].postMessage({status:"ack",eventId:r,eventType:i}),[4,function(t){var e=this;return Promise.all(t.map(function(t){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t];case 1:return[2,{fulfilled:!0,value:e.sent()}];case 2:return[2,{fulfilled:!1,reason:e.sent()}];case 3:return[2]}})})}))}(Array.from(u).map(function(t){return o(h,void 0,void 0,function(){return a(this,function(n){return[2,t(e.origin,s)]})})}))]):[2];case 1:return c=l.sent(),e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c}),[2]}})})},t.prototype._subscribe=function(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)},t.prototype._unsubscribe=function(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)},t.receivers=[],t}();var Pe=function(){function t(t){this.target=t,this.handlers=new Set}return t.prototype.removeMessageHandler=function(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)},t.prototype._send=function(t,e,n){return void 0===n&&(n=50),o(this,void 0,void 0,function(){var r,i,s,o=this;return a(this,function(a){if(!(r="undefined"!=typeof MessageChannel?new MessageChannel:null))throw new Error("connection_unavailable");return[2,new Promise(function(a,u){var c,h,l=(void 0===c&&(c=""),void 0===h&&(h=20),""+c+Math.floor(Math.random()*Math.pow(10,h)));r.port1.start();var f=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage:function(t){var e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(f),i=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(e.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"))}}},o.handlers.add(s),r.port1.addEventListener("message",s.onMessage),o.target.postMessage({eventType:t,eventId:l,data:e},[r.port2])}).finally(function(){s&&o.removeMessageHandler(s)})]})})},t}();function Ce(){return window}function De(){return void 0!==Ce().WorkerGlobalScope&&"function"==typeof Ce().importScripts}var Le="firebaseLocalStorageDb",xe=1,Ue="firebaseLocalStorage",Me="fbase_key",Ve=function(){function t(t){this.request=t}return t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.request.addEventListener("success",function(){e(t.request.result)}),t.request.addEventListener("error",function(){n(t.request.error)})})},t}();function Fe(t,e){return t.transaction([Ue],e?"readwrite":"readonly").objectStore(Ue)}function qe(){var t=this,e=indexedDB.open(Le,xe);return new Promise(function(n,r){e.addEventListener("error",function(){r(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(Ue,{keyPath:Me})}catch(t){r(t)}}),e.addEventListener("success",function(){return o(t,void 0,void 0,function(){var t;return a(this,function(r){switch(r.label){case 0:return(t=e.result).objectStoreNames.contains(Ue)?[3,2]:[4,function(){var t=indexedDB.deleteDatabase(Le);return new Ve(t).toPromise()}()];case 1:return r.sent(),[2,qe()];case 2:n(t),r.label=3;case 3:return[2]}})})})})}function je(t,e,n){return o(this,void 0,void 0,function(){var r,i,s,o;return a(this,function(a){switch(a.label){case 0:return r=Fe(t,!1).get(e),[4,new Ve(r).toPromise()];case 1:return(i=a.sent())?(i.value=n,s=Fe(t,!0).put(i),[2,new Ve(s).toPromise()]):(s=Fe(t,!0).add(((o={})[Me]=e,o.value=n,o)),[2,new Ve(s).toPromise()])}})})}function Be(t,e){var n=Fe(t,!0).delete(e);return new Ve(n).toPromise()}var $e=function(){function t(){this.type="LOCAL",this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return t.prototype._openDb=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return this.db?[2,this.db]:(t=this,[4,qe()]);case 1:return t.db=e.sent(),[2,this.db]}})})},t.prototype._withRetries=function(t){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:e=0,i.label=1;case 1:i.label=2;case 2:return i.trys.push([2,5,,6]),[4,this._openDb()];case 3:return n=i.sent(),[4,t(n)];case 4:return[2,i.sent()];case 5:if(r=i.sent(),e++>3)throw r;return this.db&&(this.db.close(),this.db=void 0),[3,6];case 6:return[3,1];case 7:return[2]}})})},t.prototype.initializeServiceWorkerMessaging=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,De()?this.initializeReceiver():this.initializeSender()]})})},t.prototype.initializeReceiver=function(){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return this.receiver=Oe._getInstance(De()?self:null),this.receiver._subscribe("keyChanged",function(e,n){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this._poll()];case 1:return[2,{keyProcessed:t.sent().includes(n.key)}]}})})}),this.receiver._subscribe("ping",function(e,n){return o(t,void 0,void 0,function(){return a(this,function(t){return[2,["keyChanged"]]})})}),[2]})})},t.prototype.initializeSender=function(){var t,e;return o(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return n=this,[4,function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return[2,null];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,navigator.serviceWorker.ready];case 2:return[2,t.sent().active];case 3:return t.sent(),[2,null];case 4:return[2]}})})}()];case 1:return n.activeServiceWorker=i.sent(),this.activeServiceWorker?(this.sender=new Pe(this.activeServiceWorker),[4,this.sender._send("ping",{},800)]):[2];case 2:return(r=i.sent())?((null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=r[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0),[2]):[2]}})})},t.prototype.notifyServiceWorker=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:if(!this.sender||!this.activeServiceWorker||function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()!==this.activeServiceWorker)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},t.prototype._isAvailable=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),indexedDB?[4,qe()]:[2,!1];case 1:return[4,je(t=e.sent(),"__sak","1")];case 2:return e.sent(),[4,Be(t,"__sak")];case 3:return e.sent(),[2,!0];case 4:return e.sent(),[3,5];case 5:return[2,!1]}})})},t.prototype._withPendingWrite=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:this.pendingWrites++,e.label=1;case 1:return e.trys.push([1,,3,4]),[4,t()];case 2:return e.sent(),[3,4];case 3:return this.pendingWrites--,[7];case 4:return[2]}})})},t.prototype._set=function(t,e){return o(this,void 0,void 0,function(){var n=this;return a(this,function(r){return[2,this._withPendingWrite(function(){return o(n,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,this._withRetries(function(n){return je(n,t,e)})];case 1:return n.sent(),this.localCache[t]=e,[2,this.notifyServiceWorker(t)]}})})})]})})},t.prototype._get=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,this._withRetries(function(e){return function(t,e){return o(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return n=Fe(t,!1).get(e),[4,new Ve(n).toPromise()];case 1:return[2,void 0===(r=i.sent())?null:r.value]}})})}(e,t)})];case 1:return e=n.sent(),this.localCache[t]=e,[2,e]}})})},t.prototype._remove=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return[2,this._withPendingWrite(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._withRetries(function(e){return Be(e,t)})];case 1:return e.sent(),delete this.localCache[t],[2,this.notifyServiceWorker(t)]}})})})]})})},t.prototype._poll=function(){return o(this,void 0,void 0,function(){var t,e,n,r,i,s,o;return a(this,function(a){switch(a.label){case 0:return[4,this._withRetries(function(t){var e=Fe(t,!1).getAll();return new Ve(e).toPromise()})];case 1:if(!(t=a.sent()))return[2,[]];if(0!==this.pendingWrites)return[2,[]];for(e=[],n=0,r=t;n<r.length;n++)i=r[n],s=i.fbase_key,o=i.value,JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),e.push(s));return[2,e]}})})},t.prototype.notifyListeners=function(t,e){if(this.listeners[t]){this.localCache[t]=e;for(var n=0,r=Array.from(this.listeners[t]);n<r.length;n++){(0,r[n])(e)}}},t.prototype.startPolling=function(){var t=this;this.stopPolling(),this.pollTimer=setInterval(function(){return o(t,void 0,void 0,function(){return a(this,function(t){return[2,this._poll()]})})},800)},t.prototype.stopPolling=function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)},t.prototype._addListener=function(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]=this.listeners[t]||new Set,this.listeners[t].add(e)},t.prototype._removeListener=function(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&(delete this.listeners[t],delete this.localCache[t])),0===Object.keys(this.listeners).length&&this.stopPolling()},t.type="LOCAL",t}(),He=function(){function t(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return t.prototype.registerConsumer=function(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)},t.prototype.unregisterConsumer=function(t){this.consumers.delete(t)},t.prototype.onEvent=function(t){var e=this;if(this.hasEventBeenHandled(t))return!1;var n=!1;return this.consumers.forEach(function(r){e.isEventForConsumer(t,r)&&(n=!0,e.sendToConsumer(t,r),e.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ze(t);default:return!1}}(t)?n:(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0),n)},t.prototype.sendToConsumer=function(t,e){var n;if(t.error&&!ze(t)){var r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(x(this.auth,r))}else e.onAuthEvent(t)},t.prototype.isEventForConsumer=function(t,e){var n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n},t.prototype.hasEventBeenHandled=function(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ge(t))},t.prototype.saveEventToCache=function(t){this.cachedEventUids.add(Ge(t)),this.lastProcessedEventTime=Date.now()},t}();function Ge(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(function(t){return t}).join("-")}function ze(t){var e=t.type,n=t.error;return"unknown"===e&&"auth/no-auth-event"===(null==n?void 0:n.code)}function We(t){return""+(t||"")+Math.floor(1e9*Math.random())}var Ke=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xe=/^https?/;function Ye(t){return o(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(s){switch(s.label){case 0:return t.config.emulator?[2]:[4,function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,tt(t,"GET","/v1/projects",{})]})})}(t)];case 1:for(e=s.sent().authorizedDomains,n=0,r=e;n<r.length;n++){i=r[n];try{if(Je(i))return[2]}catch(t){}}return L(t,"unauthorized-domain"),[2]}})})}function Je(t){var e=H(),n=new URL(e),r=n.protocol,i=n.hostname;if(t.startsWith("chrome-extension://")){var s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===r&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===r&&s.hostname===i}if(!Xe.test(r))return!1;if(Ke.test(t))return i===t;var o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}function Qe(t){return new Promise(function(e,n){var r,i,s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=n,s.type="text/javascript",s.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(s)})}function Ze(t){return"__"+t+Math.floor(1e6*Math.random())}var tn=new K(3e4,6e4);function en(){var t=Ce().___jsl;if(null==t?void 0:t.H)for(var e=0,n=Object.keys(t.H);e<n.length;e++){var r=n[e];if(t.H[r].r=t.H[r].r||[],t.H[r].L=t.H[r].L||[],t.H[r].r=u(t.H[r].L),t.CP)for(var i=0;i<t.CP.length;i++)t.CP[i]=null}}var nn=null;function rn(t){return nn=nn||function(t){return new Promise(function(e,n){var r,i,s;function o(){en(),gapi.load("gapi.iframes",{callback:function(){e(gapi.iframes.getContext())},ontimeout:function(){en(),n(x(t,"network-request-failed"))},timeout:tn.get()})}if(null===(i=null===(r=Ce().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=Ce().gapi)||void 0===s||!s.load){var a=Ze("iframefcb");return Ce()[a]=function(){gapi.load?o():n(x(t,"network-request-failed"))},Qe("https://apis.google.com/js/api.js?onload="+a)}o()}}).catch(function(t){throw nn=null,t})}(t)}var sn=new K(5e3,15e3),on="__/auth/iframe",an="emulator/auth/iframe",un={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}};function cn(t){return o(this,void 0,void 0,function(){var n,r,i=this;return a(this,function(s){switch(s.label){case 0:return[4,rn(t)];case 1:return n=s.sent(),M(r=Ce().gapi,t,"internal-error"),[2,n.open({where:document.body,url:function(t){var n=t.config;return M(n.authDomain,t,"auth-domain-config-required"),(n.emulator?X(n,an):"https://"+t.config.authDomain+"/"+on)+"?"+m({apiKey:n.apiKey,appName:t.name,v:e.SDK_VERSION}).slice(1)}(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:un,dontclear:!0},function(e){return new Promise(function(n,r){return o(i,void 0,void 0,function(){function i(){Ce().clearTimeout(o),n(e)}var s,o;return a(this,function(n){switch(n.label){case 0:return[4,e.restyle({setHideOnLeave:!1})];case 1:return n.sent(),s=x(t,"network-request-failed"),o=Ce().setTimeout(function(){r(s)},sn.get()),e.ping(i).then(i,function(){r(s)}),[2]}})})})})]}})})}var hn=function(t){function e(){return t.call(this,sessionStorage,"SESSION")||this}return r(e,t),e.prototype._addListener=function(t,e){},e.prototype._removeListener=function(t,e){},e.type="SESSION",e}(Ne),ln={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fn=500,dn=600,pn="_blank",gn="http://localhost",mn=function(){function t(t){this.window=t,this.associatedEvent=null}return t.prototype.close=function(){if(this.window)try{this.window.close()}catch(t){}},t}();function vn(t,e,n,r,s){void 0===r&&(r=fn),void 0===s&&(s=dn);var o=Math.min((window.screen.availHeight-s)/2,0).toString(),a=Math.min((window.screen.availWidth-r)/2,0).toString(),u="",c=i(i({},ln),{width:r.toString(),height:s.toString(),top:o,left:a}),h=l().toLowerCase();n&&(u=we(h)?pn:n),ve(h)&&(e=e||gn,c.scrollbars="yes");var f=Object.entries(c).reduce(function(t,e){return""+t+e[0]+"="+e[1]+","},"");if(function(t){var e;return Te(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==u)return function(t,e){var n=document.createElement("a");n.href=t,n.target=e;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",u),new mn(null);var d=window.open(e||"",u,f);M(d,t,"popup-blocked");try{d.focus()}catch(t){}return new mn(d)}var yn=function(t){function e(e){var n=t.call(this,"custom","custom")||this;return n.params=e,n}return r(e,t),e.prototype._getIdTokenResponse=function(t){return ht(t,this._buildIdpRequest())},e.prototype._linkToIdToken=function(t,e){return ht(t,this._buildIdpRequest(e))},e.prototype._getReauthenticationResolver=function(t){return ht(t,this._buildIdpRequest())},e.prototype._buildIdpRequest=function(t){var e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody||null,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0};return t&&(e.idToken=t),e},e}($);function wn(t){return Yt(t.auth,new yn(t),t.bypassAuthState)}function bn(t){var e=t.auth,n=t.user;return M(n,e,"internal-error"),Xt(n,new yn(t),t.bypassAuthState)}function En(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){return e=t.auth,M(n=t.user,e,"internal-error"),[2,Wt(n,new yn(t),t.bypassAuthState)]})})}var In=function(){function t(t,e,n,r,i){void 0===i&&(i=!1),this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}return t.prototype.execute=function(){var t=this;return new Promise(function(e,n){return o(t,void 0,void 0,function(){var t,r;return a(this,function(i){switch(i.label){case 0:this.pendingPromise={resolve:e,reject:n},i.label=1;case 1:return i.trys.push([1,4,,5]),t=this,[4,this.resolver._initialize(this.auth)];case 2:return t.eventManager=i.sent(),[4,this.onExecution()];case 3:return i.sent(),this.eventManager.registerConsumer(this),[3,5];case 4:return r=i.sent(),this.reject(r),[3,5];case 5:return[2]}})})})},t.prototype.onAuthEvent=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,o,u,c,h;return a(this,function(a){switch(a.label){case 0:if(e=t.urlResponse,n=t.sessionId,r=t.postBody,i=t.tenantId,s=t.error,o=t.type,s)return this.reject(s),[2];u={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState},a.label=1;case 1:return a.trys.push([1,3,,4]),c=this.resolve,[4,this.getIdpTask(o)(u)];case 2:return c.apply(this,[a.sent()]),[3,4];case 3:return h=a.sent(),this.reject(h),[3,4];case 4:return[2]}})})},t.prototype.onError=function(t){this.reject(t)},t.prototype.getIdpTask=function(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return wn;case"linkViaPopup":case"linkViaRedirect":return En;case"reauthViaPopup":case"reauthViaRedirect":return bn;default:L(this.auth,"internal-error")}},t.prototype.resolve=function(t){F(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()},t.prototype.reject=function(t){F(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()},t.prototype.unregisterAndCleanUp=function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()},t}();function _n(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return r=Bt(t),i=Rn(r,e),[4,new An(r,i,n).execute()];case 1:return!(s=o.sent())||n?[3,4]:(delete s.user._redirectEventId,[4,r._persistUserIfCurrent(s.user)]);case 2:return o.sent(),[4,r._setRedirectUser(null,e)];case 3:o.sent(),o.label=4;case 4:return[2,s]}})})}function Tn(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return e=We(t.uid+":::"),t._redirectEventId=e,[4,t.auth._setRedirectUser(t)];case 1:return n.sent(),[4,t.auth._persistUserIfCurrent(t)];case 2:return n.sent(),[2,e]}})})}var Sn=new Map,An=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r)||this;return i.eventId=null,i}return r(e,t),e.prototype.execute=function(){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:if(e=Sn.get(this.auth._key()))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.prototype.execute.call(this)];case 2:return n=i.sent(),e=function(){return Promise.resolve(n)},[3,4];case 3:return r=i.sent(),e=function(){return Promise.reject(r)},[3,4];case 4:Sn.set(this.auth._key(),e),i.label=5;case 5:return[2,e()]}})})},e.prototype.onAuthEvent=function(e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return"signInViaRedirect"===e.type?[2,t.prototype.onAuthEvent.call(this,e)]:"unknown"===e.type?(this.resolve(null),[2]):e.eventId?[4,this.auth._redirectUserForId(e.eventId)]:[3,2];case 1:if(n=r.sent())return this.user=n,[2,t.prototype.onAuthEvent.call(this,e)];this.resolve(null),r.label=2;case 2:return[2]}})})},e.prototype.onExecution=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2]})})},e.prototype.cleanUp=function(){},e}(In),kn="__/auth/handler",Nn="emulator/auth/handler";function Rn(t,e){return e?j(e):(M(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var On=function(){function t(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hn,this._completeRedirectFn=_n}return t.prototype._openPopup=function(t,e,n,r){var i;return o(this,void 0,void 0,function(){var s;return a(this,function(o){switch(o.label){case 0:return F(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),[4,this.originValidation(t)];case 1:return o.sent(),s=Pn(t,e,n,r),[2,vn(t,s,We())]}})})},t.prototype._openRedirect=function(t,e,n,r){return o(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,this.originValidation(t)];case 1:return i.sent(),s=Pn(t,e,n,r),Ce().location.href=s,[2,new Promise(function(){})]}var s})})},t.prototype._initialize=function(t){var e=t._key();if(this.eventManagers[e]){var n=this.eventManagers[e],r=n.manager,i=n.promise;return r?Promise.resolve(r):(F(i,"If manager is not set, promise should be"),i)}var s=this.initAndGetManager(t);return this.eventManagers[e]={promise:s},s},t.prototype.initAndGetManager=function(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:return[4,cn(t)];case 1:return e=r.sent(),n=new He(t),e.register("authEvent",function(e){return M(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,[2,n]}})})},t.prototype._isIframeWebStorageSupported=function(t,e){this.iframes[t._key()].send("webStorageSupport",{type:"webStorageSupport"},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&e(!!i),L(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)},t.prototype.originValidation=function(t){var e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=Ye(t)),this.originValidationPromises[e]},t}();function Pn(t,n,r,i){M(t.config.authDomain,t,"auth-domain-config-required"),M(t.config.apiKey,t,"invalid-api-key");var s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:H(),v:e.SDK_VERSION,eventId:i};if(n instanceof yt){n.setDefaultLanguage(t.languageCode),s.providerId=n.providerId||"",function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(n.getCustomParameters())||(s.customParameters=JSON.stringify(n.getCustomParameters()));var o=n.getScopes().filter(function(t){return""!==t});o.length>0&&(s.scopes=o.join(","))}t.tenantId&&(s.tid=t.tenantId);for(var a=0,u=Object.keys(s);a<u.length;a++){var c=u[a];void 0===s[c]&&delete s[c]}return new URL(function(t){var e=t.config;if(!e.emulator)return"https://"+e.authDomain+"/"+kn;return X(e,Nn)}(t)+"?"+m(s).slice(1)).toString()}var Cn=1e12,Dn=function(){function t(t){this.auth=t,this.counter=Cn,this._widgets=new Map}return t.prototype.render=function(t,e){var n=this.counter;return this._widgets.set(n,new Ln(t,this.auth.name,e||{})),this.counter++,n},t.prototype.reset=function(t){var e,n=t||Cn;null===(e=this._widgets.get(n))||void 0===e||e.delete(),this._widgets.delete(n)},t.prototype.getResponse=function(t){var e,n=t||Cn;return(null===(e=this._widgets.get(n))||void 0===e?void 0:e.getResponse())||""},t.prototype.execute=function(t){var e;return o(this,void 0,void 0,function(){var n;return a(this,function(r){return n=t||Cn,null===(e=this._widgets.get(n))||void 0===e||e.execute(),[2,""]})})},t}(),Ln=function(){function t(t,e,n){var r=this;this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){r.execute()};var i="string"==typeof t?document.getElementById(t):t;M(i,"argument-error",{appName:e}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return t.prototype.getResponse=function(){return this.checkIfDeleted(),this.responseToken},t.prototype.delete=function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)},t.prototype.execute=function(){var t=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(function(){t.responseToken=function(t){for(var e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}(50);var e=t.params,n=e.callback,r=e["expired-callback"];if(n)try{n(t.responseToken)}catch(t){}t.timerId=window.setTimeout(function(){if(t.timerId=null,t.responseToken=null,r)try{r()}catch(t){}t.isVisible&&t.execute()},6e4)},500))},t.prototype.checkIfDeleted=function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")},t}();var xn=Ze("rcb"),Un=new K(3e4,6e4),Mn=function(){function t(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Ce().grecaptcha}return t.prototype.load=function(t,e){var n=this;return void 0===e&&(e=""),M(function(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}(e),t,"argument-error"),this.shouldResolveImmediately(e)?Promise.resolve(Ce().grecaptcha):new Promise(function(r,i){var s=Ce().setTimeout(function(){i(x(t,"network-request-failed"))},Un.get());Ce()[xn]=function(){Ce().clearTimeout(s),delete Ce()[xn];var o=Ce().grecaptcha;if(o){var a=o.render;o.render=function(t,e){var r=a(t,e);return n.counter++,r},n.hostLanguage=e,r(o)}else i(x(t,"internal-error"))},Qe("https://www.google.com/recaptcha/api.js??"+m({onload:xn,render:"explicit",hl:e})).catch(function(){clearTimeout(s),i(x(t,"internal-error"))})})},t.prototype.clearedOneInstance=function(){this.counter--},t.prototype.shouldResolveImmediately=function(t){return!!Ce().grecaptcha&&(t===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)},t}();var Vn=function(){function t(){}return t.prototype.load=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,new Dn(t)]})})},t.prototype.clearedOneInstance=function(){},t}(),Fn="recaptcha",qn={theme:"light",type:"image"},jn=function(){function t(t,e,n){void 0===e&&(e=i({},qn)),this.parameters=e,this.type=Fn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Bt(n),this.isInvisible="invisible"===this.parameters.size,M("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var r="string"==typeof t?document.getElementById(t):t;M(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Vn:new Mn,this.validateStartingState()}return t.prototype.verify=function(){return o(this,void 0,void 0,function(){var t,e,n,r=this;return a(this,function(i){switch(i.label){case 0:return this.assertNotDestroyed(),[4,this.render()];case 1:return t=i.sent(),e=this.getAssertedRecaptcha(),(n=e.getResponse(t))?[2,n]:[2,new Promise(function(n){var i=function(t){t&&(r.tokenChangeListeners.delete(i),n(t))};r.tokenChangeListeners.add(i),r.isInvisible&&e.execute(t)})]}})})},t.prototype.render=function(){var t=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(function(e){throw t.renderPromise=null,e}),this.renderPromise)},t.prototype._reset=function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)},t.prototype.clear=function(){var t=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(function(e){t.container.removeChild(e)})},t.prototype.validateStartingState=function(){M(!this.parameters.sitekey,this.auth,"argument-error"),M(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error")},t.prototype.makeTokenCallback=function(t){var e=this;return function(n){if(e.tokenChangeListeners.forEach(function(t){return t(n)}),"function"==typeof t)t(n);else if("string"==typeof t){var r=Ce()[t];"function"==typeof r&&r(n)}}},t.prototype.assertNotDestroyed=function(){M(!this.destroyed,this.auth,"internal-error")},t.prototype.makeRenderPromise=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return[4,this.init()];case 1:return n.sent(),this.widgetId||(t=this.container,this.isInvisible||(e=document.createElement("div"),t.appendChild(e),t=e),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),[2,this.widgetId]}})})},t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return M(G()&&!De(),this.auth,"internal-error"),[4,(r=null,new Promise(function(t){"complete"!==document.readyState?(r=function(){return t()},window.addEventListener("load",r)):t()}).catch(function(t){throw r&&window.removeEventListener("load",r),t}))];case 1:return n.sent(),t=this,[4,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0)];case 2:return t.recaptcha=n.sent(),[4,function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,tt(t,"GET","/v1/recaptchaParams")];case 1:return[2,e.sent().recaptchaSiteKey||""]}})})}(this.auth)];case 3:return M(e=n.sent(),this.auth,"internal-error"),this.parameters.sitekey=e,[2]}var r})})},t.prototype.getAssertedRecaptcha=function(){return M(this.recaptcha,this.auth,"internal-error"),this.recaptcha},t}();var Bn=function(){function t(t,e){this.verificationId=t,this.onConfirmation=e}return t.prototype.confirm=function(t){var e=pt._fromVerification(this.verificationId,t);return this.onConfirmation(e)},t}();function $n(t,e,n){var r;return o(this,void 0,void 0,function(){var s,u,c,h;return a(this,function(l){switch(l.label){case 0:return[4,n.verify()];case 1:s=l.sent(),l.label=2;case 2:return l.trys.push([2,,10,11]),M("string"==typeof s,t,"argument-error"),M(n.type===Fn,t,"argument-error"),u=void 0,"session"in(u="string"==typeof e?{phoneNumber:e}:e)?(c=u.session,"phoneNumber"in u?(M("enroll"===c.type,t,"internal-error"),[4,function(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:start",i({tenantId:t.tenantId},e))}(t,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:s}})]):[3,4]):[3,7];case 3:return[2,l.sent().phoneSessionInfo.sessionInfo];case 4:return M("signin"===c.type,t,"internal-error"),M(h=(null===(r=u.multiFactorHint)||void 0===r?void 0:r.uid)||u.multiFactorUid,t,"missing-multi-factor-info"),[4,function(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:start",i({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:s}})];case 5:return[2,l.sent().phoneResponseInfo.sessionInfo];case 6:return[3,9];case 7:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:sendVerificationCode",e)]})})}(t,{phoneNumber:u.phoneNumber,recaptchaToken:s})];case 8:return[2,l.sent().sessionInfo];case 9:return[3,11];case 10:return n._reset(),[7];case 11:return[2]}})})}var Hn=function(){function t(e){this.providerId=t.PROVIDER_ID,this.auth=Bt(e)}return t.prototype.verifyPhoneNumber=function(t,e){return $n(this.auth,t,e)},t.credential=function(t,e){return pt._fromVerification(t,e)},t.credentialFromResult=function(t){var e=t;M(e._tokenResponse,e.user.auth,"argument-error");var n=e._tokenResponse,r=n.phoneNumber,i=n.temporaryProof;if(r&&i)return pt._fromTokenResponse(r,i);L(e.user.auth,"argument-error")},t.PROVIDER_ID="phone",t.PHONE_SIGN_IN_METHOD="phone",t}(),Gn=new K(2e3,1e4);var zn,Wn=function(t){function e(n,r,i,s,o){var a=t.call(this,n,r,s,o)||this;return a.provider=i,a.authWindow=null,a.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=a,a}return r(e,t),e.prototype.executeNotNull=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.execute()];case 1:return M(t=e.sent(),this.auth,"internal-error"),[2,t]}})})},e.prototype.onExecution=function(){return o(this,void 0,void 0,function(){var t,e,n=this;return a(this,function(r){switch(r.label){case 0:return F(1===this.filter.length,"Popup operations only handle one event"),t=We(),e=this,[4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t)];case 1:return e.authWindow=r.sent(),this.authWindow.associatedEvent=t,this.resolver._isIframeWebStorageSupported(this.auth,function(t){t||n.reject(x(n.auth,"web-storage-unsupported"))}),this.pollUserCancellation(),[2]}})})},Object.defineProperty(e.prototype,"eventId",{get:function(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.reject(x(this.auth,"cancelled-popup-request"))},e.prototype.cleanUp=function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null},e.prototype.pollUserCancellation=function(){var t=this,e=function(){var n,r;null!==(r=null===(n=t.authWindow)||void 0===n?void 0:n.window)&&void 0!==r&&r.closed?t.pollId=window.setTimeout(function(){t.pollId=null,t.reject(x(t.auth,"popup-closed-by-user"))},2e3):t.pollId=window.setTimeout(e,Gn.get())};e()},e.currentPopupAction=null,e}(In),Kn=function(t){function e(e){var n=t.call(this,"phone")||this;return n.credential=e,n}return r(e,t),e._fromCredential=function(t){return new e(t)},e.prototype._finalizeEnroll=function(t,e,n){return function(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:finalize",i({tenantId:t.tenantId},e))}(t,{idToken:e,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})},e.prototype._finalizeSignIn=function(t,e){return function(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:finalize",i({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:e,phoneVerificationInfo:this.credential._makeVerificationRequest()})},e}(function(){function t(t){this.factorId=t}return t.prototype._process=function(t,e,n){switch(e.type){case"enroll":return this._finalizeEnroll(t,e.credential,n);case"signin":return this._finalizeSignIn(t,e.credential);default:return V("unexpected MultiFactorSessionType")}},t}()),Xn=function(){function t(){}return t.assertion=function(t){return Kn._fromCredential(t)},t}();zn="Browser",e._registerComponent(new k("auth-exp",function(t){var e=t.getProvider("app-exp").getImmediate(),n=e.options,r=n.apiKey,i=n.authDomain;return function(t){M(r,"invalid-api-key",{appName:t.name});var e={apiKey:r,authDomain:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ae(zn)};return new jt(t,e)}(e)},"PUBLIC")),e._registerComponent(new k("auth-internal",function(t){return function(t){return new ke(t)}(Bt(t.getProvider("auth-exp").getImmediate()))},"PRIVATE")),e.registerVersion("auth-exp",ge,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";default:return}}(zn)),t.ActionCodeURL=mt,t.AuthCredential=$,t.EmailAuthCredential=ct,t.EmailAuthProvider=vt,t.FacebookAuthProvider=wt,t.GithubAuthProvider=Et,t.GoogleAuthProvider=bt,t.OAuthCredential=ft,t.OAuthProvider=yt,t.PhoneAuthCredential=pt,t.PhoneAuthProvider=Hn,t.PhoneMultiFactorGenerator=Xn,t.RecaptchaVerifier=jn,t.TwitterAuthProvider=It,t.applyActionCode=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}(t,{oobCode:e})];case 1:return n.sent(),[2]}})})},t.browserLocalPersistence=Re,t.browserPopupRedirectResolver=On,t.browserSessionPersistence=hn,t.checkActionCode=re,t.confirmPasswordReset=function(t,e,n){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,ot(t,{oobCode:e,newPassword:n})];case 1:return r.sent(),[2]}})})},t.createUserWithEmailAndPassword=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return r=Bt(t),[4,_t(t,{returnSecureToken:!0,email:e,password:n})];case 1:return i=o.sent(),[4,Mt._fromIdTokenResponse(r,"signIn",i)];case 2:return s=o.sent(),[4,r._updateCurrentUser(s.user)];case 3:return o.sent(),[2,s]}})})},t.debugErrorMap=R,t.deleteUser=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,t.delete()]})})},t.fetchSignInMethodsForEmail=function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=G()?H():"http://localhost",[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:createAuthUri",e)]})})}(t,{identifier:e,continueUri:n})];case 1:return[2,r.sent().signinMethods||[]]}})})},t.getAdditionalUserInfo=function(t){var e=t,n=e.user,r=e._tokenResponse;return n.isAnonymous&&!r?{providerId:null,isNewUser:!1,profile:null}:function(t){var e,n;if(!t)return null;var r=t.providerId,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||"identitytoolkit#SignupNewUserResponse"===t.kind;if(!r&&(null==t?void 0:t.idToken)){var o=null===(n=null===(e=Nt(t.idToken))||void 0===e?void 0:e.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new se(s,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new ae(s,i);case"github.com":return new ue(s,i);case"google.com":return new ce(s,i);case"twitter.com":return new he(s,i,t.screenName||null);case"custom":case"anonymous":return new se(s,null);default:return new se(s,r,i)}}(r)},t.getAuth=function(t){return B(t,{popupRedirectResolver:On,persistence:[$e,Re]})},t.getIdToken=function(t,e){return void 0===e&&(e=!1),t.getIdToken(e)},t.getIdTokenResult=At,t.getMultiFactorResolver=function(t,e){var n,r=e;return M(e.operationType,t,"argument-error"),M(null===(n=r.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,t,"argument-error"),fe._fromError(t,r)},t.getRedirectResult=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Bt(t)._initializationPromise];case 1:return n.sent(),[2,_n(t,e,!1)]}})})},t.inMemoryPersistence=gt,t.indexedDBLocalPersistence=$e,t.initializeAuth=B,t.isSignInWithEmailLink=function(t,e){var n=mt.parseLink(e);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)},t.linkWithCredential=Qt,t.linkWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){switch(s.label){case 0:return[4,Kt(!1,r=t,"phone")];case 1:return s.sent(),[4,$n(r.auth,e,n)];case 2:return i=s.sent(),[2,new Bn(i,function(e){return Qt(t,e)})]}})})},t.linkWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return M(e instanceof yt,(r=t).auth,"argument-error"),i=Rn(r.auth,n),[2,new Wn(r.auth,"linkViaPopup",e,i,r).executeNotNull()]})})},t.linkWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return M(e instanceof yt,(r=t).auth,"argument-error"),i=Rn(r.auth,n),[4,Kt(!1,r,e.providerId)];case 1:return o.sent(),[4,Tn(r)];case 2:return s=o.sent(),[2,i._openRedirect(r.auth,e,"linkViaRedirect",s)]}})})},t.multiFactor=function(t){return pe.has(t)||pe.set(t,de._fromUser(t)),pe.get(t)},t.onAuthStateChanged=function(t,e,n,r){return t.onAuthStateChanged(e,n,r)},t.onIdTokenChanged=function(t,e,n,r){return t.onIdTokenChanged(e,n,r)},t.parseActionCodeURL=function(t){return mt.parseLink(t)},t.prodErrorMap=O,t.reauthenticateWithCredential=Zt,t.reauthenticateWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return[4,$n(t.auth,e,n)];case 1:return r=i.sent(),[2,new Bn(r,function(e){return Zt(t,e)})]}})})},t.reauthenticateWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return M(e instanceof yt,(r=t).auth,"argument-error"),i=Rn(r.auth,n),[2,new Wn(r.auth,"reauthViaPopup",e,i,r).executeNotNull()]})})},t.reauthenticateWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return M(e instanceof yt,(r=t).auth,"argument-error"),i=Rn(r.auth,n),[4,Tn(r)];case 1:return s=o.sent(),[2,i._openRedirect(r.auth,e,"reauthViaRedirect",s)]}})})},t.reload=Dt,t.sendEmailVerification=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=t,[4,t.getIdToken()];case 1:return r=s.sent(),i={requestType:"VERIFY_EMAIL",idToken:r},e&&ne(n.auth,i,e),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(n.auth,i)];case 2:return s.sent().email===t.email?[3,4]:[4,t.reload()];case 3:s.sent(),s.label=4;case 4:return[2]}})})},t.sendPasswordResetEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return r={requestType:"PASSWORD_RESET",email:e},n&&ne(t,r,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(t,r)];case 1:return i.sent(),[2]}})})},t.sendSignInLinkToEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return r={requestType:"EMAIL_SIGNIN",email:e},M(null==n?void 0:n.handleCodeInApp,t,"argument-error"),n&&ne(t,r,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(t,r)];case 1:return i.sent(),[2]}})})},t.setPersistence=function(t,e){t.setPersistence(e)},t.signInAnonymously=function(t){var e;return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=Bt(t),(null===(e=n.currentUser)||void 0===e?void 0:e.isAnonymous)?[2,new Mt({user:n.currentUser,providerId:null,operationType:"signIn"})]:[4,_t(n,{returnSecureToken:!0})];case 1:return r=s.sent(),[4,Mt._fromIdTokenResponse(n,"signIn",r,!0)];case 2:return i=s.sent(),[4,n._updateCurrentUser(i.user)];case 3:return s.sent(),[2,i]}})})},t.signInWithCredential=Jt,t.signInWithCustomToken=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithCustomToken",e)]})})}(t,{token:e,returnSecureToken:!0})];case 1:return n=s.sent(),r=Bt(t),[4,Mt._fromIdTokenResponse(r,"signIn",n)];case 2:return i=s.sent(),[4,r._updateCurrentUser(i.user)];case 3:return s.sent(),[2,i]}})})},t.signInWithEmailAndPassword=function(t,e,n){return Jt(t,vt.credential(e,n))},t.signInWithEmailLink=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){return M((r=vt.credentialWithLink(e,n||H())).tenantId===(t.tenantId||null),t,"tenant-id-mismatch"),[2,Jt(t,r)]})})},t.signInWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return[4,$n(Bt(t),e,n)];case 1:return r=i.sent(),[2,new Bn(r,function(e){return Jt(t,e)})]}})})},t.signInWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return r=Bt(t),M(e instanceof yt,t,"argument-error"),i=Rn(r,n),[2,new Wn(r,"signInViaPopup",e,i).executeNotNull()]})})},t.signInWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){return r=Bt(t),M(e instanceof yt,t,"argument-error"),[2,Rn(r,n)._openRedirect(r,e,"signInViaRedirect")]})})},t.signOut=function(t){return t.signOut()},t.unlink=function(t,e){return o(this,void 0,void 0,function(){var n,r,i,s,o,u;return a(this,function(a){switch(a.label){case 0:return[4,Kt(!0,n=t,e)];case 1:return a.sent(),i=Tt,s=[n.auth],u={},[4,t.getIdToken()];case 2:return[4,i.apply(void 0,s.concat([(u.idToken=a.sent(),u.deleteProvider=[e],u)]))];case 3:return r=a.sent().providerUserInfo,o=zt(r||[]),n.providerData=t.providerData.filter(function(t){return o.has(t.providerId)}),o.has("phone")||(n.phoneNumber=null),[4,n.auth._persistUserIfCurrent(n)];case 4:return a.sent(),[2,t]}})})},t.updateCurrentUser=function(t,e){return t.updateCurrentUser(e)},t.updateEmail=function(t,e){return ie(t,e,null)},t.updatePassword=function(t,e){return ie(t,null,e)},t.updatePhoneNumber=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Wt(t,e)];case 1:return n.sent(),[2]}})})},t.updateProfile=function(t,e){var n=e.displayName,r=e.photoURL;return o(this,void 0,void 0,function(){var e,i,s,u,c;return a(this,function(h){switch(h.label){case 0:return void 0===n&&void 0===r?[2]:(e=t,[4,t.getIdToken()]);case 1:return i=h.sent(),s={idToken:i,displayName:n,photoUrl:r,returnSecureToken:!0},[4,Rt(e,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}(e.auth,s))];case 2:return u=h.sent(),e.displayName=u.displayName||null,e.photoURL=u.photoUrl||null,(c=e.providerData.find(function(t){return"password"===t.providerId}))&&(c.displayName=t.displayName,c.photoURL=t.photoURL),[4,e._updateTokensIfNecessary(u)];case 3:return h.sent(),[2]}})})},t.useDeviceLanguage=function(t){t.useDeviceLanguage()},t.verifyBeforeUpdateEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(u){switch(u.label){case 0:return r=t,[4,t.getIdToken()];case 1:return i=u.sent(),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:e},n&&ne(r.auth,s,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(r.auth,s)];case 2:return u.sent().email===t.email?[3,4]:[4,t.reload()];case 3:u.sent(),u.label=4;case 4:return[2]}})})},t.verifyPasswordResetCode=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,re(t,e)];case 1:return[2,n.sent().data.email]}})})},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-auth.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.functions=t.firebase.functions||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var o="FirebaseError",a=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=o,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,u.prototype.create),s}return r(e,t),e}(Error),u=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",u=this.serviceName+": "+o+" ("+i+").";return new a(i,u,r)},t}();var c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),l="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";function d(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function p(t){if(null==t)return t;if(t["@type"])switch(t["@type"]){case l:case f:var e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return p(t)}):"function"==typeof t||"object"==typeof t?d(t,function(t){return p(t)}):t}var g="functions",m={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},v=function(t){function e(e,n,r){var i=t.call(this,g+"/"+e,n||"")||this;return i.details=r,i}return r(e,t),e}(a);var y=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return i(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return[2,null==(t=e.sent())?void 0:t.accessToken];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getMessagingToken=function(){return i(this,void 0,void 0,function(){return s(this,function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]})})},t.prototype.getContext=function(){return i(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getMessagingToken()];case 2:return e=n.sent(),[2,{authToken:t,messagingToken:e}]}})})},t}(),w="us-central1";var b=function(){function t(t,e,n,r,i){var s=this;void 0===r&&(r=w),this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new y(e,n),this.cancelAllRequests=new Promise(function(t){s.deleteService=function(){return Promise.resolve(t())}});try{var o=new URL(r);this.customDomain=o.origin,this.region=w}catch(t){this.customDomain=null,this.region=r}}return t.prototype._delete=function(){return this.deleteService()},t.prototype._url=function(t){var e=this.app.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t}();function E(t,e,n){return function(r){return function(t,e,n,r){return i(this,void 0,void 0,function(){var o,a,u,c,h,l,f,g;return s(this,function(y){switch(y.label){case 0:return o=t._url(e),n=function t(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t(e)});if("function"==typeof e||"object"==typeof e)return d(e,function(e){return t(e)});throw new Error("Data cannot be encoded in JSON: "+e)}(n),a={data:n},u={},[4,t.contextProvider.getContext()];case 1:return(c=y.sent()).authToken&&(u.Authorization="Bearer "+c.authToken),c.messagingToken&&(u["Firebase-Instance-ID-Token"]=c.messagingToken),h=r.timeout||7e4,[4,Promise.race([function(t,e,n,r){return i(this,void 0,void 0,function(){var i,o;return s(this,function(s){switch(s.label){case 0:n["Content-Type"]="application/json",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return i=s.sent(),[3,4];case 3:return s.sent(),[2,{status:0,json:null}];case 4:o=null,s.label=5;case 5:return s.trys.push([5,7,,8]),[4,i.json()];case 6:return o=s.sent(),[3,8];case 7:return s.sent(),[3,8];case 8:return[2,{status:i.status,json:o}]}})})}(o,a,u,t.fetchImpl),(w=h,new Promise(function(t,e){setTimeout(function(){e(new v("deadline-exceeded","deadline-exceeded"))},w)})),t.cancelAllRequests])];case 2:if(!(l=y.sent()))throw new v("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e){var n=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=n,i=void 0;try{var s=e&&e.error;if(s){var o=s.status;if("string"==typeof o){if(!m[o])return new v("internal","internal");n=m[o],r=o}var a=s.message;"string"==typeof a&&(r=a),void 0!==(i=s.details)&&(i=p(i))}}catch(t){}return"ok"===n?null:new v(n,r,i)}(l.status,l.json))throw f;if(!l.json)throw new v("internal","Response is not valid JSON object.");if(void 0===(g=l.json.data)&&(g=l.json.result),void 0===g)throw new v("internal","Response is missing data field.");return[2,{data:p(g)}]}var w})})}(t,e,r,n||{})}}var I;I=fetch.bind(self),e._registerComponent(new h(g,function(t,e){var n=t.getProvider("app-exp").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new b(n,r,i,e,I)},"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/functions-exp","0.0.900"),t.getFunctions=function(t,n){return void 0===n&&(n=w),e._getProvider(t,g).getImmediate({identifier:n})},t.httpsCallable=function(t,e,n){return E(t,e,n)},t.useFunctionsEmulator=function(t,e,n){!function(t,e,n){t.emulatorOrigin="http://"+e+":"+n}(t,e,n)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-functions.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.firestore=t.firebase.firestore||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var i="FirebaseError",s=function(t){function e(n,r,s){var a=t.call(this,r)||this;return a.code=n,a.customData=s,a.name=i,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,o.prototype.create),a}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",u=this.serviceName+": "+a+" ("+i+").";return new s(i,u,r)},t}();var a,u,c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(u||(u={}));var f={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},d=u.INFO,p=((a={})[u.DEBUG]="log",a[u.VERBOSE]="log",a[u.INFO]="info",a[u.WARN]="warn",a[u.ERROR]="error",a),g=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=p[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,l(["["+i+"]  "+t.name+":"],n))}},m=function(){function t(t){this.name=t,this._logLevel=d,this._logHandler=g,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?f[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.DEBUG],t)),this._logHandler.apply(this,l([this,u.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.VERBOSE],t)),this._logHandler.apply(this,l([this,u.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.INFO],t)),this._logHandler.apply(this,l([this,u.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.WARN],t)),this._logHandler.apply(this,l([this,u.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.ERROR],t)),this._logHandler.apply(this,l([this,u.ERROR],t))},t}(),v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function y(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var w,b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E=E||{},I=b||self;function _(){}function T(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var A="closure_uid_"+(1e9*Math.random()>>>0),k=0;function N(t,e,n){return t.call.apply(t.bind,arguments)}function R(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function O(t,e,n){return(O=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?N:R).apply(null,arguments)}function P(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function C(){return Date.now()}function D(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function L(){this.j=this.j,this.i=this.i}L.prototype.j=!1,L.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,A)&&t[A]||(t[A]=++k)})(this)},L.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,s=0;s<r;s++)s in i&&e.call(n,i[s],s,t)};function M(t){return Array.prototype.concat.apply([],arguments)}function V(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function F(t){return/^[\s\xa0]*$/.test(t)}var q,j=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function B(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:t>e?1:0}t:{var H=I.navigator;if(H){var G=H.userAgent;if(G){q=G;break t}}q=""}function z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function W(t){var e={};for(var n in t)e[n]=t[n];return e}var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var s=0;s<K.length;s++)n=K[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Y(t){return Y[" "](t),t}Y[" "]=_;var J,Q,Z=B(q,"Opera"),tt=B(q,"Trident")||B(q,"MSIE"),et=B(q,"Edge"),nt=et||tt,rt=B(q,"Gecko")&&!(B(q.toLowerCase(),"webkit")&&!B(q,"Edge"))&&!(B(q,"Trident")||B(q,"MSIE"))&&!B(q,"Edge"),it=B(q.toLowerCase(),"webkit")&&!B(q,"Edge");function st(){var t=I.document;return t?t.documentMode:void 0}t:{var ot="",at=(Q=q,rt?/rv:([^\);]+)(\)|;)/.exec(Q):et?/Edge\/([\d\.]+)/.exec(Q):tt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Q):it?/WebKit\/(\S+)/.exec(Q):Z?/(?:Version)[ \/]?(\S+)/.exec(Q):void 0);if(at&&(ot=at?at[1]:""),tt){var ut=st();if(null!=ut&&ut>parseFloat(ot)){J=String(ut);break t}}J=ot}var ct,ht={};function lt(t){return function(t,e){var n=ht;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=j(String(J)).split("."),r=j(String(t)).split("."),i=Math.max(n.length,r.length),s=0;0==e&&s<i;s++){var o=n[s]||"",a=r[s]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=$(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||$(0==o[2].length,0==a[2].length)||$(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e})}if(I.document&&tt){var ft=st();ct=ft||(parseInt(J,10)||void 0)}else ct=void 0;var dt=ct,pt=!tt||9<=Number(dt),gt=tt&&!lt("9"),mt=function(){if(!I.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{I.addEventListener("test",_,e),I.removeEventListener("test",_,e)}catch(t){}return t}();function vt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(vt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(rt){t:{try{Y(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:wt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}vt.prototype.b=function(){this.defaultPrevented=!0},D(yt,vt);var wt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var bt="closure_listenable_"+(1e6*Math.random()|0),Et=0;function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],s=x(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(It(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function St(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.Y&&s.listener==e&&s.capture==!!n&&s.ca==r)return i}return-1}_t.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.a[s])||(t=this.a[s]=[],this.b++);var o=St(t,e,r,i);return-1<o?(e=t[o],n||(e.Z=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}(e,this.src,s,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),kt={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,s){if(Array.isArray(n)){for(var o=0;o<n.length;o++)t(e,n[o],r,i,s);return null}r=Ut(r);return e&&e[bt]?e.wa(n,r,S(i)?!!i.capture:!!i,s):Rt(e,n,r,!0,i,s)}(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Nt(t,e[s],n,r,i);return null}return n=Ut(n),t&&t[bt]?t.va(e,n,S(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=S(i)?!!i.capture:!!i;if(o&&!pt)return null;var a=Lt(t);if(a||(t[At]=a=new _t(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){var t=Dt,e=pt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)mt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[bt])Tt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):It(t)}}}function Pt(t){return t in kt?kt[t]:kt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Dt(t,e){if(t.Y)return!0;if(!pt){if(!e)t:{e=["window","event"];for(var n=I,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new yt(e,this))}return Ct(t,new yt(e,this))}function Lt(t){return(t=t[At])instanceof _t?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(t){return"function"==typeof t?t:(t[xt]||(t[xt]=function(e){return t.handleEvent(e)}),t[xt])}function Mt(){L.call(this),this.c=new _t(this),this.J=this,this.C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new vt(e,t);else if(e instanceof vt)e.target=e.target||t;else{var i=e;X(e=new vt(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.a=n[s];i=Ft(o,r,!0,e)&&i}if(i=Ft(o=e.a=t,r,!0,e)&&i,i=Ft(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Ft(o=e.a=n[s],r,!1,e)&&i}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.Y&&o.capture==n){var a=o.listener,u=o.ca||o.src;o.Z&&Tt(t.c,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}D(Mt,L),Mt.prototype[bt]=!0,(w=Mt.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},w.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)t(e,n[o],r,i,s);else i=S(i)?!!i.capture:!!i,r=Ut(r),e&&e[bt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(o=e.a[n],r,i,s))&&(It(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete e.a[n],e.b--))):e&&(e=Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,s)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},w.G=function(){if(Mt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},w.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},w.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=I.JSON.stringify;function jt(){this.b=this.a=null}var Bt,$t=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Gt},function(t){t.reset()});function Ht(){var t=Xt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Gt(){this.next=this.b=this.a=null}function zt(t){I.setTimeout(function(){throw t},0)}function Wt(t,e){Bt||function(){var t=I.Promise.resolve(void 0);Bt=function(){t.then(Yt)}}(),Kt||(Bt(),Kt=!0),Xt.add(t,e)}jt.prototype.add=function(t,e){var n=$t.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Gt.prototype.reset=function(){this.next=this.b=this.a=null};var Kt=!1,Xt=new jt;function Yt(){for(var t;t=Ht();){try{t.a.call(t.b)}catch(t){zt(t)}var e=$t;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Kt=!1}function Jt(t,e){Mt.call(this),this.b=t||1,this.a=e||I,this.f=O(this.Za,this),this.g=C()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==typeof t)n&&(t=O(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=O(t.handleEvent,t)}return 2147483647<Number(e)?-1:I.setTimeout(t,e||0)}D(Jt,Mt),(w=Jt.prototype).aa=!1,w.M=null,w.Za=function(){if(this.aa){var t=C()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Qt(this),this.start()))}},w.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=C())},w.G=function(){Jt.X.G.call(this),Qt(this),delete this.a};var te=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(I.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(L);function ee(t){L.call(this),this.b=t,this.a={}}D(ee,L);var ne=[];function re(t,e,n,r){Array.isArray(n)||(n&&(ne[0]=n.toString()),n=ne);for(var i=0;i<n.length;i++){var s=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!s)break;t.a[s.key]=s}}function ie(t){z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function se(){this.a=!0}function oe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ee.prototype.G=function(){ee.X.G.call(this),ie(this)},ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ue=null;function ce(){return ue=ue||new Mt}function he(t){vt.call(this,ae.Fa,t)}function le(t){var e=ce();Vt(e,new he(e,t))}function fe(t,e){vt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=ce();Vt(e,new fe(e,t))}function pe(t){vt.call(this,ae.Ga,t)}function ge(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return I.setTimeout(function(){t()},e)}ae.Fa="serverreachability",D(he,vt),ae.STAT_EVENT="statevent",D(fe,vt),ae.Ga="timingevent",D(pe,vt);var me={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ve={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ye(){}function we(t){var e;return(e=t.a)||(e=t.a={}),e}function be(){}ye.prototype.a=null;var Ee,Ie={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function _e(){vt.call(this,"d")}function Te(){vt.call(this,"c")}function Se(){}function Ae(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ee(this),this.P=ke,t=nt?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}D(_e,vt),D(Te,vt),D(Se,ye),Ee=new Se;var ke=45e3,Ne={},Re={};function Oe(t,e,n){t.H=1,t.i=Qe(ze(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=C(),Le(t),t.l=ze(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=sr(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(O(t.Ca,t,t.a),t.O)),re(t.J,t.a,"readystatechange",t.Xa),e=t.B?W(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(1),function(t,e,n,r,i,s){t.info(function(){if(t.a)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+c+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ce(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=De(t,n);if(i==Re){4==e&&(t.h=4,de(14),r=!1),oe(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ne){t.h=4,de(15),oe(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}oe(t.c,t.f,i,null),Fe(t,i)}4==e&&0==n.length&&(t.h=1,de(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(e),e.F=!0,de(11))):(oe(t.c,t.f,n,"[Invalid Chunked Response]"),Ve(t),Me(t))}function De(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Re:(n=Number(e.substring(n,r)),isNaN(n)?Ne:(r+=1)+n>e.length?Re:(e=e.substr(r,n),t.D=r+n,e))}function Le(t){t.T=C()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ge(O(t.Va,t),e)}function Ue(t){t.o&&(I.clearTimeout(t.o),t.o=null)}function Me(t){0==t.g.v||t.A||tr(t.g,t)}function Ve(t){Ue(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),ie(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||wn(n.b,t)))if(n.I=t.N,!t.C&&wn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Zn(n),Bn(n)}Yn(n),de(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ge(O(n.Sa,n),6e3));if(1>=yn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else nr(n,11)}else if((t.C||n.a==t)&&Zn(n),!F(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var s=i[3];null!=s&&(n.ha=s,n.c.info("VER="+n.ha));var o=i[4];null!=o&&(n.pa=o,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(B(h,"spdy")||B(h,"quic")||B(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(bn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Je(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=C()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=ir(u,u.C?u.ga:null,u.fa),d.C){En(u.b,d);var p=d,g=u.D;g&&p.setTimeout(g),p.o&&(Ue(p),Le(p)),u.a=d}else Xn(u);0<n.g.length&&Gn(n)}else"stop"!=i[0]&&"close"!=i[0]||nr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?nr(n,7):jn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);le(4)}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(T(t)||"string"==typeof t)U(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(T(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(T(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}}function je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)$e(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(w=Ae.prototype).setTimeout=function(t){this.P=t},w.Xa=function(t){t=t.target;var e=this.F;e&&3==Mn(t)?e.f():this.Ca(t)},w.Ca=function(t){try{if(t==this.a)t:{var e=Mn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!nt&&!this.a.$())){this.A||4!=e||7==n||le(8==n||0>=r?3:2),Ue(this);var i=this.a.W();this.N=i;var s=this.a.$();if(this.b=200==i,function(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var o,a=this.a;if((o=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,de(12),Ve(this),Me(this);break t}oe(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,u)}this.I?(Ce(this,e,s),nt&&this.b&&3==e&&(re(this.J,this.R,"tick",this.Wa),this.R.start())):(oe(this.c,this.f,s,null),Fe(this,s)),4==e&&Ve(this),this.b&&!this.A&&(4==e?tr(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Ve(this),Me(this)}}}catch(t){}},w.Wa=function(){if(this.a){var t=Mn(this.a),e=this.a.$();this.D<e.length&&(Ue(this),Ce(this,t,e),this.b&&4!=t&&Le(this))}},w.cancel=function(){this.A=!0,Ve(this)},w.Va=function(){this.o=null;var t=C();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(le(3),de(17)),Ve(this),this.h=2,Me(this)):xe(this,this.T-t)},(w=je.prototype).K=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},w.L=function(){return Be(this),this.a.concat()},w.get=function(t,e){return $e(this.b,t)?this.b[t]:e},w.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},w.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);t.call(e,s,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ge(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ge){this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Ke(this,t.c),Xe(this,t.h),this.g=t.g,e=t.b;var n=new un;n.c=e.c,e.a&&(n.a=new je(e.a),n.b=e.b),Ye(this,n),this.i=t.i}else t&&(n=String(t).match(He))?(this.a=!!e,We(this,n[1]||"",!0),this.j=Ze(n[2]||""),Ke(this,n[3]||"",!0),Xe(this,n[4]),this.g=Ze(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new Ge(t)}function We(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?Ze(e,!0):e}function Xe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){e instanceof un?(t.b=e,function(t,e){e&&!t.f&&(cn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),fn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=tn(e,on)),t.b=new un(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Qe(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^C()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function tn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,en),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function en(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ge.prototype.toString=function(){var t=[],e=this.f;e&&t.push(tn(e,nn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(tn(e,nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(tn(n,"/"==n.charAt(0)?sn:rn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",tn(n,an)),t.join("")};var nn=/[#\/\?@]/g,rn=/[#\?:]/g,sn=/[#\?]/g,on=/[#\?@]/g,an=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(t){t.a||(t.a=new je,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function hn(t,e){cn(t),e=dn(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$e((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function ln(t,e){return cn(t),e=dn(t,e),$e(t.a.b,e)}function fn(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),V(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(w=un.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},w.forEach=function(t,e){cn(this),this.a.forEach(function(n,r){U(n,function(n){t.call(e,n,r,this)},this)},this)},w.L=function(){cn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],s=0;s<i.length;s++)n.push(e[r]);return n},w.K=function(t){cn(this);var e=[];if("string"==typeof t)ln(this,t)&&(e=M(e,this.a.get(dn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=M(e,t[n])}return e},w.set=function(t,e){return cn(this),this.c=null,ln(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},w.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},w.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),t.push(o)}}return this.c=t.join("&")};var pn=function(){return function(t,e){this.b=t,this.a=e}}();function gn(t){this.g=t||mn,I.PerformanceNavigationTiming?t=0<(t=I.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(I.ia&&I.ia.ya&&I.ia.ya()&&I.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var mn=10;function vn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function yn(t){return t.b?1:t.a?t.a.size:0}function wn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function bn(t,e){t.a?t.a.add(e):t.b=e}function En(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=y(t.a.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.s)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return V(t.c)}function _n(){}function Tn(t,e,n){var r=n||"";try{qe(t,function(t,n){var i=t;S(t)&&(i=qt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=y(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return I.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return I.JSON.parse(t,void 0)};var An=I.JSON.parse;function kn(t){Mt.call(this),this.headers=new je,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Nn,this.D=this.F=!1}D(kn,Mt);var Nn="",Rn=/^https?$/i,On=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Dn(t),xn(t)}function Dn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Ln(t){if(t.b&&void 0!==E&&(!t.s[1]||4!=Mn(t)||2!=t.W()))if(t.l&&4==Mn(t))Zt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Mn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.B).match(He)[1]||null;if(!s&&I.self&&I.self.location){var o=I.self.location.protocol;s=o.substr(0,o.length-1)}i=!Rn.test(s?s.toLowerCase():"")}e=i}if(e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var a=2<Mn(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Dn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?_:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(I.clearTimeout(t.m),t.m=null)}function Mn(t){return t.a?t.a.readyState:0}function Vn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return z(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Fn("baseRetryDelayMs",5e3,t),this.Ra=Fn("retryDelaySeedMs",1e4,t),this.Ma=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new function(){this.a=new _n},this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function jn(t){if($n(t),3==t.v){var e=t.R++,n=ze(t.B);Je(n,"SID",t.J),Je(n,"RID",e),Je(n,"TYPE","terminate"),Wn(t,n),(e=new Ae(t,t.c,e,void 0)).H=2,e.i=Qe(ze(n)),n=!1,I.navigator&&I.navigator.sendBeacon&&(n=I.navigator.sendBeacon(e.i.toString(),"")),!n&&I.Image&&((new Image).src=e.i,n=!0),n||(e.a=sr(e.g,null),e.a.ba(e.i)),e.u=C(),Le(e)}rr(t)}function Bn(t){t.a&&(Jn(t),t.a.cancel(),t.a=null)}function $n(t){Bn(t),t.j&&(I.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&I.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){vn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function zn(t,e){var n;n=e?e.f:t.R++;var r=ze(t.B);Je(r,"SID",t.J),Je(r,"RID",n),Je(r,"AID",t.P),Wn(t,r),t.i&&t.l&&Vn(r,t.i,t.l),n=new Ae(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),bn(t.b,n),Oe(n,r,e)}function Wn(t,e){t.f&&qe({},function(t,n){Je(e,n,t)})}function Kn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?O(t.f.Ja,t.f,t):null;t:for(var i=t.g,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].b,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=s))s=Math.max(0,i[u].b-100),a=!1;else try{Tn(h,o,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=o.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Xn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function Yn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ge(O(t.Aa,t),er(t,t.o)),t.o++,!0)}function Jn(t){null!=t.s&&(I.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Ae(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);Je(e,"RID","rpc"),Je(e,"SID",t.J),Je(e,"CI",t.H?"0":"1"),Je(e,"AID",t.P),Wn(t,e),Je(e,"TYPE","xmlhttp"),t.i&&t.l&&Vn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(ze(e)),n.j=null,n.I=!0,Pe(n,t)}function Zn(t){null!=t.m&&(I.clearTimeout(t.m),t.m=null)}function tr(t,e){var n=null;if(t.a==e){Zn(t),Jn(t),t.a=null;var r=2}else{if(!wn(t.b,e))return;n=e.s,En(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=C()-e.u;var i=t.u;Vt(r=ce(),new pe(r,n,e,i)),Gn(t)}else Xn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(yn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ge(O(t.Ba,t,e),er(t,t.u)),t.u++,0)))}(t,e)||2==r&&Yn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:nr(t,5);break;case 4:nr(t,10);break;case 3:nr(t,6);break;default:nr(t,2)}}function er(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function nr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=O(t.Ya,t);n||(n=new Ge("//www.google.com/images/cleardot.gif"),I.location&&"http"==I.location.protocol||We(n,"https"),Qe(n)),function(t,e){var n=new se;if(I.Image){var r=new Image;r.onload=P(Sn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=P(Sn,n,r,"TestLoadImage: error",!1,e),r.onabort=P(Sn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=P(Sn,n,r,"TestLoadImage: timeout",!1,e),I.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else de(2);t.v=0,t.f&&t.f.ra(e),rr(t),$n(t)}function rr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,V(t.g),t.g.length=0),t.f.qa())}function ir(t,e,n){var r=function(t){return t instanceof Ge?ze(t):new Ge(t,void 0)}(n);if(""!=r.c)e&&Ke(r,e+"."+r.c),Xe(r,r.h);else{var i=I.location;r=function(t,e,n,r){var i=new Ge(null,void 0);return t&&We(i,t),e&&Ke(i,e),n&&Xe(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&z(t.V,function(t,e){Je(r,e,t)}),e=t.A,n=t.na,e&&n&&Je(r,e,n),Je(r,"VER",t.ha),Wn(t,r),r}function sr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function or(){}function ar(){if(tt&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Mt.call(this),this.a=new qn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!F(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!F(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new lr(this)}function cr(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Te.call(this),this.status=1}function lr(t){this.a=t}(w=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?we(this.H):we(Ee),this.a.onreadystatechange=O(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Cn(this,t)}t=n||"";var i=new je(this.headers);r&&qe(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=I.FormData&&t instanceof I.FormData,!(0<=x(On,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=function(t){return tt&&lt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=O(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},w.xa=function(){void 0!==E&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},w.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),xn(this))},w.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),kn.X.G.call(this)},w.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Ua())},w.Ua=function(){Ln(this)},w.W=function(){try{return 2<Mn(this)?this.a.status:-1}catch(t){return-1}},w.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},w.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},w.ua=function(){return this.h},w.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(w=qn.prototype).ha=8,w.v=1,w.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ae(this,this.c,t,void 0),r=this.l;if(this.O&&(r?X(r=W(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var s=this.g[i];if(void 0===(s="__data__"in s.a&&"string"==typeof(s=s.a.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),Je(i=ze(this.B),"RID",t),Je(i,"CVER",22),this.A&&Je(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&Vn(i,this.i,r),bn(this.b,n),this.Ia&&Je(i,"TYPE","init"),this.da?(Je(i,"$req",e),Je(i,"SID","null"),n.U=!0,Oe(n,i,null)):Oe(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},w.Aa=function(){if(this.j=null,Qn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ge(O(this.Ta,this),t)}},w.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Bn(this),Qn(this))},w.Sa=function(){null!=this.m&&(this.m=null,Bn(this),Yn(this),de(19))},w.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(w=or.prototype).ta=function(){},w.sa=function(){},w.ra=function(){},w.qa=function(){},w.Ja=function(){},ar.prototype.a=function(t,e){return new ur(t,e)},D(ur,Mt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ir(t,null,t.fa),Gn(t)},ur.prototype.close=function(){jn(this.a)},ur.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Hn(this.a,e)}else this.l?((e={}).__data__=qt(t),Hn(this.a,e)):Hn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,jn(this.a),delete this.a,ur.X.G.call(this)},D(cr,_e),D(hr,Te),D(lr,or),lr.prototype.ta=function(){Vt(this.a,"a")},lr.prototype.sa=function(t){Vt(this.a,new cr(t))},lr.prototype.ra=function(t){Vt(this.a,new hr(t))},lr.prototype.qa=function(){Vt(this.a,"b")},ar.prototype.createWebChannel=ar.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,ve.COMPLETE="complete",be.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",Mt.prototype.listen=Mt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var fr=function(){return new ar},dr=function(){return ce()},pr=me,gr=ve,mr=ae,vr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},yr=be,wr=kn;class br{constructor(t){this.uid=t}t(){return null!=this.uid}i(){return this.t()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}br.UNAUTHENTICATED=new br(null),br.o=new br("google-credentials-uid"),br.u=new br("first-party-uid");const Er=new m("@firebase/firestore");function Ir(){return Er.logLevel}function _r(t,...e){if(Er.logLevel<=u.DEBUG){const n=e.map(Ar);Er.debug("Firestore (8.1.2): "+t,...n)}}function Tr(t,...e){if(Er.logLevel<=u.ERROR){const n=e.map(Ar);Er.error("Firestore (8.1.2): "+t,...n)}}function Sr(t,...e){if(Er.logLevel<=u.WARN){const n=e.map(Ar);Er.warn("Firestore (8.1.2): "+t,...n)}}function Ar(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function kr(t="Unexpected state"){const e="FIRESTORE (8.1.2) INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function Nr(t,e){t||kr()}function Rr(t,e){return t}const Or={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pr extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}class Cr{constructor(t,e){this.user=e,this.type="OAuth",this.h={},this.h.Authorization="Bearer "+t}}class Dr{constructor(){this.l=null}getToken(){return Promise.resolve(null)}_(){}T(t){this.l=t,t(br.UNAUTHENTICATED)}I(){this.l=null}}class Lr{constructor(t){this.A=null,this.currentUser=br.UNAUTHENTICATED,this.m=!1,this.R=0,this.l=null,this.forceRefresh=!1,this.A=(()=>{this.R++,this.currentUser=this.P(),this.m=!0,this.l&&this.l(this.currentUser)}),this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.A):(this.A(null),t.get().then(t=>{this.auth=t,this.A&&this.auth.addAuthTokenListener(this.A)},()=>{}))}getToken(){const t=this.R,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.R!==t?(_r("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Nr("string"==typeof e.accessToken),new Cr(e.accessToken,this.currentUser)):null):Promise.resolve(null)}_(){this.forceRefresh=!0}T(t){this.l=t,this.m&&t(this.currentUser)}I(){this.auth&&this.auth.removeAuthTokenListener(this.A),this.A=null,this.l=null}P(){const t=this.auth&&this.auth.getUid();return Nr(null===t||"string"==typeof t),new br(t)}}class xr{constructor(t,e){this.V=t,this.g=e,this.type="FirstParty",this.user=br.u}get h(){const t={"X-Goog-AuthUser":this.g},e=this.V.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t}}class Ur{constructor(t,e){this.V=t,this.g=e}getToken(){return Promise.resolve(new xr(this.V,this.g))}T(t){t(br.u)}I(){}_(){}}class Mr{constructor(t,e,n,r,i,s){this.p=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.v=s}}class Vr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get S(){return"(default)"===this.database}isEqual(t){return t instanceof Vr&&t.projectId===this.projectId&&t.database===this.database}}class Fr{D(t){}C(){}}class qr{constructor(){this.N=(()=>this.k()),this.O=(()=>this.M()),this.F=[],this.$()}D(t){this.F.push(t)}C(){window.removeEventListener("online",this.N),window.removeEventListener("offline",this.O)}$(){window.addEventListener("online",this.N),window.addEventListener("offline",this.O)}k(){_r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.F)t(0)}M(){_r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.F)t(1)}static L(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}function jr(t){return null==t}function Br(t){return 0===t&&1/t==-1/0}function $r(t){return"number"==typeof t&&Number.isInteger(t)&&!Br(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const Hr={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};var Gr,zr;function Wr(t){switch(t){case Or.OK:return kr();case Or.CANCELLED:case Or.UNKNOWN:case Or.DEADLINE_EXCEEDED:case Or.RESOURCE_EXHAUSTED:case Or.INTERNAL:case Or.UNAVAILABLE:case Or.UNAUTHENTICATED:return!1;case Or.INVALID_ARGUMENT:case Or.NOT_FOUND:case Or.ALREADY_EXISTS:case Or.PERMISSION_DENIED:case Or.FAILED_PRECONDITION:case Or.ABORTED:case Or.OUT_OF_RANGE:case Or.UNIMPLEMENTED:case Or.DATA_LOSS:return!0;default:return kr()}}function Kr(t){if(void 0===t)return Tr("GRPC error has no .code"),Or.UNKNOWN;switch(t){case Gr.OK:return Or.OK;case Gr.CANCELLED:return Or.CANCELLED;case Gr.UNKNOWN:return Or.UNKNOWN;case Gr.DEADLINE_EXCEEDED:return Or.DEADLINE_EXCEEDED;case Gr.RESOURCE_EXHAUSTED:return Or.RESOURCE_EXHAUSTED;case Gr.INTERNAL:return Or.INTERNAL;case Gr.UNAVAILABLE:return Or.UNAVAILABLE;case Gr.UNAUTHENTICATED:return Or.UNAUTHENTICATED;case Gr.INVALID_ARGUMENT:return Or.INVALID_ARGUMENT;case Gr.NOT_FOUND:return Or.NOT_FOUND;case Gr.ALREADY_EXISTS:return Or.ALREADY_EXISTS;case Gr.PERMISSION_DENIED:return Or.PERMISSION_DENIED;case Gr.FAILED_PRECONDITION:return Or.FAILED_PRECONDITION;case Gr.ABORTED:return Or.ABORTED;case Gr.OUT_OF_RANGE:return Or.OUT_OF_RANGE;case Gr.UNIMPLEMENTED:return Or.UNIMPLEMENTED;case Gr.DATA_LOSS:return Or.DATA_LOSS;default:return kr()}}(zr=Gr||(Gr={}))[zr.OK=0]="OK",zr[zr.CANCELLED=1]="CANCELLED",zr[zr.UNKNOWN=2]="UNKNOWN",zr[zr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zr[zr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zr[zr.NOT_FOUND=5]="NOT_FOUND",zr[zr.ALREADY_EXISTS=6]="ALREADY_EXISTS",zr[zr.PERMISSION_DENIED=7]="PERMISSION_DENIED",zr[zr.UNAUTHENTICATED=16]="UNAUTHENTICATED",zr[zr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zr[zr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zr[zr.ABORTED=10]="ABORTED",zr[zr.OUT_OF_RANGE=11]="OUT_OF_RANGE",zr[zr.UNIMPLEMENTED=12]="UNIMPLEMENTED",zr[zr.INTERNAL=13]="INTERNAL",zr[zr.UNAVAILABLE=14]="UNAVAILABLE",zr[zr.DATA_LOSS=15]="DATA_LOSS";class Xr{constructor(t){this.B=t.B,this.q=t.q}U(t){this.K=t}W(t){this.j=t}onMessage(t){this.G=t}close(){this.q()}send(t){this.B(t)}H(){this.K()}J(t){this.j(t)}Y(t){this.G(t)}}class Yr{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class Jr extends class{constructor(t){this.X=t,this.p=t.p;const e=t.ssl?"https":"http";this.Z=e+"://"+t.host,this.tt="projects/"+this.p.projectId+"/databases/"+this.p.database+"/documents"}et(t,e,n,r){const i=this.nt(t,e);_r("RestConnection","Sending: ",i,n);const s={};return this.st(s,r),this.it(t,i,s,n).then(t=>(_r("RestConnection","Received: ",t),t),e=>{throw Sr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})}rt(t,e,n,r){return this.et(t,e,n,r)}st(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2",t["Content-Type"]="text/plain",e)for(const n in e.h)e.h.hasOwnProperty(n)&&(t[n]=e.h[n])}nt(t,e){const n=Hr[t];return`${this.Z}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.v=t.v}it(t,e,n,r){return new Promise((i,s)=>{const o=new wr;o.listenOnce(gr.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case pr.NO_ERROR:const e=o.getResponseJson();_r("Connection","XHR received:",JSON.stringify(e)),i(e);break;case pr.TIMEOUT:_r("Connection",'RPC "'+t+'" timed out'),s(new Pr(Or.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:const n=o.getStatus();if(_r("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Or).indexOf(e)>=0?e:Or.UNKNOWN}(t.status);s(new Pr(e,t.message))}else s(new Pr(Or.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Pr(Or.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{_r("Connection",'RPC "'+t+'" completed.')}});const a=JSON.stringify(r);o.send(e,"POST",a,n,15)})}ot(t,e){const n=[this.Z,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=fr(),s=dr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.p.projectId}/databases/${this.p.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.v};var a,u;this.st(o.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(r())||"object"==typeof navigator&&"ReactNative"===navigator.product||r().indexOf("Electron/")>=0||((u=r()).indexOf("MSIE ")>=0||u.indexOf("Trident/")>=0)||r().indexOf("MSAppHost/")>=0||"object"==typeof(a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==a.id||(o.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");_r("Connection","Creating WebChannel: "+c,o);const h=i.createWebChannel(c,o);let l=!1,f=!1;const d=new Xr({B:t=>{f?_r("Connection","Not sending because WebChannel is closed:",t):(l||(_r("Connection","Opening WebChannel transport."),h.open(),l=!0),_r("Connection","WebChannel sending:",t),h.send(t))},q:()=>h.close()}),p=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return p(h,yr.EventType.OPEN,()=>{f||_r("Connection","WebChannel transport opened.")}),p(h,yr.EventType.CLOSE,()=>{f||(f=!0,_r("Connection","WebChannel transport closed"),d.J())}),p(h,yr.EventType.ERROR,t=>{f||(f=!0,Sr("Connection","WebChannel transport errored:",t),d.J(new Pr(Or.UNAVAILABLE,"The operation could not be completed")))}),p(h,yr.EventType.MESSAGE,t=>{var e;if(!f){const n=t.data[0];Nr(!!n);const r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){_r("Connection","WebChannel received error:",i);const t=i.status;let e=function(t){const e=Gr[t];if(void 0!==e)return Kr(e)}(t),n=i.message;void 0===e&&(e=Or.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),f=!0,d.J(new Pr(e,n)),h.close()}else _r("Connection","WebChannel received:",n),d.Y(n)}}),p(s,mr.STAT_EVENT,t=>{t.stat===vr.PROXY?_r("Connection","Detected buffering proxy"):t.stat===vr.NOPROXY&&_r("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.H()},0),d}}function Qr(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Zr{static ct(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=Qr(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function ti(t,e){return t<e?-1:t>e?1:0}function ei(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}function ni(t){return t+"\0"}class ri{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Pr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Pr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Pr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Pr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ri.fromMillis(Date.now())}static fromDate(t){return ri.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new ri(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}ut(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ii{constructor(t){this.timestamp=t}static at(t){return new ii(t)}static min(){return new ii(new ri(0,0))}ht(t){return this.timestamp.ut(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}lt(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}_t(){return this.timestamp}}class si{constructor(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.ft=n}get length(){return this.ft}isEqual(t){return 0===si.dt(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof si?t.forEach(t=>{e.push(t)}):e.push(t),this.wt(e)}limit(){return this.offset+this.length}Et(t){return t=void 0===t?1:t,this.wt(this.segments,this.offset+t,this.length-t)}Tt(){return this.wt(this.segments,this.offset,this.length-1)}It(){return this.segments[this.offset]}At(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}Rt(){return 0===this.length}Pt(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}Vt(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}gt(){return this.segments.slice(this.offset,this.limit())}static dt(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class oi extends si{wt(t,e,n){return new oi(t,e,n)}yt(){return this.gt().join("/")}toString(){return this.yt()}static vt(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Pr(Or.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new oi(e)}static bt(){return new oi([])}}const ai=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ui extends si{wt(t,e,n){return new ui(t,e,n)}static St(t){return ai.test(t)}yt(){return this.gt().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ui.St(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.yt()}Dt(){return 1===this.length&&"__name__"===this.get(0)}static Ct(){return new ui(["__name__"])}static Nt(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Pr(Or.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new Pr(Or.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Pr(Or.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new Pr(Or.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ui(e)}static bt(){return new ui([])}}class ci{constructor(t){this.path=t}static xt(t){return new ci(oi.vt(t))}static kt(t){return new ci(oi.vt(t).Et(5))}Ot(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===oi.dt(this.path,t.path)}toString(){return this.path.toString()}static dt(t,e){return oi.dt(t.path,e.path)}static Mt(t){return t.length%2==0}static Ft(t){return new ci(new oi(t.slice()))}}function hi(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function li(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fi(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class di{constructor(t){this.fields=t,t.sort(ui.dt)}$t(t){for(const e of this.fields)if(e.Pt(t))return!0;return!1}isEqual(t){return ei(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class pi{constructor(t){this.Lt=t}static fromBase64String(t){const e=atob(t);return new pi(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new pi(e)}toBase64(){return t=this.Lt,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Lt)}Bt(){return 2*this.Lt.length}ht(t){return ti(this.Lt,t.Lt)}isEqual(t){return this.Lt===t.Lt}}pi.qt=new pi("");const gi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(t){if(Nr(!!t),"string"==typeof t){let e=0;const n=gi.exec(t);if(Nr(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vi(t.seconds),nanos:vi(t.nanos)}}function vi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yi(t){return"string"==typeof t?pi.fromBase64String(t):pi.fromUint8Array(t)}function wi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bi(t){const e=mi(t.mapValue.fields.__local_write_time__.timestampValue);return new ri(e.seconds,e.nanos)}function Ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wi(t)?4:10:kr()}function Ii(t,e){const n=Ei(t);if(n!==Ei(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bi(t).isEqual(bi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=mi(t.timestampValue),r=mi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return yi(t.bytesValue).isEqual(yi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return vi(t.geoPointValue.latitude)===vi(e.geoPointValue.latitude)&&vi(t.geoPointValue.longitude)===vi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vi(t.integerValue)===vi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=vi(t.doubleValue),r=vi(e.doubleValue);return n===r?Br(n)===Br(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ei(t.arrayValue.values||[],e.arrayValue.values||[],Ii);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(hi(n)!==hi(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!Ii(n[t],r[t])))return!1;return!0}(t,e);default:return kr()}}function _i(t,e){return void 0!==(t.values||[]).find(t=>Ii(t,e))}function Ti(t,e){const n=Ei(t),r=Ei(e);if(n!==r)return ti(n,r);switch(n){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=vi(t.integerValue||t.doubleValue),r=vi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Si(t.timestampValue,e.timestampValue);case 4:return Si(bi(t),bi(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){const n=yi(t),r=yi(e);return n.ht(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=ti(n[t],r[t]);if(0!==e)return e}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ti(vi(t.latitude),vi(e.latitude));return 0!==n?n:ti(vi(t.longitude),vi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=Ti(n[t],r[t]);if(e)return e}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=ti(r[t],s[t]);if(0!==e)return e;const o=Ti(n[r[t]],i[s[t]]);if(0!==o)return o}return ti(r.length,s.length)}(t.mapValue,e.mapValue);default:throw kr()}}function Si(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);const n=mi(t),r=mi(e),i=ti(n.seconds,r.seconds);return 0!==i?i:ti(n.nanos,r.nanos)}function Ai(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){const e=mi(t);return`time(${e.seconds},${e.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?yi(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,ci.kt(r).toString()):"geoPointValue"in e?`geo(${(n=e.geoPointValue).latitude},${n.longitude})`:"arrayValue"in e?function(e){let n="[",r=!0;for(const i of e.values||[])r?r=!1:n+=",",n+=t(i);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){const n=Object.keys(e.fields||{}).sort();let r="{",i=!0;for(const s of n)i?i=!1:r+=",",r+=`${s}:${t(e.fields[s])}`;return r+"}"}(e.mapValue):kr();var n,r}(t)}function ki(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.yt()}`}}function Ni(t){return!!t&&"integerValue"in t}function Ri(t){return!!t&&"arrayValue"in t}function Oi(t){return!!t&&"nullValue"in t}function Pi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ci(t){return!!t&&"mapValue"in t}class Di{constructor(t){this.proto=t}static empty(){return new Di({mapValue:{}})}field(t){if(t.Rt())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ci(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.At()])||null}}isEqual(t){return Ii(this.proto,t.proto)}}class Li{constructor(t=Di.empty()){this.Ut=t,this.Kt=new Map}set(t,e){return this.Qt(t,e),this}delete(t){return this.Qt(t,null),this}Qt(t,e){let n=this.Kt;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===Ei(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.At(),e)}Wt(){const t=this.jt(ui.bt(),this.Kt);return null!=t?new Di(t):this.Ut}jt(t,e){let n=!1;const r=this.Ut.field(t),i=Ci(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const s=this.jt(t.child(r),e);null!=s&&(i[r]=s,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}function xi(t){const e=[];return li(t.fields||{},(t,n)=>{const r=new ui([t]);if(Ci(n)){const t=xi(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)}),new di(e)}class Ui{constructor(t,e){this.key=t,this.version=e}}class Mi extends Ui{constructor(t,e,n,r){super(t,e),this.Gt=n,this.zt=!!r.zt,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.Gt.field(t)}data(){return this.Gt}Ht(){return this.Gt.proto}isEqual(t){return t instanceof Mi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.zt===t.zt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Gt.isEqual(t.Gt)}toString(){return`Document(${this.key}, ${this.version}, ${this.Gt.toString()}, {hasLocalMutations: ${this.zt}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.zt||this.hasCommittedMutations}}class Vi extends Ui{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Vi&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Fi extends Ui{toString(){return`UnknownDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return!0}isEqual(t){return t instanceof Fi&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class qi{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Jt=null}}function ji(t,e=null,n=[],r=[],i=null,s=null,o=null){return new qi(t,e,n,r,i,s,o)}function Bi(t){const e=Rr(t);if(null===e.Jt){let t=e.path.yt();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>(function(t){return t.field.yt()+t.op.toString()+Ai(t.value)})(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>(function(t){return t.field.yt()+t.dir})(t)).join(","),jr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=es(e.startAt)),e.endAt&&(t+="|ub:",t+=es(e.endAt)),e.Jt=t}return e.Jt}function $i(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!rs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!Ii(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ss(t.startAt,e.startAt)&&ss(t.endAt,e.endAt)}function Hi(t){return ci.Mt(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Gi extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.Dt()?"in"===e||"not-in"===e?this.Yt(t,e,n):new zi(t,e,n):"array-contains"===e?new Yi(t,n):"in"===e?new Ji(t,n):"not-in"===e?new Qi(t,n):"array-contains-any"===e?new Zi(t,n):new Gi(t,e,n)}static Yt(t,e,n){return"in"===e?new Wi(t,n):new Ki(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.Xt(Ti(e,this.value)):null!==e&&Ei(this.value)===Ei(e)&&this.Xt(Ti(e,this.value))}Xt(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return kr()}}Zt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class zi extends Gi{constructor(t,e,n){super(t,e,n),this.key=ci.kt(n.referenceValue)}matches(t){const e=ci.dt(t.key,this.key);return this.Xt(e)}}class Wi extends Gi{constructor(t,e){super(t,"in",e),this.keys=Xi("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Ki extends Gi{constructor(t,e){super(t,"not-in",e),this.keys=Xi("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Xi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>ci.kt(t.referenceValue))}class Yi extends Gi{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Ri(e)&&_i(e.arrayValue,this.value)}}class Ji extends Gi{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&_i(this.value.arrayValue,e)}}class Qi extends Gi{constructor(t,e){super(t,"not-in",e)}matches(t){if(_i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!_i(this.value.arrayValue,e)}}class Zi extends Gi{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Ri(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>_i(this.value.arrayValue,t))}}class ts{constructor(t,e){this.position=t,this.before=e}}function es(t){return`${t.before?"b":"a"}:${t.position.map(t=>Ai(t)).join(",")}`}class ns{constructor(t,e="asc"){this.field=t,this.dir=e}}function rs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function is(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.Dt()?ci.dt(ci.kt(o.referenceValue),n.key):Ti(o,n.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ss(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ii(t.position[n],e.position[n]))return!1;return!0}class os{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.te=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ee=null,this.ne=null,this.startAt,this.endAt}}function as(t,e,n,r,i,s,o,a){return new os(t,e,n,r,i,s,o,a)}function us(t){return new os(t)}function cs(t){return!jr(t.limit)&&"F"===t.limitType}function hs(t){return!jr(t.limit)&&"L"===t.limitType}function ls(t){return t.te.length>0?t.te[0].field:null}function fs(t){for(const e of t.filters)if(e.Zt())return e.field;return null}function ds(t){return null!==t.collectionGroup}function ps(t){const e=Rr(t);if(null===e.ee){e.ee=[];const t=fs(e),n=ls(e);if(null!==t&&null===n)t.Dt()||e.ee.push(new ns(t)),e.ee.push(new ns(ui.Ct(),"asc"));else{let t=!1;for(const n of e.te)e.ee.push(n),n.field.Dt()&&(t=!0);if(!t){const t=e.te.length>0?e.te[e.te.length-1].dir:"asc";e.ee.push(new ns(ui.Ct(),t))}}}return e.ee}function gs(t){const e=Rr(t);if(!e.ne)if("F"===e.limitType)e.ne=ji(e.path,e.collectionGroup,ps(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of ps(e)){const e="desc"===n.dir?"asc":"desc";t.push(new ns(n.field,e))}const n=e.endAt?new ts(e.endAt.position,!e.endAt.before):null,r=e.startAt?new ts(e.startAt.position,!e.startAt.before):null;e.ne=ji(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.ne}function ms(t,e,n){return new os(t.path,t.collectionGroup,t.te.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function vs(t,e){return $i(gs(t),gs(e))&&t.limitType===e.limitType}function ys(t){return`${Bi(gs(t))}|lt:${t.limitType}`}function ws(t){return`Query(target=${function(t){let e=t.path.yt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>{return`${(e=t).field.yt()} ${e.op} ${Ai(e.value)}`;var e}).join(", ")}]`),jr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>(function(t){return`${t.field.yt()} (${t.dir})`})(t)).join(", ")}]`),t.startAt&&(e+=", startAt: "+es(t.startAt)),t.endAt&&(e+=", endAt: "+es(t.endAt)),`Target(${e})`}(gs(t))}; limitType=${t.limitType})`}function bs(t,e){return function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.Ot(t.collectionGroup)&&t.path.Pt(n):ci.Mt(t.path)?t.path.isEqual(n):t.path.Vt(n)}(t,e)&&function(t,e){for(const n of t.te)if(!n.field.Dt()&&null===e.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!is(t.startAt,ps(t),e))&&(!t.endAt||!is(t.endAt,ps(t),e))}(t,e)}function Es(t){return(e,n)=>{let r=!1;for(const i of ps(t)){const t=Is(i,e,n);if(0!==t)return t;r=r||i.field.Dt()}return 0}}function Is(t,e,n){const r=t.field.Dt()?ci.dt(e.key,n.key):function(t,e,n){const r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ti(r,i):kr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return kr()}}class _s{constructor(t,e,n,r,i=ii.min(),s=ii.min(),o=pi.qt){this.target=t,this.targetId=e,this.se=n,this.sequenceNumber=r,this.ie=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}re(t){return new _s(this.target,this.targetId,this.se,t,this.ie,this.lastLimboFreeSnapshotVersion,this.resumeToken)}oe(t,e){return new _s(this.target,this.targetId,this.se,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}ce(t){return new _s(this.target,this.targetId,this.se,this.sequenceNumber,this.ie,t,this.resumeToken)}}function Ts(t,e){if(t.ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Br(e)?"-0":e}}function Ss(t){return{integerValue:""+t}}function As(t,e){return $r(e)?Ss(e):Ts(t,e)}class ks{constructor(){this.ae=void 0}}function Ns(t,e,n){return t instanceof Ps?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Cs?Ds(t,e):t instanceof Ls?xs(t,e):function(t,e){const n=Os(t,e),r=Ms(n)+Ms(t.he);return Ni(n)&&Ni(t.he)?Ss(r):Ts(t.le,r)}(t,e)}function Rs(t,e,n){return t instanceof Cs?Ds(t,e):t instanceof Ls?xs(t,e):n}function Os(t,e){return t instanceof Us?Ni(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}class Ps extends ks{}class Cs extends ks{constructor(t){super(),this.elements=t}}function Ds(t,e){const n=Vs(e);for(const e of t.elements)n.some(t=>Ii(t,e))||n.push(e);return{arrayValue:{values:n}}}class Ls extends ks{constructor(t){super(),this.elements=t}}function xs(t,e){let n=Vs(e);for(const e of t.elements)n=n.filter(t=>!Ii(t,e));return{arrayValue:{values:n}}}class Us extends ks{constructor(t,e){super(),this.le=t,this.he=e}}function Ms(t){return vi(t.integerValue||t.doubleValue)}function Vs(t){return Ri(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Fs{constructor(t,e){this.field=t,this.transform=e}}class qs{constructor(t,e){this.version=t,this.transformResults=e}}class js{constructor(t,e){this.updateTime=t,this.exists=e}static _e(){return new js}static exists(t){return new js(void 0,t)}static updateTime(t){return new js(t)}get fe(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Bs(t,e){return void 0!==t.updateTime?e instanceof Mi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Mi}class $s{}function Hs(t,e,n){return t instanceof Xs?function(t,e,n){let r=t.value;if(n.transformResults){const i=Qs(t.fieldTransforms,e,n.transformResults);r=to(t.fieldTransforms,r,i)}return new Mi(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ys?function(t,e,n){if(!Bs(t.de,e))return new Fi(t.key,n.version);const r=Js(t,e,n.transformResults?Qs(t.fieldTransforms,e,n.transformResults):[]);return new Mi(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Vi(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Gs(t,e,n,r){return t instanceof Xs?function(t,e,n,r){if(!Bs(t.de,e))return e;let i=t.value;if(t.fieldTransforms){const s=Zs(t.fieldTransforms,n,e,r);i=to(t.fieldTransforms,i,s)}const s=Ks(e);return new Mi(t.key,s,i,{zt:!0})}(t,e,r,n):t instanceof Ys?function(t,e,n,r){if(!Bs(t.de,e))return e;const i=Ks(e),s=Js(t,e,Zs(t.fieldTransforms,n,e,r));return new Mi(t.key,i,s,{zt:!0})}(t,e,r,n):function(t,e){return Bs(t.de,e)?new Vi(t.key,ii.min()):e}(t,e)}function zs(t,e){return void 0!==t.fieldTransforms?function(t,e){let n=null;for(const r of t){const t=e instanceof Mi?e.field(r.field):void 0,i=Os(r.transform,t||null);null!=i&&(n=null==n?(new Li).set(r.field,i):n.set(r.field,i))}return n?n.Wt():null}(t.fieldTransforms,e):null}function Ws(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.de.isEqual(e.de)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ei(t,e,(t,e)=>(function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Cs&&e instanceof Cs||t instanceof Ls&&e instanceof Ls?ei(t.elements,e.elements,Ii):t instanceof Us&&e instanceof Us?Ii(t.he,e.he):t instanceof Ps&&e instanceof Ps}(t.transform,e.transform)})(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.we.isEqual(e.we))}function Ks(t){return t instanceof Mi?t.version:ii.min()}class Xs extends $s{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.de=n,this.fieldTransforms=r,this.type=0}}class Ys extends $s{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.we=n,this.de=r,this.fieldTransforms=i,this.type=1}}function Js(t,e,n){let r;return r=e instanceof Mi?e.data():Di.empty(),r=function(t,e){const n=new Li(r);return t.we.fields.forEach(e=>{if(!e.Rt()){const r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.Wt()}(t),r=to(t.fieldTransforms,r,n)}function Qs(t,e,n){const r=[];Nr(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform;let a=null;e instanceof Mi&&(a=e.field(s.field)),r.push(Rs(o,a,n[i]))}return r}function Zs(t,e,n,r){const i=[];for(const s of t){const t=s.transform;let o=null;n instanceof Mi&&(o=n.field(s.field)),null===o&&r instanceof Mi&&(o=r.field(s.field)),i.push(Ns(t,o,e))}return i}function to(t,e,n){const r=new Li(e);for(let e=0;e<t.length;e++){const i=t[e];r.set(i.field,n[e])}return r.Wt()}class eo extends $s{constructor(t,e){super(),this.key=t,this.de=e,this.type=2,this.fieldTransforms=[]}}class no extends $s{constructor(t,e){super(),this.key=t,this.de=e,this.type=3,this.fieldTransforms=[]}}class ro{constructor(t){this.count=t}}class io{constructor(t,e){this.dt=t,this.root=e||oo.EMPTY}Ee(t,e){return new io(this.dt,this.root.Ee(t,e,this.dt).copy(null,null,oo.Te,null,null))}remove(t){return new io(this.dt,this.root.remove(t,this.dt).copy(null,null,oo.Te,null,null))}get(t){let e=this.root;for(;!e.Rt();){const n=this.dt(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.Rt();){const r=this.dt(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}Rt(){return this.root.Rt()}get size(){return this.root.size}Ie(){return this.root.Ie()}Ae(){return this.root.Ae()}me(t){return this.root.me(t)}forEach(t){this.me((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.me((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}Re(t){return this.root.Re(t)}Pe(){return new so(this.root,null,this.dt,!1)}Ve(t){return new so(this.root,t,this.dt,!1)}ge(){return new so(this.root,null,this.dt,!0)}ye(t){return new so(this.root,t,this.dt,!0)}}class so{constructor(t,e,n,r){this.pe=r,this.ve=[];let i=1;for(;!t.Rt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.pe?t.left:t.right;else{if(0===i){this.ve.push(t);break}this.ve.push(t),t=this.pe?t.right:t.left}}be(){let t=this.ve.pop();const e={key:t.key,value:t.value};if(this.pe)for(t=t.left;!t.Rt();)this.ve.push(t),t=t.right;else for(t=t.right;!t.Rt();)this.ve.push(t),t=t.left;return e}Se(){return this.ve.length>0}De(){if(0===this.ve.length)return null;const t=this.ve[this.ve.length-1];return{key:t.key,value:t.value}}}class oo{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:oo.RED,this.left=null!=r?r:oo.EMPTY,this.right=null!=i?i:oo.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new oo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}Rt(){return!1}me(t){return this.left.me(t)||t(this.key,this.value)||this.right.me(t)}Re(t){return this.right.Re(t)||t(this.key,this.value)||this.left.Re(t)}min(){return this.left.Rt()?this:this.left.min()}Ie(){return this.min().key}Ae(){return this.right.Rt()?this.key:this.right.Ae()}Ee(t,e,n){let r=this;const i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ee(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ee(t,e,n))).Ce()}Ne(){if(this.left.Rt())return oo.EMPTY;let t=this;return t.left.xe()||t.left.left.xe()||(t=t.ke()),(t=t.copy(null,null,null,t.left.Ne(),null)).Ce()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.Rt()||r.left.xe()||r.left.left.xe()||(r=r.ke()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.xe()&&(r=r.Oe()),r.right.Rt()||r.right.xe()||r.right.left.xe()||(r=r.Me()),0===e(t,r.key)){if(r.right.Rt())return oo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ne())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ce()}xe(){return this.color}Ce(){let t=this;return t.right.xe()&&!t.left.xe()&&(t=t.Fe()),t.left.xe()&&t.left.left.xe()&&(t=t.Oe()),t.left.xe()&&t.right.xe()&&(t=t.$e()),t}ke(){let t=this.$e();return t.right.left.xe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Oe())).Fe()).$e()),t}Me(){let t=this.$e();return t.left.left.xe()&&(t=(t=t.Oe()).$e()),t}Fe(){const t=this.copy(null,null,oo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}Oe(){const t=this.copy(null,null,oo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}$e(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}Le(){const t=this.Be();return Math.pow(2,t)<=this.size+1}Be(){if(this.xe()&&this.left.xe())throw kr();if(this.right.xe())throw kr();const t=this.left.Be();if(t!==this.right.Be())throw kr();return t+(this.xe()?0:1)}}oo.EMPTY=null,oo.RED=!0,oo.Te=!1,oo.EMPTY=new class{constructor(){this.size=0}get key(){throw kr()}get value(){throw kr()}get color(){throw kr()}get left(){throw kr()}get right(){throw kr()}copy(t,e,n,r,i){return this}Ee(t,e,n){return new oo(t,e)}remove(t,e){return this}Rt(){return!0}me(t){return!1}Re(t){return!1}Ie(){return null}Ae(){return null}xe(){return!1}Le(){return!0}Be(){return 0}};class ao{constructor(t){this.dt=t,this.data=new io(this.dt)}has(t){return null!==this.data.get(t)}first(){return this.data.Ie()}last(){return this.data.Ae()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.me((e,n)=>(t(e),!1))}qe(t,e){const n=this.data.Ve(t[0]);for(;n.Se();){const r=n.be();if(this.dt(r.key,t[1])>=0)return;e(r.key)}}Ue(t,e){let n;for(n=void 0!==e?this.data.Ve(e):this.data.Pe();n.Se();)if(!t(n.be().key))return}Ke(t){const e=this.data.Ve(t);return e.Se()?e.be().key:null}Pe(){return new uo(this.data.Pe())}Ve(t){return new uo(this.data.Ve(t))}add(t){return this.copy(this.data.remove(t).Ee(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}Rt(){return this.data.Rt()}Qe(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;const e=this.data.Pe(),n=t.data.Pe();for(;e.Se();){const t=e.be().key,r=n.be().key;if(0!==this.dt(t,r))return!1}return!0}gt(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new ao(this.dt);return e.data=t,e}}class uo{constructor(t){this.We=t}be(){return this.We.be().key}Se(){return this.We.Se()}}const co=new io(ci.dt);function ho(){return co}function lo(){return ho()}const fo=new io(ci.dt);function po(){return fo}const go=new io(ci.dt),mo=new ao(ci.dt);function vo(...t){let e=mo;for(const n of t)e=e.add(n);return e}const yo=new ao(ti);function wo(){return yo}class bo{constructor(t){this.dt=t?(e,n)=>t(e,n)||ci.dt(e.key,n.key):(t,e)=>ci.dt(t.key,e.key),this.je=po(),this.Ge=new io(this.dt)}static ze(t){return new bo(t.dt)}has(t){return null!=this.je.get(t)}get(t){return this.je.get(t)}first(){return this.Ge.Ie()}last(){return this.Ge.Ae()}Rt(){return this.Ge.Rt()}indexOf(t){const e=this.je.get(t);return e?this.Ge.indexOf(e):-1}get size(){return this.Ge.size}forEach(t){this.Ge.me((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.je.Ee(t.key,t),e.Ge.Ee(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.je.remove(t),this.Ge.remove(e)):this}isEqual(t){if(!(t instanceof bo))return!1;if(this.size!==t.size)return!1;const e=this.Ge.Pe(),n=t.Ge.Pe();for(;e.Se();){const t=e.be().key,r=n.be().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new bo;return n.dt=this.dt,n.je=t,n.Ge=e,n}}class Eo{constructor(){this.He=new io(ci.dt)}track(t){const e=t.doc.key,n=this.He.get(e);n?0!==t.type&&3===n.type?this.He=this.He.Ee(e,t):3===t.type&&1!==n.type?this.He=this.He.Ee(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.He=this.He.Ee(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.He=this.He.Ee(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.He=this.He.remove(e):1===t.type&&2===n.type?this.He=this.He.Ee(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.He=this.He.Ee(e,{type:2,doc:t.doc}):kr():this.He=this.He.Ee(e,t)}Je(){const t=[];return this.He.me((e,n)=>{t.push(n)}),t}}class Io{constructor(t,e,n,r,i,s,o,a){this.query=t,this.docs=e,this.Ye=n,this.docChanges=r,this.Xe=i,this.fromCache=s,this.Ze=o,this.tn=a}static en(t,e,n,r){const i=[];return e.forEach(t=>{i.push({type:0,doc:t})}),new Io(t,e,bo.ze(e),i,n,r,!0,!1)}get hasPendingWrites(){return!this.Xe.Rt()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.Ze===t.Ze&&this.Xe.isEqual(t.Xe)&&vs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ye.isEqual(t.Ye)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class _o{constructor(t,e,n,r,i){this.ie=t,this.nn=e,this.sn=n,this.rn=r,this.on=i}static cn(t,e){const n=new Map;return n.set(t,To.un(t,e)),new _o(ii.min(),n,wo(),ho(),vo())}}class To{constructor(t,e,n,r,i){this.resumeToken=t,this.an=e,this.hn=n,this.ln=r,this._n=i}static un(t,e){return new To(pi.qt,e,vo(),vo(),vo())}}class So{constructor(t,e,n,r){this.fn=t,this.removedTargetIds=e,this.key=n,this.dn=r}}class Ao{constructor(t,e){this.targetId=t,this.wn=e}}class ko{constructor(t,e,n=pi.qt,r=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class No{constructor(){this.En=0,this.Tn=Po(),this.In=pi.qt,this.An=!1,this.mn=!0}get an(){return this.An}get resumeToken(){return this.In}get Rn(){return 0!==this.En}get Pn(){return this.mn}Vn(t){t.Bt()>0&&(this.mn=!0,this.In=t)}gn(){let t=vo(),e=vo(),n=vo();return this.Tn.forEach((r,i)=>{switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:kr()}}),new To(this.In,this.An,t,e,n)}yn(){this.mn=!1,this.Tn=Po()}pn(t,e){this.mn=!0,this.Tn=this.Tn.Ee(t,e)}vn(t){this.mn=!0,this.Tn=this.Tn.remove(t)}bn(){this.En+=1}Sn(){this.En-=1}Dn(){this.mn=!0,this.An=!0}}class Ro{constructor(t){this.Cn=t,this.Nn=new Map,this.xn=ho(),this.kn=Oo(),this.On=new ao(ti)}Mn(t){for(const e of t.fn)t.dn instanceof Mi?this.Fn(e,t.dn):t.dn instanceof Vi&&this.$n(e,t.key,t.dn);for(const e of t.removedTargetIds)this.$n(e,t.key,t.dn)}Ln(t){this.Bn(t,e=>{const n=this.qn(e);switch(t.state){case 0:this.Un(e)&&n.Vn(t.resumeToken);break;case 1:n.Sn(),n.Rn||n.yn(),n.Vn(t.resumeToken);break;case 2:n.Sn(),n.Rn||this.removeTarget(e);break;case 3:this.Un(e)&&(n.Dn(),n.Vn(t.resumeToken));break;case 4:this.Un(e)&&(this.Kn(e),n.Vn(t.resumeToken));break;default:kr()}})}Bn(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Nn.forEach((t,n)=>{this.Un(n)&&e(n)})}Qn(t){const e=t.targetId,n=t.wn.count,r=this.Wn(e);if(r){const t=r.target;if(Hi(t))if(0===n){const n=new ci(t.path);this.$n(e,n,new Vi(n,ii.min()))}else Nr(1===n);else this.jn(e)!==n&&(this.Kn(e),this.On=this.On.add(e))}}Gn(t){const e=new Map;this.Nn.forEach((n,r)=>{const i=this.Wn(r);if(i){if(n.an&&Hi(i.target)){const e=new ci(i.target.path);null!==this.xn.get(e)||this.zn(r,e)||this.$n(r,e,new Vi(e,t))}n.Pn&&(e.set(r,n.gn()),n.yn())}});let n=vo();this.kn.forEach((t,e)=>{let r=!0;e.Ue(t=>{const e=this.Wn(t);return!e||2===e.se||(r=!1,!1)}),r&&(n=n.add(t))});const r=new _o(t,e,this.On,this.xn,n);return this.xn=ho(),this.kn=Oo(),this.On=new ao(ti),r}Fn(t,e){if(!this.Un(t))return;const n=this.zn(t,e.key)?2:0;this.qn(t).pn(e.key,n),this.xn=this.xn.Ee(e.key,e),this.kn=this.kn.Ee(e.key,this.Hn(e.key).add(t))}$n(t,e,n){if(!this.Un(t))return;const r=this.qn(t);this.zn(t,e)?r.pn(e,1):r.vn(e),this.kn=this.kn.Ee(e,this.Hn(e).delete(t)),n&&(this.xn=this.xn.Ee(e,n))}removeTarget(t){this.Nn.delete(t)}jn(t){const e=this.qn(t).gn();return this.Cn.Jn(t).size+e.hn.size-e._n.size}bn(t){this.qn(t).bn()}qn(t){let e=this.Nn.get(t);return e||(e=new No,this.Nn.set(t,e)),e}Hn(t){let e=this.kn.get(t);return e||(e=new ao(ti),this.kn=this.kn.Ee(t,e)),e}Un(t){const e=null!==this.Wn(t);return e||_r("WatchChangeAggregator","Detected inactive target",t),e}Wn(t){const e=this.Nn.get(t);return e&&e.Rn?null:this.Cn.Yn(t)}Kn(t){this.Nn.set(t,new No),this.Cn.Jn(t).forEach(e=>{this.$n(t,e,null)})}zn(t,e){return this.Cn.Jn(t).has(e)}}function Oo(){return new io(ci.dt)}function Po(){return new io(ci.dt)}const Co={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Lo{constructor(t,e){this.p=t,this.ue=e}}function xo(t,e){return t.ue?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.ue?e.toBase64():e.toUint8Array()}function Mo(t){return Nr(!!t),ii.at(function(t){const e=mi(t);return new ri(e.seconds,e.nanos)}(t))}function Vo(t,e){return function(t){return new oi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).yt()}function Fo(t){const e=oi.vt(t);return Nr(na(e)),e}function qo(t,e){return Vo(t.p,e.path)}function jo(t,e){const n=Fo(e);if(n.get(1)!==t.p.projectId)throw new Pr(Or.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.p.projectId);if(n.get(3)!==t.p.database)throw new Pr(Or.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.p.database);return new ci(Go(n))}function Bo(t,e){return Vo(t.p,e)}function $o(t){const e=Fo(t);return 4===e.length?oi.bt():Go(e)}function Ho(t){return new oi(["projects",t.p.projectId,"databases",t.p.database]).yt()}function Go(t){return Nr(t.length>4&&"documents"===t.get(4)),t.Et(5)}function zo(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function Wo(t,e){let n;if(e instanceof Xs)n={update:zo(t,e.key,e.value)};else if(e instanceof eo)n={delete:qo(t,e.key)};else if(e instanceof Ys)n={update:zo(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.yt())),{fieldPaths:e}}(e.we)};else{if(!(e instanceof no))return kr();n={verify:qo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof Ps)return{fieldPath:e.field.yt(),setToServerValue:"REQUEST_TIME"};if(n instanceof Cs)return{fieldPath:e.field.yt(),appendMissingElements:{values:n.elements}};if(n instanceof Ls)return{fieldPath:e.field.yt(),removeAllFromArray:{values:n.elements}};if(n instanceof Us)return{fieldPath:e.field.yt(),increment:n.he};throw kr()})(0,t))),e.de.fe||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return xo(t,e._t())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:kr()}(t,e.de)),n}function Ko(t,e){const n=e.currentDocument?function(t){return void 0!==t.updateTime?js.updateTime(Mo(t.updateTime)):void 0!==t.exists?js.exists(t.exists):js._e()}(e.currentDocument):js._e(),r=e.updateTransforms?e.updateTransforms.map(e=>(function(t,e){let n=null;if("setToServerValue"in e)Nr("REQUEST_TIME"===e.setToServerValue),n=new Ps;else if("appendMissingElements"in e){const t=e.appendMissingElements.values||[];n=new Cs(t)}else if("removeAllFromArray"in e){const t=e.removeAllFromArray.values||[];n=new Ls(t)}else"increment"in e?n=new Us(t,e.increment):kr();const r=ui.Nt(e.fieldPath);return new Fs(r,n)})(t,e)):[];if(e.update){e.update.name;const i=jo(t,e.update.name),s=new Di({mapValue:{fields:e.update.fields}});if(e.updateMask){const t=function(t){const e=t.fieldPaths||[];return new di(e.map(t=>ui.Nt(t)))}(e.updateMask);return new Ys(i,s,t,n,r)}return new Xs(i,s,n,r)}if(e.delete){const r=jo(t,e.delete);return new eo(r,n)}if(e.verify){const r=jo(t,e.verify);return new no(r,n)}return kr()}function Xo(t,e){return{documents:[Bo(t,e.path)]}}function Yo(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.Tt()),n.structuredQuery.from=[{collectionId:r.At()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(Pi(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NAN"}};if(Oi(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Pi(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NOT_NAN"}};if(Oi(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ta(t.field),op:function(t){return Do[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:ta(t.field),direction:function(t){return Co[t]}(t.dir)}})(t))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.ue||jr(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Qo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Qo(e.endAt)),n}function Jo(t){let e=$o(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Nr(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ea(t.unaryFilter.field);return Gi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ea(t.unaryFilter.field);return Gi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ea(t.unaryFilter.field);return Gi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ea(t.unaryFilter.field);return Gi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[function(t){return Gi.create(ea(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(t.fieldFilter.op),t.fieldFilter.value)}(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>t(e)).reduce((t,e)=>t.concat(e)):kr():[]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(t=>(function(t){return new ns(ea(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))})(t)));let a=null;n.limit&&(a=function(t){let e;return jr(e="object"==typeof t?t.value:t)?null:e}(n.limit));let u=null;n.startAt&&(u=Zo(n.startAt));let c=null;return n.endAt&&(c=Zo(n.endAt)),as(e,i,o,s,a,"F",u,c)}function Qo(t){return{before:t.before,values:t.position}}function Zo(t){const e=!!t.before,n=t.values||[];return new ts(n,e)}function ta(t){return{fieldPath:t.yt()}}function ea(t){return ui.Nt(t.fieldPath)}function na(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function ra(t){return new Lo(t,!0)}class ia{constructor(t){this.Xn=null,this.Zn=null,this.result=void 0,this.error=void 0,this.ts=!1,this.es=!1,t(t=>{this.ts=!0,this.result=t,this.Xn&&this.Xn(t)},t=>{this.ts=!0,this.error=t,this.Zn&&this.Zn(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.es&&kr(),this.es=!0,this.ts?this.error?this.ns(e,this.error):this.ss(t,this.result):new ia((n,r)=>{this.Xn=(e=>{this.ss(t,e).next(n,r)}),this.Zn=(t=>{this.ns(e,t).next(n,r)})})}rs(){return new Promise((t,e)=>{this.next(t,e)})}os(t){try{const e=t();return e instanceof ia?e:ia.resolve(e)}catch(t){return ia.reject(t)}}ss(t,e){return t?this.os(()=>t(e)):ia.resolve(e)}ns(t,e){return t?this.os(()=>t(e)):ia.reject(e)}static resolve(t){return new ia((e,n)=>{e(t)})}static reject(t){return new ia((e,n)=>{n(t)})}static cs(t){return new ia((e,n)=>{let r=0,i=0,s=!1;t.forEach(t=>{++r,t.next(()=>{++i,s&&i===r&&e()},t=>n(t))}),s=!0,i===r&&e()})}static us(t){let e=ia.resolve(!1);for(const n of t)e=e.next(t=>t?ia.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.cs(n)}}class sa{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.hs=new Yr,this.transaction.oncomplete=(()=>{this.hs.resolve()}),this.transaction.onabort=(()=>{e.error?this.hs.reject(new ua(t,e.error)):this.hs.resolve()}),this.transaction.onerror=(e=>{const n=da(e.target.error);this.hs.reject(new ua(t,n))})}static open(t,e,n,r){try{return new sa(e,t.transaction(r,n))}catch(t){throw new ua(e,t)}}get ls(){return this.hs.promise}abort(t){t&&this.hs.reject(t),this.aborted||(_r("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(t){const e=this.transaction.objectStore(t);return new ha(e)}}class oa{constructor(t,e,n){this.name=t,this.version=e,this._s=n,12.2===oa.fs(r())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return _r("SimpleDb","Removing database:",t),la(window.indexedDB.deleteDatabase(t)).rs()}static L(){if("undefined"==typeof indexedDB)return!1;if(oa.ds())return!0;const t=r(),e=oa.fs(t),n=0<e&&e<10,i=oa.ws(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||s)}static ds(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Es)}static Ts(t,e){return t.store(e)}static fs(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static ws(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Is(t){return this.db||(_r("SimpleDb","Opening database:",this.name),this.db=await new Promise((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=(t=>{const n=t.target.result;e(n)}),r.onblocked=(()=>{n(new ua(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))}),r.onerror=(e=>{const r=e.target.error;"VersionError"===r.name?n(new Pr(Or.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ua(t,r))}),r.onupgradeneeded=(t=>{_r("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this._s.As(e,r.transaction,t.oldVersion,this.version).next(()=>{_r("SimpleDb","Database upgrade to version "+this.version+" complete")})})})),this.Rs&&(this.db.onversionchange=(t=>this.Rs(t))),this.db}Ps(t){this.Rs=t,this.db&&(this.db.onversionchange=(e=>t(e)))}async runTransaction(t,e,n,r){const i="readonly"===e;for(;;){0;try{this.db=await this.Is(t);const e=sa.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).catch(t=>(e.abort(t),ia.reject(t))).rs();return s.catch(()=>{}),await e.ls,s}catch(t){const e="FirebaseError"!==t.name&&s<3;if(_r("SimpleDb","Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class aa{constructor(t){this.Vs=t,this.gs=!1,this.ys=null}get ts(){return this.gs}get ps(){return this.ys}set cursor(t){this.Vs=t}done(){this.gs=!0}vs(t){this.ys=t}delete(){return la(this.Vs.delete())}}class ua extends Pr{constructor(t,e){super(Or.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function ca(t){return"IndexedDbTransactionError"===t.name}class ha{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(_r("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(_r("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),la(n)}add(t){return _r("SimpleDb","ADD",this.store.name,t,t),la(this.store.add(t))}get(t){return la(this.store.get(t)).next(e=>(void 0===e&&(e=null),_r("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return _r("SimpleDb","DELETE",this.store.name,t),la(this.store.delete(t))}count(){return _r("SimpleDb","COUNT",this.store.name),la(this.store.count())}bs(t,e){const n=this.cursor(this.options(t,e)),r=[];return this.Ss(n,(t,e)=>{r.push(e)}).next(()=>r)}Ds(t,e){_r("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.Cs=!1;const r=this.cursor(n);return this.Ss(r,(t,e,n)=>n.delete())}Ns(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.Ss(r,e)}xs(t){const e=this.cursor({});return new ia((n,r)=>{e.onerror=(t=>{const e=da(t.target.error);r(e)}),e.onsuccess=(e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next(t=>{t?r.continue():n()}):n()})})}Ss(t,e){const n=[];return new ia((r,i)=>{t.onerror=(t=>{i(t.target.error)}),t.onsuccess=(t=>{const i=t.target.result;if(!i)return void r();const s=new aa(i),o=e(i.primaryKey,i.value,s);if(o instanceof ia){const t=o.catch(t=>(s.done(),ia.reject(t)));n.push(t)}s.ts?r():null===s.ps?i.continue():i.continue(s.ps)})}).next(()=>ia.cs(n))}options(t,e){let n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.Cs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function la(t){return new ia((e,n)=>{t.onsuccess=(t=>{const n=t.target.result;e(n)}),t.onerror=(t=>{const e=da(t.target.error);n(e)})})}let fa=!1;function da(t){const e=oa.fs(r());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new Pr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fa||(fa=!0,setTimeout(()=>{throw t},0)),t}}return t}class pa{constructor(t,e,n,r,i){this.ks=t,this.Os=e,this.Ms=n,this.op=r,this.Fs=i,this.$s=new Yr,this.then=this.$s.promise.then.bind(this.$s.promise),this.$s.promise.catch(t=>{})}static Ls(t,e,n,r,i){const s=Date.now()+n,o=new pa(t,e,s,r,i);return o.start(n),o}start(t){this.Bs=setTimeout(()=>this.qs(),t)}Us(){return this.qs()}cancel(t){null!==this.Bs&&(this.clearTimeout(),this.$s.reject(new Pr(Or.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}qs(){this.ks.Ks(()=>null!==this.Bs?(this.clearTimeout(),this.op().then(t=>this.$s.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.Bs&&(this.Fs(this),clearTimeout(this.Bs),this.Bs=null)}}function ga(t,e){if(Tr("AsyncQueue",`${e}: ${t}`),ca(t))return new Pr(Or.UNAVAILABLE,`${e}: ${t}`);throw t}class ma{constructor(t,e,n=1e3,r=1.5,i=6e4){this.Qs=t,this.Os=e,this.Ws=n,this.js=r,this.Gs=i,this.zs=0,this.Hs=null,this.Js=Date.now(),this.reset()}reset(){this.zs=0}Ys(){this.zs=this.Gs}Xs(t){this.cancel();const e=Math.floor(this.zs+this.Zs()),n=Math.max(0,Date.now()-this.Js),r=Math.max(0,e-n);r>0&&_r("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zs} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Hs=this.Qs.ti(this.Os,r,()=>(this.Js=Date.now(),t())),this.zs*=this.js,this.zs<this.Ws&&(this.zs=this.Ws),this.zs>this.Gs&&(this.zs=this.Gs)}ei(){null!==this.Hs&&(this.Hs.Us(),this.Hs=null)}cancel(){null!==this.Hs&&(this.Hs.cancel(),this.Hs=null)}Zs(){return(Math.random()-.5)*this.zs}}class va{constructor(t,e,n,r,i,s){this.Qs=t,this.ni=n,this.si=r,this.ii=i,this.listener=s,this.state=0,this.ri=0,this.oi=null,this.stream=null,this.ci=new ma(t,e)}ui(){return 1===this.state||2===this.state||4===this.state}ai(){return 2===this.state}start(){3!==this.state?this.auth():this.hi()}async stop(){this.ui()&&await this.close(0)}li(){this.state=0,this.ci.reset()}_i(){this.ai()&&null===this.oi&&(this.oi=this.Qs.ti(this.ni,6e4,()=>this.fi()))}di(t){this.wi(),this.stream.send(t)}async fi(){if(this.ai())return this.close(0)}wi(){this.oi&&(this.oi.cancel(),this.oi=null)}async close(t,e){this.wi(),this.ci.cancel(),this.ri++,3!==t?this.ci.reset():e&&e.code===Or.RESOURCE_EXHAUSTED?(Tr(e.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.ci.Ys()):e&&e.code===Or.UNAUTHENTICATED&&this.ii._(),null!==this.stream&&(this.Ei(),this.stream.close(),this.stream=null),this.state=t,await this.listener.W(e)}Ei(){}auth(){this.state=1;const t=this.Ti(this.ri),e=this.ri;this.ii.getToken().then(t=>{this.ri===e&&this.Ii(t)},e=>{t(()=>{const t=new Pr(Or.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Ai(t)})})}Ii(t){const e=this.Ti(this.ri);this.stream=this.mi(t),this.stream.U(()=>{e(()=>(this.state=2,this.listener.U()))}),this.stream.W(t=>{e(()=>this.Ai(t))}),this.stream.onMessage(t=>{e(()=>this.onMessage(t))})}hi(){this.state=4,this.ci.Xs(async()=>{this.state=0,this.start()})}Ai(t){return _r("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)}Ti(t){return e=>{this.Qs.Ks(()=>this.ri===t?e():(_r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ya extends va{constructor(t,e,n,r,i){super(t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i),this.le=r}mi(t){return this.si.ot("Listen",t)}onMessage(t){this.ci.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:kr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.ue?(Nr(void 0===e||"string"==typeof e),pi.fromBase64String(e||"")):(Nr(void 0===e||e instanceof Uint8Array),pi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Or.UNKNOWN:Kr(t.code);return new Pr(e,t.message||"")}(o);n=new ko(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=jo(t,r.document.name),s=Mo(r.document.updateTime),o=new Di({mapValue:{fields:r.document.fields}}),a=new Mi(i,s,o,{}),u=r.targetIds||[],c=r.removedTargetIds||[];n=new So(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=jo(t,r.document),s=r.readTime?Mo(r.readTime):ii.min(),o=new Vi(i,s),a=r.removedTargetIds||[];n=new So([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=jo(t,r.document),s=r.removedTargetIds||[];n=new So([],s,i,null)}else{if(!("filter"in e))return kr();{e.filter;const t=e.filter;t.targetId;const r=t.count||0,i=new ro(r),s=t.targetId;n=new Ao(s,i)}}return n}(this.le,t),n=function(t){if(!("targetChange"in t))return ii.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?ii.min():e.readTime?Mo(e.readTime):ii.min()}(t);return this.listener.Ri(e,n)}Pi(t){const e={};e.database=Ho(this.le),e.addTarget=function(t,e){let n;const r=e.target;return(n=Hi(r)?{documents:Xo(t,r)}:{query:Yo(t,r)}).targetId=e.targetId,e.resumeToken.Bt()>0?n.resumeToken=Uo(t,e.resumeToken):e.ie.ht(ii.min())>0&&(n.readTime=xo(t,e.ie._t())),n}(this.le,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}(0,e.se);return null==n?null:{"goog-listen-tags":n}}(this.le,t);n&&(e.labels=n),this.di(e)}Vi(t){const e={};e.database=Ho(this.le),e.removeTarget=t,this.di(e)}}class wa extends va{constructor(t,e,n,r,i){super(t,"write_stream_connection_backoff","write_stream_idle",e,n,i),this.le=r,this.gi=!1}get yi(){return this.gi}start(){this.gi=!1,this.lastStreamToken=void 0,super.start()}Ei(){this.gi&&this.pi([])}mi(t){return this.si.ot("Write",t)}onMessage(t){if(Nr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gi){this.ci.reset();const e=function(t,e){return t&&t.length>0?(Nr(void 0!==e),t.map(t=>(function(t,e){let n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(ii.min())&&(n=Mo(e));let r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new qs(n,r)})(t,e))):[]}(t.writeResults,t.commitTime),n=Mo(t.commitTime);return this.listener.vi(n,e)}return Nr(!t.writeResults||0===t.writeResults.length),this.gi=!0,this.listener.bi()}Si(){const t={};t.database=Ho(this.le),this.di(t)}pi(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>Wo(this.le,t))};this.di(e)}}class ba extends class{}{constructor(t,e,n){super(),this.credentials=t,this.si=e,this.le=n,this.Di=!1}Ci(){if(this.Di)throw new Pr(Or.FAILED_PRECONDITION,"The client has already been terminated.")}et(t,e,n){return this.Ci(),this.credentials.getToken().then(r=>this.si.et(t,e,n,r)).catch(t=>{throw t.code===Or.UNAUTHENTICATED&&this.credentials._(),t})}rt(t,e,n){return this.Ci(),this.credentials.getToken().then(r=>this.si.rt(t,e,n,r)).catch(t=>{throw t.code===Or.UNAUTHENTICATED&&this.credentials._(),t})}terminate(){this.Di=!1}}const Ea="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ia{constructor(){this.Ni=[]}xi(t){this.Ni.push(t)}ki(){this.Ni.forEach(t=>t())}}const _a={Oi:!1,Mi:0,Fi:0,$i:0};class Ta{constructor(t,e,n){this.Li=t,this.Bi=e,this.qi=n}static Ui(t){return new Ta(t,Ta.Ki,Ta.Qi)}}Ta.Ki=10,Ta.Qi=1e3,Ta.Wi=new Ta(41943040,Ta.Ki,Ta.Qi),Ta.ji=new Ta(-1,0,0);class Sa{constructor(t,e){this.previousValue=t,e&&(e.Gi=(t=>this.zi(t)),this.Hi=(t=>e.Ji(t)))}zi(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.Hi&&this.Hi(t),t}}async function Aa(t){if(t.code!==Or.FAILED_PRECONDITION||t.message!==Ea)throw t;_r("LocalStore","Unexpectedly lost primary lease")}Sa.Yi=-1;class ka{constructor(t,e,n,r){this.batchId=t,this.Xi=e,this.baseMutations=n,this.mutations=r}Zi(t,e,n){const r=n.tr;for(let n=0;n<this.mutations.length;n++){const i=this.mutations[n];i.key.isEqual(t)&&(e=Hs(i,e,r[n]))}return e}er(t,e){for(const n of this.baseMutations)n.key.isEqual(t)&&(e=Gs(n,e,e,this.Xi));const n=e;for(const r of this.mutations)r.key.isEqual(t)&&(e=Gs(r,e,n,this.Xi));return e}nr(t){let e=t;return this.mutations.forEach(n=>{const r=this.er(n.key,t.get(n.key));r&&(e=e.Ee(n.key,r))}),e}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),vo())}isEqual(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,(t,e)=>Ws(t,e))&&ei(this.baseMutations,t.baseMutations,(t,e)=>Ws(t,e))}}class Na{constructor(t,e,n,r){this.batch=t,this.sr=e,this.tr=n,this.ir=r}static from(t,e,n){Nr(t.mutations.length===n.length);let r=go;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.Ee(i[t].key,n[t].version);return new Na(t,e,n,r)}}class Ra{constructor(t,e){this.rr=t,this.cr=e,this.ur={}}get(t){const e=this.rr(t),n=this.ur[e];if(void 0!==n)for(const[e,r]of n)if(this.cr(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.rr(t),r=this.ur[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.cr(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e])}else this.ur[n]=[[t,e]]}delete(t){const e=this.rr(t),n=this.ur[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.cr(n[r][0],t))return 1===n.length?delete this.ur[e]:n.splice(r,1),!0;return!1}forEach(t){li(this.ur,(e,n)=>{for(const[e,r]of n)t(e,r)})}Rt(){return fi(this.ur)}}class Oa{constructor(){this.ar=new Ra(t=>t.toString(),(t,e)=>t.isEqual(e)),this.hr=!1}lr(t){const e=this.ar.get(t);return e?e.readTime:ii.min()}_r(t,e){this.dr(),this.ar.set(t.key,{wr:t,readTime:e})}Er(t,e=null){this.dr(),this.ar.set(t,{wr:null,readTime:e})}Tr(t,e){this.dr();const n=this.ar.get(e);return void 0!==n?ia.resolve(n.wr):this.Ir(t,e)}getEntries(t,e){return this.Ar(t,e)}apply(t){return this.dr(),this.hr=!0,this.mr(t)}dr(){}}function Pa([t,e],[n,r]){const i=ti(t,n);return 0===i?ti(e,r):i}class Ca{constructor(t){this.Rr=t,this.buffer=new ao(Pa),this.Pr=0}Vr(){return++this.Pr}gr(t){const e=[t,this.Vr()];if(this.buffer.size<this.Rr)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Pa(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Da{constructor(t,e){this.yr=t,this.ks=e,this.pr=!1,this.vr=null}start(t){-1!==this.yr.params.Li&&this.br(t)}stop(){this.vr&&(this.vr.cancel(),this.vr=null)}get Sr(){return null!==this.vr}br(t){const e=this.pr?3e5:6e4;_r("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.vr=this.ks.ti("lru_garbage_collection",e,async()=>{this.vr=null,this.pr=!0;try{await t.Dr(this.yr)}catch(t){ca(t)?_r("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Aa(t)}await this.br(t)})}}class La{constructor(t,e){this.Cr=t,this.params=e}Nr(t,e){return this.Cr.kr(t).next(t=>Math.floor(e/100*t))}Or(t,e){if(0===e)return ia.resolve(Sa.Yi);const n=new Ca(e);return this.Cr.Bn(t,t=>n.gr(t.sequenceNumber)).next(()=>this.Cr.Mr(t,t=>n.gr(t))).next(()=>n.maxValue)}Fr(t,e,n){return this.Cr.Fr(t,e,n)}$r(t,e){return this.Cr.$r(t,e)}Lr(t,e){return-1===this.params.Li?(_r("LruGarbageCollector","Garbage collection skipped; disabled"),ia.resolve(_a)):this.Br(t).next(n=>n<this.params.Li?(_r("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold `+this.params.Li),_a):this.qr(t,e))}Br(t){return this.Cr.Br(t)}qr(t,e){let n,r,i,s,o,a,c;const h=Date.now();return this.Nr(t,this.params.Bi).next(e=>(e>this.params.qi?(_r("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.qi} from `+e),r=this.params.qi):r=e,s=Date.now(),this.Or(t,r))).next(r=>(n=r,o=Date.now(),this.Fr(t,n,e))).next(e=>(i=e,a=Date.now(),this.$r(t,n))).next(t=>(c=Date.now(),Ir()<=u.DEBUG&&_r("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-h}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${t} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-h}ms`),ia.resolve({Oi:!0,Mi:r,Fi:i,$i:t})))}}function xa(t,e,n){if(!n)throw new Pr(Or.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ua(t){if(!ci.Mt(t))throw new Pr(Or.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ma(t){if(ci.Mt(t))throw new Pr(Or.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Va(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":kr()}function Fa(t,e){if("_delegate"in t&&(t=t.Ur),!(t instanceof e)){if(e.name===t.constructor.name)throw new Pr(Or.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Va(t);throw new Pr(Or.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function qa(t,e){if(e<=0)throw new Pr(Or.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class ja{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Pr(Or.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pr(Or.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,function(t,e,n,r){if(!0===e&&!0===r)throw new Pr(Or.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties}}const Ba=new Map;class $a{constructor(t,e){this.Kr="(lite)",this.Qr=new ja({}),this.Wr=!1,t instanceof Vr?(this.jr=t,this.Gr=new Dr):(this.zr=t,this.jr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Pr(Or.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vr(t.options.projectId)}(t),this.Gr=new Lr(e))}get app(){if(!this.zr)throw new Pr(Or.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.zr}get Hr(){return this.Wr}get Jr(){return void 0!==this.Yr}Xr(t){if(this.Wr)throw new Pr(Or.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Qr=new ja(t),void 0!==t.credentials&&(this.Gr=function(t){if(!t)return new Dr;switch(t.type){case"gapi":const e=t.client;return Nr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ur(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Pr(Or.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}Zr(){return this.Qr}eo(){return this.Wr=!0,this.Qr}_delete(){return this.Yr||(this.Yr=this.no()),this.Yr}no(){return function(t){const e=Ba.get(t);e&&(_r("ComponentProvider","Removing Datastore"),Ba.delete(t),e.terminate())}(this),Promise.resolve()}}function Ha(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=za(e)),e=Ga(t.get(n),e);return za(e)}function Ga(t,e){let n=e;const r=t.length;for(let e=0;e<r;e++){const r=t.charAt(e);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function za(t){return t+""}function Wa(t){const e=t.length;if(Nr(e>=2),2===e)return Nr(""===t.charAt(0)&&""===t.charAt(1)),oi.bt();const n=e-2,r=[];let i="";for(let n=0;n<e;){const e=t.indexOf("",n);switch((e<0||e>s)&&kr(),t.charAt(e+1)){case"":const s=t.substring(n,e);let o;0===i.length?o=s:(o=i+=s,i=""),r.push(o);break;case"":i+=t.substring(n,e),i+="\0";break;case"":i+=t.substring(n,e+1);break;default:kr()}n=e+2}return new oi(r)}class Ka{constructor(t,e){this.seconds=t,this.nanoseconds=e}}class Xa{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}Xa.store="owner",Xa.key="owner";class Ya{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}Ya.store="mutationQueues",Ya.keyPath="userId";class Ja{constructor(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}Ja.store="mutations",Ja.keyPath="batchId",Ja.userMutationsIndex="userMutationsIndex",Ja.userMutationsKeyPath=["userId","batchId"];class Qa{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Ha(e)]}static key(t,e,n){return[t,Ha(e),n]}}Qa.store="documentMutations",Qa.PLACEHOLDER=new Qa;class Za{constructor(t,e){this.path=t,this.readTime=e}}class tu{constructor(t,e){this.path=t,this.version=e}}class eu{constructor(t,e,n,r,i,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}eu.store="remoteDocuments",eu.readTimeIndex="readTimeIndex",eu.readTimeIndexPath="readTime",eu.collectionReadTimeIndex="collectionReadTimeIndex",eu.collectionReadTimeIndexPath=["parentPath","readTime"];class nu{constructor(t){this.byteSize=t}}nu.store="remoteDocumentGlobal",nu.key="remoteDocumentGlobalKey";class ru{constructor(t,e,n,r,i,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}ru.store="targets",ru.keyPath="targetId",ru.queryTargetsIndexName="queryTargetsIndex",ru.queryTargetsKeyPath=["canonicalId","targetId"];class iu{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}iu.store="targetDocuments",iu.keyPath=["targetId","path"],iu.documentTargetsIndex="documentTargetsIndex",iu.documentTargetsKeyPath=["path","targetId"];class su{constructor(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}su.key="targetGlobalKey",su.store="targetGlobal";class ou{constructor(t,e){this.collectionId=t,this.parent=e}}ou.store="collectionParents",ou.keyPath=["collectionId","parent"];class au{constructor(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}}au.store="clientMetadata",au.keyPath="clientId";class uu{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}uu.store="bundles",uu.keyPath="bundleId";class cu{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}cu.store="namedQueries",cu.keyPath="name";const hu=[...[...[...[...[Ya.store,Ja.store,Qa.store,eu.store,ru.store,Xa.store,su.store,iu.store],au.store],nu.store],ou.store],uu.store,cu.store];class lu extends Ia{constructor(t,e){super(),this.so=t,this.io=e}}function fu(t,e){const n=Rr(t);return oa.Ts(n.so,e)}class du{constructor(t){this.ro=t}}function pu(t,e){if(e.document)return function(t,e,n){const r=jo(t,e.name),i=Mo(e.updateTime),s=new Di({mapValue:{fields:e.fields}});return new Mi(r,i,s,{hasCommittedMutations:!!n})}(t.ro,e.document,!!e.hasCommittedMutations);if(e.noDocument){const t=ci.Ft(e.noDocument.path),n=wu(e.noDocument.readTime);return new Vi(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){const t=ci.Ft(e.unknownDocument.path),n=wu(e.unknownDocument.version);return new Fi(t,n)}return kr()}function gu(t,e,n){const r=mu(n),i=e.key.path.Tt().gt();if(e instanceof Mi){const n=function(t,e){return{name:qo(t,e.key),fields:e.Ht().mapValue.fields,updateTime:xo(t,e.version._t())}}(t.ro,e),s=e.hasCommittedMutations;return new eu(null,null,n,s,r,i)}if(e instanceof Vi){const t=e.key.path.gt(),n=yu(e.version),s=e.hasCommittedMutations;return new eu(null,new Za(t,n),null,s,r,i)}if(e instanceof Fi){const t=e.key.path.gt(),n=yu(e.version);return new eu(new tu(t,n),null,null,!0,r,i)}return kr()}function mu(t){const e=t._t();return[e.seconds,e.nanoseconds]}function vu(t){const e=new ri(t[0],t[1]);return ii.at(e)}function yu(t){const e=t._t();return new Ka(e.seconds,e.nanoseconds)}function wu(t){const e=new ri(t.seconds,t.nanoseconds);return ii.at(e)}function bu(t,e){const n=(e.baseMutations||[]).map(e=>Ko(t.ro,e));for(let t=e.mutations.length-1;t>=0;--t){const n=e.mutations[t];void 0!==(null==n?void 0:n.transform)&&(e.mutations[t-1].updateTransforms=n.transform.fieldTransforms,e.mutations.splice(t,1),--t)}const r=e.mutations.map(e=>Ko(t.ro,e)),i=ri.fromMillis(e.localWriteTimeMs);return new ka(e.batchId,i,n,r)}function Eu(t){const e=wu(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?wu(t.lastLimboFreeSnapshotVersion):ii.min();let r;var i;return void 0!==t.query.documents?(Nr(1===(i=t.query).documents.length),r=gs(us($o(i.documents[0])))):r=function(t){return gs(Jo(t))}(t.query),new _s(r,t.targetId,0,t.lastListenSequenceNumber,e,n,pi.fromBase64String(t.resumeToken))}function Iu(t,e){const n=yu(e.ie),r=yu(e.lastLimboFreeSnapshotVersion);let i;i=Hi(e.target)?Xo(t.ro,e.target):Yo(t.ro,e.target);const s=e.resumeToken.toBase64();return new ru(e.targetId,Bi(e.target),n,s,e.sequenceNumber,r,i)}function _u(t){const e=Jo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ms(e,e.limit,"L"):e}class Tu{oo(t,e){return Su(t).get(e).next(t=>{if(t)return{id:(e=t).bundleId,createTime:wu(e.createTime),version:e.version};var e})}co(t,e){return Su(t).put({bundleId:(n=e).id,createTime:yu(Mo(n.createTime)),version:n.version});var n}uo(t,e){return Au(t).get(e).next(t=>{if(t)return{name:(e=t).name,query:_u(e.bundledQuery),readTime:wu(e.readTime)};var e})}ao(t,e){return Au(t).put(function(t){return{name:t.name,readTime:yu(Mo(t.readTime)),bundledQuery:t.bundledQuery}}(e))}}function Su(t){return fu(t,uu.store)}function Au(t){return fu(t,cu.store)}class ku{constructor(){this.ho=new Nu}lo(t,e){return this.ho.add(e),ia.resolve()}_o(t,e){return ia.resolve(this.ho.getEntries(e))}}class Nu{constructor(){this.index={}}add(t){const e=t.At(),n=t.Tt(),r=this.index[e]||new ao(oi.dt),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.At(),n=t.Tt(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new ao(oi.dt)).gt()}}class Ru{constructor(){this.fo=new Nu}lo(t,e){if(!this.fo.has(e)){const n=e.At(),r=e.Tt();t.xi(()=>{this.fo.add(e)});const i={collectionId:n,parent:Ha(r)};return Ou(t).put(i)}return ia.resolve()}_o(t,e){const n=[],r=IDBKeyRange.bound([e,""],[ni(e),""],!1,!0);return Ou(t).bs(r).next(t=>{for(const r of t){if(r.collectionId!==e)break;n.push(Wa(r.parent))}return n})}}function Ou(t){return fu(t,ou.store)}function Pu(t,e,n){const r=t.store(Ja.store),i=t.store(Qa.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Ns({range:o},(t,e,n)=>(a++,n.delete()));s.push(u.next(()=>{Nr(1===a)}));const c=[];for(const t of n.mutations){const r=Qa.key(e,t.key.path,n.batchId);s.push(i.delete(r)),c.push(t.key)}return ia.cs(s).next(()=>c)}function Cu(t){let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}class Du{constructor(t,e,n,r){this.userId=t,this.le=e,this.wo=n,this.Eo=r,this.To={}}static Io(t,e,n,r){Nr(""!==t.uid);const i=t.t()?t.uid:"";return new Du(i,e,n,r)}Ao(t){let e=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xu(t).Ns({index:Ja.userMutationsIndex,range:n},(t,n,r)=>{e=!1,r.done()}).next(()=>e)}mo(t,e,n,r){const i=Uu(t),s=xu(t);return s.add({}).next(o=>{Nr("number"==typeof o);const a=new ka(o,e,n,r),u=function(t,e,n){const r=n.baseMutations.map(e=>Wo(t.ro,e)),i=n.mutations.map(e=>Wo(t.ro,e));return new Ja(e,n.batchId,n.Xi.toMillis(),r,i)}(this.le,this.userId,a),c=[];let h=new ao((t,e)=>ti(t.yt(),e.yt()));for(const t of r){const e=Qa.key(this.userId,t.key.path,o);h=h.add(t.key.path.Tt()),c.push(s.put(u)),c.push(i.put(e,Qa.PLACEHOLDER))}return h.forEach(e=>{c.push(this.wo.lo(t,e))}),t.xi(()=>{this.To[o]=a.keys()}),ia.cs(c).next(()=>a)})}Ro(t,e){return xu(t).get(e).next(t=>t?(Nr(t.userId===this.userId),bu(this.le,t)):null)}Po(t,e){return this.To[e]?ia.resolve(this.To[e]):this.Ro(t,e).next(t=>{if(t){const n=t.keys();return this.To[e]=n,n}return null})}Vo(t,e){const n=e+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return xu(t).Ns({index:Ja.userMutationsIndex,range:r},(t,e,r)=>{e.userId===this.userId&&(Nr(e.batchId>=n),i=bu(this.le,e)),r.done()}).next(()=>i)}yo(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return xu(t).Ns({index:Ja.userMutationsIndex,range:e,reverse:!0},(t,e,r)=>{n=e.batchId,r.done()}).next(()=>n)}po(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xu(t).bs(Ja.userMutationsIndex,e).next(t=>t.map(t=>bu(this.le,t)))}vo(t,e){const n=Qa.prefixForPath(this.userId,e.path),r=IDBKeyRange.lowerBound(n),i=[];return Uu(t).Ns({range:r},(n,r,s)=>{const[o,a,u]=n,c=Wa(a);if(o===this.userId&&e.path.isEqual(c))return xu(t).get(u).next(t=>{if(!t)throw kr();Nr(t.userId===this.userId),i.push(bu(this.le,t))});s.done()}).next(()=>i)}bo(t,e){let n=new ao(ti);const r=[];return e.forEach(e=>{const i=Qa.prefixForPath(this.userId,e.path),s=IDBKeyRange.lowerBound(i),o=Uu(t).Ns({range:s},(t,r,i)=>{const[s,o,a]=t,u=Wa(o);s===this.userId&&e.path.isEqual(u)?n=n.add(a):i.done()});r.push(o)}),ia.cs(r).next(()=>this.So(t,n))}Do(t,e){const n=e.path,r=n.length+1,i=Qa.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new ao(ti);return Uu(t).Ns({range:s},(t,e,i)=>{const[s,a,u]=t,c=Wa(a);s===this.userId&&n.Pt(c)?c.length===r&&(o=o.add(u)):i.done()}).next(()=>this.So(t,o))}So(t,e){const n=[],r=[];return e.forEach(e=>{r.push(xu(t).get(e).next(t=>{if(null===t)throw kr();Nr(t.userId===this.userId),n.push(bu(this.le,t))}))}),ia.cs(r).next(()=>n)}Co(t,e){return Pu(t.so,this.userId,e).next(n=>(t.xi(()=>{this.No(e.batchId)}),ia.forEach(n,e=>this.Eo.xo(t,e))))}No(t){delete this.To[t]}ko(t){return this.Ao(t).next(e=>{if(!e)return ia.resolve();const n=IDBKeyRange.lowerBound(Qa.prefixForUser(this.userId)),r=[];return Uu(t).Ns({range:n},(t,e,n)=>{if(t[0]===this.userId){const e=Wa(t[1]);r.push(e)}else n.done()}).next(()=>{Nr(0===r.length)})})}Oo(t,e){return Lu(t,this.userId,e)}Mo(t){return Mu(t).get(this.userId).next(t=>t||new Ya(this.userId,-1,""))}}function Lu(t,e,n){const r=Qa.prefixForPath(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Uu(t).Ns({range:s,Cs:!0},(t,n,r)=>{const[s,a,u]=t;s===e&&a===i&&(o=!0),r.done()}).next(()=>o)}function xu(t){return fu(t,Ja.store)}function Uu(t){return fu(t,Qa.store)}function Mu(t){return fu(t,Ya.store)}class Vu{constructor(t){this.Fo=t}next(){return this.Fo+=2,this.Fo}static $o(){return new Vu(0)}static Lo(){return new Vu(-1)}}class Fu{constructor(t,e){this.Eo=t,this.le=e}Bo(t){return this.qo(t).next(e=>{const n=new Vu(e.highestTargetId);return e.highestTargetId=n.next(),this.Uo(t,e).next(()=>e.highestTargetId)})}Ko(t){return this.qo(t).next(t=>ii.at(new ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}Qo(t){return this.qo(t).next(t=>t.highestListenSequenceNumber)}Wo(t,e,n){return this.qo(t).next(r=>(r.highestListenSequenceNumber=e,n&&(r.lastRemoteSnapshotVersion=n._t()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Uo(t,r)))}jo(t,e){return this.Go(t,e).next(()=>this.qo(t).next(n=>(n.targetCount+=1,this.zo(e,n),this.Uo(t,n))))}Ho(t,e){return this.Go(t,e)}Jo(t,e){return this.Yo(t,e.targetId).next(()=>qu(t).delete(e.targetId)).next(()=>this.qo(t)).next(e=>(Nr(e.targetCount>0),e.targetCount-=1,this.Uo(t,e)))}Fr(t,e,n){let r=0;const i=[];return qu(t).Ns((s,o)=>{const a=Eu(o);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r++,i.push(this.Jo(t,a)))}).next(()=>ia.cs(i)).next(()=>r)}Bn(t,e){return qu(t).Ns((t,n)=>{const r=Eu(n);e(r)})}qo(t){return ju(t).get(su.key).next(t=>(Nr(null!==t),t))}Uo(t,e){return ju(t).put(su.key,e)}Go(t,e){return qu(t).put(Iu(this.le,e))}zo(t,e){let n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n}Xo(t){return this.qo(t).next(t=>t.targetCount)}Zo(t,e){const n=Bi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return qu(t).Ns({range:r,index:ru.queryTargetsIndexName},(t,n,r)=>{const s=Eu(n);$i(e,s.target)&&(i=s,r.done())}).next(()=>i)}tc(t,e,n){const r=[],i=Bu(t);return e.forEach(e=>{const s=Ha(e.path);r.push(i.put(new iu(n,s))),r.push(this.Eo.ec(t,n,e))}),ia.cs(r)}nc(t,e,n){const r=Bu(t);return ia.forEach(e,e=>{const i=Ha(e.path);return ia.cs([r.delete([n,i]),this.Eo.sc(t,n,e)])})}Yo(t,e){const n=Bu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)}ic(t,e){const n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Bu(t);let i=vo();return r.Ns({range:n,Cs:!0},(t,e,n)=>{const r=Wa(t[1]),s=new ci(r);i=i.add(s)}).next(()=>i)}Oo(t,e){const n=Ha(e.path),r=IDBKeyRange.bound([n],[ni(n)],!1,!0);let i=0;return Bu(t).Ns({index:iu.documentTargetsIndex,Cs:!0,range:r},([t,e],n,r)=>{0!==t&&(i++,r.done())}).next(()=>i>0)}Yn(t,e){return qu(t).get(e).next(t=>t?Eu(t):null)}}function qu(t){return fu(t,ru.store)}function ju(t){return fu(t,su.store)}function Bu(t){return fu(t,iu.store)}class $u{constructor(t,e){this.db=t,this.yr=function(t,e){return new La(t,e)}(this,e)}kr(t){const e=this.rc(t);return this.db.oc().Xo(t).next(t=>e.next(e=>t+e))}rc(t){let e=0;return this.Mr(t,t=>{e++}).next(()=>e)}Bn(t,e){return this.db.oc().Bn(t,e)}Mr(t,e){return this.cc(t,(t,n)=>e(n))}ec(t,e,n){return Hu(t,n)}sc(t,e,n){return Hu(t,n)}Fr(t,e,n){return this.db.oc().Fr(t,e,n)}xo(t,e){return Hu(t,e)}uc(t,e){return function(t,e){let n=!1;return Mu(t).xs(r=>Lu(t,r,e).next(t=>(t&&(n=!0),ia.resolve(!t)))).next(()=>n)}(t,e)}$r(t,e){const n=this.db.hc().ac(),r=[];let i=0;return this.cc(t,(s,o)=>{if(o<=e){const e=this.uc(t,s).next(e=>{if(!e)return i++,n.Tr(t,s).next(()=>(n.Er(s),Bu(t).delete([0,Ha(s.path)])))});r.push(e)}}).next(()=>ia.cs(r)).next(()=>n.apply(t)).next(()=>i)}removeTarget(t,e){const n=e.re(t.io);return this.db.oc().Ho(t,n)}lc(t,e){return Hu(t,e)}cc(t,e){const n=Bu(t);let r,i=Sa.Yi;return n.Ns({index:iu.documentTargetsIndex},([t,n],{path:s,sequenceNumber:o})=>{0===t?(i!==Sa.Yi&&e(new ci(Wa(r)),i),i=o,r=s):i=Sa.Yi}).next(()=>{i!==Sa.Yi&&e(new ci(Wa(r)),i)})}Br(t){return this.db.hc()._c(t)}}function Hu(t,e){return Bu(t).put(function(t,e){return new iu(0,Ha(t.path),e)}(e,t.io))}class Gu{constructor(t,e){this.le=t,this.wo=e}_r(t,e,n){return Ku(t).put(Xu(e),n)}Er(t,e){const n=Ku(t),r=Xu(e);return n.delete(r)}updateMetadata(t,e){return this.getMetadata(t).next(n=>(n.byteSize+=e,this.fc(t,n)))}Tr(t,e){return Ku(t).get(Xu(e)).next(t=>this.dc(t))}wc(t,e){return Ku(t).get(Xu(e)).next(t=>{const e=this.dc(t);return e?{wr:e,size:Cu(t)}:null})}getEntries(t,e){let n=lo();return this.Ec(t,e,(t,e)=>{const r=this.dc(e);n=n.Ee(t,r)}).next(()=>n)}Tc(t,e){let n=lo(),r=new io(ci.dt);return this.Ec(t,e,(t,e)=>{const i=this.dc(e);i?(n=n.Ee(t,i),r=r.Ee(t,Cu(e))):(n=n.Ee(t,null),r=r.Ee(t,0))}).next(()=>({Ic:n,Ac:r}))}Ec(t,e,n){if(e.Rt())return ia.resolve();const r=IDBKeyRange.bound(e.first().path.gt(),e.last().path.gt()),i=e.Pe();let s=i.be();return Ku(t).Ns({range:r},(t,e,r)=>{const o=ci.Ft(t);for(;s&&ci.dt(s,o)<0;)n(s,null),s=i.be();s&&s.isEqual(o)&&(n(s,e),s=i.Se()?i.be():null),s?r.vs(s.path.gt()):r.done()}).next(()=>{for(;s;)n(s,null),s=i.Se()?i.be():null})}mc(t,e,n){let r=po();const i=e.path.length+1,s={};if(n.isEqual(ii.min())){const t=e.path.gt();s.range=IDBKeyRange.lowerBound(t)}else{const t=e.path.gt(),r=mu(n);s.range=IDBKeyRange.lowerBound([t,r],!0),s.index=eu.collectionReadTimeIndex}return Ku(t).Ns(s,(t,n,s)=>{if(t.length!==i)return;const o=pu(this.le,n);e.path.Pt(o.key.path)?o instanceof Mi&&bs(e,o)&&(r=r.Ee(o.key,o)):s.done()}).next(()=>r)}ac(t){return new zu(this,!!t&&t.Rc)}_c(t){return this.getMetadata(t).next(t=>t.byteSize)}getMetadata(t){return Wu(t).get(nu.key).next(t=>(Nr(!!t),t))}fc(t,e){return Wu(t).put(nu.key,e)}dc(t){if(t){const e=pu(this.le,t);return e instanceof Vi&&e.version.isEqual(ii.min())?null:e}return null}}class zu extends Oa{constructor(t,e){super(),this.Pc=t,this.Rc=e,this.Vc=new Ra(t=>t.toString(),(t,e)=>t.isEqual(e))}mr(t){const e=[];let n=0,r=new ao((t,e)=>ti(t.yt(),e.yt()));return this.ar.forEach((i,s)=>{const o=this.Vc.get(i);if(s.wr){const a=gu(this.Pc.le,s.wr,this.lr(i));r=r.add(i.path.Tt());const u=Cu(a);n+=u-o,e.push(this.Pc._r(t,i,a))}else if(n-=o,this.Rc){const n=gu(this.Pc.le,new Vi(i,ii.min()),this.lr(i));e.push(this.Pc._r(t,i,n))}else e.push(this.Pc.Er(t,i))}),r.forEach(n=>{e.push(this.Pc.wo.lo(t,n))}),e.push(this.Pc.updateMetadata(t,n)),ia.cs(e)}Ir(t,e){return this.Pc.wc(t,e).next(t=>null===t?(this.Vc.set(e,0),null):(this.Vc.set(e,t.size),t.wr))}Ar(t,e){return this.Pc.Tc(t,e).next(({Ic:t,Ac:e})=>(e.forEach((t,e)=>{this.Vc.set(t,e)}),t))}}function Wu(t){return fu(t,nu.store)}function Ku(t){return fu(t,eu.store)}function Xu(t){return t.path.gt()}class Yu{constructor(t){this.le=t}As(t,e,n,r){Nr(n<r&&n>=0&&r<=11);const i=new sa("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Xa.store)}(t),function(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}),t.createObjectStore(Ja.store,{keyPath:Ja.keyPath,autoIncrement:!0}).createIndex(Ja.userMutationsIndex,Ja.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Qa.store)}(t),Ju(t),function(t){t.createObjectStore(eu.store)}(t));let s=ia.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(iu.store),t.deleteObjectStore(ru.store),t.deleteObjectStore(su.store)}(t),Ju(t)),s=s.next(()=>(function(t){const e=i.store(su.store),n=new su(0,0,ii.min()._t(),0);return e.put(su.key,n)})())),n<4&&r>=4&&(0!==n&&(s=s.next(()=>(function(t,e){return e.store(Ja.store).bs().next(n=>{t.deleteObjectStore(Ja.store),t.createObjectStore(Ja.store,{keyPath:Ja.keyPath,autoIncrement:!0}).createIndex(Ja.userMutationsIndex,Ja.userMutationsKeyPath,{unique:!0});const r=e.store(Ja.store),i=n.map(t=>r.put(t));return ia.cs(i)})})(t,i))),s=s.next(()=>{!function(t){t.createObjectStore(au.store,{keyPath:au.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(()=>this.gc(i))),n<6&&r>=6&&(s=s.next(()=>((function(t){t.createObjectStore(nu.store)})(t),this.yc(i)))),n<7&&r>=7&&(s=s.next(()=>this.vc(i))),n<8&&r>=8&&(s=s.next(()=>this.bc(t,i))),n<9&&r>=9&&(s=s.next(()=>{!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){const e=t.objectStore(eu.store);e.createIndex(eu.readTimeIndex,eu.readTimeIndexPath,{unique:!1}),e.createIndex(eu.collectionReadTimeIndex,eu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(()=>this.Sc(i))),n<11&&r>=11&&(s=s.next(()=>{!function(t){t.createObjectStore(uu.store,{keyPath:uu.keyPath})}(t),function(t){t.createObjectStore(cu.store,{keyPath:cu.keyPath})}(t)})),s}yc(t){let e=0;return t.store(eu.store).Ns((t,n)=>{e+=Cu(n)}).next(()=>{const n=new nu(e);return t.store(nu.store).put(nu.key,n)})}gc(t){const e=t.store(Ya.store),n=t.store(Ja.store);return e.bs().next(e=>ia.forEach(e,e=>{const r=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return n.bs(Ja.userMutationsIndex,r).next(n=>ia.forEach(n,n=>{Nr(n.userId===e.userId);const r=bu(this.le,n);return Pu(t,e.userId,r).next(()=>{})}))}))}vc(t){const e=t.store(iu.store),n=t.store(eu.store);return t.store(su.store).get(su.key).next(t=>{const r=[];return n.Ns((n,i)=>{const s=new oi(n),o=function(t){return[0,Ha(s)]}();r.push(e.get(o).next(n=>n?ia.resolve():(n=>e.put(new iu(0,Ha(n),t.highestListenSequenceNumber)))(s)))}).next(()=>ia.cs(r))})}bc(t,e){t.createObjectStore(ou.store,{keyPath:ou.keyPath});const n=e.store(ou.store),r=new Nu,i=t=>{if(r.add(t)){const e=t.At(),r=t.Tt();return n.put({collectionId:e,parent:Ha(r)})}};return e.store(eu.store).Ns({Cs:!0},(t,e)=>{const n=new oi(t);return i(n.Tt())}).next(()=>e.store(Qa.store).Ns({Cs:!0},([t,e,n],r)=>{const s=Wa(e);return i(s.Tt())}))}Sc(t){const e=t.store(ru.store);return e.Ns((t,n)=>{const r=Eu(n),i=Iu(this.le,r);return e.put(i)})}}function Ju(t){t.createObjectStore(iu.store,{keyPath:iu.keyPath}).createIndex(iu.documentTargetsIndex,iu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ru.store,{keyPath:ru.keyPath}).createIndex(ru.queryTargetsIndexName,ru.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(su.store)}const Qu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Zu{constructor(t,e,n,r,i,s,o,a,u,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Qs=i,this.window=s,this.document=o,this.Dc=u,this.Cc=c,this.Nc=null,this.xc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kc=null,this.inForeground=!1,this.Oc=null,this.Mc=null,this.Fc=Number.NEGATIVE_INFINITY,this.$c=(t=>Promise.resolve()),!Zu.L())throw new Pr(Or.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Eo=new $u(this,r),this.Lc=e+"main",this.le=new du(a),this.Bc=new oa(this.Lc,11,new Yu(this.le)),this.qc=new Fu(this.Eo,this.le),this.wo=new Ru,this.Uc=function(t,e){return new Gu(t,e)}(this.le,this.wo),this.Kc=new Tu,this.window&&this.window.localStorage?this.Qc=this.window.localStorage:(this.Qc=null,!1===c&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wc().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Pr(Or.FAILED_PRECONDITION,Qu);return this.jc(),this.Gc(),this.zc(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.qc.Qo(t))}).then(t=>{this.Nc=new Sa(t,this.Dc)}).then(()=>{this.xc=!0}).catch(t=>(this.Bc&&this.Bc.close(),Promise.reject(t)))}Hc(t){return this.$c=(async e=>{if(this.Sr)return t(e)}),t(this.isPrimary)}Jc(t){this.Bc.Ps(async e=>{null===e.newVersion&&await t()})}Yc(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.Qs.Ks(async()=>{this.Sr&&await this.Wc()}))}Wc(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>ec(t).put(new au(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.Xc(t).next(t=>{t||(this.isPrimary=!1,this.Qs.Zc(()=>this.$c(!1)))})}).next(()=>this.tu(t)).next(e=>this.isPrimary&&!e?this.eu(t).next(()=>!1):!!e&&this.nu(t).next(()=>!0))).catch(t=>{if(ca(t))return _r("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return _r("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.Qs.Zc(()=>this.$c(t)),this.isPrimary=t})}Xc(t){return tc(t).get(Xa.key).next(t=>ia.resolve(this.su(t)))}iu(t){return ec(t).delete(this.clientId)}async ru(){if(this.isPrimary&&!this.ou(this.Fc,18e5)){this.Fc=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const e=fu(t,au.store);return e.bs().next(t=>{const n=this.cu(t,18e5),r=t.filter(t=>-1===n.indexOf(t));return ia.forEach(r,t=>e.delete(t.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Qc)for(const e of t)this.Qc.removeItem(this.uu(e.clientId))}}zc(){this.Mc=this.Qs.ti("client_metadata_refresh",4e3,()=>this.Wc().then(()=>this.ru()).then(()=>this.zc()))}su(t){return!!t&&t.ownerId===this.clientId}tu(t){return this.Cc?ia.resolve(!0):tc(t).get(Xa.key).next(e=>{if(null!==e&&this.ou(e.leaseTimestampMs,5e3)&&!this.au(e.ownerId)){if(this.su(e)&&this.networkEnabled)return!0;if(!this.su(e)){if(!e.allowTabSynchronization)throw new Pr(Or.FAILED_PRECONDITION,Qu);return!1}}return!(!this.networkEnabled||!this.inForeground)||ec(t).bs().next(t=>void 0===this.cu(t,5e3).find(t=>{if(this.clientId!==t.clientId){const e=!this.networkEnabled&&t.networkEnabled,n=!this.inForeground&&t.inForeground,r=this.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&_r("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async C(){this.xc=!1,this.hu(),this.Mc&&(this.Mc.cancel(),this.Mc=null),this.lu(),this._u(),await this.Bc.runTransaction("shutdown","readwrite",[Xa.store,au.store],t=>{const e=new lu(t,Sa.Yi);return this.eu(e).next(()=>this.iu(e))}),this.Bc.close(),this.fu()}cu(t,e){return t.filter(t=>this.ou(t.updateTimeMs,e)&&!this.au(t.clientId))}du(){return this.runTransaction("getActiveClients","readonly",t=>ec(t).bs().next(t=>this.cu(t,18e5).map(t=>t.clientId)))}get Sr(){return this.xc}wu(t){return Du.Io(t,this.le,this.wo,this.Eo)}oc(){return this.qc}hc(){return this.Uc}Eu(){return this.wo}Tu(){return this.Kc}runTransaction(t,e,n){_r("IndexedDbPersistence","Starting transaction:",t);const r="readonly"===e?"readonly":"readwrite";let i;return this.Bc.runTransaction(t,r,hu,r=>(i=new lu(r,this.Nc?this.Nc.next():Sa.Yi),"readwrite-primary"===e?this.Xc(i).next(t=>!!t||this.tu(i)).next(e=>{if(!e)throw Tr(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Qs.Zc(()=>this.$c(!1)),new Pr(Or.FAILED_PRECONDITION,Ea);return n(i)}).next(t=>this.nu(i).next(()=>t)):this.Iu(i).next(()=>n(i)))).then(t=>(i.ki(),t))}Iu(t){return tc(t).get(Xa.key).next(t=>{if(null!==t&&this.ou(t.leaseTimestampMs,5e3)&&!this.au(t.ownerId)&&!this.su(t)&&!(this.Cc||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Pr(Or.FAILED_PRECONDITION,Qu)})}nu(t){const e=new Xa(this.clientId,this.allowTabSynchronization,Date.now());return tc(t).put(Xa.key,e)}static L(){return oa.L()}eu(t){const e=tc(t);return e.get(Xa.key).next(t=>this.su(t)?(_r("IndexedDbPersistence","Releasing primary lease."),e.delete(Xa.key)):ia.resolve())}ou(t,e){const n=Date.now();return!(t<n-e||t>n&&(Tr(`Detected an update time that is in the future: ${t} > ${n}`),1))}jc(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Oc=(()=>{this.Qs.Ks(()=>(this.inForeground="visible"===this.document.visibilityState,this.Wc()))}),this.document.addEventListener("visibilitychange",this.Oc),this.inForeground="visible"===this.document.visibilityState)}lu(){this.Oc&&(this.document.removeEventListener("visibilitychange",this.Oc),this.Oc=null)}Gc(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.kc=(()=>{this.hu(),this.Qs.Ks(()=>this.C())}),this.window.addEventListener("unload",this.kc))}_u(){this.kc&&(this.window.removeEventListener("unload",this.kc),this.kc=null)}au(t){var e;try{const n=null!==(null===(e=this.Qc)||void 0===e?void 0:e.getItem(this.uu(t)));return _r("IndexedDbPersistence",`Client '${t}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}}hu(){if(this.Qc)try{this.Qc.setItem(this.uu(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}}fu(){if(this.Qc)try{this.Qc.removeItem(this.uu(this.clientId))}catch(t){}}uu(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function tc(t){return fu(t,Xa.store)}function ec(t){return fu(t,au.store)}function nc(t,e){let n=t.projectId;return t.S||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class rc{constructor(t,e,n){this.Uc=t,this.Au=e,this.wo=n}mu(t,e){return this.Au.vo(t,e).next(n=>this.Ru(t,e,n))}Ru(t,e,n){return this.Uc.Tr(t,e).next(t=>{for(const r of n)t=r.er(e,t);return t})}Pu(t,e,n){let r=lo();return e.forEach((t,e)=>{for(const r of n)e=r.er(t,e);r=r.Ee(t,e)}),r}Vu(t,e){return this.Uc.getEntries(t,e).next(e=>this.gu(t,e))}gu(t,e){return this.Au.bo(t,e).next(n=>{const r=this.Pu(t,e,n);let i=ho();return r.forEach((t,e)=>{e||(e=new Vi(t,ii.min())),i=i.Ee(t,e)}),i})}mc(t,e,n){return function(t){return ci.Mt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.yu(t,e.path):ds(e)?this.pu(t,e,n):this.vu(t,e,n)}yu(t,e){return this.mu(t,new ci(e)).next(t=>{let e=po();return t instanceof Mi&&(e=e.Ee(t.key,t)),e})}pu(t,e,n){const r=e.collectionGroup;let i=po();return this.wo._o(t,r).next(s=>ia.forEach(s,s=>{const o=function(t,e){return new os(e,null,t.te.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(r));return this.vu(t,o,n).next(t=>{t.forEach((t,e)=>{i=i.Ee(t,e)})})}).next(()=>i))}vu(t,e,n){let r,i;return this.Uc.mc(t,e,n).next(n=>(r=n,this.Au.Do(t,e))).next(e=>(i=e,this.bu(t,i,r).next(t=>{r=t;for(const t of i)for(const e of t.mutations){const n=e.key,i=r.get(n),s=Gs(e,i,i,t.Xi);r=s instanceof Mi?r.Ee(n,s):r.remove(n)}}))).next(()=>(r.forEach((t,n)=>{bs(e,n)||(r=r.remove(t))}),r))}bu(t,e,n){let r=vo();for(const t of e)for(const e of t.mutations)e instanceof Ys&&null===n.get(e.key)&&(r=r.add(e.key));let i=n;return this.Uc.getEntries(t,r).next(t=>(t.forEach((t,e)=>{null!==e&&e instanceof Mi&&(i=i.Ee(t,e))}),i))}}class ic{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Su=n,this.Du=r}static Cu(t,e){let n=vo(),r=vo();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new ic(t,e.fromCache,n,r)}}class sc{Nu(t){this.xu=t}mc(t,e,n,r){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.te.length||1===t.te.length&&t.te[0].field.Dt())}(e)||n.isEqual(ii.min())?this.ku(t,e):this.xu.Vu(t,r).next(i=>{const s=this.Ou(e,i);return(cs(e)||hs(e))&&this.Mu(e.limitType,s,r,n)?this.ku(t,e):(Ir()<=u.DEBUG&&_r("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ws(e)),this.xu.mc(t,e,n).next(t=>(s.forEach(e=>{t=t.Ee(e.key,e)}),t)))})}Ou(t,e){let n=new ao(Es(t));return e.forEach((e,r)=>{r instanceof Mi&&bs(t,r)&&(n=n.add(r))}),n}Mu(t,e,n,r){if(n.size!==e.size)return!0;const i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.ht(r)>0)}ku(t,e){return Ir()<=u.DEBUG&&_r("QueryEngine","Using full collection scan to execute query:",ws(e)),this.xu.mc(t,e,ii.min())}}class oc{constructor(t,e,n,r){this.persistence=t,this.Fu=e,this.le=r,this.$u=new io(ti),this.Lu=new Ra(t=>Bi(t),$i),this.Bu=ii.min(),this.Au=t.wu(n),this.qu=t.hc(),this.qc=t.oc(),this.Uu=new rc(this.qu,this.Au,this.persistence.Eu()),this.Kc=t.Tu(),this.Fu.Nu(this.Uu)}Dr(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.Lr(e,this.$u))}}function ac(t,e,n,r){return new oc(t,e,n,r)}async function uc(t,e){const n=Rr(t);let r=n.Au,i=n.Uu;const s=await n.persistence.runTransaction("Handle user change","readonly",t=>{let s;return n.Au.po(t).next(o=>(s=o,r=n.persistence.wu(e),i=new rc(n.qu,r,n.persistence.Eu()),r.po(t))).next(e=>{const n=[],r=[];let o=vo();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return i.Vu(t,o).next(t=>({Ku:t,Qu:n,Wu:r}))})});return n.Au=r,n.Uu=i,n.Fu.Nu(n.Uu),s}function cc(t){const e=Rr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qc.Ko(t))}function hc(t,e){const n=Rr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=-1),n.Au.Vo(t,e)))}function lc(t,e){const n=Rr(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return n.qc.Zo(t,e).next(i=>i?(r=i,ia.resolve(r)):n.qc.Bo(t).next(i=>(r=new _s(e,i,0,t.io),n.qc.jo(t,r).next(()=>r))))}).then(t=>{const r=n.$u.get(t.targetId);return(null===r||t.ie.ht(r.ie)>0)&&(n.$u=n.$u.Ee(t.targetId,t),n.Lu.set(e,t.targetId)),t})}async function fc(t,e,n){const r=Rr(t),i=r.$u.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,t=>r.persistence.Eo.removeTarget(t,i))}catch(t){if(!ca(t))throw t;_r("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}r.$u=r.$u.remove(e),r.Lu.delete(i.target)}function dc(t,e,n){const r=Rr(t);let i=ii.min(),s=vo();return r.persistence.runTransaction("Execute query","readonly",t=>(function(t,e,n){const r=Rr(t),i=r.Lu.get(n);return void 0!==i?ia.resolve(r.$u.get(i)):r.qc.Zo(e,n)})(r,t,gs(e)).next(e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,r.qc.ic(t,e.targetId).next(t=>{s=t})}).next(()=>r.Fu.mc(t,e,n?i:ii.min(),n?s:vo())).next(t=>({documents:t,ju:s})))}function pc(t,e){const n=Rr(t),r=Rr(n.qc),i=n.$u.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",t=>r.Yn(t,e).next(t=>t?t.target:null))}function gc(t){const e=Rr(t);return e.persistence.runTransaction("Get new document changes","readonly",t=>(function(t,e,n){const r=Rr(t);let i=ho(),s=mu(n);const o=Ku(e),a=IDBKeyRange.lowerBound(s,!0);return o.Ns({index:eu.readTimeIndex,range:a},(t,e)=>{const n=pu(r.le,e);i=i.Ee(n.key,n),s=e.readTime}).next(()=>({Gu:i,readTime:vu(s)}))})(e.qu,t,e.Bu)).then(({Gu:t,readTime:n})=>(e.Bu=n,t))}class mc{constructor(t){this.le=t,this.zu=new Map,this.Hu=new Map}oo(t,e){return ia.resolve(this.zu.get(e))}co(t,e){var n;return this.zu.set(e.id,{id:(n=e).id,version:n.version,createTime:Mo(n.createTime)}),ia.resolve()}uo(t,e){return ia.resolve(this.Hu.get(e))}ao(t,e){var n;return this.Hu.set(e.name,{name:(n=e).name,query:_u(n.bundledQuery),readTime:Mo(n.readTime)}),ia.resolve()}}class vc{constructor(){this.Ju=new ao(yc.Yu),this.Xu=new ao(yc.Zu)}Rt(){return this.Ju.Rt()}ec(t,e){const n=new yc(t,e);this.Ju=this.Ju.add(n),this.Xu=this.Xu.add(n)}ta(t,e){t.forEach(t=>this.ec(t,e))}sc(t,e){this.ea(new yc(t,e))}na(t,e){t.forEach(t=>this.sc(t,e))}sa(t){const e=new ci(new oi([])),n=new yc(e,t),r=new yc(e,t+1),i=[];return this.Xu.qe([n,r],t=>{this.ea(t),i.push(t.key)}),i}ia(){this.Ju.forEach(t=>this.ea(t))}ea(t){this.Ju=this.Ju.delete(t),this.Xu=this.Xu.delete(t)}ra(t){const e=new ci(new oi([])),n=new yc(e,t),r=new yc(e,t+1);let i=vo();return this.Xu.qe([n,r],t=>{i=i.add(t.key)}),i}Oo(t){const e=new yc(t,0),n=this.Ju.Ke(e);return null!==n&&t.isEqual(n.key)}}class yc{constructor(t,e){this.key=t,this.oa=e}static Yu(t,e){return ci.dt(t.key,e.key)||ti(t.oa,e.oa)}static Zu(t,e){return ti(t.oa,e.oa)||ci.dt(t.key,e.key)}}class wc{constructor(t,e){this.wo=t,this.Eo=e,this.Au=[],this.ca=1,this.ua=new ao(yc.Yu)}Ao(t){return ia.resolve(0===this.Au.length)}mo(t,e,n,r){const i=this.ca;this.ca++,this.Au.length>0&&this.Au[this.Au.length-1];const s=new ka(i,e,n,r);this.Au.push(s);for(const e of r)this.ua=this.ua.add(new yc(e.key,i)),this.wo.lo(t,e.key.path.Tt());return ia.resolve(s)}Ro(t,e){return ia.resolve(this.aa(e))}Vo(t,e){const n=e+1,r=this.ha(n),i=r<0?0:r;return ia.resolve(this.Au.length>i?this.Au[i]:null)}yo(){return ia.resolve(0===this.Au.length?-1:this.ca-1)}po(t){return ia.resolve(this.Au.slice())}vo(t,e){const n=new yc(e,0),r=new yc(e,Number.POSITIVE_INFINITY),i=[];return this.ua.qe([n,r],t=>{const e=this.aa(t.oa);i.push(e)}),ia.resolve(i)}bo(t,e){let n=new ao(ti);return e.forEach(t=>{const e=new yc(t,0),r=new yc(t,Number.POSITIVE_INFINITY);this.ua.qe([e,r],t=>{n=n.add(t.oa)})}),ia.resolve(this.la(n))}Do(t,e){const n=e.path,r=n.length+1;let i=n;ci.Mt(i)||(i=i.child(""));const s=new yc(new ci(i),0);let o=new ao(ti);return this.ua.Ue(t=>{const e=t.key.path;return!!n.Pt(e)&&(e.length===r&&(o=o.add(t.oa)),!0)},s),ia.resolve(this.la(o))}la(t){const e=[];return t.forEach(t=>{const n=this.aa(t);null!==n&&e.push(n)}),e}Co(t,e){Nr(0===this._a(e.batchId,"removed")),this.Au.shift();let n=this.ua;return ia.forEach(e.mutations,r=>{const i=new yc(r.key,e.batchId);return n=n.delete(i),this.Eo.xo(t,r.key)}).next(()=>{this.ua=n})}No(t){}Oo(t,e){const n=new yc(e,0),r=this.ua.Ke(n);return ia.resolve(e.isEqual(r&&r.key))}ko(t){return this.Au.length,ia.resolve()}_a(t,e){return this.ha(t)}ha(t){return 0===this.Au.length?0:t-this.Au[0].batchId}aa(t){const e=this.ha(t);return e<0||e>=this.Au.length?null:this.Au[e]}}class bc{constructor(t,e){this.wo=t,this.fa=e,this.docs=new io(ci.dt),this.size=0}_r(t,e,n){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.fa(e);return this.docs=this.docs.Ee(r,{wr:e,size:o,readTime:n}),this.size+=o-s,this.wo.lo(t,r.path.Tt())}Er(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}Tr(t,e){const n=this.docs.get(e);return ia.resolve(n?n.wr:null)}getEntries(t,e){let n=lo();return e.forEach(t=>{const e=this.docs.get(t);n=n.Ee(t,e?e.wr:null)}),ia.resolve(n)}mc(t,e,n){let r=po();const i=new ci(e.path.child("")),s=this.docs.Ve(i);for(;s.Se();){const{key:t,value:{wr:i,readTime:o}}=s.be();if(!e.path.Pt(t.path))break;o.ht(n)<=0||i instanceof Mi&&bs(e,i)&&(r=r.Ee(i.key,i))}return ia.resolve(r)}da(t,e){return ia.forEach(this.docs,t=>e(t))}ac(t){return new Ec(this)}_c(t){return ia.resolve(this.size)}}class Ec extends Oa{constructor(t){super(),this.Pc=t}mr(t){const e=[];return this.ar.forEach((n,r)=>{r&&r.wr?e.push(this.Pc._r(t,r.wr,this.lr(n))):this.Pc.Er(n)}),ia.cs(e)}Ir(t,e){return this.Pc.Tr(t,e)}Ar(t,e){return this.Pc.getEntries(t,e)}}class Ic{constructor(t){this.persistence=t,this.wa=new Ra(t=>Bi(t),$i),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.Ea=0,this.Ta=new vc,this.targetCount=0,this.Ia=Vu.$o()}Bn(t,e){return this.wa.forEach((t,n)=>e(n)),ia.resolve()}Ko(t){return ia.resolve(this.lastRemoteSnapshotVersion)}Qo(t){return ia.resolve(this.Ea)}Bo(t){return this.highestTargetId=this.Ia.next(),ia.resolve(this.highestTargetId)}Wo(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ea&&(this.Ea=e),ia.resolve()}Go(t){this.wa.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ia=new Vu(e),this.highestTargetId=e),t.sequenceNumber>this.Ea&&(this.Ea=t.sequenceNumber)}jo(t,e){return this.Go(e),this.targetCount+=1,ia.resolve()}Ho(t,e){return this.Go(e),ia.resolve()}Jo(t,e){return this.wa.delete(e.target),this.Ta.sa(e.targetId),this.targetCount-=1,ia.resolve()}Fr(t,e,n){let r=0;const i=[];return this.wa.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.wa.delete(s),i.push(this.Yo(t,o.targetId)),r++)}),ia.cs(i).next(()=>r)}Xo(t){return ia.resolve(this.targetCount)}Zo(t,e){const n=this.wa.get(e)||null;return ia.resolve(n)}tc(t,e,n){return this.Ta.ta(e,n),ia.resolve()}nc(t,e,n){this.Ta.na(e,n);const r=this.persistence.Eo,i=[];return r&&e.forEach(e=>{i.push(r.xo(t,e))}),ia.cs(i)}Yo(t,e){return this.Ta.sa(e),ia.resolve()}ic(t,e){const n=this.Ta.ra(e);return ia.resolve(n)}Oo(t,e){return ia.resolve(this.Ta.Oo(e))}}class _c{constructor(t,e){this.Aa={},this.Nc=new Sa(0),this.xc=!1,this.xc=!0,this.Eo=t(this),this.qc=new Ic(this),this.wo=new ku,this.Uc=function(t,e){return new bc(t,e)}(this.wo,t=>this.Eo.ma(t)),this.le=new du(e),this.Kc=new mc(this.le)}start(){return Promise.resolve()}C(){return this.xc=!1,Promise.resolve()}get Sr(){return this.xc}Jc(){}Yc(){}Eu(){return this.wo}wu(t){let e=this.Aa[t.i()];return e||(e=new wc(this.wo,this.Eo),this.Aa[t.i()]=e),e}oc(){return this.qc}hc(){return this.Uc}Tu(){return this.Kc}runTransaction(t,e,n){_r("MemoryPersistence","Starting transaction:",t);const r=new Tc(this.Nc.next());return this.Eo.Ra(),n(r).next(t=>this.Eo.Pa(r).next(()=>t)).rs().then(t=>(r.ki(),t))}Va(t,e){return ia.us(Object.values(this.Aa).map(n=>()=>n.Oo(t,e)))}}class Tc extends Ia{constructor(t){super(),this.io=t}}class Sc{constructor(t){this.persistence=t,this.ga=new vc,this.ya=null}static pa(t){return new Sc(t)}get va(){if(this.ya)return this.ya;throw kr()}ec(t,e,n){return this.ga.ec(n,e),this.va.delete(n.toString()),ia.resolve()}sc(t,e,n){return this.ga.sc(n,e),this.va.add(n.toString()),ia.resolve()}xo(t,e){return this.va.add(e.toString()),ia.resolve()}removeTarget(t,e){this.ga.sa(e.targetId).forEach(t=>this.va.add(t.toString()));const n=this.persistence.oc();return n.ic(t,e.targetId).next(t=>{t.forEach(t=>this.va.add(t.toString()))}).next(()=>n.Jo(t,e))}Ra(){this.ya=new Set}Pa(t){const e=this.persistence.hc().ac();return ia.forEach(this.va,n=>{const r=ci.xt(n);return this.ba(t,r).next(t=>{t||e.Er(r)})}).next(()=>(this.ya=null,e.apply(t)))}lc(t,e){return this.ba(t,e).next(t=>{t?this.va.delete(e.toString()):this.va.add(e.toString())})}ma(t){return 0}ba(t,e){return ia.us([()=>ia.resolve(this.ga.Oo(e)),()=>this.persistence.oc().Oo(t,e),()=>this.persistence.Va(t,e)])}}function Ac(t,e){return`firestore_clients_${t}_${e}`}function kc(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.t()&&(r+="_"+e.uid),r}function Nc(t,e){return`firestore_targets_${t}_${e}`}class Rc{constructor(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}static Sa(t,e,n){const r=JSON.parse(n);let i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),s=void 0;return i&&r.error&&((i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(s=new Pr(r.error.code,r.error.message))),i?new Rc(t,e,r.state,s):(Tr("SharedClientState",`Failed to parse mutation state for ID '${e}': ${n}`),null)}Da(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Oc{constructor(t,e,n){this.targetId=t,this.state=e,this.error=n}static Sa(t,e){const n=JSON.parse(e);let r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&((r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Pr(n.error.code,n.error.message))),r?new Oc(t,n.state,i):(Tr("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}Da(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Pc{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Sa(t,e){const n=JSON.parse(e);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=wo();for(let t=0;r&&t<n.activeTargetIds.length;++t)r=$r(n.activeTargetIds[t]),i=i.add(n.activeTargetIds[t]);return r?new Pc(t,i):(Tr("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class Cc{constructor(t,e){this.clientId=t,this.onlineState=e}static Sa(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Cc(e.clientId,e.onlineState):(Tr("SharedClientState","Failed to parse online state: "+t),null)}}class Dc{constructor(){this.activeTargetIds=wo()}Ca(t){this.activeTargetIds=this.activeTargetIds.add(t)}Na(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Da(){const t={activeTargetIds:this.activeTargetIds.gt(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Lc{constructor(t,e,n,r,i){this.window=t,this.Qs=e,this.persistenceKey=n,this.xa=r,this.ka=null,this.Oa=null,this.Gi=null,this.Ma=this.Fa.bind(this),this.$a=new io(ti),this.Sr=!1,this.La=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ba=Ac(this.persistenceKey,this.xa),this.qa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.$a=this.$a.Ee(this.xa,new Dc),this.Ua=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Ka=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Qa=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Wa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ja=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Ma)}static L(t){return!(!t||!t.localStorage)}async start(){const t=await this.ka.du();for(const e of t){if(e===this.xa)continue;const t=this.getItem(Ac(this.persistenceKey,e));if(t){const n=Pc.Sa(e,t);n&&(this.$a=this.$a.Ee(n.clientId,n))}}this.Ga();const e=this.storage.getItem(this.Wa);if(e){const t=this.za(e);t&&this.Ha(t)}for(const t of this.La)this.Fa(t);this.La=[],this.window.addEventListener("unload",()=>this.C()),this.Sr=!0}Ji(t){this.setItem(this.qa,JSON.stringify(t))}Ja(){return this.Ya(this.$a)}Xa(t){let e=!1;return this.$a.forEach((n,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}Za(t){this.th(t,"pending")}eh(t,e,n){this.th(t,e,n),this.nh(t)}sh(t){let e="not-current";if(this.Xa(t)){const n=this.storage.getItem(Nc(this.persistenceKey,t));if(n){const r=Oc.Sa(t,n);r&&(e=r.state)}}return this.ih.Ca(t),this.Ga(),e}rh(t){this.ih.Na(t),this.Ga()}oh(t){return this.ih.activeTargetIds.has(t)}uh(t){this.removeItem(Nc(this.persistenceKey,t))}ah(t,e,n){this.hh(t,e,n)}lh(t,e,n){e.forEach(t=>{this.nh(t)}),this.currentUser=t,n.forEach(t=>{this.Za(t)})}_h(t){this.fh(t)}dh(){this.wh()}C(){this.Sr&&(this.window.removeEventListener("storage",this.Ma),this.removeItem(this.Ba),this.Sr=!1)}getItem(t){const e=this.storage.getItem(t);return _r("SharedClientState","READ",t,e),e}setItem(t,e){_r("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){_r("SharedClientState","REMOVE",t),this.storage.removeItem(t)}Fa(t){const e=t;if(e.storageArea===this.storage){if(_r("SharedClientState","EVENT",e.key,e.newValue),e.key===this.Ba)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Qs.Zc(async()=>{if(this.Sr){if(null!==e.key)if(this.Ua.test(e.key)){if(null==e.newValue){const t=this.Eh(e.key);return this.Th(t,null)}{const t=this.Ih(e.key,e.newValue);if(t)return this.Th(t.clientId,t)}}else if(this.Ka.test(e.key)){if(null!==e.newValue){const t=this.Ah(e.key,e.newValue);if(t)return this.mh(t)}}else if(this.Qa.test(e.key)){if(null!==e.newValue){const t=this.Rh(e.key,e.newValue);if(t)return this.Ph(t)}}else if(e.key===this.Wa){if(null!==e.newValue){const t=this.za(e.newValue);if(t)return this.Ha(t)}}else if(e.key===this.qa){const t=function(t){let e=Sa.Yi;if(null!=t)try{const n=JSON.parse(t);Nr("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(e.newValue);t!==Sa.Yi&&this.Gi(t)}else if(e.key===this.ja)return this.ka.Vh()}else this.La.push(e)})}}get ih(){return this.$a.get(this.xa)}Ga(){this.setItem(this.Ba,this.ih.Da())}th(t,e,n){const r=new Rc(this.currentUser,t,e,n),i=kc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Da())}nh(t){const e=kc(this.persistenceKey,this.currentUser,t);this.removeItem(e)}fh(t){const e={clientId:this.xa,onlineState:t};this.storage.setItem(this.Wa,JSON.stringify(e))}hh(t,e,n){const r=Nc(this.persistenceKey,t),i=new Oc(t,e,n);this.setItem(r,i.Da())}wh(){this.setItem(this.ja,"value-not-used")}Eh(t){const e=this.Ua.exec(t);return e?e[1]:null}Ih(t,e){const n=this.Eh(t);return Pc.Sa(n,e)}Ah(t,e){const n=this.Ka.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Rc.Sa(new br(i),r,e)}Rh(t,e){const n=this.Qa.exec(t),r=Number(n[1]);return Oc.Sa(r,e)}za(t){return Cc.Sa(t)}async mh(t){if(t.user.uid===this.currentUser.uid)return this.ka.gh(t.batchId,t.state,t.error);_r("SharedClientState","Ignoring mutation for non-active user "+t.user.uid)}Ph(t){return this.ka.yh(t.targetId,t.state,t.error)}Th(t,e){const n=e?this.$a.Ee(t,e):this.$a.remove(t),r=this.Ya(this.$a),i=this.Ya(n),s=[],o=[];return i.forEach(t=>{r.has(t)||s.push(t)}),r.forEach(t=>{i.has(t)||o.push(t)}),this.ka.ph(s,o).then(()=>{this.$a=n})}Ha(t){this.$a.get(t.clientId)&&this.Oa(t.onlineState)}Ya(t){let e=wo();return t.forEach((t,n)=>{e=e.Qe(n.activeTargetIds)}),e}}class xc{constructor(){this.bh=new Dc,this.Sh={},this.Oa=null,this.Gi=null}Za(t){}eh(t,e,n){}sh(t){return this.bh.Ca(t),this.Sh[t]||"not-current"}ah(t,e,n){this.Sh[t]=e}rh(t){this.bh.Na(t)}oh(t){return this.bh.activeTargetIds.has(t)}uh(t){delete this.Sh[t]}Ja(){return this.bh.activeTargetIds}Xa(t){return this.bh.activeTargetIds.has(t)}start(){return this.bh=new Dc,Promise.resolve()}lh(t,e,n){}_h(t){}C(){}Ji(t){}dh(){}}function Uc(){return"undefined"!=typeof window?window:null}function Mc(){return"undefined"!=typeof document?document:null}class Vc{constructor(t,e){this.ks=t,this.Oa=e,this.state="Unknown",this.Dh=0,this.Ch=null,this.Nh=!0}xh(){0===this.Dh&&(this.kh("Unknown"),this.Ch=this.ks.ti("online_state_timeout",1e4,()=>(this.Ch=null,this.Oh("Backend didn't respond within 10 seconds."),this.kh("Offline"),Promise.resolve())))}Mh(t){"Online"===this.state?this.kh("Unknown"):(this.Dh++,this.Dh>=1&&(this.Fh(),this.Oh("Connection failed 1 times. Most recent error: "+t.toString()),this.kh("Offline")))}set(t){this.Fh(),this.Dh=0,"Online"===t&&(this.Nh=!1),this.kh(t)}kh(t){t!==this.state&&(this.state=t,this.Oa(t))}Oh(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Nh?(Tr(e),this.Nh=!1):_r("OnlineStateTracker",e)}Fh(){null!==this.Ch&&(this.Ch.cancel(),this.Ch=null)}}class Fc{constructor(t,e,n,r,i){this.$h=t,this.Lh=e,this.ks=n,this.Bh={},this.qh=[],this.Uh=new Map,this.Kh=new Set,this.Qh=[],this.Wh=i,this.Wh.D(t=>{n.Ks(async()=>{Kc(this)&&(_r("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Rr(t);e.Kh.add(4),await jc(e),e.jh.set("Unknown"),e.Kh.delete(4),await qc(e)}(this))})}),this.jh=new Vc(n,r)}}async function qc(t){if(Kc(t))for(const e of t.Qh)await e(!0)}async function jc(t){for(const e of t.Qh)await e(!1)}function Bc(t,e){const n=Rr(t);n.Uh.has(e.targetId)||(n.Uh.set(e.targetId,e),Wc(n)?zc(n):ih(n).ai()&&Hc(n,e))}function $c(t,e){const n=Rr(t),r=ih(n);n.Uh.delete(e),r.ai()&&Gc(n,e),0===n.Uh.size&&(r.ai()?r._i():Kc(n)&&n.jh.set("Unknown"))}function Hc(t,e){t.Gh.bn(e.targetId),ih(t).Pi(e)}function Gc(t,e){t.Gh.bn(e),ih(t).Vi(e)}function zc(t){t.Gh=new Ro({Jn:e=>t.Bh.Jn(e),Yn:e=>t.Uh.get(e)||null}),ih(t).start(),t.jh.xh()}function Wc(t){return Kc(t)&&!ih(t).ui()&&t.Uh.size>0}function Kc(t){return 0===Rr(t).Kh.size}function Xc(t){t.Gh=void 0}async function Yc(t,e,n){if(!ca(e))throw e;t.Kh.add(1),await jc(t),t.jh.set("Offline"),n||(n=(()=>cc(t.$h))),t.ks.Zc(async()=>{_r("RemoteStore","Retrying IndexedDB access"),await n(),t.Kh.delete(1),await qc(t)})}function Jc(t,e){return e().catch(n=>Yc(t,n,e))}async function Qc(t){const e=Rr(t),n=sh(e);let r=e.qh.length>0?e.qh[e.qh.length-1].batchId:-1;for(;Zc(e);)try{const i=await hc(e.$h,r);if(null===i){0===e.qh.length&&n._i();break}r=i.batchId,th(e,i)}catch(t){await Yc(e,t)}eh(e)&&nh(e)}function Zc(t){return Kc(t)&&t.qh.length<10}function th(t,e){t.qh.push(e);const n=sh(t);n.ai()&&n.yi&&n.pi(e.mutations)}function eh(t){return Kc(t)&&!sh(t).ui()&&t.qh.length>0}function nh(t){sh(t).start()}async function rh(t,e){const n=Rr(t);e?(n.Kh.delete(2),await qc(n)):e||(n.Kh.add(2),await jc(n),n.jh.set("Unknown"))}function ih(t){return t.Xh||(t.Xh=function(t,e,n){const r=Rr(t);return r.Ci(),new ya(e,r.si,r.credentials,r.le,n)}(t.Lh,t.ks,{U:async function(t){t.Uh.forEach((e,n)=>{Hc(t,e)})}.bind(null,t),W:async function(t,e){Xc(t),Wc(t)?(t.jh.Mh(e),zc(t)):t.jh.set("Unknown")}.bind(null,t),Ri:async function(t,e,n){if(t.jh.set("Online"),e instanceof ko&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Uh.has(r)&&(await t.Bh.zh(r,n),t.Uh.delete(r),t.Gh.removeTarget(r))}(t,e)}catch(n){_r("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Yc(t,n)}else if(e instanceof So?t.Gh.Mn(e):e instanceof Ao?t.Gh.Qn(e):t.Gh.Ln(e),!n.isEqual(ii.min()))try{const r=await cc(t.$h);n.ht(r)>=0&&await function(t,e){const n=t.Gh.Gn(e);return n.nn.forEach((n,r)=>{if(n.resumeToken.Bt()>0){const i=t.Uh.get(r);i&&t.Uh.set(r,i.oe(n.resumeToken,e))}}),n.sn.forEach(e=>{const n=t.Uh.get(e);if(!n)return;t.Uh.set(e,n.oe(pi.qt,n.ie)),Gc(t,e);const r=new _s(n.target,e,1,n.sequenceNumber);Hc(t,r)}),t.Bh.Hh(n)}(t,n)}catch(e){_r("RemoteStore","Failed to raise snapshot:",e),await Yc(t,e)}}.bind(null,t)}),t.Qh.push(async e=>{e?(t.Xh.li(),Wc(t)?zc(t):t.jh.set("Unknown")):(await t.Xh.stop(),Xc(t))})),t.Xh}function sh(t){return t.Zh||(t.Zh=function(t,e,n){const r=Rr(t);return r.Ci(),new wa(e,r.si,r.credentials,r.le,n)}(t.Lh,t.ks,{U:async function(t){sh(t).Si()}.bind(null,t),W:async function(t,e){e&&sh(t).yi&&await async function(t,e){if(Wr(n=e.code)&&n!==Or.ABORTED){const n=t.qh.shift();sh(t).li(),await Jc(t,()=>t.Bh.Yh(n.batchId,e)),await Qc(t)}var n}(t,e),eh(t)&&nh(t)}.bind(null,t),bi:async function(t){const e=sh(t);for(const n of t.qh)e.pi(n.mutations)}.bind(null,t),vi:async function(t,e,n){const r=t.qh.shift(),i=Na.from(r,e,n);await Jc(t,()=>t.Bh.Jh(i)),await Qc(t)}.bind(null,t)}),t.Qh.push(async e=>{e?(t.Zh.li(),await Qc(t)):(await t.Zh.stop(),t.qh.length>0&&(_r("RemoteStore",`Stopping write stream with ${t.qh.length} pending writes`),t.qh=[]))})),t.Zh}class oh{constructor(){this.tl=void 0,this.listeners=[]}}class ah{constructor(){this.queries=new Ra(t=>ys(t),vs),this.onlineState="Unknown",this.el=new Set}}async function uh(t,e){const n=Rr(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new oh),i)try{s.tl=await n.nl(r)}catch(t){const n=ga(t,`Initialization of query '${ws(e.query)}' failed`);return void e.onError(n)}n.queries.set(r,s),s.listeners.push(e),e.sl(n.onlineState),s.tl&&e.il(s.tl)&&hh(n)}async function ch(t,e){const n=Rr(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.rl(r)}function hh(t){t.el.forEach(t=>{t.next()})}class lh{constructor(t,e,n){this.query=t,this.ol=e,this.cl=!1,this.ul=null,this.onlineState="Unknown",this.options=n||{}}il(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Io(t.query,t.docs,t.Ye,e,t.Xe,t.fromCache,t.Ze,!0)}let e=!1;return this.cl?this.al(t)&&(this.ol.next(t),e=!0):this.hl(t,this.onlineState)&&(this.ll(t),e=!0),this.ul=t,e}onError(t){this.ol.error(t)}sl(t){this.onlineState=t;let e=!1;return this.ul&&!this.cl&&this.hl(this.ul,t)&&(this.ll(this.ul),e=!0),e}hl(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options._l&&n||t.docs.Rt()&&"Offline"!==e)}al(t){if(t.docChanges.length>0)return!0;const e=this.ul&&this.ul.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ze&&!e)&&!0===this.options.includeMetadataChanges}ll(t){t=Io.en(t.query,t.docs,t.Xe,t.fromCache),this.cl=!0,this.ol.next(t)}}class fh{constructor(t){this.key=t}}class dh{constructor(t){this.key=t}}class ph{constructor(t,e){this.query=t,this.fl=e,this.dl=null,this.an=!1,this.wl=vo(),this.Xe=vo(),this.El=Es(t),this.Tl=new bo(this.El)}get Il(){return this.fl}Al(t,e){const n=e?e.ml:new Eo,r=e?e.Tl:this.Tl;let i=e?e.Xe:this.Xe,s=r,o=!1;const a=cs(this.query)&&r.size===this.query.limit?r.last():null,u=hs(this.query)&&r.size===this.query.limit?r.first():null;if(t.me((t,e)=>{const c=r.get(t);let h=e instanceof Mi?e:null;h&&(h=bs(this.query,h)?h:null);const l=!!c&&this.Xe.has(c.key),f=!!h&&(h.zt||this.Xe.has(h.key)&&h.hasCommittedMutations);let d=!1;c&&h?c.data().isEqual(h.data())?l!==f&&(n.track({type:3,doc:h}),d=!0):this.Rl(c,h)||(n.track({type:2,doc:h}),d=!0,(a&&this.El(h,a)>0||u&&this.El(h,u)<0)&&(o=!0)):!c&&h?(n.track({type:0,doc:h}),d=!0):c&&!h&&(n.track({type:1,doc:c}),d=!0,(a||u)&&(o=!0)),d&&(h?(s=s.add(h),i=f?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))}),cs(this.query)||hs(this.query))for(;s.size>this.query.limit;){const t=cs(this.query)?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{Tl:s,ml:n,Mu:o,Xe:i}}Rl(t,e){return t.zt&&e.hasCommittedMutations&&!e.zt}mr(t,e,n){const r=this.Tl;this.Tl=t.Tl,this.Xe=t.Xe;const i=t.ml.Je();i.sort((t,e)=>(function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}};return n(t)-n(e)})(t.type,e.type)||this.El(t.doc,e.doc)),this.Pl(n);const s=e?this.Vl():[],o=0===this.wl.size&&this.an?1:0,a=o!==this.dl;return this.dl=o,0!==i.length||a?{snapshot:new Io(this.query,t.Tl,r,i,t.Xe,0===o,a,!1),gl:s}:{gl:s}}sl(t){return this.an&&"Offline"===t?(this.an=!1,this.mr({Tl:this.Tl,ml:new Eo,Xe:this.Xe,Mu:!1},!1)):{gl:[]}}yl(t){return!this.fl.has(t)&&!!this.Tl.has(t)&&!this.Tl.get(t).zt}Pl(t){t&&(t.hn.forEach(t=>this.fl=this.fl.add(t)),t.ln.forEach(t=>{}),t._n.forEach(t=>this.fl=this.fl.delete(t)),this.an=t.an)}Vl(){if(!this.an)return[];const t=this.wl;this.wl=vo(),this.Tl.forEach(t=>{this.yl(t.key)&&(this.wl=this.wl.add(t.key))});const e=[];return t.forEach(t=>{this.wl.has(t)||e.push(new dh(t))}),this.wl.forEach(n=>{t.has(n)||e.push(new fh(n))}),e}pl(t){this.fl=t.ju,this.wl=vo();const e=this.Al(t.documents);return this.mr(e,!0)}vl(){return Io.en(this.query,this.Tl,this.Xe,0===this.dl)}}class gh{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class mh{constructor(t){this.key=t,this.bl=!1}}class vh{constructor(t,e,n,r,i,s){this.$h=t,this.Sl=e,this.Dl=n,this.Cl=r,this.currentUser=i,this.Nl=s,this.xl={},this.kl=new Ra(t=>ys(t),vs),this.Ol=new Map,this.Ml=[],this.Fl=new io(ci.dt),this.$l=new Map,this.Ll=new vc,this.Bl={},this.ql=new Map,this.Ul=Vu.Lo(),this.onlineState="Unknown",this.Kl=void 0}get Ql(){return!0===this.Kl}}async function yh(t,e,n,r){t.Wl=((e,n,r)=>(async function(t,e,n,r){let i=e.view.Al(n);i.Mu&&(i=await dc(t.$h,e.query,!1).then(({documents:t})=>e.view.Al(t,i)));const s=r&&r.nn.get(e.targetId),o=e.view.mr(i,t.Ql,s);return Ah(t,e.targetId,o.gl),o.snapshot})(t,e,n,r));const i=await dc(t.$h,e,!0),s=new ph(e,i.ju),o=s.Al(i.documents),a=To.un(n,r&&"Offline"!==t.onlineState),u=s.mr(o,t.Ql,a);Ah(t,n,u.gl);const c=new gh(e,n,s);return t.kl.set(e,c),t.Ol.has(n)?t.Ol.get(n).push(e):t.Ol.set(n,[e]),u.snapshot}async function wh(t,e){const n=Rr(t);try{const r=await function(t,e){const n=Rr(t),r=e.ie;let i=n.$u;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const s=n.qu.ac({Rc:!0});i=n.$u;const o=[];e.nn.forEach((e,s)=>{const a=i.get(s);if(!a)return;o.push(n.qc.nc(t,e._n,s).next(()=>n.qc.tc(t,e.hn,s)));const u=e.resumeToken;if(u.Bt()>0){const c=a.oe(u,r).re(t.io);i=i.Ee(s,c),function(t,e,n){return Nr(e.resumeToken.Bt()>0),0===t.resumeToken.Bt()||e.ie.lt()-t.ie.lt()>=3e8||n.hn.size+n.ln.size+n._n.size>0}(a,c,e)&&o.push(n.qc.Ho(t,c))}});let a=ho();if(e.rn.forEach((r,i)=>{e.on.has(r)&&o.push(n.persistence.Eo.lc(t,r))}),o.push(function(t,e,n,r,i){let s=vo();return n.forEach(t=>s=s.add(t)),e.getEntries(t,s).next(t=>{let i=ho();return n.forEach((n,s)=>{const o=t.get(n),a=r;s instanceof Vi&&s.version.isEqual(ii.min())?(e.Er(n,a),i=i.Ee(n,s)):null==o||s.version.ht(o.version)>0||0===s.version.ht(o.version)&&o.hasPendingWrites?(e._r(s,a),i=i.Ee(n,s)):_r("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),i})}(t,s,e.rn,r).next(t=>{a=t})),!r.isEqual(ii.min())){const e=n.qc.Ko(t).next(e=>n.qc.Wo(t,t.io,r));o.push(e)}return ia.cs(o).next(()=>s.apply(t)).next(()=>n.Uu.gu(t,a))}).then(t=>(n.$u=i,t))}(n.$h,e);e.nn.forEach((t,e)=>{const r=n.$l.get(e);r&&(Nr(t.hn.size+t.ln.size+t._n.size<=1),t.hn.size>0?r.bl=!0:t.ln.size>0?Nr(r.bl):t._n.size>0&&(Nr(r.bl),r.bl=!1))}),await Rh(n,r,e)}catch(t){await Aa(t)}}function bh(t,e,n){const r=Rr(t);if(r.Ql&&0===n||!r.Ql&&1===n){const t=[];r.kl.forEach((n,r)=>{const i=r.view.sl(e);i.snapshot&&t.push(i.snapshot)}),function(t,e){const n=Rr(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const t of n.listeners)t.sl(e)&&(r=!0)}),r&&hh(n)}(r.Dl,e),t.length&&r.xl.Ri(t),r.onlineState=e,r.Ql&&r.Cl._h(e)}}async function Eh(t,e){const n=Rr(t),r=e.batch.batchId;try{const i=await function(t,e){const n=Rr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const r=e.batch.keys(),i=n.qu.ac({Rc:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=ia.resolve();return s.forEach(t=>{o=o.next(()=>r.Tr(e,t)).next(e=>{let s=e;const o=n.ir.get(t);Nr(null!==o),(!s||s.version.ht(o)<0)&&(s=i.Zi(t,s,n))&&r._r(s,n.sr)})}),o.next(()=>t.Au.Co(e,i))}(n,t,e,i).next(()=>i.apply(t)).next(()=>n.Au.ko(t)).next(()=>n.Uu.Vu(t,r))})}(n.$h,e);_h(n,r,null),Ih(n,r),n.Cl.eh(r,"acknowledged"),await Rh(n,i)}catch(t){await Aa(t)}}function Ih(t,e){(t.ql.get(e)||[]).forEach(t=>{t.resolve()}),t.ql.delete(e)}function _h(t,e,n){const r=Rr(t);let i=r.Bl[r.currentUser.i()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Bl[r.currentUser.i()]=i}}function Th(t,e,n=null){t.Cl.rh(e);for(const r of t.Ol.get(e))t.kl.delete(r),n&&t.xl.jl(r,n);t.Ol.delete(e),t.Ql&&t.Ll.sa(e).forEach(e=>{t.Ll.Oo(e)||Sh(t,e)})}function Sh(t,e){const n=t.Fl.get(e);null!==n&&($c(t.Sl,n),t.Fl=t.Fl.remove(e),t.$l.delete(n),Nh(t))}function Ah(t,e,n){for(const r of n)r instanceof fh?(t.Ll.ec(r.key,e),kh(t,r)):r instanceof dh?(_r("SyncEngine","Document no longer in limbo: "+r.key),t.Ll.sc(r.key,e),t.Ll.Oo(r.key)||Sh(t,r.key)):kr()}function kh(t,e){const n=e.key;t.Fl.get(n)||(_r("SyncEngine","New document in limbo: "+n),t.Ml.push(n),Nh(t))}function Nh(t){for(;t.Ml.length>0&&t.Fl.size<t.Nl;){const e=t.Ml.shift(),n=t.Ul.next();t.$l.set(n,new mh(e)),t.Fl=t.Fl.Ee(e,n),Bc(t.Sl,new _s(gs(us(e.path)),n,2,Sa.Yi))}}async function Rh(t,e,n){const r=Rr(t),i=[],s=[],o=[];r.kl.Rt()||(r.kl.forEach((t,a)=>{o.push(r.Wl(a,e,n).then(t=>{if(t){r.Ql&&r.Cl.ah(a.targetId,t.fromCache?"not-current":"current"),i.push(t);const e=ic.Cu(a.targetId,t);s.push(e)}}))}),await Promise.all(o),r.xl.Ri(i),await async function(t,e){const n=Rr(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>ia.forEach(e,e=>ia.forEach(e.Su,r=>n.persistence.Eo.ec(t,e.targetId,r)).next(()=>ia.forEach(e.Du,r=>n.persistence.Eo.sc(t,e.targetId,r)))))}catch(t){if(!ca(t))throw t;_r("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.$u.get(e),r=t.ie,i=t.ce(r);n.$u=n.$u.Ee(e,i)}}}(r.$h,s))}async function Oh(t,e){const n=Rr(t),r=await dc(n.$h,e.query,!0),i=e.view.pl(r);return n.Ql&&Ah(n,e.targetId,i.gl),i}async function Ph(t,e,n){const r=Rr(t),i=[],s=[];for(const t of e){let e;const n=r.Ol.get(t);if(n&&0!==n.length){e=await lc(r.$h,gs(n[0]));for(const t of n){const e=r.kl.get(t),n=await Oh(r,e);n.snapshot&&s.push(n.snapshot)}}else{const n=await pc(r.$h,t);e=await lc(r.$h,n),await yh(r,Ch(n),t,!1)}i.push(e)}return r.xl.Ri(s),i}function Ch(t){return as(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Dh(t){const e=Rr(t);return e.Sl.Bh.Hh=wh.bind(null,e),e.Sl.Bh.Jn=function(t,e){const n=Rr(t),r=n.$l.get(e);if(r&&r.bl)return vo().add(r.key);{let t=vo();const r=n.Ol.get(e);if(!r)return t;for(const e of r){const r=n.kl.get(e);t=t.Qe(r.view.Il)}return t}}.bind(null,e),e.Sl.Bh.zh=async function(t,e,n){const r=Rr(t);r.Cl.ah(e,"rejected",n);const i=r.$l.get(e),s=i&&i.key;if(s){let t=new io(ci.dt);t=t.Ee(s,new Vi(s,ii.min()));const n=vo().add(s),i=new _o(ii.min(),new Map,new ao(ti),t,n);await wh(r,i),r.Fl=r.Fl.remove(s),r.$l.delete(e),Nh(r)}else await fc(r.$h,e,!1).then(()=>Th(r,e,n)).catch(Aa)}.bind(null,e),e.xl.Ri=function(t,e){const n=Rr(t);let r=!1;for(const t of e){const e=t.query,i=n.queries.get(e);if(i){for(const e of i.listeners)e.il(t)&&(r=!0);i.tl=t}}r&&hh(n)}.bind(null,e.Dl),e.xl.jl=function(t,e,n){const r=Rr(t),i=r.queries.get(e);if(i)for(const t of i.listeners)t.onError(n);r.queries.delete(e)}.bind(null,e.Dl),e}function Lh(t){const e=Rr(t);return e.Sl.Bh.Jh=Eh.bind(null,e),e.Sl.Bh.Yh=async function(t,e,n){const r=Rr(t);try{const t=await function(t,e){const n=Rr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let r;return n.Au.Ro(t,e).next(e=>(Nr(null!==e),r=e.keys(),n.Au.Co(t,e))).next(()=>n.Au.ko(t)).next(()=>n.Uu.Vu(t,r))})}(r.$h,e);_h(r,e,n),Ih(r,e),r.Cl.eh(e,"rejected",n),await Rh(r,t)}catch(n){await Aa(n)}}.bind(null,e),e}class xh{constructor(){this.synchronizeTabs=!1}async initialize(t){this.le=ra(t.X.p),this.Cl=this.Gl(t),this.persistence=this.zl(t),await this.persistence.start(),this.Hl=this.Jl(t),this.$h=this.Yl(t)}Jl(t){return null}Yl(t){return ac(this.persistence,new sc,t.Xl,this.le)}zl(t){return new _c(Sc.pa,this.le)}Gl(t){return new xc}async terminate(){this.Hl&&this.Hl.stop(),await this.Cl.C(),await this.persistence.C()}}class Uh extends xh{constructor(t,e,n){super(),this.Zl=t,this.cacheSizeBytes=e,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await async function(t){const e=Rr(t);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>(function(t){const e=Ku(t);let n=ii.min();return e.Ns({index:eu.readTimeIndex,reverse:!0},(t,e,r)=>{e.readTime&&(n=vu(e.readTime)),r.done()}).next(()=>n)})(t)).then(t=>{e.Bu=t})}(this.$h),await this.Zl.initialize(this,t),await Lh(this.Zl.ka),await Qc(this.Zl.Sl)}Yl(t){return ac(this.persistence,new sc,t.Xl,this.le)}Jl(t){const e=this.persistence.Eo.yr;return new Da(e,t.ks)}zl(t){const e=nc(t.X.p,t.X.persistenceKey),n=void 0!==this.cacheSizeBytes?Ta.Ui(this.cacheSizeBytes):Ta.Wi;return new Zu(this.synchronizeTabs,e,t.clientId,n,t.ks,Uc(),Mc(),this.le,this.Cl,!!this.forceOwnership)}Gl(t){return new xc}}class Mh extends Uh{constructor(t,e){super(t,e,!1),this.Zl=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}async initialize(t){await super.initialize(t);const e=this.Zl.ka;this.Cl instanceof Lc&&(this.Cl.ka={gh:async function(t,e,n,r){const i=Rr(t),s=await function(t,e){const n=Rr(t),r=Rr(n.Au);return n.persistence.runTransaction("Lookup mutation documents","readonly",t=>r.Po(t,e).next(e=>e?n.Uu.Vu(t,e):ia.resolve(null)))}(i.$h,e);null!==s?("pending"===n?await Qc(i.Sl):"acknowledged"===n||"rejected"===n?(_h(i,e,r||null),Ih(i,e),function(t,e){Rr(Rr(t).Au).No(e)}(i.$h,e)):kr(),await Rh(i,s)):_r("SyncEngine","Cannot apply mutation batch with id: "+e)}.bind(null,e),yh:async function(t,e,n,r){const i=Rr(t);if(i.Kl)_r("SyncEngine","Ignoring unexpected query state notification.");else if(i.Ol.has(e))switch(n){case"current":case"not-current":{const t=await gc(i.$h),r=_o.cn(e,"current"===n);await Rh(i,t,r);break}case"rejected":await fc(i.$h,e,!0),Th(i,e,r);break;default:kr()}}.bind(null,e),ph:async function(t,e,n){const r=Dh(t);if(r.Kl){for(const t of e){if(r.Ol.has(t)){_r("SyncEngine","Adding an already active target "+t);continue}const e=await pc(r.$h,t),n=await lc(r.$h,e);await yh(r,Ch(e),n.targetId,!1),Bc(r.Sl,n)}for(const t of n)r.Ol.has(t)&&await fc(r.$h,t,!1).then(()=>{$c(r.Sl,t),Th(r,t)}).catch(Aa)}}.bind(null,e),du:function(t){return Rr(Rr(Rr(t).$h).persistence).du()}.bind(null,e),Vh:async function(t){const e=Rr(t);return gc(e.$h).then(t=>Rh(e,t))}.bind(null,e)},await this.Cl.start()),await this.persistence.Hc(async t=>{await async function(t,e){const n=Rr(t);if(Dh(n),Lh(n),!0===e&&!0!==n.Kl){const t=n.Cl.Ja(),e=await Ph(n,t.gt());n.Kl=!0,await rh(n.Sl,!0);for(const t of e)Bc(n.Sl,t)}else if(!1===e&&!1!==n.Kl){const t=[];let e=Promise.resolve();n.Ol.forEach((r,i)=>{n.Cl.oh(i)?t.push(i):e=e.then(()=>(Th(n,i),fc(n.$h,i,!0))),$c(n.Sl,i)}),await e,await Ph(n,t),function(t){const e=Rr(n);e.$l.forEach((t,n)=>{$c(e.Sl,n)}),e.Ll.ia(),e.$l=new Map,e.Fl=new io(ci.dt)}(),n.Kl=!1,await rh(n.Sl,!1)}}(this.Zl.ka,t),this.Hl&&(t&&!this.Hl.Sr?this.Hl.start(this.$h):t||this.Hl.stop())})}Gl(t){const e=Uc();if(!Lc.L(e))throw new Pr(Or.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=nc(t.X.p,t.X.persistenceKey);return new Lc(e,t.ks,n,t.clientId,t.Xl)}}class Vh{async initialize(t,e){this.$h||(this.$h=t.$h,this.Cl=t.Cl,this.Lh=this.t_(e),this.Sl=this.e_(e),this.Dl=this.n_(e),this.ka=this.s_(e,!t.synchronizeTabs),this.Cl.Oa=(t=>bh(this.ka,t,1)),this.Sl.Bh.i_=async function(t,e){const n=Rr(t);if(!n.currentUser.isEqual(e)){_r("SyncEngine","User change. New user:",e.i());const t=await uc(n.$h,e);n.currentUser=e,function(t,e){t.ql.forEach(t=>{t.forEach(t=>{t.reject(new Pr(Or.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.ql.clear()}(n),n.Cl.lh(e,t.Qu,t.Wu),await Rh(n,t.Ku)}}.bind(null,this.ka),await rh(this.Sl,this.ka.Ql))}n_(t){return new ah}t_(t){const e=ra(t.X.p),n=(r=t.X,new Jr(r));var r;return function(t,e,n){return new ba(t,e,n)}(t.credentials,n,e)}e_(t){return e=this.$h,n=this.Lh,r=t.ks,i=(t=>bh(this.ka,t,0)),s=qr.L()?new qr:new Fr,new Fc(e,n,r,i,s);var e,n,r,i,s}s_(t,e){return function(t,e,n,r,i,s,o){const a=new vh(t,e,n,r,i,s);return o&&(a.Kl=!0),a}(this.$h,this.Sl,this.Dl,this.Cl,t.Xl,t.Nl,e)}terminate(){return async function(t){const e=Rr(t);_r("RemoteStore","RemoteStore shutting down."),e.Kh.add(5),await jc(e),e.Wh.C(),e.jh.set("Unknown")}(this.Sl)}}class Fh{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.r_(this.observer.next,t)}error(t){this.observer.error?this.r_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}o_(){this.muted=!0}r_(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class qh{constructor(t){this.c_=t}static fromBase64String(t){try{return new qh(pi.fromBase64String(t))}catch(t){throw new Pr(Or.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new qh(pi.fromUint8Array(t))}toBase64(){return this.c_.toBase64()}toUint8Array(){return this.c_.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.c_.isEqual(t.c_)}}class jh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Pr(Or.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.u_=new ui(t)}isEqual(t){return this.u_.isEqual(t.u_)}}class Bh{constructor(t){this._methodName=t}}class $h{constructor(t){this.Ur=t}}class Hh{constructor(t,e,n){this.a_=e,this.h_=n,this.type="document",this.firestore=t}get l_(){return this.h_.path}get id(){return this.h_.path.At()}get path(){return this.h_.path.yt()}get parent(){return new zh(this.firestore,this.a_,this.h_.path.Tt())}withConverter(t){return new Hh(this.firestore,t,this.h_)}}class Gh{constructor(t,e,n){this.a_=e,this.__=n,this.type="query",this.firestore=t}withConverter(t){return new Gh(this.firestore,t,this.__)}}class zh extends Gh{constructor(t,e,n){super(t,e,us(n)),this.firestore=t,this.l_=n,this.type="collection"}get id(){return this.__.path.At()}get path(){return this.__.path.yt()}get parent(){const t=this.l_.Tt();return t.Rt()?null:new Hh(this.firestore,null,new ci(t))}withConverter(t){return new zh(this.firestore,t,this.l_)}}function Wh(t,e,...n){if(t instanceof $h&&(t=t.Ur),1===arguments.length&&(e=Zr.ct()),xa("doc","path",e),t instanceof $a){const r=oi.vt(e,...n);return Ua(r),new Hh(t,null,new ci(r))}{if(!(t instanceof Hh||t instanceof zh))throw new Pr(Or.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t.l_.child(oi.vt(e,...n));return Ua(r),new Hh(t.firestore,t instanceof zh?t.a_:null,new ci(r))}}function Kh(t,e){return t instanceof $h&&(t=t.Ur),e instanceof $h&&(e=e.Ur),t instanceof Gh&&e instanceof Gh&&t.firestore===e.firestore&&vs(t.__,e.__)&&t.a_===e.a_}class Xh{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Pr(Or.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Pr(Or.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.f_=t,this.d_=e}get latitude(){return this.f_}get longitude(){return this.d_}isEqual(t){return this.f_===t.f_&&this.d_===t.d_}toJSON(){return{latitude:this.f_,longitude:this.d_}}ut(t){return ti(this.f_,t.f_)||ti(this.d_,t.d_)}}const Yh=/^__.*__$/;class Jh{constructor(t,e,n){this.data=t,this.we=e,this.fieldTransforms=n}w_(t,e){return null!==this.we?new Ys(t,this.data,this.we,e,this.fieldTransforms):new Xs(t,this.data,e,this.fieldTransforms)}}class Qh{constructor(t,e,n){this.data=t,this.we=e,this.fieldTransforms=n}w_(t,e){return new Ys(t,this.data,this.we,e,this.fieldTransforms)}}function Zh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kr()}}class tl{constructor(t,e,n,r,i,s){this.settings=t,this.p=e,this.le=n,this.ignoreUndefinedProperties=r,void 0===i&&this.E_(),this.fieldTransforms=i||[],this.we=s||[]}get path(){return this.settings.path}get T_(){return this.settings.T_}I_(t){return new tl(Object.assign(Object.assign({},this.settings),t),this.p,this.le,this.ignoreUndefinedProperties,this.fieldTransforms,this.we)}A_(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,m_:!1});return r.R_(t),r}P_(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,m_:!1});return r.E_(),r}V_(t){return this.I_({path:void 0,m_:!0})}g_(t){return bl(t,this.settings.methodName,this.settings.y_||!1,this.path,this.settings.p_)}contains(t){return void 0!==this.we.find(e=>t.Pt(e))||void 0!==this.fieldTransforms.find(e=>t.Pt(e.field))}E_(){if(this.path)for(let t=0;t<this.path.length;t++)this.R_(this.path.get(t))}R_(t){if(0===t.length)throw this.g_("Document fields must not be empty");if(Zh(this.T_)&&Yh.test(t))throw this.g_('Document fields cannot begin and end with "__"')}}class el{constructor(t,e,n){this.p=t,this.ignoreUndefinedProperties=e,this.le=n||ra(t)}v_(t,e,n,r=!1){return new tl({T_:t,methodName:e,p_:n,path:ui.bt(),m_:!1,y_:r},this.p,this.le,this.ignoreUndefinedProperties)}}function nl(t){const e=t.eo(),n=ra(t.jr);return new el(t.jr,!!e.ignoreUndefinedProperties,n)}function rl(t,e,n,r,i,s={}){const o=t.v_(s.merge||s.mergeFields?2:0,e,n,i);ml("Data must be an object, but it was:",o,r);const a=pl(r,o);let u,c;if(s.merge)u=new di(o.we),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=vl(e,r,n);if(!o.contains(i))throw new Pr(Or.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);El(t,i)||t.push(i)}u=new di(t),c=o.fieldTransforms.filter(t=>u.$t(t.field))}else u=null,c=o.fieldTransforms;return new Jh(new Di(a),u,c)}class il extends Bh{b_(t){if(2!==t.T_)throw 1===t.T_?t.g_(this._methodName+"() can only appear at the top level of your update data"):t.g_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.we.push(t.path),null}isEqual(t){return t instanceof il}}function sl(t,e,n){return new tl({T_:3,p_:e.settings.p_,methodName:t._methodName,m_:n},e.p,e.le,e.ignoreUndefinedProperties)}class ol extends Bh{b_(t){return new Fs(t.path,new Ps)}isEqual(t){return t instanceof ol}}class al extends Bh{constructor(t,e){super(t),this.S_=e}b_(t){const e=sl(this,t,!0),n=this.S_.map(t=>dl(t,e)),r=new Cs(n);return new Fs(t.path,r)}isEqual(t){return this===t}}class ul extends Bh{constructor(t,e){super(t),this.S_=e}b_(t){const e=sl(this,t,!0),n=this.S_.map(t=>dl(t,e)),r=new Ls(n);return new Fs(t.path,r)}isEqual(t){return this===t}}class cl extends Bh{constructor(t,e){super(t),this.D_=e}b_(t){const e=new Us(t.le,As(t.le,this.D_));return new Fs(t.path,e)}isEqual(t){return this===t}}function hl(t,e,n,r){const i=t.v_(1,e,n);ml("Data must be an object, but it was:",i,r);const s=[],o=new Li;li(r,(t,r)=>{const a=wl(e,t,n);r instanceof $h&&(r=r.Ur);const u=i.P_(a);if(r instanceof il)s.push(a);else{const t=dl(r,u);null!=t&&(s.push(a),o.set(a,t))}});const a=new di(s);return new Qh(o.Wt(),a,i.fieldTransforms)}function ll(t,e,n,r,i,s){const o=t.v_(1,e,n),a=[vl(e,r,n)],u=[i];if(s.length%2!=0)throw new Pr(Or.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(vl(e,s[t])),u.push(s[t+1]);const c=[],h=new Li;for(let t=a.length-1;t>=0;--t)if(!El(c,a[t])){const e=a[t];let n=u[t];n instanceof $h&&(n=n.Ur);const r=o.P_(e);if(n instanceof il)c.push(e);else{const t=dl(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new di(c);return new Qh(h.Wt(),l,o.fieldTransforms)}function fl(t,e,n,r=!1){return dl(n,t.v_(r?4:3,e))}function dl(t,e){if(t instanceof $h&&(t=t.Ur),gl(t))return ml("Unsupported field value:",e,t),pl(t,e);if(t instanceof Bh)return function(t,e){if(!Zh(e.T_))throw e.g_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.g_(t._methodName+"() is not currently supported inside arrays");const n=t.b_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.we.push(e.path),t instanceof Array){if(e.settings.m_&&4!==e.T_)throw e.g_("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=dl(i,e.V_(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof $h&&(t=t.Ur),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return As(e.le,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=ri.fromDate(t);return{timestampValue:xo(e.le,n)}}if(t instanceof ri){const n=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:xo(e.le,n)}}if(t instanceof Xh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qh)return{bytesValue:Uo(e.le,t.c_)};if(t instanceof Hh){const n=e.p,r=t.firestore.jr;if(!r.isEqual(n))throw e.g_(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Vo(t.firestore.jr||e.p,t.h_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.g_("Unsupported field value: "+Va(t))}(t,e)}function pl(t,e){const n={};return fi(t)?e.path&&e.path.length>0&&e.we.push(e.path):li(t,(t,r)=>{const i=dl(r,e.A_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function gl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof Xh||t instanceof qh||t instanceof Hh||t instanceof Bh)}function ml(t,e,n){if(!gl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=Va(n);throw"an object"===r?e.g_(t+" a custom object"):e.g_(t+" "+r)}}function vl(t,e,n){if(e instanceof $h&&(e=e.Ur),e instanceof jh)return e.u_;if("string"==typeof e)return wl(t,e);throw bl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const yl=new RegExp("[~\\*/\\[\\]]");function wl(t,e,n){if(e.search(yl)>=0)throw bl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jh(...e.split(".")).u_}catch(r){throw bl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bl(t,e,n,r,i){const s=r&&!r.Rt(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=" in field "+r),o&&(u+=" in document "+i),u+=")"),new Pr(Or.INVALID_ARGUMENT,a+t+u)}function El(t,e){return t.some(t=>t.isEqual(e))}class Il{constructor(t){this.Lh=t,this.C_=new Map,this.mutations=[],this.N_=!1,this.x_=null,this.k_=new Set}async O_(t){if(this.M_(),this.mutations.length>0)throw new Pr(Or.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const e=await async function(t,e){const n=Rr(t),r=Ho(n.le)+"/documents",i={documents:e.map(t=>qo(n.le,t))},s=await n.rt("BatchGetDocuments",r,i),o=new Map;s.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){Nr(!!e.found),e.found.name,e.found.updateTime;const n=jo(t,e.found.name),r=Mo(e.found.updateTime),i=new Di({mapValue:{fields:e.found.fields}});return new Mi(n,r,i,{})}(t,e):"missing"in e?function(t,e){Nr(!!e.missing),Nr(!!e.readTime);const n=jo(t,e.missing),r=Mo(e.readTime);return new Vi(n,r)}(t,e):kr()}(n.le,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());Nr(!!e),a.push(e)}),a}(this.Lh,t);return e.forEach(t=>{t instanceof Vi||t instanceof Mi?this.F_(t):kr()}),e}set(t,e){this.write(e.w_(t,this.de(t))),this.k_.add(t.toString())}update(t,e){try{this.write(e.w_(t,this.L_(t)))}catch(t){this.x_=t}this.k_.add(t.toString())}delete(t){this.write(new eo(t,this.de(t))),this.k_.add(t.toString())}async commit(){if(this.M_(),this.x_)throw this.x_;const t=this.C_;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=ci.xt(e);this.mutations.push(new no(n,this.de(n)))}),await async function(t,e){const n=Rr(t),r=Ho(n.le)+"/documents",i={writes:e.map(t=>Wo(n.le,t))};await n.et("Commit",r,i)}(this.Lh,this.mutations),this.N_=!0}F_(t){let e;if(t instanceof Mi)e=t.version;else{if(!(t instanceof Vi))throw kr();e=ii.min()}const n=this.C_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Pr(Or.ABORTED,"Document version changed between two reads.")}else this.C_.set(t.key.toString(),e)}de(t){const e=this.C_.get(t.toString());return!this.k_.has(t.toString())&&e?js.updateTime(e):js._e()}L_(t){const e=this.C_.get(t.toString());if(!this.k_.has(t.toString())&&e){if(e.isEqual(ii.min()))throw new Pr(Or.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return js.updateTime(e)}return js.exists(!0)}write(t){this.M_(),this.mutations.push(t)}M_(){}}class _l{constructor(t,e,n,r){this.ks=t,this.Lh=e,this.updateFunction=n,this.$s=r,this.B_=5,this.ci=new ma(this.ks,"transaction_retry")}run(){this.q_()}q_(){this.ci.Xs(async()=>{const t=new Il(this.Lh),e=this.U_(t);e&&e.then(e=>{this.ks.Ks(()=>t.commit().then(()=>{this.$s.resolve(e)}).catch(t=>{this.K_(t)}))}).catch(t=>{this.K_(t)})})}U_(t){try{const e=this.updateFunction(t);return!jr(e)&&e.catch&&e.then?e:(this.$s.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.$s.reject(t),null}}K_(t){this.B_>0&&this.Q_(t)?(this.B_-=1,this.ks.Ks(()=>(this.q_(),Promise.resolve()))):this.$s.reject(t)}Q_(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!Wr(e)}return!1}}class Tl{constructor(t,e,n){this.credentials=t,this.ks=e,this.X=n,this.user=br.UNAUTHENTICATED,this.clientId=Zr.ct(),this.W_=(()=>{}),this.m=new Yr,this.credentials.T(t=>{_r("FirestoreClient","Received user=",t.uid),this.user.isEqual(t)||(this.user=t,this.W_(t)),this.m.resolve()})}async getConfiguration(){return await this.m.promise,{ks:this.ks,X:this.X,clientId:this.clientId,credentials:this.credentials,Xl:this.user,Nl:100}}j_(t){this.W_=t,this.m.promise.then(()=>this.W_(this.user))}G_(){if(this.ks.z_)throw new Pr(Or.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.ks.H_();const t=new Yr;return this.ks.J_(async()=>{try{this.Y_&&await this.Y_.terminate(),this.X_&&await this.X_.terminate(),this.credentials.I(),t.resolve()}catch(e){const n=ga(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Sl(t,e){t.ks.Z_(),_r("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n),t.j_(n=>t.ks.Zc(async()=>{await uc(e.$h,n)})),e.persistence.Jc(()=>t.terminate()),t.X_=e}async function Al(t,e){t.ks.Z_();const n=await kl(t);_r("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.j_(n=>t.ks.Zc(()=>(async function(t,e){const n=Rr(t);n.ks.Z_(),_r("RemoteStore","RemoteStore received new credentials");const r=Kc(n);n.Kh.add(3),await jc(n),r&&n.jh.set("Unknown"),await n.Bh.i_(e),n.Kh.delete(3),await qc(n)})(e.Sl,n))),t.Y_=e}async function kl(t){return t.X_||(_r("FirestoreClient","Using default OfflineComponentProvider"),await Sl(t,new xh)),t.X_}async function Nl(t){return t.Y_||(_r("FirestoreClient","Using default OnlineComponentProvider"),await Al(t,new Vh)),t.Y_}function Rl(t){return kl(t).then(t=>t.persistence)}function Ol(t){return kl(t).then(t=>t.$h)}function Pl(t){return Nl(t).then(t=>t.Sl)}function Cl(t){return Nl(t).then(t=>t.ka)}async function Dl(t){const e=await Nl(t),n=e.Dl;return n.nl=async function(t,e){const n=Dh(t);let r,i;const s=n.kl.get(e);if(s)r=s.targetId,n.Cl.sh(r),i=s.view.vl();else{const t=await lc(n.$h,gs(e)),s=n.Cl.sh(t.targetId);r=t.targetId,i=await yh(n,e,r,"current"===s),n.Ql&&Bc(n.Sl,t)}return i}.bind(null,e.ka),n.rl=async function(t,e){const n=Rr(t),r=n.kl.get(e),i=n.Ol.get(r.targetId);if(i.length>1)return n.Ol.set(r.targetId,i.filter(t=>!vs(t,e))),void n.kl.delete(e);n.Ql?(n.Cl.rh(r.targetId),n.Cl.Xa(r.targetId)||await fc(n.$h,r.targetId,!1).then(()=>{n.Cl.uh(r.targetId),$c(n.Sl,r.targetId),Th(n,r.targetId)}).catch(Aa)):(Th(n,r.targetId),await fc(n.$h,r.targetId,!0))}.bind(null,e.ka),n}function Ll(t,e,n={}){const r=new Yr;return t.ks.Ks(async()=>(function(t,e,n,r,i){const s=new Fh({next:s=>{e.Ks(()=>ch(t,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Pr(Or.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Pr(Or.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:t=>i.reject(t)}),o=new lh(us(n.path),s,{includeMetadataChanges:!0,_l:!0});return uh(t,o)})(await Dl(t),t.ks,e,n,r)),r.promise}function xl(t,e,n={}){const r=new Yr;return t.ks.Ks(async()=>(function(t,e,n,r,i){const s=new Fh({next:n=>{e.Ks(()=>ch(t,o)),n.fromCache&&"server"===r.source?i.reject(new Pr(Or.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:t=>i.reject(t)}),o=new lh(n,s,{includeMetadataChanges:!0,_l:!0});return uh(t,o)})(await Dl(t),t.ks,e,n,r)),r.promise}class Ul{constructor(){this.tf=Promise.resolve(),this.ef=[],this.nf=!1,this.sf=[],this.rf=null,this.cf=!1,this.uf=[],this.ci=new ma(this,"async_queue_retry"),this.af=(()=>{const t=Mc();t&&_r("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ci.ei()});const t=Mc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.af)}get z_(){return this.nf}Ks(t){this.enqueue(t)}J_(t){this.hf(),this.lf(t)}H_(){if(!this.nf){this.nf=!0;const t=Mc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.af)}}enqueue(t){return this.hf(),this.nf?new Promise(t=>{}):this.lf(t)}Zc(t){this.Ks(()=>(this.ef.push(t),this._f()))}async _f(){if(0!==this.ef.length){try{await this.ef[0](),this.ef.shift(),this.ci.reset()}catch(t){if(!ca(t))throw t;_r("AsyncQueue","Operation failed with retryable error: "+t)}this.ef.length>0&&this.ci.Xs(()=>this._f())}}lf(t){const e=this.tf.then(()=>(this.cf=!0,t().catch(t=>{throw this.rf=t,this.cf=!1,Tr("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.cf=!1,t))));return this.tf=e,e}ti(t,e,n){this.hf(),this.uf.indexOf(t)>-1&&(e=0);const r=pa.Ls(this,t,e,n,t=>this.ff(t));return this.sf.push(r),r}hf(){this.rf&&kr()}Z_(){}async df(){let t;do{t=this.tf,await t}while(t!==this.tf)}wf(t){for(const e of this.sf)if(e.Os===t)return!0;return!1}Ef(t){return this.df().then(()=>{this.sf.sort((t,e)=>t.Ms-e.Ms);for(const e of this.sf)if(e.Us(),"all"!==t&&e.Os===t)break;return this.df()})}Tf(t){this.uf.push(t)}ff(t){const e=this.sf.indexOf(t);this.sf.splice(e,1)}}class Ml extends $a{constructor(t,e){super(t,e),this.If=new Ul,this.Kr="name"in t?t.name:"[DEFAULT]"}no(){return this.Af||Fl(this),this.Af.terminate()}}function Vl(t){return t.Af||Fl(t),t.Af.G_(),t.Af}function Fl(t){const e=t.eo(),n=function(t,e,n){return new Mr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.jr,t.Kr,e);t.Af=new Tl(t.Gr,t.If,n)}function ql(t,e,n){const r=new Yr;return t.ks.enqueue(async()=>{try{await Sl(t,n),await Al(t,e),r.resolve()}catch(t){if(!function(t){return"FirebaseError"===t.name?t.code===Or.FAILED_PRECONDITION||t.code===Or.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)}(t))throw t;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.reject(t)}}).then(()=>r.promise)}function jl(t){if(t.Hr||t.Jr)throw new Pr(Or.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Bl{mf(t,e="none"){switch(Ei(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vi(t.integerValue||t.doubleValue);case 3:return this.Rf(t.timestampValue);case 4:return this.Pf(t,e);case 5:return t.stringValue;case 6:return this.Vf(yi(t.bytesValue));case 7:return this.gf(t.referenceValue);case 8:return this.yf(t.geoPointValue);case 9:return this.pf(t.arrayValue,e);case 10:return this.vf(t.mapValue,e);default:throw kr()}}vf(t,e){const n={};return li(t.fields||{},(t,r)=>{n[t]=this.mf(r,e)}),n}yf(t){return new Xh(vi(t.latitude),vi(t.longitude))}pf(t,e){return(t.values||[]).map(t=>this.mf(t,e))}Pf(t,e){switch(e){case"previous":const n=function t(e){const n=e.mapValue.fields.__previous_value__;return wi(n)?t(n):n}(t);return null==n?null:this.mf(n,e);case"estimate":return this.Rf(bi(t));default:return null}}Rf(t){const e=mi(t);return new ri(e.seconds,e.nanos)}bf(t,e){const n=oi.vt(t);Nr(na(n));const r=new Vr(n.get(1),n.get(3)),i=new ci(n.Et(5));return r.isEqual(e)||Tr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}class $l{constructor(t,e,n,r,i){this.Sf=t,this.Df=e,this.h_=n,this.Cf=r,this.a_=i}get id(){return this.h_.path.At()}get ref(){return new Hh(this.Sf,this.a_,this.h_)}exists(){return null!==this.Cf}data(){if(this.Cf){if(this.a_){const t=new Hl(this.Sf,this.Df,this.h_,this.Cf,null);return this.a_.fromFirestore(t)}return this.Df.mf(this.Cf.Ht())}}get(t){if(this.Cf){const e=this.Cf.data().field(Gl("DocumentSnapshot.get",t));if(null!==e)return this.Df.mf(e)}}}class Hl extends $l{data(){return super.data()}}function Gl(t,e){return"string"==typeof e?wl(t,e):e instanceof $h?e.Ur.u_:e.u_}class zl{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Wl extends $l{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this.Sf=t,this.Nf=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this.Cf){if(this.a_){const e=new Kl(this.Sf,this.Df,this.h_,this.Cf,this.metadata,null);return this.a_.fromFirestore(e,t)}return this.Df.mf(this.Cf.Ht(),t.serverTimestamps)}}get(t,e={}){if(this.Cf){const n=this.Cf.data().field(Gl("DocumentSnapshot.get",t));if(null!==n)return this.Df.mf(n,e.serverTimestamps)}}}class Kl extends Wl{data(t={}){return super.data(t)}}class Xl{constructor(t,e,n,r){this.Sf=t,this.Df=e,this.xf=r,this.metadata=new zl(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this.xf.docs.size}get empty(){return 0===this.size}forEach(t,e){this.xf.docs.forEach(n=>{t.call(e,new Kl(this.Sf,this.Df,n.key,n,new zl(this.xf.Xe.has(n.key),this.xf.fromCache),this.query.a_))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this.xf.tn)throw new Pr(Or.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kf&&this.Of===e||(this.kf=function(t,e){if(t.xf.Ye.Rt()){let e,n=0;return t.xf.docChanges.map(r=>{const i=new Kl(t.Sf,t.Df,r.doc.key,r.doc,new zl(t.xf.Xe.has(r.doc.key),t.xf.fromCache),t.query.a_);return e=r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:n++}})}{let n=t.xf.Ye;return t.xf.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new Kl(t.Sf,t.Df,e.doc.key,e.doc,new zl(t.xf.Xe.has(e.doc.key),t.xf.fromCache),t.query.a_);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(s=(n=n.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(e.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this.Of=e),this.kf}}function Yl(t){if(hs(t)&&0===t.te.length)throw new Pr(Or.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jl{}class Ql extends Jl{constructor(t,e,n){super(),this.Ff=t,this.$f=e,this.Lf=n,this.type="where"}Mf(t){const e=nl(t.firestore),n=function(t,e,n,r,i,s,o){let a;if(i.Dt()){if("array-contains"===s||"array-contains-any"===s)throw new Pr(Or.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){of(o,s);const e=[];for(const n of o)e.push(sf(r,t,n));a={arrayValue:{values:e}}}else a=sf(r,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||of(o,s),a=fl(n,"where",o,"in"===s||"not-in"===s);const u=Gi.create(i,s,a);return function(t,e){if(e.Zt()){const n=fs(t);if(null!==n&&!n.isEqual(e.field))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=ls(t);null!==r&&af(t,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new Pr(Or.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Pr(Or.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.__,0,e,t.firestore.jr,this.Ff,this.$f,this.Lf);return new Gh(t.firestore,t.a_,function(t,e){const n=t.filters.concat([e]);return new os(t.path,t.collectionGroup,t.te.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.__,n))}}class Zl extends Jl{constructor(t,e){super(),this.Ff=t,this.Bf=e,this.type="orderBy"}Mf(t){const e=function(t,e,n){if(null!==t.startAt)throw new Pr(Or.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Pr(Or.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new ns(e,n);return function(t,e){if(null===ls(t)){const n=fs(t);null!==n&&af(t,n,e.field)}}(t,r),r}(t.__,this.Ff,this.Bf);return new Gh(t.firestore,t.a_,function(t,e){const n=t.te.concat([e]);return new os(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.__,e))}}class tf extends Jl{constructor(t,e,n){super(),this.type=t,this.qf=e,this.Uf=n}Mf(t){return new Gh(t.firestore,t.a_,ms(t.__,this.qf,this.Uf))}}class ef extends Jl{constructor(t,e,n){super(),this.type=t,this.Kf=e,this.Qf=n}Mf(t){const e=rf(t,this.type,this.Kf,this.Qf);return new Gh(t.firestore,t.a_,function(t,e){return new os(t.path,t.collectionGroup,t.te.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.__,e))}}class nf extends Jl{constructor(t,e,n){super(),this.type=t,this.Kf=e,this.Qf=n}Mf(t){const e=rf(t,this.type,this.Kf,this.Qf);return new Gh(t.firestore,t.a_,function(t,e){return new os(t.path,t.collectionGroup,t.te.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.__,e))}}function rf(t,e,n,r){if(n[0]instanceof $h&&(n[0]=n[0].Ur),n[0]instanceof $l)return function(t,e,n,r,i){if(!r)throw new Pr(Or.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const s=[];for(const n of ps(t))if(n.field.Dt())s.push(ki(e,r.key));else{const t=r.field(n.field);if(wi(t))throw new Pr(Or.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.yt();throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new ts(s,i)}(t.__,t.firestore.jr,e,n[0].Cf,r);{const i=nl(t.firestore);return function(t,e,n,r,i,s){const o=t.te;if(i.length>o.length)throw new Pr(Or.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const u=i[s];if(o[s].field.Dt()){if("string"!=typeof u)throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof u}`);if(!ds(t)&&-1!==u.indexOf("/"))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(oi.vt(u));if(!ci.Mt(n))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new ci(n);a.push(ki(e,i))}else{const t=fl(n,r,u);a.push(t)}}return new ts(a,s)}(t.__,t.firestore.jr,i,e,n,r)}}function sf(t,e,n){if(n instanceof $h&&(n=n.Ur),"string"==typeof n){if(""===n)throw new Pr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ds(e)&&-1!==n.indexOf("/"))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(oi.vt(n));if(!ci.Mt(r))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ki(t,new ci(r))}if(n instanceof Hh)return ki(t,n.h_);throw new Pr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Va(n)+".")}function of(t,e){if(!Array.isArray(t)||0===t.length)throw new Pr(Or.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new Pr(Or.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function af(t,e,n){if(!n.isEqual(e))throw new Pr(Or.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function uf(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class cf extends Bl{constructor(t){super(),this.firestore=t}Vf(t){return new qh(t)}gf(t){const e=this.bf(t,this.firestore.jr);return new Hh(this.firestore,null,e)}}class hf{constructor(t,e){this.Sf=t,this.Wf=e,this.jf=[],this.Gf=!1,this.zf=nl(t)}set(t,e,n){this.Hf();const r=lf(t,this.Sf),i=uf(r.a_,e,n),s=rl(this.zf,"WriteBatch.set",r.h_,i,null!==r.a_,n);return this.jf.push(s.w_(r.h_,js._e())),this}update(t,e,n,...r){this.Hf();const i=lf(t,this.Sf);let s;return e instanceof $h&&(e=e.Ur),s="string"==typeof e||e instanceof jh?ll(this.zf,"WriteBatch.update",i.h_,e,n,r):hl(this.zf,"WriteBatch.update",i.h_,e),this.jf.push(s.w_(i.h_,js.exists(!0))),this}delete(t){this.Hf();const e=lf(t,this.Sf);return this.jf=this.jf.concat(new eo(e.h_,js._e())),this}commit(){return this.Hf(),this.Gf=!0,this.jf.length>0?this.Wf(this.jf):Promise.resolve()}Hf(){if(this.Gf)throw new Pr(Or.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lf(t,e){if(t instanceof $h&&(t=t.Ur),t.firestore!==e)throw new Pr(Or.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function ff(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class df extends Bl{constructor(t){super(),this.firestore=t}Vf(t){return new qh(t)}gf(t){const e=this.bf(t,this.firestore.jr);return new Hh(this.firestore,null,e)}}function pf(t,e){return function(t,e){const n=new Yr;return t.ks.Ks(async()=>(async function(t,e,n){const r=Lh(t);try{const i=await function(t,e){const n=Rr(t),r=ri.now(),i=e.reduce((t,e)=>t.add(e.key),vo());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>n.Uu.Vu(t,i).next(i=>{s=i;const o=[];for(const t of e){const e=zs(t,s.get(t.key));null!=e&&o.push(new Ys(t.key,e,xi(e.proto.mapValue),js.exists(!0)))}return n.Au.mo(t,r,o,e)})).then(t=>{const e=t.nr(s);return{batchId:t.batchId,ar:e}})}(r.$h,e);r.Cl.Za(i.batchId),function(t,e,n){let r=t.Bl[t.currentUser.i()];r||(r=new io(ti)),r=r.Ee(e,n),t.Bl[t.currentUser.i()]=r}(r,i.batchId,n),await Rh(r,i.ar),await Qc(r.Sl)}catch(t){const e=ga(t,"Failed to persist write");n.reject(e)}})(await Cl(t),e,n)),n.promise}(Vl(t),e)}function gf(t,e,n){const r=n.docs.get(e.h_),i=new df(t);return new Wl(t,i,e.h_,r,new zl(n.hasPendingWrites,n.fromCache),e.a_)}class mf extends class{constructor(t,e){this.Sf=t,this.Jf=e,this.zf=nl(t)}get(t){const e=lf(t,this.Sf),n=new cf(this.Sf);return this.Jf.O_([e.h_]).then(t=>{if(!t||1!==t.length)return kr();const r=t[0];if(r instanceof Vi)return new $l(this.Sf,n,e.h_,null,e.a_);if(r instanceof Mi)return new $l(this.Sf,n,r.key,r,e.a_);throw kr()})}set(t,e,n){const r=lf(t,this.Sf),i=uf(r.a_,e,n),s=rl(this.zf,"Transaction.set",r.h_,i,null!==r.a_,n);return this.Jf.set(r.h_,s),this}update(t,e,n,...r){const i=lf(t,this.Sf);let s;return e instanceof $h&&(e=e.Ur),s="string"==typeof e||e instanceof jh?ll(this.zf,"Transaction.update",i.h_,e,n,r):hl(this.zf,"Transaction.update",i.h_,e),this.Jf.update(i.h_,s),this}delete(t){const e=lf(t,this.Sf);return this.Jf.delete(e.h_),this}}{constructor(t,e){super(t,e),this.Sf=t}get(t){const e=lf(t,this.Sf),n=new df(this.Sf);return super.get(t).then(t=>new Wl(this.Sf,n,e.h_,t.Cf,new zl(!1,!1),e.a_))}}e._registerComponent(new h("firestore-exp",t=>((t,e)=>new Ml(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-exp","0.0.900","node"),t.Bytes=qh,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=zh,t.DocumentReference=Hh,t.DocumentSnapshot=Wl,t.FieldPath=jh,t.FieldValue=Bh,t.FirebaseFirestore=Ml,t.FirestoreError=Pr,t.GeoPoint=Xh,t.Query=Gh,t.QueryConstraint=Jl,t.QueryDocumentSnapshot=Kl,t.QuerySnapshot=Xl,t.SnapshotMetadata=zl,t.Timestamp=ri,t.Transaction=mf,t.WriteBatch=hf,t.addDoc=function(t,e){const n=Fa(t.firestore,Ml),r=Wh(t),i=uf(t.a_,e);return pf(n,[rl(nl(t.firestore),"addDoc",r.h_,i,null!==t.a_,{}).w_(r.h_,js.exists(!1))]).then(()=>r)},t.arrayRemove=function(...t){return new ul("arrayRemove",t)},t.arrayUnion=function(...t){return new al("arrayUnion",t)},t.clearIndexedDbPersistence=function(t){if(t.Hr&&!t.Jr)throw new Pr(Or.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Yr;return t.If.J_(async()=>{try{await async function(t){if(!oa.L())return Promise.resolve();const e=t+"main";await oa.delete(e)}(nc(t.jr,t.Kr)),e.resolve()}catch(t){e.reject(t)}}),e.promise},t.collection=function(t,e,...n){if(t instanceof $h&&(t=t.Ur),xa("collection","path",e),t instanceof $a){const r=oi.vt(e,...n);return Ma(r),new zh(t,null,r)}{if(!(t instanceof Hh||t instanceof zh))throw new Pr(Or.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=oi.vt(t.path,...n).child(oi.vt(e));return Ma(r),new zh(t.firestore,null,r)}},t.collectionGroup=function(t,e){if(t=Fa(t,$a),xa("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Pr(Or.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gh(t,null,function(t){return new os(oi.bt(),t)}(e))},t.deleteDoc=function(t){return pf(Fa(t.firestore,Ml),[new eo(t.h_,js._e())])},t.deleteField=function(){return new il("deleteField")},t.disableNetwork=function(t){return function(t){return t.ks.enqueue(async()=>{const e=await Rl(t),n=await Pl(t);return e.Yc(!1),async function(t){const e=Rr(n);e.Kh.add(0),await jc(e),e.jh.set("Offline")}()})}(Vl(t=Fa(t,Ml)))},t.doc=Wh,t.documentId=function(){return new jh("__name__")},t.enableIndexedDbPersistence=function(t,e){jl(t=Fa(t,Ml));const n=Vl(t),r=t.eo(),i=new Vh;return ql(n,i,new Uh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(t){jl(t=Fa(t,Ml));const e=Vl(t),n=t.eo(),r=new Vh;return ql(e,r,new Mh(r,n.cacheSizeBytes))},t.enableNetwork=function(t){return function(t){return t.ks.enqueue(async()=>{const e=await Rl(t),n=await Pl(t);return e.Yc(!0),function(t){const e=Rr(n);return e.Kh.delete(0),qc(e)}()})}(Vl(t=Fa(t,Ml)))},t.endAt=function(...t){return new nf("endAt",t,!1)},t.endBefore=function(...t){return new nf("endBefore",t,!0)},t.getDoc=function(t){const e=Fa((t=Fa(t,Hh)).firestore,Ml);return Ll(Vl(e),t.h_).then(n=>gf(e,t,n))},t.getDocFromCache=function(t){const e=Fa((t=Fa(t,Hh)).firestore,Ml),n=Vl(e),r=new df(e);return function(t,e){const n=new Yr;return t.ks.Ks(async()=>(async function(t,e,n){try{const r=await function(t,e){const n=Rr(t);return n.persistence.runTransaction("read document","readonly",t=>n.Uu.mu(t,e))}(t,e);r instanceof Mi?n.resolve(r):r instanceof Vi?n.resolve(null):n.reject(new Pr(Or.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(t){const r=ga(t,`Failed to get document '${e} from cache`);n.reject(r)}})(await Ol(t),e,n)),n.promise}(n,t.h_).then(n=>new Wl(e,r,t.h_,n,new zl(n instanceof Mi&&n.zt,!0),t.a_))},t.getDocFromServer=function(t){const e=Fa((t=Fa(t,Hh)).firestore,Ml);return Ll(Vl(e),t.h_,{source:"server"}).then(n=>gf(e,t,n))},t.getDocs=function(t){const e=Fa((t=Fa(t,Gh)).firestore,Ml),n=Vl(e),r=new df(e);return Yl(t.__),xl(n,t.__).then(n=>new Xl(e,r,t,n))},t.getDocsFromCache=function(t){const e=Fa((t=Fa(t,Gh)).firestore,Ml),n=Vl(e),r=new df(e);return function(t,e){const n=new Yr;return t.ks.Ks(async()=>(async function(t,e,n){try{const r=await dc(t,e,!0),i=new ph(e,r.ju),s=i.Al(r.documents),o=i.mr(s,!1);n.resolve(o.snapshot)}catch(t){const r=ga(t,`Failed to execute query '${e} against cache`);n.reject(r)}})(await Ol(t),e,n)),n.promise}(n,t.__).then(n=>new Xl(e,r,t,n))},t.getDocsFromServer=function(t){const e=Fa((t=Fa(t,Gh)).firestore,Ml),n=Vl(e),r=new df(e);return xl(n,t.__,{source:"server"}).then(n=>new Xl(e,r,t,n))},t.getFirestore=function(t){return e._getProvider(t,"firestore-exp").getImmediate()},t.increment=function(t){return new cl("increment",t)},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore-exp").getImmediate();if(void 0!==n.cacheSizeBytes&&-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new Pr(Or.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.Xr(n),r},t.limit=function(t){return qa("limit",t),new tf("limit",t,"F")},t.limitToLast=function(t){return qa("limitToLast",t),new tf("limitToLast",t,"L")},t.onSnapshot=function(t,...e){var n,r,i;t instanceof $h&&(t=t.Ur);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||ff(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(ff(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(r=t.error)||void 0===r?void 0:r.bind(t),e[o+2]=null===(i=t.complete)||void 0===i?void 0:i.bind(t)}let u,c,h;if(t instanceof Hh)c=Fa(t.firestore,Ml),h=us(t.h_.path),u={next:n=>{e[o]&&e[o](gf(c,t,n))},error:e[o+1],complete:e[o+2]};else{const n=Fa(t,Gh);c=Fa(n.firestore,Ml),h=n.__;const r=new df(c);u={next:t=>{e[o]&&e[o](new Xl(c,r,n,t))},error:e[o+1],complete:e[o+2]},Yl(t.__)}return function(t,e,n,r){const i=new Fh(u),s=new lh(e,i,n);return t.ks.Ks(async()=>uh(await Dl(t),s)),()=>{i.o_(),t.ks.Ks(async()=>ch(await Dl(t),s))}}(Vl(c),h,a)},t.onSnapshotsInSync=function(t,e){return function(t,e){const n=new Fh(e);return t.ks.Ks(async()=>(function(t,e){Rr(t).el.add(e),e.next()})(await Dl(t),n)),()=>{n.o_(),t.ks.Ks(async()=>(function(t,e){Rr(t).el.delete(e)})(await Dl(t),n))}}(Vl(t=Fa(t,Ml)),ff(e)?e:{next:e})},t.orderBy=function(t,e="asc"){const n=e,r=Gl("orderBy",t);return new Zl(r,n)},t.query=function(t,...e){for(const n of e)t=n.Mf(t);return t},t.queryEqual=Kh,t.refEqual=function(t,e){return t instanceof $h&&(t=t.Ur),e instanceof $h&&(e=e.Ur),(t instanceof Hh||t instanceof zh)&&(e instanceof Hh||e instanceof zh)&&t.firestore===e.firestore&&t.path===e.path&&t.a_===e.a_},t.runTransaction=function(t,e){return function(t,e){const n=new Yr;return t.ks.Ks(async()=>{const r=await function(t){return Nl(t).then(t=>t.Lh)}(t);new _l(t.ks,r,e,n).run()}),n.promise}(Vl(t),n=>e(new mf(t,n)))},t.serverTimestamp=function(){return new ol("serverTimestamp")},t.setDoc=function(t,e,n){const r=Fa((t=Fa(t,Hh)).firestore,Ml),i=uf(t.a_,e,n);return pf(r,[rl(nl(r),"setDoc",t.h_,i,null!==t.a_,n).w_(t.h_,js._e())])},t.setLogLevel=function(t){Er.setLogLevel(t)},t.snapshotEqual=function(t,e){return t instanceof Wl&&e instanceof Wl?t.Sf===e.Sf&&t.h_.isEqual(e.h_)&&(null===t.Cf?null===e.Cf:t.Cf.isEqual(e.Cf))&&t.a_===e.a_:t instanceof Xl&&e instanceof Xl&&t.Sf===e.Sf&&Kh(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.xf.isEqual(e.xf)},t.startAfter=function(...t){return new ef("startAfter",t,!1)},t.startAt=function(...t){return new ef("startAt",t,!0)},t.terminate=function(t){return e._removeServiceInstance(t.app,"firestore-exp"),t._delete()},t.updateDoc=function(t,e,n,...r){const i=Fa((t=Fa(t,Hh)).firestore,Ml),s=nl(i);let o;return e instanceof $h&&(e=e.Ur),pf(i,[(o="string"==typeof e||e instanceof jh?ll(s,"updateDoc",t.h_,e,n,r):hl(s,"updateDoc",t.h_,e)).w_(t.h_,js.exists(!0))])},t.waitForPendingWrites=function(t){return function(t){const e=new Yr;return t.ks.Ks(async()=>(async function(t,e){const n=Rr(t);Kc(n.Sl)||_r("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(t){const e=Rr(n.$h);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.Au.yo(t))}();if(-1===r)return void e.resolve();const i=n.ql.get(r)||[];i.push(e),n.ql.set(r,i)}catch(t){const n=ga(t,"Initialization of waitForPendingWrites() operation failed");e.reject(n)}})(await Cl(t),e)),e.promise}(Vl(t=Fa(t,Ml)))},t.where=function(t,e,n){const r=e,i=Gl("where",t);return new Ql(i,r,n)},t.writeBatch=function(t){return Vl(t=Fa(t,Ml)),new hf(t,e=>pf(t,e))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r="FirebaseError",i=function(t){function e(n,i,o){var a=t.call(this,i)||this;return a.code=n,a.customData=o,a.name=r,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,s.prototype.create),a}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),s=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},s=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(u,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",c=this.serviceName+": "+a+" ("+s+").";return new i(s,c,r)},t}();var o,a,u=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(a||(a={}));var l={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},f=a.INFO,d=((o={})[a.DEBUG]="log",o[a.VERBOSE]="log",o[a.INFO]="info",o[a.WARN]="warn",o[a.ERROR]="error",o),p=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=d[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,h(["["+i+"]  "+t.name+":"],n))}},g=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=p,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.DEBUG],t)),this._logHandler.apply(this,h([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.VERBOSE],t)),this._logHandler.apply(this,h([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.INFO],t)),this._logHandler.apply(this,h([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.WARN],t)),this._logHandler.apply(this,h([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.ERROR],t)),this._logHandler.apply(this,h([this,a.ERROR],t))},t}();class m{constructor(t){this.uid=t}t(){return null!=this.uid}i(){return this.t()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}m.UNAUTHENTICATED=new m(null),m.o=new m("google-credentials-uid"),m.u=new m("first-party-uid");const v=new g("@firebase/firestore");function y(t,...e){if(v.logLevel<=a.DEBUG){const n=e.map(b);v.debug("Firestore (8.1.2): "+t,...n)}}function w(t,...e){if(v.logLevel<=a.ERROR){const n=e.map(b);v.error("Firestore (8.1.2): "+t,...n)}}function b(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function E(t="Unexpected state"){const e="FIRESTORE (8.1.2) INTERNAL ASSERTION FAILED: "+t;throw w(e),new Error(e)}function I(t,e){t||E()}function _(t,e){return t}const T="ok",S="cancelled",A="unknown",k="invalid-argument",N="deadline-exceeded",R="not-found",O="already-exists",P="permission-denied",C="unauthenticated",D="resource-exhausted",L="failed-precondition",x="aborted",U="out-of-range",M="unimplemented",V="internal",F="unavailable",q="data-loss";class j extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}class B{constructor(t,e){this.user=e,this.type="OAuth",this.h={},this.h.Authorization="Bearer "+t}}class ${constructor(){this.l=null}getToken(){return Promise.resolve(null)}_(){}m(t){this.l=t,t(m.UNAUTHENTICATED)}p(){this.l=null}}class H{constructor(t){this.I=null,this.currentUser=m.UNAUTHENTICATED,this.T=!1,this.A=0,this.l=null,this.forceRefresh=!1,this.I=(()=>{this.A++,this.currentUser=this.P(),this.T=!0,this.l&&this.l(this.currentUser)}),this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(t=>{this.auth=t,this.I&&this.auth.addAuthTokenListener(this.I)},()=>{}))}getToken(){const t=this.A,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.A!==t?(y("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(I("string"==typeof e.accessToken),new B(e.accessToken,this.currentUser)):null):Promise.resolve(null)}_(){this.forceRefresh=!0}m(t){this.l=t,this.T&&t(this.currentUser)}p(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.l=null}P(){const t=this.auth&&this.auth.getUid();return I(null===t||"string"==typeof t),new m(t)}}class G{constructor(t,e){this.R=t,this.V=e,this.type="FirstParty",this.user=m.u}get h(){const t={"X-Goog-AuthUser":this.V},e=this.R.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t}}class z{constructor(t,e){this.R=t,this.V=e}getToken(){return Promise.resolve(new G(this.R,this.V))}m(t){t(m.u)}p(){}_(){}}class W{constructor(t,e,n,r,i,s){this.g=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.v=s}}class K{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get N(){return"(default)"===this.database}isEqual(t){return t instanceof K&&t.projectId===this.projectId&&t.database===this.database}}class X{constructor(t,e,n){void 0===e?e=0:e>t.length&&E(),void 0===n?n=t.length-e:n>t.length-e&&E(),this.segments=t,this.offset=e,this.D=n}get length(){return this.D}isEqual(t){return 0===X.F(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof X?t.forEach(t=>{e.push(t)}):e.push(t),this.$(e)}limit(){return this.offset+this.length}S(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)}q(){return this.$(this.segments,this.offset,this.length-1)}O(){return this.segments[this.offset]}C(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}L(){return 0===this.length}U(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}M(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}j(){return this.segments.slice(this.offset,this.limit())}static F(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Y extends X{$(t,e,n){return new Y(t,e,n)}B(){return this.j().join("/")}toString(){return this.B()}static k(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new j(k,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new Y(e)}static W(){return new Y([])}}const J=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Q extends X{$(t,e,n){return new Q(t,e,n)}static G(t){return J.test(t)}B(){return this.j().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Q.G(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.B()}Y(){return 1===this.length&&"__name__"===this.get(0)}static H(){return new Q(["__name__"])}static K(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new j(k,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new j(k,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new j(k,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new j(k,"Unterminated ` in path: "+t);return new Q(e)}static W(){return new Q([])}}class Z{constructor(t){this.path=t}static J(t){return new Z(Y.k(t))}static Z(t){return new Z(Y.k(t).S(5))}X(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===Y.F(this.path,t.path)}toString(){return this.path.toString()}static F(t,e){return Y.F(t.path,e.path)}static tt(t){return t.length%2==0}static nt(t){return new Z(new Y(t.slice()))}}function tt(t,e,n){if(!n)throw new j(k,`Function ${t}() cannot be called with an empty ${e}.`)}function et(t){if(!Z.tt(t))throw new j(k,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function nt(t){if(Z.tt(t))throw new j(k,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rt(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":E()}function it(t,e){if("_delegate"in t&&(t=t.et),!(t instanceof e)){if(e.name===t.constructor.name)throw new j(k,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rt(t);throw new j(k,`Expected type '${e.name}', but it was: ${n}`)}}return t}function st(t,e){if(e<=0)throw new j(k,`Function ${t}() requires a positive number, but it was: ${e}.`)}function ot(t){return null==t}function at(t){return 0===t&&1/t==-1/0}const ut={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};var ct,ht;function lt(t){if(void 0===t)return w("RPC_ERROR","HTTP error has no status"),A;switch(t){case 200:return T;case 400:return L;case 401:return C;case 403:return P;case 404:return R;case 409:return x;case 416:return U;case 429:return D;case 499:return S;case 500:return A;case 501:return M;case 503:return F;case 504:return N;default:return t>=200&&t<300?T:t>=400&&t<500?L:t>=500&&t<600?V:A}}(ht=ct||(ct={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";class ft extends class{constructor(t){this.st=t,this.g=t.g;const e=t.ssl?"https":"http";this.rt=e+"://"+t.host,this.it="projects/"+this.g.projectId+"/databases/"+this.g.database+"/documents"}ot(t,e,n,r){const i=this.ut(t,e);y("RestConnection","Sending: ",i,n);const s={};return this.ct(s,r),this.at(t,i,s,n).then(t=>(y("RestConnection","Received: ",t),t),e=>{throw function(t,...e){if(v.logLevel<=a.WARN){const t=e.map(b);v.warn("Firestore (8.1.2): RestConnection",...t)}}(0,t+" failed with error: ",e,"url: ",i,"request:",n),e})}ht(t,e,n,r){return this.ot(t,e,n,r)}ct(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2",t["Content-Type"]="text/plain",e)for(const n in e.h)e.h.hasOwnProperty(n)&&(t[n]=e.h[n])}ut(t,e){const n=ut[t];return`${this.rt}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.lt=e}ft(t,e){throw new Error("Not supported by FetchConnection")}async at(t,e,n,r){const i=JSON.stringify(r);let s;try{s=await this.lt(e,{method:"POST",headers:n,body:i})}catch(t){throw new j(lt(t.status),"Request failed with error: "+t.statusText)}if(!s.ok)throw new j(lt(s.status),"Request failed with error: "+s.statusText);return s.json()}}class dt{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}function pt(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class gt{static dt(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=pt(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function vt(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}class yt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new j(k,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new j(k,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new j(k,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new j(k,"Timestamp seconds out of range: "+t)}static now(){return yt.fromMillis(Date.now())}static fromDate(t){return yt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new yt(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_t(t){return this.seconds===t.seconds?mt(this.nanoseconds,t.nanoseconds):mt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class wt{constructor(t){this.timestamp=t}static wt(t){return new wt(t)}static min(){return new wt(new yt(0,0))}yt(t){return this.timestamp._t(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}Et(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}It(){return this.timestamp}}function bt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Et(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class It{constructor(t){this.fields=t,t.sort(Q.F)}Tt(t){for(const e of this.fields)if(e.U(t))return!0;return!1}isEqual(t){return vt(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class _t{constructor(t){this.At=t}static fromBase64String(t){const e=atob(t);return new _t(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new _t(e)}toBase64(){return t=this.At,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.At)}Pt(){return 2*this.At.length}yt(t){return mt(this.At,t.At)}isEqual(t){return this.At===t.At}}_t.Rt=new _t("");const Tt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function St(t){if(I(!!t),"string"==typeof t){let e=0;const n=Tt.exec(t);if(I(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(t.seconds),nanos:At(t.nanos)}}function At(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function kt(t){return"string"==typeof t?_t.fromBase64String(t):_t.fromUint8Array(t)}function Nt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Rt(t){const e=St(t.mapValue.fields.__local_write_time__.timestampValue);return new yt(e.seconds,e.nanos)}function Ot(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Nt(t)?4:10:E()}function Pt(t,e){const n=Ot(t);if(n!==Ot(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rt(t).isEqual(Rt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=St(t.timestampValue),r=St(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return kt(t.bytesValue).isEqual(kt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return At(t.geoPointValue.latitude)===At(e.geoPointValue.latitude)&&At(t.geoPointValue.longitude)===At(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return At(t.integerValue)===At(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=At(t.doubleValue),r=At(e.doubleValue);return n===r?at(n)===at(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return vt(t.arrayValue.values||[],e.arrayValue.values||[],Pt);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(bt(n)!==bt(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!Pt(n[t],r[t])))return!1;return!0}(t,e);default:return E()}}function Ct(t,e){return void 0!==(t.values||[]).find(t=>Pt(t,e))}function Dt(t,e){const n=Ot(t),r=Ot(e);if(n!==r)return mt(n,r);switch(n){case 0:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=At(t.integerValue||t.doubleValue),r=At(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Lt(t.timestampValue,e.timestampValue);case 4:return Lt(Rt(t),Rt(e));case 5:return mt(t.stringValue,e.stringValue);case 6:return function(t,e){const n=kt(t),r=kt(e);return n.yt(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=mt(n[t],r[t]);if(0!==e)return e}return mt(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=mt(At(t.latitude),At(e.latitude));return 0!==n?n:mt(At(t.longitude),At(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=Dt(n[t],r[t]);if(e)return e}return mt(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=mt(r[t],s[t]);if(0!==e)return e;const o=Dt(n[r[t]],i[s[t]]);if(0!==o)return o}return mt(r.length,s.length)}(t.mapValue,e.mapValue);default:throw E()}}function Lt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return mt(t,e);const n=St(t),r=St(e),i=mt(n.seconds,r.seconds);return 0!==i?i:mt(n.nanos,r.nanos)}function xt(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.B()}`}}function Ut(t){return!!t&&"arrayValue"in t}function Mt(t){return!!t&&"nullValue"in t}function Vt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ft(t){return!!t&&"mapValue"in t}class qt{constructor(t){this.proto=t}static empty(){return new qt({mapValue:{}})}field(t){if(t.L())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ft(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null}}isEqual(t){return Pt(this.proto,t.proto)}}class jt{constructor(t=qt.empty()){this.Vt=t,this.gt=new Map}set(t,e){return this.vt(t,e),this}delete(t){return this.vt(t,null),this}vt(t,e){let n=this.gt;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===Ot(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.C(),e)}bt(){const t=this.Nt(Q.W(),this.gt);return null!=t?new qt(t):this.Vt}Nt(t,e){let n=!1;const r=this.Vt.field(t),i=Ft(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const s=this.Nt(t.child(r),e);null!=s&&(i[r]=s,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}class Bt{constructor(t,e){this.key=t,this.version=e}}class $t extends Bt{constructor(t,e,n,r){super(t,e),this.Dt=n,this.Ft=!!r.Ft,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.Dt.field(t)}data(){return this.Dt}$t(){return this.Dt.proto}isEqual(t){return t instanceof $t&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ft===t.Ft&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Dt.isEqual(t.Dt)}toString(){return`Document(${this.key}, ${this.version}, ${this.Dt.toString()}, {hasLocalMutations: ${this.Ft}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.Ft||this.hasCommittedMutations}}class Ht extends Bt{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Ht&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Gt{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.St=null}}function zt(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Gt(t,e,n,r,i,s,o)}class Wt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.Y()?"in"===e||"not-in"===e?this.xt(t,e,n):new Kt(t,e,n):"array-contains"===e?new Qt(t,n):"in"===e?new Zt(t,n):"not-in"===e?new te(t,n):"array-contains-any"===e?new ee(t,n):new Wt(t,e,n)}static xt(t,e,n){return"in"===e?new Xt(t,n):new Yt(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.qt(Dt(e,this.value)):null!==e&&Ot(this.value)===Ot(e)&&this.qt(Dt(e,this.value))}qt(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return E()}}Ot(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Kt extends Wt{constructor(t,e,n){super(t,e,n),this.key=Z.Z(n.referenceValue)}matches(t){const e=Z.F(t.key,this.key);return this.qt(e)}}class Xt extends Wt{constructor(t,e){super(t,"in",e),this.keys=Jt("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Yt extends Wt{constructor(t,e){super(t,"not-in",e),this.keys=Jt("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Jt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>Z.Z(t.referenceValue))}class Qt extends Wt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Ut(e)&&Ct(e.arrayValue,this.value)}}class Zt extends Wt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&Ct(this.value.arrayValue,e)}}class te extends Wt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ct(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!Ct(this.value.arrayValue,e)}}class ee extends Wt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Ut(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Ct(this.value.arrayValue,t))}}class ne{constructor(t,e){this.position=t,this.before=e}}class re{constructor(t,e="asc"){this.field=t,this.dir=e}}function ie(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function se(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pt(t.position[n],e.position[n]))return!1;return!0}class oe{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.Ct=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Lt=null,this.Ut=null,this.startAt,this.endAt}}function ae(t){return!ot(t.limit)&&"L"===t.limitType}function ue(t){return t.Ct.length>0?t.Ct[0].field:null}function ce(t){for(const e of t.filters)if(e.Ot())return e.field;return null}function he(t){return null!==t.collectionGroup}function le(t){const e=_(t);if(null===e.Lt){e.Lt=[];const t=ce(e),n=ue(e);if(null!==t&&null===n)t.Y()||e.Lt.push(new re(t)),e.Lt.push(new re(Q.H(),"asc"));else{let t=!1;for(const n of e.Ct)e.Lt.push(n),n.field.Y()&&(t=!0);if(!t){const t=e.Ct.length>0?e.Ct[e.Ct.length-1].dir:"asc";e.Lt.push(new re(Q.H(),t))}}}return e.Lt}function fe(t){const e=_(t);if(!e.Ut)if("F"===e.limitType)e.Ut=zt(e.path,e.collectionGroup,le(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of le(e)){const e="desc"===n.dir?"asc":"desc";t.push(new re(n.field,e))}const n=e.endAt?new ne(e.endAt.position,!e.endAt.before):null,r=e.startAt?new ne(e.startAt.position,!e.startAt.before):null;e.Ut=zt(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.Ut}function de(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!at(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.Mt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:at(e)?"-0":e}}(t,e)}class pe{constructor(){this.jt=void 0}}class ge extends pe{}class me extends pe{constructor(t){super(),this.elements=t}}class ve extends pe{constructor(t){super(),this.elements=t}}class ye extends pe{constructor(t,e){super(),this.Bt=t,this.kt=e}}class we{constructor(t,e){this.field=t,this.transform=e}}class be{constructor(t,e){this.updateTime=t,this.exists=e}static Qt(){return new be}static exists(t){return new be(void 0,t)}static updateTime(t){return new be(t)}get Wt(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Ee{}class Ie extends Ee{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.zt=n,this.fieldTransforms=r,this.type=0}}class _e extends Ee{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.Gt=n,this.zt=r,this.fieldTransforms=i,this.type=1}}class Te extends Ee{constructor(t,e){super(),this.key=t,this.zt=e,this.type=2,this.fieldTransforms=[]}}class Se extends Ee{constructor(t,e){super(),this.key=t,this.zt=e,this.type=3,this.fieldTransforms=[]}}const Ae={asc:"ASCENDING",desc:"DESCENDING"},ke={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Ne{constructor(t,e){this.g=t,this.Mt=e}}function Re(t,e){return t.Mt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Oe(t){return I(!!t),wt.wt(function(t){const e=St(t);return new yt(e.seconds,e.nanos)}(t))}function Pe(t,e){return function(t){return new Y(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).B()}function Ce(t,e){return Pe(t.g,e.path)}function De(t,e){const n=function(t){const e=Y.k(t);return I(je(e)),e}(e);if(n.get(1)!==t.g.projectId)throw new j(k,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.g.projectId);if(n.get(3)!==t.g.database)throw new j(k,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.g.database);return new Z((I((r=n).length>4&&"documents"===r.get(4)),r.S(5)));var r}function Le(t,e){return Pe(t.g,e)}function xe(t){return new Y(["projects",t.g.projectId,"databases",t.g.database]).B()}function Ue(t,e,n){return{name:Ce(t,e),fields:n.proto.mapValue.fields}}function Me(t,e){let n;if(e instanceof Ie)n={update:Ue(t,e.key,e.value)};else if(e instanceof Te)n={delete:Ce(t,e.key)};else if(e instanceof _e)n={update:Ue(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.B())),{fieldPaths:e}}(e.Gt)};else{if(!(e instanceof Se))return E();n={verify:Ce(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof ge)return{fieldPath:e.field.B(),setToServerValue:"REQUEST_TIME"};if(n instanceof me)return{fieldPath:e.field.B(),appendMissingElements:{values:n.elements}};if(n instanceof ve)return{fieldPath:e.field.B(),removeAllFromArray:{values:n.elements}};if(n instanceof ye)return{fieldPath:e.field.B(),increment:n.kt};throw E()})(0,t))),e.zt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return Re(t,e.It())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:E()}(t,e.zt)),n}function Ve(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Le(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Le(t,r.q()),n.structuredQuery.from=[{collectionId:r.C()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(Vt(t.value))return{unaryFilter:{field:qe(t.field),op:"IS_NAN"}};if(Mt(t.value))return{unaryFilter:{field:qe(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vt(t.value))return{unaryFilter:{field:qe(t.field),op:"IS_NOT_NAN"}};if(Mt(t.value))return{unaryFilter:{field:qe(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qe(t.field),op:function(t){return ke[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:qe(t.field),direction:function(t){return Ae[t]}(t.dir)}})(t))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.Mt||ot(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Fe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Fe(e.endAt)),n}function Fe(t){return{before:t.before,values:t.position}}function qe(t){return{fieldPath:t.B()}}function je(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Be(t){return new Ne(t,!0)}class $e{constructor(t,e,n,r,i){this.Yt=t,this.Ht=e,this.Kt=n,this.op=r,this.Jt=i,this.Zt=new dt,this.then=this.Zt.promise.then.bind(this.Zt.promise),this.Zt.promise.catch(t=>{})}static Xt(t,e,n,r,i){const s=Date.now()+n,o=new $e(t,e,s,r,i);return o.start(n),o}start(t){this.tn=setTimeout(()=>this.nn(),t)}en(){return this.nn()}cancel(t){null!==this.tn&&(this.clearTimeout(),this.Zt.reject(new j(S,"Operation cancelled"+(t?": "+t:""))))}nn(){this.Yt.sn(()=>null!==this.tn?(this.clearTimeout(),this.op().then(t=>this.Zt.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.tn&&(this.Jt(this),clearTimeout(this.tn),this.tn=null)}}class He{constructor(t,e,n=1e3,r=1.5,i=6e4){this.rn=t,this.Ht=e,this.on=n,this.un=r,this.cn=i,this.an=0,this.hn=null,this.ln=Date.now(),this.reset()}reset(){this.an=0}fn(){this.an=this.cn}dn(t){this.cancel();const e=Math.floor(this.an+this._n()),n=Math.max(0,Date.now()-this.ln),r=Math.max(0,e-n);r>0&&y("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.an} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.hn=this.rn.wn(this.Ht,r,()=>(this.ln=Date.now(),t())),this.an*=this.un,this.an<this.on&&(this.an=this.on),this.an>this.cn&&(this.an=this.cn)}mn(){null!==this.hn&&(this.hn.en(),this.hn=null)}cancel(){null!==this.hn&&(this.hn.cancel(),this.hn=null)}_n(){return(Math.random()-.5)*this.an}}class Ge extends class{}{constructor(t,e,n){super(),this.credentials=t,this.pn=e,this.Bt=n,this.yn=!1}En(){if(this.yn)throw new j(L,"The client has already been terminated.")}ot(t,e,n){return this.En(),this.credentials.getToken().then(r=>this.pn.ot(t,e,n,r)).catch(t=>{throw t.code===C&&this.credentials._(),t})}ht(t,e,n){return this.En(),this.credentials.getToken().then(r=>this.pn.ht(t,e,n,r)).catch(t=>{throw t.code===C&&this.credentials._(),t})}terminate(){this.yn=!1}}async function ze(t,e){const n=_(t),r=xe(n.Bt)+"/documents",i={writes:e.map(t=>Me(n.Bt,t))};await n.ot("Commit",r,i)}async function We(t,e){const n=_(t),r=xe(n.Bt)+"/documents",i={documents:e.map(t=>Ce(n.Bt,t))},s=await n.ht("BatchGetDocuments",r,i),o=new Map;s.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){I(!!e.found),e.found.name,e.found.updateTime;const n=De(t,e.found.name),r=Oe(e.found.updateTime),i=new qt({mapValue:{fields:e.found.fields}});return new $t(n,r,i,{})}(t,e):"missing"in e?function(t,e){I(!!e.missing),I(!!e.readTime);const n=De(t,e.missing),r=Oe(e.readTime);return new Ht(n,r)}(t,e):E()}(n.Bt,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());I(!!e),a.push(e)}),a}class Ke{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new j(k,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new j(k,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,function(t,e,n,r){if(!0===e&&!0===r)throw new j(k,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties}}const Xe=new Map;function Ye(t){if(t.In)throw new j(L,"The client has already been terminated.");if(!Xe.has(t)){y("ComponentProvider","Initializing Datastore");const i=function(t){return new ft(t,fetch.bind(null))}((e=t.Tn,n=t.An,r=t.Pn(),new W(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling))),s=Be(t.Tn),o=function(t,e,n){return new Ge(t,i,s)}(t.Rn);Xe.set(t,o)}var e,n,r;return Xe.get(t)}class Je{constructor(t,e){this.An="(lite)",this.Vn=new Ke({}),this.gn=!1,t instanceof K?(this.Tn=t,this.Rn=new $):(this.vn=t,this.Tn=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new j(k,'"projectId" not provided in firebase.initializeApp.');return new K(t.options.projectId)}(t),this.Rn=new H(e))}get app(){if(!this.vn)throw new j(L,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.vn}get bn(){return this.gn}get In(){return void 0!==this.Nn}Dn(t){if(this.gn)throw new j(L,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Vn=new Ke(t),void 0!==t.credentials&&(this.Rn=function(t){if(!t)return new $;switch(t.type){case"gapi":const e=t.client;return I(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new z(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new j(k,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}Fn(){return this.Vn}Pn(){return this.gn=!0,this.Vn}_delete(){return this.Nn||(this.Nn=this.$n()),this.Nn}$n(){return function(t){const e=Xe.get(t);e&&(y("ComponentProvider","Removing Datastore"),Xe.delete(t),e.terminate())}(this),Promise.resolve()}}class Qe{constructor(t){this.et=t}}class Ze{constructor(t,e,n){this.Sn=e,this.xn=n,this.type="document",this.firestore=t}get qn(){return this.xn.path}get id(){return this.xn.path.C()}get path(){return this.xn.path.B()}get parent(){return new en(this.firestore,this.Sn,this.xn.path.q())}withConverter(t){return new Ze(this.firestore,t,this.xn)}}class tn{constructor(t,e,n){this.Sn=e,this.On=n,this.type="query",this.firestore=t}withConverter(t){return new tn(this.firestore,t,this.On)}}class en extends tn{constructor(t,e,n){super(t,e,new oe(n)),this.firestore=t,this.qn=n,this.type="collection"}get id(){return this.On.path.C()}get path(){return this.On.path.B()}get parent(){const t=this.qn.q();return t.L()?null:new Ze(this.firestore,null,new Z(t))}withConverter(t){return new en(this.firestore,t,this.qn)}}function nn(t,e,...n){if(t instanceof Qe&&(t=t.et),1===arguments.length&&(e=gt.dt()),tt("doc","path",e),t instanceof Je){const r=Y.k(e,...n);return et(r),new Ze(t,null,new Z(r))}{if(!(t instanceof Ze||t instanceof en))throw new j(k,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t.qn.child(Y.k(e,...n));return et(r),new Ze(t.firestore,t instanceof en?t.Sn:null,new Z(r))}}function rn(t,e){return t instanceof Qe&&(t=t.et),e instanceof Qe&&(e=e.et),t instanceof tn&&e instanceof tn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ie(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!Pt(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!se(t.startAt,e.startAt)&&se(t.endAt,e.endAt)}(fe(t),fe(e))&&t.limitType===e.limitType}(t.On,e.On)&&t.Sn===e.Sn}class sn{constructor(t){this.Cn=t}static fromBase64String(t){try{return new sn(_t.fromBase64String(t))}catch(t){throw new j(k,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new sn(_t.fromUint8Array(t))}toBase64(){return this.Cn.toBase64()}toUint8Array(){return this.Cn.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.Cn.isEqual(t.Cn)}}class on{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new j(k,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ln=new Q(t)}isEqual(t){return this.Ln.isEqual(t.Ln)}}class an{constructor(t){this._methodName=t}}class un{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new j(k,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new j(k,"Longitude must be a number between -180 and 180, but was: "+e);this.Un=t,this.Mn=e}get latitude(){return this.Un}get longitude(){return this.Mn}isEqual(t){return this.Un===t.Un&&this.Mn===t.Mn}toJSON(){return{latitude:this.Un,longitude:this.Mn}}_t(t){return mt(this.Un,t.Un)||mt(this.Mn,t.Mn)}}const cn=/^__.*__$/;class hn{constructor(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}jn(t,e){return null!==this.Gt?new _e(t,this.data,this.Gt,e,this.fieldTransforms):new Ie(t,this.data,e,this.fieldTransforms)}}class ln{constructor(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}jn(t,e){return new _e(t,this.data,this.Gt,e,this.fieldTransforms)}}function fn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw E()}}class dn{constructor(t,e,n,r,i,s){this.settings=t,this.g=e,this.Bt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Bn(),this.fieldTransforms=i||[],this.Gt=s||[]}get path(){return this.settings.path}get kn(){return this.settings.kn}Qn(t){return new dn(Object.assign(Object.assign({},this.settings),t),this.g,this.Bt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)}Wn(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Qn({path:n,zn:!1});return r.Gn(t),r}Yn(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Qn({path:n,zn:!1});return r.Bn(),r}Hn(t){return this.Qn({path:void 0,zn:!0})}Kn(t){return Dn(t,this.settings.methodName,this.settings.Jn||!1,this.path,this.settings.Zn)}contains(t){return void 0!==this.Gt.find(e=>t.U(e))||void 0!==this.fieldTransforms.find(e=>t.U(e.field))}Bn(){if(this.path)for(let t=0;t<this.path.length;t++)this.Gn(this.path.get(t))}Gn(t){if(0===t.length)throw this.Kn("Document fields must not be empty");if(fn(this.kn)&&cn.test(t))throw this.Kn('Document fields cannot begin and end with "__"')}}class pn{constructor(t,e,n){this.g=t,this.ignoreUndefinedProperties=e,this.Bt=n||Be(t)}Xn(t,e,n,r=!1){return new dn({kn:t,methodName:e,Zn:n,path:Q.W(),zn:!1,Jn:r},this.g,this.Bt,this.ignoreUndefinedProperties)}}function gn(t){const e=t.Pn(),n=Be(t.Tn);return new pn(t.Tn,!!e.ignoreUndefinedProperties,n)}function mn(t,e,n,r,i,s={}){const o=t.Xn(s.merge||s.mergeFields?2:0,e,n,i);Rn("Data must be an object, but it was:",o,r);const a=kn(r,o);let u,c;if(s.merge)u=new It(o.Gt),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=On(e,r,n);if(!o.contains(i))throw new j(k,`Field '${i}' is specified in your field mask but missing from your input data.`);Ln(t,i)||t.push(i)}u=new It(t),c=o.fieldTransforms.filter(t=>u.Tt(t.field))}else u=null,c=o.fieldTransforms;return new hn(new qt(a),u,c)}class vn extends an{te(t){if(2!==t.kn)throw 1===t.kn?t.Kn(this._methodName+"() can only appear at the top level of your update data"):t.Kn(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null}isEqual(t){return t instanceof vn}}function yn(t,e,n){return new dn({kn:3,Zn:e.settings.Zn,methodName:t._methodName,zn:n},e.g,e.Bt,e.ignoreUndefinedProperties)}class wn extends an{te(t){return new we(t.path,new ge)}isEqual(t){return t instanceof wn}}class bn extends an{constructor(t,e){super(t),this.ne=e}te(t){const e=yn(this,t,!0),n=this.ne.map(t=>An(t,e)),r=new me(n);return new we(t.path,r)}isEqual(t){return this===t}}class En extends an{constructor(t,e){super(t),this.ne=e}te(t){const e=yn(this,t,!0),n=this.ne.map(t=>An(t,e)),r=new ve(n);return new we(t.path,r)}isEqual(t){return this===t}}class In extends an{constructor(t,e){super(t),this.ee=e}te(t){const e=new ye(t.Bt,de(t.Bt,this.ee));return new we(t.path,e)}isEqual(t){return this===t}}function _n(t,e,n,r){const i=t.Xn(1,e,n);Rn("Data must be an object, but it was:",i,r);const s=[],o=new jt;Et(r,(t,r)=>{const a=Cn(e,t,n);r instanceof Qe&&(r=r.et);const u=i.Yn(a);if(r instanceof vn)s.push(a);else{const t=An(r,u);null!=t&&(s.push(a),o.set(a,t))}});const a=new It(s);return new ln(o.bt(),a,i.fieldTransforms)}function Tn(t,e,n,r,i,s){const o=t.Xn(1,e,n),a=[On(e,r,n)],u=[i];if(s.length%2!=0)throw new j(k,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(On(e,s[t])),u.push(s[t+1]);const c=[],h=new jt;for(let t=a.length-1;t>=0;--t)if(!Ln(c,a[t])){const e=a[t];let n=u[t];n instanceof Qe&&(n=n.et);const r=o.Yn(e);if(n instanceof vn)c.push(e);else{const t=An(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new It(c);return new ln(h.bt(),l,o.fieldTransforms)}function Sn(t,e,n,r=!1){return An(n,t.Xn(r?4:3,e))}function An(t,e){if(t instanceof Qe&&(t=t.et),Nn(t))return Rn("Unsupported field value:",e,t),kn(t,e);if(t instanceof an)return function(t,e){if(!fn(e.kn))throw e.Kn(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Kn(t._methodName+"() is not currently supported inside arrays");const n=t.te(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.zn&&4!==e.kn)throw e.Kn("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=An(i,e.Hn(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Qe&&(t=t.et),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return de(e.Bt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=yt.fromDate(t);return{timestampValue:Re(e.Bt,n)}}if(t instanceof yt){const n=new yt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Re(e.Bt,n)}}if(t instanceof un)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof sn)return{bytesValue:function(t,e){return t.Mt?e.toBase64():e.toUint8Array()}(e.Bt,t.Cn)};if(t instanceof Ze){const n=e.g,r=t.firestore.Tn;if(!r.isEqual(n))throw e.Kn(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Pe(t.firestore.Tn||e.g,t.xn.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Kn("Unsupported field value: "+rt(t))}(t,e)}function kn(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):Et(t,(t,r)=>{const i=An(r,e.Wn(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Nn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof yt||t instanceof un||t instanceof sn||t instanceof Ze||t instanceof an)}function Rn(t,e,n){if(!Nn(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=rt(n);throw"an object"===r?e.Kn(t+" a custom object"):e.Kn(t+" "+r)}}function On(t,e,n){if(e instanceof Qe&&(e=e.et),e instanceof on)return e.Ln;if("string"==typeof e)return Cn(t,e);throw Dn("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const Pn=new RegExp("[~\\*/\\[\\]]");function Cn(t,e,n){if(e.search(Pn)>=0)throw Dn(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new on(...e.split(".")).Ln}catch(r){throw Dn(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dn(t,e,n,r,i){const s=r&&!r.L(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)");let u="";return(s||o)&&(u+=" (found",s&&(u+=" in field "+r),o&&(u+=" in document "+i),u+=")"),new j(k,(a+=". ")+t+u)}function Ln(t,e){return t.some(t=>t.isEqual(e))}class xn{constructor(t,e,n,r,i){this.se=t,this.re=e,this.xn=n,this.ie=r,this.Sn=i}get id(){return this.xn.path.C()}get ref(){return new Ze(this.se,this.Sn,this.xn)}exists(){return null!==this.ie}data(){if(this.ie){if(this.Sn){const t=new Un(this.se,this.re,this.xn,this.ie,null);return this.Sn.fromFirestore(t)}return this.re.oe(this.ie.$t())}}get(t){if(this.ie){const e=this.ie.data().field(Vn("DocumentSnapshot.get",t));if(null!==e)return this.re.oe(e)}}}class Un extends xn{data(){return super.data()}}class Mn{constructor(t,e){this.ue=e,this.query=t}get docs(){return[...this.ue]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.ue.forEach(t,e)}}function Vn(t,e){return"string"==typeof e?Cn(t,e):e instanceof Qe?e.et.Ln:e.Ln}class Fn{}class qn extends Fn{constructor(t,e,n){super(),this.ae=t,this.he=e,this.le=n,this.type="where"}ce(t){const e=gn(t.firestore),n=function(t,e,n,r,i,s,o){let a;if(i.Y()){if("array-contains"===s||"array-contains-any"===s)throw new j(k,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){Wn(o,s);const e=[];for(const n of o)e.push(zn(r,t,n));a={arrayValue:{values:e}}}else a=zn(r,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Wn(o,s),a=Sn(n,"where",o,"in"===s||"not-in"===s);const u=Wt.create(i,s,a);return function(t,e){if(e.Ot()){const n=ce(t);if(null!==n&&!n.isEqual(e.field))throw new j(k,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=ue(t);null!==r&&Kn(t,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new j(k,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(k,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.On,0,e,t.firestore.Tn,this.ae,this.he,this.le);return new tn(t.firestore,t.Sn,function(t,e){const n=t.filters.concat([e]);return new oe(t.path,t.collectionGroup,t.Ct.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.On,n))}}class jn extends Fn{constructor(t,e){super(),this.ae=t,this.fe=e,this.type="orderBy"}ce(t){const e=function(t,e,n){if(null!==t.startAt)throw new j(k,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new j(k,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new re(e,n);return function(t,e){if(null===ue(t)){const n=ce(t);null!==n&&Kn(t,n,e.field)}}(t,r),r}(t.On,this.ae,this.fe);return new tn(t.firestore,t.Sn,function(t,e){const n=t.Ct.concat([e]);return new oe(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.On,e))}}class Bn extends Fn{constructor(t,e,n){super(),this.type=t,this.de=e,this._e=n}ce(t){return new tn(t.firestore,t.Sn,function(t,e,n){return new oe(t.path,t.collectionGroup,t.Ct.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.On,this.de,this._e))}}class $n extends Fn{constructor(t,e,n){super(),this.type=t,this.we=e,this.me=n}ce(t){const e=Gn(t,this.type,this.we,this.me);return new tn(t.firestore,t.Sn,function(t,e){return new oe(t.path,t.collectionGroup,t.Ct.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.On,e))}}class Hn extends Fn{constructor(t,e,n){super(),this.type=t,this.we=e,this.me=n}ce(t){const e=Gn(t,this.type,this.we,this.me);return new tn(t.firestore,t.Sn,function(t,e){return new oe(t.path,t.collectionGroup,t.Ct.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.On,e))}}function Gn(t,e,n,r){if(n[0]instanceof Qe&&(n[0]=n[0].et),n[0]instanceof xn)return function(t,e,n,r,i){if(!r)throw new j(R,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const s=[];for(const n of le(t))if(n.field.Y())s.push(xt(e,r.key));else{const t=r.field(n.field);if(Nt(t))throw new j(k,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.B();throw new j(k,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new ne(s,i)}(t.On,t.firestore.Tn,e,n[0].ie,r);{const i=gn(t.firestore);return function(t,e,n,r,i,s){const o=t.Ct;if(i.length>o.length)throw new j(k,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const u=i[s];if(o[s].field.Y()){if("string"!=typeof u)throw new j(k,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof u}`);if(!he(t)&&-1!==u.indexOf("/"))throw new j(k,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(Y.k(u));if(!Z.tt(n))throw new j(k,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Z(n);a.push(xt(e,i))}else{const t=Sn(n,r,u);a.push(t)}}return new ne(a,s)}(t.On,t.firestore.Tn,i,e,n,r)}}function zn(t,e,n){if(n instanceof Qe&&(n=n.et),"string"==typeof n){if(""===n)throw new j(k,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!he(e)&&-1!==n.indexOf("/"))throw new j(k,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Y.k(n));if(!Z.tt(r))throw new j(k,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xt(t,new Z(r))}if(n instanceof Ze)return xt(t,n.xn);throw new j(k,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+rt(n)+".")}function Wn(t,e){if(!Array.isArray(t)||0===t.length)throw new j(k,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new j(k,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Kn(t,e,n){if(!n.isEqual(e))throw new j(k,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function Xn(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Yn extends class{oe(t,e="none"){switch(Ot(t)){case 0:return null;case 1:return t.booleanValue;case 2:return At(t.integerValue||t.doubleValue);case 3:return this.pe(t.timestampValue);case 4:return this.ye(t,e);case 5:return t.stringValue;case 6:return this.Ee(kt(t.bytesValue));case 7:return this.Ie(t.referenceValue);case 8:return this.Te(t.geoPointValue);case 9:return this.Ae(t.arrayValue,e);case 10:return this.Pe(t.mapValue,e);default:throw E()}}Pe(t,e){const n={};return Et(t.fields||{},(t,r)=>{n[t]=this.oe(r,e)}),n}Te(t){return new un(At(t.latitude),At(t.longitude))}Ae(t,e){return(t.values||[]).map(t=>this.oe(t,e))}ye(t,e){switch(e){case"previous":const n=function t(e){const n=e.mapValue.fields.__previous_value__;return Nt(n)?t(n):n}(t);return null==n?null:this.oe(n,e);case"estimate":return this.pe(Rt(t));default:return null}}pe(t){const e=St(t);return new yt(e.seconds,e.nanos)}Re(t,e){const n=Y.k(t);I(je(n));const r=new K(n.get(1),n.get(3)),i=new Z(n.S(5));return r.isEqual(e)||w(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}Ee(t){return new sn(t)}Ie(t){const e=this.Re(t,this.firestore.Tn);return new Ze(this.firestore,null,e)}}class Jn{constructor(t,e){this.se=t,this.Ve=e,this.ge=[],this.ve=!1,this.be=gn(t)}set(t,e,n){this.Ne();const r=Qn(t,this.se),i=Xn(r.Sn,e,n),s=mn(this.be,"WriteBatch.set",r.xn,i,null!==r.Sn,n);return this.ge.push(s.jn(r.xn,be.Qt())),this}update(t,e,n,...r){this.Ne();const i=Qn(t,this.se);let s;return e instanceof Qe&&(e=e.et),s="string"==typeof e||e instanceof on?Tn(this.be,"WriteBatch.update",i.xn,e,n,r):_n(this.be,"WriteBatch.update",i.xn,e),this.ge.push(s.jn(i.xn,be.exists(!0))),this}delete(t){this.Ne();const e=Qn(t,this.se);return this.ge=this.ge.concat(new Te(e.xn,be.Qt())),this}commit(){return this.Ne(),this.ve=!0,this.ge.length>0?this.Ve(this.ge):Promise.resolve()}Ne(){if(this.ve)throw new j(L,"A write batch can no longer be used after commit() has been called.")}}function Qn(t,e){if(t instanceof Qe&&(t=t.et),t.firestore!==e)throw new j(k,"Provided document reference is from a different Firestore instance.");return t}class Zn{constructor(t){this.De=t,this.Fe=new Map,this.mutations=[],this.$e=!1,this.Se=null,this.xe=new Set}async qe(t){if(this.Oe(),this.mutations.length>0)throw new j(k,"Firestore transactions require all reads to be executed before all writes.");const e=await We(this.De,t);return e.forEach(t=>{t instanceof Ht||t instanceof $t?this.Ce(t):E()}),e}set(t,e){this.write(e.jn(t,this.zt(t))),this.xe.add(t.toString())}update(t,e){try{this.write(e.jn(t,this.Le(t)))}catch(t){this.Se=t}this.xe.add(t.toString())}delete(t){this.write(new Te(t,this.zt(t))),this.xe.add(t.toString())}async commit(){if(this.Oe(),this.Se)throw this.Se;const t=this.Fe;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=Z.J(e);this.mutations.push(new Se(n,this.zt(n)))}),await ze(this.De,this.mutations),this.$e=!0}Ce(t){let e;if(t instanceof $t)e=t.version;else{if(!(t instanceof Ht))throw E();e=wt.min()}const n=this.Fe.get(t.key.toString());if(n){if(!e.isEqual(n))throw new j(x,"Document version changed between two reads.")}else this.Fe.set(t.key.toString(),e)}zt(t){const e=this.Fe.get(t.toString());return!this.xe.has(t.toString())&&e?be.updateTime(e):be.Qt()}Le(t){const e=this.Fe.get(t.toString());if(!this.xe.has(t.toString())&&e){if(e.isEqual(wt.min()))throw new j(k,"Can't update a document that doesn't exist.");return be.updateTime(e)}return be.exists(!0)}write(t){this.Oe(),this.mutations.push(t)}Oe(){}}class tr{constructor(t,e,n,r){this.Yt=t,this.De=e,this.updateFunction=n,this.Zt=r,this.Ue=5,this.Me=new He(this.Yt,"transaction_retry")}run(){this.je()}je(){this.Me.dn(async()=>{const t=new Zn(this.De),e=this.Be(t);e&&e.then(e=>{this.Yt.sn(()=>t.commit().then(()=>{this.Zt.resolve(e)}).catch(t=>{this.ke(t)}))}).catch(t=>{this.ke(t)})})}Be(t){try{const e=this.updateFunction(t);return!ot(e)&&e.catch&&e.then?e:(this.Zt.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Zt.reject(t),null}}ke(t){this.Ue>0&&this.Qe(t)?(this.Ue-=1,this.Yt.sn(()=>(this.je(),Promise.resolve()))):this.Zt.reject(t)}Qe(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case T:return E();case S:case A:case N:case D:case V:case F:case C:return!1;case k:case R:case O:case P:case L:case x:case U:case M:case q:return!0;default:return E()}}()}return!1}}function er(){return"undefined"!=typeof document?document:null}class nr{constructor(){this.We=Promise.resolve(),this.ze=[],this.Ge=!1,this.Ye=[],this.He=null,this.Ke=!1,this.Je=[],this.Me=new He(this,"async_queue_retry"),this.Ze=(()=>{const t=er();t&&y("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Me.mn()});const t=er();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ze)}get Xe(){return this.Ge}sn(t){this.enqueue(t)}ts(t){this.ns(),this.es(t)}ss(){if(!this.Ge){this.Ge=!0;const t=er();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ze)}}enqueue(t){return this.ns(),this.Ge?new Promise(t=>{}):this.es(t)}rs(t){this.sn(()=>(this.ze.push(t),this.os()))}async os(){if(0!==this.ze.length){try{await this.ze[0](),this.ze.shift(),this.Me.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;y("AsyncQueue","Operation failed with retryable error: "+t)}this.ze.length>0&&this.Me.dn(()=>this.os())}}es(t){const e=this.We.then(()=>(this.Ke=!0,t().catch(t=>{throw this.He=t,this.Ke=!1,w("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.Ke=!1,t))));return this.We=e,e}wn(t,e,n){this.ns(),this.Je.indexOf(t)>-1&&(e=0);const r=$e.Xt(this,t,e,n,t=>this.us(t));return this.Ye.push(r),r}ns(){this.He&&E()}cs(){}async hs(){let t;do{t=this.We,await t}while(t!==this.We)}ls(t){for(const e of this.Ye)if(e.Ht===t)return!0;return!1}fs(t){return this.hs().then(()=>{this.Ye.sort((t,e)=>t.Kt-e.Kt);for(const e of this.Ye)if(e.en(),"all"!==t&&e.Ht===t)break;return this.hs()})}ds(t){this.Je.push(t)}us(t){const e=this.Ye.indexOf(t);this.Ye.splice(e,1)}}class rr{constructor(t,e){this.se=t,this._s=e,this.be=gn(t)}get(t){const e=Qn(t,this.se),n=new Yn(this.se);return this._s.qe([e.xn]).then(t=>{if(!t||1!==t.length)return E();const r=t[0];if(r instanceof Ht)return new xn(this.se,n,e.xn,null,e.Sn);if(r instanceof $t)return new xn(this.se,n,r.key,r,e.Sn);throw E()})}set(t,e,n){const r=Qn(t,this.se),i=Xn(r.Sn,e,n),s=mn(this.be,"Transaction.set",r.xn,i,null!==r.Sn,n);return this._s.set(r.xn,s),this}update(t,e,n,...r){const i=Qn(t,this.se);let s;return e instanceof Qe&&(e=e.et),s="string"==typeof e||e instanceof on?Tn(this.be,"Transaction.update",i.xn,e,n,r):_n(this.be,"Transaction.update",i.xn,e),this._s.update(i.xn,s),this}delete(t){const e=Qn(t,this.se);return this._s.delete(e.xn),this}}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new Je(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.900","node"),t.Bytes=sn,t.CollectionReference=en,t.DocumentReference=Ze,t.DocumentSnapshot=xn,t.FieldPath=on,t.FieldValue=an,t.FirebaseFirestore=Je,t.FirestoreError=j,t.GeoPoint=un,t.Query=tn,t.QueryConstraint=Fn,t.QueryDocumentSnapshot=Un,t.QuerySnapshot=Mn,t.Timestamp=yt,t.Transaction=rr,t.WriteBatch=Jn,t.addDoc=function(t,e){const n=nn(t=it(t,en)),r=Xn(t.Sn,e),i=mn(gn(t.firestore),"addDoc",n.xn,r,null!==n.Sn,{});return ze(Ye(t.firestore),[i.jn(n.xn,be.exists(!1))]).then(()=>n)},t.arrayRemove=function(...t){return new En("arrayRemove",t)},t.arrayUnion=function(...t){return new bn("arrayUnion",t)},t.collection=function(t,e,...n){if(t instanceof Qe&&(t=t.et),tt("collection","path",e),t instanceof Je){const r=Y.k(e,...n);return nt(r),new en(t,null,r)}{if(!(t instanceof Ze||t instanceof en))throw new j(k,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=Y.k(t.path,...n).child(Y.k(e));return nt(r),new en(t.firestore,null,r)}},t.collectionGroup=function(t,e){if(t=it(t,Je),tt("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new j(k,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new tn(t,null,function(t){return new oe(Y.W(),t)}(e))},t.deleteDoc=function(t){return ze(Ye((t=it(t,Ze)).firestore),[new Te(t.xn,be.Qt())])},t.deleteField=function(){return new vn("deleteField")},t.doc=nn,t.documentId=function(){return new on("__name__")},t.endAt=function(...t){return new Hn("endAt",t,!1)},t.endBefore=function(...t){return new Hn("endBefore",t,!0)},t.getDoc=function(t){const e=Ye((t=it(t,Ze)).firestore),n=new Yn(t.firestore);return We(e,[t.xn]).then(e=>{I(1===e.length);const r=e[0];return new xn(t.firestore,n,t.xn,r instanceof $t?r:null,t.Sn)})},t.getDocs=function(t){!function(t){if(ae(t)&&0===t.Ct.length)throw new j(M,"limitToLast() queries require specifying at least one orderBy() clause")}((t=it(t,tn)).On);const e=Ye(t.firestore),n=new Yn(t.firestore);return async function(t,e){const n=_(t),r=Ve(n.Bt,fe(e));return(await n.ht("RunQuery",r.parent,{structuredQuery:r.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const r=De(t,e.name),i=Oe(e.updateTime),s=new qt({mapValue:{fields:e.fields}});return new $t(r,i,s,{hasCommittedMutations:!1})})(n.Bt,t.document))}(e,t.On).then(e=>{const r=e.map(e=>new Un(t.firestore,n,e.key,e,t.Sn));return ae(t.On)&&r.reverse(),new Mn(t,r)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new In("increment",t)},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore/lite").getImmediate();return r.Dn(n),r},t.limit=function(t){return st("limit",t),new Bn("limit",t,"F")},t.limitToLast=function(t){return st("limitToLast",t),new Bn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,r=Vn("orderBy",t);return new jn(r,n)},t.query=function(t,...e){for(const n of e)t=n.ce(t);return t},t.queryEqual=rn,t.refEqual=function(t,e){return t instanceof Qe&&(t=t.et),e instanceof Qe&&(e=e.et),(t instanceof Ze||t instanceof en)&&(e instanceof Ze||e instanceof en)&&t.firestore===e.firestore&&t.path===e.path&&t.Sn===e.Sn},t.runTransaction=function(t,e){const n=Ye(t=it(t,Je)),r=new dt;return new tr(new nr,n,n=>e(new rr(t,n)),r).run(),r.promise},t.serverTimestamp=function(){return new wn("serverTimestamp")},t.setDoc=function(t,e,n){const r=Xn((t=it(t,Ze)).Sn,e,n),i=mn(gn(t.firestore),"setDoc",t.xn,r,null!==t.Sn,n);return ze(Ye(t.firestore),[i.jn(t.xn,be.Qt())])},t.setLogLevel=function(t){v.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof Qe&&(e=e.et),n instanceof Qe&&(n=n.et),e instanceof xn&&n instanceof xn?e.se===n.se&&e.xn.isEqual(n.xn)&&(null===e.ie?null===n.ie:e.ie.isEqual(n.ie))&&e.Sn===n.Sn:e instanceof Mn&&n instanceof Mn&&rn(e.query,n.query)&&vt(e.docs,n.docs,t)},t.startAfter=function(...t){return new $n("startAfter",t,!1)},t.startAt=function(...t){return new $n("startAt",t,!0)},t.terminate=function(t){return t=it(t,Je),e._removeServiceInstance(t.app,"firestore/lite"),t._delete()},t.updateDoc=function(t,e,n,...r){const i=gn((t=it(t,Ze)).firestore);let s;return e instanceof Qe&&(e=e.et),s="string"==typeof e||e instanceof on?Tn(i,"updateDoc",t.xn,e,n,r):_n(i,"updateDoc",t.xn,e),ze(Ye(t.firestore),[s.jn(t.xn,be.exists(!0))])},t.where=function(t,e,n){const r=e,i=Vn("where",t);return new qn(i,r,n)},t.writeBatch=function(t){const e=Ye(t=it(t,Je));return new Jn(t,t=>ze(e,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.performance=t.firebase.performance||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function o(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function c(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var h="FirebaseError",l=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=h,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,f.prototype.create),s}return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),f=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(g,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").";return new l(i,a,r)},t}();var d,p,g=/\{\$([^}]+)}/g;function m(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(p||(p={}));var v={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},y=p.INFO,w=((d={})[p.DEBUG]="log",d[p.VERBOSE]="log",d[p.INFO]="info",d[p.WARN]="warn",d[p.ERROR]="error",d),b=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=w[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,m(["["+i+"]  "+t.name+":"],n))}},E=function(){function t(t){this.name=t,this._logLevel=y,this._logHandler=b,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?v[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.DEBUG],t)),this._logHandler.apply(this,m([this,p.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.VERBOSE],t)),this._logHandler.apply(this,m([this,p.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.INFO],t)),this._logHandler.apply(this,m([this,p.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.WARN],t)),this._logHandler.apply(this,m([this,p.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.ERROR],t)),this._logHandler.apply(this,m([this,p.ERROR],t))},t}(),I=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function _(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function T(t,e,n){var r,i=new Promise(function(i,s){_(r=t[e].apply(t,n)).then(i,s)});return i.request=r,i}function S(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function A(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return T(this[e],r,arguments)})})}function k(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function N(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return t=this[e],(n=T(t,r,arguments)).then(function(t){if(t)return new O(t,n.request)});var t,n})})}function R(t){this._index=t}function O(t,e){this._cursor=t,this._request=e}function P(t){this._store=t}function C(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function D(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new C(n)}function L(t){this._db=t}S(R,"_index",["name","keyPath","multiEntry","unique"]),A(R,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),N(R,"_index",IDBIndex,["openCursor","openKeyCursor"]),S(O,"_cursor",["direction","key","primaryKey","value"]),A(O,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(O.prototype[t]=function(){var e=this,n=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,n),_(e._request).then(function(t){if(t)return new O(t,e._request)})})})}),P.prototype.createIndex=function(){return new R(this._store.createIndex.apply(this._store,arguments))},P.prototype.index=function(){return new R(this._store.index.apply(this._store,arguments))},S(P,"_store",["name","keyPath","indexNames","autoIncrement"]),A(P,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),N(P,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),k(P,"_store",IDBObjectStore,["deleteIndex"]),C.prototype.objectStore=function(){return new P(this._tx.objectStore.apply(this._tx,arguments))},S(C,"_tx",["objectStoreNames","mode"]),k(C,"_tx",IDBTransaction,["abort"]),D.prototype.createObjectStore=function(){return new P(this._db.createObjectStore.apply(this._db,arguments))},S(D,"_db",["name","version","objectStoreNames"]),k(D,"_db",IDBDatabase,["deleteObjectStore","close"]),L.prototype.transaction=function(){return new C(this._db.transaction.apply(this._db,arguments))},S(L,"_db",["name","version","objectStoreNames"]),k(L,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[P,R].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,n=(e=arguments,Array.prototype.slice.call(e)),r=n[n.length-1],i=this._store||this._index,s=i[t].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})})}),[R,P].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)})})})});var x,U="@firebase/installations",M="0.4.19",V=1e4,F="w:"+M,q="FIS_v2",j="https://firebaseinstallations.googleapis.com/v1",B=36e5,$=((x={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',x["not-registered"]="Firebase Installation is not registered.",x["installation-not-found"]="Firebase Installation not found.",x["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',x["app-offline"]="Could not process request. Application offline.",x["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",x),H=new f("installations","Installations",$);function G(t){return t instanceof l&&t.code.includes("request-failed")}function z(t){var e=t.projectId;return j+"/projects/"+e+"/installations"}function W(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function K(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,H.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}})})}function X(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Y(t,e){var n=e.refreshToken,r=X(t);return r.append("Authorization",function(t){return q+" "+t}(n)),r}function J(t){return s(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}})})}function Q(t){return new Promise(function(e){setTimeout(e,t)})}function Z(t){return btoa(String.fromCharCode.apply(String,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t}(t))).replace(/\+/g,"-").replace(/\//g,"_")}var tt=/^[cdef][\w-]{21}$/,et="";function nt(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return Z(t).substr(0,22)}(t);return tt.test(e)?e:et}catch(t){return et}}function rt(t){return t.appName+"!"+t.appId}var it=new Map;function st(t,e){var n=rt(t);ot(n,e),function(t,e){var n=ut();n&&n.postMessage({key:t,fid:e});ct()}(n,e)}function ot(t,e){var n,r,i=it.get(t);if(i)try{for(var s=a(i),o=s.next();!o.done;o=s.next()){(0,o.value)(e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}var at=null;function ut(){return!at&&"BroadcastChannel"in self&&((at=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){ot(t.data.key,t.data.fid)}),at}function ct(){0===it.size&&at&&(at.close(),at=null)}var ht,lt="firebase-installations-database",ft=1,dt="firebase-installations-store",pt=null;function gt(){var t,e,n;return pt||(t=function(t){switch(t.oldVersion){case 0:t.createObjectStore(dt)}},e=T(indexedDB,"open",[lt,ft]),(n=e.request)&&(n.onupgradeneeded=function(e){t&&t(new D(n.result,e.oldVersion,n.transaction))}),pt=e.then(function(t){return new L(t)})),pt}function mt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s,a;return o(this,function(o){switch(o.label){case 0:return n=rt(t),[4,gt()];case 1:return r=o.sent(),i=r.transaction(dt,"readwrite"),[4,(s=i.objectStore(dt)).get(n)];case 2:return a=o.sent(),[4,s.put(e,n)];case 3:return o.sent(),[4,i.complete];case 4:return o.sent(),a&&a.fid===e.fid||st(t,e.fid),[2,e]}})})}function vt(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return e=rt(t),[4,gt()];case 1:return n=i.sent(),[4,(r=n.transaction(dt,"readwrite")).objectStore(dt).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}})})}function yt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s,a,u;return o(this,function(o){switch(o.label){case 0:return n=rt(t),[4,gt()];case 1:return r=o.sent(),i=r.transaction(dt,"readwrite"),[4,(s=i.objectStore(dt)).get(n)];case 2:return a=o.sent(),void 0!==(u=e(a))?[3,4]:[4,s.delete(n)];case 3:return o.sent(),[3,6];case 4:return[4,s.put(u,n)];case 5:o.sent(),o.label=6;case 6:return[4,i.complete];case 7:return o.sent(),!u||a&&a.fid===u.fid||st(t,u.fid),[2,u]}})})}function wt(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return[4,yt(t,function(n){var r=function(t){return Et(t||{fid:nt(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){var n=Promise.reject(H.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,function(t,e){var n=e.fid;return s(this,void 0,void 0,function(){var e,r,i,s,a,u;return o(this,function(o){switch(o.label){case 0:return e=z(t),r=X(t),i={fid:n,authVersion:q,appId:t.appId,sdkVersion:F},s={method:"POST",headers:r,body:JSON.stringify(i)},[4,J(function(){return fetch(e,s)})];case 1:return(a=o.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(u=o.sent()).fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:W(u.authToken)}];case 3:return[4,K("Create Installation",a)];case 4:throw o.sent()}})})}(t,e)];case 1:return n=i.sent(),[2,mt(t,n)];case 2:return G(r=i.sent())&&409===r.customData.serverCode?[4,vt(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,mt(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}})})}(t,r);return{installationEntry:r,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:function(t){return s(this,void 0,void 0,function(){var e,n,r,i;return o(this,function(s){switch(s.label){case 0:return[4,bt(t)];case 1:e=s.sent(),s.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Q(100)];case 3:return s.sent(),[4,bt(t)];case 4:return e=s.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,wt(t)];case 6:return n=s.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}})})}(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry})];case 1:return(n=i.sent()).fid!==et?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function bt(t){return yt(t,function(t){if(!t)throw H.create("installation-not-found");return Et(t)})}function Et(t){return 1===(e=t).registrationStatus&&e.registrationTime+V<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function It(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return s(this,void 0,void 0,function(){var t,i,s,a,u,c,h;return o(this,function(o){switch(o.label){case 0:return t=function(t,e){var n=e.fid;return z(t)+"/"+n+"/authTokens:generate"}(n,e),i=Y(n,e),(s=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",s.getPlatformInfoString()),a={installation:{sdkVersion:F}},u={method:"POST",headers:i,body:JSON.stringify(a)},[4,J(function(){return fetch(t,u)})];case 1:return(c=o.sent()).ok?[4,c.json()]:[3,3];case 2:return h=o.sent(),[2,W(h)];case 3:return[4,K("Generate Auth Token",c)];case 4:throw o.sent()}})})}function _t(t,e){return void 0===e&&(e=!1),s(this,void 0,void 0,function(){var n,r,a;return o(this,function(u){switch(u.label){case 0:return[4,yt(t.appConfig,function(r){if(!St(r))throw H.create("not-registered");var a,u=r.authToken;if(e||2!==(a=u).requestStatus||function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+B}(a)){if(1===u.requestStatus)return n=function(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return[4,Tt(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Q(100)];case 3:return i.sent(),[4,Tt(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,_t(t,e)]:[2,r]}})})}(t,e),r;if(!navigator.onLine)throw H.create("app-offline");var c=function(t){var e={requestStatus:1,requestTime:Date.now()};return i(i({},t),{authToken:e})}(r);return n=function(t,e){return s(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,It(t,e)];case 1:return n=o.sent(),s=i(i({},e),{authToken:n}),[4,mt(t.appConfig,s)];case 2:return o.sent(),[2,n];case 3:return!G(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,vt(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return s=i(i({},e),{authToken:{requestStatus:0}}),[4,mt(t.appConfig,s)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}})})}(t,c),c}return r})];case 1:return r=u.sent(),n?[4,n]:[3,3];case 2:return a=u.sent(),[3,4];case 3:a=r.authToken,u.label=4;case 4:return[2,a]}})})}function Tt(t){return yt(t,function(t){if(!St(t))throw H.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+V<Date.now()?i(i({},t),{authToken:{requestStatus:0}}):t})}function St(t){return void 0!==t&&2===t.registrationStatus}function At(t,e){return void 0===e&&(e=!1),s(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,function(t){return s(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return[4,wt(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return n.sent(),[4,_t(t,e)];case 2:return[2,n.sent().token]}})})}function kt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s;return o(this,function(o){switch(o.label){case 0:return n=function(t,e){var n=e.fid;return z(t)+"/"+n}(t,e),r=Y(t,e),i={method:"DELETE",headers:r},[4,J(function(){return fetch(n,i)})];case 1:return(s=o.sent()).ok?[3,3]:[4,K("Delete Installation",s)];case 2:throw o.sent();case 3:return[2]}})})}function Nt(t,e){var n=t.appConfig;return function(t,e){ut();var n=rt(t),r=it.get(n);r||(r=new Set,it.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=rt(t),r=it.get(n);r&&(r.delete(e),0===r.size&&it.delete(n),ct())}(n,e)}}function Rt(t){return H.create("missing-app-config-values",{valueName:t})}(ht=n.default).INTERNAL.registerComponent(new I("installations",function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Rt("App Configuration");if(!t.name)throw Rt("App Name");try{for(var r=a(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var s=i.value;if(!t.options[s])throw Rt(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return[4,wt(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):_t(t).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(t){return At(n,t)},delete:function(){return function(t){return s(this,void 0,void 0,function(){var e,n;return o(this,function(r){switch(r.label){case 0:return[4,yt(e=t.appConfig,function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw H.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw H.create("app-offline");case 3:return[4,kt(e,n)];case 4:return r.sent(),[4,vt(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}(n)},onIdChange:function(t){return Nt(n,t)}}},"PUBLIC")),ht.registerVersion(U,M);var Ot,Pt,Ct,Dt="0.0.900",Lt="FB-PERF-TRACE-START",xt="FB-PERF-TRACE-STOP",Ut="FB-PERF-TRACE-MEASURE",Mt="_wt_",Vt="@firebase/performance/config",Ft="@firebase/performance/configexpire",qt=((Ot={})["trace started"]="Trace {$traceName} was started before.",Ot["trace stopped"]="Trace {$traceName} is not running.",Ot["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Ot["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Ot["no window"]="Window is not available.",Ot["no app id"]="App id is not available.",Ot["no project id"]="Project id is not available.",Ot["no api key"]="Api key is not available.",Ot["invalid cc log"]="Attempted to queue invalid cc event",Ot["FB not default"]="Performance can only start when Firebase app instance is the default one.",Ot["RC response not ok"]="RC response is not ok",Ot["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Ot["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Ot["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Ot["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Ot),jt=new f("performance","Performance",qt),Bt=new E("Performance");Bt.logLevel=p.INFO;var $t,Ht,Gt=function(){function t(t){if(this.window=t,!t)throw jt.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?"indexedDB"in self&&null!=indexedDB||(Bt.info("IndexedDB is not supported by current browswer"),!1):(Bt.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Pt&&(Pt=new t(Ct)),Pt},t}();function zt(){return $t}function Wt(t,e){var n=t.length-e.length;if(n<0||n>1)throw jt.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Kt,Xt=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Wt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Wt("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Ht&&(Ht=new t),Ht},t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Kt||(Kt={}));var Yt=["firebase_","google_","ga_"],Jt=new RegExp("^[a-zA-Z]\\w*$"),Qt=40,Zt=100;function te(){switch(Gt.getInstance().document.visibilityState){case"visible":return Kt.VISIBLE;case"hidden":return Kt.HIDDEN;default:return Kt.UNKNOWN}}function ee(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.appId;if(!n)throw jt.create("no app id");return n}var ne="0.0.1",re={loggingEnabled:!0},ie="FIREBASE_INSTALLATIONS_AUTH";function se(t,e){var n=function(){var t=Gt.getInstance().localStorage;if(!t)return;var e=t.getItem(Ft);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(Vt);if(!r)return;try{var i=JSON.parse(r);return i}catch(t){return}}();return n?(ae(n),Promise.resolve()):function(t,e){return(n=t.installations,r=n.getToken(),r.then(function(t){}),r).then(function(n){var r=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.projectId;if(!n)throw jt.create("no project id");return n}(t.app),i=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.apiKey;if(!n)throw jt.create("no api key");return n}(t.app),s="https://firebaseremoteconfig.googleapis.com/v1/projects/"+r+"/namespaces/fireperf:fetch?key="+i,o=new Request(s,{method:"POST",headers:{Authorization:ie+" "+n},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:ee(t.app),app_version:Dt,sdk_version:ne})});return fetch(o).then(function(t){if(t.ok)return t.json();throw jt.create("RC response not ok")})}).catch(function(){Bt.info(oe)});var n,r}(t,e).then(ae).then(function(t){return function(t){var e=Gt.getInstance().localStorage;if(!t||!e)return;e.setItem(Vt,JSON.stringify(t)),e.setItem(Ft,String(Date.now()+60*Xt.getInstance().configTimeToLive*60*1e3))}(t)},function(){})}var oe="Could not fetch config, will use default configs";function ae(t){if(!t)return t;var e=Xt.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=re.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=ue(e.tracesSamplingRate),e.logNetworkAfterSampling=ue(e.networkRequestsSamplingRate),t}function ue(t){return Math.random()<=t}var ce,he=1;function le(t){return he=2,ce=ce||function(t){return(e=Gt.getInstance().document,new Promise(function(t){if(e&&"complete"!==e.readyState){var n=function(){"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()})).then(function(){return e=t.installations,(n=e.getId()).then(function(t){$t=t}),n;var e,n}).then(function(e){return se(t,e)}).then(function(){return fe()},function(){return fe()});var e}(t)}function fe(){he=3}var de,pe=1e4,ge=5500,me=3,ve=1e3,ye=me,we=[],be=!1;function Ee(t){setTimeout(function(){var t,e;if(0!==ye)return we.length?(t=we.splice(0,ve),e=t.map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}),void function(t,e){return function(t){var e=Xt.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(function(t){return t.ok||Bt.info("Call to Firebase backend failed."),t.json()}).then(function(t){var n=Number(t.nextRequestWaitMillis),r=pe;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(we=c(e,we),Bt.info("Retry transport request later.")),ye=me,Ee(r)})}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Xt.getInstance().logSource,log_event:e},t).catch(function(){we=c(t,we),ye--,Bt.info("Tries left: "+ye+"."),Ee(pe)})):Ee(pe)},t)}function Ie(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];!function(t){if(!t.eventTime||!t.message)throw jt.create("invalid cc log");we=c(we,[t])}({message:t.apply(void 0,e),eventTime:Date.now()})}}function _e(t,e){de||(de=Ie(Ae)),de(t,e)}function Te(t){var e=Xt.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Gt.getInstance().requiredApisAvailable()&&(t.isAuto&&te()!==Kt.VISIBLE||(3===he?Se(t):le(t.performanceController).then(function(){return Se(t)},function(){return Se(t)})))}function Se(t){if(zt()){var e=Xt.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout(function(){return _e(t,1)},0)}}function Ae(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:ke(n.performanceController.app),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:ke(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function ke(t){return{google_app_id:ee(t),app_instance_id:zt(),web_app_info:{sdk_version:Dt,page_url:Gt.getInstance().getUrl(),service_worker_status:(e=Gt.getInstance().navigator,"serviceWorker"in e?e.serviceWorker.controller?2:3:1),visibility_state:te(),effective_connection_type:function(){var t=Gt.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}var Ne=100,Re="_",Oe=["_fp","_fcp","_fid"];var Pe=function(){function t(t,e,n,r){void 0===n&&(n=!1),this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=Gt.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=Lt+"-"+this.randomId+"-"+this.name,this.traceStopMark=xt+"-"+this.randomId+"-"+this.name,this.traceMeasure=r||Ut+"-"+this.randomId+"-"+this.name,r&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw jt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw jt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Te(this)},t.prototype.record=function(t,e,n){if(t<=0)throw jt.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw jt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=i({},n.attributes)),n&&n.metrics)for(var r=0,s=Object.keys(n.metrics);r<s.length;r++){var o=s[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Te(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,s=this.name,0===i.length||i.length>Ne||!(s&&s.startsWith(Mt)&&Oe.indexOf(i)>-1)&&i.startsWith(Re))throw jt.create("invalid custom metric name",{customMetricName:t});var n,r,i,s;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Bt.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>Qt||Yt.some(function(t){return n.startsWith(t)})||!n.match(Jt)),i=function(t){return 0!==t.length&&t.length<=Zt}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw jt.create("invalid attribute name",{attributeName:t});if(!i)throw jt.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return i({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r,i){var s=Gt.getInstance().getUrl();if(s){var o=new t(e,Mt+s,!0),a=Math.floor(1e3*Gt.getInstance().getTimeOrigin());o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(1e3*n[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*n[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*n[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*n[0].loadEventEnd)));if(r){var u=r.find(function(t){return"first-paint"===t.name});u&&u.startTime&&o.putMetric("_fp",Math.floor(1e3*u.startTime));var c=r.find(function(t){return"first-contentful-paint"===t.name});c&&c.startTime&&o.putMetric("_fcp",Math.floor(1e3*c.startTime)),i&&o.putMetric("_fid",Math.floor(1e3*i))}Te(o)}},t.createUserTimingTrace=function(e,n){Te(new t(e,n,!1,n))},t}();function Ce(t,e){var n=e;if(n&&void 0!==n.responseStart){var r=Gt.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(t){var e=Xt.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return _e(t,0)},0)}}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}}var De=5e3;function Le(t){zt()&&(setTimeout(function(){return function(t){var e=Gt.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){var i=setTimeout(function(){Pe.createOobTrace(t,n,r),i=void 0},De);e.onFirstInputDelay(function(e){i&&(clearTimeout(i),Pe.createOobTrace(t,n,r,e))})}else Pe.createOobTrace(t,n,r)}(t)},0),setTimeout(function(){return function(t){for(var e=Gt.getInstance(),n=e.getEntriesByType("resource"),r=0,i=n;r<i.length;r++){var s=i[r];Ce(t,s)}e.setupObserver("resource",function(e){return Ce(t,e)})}(t)},0),setTimeout(function(){return function(t){for(var e=Gt.getInstance(),n=e.getEntriesByType("measure"),r=0,i=n;r<i.length;r++){var s=i[r];xe(t,s)}e.setupObserver("measure",function(e){return xe(t,e)})}(t)},0))}function xe(t,e){var n=e.name;n.substring(0,Ut.length)!==Ut&&Pe.createUserTimingTrace(t,n)}var Ue=function(){function t(t,e){this.app=t,this.installations=e,this.initialized=!1}return t.prototype._init=function(t){var e=this;this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),Gt.getInstance().requiredApisAvailable()?new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}).then(function(t){t&&(be||(Ee(ge),be=!0),le(e).then(function(){return Le(e)},function(){return Le(e)}),e.initialized=!0)}).catch(function(t){Bt.info("Environment doesn't support IndexedDB: "+t)}):Bt.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Xt.getInstance().instrumentationEnabled},set:function(t){Xt.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Xt.getInstance().dataCollectionEnabled},set:function(t){Xt.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();var Me=function(t){var e=t.getProvider("app-exp").getImmediate(),n=t.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==e.name)throw jt.create("FB not default");if("undefined"==typeof window)throw jt.create("no window");return function(t){Ct=t}(window),new Ue(e,n)};e._registerComponent(new I("performance-exp",Me,"PUBLIC")),e.registerVersion("@firebase/performance-exp","0.0.900"),t.getPerformance=function(t,n){var r=e._getProvider(t,"performance-exp").getImmediate();return r._init(n),r},t.trace=function(t,e){return new Pe(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-performance.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["remote-config"]=t.firebase["remote-config"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var o="FirebaseError",a=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=o,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,u.prototype.create),s}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),u=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",u=this.serviceName+": "+o+" ("+i+").";return new a(i,u,r)},t}();var c=/\{\$([^}]+)}/g,h=1e3,l=2,f=144e5,d=.5;var p,g,m=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(g||(g={}));var y,w={debug:g.DEBUG,verbose:g.VERBOSE,info:g.INFO,warn:g.WARN,error:g.ERROR,silent:g.SILENT},b=g.INFO,E=((p={})[g.DEBUG]="log",p[g.VERBOSE]="log",p[g.INFO]="info",p[g.WARN]="warn",p[g.ERROR]="error",p),I=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=E[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,v(["["+i+"]  "+t.name+":"],n))}},_=function(){function t(t){this.name=t,this._logLevel=b,this._logHandler=I,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in g))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?w[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.DEBUG],t)),this._logHandler.apply(this,v([this,g.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.VERBOSE],t)),this._logHandler.apply(this,v([this,g.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.INFO],t)),this._logHandler.apply(this,v([this,g.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.WARN],t)),this._logHandler.apply(this,v([this,g.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.ERROR],t)),this._logHandler.apply(this,v([this,g.ERROR],t))},t}(),T="@firebase/remote-config-exp",S="0.0.900",A=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),k="remote-config-exp",N=((y={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",y["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",y["registration-api-key"]="Undefined API key. Check Firebase app initialization.",y["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",y["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",y["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",y["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",y["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",y["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",y["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',y["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',y["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",y["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",y),R=new u("remoteconfig","Remote Config",N);var O="",P=["1","true","t","yes","y","on"],C=function(){function t(t,e){void 0===e&&(e=O),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&P.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}();function D(t){return i(this,void 0,void 0,function(){var e,n,r,i;return s(this,function(s){switch(s.label){case 0:return e=t,[4,Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()])];case 1:return n=s.sent(),r=n[0],i=n[1],r&&r.config&&r.eTag&&r.eTag!==i?[4,Promise.all([e._storageCache.setActiveConfig(r.config),e._storage.setActiveConfigEtag(r.eTag)])]:[2,!1];case 2:return s.sent(),[2,!0]}})})}function L(t){var e=t;return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(function(){e._isInitializationComplete=!0})),e._initializePromise}function x(t){return i(this,void 0,void 0,function(){var e,n,r,o,u=this;return s(this,function(c){switch(c.label){case 0:e=t,n=new A,setTimeout(function(){return i(u,void 0,void 0,function(){return s(this,function(t){return n.abort(),[2]})})},e.settings.fetchTimeoutMillis),c.label=1;case 1:return c.trys.push([1,4,,6]),[4,e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n})];case 2:return c.sent(),[4,e._storageCache.setLastFetchStatus("success")];case 3:return c.sent(),[3,6];case 4:return r=c.sent(),l="fetch-throttle",o=(h=r)instanceof a&&-1!==h.code.indexOf(l)?"throttle":"failure",[4,e._storageCache.setLastFetchStatus(o)];case 5:throw c.sent(),r;case 6:return[2]}var h,l})})}function U(t,e){var n=t;n._isInitializationComplete||n._logger.debug('A value was requested for key "'+e+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var r=n._storageCache.getActiveConfig();return r&&void 0!==r[e]?new C("remote",r[e]):n.defaultConfig&&void 0!==n.defaultConfig[e]?new C("default",String(n.defaultConfig[e])):(n._logger.debug('Returning static value for key "'+e+'". Define a default or remote value if this is unintentional.'),new C("static"))}var M=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e,n,r,i,o;return s(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}})})},t}();var V=function(){function t(t,e,n,r,i,s){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}return t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c,h,l,f,d,p,g,m,v,y,w,b;return s(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=s.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===E&&(E=navigator),E.languages&&E.languages[0]||E.language)},c={method:"POST",headers:a,body:JSON.stringify(u)},h=fetch(o,c),l=new Promise(function(e,n){t.signal.addEventListener(function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)})}),s.label=2;case 2:return s.trys.push([2,5,,6]),[4,Promise.race([h,l])];case 3:return s.sent(),[4,h];case 4:return f=s.sent(),[3,6];case 5:throw d=s.sent(),p="fetch-client-network","AbortError"===d.name&&(p="fetch-timeout"),R.create(p,{originalErrorMessage:d.message});case 6:if(g=f.status,m=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];w=void 0,s.label=7;case 7:return s.trys.push([7,9,,10]),[4,f.json()];case 8:return w=s.sent(),[3,10];case 9:throw b=s.sent(),R.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:v=w.entries,y=w.state,s.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?g=500:"NO_CHANGE"===y?g=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(v={}),304!==g&&200!==g)throw R.create("fetch-status",{httpStatus:g});return[2,{status:g,eTag:m,config:v}]}var E})})},t}();var F=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}})})},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return i(this,void 0,void 0,function(){var e,i,o;return s(this,function(s){switch(s.label){case 0:return[4,function(t,e){return new Promise(function(n,r){var i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(function(){clearTimeout(s),r(R.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof a&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+function(t,e,n){void 0===e&&(e=h),void 0===n&&(n=l);var r=e*Math.pow(n,t),i=Math.round(d*r*(Math.random()-.5)*2);return Math.min(f,r+i)}(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}})})},t}(),q=6e4,j=432e5,B=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:q,minimumFetchIntervalMillis:j},this.defaultConfig={}}return Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t}();function $(t,e){var n=t.target.error||void 0;return R.create(e,{originalErrorMessage:n&&n.message})}var H="app_namespace_store",G="firebase_remote_config",z=1;var W=function(){function t(t,e,n,r){void 0===r&&(r=new Promise(function(t,e){var n=indexedDB.open(G,z);n.onerror=function(t){e($(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(H,{keyPath:"compositeKey"})}}})),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return i(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var s=e.transaction([H],"readonly").objectStore(H),o=n.createCompositeKey(t);try{var a=s.get(o);a.onerror=function(t){i($(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(R.create("storage-get",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.set=function(t,e){return i(this,void 0,void 0,function(){var n,r=this;return s(this,function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise(function(i,s){var o=n.transaction([H],"readwrite").objectStore(H),a=r.createCompositeKey(t);try{var u=o.put({compositeKey:a,value:e});u.onerror=function(t){s($(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){s(R.create("storage-set",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.delete=function(t){return i(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var s=e.transaction([H],"readwrite").objectStore(H),o=n.createCompositeKey(t);try{var a=s.delete(o);a.onerror=function(t){i($(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(t){i(R.create("storage-delete",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),K=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return i(this,void 0,void 0,function(){var t,e,n,r,i,o;return s(this,function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}})})},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();e._registerComponent(new m(k,function(t,n){var r=t.getProvider("app-exp").getImmediate(),i=t.getProvider("installations-exp-internal").getImmediate();if("undefined"==typeof window)throw R.create("registration-window");var s=r.options,o=s.projectId,a=s.apiKey,u=s.appId;if(!o)throw R.create("registration-project-id");if(!a)throw R.create("registration-api-key");if(!u)throw R.create("registration-app-id");n=n||"firebase";var c=new W(u,r.name,n),h=new K(c),l=new _(T);l.logLevel=g.ERROR;var f=new V(i,e.SDK_VERSION,n,o,a,u),d=new F(f,c),p=new M(d,c,h,l),m=new B(r,p,h,c,l);return L(m),m},"PUBLIC").setMultipleInstances(!0)),e.registerVersion(T,S),t.activate=D,t.ensureInitialized=L,t.fetchAndActivate=function(t){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,x(t)];case 1:return e.sent(),[2,D(t)]}})})},t.fetchConfig=x,t.getAll=function(t){var e=t;return(n=e._storageCache.getActiveConfig(),i=e.defaultConfig,void 0===n&&(n={}),void 0===i&&(i={}),Object.keys(r(r({},n),i))).reduce(function(e,n){return e[n]=U(t,n),e},{});var n,i},t.getBoolean=function(t,e){return U(t,e).asBoolean()},t.getNumber=function(t,e){return U(t,e).asNumber()},t.getRemoteConfig=function(t){return e._getProvider(t,k).getImmediate()},t.getString=function(t,e){return U(t,e).asString()},t.getValue=U,t.setLogLevel=function(t,e){var n=t;switch(e){case"debug":n._logger.logLevel=g.DEBUG;break;case"silent":n._logger.logLevel=g.SILENT;break;default:n._logger.logLevel=g.ERROR}},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-remote-config.js - be sure to load firebase-app.js first.")}});