!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Wd){"use strict";try{(function(){var l,t,e=(t=Wd)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=l=l||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}var Q=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}K=(Q=Q&&Q.userAgent)?Q:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=X(K,"Opera"),it=X(K,"Trident")||X(K,"MSIE"),ot=X(K,"Edge"),st=ot||it,ut=X(K,"Gecko")&&!(X(K.toLowerCase(),"webkit")&&!X(K,"Edge"))&&!(X(K,"Trident")||X(K,"MSIE"))&&!X(K,"Edge"),at=X(K.toLowerCase(),"webkit")&&!X(K,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);ft&&(ht=ft?ft[1]:""),nt=it&&null!=(ft=ct())&&ft>parseFloat(ht)?String(ft):ht;var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),xt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ut(r),e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ct(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Tt(t)))}function Lt(t){return t in xt?xt[t]:xt[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Rt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new wt(e,this))}function Ct(t){return(t=t[Dt])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==x(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Kt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Wt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Qt)}),Xt||(Bt(),Xt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=U()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==x(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(_(ee=oe,ne=te=q),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){q.call(this),this.b=t,this.a={}}j(se,q);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le=null;function pe(){return le=le||new jt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(de,mt),j(ve,mt),j(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ee(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Oe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Ne,mt),j(Se,mt),j(De,Ee),Ae=new De;var Oe=45e3,ke={},Pe={};function Le(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,Re(t,null)}function Re(t,e){t.u=U(),Ce(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,ge(),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,ge(),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Fe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),je(t))}function Ce(t){t.U=U()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function Ue(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){Ue(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}$n(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(En(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ue(o),Ce(o)),n.a=i):Jn(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=xe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Ue(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),qe(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Fe(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),qe(this),je(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Ue(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},A.cancel=function(){this.A=!0,qe(this)},A.Ua=function(){this.o=null;var t,e,n=U();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),qe(this),this.h=2,je(this)):Me(this,this.U-n)},(A=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Qe(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=en(n[2]||""),Qe(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Xe(t){return new We(t)}function Ye(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Qe(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function xn(t){jt.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}j(xn,jt);var On="",kn=/^https?$/i,Pn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Rn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Mn(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Fn("baseRetryDelayMs",5e3,t),this.Ma=Fn("retryDelaySeedMs",1e4,t),this.Ja=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ze(n=Xe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Yn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=U(),Ce(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),En(t.b,n),Le(n,r,e)}function Yn(t,n){t.f&&Ge({},function(t,e){Ze(n,e,t)})}function Qn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Ft(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new xe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Yn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,Re(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Wn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ye(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Tn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Xe(s):new We(s,void 0);return""!=a.c?(e&&Qe(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Ye(u,r),i&&Qe(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Yn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){jt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=xn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ae),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Rn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Rn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),xn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},A.Ta=function(){Cn(this)},A.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),Ze(i=Xe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),En(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},j(hr,jt),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},A.close=function(){Bn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Ft(t),Kn(this.a,e)):Kn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},j(fr,Ne),j(lr,Se),j(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new lr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ie.COMPLETE="complete",(Te.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,xn.prototype.listenOnce=xn.prototype.wa,xn.prototype.getLastError=xn.prototype.Qa,xn.prototype.getLastErrorCode=xn.prototype.ua,xn.prototype.getStatus=xn.prototype.X,xn.prototype.getResponseJson=xn.prototype.Na,xn.prototype.getResponseText=xn.prototype.$,xn.prototype.send=xn.prototype.ba;var dr=be,yr=Ie,vr=Te,gr=xn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Er=(n(Tr,br=Error),Tr),_r=new h("@firebase/firestore");function Tr(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Ar(){return _r.logLevel}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.DEBUG&&(e=n.map(xr),_r.debug.apply(_r,i(["Firestore (8.0.0): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.ERROR&&(e=n.map(xr),_r.error.apply(_r,i(["Firestore (8.0.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.WARN&&(e=n.map(xr),_r.warn.apply(_r,i(["Firestore (8.0.0): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Or(t){throw void 0===t&&(t="Unexpected state"),Sr(t="FIRESTORE (8.0.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||Or()}var Pr=(Lr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Lr);function Lr(){}function Rr(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Cr(t){return t+"\0"}var Mr=(Ur.fromBase64String=function(t){return new Ur(atob(t))},Ur.fromUint8Array=function(t){return new Ur(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ur.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Ur.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Ur.prototype.o=function(){return 2*this.i.length},Ur.prototype.h=function(t){return Rr(this.i,t.i)},Ur.prototype.isEqual=function(t){return this.i===t.i},Ur);function Ur(t){this.i=t}Mr.u=new Mr("");var jr=(qr.fromBase64String=function(t){try{return new qr(Mr.fromBase64String(t))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},qr.fromUint8Array=function(t){return new qr(Mr.fromUint8Array(t))},qr.prototype.toBase64=function(){return this.l.toBase64()},qr.prototype.toUint8Array=function(){return this.l.toUint8Array()},qr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},qr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},qr);function qr(t){this.l=t}function Fr(){if("undefined"==typeof Uint8Array)throw new Er(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gr(){if("undefined"==typeof atob)throw new Er(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Br(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var zr,Hr=(n(Xr,zr=jr),Xr.fromBase64String=function(t){Gr();try{return new Xr(Mr.fromBase64String(t))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Xr.fromUint8Array=function(t){return Fr(),new Xr(Mr.fromUint8Array(t))},Xr.prototype.toBase64=function(){return Gr(),zr.prototype.toBase64.call(this)},Xr.prototype.toUint8Array=function(){return Fr(),zr.prototype.toUint8Array.call(this)},Xr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xr),Kr=(Object.defineProperty(Wr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return t instanceof Wr&&t.projectId===this.projectId&&t.database===this.database},Wr.prototype.h=function(t){return Rr(this.projectId,t.projectId)||Rr(this.database,t.database)},Wr);function Wr(t,e){this.projectId=t,this.database=e||"(default)"}function Xr(){return null!==zr&&zr.apply(this,arguments)||this}function Yr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Qr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $r,Zr,ti=(pi.prototype.get=function(t){var e=this.m(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},pi.prototype.has=function(t){return void 0!==this.get(t)},pi.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},pi.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},pi.prototype.forEach=function(s){Qr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},pi.prototype.P=function(){return Jr(this.R)},pi),ei=(li.now=function(){return li.fromMillis(Date.now())},li.fromDate=function(t){return li.fromMillis(t.getTime())},li.fromMillis=function(t){var e=Math.floor(t/1e3);return new li(e,1e6*(t-1e3*e))},li.prototype.toDate=function(){return new Date(this.toMillis())},li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},li.prototype.g=function(t){return this.seconds===t.seconds?Rr(this.nanoseconds,t.nanoseconds):Rr(this.seconds,t.seconds)},li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},li),ni=(fi.V=function(t){return new fi(t)},fi.min=function(){return new fi(new ei(0,0))},fi.prototype.h=function(t){return this.timestamp.g(t.timestamp)},fi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},fi.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},fi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},fi.prototype.v=function(){return this.timestamp},fi),be=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.D(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},hi.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},hi.prototype.k=function(){return this.segments[this.offset]},hi.prototype.O=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype.P=function(){return 0===this.length},hi.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},hi.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ri=(n(ci,Zr=be),ci.prototype.C=function(t,e,n){return new ci(t,e,n)},ci.prototype.B=function(){return this.L().join("/")},ci.prototype.toString=function(){return this.B()},ci.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ci(n)},ci.U=function(){return new ci([])},ci),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(n(ai,$r=be),ai.prototype.C=function(t,e,n){return new ai(t,e,n)},ai.K=function(t){return ii.test(t)},ai.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.K(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.B()},ai.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ai.j=function(){return new ai(["__name__"])},ai.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Er(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Er(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Er(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.U=function(){return new ai([])},ai),si=(ui.H=function(t){return new ui(ri.q(t))},ui.J=function(t){return new ui(ri.q(t).N(5))},ui.prototype.Y=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.D(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.D=function(t,e){return ri.D(t.path,e.path)},ui.X=function(t){return t.length%2==0},ui.Z=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==$r&&$r.apply(this,arguments)||this}function ci(){return null!==Zr&&Zr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Or(),void 0===n?n=t.length-e:n>t.length-e&&Or(),this.segments=t,this.offset=e,this.S=n}function fi(t){this.timestamp=t}function li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t,e){this.m=t,this.A=e,this.R={}}function di(t){return null==t}function yi(t){return 0===t&&1/t==-1/0}function vi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.B()+t.op.toString()+wo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.B()+t.dir}).join(","),di(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Qu(e.startAt)),e.endAt&&(t+="|ub:",t+=Qu(e.endAt)),e.tt=t),e.tt}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!yo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$u(t.startAt,e.startAt)&&$u(t.endAt,e.endAt)}function Ii(t){return si.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ei(t){this.count=t}var _i,Ti=(Ai.prototype.st=function(t){return new Ai(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.it=function(t,e){return new Ai(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.rt=function(t){return new Ai(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=Mr.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case Ir.OK:return Or(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Or(),0}}function Si(t){if(void 0===t)return Sr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case _i.OK:return Ir.OK;case _i.CANCELLED:return Ir.CANCELLED;case _i.UNKNOWN:return Ir.UNKNOWN;case _i.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case _i.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case _i.INTERNAL:return Ir.INTERNAL;case _i.UNAVAILABLE:return Ir.UNAVAILABLE;case _i.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case _i.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case _i.NOT_FOUND:return Ir.NOT_FOUND;case _i.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case _i.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case _i.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case _i.ABORTED:return Ir.ABORTED;case _i.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case _i.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case _i.DATA_LOSS:return Ir.DATA_LOSS;default:return Or()}}(Ie=_i=_i||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var Di=(Li.prototype.ot=function(t,e){return new Li(this.D,this.root.ot(t,e,this.D).copy(null,null,Oi.at,null,null))},Li.prototype.remove=function(t){return new Li(this.D,this.root.remove(t,this.D).copy(null,null,Oi.at,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype.P=function(){return this.root.P()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.ht=function(){return this.root.ht()},Li.prototype.ct=function(){return this.root.ct()},Li.prototype.ut=function(t){return this.root.ut(t)},Li.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.lt=function(t){return this.root.lt(t)},Li.prototype._t=function(){return new xi(this.root,null,this.D,!1)},Li.prototype.ft=function(t){return new xi(this.root,t,this.D,!1)},Li.prototype.dt=function(){return new xi(this.root,null,this.D,!0)},Li.prototype.wt=function(t){return new xi(this.root,t,this.D,!0)},Li),xi=(Pi.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Pi.prototype.At=function(){return 0<this.Tt.length},Pi.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Pi),Oi=(ki.prototype.copy=function(t,e,n,r,i){return new ki(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},ki.prototype.P=function(){return!1},ki.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},ki.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},ki.prototype.min=function(){return this.left.P()?this:this.left.min()},ki.prototype.ht=function(){return this.min().key},ki.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},ki.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},ki.prototype.gt=function(){if(this.left.P())return ki.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},ki.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.bt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return ki.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},ki.prototype.Vt=function(){return this.color},ki.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},ki.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},ki.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},ki.prototype.St=function(){var t=this.copy(null,null,ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},ki.prototype.bt=function(){var t=this.copy(null,null,ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},ki.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},ki.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},ki.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw Or();if(this.right.Vt())throw Or();var t=this.left.Nt();if(t!==this.right.Nt())throw Or();return t+(this.Vt()?0:1)},ki);function ki(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ki.RED,this.left=null!=r?r:ki.EMPTY,this.right=null!=i?i:ki.EMPTY,this.size=this.left.size+1+this.right.size}function Pi(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Li(t,e){this.D=t,this.root=e||Oi.EMPTY}function Ri(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.at=!1,Oi.EMPTY=(Object.defineProperty(Ri.prototype,"key",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"value",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"color",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"left",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"right",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Ri.prototype.copy=function(t,e,n,r,i){return this},Ri.prototype.ot=function(t,e,n){return new Oi(t,e)},Ri.prototype.remove=function(t,e){return this},Ri.prototype.P=function(){return!0},Ri.prototype.ut=function(t){return!1},Ri.prototype.lt=function(t){return!1},Ri.prototype.ht=function(){return null},Ri.prototype.ct=function(){return null},Ri.prototype.Vt=function(){return!1},Ri.prototype.Ct=function(){return!0},Ri.prototype.Nt=function(){return 0},new Ri);var Vi=(ji.prototype.has=function(t){return null!==this.data.get(t)},ji.prototype.first=function(){return this.data.ht()},ji.prototype.last=function(){return this.data.ct()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ji.prototype.indexOf=function(t){return this.data.indexOf(t)},ji.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},ji.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},ji.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},ji.prototype.kt=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},ji.prototype._t=function(){return new Ci(this.data._t())},ji.prototype.ft=function(t){return new Ci(this.data.ft(t))},ji.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ji.prototype.P=function(){return this.data.P()},ji.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ji.prototype.isEqual=function(t){if(!(t instanceof ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},ji.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ji.prototype.copy=function(t){var e=new ji(this.D);return e.data=t,e},ji),Ci=(Ui.prototype.It=function(){return this.Mt.It().key},Ui.prototype.At=function(){return this.Mt.At()},Ui),Mi=new Di(si.D);function Ui(t){this.Mt=t}function ji(t){this.D=t,this.data=new Di(this.D)}var qi=new Di(si.D),Fi=new Di(si.D),Gi=new Vi(si.D);function Bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var zi=new Vi(Rr),Hi=(uo.Bt=function(t){return new uo(t.D)},uo.prototype.has=function(t){return null!=this.$t.get(t)},uo.prototype.get=function(t){return this.$t.get(t)},uo.prototype.first=function(){return this.Lt.ht()},uo.prototype.last=function(){return this.Lt.ct()},uo.prototype.P=function(){return this.Lt.P()},uo.prototype.indexOf=function(t){return(t=this.$t.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.Lt.ut(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.D=this.D,n.$t=t,n.Lt=e,n},uo),Ki=(so.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Or()},so.prototype.Ut=function(){var n=[];return this.qt.ut(function(t,e){n.push(e)}),n},so),Wi=(oo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new oo(t,e,Hi.Bt(e),i,n,r,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&wu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},oo),Xi=(io.Xt=function(t,e){var n=new Map;return n.set(t,Yi.Zt(t,e)),new io(ni.min(),n,zi,Mi,Bi())},io),Yi=(ro.Zt=function(t,e){return new ro(Mr.u,e,Bi(),Bi(),Bi())},ro),Qi=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Ji=function(t,e){this.targetId=t,this.oe=e},$i=function(t,e,n,r){void 0===n&&(n=Mr.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Zi=(Object.defineProperty(no.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),no.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ce=t)},no.prototype.we=function(){var n=Bi(),r=Bi(),i=Bi();return this.he.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Or()}}),new Yi(this.ce,this.ue,n,r,i)},no.prototype.Ee=function(){this.le=!1,this.he=co()},no.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},no.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},no.prototype.me=function(){this.ae+=1},no.prototype.Ae=function(){--this.ae},no.prototype.Re=function(){this.le=!0,this.ue=!0},no),to=(eo.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof tu?this.ve(r,t.re):t.re instanceof eu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},eo.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:Or()}})},eo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},eo.prototype.ke=function(t){var e=t.targetId,n=t.oe.count;(t=this.Oe(e))&&(Ii(t=t.target)?0===n?(t=new si(t.path),this.Se(e,t,new eu(t,ni.min()))):kr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},eo.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.Oe(e);n&&(t.te&&Ii(n.target)&&(n=new si(n.target.path),null!==i.Ve.get(n)||i.Le(e,n)||i.Se(e,n,new eu(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Bi();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.Oe(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Xi(r,o,this.pe,this.Ve,s);return this.Ve=Mi,this.ye=ao(),this.pe=new Vi(Rr),t},eo.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t)))},eo.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n)))},eo.prototype.removeTarget=function(t){this.ge.delete(t)},eo.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},eo.prototype.me=function(t){this.Ne(t).me()},eo.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new Zi,this.ge.set(t,e)),e},eo.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Vi(Rr),this.ye=this.ye.ot(t,e)),e},eo.prototype.xe=function(t){var e=null!==this.Oe(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},eo.prototype.Fe=function(e){var n=this;this.ge.set(e,new Zi),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},eo.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},eo);function eo(t){this.Pe=t,this.ge=new Map,this.Ve=Mi,this.ye=ao(),this.pe=new Vi(Rr)}function no(){this.ae=0,this.he=co(),this.ce=Mr.u,this.ue=!1,this.le=!0}function ro(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function io(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}function oo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function so(){this.qt=new Di(si.D)}function uo(n){this.D=n?function(t,e){return n(t,e)||si.D(t.key,e.key)}:function(t,e){return si.D(t.key,e.key)},this.$t=qi,this.Lt=new Di(this.D)}function ao(){return new Di(si.D)}function co(){return new Di(si.D)}function ho(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function fo(t){return t=bo(t.mapValue.fields.__local_write_time__.timestampValue),new ei(t.seconds,t.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Or()}function yo(r,i){var t,e,n,o=po(r);if(o!==po(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return fo(r).isEqual(fo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=bo(r.timestampValue),t=bo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Eo(r.bytesValue).isEqual(Eo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Io((t=r).geoPointValue.latitude)===Io(o.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?Io(e.integerValue)===Io(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=Io(e.doubleValue))===(n=Io(n.doubleValue))?yi(e)===yi(n):isNaN(e)&&isNaN(n));case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],yo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Yr(e)!==Yr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!yo(e[t],n[t])))return!1;return!0}();default:return Or()}}function vo(t,e){return void 0!==(t.values||[]).find(function(t){return yo(t,e)})}function go(t,e){var n,r,i,o,s=po(t),u=po(e);if(s!==u)return Rr(s,u);switch(s){case 0:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Io(t.integerValue||t.doubleValue))<(n=Io(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return mo(t.timestampValue,e.timestampValue);case 4:return mo(fo(t),fo(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Eo(i),o=Eo(o),i.h(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Rr(n[i],r[i]);if(0!==o)return o}return Rr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=Rr(Io(s.latitude),Io(r.latitude)))?n:Rr(Io(s.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=go(n[i],r[i]);if(o)return o}return Rr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Rr(r[s],o[s]);if(0!==u)return u;if(0!==(u=go(n[r[s]],i[o[s]])))return u}return Rr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Or()}}function mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Rr(t,e);var n=bo(t),t=bo(e);return 0!==(e=Rr(n.seconds,t.seconds))?e:Rr(n.nanos,t.nanos)}function wo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=bo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Eo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,si.J(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Or();var t,e}(t)}function bo(t){if(kr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=lo.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?Mr.fromBase64String(t):Mr.fromUint8Array(t)}function _o(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function To(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var xo={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ko=function(t,e){this._=t,this.Ke=e};function Po(t){return{integerValue:""+t}}function Lo(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function Ro(t,e){return vi(e)?Po(e):Lo(t,e)}function Vo(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Co(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Mo(t){return kr(!!t),ni.V((t=bo(t),new ei(t.seconds,t.nanos)))}function Uo(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function jo(t){return kr(ns(t=ri.q(t))),t}function qo(t,e){return Uo(t._,e.path)}function Fo(t,e){return kr((e=jo(e)).get(1)===t._.projectId),kr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new si(Ho(e))}function Go(t,e){return Uo(t._,e)}function Bo(t){return 4===(t=jo(t)).length?ri.U():Ho(t)}function zo(t){return new ri(["projects",t._.projectId,"databases",t._.database]).B()}function Ho(t){return kr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Ko(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function Wo(t,e){var n,r,i;if(e instanceof Ps)n={update:Ko(t,e.key,e.value)};else if(e instanceof Bs)n={delete:qo(t,e.key)};else if(e instanceof Ls)n={update:Ko(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Us)n={transform:{document:qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ss)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof us)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof ls)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof vs)return{fieldPath:t.field.B(),increment:e.We};throw Or()})}};else{if(!(e instanceof zs))return Or();n={verify:qo(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:Vo(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:Or()),n}function Xo(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Ts.updateTime(Mo(i.updateTime)):void 0!==i.exists?Ts.exists(i.exists):Ts.ze():Ts.ze();if(t.update){t.update.name;var n=Fo(o,t.update.name),r=new Hs({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new bs(i.map(function(t){return oi.G(t)})));return new Ls(n,r,i,e)}return new Ps(n,r,e)}if(t.delete){var s=Fo(o,t.delete);return new Bs(s,e)}return t.transform?(r=Fo(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(kr("REQUEST_TIME"===n.setToServerValue),i=new ss):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new us(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new ls(r)):"increment"in n?i=new vs(e,n.increment):Or(),n=oi.G(n.fieldPath),new Is(n,i);var e,n,r,i}),kr(!0===e.exists),new Us(r,s)):t.verify?(t=Fo(o,t.verify),new zs(t,e)):Or()}function Yo(t,e){return{documents:[Go(t,e.path)]}}function Qo(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Go(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NAN"}};if(No(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((t=t).field),direction:(t=t.dir,xo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ke||di(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}function Jo(t){var e=Bo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return Au.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return Au.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=es(t.unaryFilter.field),Au.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=es(t.unaryFilter.field),Au.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Or()}}(e)]:void 0!==e.fieldFilter?[(n=e,Au.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Or()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Or():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Zu(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=di(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Zo(n.startAt));var u=null;return n.endAt&&(u=Zo(n.endAt)),yu(uu(e,i,t,o,r,"F",s,u))}function $o(t){return{before:t.before,values:t.position}}function Zo(t){var e=!!t.before,t=t.values||[];return new Hu(t,e)}function ts(t){return{fieldPath:t.B()}}function es(t){return oi.G(t.fieldPath)}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function rs(t,e){return t instanceof vs?To(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var is,os,ss=(n(cs,os=h=function(){this.He=void 0}),cs),us=(n(as,is=h),as);function as(t){var e=this;return(e=is.call(this)||this).elements=t,e}function cs(){return null!==os&&os.apply(this,arguments)||this}function hs(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return yo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var fs,ls=(n(ps,fs=h),ps);function ps(t){var e=this;return(e=fs.call(this)||this).elements=t,e}function ds(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!yo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ys,vs=(n(gs,ys=h),gs);function gs(t,e){var n=this;return(n=ys.call(this)||this).serializer=t,n.We=e,n}function ms(t){return Io(t.integerValue||t.doubleValue)}function ws(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var bs=(Es.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},Es.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Es),Is=function(t,e){this.field=t,this.transform=e};function Es(t){(this.fields=t).sort(oi.D)}function _s(t,e){this.version=t,this.transformResults=e}var Ts=(As.ze=function(){return new As},As.exists=function(t){return new As(void 0,t)},As.updateTime=function(t){return new As(t)},Object.defineProperty(As.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),As.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},As);function As(t,e){this.updateTime=t,this.exists=e}function Ns(t,e){return void 0!==t.updateTime?e instanceof tu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof tu}function Ss(t,e,n,r){return t instanceof Ps?(o=e,Ns((i=t).Ge,o)?(o=xs(o),new tu(i.key,o,i.value,{Ye:!0})):o):t instanceof Ls?function(t,e){if(!Ns(t.Ge,e))return e;var n=xs(e),e=Cs(t,e);return new tu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Us?function(t,e,n,r){if(!Ns(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof tu&&(h=n.field(a.field)),null===h&&r instanceof tu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof ss?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof us?hs(c,i):c instanceof ls?ds(c,i):(i=ms(c=rs(h=c,i))+ms(h.We),To(c)&&To(h.We)?Po(i):Lo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=qs(t,i.data(),r);return new tu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Ns((t=t).Ge,e)?new eu(t.key,ni.min()):e);var i,o}function Ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof us&&e instanceof us||t instanceof ls&&e instanceof ls?Vr(t.elements,e.elements,yo):t instanceof vs&&e instanceof vs?yo(t.We,e.We):t instanceof ss&&e instanceof ss)}))}function xs(t){return t instanceof tu?t.version:ni.min()}var Os,ks,Ps=(n(Vs,ks=be=function(){}),Vs),Ls=(n(Rs,Os=be),Rs);function Rs(t,e,n,r){var i=this;return(i=Os.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Vs(t,e,n){var r=this;return(r=ks.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Cs(t,e){return n=t,e=e instanceof tu?e.data():Hs.empty(),r=new Ks(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Ms,Us=(n(js,Ms=be),js);function js(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ts.exists(!0),n}function qs(t,e,n){for(var r=new Ks(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Fs,Gs,Bs=(n(Qs,Gs=be),Qs),zs=(n(Ys,Fs=be),Ys),Hs=(Xs.empty=function(){return new Xs({mapValue:{}})},Xs.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Xs.prototype.isEqual=function(t){return yo(this.proto,t.proto)},Xs),Ks=(Ws.prototype.set=function(t,e){return this.en(t,e),this},Ws.prototype.delete=function(t){return this.en(t,null),this},Ws.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},Ws.prototype.Xe=function(){var t=this.nn(oi.U(),this.tn);return null!=t?new Hs(t):this.Ze},Ws.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ws);function Ws(t){void 0===t&&(t=Hs.empty()),this.Ze=t,this.tn=new Map}function Xs(t){this.proto=t}function Ys(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function Qs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var Js,$s,Zs,tu=(n(su,Zs=Ie=function(t,e){this.key=t,this.version=e}),su.prototype.field=function(t){return this.sn.field(t)},su.prototype.data=function(){return this.sn},su.prototype.rn=function(){return this.sn.proto},su.prototype.isEqual=function(t){return t instanceof su&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},su.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),su),eu=(n(ou,$s=Ie),ou.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ou.prototype.isEqual=function(t){return t instanceof ou&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ou),nu=(n(iu,Js=Ie),iu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),iu.prototype.isEqual=function(t){return t instanceof iu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},iu),ru=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.hn=null,this.cn=null,this.startAt,this.endAt};function iu(){return null!==Js&&Js.apply(this,arguments)||this}function ou(t,e,n){var r=this;return(r=$s.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function su(t,e,n,r){var i=this;return(i=Zs.call(this,t,e)||this).sn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function uu(t,e,n,r,i,o,s,u){return new ru(t,e,n,r,i,o,s,u)}function au(t){return new ru(t)}function cu(t){return!di(t.limit)&&"F"===t.an}function hu(t){return!di(t.limit)&&"L"===t.an}function fu(t){return 0<t.on.length?t.on[0].field:null}function lu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function pu(t){return null!==t.collectionGroup}function du(t){var e=t;if(null===e.hn){e.hn=[];var n=lu(e),t=fu(e);if(null!==n&&null===t)n.W()||e.hn.push(new Zu(n)),e.hn.push(new Zu(oi.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.hn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.hn.push(new Zu(oi.j(),n)))}}return e.hn}function yu(t){var e=t;if(!e.cn)if("F"===e.an)e.cn=mi(e.path,e.collectionGroup,du(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=du(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Zu(o.field,s))}var u=e.endAt?new Hu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Hu(e.startAt.position,!e.startAt.before):null;e.cn=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function vu(t,e,n){return new ru(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gu(t,e){return new ru(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function mu(t,e){return new ru(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function wu(t,e){return bi(yu(t),yu(e))&&t.an===e.an}function bu(t){return wi(yu(t))+"|lt:"+t.an}function Iu(t){return"Query(target="+(n=(e=yu(t)).path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.B()+" "+t.op+" "+wo(t.value)}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Qu(e.startAt)),e.endAt&&(n+=", endAt: "+Qu(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Eu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Y(e.collectionGroup)&&e.path.M(n):si.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Ju(t.startAt,du(t),n))&&(!t.endAt||!Ju(t.endAt,du(t),n)));var e,n}function _u(u){return function(t,e){for(var n=!1,r=0,i=du(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.W()?si.D(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?go(o,r):Or()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Or()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Tu,Au=(n(Nu,Tu=function(){}),Nu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Ou(t,e,n):"array-contains"===e?new Fu(t,n):"in"===e?new Gu(t,n):"not-in"===e?new Bu(t,n):"array-contains-any"===e?new zu(t,n):new Nu(t,e,n)},Nu.ln=function(t,e,n){return new("in"===e?ku:Pu)(t,n)},Nu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(go(t,this.value)):null!==t&&po(this.value)===po(t)&&this._n(go(t,this.value))},Nu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Or()}},Nu.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Nu);function Nu(t,e,n){var r=this;return(r=Tu.call(this)||this).field=t,r.op=e,r.value=n,r}var Su,Du,xu,Ou=(n(Vu,xu=Au),Vu.prototype.matches=function(t){return t=si.D(t.key,this.key),this._n(t)},Vu),ku=(n(Ru,Du=Au),Ru.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ru),Pu=(n(Lu,Su=Au),Lu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Lu);function Lu(t,e){var n=this;return(n=Su.call(this,t,"not-in",e)||this).keys=Cu(0,e),n}function Ru(t,e){var n=this;return(n=Du.call(this,t,"in",e)||this).keys=Cu(0,e),n}function Vu(t,e,n){var r=this;return(r=xu.call(this,t,e,n)||this).key=si.J(n.referenceValue),r}function Cu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return si.J(t.referenceValue)})}var Mu,Uu,ju,qu,Fu=(n(Yu,qu=Au),Yu.prototype.matches=function(t){return Ao(t=t.field(this.field))&&vo(t.arrayValue,this.value)},Yu),Gu=(n(Xu,ju=Au),Xu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&vo(this.value.arrayValue,t)},Xu),Bu=(n(Wu,Uu=Au),Wu.prototype.matches=function(t){return!vo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!vo(this.value.arrayValue,t))},Wu),zu=(n(Ku,Mu=Au),Ku.prototype.matches=function(t){var e=this;return!(!Ao(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return vo(e.value.arrayValue,t)})},Ku),Hu=function(t,e){this.position=t,this.before=e};function Ku(t,e){return Mu.call(this,t,"array-contains-any",e)||this}function Wu(t,e){return Uu.call(this,t,"not-in",e)||this}function Xu(t,e){return ju.call(this,t,"in",e)||this}function Yu(t,e){return qu.call(this,t,"array-contains",e)||this}function Qu(t){return(t.before?"b":"a")+":"+t.position.map(wo).join(",")}function Ju(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?si.D(si.J(s.referenceValue),n.key):go(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function $u(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yo(t.position[n],e.position[n]))return!1;return!0}var Zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ta(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ea,na=(fa.prototype.reset=function(){this.In=0},fa.prototype.Rn=function(){this.In=this.Tn},fa.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},fa.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},fa.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},fa.prototype.gn=function(){return(Math.random()-.5)*this.In},fa),ra=(ha.prototype.catch=function(t){return this.next(void 0,t)},ha.prototype.next=function(r,i){var o=this;return this.Dn&&Or(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new ha(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},ha.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ha.prototype.Fn=function(t){try{var e=t();return e instanceof ha?e:ha.resolve(e)}catch(t){return ha.reject(t)}},ha.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):ha.resolve(e)},ha.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):ha.reject(e)},ha.resolve=function(n){return new ha(function(t,e){t(n)})},ha.reject=function(n){return new ha(function(t,e){e(n)})},ha.kn=function(t){return new ha(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ha.On=function(t){for(var n=ha.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ha.resolve(t):e()})}(r[e]);return n},ha.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.kn(i)},ha),ia=(ca.delete=function(t){return Nr("SimpleDb","Removing database:",t),ga(window.indexedDB.deleteDatabase(t)).xn()},ca.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(ca.Bn())return!0;var t=p(),e=0<(n=ca.$n(t))&&n<10,n=0<(n=ca.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ca.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},ca.Kn=function(t,e){return t.store(e)},ca.$n=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ca.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ca.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Nr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new sa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Er(Ir.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new sa(o,t))},r.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Nr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},ca.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ca.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=pa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ra.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Nr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ca.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ca),oa=(Object.defineProperty(aa.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(aa.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(aa.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),aa.prototype.done=function(){this.Hn=!0},aa.prototype.Xn=function(t){this.Jn=t},aa.prototype.delete=function(){return ga(this.zn.delete())},aa),sa=(n(ua,ea=Er),ua);function ua(t,e){var n=this;return(n=ea.call(this,Ir.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function aa(t){this.zn=t,this.Hn=!1,this.Jn=null}function ca(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===ca.$n(p())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ha(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function fa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function la(t){return"IndexedDbTransactionError"===t.name}var pa=(va.open=function(t,e,n,r){try{return new va(e,t.transaction(r,n))}catch(t){throw new sa(e,t)}},Object.defineProperty(va.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),va.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},va.prototype.store=function(t){return t=this.transaction.objectStore(t),new da(t)},va),da=(ya.prototype.put=function(t,e){return ga(t=void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ya.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),ga(this.store.add(t))},ya.prototype.get=function(e){var n=this;return ga(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Nr("SimpleDb","GET",n.store.name,e,t),t})},ya.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),ga(this.store.delete(t))},ya.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),ga(this.store.count())},ya.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},ya.prototype.ns=function(t,e){return Nr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},ya.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},ya.prototype.os=function(r){var t=this.cursor({});return new ra(function(n,e){t.onerror=function(t){t=wa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ya.prototype.es=function(t,i){var o=[];return new ra(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new oa(n),(t=i(n.primaryKey,n.value,e))instanceof ra&&(t=t.catch(function(t){return e.done(),ra.reject(t)}),o.push(t)),e.Sn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return ra.kn(o)})},ya.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ya.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ya);function ya(t){this.store=t}function va(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ta,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new sa(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=wa(t.target.error),n.Zn.reject(new sa(e,t))}}function ga(t){return new ra(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=wa(t.target.error),n(t)}})}var ma=!1;function wa(t){var e=ia.$n(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Er("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ma||(ma=!0,setTimeout(function(){throw n},0)),n}return t}function ba(){return"undefined"!=typeof window?window:null}function Ia(){return"undefined"!=typeof document?document:null}var Ea=(Aa._s=function(t,e,n,r,i){return(i=new Aa(t,e,Date.now()+n,r,i)).start(n),i},Aa.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Aa.prototype.pn=function(){return this.ds()},Aa.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Er(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Aa.prototype.ds=function(){var e=this;this.hs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Aa.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},Aa),_a=(Object.defineProperty(Ta.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Ta.prototype.ws=function(t){this.enqueue(t)},Ta.prototype.bs=function(t){this.vs(),this.Ss(t)},Ta.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=Ia())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Ta.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Ta.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Ta.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.Vs.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Ta.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Ta.prototype.Vn=function(t,e,n){var r=this;return this.vs(),-1<this.gs.indexOf(t)&&(e=0),n=Ea._s(this,t,e,n,function(t){return r.xs(t)}),this.As.push(n),n},Ta.prototype.vs=function(){this.Rs&&Or()},Ta.prototype.Fs=function(){},Ta.prototype.ks=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Ta.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Ta.prototype.Ms=function(r){var i=this;return this.ks().then(function(){i.As.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.ks()})},Ta.prototype.$s=function(t){this.gs.push(t)},Ta.prototype.xs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},Ta);function Ta(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new na(this,"async_queue_retry"),this.ys=function(){var t=Ia();t&&Nr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Vs.yn()};var t=Ia();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Aa(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new ta,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Na(t,e){if(Sr("AsyncQueue",e+": "+t),la(t))return new Er(Ir.UNAVAILABLE,e+": "+t);throw t}function Sa(){this.Ls=void 0,this.listeners=[]}function Da(){this.Bs=new ti(bu,wu),this.onlineState="Unknown",this.qs=new Set}function xa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Sa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Na(o=t.sent(),"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&ka(e),[2]}})})}function Oa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function ka(t){t.qs.forEach(function(t){t.next()})}var Pa=(Va.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Wi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},Va.prototype.onError=function(t){this.js.error(t)},Va.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},Va.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},Va.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Va.prototype.Ys=function(t){t=Wi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},Va),La=(Ra.prototype.Zs=function(){return null!=this.uid},Ra.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Ra.prototype.isEqual=function(t){return t.uid===this.uid},Ra);function Ra(t){this.uid=t}function Va(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}La.UNAUTHENTICATED=new La(null),La.ei=new La("google-credentials-uid"),La.ni=new La("first-party-uid");var Ca=(Ma.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ma.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},Ma);function Ma(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function Ua(t,e){return"firestore_clients_"+t+"_"+e}function ja(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function qa(t,e){return"firestore_targets_"+t+"_"+e}Ca.ai=-1;var Fa=(fc.hi=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Er(r.error.code,r.error.message)),i?new fc(t,e,r.state,o):(Sr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},fc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},fc),Ga=(hc.hi=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Er(n.error.code,n.error.message)),r?new hc(t,n.state,i):(Sr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},hc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},hc),Ba=(cc.hi=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=zi,o=0;r&&o<n.activeTargetIds.length;++o)r=vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new cc(t,i):(Sr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},cc),za=(ac.hi=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new ac(e.clientId,e.onlineState):(Sr("SharedClientState","Failed to parse online state: "+t),null)},ac),Ha=(uc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},uc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},uc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},uc),Ka=(sc.Ln=function(t){return!(!t||!t.localStorage)},sc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(Ua(this.persistenceKey,r)))&&(o=Ba.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.yi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.Ei(h);return this.mi=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ii=!0,[2]}})})},sc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},sc.prototype.Ci=function(){return this.Ni(this.Ti)},sc.prototype.xi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},sc.prototype.Fi=function(t){this.ki(t,"pending")},sc.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},sc.prototype.$i=function(t){var e,n="not-current";return this.xi(t)&&(!(e=this.storage.getItem(qa(this.persistenceKey,t)))||(e=Ga.hi(t,e))&&(n=e.state)),this.Li.ui(t),this.bi(),n},sc.prototype.Bi=function(t){this.Li.li(t),this.bi()},sc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},sc.prototype.Ui=function(t){this.removeItem(qa(this.persistenceKey,t))},sc.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},sc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},sc.prototype.ji=function(t){this.Gi(t)},sc.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},sc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},sc.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},sc.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},sc.prototype.Ei=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Nr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ii){if(null!==s.key)if(this.Pi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Ji(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(s.key)){if(null!==s.newValue&&(n=this.Yi(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.Vi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.yi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=Ca.ai;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Sr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==Ca.ai&&this.si(o)}else this.mi.push(s);return[2]})})})}},Object.defineProperty(sc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),sc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},sc.prototype.ki=function(t,e,n){n=new Fa(this.currentUser,t,e,n),t=ja(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ci())},sc.prototype.Mi=function(t){t=ja(this.persistenceKey,this.currentUser,t),this.removeItem(t)},sc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t},this.storage.setItem(this.yi,JSON.stringify(t))},sc.prototype.Qi=function(t,e,n){var r=qa(this.persistenceKey,t),n=new Ga(t,e,n);this.setItem(r,n.ci())},sc.prototype.zi=function(t){return(t=this.Pi.exec(t))?t[1]:null},sc.prototype.Ji=function(t,e){return t=this.zi(t),Ba.hi(t,e)},sc.prototype.Yi=function(t,e){var n=this.gi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Fa.hi(new La(n),t,e)},sc.prototype.Zi=function(t,e){return t=this.Vi.exec(t),t=Number(t[1]),Ga.hi(t,e)},sc.prototype.vi=function(t){return za.hi(t)},sc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},sc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},sc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},sc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},sc.prototype.Ni=function(t){var n=zi;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},sc),Wa=(oc.prototype.Fi=function(t){},oc.prototype.Oi=function(t,e,n){},oc.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},oc.prototype.Ki=function(t,e,n){this.rr[t]=e},oc.prototype.Bi=function(t){this.ir.li(t)},oc.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},oc.prototype.Ui=function(t){delete this.rr[t]},oc.prototype.Ci=function(){return this.ir.activeTargetIds},oc.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},oc.prototype.start=function(){return this.ir=new Ha,Promise.resolve()},oc.prototype.Wi=function(t,e,n){},oc.prototype.ji=function(t){},oc.prototype.Di=function(){},oc.prototype.oi=function(t){},oc),Xa=(ic.prototype.hr=function(t,e,n){for(var r,i,o,s,u,a,c=n.cr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],a=u=s=void 0,e=r instanceof Ps?new tu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ls?(u=i,a=o,Ns((s=r).Ge,u)?(u=Cs(s,u),new tu(s.key,a.version,u,{hasCommittedMutations:!0})):new nu(s.key,a.version)):r instanceof Us?function(t,e,n){if(kr(null!=n.transformResults),!Ns(t.Ge,e))return new nu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof tu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof us?hs(o,s):o instanceof ls?ds(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=qs(t,r.data(),e);return new tu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new eu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ic.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ss(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ss(a,e,o,this.ar))}return e},ic.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},ic.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Bi())},ic.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Ds)&&Vr(this.baseMutations,t.baseMutations,Ds)},ic),Ya=(rc.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=Fi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new rc(t,e,n,r)},rc),h=(Object.defineProperty(nc.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),nc.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},nc.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},nc.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?ra.resolve(n):this.Pr(t,e)},nc.prototype.getEntries=function(t,e){return this.gr(t,e)},nc.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},nc.prototype.mr=function(){},nc),Qa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",be=(ec.prototype.pr=function(t){this.yr.push(t)},ec.prototype.br=function(){this.yr.forEach(function(t){return t()})},ec),Ja=(tc.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},tc.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},tc.prototype.kr=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.ot(t,e)}),o},tc.prototype.Or=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},tc.prototype.Mr=function(e,r){var i=this;return this.Sr.$r(e,r).next(function(t){var t=i.kr(e,r,t),n=Mi;return t.forEach(function(t,e){e=e||new eu(t,ni.min()),n=n.ot(t,e)}),n})},tc.prototype.Lr=function(t,e,n){return r=e,si.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):pu(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},tc.prototype.Br=function(t,e){return this.Cr(t,new si(e)).next(function(t){var e=qi;return t instanceof tu&&(e=e.ot(t.key,t)),e})},tc.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=qi;return this.Dr.Kr(n,s).next(function(t){return ra.forEach(t,function(t){var e=(e=r,t=t.child(s),new ru(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},tc.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Qr(e,n)}).next(function(t){return h=t,r.Wr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Ss(s,a=c.get(u),a,r.ar);c=a instanceof tu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Eu(n,e)||(c=c.remove(t))}),c})},tc.prototype.Wr=function(t,e,n){for(var r=Bi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ls&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof tu&&(c=c.ot(t,e))}),c})},tc),$a=(Za.zr=function(t,e){for(var n=Bi(),r=Bi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Za(t,e.fromCache,n,r)},Za);function Za(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}function tc(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function ec(){this.yr=[]}function nc(){this.wr=new ti(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Er=!1}function rc(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}function ic(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function oc(){this.ir=new Ha,this.rr={},this.di=null,this.si=null}function sc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new Di(Rr),this.Ii=!1,this.mi=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ai=Ua(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new Ha),this.Pi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function uc(){this.activeTargetIds=zi}function ac(t,e){this.clientId=t,this.onlineState=e}function cc(t,e){this.clientId=t,this.activeTargetIds=e}function hc(t,e,n){this.targetId=t,this.state=e,this.error=n}function fc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function lc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Rr(n,t))?Rr(r,e):t}var pc=(gc.prototype.Yr=function(){return++this.Jr},gc.prototype.Xr=function(t){var e=[t,this.Yr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):lc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(gc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),gc),dc={Zr:!1,eo:0,no:0,so:0},yc=(vc.ao=function(t){return new vc(t,vc.ho,vc.co)},vc);function vc(t,e,n){this.io=t,this.ro=e,this.oo=n}function gc(t){this.Hr=t,this.buffer=new Vi(lc),this.Jr=0}yc.uo=-1,yc.lo=1048576,yc._o=41943040,yc.ho=10,yc.co=1e3,yc.fo=new yc(yc._o,yc.ho,yc.co),yc.do=new yc(yc.uo,0,0);var mc=(Ic.prototype.start=function(t){this.wo.params.io!==yc.uo&&this.Io(t)},Ic.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(Ic.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),Ic.prototype.Io=function(n){var t=this,e=this.Eo?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.hs.Vn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.Eo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mo(this.wo)];case 2:return t.sent(),[3,7];case 3:return la(e=t.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Yh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Io(n)];case 8:return t.sent(),[2]}})})})},Ic),wc=(bc.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},bc.prototype.Vo=function(t,e){var n=this;if(0===e)return ra.resolve(Ca.ai);var r=new pc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.yo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},bc.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},bc.prototype.bo=function(t,e){return this.Ao.bo(t,e)},bc.prototype.vo=function(e,n){var r=this;return this.params.io===yc.uo?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),ra.resolve(dc)):this.So(e).next(function(t){return t<r.params.io?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),dc):r.Do(e,n)})},bc.prototype.So=function(t){return this.Ao.So(t)},bc.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.Vo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Ar()<=l.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ra.resolve({Zr:!0,eo:i,no:o,so:t})})},bc);function bc(t,e){this.Ao=t,this.params=e}function Ic(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}function Ec(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=_c(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return _c(o)}function _c(t){return t+""}function Tc(t){var e=t.length;if(kr(2<=e),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),ri.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Or(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Or()}o=s+2}return new ri(r)}var Ac=function(t){this.Co=t};function Nc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=Fo(n,r.name),n=Mo(r.updateTime),r=new Hs({mapValue:{fields:r.fields}}),new tu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=si.Z(e.noDocument.path),o=kc(e.noDocument.readTime);return new eu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=si.Z(e.unknownDocument.path),e=kc(e.unknownDocument.version),new nu(o,e)):Or()}function Sc(t,e,n){var r=Dc(n),n=e.key.path.F().L();if(e instanceof tu){var i={name:qo(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Vo(i,o.version.v())},o=e.hasCommittedMutations;return new fh(null,null,i,o,r,n)}if(e instanceof eu){var i=e.key.path.L(),o=Oc(e.version),s=e.hasCommittedMutations;return new fh(null,new ch(i,o),null,s,r,n)}return e instanceof nu?(s=e.key.path.L(),e=Oc(e.version),new fh(new hh(s,e),null,null,!0,r,n)):Or()}function Dc(t){return[(t=t.v()).seconds,t.nanoseconds]}function xc(t){return t=new ei(t[0],t[1]),ni.V(t)}function Oc(t){return t=t.v(),new th(t.seconds,t.nanoseconds)}function kc(t){return t=new ei(t.seconds,t.nanoseconds),ni.V(t)}function Pc(e,t){var n=(t.baseMutations||[]).map(function(t){return Xo(e.Co,t)}),r=t.mutations.map(function(t){return Xo(e.Co,t)}),i=ei.fromMillis(t.localWriteTimeMs);return new Xa(t.batchId,i,n,r)}function Lc(t){var e=kc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?kc(t.lastLimboFreeSnapshotVersion):ni.min(),r=void 0!==t.query.documents?(kr(1===(r=t.query).documents.length),yu(au(Bo(r.documents[0])))):Jo(t.query);return new Ti(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Mr.fromBase64String(t.resumeToken))}function Rc(t,e){var n=Oc(e.nt),r=Oc(e.lastLimboFreeSnapshotVersion),i=(Ii(e.target)?Yo:Qo)(t.Co,e.target),t=e.resumeToken.toBase64();return new ph(e.targetId,wi(e.target),n,t,e.sequenceNumber,r,i)}var Vc=(Cc.Fo=function(t,e,n,r){return kr(""!==t.uid),new Cc(t.Zs()?t.uid:"",e,n,r)},Cc.prototype.ko=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).rs({index:sh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Cc.prototype.Oo=function(d,y,v,g){var m=this,w=qc(d),b=jc(d);return b.add({}).next(function(t){kr("number"==typeof t);for(var e,n,r,i,o,s=new Xa(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Wo(e.Co,t)}),o=r.mutations.map(function(t){return Wo(e.Co,t)}),new sh(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new Vi(function(t,e){return Rr(t.B(),e.B())}),h=0,f=g;h<f.length;h++){var l=f[h],p=uh.key(m.userId,l.key.path,t),c=c.add(l.key.path.F());a.push(b.put(u)),a.push(w.put(p,uh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.xo[t]=s.keys()}),ra.kn(a).next(function(){return s})})},Cc.prototype.$o=function(t,e){var n=this;return jc(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),Pc(n.serializer,t)):null})},Cc.prototype.Lo=function(t,e){var n=this;return this.xo[e]?ra.resolve(this.xo[e]):this.$o(t,e).next(function(t){return t?(t=t.keys(),n.xo[e]=t):null})},Cc.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return jc(t).rs({index:sh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(kr(e.batchId>=i),o=Pc(r.serializer,e)),n.done()}).next(function(){return o})},Cc.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return jc(t).rs({index:sh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Cc.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).ts(sh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Pc(e.serializer,t)})})},Cc.prototype.Nr=function(o,s){var u=this,t=uh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return qc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Tc(i);if(r===u.userId&&s.path.isEqual(i))return jc(o).get(t).next(function(t){if(!t)throw Or();kr(t.userId===u.userId),a.push(Pc(u.serializer,t))});n.done()}).next(function(){return a})},Cc.prototype.$r=function(e,t){var s=this,u=new Vi(Rr),n=[];return t.forEach(function(o){var t=uh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=qc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Tc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ra.kn(n).next(function(){return s.Ko(e,u)})},Cc.prototype.Qr=function(t,e){var o=this,s=e.path,u=s.length+1,e=uh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Vi(Rr);return qc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Tc(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ko(t,a)})},Cc.prototype.Ko=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(jc(e).get(t).next(function(t){if(null===t)throw Or();kr(t.userId===n.userId),r.push(Pc(n.serializer,t))}))}),ra.kn(i).next(function(){return r})},Cc.prototype.Qo=function(e,n){var r=this;return Uc(e.Wo,this.userId,n).next(function(t){return e.pr(function(){r.jo(n.batchId)}),ra.forEach(t,function(t){return r.No.Go(e,t)})})},Cc.prototype.jo=function(t){delete this.xo[t]},Cc.prototype.zo=function(e){var i=this;return this.ko(e).next(function(t){if(!t)return ra.resolve();var t=IDBKeyRange.lowerBound(uh.prefixForUser(i.userId)),r=[];return qc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Tc(t[1]),r.push(t)):n.done()}).next(function(){kr(0===r.length)})})},Cc.prototype.Ho=function(t,e){return Mc(t,this.userId,e)},Cc.prototype.Jo=function(t){var e=this;return Fc(t).get(this.userId).next(function(t){return t||new oh(e.userId,-1,"")})},Cc);function Cc(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}function Mc(t,o,e){var s=(e=uh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return qc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Uc(t,e,n){var r=t.store(sh.store),i=t.store(uh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){kr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=uh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ra.kn(o).next(function(){return u})}function jc(t){return Lh.Kn(t,sh.store)}function qc(t){return Lh.Kn(t,uh.store)}function Fc(t){return Lh.Kn(t,oh.store)}var Gc,Bc=(Kc.prototype.Ir=function(t,e,n){return Xc(t).put(Yc(e),n)},Kc.prototype.Ar=function(t,e){return t=Xc(t),e=Yc(e),t.delete(e)},Kc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Kc.prototype.Rr=function(t,e){var n=this;return Xc(t).get(Yc(e)).next(function(t){return n.Xo(t)})},Kc.prototype.Zo=function(t,e){var n=this;return Xc(t).get(Yc(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:Qc(t)}:null})},Kc.prototype.getEntries=function(t,e){var n=this,r=Mi;return this.ea(t,e,function(t,e){e=n.Xo(e),r=r.ot(t,e)}).next(function(){return r})},Kc.prototype.na=function(t,e){var r=this,i=Mi,o=new Di(si.D);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,Qc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},Kc.prototype.ea=function(t,e,i){if(e.P())return ra.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Xc(t).rs({range:n},function(t,e,n){for(var r=si.Z(t);s&&si.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Kc.prototype.Lr=function(t,r,e){var n,i=this,o=qi,s=r.path.length+1,u={};return e.isEqual(ni.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=Dc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=fh.collectionReadTimeIndex),Xc(t).rs(u,function(t,e,n){t.length===s&&(e=Nc(i.serializer,e),r.path.M(e.key.path)?e instanceof tu&&Eu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Kc.prototype.ra=function(t){return new zc(this,!!t&&t.oa)},Kc.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Kc.prototype.getMetadata=function(t){return Wc(t).get(lh.key).next(function(t){return kr(!!t),t})},Kc.prototype.Yo=function(t,e){return Wc(t).put(lh.key,e)},Kc.prototype.Xo=function(t){return!t||(t=Nc(this.serializer,t))instanceof eu&&t.version.isEqual(ni.min())?null:t},Kc),zc=(n(Hc,Gc=h),Hc.prototype.Vr=function(i){var o=this,s=[],u=0,a=new Vi(function(t,e){return Rr(t.B(),e.B())});return this.wr.forEach(function(t,e){var n,r=o.ca.get(t);e?(n=Sc(o.ha.serializer,e,o.readTime),a=a.add(t.path.F()),e=Qc(n),u+=e-r,s.push(o.ha.Ir(i,t,n))):(u-=r,o.oa?(r=Sc(o.ha.serializer,new eu(t,ni.min()),o.readTime),s.push(o.ha.Ir(i,t,r))):s.push(o.ha.Ar(i,t)))}),a.forEach(function(t){s.push(o.ha.Dr.Mo(i,t))}),s.push(this.ha.updateMetadata(i,u)),ra.kn(s)},Hc.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)})},Hc.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ca.set(t,e)}),e})},Hc);function Hc(t,e){var n=this;return(n=Gc.call(this)||this).ha=t,n.oa=e,n.ca=new ti(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Kc(t,e){this.serializer=t,this.Dr=e}function Wc(t){return Lh.Kn(t,lh.store)}function Xc(t){return Lh.Kn(t,fh.store)}function Yc(t){return t.path.L()}function Qc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Or();e=t.noDocument}return JSON.stringify(e).length}var Jc=(ih.prototype.Mo=function(t,e){return this.ua.add(e),ra.resolve()},ih.prototype.Kr=function(t,e){return ra.resolve(this.ua.getEntries(e))},ih),$c=(rh.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Vi(ri.D),t=!r.has(n);return this.index[e]=r.add(n),t},rh.prototype.has=function(t){var e=t.O(),t=t.F();return(e=this.index[e])&&e.has(t)},rh.prototype.getEntries=function(t){return(this.index[t]||new Vi(ri.D)).L()},rh),Zc=(nh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;kr(t<r&&0<=t&&r<=10);var o=new pa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(eh.store),(s=e).createObjectStore(oh.store,{keyPath:oh.keyPath}),s.createObjectStore(sh.store,{keyPath:sh.keyPath,autoIncrement:!0}).createIndex(sh.userMutationsIndex,sh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(uh.store),gh(e),e.createObjectStore(fh.store));var s,u=ra.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(dh.store),s.deleteObjectStore(ph.store),s.deleteObjectStore(yh.store),gh(e)),u=u.next(function(){return t=o.store(yh.store),e=new yh(0,0,ni.min().v(),0),t.put(yh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(sh.store).ts().next(function(t){n.deleteObjectStore(sh.store),n.createObjectStore(sh.store,{keyPath:sh.keyPath,autoIncrement:!0}).createIndex(sh.userMutationsIndex,sh.userMutationsKeyPath,{unique:!0});var e=r.store(sh.store),t=t.map(function(t){return e.put(t)});return ra.kn(t)});var n,r})),u=u.next(function(){e.createObjectStore(mh.store,{keyPath:mh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(lh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(fh.store)).createIndex(fh.readTimeIndex,fh.readTimeIndexPath,{unique:!1}),t.createIndex(fh.collectionReadTimeIndex,fh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},nh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(fh.store).rs(function(t,e){n+=Qc(e)}).next(function(){var t=new lh(n);return e.store(lh.store).put(lh.key,t)})},nh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(oh.store),i=n.store(sh.store);return t.ts().next(function(t){return ra.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(sh.userMutationsIndex,t).next(function(t){return ra.forEach(t,function(t){return kr(t.userId===e.userId),t=Pc(r.serializer,t),Uc(n,e.userId,t).next(function(){})})})})})},nh.prototype.ensureSequenceNumbers=function(t){var o=t.store(dh.store),e=t.store(fh.store);return t.store(yh.store).get(yh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new ri(t),t=[0,Ec(n)];i.push(o.get(t).next(function(t){return t?ra.resolve():o.put(new dh(0,Ec(n),r.highestListenSequenceNumber))}))}).next(function(){return ra.kn(i)})})},nh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.O(),t=t.F();return n.put({collectionId:e,parent:Ec(t)})}}t.createObjectStore(vh.store,{keyPath:vh.keyPath});var n=e.store(vh.store),i=new $c;return e.store(fh.store).rs({ss:!0},function(t,e){return r((t=new ri(t)).F())}).next(function(){return e.store(uh.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Tc(n))).F())})})},nh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(ph.store);return r.rs(function(t,e){return e=Lc(e),e=Rc(n.serializer,e),r.put(e)})},nh),th=function(t,e){this.seconds=t,this.nanoseconds=e},eh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function nh(t){this.serializer=t}function rh(){this.index={}}function ih(){this.ua=new $c}eh.store="owner",eh.key="owner";var oh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};oh.store="mutationQueues",oh.keyPath="userId";var sh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};sh.store="mutations",sh.keyPath="batchId",sh.userMutationsIndex="userMutationsIndex",sh.userMutationsKeyPath=["userId","batchId"];var uh=(ah.prefixForUser=function(t){return[t]},ah.prefixForPath=function(t,e){return[t,Ec(e)]},ah.key=function(t,e,n){return[t,Ec(e),n]},ah);function ah(){}uh.store="documentMutations",uh.PLACEHOLDER=new uh;var ch=function(t,e){this.path=t,this.readTime=e},hh=function(t,e){this.path=t,this.version=e},fh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};fh.store="remoteDocuments",fh.readTimeIndex="readTimeIndex",fh.readTimeIndexPath="readTime",fh.collectionReadTimeIndex="collectionReadTimeIndex",fh.collectionReadTimeIndexPath=["parentPath","readTime"];var lh=function(t){this.byteSize=t};lh.store="remoteDocumentGlobal",lh.key="remoteDocumentGlobalKey";var ph=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ph.store="targets",ph.keyPath="targetId",ph.queryTargetsIndexName="queryTargetsIndex",ph.queryTargetsKeyPath=["canonicalId","targetId"];var dh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};dh.store="targetDocuments",dh.keyPath=["targetId","path"],dh.documentTargetsIndex="documentTargetsIndex",dh.documentTargetsKeyPath=["path","targetId"];var yh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};yh.key="targetGlobalKey",yh.store="targetGlobal";var vh=function(t,e){this.collectionId=t,this.parent=e};function gh(t){t.createObjectStore(dh.store,{keyPath:dh.keyPath}).createIndex(dh.documentTargetsIndex,dh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ph.store,{keyPath:ph.keyPath}).createIndex(ph.queryTargetsIndexName,ph.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(yh.store)}vh.store="collectionParents",vh.keyPath=["collectionId","parent"];var mh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};mh.store="clientMetadata",mh.keyPath="clientId";var wh=i(i(i([oh.store,sh.store,uh.store,fh.store,ph.store,eh.store,yh.store,dh.store],[mh.store]),[lh.store]),[vh.store]),bh=(Ih.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return ra.resolve();var r=e.O(),i=e.F();return t.pr(function(){n.la.add(e)}),i={collectionId:r,parent:Ec(i)},Eh(t).put(i)},Ih.prototype.Kr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Cr(i),""],!1,!0);return Eh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Tc(r.parent))}return o})},Ih);function Ih(){this.la=new $c}function Eh(t){return Lh.Kn(t,vh.store)}var _h=(Nh.prototype.next=function(){return this._a+=2,this._a},Nh.fa=function(){return new Nh(0)},Nh.da=function(){return new Nh(-1)},Nh),Th=(Ah.prototype.wa=function(n){var r=this;return this.Ea(n).next(function(t){var e=new _h(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},Ah.prototype.Ia=function(t){return this.Ea(t).next(function(t){return ni.V(new ei(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ah.prototype.ma=function(t){return this.Ea(t).next(function(t){return t.highestListenSequenceNumber})},Ah.prototype.Aa=function(e,n,r){var i=this;return this.Ea(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},Ah.prototype.Ra=function(e,n){var r=this;return this.Pa(e,n).next(function(){return r.Ea(e).next(function(t){return t.targetCount+=1,r.ga(n,t),r.Ta(e,t)})})},Ah.prototype.Va=function(t,e){return this.Pa(t,e)},Ah.prototype.ya=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Sh(e).delete(t.targetId)}).next(function(){return n.Ea(e)}).next(function(t){return kr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},Ah.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Sh(n).rs(function(t,e){(e=Lc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ya(n,e)))}).next(function(){return ra.kn(u)}).next(function(){return s})},Ah.prototype.Ce=function(t,n){return Sh(t).rs(function(t,e){e=Lc(e),n(e)})},Ah.prototype.Ea=function(t){return Dh(t).get(yh.key).next(function(t){return kr(null!==t),t})},Ah.prototype.Ta=function(t,e){return Dh(t).put(yh.key,e)},Ah.prototype.Pa=function(t,e){return Sh(t).put(Rc(this.serializer,e))},Ah.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ah.prototype.ba=function(t){return this.Ea(t).next(function(t){return t.targetCount})},Ah.prototype.va=function(t,r){var e=wi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Sh(t).rs({range:e,index:ph.queryTargetsIndexName},function(t,e,n){e=Lc(e),bi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Ah.prototype.Sa=function(n,t,r){var i=this,o=[],s=xh(n);return t.forEach(function(t){var e=Ec(t.path);o.push(s.put(new dh(r,e))),o.push(i.No.Da(n,r,t))}),ra.kn(o)},Ah.prototype.Ca=function(n,t,r){var i=this,o=xh(n);return ra.forEach(t,function(t){var e=Ec(t.path);return ra.kn([o.delete([r,e]),i.No.Na(n,r,t)])})},Ah.prototype.pa=function(t,e){return t=xh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Ah.prototype.xa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=xh(t),r=Bi();return t.rs({range:e,ss:!0},function(t,e,n){t=Tc(t[1]),t=new si(t),r=r.add(t)}).next(function(){return r})},Ah.prototype.Ho=function(t,e){var e=Ec(e.path),e=IDBKeyRange.bound([e],[Cr(e)],!1,!0),i=0;return xh(t).rs({index:dh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ah.prototype.Ue=function(t,e){return Sh(t).get(e).next(function(t){return t?Lc(t):null})},Ah);function Ah(t,e){this.No=t,this.serializer=e}function Nh(t){this._a=t}function Sh(t){return Lh.Kn(t,ph.store)}function Dh(t){return Lh.Kn(t,yh.store)}function xh(t){return Lh.Kn(t,dh.store)}var Oh,kh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ph=(n(Vh,Oh=be),Vh),Lh=(Rh.Kn=function(t,e){if(t instanceof Ph)return ia.Kn(t.Wo,e);throw Or()},Rh.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Er(Ir.FAILED_PRECONDITION,kh);return e.Ha(),e.Ja(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.ma(t)})}).then(function(t){e.Ma=new Ca(t,e.ka)}).then(function(){e.$a=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},Rh.prototype.Xa=function(n){var t=this;return this.Ka=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ii?[2,n(e)]:[2]})})},n(this.isPrimary)},Rh.prototype.Za=function(n){var t=this;this.Wa.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Rh.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Rh.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Mh(e).put(new mh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.eh(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Ka(!1)}))})}).next(function(){return n.nh(e)}).next(function(t){return n.isPrimary&&!t?n.sh(e).next(function(){return!1}):!!t&&n.ih(e).next(function(){return!0})})}).catch(function(t){if(la(t))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Ka(t)}),n.isPrimary=t})},Rh.prototype.eh=function(t){var e=this;return Ch(t).get(eh.key).next(function(t){return ra.resolve(e.rh(t))})},Rh.prototype.oh=function(t){return Mh(t).delete(this.clientId)},Rh.prototype.ah=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Rh.Kn(t,mh.store);return r.ts().next(function(t){var e=o.uh(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ra.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.lh(i.clientId));t.label=2;case 2:return[2]}})})},Rh.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ah()}).then(function(){return t.Ya()})})},Rh.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},Rh.prototype.nh=function(e){var r=this;return this.Oa?ra.resolve(!0):Ch(e).get(eh.key).next(function(t){if(null!==t&&r.hh(t.leaseTimestampMs,5e3)&&!r._h(t.ownerId)){if(r.rh(t)&&r.networkEnabled)return!0;if(!r.rh(t)){if(!t.allowTabSynchronization)throw new Er(Ir.FAILED_PRECONDITION,kh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Mh(e).ts().next(function(t){return void 0===r.uh(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Rh.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[eh.store,mh.store],function(t){var e=new Ph(t,Ca.ai);return n.sh(e).next(function(){return n.oh(e)})})];case 1:return t.sent(),this.Wa.close(),this.Eh(),[2]}})})},Rh.prototype.uh=function(t,e){var n=this;return t.filter(function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)})},Rh.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Mh(t).ts().next(function(t){return e.uh(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Rh.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Rh.prototype.Th=function(t){return Vc.Fo(t,this.serializer,this.Dr,this.No)},Rh.prototype.Ih=function(){return this.ja},Rh.prototype.mh=function(){return this.vr},Rh.prototype.Ah=function(){return this.Dr},Rh.prototype.runTransaction=function(e,n,r){var i=this;Nr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,wh,function(t){return o=new Ph(t,i.Ma?i.Ma.next():Ca.ai),"readwrite-primary"===n?i.eh(o).next(function(t){return!!t||i.nh(o)}).next(function(t){if(!t)throw Sr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Ka(!1)}),new Er(Ir.FAILED_PRECONDITION,Qa);return r(o)}).next(function(t){return i.ih(o).next(function(){return t})}):i.Rh(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},Rh.prototype.Rh=function(t){var e=this;return Ch(t).get(eh.key).next(function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Er(Ir.FAILED_PRECONDITION,kh)})},Rh.prototype.ih=function(t){var e=new eh(this.clientId,this.allowTabSynchronization,Date.now());return Ch(t).put(eh.key,e)},Rh.Ln=function(){return ia.Ln()},Rh.prototype.sh=function(t){var e=this,n=Ch(t);return n.get(eh.key).next(function(t){return e.rh(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(eh.key)):ra.resolve()})},Rh.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Sr("Detected an update time that is in the future: "+t+" > "+n),1))},Rh.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},Rh.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},Rh.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},Rh.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},Rh.prototype._h=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Sr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Rh.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){Sr("Failed to set zombie client id.",t)}},Rh.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},Rh.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Rh);function Rh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.ka=a,this.Oa=c,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!Rh.Ln())throw new Er(Ir.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new Uh(this,r),this.Qa=e+"main",this.serializer=new Ac(u),this.Wa=new ia(this.Qa,10,new Zc(this.serializer)),this.ja=new Th(this.No,this.serializer),this.Dr=new bh,this.vr=(e=this.serializer,u=this.Dr,new Bc(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Vh(t,e){var n=this;return(n=Oh.call(this)||this).Wo=t,n.Fa=e,n}function Ch(t){return Lh.Kn(t,eh.store)}function Mh(t){return Lh.Kn(t,mh.store)}var Uh=(jh.prototype.Po=function(t){var n=this.Ph(t);return this.db.Ih().ba(t).next(function(e){return n.next(function(t){return e+t})})},jh.prototype.Ph=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},jh.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},jh.prototype.yo=function(t,n){return this.gh(t,function(t,e){return n(e)})},jh.prototype.Da=function(t,e,n){return qh(t,n)},jh.prototype.Na=function(t,e,n){return qh(t,n)},jh.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},jh.prototype.Go=qh,jh.prototype.Vh=function(t,e){return r=e,i=!1,Fc(n=t).os(function(t){return Mc(n,t,r).next(function(t){return t&&(i=!0),ra.resolve(!t)})}).next(function(){return i});var n,r,i},jh.prototype.bo=function(n,r){var i=this,o=this.db.mh().ra(),s=[],u=0;return this.gh(n,function(e,t){t<=r&&(t=i.Vh(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),xh(n).delete([0,Ec(e.path)])})}),s.push(t))}).next(function(){return ra.kn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},jh.prototype.removeTarget=function(t,e){return e=e.st(t.Fa),this.db.Ih().Va(t,e)},jh.prototype.yh=qh,jh.prototype.gh=function(t,r){var i,t=xh(t),o=Ca.ai;return t.rs({index:dh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ca.ai&&r(new si(Tc(i)),o),o=e,i=t):o=Ca.ai}).next(function(){o!==Ca.ai&&r(new si(Tc(i)),o)})},jh.prototype.So=function(t){return this.db.mh().aa(t)},jh);function jh(t,e){this.db=t,this.wo=new wc(this,e)}function qh(t,e){return xh(t).put((t=t.Fa,new dh(0,Ec(e.path),t)))}function Fh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Gh=(Bh.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bh)})},Bh);function Bh(t,e,n){this.persistence=t,this.ph=e,this.bh=new Di(Rr),this.Sh=new ti(wi,bi),this.Dh=ni.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new Ja(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}function zh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ia(t)})}function Hh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.va(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i.ja.wa(e).next(function(t){return n=new Ti(r,t,0,e.Fa),i.ja.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bh.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.bh=i.bh.ot(t.targetId,t),i.Sh.set(r,t.targetId)),t})}function Kh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bh.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!la(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bh=e.bh.remove(o),e.Sh.delete(n.target),[2]}})})}function Wh(t,o,s){var u=t,a=ni.min(),c=Bi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=yu(o),(void 0!==(t=(i=t).Sh.get(r))?ra.resolve(i.bh.get(t)):i.ja.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ja.xa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ph.Lr(e,o,s?a:ni.min(),s?c:Bi())}).next(function(t){return{documents:t,Fh:c}});var t,n,r,i})}function Xh(t,e){var n=t,r=n.ja;return(t=n.bh.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function Yh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==Qa)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Qh(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t}function Jh(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Pf(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(4),[4,Tf(e)];case 1:return t.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,_f(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nu=new ff(n,r)}var $h,Zh,tf,ef=(Ef.prototype.P=function(){return this.Oh.P()},Ef.prototype.Da=function(t,e){e=new nf(t,e),this.Oh=this.Oh.add(e),this.$h=this.$h.add(e)},Ef.prototype.Bh=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},Ef.prototype.Na=function(t,e){this.qh(new nf(t,e))},Ef.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},Ef.prototype.Kh=function(t){var e=this,n=new si(new ri([])),r=new nf(n,t),t=new nf(n,t+1),i=[];return this.$h.xt([r,t],function(t){e.qh(t),i.push(t.key)}),i},Ef.prototype.Qh=function(){var e=this;this.Oh.forEach(function(t){return e.qh(t)})},Ef.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},Ef.prototype.Wh=function(t){var e=new si(new ri([])),n=new nf(e,t),t=new nf(e,t+1),r=Bi();return this.$h.xt([n,t],function(t){r=r.add(t.key)}),r},Ef.prototype.Ho=function(t){var e=new nf(t,0);return null!==(e=this.Oh.kt(e))&&t.isEqual(e.key)},Ef),nf=(If.Mh=function(t,e){return si.D(t.key,e.key)||Rr(t.jh,e.jh)},If.Lh=function(t,e){return Rr(t.jh,e.jh)||si.D(t.key,e.key)},If),rf=(bf.prototype.getToken=function(){return Promise.resolve(null)},bf.prototype.Hh=function(){},bf.prototype.Jh=function(t){(this.zh=t)(La.UNAUTHENTICATED)},bf.prototype.Yh=function(){this.zh=null},bf),of=(wf.prototype.getToken=function(){var e=this,n=this.tc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.tc!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Qh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},wf.prototype.Hh=function(){this.forceRefresh=!0},wf.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},wf.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},wf.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new La(t)},wf),sf=(Object.defineProperty(mf.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),mf),uf=(gf.prototype.getToken=function(){return Promise.resolve(new sf(this.nc,this.sc))},gf.prototype.Jh=function(t){t(La.ni)},gf.prototype.Yh=function(){},gf.prototype.Hh=function(){},gf),Ie=(vf.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},vf.prototype.uc=function(){return 2===this.state},vf.prototype.start=function(){3!==this.state?this.auth():this.lc()},vf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},vf.prototype._c=function(){this.state=0,this.Vs.reset()},vf.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,function(){return t.dc()}))},vf.prototype.wc=function(t){this.Ec(),this.stream.send(t)},vf.prototype.dc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uc()?[2,this.close(0)]:[2]})})},vf.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},vf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==e?this.Vs.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):n&&n.code===Ir.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ic(n)];case 1:return t.sent(),[2]}})})},vf.prototype.Tc=function(){},vf.prototype.auth=function(){var n=this;this.state=1;var t=this.mc(this.ac),e=this.ac;this.oc.getToken().then(function(t){n.ac===e&&n.Ac(t)},function(e){t(function(){var t=new Er(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rc(t)})})},vf.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc(function(){n(function(){return e.state=2,e.listener.gc()})}),this.stream.Ic(function(t){n(function(){return e.Rc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},vf.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},vf.prototype.Rc=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},vf.prototype.mc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ac===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},vf),af=(n(yf,tf=Ie),yf.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},yf.prototype.onMessage=function(t){this.Vs.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Or(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(kr(void 0===o||"string"==typeof o),Mr.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),Mr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Si(s.code),new Er(o,s.message||"")),r=new $i(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Fo(t,a.document.name),u=Mo(a.document.updateTime),s=new Hs({mapValue:{fields:a.document.fields}}),u=new tu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Qi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Fo(t,a.document),c=a.readTime?Mo(a.readTime):ni.min(),c=new eu(u,c),a=a.removedTargetIds||[];r=new Qi([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Fo(t,c.document),c=c.removedTargetIds||[];r=new Qi([],c,h,null)}else{if(!("filter"in e))return Or();e.filter,(h=e.filter).targetId,e=new Ei(e=h.count||0),h=h.targetId,r=new Ji(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ni.min():Mo(e.readTime);return this.listener.yc(n,t)},yf.prototype.bc=function(t){var e,n,r,i,o={};o.database=zo(this.serializer),o.addTarget=(e=this.serializer,(r=Ii(r=(n=t).target)?{documents:Yo(e,r)}:{query:Qo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Co(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.wc(o)},yf.prototype.vc=function(t){var e={};e.database=zo(this.serializer),e.removeTarget=t,this.wc(e)},yf),cf=(n(df,Zh=Ie),Object.defineProperty(df.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),df.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,Zh.prototype.start.call(this)},df.prototype.Tc=function(){this.Sc&&this.Cc([])},df.prototype.Pc=function(t){return this.rc.Vc("Write",t)},df.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?Mo(e.updateTime):Mo(n)).isEqual(ni.min())&&(r=Mo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new _s(r,n);var e,n,r})):[]),n=Mo(t.commitTime);return this.listener.Nc(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},df.prototype.Fc=function(){var t={};t.database=zo(this.serializer),this.wc(t)},df.prototype.Cc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Wo(e.serializer,t)})};this.wc(t)},df),hf=(n(pf,$h=function(){}),pf.prototype.Oc=function(){if(this.kc)throw new Er(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},pf.prototype.Mc=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.Mc(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Hh(),t})},pf.prototype.$c=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.$c(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Hh(),t})},pf.prototype.terminate=function(){this.kc=!1},pf),ff=(lf.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()}))},lf.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,1<=this.Lc&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},lf.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},lf.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},lf.prototype.Qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.qc?(Sr(t),this.qc=!1):Nr("OnlineStateTracker",t)},lf.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},lf);function lf(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}function pf(t,e,n){var r=this;return(r=$h.call(this)||this).credentials=t,r.rc=e,r.serializer=n,r.kc=!1,r}function df(t,e,n,r,i){var o=this;return(o=Zh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Sc=!1,o}function yf(t,e,n,r,i){var o=this;return(o=tf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function vf(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new na(t,e)}function gf(t,e){this.nc=t,this.sc=e}function mf(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=La.ni}function wf(t){var e=this;this.Xh=null,this.currentUser=La.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then(function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)},function(){}))}function bf(){this.zh=null}function If(t,e){this.key=t,this.jh=e}function Ef(){this.Oh=new Vi(nf.Mh),this.$h=new Vi(nf.Lh)}function _f(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Pf(r))return[3,4];e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Tf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Af(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Nr("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,Tf(e)];case 1:return t.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}})})}function Nf(t,e){t.Yc.has(e.targetId)||(t.Yc.set(e.targetId,e),kf(t)?Of(t):qf(t).uc()&&Df(t,e))}function Sf(t,e){var n=t,t=qf(n);n.Yc.delete(e),t.uc()&&xf(n,e),0===n.Yc.size&&(t.uc()?t.fc():Pf(n)&&n.nu.set("Unknown"))}function Df(t,e){t.su.me(e.targetId),qf(t).bc(e)}function xf(t,e){t.su.me(e),qf(t).vc(e)}function Of(e){e.su=new to({qe:function(t){return e.Hc.qe(t)},Ue:function(t){return e.Yc.get(t)||null}}),qf(e).start(),e.nu.Uc()}function kf(t){return Pf(t)&&!qf(t).cc()&&0<t.Yc.size}function Pf(t){return 0===t.Xc.size}function Lf(t){t.su=void 0}function Rf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!la(r))throw r;return n.Xc.add(1),[4,Tf(n)];case 1:return t.sent(),n.nu.set("Offline"),i=i||function(){return zh(n.Gc)},n.hs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Xc.delete(1),[4,_f(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Vf(e,n){return n().catch(function(t){return Rf(e,t,n)})}function Cf(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=Ff(s=h),a=0<s.Jc.length?s.Jc[s.Jc.length-1].batchId:-1,t.label=1;case 1:if(!(Pf(s)&&s.Jc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Gc,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Sr.Bo(t,i)}))];case 3:return null===(c=t.sent())?(0===s.Jc.length&&u.fc(),[3,7]):(a=c.batchId,n=c,(e=s).Jc.push(n),(e=Ff(e)).uc()&&e.Dc&&e.Cc(n.mutations),[3,6]);case 4:return c=t.sent(),[4,Rf(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Mf(s)&&Uf(s),[2]}var e,n,r,i,o})})}function Mf(t){return Pf(t)&&!Ff(t).cc()&&0<t.Jc.length}function Uf(t){Ff(t).start()}function jf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Xc.delete(2),[4,_f(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Xc.add(2),[4,Tf(e)]);case 3:t.sent(),e.nu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function qf(n){var t,e,r,i=this;return n.hu||(n.hu=(t=n.zc,e=n.hs,r={gc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Yc.forEach(function(t,e){Df(n,t)}),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Lf(e),kf(e)?(e.nu.Wc(n),Of(e)):e.nu.set("Unknown"),[2]})})}.bind(null,n),yc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.nu.set("Online"),!(u instanceof $i&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Yc.has(i)?[4,o.Hc.iu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Yc.delete(i),o.su.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Rf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Qi?s.su.be(u):u instanceof Ji?s.su.ke(u):s.su.De(u),a.isEqual(ni.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,zh(s.Gc)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).su.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Yc.get(e))&&r.Yc.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Yc.get(t);e&&(r.Yc.set(t,e.it(Mr.u,e.nt)),xf(r,t),e=new Ti(e.target,t,1,e.sequenceNumber),Df(r,e))}),r.Hc.ru(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Rf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Oc(),new af(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.hu._c(),kf(n)?Of(n):n.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.hu.stop()];case 2:t.sent(),Lf(n),t.label=3;case 3:return[2]}})})})),n.hu}function Ff(n){var t,e,r,i=this;return n.cu||(n.cu=(t=n.zc,e=n.hs,r={gc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ff(e).Fc(),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ff(e).Dc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==Ir.ABORTED?(e=r.Jc.shift(),Ff(r)._c(),[4,Vf(r,function(){return r.Hc.au(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Cf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Mf(e)&&Uf(e),[2]}})})}.bind(null,n),xc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ff(o),n=0,r=o.Jc;n<r.length;n++)i=r[n],e.Cc(i.mutations);return[2]})})}.bind(null,n),Nc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jc.shift(),n=Ya.from(e,i,o),[4,Vf(r,function(){return r.Hc.ou(n)})];case 1:return t.sent(),[4,Cf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Oc(),new cf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.cu._c(),[4,Cf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.cu.stop()];case 3:t.sent(),0<n.Jc.length&&(Nr("RemoteStore","Stopping write stream with "+n.Jc.length+" pending writes"),n.Jc=[]),t.label=4;case 4:return[2]}})})})),n.cu}var Gf=function(t){this.key=t},Bf=function(t){this.key=t},zf=(Object.defineProperty(Yf.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),Yf.prototype.Eu=function(t,e){var s=this,u=e?e.Tu:new Ki,a=(e||this).du,c=(e||this).Qt,h=a,f=!1,l=cu(this.query)&&a.size===this.query.limit?a.last():null,p=hu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof tu?e:null)&&(Eu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Iu(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.fu(r,l)||p&&s.fu(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),cu(this.query)||hu(this.query))for(;h.size>this.query.limit;){var n=cu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{du:h,Tu:u,mu:f,Qt:c}},Yf.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Yf.prototype.Vr=function(t,e,n){var o=this,r=this.du;this.du=t.du,this.Qt=t.Qt;var i=t.Tu.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}}var r,i}),this.Au(n);var s=e?this.Ru():[],e=(n=0===this._u.size&&this.te?1:0)!==this.lu;return this.lu=n,0!==i.length||e?{snapshot:new Wi(this.query,t.du,r,i,t.Qt,0==n,e,!1),Pu:s}:{Pu:s}},Yf.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new Ki,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},Yf.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},Yf.prototype.Au=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uu=e.uu.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uu=e.uu.delete(t)}),this.te=t.te)},Yf.prototype.Ru=function(){var e=this;if(!this.te)return[];var n=this._u;this._u=Bi(),this.du.forEach(function(t){e.gu(t.key)&&(e._u=e._u.add(t.key))});var r=[];return n.forEach(function(t){e._u.has(t)||r.push(new Bf(t))}),this._u.forEach(function(t){n.has(t)||r.push(new Gf(t))}),r},Yf.prototype.Vu=function(t){return this.uu=t.Fh,this._u=Bi(),t=this.Eu(t.documents),this.Vr(t,!0)},Yf.prototype.yu=function(){return Wi.Gt(this.query,this.du,this.Qt,0===this.lu)},Yf),Hf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Kf=function(t){this.key=t,this.pu=!1},Wf=(Object.defineProperty(Xf.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),Xf);function Xf(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new ti(bu,wu),this.xu=new Map,this.Fu=[],this.ku=new Di(si.D),this.Ou=new Map,this.Mu=new ef,this.$u={},this.Lu=new Map,this.Bu=_h.da(),this.onlineState="Unknown",this.qu=void 0}function Yf(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=Bi(),this.Qt=Bi(),this.fu=_u(t),this.du=new Hi(this.fu)}function Qf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Eu(o)).mu?[4,Wh(r.Gc,i.query,!1).then(function(t){return t=t.documents,i.view.Eu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Vr(e,r.Uu,n),[2,(rl(r,i.targetId,n.Pu),n.snapshot)]}})})}(i,t,e,n)},[4,Wh(i.Gc,o,!0)];case 1:return n=t.sent(),r=new zf(o,n.Fh),e=r.Eu(n.documents),n=Yi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Vr(e,i.Uu,n),rl(i,s,n.Pu),r=new Hf(o,s,r),[2,(i.Nu.set(o,r),i.xu.has(s)?i.xu.get(s).push(o):i.xu.set(s,[o]),n.snapshot)]}})})}function Jf(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,c=e,h=(a=o).nt,f=c.bh,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ch.ra({oa:!0});f=c.bh;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.ja.Ca(s,t.se,e).next(function(){return c.ja.Sa(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Fa),f=f.ot(e,n),r=o,i=t,kr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.ja.Va(s,n))))});var t,o=Mi,n=Bi();return a.Jt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Jt.forEach(function(t,e){var n=r.get(t);e instanceof eu&&e.version.isEqual(ni.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.Ir(e,h),o=o.ot(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.No.yh(s,t))})})),h.isEqual(ni.min())||(t=c.ja.Ia(s).next(function(t){return c.ja.Aa(s,s.Fa,h)}),u.push(t)),ra.kn(u).next(function(){return i.apply(s)}).next(function(){return c.Nh.Mr(s,o)})}).then(function(t){return c.bh=f,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.Ou.get(e))&&(kr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.pu=!0:0<t.ne.size?kr(e.pu):0<t.se.size&&(kr(e.pu),e.pu=!1))}),[4,ol(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,f})})}function $f(t,n,e){var r;((t=t).Uu&&0===e||!t.Uu&&1===e)&&(r=[],t.Nu.forEach(function(t,e){(e=e.view.Ks(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&ka(t)}(t.vu,n),r.length&&t.Cu.yc(r),t.onlineState=n,t.Uu&&t.Su.ji(n))}function Zf(t,e){(t.Lu.get(e)||[]).forEach(function(t){t.resolve()}),t.Lu.delete(e)}function tl(t,e,n){var r=t,i=r.$u[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i)}function el(e,t,n){void 0===n&&(n=null),e.Su.Bi(t);for(var r=0,i=e.xu.get(t);r<i.length;r++){var o=i[r];e.Nu.delete(o),n&&e.Cu.Qu(o,n)}e.xu.delete(t),e.Uu&&e.Mu.Kh(t).forEach(function(t){e.Mu.Ho(t)||nl(e,t)})}function nl(t,e){var n=t.ku.get(e);null!==n&&(Sf(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),il(t))}function rl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Gf?(t.Mu.Da(u.key,e),r=t,i=(i=u).key,r.ku.get(i)||(Nr("SyncEngine","New document in limbo: "+i),r.Fu.push(i),il(r))):u instanceof Bf?(Nr("SyncEngine","Document no longer in limbo: "+u.key),t.Mu.Na(u.key,e),t.Mu.Ho(u.key)||nl(t,u.key)):Or()}}function il(t){for(;0<t.Fu.length&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new Kf(e)),t.ku=t.ku.ot(e,n),Nf(t.bu,new Ti(yu(au(e.path)),n,2,Ca.ai))}}function ol(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nu.P()?[3,3]:(n.Nu.forEach(function(t,e){o.push(n.Ku(e,s,u).then(function(t){t&&(n.Uu&&n.Su.Ki(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=$a.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Cu.yc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(c,function(e){return ra.forEach(e.jr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return ra.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bh.get(o),u=s.nt,u=s.rt(u),r.bh=r.bh.ot(o,u));return[2]}})})}(n.Gc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function sl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xu.get(s))&&0!==a.length?[4,Hh(e.Gc,yu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nu.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Wh((e=r).Gc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Vu(n),[2,(e.Uu&&rl(e,i.targetId,n.Pu),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Xh(e.Gc,s)];case 8:return l=t.sent(),[4,Hh(e.Gc,l)];case 9:return u=t.sent(),[4,Qf(e,ul(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Cu.yc(r),n)]}})})}function ul(t){return uu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function al(t){return t.bu.Hc.ru=Jf.bind(null,t),t.bu.Hc.qe=function(t,e){var n=t;if((t=n.Ou.get(e))&&t.pu)return Bi().add(t.key);var r=Bi();if(!(e=n.xu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nu.get(s),r=r.Ot(s.view.wu);return r}.bind(null,t),t.bu.Hc.iu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Su.Ki(s,"rejected",u),i=e.Ou.get(s),(n=i&&i.key)?(r=(r=new Di(si.D)).ot(n,new eu(n,ni.min())),i=Bi().add(n),i=new Xi(ni.min(),new Map,new Vi(Rr),r,i),[4,Jf(e,i)]):[3,2];case 1:return t.sent(),e.ku=e.ku.remove(n),e.Ou.delete(s),il(e),[3,4];case 2:return[4,Kh(e.Gc,s,!1).then(function(){return el(e,s,u)}).catch(Yh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Cu.yc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&ka(n)}.bind(null,t.vu),t.Cu.Qu=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.vu),t}function cl(t){return t.bu.Hc.ou=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Ch.ra({oa:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ra.resolve();return a.forEach(function(n){c=c.next(function(){return s.Rr(o,n)}).next(function(t){var e=t;kr(null!==(t=r.dr.get(n))),(!e||e.version.h(t)<0)&&(e=u.hr(n,e,r))&&s.Ir(e,r._r)})}),c.next(function(){return i.Sr.Qo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Nh.Or(t,e)})}))];case 2:return i=t.sent(),tl(n,r,null),Zf(n,r),n.Su.Oi(r,"acknowledged"),[4,ol(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.bu.Hc.au=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.$o(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.Sr.Qo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Nh.Or(e,n)})}))];case 2:return o=t.sent(),tl(n,u,a),Zf(n,u),n.Su.Oi(u,"rejected",a),[4,ol(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var hl,fl,ll,pl=(Ul.prototype.xh=function(t){this.zu=t},Ul.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ni.min())?this.Hu(e,r):this.zu.Or(e,o).next(function(t){var n=s.Ju(r,t);return(cu(r)||hu(r))&&s.mu(r.an,n,o,i)?s.Hu(e,r):(Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.zu.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Ul.prototype.Ju=function(n,t){var r=new Vi(_u(n));return t.forEach(function(t,e){e instanceof tu&&Eu(n,e)&&(r=r.add(e))}),r},Ul.prototype.mu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.h(r))},Ul.prototype.Hu=function(t,e){return Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.zu.Lr(t,e,ni.min())},Ul),dl=(Ml.prototype.ko=function(t){return ra.resolve(0===this.Sr.length)},Ml.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Sr.length&&this.Sr[this.Sr.length-1],n=new Xa(i,e,n,r),this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xu=this.Xu.add(new nf(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return ra.resolve(n)},Ml.prototype.$o=function(t,e){return ra.resolve(this.Zu(e))},Ml.prototype.Bo=function(t,e){return e+=1,e=(e=this.tl(e))<0?0:e,ra.resolve(this.Sr.length>e?this.Sr[e]:null)},Ml.prototype.qo=function(){return ra.resolve(0===this.Sr.length?-1:this.Yu-1)},Ml.prototype.Uo=function(t){return ra.resolve(this.Sr.slice())},Ml.prototype.Nr=function(t,e){var n=this,r=new nf(e,0),e=new nf(e,Number.POSITIVE_INFINITY),i=[];return this.Xu.xt([r,e],function(t){t=n.Zu(t.jh),i.push(t)}),ra.resolve(i)},Ml.prototype.$r=function(t,e){var n=this,r=new Vi(Rr);return e.forEach(function(t){var e=new nf(t,0),t=new nf(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,t],function(t){r=r.add(t.jh)})}),ra.resolve(this.el(r))},Ml.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,e=n;si.X(e)||(e=e.child(""));var e=new nf(new si(e),0),i=new Vi(Rr);return this.Xu.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.jh)),!0)},e),ra.resolve(this.el(i))},Ml.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Zu(t))&&n.push(t)}),n},Ml.prototype.Qo=function(n,r){var i=this;kr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xu;return ra.forEach(r.mutations,function(t){var e=new nf(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xu=o})},Ml.prototype.jo=function(t){},Ml.prototype.Ho=function(t,e){var n=new nf(e,0),n=this.Xu.kt(n);return ra.resolve(e.isEqual(n&&n.key))},Ml.prototype.zo=function(t){return this.Sr.length,ra.resolve()},Ml.prototype.nl=function(t,e){return this.tl(t)},Ml.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},Ml.prototype.Zu=function(t){return(t=this.tl(t))<0||t>=this.Sr.length?null:this.Sr[t]},Ml),yl=(Cl.prototype.Ir=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:o,readTime:n}),this.size+=o-i,this.Dr.Mo(t,r.path.F())},Cl.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Cl.prototype.Rr=function(t,e){return e=this.docs.get(e),ra.resolve(e?e.ta:null)},Cl.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),ra.resolve(r)},Cl.prototype.Lr=function(t,e,n){for(var r=qi,i=new si(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ta,a=a.readTime;if(!e.path.M(s.path))break;a.h(n)<=0||u instanceof tu&&Eu(e,u)&&(r=r.ot(u.key,u))}return ra.resolve(r)},Cl.prototype.il=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},Cl.prototype.ra=function(t){return new vl(this)},Cl.prototype.aa=function(t){return ra.resolve(this.size)},Cl),vl=(n(Vl,ll=h),Vl.prototype.Vr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ha.Ir(n,e,r.readTime)):r.ha.Ar(t)}),ra.kn(i)},Vl.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},Vl.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},Vl),gl=(Rl.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),ra.resolve()},Rl.prototype.Ia=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},Rl.prototype.ma=function(t){return ra.resolve(this.ol)},Rl.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),ra.resolve(this.highestTargetId)},Rl.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),ra.resolve()},Rl.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},Rl.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,ra.resolve()},Rl.prototype.Va=function(t,e){return this.Pa(e),ra.resolve()},Rl.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),--this.targetCount,ra.resolve()},Rl.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),ra.kn(u).next(function(){return s})},Rl.prototype.ba=function(t){return ra.resolve(this.targetCount)},Rl.prototype.va=function(t,e){return e=this.rl.get(e)||null,ra.resolve(e)},Rl.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),ra.resolve()},Rl.prototype.Ca=function(e,t,n){this.al.Uh(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),ra.kn(i)},Rl.prototype.pa=function(t,e){return this.al.Kh(e),ra.resolve()},Rl.prototype.xa=function(t,e){return e=this.al.Wh(e),ra.resolve(e)},Rl.prototype.Ho=function(t,e){return ra.resolve(this.al.Ho(e))},Rl),ml=(Ll.prototype.start=function(){return Promise.resolve()},Ll.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(Ll.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Ll.prototype.Za=function(){},Ll.prototype.th=function(){},Ll.prototype.Ah=function(){return this.Dr},Ll.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new dl(this.Dr,this.No),this.cl[t.ti()]=e),e},Ll.prototype.Ih=function(){return this.ja},Ll.prototype.mh=function(){return this.vr},Ll.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new wl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).xn().then(function(t){return i.br(),t})},Ll.prototype.fl=function(e,n){return ra.On(Object.values(this.cl).map(function(t){return function(){return t.Ho(e,n)}}))},Ll),wl=(n(Pl,fl=be),Pl),bl=(kl.El=function(t){return new kl(t)},Object.defineProperty(kl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw Or()},enumerable:!1,configurable:!0}),kl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),ra.resolve()},kl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),ra.resolve()},kl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),ra.resolve()},kl.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Ih();return r.xa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.ya(t,e)})},kl.prototype.ll=function(){this.wl=new Set},kl.prototype._l=function(n){var r=this,i=this.persistence.mh().ra();return ra.forEach(this.Tl,function(t){var e=si.H(t);return r.Il(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},kl.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},kl.prototype.ul=function(t){return 0},kl.prototype.Il=function(t,e){var n=this;return ra.On([function(){return ra.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},kl),Il=(Ol.prototype.gc=function(t){this.Rl=t},Ol.prototype.Ic=function(t){this.Pl=t},Ol.prototype.onMessage=function(t){this.gl=t},Ol.prototype.close=function(){this.Al()},Ol.prototype.send=function(t){this.ml(t)},Ol.prototype.Vl=function(){this.Rl()},Ol.prototype.yl=function(t){this.Pl(t)},Ol.prototype.pl=function(t){this.gl(t)},Ol),El={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},_l=(xl.prototype.Mc=function(e,t,n,r){var i=this.Dl(e,t);return Nr("RestConnection","Sending: ",i,n),t={},this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},xl.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},xl.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},xl.prototype.Dl=function(t,e){return t=El[t],this.vl+"/v1/"+e+":"+t},n(Dl,hl=xl),Dl.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Nr("Connection",'RPC "'+o+'" timed out'),r(new Er(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Nr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Er(e,t.message))):r(new Er(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Er(Ir.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{Nr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Dl.prototype.Vc=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Il({ml:function(t){u?Nr("Connection","Not sending because WebChannel is closed:",t):(s||(Nr("Connection","Opening WebChannel transport."),o.open(),s=!0),Nr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Nr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Nr("Connection","WebChannel transport closed"),a.yl())}),t(vr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.yl(new Er(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=_i[r];if(void 0!==t)return Si(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.yl(new Er(t,i)),o.close()):(Nr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.Vl()},0),a},Dl),Tl=(Sl.prototype.eu=function(t){this.Ml.push(t)},Sl.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},Sl.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},Sl.prototype.Fl=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},Sl.prototype.Ol=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},Sl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Sl),Al=(Nl.prototype.eu=function(t){},Nl.prototype.Di=function(){},Nl);function Nl(){}function Sl(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}function Dl(t){var e=this;return(e=hl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function xl(t){this.bl=t,this._=t._;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Ol(t){this.ml=t.ml,this.Al=t.Al}function kl(t){this.persistence=t,this.dl=new ef,this.wl=null}function Pl(t){var e=this;return(e=fl.call(this)||this).Fa=t,e}function Ll(t){var e=this;this.cl={},this.Ma=new Ca(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new gl(this),this.Dr=new Jc,this.vr=(t=this.Dr,new yl(t,function(t){return e.No.ul(t)}))}function Rl(t){this.persistence=t,this.rl=new ti(wi,bi),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this.ol=0,this.al=new ef,this.targetCount=0,this.hl=_h.fa()}function Vl(t){var e=this;return(e=ll.call(this)||this).ha=t,e}function Cl(t,e){this.Dr=t,this.sl=e,this.docs=new Di(si.D),this.size=0}function Ml(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Vi(nf.Mh)}function Ul(){}function jl(t){return new ko(t,!0)}var ql,Fl,Gl=(Jl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Su=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.Gc=this.Kl(e),[2]}})})},Jl.prototype.Ul=function(t){return null},Jl.prototype.Kl=function(t){return e=this.persistence,n=new pl,t=t.Ql,new Gh(e,n,t);var e,n},Jl.prototype.Bl=function(t){return new ml(bl.El)},Jl.prototype.Ll=function(t){return new Wa},Jl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Jl),Bl=(n(Ql,Fl=Gl),Ql.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Fl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Xc(t),r=ni.min(),t.rs({index:fh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=xc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Dh=t})]})})}(this.Gc)];case 2:return t.sent(),[4,this.Wl.initialize(this,e)];case 3:return t.sent(),[4,cl(this.Wl.fi)];case 4:return t.sent(),[4,Cf(this.Wl.bu)];case 5:return t.sent(),[2]}})})},Ql.prototype.Ul=function(t){var e=this.persistence.No.wo;return new mc(e,t.hs)},Ql.prototype.Bl=function(t){var e=Fh(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?yc.ao(this.cacheSizeBytes):yc.fo,r=jl(t.bl._);return new Lh(this.synchronizeTabs,e,t.clientId,n,t.hs,ba(),Ia(),r,this.Su,!!this.forceOwnership)},Ql.prototype.Ll=function(t){return new Wa},Ql),zl=(n(Yl,ql=Bl),Yl.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,ql.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Wl.fi,this.Su instanceof Ka?(this.Su.fi={er:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Gc,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Nh.Or(e,t):ra.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Cf(o.bu)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(tl(o,a,h||null),Zf(o,a),o.Gc.Sr.jo(a)):Or(),t.label=4;case 4:return[4,ol(o,s)];case 5:return t.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),nr:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qu?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.xu.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Gc,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ch,n=t,t=s.Dh,r=e,i=Mi,o=Dc(t),t=Xc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:fh.readTimeIndex,range:n},function(t,e){var n=Nc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{kh:i,readTime:xc(o)}});var e,n,r,i,o}).then(function(t){var e=t.kh,t=t.readTime;return s.Dh=t,e}))];case 3:return r=t.sent(),i=Xi.Xt(u,"current"===a),[4,ol(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,Kh(n.Gc,u,!0)];case 6:return t.sent(),el(n,u,c),[3,8];case 7:Or(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=al(c)).qu)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xu.has(r)?(Nr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Xh(n.Gc,r)]):[3,6];case 2:return i=t.sent(),[4,Hh(n.Gc,i)];case 3:return o=t.sent(),[4,Qf(n,ul(i),o.targetId,!1)];case 4:t.sent(),Nf(n.bu,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xu.has(e)?[4,Kh(n.Gc,e,!1).then(function(){Sf(n.bu,e),el(n,e)}).catch(Yh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Gc.persistence.pi()}.bind(null,e)},[4,this.Su.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return al(r=h),cl(r),!0!==f||!0===r.qu?[3,3]:(e=r.Su.Ci(),[4,sl(r,e.L())]);case 1:return i=t.sent(),r.qu=!0,[4,jf(r.bu,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Nf(r.bu,u);return[3,7];case 3:return!1!==f||!1===r.qu?[3,7]:(a=[],c=Promise.resolve(),r.xu.forEach(function(t,e){r.Su.qi(e)?a.push(e):c=c.then(function(){return el(r,e),Kh(r.Gc,e,!0)}),Sf(r.bu,e)}),[4,c]);case 4:return t.sent(),[4,sl(r,a)];case 5:return t.sent(),(n=r).Ou.forEach(function(t,e){Sf(n.bu,e)}),n.Mu.Qh(),n.Ou=new Map,n.ku=new Di(si.D),r.qu=!1,[4,jf(r.bu,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Wl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ii?this.ql.start(this.Gc):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Yl.prototype.Ll=function(t){var e=ba();if(!Ka.Ln(e))throw new Er(Ir.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Fh(t.bl._,t.bl.persistenceKey);return new Ka(e,t.hs,n,t.clientId,t.Ql)},Yl),Hl=(Xl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Gc?[3,2]:(this.Gc=n.Gc,this.Su=n.Su,this.zc=this.jl(r),this.bu=this.Gl(r),this.vu=this.zl(r),this.fi=this.Hl(r,!n.synchronizeTabs),this.Su.di=function(t){return $f(e.fi,t,1)},this.bu.Hc.Jl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Nr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Nh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.Th(o),m=new Ja(e.Ch,n,e.persistence.Ah()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=Bi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Or(v,r).next(function(t){return{Wu:t,ju:e,Gu:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Nh=m,e.ph.xh(e.Nh),r)]}})})}(n.Gc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lu.forEach(function(t){t.forEach(function(t){t.reject(new Er(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lu.clear(),n.Su.Wi(o,r.ju,r.Gu),[4,ol(n,r.Wu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fi),[4,jf(this.bu,this.fi.Uu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xl.prototype.zl=function(t){return new Da},Xl.prototype.jl=function(t){var e=jl(t.bl._),n=(n=t.bl,new _l(n));return t=t.credentials,new hf(t,n,e)},Xl.prototype.Gl=function(t){var e=this;return new Jh(this.Gc,this.zc,t.hs,function(t){return $f(e.fi,t,0)},t=new(Tl.Ln()?Tl:Al))},Xl.prototype.Hl=function(t,e){return n=this.Gc,r=this.bu,i=this.vu,o=this.Su,s=t.Ql,u=t.Du,a=e,u=new Wf(n,r,i,o,s,u),a&&(u.qu=!0),u;var n,r,i,o,s,u,a},Xl.prototype.terminate=function(){return Af(this.bu)},Xl),Kl=(Wl.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},Wl.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Wl.prototype.Xl=function(){this.muted=!0},Wl.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Wl);function Wl(t){this.observer=t,this.muted=!1}function Xl(){}function Yl(t,e){var n=this;return(n=ql.call(this,t,e,!1)||this).Wl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Ql(t,e,n){var r=this;return(r=Fl.call(this)||this).Wl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Jl(){this.synchronizeTabs=!1}function $l(t,e,n){if(!n)throw new Er(Ir.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Zl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Er(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function tp(t,e,n,r){if(!0===e&&!0===r)throw new Er(Ir.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function ep(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Or();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function np(t,e){if(e<=0)throw new Er(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var rp,ip,op=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new oi(t)},sp=(n(fp,ip=op),fp.documentId=function(){return new fp(oi.j().B())},fp.prototype.isEqual=function(t){return t instanceof fp&&this.Zl.isEqual(t.Zl)},fp),up=new RegExp("[~\\*/\\[\\]]"),ap=function(t){this.t_=t},cp=(n(hp,rp=ap),hp.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},hp.prototype.isEqual=function(t){return t instanceof hp},hp);function hp(){return null!==rp&&rp.apply(this,arguments)||this}function fp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ip.call(this,t)||this}function lp(t,e,n){return new Vp({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var pp,dp,yp,vp,gp=(n(Lp,vp=ap),Lp.prototype.e_=function(t){return new Is(t.path,new ss)},Lp.prototype.isEqual=function(t){return t instanceof Lp},Lp),mp=(n(Pp,yp=ap),Pp.prototype.e_=function(t){var e=lp(this,t,!0),n=this.o_.map(function(t){return Bp(t,e)}),n=new us(n);return new Is(t.path,n)},Pp.prototype.isEqual=function(t){return this===t},Pp),wp=(n(kp,dp=ap),kp.prototype.e_=function(t){var e=lp(this,t,!0),n=this.o_.map(function(t){return Bp(t,e)}),n=new ls(n);return new Is(t.path,n)},kp.prototype.isEqual=function(t){return this===t},kp),bp=(n(Op,pp=ap),Op.prototype.e_=function(t){var e=new vs(t.serializer,Ro(t.serializer,this.a_));return new Is(t.path,e)},Op.prototype.isEqual=function(t){return this===t},Op),Ip=(Object.defineProperty(xp.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(xp.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),xp.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},xp.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},xp.prototype.g=function(t){return Rr(this.h_,t.h_)||Rr(this.c_,t.c_)},xp),Ep=function(t){this.u_=t},_p=/^__.*__$/,Tp=function(t,e,n){this.l_=t,this.__=e,this.f_=n},Ap=(Dp.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new Ls(t,this.data,this.Qe,e)):n.push(new Ps(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Us(t,this.fieldTransforms)),n},Dp),Np=(Sp.prototype.d_=function(t,e){return e=[new Ls(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Us(t,this.fieldTransforms)),e},Sp);function Sp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Dp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function xp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Er(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Er(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}function Op(t,e){var n=this;return(n=pp.call(this,t)||this).a_=e,n}function kp(t,e){var n=this;return(n=dp.call(this,t)||this).o_=e,n}function Pp(t,e){var n=this;return(n=yp.call(this,t)||this).o_=e,n}function Lp(){return null!==vp&&vp.apply(this,arguments)||this}function Rp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Or()}}var Vp=(Object.defineProperty(Up.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),Up.prototype.E_=function(t){return new Up(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Up.prototype.T_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.E_({path:e,r_:!1})).I_(t),e},Up.prototype.m_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.E_({path:t,r_:!1})).w_(),t},Up.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},Up.prototype.s_=function(t){return Yp(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},Up.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},Up.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},Up.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Rp(this.n_)&&_p.test(t))throw this.s_('Document fields cannot begin and end with "__"')},Up),Cp=(Mp.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Vp({n_:t,methodName:e,i_:n,path:oi.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Mp);function Mp(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||jl(t)}function Up(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function jp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);Kp("Data must be an object, but it was:",s,r);var u,a,r=zp(r,s);if(o.merge)u=new bs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof op)p=l.Zl;else{if("string"!=typeof l)throw Or();p=Xp(e,l,n)}if(!s.contains(p))throw new Er(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Qp(c,p)||c.push(p)}u=new bs(c),a=s.fieldTransforms.filter(function(t){return u.Je(t.field)})}else u=null,a=s.fieldTransforms;return new Ap(new Hs(r),u,a)}function qp(t,r,i,e){var o=t.P_(1,r,i);Kp("Data must be an object, but it was:",o,e);var s=[],u=new Ks;return Qr(e,function(t,e){var n=Xp(r,t,i),t=o.m_(n);e instanceof cp||e instanceof Ep&&e.u_ instanceof cp?s.push(n):null!=(t=Bp(e,t))&&(s.push(n),u.set(n,t))}),e=new bs(s),new Np(u.Xe(),e,o.fieldTransforms)}function Fp(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[Wp(e,r,n)],a=[i];if(o.length%2!=0)throw new Er(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Wp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Ks,y=u.length-1;0<=y;--y)Qp(p,u[y])||(h=u[y],f=a[y],l=s.m_(h),f instanceof cp||f instanceof Ep&&f.u_ instanceof cp?p.push(h):null!=(l=Bp(f,l))&&(p.push(h),d.set(h,l)));return i=new bs(p),new Np(d.Xe(),i,s.fieldTransforms)}function Gp(t,e,n,r){return void 0===r&&(r=!1),Bp(n,t.P_(r?4:3,e))}function Bp(s,t){if(s instanceof Ep&&(s=s.u_),Hp(s))return Kp("Unsupported field value:",t,s),zp(s,t);if(s instanceof ap)return function(t,e){if(!Rp(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");(t=t.e_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Bp(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ro(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof ei){var r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof Ip)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jr)return{bytesValue:Co(e.serializer,t.l)};if(t instanceof Tp){if(n=e._,!(r=t.l_).isEqual(n))throw e.s_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Uo(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+ep(t))}(s,t)}function zp(t,n){var r={};return Jr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Qr(t,function(t,e){null!=(e=Bp(e,n.T_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Hp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Ip||t instanceof jr||t instanceof Tp||t instanceof ap)}function Kp(t,e,n){if(!Hp(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=ep(n))?e.s_(t+" a custom object"):e.s_(t+" "+n);var r}function Wp(t,e,n){if(e instanceof op)return e.Zl;if("string"==typeof e)return Xp(t,e);throw Yp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Xp(t,e,n){try{return function(e){if(0<=e.search(up))throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(sp.bind.apply(sp,i([void 0],e.split("."))))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw Yp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Yp(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Er(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Qp(t,e){return t.some(function(t){return t.isEqual(e)})}var Jp=(nd.prototype.b_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new Er(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=zo((i=s).serializer)+"/documents",n={documents:u.map(function(t){return qo(i.serializer,t)})},[4,i.$c("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=Fo(t,e.found.name),t=Mo(e.found.updateTime),e=new Hs({mapValue:{fields:e.found.fields}});return new tu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=Fo(n,r.missing),r=Mo(r.readTime),new eu(n,r)):Or());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.zc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof eu||t instanceof tu?n.S_(t):Or()}),e)]}})})},nd.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},nd.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},nd.prototype.delete=function(t){this.write([new Bs(t,this.Ge(t))]),this.p_.add(t.toString())},nd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),this.y_)throw this.y_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=si.H(e),n.mutations.push(new zs(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=zo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Wo(e.serializer,t)})},[4,e.Mc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.zc,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},nd.prototype.S_=function(t){var e;if(t instanceof tu)e=t.version;else{if(!(t instanceof eu))throw Or();e=ni.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Er(Ir.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},nd.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?Ts.updateTime(e):Ts.ze()},nd.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return Ts.exists(!0);if(e.isEqual(ni.min()))throw new Er(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ts.updateTime(e)},nd.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},nd.prototype.v_=function(){},nd),$p=(ed.prototype.run=function(){this.N_()},ed.prototype.N_=function(){var t=this;this.Vs.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Jp(this.zc),(n=this.x_(e))&&n.then(function(t){r.hs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.F_(t)})})}).catch(function(t){r.F_(t)}),[2]})})})},ed.prototype.x_=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},ed.prototype.F_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.hs.ws(function(){return e.N_(),Promise.resolve()})):this.ls.reject(t)},ed.prototype.k_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ni(t))},ed),Zp=(td.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new ta,o=!1;return this.credentials.Jh(function(t){return o?void r.hs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).hs.Fs(),Nr("RemoteStore","RemoteStore received new credentials"),n=Pf(e),e.Xc.add(3),[4,Tf(e)];case 1:return t.sent(),n&&e.nu.set("Unknown"),[4,e.Hc.Jl(i)];case 2:return t.sent(),e.Xc.delete(3),[4,_f(e)];case 3:return t.sent(),[2]}})})}(r.bu,t)}):(o=!0,Nr("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject))}),this.hs.ws(function(){return r.O_.promise}),i.promise},td.prototype.enableNetwork=function(){var e=this;return this.M_(),this.hs.enqueue(function(){return e.persistence.th(!0),(t=e.bu).Xc.delete(0),_f(t);var t})},td.prototype.L_=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:o,Du:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Su=r.Su,this.Gc=r.Gc,this.ql=r.ql,this.zc=i.zc,this.bu=i.bu,this.fi=i.fi,this.B_=i.vu,this.B_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=al(s),(o=e.Nu.get(u))?(n=o.targetId,e.Su.$i(n),r=o.view.yu(),[3,4]):[3,1];case 1:return[4,Hh(e.Gc,yu(u))];case 2:return i=t.sent(),o=e.Su.$i(i.targetId),n=i.targetId,[4,Qf(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uu&&Nf(e.bu,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.B_.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nu.get(o),1<(r=e.xu.get(n.targetId)).length?[2,(e.xu.set(n.targetId,r.filter(function(t){return!wu(t,o)})),void e.Nu.delete(o))]:e.Uu?(e.Su.Bi(n.targetId),e.Su.xi(n.targetId)?[3,2]:[4,Kh(e.Gc,n.targetId,!1).then(function(){e.Su.Ui(n.targetId),Sf(e.bu,n.targetId),el(e,n.targetId)}).catch(Yh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return el(e,n.targetId),[4,Kh(e.Gc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Ir.FAILED_PRECONDITION||e.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.L_(new Gl,new Hl,o,s))];case 4:return[2]}})})},td.prototype.M_=function(){if(this.hs.ps)throw new Er(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},td.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue(function(){return t.persistence.th(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(0),[4,Tf(e)];case 1:return t.sent(),e.nu.set("Offline"),[2]}})})}(t.bu)})},td.prototype.terminate=function(){var t=this;this.hs.Ds();var n=new ta;return this.hs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Af(this.bu)];case 1:return t.sent(),[4,this.Su.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yh(),n.resolve(),[3,5];case 4:return e=Na(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},td.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new ta;return this.hs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Pf((n=o).bu)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Gc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lu.get(r)||[]).push(s),n.Lu.set(r,i),[3,4]);case 3:return i=Na(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},td.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new Kl(n),o=new Pa(t,i,e);return this.hs.ws(function(){return xa(r.B_,o)}),function(){i.Xl(),r.hs.ws(function(){return Oa(r.B_,o)})}},td.prototype.q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ta,[2,(this.hs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Nh.Cr(t,e)}))];case 1:return(r=t.sent())instanceof tu?s.resolve(r):r instanceof eu?s.resolve(null):s.reject(new Er(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Na(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Gc,r,e)}),e.promise)]}})})},td.prototype.U_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ta,[2,(this.hs.ws(function(){return n=a.B_,r=a.hs,i=c,o=h,s=e,t=new Kl({next:function(t){r.ws(function(){return Oa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Er(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Er(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Pa(au(i.path),t,{includeMetadataChanges:!0,Xs:!0}),xa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},td.prototype.K_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ta,[2,(this.hs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Wh(r,i,!0)];case 1:return n=t.sent(),e=new zf(i,n.Fh),n=e.Eu(n.documents),n=e.Vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Na(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Gc,r,e)}),e.promise)]}})})},td.prototype.Q_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),u=new ta,[2,(this.hs.ws(function(){return e=a.B_,n=a.hs,t=c,r=h,i=u,o=new Kl({next:function(t){n.ws(function(){return Oa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Er(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Pa(t,o,{includeMetadataChanges:!0,Xs:!0}),xa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},td.prototype.write=function(t){var e=this;this.M_();var n=new ta;return this.hs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=cl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Gc,a=p,h=i,f=ei.now(),o=a.reduce(function(t,e){return t.add(e.key)},Bi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Nh.Or(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Us?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof tu?t.field(i.field):void 0;null!=(o=rs(i.transform,o||null))&&(e=(null==e?new Ks:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Ls(i.key,o,function s(t){var u=[];return Qr(t.fields||{},function(t,e){var n=new oi([t]);if(Do(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new bs(u)}(o.proto.mapValue),Ts.exists(!0)))}return h.Sr.Oo(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Su.Fi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$u[e.currentUser.ti()])||new Di(Rr)).ot(n,r),e.$u[e.currentUser.ti()]=i,[4,ol(u,s.wr)];case 3:return t.sent(),[4,Cf(u.bu)];case 4:return t.sent(),[3,6];case 5:return u=Na(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},td.prototype._=function(){return this.bl._},td.prototype.W_=function(t){var e=this;this.M_();var r=new Kl(t);return this.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.B_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.B_.qs.delete(r)]})})})}},Object.defineProperty(td.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),td.prototype.transaction=function(t){var e=this;this.M_();var n=new ta;return this.hs.ws(function(){return new $p(e.hs,e.zc,t,n).run(),Promise.resolve()}),n.promise},td);function td(t,e){this.credentials=t,this.hs=e,this.clientId=Pr.t(),this.O_=new ta}function ed(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new na(this.hs,"transaction_retry")}function nd(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}function rd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var id,od,sd=(xd.prototype.J_=function(t){switch(po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(Eo(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw Or()}},xd.prototype.nf=function(t){var n=this,r={};return Qr(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},xd.prototype.tf=function(t){return new Ip(Io(t.latitude),Io(t.longitude))},xd.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},xd.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){return ho(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(fo(t));default:return null}},xd.prototype.Y_=function(t){return t=bo(t),new ei(t.seconds,t.nanos)},xd.prototype.Z_=function(t){var e=ri.q(t);return kr(ns(e)),t=new Kr(e.get(1),e.get(3)),e=new si(e.N(5)),t.isEqual(this._)||Sr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(e)},xd),ud=yc.uo,ad=(Dd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Dd),cd="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",hd=(Sd.prototype.enableIndexedDbPersistence=function(t,e){throw new Er(Ir.FAILED_PRECONDITION,cd)},Sd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Er(Ir.FAILED_PRECONDITION,cd)},Sd.prototype.clearIndexedDbPersistence=function(t){throw new Er(Ir.FAILED_PRECONDITION,cd)},Sd),fd=(Nd.prototype.enableIndexedDbPersistence=function(t,e){var n=new Hl,e=new Bl(n,t.sf().cacheSizeBytes,e);return t.if(e,n)},Nd.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new Hl,n=new zl(e,t.sf().cacheSizeBytes);return t.if(n,e)},Nd.prototype.clearIndexedDbPersistence=function(n){var t=this,r=new ta;return n.rf.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ia.Ln()?(e=n+"main",[4,ia.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Fh(n.l_,n.af))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},Nd),ld=(Object.defineProperty(Ad.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new Cp(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),Ad.prototype.settings=function(t){if(t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge,t=new ad(t),this.lf&&!this.df.isEqual(t))throw new Er(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.df=t).credentials&&(this.ff=function(t){if(!t)return new rf;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new uf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Er(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Ad.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Ad.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},Ad.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},Ad.prototype.enablePersistence=function(t){if(this.lf)throw new Er(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&tp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},Ad.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.lf&&!this.lf.j_)throw new Er(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]})})},Ad.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ad.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),Ad.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},Ad.prototype.onSnapshotsInSync=function(t){return this.uf(),rd(t)||(t={next:t}),this.lf.W_(t)},Ad.prototype.uf=function(){return this.lf||this.if(new Gl,new Hl),this.lf},Ad.prototype.If=function(){return new Br(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},Ad.prototype.if=function(t,e){var n=this.If();return this.lf=new Zp(this.ff,this.rf),this.lf.start(n,t,e)},Ad._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Er(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Er(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Kr(t)},Object.defineProperty(Ad.prototype,"app",{get:function(){if(!this.cf)throw new Er(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Ad.prototype.collection=function(t){return $l("Firestore.collection","path",t),this.uf(),new Md(ri.q(t),this,null)},Ad.prototype.doc=function(t){return $l("Firestore.doc","path",t),this.uf(),yd.mf(ri.q(t),this,null)},Ad.prototype.collectionGroup=function(t){if($l("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Vd((t=t,new ru(ri.U(),t)),this,null)},Ad.prototype.runTransaction=function(e){var n=this;return this.uf().transaction(function(t){return e(new pd(n,t))})},Ad.prototype.batch=function(){return this.uf(),new dd(this)},Ad.prototype.sf=function(){return this.df},Ad),pd=(Td.prototype.get=function(t){var e=this,n=Fd(0,t,this.Af);return this.Rf.b_([n.__]).then(function(t){if(!t||1!==t.length)return Or();if((t=t[0])instanceof eu)return new gd(e.Af,n.__,null,!1,!1,n.f_);if(t instanceof tu)return new gd(e.Af,n.__,t,!1,!1,n.f_);throw Or()})},Td.prototype.set=function(t,e,n){return t=Fd(0,t,this.Af),n=Zl("Transaction.set",n),e=Gd(t.f_,e,n),n=jp(this.Af.wf,"Transaction.set",t.__,e,null!==t.f_,n),this.Rf.set(t.__,n),this},Td.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof sp?(r=Fd(0,t,this.Af),Fp(this.Af.wf,"Transaction.update",r.__,e,n,i)):(r=Fd(0,t,this.Af),qp(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,e),this},Td.prototype.delete=function(t){return t=Fd(0,t,this.Af),this.Rf.delete(t.__),this},Td),dd=(_d.prototype.set=function(t,e,n){return this.Vf(),t=Fd(0,t,this.Af),n=Zl("WriteBatch.set",n),e=Gd(t.f_,e,n),n=jp(this.Af.wf,"WriteBatch.set",t.__,e,null!==t.f_,n),this.Pf=this.Pf.concat(n.d_(t.__,Ts.ze())),this},_d.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.Vf(),e="string"==typeof e||e instanceof sp?(r=Fd(0,t,this.Af),Fp(this.Af.wf,"WriteBatch.update",r.__,e,n,i)):(r=Fd(0,t,this.Af),qp(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(e.d_(r.__,Ts.exists(!0))),this},_d.prototype.delete=function(t){return this.Vf(),t=Fd(0,t,this.Af),this.Pf=this.Pf.concat(new Bs(t.__,Ts.ze())),this},_d.prototype.commit=function(){return this.Vf(),this.gf=!0,0<this.Pf.length?this.Af.uf().write(this.Pf):Promise.resolve()},_d.prototype.Vf=function(){if(this.gf)throw new Er(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},_d),yd=(n(Ed,od=Tp),Ed.mf=function(t,e,n){if(t.length%2!=0)throw new Er(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new Ed(new si(t),e,n)},Object.defineProperty(Ed.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"parent",{get:function(){return new Md(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),Ed.prototype.collection=function(t){if($l("DocumentReference.collection","path",t),!t)throw new Er(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=ri.q(t),new Md(this.__.path.child(t),this.firestore,null)},Ed.prototype.isEqual=function(t){return t instanceof Ed&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},Ed.prototype.set=function(t,e){return e=Zl("DocumentReference.set",e),t=Gd(this.f_,t,e),e=jp(this.firestore.wf,"DocumentReference.set",this.__,t,null!==this.f_,e),this.lf.write(e.d_(this.__,Ts.ze()))},Ed.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof sp?Fp(this.firestore.wf,"DocumentReference.update",this.__,t,e,n):qp(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(t.d_(this.__,Ts.exists(!0)))},Ed.prototype.delete=function(){return this.lf.write([new Bs(this.__,Ts.ze())])},Ed.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||rd(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};rd(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.yf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(au(this.__.path),o,s)},Ed.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then(function(t){return new gd(e.firestore,e.__,t,!0,t instanceof tu&&t.Ye,e.f_)}):n.U_(this.__,t).then(function(t){return e.yf(t)})},Ed.prototype.withConverter=function(t){return new Ed(this.__,this.firestore,t)},Ed.prototype.yf=function(t){var e=t.docs.get(this.__);return new gd(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},Ed),vd=(Id.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Id),gd=(bd.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new md(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new sd(this.Af.l_,t.serverTimestamps||"none",function(t){return new yd(t,e.Af,null)},function(t){return new Hr(t)}).J_(this.pf.rn())}},bd.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf&&null!==(t=this.pf.data().field(Wp("DocumentSnapshot.get",t,this.__))))return new sd(this.Af.l_,e.serverTimestamps||"none",function(t){return new yd(t,n.Af,n.f_)},function(t){return new Hr(t)}).J_(t)},Object.defineProperty(bd.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"ref",{get:function(){return new yd(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"metadata",{get:function(){return new vd(this.vf,this.bf)},enumerable:!1,configurable:!0}),bd.prototype.isEqual=function(t){return t instanceof bd&&this.Af===t.Af&&this.bf===t.bf&&this.__.isEqual(t.__)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.f_===t.f_},bd),md=(n(wd,id=gd),wd.prototype.data=function(t){return id.prototype.data.call(this,t)},wd);function wd(){return null!==id&&id.apply(this,arguments)||this}function bd(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}function Id(t,e){this.hasPendingWrites=t,this.fromCache=e}function Ed(t,e,n){var r=this;return(r=od.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.lf=r.firestore.uf(),r}function _d(t){this.Af=t,this.Pf=[],this.gf=!1}function Td(t,e){this.Af=t,this.Rf=e}function Ad(t,e,n){var r=this;if(void 0===n&&(n=new hd),this.hf=n,this.cf=null,this.rf=new _a,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)n=t,this.cf=n,this.l_=Ad._f(n),this.af=n.name,this.ff=new of(e);else{if(!(t=t).projectId)throw new Er(Ir.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Kr(t.projectId,t.database),this.af="[DEFAULT]",this.ff=new rf}this.df=new ad({})}function Nd(){}function Sd(){}function Dd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Er(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=yc._o;else{if(t.cacheSizeBytes!==ud&&t.cacheSizeBytes<yc.lo)throw new Er(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+yc.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,tp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function xd(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}function Od(t,e,n){if("string"==typeof n){if(""===n)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!pu(e)&&-1!==n.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ri.q(n)),!si.X(e))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return _o(t,new si(e))}if(n instanceof Tp)return _o(t,n.__);throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ep(n)+".")}function kd(t,e){if(!Array.isArray(t)||0===t.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Pd(t,e,n){if(!n.isEqual(e))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ld(t){if(hu(t)&&0===t.on.length)throw new Er(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rd,Vd=(qd.prototype.where=function(t,e,n){return t=Wp("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){kd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Od(n,t,c))}h={arrayValue:{values:s}}}else h=Od(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||kd(o,i),h=Gp(e,"Query.where",o,"in"===i||"not-in"===i);var h=Au.create(r,i,h);return function(t,e){if(e.un()){var n=lu(t);if(null!==n&&!n.isEqual(e.field))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=fu(t))&&Pd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Er(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Er(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Sf,this.firestore.wf,this.firestore.l_,t,e,n),new qd((e=(n=this.Sf).filters.concat([e]),new ru(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},qd.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Er(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Wp("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new Zu(e,n),null!==fu(t)||null!==(t=lu(t))&&Pd(0,t,n.field),e}(this.Sf,t,n);return new qd((t=(n=this.Sf).on.concat([t]),new ru(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},qd.prototype.limit=function(t){return np("Query.limit",t),new qd(vu(this.Sf,t,"F"),this.firestore,this.f_)},qd.prototype.limitToLast=function(t){return np("Query.limitToLast",t),new qd(vu(this.Sf,t,"L"),this.firestore,this.f_)},qd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAt",t,e,!0),new qd(gu(this.Sf,t),this.firestore,this.f_)},qd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAfter",t,e,!1),new qd(gu(this.Sf,t),this.firestore,this.f_)},qd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endBefore",t,e,!0),new qd(mu(this.Sf,t),this.firestore,this.f_)},qd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endAt",t,e,!1),new qd(mu(this.Sf,t),this.firestore,this.f_)},qd.prototype.isEqual=function(t){return t instanceof qd&&this.firestore===t.firestore&&wu(this.Sf,t.Sf)&&this.f_===t.f_},qd.prototype.withConverter=function(t){return new qd(this.Sf,this.firestore,t)},qd.prototype.Df=function(c,t,e,n){return t instanceof gd?function(t,e,n,r){if(!n)throw new Er(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=du(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(_o(e,n.key));else{var a=n.field(u.field);if(ho(a))throw new Er(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.B(),new Er(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Hu(i,r)}(this.Sf,this.firestore.l_,t.pf,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Er(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!pu(t)&&-1!==c.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.q(c));if(!si.X(h))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new si(h),u.push(_o(e,h))}else c=Gp(n,r,c),u.push(c)}return new Hu(u,o)}(this.Sf,this.firestore.l_,this.firestore.wf,c,e,n))},qd.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||rd(n[o])||(i=n[o],o++),rd(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Cd(e.firestore,e.Sf,t,e.f_))},error:n[o+1],complete:n[o+2]};return Ld(this.Sf),this.firestore.uf().listen(this.Sf,i,s)},qd.prototype.get=function(t){var e=this;Ld(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then(function(t){return new Cd(e.firestore,e.Sf,t,e.f_)})},qd),Cd=(Object.defineProperty(jd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),jd.prototype.forEach=function(e,n){var r=this;this.Nf.docs.forEach(function(t){e.call(n,r.kf(t,r.metadata.fromCache,r.Nf.Qt.has(t.key)))})},Object.defineProperty(jd.prototype,"query",{get:function(){return new Vd(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),jd.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.Nf.jt)throw new Er(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===t||(this.xf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Nf,t,this.kf.bind(this)),this.Ff=t),this.xf},jd.prototype.isEqual=function(t){return t instanceof jd&&this.Af===t.Af&&wu(this.Cf,t.Cf)&&this.Nf.isEqual(t.Nf)&&this.f_===t.f_},jd.prototype.kf=function(t,e,n){return new md(this.Af,t.key,t,e,n,this.f_)},jd),Md=(n(Ud,Rd=Vd),Object.defineProperty(Ud.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new yd(new si(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),Ud.prototype.doc=function(t){return 0===arguments.length&&(t=Pr.t()),$l("CollectionReference.doc","path",t),t=ri.q(t),yd.mf(this.Sf.path.child(t),this.firestore,this.f_)},Ud.prototype.add=function(t){var t=this.f_?this.f_.toFirestore(t):t,e=this.doc();return new yd(e.__,this.firestore,null).set(t).then(function(){return e})},Ud.prototype.withConverter=function(t){return new Ud(this.Of,this.firestore,t)},Ud);function Ud(t,e,n){var r=this;if(((r=Rd.call(this,au(t),e,n)||this).Of=t).length%2!=1)throw new Er(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function jd(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new vd(n.hasPendingWrites,n.fromCache)}function qd(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}function Fd(t,e,n){if((e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new Er(Ir.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=ep(t),new Er(Ir.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,yd)).firestore!==n)throw new Er(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Gd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Bd,zd,be=(n(Kd,Bd=Ep),Kd.serverTimestamp=function(){var t=new gp("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new Kd(t)},Kd.delete=function(){var t=new cp("deleteField");return t.t_="FieldValue.delete",new Kd(t)},Kd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new Kd(n)},Kd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new Kd(n)},Kd.increment=function(t){return(t=new bp("increment",t)).t_="FieldValue.increment",new Kd(t)},Kd.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},Kd),Hd={Firestore:ld,GeoPoint:Ip,Timestamp:ei,Blob:Hr,Transaction:pd,WriteBatch:dd,DocumentReference:yd,DocumentSnapshot:gd,Query:Vd,QueryDocumentSnapshot:md,QuerySnapshot:Cd,CollectionReference:Md,FieldPath:sp,FieldValue:be,setLogLevel:function(t){_r.setLogLevel(t)},CACHE_SIZE_UNLIMITED:ud};function Kd(){return null!==Bd&&Bd.apply(this,arguments)||this}(zd=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new ld(e,t,new fd);var e},"PUBLIC").setServiceProps(Object.assign({},Hd))),zd.registerVersion("@firebase/firestore","2.0.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});