!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Fv){"use strict";try{(function(){var l,t,e=(t=Fv)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function O(){}function S(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var x="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:R).apply(null,arguments)}function L(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,x)&&this[x]||(this[x]=++k))},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var G=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}var H=N.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(H=H&&H.userAgent)?H:"";var X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<X.length;i++)e=X[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=O;var Z,tt=K(ut,"Opera"),et=K(ut,"Trident")||K(ut,"MSIE"),nt=K(ut,"Edge"),rt=nt||et,it=K(ut,"Gecko")&&!(K(ut.toLowerCase(),"webkit")&&!K(ut,"Edge"))&&!(K(ut,"Trident")||K(ut,"MSIE"))&&!K(ut,"Edge"),ot=K(ut.toLowerCase(),"webkit")&&!K(ut,"Edge");function st(){var t=N.document;return t?t.documentMode:void 0}var H="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(H=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(H)?String(ut):H;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=G(String(Z)).split("."),n=G(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=N.document&&et&&(st()||parseInt(Z,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",O,e),N.removeEventListener("test",O,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},M(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Et(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}_t.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Et(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),At={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Pt(t);if(c||(t[Tt]=c=new _t(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function St(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(It(n,t),0==n.b&&(n.src=null,e[Tt]=null)):bt(t)))}function Dt(t){return t in At?At[t]:At[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&St(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return xt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new yt(e,this))}function Pt(t){return(t=t[Tt])instanceof _t?t:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==typeof e?e:(e[Rt]||(e[Rt]=function(t){return e.handleEvent(t)}),e[Rt])}function Lt(){U.call(this),this.c=new _t(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,J(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Lt,U),Lt.prototype[gt]=!0,(ut=Lt.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Ct(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Et(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Et(n,r,i,o)),(r=-1<e?n[e]:null)&&St(r))}(this,t,e,n,r)},ut.G=function(){if(Lt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=N.JSON.stringify;function jt(){this.b=this.a=null}var qt,Ft=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new zt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Gt(t,e){var n;qt||(n=N.Promise.resolve(void 0),qt=function(){n.then(Ht)}),Kt||(qt(),Kt=!0),Wt.add(t,e)}jt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Wt=new jt;function Ht(){for(var t,e;n=e=void 0,n=null,(e=Wt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function Yt(t,e){Lt.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Za,this),this.g=V()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Xt(t,e,n){if("function"==typeof t)n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}M(Yt,Lt),(ut=Yt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Qt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Yt.X.G.call(this),Qt(this),delete this.a};var Jt,$t,Zt=(E($t=ee,H=Jt=U),$t.prototype=null===H?Object.create(H):(te.prototype=H.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Xt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Jt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){U.call(this),this.b=t,this.a={}}M(ne,U);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&St(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ut(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Lt}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ae.Fa="serverreachability",M(fe,dt),ae.STAT_EVENT="statevent",M(pe,dt),ae.Ga="timingevent",M(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}we.prototype.a=null;var Ie,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ee(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ae(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Oe,t=rt?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ee,dt),M(Te,dt),M(Ae,we),Ie=new Ae;var Oe=45e3,Se={},De={};function xe(t,e,n){t.H=1,t.i=Je(Ke(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=V(),Re(t),t.l=Ke(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(C(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?Q(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?Se:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Se){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Re(t){t.T=V()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Va,t),e)}function Le(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function Me(t){Le(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Qn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Xe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Le(o),Re(o)),n.a=i):Yn(n),0<u.g.length&&Gn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):qn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Le(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Me(this),Ve(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,s)}this.I?(Pe(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Ue(this,n)),4==e&&Me(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Re(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Me(this),Ve(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Le(this),Pe(this,t,e),this.b&&4!=t&&Re(this)))},ut.cancel=function(){this.A=!0,Me(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Me(this),this.h=2,Ve(this)):Ce(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ge(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ge?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,He(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Qe(this,n),this.i=t.i):t&&(n=String(t).match(ze))?(this.a=!!e,We(this,n[1]||"",!0),this.j=$e(n[2]||""),He(this,n[3]||"",!0),Ye(this,n[4]),this.g=$e(n[5]||"",!0),Qe(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function Ke(t){return new Ge(t)}function We(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function He(t,e,n){t.c=n?$e(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Qe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Xe(t,e,n){t.b.set(e,n)}function Je(t){return Xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ge.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=F(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function In(){}function En(){this.a=new In}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},In.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},In.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var An=N.JSON.parse;function Nn(t){Lt.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}M(Nn,Lt);var On="",Sn=/^https?$/i,Dn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Cn(t)}function Pn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Rn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Xt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(ze)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!Sn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Ln(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Ln(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xe(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Un("baseRetryDelayMs",5e3,t),this.Ra=Un("retryDelaySeedMs",1e4,t),this.Ma=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new En,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Xe(n=Ke(t.B),"SID",t.J),Xe(n,"RID",e),Xe(n,"TYPE","terminate"),Wn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Je(Ke(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Re(e)),nr(t)}function Fn(t){t.a&&(Xn(t),t.a.cancel(),t.a=null)}function Bn(t){Fn(t),t.j&&(N.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function zn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){vn(t.b)||t.h||(t.h=!0,Gt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);Xe(r,"SID",t.J),Xe(r,"RID",n),Xe(r,"AID",t.P),Wn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Hn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),xe(n,r,e)}function Wn(t,n){t.f&&je({},function(t,e){Xe(n,e,t)})}function Hn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;D(t)&&(n=Ut(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,Gt(t.Aa,t),t.o=0)}function Qn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Xn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);Xe(e,"RID","rpc"),Xe(e,"SID",t.J),Xe(e,"CI",t.H?"0":"1"),Xe(e,"AID",t.P),Wn(t,e),Xe(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(Ke(e)),n.j=null,n.I=!0,ke(n,t)}function $n(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Xn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),Gn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Qn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Ya,t),r||(r=new Ge("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||We(r,"https"),Je(r)),n=r.toString(),r=o,o=new se,N.Image?((i=new Image).onload=L(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=L(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=L(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=L(Tn,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ge?Ke(s):new Ge(s,void 0);return""!=a.c?(e&&He(a,e+"."+a.c),Ye(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ge(null,void 0),r&&We(u,r),i&&He(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Xe(a,e,t)}),e=t.A,n=t.na,e&&n&&Xe(a,e,n),Xe(a,"VER",t.ha),Wn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Lt.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(ut=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ie),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=j(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ln(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Xt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Cn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Nn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Rn(this):this.Ua())},ut.Ua=function(){Rn(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=Q(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Hn(this,n,e),Xe(i=Ke(this.B),"RID",t),Xe(i,"CVER",22),this.A&&Xe(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&Mn(i,this.i,r),wn(this.b,n),this.Ia&&Xe(i,"TYPE","init"),this.da?(Xe(i,"$req",e),Xe(i,"SID","null"),n.U=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||vn(this.b)||Kn(this))},ut.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Jn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Qn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Lt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Gn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,zn(this.a,e)):this.l?((e={}).__data__=Ut(t),zn(this.a,e)):zn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ee),M(cr,Te),M(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(_e.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Lt.prototype.listen=Lt.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Qa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Pa,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=_e,vr=Nn,A=(gr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gr);function gr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},wr=(Object.defineProperty(Ir.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ir.prototype.isEqual=function(t){return t instanceof Ir&&t.projectId===this.projectId&&t.database===this.database},Ir),br=(_r.prototype.u=function(){return null!=this.uid},_r.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},_r.prototype.isEqual=function(t){return t.uid===this.uid},_r);function _r(t){this.uid=t}function Ir(t,e){this.projectId=t,this.database=e||"(default)"}br.UNAUTHENTICATED=new br(null),br.l=new br("google-credentials-uid"),br._=new br("first-party-uid");var Er="8.1.1-2020102005919",Tr=new h("@firebase/firestore");function Ar(){return Tr.logLevel}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.DEBUG&&(e=n.map(Dr),Tr.debug.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.ERROR&&(e=n.map(Dr),Tr.error.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.WARN&&(e=n.map(Dr),Tr.warn.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xr(t){throw void 0===t&&(t="Unexpected state"),Or(t="FIRESTORE ("+Er+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||xr()}function Pr(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t}var Rr,Cr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Lr=(n(Gr,Rr=Error),Gr),Vr=(zr.prototype.getToken=function(){return Promise.resolve(null)},zr.prototype.m=function(){},zr.prototype.A=function(t){(this.I=t)(br.UNAUTHENTICATED)},zr.prototype.R=function(){this.I=null},zr),Mr=(Br.prototype.getToken=function(){var e=this,n=this.V,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.V!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Pr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Br.prototype.m=function(){this.forceRefresh=!0},Br.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},Br.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},Br.prototype.p=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new br(t)},Br),Ur=(Object.defineProperty(Fr.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Fr),jr=(qr.prototype.getToken=function(){return Promise.resolve(new Ur(this.v,this.S))},qr.prototype.A=function(t){t(br._)},qr.prototype.R=function(){},qr.prototype.m=function(){},qr);function qr(t,e){this.v=t,this.S=e}function Fr(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=br._}function Br(t){var e=this;this.P=null,this.currentUser=br.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function zr(){this.I=null}function Gr(t,e){var n=this;return(n=Rr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Kr=(Wr.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Wr);function Wr(){}function Hr(t,e){return t<e?-1:e<t?1:0}function Yr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Qr(t){return t+"\0"}var Xr,Jr,$r=(ci.now=function(){return ci.fromMillis(Date.now())},ci.fromDate=function(t){return ci.fromMillis(t.getTime())},ci.fromMillis=function(t){var e=Math.floor(t/1e3);return new ci(e,1e6*(t-1e3*e))},ci.prototype.toDate=function(){return new Date(this.toMillis())},ci.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ci.prototype.C=function(t){return this.seconds===t.seconds?Hr(this.nanoseconds,t.nanoseconds):Hr(this.seconds,t.seconds)},ci.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ci.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ci.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ci.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ci),Zr=(ai.N=function(t){return new ai(t)},ai.min=function(){return new ai(new $r(0,0))},ai.prototype.F=function(t){return this.timestamp.C(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.M=function(){return this.timestamp},ai),ge=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.$(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},ui.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},ui.prototype.U=function(){return this.segments[this.offset]},ui.prototype.K=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype.W=function(){return 0===this.length},ui.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},ui.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Jr=ge),si.prototype.L=function(t,e,n){return new si(t,e,n)},si.prototype.J=function(){return this.H().join("/")},si.prototype.toString=function(){return this.J()},si.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new si(n)},si.X=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Xr=ge),oi.prototype.L=function(t,e,n){return new oi(t,e,n)},oi.Z=function(t){return ei.test(t)},oi.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.Z(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.J()},oi.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},oi.et=function(){return new oi(["__name__"])},oi.nt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Lr(Cr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Lr(Cr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Lr(Cr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.X=function(){return new oi([])},oi),ri=(ii.st=function(t){return new ii(ti.Y(t))},ii.it=function(t){return new ii(ti.Y(t).B(5))},ii.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.$(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.$=function(t,e){return ti.$(t.path,e.path)},ii.ot=function(t){return t.length%2==0},ii.ct=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Xr&&Xr.apply(this,arguments)||this}function si(){return null!==Jr&&Jr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.k=n}function ai(t){this.timestamp=t}function ci(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Lr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Lr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Lr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Lr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hi(t){return null==t}function fi(t){return 0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function di(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new pi(t,e,n,r,i,o,s)}function yi(t){var e=t;return null===e.ut&&(t=e.path.J(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.J()+t.op.toString()+bo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.J()+t.dir}).join(","),hi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Qu(e.startAt)),e.endAt&&(t+="|ub:",t+=Qu(e.endAt)),e.ut=t),e.ut}function vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ju(t.startAt,e.startAt)&&Ju(t.endAt,e.endAt)}function gi(t){return ri.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mi=(wi.fromBase64String=function(t){return new wi(atob(t))},wi.fromUint8Array=function(t){return new wi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},wi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},wi.prototype.ht=function(){return 2*this.at.length},wi.prototype.F=function(t){return Hr(this.at,t.at)},wi.prototype.isEqual=function(t){return this.at===t.at},wi);function wi(t){this.at=t}function bi(t){this.count=t}mi.lt=new mi("");var _i,Ii=(Ei.prototype.dt=function(t){return new Ei(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ei.prototype.wt=function(t,e){return new Ei(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ei.prototype.Et=function(t){return new Ei(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Ei);function Ei(t,e,n,r,i,o,s){void 0===i&&(i=Zr.min()),void 0===o&&(o=Zr.min()),void 0===s&&(s=mi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ti(t){switch(t){case Cr.OK:return xr(),0;case Cr.CANCELLED:case Cr.UNKNOWN:case Cr.DEADLINE_EXCEEDED:case Cr.RESOURCE_EXHAUSTED:case Cr.INTERNAL:case Cr.UNAVAILABLE:case Cr.UNAUTHENTICATED:return;case Cr.INVALID_ARGUMENT:case Cr.NOT_FOUND:case Cr.ALREADY_EXISTS:case Cr.PERMISSION_DENIED:case Cr.FAILED_PRECONDITION:case Cr.ABORTED:case Cr.OUT_OF_RANGE:case Cr.UNIMPLEMENTED:case Cr.DATA_LOSS:return 1;default:return xr(),0}}function Ai(t){if(void 0===t)return Or("GRPC error has no .code"),Cr.UNKNOWN;switch(t){case _i.OK:return Cr.OK;case _i.CANCELLED:return Cr.CANCELLED;case _i.UNKNOWN:return Cr.UNKNOWN;case _i.DEADLINE_EXCEEDED:return Cr.DEADLINE_EXCEEDED;case _i.RESOURCE_EXHAUSTED:return Cr.RESOURCE_EXHAUSTED;case _i.INTERNAL:return Cr.INTERNAL;case _i.UNAVAILABLE:return Cr.UNAVAILABLE;case _i.UNAUTHENTICATED:return Cr.UNAUTHENTICATED;case _i.INVALID_ARGUMENT:return Cr.INVALID_ARGUMENT;case _i.NOT_FOUND:return Cr.NOT_FOUND;case _i.ALREADY_EXISTS:return Cr.ALREADY_EXISTS;case _i.PERMISSION_DENIED:return Cr.PERMISSION_DENIED;case _i.FAILED_PRECONDITION:return Cr.FAILED_PRECONDITION;case _i.ABORTED:return Cr.ABORTED;case _i.OUT_OF_RANGE:return Cr.OUT_OF_RANGE;case _i.UNIMPLEMENTED:return Cr.UNIMPLEMENTED;case _i.DATA_LOSS:return Cr.DATA_LOSS;default:return xr()}}(me=_i={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Ni=(ki.prototype.Tt=function(t,e){return new ki(this.$,this.root.Tt(t,e,this.$).copy(null,null,Si.It,null,null))},ki.prototype.remove=function(t){return new ki(this.$,this.root.remove(t,this.$).copy(null,null,Si.It,null,null))},ki.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ki.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ki.prototype.W=function(){return this.root.W()},Object.defineProperty(ki.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ki.prototype.At=function(){return this.root.At()},ki.prototype.Rt=function(){return this.root.Rt()},ki.prototype.Pt=function(t){return this.root.Pt(t)},ki.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},ki.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ki.prototype.gt=function(t){return this.root.gt(t)},ki.prototype.yt=function(){return new Oi(this.root,null,this.$,!1)},ki.prototype.Vt=function(t){return new Oi(this.root,t,this.$,!1)},ki.prototype.vt=function(){return new Oi(this.root,null,this.$,!0)},ki.prototype.bt=function(t){return new Oi(this.root,t,this.$,!0)},ki),Oi=(xi.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},xi.prototype.Nt=function(){return 0<this.Dt.length},xi.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},xi),Si=(Di.prototype.copy=function(t,e,n,r,i){return new Di(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Di.prototype.W=function(){return!1},Di.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Di.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},Di.prototype.min=function(){return this.left.W()?this:this.left.min()},Di.prototype.At=function(){return this.min().key},Di.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Di.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Di.prototype.Ot=function(){if(this.left.W())return Di.EMPTY;var t=this;return t.left.Mt()||t.left.left.Mt()||(t=t.kt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Di.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Mt()||r.left.left.Mt()||(r=r.kt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Mt()&&(r=r.$t()),r.right.W()||r.right.Mt()||r.right.left.Mt()||(r=r.Lt()),0===e(t,r.key)){if(r.right.W())return Di.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Di.prototype.Mt=function(){return this.color},Di.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},Di.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},Di.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},Di.prototype.Bt=function(){var t=this.copy(null,null,Di.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Di.prototype.$t=function(){var t=this.copy(null,null,Di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Di.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Di.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Di.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw xr();if(this.right.Mt())throw xr();var t=this.left.Qt();if(t!==this.right.Qt())throw xr();return t+(this.Mt()?0:1)},Di);function Di(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Di.RED,this.left=null!=r?r:Di.EMPTY,this.right=null!=i?i:Di.EMPTY,this.size=this.left.size+1+this.right.size}function xi(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}function ki(t,e){this.$=t,this.root=e||Si.EMPTY}function Pi(){this.size=0}Si.EMPTY=null,Si.RED=!0,Si.It=!1,Si.EMPTY=(Object.defineProperty(Pi.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Pi.prototype.copy=function(t,e,n,r,i){return this},Pi.prototype.Tt=function(t,e,n){return new Si(t,e)},Pi.prototype.remove=function(t,e){return this},Pi.prototype.W=function(){return!0},Pi.prototype.Pt=function(t){return!1},Pi.prototype.gt=function(t){return!1},Pi.prototype.At=function(){return null},Pi.prototype.Rt=function(){return null},Pi.prototype.Mt=function(){return!1},Pi.prototype.Ut=function(){return!0},Pi.prototype.Qt=function(){return 0},new Pi);var Ri=(Mi.prototype.has=function(t){return null!==this.data.get(t)},Mi.prototype.first=function(){return this.data.At()},Mi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Mi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Mi.prototype.indexOf=function(t){return this.data.indexOf(t)},Mi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Mi.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(0<=this.$(r.key,t[1]))return;e(r.key)}},Mi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},Mi.prototype.jt=function(t){return(t=this.data.Vt(t)).Nt()?t.Ct().key:null},Mi.prototype.yt=function(){return new Ci(this.data.yt())},Mi.prototype.Vt=function(t){return new Ci(this.data.Vt(t))},Mi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Mi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Mi.prototype.W=function(){return this.data.W()},Mi.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Mi.prototype.isEqual=function(t){if(!(t instanceof Mi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(0!==this.$(r,i))return!1}return!0},Mi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Mi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Mi.prototype.copy=function(t){var e=new Mi(this.$);return e.data=t,e},Mi),Ci=(Vi.prototype.Ct=function(){return this.zt.Ct().key},Vi.prototype.Nt=function(){return this.zt.Nt()},Vi),Li=new Ni(ri.$);function Vi(t){this.zt=t}function Mi(t){this.$=t,this.data=new Ni(this.$)}var Ui=new Ni(ri.$),ji=new Ni(ri.$),qi=new Ri(ri.$);function Fi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=qi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Bi=new Ri(Hr),zi=(oo.Yt=function(t){return new oo(t.$)},oo.prototype.has=function(t){return null!=this.Ht.get(t)},oo.prototype.get=function(t){return this.Ht.get(t)},oo.prototype.first=function(){return this.Jt.At()},oo.prototype.last=function(){return this.Jt.Rt()},oo.prototype.W=function(){return this.Jt.W()},oo.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Jt.indexOf(t):-1},Object.defineProperty(oo.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),oo.prototype.forEach=function(n){this.Jt.Pt(function(t,e){return n(t),!1})},oo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},oo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},oo.prototype.isEqual=function(t){if(!(t instanceof oo))return!1;if(this.size!==t.size)return!1;for(var e=this.Jt.yt(),n=t.Jt.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(!r.isEqual(i))return!1}return!0},oo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},oo.prototype.copy=function(t,e){var n=new oo;return n.$=this.$,n.Ht=t,n.Jt=e,n},oo),Gi=(io.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):xr()},io.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},io),Ki=(ro.ie=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ro(t,e,zi.Yt(e),i,n,r,!0,!1)},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ro),Wi=(no.ae=function(t,e){var n=new Map;return n.set(t,Hi.he(t,e)),new no(Zr.min(),n,Bi,Li,Fi())},no),Hi=(eo.he=function(t,e){return new eo(mi.lt,e,Fi(),Fi(),Fi())},eo),Yi=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Qi=function(t,e){this.targetId=t,this.Te=e},Xi=function(t,e,n,r){void 0===n&&(n=mi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ji=(Object.defineProperty(to.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),to.prototype.Ve=function(t){0<t.ht()&&(this.Pe=!0,this.Ae=t)},to.prototype.pe=function(){var n=Fi(),r=Fi(),i=Fi();return this.me.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:xr()}}),new Hi(this.Ae,this.Re,n,r,i)},to.prototype.ve=function(){this.Pe=!1,this.me=uo()},to.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},to.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},to.prototype.De=function(){this.Ie+=1},to.prototype.Ce=function(){--this.Ie},to.prototype.Ne=function(){this.Pe=!0,this.Re=!0},to),$i=(Zi.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof eu?this.Le(r,t.Ee):t.Ee instanceof nu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},Zi.prototype.qe=function(n){var r=this;this.Ue(n,function(t){var e=r.Qe(t);switch(n.state){case 0:r.Ke(t)&&e.Ve(n.resumeToken);break;case 1:e.Ce(),e.ge||e.ve(),e.Ve(n.resumeToken);break;case 2:e.Ce(),e.ge||r.removeTarget(t);break;case 3:r.Ke(t)&&(e.Ne(),e.Ve(n.resumeToken));break;case 4:r.Ke(t)&&(r.We(t),e.Ve(n.resumeToken));break;default:xr()}})},Zi.prototype.Ue=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fe.forEach(function(t,e){r.Ke(e)&&n(e)})},Zi.prototype.je=function(t){var e=t.targetId,n=t.Te.count;(t=this.Ge(e))&&(gi(t=t.target)?0===n?(t=new ri(t.path),this.Be(e,t,new nu(t,Zr.min()))):kr(1===n):this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e)))},Zi.prototype.He=function(r){var i=this,o=new Map;this.Fe.forEach(function(t,e){var n=i.Ge(e);n&&(t.le&&gi(n.target)&&(n=new ri(n.target.path),null!==i.Oe.get(n)||i.Je(e,n)||i.Be(e,n,new nu(n,r))),t.ye&&(o.set(e,t.pe()),t.ve()))});var s=Fi();this.Me.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.Ge(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Wi(r,o,this.ke,this.Oe,s);return this.Oe=Li,this.Me=so(),this.ke=new Ri(Hr),t},Zi.prototype.Le=function(t,e){var n;this.Ke(t)&&(n=this.Je(t,e.key)?2:0,this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t)))},Zi.prototype.Be=function(t,e,n){var r;this.Ke(t)&&(r=this.Qe(t),this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n)))},Zi.prototype.removeTarget=function(t){this.Fe.delete(t)},Zi.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},Zi.prototype.De=function(t){this.Qe(t).De()},Zi.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Ji,this.Fe.set(t,e)),e},Zi.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Ri(Hr),this.Me=this.Me.Tt(t,e)),e},Zi.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},Zi.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},Zi.prototype.We=function(e){var n=this;this.Fe.set(e,new Ji),this.xe.Xe(e).forEach(function(t){n.Be(e,t,null)})},Zi.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},Zi);function Zi(t){this.xe=t,this.Fe=new Map,this.Oe=Li,this.Me=so(),this.ke=new Ri(Hr)}function to(){this.Ie=0,this.me=uo(),this.Ae=mi.lt,this.Re=!1,this.Pe=!0}function eo(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}function no(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}function ro(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}function io(){this.Xt=new Ni(ri.$)}function oo(n){this.$=n?function(t,e){return n(t,e)||ri.$(t.key,e.key)}:function(t,e){return ri.$(t.key,e.key)},this.Ht=Ui,this.Jt=new Ni(this.$)}function so(){return new Ni(ri.$)}function uo(){return new Ni(ri.$)}function ao(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function co(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ho(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function lo(t){return t=_o(t.mapValue.fields.__local_write_time__.timestampValue),new $r(t.seconds,t.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:xr()}function vo(r,i){var t,e=yo(r);if(e!==yo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=_o(r.timestampValue),t=_o(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Eo(r.bytesValue).isEqual(Eo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Io(e.integerValue)===Io(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Io(e.doubleValue))===(t=Io(t.doubleValue))?fi(e)===fi(t):isNaN(e)&&isNaN(t));case 9:return Yr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(ao(e)!==ao(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!vo(e[t],n[t])))return!1;return!0}();default:return xr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o=yo(t),s=yo(e);if(o!==s)return Hr(o,s);switch(o){case 0:return 0;case 1:return Hr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Io(t.integerValue||t.doubleValue))<(n=Io(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Hr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Eo(i),s=Eo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Hr(n[i],r[i]);if(0!==o)return o}return Hr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Hr(Io(o.latitude),Io(r.latitude)))?n:Hr(Io(o.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Hr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Hr(r[s],o[s]);if(0!==u)return u;if(0!==(u=mo(n[r[s]],i[o[s]])))return u}return Hr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Hr(t,e);var n=_o(t),t=_o(e);return 0!==(e=Hr(n.seconds,t.seconds))?e:Hr(n.nanos,t.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=_o(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Eo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ri.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):xr();var t,e}(t)}function _o(t){if(kr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=po.exec(t);return kr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Ao(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function Oo(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var xo={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.t=t,this.tn=e};function Ro(t){return{integerValue:""+t}}function Co(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function Lo(t,e){return li(e)?Ro(e):Co(t,e)}function Vo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Uo(t){return kr(!!t),Zr.N((t=_o(t),new $r(t.seconds,t.nanos)))}function jo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).J()}function qo(t){return kr(rs(t=ti.Y(t))),t}function Fo(t,e){return jo(t.t,e.path)}function Bo(t,e){if((e=qo(e)).get(1)!==t.t.projectId)throw new Lr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Lr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ri(Wo(e))}function zo(t,e){return jo(t.t,e)}function Go(t){return 4===(t=qo(t)).length?ti.X():Wo(t)}function Ko(t){return new ti(["projects",t.t.projectId,"databases",t.t.database]).J()}function Wo(t){return kr(4<t.length&&"documents"===t.get(4)),t.B(5)}function Ho(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i;if(e instanceof Rs)n={update:Ho(t,e.key,e.value)};else if(e instanceof Gs)n={delete:Fo(t,e.key)};else if(e instanceof Cs)n={update:Ho(t,e.key,e.data),updateMask:(i=e.en,r=[],i.fields.forEach(function(t){return r.push(t.J())}),{fieldPaths:r})};else if(e instanceof js)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.J(),increment:e.nn};throw xr()})}};else{if(!(e instanceof Ks))return xr();n={verify:Fo(t,e.key)}}return e.rn.sn||(n.currentDocument=void 0!==(i=e.rn).updateTime?{updateTime:Vo(e=t,(t=i.updateTime).M())}:void 0!==i.exists?{exists:i.exists}:xr()),n}function Qo(i,t){var e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?As.updateTime(Uo(o.updateTime)):void 0!==o.exists?As.exists(o.exists):As.on():As.on();if(t.update){t.update.name;var n=Bo(i,t.update.name),r=new Ws({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new _s(o.map(function(t){return ni.nt(t)})));return new Cs(n,r,o,e)}return new Rs(n,r,e)}if(t.delete){var s=Bo(i,t.delete);return new Gs(s,e)}return t.transform?(r=Bo(i,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(kr("REQUEST_TIME"===t.setToServerValue),r=new us):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new as(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new ps(n)):"increment"in t?r=new gs(e,t.increment):xr(),t=ni.nt(t.fieldPath),new Is(t,r);var e,n,r}),kr(!0===e.exists),new js(r,s)):t.verify?(t=Bo(i,t.verify),new Ks(t,e)):xr()}function Xo(t,e){return{documents:[zo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(Oo(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NAN"}};if(Oo(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,ko[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:es(t.field),direction:(t=t.dir,xo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.tn||hi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function $o(t){var e=Go(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return Tu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return Tu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=ns(t.unaryFilter.field),Tu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=ns(t.unaryFilter.field),Tu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Tu.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):xr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new $u(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=hi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ts(n.startAt));var u=null;return n.endAt&&(u=ts(n.endAt)),au(e,i,t,o,r,"F",s,u)}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,t=t.values||[];return new Gu(t,e)}function es(t){return{fieldPath:t.J()}}function ns(t){return ni.nt(t.fieldPath)}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function is(t,e){return t instanceof gs?Ao(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var os,ss,us=(n(hs,ss=h=function(){this.cn=void 0}),hs),as=(n(cs,os=h),cs);function cs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function hs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=h),ds);function ds(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=h),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.nn=e,n}function ws(t){return Io(t.integerValue||t.doubleValue)}function bs(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=(Es.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},Es.prototype.isEqual=function(t){return Yr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Es),Is=function(t,e){this.field=t,this.transform=e};function Es(t){(this.fields=t).sort(ni.$)}function Ts(t,e){this.version=t,this.transformResults=e}var As=(Ns.on=function(){return new Ns},Ns.exists=function(t){return new Ns(void 0,t)},Ns.updateTime=function(t){return new Ns(t)},Object.defineProperty(Ns.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ns.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ns);function Ns(t,e){this.updateTime=t,this.exists=e}function Os(t,e){return void 0!==t.updateTime?e instanceof eu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof eu}function Ss(t,e,n,r){return t instanceof Rs?(o=e,Os((i=t).rn,o)?(o=xs(o),new eu(i.key,o,i.value,{an:!0})):o):t instanceof Cs?function(t,e){if(!Os(t.rn,e))return e;var n=xs(e),e=Ms(t,e);return new eu(t.key,n,e,{an:!0})}(t,e):t instanceof js?function(t,e,n,r){if(!Os(t.rn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof eu&&(h=n.field(a.field)),null===h&&r instanceof eu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof as?fs(c,i):c instanceof ps?ys(c,i):(i=ws(c=is(h=c,i))+ws(h.nn),Ao(c)&&Ao(h.nn)?Ro(i):Co(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Fs(t,i.data(),r);return new eu(t.key,i.version,r,{an:!0})}(t,e,r,n):Os(t.rn,e)?new nu(t.key,Zr.min()):e;var i,o}function Ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||Yr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof as&&e instanceof as||t instanceof ps&&e instanceof ps?Yr(t.elements,e.elements,vo):t instanceof gs&&e instanceof gs?vo(t.nn,e.nn):t instanceof us&&e instanceof us)}))}function xs(t){return t instanceof eu?t.version:Zr.min()}var ks,Ps,Rs=(n(Vs,Ps=ge=function(){}),Vs),Cs=(n(Ls,ks=ge),Ls);function Ls(t,e,n,r){var i=this;return(i=ks.call(this)||this).key=t,i.data=e,i.en=n,i.rn=r,i.type=1,i}function Vs(t,e,n){var r=this;return(r=Ps.call(this)||this).key=t,r.value=e,r.rn=n,r.type=0,r}function Ms(t,e){return n=t,e=e instanceof eu?e.data():Ws.empty(),r=new Hs(e),n.en.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.hn();var n,r}var Us,js=(n(qs,Us=ge),qs);function qs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.rn=As.exists(!0),n}function Fs(t,e,n){for(var r=new Hs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var Bs,zs,Gs=(n(Js,zs=ge),Js),Ks=(n(Xs,Bs=ge),Xs),Ws=(Qs.empty=function(){return new Qs({mapValue:{}})},Qs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},Qs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Qs),Hs=(Ys.prototype.set=function(t,e){return this.fn(t,e),this},Ys.prototype.delete=function(t){return this.fn(t,null),this},Ys.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.K(),e)},Ys.prototype.hn=function(){var t=this.dn(ni.X(),this._n);return null!=t?new Ws(t):this.ln},Ys.prototype.dn=function(r,t){var i=this,o=!1,e=this.ln.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.dn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ys);function Ys(t){void 0===t&&(t=Ws.empty()),this.ln=t,this._n=new Map}function Qs(t){this.proto=t}function Xs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.rn=e,n.type=4,n}function Js(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.rn=e,n.type=3,n}var $s,Zs,tu,eu=(n(uu,tu=me=function(t,e){this.key=t,this.version=e}),uu.prototype.field=function(t){return this.wn.field(t)},uu.prototype.data=function(){return this.wn},uu.prototype.En=function(){return this.wn.proto},uu.prototype.isEqual=function(t){return t instanceof uu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},uu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu),nu=(n(su,Zs=me),su.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su),ru=(n(ou,$s=me),ou.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ou.prototype.isEqual=function(t){return t instanceof ou&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ou),iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function ou(){return null!==$s&&$s.apply(this,arguments)||this}function su(t,e,n){var r=this;return(r=Zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function uu(t,e,n,r){var i=this;return(i=tu.call(this,t,e)||this).wn=n,i.an=!!r.an,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function au(t,e,n,r,i,o,s,u){return new iu(t,e,n,r,i,o,s,u)}function cu(t){return new iu(t)}function hu(t){return!hi(t.limit)&&"F"===t.limitType}function fu(t){return!hi(t.limit)&&"L"===t.limitType}function lu(t){return 0<t.Tn.length?t.Tn[0].field:null}function pu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function du(t){return null!==t.collectionGroup}function yu(t){var e=t;if(null===e.In){e.In=[];var n=pu(e),t=lu(e);if(null!==n&&null===t)n.tt()||e.In.push(new $u(n)),e.In.push(new $u(ni.et(),"asc"));else{for(var r=!1,i=0,o=e.Tn;i<o.length;i++){var s=o[i];e.In.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.Tn.length?e.Tn[e.Tn.length-1].dir:"asc",e.In.push(new $u(ni.et(),n)))}}return e.In}function vu(t){var e=t;if(!e.mn)if("F"===e.limitType)e.mn=di(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new $u(o.field,s))}var u=e.endAt?new Gu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Gu(e.startAt.position,!e.startAt.before):null;e.mn=di(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.mn}function gu(t,e,n){return new iu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return vi(vu(t),vu(e))&&t.limitType===e.limitType}function wu(t){return yi(vu(t))+"|lt:"+t.limitType}function bu(t){return"Query(target="+(n=(e=vu(t)).path.J(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.J()+" "+t.op+" "+bo(t.value)}).join(", ")+"]"),hi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.J()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Qu(e.startAt)),e.endAt&&(n+=", endAt: "+Qu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function _u(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.j(n):ri.ot(e.path)?e.path.isEqual(n):e.path.G(n))&&function(t){for(var e=0,n=i.Tn;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Xu(t.startAt,yu(t),n))&&(!t.endAt||!Xu(t.endAt,yu(t),n)));var e,n}function Iu(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?ri.$(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?mo(e,r):xr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Eu,Tu=(n(Au,Eu=function(){}),Au.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,n):new Du(t,e,n):"array-contains"===e?new qu(t,n):"in"===e?new Fu(t,n):"not-in"===e?new Bu(t,n):"array-contains-any"===e?new zu(t,n):new Au(t,e,n)},Au.Rn=function(t,e,n){return new("in"===e?xu:ku)(t,n)},Au.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pn(mo(t,this.value)):null!==t&&yo(this.value)===yo(t)&&this.Pn(mo(t,this.value))},Au.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return xr()}},Au.prototype.An=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Au);function Au(t,e,n){var r=this;return(r=Eu.call(this)||this).field=t,r.op=e,r.value=n,r}var Nu,Ou,Su,Du=(n(Cu,Su=Tu),Cu.prototype.matches=function(t){return t=ri.$(t.key,this.key),this.Pn(t)},Cu),xu=(n(Ru,Ou=Tu),Ru.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ru),ku=(n(Pu,Nu=Tu),Pu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Pu);function Pu(t,e){var n=this;return(n=Nu.call(this,t,"not-in",e)||this).keys=Lu(0,e),n}function Ru(t,e){var n=this;return(n=Ou.call(this,t,"in",e)||this).keys=Lu(0,e),n}function Cu(t,e,n){var r=this;return(r=Su.call(this,t,e,n)||this).key=ri.it(n.referenceValue),r}function Lu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ri.it(t.referenceValue)})}var Vu,Mu,Uu,ju,qu=(n(Yu,ju=Tu),Yu.prototype.matches=function(t){return No(t=t.field(this.field))&&go(t.arrayValue,this.value)},Yu),Fu=(n(Hu,Uu=Tu),Hu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&go(this.value.arrayValue,t)},Hu),Bu=(n(Wu,Mu=Tu),Wu.prototype.matches=function(t){return!go(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!go(this.value.arrayValue,t))},Wu),zu=(n(Ku,Vu=Tu),Ku.prototype.matches=function(t){var e=this;return!(!No(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Ku),Gu=function(t,e){this.position=t,this.before=e};function Ku(t,e){return Vu.call(this,t,"array-contains-any",e)||this}function Wu(t,e){return Mu.call(this,t,"not-in",e)||this}function Hu(t,e){return Uu.call(this,t,"in",e)||this}function Yu(t,e){return ju.call(this,t,"array-contains",e)||this}function Qu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Xu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ri.$(ri.it(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ju(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var $u=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Zu=(aa.prototype.yn=function(t,e,n){for(var r,i,o,s,u,a=n.Vn,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof Rs?new eu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Cs?(u=i,h=o,Os((s=r).rn,u)?(u=Ms(s,u),new eu(s.key,h.version,u,{hasCommittedMutations:!0})):new ru(s.key,h.version)):r instanceof js?function(t,e,n){if(kr(null!=n.transformResults),!Os(t.rn,e))return new ru(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof eu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof as?fs(o,s):o instanceof ps?ys(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Fs(t,r.data(),e);return new eu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new nu(r.key,o.version,{hasCommittedMutations:!0}))}return e},aa.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ss(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ss(a,e,o,this.gn))}return e},aa.prototype.vn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.pn(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},aa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Fi())},aa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Yr(this.mutations,t.mutations,Ds)&&Yr(this.baseMutations,t.baseMutations,Ds)},aa),ta=(ua.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=ji,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new ua(t,e,n,r)},ua),ea=(sa.prototype.get=function(t){var e=this.Dn(t);if(void 0!==(e=this.Nn[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.Cn(i,t))return o}},sa.prototype.has=function(t){return void 0!==this.get(t)},sa.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},sa.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},sa.prototype.forEach=function(s){co(this.Nn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},sa.prototype.W=function(){return ho(this.Nn)},sa),na=(oa.prototype.catch=function(t){return this.next(void 0,t)},oa.prototype.next=function(r,i){var o=this;return this.Mn&&xr(),this.Mn=!0,this.On?this.error?this.kn(i,this.error):this.$n(r,this.result):new oa(function(e,n){o.xn=function(t){o.$n(r,t).next(e,n)},o.Fn=function(t){o.kn(i,t).next(e,n)}})},oa.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},oa.prototype.Bn=function(t){try{var e=t();return e instanceof oa?e:oa.resolve(e)}catch(t){return oa.reject(t)}},oa.prototype.$n=function(t,e){return t?this.Bn(function(){return t(e)}):oa.resolve(e)},oa.prototype.kn=function(t,e){return t?this.Bn(function(){return t(e)}):oa.reject(e)},oa.resolve=function(n){return new oa(function(t,e){t(n)})},oa.reject=function(n){return new oa(function(t,e){e(n)})},oa.qn=function(t){return new oa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},oa.Un=function(t){for(var n=oa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?oa.resolve(t):e()})}(r[e]);return n},oa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},oa),h=(ia.prototype.Wn=function(t){return(t=this.Qn.get(t))?t.readTime:Zr.min()},ia.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},ia.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},ia.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?na.resolve(n.zn):this.Yn(t,e)},ia.prototype.getEntries=function(t,e){return this.Xn(t,e)},ia.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},ia.prototype.Gn=function(){},ia),ra=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ia(){this.Qn=new ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}function oa(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}function sa(t,e){this.Dn=t,this.Cn=e,this.Nn={}}function ua(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}function aa(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}function ca(t){return new Po(t,!0)}function ha(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var fa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ge=(ma.prototype.es=function(t){this.ts.push(t)},ma.prototype.ns=function(){this.ts.forEach(function(t){return t()})},ma),la=(ga.prototype.cs=function(e,n){var r=this;return this.rs.us(e,n).next(function(t){return r.hs(e,n,t)})},ga.prototype.hs=function(t,r,i){return this.ss.Jn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].pn(r,t);return t})},ga.prototype.ls=function(t,e,i){var o=Li;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].pn(t,e);o=o.Tt(t,e)}),o},ga.prototype._s=function(e,t){var n=this;return this.ss.getEntries(e,t).next(function(t){return n.fs(e,t)})},ga.prototype.fs=function(e,r){var i=this;return this.rs.ds(e,r).next(function(t){var t=i.ls(e,r,t),n=Li;return t.forEach(function(t,e){e=e||new nu(t,Zr.min()),n=n.Tt(t,e)}),n})},ga.prototype.ws=function(t,e,n){return r=e,ri.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Es(t,e.path):du(e)?this.Ts(t,e,n):this.Is(t,e,n);var r},ga.prototype.Es=function(t,e){return this.cs(t,new ri(e)).next(function(t){var e=Ui;return t instanceof eu&&(e=e.Tt(t.key,t)),e})},ga.prototype.Ts=function(n,r,i){var o=this,s=r.collectionGroup,u=Ui;return this.os.As(n,s).next(function(t){return na.forEach(t,function(t){var e=(e=r,t=t.child(s),new iu(t,null,e.Tn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Is(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},ga.prototype.Is=function(e,n,t){var a,c,r=this;return this.ss.ws(e,n,t).next(function(t){return a=t,r.rs.Rs(e,n)}).next(function(t){return c=t,r.Ps(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Ss(s,s=a.get(u),s,r.gn);a=s instanceof eu?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){_u(n,e)||(a=a.remove(t))}),a})},ga.prototype.Ps=function(t,e,n){for(var r=Fi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof eu&&(c=c.Tt(t,e))}),c})},ga),pa=(va.Vs=function(t,e){for(var n=Fi(),r=Fi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new va(t,e.fromCache,n,r)},va),da=(ya.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ya.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},ya);function ya(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}function va(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}function ga(t,e,n){this.ss=t,this.rs=e,this.os=n}function ma(){this.ts=[]}da.Ds=-1;var wa,ba=(Oa.prototype.reset=function(){this.Ms=0},Oa.prototype.Ls=function(){this.Ms=this.Os},Oa.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},Oa.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},Oa.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},Oa.prototype.qs=function(){return(Math.random()-.5)*this.Ms},Oa),_a=(Na.delete=function(t){return Nr("SimpleDb","Removing database:",t),Ra(window.indexedDB.deleteDatabase(t)).Ln()},Na.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(Na.zs())return!0;var t=p(),e=0<(n=Na.js(t))&&n<10,n=0<(n=Na.Hs(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Na.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},Na.Ys=function(t,e){return t.store(e)},Na.js=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Na.Hs=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Na.prototype.Xs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Nr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Ea(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Lr(Cr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Ea(o,t))},r.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Nr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return i.Zs(t)}),this.db)]}})})},Na.prototype.ti=function(e){this.Zs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Na.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Xs(u)];case 2:return s.db=t.sent(),e=Da.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),na.reject(t)}).Ln(),r={},n.catch(function(){}),[4,e.ei];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Nr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Na.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Na),Ia=(Object.defineProperty(Aa.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),Aa.prototype.done=function(){this.si=!0},Aa.prototype.oi=function(t){this.ii=t},Aa.prototype.delete=function(){return Ra(this.ni.delete())},Aa),Ea=(n(Ta,wa=Lr),Ta);function Ta(t,e){var n=this;return(n=wa.call(this,Cr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Aa(t){this.ni=t,this.si=!1,this.ii=null}function Na(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===Na.js(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Oa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}function Sa(t){return"IndexedDbTransactionError"===t.name}var Da=(Pa.open=function(t,e,n,r){try{return new Pa(e,t.transaction(r,n))}catch(t){throw new Ea(e,t)}},Object.defineProperty(Pa.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),Pa.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Pa.prototype.store=function(t){return t=this.transaction.objectStore(t),new xa(t)},Pa),xa=(ka.prototype.put=function(t,e){return Ra(t=void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ka.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),Ra(this.store.add(t))},ka.prototype.get=function(e){var n=this;return Ra(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Nr("SimpleDb","GET",n.store.name,e,t),t})},ka.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),Ra(this.store.delete(t))},ka.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),Ra(this.store.count())},ka.prototype.ui=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ai(e,function(t,e){n.push(e)}).next(function(){return n})},ka.prototype.hi=function(t,e){return Nr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).li=!1,e=this.cursor(e),this.ai(e,function(t,e,n){return n.delete()})},ka.prototype._i=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ai(n,e)},ka.prototype.fi=function(r){var t=this.cursor({});return new na(function(n,e){t.onerror=function(t){t=La(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ka.prototype.ai=function(t,i){var o=[];return new na(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Ia(n),(t=i(n.primaryKey,n.value,e))instanceof na&&(t=t.catch(function(t){return e.done(),na.reject(t)}),o.push(t)),e.On?r():null===e.ri?n.continue():n.continue(e.ri)):r()}}).next(function(){return na.qn(o)})},ka.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ka.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ka);function ka(t){this.store=t}function Pa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ci=new ra,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){t.error?n.ci.reject(new Ea(e,t.error)):n.ci.resolve()},this.transaction.onerror=function(t){t=La(t.target.error),n.ci.reject(new Ea(e,t))}}function Ra(t){return new na(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=La(t.target.error),n(t)}})}var Ca=!1;function La(t){var e=_a.js(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Lr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ca||(Ca=!0,setTimeout(function(){throw n},0)),n}return t}function Va(){return"undefined"!=typeof window?window:null}function Ma(){return"undefined"!=typeof document?document:null}var Ua=(Fa.Ii=function(t,e,n,r,i){return(i=new Fa(t,e,Date.now()+n,r,i)).start(n),i},Fa.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},Fa.prototype.Ks=function(){return this.Ai()},Fa.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Lr(Cr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Fa.prototype.Ai=function(){var e=this;this.di.Ri(function(){return null!==e.mi?(e.clearTimeout(),e.op().then(function(t){return e.Ti.resolve(t)})):Promise.resolve()})},Fa.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},Fa),ja=(Object.defineProperty(qa.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),qa.prototype.Ri=function(t){this.enqueue(t)},qa.prototype.Ni=function(t){this.xi(),this.Fi(t)},qa.prototype.Oi=function(){var t;this.yi||(this.yi=!0,(t=Ma())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di))},qa.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},qa.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},qa.prototype.ki=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.gi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return t.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Sa(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.gi.length&&this.Si.Bs(function(){return n.ki()}),t.label=5;case 5:return[2]}})})},qa.prototype.Fi=function(t){var r=this,e=this.Pi.then(function(){return r.vi=!0,t().catch(function(t){throw r.pi=t,r.vi=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.vi=!1,t})});return this.Pi=e},qa.prototype.Us=function(t,e,n){var r=this;return this.xi(),-1<this.bi.indexOf(t)&&(e=0),n=Ua.Ii(this,t,e,n,function(t){return r.$i(t)}),this.Vi.push(n),n},qa.prototype.xi=function(){this.pi&&xr()},qa.prototype.Li=function(){},qa.prototype.Bi=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Pi];case 1:t.sent(),t.label=2;case 2:if(e!==this.Pi)return[3,0];t.label=3;case 3:return[2]}})})},qa.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},qa.prototype.Ui=function(r){var i=this;return this.Bi().then(function(){i.Vi.sort(function(t,e){return t.wi-e.wi});for(var t=0,e=i.Vi;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ns===r)break}return i.Bi()})},qa.prototype.Qi=function(t){this.bi.push(t)},qa.prototype.$i=function(t){t=this.Vi.indexOf(t),this.Vi.splice(t,1)},qa);function qa(){var e=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new ba(this,"async_queue_retry"),this.Di=function(){var t=Ma();t&&Nr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Si.Qs()};var t=Ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}function Fa(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new ra,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}function Ba(t,e){if(Or("AsyncQueue",e+": "+t),Sa(t))return new Lr(Cr.UNAVAILABLE,e+": "+t);throw t}function za(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Hr(n,t))?Hr(r,e):t}var Ga=(Ya.prototype.ji=function(){return++this.Wi},Ya.prototype.Gi=function(t){var e=[t,this.ji()];this.buffer.size<this.Ki?this.buffer=this.buffer.add(e):za(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Ya.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Ya),Ka={zi:!1,Hi:0,Ji:0,Yi:0},Wa=(Ha.er=function(t){return new Ha(t,Ha.nr,Ha.sr)},Ha);function Ha(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}function Ya(t){this.Ki=t,this.buffer=new Ri(za),this.Wi=0}Wa.nr=10,Wa.sr=1e3,Wa.ir=new Wa(41943040,Wa.nr,Wa.sr),Wa.rr=new Wa(-1,0,0);var Qa=($a.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},$a.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty($a.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),$a.prototype.hr=function(n){var t=this,e=this.ur?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ar=this.di.Us("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.ar=null,this.ur=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n._r(this.cr)];case 2:return t.sent(),[3,7];case 3:return Sa(e=t.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Vh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.hr(n)];case 8:return t.sent(),[2]}})})})},$a),Xa=(Ja.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},Ja.prototype.Tr=function(t,e){var n=this;if(0===e)return na.resolve(da.Ds);var r=new Ga(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},Ja.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},Ja.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},Ja.prototype.Rr=function(e,n){var r=this;return-1===this.params.Xi?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),na.resolve(Ka)):this.Pr(e).next(function(t){return t<r.params.Xi?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Xi),Ka):r.gr(e,n)})},Ja.prototype.Pr=function(t){return this.dr.Pr(t)},Ja.prototype.gr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.wr(e,this.params.Zi).next(function(t){return i=t>h.params.tr?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+t),h.params.tr):t,s=Date.now(),h.Tr(e,i)}).next(function(t){return r=t,u=Date.now(),h.mr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Ar(e,r)}).next(function(t){return c=Date.now(),Ar()<=l.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),na.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},Ja);function Ja(t,e){this.dr=t,this.params=e}function $a(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}function Za(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=tc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return tc(o)}function tc(t){return t+""}function ec(t){var e=t.length;if(kr(2<=e),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),ti.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&xr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:xr()}o=s+2}return new ti(r)}var nc=function(t){this.yr=t};function rc(t,e){if(e.document)return n=t.yr,r=e.document,i=!!e.hasCommittedMutations,t=Bo(n,r.name),n=Uo(r.updateTime),r=new Ws({mapValue:{fields:r.fields}}),new eu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ri.ct(e.noDocument.path),o=ac(e.noDocument.readTime);return new nu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=ri.ct(e.unknownDocument.path),e=ac(e.unknownDocument.version),new ru(o,e)):xr()}function ic(t,e,n){var r=oc(n),n=e.key.path.q().H();if(e instanceof eu){var i={name:Fo(i=t.yr,(o=e).key),fields:o.En().mapValue.fields,updateTime:Vo(i,o.version.M())},o=e.hasCommittedMutations;return new zc(null,null,i,o,r,n)}if(e instanceof nu){var i=e.key.path.H(),o=uc(e.version),s=e.hasCommittedMutations;return new zc(null,new Fc(i,o),null,s,r,n)}return e instanceof ru?(s=e.key.path.H(),e=uc(e.version),new zc(new Bc(s,e),null,null,!0,r,n)):xr()}function oc(t){return[(t=t.M()).seconds,t.nanoseconds]}function sc(t){return t=new $r(t[0],t[1]),Zr.N(t)}function uc(t){return t=t.M(),new Pc(t.seconds,t.nanoseconds)}function ac(t){return t=new $r(t.seconds,t.nanoseconds),Zr.N(t)}function cc(e,t){var n=(t.baseMutations||[]).map(function(t){return Qo(e.yr,t)}),r=t.mutations.map(function(t){return Qo(e.yr,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new Zu(t.batchId,i,n,r)}function hc(t){var e=ac(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ac(t.lastLimboFreeSnapshotVersion):Zr.min(),r=void 0!==t.query.documents?(kr(1===(r=t.query).documents.length),vu(cu(Go(r.documents[0])))):vu($o(t.query));return new Ii(r,t.targetId,0,t.lastListenSequenceNumber,e,n,mi.fromBase64String(t.resumeToken))}function fc(t,e){var n=uc(e.ft),r=uc(e.lastLimboFreeSnapshotVersion),i=(gi(e.target)?Xo:Jo)(t.yr,e.target),t=e.resumeToken.toBase64();return new Kc(e.targetId,yi(e.target),n,t,e.sequenceNumber,r,i)}function lc(t){var e=$o({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?gu(e,e.limit,"L"):e}var pc=(dc.vr=function(t,e,n,r){return kr(""!==t.uid),new dc(t.u()?t.uid:"",e,n,r)},dc.prototype.br=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gc(t)._i({index:Uc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},dc.prototype.Sr=function(d,y,v,g){var m=this,w=mc(d),b=gc(d);return b.add({}).next(function(t){kr("number"==typeof t);for(var e,n,r,i,o,s=new Zu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Yo(e.yr,t)}),o=r.mutations.map(function(t){return Yo(e.yr,t)}),new Uc(n,r.batchId,r.gn.toMillis(),i,o)),a=[],c=new Ri(function(t,e){return Hr(t.J(),e.J())}),h=0,f=g;h<f.length;h++){var l=f[h],p=jc.key(m.userId,l.key.path,t),c=c.add(l.key.path.q());a.push(b.put(u)),a.push(w.put(p,jc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.os.Dr(d,t))}),d.es(function(){m.pr[t]=s.keys()}),na.qn(a).next(function(){return s})})},dc.prototype.Cr=function(t,e){var n=this;return gc(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),cc(n.serializer,t)):null})},dc.prototype.Nr=function(t,e){var n=this;return this.pr[e]?na.resolve(this.pr[e]):this.Cr(t,e).next(function(t){return t?(t=t.keys(),n.pr[e]=t):null})},dc.prototype.Fr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return gc(t)._i({index:Uc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(kr(e.batchId>=i),o=cc(r.serializer,e)),n.done()}).next(function(){return o})},dc.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return gc(t)._i({index:Uc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},dc.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gc(t).ui(Uc.userMutationsIndex,n).next(function(t){return t.map(function(t){return cc(e.serializer,t)})})},dc.prototype.us=function(o,s){var u=this,t=jc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return mc(o)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ec(i);if(r===u.userId&&s.path.isEqual(i))return gc(o).get(t).next(function(t){if(!t)throw xr();kr(t.userId===u.userId),a.push(cc(u.serializer,t))});n.done()}).next(function(){return a})},dc.prototype.ds=function(e,t){var s=this,u=new Ri(Hr),n=[];return t.forEach(function(o){var t=jc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=mc(e)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ec(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),na.qn(n).next(function(){return s.kr(e,u)})},dc.prototype.Rs=function(t,e){var o=this,s=e.path,u=s.length+1,e=jc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Ri(Hr);return mc(t)._i({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ec(i);r===o.userId&&s.j(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.kr(t,a)})},dc.prototype.kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(gc(e).get(t).next(function(t){if(null===t)throw xr();kr(t.userId===n.userId),r.push(cc(n.serializer,t))}))}),na.qn(i).next(function(){return r})},dc.prototype.$r=function(e,n){var r=this;return vc(e.Lr,this.userId,n).next(function(t){return e.es(function(){r.Br(n.batchId)}),na.forEach(t,function(t){return r.Vr.qr(e,t)})})},dc.prototype.Br=function(t){delete this.pr[t]},dc.prototype.Ur=function(e){var i=this;return this.br(e).next(function(t){if(!t)return na.resolve();var t=IDBKeyRange.lowerBound(jc.prefixForUser(i.userId)),r=[];return mc(e)._i({range:t},function(t,e,n){t[0]===i.userId?(t=ec(t[1]),r.push(t)):n.done()}).next(function(){kr(0===r.length)})})},dc.prototype.Qr=function(t,e){return yc(t,this.userId,e)},dc.prototype.Kr=function(t){var e=this;return wc(t).get(this.userId).next(function(t){return t||new Mc(e.userId,-1,"")})},dc);function dc(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}function yc(t,o,e){var s=(e=jc.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return mc(t)._i({range:e,li:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function vc(t,e,n){var r=t.store(Uc.store),i=t.store(jc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r._i({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){kr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=jc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return na.qn(o).next(function(){return u})}function gc(t){return gh.Ys(t,Uc.store)}function mc(t){return gh.Ys(t,jc.store)}function wc(t){return gh.Ys(t,Mc.store)}var bc,_c=(Tc.prototype.jn=function(t,e,n){return Nc(t).put(Oc(e),n)},Tc.prototype.Hn=function(t,e){return t=Nc(t),e=Oc(e),t.delete(e)},Tc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Wr(e,t)})},Tc.prototype.Jn=function(t,e){var n=this;return Nc(t).get(Oc(e)).next(function(t){return n.jr(t)})},Tc.prototype.Gr=function(t,e){var n=this;return Nc(t).get(Oc(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Sc(t)}:null})},Tc.prototype.getEntries=function(t,e){var n=this,r=Li;return this.zr(t,e,function(t,e){e=n.jr(e),r=r.Tt(t,e)}).next(function(){return r})},Tc.prototype.Hr=function(t,e){var r=this,i=Li,o=new Ni(ri.$);return this.zr(t,e,function(t,e){var n=r.jr(e);o=n?(i=i.Tt(t,n),o.Tt(t,Sc(e))):(i=i.Tt(t,null),o.Tt(t,0))}).next(function(){return{Jr:i,Yr:o}})},Tc.prototype.zr=function(t,e,i){if(e.W())return na.resolve();var n=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),o=e.yt(),s=o.Ct();return Nc(t)._i({range:n},function(t,e,n){for(var r=ri.ct(t);s&&ri.$(s,r)<0;)i(s,null),s=o.Ct();s&&s.isEqual(r)&&(i(s,e),s=o.Nt()?o.Ct():null),s?n.oi(s.path.H()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Nt()?o.Ct():null})},Tc.prototype.ws=function(t,r,e){var n,i=this,o=Ui,s=r.path.length+1,u={};return e.isEqual(Zr.min())?(n=r.path.H(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.H(),e=oc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=zc.collectionReadTimeIndex),Nc(t)._i(u,function(t,e,n){t.length===s&&(e=rc(i.serializer,e),r.path.j(e.key.path)?e instanceof eu&&_u(r,e)&&(o=o.Tt(e.key,e)):n.done())}).next(function(){return o})},Tc.prototype.Xr=function(t){return new Ic(this,!!t&&t.Zr)},Tc.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Tc.prototype.getMetadata=function(t){return Ac(t).get(Gc.key).next(function(t){return kr(!!t),t})},Tc.prototype.Wr=function(t,e){return Ac(t).put(Gc.key,e)},Tc.prototype.jr=function(t){return!t||(t=rc(this.serializer,t))instanceof nu&&t.version.isEqual(Zr.min())?null:t},Tc),Ic=(n(Ec,bc=h),Ec.prototype.Zn=function(i){var o=this,s=[],u=0,a=new Ri(function(t,e){return Hr(t.J(),e.J())});return this.Qn.forEach(function(t,e){var n,r=o.so.get(t);e.zn?(n=ic(o.no.serializer,e.zn,o.Wn(t)),a=a.add(t.path.q()),e=Sc(n),u+=e-r,s.push(o.no.jn(i,t,n))):(u-=r,o.Zr?(r=ic(o.no.serializer,new nu(t,Zr.min()),o.Wn(t)),s.push(o.no.jn(i,t,r))):s.push(o.no.Hn(i,t)))}),a.forEach(function(t){s.push(o.no.os.Dr(i,t))}),s.push(this.no.updateMetadata(i,u)),na.qn(s)},Ec.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},Ec.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},Ec);function Ec(t,e){var n=this;return(n=bc.call(this)||this).no=t,n.Zr=e,n.so=new ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Tc(t,e){this.serializer=t,this.os=e}function Ac(t){return gh.Ys(t,Gc.store)}function Nc(t){return gh.Ys(t,zc.store)}function Oc(t){return t.path.H()}function Sc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xr();e=t.noDocument}return JSON.stringify(e).length}var Dc=(Vc.prototype.Dr=function(t,e){return this.io.add(e),na.resolve()},Vc.prototype.As=function(t,e){return na.resolve(this.io.getEntries(e))},Vc),xc=(Lc.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Ri(ti.$),t=!r.has(n);return this.index[e]=r.add(n),t},Lc.prototype.has=function(t){var e=t.K(),t=t.q();return(e=this.index[e])&&e.has(t)},Lc.prototype.getEntries=function(t){return(this.index[t]||new Ri(ti.$)).H()},Lc),kc=(Cc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;kr(t<r&&0<=t&&r<=11);var o=new Da("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Rc.store),(s=e).createObjectStore(Mc.store,{keyPath:Mc.keyPath}),s.createObjectStore(Uc.store,{keyPath:Uc.keyPath,autoIncrement:!0}).createIndex(Uc.userMutationsIndex,Uc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(jc.store),Qc(e),e.createObjectStore(zc.store));var s,u=na.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Wc.store),s.deleteObjectStore(Kc.store),s.deleteObjectStore(Hc.store),Qc(e)),u=u.next(function(){return t=o.store(Hc.store),e=new Hc(0,0,Zr.min().M(),0),t.put(Hc.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Uc.store).ui().next(function(t){n.deleteObjectStore(Uc.store),n.createObjectStore(Uc.store,{keyPath:Uc.keyPath,autoIncrement:!0}).createIndex(Uc.userMutationsIndex,Uc.userMutationsKeyPath,{unique:!0});var e=r.store(Uc.store),t=t.map(function(t){return e.put(t)});return na.qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(Xc.store,{keyPath:Xc.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Gc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(zc.store)).createIndex(zc.readTimeIndex,zc.readTimeIndexPath,{unique:!1}),t.createIndex(zc.collectionReadTimeIndex,zc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(Jc.store,{keyPath:Jc.keyPath}),e.createObjectStore($c.store,{keyPath:$c.keyPath})})),u},Cc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(zc.store)._i(function(t,e){n+=Sc(e)}).next(function(){var t=new Gc(n);return e.store(Gc.store).put(Gc.key,t)})},Cc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Mc.store),i=n.store(Uc.store);return t.ui().next(function(t){return na.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ui(Uc.userMutationsIndex,t).next(function(t){return na.forEach(t,function(t){return kr(t.userId===e.userId),t=cc(r.serializer,t),vc(n,e.userId,t).next(function(){})})})})})},Cc.prototype.ensureSequenceNumbers=function(t){var o=t.store(Wc.store),e=t.store(zc.store);return t.store(Hc.store).get(Hc.key).next(function(r){var i=[];return e._i(function(t,e){var n=new ti(t),t=[0,Za(n)];i.push(o.get(t).next(function(t){return t?na.resolve():o.put(new Wc(0,Za(n),r.highestListenSequenceNumber))}))}).next(function(){return na.qn(i)})})},Cc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.K(),t=t.q();return n.put({collectionId:e,parent:Za(t)})}}t.createObjectStore(Yc.store,{keyPath:Yc.keyPath});var n=e.store(Yc.store),i=new xc;return e.store(zc.store)._i({li:!0},function(t,e){return r((t=new ti(t)).q())}).next(function(){return e.store(jc.store)._i({li:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],ec(n))).q())})})},Cc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Kc.store);return r._i(function(t,e){return e=hc(e),e=fc(n.serializer,e),r.put(e)})},Cc),Pc=function(t,e){this.seconds=t,this.nanoseconds=e},Rc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Cc(t){this.serializer=t}function Lc(){this.index={}}function Vc(){this.io=new xc}Rc.store="owner",Rc.key="owner";var Mc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Mc.store="mutationQueues",Mc.keyPath="userId";var Uc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Uc.store="mutations",Uc.keyPath="batchId",Uc.userMutationsIndex="userMutationsIndex",Uc.userMutationsKeyPath=["userId","batchId"];var jc=(qc.prefixForUser=function(t){return[t]},qc.prefixForPath=function(t,e){return[t,Za(e)]},qc.key=function(t,e,n){return[t,Za(e),n]},qc);function qc(){}jc.store="documentMutations",jc.PLACEHOLDER=new jc;var Fc=function(t,e){this.path=t,this.readTime=e},Bc=function(t,e){this.path=t,this.version=e},zc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zc.store="remoteDocuments",zc.readTimeIndex="readTimeIndex",zc.readTimeIndexPath="readTime",zc.collectionReadTimeIndex="collectionReadTimeIndex",zc.collectionReadTimeIndexPath=["parentPath","readTime"];var Gc=function(t){this.byteSize=t};Gc.store="remoteDocumentGlobal",Gc.key="remoteDocumentGlobalKey";var Kc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Kc.store="targets",Kc.keyPath="targetId",Kc.queryTargetsIndexName="queryTargetsIndex",Kc.queryTargetsKeyPath=["canonicalId","targetId"];var Wc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Wc.store="targetDocuments",Wc.keyPath=["targetId","path"],Wc.documentTargetsIndex="documentTargetsIndex",Wc.documentTargetsKeyPath=["path","targetId"];var Hc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Hc.key="targetGlobalKey",Hc.store="targetGlobal";var Yc=function(t,e){this.collectionId=t,this.parent=e};function Qc(t){t.createObjectStore(Wc.store,{keyPath:Wc.keyPath}).createIndex(Wc.documentTargetsIndex,Wc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Kc.store,{keyPath:Kc.keyPath}).createIndex(Kc.queryTargetsIndexName,Kc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Hc.store)}Yc.store="collectionParents",Yc.keyPath=["collectionId","parent"];var Xc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Xc.store="clientMetadata",Xc.keyPath="clientId";var Jc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Jc.store="bundles",Jc.keyPath="bundleId";var $c=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};$c.store="namedQueries",$c.keyPath="name";var Zc=s(s(s(s([Mc.store,Uc.store,jc.store,zc.store,Kc.store,Rc.store,Hc.store,Wc.store],[Xc.store]),[Gc.store]),[Yc.store]),[Jc.store,$c.store]),th=(eh.prototype.ro=function(t,e){return nh(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:ac(t.createTime),version:t.version}})},eh.prototype.oo=function(t,e){return nh(t).put({bundleId:e.id,createTime:uc(Uo(e.createTime)),version:e.version})},eh.prototype.co=function(t,e){return rh(t).get(e).next(function(t){if(t)return{name:t.name,query:lc(t.bundledQuery),readTime:ac(t.readTime)}})},eh.prototype.uo=function(t,e){return rh(t).put({name:e.name,readTime:uc(Uo(e.readTime)),bundledQuery:e.bundledQuery})},eh);function eh(t){this.serializer=t}function nh(t){return gh.Ys(t,Jc.store)}function rh(t){return gh.Ys(t,$c.store)}var ih=(oh.prototype.Dr=function(t,e){var n=this;if(this.ao.has(e))return na.resolve();var r=e.K(),i=e.q();return t.es(function(){n.ao.add(e)}),i={collectionId:r,parent:Za(i)},sh(t).put(i)},oh.prototype.As=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Qr(i),""],!1,!0);return sh(t).ui(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ec(r.parent))}return o})},oh);function oh(){this.ao=new xc}function sh(t){return gh.Ys(t,Yc.store)}var uh=(hh.prototype.next=function(){return this.ho+=2,this.ho},hh.lo=function(){return new hh(0)},hh._o=function(){return new hh(-1)},hh),ah=(ch.prototype.fo=function(n){var r=this;return this.wo(n).next(function(t){var e=new uh(t.highestTargetId);return t.highestTargetId=e.next(),r.Eo(n,t).next(function(){return t.highestTargetId})})},ch.prototype.To=function(t){return this.wo(t).next(function(t){return Zr.N(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ch.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},ch.prototype.mo=function(e,n,r){var i=this;return this.wo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.M()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Eo(e,t)})},ch.prototype.Ao=function(e,n){var r=this;return this.Ro(e,n).next(function(){return r.wo(e).next(function(t){return t.targetCount+=1,r.Po(n,t),r.Eo(e,t)})})},ch.prototype.yo=function(t,e){return this.Ro(t,e)},ch.prototype.Vo=function(e,t){var n=this;return this.po(e,t.targetId).next(function(){return fh(e).delete(t.targetId)}).next(function(){return n.wo(e)}).next(function(t){return kr(0<t.targetCount),--t.targetCount,n.Eo(e,t)})},ch.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return fh(n)._i(function(t,e){(e=hc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Vo(n,e)))}).next(function(){return na.qn(u)}).next(function(){return s})},ch.prototype.Ue=function(t,n){return fh(t)._i(function(t,e){e=hc(e),n(e)})},ch.prototype.wo=function(t){return lh(t).get(Hc.key).next(function(t){return kr(null!==t),t})},ch.prototype.Eo=function(t,e){return lh(t).put(Hc.key,e)},ch.prototype.Ro=function(t,e){return fh(t).put(fc(this.serializer,e))},ch.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ch.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},ch.prototype.bo=function(t,r){var e=yi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return fh(t)._i({range:e,index:Kc.queryTargetsIndexName},function(t,e,n){e=hc(e),vi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},ch.prototype.So=function(n,t,r){var i=this,o=[],s=ph(n);return t.forEach(function(t){var e=Za(t.path);o.push(s.put(new Wc(r,e))),o.push(i.Vr.Do(n,r,t))}),na.qn(o)},ch.prototype.Co=function(n,t,r){var i=this,o=ph(n);return na.forEach(t,function(t){var e=Za(t.path);return na.qn([o.delete([r,e]),i.Vr.No(n,r,t)])})},ch.prototype.po=function(t,e){return t=ph(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},ch.prototype.xo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=ph(t),r=Fi();return t._i({range:e,li:!0},function(t,e,n){t=ec(t[1]),t=new ri(t),r=r.add(t)}).next(function(){return r})},ch.prototype.Qr=function(t,e){var e=Za(e.path),e=IDBKeyRange.bound([e],[Qr(e)],!1,!0),i=0;return ph(t)._i({index:Wc.documentTargetsIndex,li:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ch.prototype.Ze=function(t,e){return fh(t).get(e).next(function(t){return t?hc(t):null})},ch);function ch(t,e){this.Vr=t,this.serializer=e}function hh(t){this.ho=t}function fh(t){return gh.Ys(t,Kc.store)}function lh(t){return gh.Ys(t,Hc.store)}function ph(t){return gh.Ys(t,Wc.store)}var dh,yh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vh=(n(wh,dh=ge),wh),gh=(mh.Ys=function(t,e){if(t instanceof vh)return _a.Ys(t.Lr,e);throw xr()},mh.prototype.start=function(){var e=this;return this.Ho().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Lr(Cr.FAILED_PRECONDITION,yh);return e.Jo(),e.Yo(),e.Xo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.jo.Io(t)})}).then(function(t){e.ko=new da(t,e.Oo)}).then(function(){e.$o=!0}).catch(function(t){return e.Wo&&e.Wo.close(),Promise.reject(t)})},mh.prototype.Zo=function(n){var t=this;return this.Qo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.lr?[2,n(e)]:[2]})})},n(this.isPrimary)},mh.prototype.tc=function(n){var t=this;this.Wo.ti(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},mh.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},mh.prototype.Ho=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return _h(e).put(new Xc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.nc(e).next(function(t){t||(n.isPrimary=!1,n.Cs.Mi(function(){return n.Qo(!1)}))})}).next(function(){return n.sc(e)}).next(function(t){return n.isPrimary&&!t?n.ic(e).next(function(){return!1}):!!t&&n.rc(e).next(function(){return!0})})}).catch(function(t){if(Sa(t))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Cs.Mi(function(){return n.Qo(t)}),n.isPrimary=t})},mh.prototype.nc=function(t){var e=this;return bh(t).get(Rc.key).next(function(t){return na.resolve(e.oc(t))})},mh.prototype.cc=function(t){return _h(t).delete(this.clientId)},mh.prototype.uc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=mh.Ys(t,Xc.store);return r.ui().next(function(t){var e=o.hc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return na.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));t.label=2;case 2:return[2]}})})},mh.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},mh.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},mh.prototype.sc=function(e){var r=this;return this.Mo?na.resolve(!0):bh(e).get(Rc.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r._c(t.ownerId)){if(r.oc(t)&&r.networkEnabled)return!0;if(!r.oc(t)){if(!t.allowTabSynchronization)throw new Lr(Cr.FAILED_PRECONDITION,yh);return!1}}return!(!r.networkEnabled||!r.inForeground)||_h(e).ui().next(function(t){return void 0===r.hc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},mh.prototype.fc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Rc.store,Xc.store],function(t){var e=new vh(t,da.Ds);return n.ic(e).next(function(){return n.cc(e)})})];case 1:return t.sent(),this.Wo.close(),this.Tc(),[2]}})})},mh.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},mh.prototype.Ic=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return _h(t).ui().next(function(t){return e.hc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(mh.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),mh.prototype.mc=function(t){return pc.vr(t,this.serializer,this.os,this.Vr)},mh.prototype.Ac=function(){return this.jo},mh.prototype.Rc=function(){return this.ss},mh.prototype.Pc=function(){return this.os},mh.prototype.gc=function(){return this.Go},mh.prototype.runTransaction=function(e,n,r){var i=this;Nr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wo.runTransaction(e,t,Zc,function(t){return o=new vh(t,i.ko?i.ko.next():da.Ds),"readwrite-primary"===n?i.nc(o).next(function(t){return!!t||i.sc(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new Lr(Cr.FAILED_PRECONDITION,fa);return r(o)}).next(function(t){return i.rc(o).next(function(){return t})}):i.yc(o).next(function(){return r(o)})}).then(function(t){return o.ns(),t})},mh.prototype.yc=function(t){var e=this;return bh(t).get(Rc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Lr(Cr.FAILED_PRECONDITION,yh)})},mh.prototype.rc=function(t){var e=new Rc(this.clientId,this.allowTabSynchronization,Date.now());return bh(t).put(Rc.key,e)},mh.Gs=function(){return _a.Gs()},mh.prototype.ic=function(t){var e=this,n=bh(t);return n.get(Rc.key).next(function(t){return e.oc(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(Rc.key)):na.resolve()})},mh.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},mh.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},mh.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},mh.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},mh.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},mh.prototype._c=function(t){try{var e=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},mh.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},mh.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},mh.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},mh);function mh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=o,this.document=s,this.Oo=a,this.Mo=c,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!mh.Gs())throw new Lr(Cr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new Ih(this,r),this.Ko=e+"main",this.serializer=new nc(u),this.Wo=new _a(this.Ko,11,new kc(this.serializer)),this.jo=new ah(this.Vr,this.serializer),this.os=new ih,this.ss=(e=this.serializer,u=this.os,new _c(e,u)),this.Go=new th(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function wh(t,e){var n=this;return(n=dh.call(this)||this).Lr=t,n.Fo=e,n}function bh(t){return gh.Ys(t,Rc.store)}function _h(t){return gh.Ys(t,Xc.store)}var Ih=(Eh.prototype.Er=function(t){var n=this.Vc(t);return this.db.Ac().vo(t).next(function(e){return n.next(function(t){return e+t})})},Eh.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},Eh.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},Eh.prototype.Ir=function(t,n){return this.vc(t,function(t,e){return n(e)})},Eh.prototype.Do=function(t,e,n){return Th(t,n)},Eh.prototype.No=function(t,e,n){return Th(t,n)},Eh.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},Eh.prototype.qr=Th,Eh.prototype.bc=function(t,e){return r=e,i=!1,wc(n=t).fi(function(t){return yc(n,t,r).next(function(t){return t&&(i=!0),na.resolve(!t)})}).next(function(){return i});var n,r,i},Eh.prototype.Ar=function(n,r){var i=this,o=this.db.Rc().Xr(),s=[],u=0;return this.vc(n,function(e,t){t<=r&&(t=i.bc(n,e).next(function(t){if(!t)return u++,o.Jn(n,e).next(function(){return o.Hn(e),ph(n).delete([0,Za(e.path)])})}),s.push(t))}).next(function(){return na.qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Eh.prototype.removeTarget=function(t,e){return e=e.dt(t.Fo),this.db.Ac().yo(t,e)},Eh.prototype.Sc=Th,Eh.prototype.vc=function(t,r){var i,t=ph(t),o=da.Ds;return t._i({index:Wc.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==da.Ds&&r(new ri(ec(i)),o),o=e,i=t):o=da.Ds}).next(function(){o!==da.Ds&&r(new ri(ec(i)),o)})},Eh.prototype.Pr=function(t){return this.db.Rc().eo(t)},Eh);function Eh(t,e){this.db=t,this.cr=new Xa(this,e)}function Th(t,e){return ph(t).put((t=t.Fo,new Wc(0,Za(e.path),t)))}function Ah(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Nh=(Oh.prototype._r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Rr(t,n.Cc)})},Oh);function Oh(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Ni(Hr),this.Nc=new ea(yi,vi),this.xc=Zr.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new la(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}function Sh(t,e,n,r){return new Nh(t,e,n,r)}function Dh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).rs,m=e.Oc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.rs.Mr(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new la(e.Fc,n,e.persistence.Pc()),n.Mr(v)}).next(function(t){for(var e=[],n=[],r=Fi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._s(v,r).next(function(t){return{kc:t,$c:e,Lc:n}})})})];case 1:return r=t.sent(),[2,(e.rs=n,e.Oc=m,e.Dc.Mc(e.Oc),r)]}})})}function xh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function kh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.jo.bo(e,r).next(function(t){return t?(n=t,na.resolve(n)):i.jo.fo(e).next(function(t){return n=new Ii(r,t,0,e.Fo),i.jo.Ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Cc.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Cc=i.Cc.Tt(t.targetId,t),i.Nc.set(r,t.targetId)),t})}function Ph(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Cc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Vr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Sa(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Cc=e.Cc.remove(o),e.Nc.delete(n.target),[2]}})})}function Rh(t,o,s){var u=t,a=Zr.min(),c=Fi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=vu(o),(void 0!==(t=(i=t).Nc.get(r))?na.resolve(i.Cc.get(t)):i.jo.bo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.jo.xo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Dc.ws(e,o,s?a:Zr.min(),s?c:Fi())}).next(function(t){return{documents:t,Bc:c}});var t,n,r,i})}function Ch(t,e){var n=t,r=n.jo;return(t=n.Cc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Lh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Fc,n=t,t=s.xc,r=e,i=Li,o=oc(t),t=Nc(n),n=IDBKeyRange.lowerBound(o,!0),t._i({index:zc.readTimeIndex,range:n},function(t,e){var n=rc(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:sc(o)}});var e,n,r,i,o}).then(function(t){var e=t.qc,t=t.readTime;return s.xc=t,e})}function Vh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Cr.FAILED_PRECONDITION||e.message!==fa)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Mh(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return of(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(4),[4,Jh(e)];case 1:return t.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,Xh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new Gh(n,r)}var Uh,jh,qh,me=(Qh.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},Qh.prototype.zc=function(){return 2===this.state},Qh.prototype.start=function(){3!==this.state?this.auth():this.Hc()},Qh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qh.prototype.Jc=function(){this.state=0,this.Si.reset()},Qh.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},Qh.prototype.Zc=function(t){this.tu(),this.stream.send(t)},Qh.prototype.Xc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},Qh.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},Qh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==e?this.Si.reset():n&&n.code===Cr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===Cr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.nu(n)];case 1:return t.sent(),[2]}})})},Qh.prototype.eu=function(){},Qh.prototype.auth=function(){var n=this;this.state=1;var t=this.su(this.Wc),e=this.Wc;this.Kc.getToken().then(function(t){n.Wc===e&&n.iu(t)},function(e){t(function(){var t=new Lr(Cr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ru(t)})})},Qh.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Qh.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Qh.prototype.ru=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Qh.prototype.su=function(e){var n=this;return function(t){n.Cs.Ri(function(){return n.Wc===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Qh),Fh=(n(Yh,qh=me),Yh.prototype.ou=function(t){return this.Qc.uu("Listen",t)},Yh.prototype.onMessage=function(t){this.Si.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:xr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.tn?(kr(void 0===o||"string"==typeof o),mi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),mi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Cr.UNKNOWN:Ai(s.code),new Lr(o,s.message||"")),r=new Xi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Bo(t,a.document.name),u=Uo(a.document.updateTime),s=new Ws({mapValue:{fields:a.document.fields}}),u=new eu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Yi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Bo(t,a.document),c=a.readTime?Uo(a.readTime):Zr.min(),c=new nu(u,c),a=a.removedTargetIds||[];r=new Yi([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Bo(t,c.document),c=c.removedTargetIds||[];r=new Yi([],c,h,null)}else{if(!("filter"in e))return xr();e.filter,(h=e.filter).targetId,e=new bi(e=h.count||0),h=h.targetId,r=new Qi(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Zr.min():Uo(e.readTime);return this.listener.au(n,t)},Yh.prototype.hu=function(t){var e,n,r,i,o={};o.database=Ko(this.serializer),o.addTarget=(e=this.serializer,(r=gi(r=(n=t).target)?{documents:Xo(e,r)}:{query:Jo(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Mo(e,n.resumeToken):0<n.ft.F(Zr.min())&&(r.readTime=Vo(e,n.ft.M())),r),(t=(this.serializer,i=t,null==(t=function(){switch(i._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.Zc(o)},Yh.prototype.lu=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.Zc(e)},Yh),Bh=(n(Hh,jh=me),Object.defineProperty(Hh.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),Hh.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,jh.prototype.start.call(this)},Hh.prototype.eu=function(){this._u&&this.du([])},Hh.prototype.ou=function(t){return this.Qc.uu("Write",t)},Hh.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(kr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Uo(e.updateTime):Uo(n)).isEqual(Zr.min())&&(t=Uo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ts(t,n);var e,n})):[]),n=Uo(t.commitTime);return this.listener.wu(n,e)}var r;return kr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},Hh.prototype.Tu=function(){var t={};t.database=Ko(this.serializer),this.Zc(t)},Hh.prototype.du=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.Zc(t)},Hh),zh=(n(Wh,Uh=function(){}),Wh.prototype.mu=function(){if(this.Iu)throw new Lr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},Wh.prototype.Au=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Au(e,n,r,t)}).catch(function(t){throw t.code===Cr.UNAUTHENTICATED&&i.credentials.m(),t})},Wh.prototype.Ru=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Ru(e,n,r,t)}).catch(function(t){throw t.code===Cr.UNAUTHENTICATED&&i.credentials.m(),t})},Wh.prototype.terminate=function(){this.Iu=!1},Wh),Gh=(Kh.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},Kh.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,1<=this.gu&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},Kh.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},Kh.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},Kh.prototype.bu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Vu?(Or(t),this.Vu=!1):Nr("OnlineStateTracker",t)},Kh.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},Kh);function Kh(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}function Wh(t,e,n){var r=this;return(r=Uh.call(this)||this).credentials=t,r.Qc=e,r.serializer=n,r.Iu=!1,r}function Hh(t,e,n,r,i){var o=this;return(o=jh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o._u=!1,o}function Yh(t,e,n,r,i){var o=this;return(o=qh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Qh(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new ba(t,e)}function Xh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!of(r))return[3,4];e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Jh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $h(t,e){t.Ou.has(e.targetId)||(t.Ou.set(e.targetId,e),rf(t)?nf(t):pf(t).zc()&&tf(t,e))}function Zh(t,e){var n=t,t=pf(n);n.Ou.delete(e),t.zc()&&ef(n,e),0===n.Ou.size&&(t.zc()?t.Yc():of(n)&&n.Bu.set("Unknown"))}function tf(t,e){t.qu.De(e.targetId),pf(t).hu(e)}function ef(t,e){t.qu.De(e),pf(t).lu(e)}function nf(e){e.qu=new $i({Xe:function(t){return e.xu.Xe(t)},Ze:function(t){return e.Ou.get(t)||null}}),pf(e).start(),e.Bu.pu()}function rf(t){return of(t)&&!pf(t).Gc()&&0<t.Ou.size}function of(t){return 0===t.Mu.size}function sf(t){t.qu=void 0}function uf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Sa(r))throw r;return n.Mu.add(1),[4,Jh(n)];case 1:return t.sent(),n.Bu.set("Offline"),i=i||function(){return xh(n.Cu)},n.di.Mi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mu.delete(1),[4,Xh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function af(e,n){return n().catch(function(t){return uf(e,t,n)})}function cf(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=df(o=c),u=0<o.Fu.length?o.Fu[o.Fu.length-1].batchId:-1,t.label=1;case 1:if(!(of(o)&&o.Fu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Cu,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.rs.Fr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Fu.length&&s.Yc(),[3,7]):(u=a.batchId,e=a,(n=o).Fu.push(e),(n=df(n)).zc()&&n.fu&&n.du(e.mutations),[3,6]);case 4:return a=t.sent(),[4,uf(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return hf(o)&&ff(o),[2]}var e,n,r,i})})}function hf(t){return of(t)&&!df(t).Gc()&&0<t.Fu.length}function ff(t){df(t).start()}function lf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mu.delete(2),[4,Xh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mu.add(2),[4,Jh(e)]);case 3:t.sent(),e.Bu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function pf(n){var t,e,r,i=this;return n.ju||(n.ju=(t=n.Nu,e=n.di,r={cu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Ou.forEach(function(t,e){tf(n,t)}),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return sf(e),rf(e)?(e.Bu.Su(n),nf(e)):e.Bu.set("Unknown"),[2]})})}.bind(null,n),au:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bu.set("Online"),!(u instanceof Xi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ou.has(i)?[4,o.xu.Uu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ou.delete(i),o.qu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,uf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Yi?s.qu.$e(u):u instanceof Qi?s.qu.je(u):s.qu.qe(u),a.isEqual(Zr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,xh(s.Cu)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).qu.He(i)).re.forEach(function(t,e){var n;0<t.resumeToken.ht()&&(n=r.Ou.get(e))&&r.Ou.set(e,n.wt(t.resumeToken,i))}),e.oe.forEach(function(t){var e=r.Ou.get(t);e&&(r.Ou.set(t,e.wt(mi.lt,e.ft)),ef(r,t),e=new Ii(e.target,t,1,e.sequenceNumber),tf(r,e))}),r.xu.Qu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,uf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.mu(),new Fh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ju.Jc(),rf(n)?nf(n):n.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ju.stop()];case 2:t.sent(),sf(n),t.label=3;case 3:return[2]}})})})),n.ju}function df(n){var t,e,r,i=this;return n.Gu||(n.Gu=(t=n.Nu,e=n.di,r={cu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return df(e).Tu(),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&df(e).fu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ti(n=i.code)&&n!==Cr.ABORTED?(e=r.Fu.shift(),df(r).Jc(),[4,af(r,function(){return r.xu.Wu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,cf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return hf(e)&&ff(e),[2]}})})}.bind(null,n),Eu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=df(o),n=0,r=o.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]})})}.bind(null,n),wu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Fu.shift(),n=ta.from(e,i,o),[4,af(r,function(){return r.xu.Ku(n)})];case 1:return t.sent(),[4,cf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mu(),new Bh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gu.Jc(),[4,cf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Gu.stop()];case 3:t.sent(),0<n.Fu.length&&(Nr("RemoteStore","Stopping write stream with "+n.Fu.length+" pending writes"),n.Fu=[]),t.label=4;case 4:return[2]}})})})),n.Gu}function yf(){this.queries=new ea(wu,mu),this.onlineState="Unknown",this.Hu=new Set}var vf=function(){this.zu=void 0,this.listeners=[]};function gf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new vf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ju(n)];case 2:return o.zu=t.sent(),[3,4];case 3:return o=Ba(o=t.sent(),"Initialization of query '"+bu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Yu(e.onlineState),i.zu&&u.Xu(i.zu)&&wf(e),[2]}})})}function mf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Zu(n))]:[2]})})}function wf(t){t.Hu.forEach(function(t){t.next()})}var bf=(Af.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ki(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},Af.prototype.onError=function(t){this.ta.error(t)},Af.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},Af.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},Af.prototype.sa=function(t){if(0<t.docChanges.length)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},Af.prototype.ra=function(t){t=Ki.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},Af),_f=(Tf.prototype.W=function(){return this.ca.W()},Tf.prototype.Do=function(t,e){e=new If(t,e),this.ca=this.ca.add(e),this.aa=this.aa.add(e)},Tf.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Tf.prototype.No=function(t,e){this._a(new If(t,e))},Tf.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},Tf.prototype.da=function(t){var e=this,n=new ri(new ti([])),r=new If(n,t),t=new If(n,t+1),i=[];return this.aa.Kt([r,t],function(t){e._a(t),i.push(t.key)}),i},Tf.prototype.wa=function(){var e=this;this.ca.forEach(function(t){return e._a(t)})},Tf.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},Tf.prototype.Ea=function(t){var e=new ri(new ti([])),n=new If(e,t),t=new If(e,t+1),r=Fi();return this.aa.Kt([n,t],function(t){r=r.add(t.key)}),r},Tf.prototype.Qr=function(t){var e=new If(t,0);return null!==(e=this.ca.jt(e))&&t.isEqual(e.key)},Tf),If=(Ef.ua=function(t,e){return ri.$(t.key,e.key)||Hr(t.Ta,e.Ta)},Ef.ha=function(t,e){return Hr(t.Ta,e.Ta)||ri.$(t.key,e.key)},Ef);function Ef(t,e){this.key=t,this.Ta=e}function Tf(){this.ca=new Ri(If.ua),this.aa=new Ri(If.ha)}function Af(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}function Nf(t,e){return"firestore_clients_"+t+"_"+e}function Of(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.u()&&(n+="_"+e.uid),n}function Sf(t,e){return"firestore_targets_"+t+"_"+e}var Df=(Xf.Ia=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Lr(r.error.code,r.error.message)),i?new Xf(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Xf.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Xf),xf=(Qf.Ia=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Lr(n.error.code,n.error.message)),r?new Qf(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Qf.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Qf),kf=(Yf.Ia=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Bi,o=0;r&&o<n.activeTargetIds.length;++o)r=li(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Yf(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Yf),Pf=(Hf.Ia=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Hf(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},Hf),Rf=(Wf.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Wf.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Wf.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Wf),Cf=(Kf.Gs=function(t){return!(!t||!t.localStorage)},Kf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ga.Ic()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(Nf(this.persistenceKey,r)))&&(o=kf.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)h=c[a],this.Va(h);return this.va=[],this.window.addEventListener("unload",function(){return f.fc()}),this.lr=!0,[2]}})})},Kf.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},Kf.prototype.$a=function(){return this.La(this.pa)},Kf.prototype.Ba=function(n){var r=!1;return this.pa.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Kf.prototype.qa=function(t){this.Ua(t,"pending")},Kf.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},Kf.prototype.Wa=function(t){var e,n="not-current";return this.Ba(t)&&(!(e=this.storage.getItem(Sf(this.persistenceKey,t)))||(e=xf.Ia(t,e))&&(n=e.state)),this.ja.Aa(t),this.Oa(),n},Kf.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},Kf.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},Kf.prototype.Ha=function(t){this.removeItem(Sf(this.persistenceKey,t))},Kf.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},Kf.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},Kf.prototype.Za=function(t){this.th(t)},Kf.prototype.eh=function(){this.nh()},Kf.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},Kf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},Kf.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Kf.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Kf.prototype.Va=function(t){var e=this,o=t;o.storageArea===this.storage&&(Nr("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.ba?this.Cs.Mi(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.lr){if(null!==o.key)if(this.Da.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.uh(n)]}else if(this.Na.test(o.key)){if(null!==o.newValue&&(r=this.ah(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xa){if(null!==o.newValue&&(i=this.Ma(o.newValue)))return[2,this.ka(i)]}else if(o.key===this.Sa)(i=function(t){var e=da.Ds;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==da.Ds&&this.ps(i);else if(o.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(o);return[2]})})}):Or("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Kf.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),Kf.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},Kf.prototype.Ua=function(t,e,n){n=new Df(this.currentUser,t,e,n),t=Of(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ma())},Kf.prototype.Ka=function(t){t=Of(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Kf.prototype.th=function(t){t={clientId:this.Pa,onlineState:t},this.storage.setItem(this.xa,JSON.stringify(t))},Kf.prototype.Ya=function(t,e,n){var r=Sf(this.persistenceKey,t),n=new xf(t,e,n);this.setItem(r,n.ma())},Kf.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},Kf.prototype.sh=function(t){return(t=this.Da.exec(t))?t[1]:null},Kf.prototype.rh=function(t,e){return t=this.sh(t),kf.Ia(t,e)},Kf.prototype.oh=function(t,e){var n=this.Ca.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Df.Ia(new br(n),t,e)},Kf.prototype.ah=function(t,e){return t=this.Na.exec(t),t=Number(t[1]),xf.Ia(t,e)},Kf.prototype.Ma=function(t){return Pf.Ia(t)},Kf.prototype.uh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ga._h(e.batchId,e.state,e.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Kf.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},Kf.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},Kf.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},Kf.prototype.La=function(t){var n=Bi;return t.forEach(function(t,e){n=n.Gt(e.activeTargetIds)}),n},Kf),Lf=(Gf.prototype.qa=function(t){},Gf.prototype.Qa=function(t,e,n){},Gf.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},Gf.prototype.Ja=function(t,e,n){this.Eh[t]=e},Gf.prototype.Ga=function(t){this.wh.Ra(t)},Gf.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},Gf.prototype.Ha=function(t){delete this.Eh[t]},Gf.prototype.$a=function(){return this.wh.activeTargetIds},Gf.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},Gf.prototype.start=function(){return this.wh=new Rf,Promise.resolve()},Gf.prototype.Xa=function(t,e,n){},Gf.prototype.Za=function(t){},Gf.prototype.fc=function(){},Gf.prototype.Ss=function(t){},Gf.prototype.eh=function(){},Gf),Vf=function(t){this.key=t},Mf=function(t){this.key=t},Uf=(Object.defineProperty(zf.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),zf.prototype.gh=function(t,e){var s=this,u=e?e.yh:new Gi,a=(e||this).Rh,c=(e||this).ee,h=a,f=!1,l=hu(this.query)&&a.size===this.query.limit?a.last():null,p=fu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof eu?e:null)&&(_u(s.query,r)?r:null),i=!!n&&s.ee.has(n.key),o=!!r&&(r.an||s.ee.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Vh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),hu(this.query)||fu(this.query))for(;h.size>this.query.limit;){var n=hu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,yh:u,ph:f,ee:c}},zf.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},zf.prototype.Zn=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var i=t.yh.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],e=(n=0===this.mh.size&&this.le?1:0)!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Ki(this.query,t.Rh,r,i,t.ee,0==n,e,!1),Dh:s}:{Dh:s}},zf.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Gi,ee:this.ee,ph:!1},!1)):{Dh:[]}},zf.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},zf.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},zf.prototype.Sh=function(){var e=this;if(!this.le)return[];var n=this.mh;this.mh=Fi(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Mf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Vf(t))}),r},zf.prototype.Nh=function(t){return this.Th=t.Bc,this.mh=Fi(),t=this.gh(t.documents),this.Zn(t,!0)},zf.prototype.xh=function(){return Ki.ie(this.query,this.Rh,this.ee,0===this.Ih)},zf),jf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},qf=function(t){this.key=t,this.Fh=!1},Ff=(Object.defineProperty(Bf.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),Bf);function Bf(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new ea(wu,mu),this.qh=new Map,this.Uh=[],this.Qh=new Ni(ri.$),this.Kh=new Map,this.Wh=new _f,this.jh={},this.Gh=new Map,this.zh=uh._o(),this.onlineState="Unknown",this.Hh=void 0}function zf(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Fi(),this.ee=Fi(),this.Ah=Iu(t),this.Rh=new zi(this.Ah)}function Gf(){this.wh=new Rf,this.Eh={},this.Pu=null,this.ps=null}function Kf(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Ni(Hr),this.lr=!1,this.va=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.ba=Nf(this.persistenceKey,this.Pa),this.Sa="firestore_sequence_number_"+this.persistenceKey,this.pa=this.pa.Tt(this.Pa,new Rf),this.Da=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xa="firestore_online_state_"+this.persistenceKey,this.Fa="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.ya)}function Wf(){this.activeTargetIds=Bi}function Hf(t,e){this.clientId=t,this.onlineState=e}function Yf(t,e){this.clientId=t,this.activeTargetIds=e}function Qf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Xf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Jf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Rh(r.Cu,i.query,!1).then(function(t){return t=t.documents,i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.re.get(i.targetId),n=i.view.Zn(e,r.Jh,n),[2,(sl(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Rh(i.Cu,o,!0)];case 1:return n=t.sent(),r=new Uf(o,n.Bc),e=r.gh(n.documents),n=Hi.he(s,u&&"Offline"!==i.onlineState),n=r.Zn(e,i.Jh,n),sl(i,s,n.Dh),r=new jf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function $f(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=ll(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Cu,a=p,h=i,f=$r.now(),o=a.reduce(function(t,e){return t.add(e.key)},Fi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Oc._s(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof js?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof eu?t.field(i.field):void 0;null!=(o=is(i.transform,o||null))&&(e=(null==e?new Hs:e).set(i.field,o))}return e?e.hn():null}(o):null);null!=o&&e.push(new Cs(i.key,o,function s(t){var u=[];return co(t.fields||{},function(t,e){var n=new ni([t]);if(Do(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new _s(u)}(o.proto.mapValue),As.exists(!0)))}return h.rs.Sr(u,f,e,a)})}).then(function(t){var e=t.vn(c);return{batchId:t.batchId,Qn:e}}))];case 2:return s=t.sent(),u.kh.qa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.h()])||new Ni(Hr)).Tt(n,r),e.jh[e.currentUser.h()]=i,[4,al(u,s.Qn)];case 3:return t.sent(),[4,cf(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=Ba(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Zf(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,h=e,f=(o=s).ft,l=h.Cc,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Fc.Xr({Zr:!0});l=h.Cc;var u=[];o.re.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.jo.Co(s,t.de,e).next(function(){return h.jo.So(s,t._e,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,f).dt(s.Fo),l=l.Tt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i._e.size+i.fe.size+i.de.size)&&u.push(h.jo.yo(s,n))))});var e,a,n,c,r,i=Li;return o.ce.forEach(function(t,e){o.ue.has(t)&&u.push(h.persistence.Vr.Sc(s,t))}),u.push((e=s,a=t,n=o.ce,c=f,r=Fi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Li;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof nu&&e.version.isEqual(Zr.min())?(a.Hn(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.jn(e,r),o=o.Tt(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(Zr.min())||(e=h.jo.To(s).next(function(t){return h.jo.mo(s,s.Fo,f)}),u.push(e)),na.qn(u).next(function(){return t.apply(s)}).next(function(){return h.Oc.fs(s,i)})}).then(function(t){return h.Cc=l,t}))];case 2:return r=t.sent(),s.re.forEach(function(t,e){(e=n.Kh.get(e))&&(kr(t._e.size+t.fe.size+t.de.size<=1),0<t._e.size?e.Fh=!0:0<t.fe.size?kr(e.Fh):0<t.de.size&&(kr(e.Fh),e.Fh=!1))}),[4,al(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,h,f,l})})}function tl(t,n,e){var r;((t=t).Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){(e=e.view.Yu(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Yu(i)&&(o=!0)}),o&&wf(t)}(t.Mh,n),r.length&&t.Lh.au(r),t.onlineState=n,t.Jh&&t.kh.Za(n))}function el(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:of((n=o).Oh)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Cu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=Ba(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function nl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function rl(t,e,n){var r=t,i=r.jh[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i)}function il(e,t,n){void 0===n&&(n=null),e.kh.Ga(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.da(t).forEach(function(t){e.Wh.Qr(t)||ol(e,t)})}function ol(t,e){var n=t.Qh.get(e);null!==n&&(Zh(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),ul(t))}function sl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Vf?(t.Wh.Do(u.key,e),r=t,i=(i=u).key,r.Qh.get(i)||(Nr("SyncEngine","New document in limbo: "+i),r.Uh.push(i),ul(r))):u instanceof Mf?(Nr("SyncEngine","Document no longer in limbo: "+u.key),t.Wh.No(u.key,e),t.Wh.Qr(u.key)||ol(t,u.key)):xr()}}function ul(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new qf(e)),t.Qh=t.Qh.Tt(e,n),$h(t.Oh,new Ii(vu(cu(e.path)),n,2,da.Ds))}}function al(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.W()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=pa.Vs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.au(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return na.forEach(c,function(e){return na.forEach(e.gs,function(t){return r.persistence.Vr.Do(n,e.targetId,t)}).next(function(){return na.forEach(e.ys,function(t){return r.persistence.Vr.No(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Sa(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Cc.get(o),u=s.ft,u=s.Et(u),r.Cc=r.Cc.Tt(o,u));return[2]}})})}(n.Cu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function cl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,kh(e.Cu,vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Rh((e=r).Cu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&sl(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Ch(e.Cu,s)];case 8:return l=t.sent(),[4,kh(e.Cu,l)];case 9:return u=t.sent(),[4,Jf(e,hl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.au(r),n)]}})})}function hl(t){return au(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function fl(t){return t.Oh.xu.Qu=Zf.bind(null,t),t.Oh.xu.Xe=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Fi().add(t.key);var r=Fi();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Gt(s.view.Ph);return r}.bind(null,t),t.Oh.xu.Uu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ja(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Ni(ri.$)).Tt(n,new nu(n,Zr.min())),i=Fi().add(n),i=new Wi(Zr.min(),new Map,new Ri(Hr),r,i),[4,Zf(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),ul(e),[3,4];case 2:return[4,Ph(e.Cu,s,!1).then(function(){return il(e,s,u)}).catch(Vh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.au=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&wf(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function ll(t){return t.Oh.xu.Ku=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Fc.Xr({Zr:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=na.resolve();return a.forEach(function(n){c=c.next(function(){return s.Jn(o,n)}).next(function(t){var e=t;kr(null!==(t=r.Sn.get(n))),(!e||e.version.F(t)<0)&&(e=u.yn(n,e,r))&&s.jn(e,r.bn)})}),c.next(function(){return i.rs.$r(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.rs.Ur(t)}).next(function(){return f.Oc._s(t,e)})}))];case 2:return i=t.sent(),rl(n,r,null),nl(n,r),n.kh.Qa(r,"acknowledged"),[4,al(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.Oh.xu.Wu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.rs.Cr(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.rs.$r(e,t)}).next(function(){return i.rs.Ur(e)}).next(function(){return i.Oc._s(e,n)})}))];case 2:return o=t.sent(),rl(n,u,a),nl(n,u),n.kh.Qa(u,"rejected",a),[4,al(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var pl,dl,yl,vl,gl,ml=(np.prototype.Mc=function(t){this.Zh=t},np.prototype.ws=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Tn.length||1===r.Tn.length&&r.Tn[0].field.tt())||i.isEqual(Zr.min())?this.tl(e,r):this.Zh._s(e,o).next(function(t){var n=s.el(r,t);return(hu(r)||fu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bu(r)),s.Zh.ws(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},np.prototype.el=function(n,t){var r=new Ri(Iu(n));return t.forEach(function(t,e){e instanceof eu&&_u(n,e)&&(r=r.add(e))}),r},np.prototype.ph=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},np.prototype.tl=function(t,e){return Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",bu(e)),this.Zh.ws(t,e,Zr.min())},np),wl=(ep.prototype.br=function(t){return na.resolve(0===this.rs.length)},ep.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.rs.length&&this.rs[this.rs.length-1],n=new Zu(i,e,n,r),this.rs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new If(u.key,i)),this.os.Dr(t,u.key.path.q())}return na.resolve(n)},ep.prototype.Cr=function(t,e){return na.resolve(this.il(e))},ep.prototype.Fr=function(t,e){return e+=1,e=(e=this.rl(e))<0?0:e,na.resolve(this.rs.length>e?this.rs[e]:null)},ep.prototype.Or=function(){return na.resolve(0===this.rs.length?-1:this.nl-1)},ep.prototype.Mr=function(t){return na.resolve(this.rs.slice())},ep.prototype.us=function(t,e){var n=this,r=new If(e,0),e=new If(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Kt([r,e],function(t){t=n.il(t.Ta),i.push(t)}),na.resolve(i)},ep.prototype.ds=function(t,e){var n=this,r=new Ri(Hr);return e.forEach(function(t){var e=new If(t,0),t=new If(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,t],function(t){r=r.add(t.Ta)})}),na.resolve(this.ol(r))},ep.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,e=n;ri.ot(e)||(e=e.child(""));var e=new If(new ri(e),0),i=new Ri(Hr);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(i=i.add(t.Ta)),!0)},e),na.resolve(this.ol(i))},ep.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.il(t))&&n.push(t)}),n},ep.prototype.$r=function(n,r){var i=this;kr(0===this.cl(r.batchId,"removed")),this.rs.shift();var o=this.sl;return na.forEach(r.mutations,function(t){var e=new If(t.key,r.batchId);return o=o.delete(e),i.Vr.qr(n,t.key)}).next(function(){i.sl=o})},ep.prototype.Br=function(t){},ep.prototype.Qr=function(t,e){var n=new If(e,0),n=this.sl.jt(n);return na.resolve(e.isEqual(n&&n.key))},ep.prototype.Ur=function(t){return this.rs.length,na.resolve()},ep.prototype.cl=function(t,e){return this.rl(t)},ep.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},ep.prototype.il=function(t){return(t=this.rl(t))<0||t>=this.rs.length?null:this.rs[t]},ep),bl=(tp.prototype.jn=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:o,readTime:n}),this.size+=o-i,this.os.Dr(t,r.path.q())},tp.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},tp.prototype.Jn=function(t,e){return e=this.docs.get(e),na.resolve(e?e.zn:null)},tp.prototype.getEntries=function(t,e){var n=this,r=Li;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),na.resolve(r)},tp.prototype.ws=function(t,e,n){for(var r=Ui,i=new ri(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=(u=o.Ct()).key,u=(a=u.value).zn,a=a.readTime;if(!e.path.j(s.path))break;a.F(n)<=0||u instanceof eu&&_u(e,u)&&(r=r.Tt(u.key,u))}return na.resolve(r)},tp.prototype.al=function(t,e){return na.forEach(this.docs,function(t){return e(t)})},tp.prototype.Xr=function(t){return new _l(this)},tp.prototype.eo=function(t){return na.resolve(this.size)},tp),_l=(n(Zl,gl=h),Zl.prototype.Zn=function(n){var r=this,i=[];return this.Qn.forEach(function(t,e){e&&e.zn?i.push(r.no.jn(n,e.zn,r.Wn(t))):r.no.Hn(t)}),na.qn(i)},Zl.prototype.Yn=function(t,e){return this.no.Jn(t,e)},Zl.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},Zl),Il=($l.prototype.Ue=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),na.resolve()},$l.prototype.To=function(t){return na.resolve(this.lastRemoteSnapshotVersion)},$l.prototype.Io=function(t){return na.resolve(this.ll)},$l.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),na.resolve(this.highestTargetId)},$l.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),na.resolve()},$l.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new uh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},$l.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,na.resolve()},$l.prototype.yo=function(t,e){return this.Ro(e),na.resolve()},$l.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),--this.targetCount,na.resolve()},$l.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.po(n,e.targetId)),s++)}),na.qn(u).next(function(){return s})},$l.prototype.vo=function(t){return na.resolve(this.targetCount)},$l.prototype.bo=function(t,e){return e=this.hl.get(e)||null,na.resolve(e)},$l.prototype.So=function(t,e,n){return this._l.la(e,n),na.resolve()},$l.prototype.Co=function(e,t,n){this._l.fa(t,n);var r=this.persistence.Vr,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),na.qn(i)},$l.prototype.po=function(t,e){return this._l.da(e),na.resolve()},$l.prototype.xo=function(t,e){return e=this._l.Ea(e),na.resolve(e)},$l.prototype.Qr=function(t,e){return na.resolve(this._l.Qr(e))},$l),El=(Jl.prototype.ro=function(t,e){return na.resolve(this.dl.get(e))},Jl.prototype.oo=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Uo(e.createTime)}),na.resolve()},Jl.prototype.co=function(t,e){return na.resolve(this.wl.get(e))},Jl.prototype.uo=function(t,e){return this.wl.set(e.name,{name:e.name,query:lc(e.bundledQuery),readTime:Uo(e.readTime)}),na.resolve()},Jl),Tl=(Xl.prototype.start=function(){return Promise.resolve()},Xl.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(Xl.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),Xl.prototype.tc=function(){},Xl.prototype.ec=function(){},Xl.prototype.Pc=function(){return this.os},Xl.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new wl(this.os,this.Vr),this.El[t.h()]=e),e},Xl.prototype.Ac=function(){return this.jo},Xl.prototype.Rc=function(){return this.ss},Xl.prototype.gc=function(){return this.Go},Xl.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new Al(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},Xl.prototype.Al=function(e,n){return na.Un(Object.values(this.El).map(function(t){return function(){return t.Qr(e,n)}}))},Xl),Al=(n(Ql,vl=ge),Ql),Nl=(Yl.gl=function(t){return new Yl(t)},Object.defineProperty(Yl.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw xr()},enumerable:!1,configurable:!0}),Yl.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),na.resolve()},Yl.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),na.resolve()},Yl.prototype.qr=function(t,e){return this.yl.add(e.toString()),na.resolve()},Yl.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},Yl.prototype.Il=function(){this.Pl=new Set},Yl.prototype.ml=function(n){var r=this,i=this.persistence.Rc().Xr();return na.forEach(this.yl,function(t){var e=ri.st(t);return r.Vl(n,e).next(function(t){t||i.Hn(e)})}).next(function(){return r.Pl=null,i.apply(n)})},Yl.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},Yl.prototype.Tl=function(t){return 0},Yl.prototype.Vl=function(t,e){var n=this;return na.Un([function(){return na.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},Yl),Ol=(Hl.prototype.cu=function(t){this.bl=t},Hl.prototype.nu=function(t){this.Sl=t},Hl.prototype.onMessage=function(t){this.Dl=t},Hl.prototype.close=function(){this.vl()},Hl.prototype.send=function(t){this.pl(t)},Hl.prototype.Cl=function(){this.bl()},Hl.prototype.Nl=function(t){this.Sl(t)},Hl.prototype.xl=function(t){this.Dl(t)},Hl),Sl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Dl=(Wl.prototype.Au=function(e,t,n,r){var i=this.kl(e,t);return Nr("RestConnection","Sending: ",i,n),t={},this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(t){throw Sr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Wl.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},Wl.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-2020102005919",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},Wl.prototype.kl=function(t,e){return t=Sl[t],this.Ol+"/v1/"+e+":"+t},n(Kl,yl=Wl),Kl.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Nr("Connection",'RPC "'+o+'" timed out'),r(new Lr(Cr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Nr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Cr).indexOf(e)?e:Cr.UNKNOWN,r(new Lr(e,t.message))):r(new Lr(Cr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Lr(Cr.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{Nr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Kl.prototype.uu=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Ol({pl:function(t){a?Nr("Connection","Not sending because WebChannel is closed:",t):(u||(Nr("Connection","Opening WebChannel transport."),s.open(),u=!0),Nr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||Nr("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,Nr("Connection","WebChannel transport closed"),c.Nl())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Sr("Connection","WebChannel transport errored:",t),c.Nl(new Lr(Cr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=_i[r];if(void 0!==t)return Ai(t)}(),i=n.message,void 0===t&&(t=Cr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Nl(new Lr(t,i)),s.close()):(Nr("Connection","WebChannel received:",e),c.xl(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?Nr("Connection","Detected buffering proxy"):11===t.stat&&Nr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Cl()},0),c},Kl),xl=(Gl.prototype.Lu=function(t){this.Kl.push(t)},Gl.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},Gl.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},Gl.prototype.ql=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},Gl.prototype.Ql=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},Gl.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Gl),kl=(zl.prototype.Lu=function(t){},zl.prototype.fc=function(){},zl),Pl=(Bl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ca(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Cu=this.Jl(e),[2]}})})},Bl.prototype.Hl=function(t){return null},Bl.prototype.Jl=function(t){return Sh(this.persistence,new ml,t.Yl,this.serializer)},Bl.prototype.Gl=function(t){return new Tl(Nl.gl,this.serializer)},Bl.prototype.jl=function(t){return new Lf},Bl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},Bl),Rl=(n(Fl,dl=Pl),Fl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,dl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Nc(t),r=Zr.min(),t._i({index:zc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=sc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.xc=t})]})})}(this.Cu)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,ll(this.Xl.ga)];case 4:return t.sent(),[4,cf(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},Fl.prototype.Jl=function(t){return Sh(this.persistence,new ml,t.Yl,this.serializer)},Fl.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new Qa(e,t.di)},Fl.prototype.Gl=function(t){var e=Ah(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Wa.er(this.cacheSizeBytes):Wa.ir;return new gh(this.synchronizeTabs,e,t.clientId,n,t.di,Va(),Ma(),this.serializer,this.kh,!!this.forceOwnership)},Fl.prototype.jl=function(t){return new Lf},Fl),Cl=(n(ql,pl=Rl),ql.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,pl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.ga,this.kh instanceof Cf?(this.kh.ga={_h:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Cu,n=a,i=(r=e).rs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Nr(e,n).next(function(t){return t?r.Oc._s(e,t):na.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,cf(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(rl(o,a,h||null),nl(o,a),o.Cu.rs.Br(a)):xr(),t.label=4;case 4:return[4,al(o,s)];case 5:return t.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Lh(e.Cu)];case 3:return n=t.sent(),r=Wi.ae(o,"current"===s),[4,al(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Ph(e.Cu,o,!0)];case 6:return t.sent(),il(e,o,u),[3,8];case 7:xr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=fl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Nr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Ch(n.Cu,r)]):[3,6];case 2:return i=t.sent(),[4,kh(n.Cu,i)];case 3:return o=t.sent(),[4,Jf(n,hl(i),o.targetId,!1)];case 4:t.sent(),$h(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,Ph(n.Cu,e,!1).then(function(){Zh(n.Oh,e),il(n,e)}).catch(Vh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ic:function(t){return t.Cu.persistence.Ic()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Lh((e=n).Cu).then(function(t){return al(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Zo(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return fl(r=h),ll(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$a(),[4,cl(r,e.H())]);case 1:return i=t.sent(),r.Hh=!0,[4,lf(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],$h(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?a.push(e):c=c.then(function(){return il(r,e),Ph(r.Cu,e,!0)}),Zh(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,cl(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){Zh(n.Oh,e)}),n.Wh.wa(),n.Kh=new Map,n.Qh=new Ni(ri.$),r.Hh=!1,[4,lf(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Xl.ga,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.lr?this.zl.start(this.Cu):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},ql.prototype.jl=function(t){var e=Va();if(!Cf.Gs(e))throw new Lr(Cr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ah(t.Fl.t,t.Fl.persistenceKey);return new Cf(e,t.di,n,t.clientId,t.Yl)},ql),Ll=(jl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Cu?[3,2]:(this.Cu=n.Cu,this.kh=n.kh,this.Nu=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.ga=this.n_(r,!n.synchronizeTabs),this.kh.Pu=function(t){return tl(e.ga,t,1)},this.Oh.xu.s_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Nr("SyncEngine","User change. New user:",o.h()),[4,Dh(n.Cu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new Lr(Cr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xa(o,r.$c,r.Lc),[4,al(n,r.kc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.ga),[4,lf(this.Oh,this.ga.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},jl.prototype.e_=function(t){return new yf},jl.prototype.Zl=function(t){var e=ca(t.Fl.t),n=(n=t.Fl,new Dl(n));return t=t.credentials,new zh(t,n,e)},jl.prototype.t_=function(t){var e=this;return new Mh(this.Cu,this.Nu,t.di,function(t){return tl(e.ga,t,0)},t=new(xl.Gs()?xl:kl))},jl.prototype.n_=function(t,e){return n=this.Cu,r=this.Oh,i=this.Mh,o=this.kh,s=t.Yl,t=t.$h,e=e,t=new Ff(n,r,i,o,s,t),e&&(t.Hh=!0),t;var n,r,i,o,s},jl.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Nr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,Jh(e)];case 1:return t.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},jl),Vl=(Ul.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Ul.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ul.prototype.r_=function(){this.muted=!0},Ul.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ul),Ml=function(t){this.o_=t};function Ul(t){this.observer=t,this.muted=!1}function jl(){}function ql(t,e){var n=this;return(n=pl.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Fl(t,e,n){var r=this;return(r=dl.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Bl(){this.synchronizeTabs=!1}function zl(){}function Gl(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function Kl(t){var e=this;return(e=yl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Wl(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Hl(t){this.pl=t.pl,this.vl=t.vl}function Yl(t){this.persistence=t,this.Rl=new _f,this.Pl=null}function Ql(t){var e=this;return(e=vl.call(this)||this).Fo=t,e}function Xl(t,e){var n=this;this.El={},this.ko=new da(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new Il(this),this.os=new Dc,this.ss=(t=this.os,new bl(t,function(t){return n.Vr.Tl(t)})),this.serializer=new nc(e),this.Go=new El(this.serializer)}function Jl(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function $l(t){this.persistence=t,this.hl=new ea(yi,vi),this.lastRemoteSnapshotVersion=Zr.min(),this.highestTargetId=0,this.ll=0,this._l=new _f,this.targetCount=0,this.fl=uh.lo()}function Zl(t){var e=this;return(e=gl.call(this)||this).no=t,e}function tp(t,e){this.os=t,this.ul=e,this.docs=new Ni(ri.$),this.size=0}function ep(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Ri(If.ua)}function np(){}function rp(t,e,n){if(!n)throw new Lr(Cr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function ip(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function op(t,e,n,r){if(!0===e&&!0===r)throw new Lr(Cr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function sp(t){if(!ri.ot(t))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function up(t){if(ri.ot(t))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ap(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function cp(t,e){if(t instanceof Ml&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Lr(Cr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=ap(t),new Lr(Cr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function hp(t,e){if(e<=0)throw new Lr(Cr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var fp,lp=function(t){this.c_=t},pp=(n(dp,fp=lp),dp.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},dp.prototype.isEqual=function(t){return t instanceof dp},dp);function dp(){return null!==fp&&fp.apply(this,arguments)||this}function yp(t,e,n){return new cy({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var vp,gp,mp,wp,bp=(n(Vp,wp=lp),Vp.prototype.u_=function(t){return new Is(t.path,new us)},Vp.prototype.isEqual=function(t){return t instanceof Vp},Vp),_p=(n(Lp,mp=lp),Lp.prototype.u_=function(t){var e=yp(this,t,!0),n=this.f_.map(function(t){return gy(t,e)}),n=new as(n);return new Is(t.path,n)},Lp.prototype.isEqual=function(t){return this===t},Lp),Ip=(n(Cp,gp=lp),Cp.prototype.u_=function(t){var e=yp(this,t,!0),n=this.f_.map(function(t){return gy(t,e)}),n=new ps(n);return new Is(t.path,n)},Cp.prototype.isEqual=function(t){return this===t},Cp),Ep=(n(Rp,vp=lp),Rp.prototype.u_=function(t){var e=new gs(t.serializer,Lo(t.serializer,this.d_));return new Is(t.path,e)},Rp.prototype.isEqual=function(t){return this===t},Rp),Tp=(Object.defineProperty(Pp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Pp.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),Pp.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},Pp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},Pp.prototype.C=function(t){return Hr(this.w_,t.w_)||Hr(this.E_,t.E_)},Pp),Ap=(kp.fromBase64String=function(t){try{return new kp(mi.fromBase64String(t))}catch(t){throw new Lr(Cr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},kp.fromUint8Array=function(t){return new kp(mi.fromUint8Array(t))},kp.prototype.toBase64=function(){return this.T_.toBase64()},kp.prototype.toUint8Array=function(){return this.T_.toUint8Array()},kp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},kp.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},kp),Np=new Map,Op=(xp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},xp),Sp=(Object.defineProperty(Dp.prototype,"app",{get:function(){if(!this.g_)throw new Lr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),Dp.prototype.v_=function(t){if(this.A_)throw new Lr(Cr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Op(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Vr;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new jr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Lr(Cr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Dp.prototype.b_=function(){return this.m_},Dp.prototype.S_=function(){return this.A_=!0,this.m_},Dp.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},Dp.prototype.D_=function(){return(t=Np.get(this))&&(Nr("ComponentProvider","Removing Datastore"),Np.delete(this),t.terminate()),Promise.resolve();var t},Dp);function Dp(t,e){this.I_="(lite)",this.m_=new Op({}),this.A_=!1,t instanceof wr?(this.R_=t,this.P_=new Vr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Lr(Cr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wr(t.options.projectId)}(t),this.P_=new Mr(e))}function xp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Lr(Cr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Lr(Cr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,op("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function kp(t){this.T_=t}function Pp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Lr(Cr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Lr(Cr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}function Rp(t,e){var n=this;return(n=vp.call(this,t)||this).d_=e,n}function Cp(t,e){var n=this;return(n=gp.call(this,t)||this).f_=e,n}function Lp(t,e){var n=this;return(n=mp.call(this,t)||this).f_=e,n}function Vp(){return null!==wp&&wp.apply(this,arguments)||this}function Mp(){if("undefined"==typeof Uint8Array)throw new Lr(Cr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Up(){if("undefined"==typeof atob)throw new Lr(Cr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var jp,qp,Fp,Bp=(n(Xp,Fp=Ml),Xp.fromBase64String=function(t){return Up(),new Xp(Ap.fromBase64String(t))},Xp.fromUint8Array=function(t){return Mp(),new Xp(Ap.fromUint8Array(t))},Xp.prototype.toBase64=function(){return Up(),this.o_.toBase64()},Xp.prototype.toUint8Array=function(){return Mp(),this.o_.toUint8Array()},Xp.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},Xp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xp),h=(Qp.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Eo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw xr()}},Qp.prototype.L_=function(t,n){var r=this,i={};return co(t.fields||{},function(t,e){i[t]=r.C_(e,n)}),i},Qp.prototype.M_=function(t){return new Tp(Io(t.latitude),Io(t.longitude))},Qp.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},Qp.prototype.x_=function(t,e){switch(e){case"previous":var n=function t(e){return fo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(lo(t));default:return null}},Qp.prototype.N_=function(t){return t=_o(t),new $r(t.seconds,t.nanos)},Qp.prototype.B_=function(t,e){var n=ti.Y(t);return kr(rs(n)),t=new wr(n.get(1),n.get(3)),n=new ri(n.B(5)),t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Qp),zp=(n(Yp,qp=h),Yp.prototype.F_=function(t){return new Bp(new Ap(t))},Yp.prototype.O_=function(t){return t=this.B_(t,this.firestore.R_),av.q_(t,this.firestore,null)},Yp),Gp=(Object.defineProperty(Hp.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Hp.prototype,"ref",{get:function(){return new _d(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),Hp.prototype.exists=function(){return null!==this.W_},Hp.prototype.data=function(){if(this.W_){if(this.j_){var t=new Kp(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},Hp.prototype.get=function(t){if(this.W_&&null!==(t=this.W_.data().field(Jp("DocumentSnapshot.get",t))))return this.Q_.C_(t)},Hp),Kp=(n(Wp,jp=Gp),Wp.prototype.data=function(){return jp.prototype.data.call(this)},Wp);function Wp(){return null!==jp&&jp.apply(this,arguments)||this}function Hp(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}function Yp(t){var e=this;return(e=qp.call(this)||this).firestore=t,e}function Qp(){}function Xp(){return null!==Fp&&Fp.apply(this,arguments)||this}function Jp(t,e){return"string"==typeof e?Ey(t,e):(e instanceof Ml?e.o_:e).G_}var $p,Zp=(nd.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},nd),td=(n(ed,$p=Sp),ed.prototype.D_=function(){return this.H_||nv(this),this.H_.terminate()},ed);function ed(t,e){var n=this;return(n=$p.call(this,t,e)||this).z_=new ja,n.I_="name"in t?t.name:"[DEFAULT]",n}function nd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new ni(t)}function rd(n,r,i){var t=this,o=new ra;return n.di.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Py(n,i)];case 1:return t.sent(),[4,Ry(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Cr.FAILED_PRECONDITION||t.code===Cr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function id(t){if(t.y_||t.V_)throw new Lr(Cr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var od,sd,ud=(n(ld,sd=Gp),ld.prototype.exists=function(){return sd.prototype.exists.call(this)},ld.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new ad(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},ld.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_&&null!==(t=this.W_.data().field(Jp("DocumentSnapshot.get",t))))return this.Q_.C_(t,e.serverTimestamps)},ld),ad=(n(fd,od=ud),fd.prototype.data=function(t){return void 0===t&&(t={}),od.prototype.data.call(this,t)},fd),cd=(Object.defineProperty(hd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),hd.prototype.forEach=function(e,n){var r=this;this.Y_.docs.forEach(function(t){e.call(n,new ad(r.U_,r.Q_,t.key,t,new _v(r.Y_.ee.has(t.key),r.Y_.fromCache),r.query.j_))})},hd.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Y_.se)throw new Lr(Cr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===t||(this.X_=function(i,e){if(i.Y_.te.W()){var n=0;return i.Y_.docChanges.map(function(t){var e=new ad(i.U_,i.Q_,t.doc.key,t.doc,new _v(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Y_.te;return i.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new ad(i.U_,i.Q_,t.doc.key,t.doc,new _v(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Z_=t),this.X_},hd);function hd(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new _v(r.hasPendingWrites,r.fromCache),this.query=n}function fd(){return null!==od&&od.apply(this,arguments)||this}function ld(t,e,n,r,i,o){var s=this;return(s=sd.call(this,t,e,n,r,o)||this).U_=t,s.J_=t,s.metadata=i,s}function pd(t,e){return t instanceof ud&&e instanceof ud?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof cd&&e instanceof cd&&t.U_===e.U_&&ey(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var dd,yd=(n(vd,dd=h),vd.prototype.F_=function(t){return new Ap(t)},vd.prototype.O_=function(t){return t=this.B_(t,this.firestore.R_),new _d(this.firestore,null,t)},vd);function vd(t){var e=this;return(e=dd.call(this)||this).firestore=t,e}function gd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=cp(t.firestore,td),s=ny(o);return e instanceof Ml&&(e=e.o_),wd(o,("string"==typeof e||e instanceof Zp?yy(s,"updateDoc",t.K_,e,n,r):dy(s,"updateDoc",t.K_,e)).ef(t.K_,As.exists(!0)))}function md(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ha(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};ha(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof _d?(s=cp(e.firestore,td),u=cu(e.K_.path),h={next:function(t){n[o]&&n[o](bd(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=cp(e.firestore,td),u=e.tf,c=new yd(s),h={next:function(t){n[o]&&n[o](new cd(s,c,e,t))},error:n[o+1],complete:n[o+2]},Kd(e.tf));var l=ev(s),p=new Vl(h),d=new bf(u,p,f);return s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=gf,[4,qy(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=mf,[4,qy(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function wd(t,e){return function(n,r){var t=this,i=new ra;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=$f,[4,jy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ev(t),e)}function bd(t,e,n){var r=n.docs.get(e.K_),i=new yd(t);return new ud(t,i,e.K_,r,new _v(n.hasPendingWrites,n.fromCache),e.j_)}var _d=(Object.defineProperty(Td.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"parent",{get:function(){return new Hd(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),Td.prototype.withConverter=function(t){return new Td(this.firestore,t,this.K_)},Td),Id=(Ed.prototype.withConverter=function(t){return new Ed(this.firestore,t,this.tf)},Ed);function Ed(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}function Td(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}function Ad(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].sf(t);return t}var Nd,Od,Sd,Dd,xd,kd=(n(qd,xd=ge=function(){}),qd.prototype.sf=function(t){var e=ny(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){zd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Bd(n,t,c))}h={arrayValue:{values:s}}}else h=Bd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||zd(o,i),h=vy(e,"where",o,"in"===i||"not-in"===i);var h=Tu.create(r,i,h);return function(t,e){if(e.An()){var n=pu(t);if(null!==n&&!n.isEqual(e.field))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=lu(t))&&Gd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.tf,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Id(t.firestore,t.j_,(e=(t=t.tf).filters.concat([e]),new iu(t.path,t.collectionGroup,t.Tn.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},qd),Pd=(n(jd,Dd=ge),jd.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new $u(e,n);return e=r,null!==lu(n=t)||null!==(t=pu(n))&&Gd(0,t,e.field),r}(t.tf,this.rf,this.af);return new Id(t.firestore,t.j_,(e=(t=t.tf).Tn.concat([e]),new iu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},jd),Rd=(n(Ud,Sd=ge),Ud.prototype.sf=function(t){return new Id(t.firestore,t.j_,gu(t.tf,this.hf,this.lf))},Ud),Cd=(n(Md,Od=ge),Md.prototype.sf=function(t){var e=Fd(t,this.type,this._f,this.ff);return new Id(t.firestore,t.j_,(t=t.tf,new iu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Md),Ld=(n(Vd,Nd=ge),Vd.prototype.sf=function(t){var e=Fd(t,this.type,this._f,this.ff);return new Id(t.firestore,t.j_,(t=t.tf,new iu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Vd);function Vd(t,e,n){var r=this;return(r=Nd.call(this)||this).type=t,r._f=e,r.ff=n,r}function Md(t,e,n){var r=this;return(r=Od.call(this)||this).type=t,r._f=e,r.ff=n,r}function Ud(t,e,n){var r=this;return(r=Sd.call(this)||this).type=t,r.hf=e,r.lf=n,r}function jd(t,e){var n=this;return(n=Dd.call(this)||this).rf=t,n.af=e,n.type="orderBy",n}function qd(t,e,n){var r=this;return(r=xd.call(this)||this).rf=t,r.cf=e,r.uf=n,r.type="where",r}function Fd(t,c,e,n){if(e[0]instanceof Ml&&(e[0]=e[0].o_),e[0]instanceof Gp)return function(t,e,n,r){if(!n)throw new Lr(Cr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(To(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Lr(Cr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.J(),new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Gu(i,r)}(t.tf,t.firestore.R_,e[0].W_,n);var r=ny(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Lr(Cr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!du(t)&&-1!==c.indexOf("/"))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ti.Y(c));if(!ri.ot(h))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ri(h),u.push(To(e,h))}else c=vy(n,r,c),u.push(c)}return new Gu(u,o)}(t.tf,t.firestore.R_,r,c,e,n)}function Bd(t,e,n){if(n instanceof Ml&&(n=n.o_),"string"==typeof n){if(""===n)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ti.Y(n)),!ri.ot(e))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return To(t,new ri(e))}if(n instanceof _d)return To(t,n.K_);throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ap(n)+".")}function zd(t,e){if(!Array.isArray(t)||0===t.length)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Gd(t,e,n){if(!n.isEqual(e))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Kd(t){if(fu(t)&&0===t.Tn.length)throw new Lr(Cr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd,Hd=(n(Yd,Wd=Id),Object.defineProperty(Yd.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new _d(this.firestore,null,new ri(t))},enumerable:!1,configurable:!0}),Yd.prototype.withConverter=function(t){return new Yd(this.firestore,t,this.nf)},Yd);function Yd(t,e,n){var r=this;return(r=Wd.call(this,t,e,cu(n))||this).firestore=t,r.nf=n,r.type="collection",r}function Qd(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(rp("collection","path",e),t instanceof Sp){var i=ti.Y.apply(ti,s([e],n));return up(i),new Hd(t,null,i)}if(!(t instanceof _d||t instanceof Hd))throw new Lr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return up(e=ti.Y.apply(ti,s([t.path],n)).child(ti.Y(e))),new Hd(t.firestore,null,e)}function Xd(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Kr.D()),rp("doc","path",e),t instanceof Sp){var i=ti.Y.apply(ti,s([e],n));return sp(i),new _d(t,null,new ri(i))}if(!(t instanceof _d||t instanceof Hd))throw new Lr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return sp(e=t.nf.child(ti.Y.apply(ti,s([e],n)))),new _d(t.firestore,t instanceof Hd?t.j_:null,new ri(e))}var Jd,$d=(n(Zd,Jd=h),Zd.prototype.F_=function(t){return new Ap(t)},Zd.prototype.O_=function(t){return t=this.B_(t,this.firestore.R_),new _d(this.firestore,null,t)},Zd);function Zd(t){var e=this;return(e=Jd.call(this)||this).firestore=t,e}function ty(t,e){return(t instanceof _d||t instanceof Hd)&&(e instanceof _d||e instanceof Hd)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function ey(t,e){return t instanceof Id&&e instanceof Id&&t.firestore===e.firestore&&mu(t.tf,e.tf)&&t.j_===e.j_}function ny(t){var e=t.S_(),n=ca(t.R_);return new hy(t.R_,!!e.ignoreUndefinedProperties,n)}var ry=/^__.*__$/,iy=(uy.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new Cs(t,this.data,this.en,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new js(t,this.fieldTransforms)),n},uy),oy=(sy.prototype.ef=function(t,e){return e=[new Cs(t,this.data,this.en,e)],0<this.fieldTransforms.length&&e.push(new js(t,this.fieldTransforms)),e},sy);function sy(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function uy(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function ay(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xr()}}var cy=(Object.defineProperty(ly.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),ly.prototype.wf=function(t){return new ly(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},ly.prototype.Ef=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.wf({path:e,__:!1})).Tf(t),e},ly.prototype.If=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.wf({path:t,__:!1})).df(),t},ly.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},ly.prototype.h_=function(t){return Ty(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},ly.prototype.contains=function(e){return void 0!==this.en.find(function(t){return e.j(t)})||void 0!==this.fieldTransforms.find(function(t){return e.j(t.field)})},ly.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},ly.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(ay(this.a_)&&ry.test(t))throw this.h_('Document fields cannot begin and end with "__"')},ly),hy=(fy.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new cy({a_:t,methodName:e,l_:n,path:ni.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},fy);function fy(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ca(t)}function ly(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}function py(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);by("Data must be an object, but it was:",s,r);var u,a,r=my(r,s);if(o.merge)u=new _s(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=_y(e,f[h],n);if(!s.contains(l))throw new Lr(Cr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Ay(c,l)||c.push(l)}u=new _s(c),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new iy(new Ws(r),u,a)}function dy(t,r,i,e){var o=t.Rf(1,r,i);by("Data must be an object, but it was:",o,e);var s=[],u=new Hs;return co(e,function(t,e){var n=Ey(r,t,i);e instanceof Ml&&(e=e.o_),t=o.If(n),e instanceof pp?s.push(n):null!=(t=gy(e,t))&&(s.push(n),u.set(n,t))}),e=new _s(s),new oy(u.hn(),e,o.fieldTransforms)}function yy(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[_y(e,r,n)],a=[i];if(o.length%2!=0)throw new Lr(Cr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(_y(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Hs,y=u.length-1;0<=y;--y)Ay(p,u[y])||(h=u[y],(f=a[y])instanceof Ml&&(f=f.o_),l=s.If(h),f instanceof pp?p.push(h):null!=(l=gy(f,l))&&(p.push(h),d.set(h,l)));return i=new _s(p),new oy(d.hn(),i,s.fieldTransforms)}function vy(t,e,n,r){return void 0===r&&(r=!1),gy(n,t.Rf(r?4:3,e))}function gy(s,t){if(s instanceof Ml&&(s=s.o_),wy(s))return by("Unsupported field value:",t,s),my(s,t);if(s instanceof lp)return function(t,e){if(!ay(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");(t=t.u_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.en.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.a_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=gy(i[r],t.mf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Ml&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Lo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof Tp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ap)return{bytesValue:Mo(e.serializer,t.T_)};if(t instanceof _d){if(n=e.t,!(r=t.firestore.R_).isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+ap(t))}(s,t)}function my(t,n){var r={};return ho(t)?n.path&&0<n.path.length&&n.en.push(n.path):co(t,function(t,e){null!=(e=gy(e,n.Ef(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function wy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof Tp||t instanceof Ap||t instanceof _d||t instanceof lp)}function by(t,e,n){if(!wy(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=ap(n))?e.h_(t+" a custom object"):e.h_(t+" "+n);var r}function _y(t,e,n){if(e instanceof Ml&&(e=e.o_),e instanceof Zp)return e.G_;if("string"==typeof e)return Ey(t,e);throw Ty("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Iy=new RegExp("[~\\*/\\[\\]]");function Ey(e,n,r){if(0<=n.search(Iy))throw Ty("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Zp.bind.apply(Zp,s([void 0],n.split("."))))).G_}catch(t){throw Ty("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Ty(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Lr(Cr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Ay(t,e){return t.some(function(t){return t.isEqual(e)})}var Ny=(ky.prototype.pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),0<this.mutations.length)throw new Lr(Cr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ko((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Fo(r.serializer,t)})},[4,r.Ru("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),t=Uo(e.found.updateTime),e=new Ws({mapValue:{fields:e.found.fields}});return new eu(n,t,e,{})}(n,t):"missing"in t?(e=n,kr(!!(n=t).missing),kr(!!n.readTime),e=Bo(e,n.missing),n=Uo(n.readTime),new nu(e,n)):xr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){kr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Nu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof nu||t instanceof eu?n.bf(t):xr()}),e)]}})})},ky.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},ky.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},ky.prototype.delete=function(t){this.write([new Gs(t,this.rn(t))]),this.Vf.add(t.toString())},ky.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),this.yf)throw this.yf;return e=this.Pf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ri.st(e),n.mutations.push(new Ks(e,n.rn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.Au("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return t.sent(),this.gf=!0,[2]}})})},ky.prototype.bf=function(t){var e;if(t instanceof eu)e=t.version;else{if(!(t instanceof nu))throw xr();e=Zr.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Lr(Cr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},ky.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?As.updateTime(e):As.on()},ky.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(this.Vf.has(t.toString())||!e)return As.exists(!0);if(e.isEqual(Zr.min()))throw new Lr(Cr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},ky.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},ky.prototype.vf=function(){},ky),Oy=(xy.prototype.run=function(){this.Cf()},xy.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ny(this.Nu),(n=this.Nf(e))&&n.then(function(t){r.di.Ri(function(){return e.commit().then(function(){r.Ti.resolve(t)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},xy.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},xy.prototype.xf=function(t){var e=this;0<this.Df&&this.Ff(t)?(--this.Df,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},xy.prototype.Ff=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ti(t))},xy),Sy=(Dy.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},Dy.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},Dy.prototype.kf=function(){if(this.di.Ci)throw new Lr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},Dy.prototype.terminate=function(){var t=this;this.di.Oi();var n=new ra;return this.di.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=Ba(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Dy);function Dy(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=br.UNAUTHENTICATED,this.clientId=Kr.D(),this.Of=function(){},this.g=new ra,this.credentials.A(function(t){Nr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}function xy(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new ba(this.di,"transaction_retry")}function ky(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}function Py(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),Nr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Mf(function(e){return r.di.Mi(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Dh(i.Cu,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.tc(function(){return r.terminate()}),r.Lf=i,[2]}})})}function Ry(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),[4,Cy(r)];case 1:return e=t.sent(),Nr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Mf(function(t){return r.di.Mi(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).di.Li(),Nr("RemoteStore","RemoteStore received new credentials"),n=of(e),e.Mu.add(3),[4,Jh(e)];case 1:return t.sent(),n&&e.Bu.set("Unknown"),[4,e.xu.s_(i)];case 2:return t.sent(),e.Mu.delete(3),[4,Xh(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r.$f=i,[2]}})})}function Cy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Lf?[3,2]:(Nr("FirestoreClient","Using default OfflineComponentProvider"),[4,Py(e,new Pl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Lf]}})})}function Ly(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.$f?[3,2]:(Nr("FirestoreClient","Using default OnlineComponentProvider"),[4,Ry(e,new Ll)]);case 1:t.sent(),t.label=2;case 2:return[2,e.$f]}})})}function Vy(t){return Cy(t).then(function(t){return t.persistence})}function My(t){return Cy(t).then(function(t){return t.Cu})}function Uy(t){return Ly(t).then(function(t){return t.Oh})}function jy(t){return Ly(t).then(function(t){return t.ga})}function qy(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ly(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ju=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wa(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,kh(e.Cu,vu(u))];case 2:return i=t.sent(),o=e.kh.Wa(i.targetId),n=i.targetId,[4,Jf(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&$h(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ga),n.Zu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!mu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Ga(n.targetId),e.kh.Ba(n.targetId)?[3,2]:[4,Ph(e.Cu,n.targetId,!1).then(function(){e.kh.Ha(n.targetId),Zh(e.Oh,n.targetId),il(e,n.targetId)}).catch(Vh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return il(e,n.targetId),[4,Ph(e.Cu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ga),n)]}})})}function Fy(n,r,i,o,s){var t=new Vl({next:function(t){r.Ri(function(){return mf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Lr(Cr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Lr(Cr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new bf(cu(i.path),t,{includeMetadataChanges:!0,oa:!0});return gf(n,u)}function By(e,n,t,r,i){var o=new Vl({next:function(t){n.Ri(function(){return mf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Lr(Cr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new bf(t,o,{includeMetadataChanges:!0,oa:!0});return gf(e,s)}var zy=(Gy.prototype.set=function(t,e,n){return this.Kf(),e=Vv((t=Ky(t,this.U_)).j_,e,n),n=py(this.Qf,"WriteBatch.set",t.K_,e,null!==t.j_,n),this.qf=this.qf.concat(n.ef(t.K_,As.on())),this},Gy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Kf(),t=Ky(t,this.U_),e instanceof Ml&&(e=e.o_),e="string"==typeof e||e instanceof Zp?yy(this.Qf,"WriteBatch.update",t.K_,e,n,r):dy(this.Qf,"WriteBatch.update",t.K_,e),this.qf=this.qf.concat(e.ef(t.K_,As.exists(!0))),this},Gy.prototype.delete=function(t){return this.Kf(),t=Ky(t,this.U_),this.qf=this.qf.concat(new Gs(t.K_,As.on())),this},Gy.prototype.commit=function(){return this.Kf(),this.Uf=!0,0<this.qf.length?this.Bf(this.qf):Promise.resolve()},Gy.prototype.Kf=function(){if(this.Uf)throw new Lr(Cr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Gy);function Gy(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=ny(t)}function Ky(t,e){if(t instanceof Ml&&(t=t.o_),t.firestore!==e)throw new Lr(Cr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Wy,Hy,Yy=(tv.prototype.get=function(t){var e=this,n=Ky(t,this.U_),r=new $d(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return xr();if((t=t[0])instanceof nu)return new Gp(e.U_,r,n.K_,null,n.j_);if(t instanceof eu)return new Gp(e.U_,r,t.key,t,n.j_);throw xr()})},tv.prototype.set=function(t,e,n){return e=Vv((t=Ky(t,this.U_)).j_,e,n),n=py(this.Qf,"Transaction.set",t.K_,e,null!==t.j_,n),this.Wf.set(t.K_,n),this},tv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Ky(t,this.U_),e instanceof Ml&&(e=e.o_),e="string"==typeof e||e instanceof Zp?yy(this.Qf,"Transaction.update",t.K_,e,n,r):dy(this.Qf,"Transaction.update",t.K_,e),this.Wf.update(t.K_,e),this},tv.prototype.delete=function(t){return t=Ky(t,this.U_),this.Wf.delete(t.K_),this},n(Zy,Hy=tv),Zy.prototype.get=function(t){var e=this,n=Ky(t,this.U_),r=new yd(this.U_);return Hy.prototype.get.call(this,t).then(function(t){return new ud(e.U_,r,n.K_,t.W_,new _v(!1,!1),n.j_)})},Zy),Qy=($y.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){id(t);var n=ev(t),r=t.S_();return rd(n,t=new Ll,new Rl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},$y.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){id(t);var e=ev(t),n=t.S_();return rd(e,t=new Ll,new Cl(t,n.cacheSizeBytes))}(t.o_)},$y.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.y_&&!n.V_)throw new Lr(Cr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ra;return n.z_.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return _a.Gs()?(e=n+"main",[4,_a.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ah(n.R_,n.I_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},$y),Xy=(n(Jy,Wy=Ml),Object.defineProperty(Jy.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),Jy.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},Jy.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Sr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Jy.prototype.enableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Vy(r)];case 1:return e=t.sent(),[4,Uy(r)];case 2:return n=t.sent(),[2,(e.ec(!0),(t=n).Mu.delete(0),Xh(t))]}})})})}(ev(this.o_))},Jy.prototype.disableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Vy(r)];case 1:return e=t.sent(),[4,Uy(r)];case 2:return n=t.sent(),[2,(e.ec(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(0),[4,Jh(e)];case 1:return t.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(ev(this.o_))},Jy.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&op("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},Jy.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},Jy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},Jy.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ra;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=el,[4,jy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ev(this.o_))},Jy.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=ev(t),e=ha(e)?e:{next:e},i=new Vl(e);return t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.add(e),e.next()},[4,qy(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.delete(e)},[4,qy(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(Jy.prototype,"app",{get:function(){if(!this.Gf)throw new Lr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),Jy.prototype.collection=function(t){try{return new Ov(this,Qd(this.o_,t))}catch(t){throw lv(t,"collection()","Firestore.collection()")}},Jy.prototype.doc=function(t){try{return new av(this,Xd(this.o_,t))}catch(t){throw lv(t,"doc()","Firestore.doc()")}},Jy.prototype.collectionGroup=function(t){try{return new Tv(this,function(t,e){if(rp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Lr(Cr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Id(t,null,new iu(ti.X(),e))}(this.o_,t))}catch(t){throw lv(t,"collectionGroup()","Firestore.collectionGroup()")}},Jy.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ra;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Ly(n).then(function(t){return t.Nu})];case 1:return e=t.sent(),new Oy(n.di,e,r,i).run(),[2]}})})}),i.promise}(ev(n=this.o_),function(t){return t=new Yy(n,t),e(new sv(r,t))})},Jy.prototype.batch=function(){var e=this;return ev(this.o_),new uv(new zy(this.o_,function(t){return wd(e.o_,t)}))},Jy);function Jy(t,e,n){var r=this;return(r=Wy.call(this,e)||this).jf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof wr||(r.Gf=t),r}function $y(){}function Zy(t,e){var n=this;return(n=Hy.call(this,t,e)||this).U_=t,n}function tv(t,e){this.U_=t,this.Wf=e,this.Qf=ny(t)}function ev(t){return t.H_||nv(t),t.H_.kf(),t.H_}function nv(t){var e,n,r=t.S_(),r=(e=t.R_,n=t.I_,new mr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.H_=new Sy(t.P_,t.z_,r)}var rv,iv,ov,sv=(n(fv,ov=Ml),fv.prototype.get=function(t){var e=this,t=Lv(t);return this.o_.get(t).then(function(t){return new Iv(e.U_,t)})},fv.prototype.set=function(t,e,n){return t=Lv(t),n?(ip("Transaction.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},fv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Lv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},fv.prototype.delete=function(t){return t=Lv(t),this.o_.delete(t),this},fv),uv=(n(hv,iv=Ml),hv.prototype.set=function(t,e,n){return t=Lv(t),n?(ip("WriteBatch.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},hv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Lv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},hv.prototype.delete=function(t){return t=Lv(t),this.o_.delete(t),this},hv.prototype.commit=function(){return this.o_.commit()},hv),av=(n(cv,rv=Ml),cv.zf=function(t,e,n){if(t.length%2!=0)throw new Lr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new cv(e,new _d(e.o_,n,new ri(t)))},cv.q_=function(t,e,n){return new cv(e,new _d(e.o_,n,t))},Object.defineProperty(cv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"parent",{get:function(){return new Ov(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),cv.prototype.collection=function(t){try{return new Ov(this.firestore,Qd(this.o_,t))}catch(t){throw lv(t,"collection()","DocumentReference.collection()")}},cv.prototype.isEqual=function(t){return t instanceof Ml&&(t=t.o_),t instanceof _d&&ty(this.o_,t)},cv.prototype.set=function(t,e){e=ip("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=cp(n.firestore,td),r=Vv(n.j_,r,i),wd(o,py(ny(o),"setDoc",n.K_,r,null!==n.j_,i).ef(n.K_,As.on()))}catch(t){throw lv(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},cv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?gd(this.o_,t):gd.apply(void 0,s([this.o_,t,e],n))}catch(t){throw lv(t,"updateDoc()","DocumentReference.update()")}},cv.prototype.delete=function(){return wd(cp((t=this.o_).firestore,td),[new Gs(t.K_,As.on())]);var t},cv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=pv(t),i=dv(t,function(t){return new Iv(e.firestore,new ud(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))});return md(this.o_,r,i)},cv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new yd(n),o=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,My(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)}))];case 1:return(r=t.sent())instanceof eu?s.resolve(r):r instanceof nu?s.resolve(null):s.reject(new Lr(Cr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ba(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.K_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new ud(n,i,e.K_,t,new _v(t instanceof eu&&t.an,!0),e.j_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,qy(r)];case 1:return[4,Fy(t.sent(),n.z_,e.K_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return bd(n,e,t)})}:function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,qy(r)];case 1:return[4,Fy(t.sent(),n.z_,e.K_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return bd(n,e,t)})})(this.o_).then(function(t){return new Iv(e.firestore,new ud(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},cv.prototype.withConverter=function(t){return new cv(this.firestore,this.o_.withConverter(t))},cv);function cv(t,e){var n=this;return(n=rv.call(this,e)||this).firestore=t,n.Q_=new zp(t),n}function hv(){return null!==iv&&iv.apply(this,arguments)||this}function fv(t,e){var n=this;return(n=ov.call(this,e)||this).U_=t,n}function lv(t,e,n){return t.message=t.message.replace(e,n),t}function pv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ha(r))return r}return{}}function dv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ha(t[0])?t[0]:ha(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var yv,vv,gv,mv,wv,bv,_v=(Cv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Cv),Iv=(n(Rv,bv=Ml),Object.defineProperty(Rv.prototype,"ref",{get:function(){return new av(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Rv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Rv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Rv.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Rv.prototype.data=function(t){return this.o_.data(t)},Rv.prototype.get=function(t,e){return this.o_.get(t,e)},Rv.prototype.isEqual=function(t){return pd(this.o_,t.o_)},Rv),Ev=(n(Pv,wv=Iv),Pv.prototype.data=function(t){return this.o_.data(t)},Pv),Tv=(n(kv,mv=Ml),kv.prototype.where=function(t,e,n){try{return new kv(this.firestore,Ad(this.o_,(r=n,i=e,o=Jp("where",t),new kd(o,i,r))))}catch(t){throw lv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},kv.prototype.orderBy=function(n,t){try{return new kv(this.firestore,Ad(this.o_,function(t){void 0===t&&(t="asc");var e=t,t=Jp("orderBy",n);return new Pd(t,e)}(t)))}catch(n){throw lv(n,/(orderBy|where)\(\)/,"Query.$1()")}},kv.prototype.limit=function(t){try{return new kv(this.firestore,Ad(this.o_,(hp("limit",e=t),new Rd("limit",e,"F"))))}catch(t){throw lv(t,"limit()","Query.limit()")}var e},kv.prototype.limitToLast=function(t){try{return new kv(this.firestore,Ad(this.o_,(hp("limitToLast",e=t),new Rd("limitToLast",e,"L"))))}catch(t){throw lv(t,"limitToLast()","Query.limitToLast()")}var e},kv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new kv(this.firestore,Ad(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw lv(t,"startAt()","Query.startAt()")}},kv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new kv(this.firestore,Ad(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw lv(t,"startAfter()","Query.startAfter()")}},kv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new kv(this.firestore,Ad(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ld("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw lv(t,"endBefore()","Query.endBefore()")}},kv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new kv(this.firestore,Ad(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ld("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw lv(t,"endAt()","Query.endAt()")}},kv.prototype.isEqual=function(t){return ey(this.o_,t.o_)},kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new yd(n),o=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,My(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Rh(r,i,!0)];case 1:return n=t.sent(),e=new Uf(i,n.Bc),n=e.gh(n.documents),n=e.Zn(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ba(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.tf,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new cd(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new yd(n),o=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,qy(r)];case 1:return[4,By(t.sent(),n.z_,e.tf,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new cd(n,i,e,t)})}:function(e){var t=this,n=cp(e.firestore,td),r=ev(n),i=new yd(n);Kd(e.tf);var o=new ra;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,qy(r)];case 1:return[4,By(t.sent(),n.z_,e.tf,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new cd(n,i,e,t)})})(this.o_).then(function(t){return new Nv(e.firestore,t)})},kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=pv(t),i=dv(t,function(t){return new Nv(e.firestore,t)});return md(this.o_,r,i)},kv.prototype.withConverter=function(t){return new kv(this.firestore,this.o_.withConverter(t))},kv),Av=(n(xv,gv=Ml),Object.defineProperty(xv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(xv.prototype,"doc",{get:function(){return new Ev(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(xv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(xv.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),xv),Nv=(n(Dv,vv=Ml),Object.defineProperty(Dv.prototype,"query",{get:function(){return new Tv(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Dv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Dv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Dv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Dv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Ev(e.U_,t)})},enumerable:!1,configurable:!0}),Dv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new Av(e.U_,t)})},Dv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Ev(r.U_,t))})},Dv.prototype.isEqual=function(t){return pd(this.o_,t.o_)},Dv),Ov=(n(Sv,yv=Tv),Object.defineProperty(Sv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Sv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Sv.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new av(this.firestore,t):null},enumerable:!1,configurable:!0}),Sv.prototype.doc=function(t){try{return new av(this.firestore,void 0===t?Xd(this.o_):Xd(this.o_,t))}catch(t){throw lv(t,"doc()","CollectionReference.doc()")}},Sv.prototype.add=function(t){var e,n=this,r=this.o_,i=t;return t=cp(r.firestore,td),e=Xd(r),i=Vv(r.j_,i),wd(t,py(ny(r.firestore),"addDoc",e.K_,i,null!==r.j_,{}).ef(e.K_,As.exists(!1))).then(function(){return e}).then(function(t){return new av(n.firestore,t)})},Sv.prototype.isEqual=function(t){return ty(this.o_,t.o_)},Sv.prototype.withConverter=function(t){return new Sv(this.firestore,this.o_.withConverter(t))},Sv);function Sv(t,e){var n=this;return(n=yv.call(this,t,e)||this).firestore=t,n.o_=e,n}function Dv(t,e){var n=this;return(n=vv.call(this,e)||this).U_=t,n}function xv(t,e){var n=this;return(n=gv.call(this,e)||this).U_=t,n}function kv(t,e){var n=this;return(n=mv.call(this,e)||this).firestore=t,n}function Pv(){return null!==wv&&wv.apply(this,arguments)||this}function Rv(t,e){var n=this;return(n=bv.call(this,e)||this).U_=t,n}function Cv(t,e){this.hasPendingWrites=t,this.fromCache=e}function Lv(t){return t instanceof Ml&&(t=t.o_),cp(t,_d)}function Vv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Mv,Uv,ge=(n(qv,Uv=Ml),qv.documentId=function(){return new qv(ni.et().J())},qv.prototype.isEqual=function(t){return t instanceof Ml&&(t=t.o_),t instanceof Zp&&this.o_.G_.isEqual(t.G_)},qv),h=(n(jv,Mv=Ml),jv.serverTimestamp=function(){var t=new bp("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new jv(t)},jv.delete=function(){var t=new pp("deleteField");return t.c_="FieldValue.delete",new jv(t)},jv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _p("arrayUnion",t)}.apply(void 0,t);return n.c_="FieldValue.arrayUnion",new jv(n)},jv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ip("arrayRemove",t)}.apply(void 0,t);return n.c_="FieldValue.arrayRemove",new jv(n)},jv.increment=function(t){return(t=new Ep("increment",t)).c_="FieldValue.increment",new jv(t)},jv.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},jv),h={Firestore:Xy,GeoPoint:Tp,Timestamp:$r,Blob:Bp,Transaction:sv,WriteBatch:uv,DocumentReference:av,DocumentSnapshot:Iv,Query:Tv,QueryDocumentSnapshot:Ev,QuerySnapshot:Nv,CollectionReference:Ov,FieldPath:ge,FieldValue:h,setLogLevel:function(t){Tr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function jv(){return null!==Mv&&Mv.apply(this,arguments)||this}function qv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Uv.call(this,new(Zp.bind.apply(Zp,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new A("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Xy(e,new td(e,t),new Qy);var e},"PUBLIC").setServiceProps(Object.assign({},h))),e.registerVersion("@firebase/firestore","2.0.4-2020102005919")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});