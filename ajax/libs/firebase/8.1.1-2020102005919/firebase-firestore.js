!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ug){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(ug),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=N||self;function D(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:L).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var X=S.navigator;if(X){X=X.userAgent;if(X){W=X;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Y(W,"Opera"),it=Y(W,"Trident")||Y(W,"MSIE"),ot=Y(W,"Edge"),st=ot||it,ut=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),at=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=W,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=S.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),It=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[_t]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[_t]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Lt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):Tt(t)))}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Lt(t,e){if(t.Y)return!0;if(yt)return Ct(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new wt(e,this))}function Vt(t){return(t=t[St])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[_t]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function zt(){this.b=this.a=null}var Gt,Kt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Ht},function(t){t.reset()}));function Wt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Jt)}),Qt||(Gt(),Qt=!0),Xt.add(t,e)}zt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new zt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Kt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=U()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(E(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ee={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Oe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){mt.call(this,"d")}function De(){mt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Se,mt),j(De,mt),j(xe,Te),Oe=new xe;var Pe=45e3,Re={},Ce={};function Le(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=U()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(V(t.Va,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(V(u.Sa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Qn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=Ke.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Qe(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function kn(t){jt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}j(kn,jt);var Pn="",Rn=/^https?$/i,Cn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Hn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Qn(t)}function Qn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Jn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,qt(i=ye(),new be(i)),Qn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Qe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,S.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Hn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Qe?Xe(s):new Qe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Qe(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Oe),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},A.Ua=function(){Un(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Qn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Se),j(dr,De),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=ye,gr=Ie,mr=Ee,wr=pe,br=10,_r=11,Ir=Ne,Er=kn,Tr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Nr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Or=(Object.defineProperty(xr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),xr.prototype.isEqual=function(t){return t instanceof xr&&t.projectId===this.projectId&&t.database===this.database},xr),Sr=(Dr.prototype.u=function(){return null!=this.uid},Dr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Dr.prototype.isEqual=function(t){return t.uid===this.uid},Dr);function Dr(t){this.uid=t}function xr(t,e){this.projectId=t,this.database=e||"(default)"}Sr.UNAUTHENTICATED=new Sr(null),Sr.l=new Sr("google-credentials-uid"),Sr._=new Sr("first-party-uid");var kr="8.1.1-2020102005919",Pr=new h("@firebase/firestore");function Rr(){return Pr.logLevel}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=l.DEBUG&&(e=n.map(Mr),Pr.debug.apply(Pr,s(["Firestore ("+kr+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=l.ERROR&&(e=n.map(Mr),Pr.error.apply(Pr,s(["Firestore ("+kr+"): "+t],e)))}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=l.WARN&&(e=n.map(Mr),Pr.warn.apply(Pr,s(["Firestore ("+kr+"): "+t],e)))}function Mr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ur(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+kr+") INTERNAL ASSERTION FAILED: "+t;throw Lr(t),new Error(t)}function jr(t){t||Ur()}function qr(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t}var Fr,Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},zr=(n($r,Fr=Error),$r),Gr=(Jr.prototype.getToken=function(){return Promise.resolve(null)},Jr.prototype.m=function(){},Jr.prototype.A=function(t){(this.I=t)(Sr.UNAUTHENTICATED)},Jr.prototype.R=function(){this.I=null},Jr),Kr=(Xr.prototype.getToken=function(){var e=this,n=this.V,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.V!==n?(Cr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(jr("string"==typeof t.accessToken),new qr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Xr.prototype.m=function(){this.forceRefresh=!0},Xr.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},Xr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},Xr.prototype.p=function(){var t=this.auth&&this.auth.getUid();return jr(null===t||"string"==typeof t),new Sr(t)},Xr),Wr=(Object.defineProperty(Qr.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Qr),Hr=(Yr.prototype.getToken=function(){return Promise.resolve(new Wr(this.v,this.S))},Yr.prototype.A=function(t){t(Sr._)},Yr.prototype.R=function(){},Yr.prototype.m=function(){},Yr);function Yr(t,e){this.v=t,this.S=e}function Qr(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Sr._}function Xr(t){var e=this;this.P=null,this.currentUser=Sr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Jr(){this.I=null}function $r(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Zr=(ti.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},ti);function ti(){}function ei(t,e){return t<e?-1:e<t?1:0}function ni(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function ri(t){return t+"\0"}var ii,oi,si=(gi.now=function(){return gi.fromMillis(Date.now())},gi.fromDate=function(t){return gi.fromMillis(t.getTime())},gi.fromMillis=function(t){var e=Math.floor(t/1e3);return new gi(e,1e6*(t-1e3*e))},gi.prototype.toDate=function(){return new Date(this.toMillis())},gi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},gi.prototype.C=function(t){return this.seconds===t.seconds?ei(this.nanoseconds,t.nanoseconds):ei(this.seconds,t.seconds)},gi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},gi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},gi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},gi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},gi),ui=(vi.N=function(t){return new vi(t)},vi.min=function(){return new vi(new si(0,0))},vi.prototype.F=function(t){return this.timestamp.C(t.timestamp)},vi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},vi.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},vi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},vi.prototype.M=function(){return this.timestamp},vi),Ie=(Object.defineProperty(yi.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),yi.prototype.isEqual=function(t){return 0===yi.$(this,t)},yi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof yi?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},yi.prototype.limit=function(){return this.offset+this.length},yi.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},yi.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},yi.prototype.U=function(){return this.segments[this.offset]},yi.prototype.K=function(){return this.get(this.length-1)},yi.prototype.get=function(t){return this.segments[this.offset+t]},yi.prototype.W=function(){return 0===this.length},yi.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},yi.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},yi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},yi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},yi.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},yi),ai=(n(di,oi=Ie),di.prototype.L=function(t,e,n){return new di(t,e,n)},di.prototype.J=function(){return this.H().join("/")},di.prototype.toString=function(){return this.J()},di.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new zr(Br.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new di(n)},di.X=function(){return new di([])},di),ci=/^[_a-zA-Z][_a-zA-Z0-9]*$/,hi=(n(pi,ii=Ie),pi.prototype.L=function(t,e,n){return new pi(t,e,n)},pi.Z=function(t){return ci.test(t)},pi.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),pi.Z(t)||(t="`"+t+"`"),t}).join(".")},pi.prototype.toString=function(){return this.J()},pi.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},pi.et=function(){return new pi(["__name__"])},pi.nt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new zr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new zr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new zr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new pi(e)},pi.X=function(){return new pi([])},pi),fi=(li.st=function(t){return new li(ai.Y(t))},li.it=function(t){return new li(ai.Y(t).B(5))},li.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},li.prototype.isEqual=function(t){return null!==t&&0===ai.$(this.path,t.path)},li.prototype.toString=function(){return this.path.toString()},li.$=function(t,e){return ai.$(t.path,e.path)},li.ot=function(t){return t.length%2==0},li.ct=function(t){return new li(new ai(t.slice()))},li);function li(t){this.path=t}function pi(){return null!==ii&&ii.apply(this,arguments)||this}function di(){return null!==oi&&oi.apply(this,arguments)||this}function yi(t,e,n){void 0===e?e=0:e>t.length&&Ur(),void 0===n?n=t.length-e:n>t.length-e&&Ur(),this.segments=t,this.offset=e,this.k=n}function vi(t){this.timestamp=t}function gi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new zr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new zr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new zr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new zr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function mi(t){return null==t}function wi(t){return 0===t&&1/t==-1/0}function bi(t){return"number"==typeof t&&Number.isInteger(t)&&!wi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var _i=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function Ii(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new _i(t,e,n,r,i,o,s)}function Ei(t){var e=t;return null===e.ut&&(t=e.path.J(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.J()+t.op.toString()+So(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.J()+t.dir}).join(","),mi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=oa(e.startAt)),e.endAt&&(t+="|ub:",t+=oa(e.endAt)),e.ut=t),e.ut}function Ti(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!To(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ua(t.startAt,e.startAt)&&ua(t.endAt,e.endAt)}function Ai(t){return fi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ni=(Oi.fromBase64String=function(t){return new Oi(atob(t))},Oi.fromUint8Array=function(t){return new Oi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Oi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Oi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Oi.prototype.ht=function(){return 2*this.at.length},Oi.prototype.F=function(t){return ei(this.at,t.at)},Oi.prototype.isEqual=function(t){return this.at===t.at},Oi);function Oi(t){this.at=t}Ni.lt=new Ni("");function Si(t){this.count=t}var Di,xi=(ki.prototype.dt=function(t){return new ki(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ki.prototype.wt=function(t,e){return new ki(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ki.prototype.Et=function(t){return new ki(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},ki);function ki(t,e,n,r,i,o,s){void 0===i&&(i=ui.min()),void 0===o&&(o=ui.min()),void 0===s&&(s=Ni.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Pi(t){switch(t){case Br.OK:return Ur(),0;case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return 1;default:return Ur(),0}}function Ri(t){if(void 0===t)return Lr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case Di.OK:return Br.OK;case Di.CANCELLED:return Br.CANCELLED;case Di.UNKNOWN:return Br.UNKNOWN;case Di.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case Di.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case Di.INTERNAL:return Br.INTERNAL;case Di.UNAVAILABLE:return Br.UNAVAILABLE;case Di.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case Di.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case Di.NOT_FOUND:return Br.NOT_FOUND;case Di.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case Di.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case Di.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case Di.ABORTED:return Br.ABORTED;case Di.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case Di.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case Di.DATA_LOSS:return Br.DATA_LOSS;default:return Ur()}}(Ee=Di=Di||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Ci=(ji.prototype.Tt=function(t,e){return new ji(this.$,this.root.Tt(t,e,this.$).copy(null,null,Vi.It,null,null))},ji.prototype.remove=function(t){return new ji(this.$,this.root.remove(t,this.$).copy(null,null,Vi.It,null,null))},ji.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ji.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ji.prototype.W=function(){return this.root.W()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ji.prototype.At=function(){return this.root.At()},ji.prototype.Rt=function(){return this.root.Rt()},ji.prototype.Pt=function(t){return this.root.Pt(t)},ji.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},ji.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ji.prototype.gt=function(t){return this.root.gt(t)},ji.prototype.yt=function(){return new Li(this.root,null,this.$,!1)},ji.prototype.Vt=function(t){return new Li(this.root,t,this.$,!1)},ji.prototype.vt=function(){return new Li(this.root,null,this.$,!0)},ji.prototype.bt=function(t){return new Li(this.root,t,this.$,!0)},ji),Li=(Ui.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},Ui.prototype.Nt=function(){return 0<this.Dt.length},Ui.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},Ui),Vi=(Mi.prototype.copy=function(t,e,n,r,i){return new Mi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Mi.prototype.W=function(){return!1},Mi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Mi.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},Mi.prototype.min=function(){return this.left.W()?this:this.left.min()},Mi.prototype.At=function(){return this.min().key},Mi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Mi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Mi.prototype.Ot=function(){if(this.left.W())return Mi.EMPTY;var t=this;return t.left.Mt()||t.left.left.Mt()||(t=t.kt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Mi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Mt()||r.left.left.Mt()||(r=r.kt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Mt()&&(r=r.$t()),r.right.W()||r.right.Mt()||r.right.left.Mt()||(r=r.Lt()),0===e(t,r.key)){if(r.right.W())return Mi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Mi.prototype.Mt=function(){return this.color},Mi.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},Mi.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},Mi.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},Mi.prototype.Bt=function(){var t=this.copy(null,null,Mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Mi.prototype.$t=function(){var t=this.copy(null,null,Mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Mi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Mi.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Mi.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Ur();if(this.right.Mt())throw Ur();var t=this.left.Qt();if(t!==this.right.Qt())throw Ur();return t+(this.Mt()?0:1)},Mi);function Mi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Mi.RED,this.left=null!=r?r:Mi.EMPTY,this.right=null!=i?i:Mi.EMPTY,this.size=this.left.size+1+this.right.size}function Ui(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}function ji(t,e){this.$=t,this.root=e||Vi.EMPTY}function qi(){this.size=0}Vi.EMPTY=null,Vi.RED=!0,Vi.It=!1,Vi.EMPTY=(Object.defineProperty(qi.prototype,"key",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(qi.prototype,"value",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(qi.prototype,"color",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(qi.prototype,"left",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(qi.prototype,"right",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),qi.prototype.copy=function(t,e,n,r,i){return this},qi.prototype.Tt=function(t,e,n){return new Vi(t,e)},qi.prototype.remove=function(t,e){return this},qi.prototype.W=function(){return!0},qi.prototype.Pt=function(t){return!1},qi.prototype.gt=function(t){return!1},qi.prototype.At=function(){return null},qi.prototype.Rt=function(){return null},qi.prototype.Mt=function(){return!1},qi.prototype.Ut=function(){return!0},qi.prototype.Qt=function(){return 0},new qi);var Fi=(Ki.prototype.has=function(t){return null!==this.data.get(t)},Ki.prototype.first=function(){return this.data.At()},Ki.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Ki.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ki.prototype.indexOf=function(t){return this.data.indexOf(t)},Ki.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Ki.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(0<=this.$(r.key,t[1]))return;e(r.key)}},Ki.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},Ki.prototype.jt=function(t){t=this.data.Vt(t);return t.Nt()?t.Ct().key:null},Ki.prototype.yt=function(){return new Bi(this.data.yt())},Ki.prototype.Vt=function(t){return new Bi(this.data.Vt(t))},Ki.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Ki.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ki.prototype.W=function(){return this.data.W()},Ki.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ki.prototype.isEqual=function(t){if(!(t instanceof Ki))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(0!==this.$(r,i))return!1}return!0},Ki.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ki.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ki.prototype.copy=function(t){var e=new Ki(this.$);return e.data=t,e},Ki),Bi=(Gi.prototype.Ct=function(){return this.zt.Ct().key},Gi.prototype.Nt=function(){return this.zt.Nt()},Gi),zi=new Ci(fi.$);function Gi(t){this.zt=t}function Ki(t){this.$=t,this.data=new Ci(this.$)}var Wi=new Ci(fi.$);var Hi=new Ci(fi.$),Yi=new Fi(fi.$);function Qi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Yi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Xi=new Fi(ei);var Ji=(po.Yt=function(t){return new po(t.$)},po.prototype.has=function(t){return null!=this.Ht.get(t)},po.prototype.get=function(t){return this.Ht.get(t)},po.prototype.first=function(){return this.Jt.At()},po.prototype.last=function(){return this.Jt.Rt()},po.prototype.W=function(){return this.Jt.W()},po.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Jt.indexOf(t):-1},Object.defineProperty(po.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),po.prototype.forEach=function(n){this.Jt.Pt(function(t,e){return n(t),!1})},po.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},po.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},po.prototype.isEqual=function(t){if(!(t instanceof po))return!1;if(this.size!==t.size)return!1;for(var e=this.Jt.yt(),n=t.Jt.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(!r.isEqual(i))return!1}return!0},po.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},po.prototype.copy=function(t,e){var n=new po;return n.$=this.$,n.Ht=t,n.Jt=e,n},po),$i=(lo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Ur()},lo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},lo),Zi=(fo.ie=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new fo(t,e,Ji.Yt(e),i,n,r,!0,!1)},Object.defineProperty(fo.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),fo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},fo),to=(ho.ae=function(t,e){var n=new Map;return n.set(t,eo.he(t,e)),new ho(ui.min(),n,Xi,zi,Qi())},ho),eo=(co.he=function(t,e){return new co(Ni.lt,e,Qi(),Qi(),Qi())},co),no=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},ro=function(t,e){this.targetId=t,this.Te=e},io=function(t,e,n,r){void 0===n&&(n=Ni.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},oo=(Object.defineProperty(ao.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),ao.prototype.Ve=function(t){0<t.ht()&&(this.Pe=!0,this.Ae=t)},ao.prototype.pe=function(){var n=Qi(),r=Qi(),i=Qi();return this.me.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ur()}}),new eo(this.Ae,this.Re,n,r,i)},ao.prototype.ve=function(){this.Pe=!1,this.me=vo()},ao.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},ao.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},ao.prototype.De=function(){this.Ie+=1},ao.prototype.Ce=function(){--this.Ie},ao.prototype.Ne=function(){this.Pe=!0,this.Re=!0},ao),so=(uo.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof fu?this.Le(r,t.Ee):t.Ee instanceof lu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},uo.prototype.qe=function(n){var r=this;this.Ue(n,function(t){var e=r.Qe(t);switch(n.state){case 0:r.Ke(t)&&e.Ve(n.resumeToken);break;case 1:e.Ce(),e.ge||e.ve(),e.Ve(n.resumeToken);break;case 2:e.Ce(),e.ge||r.removeTarget(t);break;case 3:r.Ke(t)&&(e.Ne(),e.Ve(n.resumeToken));break;case 4:r.Ke(t)&&(r.We(t),e.Ve(n.resumeToken));break;default:Ur()}})},uo.prototype.Ue=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fe.forEach(function(t,e){r.Ke(e)&&n(e)})},uo.prototype.je=function(t){var e=t.targetId,n=t.Te.count,t=this.Ge(e);t&&(Ai(t=t.target)?0===n?(t=new fi(t.path),this.Be(e,t,new lu(t,ui.min()))):jr(1===n):this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e)))},uo.prototype.He=function(r){var i=this,o=new Map;this.Fe.forEach(function(t,e){var n=i.Ge(e);n&&(t.le&&Ai(n.target)&&(n=new fi(n.target.path),null!==i.Oe.get(n)||i.Je(e,n)||i.Be(e,n,new lu(n,r))),t.ye&&(o.set(e,t.pe()),t.ve()))});var s=Qi();this.Me.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.Ge(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new to(r,o,this.ke,this.Oe,s);return this.Oe=zi,this.Me=yo(),this.ke=new Fi(ei),t},uo.prototype.Le=function(t,e){var n;this.Ke(t)&&(n=this.Je(t,e.key)?2:0,this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t)))},uo.prototype.Be=function(t,e,n){var r;this.Ke(t)&&(r=this.Qe(t),this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n)))},uo.prototype.removeTarget=function(t){this.Fe.delete(t)},uo.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},uo.prototype.De=function(t){this.Qe(t).De()},uo.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new oo,this.Fe.set(t,e)),e},uo.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Fi(ei),this.Me=this.Me.Tt(t,e)),e},uo.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Cr("WatchChangeAggregator","Detected inactive target",t),e},uo.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},uo.prototype.We=function(e){var n=this;this.Fe.set(e,new oo),this.xe.Xe(e).forEach(function(t){n.Be(e,t,null)})},uo.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},uo);function uo(t){this.xe=t,this.Fe=new Map,this.Oe=zi,this.Me=yo(),this.ke=new Fi(ei)}function ao(){this.Ie=0,this.me=vo(),this.Ae=Ni.lt,this.Re=!1,this.Pe=!0}function co(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}function ho(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}function fo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}function lo(){this.Xt=new Ci(fi.$)}function po(n){this.$=n?function(t,e){return n(t,e)||fi.$(t.key,e.key)}:function(t,e){return fi.$(t.key,e.key)},this.Ht=Wi,this.Jt=new Ci(this.$)}function yo(){return new Ci(fi.$)}function vo(){return new Ci(fi.$)}function go(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function mo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function wo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function _o(t){t=Do(t.mapValue.fields.__local_write_time__.timestampValue);return new si(t.seconds,t.nanos)}var Io=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Eo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bo(t)?4:10:Ur()}function To(r,i){var t,e=Eo(r);if(e!==Eo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return _o(r).isEqual(_o(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Do(r.timestampValue),t=Do(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,ko(r.bytesValue).isEqual(ko(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,xo((t=r).geoPointValue.latitude)===xo(e.geoPointValue.latitude)&&xo(t.geoPointValue.longitude)===xo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return xo(t.integerValue)===xo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=xo(t.doubleValue),e=xo(e.doubleValue);return t===e?wi(t)===wi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return ni(r.arrayValue.values||[],i.arrayValue.values||[],To);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(go(e)!==go(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!To(e[t],n[t])))return!1;return!0}();default:return Ur()}}function Ao(t,e){return void 0!==(t.values||[]).find(function(t){return To(t,e)})}function No(t,e){var n,r,i=Eo(t),o=Eo(e);if(i!==o)return ei(i,o);switch(i){case 0:return 0;case 1:return ei(t.booleanValue,e.booleanValue);case 2:return n=e,r=xo(t.integerValue||t.doubleValue),n=xo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Oo(t.timestampValue,e.timestampValue);case 4:return Oo(_o(t),_o(e));case 5:return ei(t.stringValue,e.stringValue);case 6:return function(t,e){t=ko(t),e=ko(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ei(n[i],r[i]);if(0!==o)return o}return ei(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=ei(xo(i.latitude),xo(r.latitude)))?n:ei(xo(i.longitude),xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=No(n[i],r[i]);if(o)return o}return ei(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ei(r[s],o[s]);if(0!==u)return u;u=No(n[r[s]],i[o[s]]);if(0!==u)return u}return ei(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ur()}}function Oo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ei(t,e);var n=Do(t),t=Do(e),e=ei(n.seconds,t.seconds);return 0!==e?e:ei(n.nanos,t.nanos)}function So(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Do(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ko(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,fi.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Ur();var e}(t)}function Do(t){if(jr(!!t),"string"!=typeof t)return{seconds:xo(t.seconds),nanos:xo(t.nanos)};var e=0,n=Io.exec(t);jr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ko(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function Po(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Ro(t){return t&&"integerValue"in t}function Co(t){return!!t&&"arrayValue"in t}function Lo(t){return t&&"nullValue"in t}function Vo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mo(t){return t&&"mapValue"in t}var Uo={asc:"ASCENDING",desc:"DESCENDING"},jo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qo=function(t,e){this.t=t,this.tn=e};function Fo(t){return{integerValue:""+t}}function Bo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wi(e)?"-0":e}}function zo(t,e){return bi(e)?Fo(e):Bo(t,e)}function Go(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ko(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Wo(t){return jr(!!t),ui.N((t=Do(t),new si(t.seconds,t.nanos)))}function Ho(t,e){return new ai(["projects",t.projectId,"databases",t.database]).child("documents").child(e).J()}function Yo(t){t=ai.Y(t);return jr(ls(t)),t}function Qo(t,e){return Ho(t.t,e.path)}function Xo(t,e){e=Yo(e);if(e.get(1)!==t.t.projectId)throw new zr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new zr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new fi(ts(e))}function Jo(t,e){return Ho(t.t,e)}function $o(t){t=Yo(t);return 4===t.length?ai.X():ts(t)}function Zo(t){return new ai(["projects",t.t.projectId,"databases",t.t.database]).J()}function ts(t){return jr(4<t.length&&"documents"===t.get(4)),t.B(5)}function es(t,e,n){return{name:Qo(t,e),fields:n.proto.mapValue.fields}}function ns(t,e){var n,r,i;if(e instanceof zs)n={update:es(t,e.key,e.value)};else if(e instanceof tu)n={delete:Qo(t,e.key)};else if(e instanceof Gs)n={update:es(t,e.key,e.data),updateMask:(i=e.en,r=[],i.fields.forEach(function(t){return r.push(t.J())}),{fieldPaths:r})};else if(e instanceof Qs)n={transform:{document:Qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof vs)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof gs)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof Is)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof Ns)return{fieldPath:t.field.J(),increment:e.nn};throw Ur()})}};else{if(!(e instanceof eu))return Ur();n={verify:Qo(t,e.key)}}return e.rn.sn||(n.currentDocument=void 0!==(i=e.rn).updateTime?{updateTime:(e=t,t=i.updateTime,Go(e,t.M()))}:void 0!==i.exists?{exists:i.exists}:Ur()),n}function rs(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Cs.updateTime(Wo(o.updateTime)):void 0!==o.exists?Cs.exists(o.exists):Cs.on():Cs.on();if(t.update){t.update.name;var r=Xo(e,t.update.name),i=new nu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new xs(o.map(function(t){return hi.nt(t)})));return new Gs(r,i,o,n)}return new zs(r,i,n)}if(t.delete){var s=Xo(e,t.delete);return new tu(s,n)}if(t.transform){i=Xo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(jr("REQUEST_TIME"===e.setToServerValue),r=new vs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new gs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Is(n)):"increment"in e?r=new Ns(t,e.increment):Ur();e=hi.nt(e.fieldPath);return new ks(e,r)}(e,t)});return jr(!0===n.exists),new Qs(i,s)}if(t.verify){t=Xo(e,t.verify);return new eu(t,n)}return Ur()}function is(t,e){return{documents:[Jo(t,e.path)]}}function os(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Jo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Jo(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Vo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(Lo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(Lo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:(e=t.op,jo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:cs((t=t).field),direction:(t=t.dir,Uo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.tn||mi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=us(e.startAt)),e.endAt&&(n.structuredQuery.endAt=us(e.endAt)),n}function ss(t){var e=$o(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(jr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[fs(t)]:void 0!==t.fieldFilter?[(n=t,Cu.create(hs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ur()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Ur():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new aa(hs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=mi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=as(n.startAt));var u=null;return n.endAt&&(u=as(n.endAt)),mu(e,i,t,o,r,"F",s,u)}function us(t){return{before:t.before,values:t.position}}function as(t){var e=!!t.before,t=t.values||[];return new ta(t,e)}function cs(t){return{fieldPath:t.J()}}function hs(t){return hi.nt(t.fieldPath)}function fs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=hs(t.unaryFilter.field);return Cu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=hs(t.unaryFilter.field);return Cu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=hs(t.unaryFilter.field);return Cu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=hs(t.unaryFilter.field);return Cu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ur()}}function ls(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.cn=void 0};function ps(t,e){return t instanceof Ns?Ro(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ds,ys,vs=(n(ws,ys=h),ws),gs=(n(ms,ds=h),ms);function ms(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function ws(){return null!==ys&&ys.apply(this,arguments)||this}function bs(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return To(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var _s,Is=(n(Es,_s=h),Es);function Es(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function Ts(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!To(t,e)})}(i[r]);return{arrayValue:{values:n}}}var As,Ns=(n(Os,As=h),Os);function Os(t,e){var n=this;return(n=As.call(this)||this).serializer=t,n.nn=e,n}function Ss(t){return xo(t.integerValue||t.doubleValue)}function Ds(t){return Co(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var xs=(Ps.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},Ps.prototype.isEqual=function(t){return ni(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ps),ks=function(t,e){this.field=t,this.transform=e};function Ps(t){(this.fields=t).sort(hi.$)}function Rs(t,e){this.version=t,this.transformResults=e}var Cs=(Ls.on=function(){return new Ls},Ls.exists=function(t){return new Ls(void 0,t)},Ls.updateTime=function(t){return new Ls(t)},Object.defineProperty(Ls.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ls.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ls);function Ls(t,e){this.updateTime=t,this.exists=e}function Vs(t,e){return void 0!==t.updateTime?e instanceof fu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof fu}Ie=function(){};function Ms(t,e,n){return t instanceof zs?new fu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Gs?function(t,e,n){if(!Vs(t.rn,e))return new pu(t.key,n.version);e=Hs(t,e);return new fu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Qs?function(t,e,n){if(jr(null!=n.transformResults),!Vs(t.rn,e))return new pu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];jr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof fu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof gs?bs(o,s):o instanceof Is?Ts(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Js(t,r.data(),e);return new fu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new lu(t.key,n.version,{hasCommittedMutations:!0})}function Us(t,e,n,r){return t instanceof zs?function(t,e){if(!Vs(t.rn,e))return e;e=qs(e);return new fu(t.key,e,t.value,{an:!0})}(t,e):t instanceof Gs?function(t,e){if(!Vs(t.rn,e))return e;var n=qs(e),e=Hs(t,e);return new fu(t.key,n,e,{an:!0})}(t,e):t instanceof Qs?function(t,e,n,r){if(!Vs(t.rn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof fu&&(h=n.field(a.field)),null===h&&r instanceof fu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof vs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof gs?bs(c,i):c instanceof Is?Ts(c,i):(c=ps(h=c,i),i=Ss(c)+Ss(h.nn),Ro(c)&&Ro(h.nn)?Fo(i):Bo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Js(t,i.data(),r);return new fu(t.key,i.version,r,{an:!0})}(t,e,r,n):(e=e,Vs((t=t).rn,e)?new lu(t.key,ui.min()):e)}function js(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||ni(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof gs&&e instanceof gs||t instanceof Is&&e instanceof Is?ni(t.elements,e.elements,To):t instanceof Ns&&e instanceof Ns?To(t.nn,e.nn):t instanceof vs&&e instanceof vs)}))}function qs(t){return t instanceof fu?t.version:ui.min()}var Fs,Bs,zs=(n(Ws,Bs=Ie),Ws),Gs=(n(Ks,Fs=Ie),Ks);function Ks(t,e,n,r){var i=this;return(i=Fs.call(this)||this).key=t,i.data=e,i.en=n,i.rn=r,i.type=1,i}function Ws(t,e,n){var r=this;return(r=Bs.call(this)||this).key=t,r.value=e,r.rn=n,r.type=0,r}function Hs(t,e){return n=t,e=e instanceof fu?e.data():nu.empty(),r=new ru(e),n.en.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.hn();var n,r}var Ys,Qs=(n(Xs,Ys=Ie),Xs);function Xs(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.rn=Cs.exists(!0),n}function Js(t,e,n){for(var r=new ru(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var $s,Zs,tu=(n(uu,Zs=Ie),uu),eu=(n(su,$s=Ie),su),nu=(ou.empty=function(){return new ou({mapValue:{}})},ou.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Mo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},ou.prototype.isEqual=function(t){return To(this.proto,t.proto)},ou),ru=(iu.prototype.set=function(t,e){return this.fn(t,e),this},iu.prototype.delete=function(t){return this.fn(t,null),this},iu.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Eo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.K(),e)},iu.prototype.hn=function(){var t=this.dn(hi.X(),this._n);return null!=t?new nu(t):this.ln},iu.prototype.dn=function(r,t){var i=this,o=!1,e=this.ln.field(r),s=Mo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.dn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},iu);function iu(t){void 0===t&&(t=nu.empty()),this.ln=t,this._n=new Map}function ou(t){this.proto=t}function su(t,e){var n=this;return(n=$s.call(this)||this).key=t,n.rn=e,n.type=4,n}function uu(t,e){var n=this;return(n=Zs.call(this)||this).key=t,n.rn=e,n.type=3,n}var au,cu,hu,Ee=function(t,e){this.key=t,this.version=e},fu=(n(gu,hu=Ee),gu.prototype.field=function(t){return this.wn.field(t)},gu.prototype.data=function(){return this.wn},gu.prototype.En=function(){return this.wn.proto},gu.prototype.isEqual=function(t){return t instanceof gu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},gu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(gu.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),gu),lu=(n(vu,cu=Ee),vu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(vu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),vu.prototype.isEqual=function(t){return t instanceof vu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},vu),pu=(n(yu,au=Ee),yu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),yu.prototype.isEqual=function(t){return t instanceof yu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},yu),du=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function yu(){return null!==au&&au.apply(this,arguments)||this}function vu(t,e,n){var r=this;return(r=cu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function gu(t,e,n,r){var i=this;return(i=hu.call(this,t,e)||this).wn=n,i.an=!!r.an,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function mu(t,e,n,r,i,o,s,u){return new du(t,e,n,r,i,o,s,u)}function wu(t){return new du(t)}function bu(t){return!mi(t.limit)&&"F"===t.limitType}function _u(t){return!mi(t.limit)&&"L"===t.limitType}function Iu(t){return 0<t.Tn.length?t.Tn[0].field:null}function Eu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Tu(t){return null!==t.collectionGroup}function Au(t){var e=t;if(null===e.In){e.In=[];var n=Eu(e),t=Iu(e);if(null!==n&&null===t)n.tt()||e.In.push(new aa(n)),e.In.push(new aa(hi.et(),"asc"));else{for(var r=!1,i=0,o=e.Tn;i<o.length;i++){var s=o[i];e.In.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.Tn.length?e.Tn[e.Tn.length-1].dir:"asc",e.In.push(new aa(hi.et(),n)))}}return e.In}function Nu(t){var e=t;if(!e.mn)if("F"===e.limitType)e.mn=Ii(e.path,e.collectionGroup,Au(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Au(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new aa(o.field,s))}var u=e.endAt?new ta(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ta(e.startAt.position,!e.startAt.before):null;e.mn=Ii(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.mn}function Ou(t,e,n){return new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Su(t,e){return Ti(Nu(t),Nu(e))&&t.limitType===e.limitType}function Du(t){return Ei(Nu(t))+"|lt:"+t.limitType}function xu(t){return"Query(target="+(e=Nu(t),n=e.path.J(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.J()+" "+t.op+" "+So(t.value)}).join(", ")+"]"),mi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.J()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+oa(e.startAt)),e.endAt&&(n+=", endAt: "+oa(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ku(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.j(n):fi.ot(e.path)?e.path.isEqual(n):e.path.G(n))&&function(t){for(var e=0,n=i.Tn;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||sa(t.startAt,Au(t),n))&&(!t.endAt||!sa(t.endAt,Au(t),n)));var e,n}function Pu(u){return function(t,e){for(var n=!1,r=0,i=Au(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?fi.$(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?No(n,t):Ur()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Ur()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Ru,Cu=(n(Lu,Ru=function(){}),Lu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,n):new ju(t,e,n):"array-contains"===e?new Xu(t,n):"in"===e?new Ju(t,n):"not-in"===e?new $u(t,n):"array-contains-any"===e?new Zu(t,n):new Lu(t,e,n)},Lu.Rn=function(t,e,n){return new("in"===e?qu:Fu)(t,n)},Lu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pn(No(t,this.value)):null!==t&&Eo(this.value)===Eo(t)&&this.Pn(No(t,this.value))},Lu.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ur()}},Lu.prototype.An=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Lu);function Lu(t,e,n){var r=this;return(r=Ru.call(this)||this).field=t,r.op=e,r.value=n,r}var Vu,Mu,Uu,ju=(n(Gu,Uu=Cu),Gu.prototype.matches=function(t){t=fi.$(t.key,this.key);return this.Pn(t)},Gu),qu=(n(zu,Mu=Cu),zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},zu),Fu=(n(Bu,Vu=Cu),Bu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Bu);function Bu(t,e){var n=this;return(n=Vu.call(this,t,"not-in",e)||this).keys=Ku(0,e),n}function zu(t,e){var n=this;return(n=Mu.call(this,t,"in",e)||this).keys=Ku(0,e),n}function Gu(t,e,n){var r=this;return(r=Uu.call(this,t,e,n)||this).key=fi.it(n.referenceValue),r}function Ku(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return fi.it(t.referenceValue)})}var Wu,Hu,Yu,Qu,Xu=(n(ia,Qu=Cu),ia.prototype.matches=function(t){t=t.field(this.field);return Co(t)&&Ao(t.arrayValue,this.value)},ia),Ju=(n(ra,Yu=Cu),ra.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Ao(this.value.arrayValue,t)},ra),$u=(n(na,Hu=Cu),na.prototype.matches=function(t){if(Ao(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Ao(this.value.arrayValue,t)},na),Zu=(n(ea,Wu=Cu),ea.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Co(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Ao(e.value.arrayValue,t)})},ea),ta=function(t,e){this.position=t,this.before=e};function ea(t,e){return Wu.call(this,t,"array-contains-any",e)||this}function na(t,e){return Hu.call(this,t,"not-in",e)||this}function ra(t,e){return Yu.call(this,t,"in",e)||this}function ia(t,e){return Qu.call(this,t,"array-contains",e)||this}function oa(t){return(t.before?"b":"a")+":"+t.position.map(So).join(",")}function sa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?fi.$(fi.it(s.referenceValue),n.key):No(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ua(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!To(t.position[n],e.position[n]))return!1;return!0}var aa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var ca=(ma.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ms(o,e,r[i]))}return e},ma.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Us(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Us(a,e,o,this.gn))}return e},ma.prototype.vn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.pn(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ma.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Qi())},ma.prototype.isEqual=function(t){return this.batchId===t.batchId&&ni(this.mutations,t.mutations,js)&&ni(this.baseMutations,t.baseMutations,js)},ma),ha=(ga.from=function(t,e,n){jr(t.mutations.length===n.length);for(var r=Hi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new ga(t,e,n,r)},ga),fa=(va.prototype.get=function(t){var e=this.Dn(t),e=this.Nn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Cn(o,t))return i}},va.prototype.has=function(t){return void 0!==this.get(t)},va.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},va.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},va.prototype.forEach=function(s){mo(this.Nn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},va.prototype.W=function(){return wo(this.Nn)},va),la=(ya.prototype.catch=function(t){return this.next(void 0,t)},ya.prototype.next=function(r,i){var o=this;return this.Mn&&Ur(),this.Mn=!0,this.On?this.error?this.kn(i,this.error):this.$n(r,this.result):new ya(function(e,n){o.xn=function(t){o.$n(r,t).next(e,n)},o.Fn=function(t){o.kn(i,t).next(e,n)}})},ya.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ya.prototype.Bn=function(t){try{var e=t();return e instanceof ya?e:ya.resolve(e)}catch(t){return ya.reject(t)}},ya.prototype.$n=function(t,e){return t?this.Bn(function(){return t(e)}):ya.resolve(e)},ya.prototype.kn=function(t,e){return t?this.Bn(function(){return t(e)}):ya.reject(e)},ya.resolve=function(n){return new ya(function(t,e){t(n)})},ya.reject=function(n){return new ya(function(t,e){e(n)})},ya.qn=function(t){return new ya(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ya.Un=function(t){for(var n=ya.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ya.resolve(t):e()})}(r[e]);return n},ya.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},ya),h=(da.prototype.Wn=function(t){t=this.Qn.get(t);return t?t.readTime:ui.min()},da.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},da.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},da.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?la.resolve(n.zn):this.Yn(t,e)},da.prototype.getEntries=function(t,e){return this.Xn(t,e)},da.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},da.prototype.Gn=function(){},da),pa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function da(){this.Qn=new fa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}function ya(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}function va(t,e){this.Dn=t,this.Cn=e,this.Nn={}}function ga(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}function ma(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}function wa(t){return new qo(t,!0)}function ba(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var _a="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Sa.prototype.es=function(t){this.ts.push(t)},Sa.prototype.ns=function(){this.ts.forEach(function(t){return t()})},Sa),Ia=(Oa.prototype.cs=function(e,n){var r=this;return this.rs.us(e,n).next(function(t){return r.hs(e,n,t)})},Oa.prototype.hs=function(t,r,i){return this.ss.Jn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].pn(r,t);return t})},Oa.prototype.ls=function(t,e,i){var o=zi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].pn(t,e);o=o.Tt(t,e)}),o},Oa.prototype._s=function(e,t){var n=this;return this.ss.getEntries(e,t).next(function(t){return n.fs(e,t)})},Oa.prototype.fs=function(e,r){var i=this;return this.rs.ds(e,r).next(function(t){var t=i.ls(e,r,t),n=zi;return t.forEach(function(t,e){e=e||new lu(t,ui.min()),n=n.Tt(t,e)}),n})},Oa.prototype.ws=function(t,e,n){return r=e,fi.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Es(t,e.path):Tu(e)?this.Ts(t,e,n):this.Is(t,e,n);var r},Oa.prototype.Es=function(t,e){return this.cs(t,new fi(e)).next(function(t){var e=Wi;return t instanceof fu&&(e=e.Tt(t.key,t)),e})},Oa.prototype.Ts=function(n,r,i){var o=this,s=r.collectionGroup,u=Wi;return this.os.As(n,s).next(function(t){return la.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new du(t,null,e.Tn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Is(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},Oa.prototype.Is=function(e,n,t){var c,h,r=this;return this.ss.ws(e,n,t).next(function(t){return c=t,r.rs.Rs(e,n)}).next(function(t){return h=t,r.Ps(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Us(s,a,a,r.gn);c=a instanceof fu?c.Tt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){ku(n,e)||(c=c.remove(t))}),c})},Oa.prototype.Ps=function(t,e,n){for(var r=Qi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Gs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof fu&&(c=c.Tt(t,e))}),c})},Oa),Ea=(Na.Vs=function(t,e){for(var n=Qi(),r=Qi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Na(t,e.fromCache,n,r)},Na),Ta=(Aa.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Aa.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},Aa);function Aa(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}function Na(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}function Oa(t,e,n){this.ss=t,this.rs=e,this.os=n}function Sa(){this.ts=[]}Ta.Ds=-1;var Da,xa=(Ma.prototype.reset=function(){this.Ms=0},Ma.prototype.Ls=function(){this.Ms=this.Os},Ma.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Cr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},Ma.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},Ma.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},Ma.prototype.qs=function(){return(Math.random()-.5)*this.Ms},Ma),ka=(Va.delete=function(t){return Cr("SimpleDb","Removing database:",t),za(window.indexedDB.deleteDatabase(t)).Ln()},Va.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(Va.zs())return!0;var t=p(),e=Va.js(t),n=0<e&&e<10,e=Va.Hs(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Va.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},Va.Ys=function(t,e){return t.store(e)},Va.js=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Va.Hs=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Va.prototype.Xs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Cr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Ra(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new zr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Ra(o,t))},r.onupgradeneeded=function(t){Cr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Cr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return i.Zs(t)}),this.db)]}})})},Va.prototype.ti=function(e){this.Zs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Va.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Xs(u)];case 2:return s.db=t.sent(),e=ja.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),la.reject(t)}).Ln(),r={},n.catch(function(){}),[4,e.ei];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Cr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Va.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Va),Pa=(Object.defineProperty(La.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),La.prototype.done=function(){this.si=!0},La.prototype.oi=function(t){this.ii=t},La.prototype.delete=function(){return za(this.ni.delete())},La),Ra=(n(Ca,Da=zr),Ca);function Ca(t,e){var n=this;return(n=Da.call(this,Br.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function La(t){this.ni=t,this.si=!1,this.ii=null}function Va(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===Va.js(p())&&Lr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ma(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}function Ua(t){return"IndexedDbTransactionError"===t.name}var ja=(Ba.open=function(t,e,n,r){try{return new Ba(e,t.transaction(r,n))}catch(t){throw new Ra(e,t)}},Object.defineProperty(Ba.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),Ba.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Cr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ba.prototype.store=function(t){t=this.transaction.objectStore(t);return new qa(t)},Ba),qa=(Fa.prototype.put=function(t,e){t=void 0!==e?(Cr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Cr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return za(t)},Fa.prototype.add=function(t){return Cr("SimpleDb","ADD",this.store.name,t,t),za(this.store.add(t))},Fa.prototype.get=function(e){var n=this;return za(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Cr("SimpleDb","GET",n.store.name,e,t),t})},Fa.prototype.delete=function(t){return Cr("SimpleDb","DELETE",this.store.name,t),za(this.store.delete(t))},Fa.prototype.count=function(){return Cr("SimpleDb","COUNT",this.store.name),za(this.store.count())},Fa.prototype.ui=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ai(e,function(t,e){n.push(e)}).next(function(){return n})},Fa.prototype.hi=function(t,e){Cr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.li=!1;e=this.cursor(e);return this.ai(e,function(t,e,n){return n.delete()})},Fa.prototype._i=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ai(n,e)},Fa.prototype.fi=function(r){var t=this.cursor({});return new la(function(n,e){t.onerror=function(t){t=Ka(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Fa.prototype.ai=function(t,i){var o=[];return new la(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Pa(n),(t=i(n.primaryKey,n.value,e))instanceof la&&(t=t.catch(function(t){return e.done(),la.reject(t)}),o.push(t)),e.On?r():null===e.ri?n.continue():n.continue(e.ri)):r()}}).next(function(){return la.qn(o)})},Fa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Fa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Fa);function Fa(t){this.store=t}function Ba(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ci=new pa,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){t.error?n.ci.reject(new Ra(e,t.error)):n.ci.resolve()},this.transaction.onerror=function(t){t=Ka(t.target.error);n.ci.reject(new Ra(e,t))}}function za(t){return new la(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ka(t.target.error);n(t)}})}var Ga=!1;function Ka(t){var e=ka.js(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new zr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ga||(Ga=!0,setTimeout(function(){throw n},0)),n}}return t}function Wa(){return"undefined"!=typeof window?window:null}function Ha(){return"undefined"!=typeof document?document:null}var Ya=(Ja.Ii=function(t,e,n,r,i){i=new Ja(t,e,Date.now()+n,r,i);return i.start(n),i},Ja.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},Ja.prototype.Ks=function(){return this.Ai()},Ja.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new zr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ja.prototype.Ai=function(){var e=this;this.di.Ri(function(){return null!==e.mi?(e.clearTimeout(),e.op().then(function(t){return e.Ti.resolve(t)})):Promise.resolve()})},Ja.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},Ja),Qa=(Object.defineProperty(Xa.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),Xa.prototype.Ri=function(t){this.enqueue(t)},Xa.prototype.Ni=function(t){this.xi(),this.Fi(t)},Xa.prototype.Oi=function(){var t;this.yi||(this.yi=!0,(t=Ha())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di))},Xa.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},Xa.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},Xa.prototype.ki=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.gi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return t.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Ua(e=t.sent()))throw e;return Cr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.gi.length&&this.Si.Bs(function(){return n.ki()}),t.label=5;case 5:return[2]}})})},Xa.prototype.Fi=function(t){var r=this,e=this.Pi.then(function(){return r.vi=!0,t().catch(function(t){throw r.pi=t,r.vi=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.vi=!1,t})});return this.Pi=e},Xa.prototype.Us=function(t,e,n){var r=this;this.xi(),-1<this.bi.indexOf(t)&&(e=0);n=Ya.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(n),n},Xa.prototype.xi=function(){this.pi&&Ur()},Xa.prototype.Li=function(){},Xa.prototype.Bi=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Pi];case 1:t.sent(),t.label=2;case 2:if(e!==this.Pi)return[3,0];t.label=3;case 3:return[2]}})})},Xa.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},Xa.prototype.Ui=function(r){var i=this;return this.Bi().then(function(){i.Vi.sort(function(t,e){return t.wi-e.wi});for(var t=0,e=i.Vi;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ns===r)break}return i.Bi()})},Xa.prototype.Qi=function(t){this.bi.push(t)},Xa.prototype.$i=function(t){t=this.Vi.indexOf(t);this.Vi.splice(t,1)},Xa);function Xa(){var e=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new xa(this,"async_queue_retry"),this.Di=function(){var t=Ha();t&&Cr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Si.Qs()};var t=Ha();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}function Ja(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new pa,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}function $a(t,e){if(Lr("AsyncQueue",e+": "+t),Ua(t))return new zr(Br.UNAVAILABLE,e+": "+t);throw t}function Za(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=ei(n,t);return 0===t?ei(r,e):t}var tc=(ic.prototype.ji=function(){return++this.Wi},ic.prototype.Gi=function(t){var e=[t,this.ji()];this.buffer.size<this.Ki?this.buffer=this.buffer.add(e):Za(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(ic.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),ic),ec={zi:!1,Hi:0,Ji:0,Yi:0},nc=(rc.er=function(t){return new rc(t,rc.nr,rc.sr)},rc);function rc(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}function ic(t){this.Ki=t,this.buffer=new Fi(Za),this.Wi=0}nc.nr=10,nc.sr=1e3,nc.ir=new nc(41943040,nc.nr,nc.sr),nc.rr=new nc(-1,0,0);var oc=(ac.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},ac.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(ac.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),ac.prototype.hr=function(n){var t=this,e=this.ur?3e5:6e4;Cr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ar=this.di.Us("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.ar=null,this.ur=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n._r(this.cr)];case 2:return t.sent(),[3,7];case 3:return Ua(e=t.sent())?(Cr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Qh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.hr(n)];case 8:return t.sent(),[2]}})})})},ac),sc=(uc.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},uc.prototype.Tr=function(t,e){var n=this;if(0===e)return la.resolve(Ta.Ds);var r=new tc(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},uc.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},uc.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},uc.prototype.Rr=function(e,n){var r=this;return-1===this.params.Xi?(Cr("LruGarbageCollector","Garbage collection skipped; disabled"),la.resolve(ec)):this.Pr(e).next(function(t){return t<r.params.Xi?(Cr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Xi),ec):r.gr(e,n)})},uc.prototype.Pr=function(t){return this.dr.Pr(t)},uc.prototype.gr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.wr(e,this.params.Zi).next(function(t){return i=t>h.params.tr?(Cr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+t),h.params.tr):t,s=Date.now(),h.Tr(e,i)}).next(function(t){return r=t,u=Date.now(),h.mr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Ar(e,r)}).next(function(t){return c=Date.now(),Rr()<=l.DEBUG&&Cr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),la.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},uc);function uc(t,e){this.dr=t,this.params=e}function ac(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}function cc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=hc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return hc(e)}function hc(t){return t+"\x01\x01"}function fc(t){var e=t.length;if(jr(2<=e),2===e)return jr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ai.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Ur(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Ur()}o=s+2}return new ai(r)}var lc=function(t){this.yr=t};function pc(t,e){if(e.document)return n=t.yr,r=e.document,i=!!e.hasCommittedMutations,t=Xo(n,r.name),n=Wo(r.updateTime),r=new nu({mapValue:{fields:r.fields}}),new fu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=fi.ct(e.noDocument.path),o=mc(e.noDocument.readTime);return new lu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=fi.ct(e.unknownDocument.path),e=mc(e.unknownDocument.version);return new pu(o,e)}return Ur()}function dc(t,e,n){var r=yc(n),n=e.key.path.q().H();if(e instanceof fu){var i={name:Qo(i=t.yr,(o=e).key),fields:o.En().mapValue.fields,updateTime:Go(i,o.version.M())},o=e.hasCommittedMutations;return new Zc(null,null,i,o,r,n)}if(e instanceof lu){var i=e.key.path.H(),o=gc(e.version),s=e.hasCommittedMutations;return new Zc(null,new Jc(i,o),null,s,r,n)}if(e instanceof pu){s=e.key.path.H(),e=gc(e.version);return new Zc(new $c(s,e),null,null,!0,r,n)}return Ur()}function yc(t){t=t.M();return[t.seconds,t.nanoseconds]}function vc(t){t=new si(t[0],t[1]);return ui.N(t)}function gc(t){t=t.M();return new Bc(t.seconds,t.nanoseconds)}function mc(t){t=new si(t.seconds,t.nanoseconds);return ui.N(t)}function wc(e,t){var n=(t.baseMutations||[]).map(function(t){return rs(e.yr,t)}),r=t.mutations.map(function(t){return rs(e.yr,t)}),i=si.fromMillis(t.localWriteTimeMs);return new ca(t.batchId,i,n,r)}function bc(t){var e=mc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?mc(t.lastLimboFreeSnapshotVersion):ui.min(),r=void 0!==t.query.documents?(jr(1===(r=t.query).documents.length),Nu(wu($o(r.documents[0])))):Nu(ss(t.query));return new xi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ni.fromBase64String(t.resumeToken))}function _c(t,e){var n=gc(e.ft),r=gc(e.lastLimboFreeSnapshotVersion),i=(Ai(e.target)?is:os)(t.yr,e.target),t=e.resumeToken.toBase64();return new eh(e.targetId,Ei(e.target),n,t,e.sequenceNumber,r,i)}function Ic(t){var e=ss({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ou(e,e.limit,"L"):e}var Ec=(Tc.vr=function(t,e,n,r){return jr(""!==t.uid),new Tc(t.u()?t.uid:"",e,n,r)},Tc.prototype.br=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Oc(t)._i({index:Yc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Tc.prototype.Sr=function(d,y,v,g){var m=this,w=Sc(d),b=Oc(d);return b.add({}).next(function(t){jr("number"==typeof t);for(var e,n,r,i,o,s=new ca(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ns(e.yr,t)}),o=r.mutations.map(function(t){return ns(e.yr,t)}),new Yc(n,r.batchId,r.gn.toMillis(),i,o)),a=[],c=new Fi(function(t,e){return ei(t.J(),e.J())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Qc.key(m.userId,l.key.path,t),c=c.add(l.key.path.q());a.push(b.put(u)),a.push(w.put(p,Qc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.os.Dr(d,t))}),d.es(function(){m.pr[t]=s.keys()}),la.qn(a).next(function(){return s})})},Tc.prototype.Cr=function(t,e){var n=this;return Oc(t).get(e).next(function(t){return t?(jr(t.userId===n.userId),wc(n.serializer,t)):null})},Tc.prototype.Nr=function(t,e){var n=this;return this.pr[e]?la.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){t=t.keys();return n.pr[e]=t}return null})},Tc.prototype.Fr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Oc(t)._i({index:Yc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(jr(e.batchId>=i),o=wc(r.serializer,e)),n.done()}).next(function(){return o})},Tc.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Oc(t)._i({index:Yc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Tc.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Oc(t).ui(Yc.userMutationsIndex,n).next(function(t){return t.map(function(t){return wc(e.serializer,t)})})},Tc.prototype.us=function(o,s){var u=this,t=Qc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Sc(o)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=fc(i);if(r===u.userId&&s.path.isEqual(i))return Oc(o).get(t).next(function(t){if(!t)throw Ur();jr(t.userId===u.userId),a.push(wc(u.serializer,t))});n.done()}).next(function(){return a})},Tc.prototype.ds=function(e,t){var s=this,u=new Fi(ei),n=[];return t.forEach(function(o){var t=Qc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Sc(e)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=fc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),la.qn(n).next(function(){return s.kr(e,u)})},Tc.prototype.Rs=function(t,e){var o=this,s=e.path,u=s.length+1,e=Qc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Fi(ei);return Sc(t)._i({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=fc(i);r===o.userId&&s.j(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.kr(t,a)})},Tc.prototype.kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Oc(e).get(t).next(function(t){if(null===t)throw Ur();jr(t.userId===n.userId),r.push(wc(n.serializer,t))}))}),la.qn(i).next(function(){return r})},Tc.prototype.$r=function(e,n){var r=this;return Nc(e.Lr,this.userId,n).next(function(t){return e.es(function(){r.Br(n.batchId)}),la.forEach(t,function(t){return r.Vr.qr(e,t)})})},Tc.prototype.Br=function(t){delete this.pr[t]},Tc.prototype.Ur=function(e){var i=this;return this.br(e).next(function(t){if(!t)return la.resolve();var t=IDBKeyRange.lowerBound(Qc.prefixForUser(i.userId)),r=[];return Sc(e)._i({range:t},function(t,e,n){t[0]===i.userId?(t=fc(t[1]),r.push(t)):n.done()}).next(function(){jr(0===r.length)})})},Tc.prototype.Qr=function(t,e){return Ac(t,this.userId,e)},Tc.prototype.Kr=function(t){var e=this;return Dc(t).get(this.userId).next(function(t){return t||new Hc(e.userId,-1,"")})},Tc);function Tc(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}function Ac(t,o,e){var e=Qc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Sc(t)._i({range:e,li:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Nc(t,e,n){var r=t.store(Yc.store),i=t.store(Qc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r._i({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){jr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Qc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return la.qn(o).next(function(){return u})}function Oc(t){return Oh.Ys(t,Yc.store)}function Sc(t){return Oh.Ys(t,Qc.store)}function Dc(t){return Oh.Ys(t,Hc.store)}var xc,kc=(Cc.prototype.jn=function(t,e,n){return Vc(t).put(Mc(e),n)},Cc.prototype.Hn=function(t,e){t=Vc(t),e=Mc(e);return t.delete(e)},Cc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Wr(e,t)})},Cc.prototype.Jn=function(t,e){var n=this;return Vc(t).get(Mc(e)).next(function(t){return n.jr(t)})},Cc.prototype.Gr=function(t,e){var n=this;return Vc(t).get(Mc(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Uc(t)}:null})},Cc.prototype.getEntries=function(t,e){var n=this,r=zi;return this.zr(t,e,function(t,e){e=n.jr(e);r=r.Tt(t,e)}).next(function(){return r})},Cc.prototype.Hr=function(t,e){var r=this,i=zi,o=new Ci(fi.$);return this.zr(t,e,function(t,e){var n=r.jr(e);o=n?(i=i.Tt(t,n),o.Tt(t,Uc(e))):(i=i.Tt(t,null),o.Tt(t,0))}).next(function(){return{Jr:i,Yr:o}})},Cc.prototype.zr=function(t,e,i){if(e.W())return la.resolve();var n=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),o=e.yt(),s=o.Ct();return Vc(t)._i({range:n},function(t,e,n){for(var r=fi.ct(t);s&&fi.$(s,r)<0;)i(s,null),s=o.Ct();s&&s.isEqual(r)&&(i(s,e),s=o.Nt()?o.Ct():null),s?n.oi(s.path.H()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Nt()?o.Ct():null})},Cc.prototype.ws=function(t,r,e){var n,i=this,o=Wi,s=r.path.length+1,u={};return e.isEqual(ui.min())?(n=r.path.H(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.H(),e=yc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Zc.collectionReadTimeIndex),Vc(t)._i(u,function(t,e,n){t.length===s&&(e=pc(i.serializer,e),r.path.j(e.key.path)?e instanceof fu&&ku(r,e)&&(o=o.Tt(e.key,e)):n.done())}).next(function(){return o})},Cc.prototype.Xr=function(t){return new Pc(this,!!t&&t.Zr)},Cc.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Cc.prototype.getMetadata=function(t){return Lc(t).get(th.key).next(function(t){return jr(!!t),t})},Cc.prototype.Wr=function(t,e){return Lc(t).put(th.key,e)},Cc.prototype.jr=function(t){if(t){t=pc(this.serializer,t);return t instanceof lu&&t.version.isEqual(ui.min())?null:t}return null},Cc),Pc=(n(Rc,xc=h),Rc.prototype.Zn=function(i){var o=this,s=[],u=0,a=new Fi(function(t,e){return ei(t.J(),e.J())});return this.Qn.forEach(function(t,e){var n,r=o.so.get(t);e.zn?(n=dc(o.no.serializer,e.zn,o.Wn(t)),a=a.add(t.path.q()),e=Uc(n),u+=e-r,s.push(o.no.jn(i,t,n))):(u-=r,o.Zr?(r=dc(o.no.serializer,new lu(t,ui.min()),o.Wn(t)),s.push(o.no.jn(i,t,r))):s.push(o.no.Hn(i,t)))}),a.forEach(function(t){s.push(o.no.os.Dr(i,t))}),s.push(this.no.updateMetadata(i,u)),la.qn(s)},Rc.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},Rc.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},Rc);function Rc(t,e){var n=this;return(n=xc.call(this)||this).no=t,n.Zr=e,n.so=new fa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Cc(t,e){this.serializer=t,this.os=e}function Lc(t){return Oh.Ys(t,th.store)}function Vc(t){return Oh.Ys(t,Zc.store)}function Mc(t){return t.path.H()}function Uc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ur();e=t.noDocument}return JSON.stringify(e).length}var jc=(Wc.prototype.Dr=function(t,e){return this.io.add(e),la.resolve()},Wc.prototype.As=function(t,e){return la.resolve(this.io.getEntries(e))},Wc),qc=(Kc.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Fi(ai.$),t=!r.has(n);return this.index[e]=r.add(n),t},Kc.prototype.has=function(t){var e=t.K(),t=t.q(),e=this.index[e];return e&&e.has(t)},Kc.prototype.getEntries=function(t){return(this.index[t]||new Fi(ai.$)).H()},Kc),Fc=(Gc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;jr(t<r&&0<=t&&r<=11);var o=new ja("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(zc.store),(s=e).createObjectStore(Hc.store,{keyPath:Hc.keyPath}),s.createObjectStore(Yc.store,{keyPath:Yc.keyPath,autoIncrement:!0}).createIndex(Yc.userMutationsIndex,Yc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Qc.store),oh(e),e.createObjectStore(Zc.store));var s,u=la.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(nh.store),s.deleteObjectStore(eh.store),s.deleteObjectStore(rh.store),oh(e)),u=u.next(function(){return t=o.store(rh.store),e=new rh(0,0,ui.min().M(),0),t.put(rh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Yc.store).ui().next(function(t){n.deleteObjectStore(Yc.store),n.createObjectStore(Yc.store,{keyPath:Yc.keyPath,autoIncrement:!0}).createIndex(Yc.userMutationsIndex,Yc.userMutationsKeyPath,{unique:!0});var e=r.store(Yc.store),t=t.map(function(t){return e.put(t)});return la.qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(sh.store,{keyPath:sh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(th.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Zc.store)).createIndex(Zc.readTimeIndex,Zc.readTimeIndexPath,{unique:!1}),t.createIndex(Zc.collectionReadTimeIndex,Zc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(uh.store,{keyPath:uh.keyPath}),e.createObjectStore(ah.store,{keyPath:ah.keyPath})})),u},Gc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Zc.store)._i(function(t,e){n+=Uc(e)}).next(function(){var t=new th(n);return e.store(th.store).put(th.key,t)})},Gc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Hc.store),i=n.store(Yc.store);return t.ui().next(function(t){return la.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ui(Yc.userMutationsIndex,t).next(function(t){return la.forEach(t,function(t){jr(t.userId===e.userId);t=wc(r.serializer,t);return Nc(n,e.userId,t).next(function(){})})})})})},Gc.prototype.ensureSequenceNumbers=function(t){var o=t.store(nh.store),e=t.store(Zc.store);return t.store(rh.store).get(rh.key).next(function(r){var i=[];return e._i(function(t,e){var n=new ai(t),t=[0,cc(n)];i.push(o.get(t).next(function(t){return t?la.resolve():o.put(new nh(0,cc(n),r.highestListenSequenceNumber))}))}).next(function(){return la.qn(i)})})},Gc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ih.store,{keyPath:ih.keyPath});function r(t){if(i.add(t)){var e=t.K(),t=t.q();return n.put({collectionId:e,parent:cc(t)})}}var n=e.store(ih.store),i=new qc;return e.store(Zc.store)._i({li:!0},function(t,e){t=new ai(t);return r(t.q())}).next(function(){return e.store(Qc.store)._i({li:!0},function(t,e){t[0];var n=t[1],n=(t[2],fc(n));return r(n.q())})})},Gc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(eh.store);return r._i(function(t,e){e=bc(e),e=_c(n.serializer,e);return r.put(e)})},Gc),Bc=function(t,e){this.seconds=t,this.nanoseconds=e},zc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Gc(t){this.serializer=t}function Kc(){this.index={}}function Wc(){this.io=new qc}zc.store="owner",zc.key="owner";var Hc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Hc.store="mutationQueues",Hc.keyPath="userId";var Yc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Yc.store="mutations",Yc.keyPath="batchId",Yc.userMutationsIndex="userMutationsIndex",Yc.userMutationsKeyPath=["userId","batchId"];var Qc=(Xc.prefixForUser=function(t){return[t]},Xc.prefixForPath=function(t,e){return[t,cc(e)]},Xc.key=function(t,e,n){return[t,cc(e),n]},Xc);function Xc(){}Qc.store="documentMutations",Qc.PLACEHOLDER=new Qc;var Jc=function(t,e){this.path=t,this.readTime=e},$c=function(t,e){this.path=t,this.version=e},Zc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Zc.store="remoteDocuments",Zc.readTimeIndex="readTimeIndex",Zc.readTimeIndexPath="readTime",Zc.collectionReadTimeIndex="collectionReadTimeIndex",Zc.collectionReadTimeIndexPath=["parentPath","readTime"];var th=function(t){this.byteSize=t};th.store="remoteDocumentGlobal",th.key="remoteDocumentGlobalKey";var eh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};eh.store="targets",eh.keyPath="targetId",eh.queryTargetsIndexName="queryTargetsIndex",eh.queryTargetsKeyPath=["canonicalId","targetId"];var nh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};nh.store="targetDocuments",nh.keyPath=["targetId","path"],nh.documentTargetsIndex="documentTargetsIndex",nh.documentTargetsKeyPath=["path","targetId"];var rh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};rh.key="targetGlobalKey",rh.store="targetGlobal";var ih=function(t,e){this.collectionId=t,this.parent=e};function oh(t){t.createObjectStore(nh.store,{keyPath:nh.keyPath}).createIndex(nh.documentTargetsIndex,nh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(eh.store,{keyPath:eh.keyPath}).createIndex(eh.queryTargetsIndexName,eh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(rh.store)}ih.store="collectionParents",ih.keyPath=["collectionId","parent"];var sh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};sh.store="clientMetadata",sh.keyPath="clientId";var uh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};uh.store="bundles",uh.keyPath="bundleId";var ah=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ah.store="namedQueries",ah.keyPath="name";var ch=s(s(s(s([Hc.store,Yc.store,Qc.store,Zc.store,eh.store,zc.store,rh.store,nh.store],[sh.store]),[th.store]),[ih.store]),[uh.store,ah.store]),hh=(fh.prototype.ro=function(t,e){return lh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:mc(t.createTime),version:t.version}})},fh.prototype.oo=function(t,e){return lh(t).put({bundleId:(e=e).id,createTime:gc(Wo(e.createTime)),version:e.version})},fh.prototype.co=function(t,e){return ph(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Ic(t.bundledQuery),readTime:mc(t.readTime)}})},fh.prototype.uo=function(t,e){return ph(t).put({name:(e=e).name,readTime:gc(Wo(e.readTime)),bundledQuery:e.bundledQuery})},fh);function fh(t){this.serializer=t}function lh(t){return Oh.Ys(t,uh.store)}function ph(t){return Oh.Ys(t,ah.store)}var dh=(yh.prototype.Dr=function(t,e){var n=this;if(this.ao.has(e))return la.resolve();var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});i={collectionId:r,parent:cc(i)};return vh(t).put(i)},yh.prototype.As=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[ri(i),""],!1,!0);return vh(t).ui(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(fc(r.parent))}return o})},yh);function yh(){this.ao=new qc}function vh(t){return Oh.Ys(t,ih.store)}var gh=(bh.prototype.next=function(){return this.ho+=2,this.ho},bh.lo=function(){return new bh(0)},bh._o=function(){return new bh(-1)},bh),mh=(wh.prototype.fo=function(n){var r=this;return this.wo(n).next(function(t){var e=new gh(t.highestTargetId);return t.highestTargetId=e.next(),r.Eo(n,t).next(function(){return t.highestTargetId})})},wh.prototype.To=function(t){return this.wo(t).next(function(t){return ui.N(new si(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},wh.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},wh.prototype.mo=function(e,n,r){var i=this;return this.wo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.M()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Eo(e,t)})},wh.prototype.Ao=function(e,n){var r=this;return this.Ro(e,n).next(function(){return r.wo(e).next(function(t){return t.targetCount+=1,r.Po(n,t),r.Eo(e,t)})})},wh.prototype.yo=function(t,e){return this.Ro(t,e)},wh.prototype.Vo=function(e,t){var n=this;return this.po(e,t.targetId).next(function(){return _h(e).delete(t.targetId)}).next(function(){return n.wo(e)}).next(function(t){return jr(0<t.targetCount),--t.targetCount,n.Eo(e,t)})},wh.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return _h(n)._i(function(t,e){e=bc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Vo(n,e)))}).next(function(){return la.qn(u)}).next(function(){return s})},wh.prototype.Ue=function(t,n){return _h(t)._i(function(t,e){e=bc(e);n(e)})},wh.prototype.wo=function(t){return Ih(t).get(rh.key).next(function(t){return jr(null!==t),t})},wh.prototype.Eo=function(t,e){return Ih(t).put(rh.key,e)},wh.prototype.Ro=function(t,e){return _h(t).put(_c(this.serializer,e))},wh.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},wh.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},wh.prototype.bo=function(t,r){var e=Ei(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return _h(t)._i({range:e,index:eh.queryTargetsIndexName},function(t,e,n){e=bc(e);Ti(r,e.target)&&(i=e,n.done())}).next(function(){return i})},wh.prototype.So=function(n,t,r){var i=this,o=[],s=Eh(n);return t.forEach(function(t){var e=cc(t.path);o.push(s.put(new nh(r,e))),o.push(i.Vr.Do(n,r,t))}),la.qn(o)},wh.prototype.Co=function(n,t,r){var i=this,o=Eh(n);return la.forEach(t,function(t){var e=cc(t.path);return la.qn([o.delete([r,e]),i.Vr.No(n,r,t)])})},wh.prototype.po=function(t,e){t=Eh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},wh.prototype.xo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Eh(t),r=Qi();return t._i({range:e,li:!0},function(t,e,n){t=fc(t[1]),t=new fi(t);r=r.add(t)}).next(function(){return r})},wh.prototype.Qr=function(t,e){var e=cc(e.path),e=IDBKeyRange.bound([e],[ri(e)],!1,!0),i=0;return Eh(t)._i({index:nh.documentTargetsIndex,li:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},wh.prototype.Ze=function(t,e){return _h(t).get(e).next(function(t){return t?bc(t):null})},wh);function wh(t,e){this.Vr=t,this.serializer=e}function bh(t){this.ho=t}function _h(t){return Oh.Ys(t,eh.store)}function Ih(t){return Oh.Ys(t,rh.store)}function Eh(t){return Oh.Ys(t,nh.store)}var Th,Ah="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Nh=(n(Dh,Th=Ie),Dh),Oh=(Sh.Ys=function(t,e){if(t instanceof Nh)return ka.Ys(t.Lr,e);throw Ur()},Sh.prototype.start=function(){var e=this;return this.Ho().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new zr(Br.FAILED_PRECONDITION,Ah);return e.Jo(),e.Yo(),e.Xo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.jo.Io(t)})}).then(function(t){e.ko=new Ta(t,e.Oo)}).then(function(){e.$o=!0}).catch(function(t){return e.Wo&&e.Wo.close(),Promise.reject(t)})},Sh.prototype.Zo=function(n){var t=this;return this.Qo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.lr?[2,n(e)]:[2]})})},n(this.isPrimary)},Sh.prototype.tc=function(n){var t=this;this.Wo.ti(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Sh.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Sh.prototype.Ho=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return kh(e).put(new sh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.nc(e).next(function(t){t||(n.isPrimary=!1,n.Cs.Mi(function(){return n.Qo(!1)}))})}).next(function(){return n.sc(e)}).next(function(t){return n.isPrimary&&!t?n.ic(e).next(function(){return!1}):!!t&&n.rc(e).next(function(){return!0})})}).catch(function(t){if(Ua(t))return Cr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Cr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Cs.Mi(function(){return n.Qo(t)}),n.isPrimary=t})},Sh.prototype.nc=function(t){var e=this;return xh(t).get(zc.key).next(function(t){return la.resolve(e.oc(t))})},Sh.prototype.cc=function(t){return kh(t).delete(this.clientId)},Sh.prototype.uc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Sh.Ys(t,sh.store);return r.ui().next(function(t){var e=o.hc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return la.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));t.label=2;case 2:return[2]}})})},Sh.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},Sh.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},Sh.prototype.sc=function(e){var r=this;return this.Mo?la.resolve(!0):xh(e).get(zc.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r._c(t.ownerId)){if(r.oc(t)&&r.networkEnabled)return!0;if(!r.oc(t)){if(!t.allowTabSynchronization)throw new zr(Br.FAILED_PRECONDITION,Ah);return!1}}return!(!r.networkEnabled||!r.inForeground)||kh(e).ui().next(function(t){return void 0===r.hc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Cr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Sh.prototype.fc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[zc.store,sh.store],function(t){var e=new Nh(t,Ta.Ds);return n.ic(e).next(function(){return n.cc(e)})})];case 1:return t.sent(),this.Wo.close(),this.Tc(),[2]}})})},Sh.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},Sh.prototype.Ic=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return kh(t).ui().next(function(t){return e.hc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Sh.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),Sh.prototype.mc=function(t){return Ec.vr(t,this.serializer,this.os,this.Vr)},Sh.prototype.Ac=function(){return this.jo},Sh.prototype.Rc=function(){return this.ss},Sh.prototype.Pc=function(){return this.os},Sh.prototype.gc=function(){return this.Go},Sh.prototype.runTransaction=function(e,n,r){var i=this;Cr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wo.runTransaction(e,t,ch,function(t){return o=new Nh(t,i.ko?i.ko.next():Ta.Ds),"readwrite-primary"===n?i.nc(o).next(function(t){return!!t||i.sc(o)}).next(function(t){if(!t)throw Lr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new zr(Br.FAILED_PRECONDITION,_a);return r(o)}).next(function(t){return i.rc(o).next(function(){return t})}):i.yc(o).next(function(){return r(o)})}).then(function(t){return o.ns(),t})},Sh.prototype.yc=function(t){var e=this;return xh(t).get(zc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new zr(Br.FAILED_PRECONDITION,Ah)})},Sh.prototype.rc=function(t){var e=new zc(this.clientId,this.allowTabSynchronization,Date.now());return xh(t).put(zc.key,e)},Sh.Gs=function(){return ka.Gs()},Sh.prototype.ic=function(t){var e=this,n=xh(t);return n.get(zc.key).next(function(t){return e.oc(t)?(Cr("IndexedDbPersistence","Releasing primary lease."),n.delete(zc.key)):la.resolve()})},Sh.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Lr("Detected an update time that is in the future: "+t+" > "+n),1))},Sh.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},Sh.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},Sh.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},Sh.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},Sh.prototype._c=function(t){try{var e=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Cr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Lr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Sh.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Lr("Failed to set zombie client id.",t)}},Sh.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},Sh.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Sh);function Sh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=o,this.document=s,this.Oo=a,this.Mo=c,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!Sh.Gs())throw new zr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new Ph(this,r),this.Ko=e+"main",this.serializer=new lc(u),this.Wo=new ka(this.Ko,11,new Fc(this.serializer)),this.jo=new mh(this.Vr,this.serializer),this.os=new dh,this.ss=(e=this.serializer,u=this.os,new kc(e,u)),this.Go=new hh(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===c&&Lr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Dh(t,e){var n=this;return(n=Th.call(this)||this).Lr=t,n.Fo=e,n}function xh(t){return Oh.Ys(t,zc.store)}function kh(t){return Oh.Ys(t,sh.store)}var Ph=(Rh.prototype.Er=function(t){var n=this.Vc(t);return this.db.Ac().vo(t).next(function(e){return n.next(function(t){return e+t})})},Rh.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},Rh.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},Rh.prototype.Ir=function(t,n){return this.vc(t,function(t,e){return n(e)})},Rh.prototype.Do=function(t,e,n){return Ch(t,n)},Rh.prototype.No=function(t,e,n){return Ch(t,n)},Rh.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},Rh.prototype.qr=Ch,Rh.prototype.bc=function(t,e){return r=e,i=!1,Dc(n=t).fi(function(t){return Ac(n,t,r).next(function(t){return t&&(i=!0),la.resolve(!t)})}).next(function(){return i});var n,r,i},Rh.prototype.Ar=function(n,r){var i=this,o=this.db.Rc().Xr(),s=[],u=0;return this.vc(n,function(e,t){t<=r&&(t=i.bc(n,e).next(function(t){if(!t)return u++,o.Jn(n,e).next(function(){return o.Hn(e),Eh(n).delete([0,cc(e.path)])})}),s.push(t))}).next(function(){return la.qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Rh.prototype.removeTarget=function(t,e){e=e.dt(t.Fo);return this.db.Ac().yo(t,e)},Rh.prototype.Sc=Ch,Rh.prototype.vc=function(t,r){var i,t=Eh(t),o=Ta.Ds;return t._i({index:nh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ta.Ds&&r(new fi(fc(i)),o),o=e,i=t):o=Ta.Ds}).next(function(){o!==Ta.Ds&&r(new fi(fc(i)),o)})},Rh.prototype.Pr=function(t){return this.db.Rc().eo(t)},Rh);function Rh(t,e){this.db=t,this.cr=new sc(this,e)}function Ch(t,e){return Eh(t).put((t=t.Fo,new nh(0,cc(e.path),t)))}function Lh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Vh=(Mh.prototype._r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Rr(t,n.Cc)})},Mh);function Mh(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Ci(ei),this.Nc=new fa(Ei,Ti),this.xc=ui.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new Ia(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}function Uh(t,e,n,r){return new Vh(t,e,n,r)}function jh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).rs,m=e.Oc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.rs.Mr(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new Ia(e.Fc,n,e.persistence.Pc()),n.Mr(v)}).next(function(t){for(var e=[],n=[],r=Qi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._s(v,r).next(function(t){return{kc:t,$c:e,Lc:n}})})})];case 1:return r=t.sent(),[2,(e.rs=n,e.Oc=m,e.Dc.Mc(e.Oc),r)]}})})}function qh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Fc.Xr({Zr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=la.resolve(),n.forEach(function(n){u=u.next(function(){return o.Jn(r,n)}).next(function(t){var e=t,t=i.Sn.get(n);jr(null!==t),(!e||e.version.F(t)<0)&&(e=s.yn(n,e,i))&&o.jn(e,i.bn)})}),u.next(function(){return e.rs.$r(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.rs.Ur(t)}).next(function(){return f.Oc._s(t,a)})})}function Fh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Bh(t,o){var h=t,f=o.ft,l=h.Cc;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Fc.Xr({Zr:!0});l=h.Cc;var u=[];o.re.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.jo.Co(s,t.de,e).next(function(){return h.jo.So(s,t._e,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,f).dt(s.Fo),l=l.Tt(e,n),r=o,i=t,jr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i._e.size+i.fe.size+i.de.size)&&u.push(h.jo.yo(s,n))))});var e,a,n,c,r,i=zi;return o.ce.forEach(function(t,e){o.ue.has(t)&&u.push(h.persistence.Vr.Sc(s,t))}),u.push((e=s,a=t,n=o.ce,c=f,r=Qi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=zi;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof lu&&e.version.isEqual(ui.min())?(a.Hn(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.jn(e,r),o=o.Tt(t,e)):Cr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(ui.min())||(e=h.jo.To(s).next(function(t){return h.jo.mo(s,s.Fo,f)}),u.push(e)),la.qn(u).next(function(){return t.apply(s)}).next(function(){return h.Oc.fs(s,i)})}).then(function(t){return h.Cc=l,t})}function zh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.jo.bo(e,r).next(function(t){return t?(n=t,la.resolve(n)):i.jo.fo(e).next(function(t){return n=new xi(r,t,0,e.Fo),i.jo.Ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Cc.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Cc=i.Cc.Tt(t.targetId,t),i.Nc.set(r,t.targetId)),t})}function Gh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Cc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Vr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ua(r=t.sent()))throw r;return Cr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Cc=e.Cc.remove(o),e.Nc.delete(n.target),[2]}})})}function Kh(t,o,s){var u=t,a=ui.min(),c=Qi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Nu(o),(void 0!==(t=(i=t).Nc.get(r))?la.resolve(i.Cc.get(t)):i.jo.bo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.jo.xo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Dc.ws(e,o,s?a:ui.min(),s?c:Qi())}).next(function(t){return{documents:t,Bc:c}});var t,n,r,i})}function Wh(t,e){var n=t,r=n.jo,t=n.Cc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Hh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Fc,n=t,t=s.xc,r=e,i=zi,o=yc(t),t=Vc(n),n=IDBKeyRange.lowerBound(o,!0),t._i({index:Zc.readTimeIndex,range:n},function(t,e){var n=pc(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:vc(o)}});var e,n,r,i,o}).then(function(t){var e=t.qc,t=t.readTime;return s.xc=t,e})}function Yh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Vc(t),r=ui.min(),t._i({index:Zc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=vc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.xc=t})]})})}function Qh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Br.FAILED_PRECONDITION||e.message!==_a)throw e;return Cr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Xh(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return mf(this)?(Cr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(4),[4,ff(e)];case 1:return t.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,hf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new rf(n,r)}var Jh,$h,Zh,Ee=(cf.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},cf.prototype.zc=function(){return 2===this.state},cf.prototype.start=function(){3!==this.state?this.auth():this.Hc()},cf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},cf.prototype.Jc=function(){this.state=0,this.Si.reset()},cf.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},cf.prototype.Zc=function(t){this.tu(),this.stream.send(t)},cf.prototype.Xc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},cf.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},cf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==e?this.Si.reset():n&&n.code===Br.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===Br.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.nu(n)];case 1:return t.sent(),[2]}})})},cf.prototype.eu=function(){},cf.prototype.auth=function(){var n=this;this.state=1;var t=this.su(this.Wc),e=this.Wc;this.Kc.getToken().then(function(t){n.Wc===e&&n.iu(t)},function(e){t(function(){var t=new zr(Br.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ru(t)})})},cf.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},cf.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},cf.prototype.ru=function(t){return Cr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},cf.prototype.su=function(e){var n=this;return function(t){n.Cs.Ri(function(){return n.Wc===e?t():(Cr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},cf),tf=(n(af,Zh=Ee),af.prototype.ou=function(t){return this.Qc.uu("Listen",t)},af.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Ur(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.tn?(jr(void 0===o||"string"==typeof o),Ni.fromBase64String(o||"")):(jr(void 0===o||o instanceof Uint8Array),Ni.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Br.UNKNOWN:Ri(s.code),new zr(o,s.message||"")),r=new io(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Xo(t,u.document.name),a=Wo(u.document.updateTime),s=new nu({mapValue:{fields:u.document.fields}}),a=new fu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new no(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Xo(t,u.document),c=u.readTime?Wo(u.readTime):ui.min(),c=new lu(a,c),u=u.removedTargetIds||[];r=new no([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Xo(t,c.document),c=c.removedTargetIds||[];r=new no([],c,h,null)}else{if(!("filter"in e))return Ur();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Si(e),h=h.targetId;r=new ro(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ui.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Wo(t.readTime):ui.min()}(t);return this.listener.au(e,t)},af.prototype.hu=function(t){var e,n,r,i={};i.database=Zo(this.serializer),i.addTarget=(e=this.serializer,(r=Ai(r=(n=t).target)?{documents:is(e,r)}:{query:os(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Ko(e,n.resumeToken):0<n.ft.F(ui.min())&&(r.readTime=Go(e,n.ft.M())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ur()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Zc(i)},af.prototype.lu=function(t){var e={};e.database=Zo(this.serializer),e.removeTarget=t,this.Zc(e)},af),ef=(n(uf,$h=Ee),Object.defineProperty(uf.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),uf.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,$h.prototype.start.call(this)},uf.prototype.eu=function(){this._u&&this.du([])},uf.prototype.ou=function(t){return this.Qc.uu("Write",t)},uf.prototype.onMessage=function(t){if(jr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(jr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Wo(t.updateTime):Wo(e);n.isEqual(ui.min())&&(n=Wo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Rs(n,e)}(t,r)})):[]),n=Wo(t.commitTime);return this.listener.wu(n,e)}var n,r;return jr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},uf.prototype.Tu=function(){var t={};t.database=Zo(this.serializer),this.Zc(t)},uf.prototype.du=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ns(e.serializer,t)})};this.Zc(t)},uf),nf=(n(sf,Jh=function(){}),sf.prototype.mu=function(){if(this.Iu)throw new zr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},sf.prototype.Au=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Au(e,n,r,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&i.credentials.m(),t})},sf.prototype.Ru=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Ru(e,n,r,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&i.credentials.m(),t})},sf.prototype.terminate=function(){this.Iu=!1},sf),rf=(of.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},of.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,1<=this.gu&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},of.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},of.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},of.prototype.bu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(Lr(t),this.Vu=!1):Cr("OnlineStateTracker",t)},of.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},of);function of(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}function sf(t,e,n){var r=this;return(r=Jh.call(this)||this).credentials=t,r.Qc=e,r.serializer=n,r.Iu=!1,r}function uf(t,e,n,r,i){var o=this;return(o=$h.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o._u=!1,o}function af(t,e,n,r,i){var o=this;return(o=Zh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function cf(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new xa(t,e)}function hf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!mf(r))return[3,4];e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ff(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function lf(t,e){t.Ou.has(e.targetId)||(t.Ou.set(e.targetId,e),gf(t)?vf(t):Of(t).zc()&&df(t,e))}function pf(t,e){var n=t,t=Of(n);n.Ou.delete(e),t.zc()&&yf(n,e),0===n.Ou.size&&(t.zc()?t.Yc():mf(n)&&n.Bu.set("Unknown"))}function df(t,e){t.qu.De(e.targetId),Of(t).hu(e)}function yf(t,e){t.qu.De(e),Of(t).lu(e)}function vf(e){e.qu=new so({Xe:function(t){return e.xu.Xe(t)},Ze:function(t){return e.Ou.get(t)||null}}),Of(e).start(),e.Bu.pu()}function gf(t){return mf(t)&&!Of(t).Gc()&&0<t.Ou.size}function mf(t){return 0===t.Mu.size}function wf(t){t.qu=void 0}function bf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bu.set("Online"),!(u instanceof io&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ou.has(i)?[4,o.xu.Uu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ou.delete(i),o.qu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Cr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,_f(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof no?s.qu.$e(u):u instanceof ro?s.qu.je(u):s.qu.qe(u),a.isEqual(ui.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Fh(s.Cu)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).qu.He(i)).re.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.Ou.get(e))&&r.Ou.set(e,n.wt(t.resumeToken,i)))}),e.oe.forEach(function(t){var e=r.Ou.get(t);e&&(r.Ou.set(t,e.wt(Ni.lt,e.ft)),yf(r,t),e=new xi(e.target,t,1,e.sequenceNumber),df(r,e))}),r.xu.Qu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Cr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,_f(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function _f(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ua(r))throw r;return n.Mu.add(1),[4,ff(n)];case 1:return t.sent(),n.Bu.set("Offline"),i=i||function(){return Fh(n.Cu)},n.di.Mi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Cr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mu.delete(1),[4,hf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function If(e,n){return n().catch(function(t){return _f(e,t,n)})}function Ef(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Sf(i=a),s=0<i.Fu.length?i.Fu[i.Fu.length-1].batchId:-1,t.label=1;case 1:if(!(mf(i)&&i.Fu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Cu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.rs.Fr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Fu.length&&o.Yc(),[3,7]):(s=u.batchId,function(t,e){t.Fu.push(e);t=Sf(t);t.zc()&&t.fu&&t.du(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,_f(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Tf(i)&&Af(i),[2]}var e,n,r})})}function Tf(t){return mf(t)&&!Sf(t).Gc()&&0<t.Fu.length}function Af(t){Sf(t).start()}function Nf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mu.delete(2),[4,hf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mu.add(2),[4,ff(e)]);case 3:t.sent(),e.Bu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Of(n){var t,e,r,i=this;return n.ju||(n.ju=(t=n.Nu,e=n.di,r={cu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Ou.forEach(function(t,e){df(n,t)}),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return wf(e),gf(e)?(e.Bu.Su(n),vf(e)):e.Bu.set("Unknown"),[2]})})}.bind(null,n),au:bf.bind(null,n)},t.mu(),new tf(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ju.Jc(),gf(n)?vf(n):n.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ju.stop()];case 2:t.sent(),wf(n),t.label=3;case 3:return[2]}})})})),n.ju}function Sf(n){var t,e,r,i=this;return n.Gu||(n.Gu=(t=n.Nu,e=n.di,r={cu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Sf(e).Tu(),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Sf(e).fu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Pi(n=i.code)&&n!==Br.ABORTED?(e=r.Fu.shift(),Sf(r).Jc(),[4,If(r,function(){return r.xu.Wu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Ef(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Tf(e)&&Af(e),[2]}})})}.bind(null,n),Eu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Sf(o),n=0,r=o.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]})})}.bind(null,n),wu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Fu.shift(),n=ha.from(e,i,o),[4,If(r,function(){return r.xu.Ku(n)})];case 1:return t.sent(),[4,Ef(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mu(),new ef(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gu.Jc(),[4,Ef(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Gu.stop()];case 3:t.sent(),0<n.Fu.length&&(Cr("RemoteStore","Stopping write stream with "+n.Fu.length+" pending writes"),n.Fu=[]),t.label=4;case 4:return[2]}})})})),n.Gu}function Df(){this.queries=new fa(Du,Su),this.onlineState="Unknown",this.Hu=new Set}var xf=function(){this.zu=void 0,this.listeners=[]};function kf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new xf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ju(n)];case 2:return o.zu=t.sent(),[3,4];case 3:return o=t.sent(),o=$a(o,"Initialization of query '"+xu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Yu(e.onlineState),i.zu&&u.Xu(i.zu)&&Rf(e),[2]}})})}function Pf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Zu(n))]:[2]})})}function Rf(t){t.Hu.forEach(function(t){t.next()})}var Cf=(jf.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},jf.prototype.onError=function(t){this.ta.error(t)},jf.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},jf.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},jf.prototype.sa=function(t){if(0<t.docChanges.length)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},jf.prototype.ra=function(t){t=Zi.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},jf),Lf=(Uf.prototype.W=function(){return this.ca.W()},Uf.prototype.Do=function(t,e){e=new Vf(t,e);this.ca=this.ca.add(e),this.aa=this.aa.add(e)},Uf.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Uf.prototype.No=function(t,e){this._a(new Vf(t,e))},Uf.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},Uf.prototype.da=function(t){var e=this,n=new fi(new ai([])),r=new Vf(n,t),t=new Vf(n,t+1),i=[];return this.aa.Kt([r,t],function(t){e._a(t),i.push(t.key)}),i},Uf.prototype.wa=function(){var e=this;this.ca.forEach(function(t){return e._a(t)})},Uf.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},Uf.prototype.Ea=function(t){var e=new fi(new ai([])),n=new Vf(e,t),t=new Vf(e,t+1),r=Qi();return this.aa.Kt([n,t],function(t){r=r.add(t.key)}),r},Uf.prototype.Qr=function(t){var e=new Vf(t,0),e=this.ca.jt(e);return null!==e&&t.isEqual(e.key)},Uf),Vf=(Mf.ua=function(t,e){return fi.$(t.key,e.key)||ei(t.Ta,e.Ta)},Mf.ha=function(t,e){return ei(t.Ta,e.Ta)||fi.$(t.key,e.key)},Mf);function Mf(t,e){this.key=t,this.Ta=e}function Uf(){this.ca=new Fi(Vf.ua),this.aa=new Fi(Vf.ha)}function jf(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}function qf(t,e){return"firestore_clients_"+t+"_"+e}function Ff(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.u()&&(n+="_"+e.uid),n}function Bf(t,e){return"firestore_targets_"+t+"_"+e}var zf=(hl.Ia=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new zr(r.error.code,r.error.message)),i?new hl(t,e,r.state,o):(Lr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},hl.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},hl),Gf=(cl.Ia=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new zr(n.error.code,n.error.message)),r?new cl(t,n.state,i):(Lr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},cl.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},cl),Kf=(al.Ia=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Xi,o=0;r&&o<n.activeTargetIds.length;++o)r=bi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new al(t,i):(Lr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},al),Wf=(ul.Ia=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new ul(e.clientId,e.onlineState):(Lr("SharedClientState","Failed to parse online state: "+t),null)},ul),Hf=(sl.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},sl.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},sl.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},sl),Yf=(ol.Gs=function(t){return!(!t||!t.localStorage)},ol.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ga.Ic()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(qf(this.persistenceKey,r)))&&(o=Kf.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)h=c[a],this.Va(h);return this.va=[],this.window.addEventListener("unload",function(){return f.fc()}),this.lr=!0,[2]}})})},ol.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},ol.prototype.$a=function(){return this.La(this.pa)},ol.prototype.Ba=function(n){var r=!1;return this.pa.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},ol.prototype.qa=function(t){this.Ua(t,"pending")},ol.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},ol.prototype.Wa=function(t){var e,n="not-current";return this.Ba(t)&&(!(e=this.storage.getItem(Bf(this.persistenceKey,t)))||(e=Gf.Ia(t,e))&&(n=e.state)),this.ja.Aa(t),this.Oa(),n},ol.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},ol.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},ol.prototype.Ha=function(t){this.removeItem(Bf(this.persistenceKey,t))},ol.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},ol.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},ol.prototype.Za=function(t){this.th(t)},ol.prototype.eh=function(){this.nh()},ol.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},ol.prototype.getItem=function(t){var e=this.storage.getItem(t);return Cr("SharedClientState","READ",t,e),e},ol.prototype.setItem=function(t,e){Cr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},ol.prototype.removeItem=function(t){Cr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},ol.prototype.Va=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Cr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.ba)return void Lr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.lr){if(null!==o.key)if(this.Da.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.uh(n)]}else if(this.Na.test(o.key)){if(null!==o.newValue&&(r=this.ah(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xa){if(null!==o.newValue&&(i=this.Ma(o.newValue)))return[2,this.ka(i)]}else if(o.key===this.Sa)(i=function(t){var e=Ta.Ds;if(null!=t)try{var n=JSON.parse(t);jr("number"==typeof n),e=n}catch(t){Lr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Ta.Ds&&this.ps(i);else if(o.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(o);return[2]})})})}},Object.defineProperty(ol.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),ol.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},ol.prototype.Ua=function(t,e,n){n=new zf(this.currentUser,t,e,n),t=Ff(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ma())},ol.prototype.Ka=function(t){t=Ff(this.persistenceKey,this.currentUser,t);this.removeItem(t)},ol.prototype.th=function(t){t={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(t))},ol.prototype.Ya=function(t,e,n){var r=Bf(this.persistenceKey,t),n=new Gf(t,e,n);this.setItem(r,n.ma())},ol.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},ol.prototype.sh=function(t){t=this.Da.exec(t);return t?t[1]:null},ol.prototype.rh=function(t,e){t=this.sh(t);return Kf.Ia(t,e)},ol.prototype.oh=function(t,e){var n=this.Ca.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return zf.Ia(new Sr(n),t,e)},ol.prototype.ah=function(t,e){t=this.Na.exec(t),t=Number(t[1]);return Gf.Ia(t,e)},ol.prototype.Ma=function(t){return Wf.Ia(t)},ol.prototype.uh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ga._h(e.batchId,e.state,e.error)]:(Cr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},ol.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},ol.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},ol.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},ol.prototype.La=function(t){var n=Xi;return t.forEach(function(t,e){n=n.Gt(e.activeTargetIds)}),n},ol),Qf=(il.prototype.qa=function(t){},il.prototype.Qa=function(t,e,n){},il.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},il.prototype.Ja=function(t,e,n){this.Eh[t]=e},il.prototype.Ga=function(t){this.wh.Ra(t)},il.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},il.prototype.Ha=function(t){delete this.Eh[t]},il.prototype.$a=function(){return this.wh.activeTargetIds},il.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},il.prototype.start=function(){return this.wh=new Hf,Promise.resolve()},il.prototype.Xa=function(t,e,n){},il.prototype.Za=function(t){},il.prototype.fc=function(){},il.prototype.Ss=function(t){},il.prototype.eh=function(){},il),Xf=function(t){this.key=t},Jf=function(t){this.key=t},$f=(Object.defineProperty(rl.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),rl.prototype.gh=function(t,e){var s=this,u=e?e.yh:new $i,a=(e||this).Rh,c=(e||this).ee,h=a,f=!1,l=bu(this.query)&&a.size===this.query.limit?a.last():null,p=_u(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof fu?e:null)&&(ku(s.query,r)?r:null),i=!!n&&s.ee.has(n.key),o=!!r&&(r.an||s.ee.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Vh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),bu(this.query)||_u(this.query))for(;h.size>this.query.limit;){var n=bu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,yh:u,ph:f,ee:c}},rl.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},rl.prototype.Zn=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var i=t.yh.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ur()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.le?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Zi(this.query,t.Rh,r,i,t.ee,0==n,e,!1),Dh:s}:{Dh:s}},rl.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new $i,ee:this.ee,ph:!1},!1)):{Dh:[]}},rl.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},rl.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},rl.prototype.Sh=function(){var e=this;if(!this.le)return[];var n=this.mh;this.mh=Qi(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Jf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Xf(t))}),r},rl.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Qi();t=this.gh(t.documents);return this.Zn(t,!0)},rl.prototype.xh=function(){return Zi.ie(this.query,this.Rh,this.ee,0===this.Ih)},rl),Zf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},tl=function(t){this.key=t,this.Fh=!1},el=(Object.defineProperty(nl.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),nl);function nl(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new fa(Du,Su),this.qh=new Map,this.Uh=[],this.Qh=new Ci(fi.$),this.Kh=new Map,this.Wh=new Lf,this.jh={},this.Gh=new Map,this.zh=gh._o(),this.onlineState="Unknown",this.Hh=void 0}function rl(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Qi(),this.ee=Qi(),this.Ah=Pu(t),this.Rh=new Ji(this.Ah)}function il(){this.wh=new Hf,this.Eh={},this.Pu=null,this.ps=null}function ol(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Ci(ei),this.lr=!1,this.va=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=qf(this.persistenceKey,this.Pa),this.Sa="firestore_sequence_number_"+this.persistenceKey,this.pa=this.pa.Tt(this.Pa,new Hf),this.Da=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xa="firestore_online_state_"+this.persistenceKey,this.Fa="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.ya)}function sl(){this.activeTargetIds=Xi}function ul(t,e){this.clientId=t,this.onlineState=e}function al(t,e){this.clientId=t,this.activeTargetIds=e}function cl(t,e,n){this.targetId=t,this.state=e,this.error=n}function hl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function fl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Kh(r.Cu,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.re.get(i.targetId),n=i.view.Zn(e,r.Jh,n),[2,(_l(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Kh(i.Cu,o,!0)];case 1:return n=t.sent(),r=new $f(o,n.Bc),e=r.gh(n.documents),n=eo.he(s,u&&"Offline"!==i.onlineState),n=r.Zn(e,i.Jh,n),_l(i,s,n.Dh),r=new Zf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function ll(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=xl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Cu,a=p,h=i,f=si.now(),o=a.reduce(function(t,e){return t.add(e.key)},Qi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Oc._s(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Qs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof fu?t.field(i.field):void 0,o=ps(i.transform,o||null);null!=o&&(e=(null==e?new ru:e).set(i.field,o))}return e?e.hn():null}(o):null);null!=o&&e.push(new Gs(i.key,o,function s(t){var u=[];return mo(t.fields||{},function(t,e){var n=new hi([t]);if(Mo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new xs(u)}(o.proto.mapValue),Cs.exists(!0)))}return h.rs.Sr(u,f,e,a)})}).then(function(t){var e=t.vn(c);return{batchId:t.batchId,Qn:e}}))];case 2:return s=t.sent(),u.kh.qa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.h()])||new Ci(ei)).Tt(n,r),e.jh[e.currentUser.h()]=i,[4,El(u,s.Qn)];case 3:return t.sent(),[4,Ef(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=$a(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function pl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Bh(n.Cu,i)];case 2:return e=t.sent(),i.re.forEach(function(t,e){e=n.Kh.get(e);e&&(jr(t._e.size+t.fe.size+t.de.size<=1),0<t._e.size?e.Fh=!0:0<t.fe.size?jr(e.Fh):0<t.de.size&&(jr(e.Fh),e.Fh=!1))}),[4,El(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function dl(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Yu(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Yu(i)&&(o=!0)}),o&&Rf(t)}(t.Mh,n),r.length&&t.Lh.au(r),t.onlineState=n,t.Jh&&t.kh.Za(n))}function yl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.rs.Cr(e,r).next(function(t){return jr(null!==t),n=t.keys(),i.rs.$r(e,t)}).next(function(){return i.rs.Ur(e)}).next(function(){return i.Oc._s(e,n)})}))];case 2:return o=t.sent(),ml(n,u,a),gl(n,u),n.kh.Qa(u,"rejected",a),[4,El(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function vl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:mf((n=o).Oh)||Cr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Cu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=$a(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function gl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function ml(t,e,n){var r=t,i=r.jh[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i)}function wl(e,t,n){void 0===n&&(n=null),e.kh.Ga(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.da(t).forEach(function(t){e.Wh.Qr(t)||bl(e,t)})}function bl(t,e){var n=t.Qh.get(e);null!==n&&(pf(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),Il(t))}function _l(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Xf?(t.Wh.Do(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(Cr("SyncEngine","New document in limbo: "+e),t.Uh.push(e),Il(t))}(t,o)):o instanceof Jf?(Cr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||bl(t,o.key)):Ur()}}function Il(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new tl(e)),t.Qh=t.Qh.Tt(e,n),lf(t.Oh,new xi(Nu(wu(e.path)),n,2,Ta.Ds))}}function El(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.W()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ea.Vs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.au(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return la.forEach(c,function(e){return la.forEach(e.gs,function(t){return r.persistence.Vr.Do(n,e.targetId,t)}).next(function(){return la.forEach(e.ys,function(t){return r.persistence.Vr.No(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ua(e=t.sent()))throw e;return Cr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Cc.get(o),u=s.ft,u=s.Et(u),r.Cc=r.Cc.Tt(o,u));return[2]}})})}(n.Cu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Tl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Cr("SyncEngine","User change. New user:",o.h()),[4,jh(n.Cu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new zr(Br.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xa(o,r.$c,r.Lc),[4,El(n,r.kc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Al(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Cu,n=a,i=(r=e).rs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Nr(e,n).next(function(t){return t?r.Oc._s(e,t):la.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Ef(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(ml(o,a,h||null),gl(o,a),o.Cu.rs.Br(a)):Ur(),t.label=4;case 4:return[4,El(o,s)];case 5:return t.sent(),[3,7];case 6:Cr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Nl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Dl(r=h),xl(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$a(),[4,Ol(r,e.H())]);case 1:return i=t.sent(),r.Hh=!0,[4,Nf(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],lf(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?a.push(e):c=c.then(function(){return wl(r,e),Gh(r.Cu,e,!0)}),pf(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,Ol(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){pf(n.Oh,e)}),n.Wh.wa(),n.Kh=new Map,n.Qh=new Ci(fi.$),r.Hh=!1,[4,Nf(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Ol(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,zh(e.Cu,Nu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Kh((e=r).Cu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&_l(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Wh(e.Cu,s)];case 8:return l=t.sent(),[4,zh(e.Cu,l)];case 9:return u=t.sent(),[4,fl(e,Sl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.au(r),n)]}})})}function Sl(t){return mu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Dl(t){return t.Oh.xu.Qu=pl.bind(null,t),t.Oh.xu.Xe=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Qi().add(t.key);var r=Qi();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Gt(s.view.Ph);return r}.bind(null,t),t.Oh.xu.Uu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ja(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Ci(fi.$)).Tt(n,new lu(n,ui.min())),i=Qi().add(n),i=new to(ui.min(),new Map,new Fi(ei),r,i),[4,pl(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),Il(e),[3,4];case 2:return[4,Gh(e.Cu,s,!1).then(function(){return wl(e,s,u)}).catch(Qh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.au=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&Rf(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function xl(t){return t.Oh.xu.Ku=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,qh(e.Cu,o)];case 2:return r=t.sent(),ml(e,n,null),gl(e,n),e.kh.Qa(n,"acknowledged"),[4,El(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.xu.Wu=yl.bind(null,t),t}var kl,Pl,Rl,Cl,Ll,Vl=(bp.prototype.Mc=function(t){this.Zh=t},bp.prototype.ws=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Tn.length||1===r.Tn.length&&r.Tn[0].field.tt())||i.isEqual(ui.min())?this.tl(e,r):this.Zh._s(e,o).next(function(t){var n=s.el(r,t);return(bu(r)||_u(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Rr()<=l.DEBUG&&Cr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xu(r)),s.Zh.ws(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},bp.prototype.el=function(n,t){var r=new Fi(Pu(n));return t.forEach(function(t,e){e instanceof fu&&ku(n,e)&&(r=r.add(e))}),r},bp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},bp.prototype.tl=function(t,e){return Rr()<=l.DEBUG&&Cr("IndexFreeQueryEngine","Using full collection scan to execute query:",xu(e)),this.Zh.ws(t,e,ui.min())},bp),Ml=(wp.prototype.br=function(t){return la.resolve(0===this.rs.length)},wp.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.rs.length&&this.rs[this.rs.length-1];n=new ca(i,e,n,r);this.rs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new Vf(u.key,i)),this.os.Dr(t,u.key.path.q())}return la.resolve(n)},wp.prototype.Cr=function(t,e){return la.resolve(this.il(e))},wp.prototype.Fr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return la.resolve(this.rs.length>e?this.rs[e]:null)},wp.prototype.Or=function(){return la.resolve(0===this.rs.length?-1:this.nl-1)},wp.prototype.Mr=function(t){return la.resolve(this.rs.slice())},wp.prototype.us=function(t,e){var n=this,r=new Vf(e,0),e=new Vf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Kt([r,e],function(t){t=n.il(t.Ta);i.push(t)}),la.resolve(i)},wp.prototype.ds=function(t,e){var n=this,r=new Fi(ei);return e.forEach(function(t){var e=new Vf(t,0),t=new Vf(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,t],function(t){r=r.add(t.Ta)})}),la.resolve(this.ol(r))},wp.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,e=n;fi.ot(e)||(e=e.child(""));var e=new Vf(new fi(e),0),i=new Fi(ei);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(i=i.add(t.Ta)),!0)},e),la.resolve(this.ol(i))},wp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},wp.prototype.$r=function(n,r){var i=this;jr(0===this.cl(r.batchId,"removed")),this.rs.shift();var o=this.sl;return la.forEach(r.mutations,function(t){var e=new Vf(t.key,r.batchId);return o=o.delete(e),i.Vr.qr(n,t.key)}).next(function(){i.sl=o})},wp.prototype.Br=function(t){},wp.prototype.Qr=function(t,e){var n=new Vf(e,0),n=this.sl.jt(n);return la.resolve(e.isEqual(n&&n.key))},wp.prototype.Ur=function(t){return this.rs.length,la.resolve()},wp.prototype.cl=function(t,e){return this.rl(t)},wp.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},wp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.rs.length?null:this.rs[t]},wp),Ul=(mp.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:i,readTime:n}),this.size+=i-o,this.os.Dr(t,r.path.q())},mp.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},mp.prototype.Jn=function(t,e){e=this.docs.get(e);return la.resolve(e?e.zn:null)},mp.prototype.getEntries=function(t,e){var n=this,r=zi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),la.resolve(r)},mp.prototype.ws=function(t,e,n){for(var r=Wi,i=new fi(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.key,a=s.value,s=a.zn,a=a.readTime;if(!e.path.j(u.path))break;a.F(n)<=0||s instanceof fu&&ku(e,s)&&(r=r.Tt(s.key,s))}return la.resolve(r)},mp.prototype.al=function(t,e){return la.forEach(this.docs,function(t){return e(t)})},mp.prototype.Xr=function(t){return new jl(this)},mp.prototype.eo=function(t){return la.resolve(this.size)},mp),jl=(n(gp,Ll=h),gp.prototype.Zn=function(n){var r=this,i=[];return this.Qn.forEach(function(t,e){e&&e.zn?i.push(r.no.jn(n,e.zn,r.Wn(t))):r.no.Hn(t)}),la.qn(i)},gp.prototype.Yn=function(t,e){return this.no.Jn(t,e)},gp.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},gp),ql=(vp.prototype.Ue=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),la.resolve()},vp.prototype.To=function(t){return la.resolve(this.lastRemoteSnapshotVersion)},vp.prototype.Io=function(t){return la.resolve(this.ll)},vp.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),la.resolve(this.highestTargetId)},vp.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),la.resolve()},vp.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new gh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},vp.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,la.resolve()},vp.prototype.yo=function(t,e){return this.Ro(e),la.resolve()},vp.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),--this.targetCount,la.resolve()},vp.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.po(n,e.targetId)),s++)}),la.qn(u).next(function(){return s})},vp.prototype.vo=function(t){return la.resolve(this.targetCount)},vp.prototype.bo=function(t,e){e=this.hl.get(e)||null;return la.resolve(e)},vp.prototype.So=function(t,e,n){return this._l.la(e,n),la.resolve()},vp.prototype.Co=function(e,t,n){this._l.fa(t,n);var r=this.persistence.Vr,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),la.qn(i)},vp.prototype.po=function(t,e){return this._l.da(e),la.resolve()},vp.prototype.xo=function(t,e){e=this._l.Ea(e);return la.resolve(e)},vp.prototype.Qr=function(t,e){return la.resolve(this._l.Qr(e))},vp),Fl=(yp.prototype.ro=function(t,e){return la.resolve(this.dl.get(e))},yp.prototype.oo=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Wo(e.createTime)}),la.resolve()},yp.prototype.co=function(t,e){return la.resolve(this.wl.get(e))},yp.prototype.uo=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:Ic(e.bundledQuery),readTime:Wo(e.readTime)}),la.resolve()},yp),Bl=(dp.prototype.start=function(){return Promise.resolve()},dp.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(dp.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),dp.prototype.tc=function(){},dp.prototype.ec=function(){},dp.prototype.Pc=function(){return this.os},dp.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Ml(this.os,this.Vr),this.El[t.h()]=e),e},dp.prototype.Ac=function(){return this.jo},dp.prototype.Rc=function(){return this.ss},dp.prototype.gc=function(){return this.Go},dp.prototype.runTransaction=function(t,e,n){var r=this;Cr("MemoryPersistence","Starting transaction:",t);var i=new zl(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},dp.prototype.Al=function(e,n){return la.Un(Object.values(this.El).map(function(t){return function(){return t.Qr(e,n)}}))},dp),zl=(n(pp,Cl=Ie),pp),Gl=(lp.gl=function(t){return new lp(t)},Object.defineProperty(lp.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Ur()},enumerable:!1,configurable:!0}),lp.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),la.resolve()},lp.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),la.resolve()},lp.prototype.qr=function(t,e){return this.yl.add(e.toString()),la.resolve()},lp.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},lp.prototype.Il=function(){this.Pl=new Set},lp.prototype.ml=function(n){var r=this,i=this.persistence.Rc().Xr();return la.forEach(this.yl,function(t){var e=fi.st(t);return r.Vl(n,e).next(function(t){t||i.Hn(e)})}).next(function(){return r.Pl=null,i.apply(n)})},lp.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},lp.prototype.Tl=function(t){return 0},lp.prototype.Vl=function(t,e){var n=this;return la.Un([function(){return la.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},lp),Kl=(fp.prototype.cu=function(t){this.bl=t},fp.prototype.nu=function(t){this.Sl=t},fp.prototype.onMessage=function(t){this.Dl=t},fp.prototype.close=function(){this.vl()},fp.prototype.send=function(t){this.pl(t)},fp.prototype.Cl=function(){this.bl()},fp.prototype.Nl=function(t){this.Sl(t)},fp.prototype.xl=function(t){this.Dl(t)},fp),Wl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Hl=(hp.prototype.Au=function(e,t,n,r){var i=this.kl(e,t);Cr("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Cr("RestConnection","Received: ",t),t},function(t){throw Vr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},hp.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},hp.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-2020102005919",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},hp.prototype.kl=function(t,e){t=Wl[t];return this.Ol+"/v1/"+e+":"+t},n(cp,Rl=hp),cp.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new Er;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Cr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Cr("Connection",'RPC "'+o+'" timed out'),r(new zr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Cr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Br).indexOf(e)?e:Br.UNKNOWN,r(new zr(e,t.message))):r(new zr(Br.UNKNOWN,"Server responded with status "+i.getStatus())):r(new zr(Br.UNAVAILABLE,"Connection failed."));break;default:Ur()}}finally{Cr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},cp.prototype.uu=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Cr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Kl({pl:function(t){a?Cr("Connection","Not sending because WebChannel is closed:",t):(u||(Cr("Connection","Opening WebChannel transport."),s.open(),u=!0),Cr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Ir.EventType.OPEN,function(){a||Cr("Connection","WebChannel transport opened.")}),t(s,Ir.EventType.CLOSE,function(){a||(a=!0,Cr("Connection","WebChannel transport closed"),c.Nl())}),t(s,Ir.EventType.ERROR,function(t){a||(a=!0,Vr("Connection","WebChannel transport errored:",t),c.Nl(new zr(Br.UNAVAILABLE,"The operation could not be completed")))}),t(s,Ir.EventType.MESSAGE,function(t){var e,n,r,i;a||(jr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Cr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Di[r];if(void 0!==t)return Ri(t)}(),i=n.message,void 0===t&&(t=Br.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Nl(new zr(t,i)),s.close()):(Cr("Connection","WebChannel received:",e),c.xl(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Cr("Connection","Detected buffering proxy"):t.stat===_r&&Cr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Cl()},0),c},cp),Yl=(ap.prototype.Lu=function(t){this.Kl.push(t)},ap.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},ap.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},ap.prototype.ql=function(){Cr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},ap.prototype.Ql=function(){Cr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},ap.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ap),Ql=(up.prototype.Lu=function(t){},up.prototype.fc=function(){},up),Xl=(sp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=wa(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Cu=this.Jl(e),[2]}})})},sp.prototype.Hl=function(t){return null},sp.prototype.Jl=function(t){return Uh(this.persistence,new Vl,t.Yl,this.serializer)},sp.prototype.Gl=function(t){return new Bl(Gl.gl,this.serializer)},sp.prototype.jl=function(t){return new Qf},sp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},sp),Jl=(n(op,Pl=Xl),op.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Pl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Yh(this.Cu)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,xl(this.Xl.ga)];case 4:return t.sent(),[4,Ef(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},op.prototype.Jl=function(t){return Uh(this.persistence,new Vl,t.Yl,this.serializer)},op.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new oc(e,t.di)},op.prototype.Gl=function(t){var e=Lh(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?nc.er(this.cacheSizeBytes):nc.ir;return new Oh(this.synchronizeTabs,e,t.clientId,n,t.di,Wa(),Ha(),this.serializer,this.kh,!!this.forceOwnership)},op.prototype.jl=function(t){return new Qf},op),$l=(n(ip,kl=Jl),ip.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,kl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.ga,this.kh instanceof Yf?(this.kh.ga={_h:Al.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Cr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Hh(e.Cu)];case 3:return n=t.sent(),r=to.ae(o,"current"===s),[4,El(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Gh(e.Cu,o,!0)];case 6:return t.sent(),wl(e,o,u),[3,8];case 7:Ur(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Dl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Cr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Wh(n.Cu,r)]):[3,6];case 2:return i=t.sent(),[4,zh(n.Cu,i)];case 3:return o=t.sent(),[4,fl(n,Sl(i),o.targetId,!1)];case 4:t.sent(),lf(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,Gh(n.Cu,e,!1).then(function(){pf(n.Oh,e),wl(n,e)}).catch(Qh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ic:function(t){return t.Cu.persistence.Ic()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Hh((e=n).Cu).then(function(t){return El(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Zo(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Nl(this.Xl.ga,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.lr?this.zl.start(this.Cu):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},ip.prototype.jl=function(t){var e=Wa();if(!Yf.Gs(e))throw new zr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Lh(t.Fl.t,t.Fl.persistenceKey);return new Yf(e,t.di,n,t.clientId,t.Yl)},ip),Zl=(rp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Cu?[3,2]:(this.Cu=n.Cu,this.kh=n.kh,this.Nu=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.ga=this.n_(r,!n.synchronizeTabs),this.kh.Pu=function(t){return dl(e.ga,t,1)},this.Oh.xu.s_=Tl.bind(null,this.ga),[4,Nf(this.Oh,this.ga.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},rp.prototype.e_=function(t){return new Df},rp.prototype.Zl=function(t){var e=wa(t.Fl.t),n=(n=t.Fl,new Hl(n));return t=t.credentials,new nf(t,n,e)},rp.prototype.t_=function(t){var e=this,n=this.Cu,r=this.Nu,i=t.di,o=function(t){return dl(e.ga,t,0)},t=new(Yl.Gs()?Yl:Ql);return new Xh(n,r,i,o,t)},rp.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new el(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},rp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Cr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,ff(e)];case 1:return t.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},rp),tp=(np.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},np.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},np.prototype.r_=function(){this.muted=!0},np.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},np),ep=function(t){this.o_=t};function np(t){this.observer=t,this.muted=!1}function rp(){}function ip(t,e){var n=this;return(n=kl.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function op(t,e,n){var r=this;return(r=Pl.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function sp(){this.synchronizeTabs=!1}function up(){}function ap(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function cp(t){var e=this;return(e=Rl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function hp(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function fp(t){this.pl=t.pl,this.vl=t.vl}function lp(t){this.persistence=t,this.Rl=new Lf,this.Pl=null}function pp(t){var e=this;return(e=Cl.call(this)||this).Fo=t,e}function dp(t,e){var n=this;this.El={},this.ko=new Ta(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new ql(this),this.os=new jc,this.ss=(t=this.os,new Ul(t,function(t){return n.Vr.Tl(t)})),this.serializer=new lc(e),this.Go=new Fl(this.serializer)}function yp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function vp(t){this.persistence=t,this.hl=new fa(Ei,Ti),this.lastRemoteSnapshotVersion=ui.min(),this.highestTargetId=0,this.ll=0,this._l=new Lf,this.targetCount=0,this.fl=gh.lo()}function gp(t){var e=this;return(e=Ll.call(this)||this).no=t,e}function mp(t,e){this.os=t,this.ul=e,this.docs=new Ci(fi.$),this.size=0}function wp(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Fi(Vf.ua)}function bp(){}function _p(t,e,n){if(!n)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ip(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new zr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ep(t,e,n,r){if(!0===e&&!0===r)throw new zr(Br.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Tp(t){if(!fi.ot(t))throw new zr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ap(t){if(fi.ot(t))throw new zr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Np(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ur();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Op(t,e){if(t instanceof ep&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new zr(Br.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Np(t);throw new zr(Br.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Sp(t,e){if(e<=0)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Dp,xp=function(t){this.c_=t},kp=(n(Pp,Dp=xp),Pp.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},Pp.prototype.isEqual=function(t){return t instanceof Pp},Pp);function Pp(){return null!==Dp&&Dp.apply(this,arguments)||this}function Rp(t,e,n){return new Oy({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Cp,Lp,Vp,Mp,Up=(n(td,Mp=xp),td.prototype.u_=function(t){return new ks(t.path,new vs)},td.prototype.isEqual=function(t){return t instanceof td},td),jp=(n(Zp,Vp=xp),Zp.prototype.u_=function(t){var e=Rp(this,t,!0),n=this.f_.map(function(t){return Ly(t,e)}),n=new gs(n);return new ks(t.path,n)},Zp.prototype.isEqual=function(t){return this===t},Zp),qp=(n($p,Lp=xp),$p.prototype.u_=function(t){var e=Rp(this,t,!0),n=this.f_.map(function(t){return Ly(t,e)}),n=new Is(n);return new ks(t.path,n)},$p.prototype.isEqual=function(t){return this===t},$p),Fp=(n(Jp,Cp=xp),Jp.prototype.u_=function(t){var e=new Ns(t.serializer,zo(t.serializer,this.d_));return new ks(t.path,e)},Jp.prototype.isEqual=function(t){return this===t},Jp),Bp=(Object.defineProperty(Xp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),Xp.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},Xp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},Xp.prototype.C=function(t){return ei(this.w_,t.w_)||ei(this.E_,t.E_)},Xp),zp=(Qp.fromBase64String=function(t){try{return new Qp(Ni.fromBase64String(t))}catch(t){throw new zr(Br.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Qp.fromUint8Array=function(t){return new Qp(Ni.fromUint8Array(t))},Qp.prototype.toBase64=function(){return this.T_.toBase64()},Qp.prototype.toUint8Array=function(){return this.T_.toUint8Array()},Qp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Qp.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},Qp),Gp=new Map,Kp=(Yp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Yp),Wp=(Object.defineProperty(Hp.prototype,"app",{get:function(){if(!this.g_)throw new zr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(Hp.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Hp.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),Hp.prototype.v_=function(t){if(this.A_)throw new zr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Kp(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Gr;switch(t.type){case"gapi":var e=t.client;return jr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new zr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Hp.prototype.b_=function(){return this.m_},Hp.prototype.S_=function(){return this.A_=!0,this.m_},Hp.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},Hp.prototype.D_=function(){return t=this,(e=Gp.get(t))&&(Cr("ComponentProvider","Removing Datastore"),Gp.delete(t),e.terminate()),Promise.resolve();var t,e},Hp);function Hp(t,e){this.I_="(lite)",this.m_=new Kp({}),this.A_=!1,t instanceof Or?(this.R_=t,this.P_=new Gr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new zr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Or(t.options.projectId)}(t),this.P_=new Kr(e))}function Yp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new zr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new zr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ep("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Qp(t){this.T_=t}function Xp(t,e){if(!isFinite(t)||t<-90||90<t)throw new zr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new zr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}function Jp(t,e){var n=this;return(n=Cp.call(this,t)||this).d_=e,n}function $p(t,e){var n=this;return(n=Lp.call(this,t)||this).f_=e,n}function Zp(t,e){var n=this;return(n=Vp.call(this,t)||this).f_=e,n}function td(){return null!==Mp&&Mp.apply(this,arguments)||this}function ed(){if("undefined"==typeof Uint8Array)throw new zr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function nd(){if("undefined"==typeof atob)throw new zr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var rd,id,od,sd=(n(dd,od=ep),dd.fromBase64String=function(t){return nd(),new dd(zp.fromBase64String(t))},dd.fromUint8Array=function(t){return ed(),new dd(zp.fromUint8Array(t))},dd.prototype.toBase64=function(){return nd(),this.o_.toBase64()},dd.prototype.toUint8Array=function(){return ed(),this.o_.toUint8Array()},dd.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},dd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},dd),h=(pd.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),Eo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xo(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(ko(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Ur()}},pd.prototype.L_=function(t,n){var r=this,i={};return mo(t.fields||{},function(t,e){i[t]=r.C_(e,n)}),i},pd.prototype.M_=function(t){return new Bp(xo(t.latitude),xo(t.longitude))},pd.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},pd.prototype.x_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return bo(e)?t(e):e}(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(_o(t));default:return null}},pd.prototype.N_=function(t){t=Do(t);return new si(t.seconds,t.nanos)},pd.prototype.B_=function(t,e){var n=ai.Y(t);jr(ls(n));t=new Or(n.get(1),n.get(3)),n=new fi(n.B(5));return t.isEqual(e)||Lr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},pd),ud=(n(ld,id=h),ld.prototype.F_=function(t){return new sd(new zp(t))},ld.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return Nv.q_(t,this.firestore,null)},ld),ad=(Object.defineProperty(fd.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"ref",{get:function(){return new jd(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),fd.prototype.exists=function(){return null!==this.W_},fd.prototype.data=function(){if(this.W_){if(this.j_){var t=new cd(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},fd.prototype.get=function(t){if(this.W_){t=this.W_.data().field(yd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t)}},fd),cd=(n(hd,rd=ad),hd.prototype.data=function(){return rd.prototype.data.call(this)},hd);function hd(){return null!==rd&&rd.apply(this,arguments)||this}function fd(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}function ld(t){var e=this;return(e=id.call(this)||this).firestore=t,e}function pd(){}function dd(){return null!==od&&od.apply(this,arguments)||this}function yd(t,e){return"string"==typeof e?Fy(t,e):(e instanceof ep?e.o_:e).G_}var vd,gd=(bd.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},bd),md=(n(wd,vd=Wp),wd.prototype.D_=function(){return this.H_||bv(this),this.H_.terminate()},wd);function wd(t,e){var n=this;return(n=vd.call(this,t,e)||this).z_=new Qa,n.I_="name"in t?t.name:"[DEFAULT]",n}function bd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new zr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new hi(t)}function _d(n,r,i){var t=this,o=new pa;return n.di.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Xy(n,i)];case 1:return t.sent(),[4,Jy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Br.FAILED_PRECONDITION||t.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Id(t){if(t.y_||t.V_)throw new zr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Ed,Td,Ad=(n(xd,Td=ad),xd.prototype.exists=function(){return Td.prototype.exists.call(this)},xd.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new Nd(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},xd.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){t=this.W_.data().field(yd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t,e.serverTimestamps)}},xd),Nd=(n(Dd,Ed=Ad),Dd.prototype.data=function(t){return void 0===t&&(t={}),Ed.prototype.data.call(this,t)},Dd),Od=(Object.defineProperty(Sd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Sd.prototype.forEach=function(e,n){var r=this;this.Y_.docs.forEach(function(t){e.call(n,new Nd(r.U_,r.Q_,t.key,t,new jv(r.Y_.ee.has(t.key),r.Y_.fromCache),r.query.j_))})},Sd.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Y_.se)throw new zr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===t||(this.X_=function(i,e){if(i.Y_.te.W()){var n=0;return i.Y_.docChanges.map(function(t){var e=new Nd(i.U_,i.Q_,t.doc.key,t.doc,new jv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Y_.te;return i.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Nd(i.U_,i.Q_,t.doc.key,t.doc,new jv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ur()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Z_=t),this.X_},Sd);function Sd(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new jv(r.hasPendingWrites,r.fromCache),this.query=n}function Dd(){return null!==Ed&&Ed.apply(this,arguments)||this}function xd(t,e,n,r,i,o){var s=this;return(s=Td.call(this,t,e,n,r,o)||this).U_=t,s.J_=t,s.metadata=i,s}function kd(t,e){return t instanceof Ad&&e instanceof Ad?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Od&&e instanceof Od&&t.U_===e.U_&&wy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Pd,Rd=(n(Cd,Pd=h),Cd.prototype.F_=function(t){return new zp(t)},Cd.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new jd(this.firestore,null,t)},Cd);function Cd(t){var e=this;return(e=Pd.call(this)||this).firestore=t,e}function Ld(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Op(t.firestore,md),s=by(o);return e instanceof ep&&(e=e.o_),Md(o,("string"==typeof e||e instanceof gd?Ry(s,"updateDoc",t.K_,e,n,r):Py(s,"updateDoc",t.K_,e)).ef(t.K_,Cs.exists(!0)))}function Vd(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ba(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};ba(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof jd?(s=Op(e.firestore,md),u=wu(e.K_.path),h={next:function(t){n[o]&&n[o](Ud(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Op(e.firestore,md),u=e.tf,c=new Rd(s),h={next:function(t){n[o]&&n[o](new Od(s,c,e,t))},error:n[o+1],complete:n[o+2]},cy(e.tf));var l=wv(s),p=new tp(h),d=new Cf(u,p,f);return s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=kf,[4,iv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Pf,[4,iv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Md(t,e){return function(n,r){var t=this,i=new pa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ll,[4,rv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(wv(t),e)}function Ud(t,e,n){var r=n.docs.get(e.K_),i=new Rd(t);return new Ad(t,i,e.K_,r,new jv(n.hasPendingWrites,n.fromCache),e.j_)}var jd=(Object.defineProperty(Bd.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"parent",{get:function(){return new fy(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),Bd.prototype.withConverter=function(t){return new Bd(this.firestore,t,this.K_)},Bd),qd=(Fd.prototype.withConverter=function(t){return new Fd(this.firestore,t,this.tf)},Fd),Ie=function(){};function Fd(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}function Bd(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}function zd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].sf(t)}return t}var Gd,Kd,Wd,Hd,Yd,Qd=(n(iy,Yd=Ie),iy.prototype.sf=function(t){var e=by(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){uy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(sy(n,t,c))}h={arrayValue:{values:s}}}else h=sy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||uy(o,i),h=Cy(e,"where",o,"in"===i||"not-in"===i);var h=Cu.create(r,i,h);return function(t,e){if(e.An()){var n=Eu(t);if(null!==n&&!n.isEqual(e.field))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Iu(t);null!==n&&ay(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new zr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new zr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.tf,e,t.firestore.R_,this.rf,this.cf,this.uf);return new qd(t.firestore,t.j_,(t=t.tf,e=t.filters.concat([e]),new du(t.path,t.collectionGroup,t.Tn.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},iy),Xd=(n(ry,Hd=Ie),ry.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new aa(e,n);return e=r,null!==Iu(n=t)||null!==(t=Eu(n))&&ay(0,t,e.field),r}(t.tf,this.rf,this.af);return new qd(t.firestore,t.j_,(t=t.tf,e=t.Tn.concat([e]),new du(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},ry),Jd=(n(ny,Wd=Ie),ny.prototype.sf=function(t){return new qd(t.firestore,t.j_,Ou(t.tf,this.hf,this.lf))},ny),$d=(n(ey,Kd=Ie),ey.prototype.sf=function(t){var e=oy(t,this.type,this._f,this.ff);return new qd(t.firestore,t.j_,(t=t.tf,e=e,new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},ey),Zd=(n(ty,Gd=Ie),ty.prototype.sf=function(t){var e=oy(t,this.type,this._f,this.ff);return new qd(t.firestore,t.j_,(t=t.tf,e=e,new du(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},ty);function ty(t,e,n){var r=this;return(r=Gd.call(this)||this).type=t,r._f=e,r.ff=n,r}function ey(t,e,n){var r=this;return(r=Kd.call(this)||this).type=t,r._f=e,r.ff=n,r}function ny(t,e,n){var r=this;return(r=Wd.call(this)||this).type=t,r.hf=e,r.lf=n,r}function ry(t,e){var n=this;return(n=Hd.call(this)||this).rf=t,n.af=e,n.type="orderBy",n}function iy(t,e,n){var r=this;return(r=Yd.call(this)||this).rf=t,r.cf=e,r.uf=n,r.type="where",r}function oy(t,c,e,n){if(e[0]instanceof ep&&(e[0]=e[0].o_),e[0]instanceof ad)return function(t,e,n,r){if(!n)throw new zr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Au(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Po(e,n.key));else{var a=n.field(u.field);if(bo(a))throw new zr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.J();throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ta(i,r)}(t.tf,t.firestore.R_,e[0].W_,n);var r=by(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new zr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Tu(t)&&-1!==c.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ai.Y(c));if(!fi.ot(h))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new fi(h);u.push(Po(e,h))}else{c=Cy(n,r,c);u.push(c)}}return new ta(u,o)}(t.tf,t.firestore.R_,r,c,e,n)}function sy(t,e,n){if(n instanceof ep&&(n=n.o_),"string"==typeof n){if(""===n)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tu(e)&&-1!==n.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ai.Y(n));if(!fi.ot(e))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Po(t,new fi(e))}if(n instanceof jd)return Po(t,n.K_);throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Np(n)+".")}function uy(t,e){if(!Array.isArray(t)||0===t.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ay(t,e,n){if(!n.isEqual(e))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function cy(t){if(_u(t)&&0===t.Tn.length)throw new zr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var hy,fy=(n(ly,hy=qd),Object.defineProperty(ly.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new jd(this.firestore,null,new fi(t))},enumerable:!1,configurable:!0}),ly.prototype.withConverter=function(t){return new ly(this.firestore,t,this.nf)},ly);function ly(t,e,n){var r=this;return(r=hy.call(this,t,e,wu(n))||this).firestore=t,r.nf=n,r.type="collection",r}function py(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(_p("collection","path",e),t instanceof Wp){var i=ai.Y.apply(ai,s([e],n));return Ap(i),new fy(t,null,i)}if(!(t instanceof jd||t instanceof fy))throw new zr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ai.Y.apply(ai,s([t.path],n)).child(ai.Y(e));return Ap(e),new fy(t.firestore,null,e)}function dy(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Zr.D()),_p("doc","path",e),t instanceof Wp){var i=ai.Y.apply(ai,s([e],n));return Tp(i),new jd(t,null,new fi(i))}if(!(t instanceof jd||t instanceof fy))throw new zr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.nf.child(ai.Y.apply(ai,s([e],n)));return Tp(e),new jd(t.firestore,t instanceof fy?t.j_:null,new fi(e))}var yy,vy=(n(gy,yy=h),gy.prototype.F_=function(t){return new zp(t)},gy.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new jd(this.firestore,null,t)},gy);function gy(t){var e=this;return(e=yy.call(this)||this).firestore=t,e}function my(t,e){return(t instanceof jd||t instanceof fy)&&(e instanceof jd||e instanceof fy)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function wy(t,e){return t instanceof qd&&e instanceof qd&&t.firestore===e.firestore&&Su(t.tf,e.tf)&&t.j_===e.j_}function by(t){var e=t.S_(),n=wa(t.R_);return new Sy(t.R_,!!e.ignoreUndefinedProperties,n)}var _y=/^__.*__$/,Iy=(Ay.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new Gs(t,this.data,this.en,e)):n.push(new zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Qs(t,this.fieldTransforms)),n},Ay),Ey=(Ty.prototype.ef=function(t,e){e=[new Gs(t,this.data,this.en,e)];return 0<this.fieldTransforms.length&&e.push(new Qs(t,this.fieldTransforms)),e},Ty);function Ty(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function Ay(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function Ny(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ur()}}var Oy=(Object.defineProperty(xy.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(xy.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),xy.prototype.wf=function(t){return new xy(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},xy.prototype.Ef=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.wf({path:e,__:!1});return e.Tf(t),e},xy.prototype.If=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.wf({path:t,__:!1});return t.df(),t},xy.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},xy.prototype.h_=function(t){return By(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},xy.prototype.contains=function(e){return void 0!==this.en.find(function(t){return e.j(t)})||void 0!==this.fieldTransforms.find(function(t){return e.j(t.field)})},xy.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},xy.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Ny(this.a_)&&_y.test(t))throw this.h_('Document fields cannot begin and end with "__"')},xy),Sy=(Dy.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Oy({a_:t,methodName:e,l_:n,path:hi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Dy);function Dy(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||wa(t)}function xy(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}function ky(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Uy("Data must be an object, but it was:",s,r);var u,a,r=Vy(r,s);if(o.merge)u=new xs(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=jy(e,f[h],n);if(!s.contains(l))throw new zr(Br.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");zy(c,l)||c.push(l)}u=new xs(c),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new Iy(new nu(r),u,a)}function Py(t,r,i,e){var o=t.Rf(1,r,i);Uy("Data must be an object, but it was:",o,e);var s=[],u=new ru;mo(e,function(t,e){var n=Fy(r,t,i);e instanceof ep&&(e=e.o_);t=o.If(n);e instanceof kp?s.push(n):null!=(t=Ly(e,t))&&(s.push(n),u.set(n,t))});e=new xs(s);return new Ey(u.hn(),e,o.fieldTransforms)}function Ry(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[jy(e,r,n)],a=[i];if(o.length%2!=0)throw new zr(Br.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(jy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new ru,y=u.length-1;0<=y;--y){zy(p,u[y])||(h=u[y],(f=a[y])instanceof ep&&(f=f.o_),l=s.If(h),f instanceof kp?p.push(h):null!=(l=Ly(f,l))&&(p.push(h),d.set(h,l)))}i=new xs(p);return new Ey(d.hn(),i,s.fieldTransforms)}function Cy(t,e,n,r){return void 0===r&&(r=!1),Ly(n,t.Rf(r?4:3,e))}function Ly(s,t){if(s instanceof ep&&(s=s.o_),My(s))return Uy("Unsupported field value:",t,s),Vy(s,t);if(s instanceof xp)return function(t,e){if(!Ny(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");t=t.u_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.en.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.a_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ly(i[r],t.mf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof ep&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return zo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=si.fromDate(t);return{timestampValue:Go(e.serializer,n)}}if(t instanceof si){var r=new si(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Go(e.serializer,r)}}if(t instanceof Bp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zp)return{bytesValue:Ko(e.serializer,t.T_)};if(t instanceof jd){n=e.t,r=t.firestore.R_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ho(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Np(t))}(s,t)}function Vy(t,n){var r={};return wo(t)?n.path&&0<n.path.length&&n.en.push(n.path):mo(t,function(t,e){e=Ly(e,n.Ef(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function My(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof si||t instanceof Bp||t instanceof zp||t instanceof jd||t instanceof xp)}function Uy(t,e,n){if(!My(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Np(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function jy(t,e,n){if(e instanceof ep&&(e=e.o_),e instanceof gd)return e.G_;if("string"==typeof e)return Fy(t,e);throw By("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var qy=new RegExp("[~\\*/\\[\\]]");function Fy(e,n,r){if(0<=n.search(qy))throw By("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(gd.bind.apply(gd,s([void 0],n.split("."))))).G_}catch(t){throw By("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function By(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new zr(Br.INVALID_ARGUMENT,(e+=". ")+t+n)}function zy(t,e){return t.some(function(t){return t.isEqual(e)})}var Gy=(Qy.prototype.pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),0<this.mutations.length)throw new zr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Zo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Qo(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){jr(!!e.found),e.found.name,e.found.updateTime;var n=Xo(t,e.found.name),t=Wo(e.found.updateTime),e=new nu({mapValue:{fields:e.found.fields}});return new fu(n,t,e,{})}(e,t):"missing"in t?function(t,e){jr(!!e.missing),jr(!!e.readTime);t=Xo(t,e.missing),e=Wo(e.readTime);return new lu(t,e)}(e,t):Ur());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());jr(!!t),o.push(t)}),o)]}})})}(this.Nu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof lu||t instanceof fu?n.bf(t):Ur()}),e)]}})})},Qy.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},Qy.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},Qy.prototype.delete=function(t){this.write([new tu(t,this.rn(t))]),this.Vf.add(t.toString())},Qy.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),this.yf)throw this.yf;return e=this.Pf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=fi.st(e);n.mutations.push(new eu(e,n.rn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Zo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ns(e.serializer,t)})},[4,e.Au("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return t.sent(),this.gf=!0,[2]}})})},Qy.prototype.bf=function(t){var e;if(t instanceof fu)e=t.version;else{if(!(t instanceof lu))throw Ur();e=ui.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new zr(Br.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},Qy.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Cs.updateTime(e):Cs.on()},Qy.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(this.Vf.has(t.toString())||!e)return Cs.exists(!0);if(e.isEqual(ui.min()))throw new zr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cs.updateTime(e)},Qy.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},Qy.prototype.vf=function(){},Qy),Ky=(Yy.prototype.run=function(){this.Cf()},Yy.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Gy(this.Nu),(n=this.Nf(e))&&n.then(function(t){r.di.Ri(function(){return e.commit().then(function(){r.Ti.resolve(t)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},Yy.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!mi(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},Yy.prototype.xf=function(t){var e=this;0<this.Df&&this.Ff(t)?(--this.Df,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},Yy.prototype.Ff=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Pi(t)},Yy),Wy=(Hy.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},Hy.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},Hy.prototype.kf=function(){if(this.di.Ci)throw new zr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},Hy.prototype.terminate=function(){var t=this;this.di.Oi();var n=new pa;return this.di.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=$a(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Hy);function Hy(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Sr.UNAUTHENTICATED,this.clientId=Zr.D(),this.Of=function(){},this.g=new pa,this.credentials.A(function(t){Cr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}function Yy(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new xa(this.di,"transaction_retry")}function Qy(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}function Xy(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),Cr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Mf(function(e){return r.di.Mi(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,jh(i.Cu,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.tc(function(){return r.terminate()}),r.Lf=i,[2]}})})}function Jy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),[4,$y(r)];case 1:return e=t.sent(),Cr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Mf(function(t){return r.di.Mi(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).di.Li(),Cr("RemoteStore","RemoteStore received new credentials"),n=mf(e),e.Mu.add(3),[4,ff(e)];case 1:return t.sent(),n&&e.Bu.set("Unknown"),[4,e.xu.s_(i)];case 2:return t.sent(),e.Mu.delete(3),[4,hf(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r.$f=i,[2]}})})}function $y(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Lf?[3,2]:(Cr("FirestoreClient","Using default OfflineComponentProvider"),[4,Xy(e,new Xl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Lf]}})})}function Zy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.$f?[3,2]:(Cr("FirestoreClient","Using default OnlineComponentProvider"),[4,Jy(e,new Zl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.$f]}})})}function tv(t){return $y(t).then(function(t){return t.persistence})}function ev(t){return $y(t).then(function(t){return t.Cu})}function nv(t){return Zy(t).then(function(t){return t.Oh})}function rv(t){return Zy(t).then(function(t){return t.ga})}function iv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ju=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Dl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wa(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,zh(e.Cu,Nu(u))];case 2:return i=t.sent(),o=e.kh.Wa(i.targetId),n=i.targetId,[4,fl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&lf(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ga),n.Zu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!Su(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Ga(n.targetId),e.kh.Ba(n.targetId)?[3,2]:[4,Gh(e.Cu,n.targetId,!1).then(function(){e.kh.Ha(n.targetId),pf(e.Oh,n.targetId),wl(e,n.targetId)}).catch(Qh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return wl(e,n.targetId),[4,Gh(e.Cu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ga),n)]}})})}function ov(n,r,i,o,s){var t=new tp({next:function(t){r.Ri(function(){return Pf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new zr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new zr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Cf(wu(i.path),t,{includeMetadataChanges:!0,oa:!0});return kf(n,u)}function sv(e,n,t,r,i){var o=new tp({next:function(t){n.Ri(function(){return Pf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new zr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Cf(t,o,{includeMetadataChanges:!0,oa:!0});return kf(e,s)}var uv=(av.prototype.set=function(t,e,n){this.Kf();t=cv(t,this.U_),e=tg(t.j_,e,n),n=ky(this.Qf,"WriteBatch.set",t.K_,e,null!==t.j_,n);return this.qf=this.qf.concat(n.ef(t.K_,Cs.on())),this},av.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();t=cv(t,this.U_);return e instanceof ep&&(e=e.o_),e="string"==typeof e||e instanceof gd?Ry(this.Qf,"WriteBatch.update",t.K_,e,n,r):Py(this.Qf,"WriteBatch.update",t.K_,e),this.qf=this.qf.concat(e.ef(t.K_,Cs.exists(!0))),this},av.prototype.delete=function(t){this.Kf();t=cv(t,this.U_);return this.qf=this.qf.concat(new tu(t.K_,Cs.on())),this},av.prototype.commit=function(){return this.Kf(),this.Uf=!0,0<this.qf.length?this.Bf(this.qf):Promise.resolve()},av.prototype.Kf=function(){if(this.Uf)throw new zr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},av);function av(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=by(t)}function cv(t,e){if(t instanceof ep&&(t=t.o_),t.firestore!==e)throw new zr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var hv,fv,lv=(mv.prototype.get=function(t){var e=this,n=cv(t,this.U_),r=new vy(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Ur();t=t[0];if(t instanceof lu)return new ad(e.U_,r,n.K_,null,n.j_);if(t instanceof fu)return new ad(e.U_,r,t.key,t,n.j_);throw Ur()})},mv.prototype.set=function(t,e,n){t=cv(t,this.U_),e=tg(t.j_,e,n),n=ky(this.Qf,"Transaction.set",t.K_,e,null!==t.j_,n);return this.Wf.set(t.K_,n),this},mv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=cv(t,this.U_);return e instanceof ep&&(e=e.o_),e="string"==typeof e||e instanceof gd?Ry(this.Qf,"Transaction.update",t.K_,e,n,r):Py(this.Qf,"Transaction.update",t.K_,e),this.Wf.update(t.K_,e),this},mv.prototype.delete=function(t){t=cv(t,this.U_);return this.Wf.delete(t.K_),this},n(gv,fv=mv),gv.prototype.get=function(t){var e=this,n=cv(t,this.U_),r=new Rd(this.U_);return fv.prototype.get.call(this,t).then(function(t){return new Ad(e.U_,r,n.K_,t.W_,new jv(!1,!1),n.j_)})},gv),pv=(vv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Id(t);var n=wv(t),r=t.S_(),t=new Zl;return _d(n,t,new Jl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},vv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Id(t);var e=wv(t),n=t.S_(),t=new Zl;return _d(e,t,new $l(t,n.cacheSizeBytes))}(t.o_)},vv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.y_&&!n.V_)throw new zr(Br.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new pa;return n.z_.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ka.Gs()?(e=n+"main",[4,ka.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Lh(n.R_,n.I_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},vv),dv=(n(yv,hv=ep),Object.defineProperty(yv.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),yv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},yv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Vr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},yv.prototype.enableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return e=t.sent(),[4,nv(r)];case 2:return n=t.sent(),[2,(e.ec(!0),(t=n).Mu.delete(0),hf(t))]}})})})}(wv(this.o_))},yv.prototype.disableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return e=t.sent(),[4,nv(r)];case 2:return n=t.sent(),[2,(e.ec(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(0),[4,ff(e)];case 1:return t.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(wv(this.o_))},yv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ep("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},yv.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},yv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},yv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new pa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vl,[4,rv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(wv(this.o_))},yv.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=wv(t),e=ba(e)?e:{next:e},i=new tp(e);return t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.add(e),e.next()},[4,iv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.delete(e)},[4,iv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(yv.prototype,"app",{get:function(){if(!this.Gf)throw new zr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),yv.prototype.collection=function(t){try{return new Kv(this,py(this.o_,t))}catch(t){throw xv(t,"collection()","Firestore.collection()")}},yv.prototype.doc=function(t){try{return new Nv(this,dy(this.o_,t))}catch(t){throw xv(t,"doc()","Firestore.doc()")}},yv.prototype.collectionGroup=function(t){try{return new Bv(this,function(t,e){if(_p("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new qd(t,null,(e=e,new du(ai.X(),e)))}(this.o_,t))}catch(t){throw xv(t,"collectionGroup()","Firestore.collectionGroup()")}},yv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new pa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Zy(n).then(function(t){return t.Nu})];case 1:return e=t.sent(),new Ky(n.di,e,r,i).run(),[2]}})})}),i.promise}(wv(n=this.o_),function(t){return t=new lv(n,t),e(new Tv(r,t))})},yv.prototype.batch=function(){var e=this;return wv(this.o_),new Av(new uv(this.o_,function(t){return Md(e.o_,t)}))},yv);function yv(t,e,n){var r=this;return(r=hv.call(this,e)||this).jf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Or||(r.Gf=t),r}function vv(){}function gv(t,e){var n=this;return(n=fv.call(this,t,e)||this).U_=t,n}function mv(t,e){this.U_=t,this.Wf=e,this.Qf=by(t)}function wv(t){return t.H_||bv(t),t.H_.kf(),t.H_}function bv(t){var e,n,r=t.S_(),r=(e=t.R_,n=t.I_,new Nr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.H_=new Wy(t.P_,t.z_,r)}var _v,Iv,Ev,Tv=(n(Dv,Ev=ep),Dv.prototype.get=function(t){var e=this,t=Zv(t);return this.o_.get(t).then(function(t){return new qv(e.U_,t)})},Dv.prototype.set=function(t,e,n){t=Zv(t);return n?(Ip("Transaction.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Dv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Zv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Dv.prototype.delete=function(t){t=Zv(t);return this.o_.delete(t),this},Dv),Av=(n(Sv,Iv=ep),Sv.prototype.set=function(t,e,n){t=Zv(t);return n?(Ip("WriteBatch.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Zv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Sv.prototype.delete=function(t){t=Zv(t);return this.o_.delete(t),this},Sv.prototype.commit=function(){return this.o_.commit()},Sv),Nv=(n(Ov,_v=ep),Ov.zf=function(t,e,n){if(t.length%2!=0)throw new zr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new Ov(e,new jd(e.o_,n,new fi(t)))},Ov.q_=function(t,e,n){return new Ov(e,new jd(e.o_,n,t))},Object.defineProperty(Ov.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Ov.prototype,"parent",{get:function(){return new Kv(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Ov.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Ov.prototype.collection=function(t){try{return new Kv(this.firestore,py(this.o_,t))}catch(t){throw xv(t,"collection()","DocumentReference.collection()")}},Ov.prototype.isEqual=function(t){return t instanceof ep&&(t=t.o_),t instanceof jd&&my(this.o_,t)},Ov.prototype.set=function(t,e){e=Ip("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Op(n.firestore,md),r=tg(n.j_,r,i),Md(o,ky(by(o),"setDoc",n.K_,r,null!==n.j_,i).ef(n.K_,Cs.on()))}catch(t){throw xv(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Ov.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ld(this.o_,t):Ld.apply(void 0,s([this.o_,t,e],n))}catch(t){throw xv(t,"updateDoc()","DocumentReference.update()")}},Ov.prototype.delete=function(){return Md(Op((t=this.o_).firestore,md),[new tu(t.K_,Cs.on())]);var t},Ov.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=kv(t),i=Pv(t,function(t){return new qv(e.firestore,new Ad(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))});return Vd(this.o_,r,i)},Ov.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new Rd(n),o=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ev(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)}))];case 1:return(r=t.sent())instanceof fu?s.resolve(r):r instanceof lu?s.resolve(null):s.reject(new zr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=$a(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.K_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Ad(n,i,e.K_,t,new jv(t instanceof fu&&t.an,!0),e.j_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,iv(r)];case 1:return[4,ov(t.sent(),n.z_,e.K_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Ud(n,e,t)})}:function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,iv(r)];case 1:return[4,ov(t.sent(),n.z_,e.K_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Ud(n,e,t)})})(this.o_).then(function(t){return new qv(e.firestore,new Ad(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},Ov.prototype.withConverter=function(t){return new Ov(this.firestore,this.o_.withConverter(t))},Ov);function Ov(t,e){var n=this;return(n=_v.call(this,e)||this).firestore=t,n.Q_=new ud(t),n}function Sv(){return null!==Iv&&Iv.apply(this,arguments)||this}function Dv(t,e){var n=this;return(n=Ev.call(this,e)||this).U_=t,n}function xv(t,e,n){return t.message=t.message.replace(e,n),t}function kv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ba(r))return r}return{}}function Pv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ba(t[0])?t[0]:ba(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Rv,Cv,Lv,Vv,Mv,Uv,jv=($v.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},$v),qv=(n(Jv,Uv=ep),Object.defineProperty(Jv.prototype,"ref",{get:function(){return new Nv(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Jv.prototype.data=function(t){return this.o_.data(t)},Jv.prototype.get=function(t,e){return this.o_.get(t,e)},Jv.prototype.isEqual=function(t){return kd(this.o_,t.o_)},Jv),Fv=(n(Xv,Mv=qv),Xv.prototype.data=function(t){return this.o_.data(t)},Xv),Bv=(n(Qv,Vv=ep),Qv.prototype.where=function(t,e,n){try{return new Qv(this.firestore,zd(this.o_,(r=n,i=e,o=yd("where",t),new Qd(o,i,r))))}catch(t){throw xv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Qv.prototype.orderBy=function(n,t){try{return new Qv(this.firestore,zd(this.o_,function(t){void 0===t&&(t="asc");var e=t,t=yd("orderBy",n);return new Xd(t,e)}(t)))}catch(n){throw xv(n,/(orderBy|where)\(\)/,"Query.$1()")}},Qv.prototype.limit=function(t){try{return new Qv(this.firestore,zd(this.o_,(Sp("limit",e=t),new Jd("limit",e,"F"))))}catch(t){throw xv(t,"limit()","Query.limit()")}var e},Qv.prototype.limitToLast=function(t){try{return new Qv(this.firestore,zd(this.o_,(Sp("limitToLast",e=t),new Jd("limitToLast",e,"L"))))}catch(t){throw xv(t,"limitToLast()","Query.limitToLast()")}var e},Qv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Qv(this.firestore,zd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $d("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw xv(t,"startAt()","Query.startAt()")}},Qv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Qv(this.firestore,zd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $d("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw xv(t,"startAfter()","Query.startAfter()")}},Qv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Qv(this.firestore,zd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw xv(t,"endBefore()","Query.endBefore()")}},Qv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Qv(this.firestore,zd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw xv(t,"endAt()","Query.endAt()")}},Qv.prototype.isEqual=function(t){return wy(this.o_,t.o_)},Qv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new Rd(n),o=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ev(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Kh(r,i,!0)];case 1:return n=t.sent(),e=new $f(i,n.Bc),n=e.gh(n.documents),n=e.Zn(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=$a(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.tf,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Od(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new Rd(n),o=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,iv(r)];case 1:return[4,sv(t.sent(),n.z_,e.tf,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Od(n,i,e,t)})}:function(e){var t=this,n=Op(e.firestore,md),r=wv(n),i=new Rd(n);cy(e.tf);var o=new pa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,iv(r)];case 1:return[4,sv(t.sent(),n.z_,e.tf,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Od(n,i,e,t)})})(this.o_).then(function(t){return new Gv(e.firestore,t)})},Qv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=kv(t),i=Pv(t,function(t){return new Gv(e.firestore,t)});return Vd(this.o_,r,i)},Qv.prototype.withConverter=function(t){return new Qv(this.firestore,this.o_.withConverter(t))},Qv),zv=(n(Yv,Lv=ep),Object.defineProperty(Yv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"doc",{get:function(){return new Fv(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),Yv),Gv=(n(Hv,Cv=ep),Object.defineProperty(Hv.prototype,"query",{get:function(){return new Bv(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Fv(e.U_,t)})},enumerable:!1,configurable:!0}),Hv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new zv(e.U_,t)})},Hv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Fv(r.U_,t))})},Hv.prototype.isEqual=function(t){return kd(this.o_,t.o_)},Hv),Kv=(n(Wv,Rv=Bv),Object.defineProperty(Wv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Nv(this.firestore,t):null},enumerable:!1,configurable:!0}),Wv.prototype.doc=function(t){try{return new Nv(this.firestore,void 0===t?dy(this.o_):dy(this.o_,t))}catch(t){throw xv(t,"doc()","CollectionReference.doc()")}},Wv.prototype.add=function(t){var e,n,r,i=this;return e=this.o_,n=t,t=Op(e.firestore,md),r=dy(e),n=tg(e.j_,n),Md(t,ky(by(e.firestore),"addDoc",r.K_,n,null!==e.j_,{}).ef(r.K_,Cs.exists(!1))).then(function(){return r}).then(function(t){return new Nv(i.firestore,t)})},Wv.prototype.isEqual=function(t){return my(this.o_,t.o_)},Wv.prototype.withConverter=function(t){return new Wv(this.firestore,this.o_.withConverter(t))},Wv);function Wv(t,e){var n=this;return(n=Rv.call(this,t,e)||this).firestore=t,n.o_=e,n}function Hv(t,e){var n=this;return(n=Cv.call(this,e)||this).U_=t,n}function Yv(t,e){var n=this;return(n=Lv.call(this,e)||this).U_=t,n}function Qv(t,e){var n=this;return(n=Vv.call(this,e)||this).firestore=t,n}function Xv(){return null!==Mv&&Mv.apply(this,arguments)||this}function Jv(t,e){var n=this;return(n=Uv.call(this,e)||this).U_=t,n}function $v(t,e){this.hasPendingWrites=t,this.fromCache=e}function Zv(t){return t instanceof ep&&(t=t.o_),Op(t,jd)}function tg(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var eg,ng,rg,Ie=(n(sg,ng=ep),sg.documentId=function(){return new sg(hi.et().J())},sg.prototype.isEqual=function(t){return t instanceof ep&&(t=t.o_),t instanceof gd&&this.o_.G_.isEqual(t.G_)},sg),h=(n(og,eg=ep),og.serverTimestamp=function(){var t=new Up("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new og(t)},og.delete=function(){var t=new kp("deleteField");return t.c_="FieldValue.delete",new og(t)},og.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jp("arrayUnion",t)}.apply(void 0,t);return n.c_="FieldValue.arrayUnion",new og(n)},og.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qp("arrayRemove",t)}.apply(void 0,t);return n.c_="FieldValue.arrayRemove",new og(n)},og.increment=function(t){t=new Fp("increment",t);return t.c_="FieldValue.increment",new og(t)},og.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},og),ig={Firestore:dv,GeoPoint:Bp,Timestamp:si,Blob:sd,Transaction:Tv,WriteBatch:Av,DocumentReference:Nv,DocumentSnapshot:qv,Query:Bv,QueryDocumentSnapshot:Fv,QuerySnapshot:Gv,CollectionReference:Kv,FieldPath:Ie,FieldValue:h,setLogLevel:function(t){Pr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function og(){return null!==eg&&eg.apply(this,arguments)||this}function sg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ng.call(this,new(gd.bind.apply(gd,s([void 0],t))))||this}(rg=e.default).INTERNAL.registerComponent(new Tr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new dv(e,new md(e,t),new pv);var e},"PUBLIC").setServiceProps(Object.assign({},ig))),rg.registerVersion("@firebase/firestore","2.0.4-2020102005919")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
