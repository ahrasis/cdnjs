!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(cd){"use strict";try{(function(){var u,t,e=(t=cd)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function R(){}function k(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var S="closure_uid_"+(1e9*Math.random()>>>0),P=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:L).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function x(){this.j=this.j,this.i=this.i}x.prototype.j=!1,x.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,S)&&this[S]||(this[S]=++P))},x.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var M=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function H(t,e){return t<e?-1:e<t?1:0}var X=O.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function K(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(X=X&&X.userAgent)?X:"";var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function J(t){return J[" "](t),t}J[" "]=R;var Z,tt=z(ut,"Opera"),et=z(ut,"Trident")||z(ut,"MSIE"),nt=z(ut,"Edge"),rt=nt||et,it=z(ut,"Gecko")&&!(z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge"))&&!(z(ut,"Trident")||z(ut,"MSIE"))&&!z(ut,"Edge"),ot=z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge");function st(){var t=O.document;return t?t.documentMode:void 0}var X="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(X=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(X)?String(ut):X;var at={};function ht(u){return t=u,e=function(){for(var t=0,e=W(String(Z)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=H(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||H(0==o[2].length,0==s[2].length)||H(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ct=O.document&&et&&(st()||parseInt(Z,10))||void 0,lt=!et||9<=Number(ct),ft=et&&!ht("9"),pt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",R,e),O.removeEventListener("test",R,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{J(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},j(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ft)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=M(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function It(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=It(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),Nt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Vt(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Vt(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!lt)return null;var u,a,h=_t(t);if(h||(t[At]=h=new Et(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=lt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_t(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):bt(t)))}function Dt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function St(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(lt)return St(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return St(t,e=new yt(e,this))}function _t(t){return(t=t[At])instanceof Et?t:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vt(e){return"function"==typeof e?e:(e[Lt]||(e[Lt]=function(t){return e.handleEvent(t)}),e[Lt])}function Ct(){x.call(this),this.c=new Et(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,Q(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=jt(o,r,!0,e)&&s;if(s=jt(o=e.a=t,r,!0,e)&&s,s=jt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=jt(o=e.a=n[i],r,!1,e)&&s}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Ct,x),Ct.prototype[gt]=!0,(ut=Ct.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Vt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=It(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&_t(e))&&(n=e.a[n.toString()],e=-1,n&&(e=It(n,r,i,o)),(r=-1<e?n[e]:null)&&kt(r))}(this,t,e,n,r)},ut.G=function(){if(Ct.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=O.JSON.stringify;function Mt(){this.b=this.a=null}var qt,Ft=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new Bt},function(t){t.reset()}));function Gt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Bt(){this.next=this.b=this.a=null}function Wt(t,e){var n;qt||(n=O.Promise.resolve(void 0),qt=function(){n.then(Xt)}),zt||(qt(),zt=!0),Ht.add(t,e)}Mt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Bt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var zt=!(Bt.prototype.reset=function(){this.next=this.b=this.a=null}),Ht=new Mt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Ht).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}zt=!1}function Yt(t,e){Ct.call(this),this.b=t||1,this.a=e||O,this.f=V(this.Za,this),this.g=U()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j(Yt,Ct),(ut=Yt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Kt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},ut.G=function(){Yt.X.G.call(this),Kt(this),delete this.a};var Qt,Jt,Zt=(I(Jt=ee,X=Qt=x),Jt.prototype=null===X?Object.create(X):(te.prototype=X.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Qt.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=Jt}function ee(t,e){var n=Qt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){x.call(this),this.b=t,this.a={}}j(ne,x);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return xt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},he=null;function ce(){return he=he||new Ct}function le(t){dt.call(this,ae.Fa,t)}function fe(){var t=ce();Ut(t,new le(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=ce();Ut(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}ae.Fa="serverreachability",j(le,dt),ae.STAT_EVENT="statevent",j(pe,dt),ae.Ga="timingevent",j(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ie(){dt.call(this,"d")}function Ae(){dt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Re,t=rt?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Ie,dt),j(Ae,dt),j(Ne,we),Te=new Ne;var Re=45e3,ke={},De={};function Se(t,e,n){t.H=1,t.i=Qe(ze(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=U(),Le(t),t.l=ze(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(V(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?K(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function _e(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),xe(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Ue(t))}function Le(t){t.T=U()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(V(t.Va,t),e)}function Ce(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function je(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function xe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Jn(u),Fn(u)}Kn(u),de(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(V(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Jn(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(z(r,"spdy")||z(r,"quic")||z(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,$e(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Le(o)),n.a=i):Yn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Oe.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),je(this),Ue(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,xe(this,s)}this.I?(_e(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),xe(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),je(this),Ue(this)}}}catch(t){}var u,a,h,c,l,f},ut.Wa=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),_e(this,t,e),this.b&&4!=t&&Le(this)))},ut.cancel=function(){this.A=!0,je(this)},ut.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de(17)),je(this),this.h=2,Ue(this)):Ve(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},ut.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,He(this,n[1]||"",!0),this.j=Je(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=Je(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=Je(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new We(t)}function He(t,e,n){t.f=n?Je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?Je(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function Qe(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function Je(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=F(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){Ct.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}j(On,Ct);var Rn="",kn=/^https?$/i,Dn=["POST","PUT"];function Sn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,_n(t),Vn(t)}function _n(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function Ln(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))$t(t.za,0,t);else if(Ut(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",_n(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=xn("baseRetryDelayMs",5e3,t),this.Ra=xn("retryDelaySeedMs",1e4,t),this.Ma=xn("forwardChannelMaxRetries",2,t),this.ma=xn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,$e(n=ze(t.B),"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),Hn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Qe(ze(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),Le(e)),nr(t)}function Fn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function Gn(t){Fn(t),t.j&&(O.clearTimeout(t.j),t.j=null),Jn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Wn(t)}function Wn(t){vn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),Hn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Se(n,r,e)}function Hn(t,n){t.f&&Me({},function(t,e){$e(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Me(t,function(t,e){var n=t;D(t)&&(n=xt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(V(t.Aa,t),tr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),Hn(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(ze(e)),n.j=null,n.I=!0,Pe(n,t)}function Jn(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){Jn(t),$n(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=ce(),new ye(s)),Wn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(V(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Kn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||He(r,"https"),Qe(r)),n=r.toString(),r=o,o=new se,O.Image?((i=new Image).onload=C(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(An,o,i,"TestLoadImage: error",!1,r),i.onabort=C(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?ze(s):new We(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),Ye(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&He(u,r),i&&Xe(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){$e(a,e,t)}),e=t.A,n=t.na,e&&n&&$e(a,e,n),$e(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ct)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ct.call(this),this.a=new Mn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(ut=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&Me(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Sn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=M(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,et&&ht(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Vn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Ua())},ut.Ua=function(){Ln(this)},ut.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=Mn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Q(r=K(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),$e(i=ze(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&jn(i,this.i,r),wn(this.b,n),this.Ia&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.U=!0,Se(n,i,null)):Se(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},ut.Aa=function(){var t;this.j=null,Qn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(V(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Qn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Kn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},j(ur,Ct),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Wn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=xt(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},j(ar,Ie),j(hr,Ae),j(cr,or),cr.prototype.ta=function(){Ut(this.a,"a")},cr.prototype.sa=function(t){Ut(this.a,new ar(t))},cr.prototype.ra=function(t){Ut(this.a,new hr)},cr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ct.prototype.listen=Ct.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Pa,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ce,fr=ge,pr=me,dr=ae,yr=Ee,vr=On,ge=(gr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gr);function gr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},wr=(Object.defineProperty(Tr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Tr.prototype.isEqual=function(t){return t instanceof Tr&&t.projectId===this.projectId&&t.database===this.database},Tr),br=(Er.prototype.u=function(){return null!=this.uid},Er.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Er.prototype.isEqual=function(t){return t.uid===this.uid},Er);function Er(t){this.uid=t}function Tr(t,e){this.projectId=t,this.database=e||"(default)"}br.UNAUTHENTICATED=new br(null),br.l=new br("google-credentials-uid"),br._=new br("first-party-uid");var Ir="8.1.1-2020102005919",Ar=new l("@firebase/firestore");function Nr(){return Ar.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Dr),Ar.debug.apply(Ar,s(["Firestore ("+Ir+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Dr),Ar.error.apply(Ar,s(["Firestore ("+Ir+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Dr),Ar.warn.apply(Ar,s(["Firestore ("+Ir+"): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Sr(t){throw void 0===t&&(t="Unexpected state"),Rr(t="FIRESTORE ("+Ir+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Pr(t){t||Sr()}function _r(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Lr,Vr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Cr=(n(Wr,Lr=Error),Wr),Ur=(Br.prototype.getToken=function(){return Promise.resolve(null)},Br.prototype.A=function(){},Br.prototype.I=function(t){(this.T=t)(br.UNAUTHENTICATED)},Br.prototype.R=function(){this.T=null},Br),jr=(Gr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new _r(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Gr.prototype.A=function(){this.forceRefresh=!0},Gr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Gr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Gr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new br(t)},Gr),xr=(Object.defineProperty(Fr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Fr),Mr=(qr.prototype.getToken=function(){return Promise.resolve(new xr(this.v,this.C))},qr.prototype.I=function(t){t(br._)},qr.prototype.R=function(){},qr.prototype.A=function(){},qr);function qr(t,e){this.v=t,this.C=e}function Fr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=br._}function Gr(t){var e=this;this.P=null,this.currentUser=br.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Br(){this.T=null}function Wr(t,e){var n=this;return(n=Lr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var zr=(Hr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Hr);function Hr(){}function Xr(t,e){return t<e?-1:e<t?1:0}function Yr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Kr,$r,Qr=(ai.now=function(){return ai.fromMillis(Date.now())},ai.fromDate=function(t){return ai.fromMillis(t.getTime())},ai.fromMillis=function(t){var e=Math.floor(t/1e3);return new ai(e,1e6*(t-1e3*e))},ai.prototype.toDate=function(){return new Date(this.toMillis())},ai.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ai.prototype.D=function(t){return this.seconds===t.seconds?Xr(this.nanoseconds,t.nanoseconds):Xr(this.seconds,t.seconds)},ai.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ai.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ai.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ai.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ai),Jr=(ui.N=function(t){return new ui(t)},ui.min=function(){return new ui(new Qr(0,0))},ui.prototype.F=function(t){return this.timestamp.D(t.timestamp)},ui.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ui.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ui.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ui.prototype.$=function(){return this.timestamp},ui),me=(Object.defineProperty(si.prototype,"length",{get:function(){return this.L},enumerable:!1,configurable:!0}),si.prototype.isEqual=function(t){return 0===si.k(this,t)},si.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof si?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},si.prototype.limit=function(){return this.offset+this.length},si.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},si.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},si.prototype.B=function(){return this.segments[this.offset]},si.prototype.j=function(){return this.get(this.length-1)},si.prototype.get=function(t){return this.segments[this.offset+t]},si.prototype.W=function(){return 0===this.length},si.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},si.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},si.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},si.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},si.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},si),Zr=(n(oi,$r=me),oi.prototype.M=function(t,e,n){return new oi(t,e,n)},oi.prototype.Y=function(){return this.H().join("/")},oi.prototype.toString=function(){return this.Y()},oi.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new oi(n)},oi.X=function(){return new oi([])},oi),ti=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ei=(n(ii,Kr=me),ii.prototype.M=function(t,e,n){return new ii(t,e,n)},ii.Z=function(t){return ti.test(t)},ii.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ii.Z(t)||(t="`"+t+"`"),t}).join(".")},ii.prototype.toString=function(){return this.Y()},ii.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ii.nt=function(){return new ii(["__name__"])},ii.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Cr(Vr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Cr(Vr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Cr(Vr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ii(e)},ii.X=function(){return new ii([])},ii),ni=(ri.st=function(t){return new ri(Zr.J(t))},ri.it=function(t){return new ri(Zr.J(t).U(5))},ri.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ri.prototype.isEqual=function(t){return null!==t&&0===Zr.k(this.path,t.path)},ri.prototype.toString=function(){return this.path.toString()},ri.k=function(t,e){return Zr.k(t.path,e.path)},ri.ot=function(t){return t.length%2==0},ri.ut=function(t){return new ri(new Zr(t.slice()))},ri);function ri(t){this.path=t}function ii(){return null!==Kr&&Kr.apply(this,arguments)||this}function oi(){return null!==$r&&$r.apply(this,arguments)||this}function si(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.L=n}function ui(t){this.timestamp=t}function ai(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Cr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Cr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Cr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Cr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hi(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}var li=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new li(t,e,n,r,i,o,s)}function pi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Y()+t.op.toString()+mo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Y()+t.dir}).join(","),hi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Gu(e.startAt)),e.endAt&&(t+="|ub:",t+=Gu(e.endAt)),e.ct=t),e.ct}function di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Wu(t.startAt,e.startAt)&&Wu(t.endAt,e.endAt)}function yi(t){return ni.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},gi.prototype.ht=function(){return 2*this.at.length},gi.prototype.F=function(t){return Xr(this.at,t.at)},gi.prototype.isEqual=function(t){return this.at===t.at},gi);function gi(t){this.at=t}function mi(t){this.count=t}vi.lt=new vi("");var wi,bi=(Ei.prototype.dt=function(t){return new Ei(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ei.prototype.wt=function(t,e){return new Ei(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ei.prototype.Et=function(t){return new Ei(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Ei);function Ei(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=vi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ti(t){switch(t){case Vr.OK:return Sr(),0;case Vr.CANCELLED:case Vr.UNKNOWN:case Vr.DEADLINE_EXCEEDED:case Vr.RESOURCE_EXHAUSTED:case Vr.INTERNAL:case Vr.UNAVAILABLE:case Vr.UNAUTHENTICATED:return;case Vr.INVALID_ARGUMENT:case Vr.NOT_FOUND:case Vr.ALREADY_EXISTS:case Vr.PERMISSION_DENIED:case Vr.FAILED_PRECONDITION:case Vr.ABORTED:case Vr.OUT_OF_RANGE:case Vr.UNIMPLEMENTED:case Vr.DATA_LOSS:return 1;default:return Sr(),0}}function Ii(t){if(void 0===t)return Rr("GRPC error has no .code"),Vr.UNKNOWN;switch(t){case wi.OK:return Vr.OK;case wi.CANCELLED:return Vr.CANCELLED;case wi.UNKNOWN:return Vr.UNKNOWN;case wi.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case wi.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case wi.INTERNAL:return Vr.INTERNAL;case wi.UNAVAILABLE:return Vr.UNAVAILABLE;case wi.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case wi.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case wi.NOT_FOUND:return Vr.NOT_FOUND;case wi.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case wi.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case wi.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case wi.ABORTED:return Vr.ABORTED;case wi.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case wi.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case wi.DATA_LOSS:return Vr.DATA_LOSS;default:return Sr()}}(l=wi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ai=(Di.prototype.Tt=function(t,e){return new Di(this.k,this.root.Tt(t,e,this.k).copy(null,null,Oi.At,null,null))},Di.prototype.remove=function(t){return new Di(this.k,this.root.remove(t,this.k).copy(null,null,Oi.At,null,null))},Di.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Di.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Di.prototype.W=function(){return this.root.W()},Object.defineProperty(Di.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Di.prototype.It=function(){return this.root.It()},Di.prototype.Rt=function(){return this.root.Rt()},Di.prototype.Pt=function(t){return this.root.Pt(t)},Di.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Di.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Di.prototype.yt=function(t){return this.root.yt(t)},Di.prototype.Vt=function(){return new Ni(this.root,null,this.k,!1)},Di.prototype.gt=function(t){return new Ni(this.root,t,this.k,!1)},Di.prototype.vt=function(){return new Ni(this.root,null,this.k,!0)},Di.prototype.bt=function(t){return new Ni(this.root,t,this.k,!0)},Di),Ni=(ki.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},ki.prototype.Nt=function(){return 0<this.St.length},ki.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},ki),Oi=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype.W=function(){return!1},Ri.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Ri.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Ri.prototype.min=function(){return this.left.W()?this:this.left.min()},Ri.prototype.It=function(){return this.min().key},Ri.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Ri.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Ri.prototype.Ot=function(){if(this.left.W())return Ri.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.kt()),r.right.W()||r.right.$t()||r.right.left.$t()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Ri.prototype.$t=function(){return this.color},Ri.prototype.Ft=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.kt()),t.left.$t()&&t.right.$t()&&(t=t.qt()),t},Ri.prototype.Lt=function(){var t=this.qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Ri.prototype.Mt=function(){var t=this.qt();return t.left.left.$t()&&(t=(t=t.kt()).qt()),t},Ri.prototype.Ut=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.kt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Ri.prototype.Qt=function(){if(this.$t()&&this.left.$t())throw Sr();if(this.right.$t())throw Sr();var t=this.left.Qt();if(t!==this.right.Qt())throw Sr();return t+(this.$t()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function ki(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Di(t,e){this.k=t,this.root=e||Oi.EMPTY}function Si(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.At=!1,Oi.EMPTY=(Object.defineProperty(Si.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Si.prototype.copy=function(t,e,n,r,i){return this},Si.prototype.Tt=function(t,e,n){return new Oi(t,e)},Si.prototype.remove=function(t,e){return this},Si.prototype.W=function(){return!0},Si.prototype.Pt=function(t){return!1},Si.prototype.yt=function(t){return!1},Si.prototype.It=function(){return null},Si.prototype.Rt=function(){return null},Si.prototype.$t=function(){return!1},Si.prototype.Bt=function(){return!0},Si.prototype.Qt=function(){return 0},new Si);var Pi=(Ci.prototype.has=function(t){return null!==this.data.get(t)},Ci.prototype.first=function(){return this.data.It()},Ci.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Ci.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ci.prototype.indexOf=function(t){return this.data.indexOf(t)},Ci.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Ci.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Ci.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Ci.prototype.Gt=function(t){return(t=this.data.gt(t)).Nt()?t.Dt().key:null},Ci.prototype.Vt=function(){return new _i(this.data.Vt())},Ci.prototype.gt=function(t){return new _i(this.data.gt(t))},Ci.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Ci.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ci.prototype.W=function(){return this.data.W()},Ci.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ci.prototype.isEqual=function(t){if(!(t instanceof Ci))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Ci.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ci.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ci.prototype.copy=function(t){var e=new Ci(this.k);return e.data=t,e},Ci),_i=(Vi.prototype.Dt=function(){return this.zt.Dt().key},Vi.prototype.Nt=function(){return this.zt.Nt()},Vi),Li=new Ai(ni.k);function Vi(t){this.zt=t}function Ci(t){this.k=t,this.data=new Ai(this.k)}var Ui=new Ai(ni.k),ji=new Ai(ni.k),xi=new Pi(ni.k);function Mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=xi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var qi=new Pi(Xr),Fi=(ro.Jt=function(t){return new ro(t.k)},ro.prototype.has=function(t){return null!=this.Ht.get(t)},ro.prototype.get=function(t){return this.Ht.get(t)},ro.prototype.first=function(){return this.Yt.It()},ro.prototype.last=function(){return this.Yt.Rt()},ro.prototype.W=function(){return this.Yt.W()},ro.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Yt.indexOf(t):-1},Object.defineProperty(ro.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),ro.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},ro.prototype.isEqual=function(t){if(!(t instanceof ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ro.prototype.copy=function(t,e){var n=new ro;return n.k=this.k,n.Ht=t,n.Yt=e,n},ro),Gi=(no.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Sr()},no.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},no),Bi=(eo.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new eo(t,e,Fi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(eo.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),eo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&lu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},eo),Wi=(to.hn=function(t,e){var n=new Map;return n.set(t,zi.ln(t,e)),new to(Jr.min(),n,qi,Li,Mi())},to),zi=(Zi.ln=function(t,e){return new Zi(vi.lt,e,Mi(),Mi(),Mi())},Zi),Hi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Xi=function(t,e){this.targetId=t,this.Tn=e},Yi=function(t,e,n,r){void 0===n&&(n=vi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ki=(Object.defineProperty(Ji.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),Ji.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},Ji.prototype.vn=function(){var n=Mi(),r=Mi(),i=Mi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Sr()}}),new zi(this.Rn,this.Pn,n,r,i)},Ji.prototype.bn=function(){this.yn=!1,this.In=oo()},Ji.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},Ji.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},Ji.prototype.Dn=function(){this.An+=1},Ji.prototype.Nn=function(){--this.An},Ji.prototype.xn=function(){this.yn=!0,this.Pn=!0},Ji),$i=(Qi.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof Ks?this.Un(r,t.mn):t.mn instanceof $s&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},Qi.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:Sr()}})},Qi.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},Qi.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.zn(e))&&(yi(t=t.target)?0===n?(t=new ni(t.path),this.qn(e,t,new $s(t,Jr.min()))):Pr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},Qi.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&yi(n.target)&&(n=new ni(n.target.path),null!==i.$n.get(n)||i.Jn(e,n)||i.qn(e,n,new $s(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Mi();this.Ln.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.zn(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Wi(r,o,this.kn,this.$n,s);return this.$n=Li,this.Ln=io(),this.kn=new Pi(Xr),t},Qi.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.$n=this.$n.Tt(e.key,e),this.Ln=this.Ln.Tt(e.key,this.Xn(e.key).add(t)))},Qi.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.Ln=this.Ln.Tt(e,this.Xn(e).delete(t)),n&&(this.$n=this.$n.Tt(e,n)))},Qi.prototype.removeTarget=function(t){this.On.delete(t)},Qi.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},Qi.prototype.Dn=function(t){this.jn(t).Dn()},Qi.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Ki,this.On.set(t,e)),e},Qi.prototype.Xn=function(t){var e=this.Ln.get(t);return e||(e=new Pi(Xr),this.Ln=this.Ln.Tt(t,e)),e},Qi.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},Qi.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},Qi.prototype.Gn=function(e){var n=this;this.On.set(e,new Ki),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},Qi.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},Qi);function Qi(t){this.Fn=t,this.On=new Map,this.$n=Li,this.Ln=io(),this.kn=new Pi(Xr)}function Ji(){this.An=0,this.In=oo(),this.Rn=vi.lt,this.Pn=!1,this.yn=!0}function Zi(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function to(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function eo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function no(){this.Xt=new Ai(ni.k)}function ro(n){this.k=n?function(t,e){return n(t,e)||ni.k(t.key,e.key)}:function(t,e){return ni.k(t.key,e.key)},this.Ht=Ui,this.Yt=new Ai(this.k)}function io(){return new Ai(ni.k)}function oo(){return new Ai(ni.k)}function so(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function uo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ao(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ho(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function co(t){return t=wo(t.mapValue.fields.__local_write_time__.timestampValue),new Qr(t.seconds,t.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Sr()}function po(r,i){var t,e=fo(r);if(e!==fo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return co(r).isEqual(co(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=wo(r.timestampValue),t=wo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Eo(r.bytesValue).isEqual(Eo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,bo((t=r).geoPointValue.latitude)===bo(e.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?bo(e.integerValue)===bo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=bo(e.doubleValue))===(t=bo(t.doubleValue))?ci(e)===ci(t):isNaN(e)&&isNaN(t));case 9:return Yr(r.arrayValue.values||[],i.arrayValue.values||[],po);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(so(e)!==so(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!po(e[t],n[t])))return!1;return!0}();default:return Sr()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,r,i,o=fo(t),s=fo(e);if(o!==s)return Xr(o,s);switch(o){case 0:return 0;case 1:return Xr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=bo(t.integerValue||t.doubleValue))<(n=bo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return Xr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Eo(i),s=Eo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Xr(n[i],r[i]);if(0!==o)return o}return Xr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Xr(bo(o.latitude),bo(r.latitude)))?n:Xr(bo(o.longitude),bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vo(n[i],r[i]);if(o)return o}return Xr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Xr(r[s],o[s]);if(0!==u)return u;if(0!==(u=vo(n[r[s]],i[o[s]])))return u}return Xr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Xr(t,e);var n=wo(t),t=wo(e);return 0!==(e=Xr(n.seconds,t.seconds))?e:Xr(n.nanos,t.nanos)}function mo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=wo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Eo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ni.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Sr();var t,e}(t)}function wo(t){if(Pr(!!t),"string"!=typeof t)return{seconds:bo(t.seconds),nanos:bo(t.nanos)};var e=0,n=lo.exec(t);return Pr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Io(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function Oo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var ko={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},So=function(t,e){this.t=t,this.ne=e};function Po(t){return{integerValue:""+t}}function _o(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function Lo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Po(e):_o(t,e);var n}function Vo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Co(t,e){return t.ne?e.toBase64():e.toUint8Array()}function Uo(t){return Pr(!!t),Jr.N((t=wo(t),new Qr(t.seconds,t.nanos)))}function jo(t,e){return new Zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function xo(t){return Pr(Qo(t=Zr.J(t))),t}function Mo(t,e){return jo(t.t,e.path)}function qo(t,e){if((e=xo(e)).get(1)!==t.t.projectId)throw new Cr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Cr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ni(Bo(e))}function Fo(t,e){return jo(t.t,e)}function Go(t){return new Zr(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Bo(t){return Pr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Wo(t,e,n){return{name:Mo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,r,i;if(e instanceof Rs)n={update:Wo(t,e.key,e.value)};else if(e instanceof xs)n={delete:Mo(t,e.key)};else if(e instanceof ks)n={update:Wo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Ls)n={transform:{document:Mo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof es)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof ns)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof ls)return{fieldPath:t.field.Y(),increment:e.se};throw Sr()})}};else{if(!(e instanceof Ms))return Sr();n={verify:Mo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:Vo(e=t,(t=i.updateTime).$())}:void 0!==i.exists?{exists:i.exists}:Sr()),n}function Ho(t){var e=4===(o=xo(t.parent)).length?Zr.X():Bo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$o(t.unaryFilter.field);return gu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=$o(t.unaryFilter.field);return gu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=$o(t.unaryFilter.field),gu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=$o(t.unaryFilter.field),gu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}(e)]:void 0!==e.fieldFilter?[(n=e,gu.create($o(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Sr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new zu($o((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=hi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Yo(n.startAt));var u=null;return n.endAt&&(u=Yo(n.endAt)),new Js(e,i,t,o,r,"F",s,u)}function Xo(t){return{before:t.before,values:t.position}}function Yo(t){var e=!!t.before,t=t.values||[];return new ju(t,e)}function Ko(t){return{fieldPath:t.Y()}}function $o(t){return ei.et(t.fieldPath)}function Qo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Jo(t,e){return t instanceof ls?Io(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Zo,ts,es=(n(is,ts=me=function(){this.oe=void 0}),is),ns=(n(rs,Zo=me),rs);function rs(t){var e=this;return(e=Zo.call(this)||this).elements=t,e}function is(){return null!==ts&&ts.apply(this,arguments)||this}function os(t,e){for(var n=ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ss,us=(n(as,ss=me),as);function as(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function hs(t,e){for(var n=ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var cs,ls=(n(fs,cs=me),fs);function fs(t,e){var n=this;return(n=cs.call(this)||this).serializer=t,n.se=e,n}function ps(t){return bo(t.integerValue||t.doubleValue)}function ds(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ys(t,e){this.field=t,this.transform=e}var vs=(gs.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},gs.prototype.isEqual=function(t){return Yr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},gs);function gs(t){(this.fields=t).sort(ei.k)}function ms(t,e){this.version=t,this.transformResults=e}var ws=(bs.ce=function(){return new bs},bs.exists=function(t){return new bs(void 0,t)},bs.updateTime=function(t){return new bs(t)},Object.defineProperty(bs.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},bs);function bs(t,e){this.updateTime=t,this.exists=e}function Es(t,e){return void 0!==t.updateTime?e instanceof Ks&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ks}function Ts(t,e,n,r){return t instanceof Rs?(o=e,Es((i=t).re,o)?(o=As(o),new Ks(i.key,o,i.value,{ae:!0})):o):t instanceof ks?function(t,e){if(!Es(t.re,e))return e;var n=As(e),e=Ps(t,e);return new Ks(t.key,n,e,{ae:!0})}(t,e):t instanceof Ls?function(t,e,n,r){if(!Es(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Ks&&(c=n.field(a.field)),null===c&&r instanceof Ks&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof es?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ns?os(h,i):h instanceof us?hs(h,i):(i=ps(h=Jo(c=h,i))+ps(c.se),Io(h)&&Io(c.se)?Po(i):_o(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Cs(t,i.data(),r);return new Ks(t.key,i.version,r,{ae:!0})}(t,e,r,n):Es(t.re,e)?new $s(t.key,Jr.min()):e;var i,o}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Yr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ns&&e instanceof ns||t instanceof us&&e instanceof us?Yr(t.elements,e.elements,po):t instanceof ls&&e instanceof ls?po(t.se,e.se):t instanceof es&&e instanceof es)}))}function As(t){return t instanceof Ks?t.version:Jr.min()}var Ns,Os,Rs=(n(Ss,Os=l=function(){}),Ss),ks=(n(Ds,Ns=l),Ds);function Ds(t,e,n,r){var i=this;return(i=Ns.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function Ss(t,e,n){var r=this;return(r=Os.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Ps(t,e){return n=t,e=e instanceof Ks?e.data():qs.empty(),r=new Fs(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var _s,Ls=(n(Vs,_s=l),Vs);function Vs(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=ws.exists(!0),n}function Cs(t,e,n){for(var r=new Fs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Us,js,xs=(n(zs,js=l),zs),Ms=(n(Ws,Us=l),Ws),qs=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Bs.prototype.isEqual=function(t){return po(this.proto,t.proto)},Bs),Fs=(Gs.prototype.set=function(t,e){return this.fe(t,e),this},Gs.prototype.delete=function(t){return this.fe(t,null),this},Gs.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},Gs.prototype.he=function(){var t=this.de(ei.X(),this._e);return null!=t?new qs(t):this.le},Gs.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Gs);function Gs(t){void 0===t&&(t=qs.empty()),this.le=t,this._e=new Map}function Bs(t){this.proto=t}function Ws(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.re=e,n.type=4,n}function zs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.re=e,n.type=3,n}var Hs,Xs,Ys,Ks=(n(eu,Ys=me=function(t,e){this.key=t,this.version=e}),eu.prototype.field=function(t){return this.we.field(t)},eu.prototype.data=function(){return this.we},eu.prototype.Ee=function(){return this.we.proto},eu.prototype.isEqual=function(t){return t instanceof eu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},eu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),eu),$s=(n(tu,Xs=me),tu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu.prototype.isEqual=function(t){return t instanceof tu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},tu),Qs=(n(Zs,Hs=me),Zs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Js=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function Zs(){return null!==Hs&&Hs.apply(this,arguments)||this}function tu(t,e,n){var r=this;return(r=Xs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function eu(t,e,n,r){var i=this;return(i=Ys.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function nu(t){return new Js(t)}function ru(t){return!hi(t.limit)&&"F"===t.limitType}function iu(t){return!hi(t.limit)&&"L"===t.limitType}function ou(t){return 0<t.me.length?t.me[0].field:null}function su(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function uu(t){return null!==t.collectionGroup}function au(t){var e=t;if(null===e.Te){e.Te=[];var n=su(e),t=ou(e);if(null!==n&&null===t)n.tt()||e.Te.push(new zu(n)),e.Te.push(new zu(ei.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new zu(ei.nt(),n)))}}return e.Te}function hu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=fi(e.path,e.collectionGroup,au(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=au(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new ju(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ju(e.startAt.position,!e.startAt.before):null;e.Ae=fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function cu(t,e,n){return new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lu(t,e){return di(hu(t),hu(e))&&t.limitType===e.limitType}function fu(t){return pi(hu(t))+"|lt:"+t.limitType}function pu(t){return"Query(target="+(n=(e=hu(t)).path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Y()+" "+t.op+" "+mo(t.value)}).join(", ")+"]"),hi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Gu(e.startAt)),e.endAt&&(n+=", endAt: "+Gu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function du(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):ni.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Bu(t.startAt,au(t),n))&&(!t.endAt||!Bu(t.endAt,au(t),n)));var e,n}function yu(u){return function(t,e){for(var n=!1,r=0,i=au(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?ni.k(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?vo(e,r):Sr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Sr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var vu,gu=(n(mu,vu=function(){}),mu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Tu(t,e,n):"array-contains"===e?new Lu(t,n):"in"===e?new Vu(t,n):"not-in"===e?new Cu(t,n):"array-contains-any"===e?new Uu(t,n):new mu(t,e,n)},mu.Re=function(t,e,n){return new("in"===e?Iu:Au)(t,n)},mu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pe(vo(t,this.value)):null!==t&&fo(this.value)===fo(t)&&this.Pe(vo(t,this.value))},mu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Sr()}},mu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},mu);function mu(t,e,n){var r=this;return(r=vu.call(this)||this).field=t,r.op=e,r.value=n,r}var wu,bu,Eu,Tu=(n(Ru,Eu=gu),Ru.prototype.matches=function(t){return t=ni.k(t.key,this.key),this.Pe(t)},Ru),Iu=(n(Ou,bu=gu),Ou.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ou),Au=(n(Nu,wu=gu),Nu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Nu);function Nu(t,e){var n=this;return(n=wu.call(this,t,"not-in",e)||this).keys=ku(0,e),n}function Ou(t,e){var n=this;return(n=bu.call(this,t,"in",e)||this).keys=ku(0,e),n}function Ru(t,e,n){var r=this;return(r=Eu.call(this,t,e,n)||this).key=ni.it(n.referenceValue),r}function ku(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ni.it(t.referenceValue)})}var Du,Su,Pu,_u,Lu=(n(Fu,_u=gu),Fu.prototype.matches=function(t){return Ao(t=t.field(this.field))&&yo(t.arrayValue,this.value)},Fu),Vu=(n(qu,Pu=gu),qu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&yo(this.value.arrayValue,t)},qu),Cu=(n(Mu,Su=gu),Mu.prototype.matches=function(t){return!yo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!yo(this.value.arrayValue,t))},Mu),Uu=(n(xu,Du=gu),xu.prototype.matches=function(t){var e=this;return!(!Ao(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},xu),ju=function(t,e){this.position=t,this.before=e};function xu(t,e){return Du.call(this,t,"array-contains-any",e)||this}function Mu(t,e){return Su.call(this,t,"not-in",e)||this}function qu(t,e){return Pu.call(this,t,"in",e)||this}function Fu(t,e){return _u.call(this,t,"array-contains",e)||this}function Gu(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}function Bu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ni.k(ni.it(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Wu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Hu=(ta.prototype.Ve=function(t,e,n){for(var r,i,o,s,u,a=n.pe,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof Rs?new Ks(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof ks?(u=i,c=o,Es((s=r).re,u)?(u=Ps(s,u),new Ks(s.key,c.version,u,{hasCommittedMutations:!0})):new Qs(s.key,c.version)):r instanceof Ls?function(t,e,n){if(Pr(null!=n.transformResults),!Es(t.re,e))return new Qs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ks&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ns?os(o,s):o instanceof us?hs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Cs(t,r.data(),e);return new Ks(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new $s(r.key,o.version,{hasCommittedMutations:!0}))}return e},ta.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ts(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.ye))}return e},ta.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ta.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Mi())},ta.prototype.isEqual=function(t){return this.batchId===t.batchId&&Yr(this.mutations,t.mutations,Is)&&Yr(this.baseMutations,t.baseMutations,Is)},ta),Xu=(Zu.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=ji,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new Zu(t,e,n,r)},Zu),Yu=(Ju.prototype.get=function(t){var e=this.Se(t);if(void 0!==(e=this.Ne[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.De(i,t))return o}},Ju.prototype.has=function(t){return void 0!==this.get(t)},Ju.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},Ju.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},Ju.prototype.forEach=function(s){uo(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ju.prototype.W=function(){return ao(this.Ne)},Ju),Ku=(Qu.prototype.catch=function(t){return this.next(void 0,t)},Qu.prototype.next=function(r,i){var o=this;return this.$e&&Sr(),this.$e=!0,this.Oe?this.error?this.Le(i,this.error):this.ke(r,this.result):new Qu(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.Le(i,t).next(e,n)}})},Qu.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Qu.prototype.Ue=function(t){try{var e=t();return e instanceof Qu?e:Qu.resolve(e)}catch(t){return Qu.reject(t)}},Qu.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):Qu.resolve(e)},Qu.prototype.Le=function(t,e){return t?this.Ue(function(){return t(e)}):Qu.reject(e)},Qu.resolve=function(n){return new Qu(function(t,e){t(n)})},Qu.reject=function(n){return new Qu(function(t,e){e(n)})},Qu.qe=function(t){return new Qu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Qu.Be=function(t){for(var n=Qu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Qu.resolve(t):e()})}(r[e]);return n},Qu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},Qu),$u=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function Qu(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.$e=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function Ju(t,e){this.Se=t,this.De=e,this.Ne={}}function Zu(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function ta(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function ea(t){return new So(t,!0)}function na(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ra=(aa.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},aa.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},aa.prototype.Ye=function(t,e,i){var o=Li;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},aa.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},aa.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Li;return t.forEach(function(t,e){e=e||new $s(t,Jr.min()),n=n.Tt(t,e)}),n})},aa.prototype.ts=function(t,e,n){return r=e,ni.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):uu(e)?this.es(t,e,n):this.ss(t,e,n);var r},aa.prototype.ns=function(t,e){return this.Ge(t,new ni(e)).next(function(t){var e=Ui;return t instanceof Ks&&(e=e.Tt(t.key,t)),e})},aa.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=Ui;return this.We.rs(n,s).next(function(t){return Ku.forEach(t,function(t){var e=(e=r,t=t.child(s),new Js(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},aa.prototype.ss=function(e,n,t){var a,h,r=this;return this.Qe.ts(e,n,t).next(function(t){return a=t,r.je.os(e,n)}).next(function(t){return h=t,r.us(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Ts(s,s=a.get(u),s,r.ye);a=s instanceof Ks?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){du(n,e)||(a=a.remove(t))}),a})},aa.prototype.us=function(t,e,n){for(var r=Mi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ks&&(h=h.Tt(t,e))}),h})},aa),ia=(ua.ls=function(t,e){for(var n=Mi(),r=Mi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ua(t,e.fromCache,n,r)},ua),oa=(sa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},sa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},sa);function sa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function ua(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function aa(t,e,n){this.Qe=t,this.je=e,this.We=n}oa.Es=-1;var ha=(ca.prototype.reset=function(){this.ys=0},ca.prototype.gs=function(){this.ys=this.Ps},ca.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ca.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ca.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ca.prototype.bs=function(){return(Math.random()-.5)*this.ys},ca);function ca(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function la(t){return"IndexedDbTransactionError"===t.name}function fa(){return"undefined"!=typeof document?document:null}var pa=(va.$s=function(t,e,n,r,i){return(i=new va(t,e,Date.now()+n,r,i)).start(n),i},va.prototype.start=function(t){var e=this;this.Ls=setTimeout(function(){return e.ks()},t)},va.prototype.Ds=function(){return this.ks()},va.prototype.cancel=function(t){null!==this.Ls&&(this.clearTimeout(),this.Os.reject(new Cr(Vr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},va.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.Ls?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},va.prototype.clearTimeout=function(){null!==this.Ls&&(this.Fs(this),clearTimeout(this.Ls),this.Ls=null)},va),da=(Object.defineProperty(ya.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),ya.prototype.Ms=function(t){this.enqueue(t)},ya.prototype.Ys=function(t){this.Js(),this.Xs(t)},ya.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=fa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},ya.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},ya.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},ya.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},ya.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Rr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},ya.prototype.Cs=function(t,e,n){var r=this;return this.Js(),-1<this.Gs.indexOf(t)&&(e=0),n=pa.$s(this,t,e,n,function(t){return r.ei(t)}),this.Qs.push(n),n},ya.prototype.Js=function(){this.js&&Sr()},ya.prototype.si=function(){},ya.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},ya.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},ya.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},ya.prototype.ui=function(t){this.Gs.push(t)},ya.prototype.ei=function(t){t=this.Qs.indexOf(t),this.Qs.splice(t,1)},ya);function ya(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new ha(this,"async_queue_retry"),this.zs=function(){var t=fa();t&&Or("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=fa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function va(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new $u,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function ga(t,e){if(Rr("AsyncQueue",e+": "+t),la(t))return new Cr(Vr.UNAVAILABLE,e+": "+t);throw t}function ma(t){this.ci=t}var wa=(Oa.prototype.hi=function(t,e){return this.ai.add(e),Ku.resolve()},Oa.prototype.rs=function(t,e){return Ku.resolve(this.ai.getEntries(e))},Oa),ba=(Na.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Pi(Zr.k),t=!r.has(n);return this.index[e]=r.add(n),t},Na.prototype.has=function(t){var e=t.j(),t=t.q();return(e=this.index[e])&&e.has(t)},Na.prototype.getEntries=function(t){return(this.index[t]||new Pi(Zr.k)).H()},Na),Ea=(Aa.prototype.next=function(){return this.li+=2,this.li},Aa._i=function(){return new Aa(0)},Aa.fi=function(){return new Aa(-1)},Aa),Ta=(Ia.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},Ia);function Ia(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Ai(Xr),this.Ei=new Yu(pi,di),this.mi=Jr.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new ra(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Aa(t){this.li=t}function Na(){this.index={}}function Oa(){this.ai=new ba}function Ra(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Si(v).next(function(t){return g=t,n=e.persistence.Ti(o),m=new ra(e.Ai,n,e.persistence.Vi()),n.Si(v)}).next(function(t){for(var e=[],n=[],r=Mi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function ka(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function Da(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!la(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function Sa(t,o,s){var u=t,a=Jr.min(),h=Mi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=hu(o),(void 0!==(t=(i=t).Ei.get(r))?Ku.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:Jr.min(),s?h:Mi())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function Pa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Vr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function _a(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Za(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,Ha(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,za(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new Ma(n,r)}var La,Va,Ca,l=(Wa.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},Wa.prototype.ir=function(){return 2===this.state},Wa.prototype.start=function(){3!==this.state?this.auth():this.rr()},Wa.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wa.prototype.ur=function(){this.state=0,this.Ks.reset()},Wa.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},Wa.prototype.hr=function(t){this.lr(),this.stream.send(t)},Wa.prototype.ar=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},Wa.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},Wa.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===Vr.RESOURCE_EXHAUSTED?(Rr(n.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Vr.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},Wa.prototype._r=function(){},Wa.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Cr(Vr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},Wa.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Wa.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Wa.prototype.mr=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Wa.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Wa),Ua=(n(Ba,Ca=l),Ba.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},Ba.prototype.onMessage=function(t){this.Ks.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Sr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Pr(void 0===o||"string"==typeof o),vi.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),vi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Vr.UNKNOWN:Ii(s.code),new Cr(o,s.message||"")),r=new Yi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=qo(t,a.document.name),u=Uo(a.document.updateTime),s=new qs({mapValue:{fields:a.document.fields}}),u=new Ks(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Hi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=qo(t,a.document),h=a.readTime?Uo(a.readTime):Jr.min(),h=new $s(u,h),a=a.removedTargetIds||[];r=new Hi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=qo(t,h.document),h=h.removedTargetIds||[];r=new Hi([],h,c,null)}else{if(!("filter"in e))return Sr();e.filter,(c=e.filter).targetId,e=new mi(e=c.count||0),c=c.targetId,r=new Xi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Jr.min():Uo(e.readTime);return this.listener.Rr(n,t)},Ba.prototype.Pr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=Go(this.serializer),h.addTarget=(e=this.serializer,(r=yi(r=(n=t).target)?{documents:{documents:[Fo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Fo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Fo(i,u.q()),s.structuredQuery.from=[{collectionId:u.j()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Oo(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Oo(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NAN"}};if(No(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(t.field),op:(e=t.op,Do[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Ko(t.field),direction:(t=t.dir,ko[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.ne||hi(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Xo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Xo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Co(e,n.resumeToken):0<n.ft.F(Jr.min())&&(r.readTime=Vo(e,n.ft.$())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.hr(h)},Ba.prototype.yr=function(t){var e={};e.database=Go(this.serializer),e.removeTarget=t,this.hr(e)},Ba),ja=(n(Ga,Va=l),Object.defineProperty(Ga.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),Ga.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,Va.prototype.start.call(this)},Ga.prototype._r=function(){this.Vr&&this.gr([])},Ga.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},Ga.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Uo(e.updateTime):Uo(n)).isEqual(Jr.min())&&(t=Uo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ms(t,n);var e,n})):[]),n=Uo(t.commitTime);return this.listener.vr(n,e)}var r;return Pr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},Ga.prototype.Cr=function(){var t={};t.database=Go(this.serializer),this.hr(t)},Ga.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.hr(t)},Ga),xa=(n(Fa,La=function(){}),Fa.prototype.Dr=function(){if(this.Sr)throw new Cr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},Fa.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&i.credentials.A(),t})},Fa.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&i.credentials.A(),t})},Fa.prototype.terminate=function(){this.Sr=!1},Fa),Ma=(qa.prototype.Mr=function(){var t=this;0===this.$r&&(this.Ur("Unknown"),this.Lr=this.Ns.Cs("online_state_timeout",1e4,function(){return t.Lr=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},qa.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.$r++,1<=this.$r&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},qa.prototype.set=function(t){this.Qr(),this.$r=0,"Online"===t&&(this.kr=!1),this.Ur(t)},qa.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},qa.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kr?(Rr(t),this.kr=!1):Or("OnlineStateTracker",t)},qa.prototype.Qr=function(){null!==this.Lr&&(this.Lr.cancel(),this.Lr=null)},qa);function qa(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.$r=0,this.Lr=null,this.kr=!0}function Fa(t,e,n){var r=this;return(r=La.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function Ga(t,e,n,r,i){var o=this;return(o=Va.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function Ba(t,e,n,r,i){var o=this;return(o=Ca.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Wa(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new ha(t,e)}function za(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Za(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ha(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Xa(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),Ja(t)?Qa(t):sh(t).ir()&&Ka(t,e))}function Ya(t,e){var n=t,t=sh(n);n.zr.delete(e),t.ir()&&$a(n,e),0===n.zr.size&&(t.ir()?t.cr():Za(n)&&n.Zr.set("Unknown"))}function Ka(t,e){t.no.Dn(e.targetId),sh(t).Pr(e)}function $a(t,e){t.no.Dn(e),sh(t).yr(e)}function Qa(e){e.no=new $i({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),sh(e).start(),e.Zr.Mr()}function Ja(t){return Za(t)&&!sh(t).sr()&&0<t.zr.size}function Za(t){return 0===t.Hr.size}function th(t){t.no=void 0}function eh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!la(r))throw r;return n.Hr.add(1),[4,Ha(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return ka(n.jr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,za(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function nh(e,n){return n().catch(function(t){return eh(e,t,n)})}function rh(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=uh(o=h),u=0<o.Kr.length?o.Kr[o.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(Za(o)&&o.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.jr,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.je.zi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kr.length&&s.cr(),[3,7]):(u=a.batchId,e=a,(n=o).Kr.push(e),(n=uh(n)).ir()&&n.pr&&n.gr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,eh(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return ih(o)&&oh(o),[2]}var e,n,r,i})})}function ih(t){return Za(t)&&!uh(t).sr()&&0<t.Kr.length}function oh(t){uh(t).start()}function sh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zr.forEach(function(t,e){Ka(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return th(e),Ja(e)?(e.Zr.Br(n),Qa(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof Yi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,eh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Hi?s.no.Mn(u):u instanceof Xi?s.no.Kn(u):s.no.Bn(u),a.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ka(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&(n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(vi.lt,e.ft)),$a(r,t),e=new bi(e.target,t,1,e.sequenceNumber),Ka(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,eh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Dr(),new Ua(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),Ja(n)?Qa(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),th(n),t.label=3;case 3:return[2]}})})})),n.oo}function uh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return uh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&uh(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ti(n=i.code)&&n!==Vr.ABORTED?(e=r.Kr.shift(),uh(r).ur(),[4,nh(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,rh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return ih(e)&&oh(e),[2]}})})}.bind(null,n),br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=uh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=Xu.from(e,i,o),[4,nh(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,rh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new ja(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,rh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Or("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function ah(){this.queries=new Yu(fu,lu),this.onlineState="Unknown",this.ao=new Set}var hh=function(){this.co=void 0,this.listeners=[]};function ch(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new hh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=ga(o=t.sent(),"Initialization of query '"+pu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&fh(e),[2]}})})}function lh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function fh(t){t.ao.forEach(function(t){t.next()})}var ph=(Sh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},Sh.prototype.onError=function(t){this.wo.error(t)},Sh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},Sh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},Sh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Sh.prototype.Io=function(t){t=Bi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},Sh),dh=(Dh.prototype.W=function(){return this.Po.W()},Dh.prototype.vo=function(t,e){e=new yh(t,e),this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Dh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Dh.prototype.Co=function(t,e){this.So(new yh(t,e))},Dh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Dh.prototype.No=function(t){var e=this,n=new ni(new Zr([])),r=new yh(n,t),t=new yh(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Dh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Dh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Dh.prototype.Fo=function(t){var e=new ni(new Zr([])),n=new yh(e,t),t=new yh(e,t+1),r=Mi();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Dh.prototype.Oo=function(t){var e=new yh(t,0);return null!==(e=this.Po.Gt(e))&&t.isEqual(e.key)},Dh),yh=(kh.yo=function(t,e){return ni.k(t.key,e.key)||Xr(t.$o,e.$o)},kh.po=function(t,e){return Xr(t.$o,e.$o)||ni.k(t.key,e.key)},kh),vh=(Rh.prototype.Lo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Rh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Rh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Rh),gh=(Oh.prototype.Bo=function(t){},Oh.prototype.Qo=function(t,e,n){},Oh.prototype.jo=function(t){return this.Uo.Lo(t),this.qo[t]||"not-current"},Oh.prototype.Wo=function(t,e,n){this.qo[t]=e},Oh.prototype.Go=function(t){this.Uo.ko(t)},Oh.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Oh.prototype.zo=function(t){delete this.qo[t]},Oh.prototype.Ho=function(){return this.Uo.activeTargetIds},Oh.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Oh.prototype.start=function(){return this.Uo=new vh,Promise.resolve()},Oh.prototype.Jo=function(t,e,n){},Oh.prototype.Xo=function(t){},Oh.prototype.Zo=function(){},Oh.prototype.ws=function(t){},Oh.prototype.tu=function(){},Oh),mh=function(t){this.key=t},wh=function(t){this.key=t},bh=(Object.defineProperty(Nh.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Nh.prototype.uu=function(t,e){var s=this,u=e?e.cu:new Gi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=ru(this.query)&&a.size===this.query.limit?a.last():null,p=iu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof Ks?e:null)&&(du(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),ru(this.query)||iu(this.query))for(;c.size>this.query.limit;){var n=ru(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Nh.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Nh.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}}var r,i}),this._u(n);var s=e?this.fu():[],e=(n=0===this.su.size&&this._n?1:0)!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Bi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Nh.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new Gi,nn:this.nn,hu:!1},!1)):{du:[]}},Nh.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Nh.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Nh.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=Mi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new wh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new mh(t))}),r},Nh.prototype.Eu=function(t){return this.nu=t.Ji,this.su=Mi(),t=this.uu(t.documents),this.lu(t,!0)},Nh.prototype.mu=function(){return Bi.rn(this.query,this.ru,this.nn,0===this.eu)},Nh),Eh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Th=function(t){this.key=t,this.Tu=!1},Ih=(Object.defineProperty(Ah.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),Ah);function Ah(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new Yu(fu,lu),this.pu=new Map,this.gu=[],this.vu=new Ai(ni.k),this.bu=new Map,this.Cu=new dh,this.Su={},this.Du=new Map,this.Nu=Ea.fi(),this.onlineState="Unknown",this.xu=void 0}function Nh(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=Mi(),this.nn=Mi(),this.iu=yu(t),this.ru=new Fi(this.iu)}function Oh(){this.Uo=new vh,this.qo={},this.Or=null,this._s=null}function Rh(){this.activeTargetIds=qi}function kh(t,e){this.key=t,this.$o=e}function Dh(){this.Po=new Pi(yh.yo),this.Vo=new Pi(yh.po)}function Sh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Ph(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ai.Fi({Oi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Ku.resolve();return a.forEach(function(n){h=h.next(function(){return s.He(o,n)}).next(function(t){var e=t;Pr(null!==(t=r.Ce.get(n))),(!e||e.version.F(t)<0)&&(e=u.Ve(n,e,r))&&s.$i(e,r.be)})}),h.next(function(){return i.je.Li(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,e)})}))];case 2:return i=t.sent(),Uh(n,r,null),Ch(n,r),n.Ru.Qo(r,"acknowledged"),[4,Fh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.je.Li(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Uh(n,u,a),Ch(n,u),n.Ru.Qo(u,"rejected",a),[4,Fh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=Qr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Mi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ls?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ks?t.field(i.field):void 0;null!=(o=Jo(i.transform,o||null))&&(e=(null==e?new Fs:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new ks(i.key,o,function s(t){var u=[];return uo(t.fields||{},function(t,e){var n=new ei([t]);if(Ro(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new vs(u)}(o.proto.mapValue),ws.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Ai(Xr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,Fh(u,s.Uu)];case 3:return t.sent(),[4,rh(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=ga(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function _h(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=e,l=(o=s).ft,f=c.wi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=Li;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Mi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Li;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof $s&&e.version.isEqual(Jr.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.$i(e,r),o=o.Tt(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Jr.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),Ku.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t}))];case 2:return r=t.sent(),s.on.forEach(function(t,e){(e=n.bu.get(e))&&(Pr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Pr(e.Tu):0<t.wn.size&&(Pr(e.Tu),e.Tu=!1))}),[4,Fh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Lh(t,n,e){var r;((t=t).Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){(e=e.view.lo(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&fh(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function Vh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Za((n=o).Au)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=ga(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Ch(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Uh(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function jh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||xh(e,t)})}function xh(t,e){var n=t.vu.get(e);null!==n&&(Ya(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),qh(t))}function Mh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof mh?(t.Cu.vo(u.key,e),r=t,i=(i=u).key,r.vu.get(i)||(Or("SyncEngine","New document in limbo: "+i),r.gu.push(i),qh(r))):u instanceof wh?(Or("SyncEngine","Document no longer in limbo: "+u.key),t.Cu.Co(u.key,e),t.Cu.Oo(u.key)||xh(t,u.key)):Sr()}}function qh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new Th(e)),t.vu=t.vu.Tt(e,n),Xa(t.Au,new bi(hu(nu(e.path)),n,2,oa.Es))}}function Fh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ia.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ku.forEach(h,function(e){return Ku.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return Ku.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var Gh,Bh,Wh,zh=(Rc.prototype.vi=function(t){this.Qu=t},Rc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(Jr.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(ru(r)||iu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Nr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Rc.prototype.Wu=function(n,t){var r=new Pi(yu(n));return t.forEach(function(t,e){e instanceof Ks&&du(n,e)&&(r=r.add(e))}),r},Rc.prototype.hu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},Rc.prototype.ju=function(t,e){return Nr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",pu(e)),this.Qu.ts(t,e,Jr.min())},Rc),Hh=(Oc.prototype.zu=function(t){return Ku.resolve(0===this.je.length)},Oc.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1],n=new Hu(i,e,n,r),this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new yh(u.key,i)),this.We.hi(t,u.key.path.q())}return Ku.resolve(n)},Oc.prototype.qu=function(t,e){return Ku.resolve(this.Hu(e))},Oc.prototype.zi=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,Ku.resolve(this.je.length>e?this.je[e]:null)},Oc.prototype.Bu=function(){return Ku.resolve(0===this.je.length?-1:this.Gu-1)},Oc.prototype.Si=function(t){return Ku.resolve(this.je.slice())},Oc.prototype.Ke=function(t,e){var n=this,r=new yh(e,0),e=new yh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.$o),i.push(t)}),Ku.resolve(i)},Oc.prototype.Ze=function(t,e){var n=this,r=new Pi(Xr);return e.forEach(function(t){var e=new yh(t,0),t=new yh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.$o)})}),Ku.resolve(this.Ju(r))},Oc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;ni.ot(e)||(e=e.child(""));var e=new yh(new ni(e),0),i=new Pi(Xr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.$o)),!0)},e),Ku.resolve(this.Ju(i))},Oc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Oc.prototype.Li=function(n,r){var i=this;Pr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return Ku.forEach(r.mutations,function(t){var e=new yh(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Oc.prototype.tc=function(t){},Oc.prototype.Oo=function(t,e){var n=new yh(e,0),n=this.Ku.Gt(n);return Ku.resolve(e.isEqual(n&&n.key))},Oc.prototype.ki=function(t){return this.je.length,Ku.resolve()},Oc.prototype.Xu=function(t,e){return this.Yu(t)},Oc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Oc.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.je.length?null:this.je[t]},Oc),Xh=(Nc.prototype.$i=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.We.hi(t,r.path.q())},Nc.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Nc.prototype.He=function(t,e){return e=this.docs.get(e),Ku.resolve(e?e.ec:null)},Nc.prototype.getEntries=function(t,e){var n=this,r=Li;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),Ku.resolve(r)},Nc.prototype.ts=function(t,e,n){for(var r=Ui,i=new ni(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=(u=o.Dt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.G(s.path))break;a.F(n)<=0||u instanceof Ks&&du(e,u)&&(r=r.Tt(u.key,u))}return Ku.resolve(r)},Nc.prototype.sc=function(t,e){return Ku.forEach(this.docs,function(t){return e(t)})},Nc.prototype.Fi=function(t){return new Yh(this)},Nc.prototype.ic=function(t){return Ku.resolve(this.size)},Nc),Yh=(Ac.prototype.oc=function(t){return(t=this.Uu.get(t))?t.readTime:Jr.min()},Ac.prototype.$i=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Ac.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Ac.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?Ku.resolve(n.ec):this.cc(t,e)},Ac.prototype.getEntries=function(t,e){return this.ac(t,e)},Ac.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Ac.prototype.uc=function(){},n(Ic,Wh=Ac),Ic.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.$i(n,e.ec,r.oc(t))):r.hc.Gi(t)}),Ku.qe(i)},Ic.prototype.cc=function(t,e){return this.hc.He(t,e)},Ic.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Ic),Kh=(Tc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Ku.resolve()},Tc.prototype.Mi=function(t){return Ku.resolve(this.lastRemoteSnapshotVersion)},Tc.prototype.wc=function(t){return Ku.resolve(this._c)},Tc.prototype.$u=function(t){return this.highestTargetId=this.dc.next(),Ku.resolve(this.highestTargetId)},Tc.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Ku.resolve()},Tc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new Ea(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Tc.prototype.Lu=function(t,e){return this.Ec(e),this.targetCount+=1,Ku.resolve()},Tc.prototype.Qi=function(t,e){return this.Ec(e),Ku.resolve()},Tc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,Ku.resolve()},Tc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),Ku.qe(u).next(function(){return s})},Tc.prototype.Ic=function(t){return Ku.resolve(this.targetCount)},Tc.prototype.Hi=function(t,e){return e=this.lc.get(e)||null,Ku.resolve(e)},Tc.prototype.qi=function(t,e,n){return this.fc.bo(e,n),Ku.resolve()},Tc.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Ku.qe(i)},Tc.prototype.Ac=function(t,e){return this.fc.No(e),Ku.resolve()},Tc.prototype.Yi=function(t,e){return e=this.fc.Fo(e),Ku.resolve(e)},Tc.prototype.Oo=function(t,e){return Ku.resolve(this.fc.Oo(e))},Tc),$h=(Ec.prototype.yc=function(t,e){return Ku.resolve(this.Rc.get(e))},Ec.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Uo(e.createTime)}),Ku.resolve()},Ec.prototype.gc=function(t,e){return Ku.resolve(this.Pc.get(e))},Ec.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=Ho({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?cu(e,e.limit,"L"):e),readTime:Uo(n.readTime)}),Ku.resolve()},Ec),Qh=(bc.prototype.start=function(){return Promise.resolve()},bc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(bc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),bc.prototype.xc=function(){},bc.prototype.Fc=function(){},bc.prototype.Vi=function(){return this.We},bc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new Hh(this.We,this.Wi),this.bc[t.h()]=e),e},bc.prototype.Pi=function(){return this.Ri},bc.prototype.Ii=function(){return this.Qe},bc.prototype.gi=function(){return this.pi},bc.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Jh(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.$c(i).next(function(){return t})}).Me().then(function(t){return i.Lc(),t})},bc.prototype.kc=function(e,n){return Ku.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},bc),Jh=(wc.prototype.Uc=function(t){this.Mc.push(t)},wc.prototype.Lc=function(){this.Mc.forEach(function(t){return t()})},n(mc,Bh=wc),mc),Zh=(gc.Qc=function(t){return new gc(t)},Object.defineProperty(gc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Sr()},enumerable:!1,configurable:!0}),gc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),Ku.resolve()},gc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),Ku.resolve()},gc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Ku.resolve()},gc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},gc.prototype.Oc=function(){this.Bc=new Set},gc.prototype.$c=function(n){var r=this,i=this.persistence.Ii().Fi();return Ku.forEach(this.jc,function(t){var e=ni.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},gc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},gc.prototype.Dc=function(t){return 0},gc.prototype.Wc=function(t,e){var n=this;return Ku.Be([function(){return Ku.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},gc),tc=(vc.prototype.Ar=function(t){this.zc=t},vc.prototype.dr=function(t){this.Hc=t},vc.prototype.onMessage=function(t){this.Yc=t},vc.prototype.close=function(){this.Kc()},vc.prototype.send=function(t){this.Gc(t)},vc.prototype.Jc=function(){this.zc()},vc.prototype.Xc=function(t){this.Hc(t)},vc.prototype.Zc=function(t){this.Yc(t)},vc),ec={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},nc=(yc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);return Or("RestConnection","Sending: ",i,n),t={},this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},yc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},yc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-2020102005919",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},yc.prototype.sa=function(t,e){return t=ec[t],this.na+"/v1/"+e+":"+t},n(dc,Gh=yc),dc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case fr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case fr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Cr(Vr.DEADLINE_EXCEEDED,"Request time out"));break;case fr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Vr).indexOf(e)?e:Vr.UNKNOWN,r(new Cr(e,t.message))):r(new Cr(Vr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Cr(Vr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},dc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=lr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Or("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,h=new tc({Gc:function(t){a?Or("Connection","Not sending because WebChannel is closed:",t):(u||(Or("Connection","Opening WebChannel transport."),s.open(),u=!0),Or("Connection","WebChannel sending:",t),s.send(t))},Kc:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||Or("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,Or("Connection","WebChannel transport closed"),h.Xc())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,kr("Connection","WebChannel transport errored:",t),h.Xc(new Cr(Vr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=wi[r];if(void 0!==t)return Ii(t)}(),i=n.message,void 0===t&&(t=Vr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.Xc(new Cr(t,i)),s.close()):(Or("Connection","WebChannel received:",e),h.Zc(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?Or("Connection","Detected buffering proxy"):11===t.stat&&Or("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Jc()},0),h},dc),rc=(pc.prototype.Xr=function(t){this.ha.push(t)},pc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},pc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},pc.prototype.ua=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},pc.prototype.aa=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},pc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},pc),ic=(fc.prototype.Xr=function(t){},fc.prototype.Zo=function(){},fc),oc=(lc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ea(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},lc.prototype.Ea=function(t){return null},lc.prototype.ma=function(t){return e=this.persistence,n=new zh,r=t.Ta,t=this.serializer,new Ta(e,n,r,t);var e,n,r},lc.prototype.da=function(t){return new Qh(Zh.Qc,this.serializer)},lc.prototype.fa=function(t){return new gh},lc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},lc),sc=(cc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Lh(e.Pa,t,1)},this.Au.Gr.Va=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.h()),[4,Ra(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Cr(Vr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,Fh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Pa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,za(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,Ha(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},cc.prototype.Ra=function(t){return new ah},cc.prototype.Aa=function(t){var e=ea(t.ta.t),n=(n=t.ta,new nc(n));return t=t.credentials,new xa(t,n,e)},cc.prototype.Ia=function(t){var e=this;return new _a(this.jr,this.Wr,t.Ns,function(t){return Lh(e.Pa,t,0)},t=new(rc._a()?rc:ic))},cc.prototype.ya=function(t,e){return n=this.jr,r=this.Au,i=this.Iu,o=this.Ru,s=t.Ta,t=t.Pu,e=e,t=new Ih(n,r,i,o,s,t),e&&(t.xu=!0),t;var n,r,i,o,s},cc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,Ha(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},cc),uc=(hc.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},hc.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},hc.prototype.ga=function(){this.muted=!0},hc.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},hc),ac=function(t){this.va=t};function hc(t){this.observer=t,this.muted=!1}function cc(){}function lc(){this.synchronizeTabs=!1}function fc(){}function pc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function dc(t){var e=this;return(e=Gh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function yc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function vc(t){this.Gc=t.Gc,this.Kc=t.Kc}function gc(t){this.persistence=t,this.qc=new dh,this.Bc=null}function mc(t){var e=this;return(e=Bh.call(this)||this).Bi=t,e}function wc(){this.Mc=[]}function bc(t,e){var n=this;this.bc={},this.Cc=new oa(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new Kh(this),this.We=new wa,this.Qe=(t=this.We,new Xh(t,function(t){return n.Wi.Dc(t)})),this.serializer=new ma(e),this.pi=new $h(this.serializer)}function Ec(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Tc(t){this.persistence=t,this.lc=new Yu(pi,di),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this._c=0,this.fc=new dh,this.targetCount=0,this.dc=Ea._i()}function Ic(t){var e=this;return(e=Wh.call(this)||this).hc=t,e}function Ac(){this.Uu=new Yu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Nc(t,e){this.We=t,this.nc=e,this.docs=new Ai(ni.k),this.size=0}function Oc(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Pi(yh.yo)}function Rc(){}function kc(t,e,n){if(!n)throw new Cr(Vr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Dc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Sc(t,e,n,r){if(!0===e&&!0===r)throw new Cr(Vr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Pc(t){if(!ni.ot(t))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function _c(t){if(ni.ot(t))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Lc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Sr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Vc(t,e){if(t instanceof ac&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Cr(Vr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Lc(t),new Cr(Vr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Cc(t,e){if(e<=0)throw new Cr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uc,jc=function(t){this.ba=t},xc=(n(Mc,Uc=jc),Mc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},Mc.prototype.isEqual=function(t){return t instanceof Mc},Mc);function Mc(){return null!==Uc&&Uc.apply(this,arguments)||this}function qc(t,e,n){return new Lf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Fc,Gc,Bc,Wc,zc=(n(ul,Wc=jc),ul.prototype.Ca=function(t){return new ys(t.path,new es)},ul.prototype.isEqual=function(t){return t instanceof ul},ul),Hc=(n(sl,Bc=jc),sl.prototype.Ca=function(t){var e=qc(this,t,!0),n=this.Fa.map(function(t){return Ff(t,e)}),n=new ns(n);return new ys(t.path,n)},sl.prototype.isEqual=function(t){return this===t},sl),Xc=(n(ol,Gc=jc),ol.prototype.Ca=function(t){var e=qc(this,t,!0),n=this.Fa.map(function(t){return Ff(t,e)}),n=new us(n);return new ys(t.path,n)},ol.prototype.isEqual=function(t){return this===t},ol),Yc=(n(il,Fc=jc),il.prototype.Ca=function(t){var e=new ls(t.serializer,Lo(t.serializer,this.Oa));return new ys(t.path,e)},il.prototype.isEqual=function(t){return this===t},il),Kc=(Object.defineProperty(rl.prototype,"latitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Object.defineProperty(rl.prototype,"longitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),rl.prototype.isEqual=function(t){return this.$a===t.$a&&this.La===t.La},rl.prototype.toJSON=function(){return{latitude:this.$a,longitude:this.La}},rl.prototype.D=function(t){return Xr(this.$a,t.$a)||Xr(this.La,t.La)},rl),$c=(nl.fromBase64String=function(t){try{return new nl(vi.fromBase64String(t))}catch(t){throw new Cr(Vr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},nl.fromUint8Array=function(t){return new nl(vi.fromUint8Array(t))},nl.prototype.toBase64=function(){return this.ka.toBase64()},nl.prototype.toUint8Array=function(){return this.ka.toUint8Array()},nl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},nl.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},nl),Qc=new Map,Jc=(el.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},el),Zc=(Object.defineProperty(tl.prototype,"app",{get:function(){if(!this.ja)throw new Cr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(tl.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(tl.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),tl.prototype.za=function(t){if(this.qa)throw new Cr(Vr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new Jc(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new Ur;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Cr(Vr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},tl.prototype.Ha=function(){return this.Ua},tl.prototype.Ya=function(){return this.qa=!0,this.Ua},tl.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},tl.prototype.Ja=function(){return(t=Qc.get(this))&&(Or("ComponentProvider","Removing Datastore"),Qc.delete(this),t.terminate()),Promise.resolve();var t},tl);function tl(t,e){this.Ma="(lite)",this.Ua=new Jc({}),this.qa=!1,t instanceof wr?(this.Ba=t,this.Qa=new Ur):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Cr(Vr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wr(t.options.projectId)}(t),this.Qa=new jr(e))}function el(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Cr(Vr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Cr(Vr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Sc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function nl(t){this.ka=t}function rl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Cr(Vr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Cr(Vr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.$a=t,this.La=e}function il(t,e){var n=this;return(n=Fc.call(this,t)||this).Oa=e,n}function ol(t,e){var n=this;return(n=Gc.call(this,t)||this).Fa=e,n}function sl(t,e){var n=this;return(n=Bc.call(this,t)||this).Fa=e,n}function ul(){return null!==Wc&&Wc.apply(this,arguments)||this}function al(){if("undefined"==typeof Uint8Array)throw new Cr(Vr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function hl(){if("undefined"==typeof atob)throw new Cr(Vr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var cl,ll,fl,pl=(n(El,fl=ac),El.fromBase64String=function(t){return hl(),new El($c.fromBase64String(t))},El.fromUint8Array=function(t){return al(),new El($c.fromUint8Array(t))},El.prototype.toBase64=function(){return hl(),this.va.toBase64()},El.prototype.toUint8Array=function(){return al(),this.va.toUint8Array()},El.prototype.isEqual=function(t){return this.va.isEqual(t.va)},El.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},El),me=(bl.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(Eo(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw Sr()}},bl.prototype.rh=function(t,n){var r=this,i={};return uo(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},bl.prototype.sh=function(t){return new Kc(bo(t.latitude),bo(t.longitude))},bl.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},bl.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){return ho(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(co(t));default:return null}},bl.prototype.Za=function(t){return t=wo(t),new Qr(t.seconds,t.nanos)},bl.prototype.oh=function(t,e){var n=Zr.J(t);return Pr(Qo(n)),t=new wr(n.get(1),n.get(3)),n=new ni(n.U(5)),t.isEqual(e)||Rr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},bl),dl=(n(wl,ll=me),wl.prototype.nh=function(t){return new pl(new $c(t))},wl.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),Pp.uh(t,this.firestore,null)},wl),yl=(Object.defineProperty(ml.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(ml.prototype,"ref",{get:function(){return new Wl(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),ml.prototype.exists=function(){return null!==this._h},ml.prototype.data=function(){if(this._h){if(this.fh){var t=new vl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},ml.prototype.get=function(t){if(this._h&&null!==(t=this._h.data().field(Tl("DocumentSnapshot.get",t))))return this.hh.Xa(t)},ml),vl=(n(gl,cl=yl),gl.prototype.data=function(){return cl.prototype.data.call(this)},gl);function gl(){return null!==cl&&cl.apply(this,arguments)||this}function ml(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function wl(t){var e=this;return(e=ll.call(this)||this).firestore=t,e}function bl(){}function El(){return null!==fl&&fl.apply(this,arguments)||this}function Tl(t,e){return"string"==typeof e?Xf(t,e):(e instanceof ac?e.va:e).dh}var Il,Al=(Rl.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Rl),Nl=(n(Ol,Il=Zc),Ol.prototype.Ja=function(){return this.Eh||Np(this),this.Eh.terminate()},Ol);function Ol(t,e){var n=this;return(n=Il.call(this,t,e)||this).wh=new da,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Rl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new ei(t)}var kl,Dl,Sl=(n(Cl,Dl=yl),Cl.prototype.exists=function(){return Dl.prototype.exists.call(this)},Cl.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Pl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Cl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h&&null!==(t=this._h.data().field(Tl("DocumentSnapshot.get",t))))return this.hh.Xa(t,e.serverTimestamps)},Cl),Pl=(n(Vl,kl=Sl),Vl.prototype.data=function(t){return void 0===t&&(t={}),kl.prototype.data.call(this,t)},Vl),_l=(Object.defineProperty(Ll.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Ll.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Pl(r.ah,r.hh,t.key,t,new Wp(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Ll.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Th.sn)throw new Cr(Vr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Pl(i.ah,i.hh,t.doc.key,t.doc,new Wp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Pl(i.ah,i.hh,t.doc.key,t.doc,new Wp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Ll);function Ll(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new Wp(r.hasPendingWrites,r.fromCache),this.query=n}function Vl(){return null!==kl&&kl.apply(this,arguments)||this}function Cl(t,e,n,r,i,o){var s=this;return(s=Dl.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Ul(t,e){return t instanceof Sl&&e instanceof Sl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof _l&&e instanceof _l&&t.ah===e.ah&&Nf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var jl,xl=(n(Ml,jl=me),Ml.prototype.nh=function(t){return new $c(t)},Ml.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Wl(this.firestore,null,t)},Ml);function Ml(t){var e=this;return(e=jl.call(this)||this).firestore=t,e}function ql(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Vc(t.firestore,Nl),s=Of(o);return e instanceof ac&&(e=e.va),Gl(o,("string"==typeof e||e instanceof Al?Mf(s,"updateDoc",t.lh,e,n,r):xf(s,"updateDoc",t.lh,e)).Ph(t.lh,ws.exists(!0)))}function Fl(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||na(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};na(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Wl?(s=Vc(e.firestore,Nl),u=nu(e.lh.path),c={next:function(t){n[o]&&n[o](Bl(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Vc(e.firestore,Nl),u=e.Rh,h=new xl(s),c={next:function(t){n[o]&&n[o](new _l(s,h,e,t))},error:n[o+1],complete:n[o+2]},yf(e.Rh));var f=Ap(s),p=new uc(c),d=new ph(u,p,l);return s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ch,[4,ap(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=lh,[4,ap(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Gl(t,e){return function(n,r){var t=this,i=new $u;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ph,[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ap(t),e)}function Bl(t,e,n){var r=n.docs.get(e.lh),i=new xl(t);return new Sl(t,i,e.lh,r,new Wp(n.hasPendingWrites,n.fromCache),e.fh)}var Wl=(Object.defineProperty(Xl.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"parent",{get:function(){return new gf(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),Xl.prototype.withConverter=function(t){return new Xl(this.firestore,t,this.lh)},Xl),zl=(Hl.prototype.withConverter=function(t){return new Hl(this.firestore,t,this.Rh)},Hl);function Hl(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function Xl(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function Yl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Vh(t);return t}var Kl,$l,Ql,Jl,Zl,tf=(n(cf,Zl=l=function(){}),cf.prototype.Vh=function(t){var e=Of(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){pf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(ff(n,t,h))}c={arrayValue:{values:s}}}else c=ff(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||pf(o,i),c=qf(e,"where",o,"in"===i||"not-in"===i);var c=gu.create(r,i,c);return function(t,e){if(e.Ie()){var n=su(t);if(null!==n&&!n.isEqual(e.field))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ou(t))&&df(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new zl(t.firestore,t.fh,(e=(t=t.Rh).filters.concat([e]),new Js(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},cf),ef=(n(hf,Jl=l),hf.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new zu(e,n);return e=r,null!==ou(n=t)||null!==(t=su(n))&&df(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new zl(t.firestore,t.fh,(e=(t=t.Rh).me.concat([e]),new Js(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},hf),nf=(n(af,Ql=l),af.prototype.Vh=function(t){return new zl(t.firestore,t.fh,cu(t.Rh,this.Sh,this.Dh))},af),rf=(n(uf,$l=l),uf.prototype.Vh=function(t){var e=lf(t,this.type,this.Nh,this.xh);return new zl(t.firestore,t.fh,(t=t.Rh,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},uf),of=(n(sf,Kl=l),sf.prototype.Vh=function(t){var e=lf(t,this.type,this.Nh,this.xh);return new zl(t.firestore,t.fh,(t=t.Rh,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},sf);function sf(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function uf(t,e,n){var r=this;return(r=$l.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function af(t,e,n){var r=this;return(r=Ql.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function hf(t,e){var n=this;return(n=Jl.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function cf(t,e,n){var r=this;return(r=Zl.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function lf(t,h,e,n){if(e[0]instanceof ac&&(e[0]=e[0].va),e[0]instanceof yl)return function(t,e,n,r){if(!n)throw new Cr(Vr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=au(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(To(e,n.key));else{var a=n.field(u.field);if(ho(a))throw new Cr(Vr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Y(),new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new ju(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=Of(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Cr(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!uu(t)&&-1!==h.indexOf("/"))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Zr.J(h));if(!ni.ot(c))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ni(c),u.push(To(e,c))}else h=qf(n,r,h),u.push(h)}return new ju(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function ff(t,e,n){if(n instanceof ac&&(n=n.va),"string"==typeof n){if(""===n)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!uu(e)&&-1!==n.indexOf("/"))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Zr.J(n)),!ni.ot(e))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return To(t,new ni(e))}if(n instanceof Wl)return To(t,n.lh);throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lc(n)+".")}function pf(t,e){if(!Array.isArray(t)||0===t.length)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function df(t,e,n){if(!n.isEqual(e))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function yf(t){if(iu(t)&&0===t.me.length)throw new Cr(Vr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vf,gf=(n(mf,vf=zl),Object.defineProperty(mf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new Wl(this.firestore,null,new ni(t))},enumerable:!1,configurable:!0}),mf.prototype.withConverter=function(t){return new mf(this.firestore,t,this.yh)},mf);function mf(t,e,n){var r=this;return(r=vf.call(this,t,e,nu(n))||this).firestore=t,r.yh=n,r.type="collection",r}function wf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(kc("collection","path",e),t instanceof Zc){var i=Zr.J.apply(Zr,s([e],n));return _c(i),new gf(t,null,i)}if(!(t instanceof Wl||t instanceof gf))throw new Cr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _c(e=Zr.J.apply(Zr,s([t.path],n)).child(Zr.J(e))),new gf(t.firestore,null,e)}function bf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=zr.S()),kc("doc","path",e),t instanceof Zc){var i=Zr.J.apply(Zr,s([e],n));return Pc(i),new Wl(t,null,new ni(i))}if(!(t instanceof Wl||t instanceof gf))throw new Cr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Pc(e=t.yh.child(Zr.J.apply(Zr,s([e],n)))),new Wl(t.firestore,t instanceof gf?t.fh:null,new ni(e))}var Ef,Tf=(n(If,Ef=me),If.prototype.nh=function(t){return new $c(t)},If.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Wl(this.firestore,null,t)},If);function If(t){var e=this;return(e=Ef.call(this)||this).firestore=t,e}function Af(t,e){return(t instanceof Wl||t instanceof gf)&&(e instanceof Wl||e instanceof gf)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function Nf(t,e){return t instanceof zl&&e instanceof zl&&t.firestore===e.firestore&&lu(t.Rh,e.Rh)&&t.fh===e.fh}function Of(t){var e=t.Ya(),n=ea(t.Ba);return new Vf(t.Ba,!!e.ignoreUndefinedProperties,n)}var Rf=/^__.*__$/,kf=(Pf.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new ks(t,this.data,this.ee,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ls(t,this.fieldTransforms)),n},Pf),Df=(Sf.prototype.Ph=function(t,e){return e=[new ks(t,this.data,this.ee,e)],0<this.fieldTransforms.length&&e.push(new Ls(t,this.fieldTransforms)),e},Sf);function Sf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Pf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function _f(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Sr()}}var Lf=(Object.defineProperty(Uf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Uf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Uf.prototype.Oh=function(t){return new Uf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Uf.prototype.$h=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Oh({path:e,xa:!1})).Lh(t),e},Uf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Oh({path:t,xa:!1})).Fh(),t},Uf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Uf.prototype.Da=function(t){return Yf(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Uf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Uf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lh(this.path.get(t))},Uf.prototype.Lh=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(_f(this.Sa)&&Rf.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Uf),Vf=(Cf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Lf({Sa:t,methodName:e,Na:n,path:ei.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Cf);function Cf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ea(t)}function Uf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function jf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);Wf("Data must be an object, but it was:",s,r);var u,a,r=Gf(r,s);if(o.merge)u=new vs(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=zf(e,l[c],n);if(!s.contains(f))throw new Cr(Vr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Kf(h,f)||h.push(f)}u=new vs(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new kf(new qs(r),u,a)}function xf(t,r,i,e){var o=t.qh(1,r,i);Wf("Data must be an object, but it was:",o,e);var s=[],u=new Fs;return uo(e,function(t,e){var n=Xf(r,t,i);e instanceof ac&&(e=e.va),t=o.kh(n),e instanceof xc?s.push(n):null!=(t=Ff(e,t))&&(s.push(n),u.set(n,t))}),e=new vs(s),new Df(u.he(),e,o.fieldTransforms)}function Mf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[zf(e,r,n)],a=[i];if(o.length%2!=0)throw new Cr(Vr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(zf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Fs,y=u.length-1;0<=y;--y)Kf(p,u[y])||(c=u[y],(l=a[y])instanceof ac&&(l=l.va),f=s.kh(c),l instanceof xc?p.push(c):null!=(f=Ff(l,f))&&(p.push(c),d.set(c,f)));return i=new vs(p),new Df(d.he(),i,s.fieldTransforms)}function qf(t,e,n,r){return void 0===r&&(r=!1),Ff(n,t.qh(r?4:3,e))}function Ff(s,t){if(s instanceof ac&&(s=s.va),Bf(s))return Wf("Unsupported field value:",t,s),Gf(s,t);if(s instanceof jc)return function(t,e){if(!_f(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");(t=t.Ca(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ff(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof ac&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Lo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Qr.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Qr){var r=new Qr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof Kc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof $c)return{bytesValue:Co(e.serializer,t.ka)};if(t instanceof Wl){if(n=e.t,!(r=t.firestore.Ba).isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Lc(t))}(s,t)}function Gf(t,n){var r={};return ao(t)?n.path&&0<n.path.length&&n.ee.push(n.path):uo(t,function(t,e){null!=(e=Ff(e,n.$h(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Bf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof Kc||t instanceof $c||t instanceof Wl||t instanceof jc)}function Wf(t,e,n){if(!Bf(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Lc(n))?e.Da(t+" a custom object"):e.Da(t+" "+n);var r}function zf(t,e,n){if(e instanceof ac&&(e=e.va),e instanceof Al)return e.dh;if("string"==typeof e)return Xf(t,e);throw Yf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Hf=new RegExp("[~\\*/\\[\\]]");function Xf(e,n,r){if(0<=n.search(Hf))throw Yf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Al.bind.apply(Al,s([void 0],n.split("."))))).dh}catch(t){throw Yf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Yf(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Cr(Vr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Kf(t,e){return t.some(function(t){return t.isEqual(e)})}var $f=(ep.prototype.Gh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Cr(Vr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Go((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Mo(r.serializer,t)})},[4,r.Fr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=qo(t,e.found.name),t=Uo(e.found.updateTime),e=new qs({mapValue:{fields:e.found.fields}});return new Ks(n,t,e,{})}(n,t):"missing"in t?(e=n,Pr(!!(n=t).missing),Pr(!!n.readTime),e=qo(e,n.missing),n=Uo(n.readTime),new $s(e,n)):Sr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Pr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Ks?n.zh(t):Sr()}),e)]}})})},ep.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},ep.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},ep.prototype.delete=function(t){this.write([new xs(t,this.re(t))]),this.Wh.add(t.toString())},ep.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ni.st(e),n.mutations.push(new Ms(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Go((e=i).serializer)+"/documents",r={writes:o.map(function(t){return zo(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},ep.prototype.zh=function(t){var e;if(t instanceof Ks)e=t.version;else{if(!(t instanceof $s))throw Sr();e=Jr.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Cr(Vr.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},ep.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?ws.updateTime(e):ws.ce()},ep.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return ws.exists(!0);if(e.isEqual(Jr.min()))throw new Cr(Vr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(e)},ep.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},ep.prototype.Kh=function(){},ep),Qf=(tp.prototype.run=function(){this.Jh()},tp.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new $f(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},tp.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},tp.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},tp.prototype.tl=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ti(t))},tp),Jf=(Zf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},Zf.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},Zf.prototype.sl=function(){if(this.Ns.Hs)throw new Cr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},Zf.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new $u;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=ga(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Zf);function Zf(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=br.UNAUTHENTICATED,this.clientId=zr.S(),this.nl=function(){},this.V=new $u,this.credentials.I(function(t){Or("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function tp(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new ha(this.Ns,"transaction_retry")}function ep(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function np(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Or("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Or("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ra(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new oc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function rp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Or("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,np(r)];case 1:return e=t.sent(),Or("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Or("RemoteStore","RemoteStore received new credentials"),n=Za(e),e.Hr.add(3),[4,Ha(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,za(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new sc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function ip(t){return np(t).then(function(t){return t.persistence})}function op(t){return np(t).then(function(t){return t.jr})}function sp(t){return rp(t).then(function(t){return t.Au})}function up(t){return rp(t).then(function(t){return t.Pa})}function ap(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=_h.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t;if((t=n.bu.get(e))&&t.Tu)return Mi().add(t.key);var r=Mi();if(!(e=n.pu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Vu.get(s),r=r.Kt(s.view.ou);return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ai(ni.k)).Tt(n,new $s(n,Jr.min())),i=Mi().add(n),i=new Wi(Jr.min(),new Map,new Pi(Xr),r,i),[4,_h(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),qh(e),[3,4];case 2:return[4,Da(e.jr,s,!1).then(function(){return jh(e,s,u)}).catch(Pa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&fh(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=hu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,Ku.resolve(n)):i.Ri.$u(e).next(function(t){return n=new bi(r,t,0,e.Bi),i.Ri.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Sa(r.jr,i.query,!1).then(function(t){return t=t.documents,i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(Mh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Sa(i.jr,o,!0)];case 1:return n=t.sent(),r=new bh(o,n.Ji),e=r.uu(n.documents),n=zi.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),Mh(i,s,n.du),r=new Eh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&Xa(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.Pa),n.fo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!lu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Da(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),Ya(e.Au,n.targetId),jh(e,n.targetId)}).catch(Pa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return jh(e,n.targetId),[4,Da(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function hp(n,r,i,o,s){var t=new uc({next:function(t){r.Ms(function(){return lh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Cr(Vr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Cr(Vr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ph(nu(i.path),t,{includeMetadataChanges:!0,Ro:!0});return ch(n,u)}function cp(e,n,t,r,i){var o=new uc({next:function(t){n.Ms(function(){return lh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Cr(Vr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ph(t,o,{includeMetadataChanges:!0,Ro:!0});return ch(e,s)}var lp=(fp.prototype.set=function(t,e,n){return this.hl(),e=od((t=pp(t,this.ah)).fh,e,n),n=jf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n),this.ul=this.ul.concat(n.Ph(t.lh,ws.ce())),this},fp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.hl(),t=pp(t,this.ah),e instanceof ac&&(e=e.va),e="string"==typeof e||e instanceof Al?Mf(this.al,"WriteBatch.update",t.lh,e,n,r):xf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,ws.exists(!0))),this},fp.prototype.delete=function(t){return this.hl(),t=pp(t,this.ah),this.ul=this.ul.concat(new xs(t.lh,ws.ce())),this},fp.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},fp.prototype.hl=function(){if(this.cl)throw new Cr(Vr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},fp);function fp(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=Of(t)}function pp(t,e){if(t instanceof ac&&(t=t.va),t.firestore!==e)throw new Cr(Vr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var dp,yp,vp=(Ip.prototype.get=function(t){var e=this,n=pp(t,this.ah),r=new Tf(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return Sr();if((t=t[0])instanceof $s)return new yl(e.ah,r,n.lh,null,n.fh);if(t instanceof Ks)return new yl(e.ah,r,t.key,t,n.fh);throw Sr()})},Ip.prototype.set=function(t,e,n){return e=od((t=pp(t,this.ah)).fh,e,n),n=jf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n),this.ll.set(t.lh,n),this},Ip.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=pp(t,this.ah),e instanceof ac&&(e=e.va),e="string"==typeof e||e instanceof Al?Mf(this.al,"Transaction.update",t.lh,e,n,r):xf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},Ip.prototype.delete=function(t){return t=pp(t,this.ah),this.ll.delete(t.lh),this},n(Tp,yp=Ip),Tp.prototype.get=function(t){var e=this,n=pp(t,this.ah),r=new xl(this.ah);return yp.prototype.get.call(this,t).then(function(t){return new Sl(e.ah,r,n.lh,t._h,new Wp(!1,!1),n.fh)})},Tp),gp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",mp=(Ep.prototype.enableIndexedDbPersistence=function(t,e){throw new Cr(Vr.FAILED_PRECONDITION,gp)},Ep.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Cr(Vr.FAILED_PRECONDITION,gp)},Ep.prototype.clearIndexedDbPersistence=function(t){throw new Cr(Vr.FAILED_PRECONDITION,gp)},Ep),wp=(n(bp,dp=ac),Object.defineProperty(bp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),bp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},bp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},bp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ip(r)];case 1:return e=t.sent(),[4,sp(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),za(t))]}})})})}(Ap(this.va))},bp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ip(r)];case 1:return e=t.sent(),[4,sp(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,Ha(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Ap(this.va))},bp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Sc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},bp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},bp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},bp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new $u;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Vh,[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ap(this.va))},bp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Ap(t),e=na(e)?e:{next:e},i=new uc(e);return t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,ap(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,ap(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(bp.prototype,"app",{get:function(){if(!this.fl)throw new Cr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),bp.prototype.collection=function(t){try{return new $p(this,wf(this.va,t))}catch(t){throw Cp(t,"collection()","Firestore.collection()")}},bp.prototype.doc=function(t){try{return new Pp(this,bf(this.va,t))}catch(t){throw Cp(t,"doc()","Firestore.doc()")}},bp.prototype.collectionGroup=function(t){try{return new Xp(this,function(t,e){if(kc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Cr(Vr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new zl(t,null,new Js(Zr.X(),e))}(this.va,t))}catch(t){throw Cp(t,"collectionGroup()","Firestore.collectionGroup()")}},bp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new $u;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,rp(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new Qf(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Ap(n=this.va),function(t){return t=new vp(n,t),e(new Dp(r,t))})},bp.prototype.batch=function(){var e=this;return Ap(this.va),new Sp(new lp(this.va,function(t){return Gl(e.va,t)}))},bp);function bp(t,e,n){var r=this;return(r=dp.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof wr||(r.fl=t),r}function Ep(){}function Tp(t,e){var n=this;return(n=yp.call(this,t,e)||this).ah=t,n}function Ip(t,e){this.ah=t,this.ll=e,this.al=Of(t)}function Ap(t){return t.Eh||Np(t),t.Eh.sl(),t.Eh}function Np(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new mr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new Jf(t.Qa,t.wh,r)}var Op,Rp,kp,Dp=(n(Vp,kp=ac),Vp.prototype.get=function(t){var e=this,t=id(t);return this.va.get(t).then(function(t){return new zp(e.ah,t)})},Vp.prototype.set=function(t,e,n){return t=id(t),n?(Dc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Vp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=id(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Vp.prototype.delete=function(t){return t=id(t),this.va.delete(t),this},Vp),Sp=(n(Lp,Rp=ac),Lp.prototype.set=function(t,e,n){return t=id(t),n?(Dc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Lp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=id(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Lp.prototype.delete=function(t){return t=id(t),this.va.delete(t),this},Lp.prototype.commit=function(){return this.va.commit()},Lp),Pp=(n(_p,Op=ac),_p.dl=function(t,e,n){if(t.length%2!=0)throw new Cr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new _p(e,new Wl(e.va,n,new ni(t)))},_p.uh=function(t,e,n){return new _p(e,new Wl(e.va,n,t))},Object.defineProperty(_p.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(_p.prototype,"parent",{get:function(){return new $p(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(_p.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),_p.prototype.collection=function(t){try{return new $p(this.firestore,wf(this.va,t))}catch(t){throw Cp(t,"collection()","DocumentReference.collection()")}},_p.prototype.isEqual=function(t){return t instanceof ac&&(t=t.va),t instanceof Wl&&Af(this.va,t)},_p.prototype.set=function(t,e){e=Dc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Vc(n.firestore,Nl),r=od(n.fh,r,i),Gl(o,jf(Of(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,ws.ce()))}catch(t){throw Cp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},_p.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ql(this.va,t):ql.apply(void 0,s([this.va,t,e],n))}catch(t){throw Cp(t,"updateDoc()","DocumentReference.update()")}},_p.prototype.delete=function(){return Gl(Vc((t=this.va).firestore,Nl),[new xs(t.lh,ws.ce())]);var t},_p.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Up(t),i=jp(t,function(t){return new zp(e.firestore,new Sl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return Fl(this.va,r,i)},_p.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new xl(n),o=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof Ks?s.resolve(r):r instanceof $s?s.resolve(null):s.reject(new Cr(Vr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=ga(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e.lh,t,new Wp(t instanceof Ks&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap(r)];case 1:return[4,hp(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Bl(n,e,t)})}:function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap(r)];case 1:return[4,hp(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Bl(n,e,t)})})(this.va).then(function(t){return new zp(e.firestore,new Sl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},_p.prototype.withConverter=function(t){return new _p(this.firestore,this.va.withConverter(t))},_p);function _p(t,e){var n=this;return(n=Op.call(this,e)||this).firestore=t,n.hh=new dl(t),n}function Lp(){return null!==Rp&&Rp.apply(this,arguments)||this}function Vp(t,e){var n=this;return(n=kp.call(this,e)||this).ah=t,n}function Cp(t,e,n){return t.message=t.message.replace(e,n),t}function Up(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!na(r))return r}return{}}function jp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=na(t[0])?t[0]:na(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var xp,Mp,qp,Fp,Gp,Bp,Wp=(rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},rd),zp=(n(nd,Bp=ac),Object.defineProperty(nd.prototype,"ref",{get:function(){return new Pp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),nd.prototype.data=function(t){return this.va.data(t)},nd.prototype.get=function(t,e){return this.va.get(t,e)},nd.prototype.isEqual=function(t){return Ul(this.va,t.va)},nd),Hp=(n(ed,Gp=zp),ed.prototype.data=function(t){return this.va.data(t)},ed),Xp=(n(td,Fp=ac),td.prototype.where=function(t,e,n){try{return new td(this.firestore,Yl(this.va,(r=n,i=e,o=Tl("where",t),new tf(o,i,r))))}catch(t){throw Cp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},td.prototype.orderBy=function(n,t){try{return new td(this.firestore,Yl(this.va,function(t){void 0===t&&(t="asc");var e=t,t=Tl("orderBy",n);return new ef(t,e)}(t)))}catch(n){throw Cp(n,/(orderBy|where)\(\)/,"Query.$1()")}},td.prototype.limit=function(t){try{return new td(this.firestore,Yl(this.va,(Cc("limit",e=t),new nf("limit",e,"F"))))}catch(t){throw Cp(t,"limit()","Query.limit()")}var e},td.prototype.limitToLast=function(t){try{return new td(this.firestore,Yl(this.va,(Cc("limitToLast",e=t),new nf("limitToLast",e,"L"))))}catch(t){throw Cp(t,"limitToLast()","Query.limitToLast()")}var e},td.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new td(this.firestore,Yl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Cp(t,"startAt()","Query.startAt()")}},td.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new td(this.firestore,Yl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Cp(t,"startAfter()","Query.startAfter()")}},td.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new td(this.firestore,Yl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new of("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Cp(t,"endBefore()","Query.endBefore()")}},td.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new td(this.firestore,Yl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new of("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Cp(t,"endAt()","Query.endAt()")}},td.prototype.isEqual=function(t){return Nf(this.va,t.va)},td.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new xl(n),o=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Sa(r,i,!0)];case 1:return n=t.sent(),e=new bh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=ga(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new _l(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new xl(n),o=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap(r)];case 1:return[4,cp(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new _l(n,i,e,t)})}:function(e){var t=this,n=Vc(e.firestore,Nl),r=Ap(n),i=new xl(n);yf(e.Rh);var o=new $u;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap(r)];case 1:return[4,cp(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new _l(n,i,e,t)})})(this.va).then(function(t){return new Kp(e.firestore,t)})},td.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Up(t),i=jp(t,function(t){return new Kp(e.firestore,t)});return Fl(this.va,r,i)},td.prototype.withConverter=function(t){return new td(this.firestore,this.va.withConverter(t))},td),Yp=(n(Zp,qp=ac),Object.defineProperty(Zp.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"doc",{get:function(){return new Hp(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),Zp),Kp=(n(Jp,Mp=ac),Object.defineProperty(Jp.prototype,"query",{get:function(){return new Xp(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new Hp(e.ah,t)})},enumerable:!1,configurable:!0}),Jp.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new Yp(e.ah,t)})},Jp.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new Hp(r.ah,t))})},Jp.prototype.isEqual=function(t){return Ul(this.va,t.va)},Jp),$p=(n(Qp,xp=Xp),Object.defineProperty(Qp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Pp(this.firestore,t):null},enumerable:!1,configurable:!0}),Qp.prototype.doc=function(t){try{return new Pp(this.firestore,void 0===t?bf(this.va):bf(this.va,t))}catch(t){throw Cp(t,"doc()","CollectionReference.doc()")}},Qp.prototype.add=function(t){var e,n=this,r=this.va,i=t;return t=Vc(r.firestore,Nl),e=bf(r),i=od(r.fh,i),Gl(t,jf(Of(r.firestore),"addDoc",e.lh,i,null!==r.fh,{}).Ph(e.lh,ws.exists(!1))).then(function(){return e}).then(function(t){return new Pp(n.firestore,t)})},Qp.prototype.isEqual=function(t){return Af(this.va,t.va)},Qp.prototype.withConverter=function(t){return new Qp(this.firestore,this.va.withConverter(t))},Qp);function Qp(t,e){var n=this;return(n=xp.call(this,t,e)||this).firestore=t,n.va=e,n}function Jp(t,e){var n=this;return(n=Mp.call(this,e)||this).ah=t,n}function Zp(t,e){var n=this;return(n=qp.call(this,e)||this).ah=t,n}function td(t,e){var n=this;return(n=Fp.call(this,e)||this).firestore=t,n}function ed(){return null!==Gp&&Gp.apply(this,arguments)||this}function nd(t,e){var n=this;return(n=Bp.call(this,e)||this).ah=t,n}function rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function id(t){return t instanceof ac&&(t=t.va),Vc(t,Wl)}function od(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var sd,ud,l=(n(hd,ud=ac),hd.documentId=function(){return new hd(ei.nt().Y())},hd.prototype.isEqual=function(t){return t instanceof ac&&(t=t.va),t instanceof Al&&this.va.dh.isEqual(t.dh)},hd),me=(n(ad,sd=ac),ad.serverTimestamp=function(){var t=new zc("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new ad(t)},ad.delete=function(){var t=new xc("deleteField");return t.ba="FieldValue.delete",new ad(t)},ad.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hc("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new ad(n)},ad.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xc("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new ad(n)},ad.increment=function(t){return(t=new Yc("increment",t)).ba="FieldValue.increment",new ad(t)},ad.prototype.isEqual=function(t){return this.va.isEqual(t.va)},ad),me={Firestore:wp,GeoPoint:Kc,Timestamp:Qr,Blob:pl,Transaction:Dp,WriteBatch:Sp,DocumentReference:Pp,DocumentSnapshot:zp,Query:Xp,QueryDocumentSnapshot:Hp,QuerySnapshot:Kp,CollectionReference:$p,FieldPath:l,FieldValue:me,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function ad(){return null!==sd&&sd.apply(this,arguments)||this}function hd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ud.call(this,new(Al.bind.apply(Al,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new wp(e,new Nl(e,t),new mp);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.4-2020102005919")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});