!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ud){"use strict";try{(function(){var u,t,e=(t=ud)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function R(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var S="closure_uid_"+(1e9*Math.random()>>>0),P=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function x(){this.j=this.j,this.i=this.i}x.prototype.j=!1,x.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,S)&&this[S]||(this[S]=++P))},x.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=O.navigator;function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(Y=Y&&Y.userAgent)?Y:"";var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<J.length;i++)e=J[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=R;var tt,et=H(at,"Opera"),nt=H(at,"Trident")||H(at,"MSIE"),rt=H(at,"Edge"),it=rt||nt,ot=H(at,"Gecko")&&!(H(at.toLowerCase(),"webkit")&&!H(at,"Edge"))&&!(H(at,"Trident")||H(at,"MSIE"))&&!H(at,"Edge"),st=H(at.toLowerCase(),"webkit")&&!H(at,"Edge");function ut(){var t=O.document;return t?t.documentMode:void 0}var Y="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(Y=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(Y)?String(at):Y;var ht={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String(tt)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ht,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=O.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ct("9"),dt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",R,e),O.removeEventListener("test",R,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},M(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Tt(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Tt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[mt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[mt]?t.va(e,n,D(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,h=_t(t);if(h||(t[Nt]=h=new Tt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_t(e))?(It(n,t),0==n.b&&(n.src=null,e[Nt]=null)):Et(t)))}function Dt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function St(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(ft)return St(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return St(t,e=new vt(e,this))}function _t(t){return(t=t[Nt])instanceof Tt?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==L(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ut(){x.call(this),this.c=new Tt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,$(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Ut,x),Ut.prototype[mt]=!0,(at=Ut.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Ct(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&_t(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&kt(r))}(this,t,e,n,r)},at.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=O.JSON.stringify;function qt(){this.b=this.a=null}var Ft,Gt=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Wt},function(t){t.reset()},100));function Bt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function zt(t,e){var n;Ft||(n=O.Promise.resolve(void 0),Ft=function(){n.then(Yt)}),Ht||(Ft(),Ht=!0),Xt.add(t,e)}qt.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new qt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Gt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Kt(t,e){Ut.call(this),this.b=t||1,this.a=e||O,this.f=C(this.Xa,this),this.g=j()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Jt(t,e,n){if("function"==L(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}M(Kt,Ut),(at=Kt.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(Qt(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},at.G=function(){Kt.X.G.call(this),Qt(this),delete this.a};var $t,Zt,te=(I(Zt=ne,Y=$t=x),Zt.prototype=null===Y?Object.create(Y):(ee.prototype=Y.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Jt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){$t.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Zt}function ne(t,e,n){var r=$t.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){x.call(this),this.b=t,this.a={}}M(re,x);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return xt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var he=null;function ce(){return he=he||new Ut}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=ce();jt(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=ce();jt(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}M(le,yt),M(pe,yt),M(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Ie(){yt.call(this,"d")}function Ae(){yt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=Re,t=it?125:void 0,this.R=new Kt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ie,yt),M(Ae,yt),M(Ne,we),Te=new Ne;var Re=45e3,Le={},ke={};function De(t,e,n){t.H=1,t.i=Je(ze(e)),t.j=n,t.I=!0,Se(t,null)}function Se(t,e){t.u=j(),_e(t),t.l=ze(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(C(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?Q(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?ke:(i=Number(u.substring(i,o)),isNaN(i)?Le:(o+=1)+i>u.length?ke:(u=u.substr(o,i),r.D=o+i,u)));if(u==ke){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==Le){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qn(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Ue(t))}function _e(t){t.T=j()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Ta,t),e)}function Ce(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function je(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Kn(u),de()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Qe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),_e(o)),n.a=i):Yn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=Oe.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),je(this),Ue(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(Pe(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),Me(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,_e(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),je(this),Ue(this)}}}catch(t){}var u,a,h,c,l,f},at.Ua=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Pe(this,t,e),this.b&&4!=t&&_e(this)))},at.cancel=function(){this.A=!0,je(this)},at.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),je(this),this.h=2,Ue(this)):Ve(this,this.T-n)},(at=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return Fe(this),this.a.concat()},at.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},at.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,He(this,n[1]||"",!0),this.j=$e(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=$e(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new We(t)}function He(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?$e(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Qe(t,e,n){t.b.set(e,n)}function Je(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),B(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=G(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){Ut.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}M(On,Ut);var Rn="",Ln=/^https?$/i,kn=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Vn(t)}function Pn(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function _n(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Jt(t.za,0,t);else if(jt(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Ln.test(i?i.toLowerCase():"")),e=n),e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Qe(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function xn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Pa=Mn("retryDelaySeedMs",1e4,t),this.Ka=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,Qe(n=ze(t.B),"SID",t.J),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Hn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Je(ze(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=j(),_e(e)),nr(t)}function Fn(t){t.a&&(Qn(t),t.a.cancel(),t.a=null)}function Gn(t){Fn(t),t.j&&(O.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&Wn(t)}function Wn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);Qe(r,"SID",t.J),Qe(r,"RID",n),Qe(r,"AID",t.P),Hn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),De(n,r,e)}function Hn(t,n){t.f&&xe({},function(t,e){Qe(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{xe(t,function(t,e){var n=t;D(t)&&(n=xt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Qn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);Qe(e,"RID","rpc"),Qe(e,"SID",t.J),Qe(e,"CI",t.H?"0":"1"),Qe(e,"AID",t.P),Hn(t,e),Qe(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(ze(e)),n.j=null,n.I=!0,Se(n,t)}function $n(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Qn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=j()-e.u,n=t.u,jt(s=ce(),new ye(s)),Wn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Kn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Wa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||He(r,"https"),Je(r)),n=r.toString(),r=o,o=new ue,O.Image?((i=new Image).onload=U(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(An,o,i,"TestLoadImage: error",!1,r),i.onabort=U(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?ze(s):new We(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),Ye(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&He(u,r),i&&Xe(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&K(t.V,function(t,e){Qe(a,e,t)}),e=t.A,n=t.na,e&&n&&Qe(a,e,n),Qe(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ut.call(this),this.a=new xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(at=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Dn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,nt&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Jt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Vn(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?_n(this):this.Sa())},at.Sa=function(){_n(this)},at.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=xn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=Q(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Qe(i=ze(this.B),"RID",t),Qe(i,"CVER",22),this.A&&Qe(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&jn(i,this.i,r),wn(this.b,n),this.Ga&&Qe(i,"TYPE","init"),this.da?(Qe(i,"$req",e),Qe(i,"SID","null"),n.U=!0,De(n,i,null)):De(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},at.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),Fn(this),Jn(this))},at.Qa=function(){null!=this.m&&(this.m=null,Fn(this),Kn(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Ut),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Wn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=xt(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ie),M(hr,Ae),M(cr,or),cr.prototype.ta=function(){jt(this.a,"a")},cr.prototype.sa=function(t){jt(this.a,new ar(t))},cr.prototype.ra=function(t){jt(this.a,new hr)},cr.prototype.qa=function(){jt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Oa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ge,fr=me,pr=Ee,dr=On,ge=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},gr=(Object.defineProperty(br.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),br.prototype.isEqual=function(t){return t instanceof br&&t.projectId===this.projectId&&t.database===this.database},br),mr=(wr.prototype.u=function(){return null!=this.uid},wr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},wr.prototype.isEqual=function(t){return t.uid===this.uid},wr);function wr(t){this.uid=t}function br(t,e){this.projectId=t,this.database=e||"(default)"}mr.UNAUTHENTICATED=new mr(null),mr.l=new mr("google-credentials-uid"),mr._=new mr("first-party-uid");var Er=new l("@firebase/firestore");function Tr(){return Er.logLevel}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.DEBUG&&(e=n.map(Or),Er.debug.apply(Er,s(["Firestore (8.1.0): "+t],e)))}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.ERROR&&(e=n.map(Or),Er.error.apply(Er,s(["Firestore (8.1.0): "+t],e)))}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.WARN&&(e=n.map(Or),Er.warn.apply(Er,s(["Firestore (8.1.0): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){throw void 0===t&&(t="Unexpected state"),Ar(t="FIRESTORE (8.1.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Lr(t){t||Rr()}function kr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Dr,Sr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Pr=(n(Fr,Dr=Error),Fr),_r=(qr.prototype.getToken=function(){return Promise.resolve(null)},qr.prototype.A=function(){},qr.prototype.I=function(t){(this.T=t)(mr.UNAUTHENTICATED)},qr.prototype.R=function(){this.T=null},qr),Vr=(xr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Ir("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new kr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},xr.prototype.A=function(){this.forceRefresh=!0},xr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},xr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},xr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new mr(t)},xr),Cr=(Object.defineProperty(Mr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Mr),Ur=(jr.prototype.getToken=function(){return Promise.resolve(new Cr(this.v,this.C))},jr.prototype.I=function(t){t(mr._)},jr.prototype.R=function(){},jr.prototype.A=function(){},jr);function jr(t,e){this.v=t,this.C=e}function Mr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=mr._}function xr(t){var e=this;this.P=null,this.currentUser=mr.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function qr(){this.T=null}function Fr(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Gr=(Br.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Br);function Br(){}function Wr(t,e){return t<e?-1:e<t?1:0}function zr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Hr,Xr,Yr=(oi.now=function(){return oi.fromMillis(Date.now())},oi.fromDate=function(t){return oi.fromMillis(t.getTime())},oi.fromMillis=function(t){var e=Math.floor(t/1e3);return new oi(e,1e6*(t-1e3*e))},oi.prototype.toDate=function(){return new Date(this.toMillis())},oi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},oi.prototype.D=function(t){return this.seconds===t.seconds?Wr(this.nanoseconds,t.nanoseconds):Wr(this.seconds,t.seconds)},oi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},oi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},oi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},oi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},oi),Kr=(ii.N=function(t){return new ii(t)},ii.min=function(){return new ii(new Yr(0,0))},ii.prototype.F=function(t){return this.timestamp.D(t.timestamp)},ii.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ii.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ii.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ii.prototype.L=function(){return this.timestamp},ii),me=(Object.defineProperty(ri.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),ri.prototype.isEqual=function(t){return 0===ri.k(this,t)},ri.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ri?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},ri.prototype.limit=function(){return this.offset+this.length},ri.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},ri.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},ri.prototype.B=function(){return this.segments[this.offset]},ri.prototype.j=function(){return this.get(this.length-1)},ri.prototype.get=function(t){return this.segments[this.offset+t]},ri.prototype.W=function(){return 0===this.length},ri.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ri.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ri.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ri.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},ri.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ri),Qr=(n(ni,Xr=me),ni.prototype.M=function(t,e,n){return new ni(t,e,n)},ni.prototype.Y=function(){return this.H().join("/")},ni.prototype.toString=function(){return this.Y()},ni.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ni(n)},ni.X=function(){return new ni([])},ni),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$r=(n(ei,Hr=me),ei.prototype.M=function(t,e,n){return new ei(t,e,n)},ei.Z=function(t){return Jr.test(t)},ei.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ei.Z(t)||(t="`"+t+"`"),t}).join(".")},ei.prototype.toString=function(){return this.Y()},ei.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ei.nt=function(){return new ei(["__name__"])},ei.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Pr(Sr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Pr(Sr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Pr(Sr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ei(e)},ei.X=function(){return new ei([])},ei),Zr=(ti.st=function(t){return new ti(Qr.J(t))},ti.it=function(t){return new ti(Qr.J(t).U(5))},ti.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ti.prototype.isEqual=function(t){return null!==t&&0===Qr.k(this.path,t.path)},ti.prototype.toString=function(){return this.path.toString()},ti.k=function(t,e){return Qr.k(t.path,e.path)},ti.ot=function(t){return t.length%2==0},ti.ut=function(t){return new ti(new Qr(t.slice()))},ti);function ti(t){this.path=t}function ei(){return null!==Hr&&Hr.apply(this,arguments)||this}function ni(){return null!==Xr&&Xr.apply(this,arguments)||this}function ri(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.$=n}function ii(t){this.timestamp=t}function oi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Pr(Sr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Pr(Sr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Pr(Sr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Pr(Sr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function si(t){return null==t}function ui(t){return 0===t&&1/t==-1/0}var ai=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function hi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ai(t,e,n,r,i,o,s)}function ci(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Y()+t.op.toString()+yo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Y()+t.dir}).join(","),si(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=xu(e.startAt)),e.endAt&&(t+="|ub:",t+=xu(e.endAt)),e.ct=t),e.ct}function li(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!co(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fu(t.startAt,e.startAt)&&Fu(t.endAt,e.endAt)}function fi(t){return Zr.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var pi=(di.fromBase64String=function(t){return new di(atob(t))},di.fromUint8Array=function(t){return new di(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},di.prototype.toBase64=function(){return t=this.at,btoa(t);var t},di.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},di.prototype.ht=function(){return 2*this.at.length},di.prototype.F=function(t){return Wr(this.at,t.at)},di.prototype.isEqual=function(t){return this.at===t.at},di);function di(t){this.at=t}function yi(t){this.count=t}pi.lt=new pi("");var vi,gi=(mi.prototype.dt=function(t){return new mi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},mi.prototype.wt=function(t,e){return new mi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},mi.prototype.Et=function(t){return new mi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},mi);function mi(t,e,n,r,i,o,s){void 0===i&&(i=Kr.min()),void 0===o&&(o=Kr.min()),void 0===s&&(s=pi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function wi(t){switch(t){case Sr.OK:return Rr(),0;case Sr.CANCELLED:case Sr.UNKNOWN:case Sr.DEADLINE_EXCEEDED:case Sr.RESOURCE_EXHAUSTED:case Sr.INTERNAL:case Sr.UNAVAILABLE:case Sr.UNAUTHENTICATED:return;case Sr.INVALID_ARGUMENT:case Sr.NOT_FOUND:case Sr.ALREADY_EXISTS:case Sr.PERMISSION_DENIED:case Sr.FAILED_PRECONDITION:case Sr.ABORTED:case Sr.OUT_OF_RANGE:case Sr.UNIMPLEMENTED:case Sr.DATA_LOSS:return 1;default:return Rr(),0}}function bi(t){if(void 0===t)return Ar("GRPC error has no .code"),Sr.UNKNOWN;switch(t){case vi.OK:return Sr.OK;case vi.CANCELLED:return Sr.CANCELLED;case vi.UNKNOWN:return Sr.UNKNOWN;case vi.DEADLINE_EXCEEDED:return Sr.DEADLINE_EXCEEDED;case vi.RESOURCE_EXHAUSTED:return Sr.RESOURCE_EXHAUSTED;case vi.INTERNAL:return Sr.INTERNAL;case vi.UNAVAILABLE:return Sr.UNAVAILABLE;case vi.UNAUTHENTICATED:return Sr.UNAUTHENTICATED;case vi.INVALID_ARGUMENT:return Sr.INVALID_ARGUMENT;case vi.NOT_FOUND:return Sr.NOT_FOUND;case vi.ALREADY_EXISTS:return Sr.ALREADY_EXISTS;case vi.PERMISSION_DENIED:return Sr.PERMISSION_DENIED;case vi.FAILED_PRECONDITION:return Sr.FAILED_PRECONDITION;case vi.ABORTED:return Sr.ABORTED;case vi.OUT_OF_RANGE:return Sr.OUT_OF_RANGE;case vi.UNIMPLEMENTED:return Sr.UNIMPLEMENTED;case vi.DATA_LOSS:return Sr.DATA_LOSS;default:return Rr()}}(l=vi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ei=(Oi.prototype.Tt=function(t,e){return new Oi(this.k,this.root.Tt(t,e,this.k).copy(null,null,Ii.At,null,null))},Oi.prototype.remove=function(t){return new Oi(this.k,this.root.remove(t,this.k).copy(null,null,Ii.At,null,null))},Oi.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Oi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Oi.prototype.W=function(){return this.root.W()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Oi.prototype.It=function(){return this.root.It()},Oi.prototype.Rt=function(){return this.root.Rt()},Oi.prototype.Pt=function(t){return this.root.Pt(t)},Oi.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Oi.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Oi.prototype.yt=function(t){return this.root.yt(t)},Oi.prototype.Vt=function(){return new Ti(this.root,null,this.k,!1)},Oi.prototype.gt=function(t){return new Ti(this.root,t,this.k,!1)},Oi.prototype.vt=function(){return new Ti(this.root,null,this.k,!0)},Oi.prototype.bt=function(t){return new Ti(this.root,t,this.k,!0)},Oi),Ti=(Ni.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Ni.prototype.Nt=function(){return 0<this.St.length},Ni.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Ni),Ii=(Ai.prototype.copy=function(t,e,n,r,i){return new Ai(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ai.prototype.W=function(){return!1},Ai.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Ai.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Ai.prototype.min=function(){return this.left.W()?this:this.left.min()},Ai.prototype.It=function(){return this.min().key},Ai.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Ai.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Ai.prototype.Ot=function(){if(this.left.W())return Ai.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Ai.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Ai.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Ai.prototype.Lt=function(){return this.color},Ai.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Ai.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Ai.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Ai.prototype.Ut=function(){var t=this.copy(null,null,Ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ai.prototype.kt=function(){var t=this.copy(null,null,Ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ai.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ai.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Ai.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw Rr();if(this.right.Lt())throw Rr();var t=this.left.Qt();if(t!==this.right.Qt())throw Rr();return t+(this.Lt()?0:1)},Ai);function Ai(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ai.RED,this.left=null!=r?r:Ai.EMPTY,this.right=null!=i?i:Ai.EMPTY,this.size=this.left.size+1+this.right.size}function Ni(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Oi(t,e){this.k=t,this.root=e||Ii.EMPTY}function Ri(){this.size=0}Ii.EMPTY=null,Ii.RED=!0,Ii.At=!1,Ii.EMPTY=(Object.defineProperty(Ri.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Ri.prototype.copy=function(t,e,n,r,i){return this},Ri.prototype.Tt=function(t,e,n){return new Ii(t,e)},Ri.prototype.remove=function(t,e){return this},Ri.prototype.W=function(){return!0},Ri.prototype.Pt=function(t){return!1},Ri.prototype.yt=function(t){return!1},Ri.prototype.It=function(){return null},Ri.prototype.Rt=function(){return null},Ri.prototype.Lt=function(){return!1},Ri.prototype.Bt=function(){return!0},Ri.prototype.Qt=function(){return 0},new Ri);var Li=(Pi.prototype.has=function(t){return null!==this.data.get(t)},Pi.prototype.first=function(){return this.data.It()},Pi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Pi.prototype.indexOf=function(t){return this.data.indexOf(t)},Pi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Pi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Pi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Pi.prototype.Gt=function(t){return(t=this.data.gt(t)).Nt()?t.Dt().key:null},Pi.prototype.Vt=function(){return new ki(this.data.Vt())},Pi.prototype.gt=function(t){return new ki(this.data.gt(t))},Pi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Pi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Pi.prototype.W=function(){return this.data.W()},Pi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Pi.prototype.isEqual=function(t){if(!(t instanceof Pi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Pi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Pi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Pi.prototype.copy=function(t){var e=new Pi(this.k);return e.data=t,e},Pi),ki=(Si.prototype.Dt=function(){return this.zt.Dt().key},Si.prototype.Nt=function(){return this.zt.Nt()},Si),Di=new Ei(Zr.k);function Si(t){this.zt=t}function Pi(t){this.k=t,this.data=new Ei(this.k)}var _i=new Ei(Zr.k),Vi=new Ei(Zr.k),Ci=new Li(Zr.k);function Ui(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ci,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ji=new Li(Wr),Mi=(to.Jt=function(t){return new to(t.k)},to.prototype.has=function(t){return null!=this.Ht.get(t)},to.prototype.get=function(t){return this.Ht.get(t)},to.prototype.first=function(){return this.Yt.It()},to.prototype.last=function(){return this.Yt.Rt()},to.prototype.W=function(){return this.Yt.W()},to.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Yt.indexOf(t):-1},Object.defineProperty(to.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),to.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},to.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},to.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},to.prototype.isEqual=function(t){if(!(t instanceof to))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},to.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},to.prototype.copy=function(t,e){var n=new to;return n.k=this.k,n.Ht=t,n.Yt=e,n},to),xi=(Zi.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Rr()},Zi.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},Zi),qi=($i.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new $i(t,e,Mi.Jt(e),i,n,r,!0,!1)},Object.defineProperty($i.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),$i.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&au(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},$i),Fi=(Ji.hn=function(t,e){var n=new Map;return n.set(t,Gi.ln(t,e)),new Ji(Kr.min(),n,ji,Di,Ui())},Ji),Gi=(Qi.ln=function(t,e){return new Qi(pi.lt,e,Ui(),Ui(),Ui())},Qi),Bi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Wi=function(t,e){this.targetId=t,this.Tn=e},zi=function(t,e,n,r){void 0===n&&(n=pi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Hi=(Object.defineProperty(Ki.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),Ki.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},Ki.prototype.vn=function(){var n=Ui(),r=Ui(),i=Ui();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Gi(this.Rn,this.Pn,n,r,i)},Ki.prototype.bn=function(){this.yn=!1,this.In=no()},Ki.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},Ki.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},Ki.prototype.Dn=function(){this.An+=1},Ki.prototype.Nn=function(){--this.An},Ki.prototype.xn=function(){this.yn=!0,this.Pn=!0},Ki),Xi=(Yi.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof Hs?this.Un(r,t.mn):t.mn instanceof Xs&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},Yi.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:Rr()}})},Yi.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},Yi.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.zn(e))&&(fi(t=t.target)?0===n?(t=new Zr(t.path),this.qn(e,t,new Xs(t,Kr.min()))):Lr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},Yi.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&fi(n.target)&&(n=new Zr(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new Xs(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Ui();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.zn(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Fi(r,o,this.kn,this.Ln,s);return this.Ln=Di,this.$n=eo(),this.kn=new Li(Wr),t},Yi.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},Yi.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},Yi.prototype.removeTarget=function(t){this.On.delete(t)},Yi.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},Yi.prototype.Dn=function(t){this.jn(t).Dn()},Yi.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Hi,this.On.set(t,e)),e},Yi.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new Li(Wr),this.$n=this.$n.Tt(t,e)),e},Yi.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Ir("WatchChangeAggregator","Detected inactive target",t),e},Yi.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},Yi.prototype.Gn=function(e){var n=this;this.On.set(e,new Hi),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},Yi.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},Yi);function Yi(t){this.Fn=t,this.On=new Map,this.Ln=Di,this.$n=eo(),this.kn=new Li(Wr)}function Ki(){this.An=0,this.In=no(),this.Rn=pi.lt,this.Pn=!1,this.yn=!0}function Qi(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function Ji(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function $i(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function Zi(){this.Xt=new Ei(Zr.k)}function to(n){this.k=n?function(t,e){return n(t,e)||Zr.k(t.key,e.key)}:function(t,e){return Zr.k(t.key,e.key)},this.Ht=_i,this.Yt=new Ei(this.k)}function eo(){return new Ei(Zr.k)}function no(){return new Ei(Zr.k)}function ro(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function io(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function so(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function uo(t){return t=vo(t.mapValue.fields.__local_write_time__.timestampValue),new Yr(t.seconds,t.nanos)}var ao=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?so(t)?4:10:Rr()}function co(r,i){var t,e=ho(r);if(e!==ho(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return uo(r).isEqual(uo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=vo(r.timestampValue),t=vo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,mo(r.bytesValue).isEqual(mo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,go((t=r).geoPointValue.latitude)===go(e.geoPointValue.latitude)&&go(t.geoPointValue.longitude)===go(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?go(e.integerValue)===go(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=go(e.doubleValue))===(t=go(t.doubleValue))?ui(e)===ui(t):isNaN(e)&&isNaN(t));case 9:return zr(r.arrayValue.values||[],i.arrayValue.values||[],co);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(ro(e)!==ro(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!co(e[t],n[t])))return!1;return!0}();default:return Rr()}}function lo(t,e){return void 0!==(t.values||[]).find(function(t){return co(t,e)})}function fo(t,e){var n,r,i,o=ho(t),s=ho(e);if(o!==s)return Wr(o,s);switch(o){case 0:return 0;case 1:return Wr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=go(t.integerValue||t.doubleValue))<(n=go(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return po(t.timestampValue,e.timestampValue);case 4:return po(uo(t),uo(e));case 5:return Wr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=mo(i),s=mo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Wr(n[i],r[i]);if(0!==o)return o}return Wr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Wr(go(o.latitude),go(r.latitude)))?n:Wr(go(o.longitude),go(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=fo(n[i],r[i]);if(o)return o}return Wr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Wr(r[s],o[s]);if(0!==u)return u;if(0!==(u=fo(n[r[s]],i[o[s]])))return u}return Wr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function po(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Wr(t,e);var n=vo(t),t=vo(e);return 0!==(e=Wr(n.seconds,t.seconds))?e:Wr(n.nanos,t.nanos)}function yo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=vo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?mo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Zr.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e}(t)}function vo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:go(t.seconds),nanos:go(t.nanos)};var e=0,n=ao.exec(t);return Lr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mo(t){return"string"==typeof t?pi.fromBase64String(t):pi.fromUint8Array(t)}function wo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function bo(t){return t&&"integerValue"in t}function Eo(t){return!!t&&"arrayValue"in t}function To(t){return t&&"nullValue"in t}function Io(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ao(t){return t&&"mapValue"in t}var No={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this.t=t,this.ne=e};function Lo(t){return{integerValue:""+t}}function ko(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function Do(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Lo(e):ko(t,e);var n}function So(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Po(t,e){return t.ne?e.toBase64():e.toUint8Array()}function _o(t){return Lr(!!t),Kr.N((t=vo(t),new Yr(t.seconds,t.nanos)))}function Vo(t,e){return new Qr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function Co(t){return Lr(Yo(t=Qr.J(t))),t}function Uo(t,e){return Vo(t.t,e.path)}function jo(t,e){if((e=Co(e)).get(1)!==t.t.projectId)throw new Pr(Sr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Pr(Sr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new Zr(qo(e))}function Mo(t,e){return Vo(t.t,e)}function xo(t){return new Qr(["projects",t.t.projectId,"databases",t.t.database]).Y()}function qo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Fo(t,e,n){return{name:Uo(t,e),fields:n.proto.mapValue.fields}}function Go(t,e){var n,r,i;if(e instanceof As)n={update:Fo(t,e.key,e.value)};else if(e instanceof Cs)n={delete:Uo(t,e.key)};else if(e instanceof Ns)n={update:Fo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Ds)n={transform:{document:Uo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof $o)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof Zo)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof is)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.Y(),increment:e.se};throw Rr()})}};else{if(!(e instanceof Us))return Rr();n={verify:Uo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:So(e=t,(t=i.updateTime).L())}:void 0!==i.exists?{exists:i.exists}:Rr()),n}function Bo(t){var e=4===(o=Co(t.parent)).length?Qr.X():qo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Xo(t.unaryFilter.field);return du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Xo(t.unaryFilter.field);return du.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Xo(t.unaryFilter.field),du.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Xo(t.unaryFilter.field),du.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,du.create(Xo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Gu(Xo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=si(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=zo(n.startAt));var u=null;return n.endAt&&(u=zo(n.endAt)),new Ks(e,i,t,o,r,"F",s,u)}function Wo(t){return{before:t.before,values:t.position}}function zo(t){var e=!!t.before,t=t.values||[];return new Vu(t,e)}function Ho(t){return{fieldPath:t.Y()}}function Xo(t){return $r.et(t.fieldPath)}function Yo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ko(t,e){return t instanceof as?bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Qo,Jo,$o=(n(es,Jo=me=function(){this.oe=void 0}),es),Zo=(n(ts,Qo=me),ts);function ts(t){var e=this;return(e=Qo.call(this)||this).elements=t,e}function es(){return null!==Jo&&Jo.apply(this,arguments)||this}function ns(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return co(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var rs,is=(n(os,rs=me),os);function os(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function ss(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!co(t,e)})}(i[r]);return{arrayValue:{values:n}}}var us,as=(n(hs,us=me),hs);function hs(t,e){var n=this;return(n=us.call(this)||this).serializer=t,n.se=e,n}function cs(t){return go(t.integerValue||t.doubleValue)}function ls(t){return Eo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fs(t,e){this.field=t,this.transform=e}var ps=(ds.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},ds.prototype.isEqual=function(t){return zr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ds);function ds(t){(this.fields=t).sort($r.k)}function ys(t,e){this.version=t,this.transformResults=e}var vs=(gs.ce=function(){return new gs},gs.exists=function(t){return new gs(void 0,t)},gs.updateTime=function(t){return new gs(t)},Object.defineProperty(gs.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},gs);function gs(t,e){this.updateTime=t,this.exists=e}function ms(t,e){return void 0!==t.updateTime?e instanceof Hs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Hs}function ws(t,e,n,r){return t instanceof As?(o=e,ms((i=t).re,o)?(o=Es(o),new Hs(i.key,o,i.value,{ae:!0})):o):t instanceof Ns?function(t,e){if(!ms(t.re,e))return e;var n=Es(e),e=Ls(t,e);return new Hs(t.key,n,e,{ae:!0})}(t,e):t instanceof Ds?function(t,e,n,r){if(!ms(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Hs&&(c=n.field(a.field)),null===c&&r instanceof Hs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof $o?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Zo?ns(h,i):h instanceof is?ss(h,i):(i=cs(h=Ko(c=h,i))+cs(c.se),bo(h)&&bo(c.se)?Lo(i):ko(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ps(t,i.data(),r);return new Hs(t.key,i.version,r,{ae:!0})}(t,e,r,n):ms(t.re,e)?new Xs(t.key,Kr.min()):e;var i,o}function bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||zr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Zo&&e instanceof Zo||t instanceof is&&e instanceof is?zr(t.elements,e.elements,co):t instanceof as&&e instanceof as?co(t.se,e.se):t instanceof $o&&e instanceof $o)}))}function Es(t){return t instanceof Hs?t.version:Kr.min()}var Ts,Is,As=(n(Rs,Is=l=function(){}),Rs),Ns=(n(Os,Ts=l),Os);function Os(t,e,n,r){var i=this;return(i=Ts.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function Rs(t,e,n){var r=this;return(r=Is.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Ls(t,e){return n=t,e=e instanceof Hs?e.data():js.empty(),r=new Ms(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var ks,Ds=(n(Ss,ks=l),Ss);function Ss(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=vs.exists(!0),n}function Ps(t,e,n){for(var r=new Ms(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var _s,Vs,Cs=(n(Gs,Vs=l),Gs),Us=(n(Fs,_s=l),Fs),js=(qs.empty=function(){return new qs({mapValue:{}})},qs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ao(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},qs.prototype.isEqual=function(t){return co(this.proto,t.proto)},qs),Ms=(xs.prototype.set=function(t,e){return this.fe(t,e),this},xs.prototype.delete=function(t){return this.fe(t,null),this},xs.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ho(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},xs.prototype.he=function(){var t=this.de($r.X(),this._e);return null!=t?new js(t):this.le},xs.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Ao(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},xs);function xs(t){void 0===t&&(t=js.empty()),this.le=t,this._e=new Map}function qs(t){this.proto=t}function Fs(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.re=e,n.type=4,n}function Gs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.re=e,n.type=3,n}var Bs,Ws,zs,Hs=(n($s,zs=me=function(t,e){this.key=t,this.version=e}),$s.prototype.field=function(t){return this.we.field(t)},$s.prototype.data=function(){return this.we},$s.prototype.Ee=function(){return this.we.proto},$s.prototype.isEqual=function(t){return t instanceof $s&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},$s.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),$s),Xs=(n(Js,Ws=me),Js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js),Ys=(n(Qs,Bs=me),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs),Ks=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function Qs(){return null!==Bs&&Bs.apply(this,arguments)||this}function Js(t,e,n){var r=this;return(r=Ws.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function $s(t,e,n,r){var i=this;return(i=zs.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Zs(t){return new Ks(t)}function tu(t){return!si(t.limit)&&"F"===t.limitType}function eu(t){return!si(t.limit)&&"L"===t.limitType}function nu(t){return 0<t.me.length?t.me[0].field:null}function ru(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function iu(t){return null!==t.collectionGroup}function ou(t){var e=t;if(null===e.Te){e.Te=[];var n=ru(e),t=nu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Gu(n)),e.Te.push(new Gu($r.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Gu($r.nt(),n)))}}return e.Te}function su(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=hi(e.path,e.collectionGroup,ou(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ou(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Gu(o.field,s))}var u=e.endAt?new Vu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Vu(e.startAt.position,!e.startAt.before):null;e.Ae=hi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function uu(t,e,n){return new Ks(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function au(t,e){return li(su(t),su(e))&&t.limitType===e.limitType}function hu(t){return ci(su(t))+"|lt:"+t.limitType}function cu(t){return"Query(target="+(n=(e=su(t)).path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Y()+" "+t.op+" "+yo(t.value)}).join(", ")+"]"),si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+xu(e.startAt)),e.endAt&&(n+=", endAt: "+xu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function lu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):Zr.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||qu(t.startAt,ou(t),n))&&(!t.endAt||!qu(t.endAt,ou(t),n)));var e,n}function fu(u){return function(t,e){for(var n=!1,r=0,i=ou(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?Zr.k(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?fo(e,r):Rr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var pu,du=(n(yu,pu=function(){}),yu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new wu(t,e,n):"array-contains"===e?new Du(t,n):"in"===e?new Su(t,n):"not-in"===e?new Pu(t,n):"array-contains-any"===e?new _u(t,n):new yu(t,e,n)},yu.Re=function(t,e,n){return new("in"===e?bu:Eu)(t,n)},yu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pe(fo(t,this.value)):null!==t&&ho(this.value)===ho(t)&&this.Pe(fo(t,this.value))},yu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},yu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},yu);function yu(t,e,n){var r=this;return(r=pu.call(this)||this).field=t,r.op=e,r.value=n,r}var vu,gu,mu,wu=(n(Au,mu=du),Au.prototype.matches=function(t){return t=Zr.k(t.key,this.key),this.Pe(t)},Au),bu=(n(Iu,gu=du),Iu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Iu),Eu=(n(Tu,vu=du),Tu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Tu);function Tu(t,e){var n=this;return(n=vu.call(this,t,"not-in",e)||this).keys=Nu(0,e),n}function Iu(t,e){var n=this;return(n=gu.call(this,t,"in",e)||this).keys=Nu(0,e),n}function Au(t,e,n){var r=this;return(r=mu.call(this,t,e,n)||this).key=Zr.it(n.referenceValue),r}function Nu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Zr.it(t.referenceValue)})}var Ou,Ru,Lu,ku,Du=(n(Mu,ku=du),Mu.prototype.matches=function(t){return Eo(t=t.field(this.field))&&lo(t.arrayValue,this.value)},Mu),Su=(n(ju,Lu=du),ju.prototype.matches=function(t){return null!==(t=t.field(this.field))&&lo(this.value.arrayValue,t)},ju),Pu=(n(Uu,Ru=du),Uu.prototype.matches=function(t){return!lo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!lo(this.value.arrayValue,t))},Uu),_u=(n(Cu,Ou=du),Cu.prototype.matches=function(t){var e=this;return!(!Eo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return lo(e.value.arrayValue,t)})},Cu),Vu=function(t,e){this.position=t,this.before=e};function Cu(t,e){return Ou.call(this,t,"array-contains-any",e)||this}function Uu(t,e){return Ru.call(this,t,"not-in",e)||this}function ju(t,e){return Lu.call(this,t,"in",e)||this}function Mu(t,e){return ku.call(this,t,"array-contains",e)||this}function xu(t){return(t.before?"b":"a")+":"+t.position.map(yo).join(",")}function qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?Zr.k(Zr.it(s.referenceValue),n.key):fo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Fu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!co(t.position[n],e.position[n]))return!1;return!0}var Gu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Bu=(Ju.prototype.Ve=function(t,e,n){for(var r,i,o,s,u,a=n.pe,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof As?new Hs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ns?(u=i,c=o,ms((s=r).re,u)?(u=Ls(s,u),new Hs(s.key,c.version,u,{hasCommittedMutations:!0})):new Ys(s.key,c.version)):r instanceof Ds?function(t,e,n){if(Lr(null!=n.transformResults),!ms(t.re,e))return new Ys(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Hs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Zo?ns(o,s):o instanceof is?ss(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ps(t,r.data(),e);return new Hs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Xs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ju.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ws(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ws(a,e,o,this.ye))}return e},Ju.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},Ju.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ui())},Ju.prototype.isEqual=function(t){return this.batchId===t.batchId&&zr(this.mutations,t.mutations,bs)&&zr(this.baseMutations,t.baseMutations,bs)},Ju),Wu=(Qu.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=Vi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new Qu(t,e,n,r)},Qu),zu=(Ku.prototype.get=function(t){var e=this.Se(t);if(void 0!==(e=this.Ne[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.De(i,t))return o}},Ku.prototype.has=function(t){return void 0!==this.get(t)},Ku.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},Ku.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},Ku.prototype.forEach=function(s){io(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ku.prototype.W=function(){return oo(this.Ne)},Ku),Hu=(Yu.prototype.catch=function(t){return this.next(void 0,t)},Yu.prototype.next=function(r,i){var o=this;return this.Le&&Rr(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new Yu(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},Yu.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Yu.prototype.Ue=function(t){try{var e=t();return e instanceof Yu?e:Yu.resolve(e)}catch(t){return Yu.reject(t)}},Yu.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):Yu.resolve(e)},Yu.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):Yu.reject(e)},Yu.resolve=function(n){return new Yu(function(t,e){t(n)})},Yu.reject=function(n){return new Yu(function(t,e){e(n)})},Yu.qe=function(t){return new Yu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Yu.Be=function(t){for(var n=Yu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Yu.resolve(t):e()})}(r[e]);return n},Yu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},Yu),Xu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function Yu(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function Ku(t,e){this.Se=t,this.De=e,this.Ne={}}function Qu(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function Ju(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function $u(t){return new Ro(t,!0)}function Zu(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ta=(oa.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},oa.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},oa.prototype.Ye=function(t,e,i){var o=Di;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},oa.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},oa.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Di;return t.forEach(function(t,e){e=e||new Xs(t,Kr.min()),n=n.Tt(t,e)}),n})},oa.prototype.ts=function(t,e,n){return r=e,Zr.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):iu(e)?this.es(t,e,n):this.ss(t,e,n);var r},oa.prototype.ns=function(t,e){return this.Ge(t,new Zr(e)).next(function(t){var e=_i;return t instanceof Hs&&(e=e.Tt(t.key,t)),e})},oa.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=_i;return this.We.rs(n,s).next(function(t){return Hu.forEach(t,function(t){var e=(e=r,t=t.child(s),new Ks(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},oa.prototype.ss=function(e,n,t){var a,h,r=this;return this.Qe.ts(e,n,t).next(function(t){return a=t,r.je.os(e,n)}).next(function(t){return h=t,r.us(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=ws(s,s=a.get(u),s,r.ye);a=s instanceof Hs?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){lu(n,e)||(a=a.remove(t))}),a})},oa.prototype.us=function(t,e,n){for(var r=Ui(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ns&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Hs&&(h=h.Tt(t,e))}),h})},oa),ea=(ia.ls=function(t,e){for(var n=Ui(),r=Ui(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ia(t,e.fromCache,n,r)},ia),na=(ra.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ra.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},ra);function ra(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function ia(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function oa(t,e,n){this.Qe=t,this.je=e,this.We=n}na.Es=-1;var sa=(ua.prototype.reset=function(){this.ys=0},ua.prototype.gs=function(){this.ys=this.Ps},ua.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Ir("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ua.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ua.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ua.prototype.bs=function(){return(Math.random()-.5)*this.ys},ua);function ua(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function aa(t){return"IndexedDbTransactionError"===t.name}function ha(){return"undefined"!=typeof document?document:null}var ca=(pa.Ls=function(t,e,n,r,i){return(i=new pa(t,e,Date.now()+n,r,i)).start(n),i},pa.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},pa.prototype.Ds=function(){return this.ks()},pa.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Pr(Sr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},pa.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},pa.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},pa),la=(Object.defineProperty(fa.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),fa.prototype.Ms=function(t){this.enqueue(t)},fa.prototype.Ys=function(t){this.Js(),this.Xs(t)},fa.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=ha())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},fa.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},fa.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},fa.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!aa(e=t.sent()))throw e;return Ir("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},fa.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Ar("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},fa.prototype.Cs=function(t,e,n){var r=this;return this.Js(),-1<this.Gs.indexOf(t)&&(e=0),n=ca.Ls(this,t,e,n,function(t){return r.ei(t)}),this.Qs.push(n),n},fa.prototype.Js=function(){this.js&&Rr()},fa.prototype.si=function(){},fa.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},fa.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},fa.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},fa.prototype.ui=function(t){this.Gs.push(t)},fa.prototype.ei=function(t){t=this.Qs.indexOf(t),this.Qs.splice(t,1)},fa);function fa(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new sa(this,"async_queue_retry"),this.zs=function(){var t=ha();t&&Ir("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=ha();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function pa(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new Xu,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function da(t,e){if(Ar("AsyncQueue",e+": "+t),aa(t))return new Pr(Sr.UNAVAILABLE,e+": "+t);throw t}function ya(t){this.ci=t}var va=(Ia.prototype.hi=function(t,e){return this.ai.add(e),Hu.resolve()},Ia.prototype.rs=function(t,e){return Hu.resolve(this.ai.getEntries(e))},Ia),ga=(Ta.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Li(Qr.k),t=!r.has(n);return this.index[e]=r.add(n),t},Ta.prototype.has=function(t){var e=t.j(),t=t.q();return(e=this.index[e])&&e.has(t)},Ta.prototype.getEntries=function(t){return(this.index[t]||new Li(Qr.k)).H()},Ta),ma=(Ea.prototype.next=function(){return this.li+=2,this.li},Ea._i=function(){return new Ea(0)},Ea.fi=function(){return new Ea(-1)},Ea),wa=(ba.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},ba);function ba(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Ei(Wr),this.Ei=new zu(ci,li),this.mi=Kr.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new ta(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Ea(t){this.li=t}function Ta(){this.index={}}function Ia(){this.ai=new ga}function Aa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Si(v).next(function(t){return g=t,n=e.persistence.Ti(o),m=new ta(e.Ai,n,e.persistence.Vi()),n.Si(v)}).next(function(t){for(var e=[],n=[],r=Ui(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function Na(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function Oa(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!aa(r=t.sent()))throw r;return Ir("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function Ra(t,o,s){var u=t,a=Kr.min(),h=Ui();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=su(o),(void 0!==(t=(i=t).Ei.get(r))?Hu.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:Kr.min(),s?h:Ui())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function La(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Sr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ir("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ka(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Qa(this)?(Ir("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,Ba(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,Ga(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new Ua(n,r)}var Da,Sa,Pa,l=(Fa.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},Fa.prototype.ir=function(){return 2===this.state},Fa.prototype.start=function(){3!==this.state?this.auth():this.rr()},Fa.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Fa.prototype.ur=function(){this.state=0,this.Ks.reset()},Fa.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},Fa.prototype.hr=function(t){this.lr(),this.stream.send(t)},Fa.prototype.ar=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},Fa.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},Fa.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===Sr.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Sr.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},Fa.prototype._r=function(){},Fa.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Pr(Sr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},Fa.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Fa.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Fa.prototype.mr=function(t){return Ir("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Fa.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Ir("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Fa),_a=(n(qa,Pa=l),qa.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},qa.prototype.onMessage=function(t){this.Ks.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Rr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Lr(void 0===o||"string"==typeof o),pi.fromBase64String(o||"")):(Lr(void 0===o||o instanceof Uint8Array),pi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Sr.UNKNOWN:bi(s.code),new Pr(o,s.message||"")),r=new zi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=jo(t,a.document.name),u=_o(a.document.updateTime),s=new js({mapValue:{fields:a.document.fields}}),u=new Hs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Bi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=jo(t,a.document),h=a.readTime?_o(a.readTime):Kr.min(),h=new Xs(u,h),a=a.removedTargetIds||[];r=new Bi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=jo(t,h.document),h=h.removedTargetIds||[];r=new Bi([],h,c,null)}else{if(!("filter"in e))return Rr();e.filter,(c=e.filter).targetId,e=new yi(e=c.count||0),c=c.targetId,r=new Wi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Kr.min():_o(e.readTime);return this.listener.Rr(n,t)},qa.prototype.Pr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=xo(this.serializer),h.addTarget=(e=this.serializer,(r=fi(r=(n=t).target)?{documents:{documents:[Mo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Mo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Mo(i,u.q()),s.structuredQuery.from=[{collectionId:u.j()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Io(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(To(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Io(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NAN"}};if(To(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Ho(t.field),direction:(t=t.dir,No[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.ne||si(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Wo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Wo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Po(e,n.resumeToken):0<n.ft.F(Kr.min())&&(r.readTime=So(e,n.ft.L())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.hr(h)},qa.prototype.yr=function(t){var e={};e.database=xo(this.serializer),e.removeTarget=t,this.hr(e)},qa),Va=(n(xa,Sa=l),Object.defineProperty(xa.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),xa.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,Sa.prototype.start.call(this)},xa.prototype._r=function(){this.Vr&&this.gr([])},xa.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},xa.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?_o(e.updateTime):_o(n)).isEqual(Kr.min())&&(t=_o(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ys(t,n);var e,n})):[]),n=_o(t.commitTime);return this.listener.vr(n,e)}var r;return Lr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},xa.prototype.Cr=function(){var t={};t.database=xo(this.serializer),this.hr(t)},xa.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Go(e.serializer,t)})};this.hr(t)},xa),Ca=(n(Ma,Da=function(){}),Ma.prototype.Dr=function(){if(this.Sr)throw new Pr(Sr.FAILED_PRECONDITION,"The client has already been terminated.")},Ma.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===Sr.UNAUTHENTICATED&&i.credentials.A(),t})},Ma.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===Sr.UNAUTHENTICATED&&i.credentials.A(),t})},Ma.prototype.terminate=function(){this.Sr=!1},Ma),Ua=(ja.prototype.Mr=function(){var t=this;0===this.Lr&&(this.Ur("Unknown"),this.$r=this.Ns.Cs("online_state_timeout",1e4,function(){return t.$r=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},ja.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.Lr++,1<=this.Lr&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},ja.prototype.set=function(t){this.Qr(),this.Lr=0,"Online"===t&&(this.kr=!1),this.Ur(t)},ja.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},ja.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kr?(Ar(t),this.kr=!1):Ir("OnlineStateTracker",t)},ja.prototype.Qr=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},ja);function ja(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.Lr=0,this.$r=null,this.kr=!0}function Ma(t,e,n){var r=this;return(r=Da.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function xa(t,e,n,r,i){var o=this;return(o=Sa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function qa(t,e,n,r,i){var o=this;return(o=Pa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Fa(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new sa(t,e)}function Ga(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Qa(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ba(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Wa(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),Ka(t)?Ya(t):rh(t).ir()&&Ha(t,e))}function za(t,e){var n=t,t=rh(n);n.zr.delete(e),t.ir()&&Xa(n,e),0===n.zr.size&&(t.ir()?t.cr():Qa(n)&&n.Zr.set("Unknown"))}function Ha(t,e){t.no.Dn(e.targetId),rh(t).Pr(e)}function Xa(t,e){t.no.Dn(e),rh(t).yr(e)}function Ya(e){e.no=new Xi({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),rh(e).start(),e.Zr.Mr()}function Ka(t){return Qa(t)&&!rh(t).sr()&&0<t.zr.size}function Qa(t){return 0===t.Hr.size}function Ja(t){t.no=void 0}function $a(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!aa(r))throw r;return n.Hr.add(1),[4,Ba(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Na(n.jr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,Ga(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Za(e,n){return n().catch(function(t){return $a(e,t,n)})}function th(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=ih(o=h),u=0<o.Kr.length?o.Kr[o.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(Qa(o)&&o.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.jr,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.je.zi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kr.length&&s.cr(),[3,7]):(u=a.batchId,e=a,(n=o).Kr.push(e),(n=ih(n)).ir()&&n.pr&&n.gr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,$a(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return eh(o)&&nh(o),[2]}var e,n,r,i})})}function eh(t){return Qa(t)&&!ih(t).sr()&&0<t.Kr.length}function nh(t){ih(t).start()}function rh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zr.forEach(function(t,e){Ha(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Ja(e),Ka(e)?(e.Zr.Br(n),Ya(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof zi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ir("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,$a(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Bi?s.no.Mn(u):u instanceof Wi?s.no.Kn(u):s.no.Bn(u),a.isEqual(Kr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Na(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&(n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(pi.lt,e.ft)),Xa(r,t),e=new gi(e.target,t,1,e.sequenceNumber),Ha(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ir("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,$a(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Dr(),new _a(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),Ka(n)?Ya(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),Ja(n),t.label=3;case 3:return[2]}})})})),n.oo}function ih(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ih(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ih(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return wi(n=i.code)&&n!==Sr.ABORTED?(e=r.Kr.shift(),ih(r).ur(),[4,Za(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,th(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return eh(e)&&nh(e),[2]}})})}.bind(null,n),br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ih(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=Wu.from(e,i,o),[4,Za(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,th(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new Va(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,th(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Ir("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function oh(){this.queries=new zu(hu,au),this.onlineState="Unknown",this.ao=new Set}var sh=function(){this.co=void 0,this.listeners=[]};function uh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new sh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=da(o=t.sent(),"Initialization of query '"+cu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&hh(e),[2]}})})}function ah(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function hh(t){t.ao.forEach(function(t){t.next()})}var ch=(Rh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new qi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},Rh.prototype.onError=function(t){this.wo.error(t)},Rh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},Rh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},Rh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Rh.prototype.Io=function(t){t=qi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},Rh),lh=(Oh.prototype.W=function(){return this.Po.W()},Oh.prototype.vo=function(t,e){e=new fh(t,e),this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Oh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Oh.prototype.Co=function(t,e){this.So(new fh(t,e))},Oh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Oh.prototype.No=function(t){var e=this,n=new Zr(new Qr([])),r=new fh(n,t),t=new fh(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Oh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Oh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Oh.prototype.Fo=function(t){var e=new Zr(new Qr([])),n=new fh(e,t),t=new fh(e,t+1),r=Ui();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Oh.prototype.Oo=function(t){var e=new fh(t,0);return null!==(e=this.Po.Gt(e))&&t.isEqual(e.key)},Oh),fh=(Nh.yo=function(t,e){return Zr.k(t.key,e.key)||Wr(t.Lo,e.Lo)},Nh.po=function(t,e){return Wr(t.Lo,e.Lo)||Zr.k(t.key,e.key)},Nh),ph=(Ah.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ah.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ah.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ah),dh=(Ih.prototype.Bo=function(t){},Ih.prototype.Qo=function(t,e,n){},Ih.prototype.jo=function(t){return this.Uo.$o(t),this.qo[t]||"not-current"},Ih.prototype.Wo=function(t,e,n){this.qo[t]=e},Ih.prototype.Go=function(t){this.Uo.ko(t)},Ih.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Ih.prototype.zo=function(t){delete this.qo[t]},Ih.prototype.Ho=function(){return this.Uo.activeTargetIds},Ih.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Ih.prototype.start=function(){return this.Uo=new ph,Promise.resolve()},Ih.prototype.Jo=function(t,e,n){},Ih.prototype.Xo=function(t){},Ih.prototype.Zo=function(){},Ih.prototype.ws=function(t){},Ih.prototype.tu=function(){},Ih),yh=function(t){this.key=t},vh=function(t){this.key=t},gh=(Object.defineProperty(Th.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Th.prototype.uu=function(t,e){var s=this,u=e?e.cu:new xi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=tu(this.query)&&a.size===this.query.limit?a.last():null,p=eu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof Hs?e:null)&&(lu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),tu(this.query)||eu(this.query))for(;c.size>this.query.limit;){var n=tu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Th.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Th.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this._u(n);var s=e?this.fu():[],e=(n=0===this.su.size&&this._n?1:0)!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new qi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Th.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new xi,nn:this.nn,hu:!1},!1)):{du:[]}},Th.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Th.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Th.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=Ui(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new vh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new yh(t))}),r},Th.prototype.Eu=function(t){return this.nu=t.Ji,this.su=Ui(),t=this.uu(t.documents),this.lu(t,!0)},Th.prototype.mu=function(){return qi.rn(this.query,this.ru,this.nn,0===this.eu)},Th),mh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},wh=function(t){this.key=t,this.Tu=!1},bh=(Object.defineProperty(Eh.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),Eh);function Eh(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new zu(hu,au),this.pu=new Map,this.gu=[],this.vu=new Ei(Zr.k),this.bu=new Map,this.Cu=new lh,this.Su={},this.Du=new Map,this.Nu=ma.fi(),this.onlineState="Unknown",this.xu=void 0}function Th(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=Ui(),this.nn=Ui(),this.iu=fu(t),this.ru=new Mi(this.iu)}function Ih(){this.Uo=new ph,this.qo={},this.Or=null,this._s=null}function Ah(){this.activeTargetIds=ji}function Nh(t,e){this.key=t,this.Lo=e}function Oh(){this.Po=new Li(fh.yo),this.Vo=new Li(fh.po)}function Rh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Lh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ai.Fi({Oi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Hu.resolve();return a.forEach(function(n){h=h.next(function(){return s.He(o,n)}).next(function(t){var e=t;Lr(null!==(t=r.Ce.get(n))),(!e||e.version.F(t)<0)&&(e=u.Ve(n,e,r))&&s.Li(e,r.be)})}),h.next(function(){return i.je.$i(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,e)})}))];case 2:return i=t.sent(),_h(n,r,null),Ph(n,r),n.Ru.Qo(r,"acknowledged"),[4,Mh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,La(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.je.$i(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),_h(n,u,a),Ph(n,u),n.Ru.Qo(u,"rejected",a),[4,Mh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,La(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=Yr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Ui()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ds?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Hs?t.field(i.field):void 0;null!=(o=Ko(i.transform,o||null))&&(e=(null==e?new Ms:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new Ns(i.key,o,function s(t){var u=[];return io(t.fields||{},function(t,e){var n=new $r([t]);if(Ao(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ps(u)}(o.proto.mapValue),vs.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Ei(Wr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,Mh(u,s.Uu)];case 3:return t.sent(),[4,th(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=da(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function kh(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=e,l=(o=s).ft,f=c.wi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=Di;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Ui(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Di;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof Xs&&e.version.isEqual(Kr.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Li(e,r),o=o.Tt(t,e)):Ir("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Kr.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),Hu.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t}))];case 2:return r=t.sent(),s.on.forEach(function(t,e){(e=n.bu.get(e))&&(Lr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Lr(e.Tu):0<t.wn.size&&(Lr(e.Tu),e.Tu=!1))}),[4,Mh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,La(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Dh(t,n,e){var r;((t=t).Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){(e=e.view.lo(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&hh(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function Sh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Qa((n=o).Au)||Ir("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=da(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Ph(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function _h(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Vh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||Ch(e,t)})}function Ch(t,e){var n=t.vu.get(e);null!==n&&(za(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),jh(t))}function Uh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof yh?(t.Cu.vo(u.key,e),r=t,i=(i=u).key,r.vu.get(i)||(Ir("SyncEngine","New document in limbo: "+i),r.gu.push(i),jh(r))):u instanceof vh?(Ir("SyncEngine","Document no longer in limbo: "+u.key),t.Cu.Co(u.key,e),t.Cu.Oo(u.key)||Ch(t,u.key)):Rr()}}function jh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new wh(e)),t.vu=t.vu.Tt(e,n),Wa(t.Au,new gi(su(Zs(e.path)),n,2,na.Es))}}function Mh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ea.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Hu.forEach(h,function(e){return Hu.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return Hu.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!aa(e=t.sent()))throw e;return Ir("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var xh,qh,Fh,Gh=(Ac.prototype.vi=function(t){this.Qu=t},Ac.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(Kr.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(tu(r)||eu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Tr()<=u.DEBUG&&Ir("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Ac.prototype.Wu=function(n,t){var r=new Li(fu(n));return t.forEach(function(t,e){e instanceof Hs&&lu(n,e)&&(r=r.add(e))}),r},Ac.prototype.hu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},Ac.prototype.ju=function(t,e){return Tr()<=u.DEBUG&&Ir("IndexFreeQueryEngine","Using full collection scan to execute query:",cu(e)),this.Qu.ts(t,e,Kr.min())},Ac),Bh=(Ic.prototype.zu=function(t){return Hu.resolve(0===this.je.length)},Ic.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1],n=new Bu(i,e,n,r),this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new fh(u.key,i)),this.We.hi(t,u.key.path.q())}return Hu.resolve(n)},Ic.prototype.qu=function(t,e){return Hu.resolve(this.Hu(e))},Ic.prototype.zi=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,Hu.resolve(this.je.length>e?this.je[e]:null)},Ic.prototype.Bu=function(){return Hu.resolve(0===this.je.length?-1:this.Gu-1)},Ic.prototype.Si=function(t){return Hu.resolve(this.je.slice())},Ic.prototype.Ke=function(t,e){var n=this,r=new fh(e,0),e=new fh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Lo),i.push(t)}),Hu.resolve(i)},Ic.prototype.Ze=function(t,e){var n=this,r=new Li(Wr);return e.forEach(function(t){var e=new fh(t,0),t=new fh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Lo)})}),Hu.resolve(this.Ju(r))},Ic.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;Zr.ot(e)||(e=e.child(""));var e=new fh(new Zr(e),0),i=new Li(Wr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Lo)),!0)},e),Hu.resolve(this.Ju(i))},Ic.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Ic.prototype.$i=function(n,r){var i=this;Lr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return Hu.forEach(r.mutations,function(t){var e=new fh(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Ic.prototype.tc=function(t){},Ic.prototype.Oo=function(t,e){var n=new fh(e,0),n=this.Ku.Gt(n);return Hu.resolve(e.isEqual(n&&n.key))},Ic.prototype.ki=function(t){return this.je.length,Hu.resolve()},Ic.prototype.Xu=function(t,e){return this.Yu(t)},Ic.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Ic.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.je.length?null:this.je[t]},Ic),Wh=(Tc.prototype.Li=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.We.hi(t,r.path.q())},Tc.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Tc.prototype.He=function(t,e){return e=this.docs.get(e),Hu.resolve(e?e.ec:null)},Tc.prototype.getEntries=function(t,e){var n=this,r=Di;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),Hu.resolve(r)},Tc.prototype.ts=function(t,e,n){for(var r=_i,i=new Zr(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=(u=o.Dt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.G(s.path))break;a.F(n)<=0||u instanceof Hs&&lu(e,u)&&(r=r.Tt(u.key,u))}return Hu.resolve(r)},Tc.prototype.sc=function(t,e){return Hu.forEach(this.docs,function(t){return e(t)})},Tc.prototype.Fi=function(t){return new zh(this)},Tc.prototype.ic=function(t){return Hu.resolve(this.size)},Tc),zh=(Ec.prototype.oc=function(t){return(t=this.Uu.get(t))?t.readTime:Kr.min()},Ec.prototype.Li=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Ec.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Ec.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?Hu.resolve(n.ec):this.cc(t,e)},Ec.prototype.getEntries=function(t,e){return this.ac(t,e)},Ec.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Ec.prototype.uc=function(){},n(bc,Fh=Ec),bc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Li(n,e.ec,r.oc(t))):r.hc.Gi(t)}),Hu.qe(i)},bc.prototype.cc=function(t,e){return this.hc.He(t,e)},bc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},bc),Hh=(wc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Hu.resolve()},wc.prototype.Mi=function(t){return Hu.resolve(this.lastRemoteSnapshotVersion)},wc.prototype.wc=function(t){return Hu.resolve(this._c)},wc.prototype.Lu=function(t){return this.highestTargetId=this.dc.next(),Hu.resolve(this.highestTargetId)},wc.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Hu.resolve()},wc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new ma(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},wc.prototype.$u=function(t,e){return this.Ec(e),this.targetCount+=1,Hu.resolve()},wc.prototype.Qi=function(t,e){return this.Ec(e),Hu.resolve()},wc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,Hu.resolve()},wc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),Hu.qe(u).next(function(){return s})},wc.prototype.Ic=function(t){return Hu.resolve(this.targetCount)},wc.prototype.Hi=function(t,e){return e=this.lc.get(e)||null,Hu.resolve(e)},wc.prototype.qi=function(t,e,n){return this.fc.bo(e,n),Hu.resolve()},wc.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Hu.qe(i)},wc.prototype.Ac=function(t,e){return this.fc.No(e),Hu.resolve()},wc.prototype.Yi=function(t,e){return e=this.fc.Fo(e),Hu.resolve(e)},wc.prototype.Oo=function(t,e){return Hu.resolve(this.fc.Oo(e))},wc),Xh=(mc.prototype.yc=function(t,e){return Hu.resolve(this.Rc.get(e))},mc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:_o(e.createTime)}),Hu.resolve()},mc.prototype.gc=function(t,e){return Hu.resolve(this.Pc.get(e))},mc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=Bo({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?uu(e,e.limit,"L"):e),readTime:_o(n.readTime)}),Hu.resolve()},mc),Yh=(gc.prototype.start=function(){return Promise.resolve()},gc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(gc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),gc.prototype.xc=function(){},gc.prototype.Fc=function(){},gc.prototype.Vi=function(){return this.We},gc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new Bh(this.We,this.Wi),this.bc[t.h()]=e),e},gc.prototype.Pi=function(){return this.Ri},gc.prototype.Ii=function(){return this.Qe},gc.prototype.gi=function(){return this.pi},gc.prototype.runTransaction=function(t,e,n){var r=this;Ir("MemoryPersistence","Starting transaction:",t);var i=new Kh(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},gc.prototype.kc=function(e,n){return Hu.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},gc),Kh=(vc.prototype.Uc=function(t){this.Mc.push(t)},vc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(yc,qh=vc),yc),Qh=(dc.Qc=function(t){return new dc(t)},Object.defineProperty(dc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Rr()},enumerable:!1,configurable:!0}),dc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),Hu.resolve()},dc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),Hu.resolve()},dc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Hu.resolve()},dc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},dc.prototype.Oc=function(){this.Bc=new Set},dc.prototype.Lc=function(n){var r=this,i=this.persistence.Ii().Fi();return Hu.forEach(this.jc,function(t){var e=Zr.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},dc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},dc.prototype.Dc=function(t){return 0},dc.prototype.Wc=function(t,e){var n=this;return Hu.Be([function(){return Hu.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},dc),Jh=(pc.prototype.Ar=function(t){this.zc=t},pc.prototype.dr=function(t){this.Hc=t},pc.prototype.onMessage=function(t){this.Yc=t},pc.prototype.close=function(){this.Kc()},pc.prototype.send=function(t){this.Gc(t)},pc.prototype.Jc=function(){this.zc()},pc.prototype.Xc=function(t){this.Hc(t)},pc.prototype.Zc=function(t){this.Yc(t)},pc),$h={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Zh=(fc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);return Ir("RestConnection","Sending: ",i,n),t={},this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Ir("RestConnection","Received: ",t),t},function(t){throw Nr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},fc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},fc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},fc.prototype.sa=function(t,e){return t=$h[t],this.na+"/v1/"+e+":"+t},n(lc,xh=fc),lc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Ir("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Ir("Connection",'RPC "'+o+'" timed out'),r(new Pr(Sr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Ir("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Sr).indexOf(e)?e:Sr.UNKNOWN,r(new Pr(e,t.message))):r(new Pr(Sr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Pr(Sr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Ir("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},lc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Ir("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Jh({Gc:function(t){u?Ir("Connection","Not sending because WebChannel is closed:",t):(s||(Ir("Connection","Opening WebChannel transport."),o.open(),s=!0),Ir("Connection","WebChannel sending:",t),o.send(t))},Kc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Ir("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Ir("Connection","WebChannel transport closed"),a.Xc())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Nr("Connection","WebChannel transport errored:",t),a.Xc(new Pr(Sr.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ir("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=vi[r];if(void 0!==t)return bi(t)}(),i=n.message,void 0===t&&(t=Sr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new Pr(t,i)),o.close()):(Ir("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},lc),tc=(cc.prototype.Xr=function(t){this.ha.push(t)},cc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},cc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},cc.prototype.ua=function(){Ir("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},cc.prototype.aa=function(){Ir("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},cc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},cc),ec=(hc.prototype.Xr=function(t){},hc.prototype.Zo=function(){},hc),nc=(ac.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=$u(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},ac.prototype.Ea=function(t){return null},ac.prototype.ma=function(t){return e=this.persistence,n=new Gh,r=t.Ta,t=this.serializer,new wa(e,n,r,t);var e,n,r},ac.prototype.da=function(t){return new Yh(Qh.Qc,this.serializer)},ac.prototype.fa=function(t){return new dh},ac.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},ac),rc=(uc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Dh(e.Pa,t,1)},this.Au.Gr.Va=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ir("SyncEngine","User change. New user:",o.h()),[4,Aa(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Pr(Sr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,Mh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Pa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,Ga(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,Ba(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},uc.prototype.Ra=function(t){return new oh},uc.prototype.Aa=function(t){var e=$u(t.ta.t),n=(n=t.ta,new Zh(n));return t=t.credentials,new Ca(t,n,e)},uc.prototype.Ia=function(t){var e=this;return new ka(this.jr,this.Wr,t.Ns,function(t){return Dh(e.Pa,t,0)},t=new(tc._a()?tc:ec))},uc.prototype.ya=function(t,e){return n=this.jr,r=this.Au,i=this.Iu,o=this.Ru,s=t.Ta,t=t.Pu,e=e,t=new bh(n,r,i,o,s,t),e&&(t.xu=!0),t;var n,r,i,o,s},uc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ir("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,Ba(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},uc),ic=(sc.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},sc.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},sc.prototype.ga=function(){this.muted=!0},sc.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},sc),oc=function(t){this.va=t};function sc(t){this.observer=t,this.muted=!1}function uc(){}function ac(){this.synchronizeTabs=!1}function hc(){}function cc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function lc(t){var e=this;return(e=xh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function fc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function pc(t){this.Gc=t.Gc,this.Kc=t.Kc}function dc(t){this.persistence=t,this.qc=new lh,this.Bc=null}function yc(t){var e=this;return(e=qh.call(this)||this).Bi=t,e}function vc(){this.Mc=[]}function gc(t,e){var n=this;this.bc={},this.Cc=new na(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new Hh(this),this.We=new va,this.Qe=(t=this.We,new Wh(t,function(t){return n.Wi.Dc(t)})),this.serializer=new ya(e),this.pi=new Xh(this.serializer)}function mc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function wc(t){this.persistence=t,this.lc=new zu(ci,li),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this._c=0,this.fc=new lh,this.targetCount=0,this.dc=ma._i()}function bc(t){var e=this;return(e=Fh.call(this)||this).hc=t,e}function Ec(){this.Uu=new zu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Tc(t,e){this.We=t,this.nc=e,this.docs=new Ei(Zr.k),this.size=0}function Ic(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Li(fh.yo)}function Ac(){}function Nc(t,e,n){if(!n)throw new Pr(Sr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Oc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Rc(t,e,n,r){if(!0===e&&!0===r)throw new Pr(Sr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Lc(t){if(!Zr.ot(t))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function kc(t){if(Zr.ot(t))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Dc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Sc(t,e){if(t instanceof oc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Pr(Sr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Dc(t),new Pr(Sr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Pc(t,e){if(e<=0)throw new Pr(Sr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var _c,Vc=function(t){this.ba=t},Cc=(n(Uc,_c=Vc),Uc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},Uc.prototype.isEqual=function(t){return t instanceof Uc},Uc);function Uc(){return null!==_c&&_c.apply(this,arguments)||this}function jc(t,e,n){return new Df({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Mc,xc,qc,Fc,Gc=(n(il,Fc=Vc),il.prototype.Ca=function(t){return new fs(t.path,new $o)},il.prototype.isEqual=function(t){return t instanceof il},il),Bc=(n(rl,qc=Vc),rl.prototype.Ca=function(t){var e=jc(this,t,!0),n=this.Fa.map(function(t){return Mf(t,e)}),n=new Zo(n);return new fs(t.path,n)},rl.prototype.isEqual=function(t){return this===t},rl),Wc=(n(nl,xc=Vc),nl.prototype.Ca=function(t){var e=jc(this,t,!0),n=this.Fa.map(function(t){return Mf(t,e)}),n=new is(n);return new fs(t.path,n)},nl.prototype.isEqual=function(t){return this===t},nl),zc=(n(el,Mc=Vc),el.prototype.Ca=function(t){var e=new as(t.serializer,Do(t.serializer,this.Oa));return new fs(t.path,e)},el.prototype.isEqual=function(t){return this===t},el),Hc=(Object.defineProperty(tl.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(tl.prototype,"longitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),tl.prototype.isEqual=function(t){return this.La===t.La&&this.$a===t.$a},tl.prototype.toJSON=function(){return{latitude:this.La,longitude:this.$a}},tl.prototype.D=function(t){return Wr(this.La,t.La)||Wr(this.$a,t.$a)},tl),Xc=(Zc.fromBase64String=function(t){try{return new Zc(pi.fromBase64String(t))}catch(t){throw new Pr(Sr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Zc.fromUint8Array=function(t){return new Zc(pi.fromUint8Array(t))},Zc.prototype.toBase64=function(){return this.ka.toBase64()},Zc.prototype.toUint8Array=function(){return this.ka.toUint8Array()},Zc.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Zc.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},Zc),Yc=new Map,Kc=($c.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},$c),Qc=(Object.defineProperty(Jc.prototype,"app",{get:function(){if(!this.ja)throw new Pr(Sr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),Jc.prototype.za=function(t){if(this.qa)throw new Pr(Sr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new Kc(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new _r;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ur(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Pr(Sr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Jc.prototype.Ha=function(){return this.Ua},Jc.prototype.Ya=function(){return this.qa=!0,this.Ua},Jc.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},Jc.prototype.Ja=function(){return(t=Yc.get(this))&&(Ir("ComponentProvider","Removing Datastore"),Yc.delete(this),t.terminate()),Promise.resolve();var t},Jc);function Jc(t,e){this.Ma="(lite)",this.Ua=new Kc({}),this.qa=!1,t instanceof gr?(this.Ba=t,this.Qa=new _r):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Pr(Sr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gr(t.options.projectId)}(t),this.Qa=new Vr(e))}function $c(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Pr(Sr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pr(Sr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Rc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Zc(t){this.ka=t}function tl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Pr(Sr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Pr(Sr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.$a=e}function el(t,e){var n=this;return(n=Mc.call(this,t)||this).Oa=e,n}function nl(t,e){var n=this;return(n=xc.call(this,t)||this).Fa=e,n}function rl(t,e){var n=this;return(n=qc.call(this,t)||this).Fa=e,n}function il(){return null!==Fc&&Fc.apply(this,arguments)||this}function ol(){if("undefined"==typeof Uint8Array)throw new Pr(Sr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function sl(){if("undefined"==typeof atob)throw new Pr(Sr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ul,al,hl,cl=(n(ml,hl=Xc),ml.fromBase64String=function(t){sl();try{return new ml(pi.fromBase64String(t))}catch(t){throw new Pr(Sr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ml.fromUint8Array=function(t){return ol(),new ml(pi.fromUint8Array(t))},ml.prototype.toBase64=function(){return sl(),hl.prototype.toBase64.call(this)},ml.prototype.toUint8Array=function(){return ol(),hl.prototype.toUint8Array.call(this)},ml.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ml),me=(gl.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),ho(t)){case 0:return null;case 1:return t.booleanValue;case 2:return go(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(mo(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw Rr()}},gl.prototype.rh=function(t,n){var r=this,i={};return io(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},gl.prototype.sh=function(t){return new Hc(go(t.latitude),go(t.longitude))},gl.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},gl.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){return so(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(uo(t));default:return null}},gl.prototype.Za=function(t){return t=vo(t),new Yr(t.seconds,t.nanos)},gl.prototype.oh=function(t,e){var n=Qr.J(t);return Lr(Yo(n)),t=new gr(n.get(1),n.get(3)),n=new Zr(n.U(5)),t.isEqual(e)||Ar("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},gl),ll=(n(vl,al=me),vl.prototype.nh=function(t){return new cl(t)},vl.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),Lp.uh(t,this.firestore,null)},vl),fl=(Object.defineProperty(yl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"ref",{get:function(){return new Fl(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),yl.prototype.exists=function(){return null!==this._h},yl.prototype.data=function(){if(this._h){if(this.fh){var t=new pl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},yl.prototype.get=function(t){if(this._h&&null!==(t=this._h.data().field(wl("DocumentSnapshot.get",t))))return this.hh.Xa(t)},yl),pl=(n(dl,ul=fl),dl.prototype.data=function(){return ul.prototype.data.call(this)},dl);function dl(){return null!==ul&&ul.apply(this,arguments)||this}function yl(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function vl(t){var e=this;return(e=al.call(this)||this).firestore=t,e}function gl(){}function ml(){return null!==hl&&hl.apply(this,arguments)||this}function wl(t,e){return"string"==typeof e?Wf(t,e):(e instanceof oc?e.va:e).dh}var bl,El=(Al.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Al),Tl=(n(Il,bl=Qc),Il.prototype.Ja=function(){return this.Eh||Tp(this),this.Eh.terminate()},Il);function Il(t,e){var n=this;return(n=bl.call(this,t,e)||this).wh=new la,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Al(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new $r(t)}var Nl,Ol,Rl=(n(Pl,Ol=fl),Pl.prototype.exists=function(){return Ol.prototype.exists.call(this)},Pl.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Ll(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Pl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h&&null!==(t=this._h.data().field(wl("DocumentSnapshot.get",t))))return this.hh.Xa(t,e.serverTimestamps)},Pl),Ll=(n(Sl,Nl=Rl),Sl.prototype.data=function(t){return void 0===t&&(t={}),Nl.prototype.data.call(this,t)},Sl),kl=(Object.defineProperty(Dl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Dl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Dl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Dl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Ll(r.ah,r.hh,t.key,t,new Fp(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Dl.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Th.sn)throw new Pr(Sr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Ll(i.ah,i.hh,t.doc.key,t.doc,new Fp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ll(i.ah,i.hh,t.doc.key,t.doc,new Fp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Dl);function Dl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new Fp(r.hasPendingWrites,r.fromCache),this.query=n}function Sl(){return null!==Nl&&Nl.apply(this,arguments)||this}function Pl(t,e,n,r,i,o){var s=this;return(s=Ol.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function _l(t,e){return t instanceof Rl&&e instanceof Rl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof kl&&e instanceof kl&&t.ah===e.ah&&Tf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var Vl,Cl=(n(Ul,Vl=me),Ul.prototype.nh=function(t){return new Xc(t)},Ul.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Fl(this.firestore,null,t)},Ul);function Ul(t){var e=this;return(e=Vl.call(this)||this).firestore=t,e}function jl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Sc(t.firestore,Tl),s=If(o);return e instanceof oc&&(e=e.va),xl(o,("string"==typeof e||e instanceof El?Uf(s,"updateDoc",t.lh,e,n,r):Cf(s,"updateDoc",t.lh,e)).Ph(t.lh,vs.exists(!0)))}function Ml(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||Zu(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};Zu(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Fl?(s=Sc(e.firestore,Tl),u=Zs(e.lh.path),c={next:function(t){n[o]&&n[o](ql(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Sc(e.firestore,Tl),u=e.Rh,h=new Cl(s),c={next:function(t){n[o]&&n[o](new kl(s,h,e,t))},error:n[o+1],complete:n[o+2]},ff(e.Rh));var f=Ep(s),p=new ic(c),d=new ch(u,p,l);return s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=uh,[4,op(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ah,[4,op(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function xl(t,e){return function(n,r){var t=this,i=new Xu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ep(t),e)}function ql(t,e,n){var r=n.docs.get(e.lh),i=new Cl(t);return new Rl(t,i,e.lh,r,new Fp(n.hasPendingWrites,n.fromCache),e.fh)}var Fl=(Object.defineProperty(Wl.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"parent",{get:function(){return new df(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),Wl.prototype.withConverter=function(t){return new Wl(this.firestore,t,this.lh)},Wl),Gl=(Bl.prototype.withConverter=function(t){return new Bl(this.firestore,t,this.Rh)},Bl);function Bl(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function Wl(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function zl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Vh(t);return t}var Hl,Xl,Yl,Kl,Ql,Jl=(n(uf,Ql=l=function(){}),uf.prototype.Vh=function(t){var e=If(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){cf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(hf(n,t,h))}c={arrayValue:{values:s}}}else c=hf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||cf(o,i),c=jf(e,"where",o,"in"===i||"not-in"===i);var c=du.create(r,i,c);return function(t,e){if(e.Ie()){var n=ru(t);if(null!==n&&!n.isEqual(e.field))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=nu(t))&&lf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new Gl(t.firestore,t.fh,(e=(t=t.Rh).filters.concat([e]),new Ks(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},uf),$l=(n(sf,Kl=l),sf.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Gu(e,n);return e=r,null!==nu(n=t)||null!==(t=ru(n))&&lf(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new Gl(t.firestore,t.fh,(e=(t=t.Rh).me.concat([e]),new Ks(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},sf),Zl=(n(of,Yl=l),of.prototype.Vh=function(t){return new Gl(t.firestore,t.fh,uu(t.Rh,this.Sh,this.Dh))},of),tf=(n(rf,Xl=l),rf.prototype.Vh=function(t){var e=af(t,this.type,this.Nh,this.xh);return new Gl(t.firestore,t.fh,(t=t.Rh,new Ks(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},rf),ef=(n(nf,Hl=l),nf.prototype.Vh=function(t){var e=af(t,this.type,this.Nh,this.xh);return new Gl(t.firestore,t.fh,(t=t.Rh,new Ks(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},nf);function nf(t,e,n){var r=this;return(r=Hl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function rf(t,e,n){var r=this;return(r=Xl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function of(t,e,n){var r=this;return(r=Yl.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function sf(t,e){var n=this;return(n=Kl.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function uf(t,e,n){var r=this;return(r=Ql.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function af(t,h,e,n){if(e[0]instanceof oc&&(e[0]=e[0].va),e[0]instanceof fl)return function(t,e,n,r){if(!n)throw new Pr(Sr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=ou(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(wo(e,n.key));else{var a=n.field(u.field);if(so(a))throw new Pr(Sr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Y(),new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Vu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=If(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Pr(Sr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!iu(t)&&-1!==h.indexOf("/"))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Qr.J(h));if(!Zr.ot(c))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Zr(c),u.push(wo(e,c))}else h=jf(n,r,h),u.push(h)}return new Vu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function hf(t,e,n){if(n instanceof oc&&(n=n.va),"string"==typeof n){if(""===n)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!iu(e)&&-1!==n.indexOf("/"))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Qr.J(n)),!Zr.ot(e))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return wo(t,new Zr(e))}if(n instanceof Fl)return wo(t,n.lh);throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dc(n)+".")}function cf(t,e){if(!Array.isArray(t)||0===t.length)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function lf(t,e,n){if(!n.isEqual(e))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ff(t){if(eu(t)&&0===t.me.length)throw new Pr(Sr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pf,df=(n(yf,pf=Gl),Object.defineProperty(yf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new Fl(this.firestore,null,new Zr(t))},enumerable:!1,configurable:!0}),yf.prototype.withConverter=function(t){return new yf(this.firestore,t,this.yh)},yf);function yf(t,e,n){var r=this;return(r=pf.call(this,t,e,Zs(n))||this).firestore=t,r.yh=n,r.type="collection",r}function vf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Nc("collection","path",e),t instanceof Qc){var i=Qr.J.apply(Qr,s([e],n));return kc(i),new df(t,null,i)}if(!(t instanceof Fl||t instanceof df))throw new Pr(Sr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kc(e=Qr.J.apply(Qr,s([t.path],n)).child(Qr.J(e))),new df(t.firestore,null,e)}function gf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Gr.S()),Nc("doc","path",e),t instanceof Qc){var i=Qr.J.apply(Qr,s([e],n));return Lc(i),new Fl(t,null,new Zr(i))}if(!(t instanceof Fl||t instanceof df))throw new Pr(Sr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Lc(e=t.yh.child(Qr.J.apply(Qr,s([e],n)))),new Fl(t.firestore,t instanceof df?t.fh:null,new Zr(e))}var mf,wf=(n(bf,mf=me),bf.prototype.nh=function(t){return new Xc(t)},bf.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Fl(this.firestore,null,t)},bf);function bf(t){var e=this;return(e=mf.call(this)||this).firestore=t,e}function Ef(t,e){return(t instanceof Fl||t instanceof df)&&(e instanceof Fl||e instanceof df)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function Tf(t,e){return t instanceof Gl&&e instanceof Gl&&t.firestore===e.firestore&&au(t.Rh,e.Rh)&&t.fh===e.fh}function If(t){var e=t.Ya(),n=$u(t.Ba);return new Sf(t.Ba,!!e.ignoreUndefinedProperties,n)}var Af=/^__.*__$/,Nf=(Lf.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new Ns(t,this.data,this.ee,e)):n.push(new As(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},Lf),Of=(Rf.prototype.Ph=function(t,e){return e=[new Ns(t,this.data,this.ee,e)],0<this.fieldTransforms.length&&e.push(new Ds(t,this.fieldTransforms)),e},Rf);function Rf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Lf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function kf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Df=(Object.defineProperty(_f.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),_f.prototype.Oh=function(t){return new _f(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},_f.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Oh({path:e,xa:!1})).$h(t),e},_f.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Oh({path:t,xa:!1})).Fh(),t},_f.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},_f.prototype.Da=function(t){return zf(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},_f.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},_f.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$h(this.path.get(t))},_f.prototype.$h=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(kf(this.Sa)&&Af.test(t))throw this.Da('Document fields cannot begin and end with "__"')},_f),Sf=(Pf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Df({Sa:t,methodName:e,Na:n,path:$r.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Pf);function Pf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||$u(t)}function _f(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function Vf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);Ff("Data must be an object, but it was:",s,r);var u,a,r=xf(r,s);if(o.merge)u=new ps(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=Gf(e,l[c],n);if(!s.contains(f))throw new Pr(Sr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Hf(h,f)||h.push(f)}u=new ps(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new Nf(new js(r),u,a)}function Cf(t,r,i,e){var o=t.qh(1,r,i);Ff("Data must be an object, but it was:",o,e);var s=[],u=new Ms;return io(e,function(t,e){var n=Wf(r,t,i);e instanceof oc&&(e=e.va),t=o.kh(n),e instanceof Cc?s.push(n):null!=(t=Mf(e,t))&&(s.push(n),u.set(n,t))}),e=new ps(s),new Of(u.he(),e,o.fieldTransforms)}function Uf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[Gf(e,r,n)],a=[i];if(o.length%2!=0)throw new Pr(Sr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Gf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Ms,y=u.length-1;0<=y;--y)Hf(p,u[y])||(c=u[y],(l=a[y])instanceof oc&&(l=l.va),f=s.kh(c),l instanceof Cc?p.push(c):null!=(f=Mf(l,f))&&(p.push(c),d.set(c,f)));return i=new ps(p),new Of(d.he(),i,s.fieldTransforms)}function jf(t,e,n,r){return void 0===r&&(r=!1),Mf(n,t.qh(r?4:3,e))}function Mf(s,t){if(s instanceof oc&&(s=s.va),qf(s))return Ff("Unsupported field value:",t,s),xf(s,t);if(s instanceof Vc)return function(t,e){if(!kf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");(t=t.Ca(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Mf(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof oc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Do(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Yr.fromDate(t);return{timestampValue:So(e.serializer,n)}}if(t instanceof Yr){var r=new Yr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:So(e.serializer,r)}}if(t instanceof Hc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xc)return{bytesValue:Po(e.serializer,t.ka)};if(t instanceof Fl){if(n=e.t,!(r=t.firestore.Ba).isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Vo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Dc(t))}(s,t)}function xf(t,n){var r={};return oo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):io(t,function(t,e){null!=(e=Mf(e,n.Lh(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function qf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Yr||t instanceof Hc||t instanceof Xc||t instanceof Fl||t instanceof Vc)}function Ff(t,e,n){if(!qf(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Dc(n))?e.Da(t+" a custom object"):e.Da(t+" "+n);var r}function Gf(t,e,n){if(e instanceof oc&&(e=e.va),e instanceof El)return e.dh;if("string"==typeof e)return Wf(t,e);throw zf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Bf=new RegExp("[~\\*/\\[\\]]");function Wf(e,n,r){if(0<=n.search(Bf))throw zf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(El.bind.apply(El,s([void 0],n.split("."))))).dh}catch(t){throw zf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function zf(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Pr(Sr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Hf(t,e){return t.some(function(t){return t.isEqual(e)})}var Xf=($f.prototype.Gh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Pr(Sr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=xo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Uo(r.serializer,t)})},[4,r.Fr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=jo(t,e.found.name),t=_o(e.found.updateTime),e=new js({mapValue:{fields:e.found.fields}});return new Hs(n,t,e,{})}(n,t):"missing"in t?(e=n,Lr(!!(n=t).missing),Lr(!!n.readTime),e=jo(e,n.missing),n=_o(n.readTime),new Xs(e,n)):Rr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Lr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Xs||t instanceof Hs?n.zh(t):Rr()}),e)]}})})},$f.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},$f.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},$f.prototype.delete=function(t){this.write([new Cs(t,this.re(t))]),this.Wh.add(t.toString())},$f.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Zr.st(e),n.mutations.push(new Us(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=xo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Go(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},$f.prototype.zh=function(t){var e;if(t instanceof Hs)e=t.version;else{if(!(t instanceof Xs))throw Rr();e=Kr.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Pr(Sr.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},$f.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?vs.updateTime(e):vs.ce()},$f.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return vs.exists(!0);if(e.isEqual(Kr.min()))throw new Pr(Sr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},$f.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},$f.prototype.Kh=function(){},$f),Yf=(Jf.prototype.run=function(){this.Jh()},Jf.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Xf(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},Jf.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},Jf.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},Jf.prototype.tl=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!wi(t))},Jf),Kf=(Qf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},Qf.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},Qf.prototype.sl=function(){if(this.Ns.Hs)throw new Pr(Sr.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new Xu;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=da(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Qf);function Qf(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=mr.UNAUTHENTICATED,this.clientId=Gr.S(),this.nl=function(){},this.V=new Xu,this.credentials.I(function(t){Ir("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function Jf(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new sa(this.Ns,"transaction_retry")}function $f(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function Zf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Ir("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Ir("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Aa(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new nc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function tp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Ir("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,Zf(r)];case 1:return e=t.sent(),Ir("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Ir("RemoteStore","RemoteStore received new credentials"),n=Qa(e),e.Hr.add(3),[4,Ba(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,Ga(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new rc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function ep(t){return Zf(t).then(function(t){return t.persistence})}function np(t){return Zf(t).then(function(t){return t.jr})}function rp(t){return tp(t).then(function(t){return t.Au})}function ip(t){return tp(t).then(function(t){return t.Pa})}function op(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,tp(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=kh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t;if((t=n.bu.get(e))&&t.Tu)return Ui().add(t.key);var r=Ui();if(!(e=n.pu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Vu.get(s),r=r.Kt(s.view.ou);return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ei(Zr.k)).Tt(n,new Xs(n,Kr.min())),i=Ui().add(n),i=new Fi(Kr.min(),new Map,new Li(Wr),r,i),[4,kh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),jh(e),[3,4];case 2:return[4,Oa(e.jr,s,!1).then(function(){return Vh(e,s,u)}).catch(La)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&hh(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=su(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,Hu.resolve(n)):i.Ri.Lu(e).next(function(t){return n=new gi(r,t,0,e.Bi),i.Ri.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Ra(r.jr,i.query,!1).then(function(t){return t=t.documents,i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(Uh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Ra(i.jr,o,!0)];case 1:return n=t.sent(),r=new gh(o,n.Ji),e=r.uu(n.documents),n=Gi.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),Uh(i,s,n.du),r=new mh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&Wa(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.Pa),n.fo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!au(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Oa(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),za(e.Au,n.targetId),Vh(e,n.targetId)}).catch(La)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Vh(e,n.targetId),[4,Oa(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function sp(n,r,i,o,s){var t=new ic({next:function(t){r.Ms(function(){return ah(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Pr(Sr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Pr(Sr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ch(Zs(i.path),t,{includeMetadataChanges:!0,Ro:!0});return uh(n,u)}function up(e,n,t,r,i){var o=new ic({next:function(t){n.Ms(function(){return ah(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Pr(Sr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ch(t,o,{includeMetadataChanges:!0,Ro:!0});return uh(e,s)}var ap=(hp.prototype.set=function(t,e,n){return this.hl(),e=nd((t=cp(t,this.ah)).fh,e,n),n=Vf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n),this.ul=this.ul.concat(n.Ph(t.lh,vs.ce())),this},hp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.hl(),t=cp(t,this.ah),e instanceof oc&&(e=e.va),e="string"==typeof e||e instanceof El?Uf(this.al,"WriteBatch.update",t.lh,e,n,r):Cf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,vs.exists(!0))),this},hp.prototype.delete=function(t){return this.hl(),t=cp(t,this.ah),this.ul=this.ul.concat(new Cs(t.lh,vs.ce())),this},hp.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},hp.prototype.hl=function(){if(this.cl)throw new Pr(Sr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},hp);function hp(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=If(t)}function cp(t,e){if(t instanceof oc&&(t=t.va),t.firestore!==e)throw new Pr(Sr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var lp,fp,pp=(bp.prototype.get=function(t){var e=this,n=cp(t,this.ah),r=new wf(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return Rr();if((t=t[0])instanceof Xs)return new fl(e.ah,r,n.lh,null,n.fh);if(t instanceof Hs)return new fl(e.ah,r,t.key,t,n.fh);throw Rr()})},bp.prototype.set=function(t,e,n){return e=nd((t=cp(t,this.ah)).fh,e,n),n=Vf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n),this.ll.set(t.lh,n),this},bp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=cp(t,this.ah),e instanceof oc&&(e=e.va),e="string"==typeof e||e instanceof El?Uf(this.al,"Transaction.update",t.lh,e,n,r):Cf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},bp.prototype.delete=function(t){return t=cp(t,this.ah),this.ll.delete(t.lh),this},n(wp,fp=bp),wp.prototype.get=function(t){var e=this,n=cp(t,this.ah),r=new Cl(this.ah);return fp.prototype.get.call(this,t).then(function(t){return new Rl(e.ah,r,n.lh,t._h,new Fp(!1,!1),n.fh)})},wp),dp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",yp=(mp.prototype.enableIndexedDbPersistence=function(t,e){throw new Pr(Sr.FAILED_PRECONDITION,dp)},mp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Pr(Sr.FAILED_PRECONDITION,dp)},mp.prototype.clearIndexedDbPersistence=function(t){throw new Pr(Sr.FAILED_PRECONDITION,dp)},mp),vp=(n(gp,lp=oc),Object.defineProperty(gp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),gp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},gp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&Nr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},gp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ep(r)];case 1:return e=t.sent(),[4,rp(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),Ga(t))]}})})})}(Ep(this.va))},gp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ep(r)];case 1:return e=t.sent(),[4,rp(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,Ba(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Ep(this.va))},gp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Rc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},gp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},gp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},gp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Xu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sh,[4,ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ep(this.va))},gp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Ep(t),e=Zu(e)?e:{next:e},i=new ic(e);return t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,op(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,op(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(gp.prototype,"app",{get:function(){if(!this.fl)throw new Pr(Sr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),gp.prototype.collection=function(t){try{return new Xp(this,vf(this.va,t))}catch(t){throw Pp(t,"collection()","Firestore.collection()")}},gp.prototype.doc=function(t){try{return new Lp(this,gf(this.va,t))}catch(t){throw Pp(t,"doc()","Firestore.doc()")}},gp.prototype.collectionGroup=function(t){try{return new Wp(this,function(t,e){if(Nc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Pr(Sr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Gl(t,null,new Ks(Qr.X(),e))}(this.va,t))}catch(t){throw Pp(t,"collectionGroup()","Firestore.collectionGroup()")}},gp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Xu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,tp(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new Yf(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Ep(n=this.va),function(t){return t=new pp(n,t),e(new Op(r,t))})},gp.prototype.batch=function(){var e=this;return Ep(this.va),new Rp(new ap(this.va,function(t){return xl(e.va,t)}))},gp);function gp(t,e,n){var r=this;return(r=lp.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof gr||(r.fl=t),r}function mp(){}function wp(t,e){var n=this;return(n=fp.call(this,t,e)||this).ah=t,n}function bp(t,e){this.ah=t,this.ll=e,this.al=If(t)}function Ep(t){return t.Eh||Tp(t),t.Eh.sl(),t.Eh}function Tp(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new vr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new Kf(t.Qa,t.wh,r)}var Ip,Ap,Np,Op=(n(Sp,Np=oc),Sp.prototype.get=function(t){var e=this,t=ed(t);return this.va.get(t).then(function(t){return new Gp(e.ah,t)})},Sp.prototype.set=function(t,e,n){return t=ed(t),n?(Oc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Sp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=ed(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Sp.prototype.delete=function(t){return t=ed(t),this.va.delete(t),this},Sp),Rp=(n(Dp,Ap=oc),Dp.prototype.set=function(t,e,n){return t=ed(t),n?(Oc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Dp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=ed(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Dp.prototype.delete=function(t){return t=ed(t),this.va.delete(t),this},Dp.prototype.commit=function(){return this.va.commit()},Dp),Lp=(n(kp,Ip=oc),kp.dl=function(t,e,n){if(t.length%2!=0)throw new Pr(Sr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new kp(e,new Fl(e.va,n,new Zr(t)))},kp.uh=function(t,e,n){return new kp(e,new Fl(e.va,n,t))},Object.defineProperty(kp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(kp.prototype,"parent",{get:function(){return new Xp(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(kp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),kp.prototype.collection=function(t){try{return new Xp(this.firestore,vf(this.va,t))}catch(t){throw Pp(t,"collection()","DocumentReference.collection()")}},kp.prototype.isEqual=function(t){return t instanceof oc&&(t=t.va),t instanceof Fl&&Ef(this.va,t)},kp.prototype.set=function(t,e){e=Oc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Sc(n.firestore,Tl),r=nd(n.fh,r,i),xl(o,Vf(If(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,vs.ce()))}catch(t){throw Pp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},kp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?jl(this.va,t):jl.apply(void 0,s([this.va,t,e],n))}catch(t){throw Pp(t,"updateDoc()","DocumentReference.update()")}},kp.prototype.delete=function(){return xl(Sc((t=this.va).firestore,Tl),[new Cs(t.lh,vs.ce())]);var t},kp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=_p(t),i=Vp(t,function(t){return new Gp(e.firestore,new Rl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return Ml(this.va,r,i)},kp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Cl(n),o=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof Hs?s.resolve(r):r instanceof Xs?s.resolve(null):s.reject(new Pr(Sr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=da(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Rl(n,i,e.lh,t,new Fp(t instanceof Hs&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,sp(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ql(n,e,t)})}:function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,sp(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ql(n,e,t)})})(this.va).then(function(t){return new Gp(e.firestore,new Rl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},kp.prototype.withConverter=function(t){return new kp(this.firestore,this.va.withConverter(t))},kp);function kp(t,e){var n=this;return(n=Ip.call(this,e)||this).firestore=t,n.hh=new ll(t),n}function Dp(){return null!==Ap&&Ap.apply(this,arguments)||this}function Sp(t,e){var n=this;return(n=Np.call(this,e)||this).ah=t,n}function Pp(t,e,n){return t.message=t.message.replace(e,n),t}function _p(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Zu(r))return r}return{}}function Vp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Zu(t[0])?t[0]:Zu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Cp,Up,jp,Mp,xp,qp,Fp=(td.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},td),Gp=(n(Zp,qp=oc),Object.defineProperty(Zp.prototype,"ref",{get:function(){return new Lp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),Zp.prototype.data=function(t){return this.va.data(t)},Zp.prototype.get=function(t,e){return this.va.get(t,e)},Zp.prototype.isEqual=function(t){return _l(this.va,t.va)},Zp),Bp=(n($p,xp=Gp),$p.prototype.data=function(t){return this.va.data(t)},$p),Wp=(n(Jp,Mp=oc),Jp.prototype.where=function(t,e,n){try{return new Jp(this.firestore,zl(this.va,(r=n,i=e,o=wl("where",t),new Jl(o,i,r))))}catch(t){throw Pp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Jp.prototype.orderBy=function(n,t){try{return new Jp(this.firestore,zl(this.va,function(t){void 0===t&&(t="asc");var e=t,t=wl("orderBy",n);return new $l(t,e)}(t)))}catch(n){throw Pp(n,/(orderBy|where)\(\)/,"Query.$1()")}},Jp.prototype.limit=function(t){try{return new Jp(this.firestore,zl(this.va,(Pc("limit",e=t),new Zl("limit",e,"F"))))}catch(t){throw Pp(t,"limit()","Query.limit()")}var e},Jp.prototype.limitToLast=function(t){try{return new Jp(this.firestore,zl(this.va,(Pc("limitToLast",e=t),new Zl("limitToLast",e,"L"))))}catch(t){throw Pp(t,"limitToLast()","Query.limitToLast()")}var e},Jp.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,zl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Pp(t,"startAt()","Query.startAt()")}},Jp.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,zl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Pp(t,"startAfter()","Query.startAfter()")}},Jp.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,zl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ef("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Pp(t,"endBefore()","Query.endBefore()")}},Jp.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,zl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ef("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Pp(t,"endAt()","Query.endAt()")}},Jp.prototype.isEqual=function(t){return Tf(this.va,t.va)},Jp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Cl(n),o=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ra(r,i,!0)];case 1:return n=t.sent(),e=new gh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=da(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new kl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Cl(n),o=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,up(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new kl(n,i,e,t)})}:function(e){var t=this,n=Sc(e.firestore,Tl),r=Ep(n),i=new Cl(n);ff(e.Rh);var o=new Xu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op(r)];case 1:return[4,up(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new kl(n,i,e,t)})})(this.va).then(function(t){return new Hp(e.firestore,t)})},Jp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=_p(t),i=Vp(t,function(t){return new Hp(e.firestore,t)});return Ml(this.va,r,i)},Jp.prototype.withConverter=function(t){return new Jp(this.firestore,this.va.withConverter(t))},Jp),zp=(n(Qp,jp=oc),Object.defineProperty(Qp.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"doc",{get:function(){return new Bp(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),Qp),Hp=(n(Kp,Up=oc),Object.defineProperty(Kp.prototype,"query",{get:function(){return new Wp(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new Bp(e.ah,t)})},enumerable:!1,configurable:!0}),Kp.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new zp(e.ah,t)})},Kp.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new Bp(r.ah,t))})},Kp.prototype.isEqual=function(t){return _l(this.va,t.va)},Kp),Xp=(n(Yp,Cp=Wp),Object.defineProperty(Yp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Lp(this.firestore,t):null},enumerable:!1,configurable:!0}),Yp.prototype.doc=function(t){try{return new Lp(this.firestore,void 0===t?gf(this.va):gf(this.va,t))}catch(t){throw Pp(t,"doc()","CollectionReference.doc()")}},Yp.prototype.add=function(t){var e,n=this,r=this.va,i=t;return t=Sc(r.firestore,Tl),e=gf(r),i=nd(r.fh,i),xl(t,Vf(If(r.firestore),"addDoc",e.lh,i,null!==r.fh,{}).Ph(e.lh,vs.exists(!1))).then(function(){return e}).then(function(t){return new Lp(n.firestore,t)})},Yp.prototype.isEqual=function(t){return Ef(this.va,t.va)},Yp.prototype.withConverter=function(t){return new Yp(this.firestore,this.va.withConverter(t))},Yp);function Yp(t,e){var n=this;return(n=Cp.call(this,t,e)||this).firestore=t,n.va=e,n}function Kp(t,e){var n=this;return(n=Up.call(this,e)||this).ah=t,n}function Qp(t,e){var n=this;return(n=jp.call(this,e)||this).ah=t,n}function Jp(t,e){var n=this;return(n=Mp.call(this,e)||this).firestore=t,n}function $p(){return null!==xp&&xp.apply(this,arguments)||this}function Zp(t,e){var n=this;return(n=qp.call(this,e)||this).ah=t,n}function td(t,e){this.hasPendingWrites=t,this.fromCache=e}function ed(t){return t instanceof oc&&(t=t.va),Sc(t,Fl)}function nd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var rd,id,l=(n(sd,id=oc),sd.documentId=function(){return new sd($r.nt().Y())},sd.prototype.isEqual=function(t){return t instanceof oc&&(t=t.va),t instanceof El&&this.va.dh.isEqual(t.dh)},sd),me=(n(od,rd=oc),od.serverTimestamp=function(){var t=new Gc("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new od(t)},od.delete=function(){var t=new Cc("deleteField");return t.ba="FieldValue.delete",new od(t)},od.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Bc("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new od(n)},od.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wc("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new od(n)},od.increment=function(t){return(t=new zc("increment",t)).ba="FieldValue.increment",new od(t)},od.prototype.isEqual=function(t){return this.va.isEqual(t.va)},od),me={Firestore:vp,GeoPoint:Hc,Timestamp:Yr,Blob:cl,Transaction:Op,WriteBatch:Rp,DocumentReference:Lp,DocumentSnapshot:Gp,Query:Wp,QueryDocumentSnapshot:Bp,QuerySnapshot:Hp,CollectionReference:Xp,FieldPath:l,FieldValue:me,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function od(){return null!==rd&&rd.apply(this,arguments)||this}function sd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return id.call(this,new(El.bind.apply(El,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new vp(e,new Tl(e,t),new yp);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});