!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(wv){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(wv),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=l=l||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A={},S=x||self;function O(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Q,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){Q=J;break t}}Q=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var rt,it=Y(Q,"Opera"),ot=Y(Q,"Trident")||Y(Q,"MSIE"),st=Y(Q,"Edge"),ut=st||ot,at=Y(Q,"Gecko")&&!(Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge"))&&!(Y(Q,"Trident")||Y(Q,"MSIE"))&&!Y(Q,"Edge"),ct=Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=Q,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var _t={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function xt(t){this.src=t,this.a={},this.b=0}function At(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Ot]=c=new xt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?At(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(At(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Nt(t)))}function Lt(t){return t in kt?kt[t]:kt[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Rt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new bt(e,this))}function Mt(t){return(t=t[Ot])instanceof xt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==k(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Ft(){q.call(this),this.c=new xt(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&At(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,q),Ft.prototype[Et]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},N.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=S.JSON.stringify;function zt(){this.b=this.a=null}var Kt,Ht=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Wt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then($t)}),Xt||(Kt(),Xt=!0),Jt.add(t,e)}zt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new zt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Xa,this),this.g=j()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==k(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Zt,Ft),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(I(re=ue,ie=ne=q),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){q.call(this),this.b=t,this.a={}}F(ae,q);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de=null;function ye(){return de=de||new Ft}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();qt(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function _e(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(ve,wt),F(me,wt),F(be,wt);var Ee={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ie={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Te(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function xe(){}Te.prototype.a=null;var Ae,x={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Se(){wt.call(this,"d")}function Oe(){wt.call(this,"c")}function ke(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(Se,wt),F(Oe,wt),F(ke,Te),Ae=new ke;var Pe=45e3,Ce={},Le={};function Re(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Ce:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ce){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),qe(t))}function Ue(t){t.T=j()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Ta,t),e)}function Fe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(M(u.Qa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),qe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Me(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},N.Ua=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,qe(this)):je(this,this.T-n)},(N=Ke.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function yn(t,e){return pn(t),e=gn(t,e),Qe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),K(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function xn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Sn(){this.a=new An}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=xn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var kn=S.JSON.parse;function Dn(t){Ft.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}F(Dn,Ft);var Pn="",Cn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))ee(t.za,0,t);else if(qt(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Pa=Gn("retryDelaySeedMs",1e4,t),this.Ka=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=j(),Ue(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Qn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Re(n,r,e)}function Jn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;P(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(M(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new De(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,qt(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=_e(M(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=U(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(On,o,i,"TestLoadImage: error",!1,r),i.onabort=U(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(On,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Qn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==xn(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.La)).F=t.C,e}function hr(){}function fr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Oe.call(this),this.status=1}function yr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Ae),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Dn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Sa())},N.Sa=function(){Un(this)},N.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=zn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},F(pr,Se),F(dr,Oe),F(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(xe.EventType=x).OPEN="a",x.CLOSE="b",x.ERROR="c",x.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Oa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.W,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var vr=Ee,gr=Ie,mr=xe,wr=Dn,br=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(xr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),xr.prototype.isEqual=function(t){return t instanceof xr&&t.projectId===this.projectId&&t.database===this.database},xr),Tr="8.0.2-20201012233953",Nr=new h("@firebase/firestore");function xr(t,e){this.projectId=t,this.database=e||"(default)"}function Ar(){return Nr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.DEBUG&&(e=n.map(Dr),Nr.debug.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.ERROR&&(e=n.map(Dr),Nr.error.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.WARN&&(e=n.map(Dr),Nr.warn.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t;throw Or(t),new Error(t)}function Cr(t){t||Pr()}var Lr=(Rr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Rr);function Rr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t){return t+"\0"}function jr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Fr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br,Gr,zr,Kr=(ui.prototype.get=function(t){var e=this.h(t),e=this._[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.l(o,t))return i}},ui.prototype.has=function(t){return void 0!==this.get(t)},ui.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},ui.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},ui.prototype.forEach=function(s){Fr(this._,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ui.prototype.T=function(){return qr(this._)},ui),Hr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Qr=(n(si,zr=Error),si),Wr=(oi.now=function(){return oi.fromMillis(Date.now())},oi.fromDate=function(t){return oi.fromMillis(t.getTime())},oi.fromMillis=function(t){var e=Math.floor(t/1e3);return new oi(e,1e6*(t-1e3*e))},oi.prototype.toDate=function(){return new Date(this.toMillis())},oi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},oi.prototype.I=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},oi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},oi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},oi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},oi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},oi),Yr=(ii.m=function(t){return new ii(t)},ii.min=function(){return new ii(new Wr(0,0))},ii.prototype.A=function(t){return this.timestamp.I(t.timestamp)},ii.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ii.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ii.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ii.prototype.P=function(){return this.timestamp},ii),Ee=(Object.defineProperty(ri.prototype,"length",{get:function(){return this.g},enumerable:!1,configurable:!0}),ri.prototype.isEqual=function(t){return 0===ri.V(this,t)},ri.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ri?t.forEach(function(t){e.push(t)}):e.push(t),this.p(e)},ri.prototype.limit=function(){return this.offset+this.length},ri.prototype.v=function(t){return t=void 0===t?1:t,this.p(this.segments,this.offset+t,this.length-t)},ri.prototype.S=function(){return this.p(this.segments,this.offset,this.length-1)},ri.prototype.D=function(){return this.segments[this.offset]},ri.prototype.C=function(){return this.get(this.length-1)},ri.prototype.get=function(t){return this.segments[this.offset+t]},ri.prototype.T=function(){return 0===this.length},ri.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ri.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ri.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ri.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},ri.V=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ri),Xr=(n(ni,Gr=Ee),ni.prototype.p=function(t,e,n){return new ni(t,e,n)},ni.prototype.M=function(){return this.O().join("/")},ni.prototype.toString=function(){return this.M()},ni.k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ni(n)},ni.$=function(){return new ni([])},ni),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$r=(n(ei,Br=Ee),ei.prototype.p=function(t,e,n){return new ei(t,e,n)},ei.L=function(t){return Jr.test(t)},ei.prototype.M=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ei.L(t)||(t="`"+t+"`"),t}).join(".")},ei.prototype.toString=function(){return this.M()},ei.prototype.B=function(){return 1===this.length&&"__name__"===this.get(0)},ei.q=function(){return new ei(["__name__"])},ei.U=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Qr(Hr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Qr(Hr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Qr(Hr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ei(e)},ei.$=function(){return new ei([])},ei),Zr=(ti.K=function(t){return new ti(Xr.k(t))},ti.W=function(t){return new ti(Xr.k(t).v(5))},ti.prototype.j=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ti.prototype.isEqual=function(t){return null!==t&&0===Xr.V(this.path,t.path)},ti.prototype.toString=function(){return this.path.toString()},ti.V=function(t,e){return Xr.V(t.path,e.path)},ti.G=function(t){return t.length%2==0},ti.H=function(t){return new ti(new Xr(t.slice()))},ti);function ti(t){this.path=t}function ei(){return null!==Br&&Br.apply(this,arguments)||this}function ni(){return null!==Gr&&Gr.apply(this,arguments)||this}function ri(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.g=n}function ii(t){this.timestamp=t}function oi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Qr(Hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Qr(Hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Qr(Hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Qr(Hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function si(t,e){var n=this;return(n=zr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ui(t,e){this.h=t,this.l=e,this._={}}function ai(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}function hi(t){return"number"==typeof t&&Number.isInteger(t)&&!ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var fi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.J=null};function li(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new fi(t,e,n,r,i,o,s)}function pi(t){var e=t;return null===e.J&&(t=e.path.M(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.M()+t.op.toString()+yo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.M()+t.dir}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Wu(e.startAt)),e.endAt&&(t+="|ub:",t+=Wu(e.endAt)),e.J=t),e.J}function di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!ho(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xu(t.startAt,e.startAt)&&Xu(t.endAt,e.endAt)}function yi(t){return Zr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.Y,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Y)},gi.prototype.X=function(){return 2*this.Y.length},gi.prototype.A=function(t){return Vr(this.Y,t.Y)},gi.prototype.isEqual=function(t){return this.Y===t.Y},gi);function gi(t){this.Y=t}vi.Z=new vi("");function mi(t){this.count=t}var wi,bi=(_i.prototype.nt=function(t){return new _i(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_i.prototype.st=function(t,e){return new _i(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_i.prototype.it=function(t){return new _i(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},_i);function _i(t,e,n,r,i,o,s){void 0===i&&(i=Yr.min()),void 0===o&&(o=Yr.min()),void 0===s&&(s=vi.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ei(t){switch(t){case Hr.OK:return Pr(),0;case Hr.CANCELLED:case Hr.UNKNOWN:case Hr.DEADLINE_EXCEEDED:case Hr.RESOURCE_EXHAUSTED:case Hr.INTERNAL:case Hr.UNAVAILABLE:case Hr.UNAUTHENTICATED:return;case Hr.INVALID_ARGUMENT:case Hr.NOT_FOUND:case Hr.ALREADY_EXISTS:case Hr.PERMISSION_DENIED:case Hr.FAILED_PRECONDITION:case Hr.ABORTED:case Hr.OUT_OF_RANGE:case Hr.UNIMPLEMENTED:case Hr.DATA_LOSS:return 1;default:return Pr(),0}}function Ii(t){if(void 0===t)return Or("GRPC error has no .code"),Hr.UNKNOWN;switch(t){case wi.OK:return Hr.OK;case wi.CANCELLED:return Hr.CANCELLED;case wi.UNKNOWN:return Hr.UNKNOWN;case wi.DEADLINE_EXCEEDED:return Hr.DEADLINE_EXCEEDED;case wi.RESOURCE_EXHAUSTED:return Hr.RESOURCE_EXHAUSTED;case wi.INTERNAL:return Hr.INTERNAL;case wi.UNAVAILABLE:return Hr.UNAVAILABLE;case wi.UNAUTHENTICATED:return Hr.UNAUTHENTICATED;case wi.INVALID_ARGUMENT:return Hr.INVALID_ARGUMENT;case wi.NOT_FOUND:return Hr.NOT_FOUND;case wi.ALREADY_EXISTS:return Hr.ALREADY_EXISTS;case wi.PERMISSION_DENIED:return Hr.PERMISSION_DENIED;case wi.FAILED_PRECONDITION:return Hr.FAILED_PRECONDITION;case wi.ABORTED:return Hr.ABORTED;case wi.OUT_OF_RANGE:return Hr.OUT_OF_RANGE;case wi.UNIMPLEMENTED:return Hr.UNIMPLEMENTED;case wi.DATA_LOSS:return Hr.DATA_LOSS;default:return Pr()}}(Ie=wi=wi||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var Ti=(Oi.prototype.rt=function(t,e){return new Oi(this.V,this.root.rt(t,e,this.V).copy(null,null,xi.ot,null,null))},Oi.prototype.remove=function(t){return new Oi(this.V,this.root.remove(t,this.V).copy(null,null,xi.ot,null,null))},Oi.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.V(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Oi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.V(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Oi.prototype.T=function(){return this.root.T()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Oi.prototype.at=function(){return this.root.at()},Oi.prototype.ct=function(){return this.root.ct()},Oi.prototype.ut=function(t){return this.root.ut(t)},Oi.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Oi.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Oi.prototype.ht=function(t){return this.root.ht(t)},Oi.prototype.lt=function(){return new Ni(this.root,null,this.V,!1)},Oi.prototype._t=function(t){return new Ni(this.root,t,this.V,!1)},Oi.prototype.ft=function(){return new Ni(this.root,null,this.V,!0)},Oi.prototype.dt=function(t){return new Ni(this.root,t,this.V,!0)},Oi),Ni=(Si.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.T();)this.Tt.push(t),t=t.left;return e},Si.prototype.It=function(){return 0<this.Tt.length},Si.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Si),xi=(Ai.prototype.copy=function(t,e,n,r,i){return new Ai(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ai.prototype.T=function(){return!1},Ai.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},Ai.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ai.prototype.min=function(){return this.left.T()?this:this.left.min()},Ai.prototype.at=function(){return this.min().key},Ai.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},Ai.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ai.prototype.Pt=function(){if(this.left.T())return Ai.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},Ai.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.T()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.yt()),r.right.T()||r.right.gt()||r.right.left.gt()||(r=r.vt()),0===e(t,r.key)){if(r.right.T())return Ai.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ai.prototype.gt=function(){return this.color},Ai.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.bt()),t.left.gt()&&t.left.left.gt()&&(t=t.yt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},Ai.prototype.Vt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.yt())).bt()).St()),t},Ai.prototype.vt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.yt()).St()),t},Ai.prototype.bt=function(){var t=this.copy(null,null,Ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ai.prototype.yt=function(){var t=this.copy(null,null,Ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ai.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ai.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Ai.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw Pr();if(this.right.gt())throw Pr();var t=this.left.Ct();if(t!==this.right.Ct())throw Pr();return t+(this.gt()?0:1)},Ai);function Ai(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ai.RED,this.left=null!=r?r:Ai.EMPTY,this.right=null!=i?i:Ai.EMPTY,this.size=this.left.size+1+this.right.size}function Si(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function Oi(t,e){this.V=t,this.root=e||xi.EMPTY}function ki(){this.size=0}xi.EMPTY=null,xi.RED=!0,xi.ot=!1,xi.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.rt=function(t,e,n){return new xi(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype.T=function(){return!0},ki.prototype.ut=function(t){return!1},ki.prototype.ht=function(t){return!1},ki.prototype.at=function(){return null},ki.prototype.ct=function(){return null},ki.prototype.gt=function(){return!1},ki.prototype.Dt=function(){return!0},ki.prototype.Ct=function(){return 0},new ki);var Di=(Ri.prototype.has=function(t){return null!==this.data.get(t)},Ri.prototype.first=function(){return this.data.at()},Ri.prototype.last=function(){return this.data.ct()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ri.prototype.indexOf=function(t){return this.data.indexOf(t)},Ri.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},Ri.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.V(r.key,t[1]))return;e(r.key)}},Ri.prototype.xt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},Ri.prototype.Ft=function(t){t=this.data._t(t);return t.It()?t.Et().key:null},Ri.prototype.lt=function(){return new Pi(this.data.lt())},Ri.prototype._t=function(t){return new Pi(this.data._t(t))},Ri.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},Ri.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ri.prototype.T=function(){return this.data.T()},Ri.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ri.prototype.isEqual=function(t){if(!(t instanceof Ri))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.V(r,i))return!1}return!0},Ri.prototype.O=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ri.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ri.prototype.copy=function(t){var e=new Ri(this.V);return e.data=t,e},Ri),Pi=(Li.prototype.Et=function(){return this.Mt.Et().key},Li.prototype.It=function(){return this.Mt.It()},Li),Ci=new Ti(Zr.V);function Li(t){this.Mt=t}function Ri(t){this.V=t,this.data=new Ti(this.V)}var Vi=new Ti(Zr.V);var Mi=new Ti(Zr.V),Ui=new Di(Zr.V);function ji(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ui,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Fi=new Di(Vr);var qi=(ro.Lt=function(t){return new ro(t.V)},ro.prototype.has=function(t){return null!=this.kt.get(t)},ro.prototype.get=function(t){return this.kt.get(t)},ro.prototype.first=function(){return this.$t.at()},ro.prototype.last=function(){return this.$t.ct()},ro.prototype.T=function(){return this.$t.T()},ro.prototype.indexOf=function(t){t=this.kt.get(t);return t?this.$t.indexOf(t):-1},Object.defineProperty(ro.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),ro.prototype.forEach=function(n){this.$t.ut(function(t,e){return n(t),!1})},ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.rt(t.key,t),e.$t.rt(t,null))},ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},ro.prototype.isEqual=function(t){if(!(t instanceof ro))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.lt(),n=t.$t.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ro.prototype.copy=function(t,e){var n=new ro;return n.V=this.V,n.kt=t,n.$t=e,n},ro),Bi=(no.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Pr()},no.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},no),Gi=(eo.jt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new eo(t,e,qi.Lt(e),i,n,r,!0,!1)},Object.defineProperty(eo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),eo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Kt===t.Kt&&this.Qt.isEqual(t.Qt)&&gu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},eo),zi=(to.Yt=function(t,e){var n=new Map;return n.set(t,Ki.Xt(t,e)),new to(Yr.min(),n,Fi,Ci,ji())},to),Ki=(Zi.Xt=function(t,e){return new Zi(vi.Z,e,ji(),ji(),ji())},Zi),Hi=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Qi=function(t,e){this.targetId=t,this.re=e},Wi=function(t,e,n,r){void 0===n&&(n=vi.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Yi=(Object.defineProperty($i.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),$i.prototype.fe=function(t){0<t.X()&&(this.he=!0,this.ce=t)},$i.prototype.de=function(){var n=ji(),r=ji(),i=ji();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new Ki(this.ce,this.ue,n,r,i)},$i.prototype.we=function(){this.he=!1,this.ae=oo()},$i.prototype.Te=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},$i.prototype.Ee=function(t){this.he=!0,this.ae=this.ae.remove(t)},$i.prototype.Ie=function(){this.oe+=1},$i.prototype.me=function(){--this.oe},$i.prototype.Ae=function(){this.he=!0,this.ue=!0},$i),Xi=(Ji.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof $s?this.ve(r,t.ie):t.ie instanceof Zs&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Ji.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.me(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.me(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.xe(t),e.fe(n.resumeToken));break;default:Pr()}})},Ji.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},Ji.prototype.Fe=function(t){var e=t.targetId,n=t.re.count,t=this.Oe(e);t&&(yi(t=t.target)?0===n?(t=new Zr(t.path),this.be(e,t,new Zs(t,Yr.min()))):Cr(1===n):this.Me(e)!==n&&(this.xe(e),this.ye=this.ye.add(e)))},Ji.prototype.ke=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.Oe(e);n&&(t.Zt&&yi(n.target)&&(n=new Zr(n.target.path),null!==i.ge.get(n)||i.$e(e,n)||i.be(e,n,new Zs(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ji();this.Ve.forEach(function(t,e){var n=!0;e.xt(function(t){t=i.Oe(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new zi(r,o,this.ye,this.ge,s);return this.ge=Ci,this.Ve=io(),this.ye=new Di(Vr),t},Ji.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.$e(t,e.key)?2:0,this.Ce(t).Te(e.key,n),this.ge=this.ge.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Le(e.key).add(t)))},Ji.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.$e(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},Ji.prototype.removeTarget=function(t){this.Pe.delete(t)},Ji.prototype.Me=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},Ji.prototype.Ie=function(t){this.Ce(t).Ie()},Ji.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Yi,this.Pe.set(t,e)),e},Ji.prototype.Le=function(t){var e=this.Ve.get(t);return e||(e=new Di(Vr),this.Ve=this.Ve.rt(t,e)),e},Ji.prototype.Ne=function(t){var e=null!==this.Oe(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},Ji.prototype.Oe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},Ji.prototype.xe=function(e){var n=this;this.Pe.set(e,new Yi),this.Re.Be(e).forEach(function(t){n.be(e,t,null)})},Ji.prototype.$e=function(t,e){return this.Re.Be(t).has(e)},Ji);function Ji(t){this.Re=t,this.Pe=new Map,this.ge=Ci,this.Ve=io(),this.ye=new Di(Vr)}function $i(){this.oe=0,this.ae=oo(),this.ce=vi.Z,this.ue=!1,this.he=!0}function Zi(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function to(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function eo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Kt=s,this.Wt=u}function no(){this.Bt=new Ti(Zr.V)}function ro(n){this.V=n?function(t,e){return n(t,e)||Zr.V(t.key,e.key)}:function(t,e){return Zr.V(t.key,e.key)},this.kt=Vi,this.$t=new Ti(this.V)}function io(){return new Ti(Zr.V)}function oo(){return new Ti(Zr.V)}function so(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function uo(t){t=vo(t.mapValue.fields.__local_write_time__.timestampValue);return new Wr(t.seconds,t.nanos)}var ao=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?so(t)?4:10:Pr()}function ho(r,i){var t,e=co(r);if(e!==co(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return uo(r).isEqual(uo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=vo(r.timestampValue),t=vo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,mo(r.bytesValue).isEqual(mo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,go((t=r).geoPointValue.latitude)===go(e.geoPointValue.latitude)&&go(t.geoPointValue.longitude)===go(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return go(t.integerValue)===go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=go(t.doubleValue),e=go(e.doubleValue);return t===e?ci(t)===ci(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],ho);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(jr(e)!==jr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!ho(e[t],n[t])))return!1;return!0}();default:return Pr()}}function fo(t,e){return void 0!==(t.values||[]).find(function(t){return ho(t,e)})}function lo(t,e){var n,r,i=co(t),o=co(e);if(i!==o)return Vr(i,o);switch(i){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return n=e,r=go(t.integerValue||t.doubleValue),n=go(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return po(t.timestampValue,e.timestampValue);case 4:return po(uo(t),uo(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){t=mo(t),e=mo(e);return t.A(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Vr(go(i.latitude),go(r.latitude)))?n:Vr(go(i.longitude),go(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=lo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;u=lo(n[r[s]],i[o[s]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function po(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=vo(t),t=vo(e),e=Vr(n.seconds,t.seconds);return 0!==e?e:Vr(n.nanos,t.nanos)}function yo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=vo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?mo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Zr.W(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function vo(t){if(Cr(!!t),"string"!=typeof t)return{seconds:go(t.seconds),nanos:go(t.nanos)};var e=0,n=ao.exec(t);Cr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mo(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function wo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.M()}}function bo(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function Eo(t){return t&&"nullValue"in t}function Io(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function To(t){return t&&"mapValue"in t}var No={asc:"ASCENDING",desc:"DESCENDING"},xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ao=function(t,e){this.t=t,this.Ue=e};function So(t){return{integerValue:""+t}}function Oo(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function ko(t,e){return hi(e)?So(e):Oo(t,e)}function Do(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Po(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function Co(t){return Cr(!!t),Yr.m((t=vo(t),new Wr(t.seconds,t.nanos)))}function Lo(t,e){return new Xr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).M()}function Ro(t){t=Xr.k(t);return Cr(Zo(t)),t}function Vo(t,e){return Lo(t.t,e.path)}function Mo(t,e){e=Ro(e);if(e.get(1)!==t.t.projectId)throw new Qr(Hr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Qr(Hr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new Zr(qo(e))}function Uo(t,e){return Lo(t.t,e)}function jo(t){t=Ro(t);return 4===t.length?Xr.$():qo(t)}function Fo(t){return new Xr(["projects",t.t.projectId,"databases",t.t.database]).M()}function qo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.v(5)}function Bo(t,e,n){return{name:Vo(t,e),fields:n.proto.mapValue.fields}}function Go(t,e){var n,r,i;if(e instanceof ks)n={update:Bo(t,e.key,e.value)};else if(e instanceof qs)n={delete:Vo(t,e.key)};else if(e instanceof Ds)n={update:Bo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.M())}),{fieldPaths:r})};else if(e instanceof Vs)n={transform:{document:Vo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof rs)return{fieldPath:t.field.M(),setToServerValue:"REQUEST_TIME"};if(e instanceof is)return{fieldPath:t.field.M(),appendMissingElements:{values:e.elements}};if(e instanceof cs)return{fieldPath:t.field.M(),removeAllFromArray:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.M(),increment:e.Ke};throw Pr()})}};else{if(!(e instanceof Bs))return Pr();n={verify:Vo(t,e.key)}}return e.je.We||(n.currentDocument=void 0!==(i=e.je).updateTime?{updateTime:(e=t,t=i.updateTime,Do(e,t.P()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function zo(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?_s.updateTime(Co(o.updateTime)):void 0!==o.exists?_s.exists(o.exists):_s.Ge():_s.Ge();if(t.update){t.update.name;var r=Mo(e,t.update.name),i=new Gs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new gs(o.map(function(t){return $r.U(t)})));return new Ds(r,i,o,n)}return new ks(r,i,n)}if(t.delete){var s=Mo(e,t.delete);return new qs(s,n)}if(t.transform){i=Mo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),r=new rs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new is(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new cs(n)):"increment"in e?r=new ps(t,e.increment):Pr();e=$r.U(e.fieldPath);return new ms(e,r)}(e,t)});return Cr(!0===n.exists),new Vs(i,s)}if(t.verify){t=Mo(e,t.verify);return new Bs(t,n)}return Pr()}function Ko(t,e){return{documents:[Uo(t,e.path)]}}function Ho(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.S()),n.structuredQuery.from=[{collectionId:r.C()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Io(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Io(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,xo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo((t=t).field),direction:(t=t.dir,No[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ue||ai(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Wo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wo(e.endAt)),n}function Qo(t){var e=jo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Cr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[$o(t)]:void 0!==t.fieldFilter?[(n=t,Iu.create(Jo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Ju(Jo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=ai(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Yo(n.startAt));var u=null;return n.endAt&&(u=Yo(n.endAt)),ou(e,i,t,o,r,"F",s,u)}function Wo(t){return{before:t.before,values:t.position}}function Yo(t){var e=!!t.before,t=t.values||[];return new Gu(t,e)}function Xo(t){return{fieldPath:t.M()}}function Jo(t){return $r.U(t.fieldPath)}function $o(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Jo(t.unaryFilter.field);return Iu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Jo(t.unaryFilter.field);return Iu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Jo(t.unaryFilter.field);return Iu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=Jo(t.unaryFilter.field);return Iu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function Zo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.ze=void 0};function ts(t,e){return t instanceof ps?bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var es,ns,rs=(n(ss,ns=h),ss),is=(n(os,es=h),os);function os(t){var e=this;return(e=es.call(this)||this).elements=t,e}function ss(){return null!==ns&&ns.apply(this,arguments)||this}function us(t,e){for(var n=vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return ho(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var as,cs=(n(hs,as=h),hs);function hs(t){var e=this;return(e=as.call(this)||this).elements=t,e}function fs(t,e){for(var n=vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!ho(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=h),ds);function ds(t,e){var n=this;return(n=ls.call(this)||this).serializer=t,n.Ke=e,n}function ys(t){return go(t.integerValue||t.doubleValue)}function vs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var gs=(ws.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},ws.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ws),ms=function(t,e){this.field=t,this.transform=e};function ws(t){(this.fields=t).sort($r.V)}function bs(t,e){this.version=t,this.transformResults=e}var _s=(Es.Ge=function(){return new Es},Es.exists=function(t){return new Es(void 0,t)},Es.updateTime=function(t){return new Es(t)},Object.defineProperty(Es.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Es.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Es);function Es(t,e){this.updateTime=t,this.exists=e}function Is(t,e){return void 0!==t.updateTime?e instanceof $s&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof $s}Ee=function(){};function Ts(t,e,n){return t instanceof ks?new $s(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ds?function(t,e,n){if(!Is(t.je,e))return new tu(t.key,n.version);e=Ls(t,e);return new $s(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Vs?function(t,e,n){if(Cr(null!=n.transformResults),!Is(t.je,e))return new tu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof $s&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof is?us(o,s):o instanceof cs?fs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Us(t,r.data(),e);return new $s(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Zs(t.key,n.version,{hasCommittedMutations:!0})}function Ns(t,e,n,r){return t instanceof ks?function(t,e){if(!Is(t.je,e))return e;e=As(e);return new $s(t.key,e,t.value,{Je:!0})}(t,e):t instanceof Ds?function(t,e){if(!Is(t.je,e))return e;var n=As(e),e=Ls(t,e);return new $s(t.key,n,e,{Je:!0})}(t,e):t instanceof Vs?function(t,e,n,r){if(!Is(t.je,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof $s&&(h=n.field(a.field)),null===h&&r instanceof $s&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof rs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof is?us(c,i):c instanceof cs?fs(c,i):(c=ts(h=c,i),i=ys(c)+ys(h.Ke),bo(c)&&bo(h.Ke)?So(i):Oo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Us(t,i.data(),r);return new $s(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Is((t=t).je,e)?new Zs(t.key,Yr.min()):e)}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.je.isEqual(e.je)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof is&&e instanceof is||t instanceof cs&&e instanceof cs?Mr(t.elements,e.elements,ho):t instanceof ps&&e instanceof ps?ho(t.Ke,e.Ke):t instanceof rs&&e instanceof rs)}))}function As(t){return t instanceof $s?t.version:Yr.min()}var Ss,Os,ks=(n(Cs,Os=Ee),Cs),Ds=(n(Ps,Ss=Ee),Ps);function Ps(t,e,n,r){var i=this;return(i=Ss.call(this)||this).key=t,i.data=e,i.Qe=n,i.je=r,i.type=1,i}function Cs(t,e,n){var r=this;return(r=Os.call(this)||this).key=t,r.value=e,r.je=n,r.type=0,r}function Ls(t,e){return n=t,e=e instanceof $s?e.data():Gs.empty(),r=new zs(e),n.Qe.fields.forEach(function(t){var e;t.T()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var Rs,Vs=(n(Ms,Rs=Ee),Ms);function Ms(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.je=_s.exists(!0),n}function Us(t,e,n){for(var r=new zs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var js,Fs,qs=(n(Ws,Fs=Ee),Ws),Bs=(n(Qs,js=Ee),Qs),Gs=(Hs.empty=function(){return new Hs({mapValue:{}})},Hs.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!To(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null},Hs.prototype.isEqual=function(t){return ho(this.proto,t.proto)},Hs),zs=(Ks.prototype.set=function(t,e){return this.tn(t,e),this},Ks.prototype.delete=function(t){return this.tn(t,null),this},Ks.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===co(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.C(),e)},Ks.prototype.Ye=function(){var t=this.en($r.$(),this.Ze);return null!=t?new Gs(t):this.Xe},Ks.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=To(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ks);function Ks(t){void 0===t&&(t=Gs.empty()),this.Xe=t,this.Ze=new Map}function Hs(t){this.proto=t}function Qs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.je=e,n.type=4,n}function Ws(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.je=e,n.type=3,n}var Ys,Xs,Js,Ie=function(t,e){this.key=t,this.version=e},$s=(n(iu,Js=Ie),iu.prototype.field=function(t){return this.nn.field(t)},iu.prototype.data=function(){return this.nn},iu.prototype.sn=function(){return this.nn.proto},iu.prototype.isEqual=function(t){return t instanceof iu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},iu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),iu),Zs=(n(ru,Xs=Ie),ru.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ru.prototype.isEqual=function(t){return t instanceof ru&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ru),tu=(n(nu,Ys=Ie),nu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),eu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null,this.startAt,this.endAt};function nu(){return null!==Ys&&Ys.apply(this,arguments)||this}function ru(t,e,n){var r=this;return(r=Xs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function iu(t,e,n,r){var i=this;return(i=Js.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function ou(t,e,n,r,i,o,s,u){return new eu(t,e,n,r,i,o,s,u)}function su(t){return new eu(t)}function uu(t){return!ai(t.limit)&&"F"===t.limitType}function au(t){return!ai(t.limit)&&"L"===t.limitType}function cu(t){return 0<t.rn.length?t.rn[0].field:null}function hu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function fu(t){return null!==t.collectionGroup}function lu(t){var e=t;if(null===e.on){e.on=[];var n=hu(e),t=cu(e);if(null!==n&&null===t)n.B()||e.on.push(new Ju(n)),e.on.push(new Ju($r.q(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.B()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new Ju($r.q(),n)))}}return e.on}function pu(t){var e=t;if(!e.an)if("F"===e.limitType)e.an=li(e.path,e.collectionGroup,lu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=lu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ju(o.field,s))}var u=e.endAt?new Gu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Gu(e.startAt.position,!e.startAt.before):null;e.an=li(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function du(t,e,n){return new eu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function yu(t,e){return new eu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function vu(t,e){return new eu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function gu(t,e){return di(pu(t),pu(e))&&t.limitType===e.limitType}function mu(t){return pi(pu(t))+"|lt:"+t.limitType}function wu(t){return"Query(target="+(e=pu(t),n=e.path.M(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.M()+" "+t.op+" "+yo(t.value)}).join(", ")+"]"),ai(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.M()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Wu(e.startAt)),e.endAt&&(n+=", endAt: "+Wu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function bu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.j(e.collectionGroup)&&e.path.N(n):Zr.G(e.path)?e.path.isEqual(n):e.path.F(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.B()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Yu(t.startAt,lu(t),n))&&(!t.endAt||!Yu(t.endAt,lu(t),n)));var e,n}function _u(u){return function(t,e){for(var n=!1,r=0,i=lu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.B()?Zr.V(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?lo(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.B()}return 0}}var Eu,Iu=(n(Tu,Eu=function(){}),Tu.create=function(t,e,n){return t.B()?"in"===e||"not-in"===e?this.un(t,e,n):new Su(t,e,n):"array-contains"===e?new ju(t,n):"in"===e?new Fu(t,n):"not-in"===e?new qu(t,n):"array-contains-any"===e?new Bu(t,n):new Tu(t,e,n)},Tu.un=function(t,e,n){return new("in"===e?Ou:ku)(t,n)},Tu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.hn(lo(t,this.value)):null!==t&&co(this.value)===co(t)&&this.hn(lo(t,this.value))},Tu.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Tu.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Tu);function Tu(t,e,n){var r=this;return(r=Eu.call(this)||this).field=t,r.op=e,r.value=n,r}var Nu,xu,Au,Su=(n(Cu,Au=Iu),Cu.prototype.matches=function(t){t=Zr.V(t.key,this.key);return this.hn(t)},Cu),Ou=(n(Pu,xu=Iu),Pu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Pu),ku=(n(Du,Nu=Iu),Du.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Du);function Du(t,e){var n=this;return(n=Nu.call(this,t,"not-in",e)||this).keys=Lu(0,e),n}function Pu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=Lu(0,e),n}function Cu(t,e,n){var r=this;return(r=Au.call(this,t,e,n)||this).key=Zr.W(n.referenceValue),r}function Lu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Zr.W(t.referenceValue)})}var Ru,Vu,Mu,Uu,ju=(n(Qu,Uu=Iu),Qu.prototype.matches=function(t){t=t.field(this.field);return _o(t)&&fo(t.arrayValue,this.value)},Qu),Fu=(n(Hu,Mu=Iu),Hu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&fo(this.value.arrayValue,t)},Hu),qu=(n(Ku,Vu=Iu),Ku.prototype.matches=function(t){if(fo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!fo(this.value.arrayValue,t)},Ku),Bu=(n(zu,Ru=Iu),zu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!_o(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return fo(e.value.arrayValue,t)})},zu),Gu=function(t,e){this.position=t,this.before=e};function zu(t,e){return Ru.call(this,t,"array-contains-any",e)||this}function Ku(t,e){return Vu.call(this,t,"not-in",e)||this}function Hu(t,e){return Mu.call(this,t,"in",e)||this}function Qu(t,e){return Uu.call(this,t,"array-contains",e)||this}function Wu(t){return(t.before?"b":"a")+":"+t.position.map(yo).join(",")}function Yu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.B()?Zr.V(Zr.W(s.referenceValue),n.key):lo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Xu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ho(t.position[n],e.position[n]))return!1;return!0}var Ju=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var $u,Zu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ta=(ca.prototype.reset=function(){this.Tn=0},ca.prototype.mn=function(){this.Tn=this.wn},ca.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Rn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.Pn(this._n,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.dn,this.Tn<this.fn&&(this.Tn=this.fn),this.Tn>this.wn&&(this.Tn=this.wn)},ca.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},ca.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ca.prototype.Rn=function(){return(Math.random()-.5)*this.Tn},ca),ea=(aa.prototype.catch=function(t){return this.next(void 0,t)},aa.prototype.next=function(r,i){var o=this;return this.bn&&Pr(),this.bn=!0,this.vn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new aa(function(e,n){o.yn=function(t){o.Dn(r,t).next(e,n)},o.pn=function(t){o.Sn(i,t).next(e,n)}})},aa.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},aa.prototype.Nn=function(t){try{var e=t();return e instanceof aa?e:aa.resolve(e)}catch(t){return aa.reject(t)}},aa.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):aa.resolve(e)},aa.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):aa.reject(e)},aa.resolve=function(n){return new aa(function(t,e){t(n)})},aa.reject=function(n){return new aa(function(t,e){e(n)})},aa.xn=function(t){return new aa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},aa.Fn=function(t){for(var n=aa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?aa.resolve(t):e()})}(r[e]);return n},aa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},aa),na=(ua.delete=function(t){return Sr("SimpleDb","Removing database:",t),ya(window.indexedDB.deleteDatabase(t)).Cn()},ua.kn=function(){if("undefined"==typeof indexedDB)return!1;if(ua.$n())return!0;var t=p(),e=ua.Mn(t),n=0<e&&e<10,e=ua.Ln(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},ua.$n=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},ua.qn=function(t,e){return t.store(e)},ua.Mn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},ua.Ln=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},ua.prototype.Un=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ia(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Qr(Hr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ia(o,t))},r.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.On.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Sr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return i.Qn(t)}),this.db)]}})})},ua.prototype.Kn=function(e){this.Qn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ua.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Un(u)];case 2:return s.db=t.sent(),e=fa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ea.reject(t)}).Cn(),r={},n.catch(function(){}),[4,e.Wn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Sr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ua.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ua),ra=(Object.defineProperty(sa.prototype,"vn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(sa.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(sa.prototype,"cursor",{set:function(t){this.jn=t},enumerable:!1,configurable:!0}),sa.prototype.done=function(){this.Gn=!0},sa.prototype.Jn=function(t){this.zn=t},sa.prototype.delete=function(){return ya(this.jn.delete())},sa),ia=(n(oa,$u=Qr),oa);function oa(t,e){var n=this;return(n=$u.call(this,Hr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function sa(t){this.jn=t,this.Gn=!1,this.zn=null}function ua(t,e,n){this.name=t,this.version=e,this.On=n,12.2===ua.Mn(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function aa(t){var e=this;this.yn=null,this.pn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.yn&&e.yn(t)},function(t){e.vn=!0,e.error=t,e.pn&&e.pn(t)})}function ca(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function ha(t){return"IndexedDbTransactionError"===t.name}var fa=(da.open=function(t,e,n,r){try{return new da(e,t.transaction(r,n))}catch(t){throw new ia(e,t)}},Object.defineProperty(da.prototype,"Wn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),da.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},da.prototype.store=function(t){t=this.transaction.objectStore(t);return new la(t)},da),la=(pa.prototype.put=function(t,e){t=void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return ya(t)},pa.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),ya(this.store.add(t))},pa.prototype.get=function(e){var n=this;return ya(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},pa.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),ya(this.store.delete(t))},pa.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),ya(this.store.count())},pa.prototype.Xn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Zn(e,function(t,e){n.push(e)}).next(function(){return n})},pa.prototype.ts=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.es=!1;e=this.cursor(e);return this.Zn(e,function(t,e,n){return n.delete()})},pa.prototype.ns=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Zn(n,e)},pa.prototype.ss=function(r){var t=this.cursor({});return new ea(function(n,e){t.onerror=function(t){t=ga(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},pa.prototype.Zn=function(t,i){var o=[];return new ea(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new ra(n),(t=i(n.primaryKey,n.value,e))instanceof ea&&(t=t.catch(function(t){return e.done(),ea.reject(t)}),o.push(t)),e.vn?r():null===e.Hn?n.continue():n.continue(e.Hn)):r()}}).next(function(){return ea.xn(o)})},pa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},pa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},pa);function pa(t){this.store=t}function da(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Yn=new Zu,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){t.error?n.Yn.reject(new ia(e,t.error)):n.Yn.resolve()},this.transaction.onerror=function(t){t=ga(t.target.error);n.Yn.reject(new ia(e,t))}}function ya(t){return new ea(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=ga(t.target.error);n(t)}})}var va=!1;function ga(t){var e=na.Mn(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return va||(va=!0,setTimeout(function(){throw n},0)),n}}return t}function ma(){return"undefined"!=typeof window?window:null}function wa(){return"undefined"!=typeof document?document:null}var ba=(Ia.hs=function(t,e,n,r,i){i=new Ia(t,e,Date.now()+n,r,i);return i.start(n),i},Ia.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},Ia.prototype.Vn=function(){return this._s()},Ia.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.us.reject(new Qr(Hr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ia.prototype._s=function(){var e=this;this.rs.fs(function(){return null!==e.ls?(e.clearTimeout(),e.op().then(function(t){return e.us.resolve(t)})):Promise.resolve()})},Ia.prototype.clearTimeout=function(){null!==this.ls&&(this.cs(this),clearTimeout(this.ls),this.ls=null)},Ia),_a=(Object.defineProperty(Ea.prototype,"Vs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),Ea.prototype.fs=function(t){this.enqueue(t)},Ea.prototype.ys=function(t){this.ps(),this.vs(t)},Ea.prototype.bs=function(){var t;this.Ts||(this.Ts=!0,(t=wa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs))},Ea.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.vs(t)},Ea.prototype.Ss=function(t){var e=this;this.fs(function(){return e.ws.push(t),e.Ds()})},Ea.prototype.Ds=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.ws.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return t.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!ha(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ws.length&&this.Ps.An(function(){return n.Ds()}),t.label=5;case 5:return[2]}})})},Ea.prototype.vs=function(t){var r=this,e=this.ds.then(function(){return r.As=!0,t().catch(function(t){throw r.Is=t,r.As=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.As=!1,t})});return this.ds=e},Ea.prototype.Pn=function(t,e,n){var r=this;this.ps(),-1<this.Rs.indexOf(t)&&(e=0);n=ba.hs(this,t,e,n,function(t){return r.Cs(t)});return this.Es.push(n),n},Ea.prototype.ps=function(){this.Is&&Pr()},Ea.prototype.Ns=function(){},Ea.prototype.xs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.ds)return[3,0];t.label=3;case 3:return[2]}})})},Ea.prototype.Fs=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},Ea.prototype.Os=function(r){var i=this;return this.xs().then(function(){i.Es.sort(function(t,e){return t.os-e.os});for(var t=0,e=i.Es;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n._n===r)break}return i.xs()})},Ea.prototype.Ms=function(t){this.Rs.push(t)},Ea.prototype.Cs=function(t){t=this.Es.indexOf(t);this.Es.splice(t,1)},Ea);function Ea(){var e=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new ta(this,"async_queue_retry"),this.gs=function(){var t=wa();t&&Sr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ps.gn()};var t=wa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.gs)}function Ia(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.cs=i,this.us=new Zu,this.then=this.us.promise.then.bind(this.us.promise),this.us.promise.catch(function(t){})}function Ta(t,e){if(Or("AsyncQueue",e+": "+t),ha(t))return new Qr(Hr.UNAVAILABLE,e+": "+t);throw t}function Na(){this.queries=new Kr(mu,gu),this.onlineState="Unknown",this.$s=new Set}var xa=function(){this.ks=void 0,this.listeners=[]};function Aa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new xa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ls(n)];case 2:return o.ks=t.sent(),[3,4];case 3:return o=t.sent(),o=Ta(o,"Initialization of query '"+wu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Bs(e.onlineState),i.ks&&u.qs(i.ks)&&Oa(e),[2]}})})}function Sa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Us(n))]:[2]})})}function Oa(t){t.$s.forEach(function(t){t.next()})}var ka=(Ca.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Gi(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Kt,!0)}var o=!1;return this.Ks?this.js(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.Ws=t,o},Ca.prototype.onError=function(t){this.Qs.error(t)},Ca.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.Ws&&!this.Ks&&this.Gs(this.Ws,t)&&(this.zs(this.Ws),e=!0),e},Ca.prototype.Gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Hs&&n||t.docs.T()&&"Offline"!==e)},Ca.prototype.js=function(t){if(0<t.docChanges.length)return!0;var e=this.Ws&&this.Ws.hasPendingWrites!==t.hasPendingWrites;return!(!t.Kt&&!e)&&!0===this.options.includeMetadataChanges},Ca.prototype.zs=function(t){t=Gi.jt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.Qs.next(t)},Ca),Da=(Pa.prototype.Js=function(){return null!=this.uid},Pa.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},Pa.prototype.isEqual=function(t){return t.uid===this.uid},Pa);function Pa(t){this.uid=t}function Ca(t,e,n){this.query=t,this.Qs=e,this.Ks=!1,this.Ws=null,this.onlineState="Unknown",this.options=n||{}}Da.UNAUTHENTICATED=new Da(null),Da.Xs=new Da("google-credentials-uid"),Da.Zs=new Da("first-party-uid");function La(t,e){this.user=e,this.type="OAuth",this.ti={},this.ti.Authorization="Bearer "+t}var Ra=(Qa.prototype.getToken=function(){return Promise.resolve(null)},Qa.prototype.ni=function(){},Qa.prototype.si=function(t){(this.ei=t)(Da.UNAUTHENTICATED)},Qa.prototype.ii=function(){this.ei=null},Qa),Va=(Ha.prototype.getToken=function(){var e=this,n=this.ai,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ai!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new La(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ha.prototype.ni=function(){this.forceRefresh=!0},Ha.prototype.si=function(t){this.ei=t,this.oi&&t(this.currentUser)},Ha.prototype.ii=function(){this.auth&&this.auth.removeAuthTokenListener(this.ri),this.ri=null,this.ei=null},Ha.prototype.ci=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Da(t)},Ha),Ma=(Object.defineProperty(Ka.prototype,"ti",{get:function(){var t={"X-Goog-AuthUser":this.hi},e=this.ui.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ka),Ua=(za.prototype.getToken=function(){return Promise.resolve(new Ma(this.ui,this.hi))},za.prototype.si=function(t){t(Da.Zs)},za.prototype.ii=function(){},za.prototype.ni=function(){},za),ja=(Ga.prototype._i=function(t,e,n){for(var r=n.fi,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ts(o,e,r[i]))}return e},Ga.prototype.di=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ns(i,e,e,this.li))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ns(a,e,o,this.li))}return e},Ga.prototype.wi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.di(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ji())},Ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,xs)&&Mr(this.baseMutations,t.baseMutations,xs)},Ga),Fa=(Ba.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=Mi,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Ba(t,e,n,r)},Ba),h=(qa.prototype.Ai=function(t){t=this.Ii.get(t);return t?t.readTime:Yr.min()},qa.prototype.Ri=function(t,e){this.Pi(),this.Ii.set(t.key,{gi:t,readTime:e})},qa.prototype.Vi=function(t,e){void 0===e&&(e=null),this.Pi(),this.Ii.set(t,{gi:null,readTime:e})},qa.prototype.yi=function(t,e){this.Pi();var n=this.Ii.get(e);return void 0!==n?ea.resolve(n.gi):this.pi(t,e)},qa.prototype.getEntries=function(t,e){return this.vi(t,e)},qa.prototype.apply=function(t){return this.Pi(),this.mi=!0,this.bi(t)},qa.prototype.Pi=function(){},qa);function qa(){this.Ii=new Kr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mi=!1}function Ba(t,e,n,r){this.batch=t,this.Ti=e,this.fi=n,this.Ei=r}function Ga(t,e,n,r){this.batchId=t,this.li=e,this.baseMutations=n,this.mutations=r}function za(t,e){this.ui=t,this.hi=e}function Ka(t,e){this.ui=t,this.hi=e,this.type="FirstParty",this.user=Da.Zs}function Ha(t){var e=this;this.ri=null,this.currentUser=Da.UNAUTHENTICATED,this.oi=!1,this.ai=0,this.ei=null,this.forceRefresh=!1,this.ri=function(){e.ai++,e.currentUser=e.ci(),e.oi=!0,e.ei&&e.ei(e.currentUser)},this.ai=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ri):(this.ri(null),t.get().then(function(t){e.auth=t,e.ri&&e.auth.addAuthTokenListener(e.ri)},function(){}))}function Qa(){this.ei=null}function Wa(t){return new Ao(t,!0)}function Ya(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Xa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(rc.prototype.Di=function(t){this.Si.push(t)},rc.prototype.Ci=function(){this.Si.forEach(function(t){return t()})},rc),Ja=(nc.prototype.Oi=function(e,n){var r=this;return this.xi.Mi(e,n).next(function(t){return r.ki(e,n,t)})},nc.prototype.ki=function(t,r,i){return this.Ni.yi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].di(r,t);return t})},nc.prototype.$i=function(t,e,i){var o=Ci;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].di(t,e);o=o.rt(t,e)}),o},nc.prototype.Li=function(e,t){var n=this;return this.Ni.getEntries(e,t).next(function(t){return n.Bi(e,t)})},nc.prototype.Bi=function(e,r){var i=this;return this.xi.qi(e,r).next(function(t){var t=i.$i(e,r,t),n=Ci;return t.forEach(function(t,e){e=e||new Zs(t,Yr.min()),n=n.rt(t,e)}),n})},nc.prototype.Ui=function(t,e,n){return r=e,Zr.G(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Qi(t,e.path):fu(e)?this.Ki(t,e,n):this.Wi(t,e,n);var r},nc.prototype.Qi=function(t,e){return this.Oi(t,new Zr(e)).next(function(t){var e=Vi;return t instanceof $s&&(e=e.rt(t.key,t)),e})},nc.prototype.Ki=function(n,r,i){var o=this,s=r.collectionGroup,u=Vi;return this.Fi.ji(n,s).next(function(t){return ea.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new eu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Wi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},nc.prototype.Wi=function(e,n,t){var c,h,r=this;return this.Ni.Ui(e,n,t).next(function(t){return c=t,r.xi.Gi(e,n)}).next(function(t){return h=t,r.zi(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ns(s,a,a,r.li);c=a instanceof $s?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){bu(n,e)||(c=c.remove(t))}),c})},nc.prototype.zi=function(t,e,n){for(var r=ji(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ds&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Ni.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof $s&&(c=c.rt(t,e))}),c})},nc),$a=(ec.Yi=function(t,e){for(var n=ji(),r=ji(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ec(t,e.fromCache,n,r)},ec),Za=(tc.prototype.Zi=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},tc.prototype.next=function(){var t=++this.previousValue;return this.tr&&this.tr(t),t},tc);function tc(t,e){var n=this;this.previousValue=t,e&&(e.Xi=function(t){return n.Zi(t)},this.tr=function(t){return e.er(t)})}function ec(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hi=n,this.Ji=r}function nc(t,e,n){this.Ni=t,this.xi=e,this.Fi=n}function rc(){this.Si=[]}function ic(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Vr(n,t);return 0===t?Vr(r,e):t}Za.nr=-1;var oc=(cc.prototype.rr=function(){return++this.ir},cc.prototype.ar=function(t){var e=[t,this.rr()];this.buffer.size<this.sr?this.buffer=this.buffer.add(e):ic(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(cc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),cc),sc={cr:!1,ur:0,hr:0,lr:0},uc=(ac.Tr=function(t){return new ac(t,ac.Er,ac.Ir)},ac);function ac(t,e,n){this._r=t,this.dr=e,this.wr=n}function cc(t){this.sr=t,this.buffer=new Di(ic),this.ir=0}uc.Er=10,uc.Ir=1e3,uc.mr=new uc(41943040,uc.Er,uc.Ir),uc.Ar=new uc(-1,0,0);var hc=(pc.prototype.start=function(t){-1!==this.Rr.params._r&&this.Vr(t)},pc.prototype.stop=function(){this.gr&&(this.gr.cancel(),this.gr=null)},Object.defineProperty(pc.prototype,"yr",{get:function(){return null!==this.gr},enumerable:!1,configurable:!0}),pc.prototype.Vr=function(n){var t=this,e=this.Pr?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gr=this.rs.Pn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.gr=null,this.Pr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.pr(this.Rr)];case 2:return t.sent(),[3,7];case 3:return ha(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,tf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Vr(n)];case 8:return t.sent(),[2]}})})})},pc),fc=(lc.prototype.br=function(t,e){return this.vr.Sr(t).next(function(t){return Math.floor(e/100*t)})},lc.prototype.Dr=function(t,e){var n=this;if(0===e)return ea.resolve(Za.nr);var r=new oc(e);return this.vr.De(t,function(t){return r.ar(t.sequenceNumber)}).next(function(){return n.vr.Cr(t,function(t){return r.ar(t)})}).next(function(){return r.maxValue})},lc.prototype.Nr=function(t,e,n){return this.vr.Nr(t,e,n)},lc.prototype.Fr=function(t,e){return this.vr.Fr(t,e)},lc.prototype.Or=function(e,n){var r=this;return-1===this.params._r?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),ea.resolve(sc)):this.Mr(e).next(function(t){return t<r.params._r?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params._r),sc):r.kr(e,n)})},lc.prototype.Mr=function(t){return this.vr.Mr(t)},lc.prototype.kr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.br(e,this.params.dr).next(function(t){return i=t>h.params.wr?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.wr+" from "+t),h.params.wr):t,s=Date.now(),h.Dr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Nr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Fr(e,r)}).next(function(t){return c=Date.now(),Ar()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ea.resolve({cr:!0,ur:i,hr:o,lr:t})})},lc);function lc(t,e){this.vr=t,this.params=e}function pc(t,e){this.Rr=t,this.rs=e,this.Pr=!1,this.gr=null}function dc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=yc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return yc(e)}function yc(t){return t+"\x01\x01"}function vc(t){var e=t.length;if(Cr(2<=e),2===e)return Cr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Xr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new Xr(r)}var gc=function(t){this.$r=t};function mc(t,e){if(e.document)return n=t.$r,r=e.document,i=!!e.hasCommittedMutations,t=Mo(n,r.name),n=Co(r.updateTime),r=new Gs({mapValue:{fields:r.fields}}),new $s(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=Zr.H(e.noDocument.path),o=Ic(e.noDocument.readTime);return new Zs(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=Zr.H(e.unknownDocument.path),e=Ic(e.unknownDocument.version);return new tu(o,e)}return Pr()}function wc(t,e,n){var r=bc(n),n=e.key.path.S().O();if(e instanceof $s){var i={name:Vo(i=t.$r,(o=e).key),fields:o.sn().mapValue.fields,updateTime:Do(i,o.version.P())},o=e.hasCommittedMutations;return new ih(null,null,i,o,r,n)}if(e instanceof Zs){var i=e.key.path.O(),o=Ec(e.version),s=e.hasCommittedMutations;return new ih(null,new nh(i,o),null,s,r,n)}if(e instanceof tu){s=e.key.path.O(),e=Ec(e.version);return new ih(new rh(s,e),null,null,!0,r,n)}return Pr()}function bc(t){t=t.P();return[t.seconds,t.nanoseconds]}function _c(t){t=new Wr(t[0],t[1]);return Yr.m(t)}function Ec(t){t=t.P();return new Qc(t.seconds,t.nanoseconds)}function Ic(t){t=new Wr(t.seconds,t.nanoseconds);return Yr.m(t)}function Tc(e,t){var n=(t.baseMutations||[]).map(function(t){return zo(e.$r,t)}),r=t.mutations.map(function(t){return zo(e.$r,t)}),i=Wr.fromMillis(t.localWriteTimeMs);return new ja(t.batchId,i,n,r)}function Nc(t){var e=Ic(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Ic(t.lastLimboFreeSnapshotVersion):Yr.min(),r=void 0!==t.query.documents?(Cr(1===(r=t.query).documents.length),pu(su(jo(r.documents[0])))):pu(Qo(t.query));return new bi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,vi.fromBase64String(t.resumeToken))}function xc(t,e){var n=Ec(e.et),r=Ec(e.lastLimboFreeSnapshotVersion),i=(yi(e.target)?Ko:Ho)(t.$r,e.target),t=e.resumeToken.toBase64();return new sh(e.targetId,pi(e.target),n,t,e.sequenceNumber,r,i)}function Ac(t){var e=Qo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?du(e,e.limit,"L"):e}var Sc=(Oc.qr=function(t,e,n,r){return Cr(""!==t.uid),new Oc(t.Js()?t.uid:"",e,n,r)},Oc.prototype.Ur=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).ns({index:Zc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Oc.prototype.Qr=function(d,y,v,g){var m=this,w=Cc(d),b=Pc(d);return b.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new ja(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Go(e.$r,t)}),o=r.mutations.map(function(t){return Go(e.$r,t)}),new Zc(n,r.batchId,r.li.toMillis(),i,o)),a=[],c=new Di(function(t,e){return Vr(t.M(),e.M())}),h=0,f=g;h<f.length;h++){var l=f[h],p=th.key(m.userId,l.key.path,t),c=c.add(l.key.path.S());a.push(b.put(u)),a.push(w.put(p,th.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Fi.Kr(d,t))}),d.Di(function(){m.Br[t]=s.keys()}),ea.xn(a).next(function(){return s})})},Oc.prototype.Wr=function(t,e){var n=this;return Pc(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),Tc(n.serializer,t)):null})},Oc.prototype.jr=function(t,e){var n=this;return this.Br[e]?ea.resolve(this.Br[e]):this.Wr(t,e).next(function(t){if(t){t=t.keys();return n.Br[e]=t}return null})},Oc.prototype.Gr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Pc(t).ns({index:Zc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=Tc(r.serializer,e)),n.done()}).next(function(){return o})},Oc.prototype.zr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Pc(t).ns({index:Zc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Oc.prototype.Hr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).Xn(Zc.userMutationsIndex,n).next(function(t){return t.map(function(t){return Tc(e.serializer,t)})})},Oc.prototype.Mi=function(o,s){var u=this,t=th.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Cc(o).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);if(r===u.userId&&s.path.isEqual(i))return Pc(o).get(t).next(function(t){if(!t)throw Pr();Cr(t.userId===u.userId),a.push(Tc(u.serializer,t))});n.done()}).next(function(){return a})},Oc.prototype.qi=function(e,t){var s=this,u=new Di(Vr),n=[];return t.forEach(function(o){var t=th.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Cc(e).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ea.xn(n).next(function(){return s.Jr(e,u)})},Oc.prototype.Gi=function(t,e){var o=this,s=e.path,u=s.length+1,e=th.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Di(Vr);return Cc(t).ns({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);r===o.userId&&s.N(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Jr(t,a)})},Oc.prototype.Jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Pc(e).get(t).next(function(t){if(null===t)throw Pr();Cr(t.userId===n.userId),r.push(Tc(n.serializer,t))}))}),ea.xn(i).next(function(){return r})},Oc.prototype.Yr=function(e,n){var r=this;return Dc(e.Xr,this.userId,n).next(function(t){return e.Di(function(){r.Zr(n.batchId)}),ea.forEach(t,function(t){return r.Lr.eo(e,t)})})},Oc.prototype.Zr=function(t){delete this.Br[t]},Oc.prototype.no=function(e){var i=this;return this.Ur(e).next(function(t){if(!t)return ea.resolve();var t=IDBKeyRange.lowerBound(th.prefixForUser(i.userId)),r=[];return Cc(e).ns({range:t},function(t,e,n){t[0]===i.userId?(t=vc(t[1]),r.push(t)):n.done()}).next(function(){Cr(0===r.length)})})},Oc.prototype.so=function(t,e){return kc(t,this.userId,e)},Oc.prototype.io=function(t){var e=this;return Lc(t).get(this.userId).next(function(t){return t||new $c(e.userId,-1,"")})},Oc);function Oc(t,e,n,r){this.userId=t,this.serializer=e,this.Fi=n,this.Lr=r,this.Br={}}function kc(t,o,e){var e=th.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Cc(t).ns({range:e,es:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Dc(t,e,n){var r=t.store(Zc.store),i=t.store(th.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ns({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Cr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=th.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ea.xn(o).next(function(){return u})}function Pc(t){return Ph.qn(t,Zc.store)}function Cc(t){return Ph.qn(t,th.store)}function Lc(t){return Ph.qn(t,$c.store)}var Rc,Vc=(jc.prototype.Ri=function(t,e,n){return qc(t).put(Bc(e),n)},jc.prototype.Vi=function(t,e){t=qc(t),e=Bc(e);return t.delete(e)},jc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ro(e,t)})},jc.prototype.yi=function(t,e){var n=this;return qc(t).get(Bc(e)).next(function(t){return n.oo(t)})},jc.prototype.ao=function(t,e){var n=this;return qc(t).get(Bc(e)).next(function(t){var e=n.oo(t);return e?{gi:e,size:Gc(t)}:null})},jc.prototype.getEntries=function(t,e){var n=this,r=Ci;return this.co(t,e,function(t,e){e=n.oo(e);r=r.rt(t,e)}).next(function(){return r})},jc.prototype.uo=function(t,e){var r=this,i=Ci,o=new Ti(Zr.V);return this.co(t,e,function(t,e){var n=r.oo(e);o=n?(i=i.rt(t,n),o.rt(t,Gc(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{ho:i,lo:o}})},jc.prototype.co=function(t,e,i){if(e.T())return ea.resolve();var n=IDBKeyRange.bound(e.first().path.O(),e.last().path.O()),o=e.lt(),s=o.Et();return qc(t).ns({range:n},function(t,e,n){for(var r=Zr.H(t);s&&Zr.V(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.O()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},jc.prototype.Ui=function(t,r,e){var n,i=this,o=Vi,s=r.path.length+1,u={};return e.isEqual(Yr.min())?(n=r.path.O(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.O(),e=bc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=ih.collectionReadTimeIndex),qc(t).ns(u,function(t,e,n){t.length===s&&(e=mc(i.serializer,e),r.path.N(e.key.path)?e instanceof $s&&bu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},jc.prototype._o=function(t){return new Mc(this,!!t&&t.fo)},jc.prototype.wo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},jc.prototype.getMetadata=function(t){return Fc(t).get(oh.key).next(function(t){return Cr(!!t),t})},jc.prototype.ro=function(t,e){return Fc(t).put(oh.key,e)},jc.prototype.oo=function(t){if(t){t=mc(this.serializer,t);return t instanceof Zs&&t.version.isEqual(Yr.min())?null:t}return null},jc),Mc=(n(Uc,Rc=h),Uc.prototype.bi=function(i){var o=this,s=[],u=0,a=new Di(function(t,e){return Vr(t.M(),e.M())});return this.Ii.forEach(function(t,e){var n,r=o.Eo.get(t);e.gi?(n=wc(o.To.serializer,e.gi,o.Ai(t)),a=a.add(t.path.S()),e=Gc(n),u+=e-r,s.push(o.To.Ri(i,t,n))):(u-=r,o.fo?(r=wc(o.To.serializer,new Zs(t,Yr.min()),o.Ai(t)),s.push(o.To.Ri(i,t,r))):s.push(o.To.Vi(i,t)))}),a.forEach(function(t){s.push(o.To.Fi.Kr(i,t))}),s.push(this.To.updateMetadata(i,u)),ea.xn(s)},Uc.prototype.pi=function(t,e){var n=this;return this.To.ao(t,e).next(function(t){return null===t?(n.Eo.set(e,0),null):(n.Eo.set(e,t.size),t.gi)})},Uc.prototype.vi=function(t,e){var n=this;return this.To.uo(t,e).next(function(t){var e=t.ho;return t.lo.forEach(function(t,e){n.Eo.set(t,e)}),e})},Uc);function Uc(t,e){var n=this;return(n=Rc.call(this)||this).To=t,n.fo=e,n.Eo=new Kr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function jc(t,e){this.serializer=t,this.Fi=e}function Fc(t){return Ph.qn(t,oh.store)}function qc(t){return Ph.qn(t,ih.store)}function Bc(t){return t.path.O()}function Gc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}var zc=(Jc.prototype.Kr=function(t,e){return this.Io.add(e),ea.resolve()},Jc.prototype.ji=function(t,e){return ea.resolve(this.Io.getEntries(e))},Jc),Kc=(Xc.prototype.add=function(t){var e=t.C(),n=t.S(),r=this.index[e]||new Di(Xr.V),t=!r.has(n);return this.index[e]=r.add(n),t},Xc.prototype.has=function(t){var e=t.C(),t=t.S(),e=this.index[e];return e&&e.has(t)},Xc.prototype.getEntries=function(t){return(this.index[t]||new Di(Xr.V)).O()},Xc),Hc=(Yc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Cr(t<r&&0<=t&&r<=11);var o=new fa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Wc.store),(s=e).createObjectStore($c.store,{keyPath:$c.keyPath}),s.createObjectStore(Zc.store,{keyPath:Zc.keyPath,autoIncrement:!0}).createIndex(Zc.userMutationsIndex,Zc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(th.store),hh(e),e.createObjectStore(ih.store));var s,u=ea.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(uh.store),s.deleteObjectStore(sh.store),s.deleteObjectStore(ah.store),hh(e)),u=u.next(function(){return t=o.store(ah.store),e=new ah(0,0,Yr.min().P(),0),t.put(ah.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Zc.store).Xn().next(function(t){n.deleteObjectStore(Zc.store),n.createObjectStore(Zc.store,{keyPath:Zc.keyPath,autoIncrement:!0}).createIndex(Zc.userMutationsIndex,Zc.userMutationsKeyPath,{unique:!0});var e=r.store(Zc.store),t=t.map(function(t){return e.put(t)});return ea.xn(t)});var n,r})),u=u.next(function(){e.createObjectStore(fh.store,{keyPath:fh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(oh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(ih.store)).createIndex(ih.readTimeIndex,ih.readTimeIndexPath,{unique:!1}),t.createIndex(ih.collectionReadTimeIndex,ih.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(lh.store,{keyPath:lh.keyPath}),e.createObjectStore(ph.store,{keyPath:ph.keyPath})})),u},Yc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(ih.store).ns(function(t,e){n+=Gc(e)}).next(function(){var t=new oh(n);return e.store(oh.store).put(oh.key,t)})},Yc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store($c.store),i=n.store(Zc.store);return t.Xn().next(function(t){return ea.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Xn(Zc.userMutationsIndex,t).next(function(t){return ea.forEach(t,function(t){Cr(t.userId===e.userId);t=Tc(r.serializer,t);return Dc(n,e.userId,t).next(function(){})})})})})},Yc.prototype.ensureSequenceNumbers=function(t){var o=t.store(uh.store),e=t.store(ih.store);return t.store(ah.store).get(ah.key).next(function(r){var i=[];return e.ns(function(t,e){var n=new Xr(t),t=[0,dc(n)];i.push(o.get(t).next(function(t){return t?ea.resolve():o.put(new uh(0,dc(n),r.highestListenSequenceNumber))}))}).next(function(){return ea.xn(i)})})},Yc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ch.store,{keyPath:ch.keyPath});function r(t){if(i.add(t)){var e=t.C(),t=t.S();return n.put({collectionId:e,parent:dc(t)})}}var n=e.store(ch.store),i=new Kc;return e.store(ih.store).ns({es:!0},function(t,e){t=new Xr(t);return r(t.S())}).next(function(){return e.store(th.store).ns({es:!0},function(t,e){t[0];var n=t[1],n=(t[2],vc(n));return r(n.S())})})},Yc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(sh.store);return r.ns(function(t,e){e=Nc(e),e=xc(n.serializer,e);return r.put(e)})},Yc),Qc=function(t,e){this.seconds=t,this.nanoseconds=e},Wc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Yc(t){this.serializer=t}function Xc(){this.index={}}function Jc(){this.Io=new Kc}Wc.store="owner",Wc.key="owner";var $c=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};$c.store="mutationQueues",$c.keyPath="userId";var Zc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Zc.store="mutations",Zc.keyPath="batchId",Zc.userMutationsIndex="userMutationsIndex",Zc.userMutationsKeyPath=["userId","batchId"];var th=(eh.prefixForUser=function(t){return[t]},eh.prefixForPath=function(t,e){return[t,dc(e)]},eh.key=function(t,e,n){return[t,dc(e),n]},eh);function eh(){}th.store="documentMutations",th.PLACEHOLDER=new th;var nh=function(t,e){this.path=t,this.readTime=e},rh=function(t,e){this.path=t,this.version=e},ih=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ih.store="remoteDocuments",ih.readTimeIndex="readTimeIndex",ih.readTimeIndexPath="readTime",ih.collectionReadTimeIndex="collectionReadTimeIndex",ih.collectionReadTimeIndexPath=["parentPath","readTime"];var oh=function(t){this.byteSize=t};oh.store="remoteDocumentGlobal",oh.key="remoteDocumentGlobalKey";var sh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};sh.store="targets",sh.keyPath="targetId",sh.queryTargetsIndexName="queryTargetsIndex",sh.queryTargetsKeyPath=["canonicalId","targetId"];var uh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};uh.store="targetDocuments",uh.keyPath=["targetId","path"],uh.documentTargetsIndex="documentTargetsIndex",uh.documentTargetsKeyPath=["path","targetId"];var ah=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ah.key="targetGlobalKey",ah.store="targetGlobal";var ch=function(t,e){this.collectionId=t,this.parent=e};function hh(t){t.createObjectStore(uh.store,{keyPath:uh.keyPath}).createIndex(uh.documentTargetsIndex,uh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(sh.store,{keyPath:sh.keyPath}).createIndex(sh.queryTargetsIndexName,sh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ah.store)}ch.store="collectionParents",ch.keyPath=["collectionId","parent"];var fh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};fh.store="clientMetadata",fh.keyPath="clientId";var lh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};lh.store="bundles",lh.keyPath="bundleId";var ph=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ph.store="namedQueries",ph.keyPath="name";var dh=i(i(i(i([$c.store,Zc.store,th.store,ih.store,sh.store,Wc.store,ah.store,uh.store],[fh.store]),[oh.store]),[ch.store]),[lh.store,ph.store]),yh=(vh.prototype.mo=function(t,e){return gh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:Ic(t.createTime),version:t.version}})},vh.prototype.Ao=function(t,e){return gh(t).put({bundleId:(e=e).id,createTime:Ec(Co(e.createTime)),version:e.version})},vh.prototype.Ro=function(t,e){return mh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Ac(t.bundledQuery),readTime:Ic(t.readTime)}})},vh.prototype.Po=function(t,e){return mh(t).put({name:(e=e).name,readTime:Ec(Co(e.readTime)),bundledQuery:e.bundledQuery})},vh);function vh(t){this.serializer=t}function gh(t){return Ph.qn(t,lh.store)}function mh(t){return Ph.qn(t,ph.store)}var wh=(bh.prototype.Kr=function(t,e){var n=this;if(this.Vo.has(e))return ea.resolve();var r=e.C(),i=e.S();t.Di(function(){n.Vo.add(e)});i={collectionId:r,parent:dc(i)};return _h(t).put(i)},bh.prototype.ji=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ur(i),""],!1,!0);return _h(t).Xn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(vc(r.parent))}return o})},bh);function bh(){this.Vo=new Kc}function _h(t){return Ph.qn(t,ch.store)}var Eh=(Nh.prototype.next=function(){return this.yo+=2,this.yo},Nh.po=function(){return new Nh(0)},Nh.vo=function(){return new Nh(-1)},Nh),Ih=(Th.prototype.bo=function(n){var r=this;return this.So(n).next(function(t){var e=new Eh(t.highestTargetId);return t.highestTargetId=e.next(),r.Do(n,t).next(function(){return t.highestTargetId})})},Th.prototype.Co=function(t){return this.So(t).next(function(t){return Yr.m(new Wr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Th.prototype.No=function(t){return this.So(t).next(function(t){return t.highestListenSequenceNumber})},Th.prototype.xo=function(e,n,r){var i=this;return this.So(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.P()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Do(e,t)})},Th.prototype.Fo=function(e,n){var r=this;return this.Oo(e,n).next(function(){return r.So(e).next(function(t){return t.targetCount+=1,r.Mo(n,t),r.Do(e,t)})})},Th.prototype.ko=function(t,e){return this.Oo(t,e)},Th.prototype.$o=function(e,t){var n=this;return this.Lo(e,t.targetId).next(function(){return xh(e).delete(t.targetId)}).next(function(){return n.So(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.Do(e,t)})},Th.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return xh(n).ns(function(t,e){e=Nc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.$o(n,e)))}).next(function(){return ea.xn(u)}).next(function(){return s})},Th.prototype.De=function(t,n){return xh(t).ns(function(t,e){e=Nc(e);n(e)})},Th.prototype.So=function(t){return Ah(t).get(ah.key).next(function(t){return Cr(null!==t),t})},Th.prototype.Do=function(t,e){return Ah(t).put(ah.key,e)},Th.prototype.Oo=function(t,e){return xh(t).put(xc(this.serializer,e))},Th.prototype.Mo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Th.prototype.Bo=function(t){return this.So(t).next(function(t){return t.targetCount})},Th.prototype.qo=function(t,r){var e=pi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return xh(t).ns({range:e,index:sh.queryTargetsIndexName},function(t,e,n){e=Nc(e);di(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Th.prototype.Uo=function(n,t,r){var i=this,o=[],s=Sh(n);return t.forEach(function(t){var e=dc(t.path);o.push(s.put(new uh(r,e))),o.push(i.Lr.Qo(n,r,t))}),ea.xn(o)},Th.prototype.Ko=function(n,t,r){var i=this,o=Sh(n);return ea.forEach(t,function(t){var e=dc(t.path);return ea.xn([o.delete([r,e]),i.Lr.Wo(n,r,t)])})},Th.prototype.Lo=function(t,e){t=Sh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Th.prototype.jo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Sh(t),r=ji();return t.ns({range:e,es:!0},function(t,e,n){t=vc(t[1]),t=new Zr(t);r=r.add(t)}).next(function(){return r})},Th.prototype.so=function(t,e){var e=dc(e.path),e=IDBKeyRange.bound([e],[Ur(e)],!1,!0),i=0;return Sh(t).ns({index:uh.documentTargetsIndex,es:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Th.prototype.qe=function(t,e){return xh(t).get(e).next(function(t){return t?Nc(t):null})},Th);function Th(t,e){this.Lr=t,this.serializer=e}function Nh(t){this.yo=t}function xh(t){return Ph.qn(t,sh.store)}function Ah(t){return Ph.qn(t,ah.store)}function Sh(t){return Ph.qn(t,uh.store)}var Oh,kh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Dh=(n(Lh,Oh=Ee),Lh),Ph=(Ch.qn=function(t,e){if(t instanceof Dh)return na.qn(t.Xr,e);throw Pr()},Ch.prototype.start=function(){var e=this;return this.ca().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Qr(Hr.FAILED_PRECONDITION,kh);return e.ua(),e.ha(),e.la(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ra.No(t)})}).then(function(t){e.Jo=new Za(t,e.zo)}).then(function(){e.Yo=!0}).catch(function(t){return e.ia&&e.ia.close(),Promise.reject(t)})},Ch.prototype._a=function(n){var t=this;return this.na=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.yr?[2,n(e)]:[2]})})},n(this.isPrimary)},Ch.prototype.fa=function(n){var t=this;this.ia.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ch.prototype.da=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.yr?[4,this.ca()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ch.prototype.ca=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Vh(e).put(new fh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.wa(e).next(function(t){t||(n.isPrimary=!1,n.ln.Ss(function(){return n.na(!1)}))})}).next(function(){return n.Ta(e)}).next(function(t){return n.isPrimary&&!t?n.Ea(e).next(function(){return!1}):!!t&&n.Ia(e).next(function(){return!0})})}).catch(function(t){if(ha(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ln.Ss(function(){return n.na(t)}),n.isPrimary=t})},Ch.prototype.wa=function(t){var e=this;return Rh(t).get(Wc.key).next(function(t){return ea.resolve(e.ma(t))})},Ch.prototype.Aa=function(t){return Vh(t).delete(this.clientId)},Ch.prototype.Ra=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Pa(this.ea,18e5)?[3,2]:(this.ea=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ch.qn(t,fh.store);return r.Xn().next(function(t){var e=o.ga(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ea.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.aa)for(n=0,r=e;n<r.length;n++)i=r[n],this.aa.removeItem(this.Va(i.clientId));t.label=2;case 2:return[2]}})})},Ch.prototype.la=function(){var t=this;this.ta=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.ca().then(function(){return t.Ra()}).then(function(){return t.la()})})},Ch.prototype.ma=function(t){return!!t&&t.ownerId===this.clientId},Ch.prototype.Ta=function(e){var r=this;return this.Ho?ea.resolve(!0):Rh(e).get(Wc.key).next(function(t){if(null!==t&&r.Pa(t.leaseTimestampMs,5e3)&&!r.ya(t.ownerId)){if(r.ma(t)&&r.networkEnabled)return!0;if(!r.ma(t)){if(!t.allowTabSynchronization)throw new Qr(Hr.FAILED_PRECONDITION,kh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Vh(e).Xn().next(function(t){return void 0===r.ga(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ch.prototype.pa=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Yo=!1,this.va(),this.ta&&(this.ta.cancel(),this.ta=null),this.ba(),this.Sa(),[4,this.ia.runTransaction("shutdown","readwrite",[Wc.store,fh.store],function(t){var e=new Dh(t,Za.nr);return n.Ea(e).next(function(){return n.Aa(e)})})];case 1:return t.sent(),this.ia.close(),this.Da(),[2]}})})},Ch.prototype.ga=function(t,e){var n=this;return t.filter(function(t){return n.Pa(t.updateTimeMs,e)&&!n.ya(t.clientId)})},Ch.prototype.Ca=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Vh(t).Xn().next(function(t){return e.ga(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ch.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Ch.prototype.Na=function(t){return Sc.qr(t,this.serializer,this.Fi,this.Lr)},Ch.prototype.xa=function(){return this.ra},Ch.prototype.Fa=function(){return this.Ni},Ch.prototype.Oa=function(){return this.Fi},Ch.prototype.Ma=function(){return this.oa},Ch.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ia.runTransaction(e,t,dh,function(t){return o=new Dh(t,i.Jo?i.Jo.next():Za.nr),"readwrite-primary"===n?i.wa(o).next(function(t){return!!t||i.Ta(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.na(!1)}),new Qr(Hr.FAILED_PRECONDITION,Xa);return r(o)}).next(function(t){return i.Ia(o).next(function(){return t})}):i.ka(o).next(function(){return r(o)})}).then(function(t){return o.Ci(),t})},Ch.prototype.ka=function(t){var e=this;return Rh(t).get(Wc.key).next(function(t){if(null!==t&&e.Pa(t.leaseTimestampMs,5e3)&&!e.ya(t.ownerId)&&!e.ma(t)&&!(e.Ho||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Qr(Hr.FAILED_PRECONDITION,kh)})},Ch.prototype.Ia=function(t){var e=new Wc(this.clientId,this.allowTabSynchronization,Date.now());return Rh(t).put(Wc.key,e)},Ch.kn=function(){return na.kn()},Ch.prototype.Ea=function(t){var e=this,n=Rh(t);return n.get(Wc.key).next(function(t){return e.ma(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(Wc.key)):ea.resolve()})},Ch.prototype.Pa=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},Ch.prototype.ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Zo=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.ca()})},this.document.addEventListener("visibilitychange",this.Zo),this.inForeground="visible"===this.document.visibilityState)},Ch.prototype.ba=function(){this.Zo&&(this.document.removeEventListener("visibilitychange",this.Zo),this.Zo=null)},Ch.prototype.ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Xo=function(){e.va(),e.ln.fs(function(){return e.pa()})},this.window.addEventListener("unload",this.Xo))},Ch.prototype.Sa=function(){this.Xo&&(this.window.removeEventListener("unload",this.Xo),this.Xo=null)},Ch.prototype.ya=function(t){try{var e=null!==(null===(e=this.aa)||void 0===e?void 0:e.getItem(this.Va(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ch.prototype.va=function(){if(this.aa)try{this.aa.setItem(this.Va(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},Ch.prototype.Da=function(){if(this.aa)try{this.aa.removeItem(this.Va(this.clientId))}catch(t){}},Ch.prototype.Va=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ch);function Ch(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ln=i,this.window=o,this.document=s,this.zo=a,this.Ho=c,this.Jo=null,this.Yo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Xo=null,this.inForeground=!1,this.Zo=null,this.ta=null,this.ea=Number.NEGATIVE_INFINITY,this.na=function(t){return Promise.resolve()},!Ch.kn())throw new Qr(Hr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Lr=new Mh(this,r),this.sa=e+"main",this.serializer=new gc(u),this.ia=new na(this.sa,11,new Hc(this.serializer)),this.ra=new Ih(this.Lr,this.serializer),this.Fi=new wh,this.Ni=(e=this.serializer,u=this.Fi,new Vc(e,u)),this.oa=new yh(this.serializer),this.window&&this.window.localStorage?this.aa=this.window.localStorage:(this.aa=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Lh(t,e){var n=this;return(n=Oh.call(this)||this).Xr=t,n.Go=e,n}function Rh(t){return Ph.qn(t,Wc.store)}function Vh(t){return Ph.qn(t,fh.store)}var Mh=(Uh.prototype.Sr=function(t){var n=this.$a(t);return this.db.xa().Bo(t).next(function(e){return n.next(function(t){return e+t})})},Uh.prototype.$a=function(t){var e=0;return this.Cr(t,function(t){e++}).next(function(){return e})},Uh.prototype.De=function(t,e){return this.db.xa().De(t,e)},Uh.prototype.Cr=function(t,n){return this.La(t,function(t,e){return n(e)})},Uh.prototype.Qo=function(t,e,n){return jh(t,n)},Uh.prototype.Wo=function(t,e,n){return jh(t,n)},Uh.prototype.Nr=function(t,e,n){return this.db.xa().Nr(t,e,n)},Uh.prototype.eo=jh,Uh.prototype.Ba=function(t,e){return r=e,i=!1,Lc(n=t).ss(function(t){return kc(n,t,r).next(function(t){return t&&(i=!0),ea.resolve(!t)})}).next(function(){return i});var n,r,i},Uh.prototype.Fr=function(n,r){var i=this,o=this.db.Fa()._o(),s=[],u=0;return this.La(n,function(e,t){t<=r&&(t=i.Ba(n,e).next(function(t){if(!t)return u++,o.yi(n,e).next(function(){return o.Vi(e),Sh(n).delete([0,dc(e.path)])})}),s.push(t))}).next(function(){return ea.xn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Uh.prototype.removeTarget=function(t,e){e=e.nt(t.Go);return this.db.xa().ko(t,e)},Uh.prototype.qa=jh,Uh.prototype.La=function(t,r){var i,t=Sh(t),o=Za.nr;return t.ns({index:uh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Za.nr&&r(new Zr(vc(i)),o),o=e,i=t):o=Za.nr}).next(function(){o!==Za.nr&&r(new Zr(vc(i)),o)})},Uh.prototype.Mr=function(t){return this.db.Fa().wo(t)},Uh);function Uh(t,e){this.db=t,this.Rr=new fc(this,e)}function jh(t,e){return Sh(t).put((t=t.Go,new uh(0,dc(e.path),t)))}function Fh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var qh=(Bh.prototype.pr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Or(t,n.Qa)})},Bh);function Bh(t,e,n,r){this.persistence=t,this.Ua=e,this.serializer=r,this.Qa=new Ti(Vr),this.Ka=new Kr(pi,di),this.Wa=Yr.min(),this.xi=t.Na(n),this.ja=t.Fa(),this.ra=t.xa(),this.Ga=new Ja(this.ja,this.xi,this.persistence.Oa()),this.oa=t.Ma(),this.Ua.za(this.Ga)}function Gh(t,e,n,r){return new qh(t,e,n,r)}function zh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).xi,m=e.Ga,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.xi.Hr(v).next(function(t){return g=t,n=e.persistence.Na(o),m=new Ja(e.ja,n,e.persistence.Oa()),n.Hr(v)}).next(function(t){for(var e=[],n=[],r=ji(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Li(v,r).next(function(t){return{Ha:t,Ja:e,Ya:n}})})})];case 1:return r=t.sent(),[2,(e.xi=n,e.Ga=m,e.Ua.za(e.Ga),r)]}})})}function Kh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.ja._o({fo:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ea.resolve(),n.forEach(function(n){u=u.next(function(){return o.yi(r,n)}).next(function(t){var e=t,t=i.Ei.get(n);Cr(null!==t),(!e||e.version.A(t)<0)&&(e=s._i(n,e,i))&&o.Ri(e,i.Ti)})}),u.next(function(){return e.xi.Yr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.xi.no(t)}).next(function(){return f.Ga.Li(t,a)})})}function Hh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ra.Co(t)})}function Qh(t,o){var h=t,f=o.et,l=h.Qa;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.ja._o({fo:!0});l=h.Qa;var u=[];o.Gt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.ra.Ko(s,t.ne,e).next(function(){return h.ra.Uo(s,t.te,e)})),0<(i=t.resumeToken).X()&&(n=o.st(i,f).nt(s.Go),l=l.rt(e,n),r=o,i=t,Cr(0<(o=n).resumeToken.X()),(0===r.resumeToken.X()||3e8<=o.et.R()-r.et.R()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(h.ra.ko(s,n))))});var e,a,n,c,r,i=Ci;return o.Ht.forEach(function(t,e){o.Jt.has(t)&&u.push(h.persistence.Lr.qa(s,t))}),u.push((e=s,a=t,n=o.Ht,c=f,r=ji(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Ci;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof Zs&&e.version.isEqual(Yr.min())?(a.Vi(t,r),o=o.rt(t,e)):null==n||0<e.version.A(n.version)||0===e.version.A(n.version)&&n.hasPendingWrites?(a.Ri(e,r),o=o.rt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(Yr.min())||(e=h.ra.Co(s).next(function(t){return h.ra.xo(s,s.Go,f)}),u.push(e)),ea.xn(u).next(function(){return t.apply(s)}).next(function(){return h.Ga.Bi(s,i)})}).then(function(t){return h.Qa=l,t})}function Wh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ra.qo(e,r).next(function(t){return t?(n=t,ea.resolve(n)):i.ra.bo(e).next(function(t){return n=new bi(r,t,0,e.Go),i.ra.Fo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Qa.get(t.targetId);return(null===e||0<t.et.A(e.et))&&(i.Qa=i.Qa.rt(t.targetId,t),i.Ka.set(r,t.targetId)),t})}function Yh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Qa.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Lr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ha(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Qa=e.Qa.remove(o),e.Ka.delete(n.target),[2]}})})}function Xh(t,o,s){var u=t,a=Yr.min(),c=ji();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=pu(o),(void 0!==(t=(i=t).Ka.get(r))?ea.resolve(i.Qa.get(t)):i.ra.qo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ra.jo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Ua.Ui(e,o,s?a:Yr.min(),s?c:ji())}).next(function(t){return{documents:t,Xa:c}});var t,n,r,i})}function Jh(t,e){var n=t,r=n.ra,t=n.Qa.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function $h(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.ja,n=t,t=s.Wa,r=e,i=Ci,o=bc(t),t=qc(n),n=IDBKeyRange.lowerBound(o,!0),t.ns({index:ih.readTimeIndex,range:n},function(t,e){var n=mc(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Za:i,readTime:_c(o)}});var e,n,r,i,o}).then(function(t){var e=t.Za,t=t.readTime;return s.Wa=t,e})}function Zh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=qc(t),r=Yr.min(),t.ns({index:ih.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=_c(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Wa=t})]})})}function tf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Hr.FAILED_PRECONDITION||e.message!==Xa)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ef(t,e,n,r,i){var o=this;this.Kc=t,this.Wc=e,this.rs=n,this.jc={},this.Gc=[],this.zc=new Map,this.Hc=new Set,this.Jc=[],this.Yc=i,this.Yc.Xc(function(t){n.fs(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return If(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(4),[4,vf(e)];case 1:return t.sent(),e.Zc.set("Unknown"),e.Hc.delete(4),[4,yf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zc=new cf(n,r)}var nf,rf,of,Ie=(df.prototype.rc=function(){return 1===this.state||2===this.state||4===this.state},df.prototype.oc=function(){return 2===this.state},df.prototype.start=function(){3!==this.state?this.auth():this.ac()},df.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.rc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},df.prototype.cc=function(){this.state=0,this.Ps.reset()},df.prototype.uc=function(){var t=this;this.oc()&&null===this.ic&&(this.ic=this.ln.Pn(this.tc,6e4,function(){return t.hc()}))},df.prototype.lc=function(t){this._c(),this.stream.send(t)},df.prototype.hc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oc()?[2,this.close(0)]:[2]})})},df.prototype._c=function(){this.ic&&(this.ic.cancel(),this.ic=null)},df.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._c(),this.Ps.cancel(),this.sc++,3!==e?this.Ps.reset():n&&n.code===Hr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Ps.mn()):n&&n.code===Hr.UNAUTHENTICATED&&this.nc.ni(),null!==this.stream&&(this.fc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dc(n)];case 1:return t.sent(),[2]}})})},df.prototype.fc=function(){},df.prototype.auth=function(){var n=this;this.state=1;var t=this.wc(this.sc),e=this.sc;this.nc.getToken().then(function(t){n.sc===e&&n.Tc(t)},function(e){t(function(){var t=new Qr(Hr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ec(t)})})},df.prototype.Tc=function(t){var e=this,n=this.wc(this.sc);this.stream=this.Ic(t),this.stream.mc(function(){n(function(){return e.state=2,e.listener.mc()})}),this.stream.dc(function(t){n(function(){return e.Ec(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},df.prototype.ac=function(){var t=this;this.state=4,this.Ps.An(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},df.prototype.Ec=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},df.prototype.wc=function(e){var n=this;return function(t){n.ln.fs(function(){return n.sc===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},df),sf=(n(pf,of=Ie),pf.prototype.Ic=function(t){return this.ec.Ac("Listen",t)},pf.prototype.onMessage=function(t){this.Ps.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Pr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Cr(void 0===o||"string"==typeof o),vi.fromBase64String(o||"")):(Cr(void 0===o||o instanceof Uint8Array),vi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Hr.UNKNOWN:Ii(s.code),new Qr(o,s.message||"")),r=new Wi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Mo(t,u.document.name),a=Co(u.document.updateTime),s=new Gs({mapValue:{fields:u.document.fields}}),a=new $s(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Hi(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Mo(t,u.document),c=u.readTime?Co(u.readTime):Yr.min(),c=new Zs(a,c),u=u.removedTargetIds||[];r=new Hi([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Mo(t,c.document),c=c.removedTargetIds||[];r=new Hi([],c,h,null)}else{if(!("filter"in e))return Pr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new mi(e),h=h.targetId;r=new Qi(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Yr.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Co(t.readTime):Yr.min()}(t);return this.listener.Rc(e,t)},pf.prototype.Pc=function(t){var e,n,r,i={};i.database=Fo(this.serializer),i.addTarget=(e=this.serializer,(r=yi(r=(n=t).target)?{documents:Ko(e,r)}:{query:Ho(e,r)}).targetId=n.targetId,0<n.resumeToken.X()?r.resumeToken=Po(e,n.resumeToken):0<n.et.A(Yr.min())&&(r.readTime=Do(e,n.et.P())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.lc(i)},pf.prototype.gc=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.lc(e)},pf),uf=(n(lf,rf=Ie),Object.defineProperty(lf.prototype,"yc",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),lf.prototype.start=function(){this.Vc=!1,this.lastStreamToken=void 0,rf.prototype.start.call(this)},lf.prototype.fc=function(){this.Vc&&this.vc([])},lf.prototype.Ic=function(t){return this.ec.Ac("Write",t)},lf.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vc){this.Ps.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Cr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Co(t.updateTime):Co(e);n.isEqual(Yr.min())&&(n=Co(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new bs(n,e)}(t,r)})):[]),n=Co(t.commitTime);return this.listener.bc(n,e)}var n,r;return Cr(!t.writeResults||0===t.writeResults.length),this.Vc=!0,this.listener.Sc()},lf.prototype.Dc=function(){var t={};t.database=Fo(this.serializer),this.lc(t)},lf.prototype.vc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Go(e.serializer,t)})};this.lc(t)},lf),af=(n(ff,nf=function(){}),ff.prototype.Nc=function(){if(this.Cc)throw new Qr(Hr.FAILED_PRECONDITION,"The client has already been terminated.")},ff.prototype.xc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.xc(e,n,r,t)}).catch(function(t){throw t.code===Hr.UNAUTHENTICATED&&i.credentials.ni(),t})},ff.prototype.Fc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.Fc(e,n,r,t)}).catch(function(t){throw t.code===Hr.UNAUTHENTICATED&&i.credentials.ni(),t})},ff.prototype.terminate=function(){this.Cc=!1},ff),cf=(hf.prototype.Lc=function(){var t=this;0===this.Mc&&(this.Bc("Unknown"),this.kc=this.rs.Pn("online_state_timeout",1e4,function(){return t.kc=null,t.qc("Backend didn't respond within 10 seconds."),t.Bc("Offline"),Promise.resolve()}))},hf.prototype.Uc=function(t){"Online"===this.state?this.Bc("Unknown"):(this.Mc++,1<=this.Mc&&(this.Qc(),this.qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Bc("Offline")))},hf.prototype.set=function(t){this.Qc(),this.Mc=0,"Online"===t&&(this.$c=!1),this.Bc(t)},hf.prototype.Bc=function(t){t!==this.state&&(this.state=t,this.Oc(t))},hf.prototype.qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.$c?(Or(t),this.$c=!1):Sr("OnlineStateTracker",t)},hf.prototype.Qc=function(){null!==this.kc&&(this.kc.cancel(),this.kc=null)},hf);function hf(t,e){this.rs=t,this.Oc=e,this.state="Unknown",this.Mc=0,this.kc=null,this.$c=!0}function ff(t,e,n){var r=this;return(r=nf.call(this)||this).credentials=t,r.ec=e,r.serializer=n,r.Cc=!1,r}function lf(t,e,n,r,i){var o=this;return(o=rf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vc=!1,o}function pf(t,e,n,r,i){var o=this;return(o=of.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function df(t,e,n,r,i,o){this.ln=t,this.tc=n,this.ec=r,this.nc=i,this.listener=o,this.state=0,this.sc=0,this.ic=null,this.stream=null,this.Ps=new ta(t,e)}function yf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!If(r))return[3,4];e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function gf(t,e){t.zc.has(e.targetId)||(t.zc.set(e.targetId,e),Ef(t)?_f(t):Pf(t).oc()&&wf(t,e))}function mf(t,e){var n=t,t=Pf(n);n.zc.delete(e),t.oc()&&bf(n,e),0===n.zc.size&&(t.oc()?t.uc():If(n)&&n.Zc.set("Unknown"))}function wf(t,e){t.tu.Ie(e.targetId),Pf(t).Pc(e)}function bf(t,e){t.tu.Ie(e),Pf(t).gc(e)}function _f(e){e.tu=new Xi({Be:function(t){return e.jc.Be(t)},qe:function(t){return e.zc.get(t)||null}}),Pf(e).start(),e.Zc.Lc()}function Ef(t){return If(t)&&!Pf(t).rc()&&0<t.zc.size}function If(t){return 0===t.Hc.size}function Tf(t){t.tu=void 0}function Nf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zc.set("Online"),!(u instanceof Wi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zc.has(i)?[4,o.jc.eu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zc.delete(i),o.tu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,xf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Hi?s.tu.pe(u):u instanceof Qi?s.tu.Fe(u):s.tu.Se(u),a.isEqual(Yr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Hh(s.Kc)];case 8:return o=t.sent(),0<=a.A(o)?[4,(i=a,(e=(r=s).tu.ke(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.X()&&((n=r.zc.get(e))&&r.zc.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.zc.get(t);e&&(r.zc.set(t,e.st(vi.Z,e.et)),bf(r,t),e=new bi(e.target,t,1,e.sequenceNumber),wf(r,e))}),r.jc.nu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,xf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function xf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ha(r))throw r;return n.Hc.add(1),[4,vf(n)];case 1:return t.sent(),n.Zc.set("Offline"),i=i||function(){return Hh(n.Kc)},n.rs.Ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hc.delete(1),[4,yf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Af(e,n){return n().catch(function(t){return xf(e,t,n)})}function Sf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Cf(i=a),s=0<i.Gc.length?i.Gc[i.Gc.length-1].batchId:-1,t.label=1;case 1:if(!(If(i)&&i.Gc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Kc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.xi.Gr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Gc.length&&o.uc(),[3,7]):(s=u.batchId,function(t,e){t.Gc.push(e);t=Cf(t);t.oc()&&t.yc&&t.vc(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,xf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Of(i)&&kf(i),[2]}var e,n,r})})}function Of(t){return If(t)&&!Cf(t).rc()&&0<t.Gc.length}function kf(t){Cf(t).start()}function Df(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hc.delete(2),[4,yf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hc.add(2),[4,vf(e)]);case 3:t.sent(),e.Zc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Pf(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.Wc,e=n.rs,r={mc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zc.forEach(function(t,e){wf(n,t)}),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Tf(e),Ef(e)?(e.Zc.Uc(n),_f(e)):e.Zc.set("Unknown"),[2]})})}.bind(null,n),Rc:Nf.bind(null,n)},t.Nc(),new sf(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.cc(),Ef(n)?_f(n):n.Zc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ru.stop()];case 2:t.sent(),Tf(n),t.label=3;case 3:return[2]}})})})),n.ru}function Cf(n){var t,e,r,i=this;return n.ou||(n.ou=(t=n.Wc,e=n.rs,r={mc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Cf(e).Dc(),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Cf(e).yc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ei(n=i.code)&&n!==Hr.ABORTED?(e=r.Gc.shift(),Cf(r).cc(),[4,Af(r,function(){return r.jc.iu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Sf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Of(e)&&kf(e),[2]}})})}.bind(null,n),Sc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Cf(o),n=0,r=o.Gc;n<r.length;n++)i=r[n],e.vc(i.mutations);return[2]})})}.bind(null,n),bc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Gc.shift(),n=Fa.from(e,i,o),[4,Af(r,function(){return r.jc.su(n)})];case 1:return t.sent(),[4,Sf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Nc(),new uf(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ou.cc(),[4,Sf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ou.stop()];case 3:t.sent(),0<n.Gc.length&&(Sr("RemoteStore","Stopping write stream with "+n.Gc.length+" pending writes"),n.Gc=[]),t.label=4;case 4:return[2]}})})})),n.ou}var Lf=(Mf.prototype.T=function(){return this.au.T()},Mf.prototype.Qo=function(t,e){e=new Rf(t,e);this.au=this.au.add(e),this.uu=this.uu.add(e)},Mf.prototype.lu=function(t,e){var n=this;t.forEach(function(t){return n.Qo(t,e)})},Mf.prototype.Wo=function(t,e){this._u(new Rf(t,e))},Mf.prototype.fu=function(t,e){var n=this;t.forEach(function(t){return n.Wo(t,e)})},Mf.prototype.du=function(t){var e=this,n=new Zr(new Xr([])),r=new Rf(n,t),t=new Rf(n,t+1),i=[];return this.uu.Nt([r,t],function(t){e._u(t),i.push(t.key)}),i},Mf.prototype.wu=function(){var e=this;this.au.forEach(function(t){return e._u(t)})},Mf.prototype._u=function(t){this.au=this.au.delete(t),this.uu=this.uu.delete(t)},Mf.prototype.Tu=function(t){var e=new Zr(new Xr([])),n=new Rf(e,t),t=new Rf(e,t+1),r=ji();return this.uu.Nt([n,t],function(t){r=r.add(t.key)}),r},Mf.prototype.so=function(t){var e=new Rf(t,0),e=this.au.Ft(e);return null!==e&&t.isEqual(e.key)},Mf),Rf=(Vf.cu=function(t,e){return Zr.V(t.key,e.key)||Vr(t.Eu,e.Eu)},Vf.hu=function(t,e){return Vr(t.Eu,e.Eu)||Zr.V(t.key,e.key)},Vf);function Vf(t,e){this.key=t,this.Eu=e}function Mf(){this.au=new Di(Rf.cu),this.uu=new Di(Rf.hu)}function Uf(t,e){return"firestore_clients_"+t+"_"+e}function jf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Js()&&(n+="_"+e.uid),n}function Ff(t,e){return"firestore_targets_"+t+"_"+e}var qf=(al.Iu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Qr(r.error.code,r.error.message)),i?new al(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},al.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},al),Bf=(ul.Iu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Qr(n.error.code,n.error.message)),r?new ul(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},ul.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ul),Gf=(sl.Iu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Fi,o=0;r&&o<n.activeTargetIds.length;++o)r=hi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new sl(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},sl),zf=(ol.Iu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new ol(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},ol),Kf=(il.prototype.Au=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},il.prototype.Ru=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},il.prototype.mu=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},il),Hf=(rl.kn=function(t){return!(!t||!t.localStorage)},rl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.gu.Ca()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pu&&(i=this.getItem(Uf(this.persistenceKey,r)))&&(o=Gf.Iu(r,i))&&(this.pu=this.pu.rt(o.clientId,o));for(this.Ou(),(s=this.storage.getItem(this.xu))&&(u=this.Mu(s))&&this.ku(u),a=0,c=this.vu;a<c.length;a++)h=c[a],this.yu(h);return this.vu=[],this.window.addEventListener("unload",function(){return f.pa()}),this.yr=!0,[2]}})})},rl.prototype.er=function(t){this.setItem(this.Su,JSON.stringify(t))},rl.prototype.$u=function(){return this.Lu(this.pu)},rl.prototype.Bu=function(n){var r=!1;return this.pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},rl.prototype.qu=function(t){this.Uu(t,"pending")},rl.prototype.Qu=function(t,e,n){this.Uu(t,e,n),this.Ku(t)},rl.prototype.Wu=function(t){var e,n="not-current";return this.Bu(t)&&(!(e=this.storage.getItem(Ff(this.persistenceKey,t)))||(e=Bf.Iu(t,e))&&(n=e.state)),this.ju.Au(t),this.Ou(),n},rl.prototype.Gu=function(t){this.ju.Ru(t),this.Ou()},rl.prototype.zu=function(t){return this.ju.activeTargetIds.has(t)},rl.prototype.Hu=function(t){this.removeItem(Ff(this.persistenceKey,t))},rl.prototype.Ju=function(t,e,n){this.Yu(t,e,n)},rl.prototype.Xu=function(t,e,n){var r=this;e.forEach(function(t){r.Ku(t)}),this.currentUser=t,n.forEach(function(t){r.qu(t)})},rl.prototype.Zu=function(t){this.th(t)},rl.prototype.eh=function(){this.nh()},rl.prototype.pa=function(){this.yr&&(this.window.removeEventListener("storage",this.Vu),this.removeItem(this.bu),this.yr=!1)},rl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},rl.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},rl.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},rl.prototype.yu=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Sr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.bu)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.yr){if(null!==o.key)if(this.Du.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Cu.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.ah(n)]}else if(this.Nu.test(o.key)){if(null!==o.newValue&&(r=this.uh(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xu){if(null!==o.newValue&&(i=this.Mu(o.newValue)))return[2,this.ku(i)]}else if(o.key===this.Su)(i=function(t){var e=Za.nr;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Za.nr&&this.Xi(i);else if(o.key===this.Fu)return[2,this.gu.lh()]}else this.vu.push(o);return[2]})})})}},Object.defineProperty(rl.prototype,"ju",{get:function(){return this.pu.get(this.Pu)},enumerable:!1,configurable:!0}),rl.prototype.Ou=function(){this.setItem(this.bu,this.ju.mu())},rl.prototype.Uu=function(t,e,n){n=new qf(this.currentUser,t,e,n),t=jf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.mu())},rl.prototype.Ku=function(t){t=jf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},rl.prototype.th=function(t){t={clientId:this.Pu,onlineState:t};this.storage.setItem(this.xu,JSON.stringify(t))},rl.prototype.Yu=function(t,e,n){var r=Ff(this.persistenceKey,t),n=new Bf(t,e,n);this.setItem(r,n.mu())},rl.prototype.nh=function(){this.setItem(this.Fu,"value-not-used")},rl.prototype.sh=function(t){t=this.Du.exec(t);return t?t[1]:null},rl.prototype.rh=function(t,e){t=this.sh(t);return Gf.Iu(t,e)},rl.prototype.oh=function(t,e){var n=this.Cu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return qf.Iu(new Da(n),t,e)},rl.prototype.uh=function(t,e){t=this.Nu.exec(t),t=Number(t[1]);return Bf.Iu(t,e)},rl.prototype.Mu=function(t){return zf.Iu(t)},rl.prototype.ah=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.gu._h(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},rl.prototype.hh=function(t){return this.gu.fh(t.targetId,t.state,t.error)},rl.prototype.ih=function(t,e){var n=this,r=e?this.pu.rt(t,e):this.pu.remove(t),i=this.Lu(this.pu),o=this.Lu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.gu.dh(s,u).then(function(){n.pu=r})},rl.prototype.ku=function(t){this.pu.get(t.clientId)&&this.Oc(t.onlineState)},rl.prototype.Lu=function(t){var n=Fi;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},rl),Qf=(nl.prototype.qu=function(t){},nl.prototype.Qu=function(t,e,n){},nl.prototype.Wu=function(t){return this.wh.Au(t),this.Th[t]||"not-current"},nl.prototype.Ju=function(t,e,n){this.Th[t]=e},nl.prototype.Gu=function(t){this.wh.Ru(t)},nl.prototype.zu=function(t){return this.wh.activeTargetIds.has(t)},nl.prototype.Hu=function(t){delete this.Th[t]},nl.prototype.$u=function(){return this.wh.activeTargetIds},nl.prototype.Bu=function(t){return this.wh.activeTargetIds.has(t)},nl.prototype.start=function(){return this.wh=new Kf,Promise.resolve()},nl.prototype.Xu=function(t,e,n){},nl.prototype.Zu=function(t){},nl.prototype.pa=function(){},nl.prototype.er=function(t){},nl.prototype.eh=function(){},nl),Wf=function(t){this.key=t},Yf=function(t){this.key=t},Xf=(Object.defineProperty(el.prototype,"Ph",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),el.prototype.gh=function(t,e){var s=this,u=e?e.Vh:new Bi,a=(e||this).Rh,c=(e||this).Qt,h=a,f=!1,l=uu(this.query)&&a.size===this.query.limit?a.last():null,p=au(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof $s?e:null)&&(bu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.yh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),uu(this.query)||au(this.query))for(;h.size>this.query.limit;){var n=uu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,Vh:u,ph:f,Qt:c}},el.prototype.yh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},el.prototype.bi=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.Qt=t.Qt;var i=t.Vh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.Zt?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Gi(this.query,t.Rh,r,i,t.Qt,0==n,e,!1),Dh:s}:{Dh:s}},el.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.bi({Rh:this.Rh,Vh:new Bi,Qt:this.Qt,ph:!1},!1)):{Dh:[]}},el.prototype.Ch=function(t){return!this.Eh.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).Je},el.prototype.bh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Eh=e.Eh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Eh=e.Eh.delete(t)}),this.Zt=t.Zt)},el.prototype.Sh=function(){var e=this;if(!this.Zt)return[];var n=this.mh;this.mh=ji(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Yf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Wf(t))}),r},el.prototype.Nh=function(t){this.Eh=t.Xa,this.mh=ji();t=this.gh(t.documents);return this.bi(t,!0)},el.prototype.xh=function(){return Gi.jt(this.query,this.Rh,this.Qt,0===this.Ih)},el),Jf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},$f=function(t){this.key=t,this.Fh=!1},Zf=(Object.defineProperty(tl.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),tl);function tl(t,e,n,r,i,o){this.Kc=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Kr(mu,gu),this.qh=new Map,this.Uh=[],this.Qh=new Ti(Zr.V),this.Kh=new Map,this.Wh=new Lf,this.jh={},this.Gh=new Map,this.zh=Eh.vo(),this.onlineState="Unknown",this.Hh=void 0}function el(t,e){this.query=t,this.Eh=e,this.Ih=null,this.Zt=!1,this.mh=ji(),this.Qt=ji(),this.Ah=_u(t),this.Rh=new qi(this.Ah)}function nl(){this.wh=new Kf,this.Th={},this.Oc=null,this.Xi=null}function rl(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.Pu=r,this.gu=null,this.Oc=null,this.Xi=null,this.Vu=this.yu.bind(this),this.pu=new Ti(Vr),this.yr=!1,this.vu=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.bu=Uf(this.persistenceKey,this.Pu),this.Su="firestore_sequence_number_"+this.persistenceKey,this.pu=this.pu.rt(this.Pu,new Kf),this.Du=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Cu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Nu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xu="firestore_online_state_"+this.persistenceKey,this.Fu="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Vu)}function il(){this.activeTargetIds=Fi}function ol(t,e){this.clientId=t,this.onlineState=e}function sl(t,e){this.clientId=t,this.activeTargetIds=e}function ul(t,e,n){this.targetId=t,this.state=e,this.error=n}function al(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function cl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Xh(r.Kc,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.bi(e,r.Jh,n),[2,(wl(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Xh(i.Kc,o,!0)];case 1:return n=t.sent(),r=new Xf(o,n.Xa),e=r.gh(n.documents),n=Ki.Xt(s,u&&"Offline"!==i.onlineState),n=r.bi(e,i.Jh,n),wl(i,s,n.Dh),r=new Jf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function hl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Sl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Kc,a=p,h=i,f=Wr.now(),o=a.reduce(function(t,e){return t.add(e.key)},ji()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ga.Li(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Vs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof $s?t.field(i.field):void 0,o=ts(i.transform,o||null);null!=o&&(e=(null==e?new zs:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new Ds(i.key,o,function s(t){var u=[];return Fr(t.fields||{},function(t,e){var n=new $r([t]);if(To(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new gs(u)}(o.proto.mapValue),_s.exists(!0)))}return h.xi.Qr(u,f,e,a)})}).then(function(t){var e=t.wi(c);return{batchId:t.batchId,Ii:e}}))];case 2:return s=t.sent(),u.kh.qu(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.Ys()])||new Ti(Vr)).rt(n,r),e.jh[e.currentUser.Ys()]=i,[4,_l(u,s.Ii)];case 3:return t.sent(),[4,Sf(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ta(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function fl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Qh(n.Kc,i)];case 2:return e=t.sent(),i.Gt.forEach(function(t,e){e=n.Kh.get(e);e&&(Cr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Fh=!0:0<t.ee.size?Cr(e.Fh):0<t.ne.size&&(Cr(e.Fh),e.Fh=!1))}),[4,_l(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function ll(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Bs(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Bs(i)&&(o=!0)}),o&&Oa(t)}(t.Mh,n),r.length&&t.Lh.Rc(r),t.onlineState=n,t.Jh&&t.kh.Zu(n))}function pl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.xi.Wr(e,r).next(function(t){return Cr(null!==t),n=t.keys(),i.xi.Yr(e,t)}).next(function(){return i.xi.no(e)}).next(function(){return i.Ga.Li(e,n)})}))];case 2:return o=t.sent(),vl(n,u,a),yl(n,u),n.kh.Qu(u,"rejected",a),[4,_l(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function dl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:If((n=o).Oh)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Kc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.xi.zr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ta(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function yl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function vl(t,e,n){var r=t,i=r.jh[r.currentUser.Ys()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.Ys()]=i)}function gl(e,t,n){void 0===n&&(n=null),e.kh.Gu(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.du(t).forEach(function(t){e.Wh.so(t)||ml(e,t)})}function ml(t,e){var n=t.Qh.get(e);null!==n&&(mf(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),bl(t))}function wl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Wf?(t.Wh.Qo(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.Uh.push(e),bl(t))}(t,o)):o instanceof Yf?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.Wo(o.key,e),t.Wh.so(o.key)||ml(t,o.key)):Pr()}}function bl(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new $f(e)),t.Qh=t.Qh.rt(e,n),gf(t.Oh,new bi(pu(su(e.path)),n,2,Za.nr))}}function _l(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.T()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ju(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=$a.Yi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.Rc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ea.forEach(c,function(e){return ea.forEach(e.Hi,function(t){return r.persistence.Lr.Qo(n,e.targetId,t)}).next(function(){return ea.forEach(e.Ji,function(t){return r.persistence.Lr.Wo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ha(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Qa.get(o),u=s.et,u=s.it(u),r.Qa=r.Qa.rt(o,u));return[2]}})})}(n.Kc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function El(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.Ys()),[4,zh(n.Kc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new Qr(Hr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xu(o,r.Ja,r.Ya),[4,_l(n,r.Ha)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Il(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Kc,n=a,i=(r=e).xi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.jr(e,n).next(function(t){return t?r.Ga.Li(e,t):ea.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Sf(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(vl(o,a,h||null),yl(o,a),o.Kc.xi.Zr(a)):Pr(),t.label=4;case 4:return[4,_l(o,s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Tl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Al(r=h),Sl(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$u(),[4,Nl(r,e.O())]);case 1:return i=t.sent(),r.Hh=!0,[4,Df(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],gf(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.zu(e)?a.push(e):c=c.then(function(){return gl(r,e),Yh(r.Kc,e,!0)}),mf(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,Nl(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){mf(n.Oh,e)}),n.Wh.wu(),n.Kh=new Map,n.Qh=new Ti(Zr.V),r.Hh=!1,[4,Df(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Nl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,Wh(e.Kc,pu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xh((e=r).Kc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&wl(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Jh(e.Kc,s)];case 8:return l=t.sent(),[4,Wh(e.Kc,l)];case 9:return u=t.sent(),[4,cl(e,xl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.Rc(r),n)]}})})}function xl(t){return ou(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Al(t){return t.Oh.jc.nu=fl.bind(null,t),t.Oh.jc.Be=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return ji().add(t.key);var r=ji();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Ot(s.view.Ph);return r}.bind(null,t),t.Oh.jc.eu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ju(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Ti(Zr.V)).rt(n,new Zs(n,Yr.min())),i=ji().add(n),i=new zi(Yr.min(),new Map,new Di(Vr),r,i),[4,fl(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),bl(e),[3,4];case 2:return[4,Yh(e.Kc,s,!1).then(function(){return gl(e,s,u)}).catch(tf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.Rc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.ks=s}}r&&Oa(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function Sl(t){return t.Oh.jc.su=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Kh(e.Kc,o)];case 2:return r=t.sent(),vl(e,n,null),yl(e,n),e.kh.Qu(n,"acknowledged"),[4,_l(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.jc.iu=pl.bind(null,t),t}var Ol,kl,Dl,Pl,Cl,Ll=(mp.prototype.za=function(t){this.Zh=t},mp.prototype.Ui=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.B())||i.isEqual(Yr.min())?this.tl(e,r):this.Zh.Li(e,o).next(function(t){var n=s.el(r,t);return(uu(r)||au(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Ar()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wu(r)),s.Zh.Ui(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},mp.prototype.el=function(n,t){var r=new Di(_u(n));return t.forEach(function(t,e){e instanceof $s&&bu(n,e)&&(r=r.add(e))}),r},mp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.A(r))},mp.prototype.tl=function(t,e){return Ar()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",wu(e)),this.Zh.Ui(t,e,Yr.min())},mp),Rl=(gp.prototype.Ur=function(t){return ea.resolve(0===this.xi.length)},gp.prototype.Qr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.xi.length&&this.xi[this.xi.length-1];n=new ja(i,e,n,r);this.xi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new Rf(u.key,i)),this.Fi.Kr(t,u.key.path.S())}return ea.resolve(n)},gp.prototype.Wr=function(t,e){return ea.resolve(this.il(e))},gp.prototype.Gr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return ea.resolve(this.xi.length>e?this.xi[e]:null)},gp.prototype.zr=function(){return ea.resolve(0===this.xi.length?-1:this.nl-1)},gp.prototype.Hr=function(t){return ea.resolve(this.xi.slice())},gp.prototype.Mi=function(t,e){var n=this,r=new Rf(e,0),e=new Rf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Nt([r,e],function(t){t=n.il(t.Eu);i.push(t)}),ea.resolve(i)},gp.prototype.qi=function(t,e){var n=this,r=new Di(Vr);return e.forEach(function(t){var e=new Rf(t,0),t=new Rf(t,Number.POSITIVE_INFINITY);n.sl.Nt([e,t],function(t){r=r.add(t.Eu)})}),ea.resolve(this.ol(r))},gp.prototype.Gi=function(t,e){var n=e.path,r=n.length+1,e=n;Zr.G(e)||(e=e.child(""));var e=new Rf(new Zr(e),0),i=new Di(Vr);return this.sl.xt(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(i=i.add(t.Eu)),!0)},e),ea.resolve(this.ol(i))},gp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},gp.prototype.Yr=function(n,r){var i=this;Cr(0===this.al(r.batchId,"removed")),this.xi.shift();var o=this.sl;return ea.forEach(r.mutations,function(t){var e=new Rf(t.key,r.batchId);return o=o.delete(e),i.Lr.eo(n,t.key)}).next(function(){i.sl=o})},gp.prototype.Zr=function(t){},gp.prototype.so=function(t,e){var n=new Rf(e,0),n=this.sl.Ft(n);return ea.resolve(e.isEqual(n&&n.key))},gp.prototype.no=function(t){return this.xi.length,ea.resolve()},gp.prototype.al=function(t,e){return this.rl(t)},gp.prototype.rl=function(t){return 0===this.xi.length?0:t-this.xi[0].batchId},gp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.xi.length?null:this.xi[t]},gp),Vl=(vp.prototype.Ri=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.cl(e);return this.docs=this.docs.rt(r,{gi:e,size:i,readTime:n}),this.size+=i-o,this.Fi.Kr(t,r.path.S())},vp.prototype.Vi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},vp.prototype.yi=function(t,e){e=this.docs.get(e);return ea.resolve(e?e.gi:null)},vp.prototype.getEntries=function(t,e){var n=this,r=Ci;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.gi:null)}),ea.resolve(r)},vp.prototype.Ui=function(t,e,n){for(var r=Vi,i=new Zr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,s=a.gi,a=a.readTime;if(!e.path.N(u.path))break;a.A(n)<=0||s instanceof $s&&bu(e,s)&&(r=r.rt(s.key,s))}return ea.resolve(r)},vp.prototype.ul=function(t,e){return ea.forEach(this.docs,function(t){return e(t)})},vp.prototype._o=function(t){return new Ml(this)},vp.prototype.wo=function(t){return ea.resolve(this.size)},vp),Ml=(n(yp,Cl=h),yp.prototype.bi=function(n){var r=this,i=[];return this.Ii.forEach(function(t,e){e&&e.gi?i.push(r.To.Ri(n,e.gi,r.Ai(t))):r.To.Vi(t)}),ea.xn(i)},yp.prototype.pi=function(t,e){return this.To.yi(t,e)},yp.prototype.vi=function(t,e){return this.To.getEntries(t,e)},yp),Ul=(dp.prototype.De=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),ea.resolve()},dp.prototype.Co=function(t){return ea.resolve(this.lastRemoteSnapshotVersion)},dp.prototype.No=function(t){return ea.resolve(this.ll)},dp.prototype.bo=function(t){return this.highestTargetId=this.fl.next(),ea.resolve(this.highestTargetId)},dp.prototype.xo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),ea.resolve()},dp.prototype.Oo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Eh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},dp.prototype.Fo=function(t,e){return this.Oo(e),this.targetCount+=1,ea.resolve()},dp.prototype.ko=function(t,e){return this.Oo(e),ea.resolve()},dp.prototype.$o=function(t,e){return this.hl.delete(e.target),this._l.du(e.targetId),--this.targetCount,ea.resolve()},dp.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.Lo(n,e.targetId)),s++)}),ea.xn(u).next(function(){return s})},dp.prototype.Bo=function(t){return ea.resolve(this.targetCount)},dp.prototype.qo=function(t,e){e=this.hl.get(e)||null;return ea.resolve(e)},dp.prototype.Uo=function(t,e,n){return this._l.lu(e,n),ea.resolve()},dp.prototype.Ko=function(e,t,n){this._l.fu(t,n);var r=this.persistence.Lr,i=[];return r&&t.forEach(function(t){i.push(r.eo(e,t))}),ea.xn(i)},dp.prototype.Lo=function(t,e){return this._l.du(e),ea.resolve()},dp.prototype.jo=function(t,e){e=this._l.Tu(e);return ea.resolve(e)},dp.prototype.so=function(t,e){return ea.resolve(this._l.so(e))},dp),jl=(pp.prototype.mo=function(t,e){return ea.resolve(this.dl.get(e))},pp.prototype.Ao=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Co(e.createTime)}),ea.resolve()},pp.prototype.Ro=function(t,e){return ea.resolve(this.wl.get(e))},pp.prototype.Po=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:Ac(e.bundledQuery),readTime:Co(e.readTime)}),ea.resolve()},pp),Fl=(lp.prototype.start=function(){return Promise.resolve()},lp.prototype.pa=function(){return this.Yo=!1,Promise.resolve()},Object.defineProperty(lp.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),lp.prototype.fa=function(){},lp.prototype.da=function(){},lp.prototype.Oa=function(){return this.Fi},lp.prototype.Na=function(t){var e=this.Tl[t.Ys()];return e||(e=new Rl(this.Fi,this.Lr),this.Tl[t.Ys()]=e),e},lp.prototype.xa=function(){return this.ra},lp.prototype.Fa=function(){return this.Ni},lp.prototype.Ma=function(){return this.oa},lp.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new ql(this.Jo.next());return this.Lr.Il(),n(i).next(function(t){return r.Lr.ml(i).next(function(){return t})}).Cn().then(function(t){return i.Ci(),t})},lp.prototype.Al=function(e,n){return ea.Fn(Object.values(this.Tl).map(function(t){return function(){return t.so(e,n)}}))},lp),ql=(n(fp,Pl=Ee),fp),Bl=(hp.gl=function(t){return new hp(t)},Object.defineProperty(hp.prototype,"Vl",{get:function(){if(this.Pl)return this.Pl;throw Pr()},enumerable:!1,configurable:!0}),hp.prototype.Qo=function(t,e,n){return this.Rl.Qo(n,e),this.Vl.delete(n.toString()),ea.resolve()},hp.prototype.Wo=function(t,e,n){return this.Rl.Wo(n,e),this.Vl.add(n.toString()),ea.resolve()},hp.prototype.eo=function(t,e){return this.Vl.add(e.toString()),ea.resolve()},hp.prototype.removeTarget=function(t,e){var n=this;this.Rl.du(e.targetId).forEach(function(t){return n.Vl.add(t.toString())});var r=this.persistence.xa();return r.jo(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vl.add(t.toString())})}).next(function(){return r.$o(t,e)})},hp.prototype.Il=function(){this.Pl=new Set},hp.prototype.ml=function(n){var r=this,i=this.persistence.Fa()._o();return ea.forEach(this.Vl,function(t){var e=Zr.K(t);return r.yl(n,e).next(function(t){t||i.Vi(e)})}).next(function(){return r.Pl=null,i.apply(n)})},hp.prototype.qa=function(t,e){var n=this;return this.yl(t,e).next(function(t){t?n.Vl.delete(e.toString()):n.Vl.add(e.toString())})},hp.prototype.El=function(t){return 0},hp.prototype.yl=function(t,e){var n=this;return ea.Fn([function(){return ea.resolve(n.Rl.so(e))},function(){return n.persistence.xa().so(t,e)},function(){return n.persistence.Al(t,e)}])},hp),Gl=(cp.prototype.mc=function(t){this.bl=t},cp.prototype.dc=function(t){this.Sl=t},cp.prototype.onMessage=function(t){this.Dl=t},cp.prototype.close=function(){this.vl()},cp.prototype.send=function(t){this.pl(t)},cp.prototype.Cl=function(){this.bl()},cp.prototype.Nl=function(t){this.Sl(t)},cp.prototype.xl=function(t){this.Dl(t)},cp),zl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Kl=(ap.prototype.xc=function(e,t,n,r){var i=this.kl(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},ap.prototype.Fc=function(t,e,n,r){return this.xc(t,e,n,r)},ap.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2-20201012233953",t["Content-Type"]="text/plain",e)for(var n in e.ti)e.ti.hasOwnProperty(n)&&(t[n]=e.ti[n])},ap.prototype.kl=function(t,e){t=zl[t];return this.Ol+"/v1/"+e+":"+t},n(up,Dl=ap),up.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Qr(Hr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Hr).indexOf(e)?e:Hr.UNKNOWN,r(new Qr(e,t.message))):r(new Qr(Hr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Qr(Hr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},up.prototype.Ac=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Gl({pl:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},vl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.Nl())}),t(mr.EventType.ERROR,function(t){u||(u=!0,kr("Connection","WebChannel transport errored:",t),a.Nl(new Qr(Hr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Cr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=wi[r];if(void 0!==t)return Ii(t)}(),i=n.message,void 0===t&&(t=Hr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Nl(new Qr(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.xl(e)))}),setTimeout(function(){a.Cl()},0),a},up),Hl=(sp.prototype.Xc=function(t){this.Kl.push(t)},sp.prototype.pa=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},sp.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},sp.prototype.ql=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},sp.prototype.Ql=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},sp.kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},sp),Ql=(op.prototype.Xc=function(t){},op.prototype.pa=function(){},op),Wl=(ip.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Wa(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Kc=this.Jl(e),[2]}})})},ip.prototype.Hl=function(t){return null},ip.prototype.Jl=function(t){return Gh(this.persistence,new Ll,t.Yl,this.serializer)},ip.prototype.Gl=function(t){return new Fl(Bl.gl,this.serializer)},ip.prototype.jl=function(t){return new Qf},ip.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.pa()];case 1:return t.sent(),[4,this.persistence.pa()];case 2:return t.sent(),[2]}})})},ip),Yl=(n(rp,kl=Wl),rp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,kl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Zh(this.Kc)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,Sl(this.Xl.gu)];case 4:return t.sent(),[4,Sf(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},rp.prototype.Jl=function(t){return Gh(this.persistence,new Ll,t.Yl,this.serializer)},rp.prototype.Hl=function(t){var e=this.persistence.Lr.Rr;return new hc(e,t.rs)},rp.prototype.Gl=function(t){var e=Fh(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?uc.Tr(this.cacheSizeBytes):uc.mr;return new Ph(this.synchronizeTabs,e,t.clientId,n,t.rs,ma(),wa(),this.serializer,this.kh,!!this.forceOwnership)},rp.prototype.jl=function(t){return new Qf},rp),Xl=(n(np,Ol=Yl),np.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Ol.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.gu,this.kh instanceof Hf?(this.kh.gu={_h:Il.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,$h(e.Kc)];case 3:return n=t.sent(),r=zi.Yt(o,"current"===s),[4,_l(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Yh(e.Kc,o,!0)];case 6:return t.sent(),gl(e,o,u),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Al(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Sr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Jh(n.Kc,r)]):[3,6];case 2:return i=t.sent(),[4,Wh(n.Kc,i)];case 3:return o=t.sent(),[4,cl(n,xl(i),o.targetId,!1)];case 4:t.sent(),gf(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,Yh(n.Kc,e,!1).then(function(){mf(n.Oh,e),gl(n,e)}).catch(tf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ca:function(t){return t.Kc.persistence.Ca()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,$h((e=n).Kc).then(function(t){return _l(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence._a(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Tl(this.Xl.gu,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.yr?this.zl.start(this.Kc):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},np.prototype.jl=function(t){var e=ma();if(!Hf.kn(e))throw new Qr(Hr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Fh(t.Fl.t,t.Fl.persistenceKey);return new Hf(e,t.rs,n,t.clientId,t.Yl)},np),Jl=(ep.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Kc?[3,2]:(this.Kc=n.Kc,this.kh=n.kh,this.Wc=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.gu=this.n_(r,!n.synchronizeTabs),this.kh.Oc=function(t){return ll(e.gu,t,1)},this.Oh.jc.s_=El.bind(null,this.gu),[4,Df(this.Oh,this.gu.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ep.prototype.e_=function(t){return new Na},ep.prototype.Zl=function(t){var e=Wa(t.Fl.t),n=(n=t.Fl,new Kl(n));return t=t.credentials,new af(t,n,e)},ep.prototype.t_=function(t){var e=this,n=this.Kc,r=this.Wc,i=t.rs,o=function(t){return ll(e.gu,t,0)},t=new(Hl.kn()?Hl:Ql);return new ef(n,r,i,o,t)},ep.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new Zf(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Kc,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},ep.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Hc.add(5),[4,vf(e)];case 1:return t.sent(),e.Yc.pa(),e.Zc.set("Unknown"),[2]}})})}(this.Oh)},ep),$l=(tp.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},tp.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},tp.prototype.r_=function(){this.muted=!0},tp.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},tp),Zl=function(t){this.o_=t};function tp(t){this.observer=t,this.muted=!1}function ep(){}function np(t,e){var n=this;return(n=Ol.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function rp(t,e,n){var r=this;return(r=kl.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function ip(){this.synchronizeTabs=!1}function op(){}function sp(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function up(t){var e=this;return(e=Dl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function ap(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function cp(t){this.pl=t.pl,this.vl=t.vl}function hp(t){this.persistence=t,this.Rl=new Lf,this.Pl=null}function fp(t){var e=this;return(e=Pl.call(this)||this).Go=t,e}function lp(t,e){var n=this;this.Tl={},this.Jo=new Za(0),this.Yo=!1,this.Yo=!0,this.Lr=t(this),this.ra=new Ul(this),this.Fi=new zc,this.Ni=(t=this.Fi,new Vl(t,function(t){return n.Lr.El(t)})),this.serializer=new gc(e),this.oa=new jl(this.serializer)}function pp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function dp(t){this.persistence=t,this.hl=new Kr(pi,di),this.lastRemoteSnapshotVersion=Yr.min(),this.highestTargetId=0,this.ll=0,this._l=new Lf,this.targetCount=0,this.fl=Eh.po()}function yp(t){var e=this;return(e=Cl.call(this)||this).To=t,e}function vp(t,e){this.Fi=t,this.cl=e,this.docs=new Ti(Zr.V),this.size=0}function gp(t,e){this.Fi=t,this.Lr=e,this.xi=[],this.nl=1,this.sl=new Di(Rf.cu)}function mp(){}function wp(t,e,n){if(!n)throw new Qr(Hr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function bp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function _p(t,e,n,r){if(!0===e&&!0===r)throw new Qr(Hr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ep(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ip(t,e){if(t instanceof Zl&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Qr(Hr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Ep(t);throw new Qr(Hr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Tp(t,e){if(e<=0)throw new Qr(Hr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Np,xp=function(t){this.a_=t},Ap=(n(Sp,Np=xp),Sp.prototype.c_=function(t){if(2!==t.u_)throw 1===t.u_?t.h_(this.a_+"() can only appear at the top level of your update data"):t.h_(this.a_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Sp.prototype.isEqual=function(t){return t instanceof Sp},Sp);function Sp(){return null!==Np&&Np.apply(this,arguments)||this}function Op(t,e,n){return new Nd({u_:3,l_:e.settings.l_,methodName:t.a_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var kp,Dp,Pp,Cp,Lp=(n(Wp,Cp=xp),Wp.prototype.c_=function(t){return new ms(t.path,new rs)},Wp.prototype.isEqual=function(t){return t instanceof Wp},Wp),Rp=(n(Qp,Pp=xp),Qp.prototype.c_=function(t){var e=Op(this,t,!0),n=this.f_.map(function(t){return Cd(t,e)}),n=new is(n);return new ms(t.path,n)},Qp.prototype.isEqual=function(t){return this===t},Qp),Vp=(n(Hp,Dp=xp),Hp.prototype.c_=function(t){var e=Op(this,t,!0),n=this.f_.map(function(t){return Cd(t,e)}),n=new cs(n);return new ms(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Mp=(n(Kp,kp=xp),Kp.prototype.c_=function(t){var e=new ps(t.serializer,ko(t.serializer,this.d_));return new ms(t.path,e)},Kp.prototype.isEqual=function(t){return this===t},Kp),Up=(Object.defineProperty(zp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(zp.prototype,"longitude",{get:function(){return this.T_},enumerable:!1,configurable:!0}),zp.prototype.isEqual=function(t){return this.w_===t.w_&&this.T_===t.T_},zp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.T_}},zp.prototype.I=function(t){return Vr(this.w_,t.w_)||Vr(this.T_,t.T_)},zp),jp=(Gp.fromBase64String=function(t){try{return new Gp(vi.fromBase64String(t))}catch(t){throw new Qr(Hr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Gp.fromUint8Array=function(t){return new Gp(vi.fromUint8Array(t))},Gp.prototype.toBase64=function(){return this.E_.toBase64()},Gp.prototype.toUint8Array=function(){return this.E_.toUint8Array()},Gp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Gp.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},Gp),Fp=new Map,qp=(Bp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Bp);function Bp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Qr(Hr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Qr(Hr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,_p("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Gp(t){this.E_=t}function zp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Qr(Hr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Qr(Hr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.T_=e}function Kp(t,e){var n=this;return(n=kp.call(this,t)||this).d_=e,n}function Hp(t,e){var n=this;return(n=Dp.call(this,t)||this).f_=e,n}function Qp(t,e){var n=this;return(n=Pp.call(this,t)||this).f_=e,n}function Wp(){return null!==Cp&&Cp.apply(this,arguments)||this}function Yp(){if("undefined"==typeof Uint8Array)throw new Qr(Hr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Xp(){if("undefined"==typeof atob)throw new Qr(Hr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Jp,$p,Zp,td=(n(ud,Zp=jp),ud.fromBase64String=function(t){Xp();try{return new ud(vi.fromBase64String(t))}catch(t){throw new Qr(Hr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ud.fromUint8Array=function(t){return Yp(),new ud(vi.fromUint8Array(t))},ud.prototype.toBase64=function(){return Xp(),Zp.prototype.toBase64.call(this)},ud.prototype.toUint8Array=function(){return Yp(),Zp.prototype.toUint8Array.call(this)},ud.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ud),h=(sd.prototype.I_=function(t,e){switch(void 0===e&&(e="none"),co(t)){case 0:return null;case 1:return t.booleanValue;case 2:return go(t.integerValue||t.doubleValue);case 3:return this.m_(t.timestampValue);case 4:return this.A_(t,e);case 5:return t.stringValue;case 6:return this.R_(mo(t.bytesValue));case 7:return this.P_(t.referenceValue);case 8:return this.g_(t.geoPointValue);case 9:return this.V_(t.arrayValue,e);case 10:return this.y_(t.mapValue,e);default:throw Pr()}},sd.prototype.y_=function(t,n){var r=this,i={};return Fr(t.fields||{},function(t,e){i[t]=r.I_(e,n)}),i},sd.prototype.g_=function(t){return new Up(go(t.latitude),go(t.longitude))},sd.prototype.V_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.I_(t,e)})},sd.prototype.A_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return so(e)?t(e):e}(t);return null==n?null:this.I_(n,e);case"estimate":return this.m_(uo(t));default:return null}},sd.prototype.m_=function(t){t=vo(t);return new Wr(t.seconds,t.nanos)},sd.prototype.p_=function(t,e){var n=Xr.k(t);Cr(Zo(n));t=new Ir(n.get(1),n.get(3)),n=new Zr(n.v(5));return t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},sd),ed=(n(od,$p=h),od.prototype.R_=function(t){return new td(t)},od.prototype.P_=function(t){t=this.p_(t,this.firestore.v_);return My.b_(t,this.firestore,null)},od),Ee=(Object.defineProperty(id.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(id.prototype,"ref",{get:function(){return new fd(this.S_,this.x_,this.C_)},enumerable:!1,configurable:!0}),id.prototype.exists=function(){return null!==this.N_},id.prototype.data=function(){if(this.N_){if(this.x_){var t=new nd(this.S_,this.D_,this.C_,this.N_,null);return this.x_.fromFirestore(t)}return this.D_.I_(this.N_.sn())}},id.prototype.get=function(t){if(this.N_){t=this.N_.data().field(ad("DocumentSnapshot.get",t));if(null!==t)return this.D_.I_(t)}},id),nd=(n(rd,Jp=Ee),rd.prototype.data=function(){return Jp.prototype.data.call(this)},rd);function rd(){return null!==Jp&&Jp.apply(this,arguments)||this}function id(t,e,n,r,i){this.S_=t,this.D_=e,this.C_=n,this.N_=r,this.x_=i}function od(t){var e=this;return(e=$p.call(this)||this).firestore=t,e}function sd(){}function ud(){return null!==Zp&&Zp.apply(this,arguments)||this}function ad(t,e){return"string"==typeof e?jd(t,e):(e instanceof Zl?e.o_:e).F_}var cd,hd=(gd.prototype.isEqual=function(t){return this.F_.isEqual(t.F_)},gd),fd=(Object.defineProperty(vd.prototype,"O_",{get:function(){return this.C_.path},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"path",{get:function(){return this.C_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"parent",{get:function(){return new pd(this.firestore,this.x_,this.C_.path.S())},enumerable:!1,configurable:!0}),vd.prototype.withConverter=function(t){return new vd(this.firestore,t,this.C_)},vd),ld=(yd.prototype.withConverter=function(t){return new yd(this.firestore,t,this.M_)},yd),pd=(n(dd,cd=ld),Object.defineProperty(dd.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"parent",{get:function(){var t=this.O_.S();return t.T()?null:new fd(this.firestore,null,new Zr(t))},enumerable:!1,configurable:!0}),dd.prototype.withConverter=function(t){return new dd(this.firestore,t,this.O_)},dd);function dd(t,e,n){var r=this;return(r=cd.call(this,t,e,su(n))||this).firestore=t,r.O_=n,r.type="collection",r}function yd(t,e,n){this.x_=e,this.M_=n,this.type="query",this.firestore=t}function vd(t,e,n){this.x_=e,this.C_=n,this.type="document",this.firestore=t}function gd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new $r(t)}function md(t){var e=t.k_(),n=Wa(t.v_);return new xd(t.v_,!!e.ignoreUndefinedProperties,n)}var wd=/^__.*__$/,bd=(Id.prototype.L_=function(t,e){var n=[];return null!==this.Qe?n.push(new Ds(t,this.data,this.Qe,e)):n.push(new ks(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Vs(t,this.fieldTransforms)),n},Id),_d=(Ed.prototype.L_=function(t,e){e=[new Ds(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Vs(t,this.fieldTransforms)),e},Ed);function Ed(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Id(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Td(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Nd=(Object.defineProperty(Sd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),Sd.prototype.q_=function(t){return new Sd(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Sd.prototype.U_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.q_({path:e,__:!1});return e.Q_(t),e},Sd.prototype.K_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.q_({path:t,__:!1});return t.B_(),t},Sd.prototype.W_=function(t){return this.q_({path:void 0,__:!0})},Sd.prototype.h_=function(t){return Fd(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.l_)},Sd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.N(t)})||void 0!==this.fieldTransforms.find(function(t){return e.N(t.field)})},Sd.prototype.B_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Q_(this.path.get(t))},Sd.prototype.Q_=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Td(this.u_)&&wd.test(t))throw this.h_('Document fields cannot begin and end with "__"')},Sd),xd=(Ad.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Nd({u_:t,methodName:e,l_:n,path:$r.$(),__:!1,j_:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Ad);function Ad(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Wa(t)}function Sd(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.B_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Od(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Vd("Data must be an object, but it was:",s,r);var u,a,r=Ld(r,s);if(o.merge)u=new gs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Md(e,f[h],n);if(!s.contains(l))throw new Qr(Hr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");qd(c,l)||c.push(l)}u=new gs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new bd(new Gs(r),u,a)}function kd(t,r,i,e){var o=t.G_(1,r,i);Vd("Data must be an object, but it was:",o,e);var s=[],u=new zs;Fr(e,function(t,e){var n=jd(r,t,i);e instanceof Zl&&(e=e.o_);t=o.K_(n);e instanceof Ap?s.push(n):null!=(t=Cd(e,t))&&(s.push(n),u.set(n,t))});e=new gs(s);return new _d(u.Ye(),e,o.fieldTransforms)}function Dd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Md(e,r,n)],a=[i];if(o.length%2!=0)throw new Qr(Hr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Md(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new zs,y=u.length-1;0<=y;--y){qd(p,u[y])||(h=u[y],(f=a[y])instanceof Zl&&(f=f.o_),l=s.K_(h),f instanceof Ap?p.push(h):null!=(l=Cd(f,l))&&(p.push(h),d.set(h,l)))}i=new gs(p);return new _d(d.Ye(),i,s.fieldTransforms)}function Pd(t,e,n,r){return void 0===r&&(r=!1),Cd(n,t.G_(r?4:3,e))}function Cd(s,t){if(s instanceof Zl&&(s=s.o_),Rd(s))return Vd("Unsupported field value:",t,s),Ld(s,t);if(s instanceof xp)return function(t,e){if(!Td(e.u_))throw e.h_(t.a_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.a_+"() is not currently supported inside arrays");t=t.c_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.u_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Cd(i[r],t.W_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Zl&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Wr.fromDate(t);return{timestampValue:Do(e.serializer,n)}}if(t instanceof Wr){var r=new Wr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Do(e.serializer,r)}}if(t instanceof Up)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jp)return{bytesValue:Po(e.serializer,t.E_)};if(t instanceof fd){n=e.t,r=t.firestore.v_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Lo(t.firestore.v_||e.t,t.C_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Ep(t))}(s,t)}function Ld(t,n){var r={};return qr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Fr(t,function(t,e){e=Cd(e,n.U_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Rd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Wr||t instanceof Up||t instanceof jp||t instanceof fd||t instanceof xp)}function Vd(t,e,n){if(!Rd(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Ep(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function Md(t,e,n){if(e instanceof Zl&&(e=e.o_),e instanceof hd)return e.F_;if("string"==typeof e)return jd(t,e);throw Fd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ud=new RegExp("[~\\*/\\[\\]]");function jd(e,n,r){if(0<=n.search(Ud))throw Fd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(hd.bind.apply(hd,i([void 0],n.split("."))))).F_}catch(t){throw Fd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Fd(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Qr(Hr.INVALID_ARGUMENT,(e+=". ")+t+n)}function qd(t,e){return t.some(function(t){return t.isEqual(e)})}var Bd=(Qd.prototype.X_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),0<this.mutations.length)throw new Qr(Hr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Fo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Vo(n.serializer,t)})},[4,n.Fc("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=Mo(t,e.found.name),t=Co(e.found.updateTime),e=new Gs({mapValue:{fields:e.found.fields}});return new $s(n,t,e,{})}(e,t):"missing"in t?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);t=Mo(t,e.missing),e=Co(e.readTime);return new Zs(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Cr(!!t),o.push(t)}),o)]}})})}(this.Wc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Zs||t instanceof $s?n.tf(t):Pr()}),e)]}})})},Qd.prototype.set=function(t,e){this.write(e.L_(t,this.je(t))),this.Y_.add(t.toString())},Qd.prototype.update=function(t,e){try{this.write(e.L_(t,this.ef(t)))}catch(t){this.J_=t}this.Y_.add(t.toString())},Qd.prototype.delete=function(t){this.write([new qs(t,this.je(t))]),this.Y_.add(t.toString())},Qd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),this.J_)throw this.J_;return e=this.z_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Zr.K(e);n.mutations.push(new Bs(e,n.je(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Fo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Go(e.serializer,t)})},[4,e.xc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wc,this.mutations)];case 1:return t.sent(),this.H_=!0,[2]}})})},Qd.prototype.tf=function(t){var e;if(t instanceof $s)e=t.version;else{if(!(t instanceof Zs))throw Pr();e=Yr.min()}var n=this.z_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Qr(Hr.ABORTED,"Document version changed between two reads.")}else this.z_.set(t.key.toString(),e)},Qd.prototype.je=function(t){var e=this.z_.get(t.toString());return!this.Y_.has(t.toString())&&e?_s.updateTime(e):_s.Ge()},Qd.prototype.ef=function(t){var e=this.z_.get(t.toString());if(this.Y_.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(Yr.min()))throw new Qr(Hr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Qd.prototype.write=function(t){this.Z_(),this.mutations=this.mutations.concat(t)},Qd.prototype.Z_=function(){},Qd),Gd=(Hd.prototype.run=function(){this.sf()},Hd.prototype.sf=function(){var t=this;this.Ps.An(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Bd(this.Wc),(n=this.rf(e))&&n.then(function(t){r.rs.fs(function(){return e.commit().then(function(){r.us.resolve(t)}).catch(function(t){r.af(t)})})}).catch(function(t){r.af(t)}),[2]})})})},Hd.prototype.rf=function(t){try{var e=this.updateFunction(t);return!ai(e)&&e.catch&&e.then?e:(this.us.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.us.reject(t),null}},Hd.prototype.af=function(t){var e=this;0<this.nf&&this.cf(t)?(--this.nf,this.rs.fs(function(){return e.sf(),Promise.resolve()})):this.us.reject(t)},Hd.prototype.cf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ei(t)},Hd),zd=(Kd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.oi.promise];case 1:return[2,(t.sent(),{rs:this.rs,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},Kd.prototype.hf=function(t){var e=this;this.uf=t,this.oi.promise.then(function(){return e.uf(e.user)})},Kd.prototype.lf=function(){if(this.rs.Vs)throw new Qr(Hr.FAILED_PRECONDITION,"The client has already been terminated.")},Kd.prototype.terminate=function(){var t=this;this.rs.bs();var n=new Zu;return this.rs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this._f?[4,this._f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ff?[4,this.ff.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ii(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ta(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Kd);function Kd(t,e,n){var r=this;this.credentials=t,this.rs=e,this.Fl=n,this.user=Da.UNAUTHENTICATED,this.clientId=Lr.u(),this.uf=function(){},this.oi=new Zu,this.credentials.si(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.uf(t)),r.oi.resolve()})}function Hd(t,e,n,r){this.rs=t,this.Wc=e,this.updateFunction=n,this.us=r,this.nf=5,this.Ps=new ta(this.rs,"transaction_retry")}function Qd(t){this.Wc=t,this.z_=new Map,this.mutations=[],this.H_=!1,this.J_=null,this.Y_=new Set}function Wd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.hf(function(e){return r.rs.Ss(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,zh(i.Kc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.fa(function(){return r.terminate()}),r.ff=i,[2]}})})}function Yd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),[4,Xd(r)];case 1:return e=t.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.hf(function(t){return r.rs.Ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).rs.Ns(),Sr("RemoteStore","RemoteStore received new credentials"),n=If(e),e.Hc.add(3),[4,vf(e)];case 1:return t.sent(),n&&e.Zc.set("Unknown"),[4,e.jc.s_(i)];case 2:return t.sent(),e.Hc.delete(3),[4,yf(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r._f=i,[2]}})})}function Xd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ff?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,Wd(e,new Wl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ff]}})})}function Jd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e._f?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,Yd(e,new Jl)]);case 1:t.sent(),t.label=2;case 2:return[2,e._f]}})})}function $d(t){return Xd(t).then(function(t){return t.persistence})}function Zd(t){return Xd(t).then(function(t){return t.Kc})}function ty(t){return Jd(t).then(function(t){return t.Oh})}function ey(t){return Jd(t).then(function(t){return t.gu})}function ny(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Jd(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ls=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Al(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wu(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,Wh(e.Kc,pu(u))];case 2:return i=t.sent(),o=e.kh.Wu(i.targetId),n=i.targetId,[4,cl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&gf(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.gu),n.Us=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!gu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Gu(n.targetId),e.kh.Bu(n.targetId)?[3,2]:[4,Yh(e.Kc,n.targetId,!1).then(function(){e.kh.Hu(n.targetId),mf(e.Oh,n.targetId),gl(e,n.targetId)}).catch(tf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return gl(e,n.targetId),[4,Yh(e.Kc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.gu),n)]}})})}function ry(n,r){var t=this,i=new Zu;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hl,[4,ey(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function iy(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ga.Oi(t,e)}))];case 1:return(r=t.sent())instanceof $s?s.resolve(r):r instanceof Zs?s.resolve(null):s.reject(new Qr(Hr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ta(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}function oy(n,r,i,o,s){var t=new $l({next:function(t){r.fs(function(){return Sa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Qr(Hr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Qr(Hr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ka(su(i.path),t,{includeMetadataChanges:!0,Hs:!0});return Aa(n,u)}var sy,uy=(Object.defineProperty(cy.prototype,"app",{get:function(){if(!this.If)throw new Qr(Hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.If},enumerable:!1,configurable:!0}),Object.defineProperty(cy.prototype,"mf",{get:function(){return this.Tf},enumerable:!1,configurable:!0}),Object.defineProperty(cy.prototype,"Af",{get:function(){return void 0!==this.Rf},enumerable:!1,configurable:!0}),cy.prototype.Pf=function(t){if(this.Tf)throw new Qr(Hr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.wf=new qp(t),void 0!==t.credentials&&(this.Ef=function(t){if(!t)return new Ra;switch(t.type){case"gapi":var e=t.client;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ua(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Qr(Hr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},cy.prototype.gf=function(){return this.wf},cy.prototype.k_=function(){return this.Tf=!0,this.wf},cy.prototype._delete=function(){return this.Rf||(this.Rf=this.Vf()),this.Rf},cy.prototype.Vf=function(){return t=this,(e=Fp.get(t))&&(Sr("ComponentProvider","Removing Datastore"),Fp.delete(t),e.terminate()),Promise.resolve();var t,e},n(ay,sy=cy),ay.prototype.Vf=function(){return this.pf||Cy(this),this.pf.terminate()},ay);function ay(t,e){var n=this;return(n=sy.call(this,t,e)||this).yf=new _a,n.df="name"in t?t.name:"[DEFAULT]",n}function cy(t,e){this.df="(lite)",this.wf=new qp({}),this.Tf=!1,t instanceof Ir?(this.v_=t,this.Ef=new Ra):(this.If=t,this.v_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Qr(Hr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.Ef=new Va(e))}function hy(n,r,i){var t=this,o=new Zu;return n.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Wd(n,i)];case 1:return t.sent(),[4,Yd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Hr.FAILED_PRECONDITION||t.code===Hr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function fy(t){if(t.mf||t.Af)throw new Qr(Hr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ly,py,dy=(n(wy,py=Ee),wy.prototype.exists=function(){return py.prototype.exists.call(this)},wy.prototype.data=function(t){if(void 0===t&&(t={}),this.N_){if(this.x_){var e=new yy(this.S_,this.D_,this.C_,this.N_,this.metadata,null);return this.x_.fromFirestore(e,t)}return this.D_.I_(this.N_.sn(),t.serverTimestamps)}},wy.prototype.get=function(t,e){if(void 0===e&&(e={}),this.N_){t=this.N_.data().field(ad("DocumentSnapshot.get",t));if(null!==t)return this.D_.I_(t,e.serverTimestamps)}},wy),yy=(n(my,ly=dy),my.prototype.data=function(t){return void 0===t&&(t={}),ly.prototype.data.call(this,t)},my),vy=(Object.defineProperty(gy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"size",{get:function(){return this.bf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),gy.prototype.forEach=function(e,n){var r=this;this.bf.docs.forEach(function(t){e.call(n,new yy(r.S_,r.D_,t.key,t,new zy(r.bf.Qt.has(t.key),r.bf.fromCache),r.query.x_))})},gy.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.bf.Wt)throw new Qr(Hr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Sf&&this.Df===t||(this.Sf=function(i,e){if(i.bf.Ut.T()){var n=0;return i.bf.docChanges.map(function(t){var e=new yy(i.S_,i.D_,t.doc.key,t.doc,new zy(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.bf.Ut;return i.bf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new yy(i.S_,i.D_,t.doc.key,t.doc,new zy(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Df=t),this.Sf},gy);function gy(t,e,n,r){this.S_=t,this.D_=e,this.bf=r,this.metadata=new zy(r.hasPendingWrites,r.fromCache),this.query=n}function my(){return null!==ly&&ly.apply(this,arguments)||this}function wy(t,e,n,r,i,o){var s=this;return(s=py.call(this,t,e,n,r,o)||this).S_=t,s.vf=t,s.metadata=i,s}function by(t,e){return t instanceof dy&&e instanceof dy?t.S_===e.S_&&t.C_.isEqual(e.C_)&&(null===t.N_?null===e.N_:t.N_.isEqual(e.N_))&&t.x_===e.x_:t instanceof vy&&e instanceof vy&&t.S_===e.S_&&(n=t.query,r=e.query,n instanceof ld&&r instanceof ld&&n.firestore===r.firestore&&gu(n.M_,r.M_)&&n.x_===r.x_)&&t.metadata.isEqual(e.metadata)&&t.bf.isEqual(e.bf);var n,r}var _y,Ey=(n(Iy,_y=h),Iy.prototype.R_=function(t){return new jp(t)},Iy.prototype.P_=function(t){t=this.p_(t,this.firestore.v_);return new fd(this.firestore,null,t)},Iy);function Iy(t){var e=this;return(e=_y.call(this)||this).firestore=t,e}function Ty(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ip(t.firestore,uy),s=md(o);return e instanceof Zl&&(e=e.o_),Ny(o,("string"==typeof e||e instanceof hd?Dd(s,"updateDoc",t.C_,e,n,r):kd(s,"updateDoc",t.C_,e)).L_(t.C_,_s.exists(!0)))}function Ny(t,e){return ry(Py(t),e)}function xy(t,e,n){var r=n.docs.get(e.C_),i=new Ey(t);return new dy(t,i,e.C_,r,new zy(n.hasPendingWrites,n.fromCache),e.x_)}var Ay,Sy=(Dy.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){fy(t);var n=Py(t),r=t.k_(),t=new Jl;return hy(n,t,new Yl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},Dy.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){fy(t);var e=Py(t),n=t.k_(),t=new Jl;return hy(e,t,new Xl(t,n.cacheSizeBytes))}(t.o_)},Dy.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.mf&&!n.Af)throw new Qr(Hr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Zu;return n.yf.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return na.kn()?(e=n+"main",[4,na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Fh(n.v_,n.df))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},Dy),Oy=(n(ky,Ay=Zl),Object.defineProperty(ky.prototype,"v_",{get:function(){return this.o_.v_},enumerable:!1,configurable:!0}),ky.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.gf()),t)).merge,this.o_.Pf(t)},ky.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.gf().host&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},ky.prototype.enableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,$d(r)];case 1:return e=t.sent(),[4,ty(r)];case 2:return n=t.sent(),[2,(e.da(!0),(t=n).Hc.delete(0),yf(t))]}})})})}(Py(this.o_))},ky.prototype.disableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,$d(r)];case 1:return e=t.sent(),[4,ty(r)];case 2:return n=t.sent(),[2,(e.da(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(0),[4,vf(e)];case 1:return t.sent(),e.Zc.set("Offline"),[2]}})})}(n))]}})})})}(Py(this.o_))},ky.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&_p("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Cf.enableMultiTabIndexedDbPersistence(this):this.Cf.enableIndexedDbPersistence(this,n)},ky.prototype.clearPersistence=function(){return this.Cf.clearIndexedDbPersistence(this)},ky.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},ky.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Zu;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=dl,[4,ey(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Py(this.o_))},ky.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Py(t),e=Ya(e)?e:{next:e},i=new $l(e);return t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.add(e),e.next()},[4,ny(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.delete(e)},[4,ny(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(ky.prototype,"app",{get:function(){if(!this.Nf)throw new Qr(Hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nf},enumerable:!1,configurable:!0}),ky.prototype.collection=function(t){return wp("Firestore.collection","path",t),Py(this.o_),new sv(Xr.k(t),this,null)},ky.prototype.doc=function(t){return wp("Firestore.doc","path",t),Py(this.o_),My.xf(Xr.k(t),this,null)},ky.prototype.collectionGroup=function(t){if(wp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Py(this.o_),new rv((t=t,new eu(Xr.$(),t)),this,null)},ky.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Zu;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Jd(n).then(function(t){return t.Wc})];case 1:return e=t.sent(),new Gd(n.rs,e,r,i).run(),[2]}})})}),i.promise}(Py(this.o_),function(t){return e(new Ry(n,t))})},ky.prototype.batch=function(){return Py(this.o_),new Vy(this)},ky);function ky(t,e,n){var r=this;return(r=Ay.call(this,e)||this).Cf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.Nf=t),r}function Dy(){}function Py(t){return t.pf||Cy(t),t.pf.lf(),t.pf}function Cy(t){var e,n,r=t.k_(),r=(e=t.v_,n=t.df,new Er(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.pf=new zd(t.Ef,t.yf,r)}var Ly,Ry=(Fy.prototype.get=function(t){var e=this,n=fv(0,t,this.S_),r=new ed(this.S_);return this.Ff.X_([n.C_]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof Zs)return new Ky(e.S_,new dy(e.S_.o_,r,n.C_,null,new zy(!1,!1),n.x_));if(t instanceof $s)return new Ky(e.S_,new dy(e.S_.o_,r,n.C_,t,new zy(!1,!1),n.x_));throw Pr()})},Fy.prototype.set=function(t,e,n){t=fv(0,t,this.S_);n=bp("Transaction.set",n);e=lv(t.x_,e,n),n=Od(this.Of,"Transaction.set",t.C_,e,null!==t.x_,n);return this.Ff.set(t.C_,n),this},Fy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=fv(0,t,this.S_);return e instanceof Zl&&(e=e.o_),e="string"==typeof e||e instanceof hd?Dd(this.Of,"Transaction.update",t.C_,e,n,r):kd(this.Of,"Transaction.update",t.C_,e),this.Ff.update(t.C_,e),this},Fy.prototype.delete=function(t){t=fv(0,t,this.S_);return this.Ff.delete(t.C_),this},Fy),Vy=(jy.prototype.set=function(t,e,n){this.$f();t=fv(0,t,this.S_);n=bp("WriteBatch.set",n);e=lv(t.x_,e,n),n=Od(this.Of,"WriteBatch.set",t.C_,e,null!==t.x_,n);return this.Mf=this.Mf.concat(n.L_(t.C_,_s.Ge())),this},jy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.$f();t=fv(0,t,this.S_);return e instanceof Zl&&(e=e.o_),e="string"==typeof e||e instanceof hd?Dd(this.Of,"WriteBatch.update",t.C_,e,n,r):kd(this.Of,"WriteBatch.update",t.C_,e),this.Mf=this.Mf.concat(e.L_(t.C_,_s.exists(!0))),this},jy.prototype.delete=function(t){this.$f();t=fv(0,t,this.S_);return this.Mf=this.Mf.concat(new qs(t.C_,_s.Ge())),this},jy.prototype.commit=function(){return this.$f(),this.kf=!0,0<this.Mf.length?ry(Py(this.S_.o_),this.Mf):Promise.resolve()},jy.prototype.$f=function(){if(this.kf)throw new Qr(Hr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},jy),My=(n(Uy,Ly=Zl),Uy.xf=function(t,e,n){if(t.length%2!=0)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.M()+" has "+t.length);return new Uy(e,new fd(e.o_,n,new Zr(t)))},Uy.b_=function(t,e,n){return new Uy(e,new fd(e.o_,n,t))},Object.defineProperty(Uy.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Uy.prototype,"parent",{get:function(){return new sv(this.o_.O_.S(),this.firestore,this.o_.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(Uy.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Uy.prototype.collection=function(t){if(wp("DocumentReference.collection","path",t),!t)throw new Qr(Hr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Xr.k(t);return new sv(this.o_.O_.child(t),this.firestore,null)},Uy.prototype.isEqual=function(t){return t instanceof Zl&&(t=t.o_),t instanceof fd&&(((e=this.o_)instanceof fd||e instanceof pd)&&(t instanceof fd||t instanceof pd)&&e.firestore===t.firestore&&e.path===t.path&&e.x_===t.x_);var e},Uy.prototype.set=function(t,e){e=bp("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Ip(n.firestore,uy),r=lv(n.x_,r,i),Ny(o,Od(md(o),"setDoc",n.C_,r,null!==n.x_,i).L_(n.C_,_s.Ge()))}catch(t){throw qy(t,"setDoc","DocumentReference.set")}var n,r,i,o},Uy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ty(this.o_,t):Ty.apply(void 0,i([this.o_,t,e],n))}catch(t){throw qy(t,"updateDoc","DocumentReference.update")}},Uy.prototype.delete=function(){return Ny(Ip((t=this.o_).firestore,uy),[new qs(t.C_,_s.Ge())]);var t},Uy.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i,o=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!Ya(n))return n}return{}}(),n={next:function(t){i.next&&i.next(new Ky(e.firestore,new dy(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_)))},error:null===(n=(i=Ya((n=r)[0])?n[0]:Ya(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(n=i.complete)||void 0===n?void 0:n.bind(i)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||Ya(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};Ya(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof fd?(s=Ip(e.firestore,uy),u=su(e.C_.path),h={next:function(t){n[o]&&n[o](xy(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Ip(e.firestore,uy),u=e.M_,c=new Ey(s),h={next:function(t){n[o]&&n[o](new vy(s,c,e,t))},error:n[o+1],complete:n[o+2]},Zy(e.M_));var l=Py(s),p=new $l(h),d=new ka(u,p,f);return s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Aa,[4,ny(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sa,[4,ny(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}(this.o_,o,n)},Uy.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,uy),r=Py(n),i=new Ey(n),o=new Zu;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zd(r)];case 1:return[4,iy(t.sent(),e.C_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new dy(n,i,e.C_,t,new zy(t instanceof $s&&t.Je,!0),e.x_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,uy),r=Py(n),i=new Zu;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ny(r)];case 1:return[4,oy(t.sent(),n.yf,e.C_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return xy(n,e,t)})}:function(e){var t=this,n=Ip(e.firestore,uy),r=Py(n),i=new Zu;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ny(r)];case 1:return[4,oy(t.sent(),n.yf,e.C_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return xy(n,e,t)})})(this.o_).then(function(t){return new Ky(e.firestore,new dy(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_))})},Uy.prototype.withConverter=function(t){return new Uy(this.firestore,this.o_.withConverter(t))},Uy);function Uy(t,e){var n=this;return(n=Ly.call(this,e)||this).firestore=t,n.D_=new ed(t),n}function jy(t){this.S_=t,this.Mf=[],this.kf=!1,this.Of=md(this.S_.o_)}function Fy(t,e){this.S_=t,this.Ff=e,this.Of=md(this.S_.o_)}function qy(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var By,Gy,zy=(Yy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yy),Ky=(n(Wy,Gy=Zl),Object.defineProperty(Wy.prototype,"ref",{get:function(){return new My(this.S_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Wy.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wy.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Wy.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Wy.prototype.data=function(t){return this.o_.data(t)},Wy.prototype.get=function(t,e){return this.o_.get(t,e)},Wy.prototype.isEqual=function(t){return by(this.o_,t.o_)},Wy),Hy=(n(Qy,By=Ky),Qy.prototype.data=function(t){return this.o_.data(t)},Qy);function Qy(){return null!==By&&By.apply(this,arguments)||this}function Wy(t,e){var n=this;return(n=Gy.call(this,e)||this).S_=t,n}function Yy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Xy(t,e,n){if(n instanceof Zl&&(n=n.o_),"string"==typeof n){if(""===n)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!fu(e)&&-1!==n.indexOf("/"))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Xr.k(n));if(!Zr.G(e))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return wo(t,new Zr(e))}if(n instanceof fd)return wo(t,n.C_);throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ep(n)+".")}function Jy(t,e){if(!Array.isArray(t)||0===t.length)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function $y(t,e,n){if(!n.isEqual(e))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Zy(t){if(au(t)&&0===t.rn.length)throw new Qr(Hr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var tv,ev,nv,rv=(hv.prototype.where=function(t,e,n){t=Md("Query.where",t),e=function(t,e,n,r,i,o){if(r.B()){if("array-contains"===i||"array-contains-any"===i)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Jy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Xy(n,t,c))}h={arrayValue:{values:s}}}else h=Xy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Jy(o,i),h=Pd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Iu.create(r,i,h);return function(t,e){if(e.cn()){var n=hu(t);if(null!==n&&!n.isEqual(e.field))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=cu(t);null!==n&&$y(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.M_,this.Lf,this.firestore.v_,t,e,n);return new hv((n=this.M_,e=n.filters.concat([e]),new eu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},hv.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Qr(Hr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Md("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new Ju(e,n);return n=e,null!==cu(t)||null!==(t=hu(t))&&$y(0,t,n.field),e}(this.M_,t,n);return new hv((n=this.M_,t=n.rn.concat([t]),new eu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},hv.prototype.limit=function(t){return Tp("Query.limit",t),new hv(du(this.M_,t,"F"),this.firestore,this.x_)},hv.prototype.limitToLast=function(t){return Tp("Query.limitToLast",t),new hv(du(this.M_,t,"L"),this.firestore,this.x_)},hv.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.startAt",t,e,!0);return new hv(yu(this.M_,t),this.firestore,this.x_)},hv.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.startAfter",t,e,!1);return new hv(yu(this.M_,t),this.firestore,this.x_)},hv.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.endBefore",t,e,!0);return new hv(vu(this.M_,t),this.firestore,this.x_)},hv.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Bf("Query.endAt",t,e,!1);return new hv(vu(this.M_,t),this.firestore,this.x_)},hv.prototype.isEqual=function(t){return t instanceof hv&&this.firestore===t.firestore&&gu(this.M_,t.M_)&&this.x_===t.x_},hv.prototype.withConverter=function(t){return new hv(this.M_,this.firestore,t)},hv.prototype.Bf=function(c,t,e,n){if(t instanceof Ky)return function(t,e,n,r){if(!n)throw new Qr(Hr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=lu(t);o<s.length;o++){var u=s[o];if(u.field.B())i.push(wo(e,n.key));else{var a=n.field(u.field);if(so(a))throw new Qr(Hr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.M();throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Gu(i,r)}(this.M_,this.firestore.v_,t.o_.N_,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Qr(Hr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.B()){if("string"!=typeof c)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!fu(t)&&-1!==c.indexOf("/"))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Xr.k(c));if(!Zr.G(h))throw new Qr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Zr(h);u.push(wo(e,h))}else{c=Pd(n,r,c);u.push(c)}}return new Gu(u,o)}(this.M_,this.firestore.v_,this.Lf,c,e,n)},hv.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||Ya(n[s])||(o=n[s],s++),Ya(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new ov(e.firestore,new vy(e.firestore.o_,e.D_,new ld(e.firestore.o_,e.x_,e.M_),t)))},error:n[s+1],complete:n[s+2]};return Zy(this.M_),function(n,t,e){var r=this,i=new $l(u),o=new ka(t,i,e);return n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Aa,[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sa,[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Py(this.firestore.o_),this.M_,o)},hv.prototype.get=function(t){var e=this;Zy(this.M_);var n=Py(this.firestore.o_);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Zu;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Xh(r,i,!0)];case 1:return n=t.sent(),e=new Xf(i,n.Xa),n=e.gh(n.documents),n=e.bi(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ta(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Zd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.M_):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Zu;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new $l({next:function(t){n.fs(function(){return Sa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Qr(Hr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ka(t,o,{includeMetadataChanges:!0,Hs:!0});return Aa(e,s)},[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.rs,r,i,o])]}})})}),o.promise}(n,this.M_,t)).then(function(t){return new ov(e.firestore,new vy(e.firestore.o_,e.D_,new ld(e.firestore.o_,e.x_,e.M_),t))})},hv),iv=(n(cv,nv=Zl),Object.defineProperty(cv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"doc",{get:function(){return new Hy(this.S_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"newIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),cv),ov=(n(av,ev=Zl),Object.defineProperty(av.prototype,"query",{get:function(){return new rv(this.o_.query.M_,this.S_,this.o_.query.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Hy(e.S_,t)})},enumerable:!1,configurable:!0}),av.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new iv(e.S_,t)})},av.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Hy(r.S_,t))})},av.prototype.isEqual=function(t){return by(this.o_,t.o_)},av),sv=(n(uv,tv=rv),Object.defineProperty(uv.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"parent",{get:function(){var t=this.M_.path.S();return t.T()?null:My.xf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),uv.prototype.doc=function(t){0===arguments.length&&(t=Lr.u()),wp("CollectionReference.doc","path",t);t=Xr.k(t);return My.xf(this.M_.path.child(t),this.firestore,this.x_)},uv.prototype.add=function(t){var t=this.x_?this.x_.toFirestore(t):t,e=this.doc();return My.b_(e.o_.C_,this.firestore,null).set(t).then(function(){return e})},uv.prototype.withConverter=function(t){return new uv(this.O_,this.firestore,t)},uv);function uv(t,e,n){var r=this;if(((r=tv.call(this,su(t),e,n)||this).O_=t).length%2!=1)throw new Qr(Hr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.M()+" has "+t.length);return r}function av(t,e){var n=this;return(n=ev.call(this,e)||this).S_=t,n}function cv(t,e){var n=this;return(n=nv.call(this,e)||this).S_=t,n}function hv(t,e,n){this.M_=t,this.firestore=e,this.x_=n,this.Lf=md(e.o_),this.D_=new ed(e)}function fv(t,e,n){e=Ip(e,fd);if(e.firestore!==n.o_)throw new Qr(Hr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function lv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var pv,dv,yv,Ee=(n(mv,dv=Zl),mv.documentId=function(){return new mv($r.q().M())},mv.prototype.isEqual=function(t){return t instanceof Zl&&(t=t.o_),t instanceof hd&&this.o_.F_.isEqual(t.F_)},mv),h=(n(gv,pv=Zl),gv.serverTimestamp=function(){var t=new Lp("serverTimestamp");return t.a_="FieldValue.serverTimestamp",new gv(t)},gv.delete=function(){var t=new Ap("deleteField");return t.a_="FieldValue.delete",new gv(t)},gv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rp("arrayUnion",t)}.apply(void 0,t);return n.a_="FieldValue.arrayUnion",new gv(n)},gv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vp("arrayRemove",t)}.apply(void 0,t);return n.a_="FieldValue.arrayRemove",new gv(n)},gv.increment=function(t){t=new Mp("increment",t);return t.a_="FieldValue.increment",new gv(t)},gv.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},gv),vv={Firestore:Oy,GeoPoint:Up,Timestamp:Wr,Blob:td,Transaction:Ry,WriteBatch:Vy,DocumentReference:My,DocumentSnapshot:Ky,Query:rv,QueryDocumentSnapshot:Hy,QuerySnapshot:ov,CollectionReference:sv,FieldPath:Ee,FieldValue:h,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function gv(){return null!==pv&&pv.apply(this,arguments)||this}function mv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dv.call(this,new(hd.bind.apply(hd,i([void 0],t))))||this}(yv=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Oy(e,new uy(e,t),new Sy);var e},"PUBLIC").setServiceProps(Object.assign({},vv))),yv.registerVersion("@firebase/firestore","2.0.2-20201012233953")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
