!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(tv){"use strict";try{(function(){var f,t,e=(t=tv)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=f=f||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((me={})[f.DEBUG]="log",me[f.VERBOSE]="log",me[f.INFO]="info",me[f.WARN]="warn",me[f.ERROR]="error",me),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},x=N||self;function A(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function R(t,e,n){return(R=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:L).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function U(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}var W=x.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(W=W&&W.userAgent)?W:"";var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<J.length;i++)e=J[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=A;var tt,et=H(at,"Opera"),nt=H(at,"Trident")||H(at,"MSIE"),rt=H(at,"Edge"),it=rt||nt,ot=H(at,"Gecko")&&!(H(at.toLowerCase(),"webkit")&&!H(at,"Edge"))&&!(H(at,"Trident")||H(at,"MSIE"))&&!H(at,"Edge"),st=H(at.toLowerCase(),"webkit")&&!H(at,"Edge");function ut(){var t=x.document;return t?t.documentMode:void 0}var W="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(W=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(W)?String(at):W;var ct={};function ht(u){return t=u,e=function(){for(var t=0,e=K(String(tt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ct,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=x.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ht("9"),dt=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{x.addEventListener("test",A,e),x.removeEventListener("test",A,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},U(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Tt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Tt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),xt={};function At(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Rt(r),e&&e[mt]?e.wa(n,r,k(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)At(t,e[o],n,r,i);return null}return n=Rt(n),t&&t[mt]?t.va(e,n,k(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Ct(t);if(c||(t[Nt]=c=new Et(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(It(n,t),0==n.b&&(n.src=null,e[Nt]=null)):_t(t)))}function kt(t){return t in xt?xt[t]:xt[t]="on"+t}function Dt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(ft)return Dt(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=x,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Dt(t,e=new vt(e,this))}function Ct(t){return(t=t[Nt])instanceof Et?t:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(e){return"function"==S(e)?e:(e[Lt]||(e[Lt]=function(t){return e.handleEvent(t)}),e[Lt])}function Vt(){j.call(this),this.c=new Et(this),(this.J=this).C=null}function Mt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,$(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ut(o,r,!0,e)&&s;if(s=Ut(o=e.a=t,r,!0,e)&&s,s=Ut(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ut(o=e.a=n[i],r,!1,e)&&s}function Ut(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(Vt,j),Vt.prototype[mt]=!0,(at=Vt.prototype).addEventListener=function(t,e,n,r){At(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Rt(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Tt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Tt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},at.G=function(){if(Vt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var jt=x.JSON.stringify;function Ft(){this.b=this.a=null}var qt,Bt=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new zt},function(t){t.reset()},100));function Gt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Kt(t,e){var n;qt||(n=x.Promise.resolve(void 0),qt=function(){n.then(Wt)}),Ht||(qt(),Ht=!0),Qt.add(t,e)}Ft.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Ft;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){x.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Yt(t,e){Vt.call(this),this.b=t||1,this.a=e||x,this.f=R(this.Xa,this),this.g=M()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Jt(t,e,n){if("function"==S(t))n&&(t=R(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=R(t.handleEvent,t)}return 2147483647<Number(e)?-1:x.setTimeout(t,e||0)}U(Yt,Vt),(at=Yt.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Mt(this,"tick"),this.aa&&(Xt(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},at.G=function(){Yt.X.G.call(this),Xt(this),delete this.a};var $t,Zt,te=(I(Zt=ne,W=$t=j),Zt.prototype=null===W?Object.create(W):(ee.prototype=W.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Jt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){$t.prototype.G.call(this),this.a&&(x.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Zt}function ne(t,e,n){var r=$t.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){j.call(this),this.b=t,this.a={}}U(re,j);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=At(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return jt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var ce=null;function he(){return ce=ce||new Vt}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=he();Mt(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=he();Mt(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){t()},e)}U(le,yt),U(pe,yt),U(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}we.prototype.a=null;var Ee,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Ie(){yt.call(this,"d")}function Te(){yt.call(this,"c")}function Ne(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=Ae,t=it?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}U(Ie,yt),U(Te,yt),U(Ne,we),Ee=new Ne;var Ae=45e3,Se={},Oe={};function ke(t,e,n){t.H=1,t.i=Je(Ke(e)),t.j=n,t.I=!0,De(t,null)}function De(t,e){t.u=M(),Ce(t),t.l=Ke(t.i);var s,u,a,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(R(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Oe:(i=Number(u.substring(i,o)),isNaN(i)?Se:(o+=1)+i>u.length?Oe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Oe){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==Se){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Ce(t){t.T=M()+t.P,Le(t,t.P)}function Le(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(R(t.Ta,t),e)}function Re(t){t.o&&(x.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function Me(t){Re(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),qn(u)}Yn(u),de()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(R(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Xe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Re(o),Ce(o)),n.a=i):Wn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):Fn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);fe()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=xe.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Re(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),Me(this),Ve(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,s)}this.I?(Pe(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),Ue(this,n)),4==e&&Me(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),Me(this),Ve(this)}}}catch(t){}var u,a,c,h,l,f},at.Ua=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Re(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},at.cancel=function(){this.A=!0,Me(this)},at.Ta=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),Me(this),this.h=2,Ve(this)):Le(this,this.T-n)},(at=Fe.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return qe(this),this.a.concat()},at.get=function(t,e){return Be(this.b,t)?this.b[t]:e},at.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,Qe(this,t.c),We(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Ye(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,He(this,n[1]||"",!0),this.j=$e(n[2]||""),Qe(this,n[3]||"",!0),We(this,n[4]),this.g=$e(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function Ke(t){return new ze(t)}function He(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Qe(t,e,n){t.c=n?$e(e,!0):e}function We(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Xe(t,e,n){t.b.set(e,n)}function Je(t){return Xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new Fe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=fn(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function hn(t,e){return an(t),e=fn(t,e),Be(t.a.b,e)}function ln(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=x.PerformanceNavigationTiming?0<(t=x.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(x.ia&&x.ia.ya&&x.ia.ya()&&x.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=B(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,hn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function En(){}function In(){this.a=new En}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return x.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return x.JSON.parse(t,void 0)};var Nn=x.JSON.parse;function xn(t){Vt.call(this),this.headers=new Fe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=An,this.D=this.F=!1}U(xn,Vt);var An="",Sn=/^https?$/i,On=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Dn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Ln(t)}function Pn(t){t.u||(t.u=!0,Mt(t,"complete"),Mt(t,"error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Jt(t.za,0,t);else if(Mt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&x.self&&x.self.location&&(i=(r=x.self.location.protocol).substr(0,r.length-1)),n=!Sn.test(i?i.toLowerCase():"")),e=n),e)Mt(t,"complete"),Mt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.a){Rn(t);var n=t.a,r=t.s[0]?A:null;t.a=null,t.s=null,e||Mt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(x.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xe(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Un("baseRetryDelayMs",5e3,t),this.Pa=Un("retryDelaySeedMs",1e4,t),this.Ka=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Fn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Xe(n=Ke(t.B),"SID",t.J),Xe(n,"RID",e),Xe(n,"TYPE","terminate"),Hn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=Je(Ke(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(e.i.toString(),"")),!n&&x.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=M(),Ce(e)),nr(t)}function qn(t){t.a&&(Xn(t),t.a.cancel(),t.a=null)}function Bn(t){qn(t),t.j&&(x.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&x.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);Xe(r,"SID",t.J),Xe(r,"RID",n),Xe(r,"AID",t.P),Hn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),ke(n,r,e)}function Hn(t,n){t.f&&je({},function(t,e){Xe(n,e,t)})}function Qn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?R(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;k(t)&&(n=jt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Wn(t){t.a||t.j||(t.T=1,Kt(t.Aa,t),t.o=0)}function Yn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(R(t.Aa,t),tr(t,t.o)),t.o++,1)}function Xn(t){null!=t.s&&(x.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new xe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);Xe(e,"RID","rpc"),Xe(e,"SID",t.J),Xe(e,"CI",t.H?"0":"1"),Xe(e,"AID",t.P),Hn(t,e),Xe(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(Ke(e)),n.j=null,n.I=!0,De(n,t)}function $n(t){null!=t.m&&(x.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Xn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=M()-e.u,n=t.u,Mt(s=he(),new ye(s)),zn(t)):Wn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(R(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Yn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=R(t.Wa,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||He(r,"https"),Je(r)),n=r.toString(),r=o,o=new ue,x.Image?((i=new Image).onload=V(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Tn,o,i,"TestLoadImage: timeout",!1,r),x.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?Ke(s):new ze(s,void 0);return""!=a.c?(e&&Qe(a,e+"."+a.c),We(a,a.h)):(r=(u=x.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&He(u,r),i&&Qe(u,i),o&&We(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Xe(a,e,t)}),e=t.A,n=t.na,e&&n&&Xe(a,e,n),Xe(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Vt.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(at=xn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ee),this.a.onreadystatechange=R(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Dn(this,t)}t=n||"";var i,o=new Fe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=x.FormData&&t instanceof x.FormData,0<=F(On,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=(i=this.a,nt&&ht(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=R(this.xa,this)):this.m=Jt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Dn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Mt(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Mt(this,"complete"),Mt(this,"abort"),Ln(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ln(this,!0)),xn.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Sa())},at.Sa=function(){Cn(this)},at.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=jn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),Xe(i=Ke(this.B),"RID",t),Xe(i,"CVER",22),this.A&&Xe(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&Mn(i,this.i,r),wn(this.b,n),this.Ga&&Xe(i,"TYPE","init"),this.da?(Xe(i,"$req",e),Xe(i,"SID","null"),n.U=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||vn(this.b)||Kn(this))},at.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(R(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),qn(this),Jn(this))},at.Qa=function(){null!=this.m&&(this.m=null,qn(this),Yn(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},U(ur,Vt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){Fn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=jt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,Fn(this.a),delete this.a,ur.X.G.call(this)},U(ar,Ie),U(cr,Te),U(hr,or),hr.prototype.ta=function(){Mt(this.a,"a")},hr.prototype.sa=function(t){Mt(this.a,new ar(t))},hr.prototype.ra=function(t){Mt(this.a,new cr)},hr.prototype.qa=function(){Mt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Vt.prototype.listen=Vt.prototype.va,xn.prototype.listenOnce=xn.prototype.wa,xn.prototype.getLastError=xn.prototype.Oa,xn.prototype.getLastErrorCode=xn.prototype.ua,xn.prototype.getStatus=xn.prototype.W,xn.prototype.getResponseJson=xn.prototype.Na,xn.prototype.getResponseText=xn.prototype.$,xn.prototype.send=xn.prototype.ba;var lr=ge,fr=me,pr=_e,dr=xn,N=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},gr=(Object.defineProperty(br.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),br.prototype.isEqual=function(t){return t instanceof br&&t.projectId===this.projectId&&t.database===this.database},br),mr="8.0.2-20201012233953",wr=new h("@firebase/firestore");function br(t,e){this.projectId=t,this.database=e||"(default)"}function _r(){return wr.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=f.DEBUG&&(e=n.map(Nr),wr.debug.apply(wr,i(["Firestore ("+mr+"): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=f.ERROR&&(e=n.map(Nr),wr.error.apply(wr,i(["Firestore ("+mr+"): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=f.WARN&&(e=n.map(Nr),wr.warn.apply(wr,i(["Firestore ("+mr+"): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xr(t){throw void 0===t&&(t="Unexpected state"),Ir(t="FIRESTORE ("+mr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Ar(t){t||xr()}var Sr=(Or.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Or);function Or(){}function kr(t,e){return t<e?-1:e<t?1:0}function Dr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Pr(t){return t+"\0"}function Cr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Lr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Rr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Vr,Mr,Ur,jr=(ei.prototype.get=function(t){var e=this.h(t);if(void 0!==(e=this._[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.l(i,t))return o}},ei.prototype.has=function(t){return void 0!==this.get(t)},ei.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},ei.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},ei.prototype.forEach=function(s){Lr(this._,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},ei.prototype.T=function(){return Rr(this._)},ei),Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=(n(ti,Ur=Error),ti),Br=(Zr.now=function(){return Zr.fromMillis(Date.now())},Zr.fromDate=function(t){return Zr.fromMillis(t.getTime())},Zr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Zr(e,1e6*(t-1e3*e))},Zr.prototype.toDate=function(){return new Date(this.toMillis())},Zr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Zr.prototype.I=function(t){return this.seconds===t.seconds?kr(this.nanoseconds,t.nanoseconds):kr(this.seconds,t.seconds)},Zr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Zr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Zr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Zr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Zr),Gr=($r.m=function(t){return new $r(t)},$r.min=function(){return new $r(new Br(0,0))},$r.prototype.A=function(t){return this.timestamp.I(t.timestamp)},$r.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},$r.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},$r.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},$r.prototype.P=function(){return this.timestamp},$r),ge=(Object.defineProperty(Jr.prototype,"length",{get:function(){return this.g},enumerable:!1,configurable:!0}),Jr.prototype.isEqual=function(t){return 0===Jr.V(this,t)},Jr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Jr?t.forEach(function(t){e.push(t)}):e.push(t),this.p(e)},Jr.prototype.limit=function(){return this.offset+this.length},Jr.prototype.v=function(t){return t=void 0===t?1:t,this.p(this.segments,this.offset+t,this.length-t)},Jr.prototype.S=function(){return this.p(this.segments,this.offset,this.length-1)},Jr.prototype.D=function(){return this.segments[this.offset]},Jr.prototype.C=function(){return this.get(this.length-1)},Jr.prototype.get=function(t){return this.segments[this.offset+t]},Jr.prototype.T=function(){return 0===this.length},Jr.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Jr.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Jr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Jr.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},Jr.V=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Jr),zr=(n(Xr,Mr=ge),Xr.prototype.p=function(t,e,n){return new Xr(t,e,n)},Xr.prototype.M=function(){return this.O().join("/")},Xr.prototype.toString=function(){return this.M()},Xr.k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Xr(n)},Xr.$=function(){return new Xr([])},Xr),Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Hr=(n(Yr,Vr=ge),Yr.prototype.p=function(t,e,n){return new Yr(t,e,n)},Yr.L=function(t){return Kr.test(t)},Yr.prototype.M=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Yr.L(t)||(t="`"+t+"`"),t}).join(".")},Yr.prototype.toString=function(){return this.M()},Yr.prototype.B=function(){return 1===this.length&&"__name__"===this.get(0)},Yr.q=function(){return new Yr(["__name__"])},Yr.U=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new qr(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qr(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new qr(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Yr(e)},Yr.$=function(){return new Yr([])},Yr),Qr=(Wr.K=function(t){return new Wr(zr.k(t))},Wr.W=function(t){return new Wr(zr.k(t).v(5))},Wr.prototype.j=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Wr.prototype.isEqual=function(t){return null!==t&&0===zr.V(this.path,t.path)},Wr.prototype.toString=function(){return this.path.toString()},Wr.V=function(t,e){return zr.V(t.path,e.path)},Wr.G=function(t){return t.length%2==0},Wr.H=function(t){return new Wr(new zr(t.slice()))},Wr);function Wr(t){this.path=t}function Yr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Xr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Jr(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.g=n}function $r(t){this.timestamp=t}function Zr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ti(t,e){var n=this;return(n=Ur.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ei(t,e){this.h=t,this.l=e,this._={}}function ni(t){return null==t}function ri(t){return 0===t&&1/t==-1/0}function ii(t){return"number"==typeof t&&Number.isInteger(t)&&!ri(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var oi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.J=null};function si(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new oi(t,e,n,r,i,o,s)}function ui(t){var e=t;return null===e.J&&(t=e.path.M(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.M()+t.op.toString()+ao(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.M()+t.dir}).join(","),ni(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Fu(e.startAt)),e.endAt&&(t+="|ub:",t+=Fu(e.endAt)),e.J=t),e.J}function ai(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!io(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function ci(t){return Qr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var hi=(li.fromBase64String=function(t){return new li(atob(t))},li.fromUint8Array=function(t){return new li(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},li.prototype.toBase64=function(){return t=this.Y,btoa(t);var t},li.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Y)},li.prototype.X=function(){return 2*this.Y.length},li.prototype.A=function(t){return kr(this.Y,t.Y)},li.prototype.isEqual=function(t){return this.Y===t.Y},li);function li(t){this.Y=t}function fi(t){this.count=t}hi.Z=new hi("");var pi,di=(yi.prototype.nt=function(t){return new yi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},yi.prototype.st=function(t,e){return new yi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},yi.prototype.it=function(t){return new yi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},yi);function yi(t,e,n,r,i,o,s){void 0===i&&(i=Gr.min()),void 0===o&&(o=Gr.min()),void 0===s&&(s=hi.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function vi(t){switch(t){case Fr.OK:return xr(),0;case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return 1;default:return xr(),0}}function gi(t){if(void 0===t)return Ir("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case pi.OK:return Fr.OK;case pi.CANCELLED:return Fr.CANCELLED;case pi.UNKNOWN:return Fr.UNKNOWN;case pi.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case pi.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case pi.INTERNAL:return Fr.INTERNAL;case pi.UNAVAILABLE:return Fr.UNAVAILABLE;case pi.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case pi.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case pi.NOT_FOUND:return Fr.NOT_FOUND;case pi.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case pi.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case pi.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case pi.ABORTED:return Fr.ABORTED;case pi.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case pi.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case pi.DATA_LOSS:return Fr.DATA_LOSS;default:return xr()}}(me=pi={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var mi=(Ii.prototype.rt=function(t,e){return new Ii(this.V,this.root.rt(t,e,this.V).copy(null,null,bi.ot,null,null))},Ii.prototype.remove=function(t){return new Ii(this.V,this.root.remove(t,this.V).copy(null,null,bi.ot,null,null))},Ii.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.V(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ii.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.V(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ii.prototype.T=function(){return this.root.T()},Object.defineProperty(Ii.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ii.prototype.at=function(){return this.root.at()},Ii.prototype.ct=function(){return this.root.ct()},Ii.prototype.ut=function(t){return this.root.ut(t)},Ii.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Ii.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ii.prototype.ht=function(t){return this.root.ht(t)},Ii.prototype.lt=function(){return new wi(this.root,null,this.V,!1)},Ii.prototype._t=function(t){return new wi(this.root,t,this.V,!1)},Ii.prototype.ft=function(){return new wi(this.root,null,this.V,!0)},Ii.prototype.dt=function(t){return new wi(this.root,t,this.V,!0)},Ii),wi=(Ei.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.T();)this.Tt.push(t),t=t.left;return e},Ei.prototype.It=function(){return 0<this.Tt.length},Ei.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ei),bi=(_i.prototype.copy=function(t,e,n,r,i){return new _i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},_i.prototype.T=function(){return!1},_i.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},_i.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},_i.prototype.min=function(){return this.left.T()?this:this.left.min()},_i.prototype.at=function(){return this.min().key},_i.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},_i.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},_i.prototype.Pt=function(){if(this.left.T())return _i.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},_i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.T()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.yt()),r.right.T()||r.right.gt()||r.right.left.gt()||(r=r.vt()),0===e(t,r.key)){if(r.right.T())return _i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},_i.prototype.gt=function(){return this.color},_i.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.bt()),t.left.gt()&&t.left.left.gt()&&(t=t.yt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},_i.prototype.Vt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.yt())).bt()).St()),t},_i.prototype.vt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.yt()).St()),t},_i.prototype.bt=function(){var t=this.copy(null,null,_i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},_i.prototype.yt=function(){var t=this.copy(null,null,_i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},_i.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},_i.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},_i.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw xr();if(this.right.gt())throw xr();var t=this.left.Ct();if(t!==this.right.Ct())throw xr();return t+(this.gt()?0:1)},_i);function _i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:_i.RED,this.left=null!=r?r:_i.EMPTY,this.right=null!=i?i:_i.EMPTY,this.size=this.left.size+1+this.right.size}function Ei(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function Ii(t,e){this.V=t,this.root=e||bi.EMPTY}function Ti(){this.size=0}bi.EMPTY=null,bi.RED=!0,bi.ot=!1,bi.EMPTY=(Object.defineProperty(Ti.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ti.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ti.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ti.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ti.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Ti.prototype.copy=function(t,e,n,r,i){return this},Ti.prototype.rt=function(t,e,n){return new bi(t,e)},Ti.prototype.remove=function(t,e){return this},Ti.prototype.T=function(){return!0},Ti.prototype.ut=function(t){return!1},Ti.prototype.ht=function(t){return!1},Ti.prototype.at=function(){return null},Ti.prototype.ct=function(){return null},Ti.prototype.gt=function(){return!1},Ti.prototype.Dt=function(){return!0},Ti.prototype.Ct=function(){return 0},new Ti);var Ni=(Oi.prototype.has=function(t){return null!==this.data.get(t)},Oi.prototype.first=function(){return this.data.at()},Oi.prototype.last=function(){return this.data.ct()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Oi.prototype.indexOf=function(t){return this.data.indexOf(t)},Oi.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},Oi.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.V(r.key,t[1]))return;e(r.key)}},Oi.prototype.xt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},Oi.prototype.Ft=function(t){return(t=this.data._t(t)).It()?t.Et().key:null},Oi.prototype.lt=function(){return new xi(this.data.lt())},Oi.prototype._t=function(t){return new xi(this.data._t(t))},Oi.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},Oi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Oi.prototype.T=function(){return this.data.T()},Oi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Oi.prototype.isEqual=function(t){if(!(t instanceof Oi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.V(r,i))return!1}return!0},Oi.prototype.O=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Oi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Oi.prototype.copy=function(t){var e=new Oi(this.V);return e.data=t,e},Oi),xi=(Si.prototype.Et=function(){return this.Mt.Et().key},Si.prototype.It=function(){return this.Mt.It()},Si),Ai=new mi(Qr.V);function Si(t){this.Mt=t}function Oi(t){this.V=t,this.data=new mi(this.V)}var ki=new mi(Qr.V),Di=new mi(Qr.V),Pi=new Ni(Qr.V);function Ci(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Pi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Li=new Ni(kr),Ri=(Ji.Lt=function(t){return new Ji(t.V)},Ji.prototype.has=function(t){return null!=this.kt.get(t)},Ji.prototype.get=function(t){return this.kt.get(t)},Ji.prototype.first=function(){return this.$t.at()},Ji.prototype.last=function(){return this.$t.ct()},Ji.prototype.T=function(){return this.$t.T()},Ji.prototype.indexOf=function(t){return(t=this.kt.get(t))?this.$t.indexOf(t):-1},Object.defineProperty(Ji.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),Ji.prototype.forEach=function(n){this.$t.ut(function(t,e){return n(t),!1})},Ji.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.rt(t.key,t),e.$t.rt(t,null))},Ji.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},Ji.prototype.isEqual=function(t){if(!(t instanceof Ji))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.lt(),n=t.$t.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Ji.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ji.prototype.copy=function(t,e){var n=new Ji;return n.V=this.V,n.kt=t,n.$t=e,n},Ji),Vi=(Xi.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):xr()},Xi.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},Xi),Mi=(Yi.jt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Yi(t,e,Ri.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Yi.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),Yi.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Kt===t.Kt&&this.Qt.isEqual(t.Qt)&&cu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Yi),Ui=(Wi.Yt=function(t,e){var n=new Map;return n.set(t,ji.Xt(t,e)),new Wi(Gr.min(),n,Li,Ai,Ci())},Wi),ji=(Qi.Xt=function(t,e){return new Qi(hi.Z,e,Ci(),Ci(),Ci())},Qi),Fi=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},qi=function(t,e){this.targetId=t,this.re=e},Bi=function(t,e,n,r){void 0===n&&(n=hi.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Gi=(Object.defineProperty(Hi.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Hi.prototype.fe=function(t){0<t.X()&&(this.he=!0,this.ce=t)},Hi.prototype.de=function(){var n=Ci(),r=Ci(),i=Ci();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:xr()}}),new ji(this.ce,this.ue,n,r,i)},Hi.prototype.we=function(){this.he=!1,this.ae=Zi()},Hi.prototype.Te=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},Hi.prototype.Ee=function(t){this.he=!0,this.ae=this.ae.remove(t)},Hi.prototype.Ie=function(){this.oe+=1},Hi.prototype.me=function(){--this.oe},Hi.prototype.Ae=function(){this.he=!0,this.ue=!0},Hi),zi=(Ki.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof zs?this.ve(r,t.ie):t.ie instanceof Ks&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Ki.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.me(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.me(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.xe(t),e.fe(n.resumeToken));break;default:xr()}})},Ki.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},Ki.prototype.Fe=function(t){var e=t.targetId,n=t.re.count;(t=this.Oe(e))&&(ci(t=t.target)?0===n?(t=new Qr(t.path),this.be(e,t,new Ks(t,Gr.min()))):Ar(1===n):this.Me(e)!==n&&(this.xe(e),this.ye=this.ye.add(e)))},Ki.prototype.ke=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.Oe(e);n&&(t.Zt&&ci(n.target)&&(n=new Qr(n.target.path),null!==i.ge.get(n)||i.$e(e,n)||i.be(e,n,new Ks(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=Ci();this.Ve.forEach(function(t,e){var n=!0;e.xt(function(t){return!(t=i.Oe(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new Ui(r,o,this.ye,this.ge,s);return this.ge=Ai,this.Ve=$i(),this.ye=new Ni(kr),t},Ki.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.$e(t,e.key)?2:0,this.Ce(t).Te(e.key,n),this.ge=this.ge.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Le(e.key).add(t)))},Ki.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.$e(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},Ki.prototype.removeTarget=function(t){this.Pe.delete(t)},Ki.prototype.Me=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},Ki.prototype.Ie=function(t){this.Ce(t).Ie()},Ki.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Gi,this.Pe.set(t,e)),e},Ki.prototype.Le=function(t){var e=this.Ve.get(t);return e||(e=new Ni(kr),this.Ve=this.Ve.rt(t,e)),e},Ki.prototype.Ne=function(t){var e=null!==this.Oe(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},Ki.prototype.Oe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},Ki.prototype.xe=function(e){var n=this;this.Pe.set(e,new Gi),this.Re.Be(e).forEach(function(t){n.be(e,t,null)})},Ki.prototype.$e=function(t,e){return this.Re.Be(t).has(e)},Ki);function Ki(t){this.Re=t,this.Pe=new Map,this.ge=Ai,this.Ve=$i(),this.ye=new Ni(kr)}function Hi(){this.oe=0,this.ae=Zi(),this.ce=hi.Z,this.ue=!1,this.he=!0}function Qi(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Wi(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function Yi(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Kt=s,this.Wt=u}function Xi(){this.Bt=new mi(Qr.V)}function Ji(n){this.V=n?function(t,e){return n(t,e)||Qr.V(t.key,e.key)}:function(t,e){return Qr.V(t.key,e.key)},this.kt=ki,this.$t=new mi(this.V)}function $i(){return new mi(Qr.V)}function Zi(){return new mi(Qr.V)}function to(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function eo(t){return t=co(t.mapValue.fields.__local_write_time__.timestampValue),new Br(t.seconds,t.nanos)}var no=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?to(t)?4:10:xr()}function io(r,i){var t,e=ro(r);if(e!==ro(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return eo(r).isEqual(eo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=co(r.timestampValue),t=co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,lo(r.bytesValue).isEqual(lo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,ho((t=r).geoPointValue.latitude)===ho(e.geoPointValue.latitude)&&ho(t.geoPointValue.longitude)===ho(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?ho(e.integerValue)===ho(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=ho(e.doubleValue))===(t=ho(t.doubleValue))?ri(e)===ri(t):isNaN(e)&&isNaN(t));case 9:return Dr(r.arrayValue.values||[],i.arrayValue.values||[],io);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Cr(e)!==Cr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!io(e[t],n[t])))return!1;return!0}();default:return xr()}}function oo(t,e){return void 0!==(t.values||[]).find(function(t){return io(t,e)})}function so(t,e){var n,r,i,o=ro(t),s=ro(e);if(o!==s)return kr(o,s);switch(o){case 0:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=ho(t.integerValue||t.doubleValue))<(n=ho(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return uo(t.timestampValue,e.timestampValue);case 4:return uo(eo(t),eo(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=lo(i),s=lo(s),i.A(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=kr(n[i],r[i]);if(0!==o)return o}return kr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=kr(ho(o.latitude),ho(r.latitude)))?n:kr(ho(o.longitude),ho(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=so(n[i],r[i]);if(o)return o}return kr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=kr(r[s],o[s]);if(0!==u)return u;if(0!==(u=so(n[r[s]],i[o[s]])))return u}return kr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function uo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return kr(t,e);var n=co(t),t=co(e);return 0!==(e=kr(n.seconds,t.seconds))?e:kr(n.nanos,t.nanos)}function ao(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=co(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?lo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Qr.W(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):xr();var t,e}(t)}function co(t){if(Ar(!!t),"string"!=typeof t)return{seconds:ho(t.seconds),nanos:ho(t.nanos)};var e=0,n=no.exec(t);return Ar(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function ho(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function lo(t){return"string"==typeof t?hi.fromBase64String(t):hi.fromUint8Array(t)}function fo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.M()}}function po(t){return t&&"integerValue"in t}function yo(t){return!!t&&"arrayValue"in t}function vo(t){return t&&"nullValue"in t}function go(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mo(t){return t&&"mapValue"in t}var wo={asc:"ASCENDING",desc:"DESCENDING"},bo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_o=function(t,e){this.t=t,this.Ue=e};function Eo(t){return{integerValue:""+t}}function Io(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ri(e)?"-0":e}}function To(t,e){return ii(e)?Eo(e):Io(t,e)}function No(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function xo(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function Ao(t){return Ar(!!t),Gr.m((t=co(t),new Br(t.seconds,t.nanos)))}function So(t,e){return new zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).M()}function Oo(t){return Ar(Ho(t=zr.k(t))),t}function ko(t,e){return So(t.t,e.path)}function Do(t,e){if((e=Oo(e)).get(1)!==t.t.projectId)throw new qr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new qr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new Qr(Ro(e))}function Po(t,e){return So(t.t,e)}function Co(t){return 4===(t=Oo(t)).length?zr.$():Ro(t)}function Lo(t){return new zr(["projects",t.t.projectId,"databases",t.t.database]).M()}function Ro(t){return Ar(4<t.length&&"documents"===t.get(4)),t.v(5)}function Vo(t,e,n){return{name:ko(t,e),fields:n.proto.mapValue.fields}}function Mo(t,e){var n,r,i;if(e instanceof Es)n={update:Vo(t,e.key,e.value)};else if(e instanceof Cs)n={delete:ko(t,e.key)};else if(e instanceof Is)n={update:Vo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.M())}),{fieldPaths:r})};else if(e instanceof Ss)n={transform:{document:ko(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Xo)return{fieldPath:t.field.M(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.M(),appendMissingElements:{values:e.elements}};if(e instanceof ns)return{fieldPath:t.field.M(),removeAllFromArray:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.M(),increment:e.Ke};throw xr()})}};else{if(!(e instanceof Ls))return xr();n={verify:ko(t,e.key)}}return e.je.We||(n.currentDocument=void 0!==(i=e.je).updateTime?{updateTime:No(e=t,(t=i.updateTime).P())}:void 0!==i.exists?{exists:i.exists}:xr()),n}function Uo(i,t){var e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?ds.updateTime(Ao(o.updateTime)):void 0!==o.exists?ds.exists(o.exists):ds.Ge():ds.Ge();if(t.update){t.update.name;var n=Do(i,t.update.name),r=new Rs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new hs(o.map(function(t){return Hr.U(t)})));return new Is(n,r,o,e)}return new Es(n,r,e)}if(t.delete){var s=Do(i,t.delete);return new Cs(s,e)}return t.transform?(r=Do(i,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Ar("REQUEST_TIME"===t.setToServerValue),r=new Xo):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new Jo(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new ns(n)):"increment"in t?r=new ss(e,t.increment):xr(),t=Hr.U(t.fieldPath),new ls(t,r);var e,n,r}),Ar(!0===e.exists),new Ss(r,s)):t.verify?(t=Do(i,t.verify),new Ls(t,e)):xr()}function jo(t,e){return{documents:[Po(t,e.path)]}}function Fo(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Po(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Po(t,r.S()),n.structuredQuery.from=[{collectionId:r.C()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(go(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NAN"}};if(vo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(go(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NAN"}};if(vo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(t.field),op:(e=t.op,bo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:zo(t.field),direction:(t=t.dir,wo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ue||ni(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Bo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Bo(e.endAt)),n}function qo(t){var e=Co(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Ar(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ko(t.unaryFilter.field);return yu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ko(t.unaryFilter.field);return yu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Ko(t.unaryFilter.field),yu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Ko(t.unaryFilter.field),yu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xr()}}(e)]:void 0!==e.fieldFilter?[(n=e,yu.create(Ko(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):xr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new zu(Ko((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ni(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Go(n.startAt));var u=null;return n.endAt&&(u=Go(n.endAt)),Js(e,i,t,o,r,"F",s,u)}function Bo(t){return{before:t.before,values:t.position}}function Go(t){var e=!!t.before,t=t.values||[];return new Ru(t,e)}function zo(t){return{fieldPath:t.M()}}function Ko(t){return Hr.U(t.fieldPath)}function Ho(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Qo(t,e){return t instanceof ss?po(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Wo,Yo,Xo=(n(Zo,Yo=h=function(){this.ze=void 0}),Zo),Jo=(n($o,Wo=h),$o);function $o(t){var e=this;return(e=Wo.call(this)||this).elements=t,e}function Zo(){return null!==Yo&&Yo.apply(this,arguments)||this}function ts(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return io(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var es,ns=(n(rs,es=h),rs);function rs(t){var e=this;return(e=es.call(this)||this).elements=t,e}function is(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!io(t,e)})}(i[r]);return{arrayValue:{values:n}}}var os,ss=(n(us,os=h),us);function us(t,e){var n=this;return(n=os.call(this)||this).serializer=t,n.Ke=e,n}function as(t){return ho(t.integerValue||t.doubleValue)}function cs(t){return yo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var hs=(fs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},fs.prototype.isEqual=function(t){return Dr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},fs),ls=function(t,e){this.field=t,this.transform=e};function fs(t){(this.fields=t).sort(Hr.V)}function ps(t,e){this.version=t,this.transformResults=e}var ds=(ys.Ge=function(){return new ys},ys.exists=function(t){return new ys(void 0,t)},ys.updateTime=function(t){return new ys(t)},Object.defineProperty(ys.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ys.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ys);function ys(t,e){this.updateTime=t,this.exists=e}function vs(t,e){return void 0!==t.updateTime?e instanceof zs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof zs}function gs(t,e,n,r){return t instanceof Es?(o=e,vs((i=t).je,o)?(o=ws(o),new zs(i.key,o,i.value,{Je:!0})):o):t instanceof Is?function(t,e){if(!vs(t.je,e))return e;var n=ws(e),e=xs(t,e);return new zs(t.key,n,e,{Je:!0})}(t,e):t instanceof Ss?function(t,e,n,r){if(!vs(t.je,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof zs&&(h=n.field(a.field)),null===h&&r instanceof zs&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof Xo?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Jo?ts(c,i):c instanceof ns?is(c,i):(i=as(c=Qo(h=c,i))+as(h.Ke),po(c)&&po(h.Ke)?Eo(i):Io(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=ks(t,i.data(),r);return new zs(t.key,i.version,r,{Je:!0})}(t,e,r,n):vs(t.je,e)?new Ks(t.key,Gr.min()):e;var i,o}function ms(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.je.isEqual(e.je)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Dr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Jo&&e instanceof Jo||t instanceof ns&&e instanceof ns?Dr(t.elements,e.elements,io):t instanceof ss&&e instanceof ss?io(t.Ke,e.Ke):t instanceof Xo&&e instanceof Xo)}))}function ws(t){return t instanceof zs?t.version:Gr.min()}var bs,_s,Es=(n(Ns,_s=ge=function(){}),Ns),Is=(n(Ts,bs=ge),Ts);function Ts(t,e,n,r){var i=this;return(i=bs.call(this)||this).key=t,i.data=e,i.Qe=n,i.je=r,i.type=1,i}function Ns(t,e,n){var r=this;return(r=_s.call(this)||this).key=t,r.value=e,r.je=n,r.type=0,r}function xs(t,e){return n=t,e=e instanceof zs?e.data():Rs.empty(),r=new Vs(e),n.Qe.fields.forEach(function(t){var e;t.T()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var As,Ss=(n(Os,As=ge),Os);function Os(t,e){var n=this;return(n=As.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.je=ds.exists(!0),n}function ks(t,e,n){for(var r=new Vs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var Ds,Ps,Cs=(n(Fs,Ps=ge),Fs),Ls=(n(js,Ds=ge),js),Rs=(Us.empty=function(){return new Us({mapValue:{}})},Us.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!mo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null},Us.prototype.isEqual=function(t){return io(this.proto,t.proto)},Us),Vs=(Ms.prototype.set=function(t,e){return this.tn(t,e),this},Ms.prototype.delete=function(t){return this.tn(t,null),this},Ms.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ro(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.C(),e)},Ms.prototype.Ye=function(){var t=this.en(Hr.$(),this.Ze);return null!=t?new Rs(t):this.Xe},Ms.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=mo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ms);function Ms(t){void 0===t&&(t=Rs.empty()),this.Xe=t,this.Ze=new Map}function Us(t){this.proto=t}function js(t,e){var n=this;return(n=Ds.call(this)||this).key=t,n.je=e,n.type=4,n}function Fs(t,e){var n=this;return(n=Ps.call(this)||this).key=t,n.je=e,n.type=3,n}var qs,Bs,Gs,zs=(n(Xs,Gs=me=function(t,e){this.key=t,this.version=e}),Xs.prototype.field=function(t){return this.nn.field(t)},Xs.prototype.data=function(){return this.nn},Xs.prototype.sn=function(){return this.nn.proto},Xs.prototype.isEqual=function(t){return t instanceof Xs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Xs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Xs),Ks=(n(Ys,Bs=me),Ys.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ys.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ys.prototype.isEqual=function(t){return t instanceof Ys&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ys),Hs=(n(Ws,qs=me),Ws.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ws.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ws.prototype.isEqual=function(t){return t instanceof Ws&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ws),Qs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null,this.startAt,this.endAt};function Ws(){return null!==qs&&qs.apply(this,arguments)||this}function Ys(t,e,n){var r=this;return(r=Bs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Xs(t,e,n,r){var i=this;return(i=Gs.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Js(t,e,n,r,i,o,s,u){return new Qs(t,e,n,r,i,o,s,u)}function $s(t){return new Qs(t)}function Zs(t){return!ni(t.limit)&&"F"===t.limitType}function tu(t){return!ni(t.limit)&&"L"===t.limitType}function eu(t){return 0<t.rn.length?t.rn[0].field:null}function nu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function ru(t){return null!==t.collectionGroup}function iu(t){var e=t;if(null===e.on){e.on=[];var n=nu(e),t=eu(e);if(null!==n&&null===t)n.B()||e.on.push(new zu(n)),e.on.push(new zu(Hr.q(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.B()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new zu(Hr.q(),n)))}}return e.on}function ou(t){var e=t;if(!e.an)if("F"===e.limitType)e.an=si(e.path,e.collectionGroup,iu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=iu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new Ru(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Ru(e.startAt.position,!e.startAt.before):null;e.an=si(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function su(t,e,n){return new Qs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function uu(t,e){return new Qs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function au(t,e){return new Qs(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function cu(t,e){return ai(ou(t),ou(e))&&t.limitType===e.limitType}function hu(t){return ui(ou(t))+"|lt:"+t.limitType}function lu(t){return"Query(target="+(n=(e=ou(t)).path.M(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.M()+" "+t.op+" "+ao(t.value)}).join(", ")+"]"),ni(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.M()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Fu(e.startAt)),e.endAt&&(n+=", endAt: "+Fu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function fu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.j(e.collectionGroup)&&e.path.N(n):Qr.G(e.path)?e.path.isEqual(n):e.path.F(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.B()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||qu(t.startAt,iu(t),n))&&(!t.endAt||!qu(t.endAt,iu(t),n)));var e,n}function pu(u){return function(t,e){for(var n=!1,r=0,i=iu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.B()?Qr.V(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?so(e,r):xr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.B()}return 0}}var du,yu=(n(vu,du=function(){}),vu.create=function(t,e,n){return t.B()?"in"===e||"not-in"===e?this.un(t,e,n):new bu(t,e,n):"array-contains"===e?new Du(t,n):"in"===e?new Pu(t,n):"not-in"===e?new Cu(t,n):"array-contains-any"===e?new Lu(t,n):new vu(t,e,n)},vu.un=function(t,e,n){return new("in"===e?_u:Eu)(t,n)},vu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.hn(so(t,this.value)):null!==t&&ro(this.value)===ro(t)&&this.hn(so(t,this.value))},vu.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return xr()}},vu.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},vu);function vu(t,e,n){var r=this;return(r=du.call(this)||this).field=t,r.op=e,r.value=n,r}var gu,mu,wu,bu=(n(Nu,wu=yu),Nu.prototype.matches=function(t){return t=Qr.V(t.key,this.key),this.hn(t)},Nu),_u=(n(Tu,mu=yu),Tu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Tu),Eu=(n(Iu,gu=yu),Iu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Iu);function Iu(t,e){var n=this;return(n=gu.call(this,t,"not-in",e)||this).keys=xu(0,e),n}function Tu(t,e){var n=this;return(n=mu.call(this,t,"in",e)||this).keys=xu(0,e),n}function Nu(t,e,n){var r=this;return(r=wu.call(this,t,e,n)||this).key=Qr.W(n.referenceValue),r}function xu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Qr.W(t.referenceValue)})}var Au,Su,Ou,ku,Du=(n(ju,ku=yu),ju.prototype.matches=function(t){return yo(t=t.field(this.field))&&oo(t.arrayValue,this.value)},ju),Pu=(n(Uu,Ou=yu),Uu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&oo(this.value.arrayValue,t)},Uu),Cu=(n(Mu,Su=yu),Mu.prototype.matches=function(t){return!oo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!oo(this.value.arrayValue,t))},Mu),Lu=(n(Vu,Au=yu),Vu.prototype.matches=function(t){var e=this;return!(!yo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return oo(e.value.arrayValue,t)})},Vu),Ru=function(t,e){this.position=t,this.before=e};function Vu(t,e){return Au.call(this,t,"array-contains-any",e)||this}function Mu(t,e){return Su.call(this,t,"not-in",e)||this}function Uu(t,e){return Ou.call(this,t,"in",e)||this}function ju(t,e){return ku.call(this,t,"array-contains",e)||this}function Fu(t){return(t.before?"b":"a")+":"+t.position.map(ao).join(",")}function qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.B()?Qr.V(Qr.W(s.referenceValue),n.key):so(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!io(t.position[n],e.position[n]))return!1;return!0}var Gu,zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Ku=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Hu=(ea.prototype.reset=function(){this.Tn=0},ea.prototype.mn=function(){this.Tn=this.wn},ea.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Rn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.Pn(this._n,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.dn,this.Tn<this.fn&&(this.Tn=this.fn),this.Tn>this.wn&&(this.Tn=this.wn)},ea.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},ea.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ea.prototype.Rn=function(){return(Math.random()-.5)*this.Tn},ea),Qu=(ta.prototype.catch=function(t){return this.next(void 0,t)},ta.prototype.next=function(r,i){var o=this;return this.bn&&xr(),this.bn=!0,this.vn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new ta(function(e,n){o.yn=function(t){o.Dn(r,t).next(e,n)},o.pn=function(t){o.Sn(i,t).next(e,n)}})},ta.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ta.prototype.Nn=function(t){try{var e=t();return e instanceof ta?e:ta.resolve(e)}catch(t){return ta.reject(t)}},ta.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):ta.resolve(e)},ta.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):ta.reject(e)},ta.resolve=function(n){return new ta(function(t,e){t(n)})},ta.reject=function(n){return new ta(function(t,e){e(n)})},ta.xn=function(t){return new ta(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ta.Fn=function(t){for(var n=ta.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ta.resolve(t):e()})}(r[e]);return n},ta.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},ta),Wu=(Zu.delete=function(t){return Er("SimpleDb","Removing database:",t),ua(window.indexedDB.deleteDatabase(t)).Cn()},Zu.kn=function(){if("undefined"==typeof indexedDB)return!1;if(Zu.$n())return!0;var t=p(),e=0<(n=Zu.Mn(t))&&n<10,n=0<(n=Zu.Ln(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Zu.$n=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},Zu.qn=function(t,e){return t.store(e)},Zu.Mn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Zu.Ln=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Zu.prototype.Un=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Er("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Xu(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new qr(Fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Xu(o,t))},r.onupgradeneeded=function(t){Er("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.On.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Er("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return i.Qn(t)}),this.db)]}})})},Zu.prototype.Kn=function(e){this.Qn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Zu.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Un(u)];case 2:return s.db=t.sent(),e=ra.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Qu.reject(t)}).Cn(),r={},n.catch(function(){}),[4,e.Wn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Er("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Zu.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Zu),Yu=(Object.defineProperty($u.prototype,"vn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty($u.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty($u.prototype,"cursor",{set:function(t){this.jn=t},enumerable:!1,configurable:!0}),$u.prototype.done=function(){this.Gn=!0},$u.prototype.Jn=function(t){this.zn=t},$u.prototype.delete=function(){return ua(this.jn.delete())},$u),Xu=(n(Ju,Gu=qr),Ju);function Ju(t,e){var n=this;return(n=Gu.call(this,Fr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function $u(t){this.jn=t,this.Gn=!1,this.zn=null}function Zu(t,e,n){this.name=t,this.version=e,this.On=n,12.2===Zu.Mn(p())&&Ir("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ta(t){var e=this;this.yn=null,this.pn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.yn&&e.yn(t)},function(t){e.vn=!0,e.error=t,e.pn&&e.pn(t)})}function ea(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function na(t){return"IndexedDbTransactionError"===t.name}var ra=(sa.open=function(t,e,n,r){try{return new sa(e,t.transaction(r,n))}catch(t){throw new Xu(e,t)}},Object.defineProperty(sa.prototype,"Wn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),sa.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(Er("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},sa.prototype.store=function(t){return t=this.transaction.objectStore(t),new ia(t)},sa),ia=(oa.prototype.put=function(t,e){return ua(t=void 0!==e?(Er("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Er("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},oa.prototype.add=function(t){return Er("SimpleDb","ADD",this.store.name,t,t),ua(this.store.add(t))},oa.prototype.get=function(e){var n=this;return ua(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Er("SimpleDb","GET",n.store.name,e,t),t})},oa.prototype.delete=function(t){return Er("SimpleDb","DELETE",this.store.name,t),ua(this.store.delete(t))},oa.prototype.count=function(){return Er("SimpleDb","COUNT",this.store.name),ua(this.store.count())},oa.prototype.Xn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Zn(e,function(t,e){n.push(e)}).next(function(){return n})},oa.prototype.ts=function(t,e){return Er("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).es=!1,e=this.cursor(e),this.Zn(e,function(t,e,n){return n.delete()})},oa.prototype.ns=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Zn(n,e)},oa.prototype.ss=function(r){var t=this.cursor({});return new Qu(function(n,e){t.onerror=function(t){t=ca(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},oa.prototype.Zn=function(t,i){var o=[];return new Qu(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Yu(n),(t=i(n.primaryKey,n.value,e))instanceof Qu&&(t=t.catch(function(t){return e.done(),Qu.reject(t)}),o.push(t)),e.vn?r():null===e.Hn?n.continue():n.continue(e.Hn)):r()}}).next(function(){return Qu.xn(o)})},oa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},oa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},oa);function oa(t){this.store=t}function sa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Yn=new Ku,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){t.error?n.Yn.reject(new Xu(e,t.error)):n.Yn.resolve()},this.transaction.onerror=function(t){t=ca(t.target.error),n.Yn.reject(new Xu(e,t))}}function ua(t){return new Qu(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=ca(t.target.error),n(t)}})}var aa=!1;function ca(t){var e=Wu.Mn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return aa||(aa=!0,setTimeout(function(){throw n},0)),n}return t}function ha(){return"undefined"!=typeof window?window:null}function la(){return"undefined"!=typeof document?document:null}var fa=(ya.hs=function(t,e,n,r,i){return(i=new ya(t,e,Date.now()+n,r,i)).start(n),i},ya.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},ya.prototype.Vn=function(){return this._s()},ya.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.us.reject(new qr(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ya.prototype._s=function(){var e=this;this.rs.fs(function(){return null!==e.ls?(e.clearTimeout(),e.op().then(function(t){return e.us.resolve(t)})):Promise.resolve()})},ya.prototype.clearTimeout=function(){null!==this.ls&&(this.cs(this),clearTimeout(this.ls),this.ls=null)},ya),pa=(Object.defineProperty(da.prototype,"Vs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),da.prototype.fs=function(t){this.enqueue(t)},da.prototype.ys=function(t){this.ps(),this.vs(t)},da.prototype.bs=function(){var t;this.Ts||(this.Ts=!0,(t=la())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs))},da.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.vs(t)},da.prototype.Ss=function(t){var e=this;this.fs(function(){return e.ws.push(t),e.Ds()})},da.prototype.Ds=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.ws.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return t.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!na(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ws.length&&this.Ps.An(function(){return n.Ds()}),t.label=5;case 5:return[2]}})})},da.prototype.vs=function(t){var r=this,e=this.ds.then(function(){return r.As=!0,t().catch(function(t){throw r.Is=t,r.As=!1,Ir("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.As=!1,t})});return this.ds=e},da.prototype.Pn=function(t,e,n){var r=this;return this.ps(),-1<this.Rs.indexOf(t)&&(e=0),n=fa.hs(this,t,e,n,function(t){return r.Cs(t)}),this.Es.push(n),n},da.prototype.ps=function(){this.Is&&xr()},da.prototype.Ns=function(){},da.prototype.xs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.ds)return[3,0];t.label=3;case 3:return[2]}})})},da.prototype.Fs=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},da.prototype.Os=function(r){var i=this;return this.xs().then(function(){i.Es.sort(function(t,e){return t.os-e.os});for(var t=0,e=i.Es;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n._n===r)break}return i.xs()})},da.prototype.Ms=function(t){this.Rs.push(t)},da.prototype.Cs=function(t){t=this.Es.indexOf(t),this.Es.splice(t,1)},da);function da(){var e=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new Hu(this,"async_queue_retry"),this.gs=function(){var t=la();t&&Er("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ps.gn()};var t=la();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.gs)}function ya(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.cs=i,this.us=new Ku,this.then=this.us.promise.then.bind(this.us.promise),this.us.promise.catch(function(t){})}function va(t,e){if(Ir("AsyncQueue",e+": "+t),na(t))return new qr(Fr.UNAVAILABLE,e+": "+t);throw t}function ga(){this.queries=new jr(hu,cu),this.onlineState="Unknown",this.$s=new Set}var ma=function(){this.ks=void 0,this.listeners=[]};function wa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ma),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ls(n)];case 2:return o.ks=t.sent(),[3,4];case 3:return o=va(o=t.sent(),"Initialization of query '"+lu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Bs(e.onlineState),i.ks&&u.qs(i.ks)&&_a(e),[2]}})})}function ba(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Us(n))]:[2]})})}function _a(t){t.$s.forEach(function(t){t.next()})}var Ea=(Na.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Mi(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Kt,!0)}var o=!1;return this.Ks?this.js(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.Ws=t,o},Na.prototype.onError=function(t){this.Qs.error(t)},Na.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.Ws&&!this.Ks&&this.Gs(this.Ws,t)&&(this.zs(this.Ws),e=!0),e},Na.prototype.Gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Hs&&n||t.docs.T()&&"Offline"!==e)},Na.prototype.js=function(t){if(0<t.docChanges.length)return!0;var e=this.Ws&&this.Ws.hasPendingWrites!==t.hasPendingWrites;return!(!t.Kt&&!e)&&!0===this.options.includeMetadataChanges},Na.prototype.zs=function(t){t=Mi.jt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.Qs.next(t)},Na),Ia=(Ta.prototype.Js=function(){return null!=this.uid},Ta.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},Ta.prototype.isEqual=function(t){return t.uid===this.uid},Ta);function Ta(t){this.uid=t}function Na(t,e,n){this.query=t,this.Qs=e,this.Ks=!1,this.Ws=null,this.onlineState="Unknown",this.options=n||{}}function xa(t,e){this.user=e,this.type="OAuth",this.ti={},this.ti.Authorization="Bearer "+t}Ia.UNAUTHENTICATED=new Ia(null),Ia.Xs=new Ia("google-credentials-uid"),Ia.Zs=new Ia("first-party-uid");var Aa=(ja.prototype.getToken=function(){return Promise.resolve(null)},ja.prototype.ni=function(){},ja.prototype.si=function(t){(this.ei=t)(Ia.UNAUTHENTICATED)},ja.prototype.ii=function(){this.ei=null},ja),Sa=(Ua.prototype.getToken=function(){var e=this,n=this.ai,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ai!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ar("string"==typeof t.accessToken),new xa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ua.prototype.ni=function(){this.forceRefresh=!0},Ua.prototype.si=function(t){this.ei=t,this.oi&&t(this.currentUser)},Ua.prototype.ii=function(){this.auth&&this.auth.removeAuthTokenListener(this.ri),this.ri=null,this.ei=null},Ua.prototype.ci=function(){var t=this.auth&&this.auth.getUid();return Ar(null===t||"string"==typeof t),new Ia(t)},Ua),Oa=(Object.defineProperty(Ma.prototype,"ti",{get:function(){var t={"X-Goog-AuthUser":this.hi},e=this.ui.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ma),ka=(Va.prototype.getToken=function(){return Promise.resolve(new Oa(this.ui,this.hi))},Va.prototype.si=function(t){t(Ia.Zs)},Va.prototype.ii=function(){},Va.prototype.ni=function(){},Va),Da=(Ra.prototype._i=function(t,e,n){for(var r,i,o,s,u,a=n.fi,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof Es?new zs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Is?(u=i,h=o,vs((s=r).je,u)?(u=xs(s,u),new zs(s.key,h.version,u,{hasCommittedMutations:!0})):new Hs(s.key,h.version)):r instanceof Ss?function(t,e,n){if(Ar(null!=n.transformResults),!vs(t.je,e))return new Hs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Ar(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof zs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Jo?ts(o,s):o instanceof ns?is(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=ks(t,r.data(),e);return new zs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Ks(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ra.prototype.di=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=gs(i,e,e,this.li))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=gs(a,e,o,this.li))}return e},Ra.prototype.wi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.di(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ra.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ci())},Ra.prototype.isEqual=function(t){return this.batchId===t.batchId&&Dr(this.mutations,t.mutations,ms)&&Dr(this.baseMutations,t.baseMutations,ms)},Ra),Pa=(La.from=function(t,e,n){Ar(t.mutations.length===n.length);for(var r=Di,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new La(t,e,n,r)},La),h=(Ca.prototype.Ai=function(t){return(t=this.Ii.get(t))?t.readTime:Gr.min()},Ca.prototype.Ri=function(t,e){this.Pi(),this.Ii.set(t.key,{gi:t,readTime:e})},Ca.prototype.Vi=function(t,e){void 0===e&&(e=null),this.Pi(),this.Ii.set(t,{gi:null,readTime:e})},Ca.prototype.yi=function(t,e){this.Pi();var n=this.Ii.get(e);return void 0!==n?Qu.resolve(n.gi):this.pi(t,e)},Ca.prototype.getEntries=function(t,e){return this.vi(t,e)},Ca.prototype.apply=function(t){return this.Pi(),this.mi=!0,this.bi(t)},Ca.prototype.Pi=function(){},Ca);function Ca(){this.Ii=new jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mi=!1}function La(t,e,n,r){this.batch=t,this.Ti=e,this.fi=n,this.Ei=r}function Ra(t,e,n,r){this.batchId=t,this.li=e,this.baseMutations=n,this.mutations=r}function Va(t,e){this.ui=t,this.hi=e}function Ma(t,e){this.ui=t,this.hi=e,this.type="FirstParty",this.user=Ia.Zs}function Ua(t){var e=this;this.ri=null,this.currentUser=Ia.UNAUTHENTICATED,this.oi=!1,this.ai=0,this.ei=null,this.forceRefresh=!1,this.ri=function(){e.ai++,e.currentUser=e.ci(),e.oi=!0,e.ei&&e.ei(e.currentUser)},this.ai=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ri):(this.ri(null),t.get().then(function(t){e.auth=t,e.ri&&e.auth.addAuthTokenListener(e.ri)},function(){}))}function ja(){this.ei=null}function Fa(t){return new _o(t,!0)}function qa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Ba="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ge=(Ya.prototype.Di=function(t){this.Si.push(t)},Ya.prototype.Ci=function(){this.Si.forEach(function(t){return t()})},Ya),Ga=(Wa.prototype.Oi=function(e,n){var r=this;return this.xi.Mi(e,n).next(function(t){return r.ki(e,n,t)})},Wa.prototype.ki=function(t,r,i){return this.Ni.yi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].di(r,t);return t})},Wa.prototype.$i=function(t,e,i){var o=Ai;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].di(t,e);o=o.rt(t,e)}),o},Wa.prototype.Li=function(e,t){var n=this;return this.Ni.getEntries(e,t).next(function(t){return n.Bi(e,t)})},Wa.prototype.Bi=function(e,r){var i=this;return this.xi.qi(e,r).next(function(t){var t=i.$i(e,r,t),n=Ai;return t.forEach(function(t,e){e=e||new Ks(t,Gr.min()),n=n.rt(t,e)}),n})},Wa.prototype.Ui=function(t,e,n){return r=e,Qr.G(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Qi(t,e.path):ru(e)?this.Ki(t,e,n):this.Wi(t,e,n);var r},Wa.prototype.Qi=function(t,e){return this.Oi(t,new Qr(e)).next(function(t){var e=ki;return t instanceof zs&&(e=e.rt(t.key,t)),e})},Wa.prototype.Ki=function(n,r,i){var o=this,s=r.collectionGroup,u=ki;return this.Fi.ji(n,s).next(function(t){return Qu.forEach(t,function(t){var e=(e=r,t=t.child(s),new Qs(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Wi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Wa.prototype.Wi=function(e,n,t){var a,c,r=this;return this.Ni.Ui(e,n,t).next(function(t){return a=t,r.xi.Gi(e,n)}).next(function(t){return c=t,r.zi(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=gs(s,s=a.get(u),s,r.li);a=s instanceof zs?a.rt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){fu(n,e)||(a=a.remove(t))}),a})},Wa.prototype.zi=function(t,e,n){for(var r=Ci(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Is&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Ni.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof zs&&(c=c.rt(t,e))}),c})},Wa),za=(Qa.Yi=function(t,e){for(var n=Ci(),r=Ci(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Qa(t,e.fromCache,n,r)},Qa),Ka=(Ha.prototype.Zi=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ha.prototype.next=function(){var t=++this.previousValue;return this.tr&&this.tr(t),t},Ha);function Ha(t,e){var n=this;this.previousValue=t,e&&(e.Xi=function(t){return n.Zi(t)},this.tr=function(t){return e.er(t)})}function Qa(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hi=n,this.Ji=r}function Wa(t,e,n){this.Ni=t,this.xi=e,this.Fi=n}function Ya(){this.Si=[]}function Xa(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=kr(n,t))?kr(r,e):t}Ka.nr=-1;var Ja=(ec.prototype.rr=function(){return++this.ir},ec.prototype.ar=function(t){var e=[t,this.rr()];this.buffer.size<this.sr?this.buffer=this.buffer.add(e):Xa(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(ec.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),ec),$a={cr:!1,ur:0,hr:0,lr:0},Za=(tc.Tr=function(t){return new tc(t,tc.Er,tc.Ir)},tc);function tc(t,e,n){this._r=t,this.dr=e,this.wr=n}function ec(t){this.sr=t,this.buffer=new Ni(Xa),this.ir=0}Za.Er=10,Za.Ir=1e3,Za.mr=new Za(41943040,Za.Er,Za.Ir),Za.Ar=new Za(-1,0,0);var nc=(oc.prototype.start=function(t){-1!==this.Rr.params._r&&this.Vr(t)},oc.prototype.stop=function(){this.gr&&(this.gr.cancel(),this.gr=null)},Object.defineProperty(oc.prototype,"yr",{get:function(){return null!==this.gr},enumerable:!1,configurable:!0}),oc.prototype.Vr=function(n){var t=this,e=this.Pr?3e5:6e4;Er("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gr=this.rs.Pn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.gr=null,this.Pr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.pr(this.Rr)];case 2:return t.sent(),[3,7];case 3:return na(e=t.sent())?(Er("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Gh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Vr(n)];case 8:return t.sent(),[2]}})})})},oc),rc=(ic.prototype.br=function(t,e){return this.vr.Sr(t).next(function(t){return Math.floor(e/100*t)})},ic.prototype.Dr=function(t,e){var n=this;if(0===e)return Qu.resolve(Ka.nr);var r=new Ja(e);return this.vr.De(t,function(t){return r.ar(t.sequenceNumber)}).next(function(){return n.vr.Cr(t,function(t){return r.ar(t)})}).next(function(){return r.maxValue})},ic.prototype.Nr=function(t,e,n){return this.vr.Nr(t,e,n)},ic.prototype.Fr=function(t,e){return this.vr.Fr(t,e)},ic.prototype.Or=function(e,n){var r=this;return-1===this.params._r?(Er("LruGarbageCollector","Garbage collection skipped; disabled"),Qu.resolve($a)):this.Mr(e).next(function(t){return t<r.params._r?(Er("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params._r),$a):r.kr(e,n)})},ic.prototype.Mr=function(t){return this.vr.Mr(t)},ic.prototype.kr=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.br(e,this.params.dr).next(function(t){return i=t>h.params.wr?(Er("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.wr+" from "+t),h.params.wr):t,s=Date.now(),h.Dr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Nr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Fr(e,r)}).next(function(t){return c=Date.now(),_r()<=f.DEBUG&&Er("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),Qu.resolve({cr:!0,ur:i,hr:o,lr:t})})},ic);function ic(t,e){this.vr=t,this.params=e}function oc(t,e){this.Rr=t,this.rs=e,this.Pr=!1,this.gr=null}function sc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=uc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return uc(o)}function uc(t){return t+""}function ac(t){var e=t.length;if(Ar(2<=e),2===e)return Ar(""===t.charAt(0)&&""===t.charAt(1)),zr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&xr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:xr()}o=s+2}return new zr(r)}var cc=function(t){this.$r=t};function hc(t,e){if(e.document)return n=t.$r,r=e.document,i=!!e.hasCommittedMutations,t=Do(n,r.name),n=Ao(r.updateTime),r=new Rs({mapValue:{fields:r.fields}}),new zs(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=Qr.H(e.noDocument.path),o=yc(e.noDocument.readTime);return new Ks(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=Qr.H(e.unknownDocument.path),e=yc(e.unknownDocument.version),new Hs(o,e)):xr()}function lc(t,e,n){var r=fc(n),n=e.key.path.S().O();if(e instanceof zs){var i={name:ko(i=t.$r,(o=e).key),fields:o.sn().mapValue.fields,updateTime:No(i,o.version.P())},o=e.hasCommittedMutations;return new Xc(null,null,i,o,r,n)}if(e instanceof Ks){var i=e.key.path.O(),o=dc(e.version),s=e.hasCommittedMutations;return new Xc(null,new Wc(i,o),null,s,r,n)}return e instanceof Hs?(s=e.key.path.O(),e=dc(e.version),new Xc(new Yc(s,e),null,null,!0,r,n)):xr()}function fc(t){return[(t=t.P()).seconds,t.nanoseconds]}function pc(t){return t=new Br(t[0],t[1]),Gr.m(t)}function dc(t){return t=t.P(),new jc(t.seconds,t.nanoseconds)}function yc(t){return t=new Br(t.seconds,t.nanoseconds),Gr.m(t)}function vc(e,t){var n=(t.baseMutations||[]).map(function(t){return Uo(e.$r,t)}),r=t.mutations.map(function(t){return Uo(e.$r,t)}),i=Br.fromMillis(t.localWriteTimeMs);return new Da(t.batchId,i,n,r)}function gc(t){var e=yc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?yc(t.lastLimboFreeSnapshotVersion):Gr.min(),r=void 0!==t.query.documents?(Ar(1===(r=t.query).documents.length),ou($s(Co(r.documents[0])))):ou(qo(t.query));return new di(r,t.targetId,0,t.lastListenSequenceNumber,e,n,hi.fromBase64String(t.resumeToken))}function mc(t,e){var n=dc(e.et),r=dc(e.lastLimboFreeSnapshotVersion),i=(ci(e.target)?jo:Fo)(t.$r,e.target),t=e.resumeToken.toBase64();return new $c(e.targetId,ui(e.target),n,t,e.sequenceNumber,r,i)}function wc(t){var e=qo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?su(e,e.limit,"L"):e}var bc=(_c.qr=function(t,e,n,r){return Ar(""!==t.uid),new _c(t.Js()?t.uid:"",e,n,r)},_c.prototype.Ur=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Tc(t).ns({index:Kc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},_c.prototype.Qr=function(d,y,v,g){var m=this,w=Nc(d),b=Tc(d);return b.add({}).next(function(t){Ar("number"==typeof t);for(var e,n,r,i,o,s=new Da(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Mo(e.$r,t)}),o=r.mutations.map(function(t){return Mo(e.$r,t)}),new Kc(n,r.batchId,r.li.toMillis(),i,o)),a=[],c=new Ni(function(t,e){return kr(t.M(),e.M())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Hc.key(m.userId,f.key.path,t),c=c.add(f.key.path.S());a.push(b.put(u)),a.push(w.put(p,Hc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Fi.Kr(d,t))}),d.Di(function(){m.Br[t]=s.keys()}),Qu.xn(a).next(function(){return s})})},_c.prototype.Wr=function(t,e){var n=this;return Tc(t).get(e).next(function(t){return t?(Ar(t.userId===n.userId),vc(n.serializer,t)):null})},_c.prototype.jr=function(t,e){var n=this;return this.Br[e]?Qu.resolve(this.Br[e]):this.Wr(t,e).next(function(t){return t?(t=t.keys(),n.Br[e]=t):null})},_c.prototype.Gr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Tc(t).ns({index:Kc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Ar(e.batchId>=i),o=vc(r.serializer,e)),n.done()}).next(function(){return o})},_c.prototype.zr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Tc(t).ns({index:Kc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},_c.prototype.Hr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Tc(t).Xn(Kc.userMutationsIndex,n).next(function(t){return t.map(function(t){return vc(e.serializer,t)})})},_c.prototype.Mi=function(o,s){var u=this,t=Hc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Nc(o).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ac(i);if(r===u.userId&&s.path.isEqual(i))return Tc(o).get(t).next(function(t){if(!t)throw xr();Ar(t.userId===u.userId),a.push(vc(u.serializer,t))});n.done()}).next(function(){return a})},_c.prototype.qi=function(e,t){var s=this,u=new Ni(kr),n=[];return t.forEach(function(o){var t=Hc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Nc(e).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ac(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Qu.xn(n).next(function(){return s.Jr(e,u)})},_c.prototype.Gi=function(t,e){var o=this,s=e.path,u=s.length+1,e=Hc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Ni(kr);return Nc(t).ns({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ac(i);r===o.userId&&s.N(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Jr(t,a)})},_c.prototype.Jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Tc(e).get(t).next(function(t){if(null===t)throw xr();Ar(t.userId===n.userId),r.push(vc(n.serializer,t))}))}),Qu.xn(i).next(function(){return r})},_c.prototype.Yr=function(e,n){var r=this;return Ic(e.Xr,this.userId,n).next(function(t){return e.Di(function(){r.Zr(n.batchId)}),Qu.forEach(t,function(t){return r.Lr.eo(e,t)})})},_c.prototype.Zr=function(t){delete this.Br[t]},_c.prototype.no=function(e){var i=this;return this.Ur(e).next(function(t){if(!t)return Qu.resolve();var t=IDBKeyRange.lowerBound(Hc.prefixForUser(i.userId)),r=[];return Nc(e).ns({range:t},function(t,e,n){t[0]===i.userId?(t=ac(t[1]),r.push(t)):n.done()}).next(function(){Ar(0===r.length)})})},_c.prototype.so=function(t,e){return Ec(t,this.userId,e)},_c.prototype.io=function(t){var e=this;return xc(t).get(this.userId).next(function(t){return t||new zc(e.userId,-1,"")})},_c);function _c(t,e,n,r){this.userId=t,this.serializer=e,this.Fi=n,this.Lr=r,this.Br={}}function Ec(t,o,e){var s=(e=Hc.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Nc(t).ns({range:e,es:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Ic(t,e,n){var r=t.store(Kc.store),i=t.store(Hc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ns({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Ar(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Hc.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return Qu.xn(o).next(function(){return u})}function Tc(t){return Th.qn(t,Kc.store)}function Nc(t){return Th.qn(t,Hc.store)}function xc(t){return Th.qn(t,zc.store)}var Ac,Sc=(Dc.prototype.Ri=function(t,e,n){return Cc(t).put(Lc(e),n)},Dc.prototype.Vi=function(t,e){return t=Cc(t),e=Lc(e),t.delete(e)},Dc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ro(e,t)})},Dc.prototype.yi=function(t,e){var n=this;return Cc(t).get(Lc(e)).next(function(t){return n.oo(t)})},Dc.prototype.ao=function(t,e){var n=this;return Cc(t).get(Lc(e)).next(function(t){var e=n.oo(t);return e?{gi:e,size:Rc(t)}:null})},Dc.prototype.getEntries=function(t,e){var n=this,r=Ai;return this.co(t,e,function(t,e){e=n.oo(e),r=r.rt(t,e)}).next(function(){return r})},Dc.prototype.uo=function(t,e){var r=this,i=Ai,o=new mi(Qr.V);return this.co(t,e,function(t,e){var n=r.oo(e);o=n?(i=i.rt(t,n),o.rt(t,Rc(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{ho:i,lo:o}})},Dc.prototype.co=function(t,e,i){if(e.T())return Qu.resolve();var n=IDBKeyRange.bound(e.first().path.O(),e.last().path.O()),o=e.lt(),s=o.Et();return Cc(t).ns({range:n},function(t,e,n){for(var r=Qr.H(t);s&&Qr.V(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.O()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},Dc.prototype.Ui=function(t,r,e){var n,i=this,o=ki,s=r.path.length+1,u={};return e.isEqual(Gr.min())?(n=r.path.O(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.O(),e=fc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Xc.collectionReadTimeIndex),Cc(t).ns(u,function(t,e,n){t.length===s&&(e=hc(i.serializer,e),r.path.N(e.key.path)?e instanceof zs&&fu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},Dc.prototype._o=function(t){return new Oc(this,!!t&&t.fo)},Dc.prototype.wo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Dc.prototype.getMetadata=function(t){return Pc(t).get(Jc.key).next(function(t){return Ar(!!t),t})},Dc.prototype.ro=function(t,e){return Pc(t).put(Jc.key,e)},Dc.prototype.oo=function(t){return!t||(t=hc(this.serializer,t))instanceof Ks&&t.version.isEqual(Gr.min())?null:t},Dc),Oc=(n(kc,Ac=h),kc.prototype.bi=function(i){var o=this,s=[],u=0,a=new Ni(function(t,e){return kr(t.M(),e.M())});return this.Ii.forEach(function(t,e){var n,r=o.Eo.get(t);e.gi?(n=lc(o.To.serializer,e.gi,o.Ai(t)),a=a.add(t.path.S()),e=Rc(n),u+=e-r,s.push(o.To.Ri(i,t,n))):(u-=r,o.fo?(r=lc(o.To.serializer,new Ks(t,Gr.min()),o.Ai(t)),s.push(o.To.Ri(i,t,r))):s.push(o.To.Vi(i,t)))}),a.forEach(function(t){s.push(o.To.Fi.Kr(i,t))}),s.push(this.To.updateMetadata(i,u)),Qu.xn(s)},kc.prototype.pi=function(t,e){var n=this;return this.To.ao(t,e).next(function(t){return null===t?(n.Eo.set(e,0),null):(n.Eo.set(e,t.size),t.gi)})},kc.prototype.vi=function(t,e){var n=this;return this.To.uo(t,e).next(function(t){var e=t.ho;return t.lo.forEach(function(t,e){n.Eo.set(t,e)}),e})},kc);function kc(t,e){var n=this;return(n=Ac.call(this)||this).To=t,n.fo=e,n.Eo=new jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Dc(t,e){this.serializer=t,this.Fi=e}function Pc(t){return Th.qn(t,Jc.store)}function Cc(t){return Th.qn(t,Xc.store)}function Lc(t){return t.path.O()}function Rc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xr();e=t.noDocument}return JSON.stringify(e).length}var Vc=(Gc.prototype.Kr=function(t,e){return this.Io.add(e),Qu.resolve()},Gc.prototype.ji=function(t,e){return Qu.resolve(this.Io.getEntries(e))},Gc),Mc=(Bc.prototype.add=function(t){var e=t.C(),n=t.S(),r=this.index[e]||new Ni(zr.V),t=!r.has(n);return this.index[e]=r.add(n),t},Bc.prototype.has=function(t){var e=t.C(),t=t.S();return(e=this.index[e])&&e.has(t)},Bc.prototype.getEntries=function(t){return(this.index[t]||new Ni(zr.V)).O()},Bc),Uc=(qc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Ar(t<r&&0<=t&&r<=11);var o=new ra("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Fc.store),(s=e).createObjectStore(zc.store,{keyPath:zc.keyPath}),s.createObjectStore(Kc.store,{keyPath:Kc.keyPath,autoIncrement:!0}).createIndex(Kc.userMutationsIndex,Kc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Hc.store),nh(e),e.createObjectStore(Xc.store));var s,u=Qu.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Zc.store),s.deleteObjectStore($c.store),s.deleteObjectStore(th.store),nh(e)),u=u.next(function(){return t=o.store(th.store),e=new th(0,0,Gr.min().P(),0),t.put(th.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Kc.store).Xn().next(function(t){n.deleteObjectStore(Kc.store),n.createObjectStore(Kc.store,{keyPath:Kc.keyPath,autoIncrement:!0}).createIndex(Kc.userMutationsIndex,Kc.userMutationsKeyPath,{unique:!0});var e=r.store(Kc.store),t=t.map(function(t){return e.put(t)});return Qu.xn(t)});var n,r})),u=u.next(function(){e.createObjectStore(rh.store,{keyPath:rh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Jc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Xc.store)).createIndex(Xc.readTimeIndex,Xc.readTimeIndexPath,{unique:!1}),t.createIndex(Xc.collectionReadTimeIndex,Xc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(ih.store,{keyPath:ih.keyPath}),e.createObjectStore(oh.store,{keyPath:oh.keyPath})})),u},qc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Xc.store).ns(function(t,e){n+=Rc(e)}).next(function(){var t=new Jc(n);return e.store(Jc.store).put(Jc.key,t)})},qc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(zc.store),i=n.store(Kc.store);return t.Xn().next(function(t){return Qu.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Xn(Kc.userMutationsIndex,t).next(function(t){return Qu.forEach(t,function(t){return Ar(t.userId===e.userId),t=vc(r.serializer,t),Ic(n,e.userId,t).next(function(){})})})})})},qc.prototype.ensureSequenceNumbers=function(t){var o=t.store(Zc.store),e=t.store(Xc.store);return t.store(th.store).get(th.key).next(function(r){var i=[];return e.ns(function(t,e){var n=new zr(t),t=[0,sc(n)];i.push(o.get(t).next(function(t){return t?Qu.resolve():o.put(new Zc(0,sc(n),r.highestListenSequenceNumber))}))}).next(function(){return Qu.xn(i)})})},qc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.C(),t=t.S();return n.put({collectionId:e,parent:sc(t)})}}t.createObjectStore(eh.store,{keyPath:eh.keyPath});var n=e.store(eh.store),i=new Mc;return e.store(Xc.store).ns({es:!0},function(t,e){return r((t=new zr(t)).S())}).next(function(){return e.store(Hc.store).ns({es:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],ac(n))).S())})})},qc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store($c.store);return r.ns(function(t,e){return e=gc(e),e=mc(n.serializer,e),r.put(e)})},qc),jc=function(t,e){this.seconds=t,this.nanoseconds=e},Fc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function qc(t){this.serializer=t}function Bc(){this.index={}}function Gc(){this.Io=new Mc}Fc.store="owner",Fc.key="owner";var zc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};zc.store="mutationQueues",zc.keyPath="userId";var Kc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Kc.store="mutations",Kc.keyPath="batchId",Kc.userMutationsIndex="userMutationsIndex",Kc.userMutationsKeyPath=["userId","batchId"];var Hc=(Qc.prefixForUser=function(t){return[t]},Qc.prefixForPath=function(t,e){return[t,sc(e)]},Qc.key=function(t,e,n){return[t,sc(e),n]},Qc);function Qc(){}Hc.store="documentMutations",Hc.PLACEHOLDER=new Hc;var Wc=function(t,e){this.path=t,this.readTime=e},Yc=function(t,e){this.path=t,this.version=e},Xc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Xc.store="remoteDocuments",Xc.readTimeIndex="readTimeIndex",Xc.readTimeIndexPath="readTime",Xc.collectionReadTimeIndex="collectionReadTimeIndex",Xc.collectionReadTimeIndexPath=["parentPath","readTime"];var Jc=function(t){this.byteSize=t};Jc.store="remoteDocumentGlobal",Jc.key="remoteDocumentGlobalKey";var $c=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};$c.store="targets",$c.keyPath="targetId",$c.queryTargetsIndexName="queryTargetsIndex",$c.queryTargetsKeyPath=["canonicalId","targetId"];var Zc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Zc.store="targetDocuments",Zc.keyPath=["targetId","path"],Zc.documentTargetsIndex="documentTargetsIndex",Zc.documentTargetsKeyPath=["path","targetId"];var th=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};th.key="targetGlobalKey",th.store="targetGlobal";var eh=function(t,e){this.collectionId=t,this.parent=e};function nh(t){t.createObjectStore(Zc.store,{keyPath:Zc.keyPath}).createIndex(Zc.documentTargetsIndex,Zc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore($c.store,{keyPath:$c.keyPath}).createIndex($c.queryTargetsIndexName,$c.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(th.store)}eh.store="collectionParents",eh.keyPath=["collectionId","parent"];var rh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};rh.store="clientMetadata",rh.keyPath="clientId";var ih=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ih.store="bundles",ih.keyPath="bundleId";var oh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};oh.store="namedQueries",oh.keyPath="name";var sh=i(i(i(i([zc.store,Kc.store,Hc.store,Xc.store,$c.store,Fc.store,th.store,Zc.store],[rh.store]),[Jc.store]),[eh.store]),[ih.store,oh.store]),uh=(ah.prototype.mo=function(t,e){return ch(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:yc(t.createTime),version:t.version}})},ah.prototype.Ao=function(t,e){return ch(t).put({bundleId:e.id,createTime:dc(Ao(e.createTime)),version:e.version})},ah.prototype.Ro=function(t,e){return hh(t).get(e).next(function(t){if(t)return{name:t.name,query:wc(t.bundledQuery),readTime:yc(t.readTime)}})},ah.prototype.Po=function(t,e){return hh(t).put({name:e.name,readTime:dc(Ao(e.readTime)),bundledQuery:e.bundledQuery})},ah);function ah(t){this.serializer=t}function ch(t){return Th.qn(t,ih.store)}function hh(t){return Th.qn(t,oh.store)}var lh=(fh.prototype.Kr=function(t,e){var n=this;if(this.Vo.has(e))return Qu.resolve();var r=e.C(),i=e.S();return t.Di(function(){n.Vo.add(e)}),i={collectionId:r,parent:sc(i)},ph(t).put(i)},fh.prototype.ji=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Pr(i),""],!1,!0);return ph(t).Xn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ac(r.parent))}return o})},fh);function fh(){this.Vo=new Mc}function ph(t){return Th.qn(t,eh.store)}var dh=(gh.prototype.next=function(){return this.yo+=2,this.yo},gh.po=function(){return new gh(0)},gh.vo=function(){return new gh(-1)},gh),yh=(vh.prototype.bo=function(n){var r=this;return this.So(n).next(function(t){var e=new dh(t.highestTargetId);return t.highestTargetId=e.next(),r.Do(n,t).next(function(){return t.highestTargetId})})},vh.prototype.Co=function(t){return this.So(t).next(function(t){return Gr.m(new Br(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},vh.prototype.No=function(t){return this.So(t).next(function(t){return t.highestListenSequenceNumber})},vh.prototype.xo=function(e,n,r){var i=this;return this.So(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.P()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Do(e,t)})},vh.prototype.Fo=function(e,n){var r=this;return this.Oo(e,n).next(function(){return r.So(e).next(function(t){return t.targetCount+=1,r.Mo(n,t),r.Do(e,t)})})},vh.prototype.ko=function(t,e){return this.Oo(t,e)},vh.prototype.$o=function(e,t){var n=this;return this.Lo(e,t.targetId).next(function(){return mh(e).delete(t.targetId)}).next(function(){return n.So(e)}).next(function(t){return Ar(0<t.targetCount),--t.targetCount,n.Do(e,t)})},vh.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return mh(n).ns(function(t,e){(e=gc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.$o(n,e)))}).next(function(){return Qu.xn(u)}).next(function(){return s})},vh.prototype.De=function(t,n){return mh(t).ns(function(t,e){e=gc(e),n(e)})},vh.prototype.So=function(t){return wh(t).get(th.key).next(function(t){return Ar(null!==t),t})},vh.prototype.Do=function(t,e){return wh(t).put(th.key,e)},vh.prototype.Oo=function(t,e){return mh(t).put(mc(this.serializer,e))},vh.prototype.Mo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},vh.prototype.Bo=function(t){return this.So(t).next(function(t){return t.targetCount})},vh.prototype.qo=function(t,r){var e=ui(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return mh(t).ns({range:e,index:$c.queryTargetsIndexName},function(t,e,n){e=gc(e),ai(r,e.target)&&(i=e,n.done())}).next(function(){return i})},vh.prototype.Uo=function(n,t,r){var i=this,o=[],s=bh(n);return t.forEach(function(t){var e=sc(t.path);o.push(s.put(new Zc(r,e))),o.push(i.Lr.Qo(n,r,t))}),Qu.xn(o)},vh.prototype.Ko=function(n,t,r){var i=this,o=bh(n);return Qu.forEach(t,function(t){var e=sc(t.path);return Qu.xn([o.delete([r,e]),i.Lr.Wo(n,r,t)])})},vh.prototype.Lo=function(t,e){return t=bh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},vh.prototype.jo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=bh(t),r=Ci();return t.ns({range:e,es:!0},function(t,e,n){t=ac(t[1]),t=new Qr(t),r=r.add(t)}).next(function(){return r})},vh.prototype.so=function(t,e){var e=sc(e.path),e=IDBKeyRange.bound([e],[Pr(e)],!1,!0),i=0;return bh(t).ns({index:Zc.documentTargetsIndex,es:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},vh.prototype.qe=function(t,e){return mh(t).get(e).next(function(t){return t?gc(t):null})},vh);function vh(t,e){this.Lr=t,this.serializer=e}function gh(t){this.yo=t}function mh(t){return Th.qn(t,$c.store)}function wh(t){return Th.qn(t,th.store)}function bh(t){return Th.qn(t,Zc.store)}var _h,Eh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ih=(n(xh,_h=ge),xh),Th=(Nh.qn=function(t,e){if(t instanceof Ih)return Wu.qn(t.Xr,e);throw xr()},Nh.prototype.start=function(){var e=this;return this.ca().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new qr(Fr.FAILED_PRECONDITION,Eh);return e.ua(),e.ha(),e.la(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ra.No(t)})}).then(function(t){e.Jo=new Ka(t,e.zo)}).then(function(){e.Yo=!0}).catch(function(t){return e.ia&&e.ia.close(),Promise.reject(t)})},Nh.prototype._a=function(n){var t=this;return this.na=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.yr?[2,n(e)]:[2]})})},n(this.isPrimary)},Nh.prototype.fa=function(n){var t=this;this.ia.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Nh.prototype.da=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.yr?[4,this.ca()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Nh.prototype.ca=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Sh(e).put(new rh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.wa(e).next(function(t){t||(n.isPrimary=!1,n.ln.Ss(function(){return n.na(!1)}))})}).next(function(){return n.Ta(e)}).next(function(t){return n.isPrimary&&!t?n.Ea(e).next(function(){return!1}):!!t&&n.Ia(e).next(function(){return!0})})}).catch(function(t){if(na(t))return Er("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Er("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ln.Ss(function(){return n.na(t)}),n.isPrimary=t})},Nh.prototype.wa=function(t){var e=this;return Ah(t).get(Fc.key).next(function(t){return Qu.resolve(e.ma(t))})},Nh.prototype.Aa=function(t){return Sh(t).delete(this.clientId)},Nh.prototype.Ra=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Pa(this.ea,18e5)?[3,2]:(this.ea=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Nh.qn(t,rh.store);return r.Xn().next(function(t){var e=o.ga(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Qu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.aa)for(n=0,r=e;n<r.length;n++)i=r[n],this.aa.removeItem(this.Va(i.clientId));t.label=2;case 2:return[2]}})})},Nh.prototype.la=function(){var t=this;this.ta=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.ca().then(function(){return t.Ra()}).then(function(){return t.la()})})},Nh.prototype.ma=function(t){return!!t&&t.ownerId===this.clientId},Nh.prototype.Ta=function(e){var r=this;return this.Ho?Qu.resolve(!0):Ah(e).get(Fc.key).next(function(t){if(null!==t&&r.Pa(t.leaseTimestampMs,5e3)&&!r.ya(t.ownerId)){if(r.ma(t)&&r.networkEnabled)return!0;if(!r.ma(t)){if(!t.allowTabSynchronization)throw new qr(Fr.FAILED_PRECONDITION,Eh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Sh(e).Xn().next(function(t){return void 0===r.ga(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Er("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Nh.prototype.pa=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Yo=!1,this.va(),this.ta&&(this.ta.cancel(),this.ta=null),this.ba(),this.Sa(),[4,this.ia.runTransaction("shutdown","readwrite",[Fc.store,rh.store],function(t){var e=new Ih(t,Ka.nr);return n.Ea(e).next(function(){return n.Aa(e)})})];case 1:return t.sent(),this.ia.close(),this.Da(),[2]}})})},Nh.prototype.ga=function(t,e){var n=this;return t.filter(function(t){return n.Pa(t.updateTimeMs,e)&&!n.ya(t.clientId)})},Nh.prototype.Ca=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Sh(t).Xn().next(function(t){return e.ga(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Nh.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Nh.prototype.Na=function(t){return bc.qr(t,this.serializer,this.Fi,this.Lr)},Nh.prototype.xa=function(){return this.ra},Nh.prototype.Fa=function(){return this.Ni},Nh.prototype.Oa=function(){return this.Fi},Nh.prototype.Ma=function(){return this.oa},Nh.prototype.runTransaction=function(e,n,r){var i=this;Er("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ia.runTransaction(e,t,sh,function(t){return o=new Ih(t,i.Jo?i.Jo.next():Ka.nr),"readwrite-primary"===n?i.wa(o).next(function(t){return!!t||i.Ta(o)}).next(function(t){if(!t)throw Ir("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.na(!1)}),new qr(Fr.FAILED_PRECONDITION,Ba);return r(o)}).next(function(t){return i.Ia(o).next(function(){return t})}):i.ka(o).next(function(){return r(o)})}).then(function(t){return o.Ci(),t})},Nh.prototype.ka=function(t){var e=this;return Ah(t).get(Fc.key).next(function(t){if(null!==t&&e.Pa(t.leaseTimestampMs,5e3)&&!e.ya(t.ownerId)&&!e.ma(t)&&!(e.Ho||e.allowTabSynchronization&&t.allowTabSynchronization))throw new qr(Fr.FAILED_PRECONDITION,Eh)})},Nh.prototype.Ia=function(t){var e=new Fc(this.clientId,this.allowTabSynchronization,Date.now());return Ah(t).put(Fc.key,e)},Nh.kn=function(){return Wu.kn()},Nh.prototype.Ea=function(t){var e=this,n=Ah(t);return n.get(Fc.key).next(function(t){return e.ma(t)?(Er("IndexedDbPersistence","Releasing primary lease."),n.delete(Fc.key)):Qu.resolve()})},Nh.prototype.Pa=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ir("Detected an update time that is in the future: "+t+" > "+n),1))},Nh.prototype.ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Zo=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.ca()})},this.document.addEventListener("visibilitychange",this.Zo),this.inForeground="visible"===this.document.visibilityState)},Nh.prototype.ba=function(){this.Zo&&(this.document.removeEventListener("visibilitychange",this.Zo),this.Zo=null)},Nh.prototype.ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Xo=function(){e.va(),e.ln.fs(function(){return e.pa()})},this.window.addEventListener("unload",this.Xo))},Nh.prototype.Sa=function(){this.Xo&&(this.window.removeEventListener("unload",this.Xo),this.Xo=null)},Nh.prototype.ya=function(t){try{var e=null!==(null===(e=this.aa)||void 0===e?void 0:e.getItem(this.Va(t)));return Er("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ir("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Nh.prototype.va=function(){if(this.aa)try{this.aa.setItem(this.Va(this.clientId),String(Date.now()))}catch(t){Ir("Failed to set zombie client id.",t)}},Nh.prototype.Da=function(){if(this.aa)try{this.aa.removeItem(this.Va(this.clientId))}catch(t){}},Nh.prototype.Va=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Nh);function Nh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ln=i,this.window=o,this.document=s,this.zo=a,this.Ho=c,this.Jo=null,this.Yo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Xo=null,this.inForeground=!1,this.Zo=null,this.ta=null,this.ea=Number.NEGATIVE_INFINITY,this.na=function(t){return Promise.resolve()},!Nh.kn())throw new qr(Fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Lr=new Oh(this,r),this.sa=e+"main",this.serializer=new cc(u),this.ia=new Wu(this.sa,11,new Uc(this.serializer)),this.ra=new yh(this.Lr,this.serializer),this.Fi=new lh,this.Ni=(e=this.serializer,u=this.Fi,new Sc(e,u)),this.oa=new uh(this.serializer),this.window&&this.window.localStorage?this.aa=this.window.localStorage:(this.aa=null,!1===c&&Ir("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function xh(t,e){var n=this;return(n=_h.call(this)||this).Xr=t,n.Go=e,n}function Ah(t){return Th.qn(t,Fc.store)}function Sh(t){return Th.qn(t,rh.store)}var Oh=(kh.prototype.Sr=function(t){var n=this.$a(t);return this.db.xa().Bo(t).next(function(e){return n.next(function(t){return e+t})})},kh.prototype.$a=function(t){var e=0;return this.Cr(t,function(t){e++}).next(function(){return e})},kh.prototype.De=function(t,e){return this.db.xa().De(t,e)},kh.prototype.Cr=function(t,n){return this.La(t,function(t,e){return n(e)})},kh.prototype.Qo=function(t,e,n){return Dh(t,n)},kh.prototype.Wo=function(t,e,n){return Dh(t,n)},kh.prototype.Nr=function(t,e,n){return this.db.xa().Nr(t,e,n)},kh.prototype.eo=Dh,kh.prototype.Ba=function(t,e){return r=e,i=!1,xc(n=t).ss(function(t){return Ec(n,t,r).next(function(t){return t&&(i=!0),Qu.resolve(!t)})}).next(function(){return i});var n,r,i},kh.prototype.Fr=function(n,r){var i=this,o=this.db.Fa()._o(),s=[],u=0;return this.La(n,function(e,t){t<=r&&(t=i.Ba(n,e).next(function(t){if(!t)return u++,o.yi(n,e).next(function(){return o.Vi(e),bh(n).delete([0,sc(e.path)])})}),s.push(t))}).next(function(){return Qu.xn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},kh.prototype.removeTarget=function(t,e){return e=e.nt(t.Go),this.db.xa().ko(t,e)},kh.prototype.qa=Dh,kh.prototype.La=function(t,r){var i,t=bh(t),o=Ka.nr;return t.ns({index:Zc.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ka.nr&&r(new Qr(ac(i)),o),o=e,i=t):o=Ka.nr}).next(function(){o!==Ka.nr&&r(new Qr(ac(i)),o)})},kh.prototype.Mr=function(t){return this.db.Fa().wo(t)},kh);function kh(t,e){this.db=t,this.Rr=new rc(this,e)}function Dh(t,e){return bh(t).put((t=t.Go,new Zc(0,sc(e.path),t)))}function Ph(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ch=(Lh.prototype.pr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Or(t,n.Qa)})},Lh);function Lh(t,e,n,r){this.persistence=t,this.Ua=e,this.serializer=r,this.Qa=new mi(kr),this.Ka=new jr(ui,ai),this.Wa=Gr.min(),this.xi=t.Na(n),this.ja=t.Fa(),this.ra=t.xa(),this.Ga=new Ga(this.ja,this.xi,this.persistence.Oa()),this.oa=t.Ma(),this.Ua.za(this.Ga)}function Rh(t,e,n,r){return new Ch(t,e,n,r)}function Vh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).xi,m=e.Ga,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.xi.Hr(v).next(function(t){return g=t,n=e.persistence.Na(o),m=new Ga(e.ja,n,e.persistence.Oa()),n.Hr(v)}).next(function(t){for(var e=[],n=[],r=Ci(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Li(v,r).next(function(t){return{Ha:t,Ja:e,Ya:n}})})})];case 1:return r=t.sent(),[2,(e.xi=n,e.Ga=m,e.Ua.za(e.Ga),r)]}})})}function Mh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ra.Co(t)})}function Uh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ra.qo(e,r).next(function(t){return t?(n=t,Qu.resolve(n)):i.ra.bo(e).next(function(t){return n=new di(r,t,0,e.Go),i.ra.Fo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Qa.get(t.targetId);return(null===e||0<t.et.A(e.et))&&(i.Qa=i.Qa.rt(t.targetId,t),i.Ka.set(r,t.targetId)),t})}function jh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Qa.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Lr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!na(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Qa=e.Qa.remove(o),e.Ka.delete(n.target),[2]}})})}function Fh(t,o,s){var u=t,a=Gr.min(),c=Ci();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ou(o),(void 0!==(t=(i=t).Ka.get(r))?Qu.resolve(i.Qa.get(t)):i.ra.qo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ra.jo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Ua.Ui(e,o,s?a:Gr.min(),s?c:Ci())}).next(function(t){return{documents:t,Xa:c}});var t,n,r,i})}function qh(t,e){var n=t,r=n.ra;return(t=n.Qa.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function Bh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.ja,n=t,t=s.Wa,r=e,i=Ai,o=fc(t),t=Cc(n),n=IDBKeyRange.lowerBound(o,!0),t.ns({index:Xc.readTimeIndex,range:n},function(t,e){var n=hc(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Za:i,readTime:pc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Za,t=t.readTime;return s.Wa=t,e})}function Gh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Fr.FAILED_PRECONDITION||e.message!==Ba)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}function zh(t,e,n,r,i){var o=this;this.Kc=t,this.Wc=e,this.rs=n,this.jc={},this.Gc=[],this.zc=new Map,this.Hc=new Set,this.Jc=[],this.Yc=i,this.Yc.Xc(function(t){n.fs(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ll(this)?(Er("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(4),[4,il(e)];case 1:return t.sent(),e.Zc.set("Unknown"),e.Hc.delete(4),[4,rl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zc=new Jh(n,r)}var Kh,Hh,Qh,me=(nl.prototype.rc=function(){return 1===this.state||2===this.state||4===this.state},nl.prototype.oc=function(){return 2===this.state},nl.prototype.start=function(){3!==this.state?this.auth():this.ac()},nl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.rc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},nl.prototype.cc=function(){this.state=0,this.Ps.reset()},nl.prototype.uc=function(){var t=this;this.oc()&&null===this.ic&&(this.ic=this.ln.Pn(this.tc,6e4,function(){return t.hc()}))},nl.prototype.lc=function(t){this._c(),this.stream.send(t)},nl.prototype.hc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oc()?[2,this.close(0)]:[2]})})},nl.prototype._c=function(){this.ic&&(this.ic.cancel(),this.ic=null)},nl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._c(),this.Ps.cancel(),this.sc++,3!==e?this.Ps.reset():n&&n.code===Fr.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.Ps.mn()):n&&n.code===Fr.UNAUTHENTICATED&&this.nc.ni(),null!==this.stream&&(this.fc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dc(n)];case 1:return t.sent(),[2]}})})},nl.prototype.fc=function(){},nl.prototype.auth=function(){var n=this;this.state=1;var t=this.wc(this.sc),e=this.sc;this.nc.getToken().then(function(t){n.sc===e&&n.Tc(t)},function(e){t(function(){var t=new qr(Fr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ec(t)})})},nl.prototype.Tc=function(t){var e=this,n=this.wc(this.sc);this.stream=this.Ic(t),this.stream.mc(function(){n(function(){return e.state=2,e.listener.mc()})}),this.stream.dc(function(t){n(function(){return e.Ec(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},nl.prototype.ac=function(){var t=this;this.state=4,this.Ps.An(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},nl.prototype.Ec=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},nl.prototype.wc=function(e){var n=this;return function(t){n.ln.fs(function(){return n.sc===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},nl),Wh=(n(el,Qh=me),el.prototype.Ic=function(t){return this.ec.Ac("Listen",t)},el.prototype.onMessage=function(t){this.Ps.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:xr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Ar(void 0===o||"string"==typeof o),hi.fromBase64String(o||"")):(Ar(void 0===o||o instanceof Uint8Array),hi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Fr.UNKNOWN:gi(s.code),new qr(o,s.message||"")),r=new Bi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Do(t,a.document.name),u=Ao(a.document.updateTime),s=new Rs({mapValue:{fields:a.document.fields}}),u=new zs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Fi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Do(t,a.document),c=a.readTime?Ao(a.readTime):Gr.min(),c=new Ks(u,c),a=a.removedTargetIds||[];r=new Fi([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Do(t,c.document),c=c.removedTargetIds||[];r=new Fi([],c,h,null)}else{if(!("filter"in e))return xr();e.filter,(h=e.filter).targetId,e=new fi(e=h.count||0),h=h.targetId,r=new qi(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Gr.min():Ao(e.readTime);return this.listener.Rc(n,t)},el.prototype.Pc=function(t){var e,n,r,i,o={};o.database=Lo(this.serializer),o.addTarget=(e=this.serializer,(r=ci(r=(n=t).target)?{documents:jo(e,r)}:{query:Fo(e,r)}).targetId=n.targetId,0<n.resumeToken.X()?r.resumeToken=xo(e,n.resumeToken):0<n.et.A(Gr.min())&&(r.readTime=No(e,n.et.P())),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.lc(o)},el.prototype.gc=function(t){var e={};e.database=Lo(this.serializer),e.removeTarget=t,this.lc(e)},el),Yh=(n(tl,Hh=me),Object.defineProperty(tl.prototype,"yc",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),tl.prototype.start=function(){this.Vc=!1,this.lastStreamToken=void 0,Hh.prototype.start.call(this)},tl.prototype.fc=function(){this.Vc&&this.vc([])},tl.prototype.Ic=function(t){return this.ec.Ac("Write",t)},tl.prototype.onMessage=function(t){if(Ar(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vc){this.Ps.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Ar(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ao(e.updateTime):Ao(n)).isEqual(Gr.min())&&(t=Ao(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ps(t,n);var e,n})):[]),n=Ao(t.commitTime);return this.listener.bc(n,e)}var r;return Ar(!t.writeResults||0===t.writeResults.length),this.Vc=!0,this.listener.Sc()},tl.prototype.Dc=function(){var t={};t.database=Lo(this.serializer),this.lc(t)},tl.prototype.vc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Mo(e.serializer,t)})};this.lc(t)},tl),Xh=(n(Zh,Kh=function(){}),Zh.prototype.Nc=function(){if(this.Cc)throw new qr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},Zh.prototype.xc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.xc(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.ni(),t})},Zh.prototype.Fc=function(e,n,r){var i=this;return this.Nc(),this.credentials.getToken().then(function(t){return i.ec.Fc(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.ni(),t})},Zh.prototype.terminate=function(){this.Cc=!1},Zh),Jh=($h.prototype.Lc=function(){var t=this;0===this.Mc&&(this.Bc("Unknown"),this.kc=this.rs.Pn("online_state_timeout",1e4,function(){return t.kc=null,t.qc("Backend didn't respond within 10 seconds."),t.Bc("Offline"),Promise.resolve()}))},$h.prototype.Uc=function(t){"Online"===this.state?this.Bc("Unknown"):(this.Mc++,1<=this.Mc&&(this.Qc(),this.qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Bc("Offline")))},$h.prototype.set=function(t){this.Qc(),this.Mc=0,"Online"===t&&(this.$c=!1),this.Bc(t)},$h.prototype.Bc=function(t){t!==this.state&&(this.state=t,this.Oc(t))},$h.prototype.qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.$c?(Ir(t),this.$c=!1):Er("OnlineStateTracker",t)},$h.prototype.Qc=function(){null!==this.kc&&(this.kc.cancel(),this.kc=null)},$h);function $h(t,e){this.rs=t,this.Oc=e,this.state="Unknown",this.Mc=0,this.kc=null,this.$c=!0}function Zh(t,e,n){var r=this;return(r=Kh.call(this)||this).credentials=t,r.ec=e,r.serializer=n,r.Cc=!1,r}function tl(t,e,n,r,i){var o=this;return(o=Hh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vc=!1,o}function el(t,e,n,r,i){var o=this;return(o=Qh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function nl(t,e,n,r,i,o){this.ln=t,this.tc=n,this.ec=r,this.nc=i,this.listener=o,this.state=0,this.sc=0,this.ic=null,this.stream=null,this.Ps=new Hu(t,e)}function rl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ll(r))return[3,4];e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function il(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ol(t,e){t.zc.has(e.targetId)||(t.zc.set(e.targetId,e),hl(t)?cl(t):wl(t).oc()&&ul(t,e))}function sl(t,e){var n=t,t=wl(n);n.zc.delete(e),t.oc()&&al(n,e),0===n.zc.size&&(t.oc()?t.uc():ll(n)&&n.Zc.set("Unknown"))}function ul(t,e){t.tu.Ie(e.targetId),wl(t).Pc(e)}function al(t,e){t.tu.Ie(e),wl(t).gc(e)}function cl(e){e.tu=new zi({Be:function(t){return e.jc.Be(t)},qe:function(t){return e.zc.get(t)||null}}),wl(e).start(),e.Zc.Lc()}function hl(t){return ll(t)&&!wl(t).rc()&&0<t.zc.size}function ll(t){return 0===t.Hc.size}function fl(t){t.tu=void 0}function pl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!na(r))throw r;return n.Hc.add(1),[4,il(n)];case 1:return t.sent(),n.Zc.set("Offline"),i=i||function(){return Mh(n.Kc)},n.rs.Ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hc.delete(1),[4,rl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function dl(e,n){return n().catch(function(t){return pl(e,t,n)})}function yl(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=bl(o=c),u=0<o.Gc.length?o.Gc[o.Gc.length-1].batchId:-1,t.label=1;case 1:if(!(ll(o)&&o.Gc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Kc,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.xi.Gr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Gc.length&&s.uc(),[3,7]):(u=a.batchId,e=a,(n=o).Gc.push(e),(n=bl(n)).oc()&&n.yc&&n.vc(e.mutations),[3,6]);case 4:return a=t.sent(),[4,pl(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return vl(o)&&gl(o),[2]}var e,n,r,i})})}function vl(t){return ll(t)&&!bl(t).rc()&&0<t.Gc.length}function gl(t){bl(t).start()}function ml(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hc.delete(2),[4,rl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hc.add(2),[4,il(e)]);case 3:t.sent(),e.Zc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function wl(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.Wc,e=n.rs,r={mc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zc.forEach(function(t,e){ul(n,t)}),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return fl(e),hl(e)?(e.Zc.Uc(n),cl(e)):e.Zc.set("Unknown"),[2]})})}.bind(null,n),Rc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zc.set("Online"),!(u instanceof Bi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zc.has(i)?[4,o.jc.eu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zc.delete(i),o.tu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,pl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Fi?s.tu.pe(u):u instanceof qi?s.tu.Fe(u):s.tu.Se(u),a.isEqual(Gr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Mh(s.Kc)];case 8:return o=t.sent(),0<=a.A(o)?[4,(i=a,(e=(r=s).tu.ke(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.X()&&(n=r.zc.get(e))&&r.zc.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.zc.get(t);e&&(r.zc.set(t,e.st(hi.Z,e.et)),al(r,t),e=new di(e.target,t,1,e.sequenceNumber),ul(r,e))}),r.jc.nu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,pl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Nc(),new Wh(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.cc(),hl(n)?cl(n):n.Zc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ru.stop()];case 2:t.sent(),fl(n),t.label=3;case 3:return[2]}})})})),n.ru}function bl(n){var t,e,r,i=this;return n.ou||(n.ou=(t=n.Wc,e=n.rs,r={mc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return bl(e).Dc(),[2]})})}.bind(null,n),dc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&bl(e).yc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return vi(n=i.code)&&n!==Fr.ABORTED?(e=r.Gc.shift(),bl(r).cc(),[4,dl(r,function(){return r.jc.iu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,yl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return vl(e)&&gl(e),[2]}})})}.bind(null,n),Sc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=bl(o),n=0,r=o.Gc;n<r.length;n++)i=r[n],e.vc(i.mutations);return[2]})})}.bind(null,n),bc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Gc.shift(),n=Pa.from(e,i,o),[4,dl(r,function(){return r.jc.su(n)})];case 1:return t.sent(),[4,yl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Nc(),new Yh(e,t.ec,t.credentials,t.serializer,r)),n.Jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ou.cc(),[4,yl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ou.stop()];case 3:t.sent(),0<n.Gc.length&&(Er("RemoteStore","Stopping write stream with "+n.Gc.length+" pending writes"),n.Gc=[]),t.label=4;case 4:return[2]}})})})),n.ou}var _l=(Tl.prototype.T=function(){return this.au.T()},Tl.prototype.Qo=function(t,e){e=new El(t,e),this.au=this.au.add(e),this.uu=this.uu.add(e)},Tl.prototype.lu=function(t,e){var n=this;t.forEach(function(t){return n.Qo(t,e)})},Tl.prototype.Wo=function(t,e){this._u(new El(t,e))},Tl.prototype.fu=function(t,e){var n=this;t.forEach(function(t){return n.Wo(t,e)})},Tl.prototype.du=function(t){var e=this,n=new Qr(new zr([])),r=new El(n,t),t=new El(n,t+1),i=[];return this.uu.Nt([r,t],function(t){e._u(t),i.push(t.key)}),i},Tl.prototype.wu=function(){var e=this;this.au.forEach(function(t){return e._u(t)})},Tl.prototype._u=function(t){this.au=this.au.delete(t),this.uu=this.uu.delete(t)},Tl.prototype.Tu=function(t){var e=new Qr(new zr([])),n=new El(e,t),t=new El(e,t+1),r=Ci();return this.uu.Nt([n,t],function(t){r=r.add(t.key)}),r},Tl.prototype.so=function(t){var e=new El(t,0);return null!==(e=this.au.Ft(e))&&t.isEqual(e.key)},Tl),El=(Il.cu=function(t,e){return Qr.V(t.key,e.key)||kr(t.Eu,e.Eu)},Il.hu=function(t,e){return kr(t.Eu,e.Eu)||Qr.V(t.key,e.key)},Il);function Il(t,e){this.key=t,this.Eu=e}function Tl(){this.au=new Ni(El.cu),this.uu=new Ni(El.hu)}function Nl(t,e){return"firestore_clients_"+t+"_"+e}function xl(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Js()&&(n+="_"+e.uid),n}function Al(t,e){return"firestore_targets_"+t+"_"+e}var Sl=(Yl.Iu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new qr(r.error.code,r.error.message)),i?new Yl(t,e,r.state,o):(Ir("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Yl.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Yl),Ol=(Wl.Iu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new qr(n.error.code,n.error.message)),r?new Wl(t,n.state,i):(Ir("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Wl.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Wl),kl=(Ql.Iu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Li,o=0;r&&o<n.activeTargetIds.length;++o)r=ii(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Ql(t,i):(Ir("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Ql),Dl=(Hl.Iu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Hl(e.clientId,e.onlineState):(Ir("SharedClientState","Failed to parse online state: "+t),null)},Hl),Pl=(Kl.prototype.Au=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Kl.prototype.Ru=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Kl.prototype.mu=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},Kl),Cl=(zl.kn=function(t){return!(!t||!t.localStorage)},zl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.gu.Ca()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pu&&(i=this.getItem(Nl(this.persistenceKey,r)))&&(o=kl.Iu(r,i))&&(this.pu=this.pu.rt(o.clientId,o));for(this.Ou(),(s=this.storage.getItem(this.xu))&&(u=this.Mu(s))&&this.ku(u),a=0,c=this.vu;a<c.length;a++)h=c[a],this.yu(h);return this.vu=[],this.window.addEventListener("unload",function(){return l.pa()}),this.yr=!0,[2]}})})},zl.prototype.er=function(t){this.setItem(this.Su,JSON.stringify(t))},zl.prototype.$u=function(){return this.Lu(this.pu)},zl.prototype.Bu=function(n){var r=!1;return this.pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},zl.prototype.qu=function(t){this.Uu(t,"pending")},zl.prototype.Qu=function(t,e,n){this.Uu(t,e,n),this.Ku(t)},zl.prototype.Wu=function(t){var e,n="not-current";return this.Bu(t)&&(!(e=this.storage.getItem(Al(this.persistenceKey,t)))||(e=Ol.Iu(t,e))&&(n=e.state)),this.ju.Au(t),this.Ou(),n},zl.prototype.Gu=function(t){this.ju.Ru(t),this.Ou()},zl.prototype.zu=function(t){return this.ju.activeTargetIds.has(t)},zl.prototype.Hu=function(t){this.removeItem(Al(this.persistenceKey,t))},zl.prototype.Ju=function(t,e,n){this.Yu(t,e,n)},zl.prototype.Xu=function(t,e,n){var r=this;e.forEach(function(t){r.Ku(t)}),this.currentUser=t,n.forEach(function(t){r.qu(t)})},zl.prototype.Zu=function(t){this.th(t)},zl.prototype.eh=function(){this.nh()},zl.prototype.pa=function(){this.yr&&(this.window.removeEventListener("storage",this.Vu),this.removeItem(this.bu),this.yr=!1)},zl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Er("SharedClientState","READ",t,e),e},zl.prototype.setItem=function(t,e){Er("SharedClientState","SET",t,e),this.storage.setItem(t,e)},zl.prototype.removeItem=function(t){Er("SharedClientState","REMOVE",t),this.storage.removeItem(t)},zl.prototype.yu=function(t){var e=this,o=t;o.storageArea===this.storage&&(Er("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.bu?this.ln.Ss(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.yr){if(null!==o.key)if(this.Du.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Cu.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.ah(n)]}else if(this.Nu.test(o.key)){if(null!==o.newValue&&(r=this.uh(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xu){if(null!==o.newValue&&(i=this.Mu(o.newValue)))return[2,this.ku(i)]}else if(o.key===this.Su)(i=function(t){var e=Ka.nr;if(null!=t)try{var n=JSON.parse(t);Ar("number"==typeof n),e=n}catch(t){Ir("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Ka.nr&&this.Xi(i);else if(o.key===this.Fu)return[2,this.gu.lh()]}else this.vu.push(o);return[2]})})}):Ir("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(zl.prototype,"ju",{get:function(){return this.pu.get(this.Pu)},enumerable:!1,configurable:!0}),zl.prototype.Ou=function(){this.setItem(this.bu,this.ju.mu())},zl.prototype.Uu=function(t,e,n){n=new Sl(this.currentUser,t,e,n),t=xl(this.persistenceKey,this.currentUser,t),this.setItem(t,n.mu())},zl.prototype.Ku=function(t){t=xl(this.persistenceKey,this.currentUser,t),this.removeItem(t)},zl.prototype.th=function(t){t={clientId:this.Pu,onlineState:t},this.storage.setItem(this.xu,JSON.stringify(t))},zl.prototype.Yu=function(t,e,n){var r=Al(this.persistenceKey,t),n=new Ol(t,e,n);this.setItem(r,n.mu())},zl.prototype.nh=function(){this.setItem(this.Fu,"value-not-used")},zl.prototype.sh=function(t){return(t=this.Du.exec(t))?t[1]:null},zl.prototype.rh=function(t,e){return t=this.sh(t),kl.Iu(t,e)},zl.prototype.oh=function(t,e){var n=this.Cu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Sl.Iu(new Ia(n),t,e)},zl.prototype.uh=function(t,e){return t=this.Nu.exec(t),t=Number(t[1]),Ol.Iu(t,e)},zl.prototype.Mu=function(t){return Dl.Iu(t)},zl.prototype.ah=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.gu._h(e.batchId,e.state,e.error)]:(Er("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},zl.prototype.hh=function(t){return this.gu.fh(t.targetId,t.state,t.error)},zl.prototype.ih=function(t,e){var n=this,r=e?this.pu.rt(t,e):this.pu.remove(t),i=this.Lu(this.pu),o=this.Lu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.gu.dh(s,u).then(function(){n.pu=r})},zl.prototype.ku=function(t){this.pu.get(t.clientId)&&this.Oc(t.onlineState)},zl.prototype.Lu=function(t){var n=Li;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},zl),Ll=(Gl.prototype.qu=function(t){},Gl.prototype.Qu=function(t,e,n){},Gl.prototype.Wu=function(t){return this.wh.Au(t),this.Th[t]||"not-current"},Gl.prototype.Ju=function(t,e,n){this.Th[t]=e},Gl.prototype.Gu=function(t){this.wh.Ru(t)},Gl.prototype.zu=function(t){return this.wh.activeTargetIds.has(t)},Gl.prototype.Hu=function(t){delete this.Th[t]},Gl.prototype.$u=function(){return this.wh.activeTargetIds},Gl.prototype.Bu=function(t){return this.wh.activeTargetIds.has(t)},Gl.prototype.start=function(){return this.wh=new Pl,Promise.resolve()},Gl.prototype.Xu=function(t,e,n){},Gl.prototype.Zu=function(t){},Gl.prototype.pa=function(){},Gl.prototype.er=function(t){},Gl.prototype.eh=function(){},Gl),Rl=function(t){this.key=t},Vl=function(t){this.key=t},Ml=(Object.defineProperty(Bl.prototype,"Ph",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),Bl.prototype.gh=function(t,e){var s=this,u=e?e.Vh:new Vi,a=(e||this).Rh,c=(e||this).Qt,h=a,l=!1,f=Zs(this.query)&&a.size===this.query.limit?a.last():null,p=tu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof zs?e:null)&&(fu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.yh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Ah(r,f)||p&&s.Ah(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Zs(this.query)||tu(this.query))for(;h.size>this.query.limit;){var n=Zs(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,Vh:u,ph:l,Qt:c}},Bl.prototype.yh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Bl.prototype.bi=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.Qt=t.Qt;var i=t.Vh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],e=(n=0===this.mh.size&&this.Zt?1:0)!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Mi(this.query,t.Rh,r,i,t.Qt,0==n,e,!1),Dh:s}:{Dh:s}},Bl.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.bi({Rh:this.Rh,Vh:new Vi,Qt:this.Qt,ph:!1},!1)):{Dh:[]}},Bl.prototype.Ch=function(t){return!this.Eh.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).Je},Bl.prototype.bh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Eh=e.Eh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Eh=e.Eh.delete(t)}),this.Zt=t.Zt)},Bl.prototype.Sh=function(){var e=this;if(!this.Zt)return[];var n=this.mh;this.mh=Ci(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Vl(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Rl(t))}),r},Bl.prototype.Nh=function(t){return this.Eh=t.Xa,this.mh=Ci(),t=this.gh(t.documents),this.bi(t,!0)},Bl.prototype.xh=function(){return Mi.jt(this.query,this.Rh,this.Qt,0===this.Ih)},Bl),Ul=function(t,e,n){this.query=t,this.targetId=e,this.view=n},jl=function(t){this.key=t,this.Fh=!1},Fl=(Object.defineProperty(ql.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),ql);function ql(t,e,n,r,i,o){this.Kc=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new jr(hu,cu),this.qh=new Map,this.Uh=[],this.Qh=new mi(Qr.V),this.Kh=new Map,this.Wh=new _l,this.jh={},this.Gh=new Map,this.zh=dh.vo(),this.onlineState="Unknown",this.Hh=void 0}function Bl(t,e){this.query=t,this.Eh=e,this.Ih=null,this.Zt=!1,this.mh=Ci(),this.Qt=Ci(),this.Ah=pu(t),this.Rh=new Ri(this.Ah)}function Gl(){this.wh=new Pl,this.Th={},this.Oc=null,this.Xi=null}function zl(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.Pu=r,this.gu=null,this.Oc=null,this.Xi=null,this.Vu=this.yu.bind(this),this.pu=new mi(kr),this.yr=!1,this.vu=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.bu=Nl(this.persistenceKey,this.Pu),this.Su="firestore_sequence_number_"+this.persistenceKey,this.pu=this.pu.rt(this.Pu,new Pl),this.Du=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Cu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Nu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xu="firestore_online_state_"+this.persistenceKey,this.Fu="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Vu)}function Kl(){this.activeTargetIds=Li}function Hl(t,e){this.clientId=t,this.onlineState=e}function Ql(t,e){this.clientId=t,this.activeTargetIds=e}function Wl(t,e,n){this.targetId=t,this.state=e,this.error=n}function Yl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Xl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Fh(r.Kc,i.query,!1).then(function(t){return t=t.documents,i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.bi(e,r.Jh,n),[2,(sf(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Fh(i.Kc,o,!0)];case 1:return n=t.sent(),r=new Ml(o,n.Xa),e=r.gh(n.documents),n=ji.Xt(s,u&&"Offline"!==i.onlineState),n=r.bi(e,i.Jh,n),sf(i,s,n.Dh),r=new Ul(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function Jl(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=ff(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Kc,a=p,h=i,l=Br.now(),o=a.reduce(function(t,e){return t.add(e.key)},Ci()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ga.Li(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ss?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof zs?t.field(i.field):void 0;null!=(o=Qo(i.transform,o||null))&&(e=(null==e?new Vs:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new Is(i.key,o,function s(t){var u=[];return Lr(t.fields||{},function(t,e){var n=new Hr([t]);if(mo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new hs(u)}(o.proto.mapValue),ds.exists(!0)))}return h.xi.Qr(u,l,e,a)})}).then(function(t){var e=t.wi(c);return{batchId:t.batchId,Ii:e}}))];case 2:return s=t.sent(),u.kh.qu(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.Ys()])||new mi(kr)).rt(n,r),e.jh[e.currentUser.Ys()]=i,[4,af(u,s.Ii)];case 3:return t.sent(),[4,yl(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}function $l(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kc,h=e,l=(o=s).et,f=h.Qa,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.ja._o({fo:!0});f=h.Qa;var u=[];o.Gt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(h.ra.Ko(s,t.ne,e).next(function(){return h.ra.Uo(s,t.te,e)})),0<(i=t.resumeToken).X()&&(n=o.st(i,l).nt(s.Go),f=f.rt(e,n),r=o,i=t,Ar(0<(o=n).resumeToken.X()),(0===r.resumeToken.X()||3e8<=o.et.R()-r.et.R()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(h.ra.ko(s,n))))});var e,a,n,c,r,i=Ai;return o.Ht.forEach(function(t,e){o.Jt.has(t)&&u.push(h.persistence.Lr.qa(s,t))}),u.push((e=s,a=t,n=o.Ht,c=l,r=Ci(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Ai;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof Ks&&e.version.isEqual(Gr.min())?(a.Vi(t,r),o=o.rt(t,e)):null==n||0<e.version.A(n.version)||0===e.version.A(n.version)&&n.hasPendingWrites?(a.Ri(e,r),o=o.rt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Gr.min())||(e=h.ra.Co(s).next(function(t){return h.ra.xo(s,s.Go,l)}),u.push(e)),Qu.xn(u).next(function(){return t.apply(s)}).next(function(){return h.Ga.Bi(s,i)})}).then(function(t){return h.Qa=f,t}))];case 2:return r=t.sent(),s.Gt.forEach(function(t,e){(e=n.Kh.get(e))&&(Ar(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Fh=!0:0<t.ee.size?Ar(e.Fh):0<t.ne.size&&(Ar(e.Fh),e.Fh=!1))}),[4,af(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,h,l,f})})}function Zl(t,n,e){var r;((t=t).Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){(e=e.view.Bs(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Bs(i)&&(o=!0)}),o&&_a(t)}(t.Mh,n),r.length&&t.Lh.Rc(r),t.onlineState=n,t.Jh&&t.kh.Zu(n))}function tf(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ll((n=o).Oh)||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Kc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.xi.zr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function ef(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function nf(t,e,n){var r=t,i=r.jh[r.currentUser.Ys()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.Ys()]=i)}function rf(e,t,n){void 0===n&&(n=null),e.kh.Gu(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.du(t).forEach(function(t){e.Wh.so(t)||of(e,t)})}function of(t,e){var n=t.Qh.get(e);null!==n&&(sl(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),uf(t))}function sf(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Rl?(t.Wh.Qo(u.key,e),r=t,i=(i=u).key,r.Qh.get(i)||(Er("SyncEngine","New document in limbo: "+i),r.Uh.push(i),uf(r))):u instanceof Vl?(Er("SyncEngine","Document no longer in limbo: "+u.key),t.Wh.Wo(u.key,e),t.Wh.so(u.key)||of(t,u.key)):xr()}}function uf(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new jl(e)),t.Qh=t.Qh.rt(e,n),ol(t.Oh,new di(ou($s(e.path)),n,2,Ka.nr))}}function af(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.T()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ju(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=za.Yi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.Rc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Qu.forEach(c,function(e){return Qu.forEach(e.Hi,function(t){return r.persistence.Lr.Qo(n,e.targetId,t)}).next(function(){return Qu.forEach(e.Ji,function(t){return r.persistence.Lr.Wo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!na(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Qa.get(o),u=s.et,u=s.it(u),r.Qa=r.Qa.rt(o,u));return[2]}})})}(n.Kc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function cf(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,Uh(e.Kc,ou(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.Bh.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Fh((e=r).Kc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&sf(e,i.targetId,n.Dh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,qh(e.Kc,s)];case 8:return f=t.sent(),[4,Uh(e.Kc,f)];case 9:return u=t.sent(),[4,Xl(e,hf(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.Rc(r),n)]}})})}function hf(t){return Js(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function lf(t){return t.Oh.jc.nu=$l.bind(null,t),t.Oh.jc.Be=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Ci().add(t.key);var r=Ci();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Ot(s.view.Ph);return r}.bind(null,t),t.Oh.jc.eu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ju(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new mi(Qr.V)).rt(n,new Ks(n,Gr.min())),i=Ci().add(n),i=new Ui(Gr.min(),new Map,new Ni(kr),r,i),[4,$l(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),uf(e),[3,4];case 2:return[4,jh(e.Kc,s,!1).then(function(){return rf(e,s,u)}).catch(Gh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.Rc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.ks=s}}r&&_a(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function ff(t){return t.Oh.jc.su=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kc,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.ja._o({fo:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Qu.resolve();return a.forEach(function(n){c=c.next(function(){return s.yi(o,n)}).next(function(t){var e=t;Ar(null!==(t=r.Ei.get(n))),(!e||e.version.A(t)<0)&&(e=u._i(n,e,r))&&s.Ri(e,r.Ti)})}),c.next(function(){return i.xi.Yr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.xi.no(t)}).next(function(){return l.Ga.Li(t,e)})}))];case 2:return i=t.sent(),nf(n,r,null),ef(n,r),n.kh.Qu(r,"acknowledged"),[4,af(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,t),t.Oh.jc.iu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.xi.Wr(e,r).next(function(t){return Ar(null!==t),n=t.keys(),i.xi.Yr(e,t)}).next(function(){return i.xi.no(e)}).next(function(){return i.Ga.Li(e,n)})}))];case 2:return o=t.sent(),nf(n,u,a),ef(n,u),n.kh.Qu(u,"rejected",a),[4,af(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var pf,df,yf,vf,gf,mf=(np.prototype.za=function(t){this.Zh=t},np.prototype.Ui=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.B())||i.isEqual(Gr.min())?this.tl(e,r):this.Zh.Li(e,o).next(function(t){var n=s.el(r,t);return(Zs(r)||tu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(_r()<=f.DEBUG&&Er("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lu(r)),s.Zh.Ui(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},np.prototype.el=function(n,t){var r=new Ni(pu(n));return t.forEach(function(t,e){e instanceof zs&&fu(n,e)&&(r=r.add(e))}),r},np.prototype.ph=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.A(r))},np.prototype.tl=function(t,e){return _r()<=f.DEBUG&&Er("IndexFreeQueryEngine","Using full collection scan to execute query:",lu(e)),this.Zh.Ui(t,e,Gr.min())},np),wf=(ep.prototype.Ur=function(t){return Qu.resolve(0===this.xi.length)},ep.prototype.Qr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.xi.length&&this.xi[this.xi.length-1],n=new Da(i,e,n,r),this.xi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new El(u.key,i)),this.Fi.Kr(t,u.key.path.S())}return Qu.resolve(n)},ep.prototype.Wr=function(t,e){return Qu.resolve(this.il(e))},ep.prototype.Gr=function(t,e){return e+=1,e=(e=this.rl(e))<0?0:e,Qu.resolve(this.xi.length>e?this.xi[e]:null)},ep.prototype.zr=function(){return Qu.resolve(0===this.xi.length?-1:this.nl-1)},ep.prototype.Hr=function(t){return Qu.resolve(this.xi.slice())},ep.prototype.Mi=function(t,e){var n=this,r=new El(e,0),e=new El(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Nt([r,e],function(t){t=n.il(t.Eu),i.push(t)}),Qu.resolve(i)},ep.prototype.qi=function(t,e){var n=this,r=new Ni(kr);return e.forEach(function(t){var e=new El(t,0),t=new El(t,Number.POSITIVE_INFINITY);n.sl.Nt([e,t],function(t){r=r.add(t.Eu)})}),Qu.resolve(this.ol(r))},ep.prototype.Gi=function(t,e){var n=e.path,r=n.length+1,e=n;Qr.G(e)||(e=e.child(""));var e=new El(new Qr(e),0),i=new Ni(kr);return this.sl.xt(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(i=i.add(t.Eu)),!0)},e),Qu.resolve(this.ol(i))},ep.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.il(t))&&n.push(t)}),n},ep.prototype.Yr=function(n,r){var i=this;Ar(0===this.al(r.batchId,"removed")),this.xi.shift();var o=this.sl;return Qu.forEach(r.mutations,function(t){var e=new El(t.key,r.batchId);return o=o.delete(e),i.Lr.eo(n,t.key)}).next(function(){i.sl=o})},ep.prototype.Zr=function(t){},ep.prototype.so=function(t,e){var n=new El(e,0),n=this.sl.Ft(n);return Qu.resolve(e.isEqual(n&&n.key))},ep.prototype.no=function(t){return this.xi.length,Qu.resolve()},ep.prototype.al=function(t,e){return this.rl(t)},ep.prototype.rl=function(t){return 0===this.xi.length?0:t-this.xi[0].batchId},ep.prototype.il=function(t){return(t=this.rl(t))<0||t>=this.xi.length?null:this.xi[t]},ep),bf=(tp.prototype.Ri=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.cl(e);return this.docs=this.docs.rt(r,{gi:e,size:o,readTime:n}),this.size+=o-i,this.Fi.Kr(t,r.path.S())},tp.prototype.Vi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},tp.prototype.yi=function(t,e){return e=this.docs.get(e),Qu.resolve(e?e.gi:null)},tp.prototype.getEntries=function(t,e){var n=this,r=Ai;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.gi:null)}),Qu.resolve(r)},tp.prototype.Ui=function(t,e,n){for(var r=ki,i=new Qr(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Et()).key,u=(a=u.value).gi,a=a.readTime;if(!e.path.N(s.path))break;a.A(n)<=0||u instanceof zs&&fu(e,u)&&(r=r.rt(u.key,u))}return Qu.resolve(r)},tp.prototype.ul=function(t,e){return Qu.forEach(this.docs,function(t){return e(t)})},tp.prototype._o=function(t){return new _f(this)},tp.prototype.wo=function(t){return Qu.resolve(this.size)},tp),_f=(n(Zf,gf=h),Zf.prototype.bi=function(n){var r=this,i=[];return this.Ii.forEach(function(t,e){e&&e.gi?i.push(r.To.Ri(n,e.gi,r.Ai(t))):r.To.Vi(t)}),Qu.xn(i)},Zf.prototype.pi=function(t,e){return this.To.yi(t,e)},Zf.prototype.vi=function(t,e){return this.To.getEntries(t,e)},Zf),Ef=($f.prototype.De=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),Qu.resolve()},$f.prototype.Co=function(t){return Qu.resolve(this.lastRemoteSnapshotVersion)},$f.prototype.No=function(t){return Qu.resolve(this.ll)},$f.prototype.bo=function(t){return this.highestTargetId=this.fl.next(),Qu.resolve(this.highestTargetId)},$f.prototype.xo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Qu.resolve()},$f.prototype.Oo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new dh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},$f.prototype.Fo=function(t,e){return this.Oo(e),this.targetCount+=1,Qu.resolve()},$f.prototype.ko=function(t,e){return this.Oo(e),Qu.resolve()},$f.prototype.$o=function(t,e){return this.hl.delete(e.target),this._l.du(e.targetId),--this.targetCount,Qu.resolve()},$f.prototype.Nr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.Lo(n,e.targetId)),s++)}),Qu.xn(u).next(function(){return s})},$f.prototype.Bo=function(t){return Qu.resolve(this.targetCount)},$f.prototype.qo=function(t,e){return e=this.hl.get(e)||null,Qu.resolve(e)},$f.prototype.Uo=function(t,e,n){return this._l.lu(e,n),Qu.resolve()},$f.prototype.Ko=function(e,t,n){this._l.fu(t,n);var r=this.persistence.Lr,i=[];return r&&t.forEach(function(t){i.push(r.eo(e,t))}),Qu.xn(i)},$f.prototype.Lo=function(t,e){return this._l.du(e),Qu.resolve()},$f.prototype.jo=function(t,e){return e=this._l.Tu(e),Qu.resolve(e)},$f.prototype.so=function(t,e){return Qu.resolve(this._l.so(e))},$f),If=(Jf.prototype.mo=function(t,e){return Qu.resolve(this.dl.get(e))},Jf.prototype.Ao=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Ao(e.createTime)}),Qu.resolve()},Jf.prototype.Ro=function(t,e){return Qu.resolve(this.wl.get(e))},Jf.prototype.Po=function(t,e){return this.wl.set(e.name,{name:e.name,query:wc(e.bundledQuery),readTime:Ao(e.readTime)}),Qu.resolve()},Jf),Tf=(Xf.prototype.start=function(){return Promise.resolve()},Xf.prototype.pa=function(){return this.Yo=!1,Promise.resolve()},Object.defineProperty(Xf.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Xf.prototype.fa=function(){},Xf.prototype.da=function(){},Xf.prototype.Oa=function(){return this.Fi},Xf.prototype.Na=function(t){var e=this.Tl[t.Ys()];return e||(e=new wf(this.Fi,this.Lr),this.Tl[t.Ys()]=e),e},Xf.prototype.xa=function(){return this.ra},Xf.prototype.Fa=function(){return this.Ni},Xf.prototype.Ma=function(){return this.oa},Xf.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new Nf(this.Jo.next());return this.Lr.Il(),n(i).next(function(t){return r.Lr.ml(i).next(function(){return t})}).Cn().then(function(t){return i.Ci(),t})},Xf.prototype.Al=function(e,n){return Qu.Fn(Object.values(this.Tl).map(function(t){return function(){return t.so(e,n)}}))},Xf),Nf=(n(Yf,vf=ge),Yf),xf=(Wf.gl=function(t){return new Wf(t)},Object.defineProperty(Wf.prototype,"Vl",{get:function(){if(this.Pl)return this.Pl;throw xr()},enumerable:!1,configurable:!0}),Wf.prototype.Qo=function(t,e,n){return this.Rl.Qo(n,e),this.Vl.delete(n.toString()),Qu.resolve()},Wf.prototype.Wo=function(t,e,n){return this.Rl.Wo(n,e),this.Vl.add(n.toString()),Qu.resolve()},Wf.prototype.eo=function(t,e){return this.Vl.add(e.toString()),Qu.resolve()},Wf.prototype.removeTarget=function(t,e){var n=this;this.Rl.du(e.targetId).forEach(function(t){return n.Vl.add(t.toString())});var r=this.persistence.xa();return r.jo(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vl.add(t.toString())})}).next(function(){return r.$o(t,e)})},Wf.prototype.Il=function(){this.Pl=new Set},Wf.prototype.ml=function(n){var r=this,i=this.persistence.Fa()._o();return Qu.forEach(this.Vl,function(t){var e=Qr.K(t);return r.yl(n,e).next(function(t){t||i.Vi(e)})}).next(function(){return r.Pl=null,i.apply(n)})},Wf.prototype.qa=function(t,e){var n=this;return this.yl(t,e).next(function(t){t?n.Vl.delete(e.toString()):n.Vl.add(e.toString())})},Wf.prototype.El=function(t){return 0},Wf.prototype.yl=function(t,e){var n=this;return Qu.Fn([function(){return Qu.resolve(n.Rl.so(e))},function(){return n.persistence.xa().so(t,e)},function(){return n.persistence.Al(t,e)}])},Wf),Af=(Qf.prototype.mc=function(t){this.bl=t},Qf.prototype.dc=function(t){this.Sl=t},Qf.prototype.onMessage=function(t){this.Dl=t},Qf.prototype.close=function(){this.vl()},Qf.prototype.send=function(t){this.pl(t)},Qf.prototype.Cl=function(){this.bl()},Qf.prototype.Nl=function(t){this.Sl(t)},Qf.prototype.xl=function(t){this.Dl(t)},Qf),Sf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Of=(Hf.prototype.xc=function(e,t,n,r){var i=this.kl(e,t);return Er("RestConnection","Sending: ",i,n),t={},this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Er("RestConnection","Received: ",t),t},function(t){throw Tr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Hf.prototype.Fc=function(t,e,n,r){return this.xc(t,e,n,r)},Hf.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2-20201012233953",t["Content-Type"]="text/plain",e)for(var n in e.ti)e.ti.hasOwnProperty(n)&&(t[n]=e.ti[n])},Hf.prototype.kl=function(t,e){return t=Sf[t],this.Ol+"/v1/"+e+":"+t},n(Kf,yf=Hf),Kf.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Er("Connection",'RPC "'+o+'" timed out'),r(new qr(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Er("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Fr).indexOf(e)?e:Fr.UNKNOWN,r(new qr(e,t.message))):r(new qr(Fr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new qr(Fr.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{Er("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Kf.prototype.Ac=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Er("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Af({pl:function(t){u?Er("Connection","Not sending because WebChannel is closed:",t):(s||(Er("Connection","Opening WebChannel transport."),o.open(),s=!0),Er("Connection","WebChannel sending:",t),o.send(t))},vl:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Er("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Er("Connection","WebChannel transport closed"),a.Nl())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Tr("Connection","WebChannel transport errored:",t),a.Nl(new qr(Fr.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Ar(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Er("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=pi[r];if(void 0!==t)return gi(t)}(),i=n.message,void 0===t&&(t=Fr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Nl(new qr(t,i)),o.close()):(Er("Connection","WebChannel received:",e),a.xl(e)))}),setTimeout(function(){a.Cl()},0),a},Kf),kf=(zf.prototype.Xc=function(t){this.Kl.push(t)},zf.prototype.pa=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},zf.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},zf.prototype.ql=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},zf.prototype.Ql=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},zf.kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},zf),Df=(Gf.prototype.Xc=function(t){},Gf.prototype.pa=function(){},Gf),Pf=(Bf.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Fa(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Kc=this.Jl(e),[2]}})})},Bf.prototype.Hl=function(t){return null},Bf.prototype.Jl=function(t){return Rh(this.persistence,new mf,t.Yl,this.serializer)},Bf.prototype.Gl=function(t){return new Tf(xf.gl,this.serializer)},Bf.prototype.jl=function(t){return new Ll},Bf.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.pa()];case 1:return t.sent(),[4,this.persistence.pa()];case 2:return t.sent(),[2]}})})},Bf),Cf=(n(qf,df=Pf),qf.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,df.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Cc(t),r=Gr.min(),t.ns({index:Xc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=pc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Wa=t})]})})}(this.Kc)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,ff(this.Xl.gu)];case 4:return t.sent(),[4,yl(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},qf.prototype.Jl=function(t){return Rh(this.persistence,new mf,t.Yl,this.serializer)},qf.prototype.Hl=function(t){var e=this.persistence.Lr.Rr;return new nc(e,t.rs)},qf.prototype.Gl=function(t){var e=Ph(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Za.Tr(this.cacheSizeBytes):Za.mr;return new Th(this.synchronizeTabs,e,t.clientId,n,t.rs,ha(),la(),this.serializer,this.kh,!!this.forceOwnership)},qf.prototype.jl=function(t){return new Ll},qf),Lf=(n(Ff,pf=Cf),Ff.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,pf.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.gu,this.kh instanceof Cl?(this.kh.gu={_h:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Kc,n=a,i=(r=e).xi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.jr(e,n).next(function(t){return t?r.Ga.Li(e,t):Qu.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,yl(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(nf(o,a,h||null),ef(o,a),o.Kc.xi.Zr(a)):xr(),t.label=4;case 4:return[4,af(o,s)];case 5:return t.sent(),[3,7];case 6:Er("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Er("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Bh(e.Kc)];case 3:return n=t.sent(),r=Ui.Yt(o,"current"===s),[4,af(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,jh(e.Kc,o,!0)];case 6:return t.sent(),rf(e,o,u),[3,8];case 7:xr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=lf(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Er("SyncEngine","Adding an already active target "+r),[3,5]):[4,qh(n.Kc,r)]):[3,6];case 2:return i=t.sent(),[4,Uh(n.Kc,i)];case 3:return o=t.sent(),[4,Xl(n,hf(i),o.targetId,!1)];case 4:t.sent(),ol(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,jh(n.Kc,e,!1).then(function(){sl(n.Oh,e),rf(n,e)}).catch(Gh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ca:function(t){return t.Kc.persistence.Ca()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Bh((e=n).Kc).then(function(t){return af(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence._a(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return lf(r=h),ff(r),!0!==l||!0===r.Hh?[3,3]:(e=r.kh.$u(),[4,cf(r,e.O())]);case 1:return i=t.sent(),r.Hh=!0,[4,ml(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],ol(r.Oh,u);return[3,7];case 3:return!1!==l||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.zu(e)?a.push(e):c=c.then(function(){return rf(r,e),jh(r.Kc,e,!0)}),sl(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,cf(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){sl(n.Oh,e)}),n.Wh.wu(),n.Kh=new Map,n.Qh=new mi(Qr.V),r.Hh=!1,[4,ml(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Xl.gu,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.yr?this.zl.start(this.Kc):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Ff.prototype.jl=function(t){var e=ha();if(!Cl.kn(e))throw new qr(Fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ph(t.Fl.t,t.Fl.persistenceKey);return new Cl(e,t.rs,n,t.clientId,t.Yl)},Ff),Rf=(jf.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Kc?[3,2]:(this.Kc=n.Kc,this.kh=n.kh,this.Wc=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.gu=this.n_(r,!n.synchronizeTabs),this.kh.Oc=function(t){return Zl(e.gu,t,1)},this.Oh.jc.s_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Er("SyncEngine","User change. New user:",o.Ys()),[4,Vh(n.Kc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new qr(Fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xu(o,r.Ja,r.Ya),[4,af(n,r.Ha)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.gu),[4,ml(this.Oh,this.gu.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},jf.prototype.e_=function(t){return new ga},jf.prototype.Zl=function(t){var e=Fa(t.Fl.t),n=(n=t.Fl,new Of(n));return t=t.credentials,new Xh(t,n,e)},jf.prototype.t_=function(t){var e=this;return new zh(this.Kc,this.Wc,t.rs,function(t){return Zl(e.gu,t,0)},t=new(kf.kn()?kf:Df))},jf.prototype.n_=function(t,e){return n=this.Kc,r=this.Oh,i=this.Mh,o=this.kh,s=t.Yl,t=t.$h,e=e,t=new Fl(n,r,i,o,s,t),e&&(t.Hh=!0),t;var n,r,i,o,s},jf.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Er("RemoteStore","RemoteStore shutting down."),e.Hc.add(5),[4,il(e)];case 1:return t.sent(),e.Yc.pa(),e.Zc.set("Unknown"),[2]}})})}(this.Oh)},jf),Vf=(Uf.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Uf.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Uf.prototype.r_=function(){this.muted=!0},Uf.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Uf),Mf=function(t){this.o_=t};function Uf(t){this.observer=t,this.muted=!1}function jf(){}function Ff(t,e){var n=this;return(n=pf.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function qf(t,e,n){var r=this;return(r=df.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Bf(){this.synchronizeTabs=!1}function Gf(){}function zf(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function Kf(t){var e=this;return(e=yf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Hf(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Qf(t){this.pl=t.pl,this.vl=t.vl}function Wf(t){this.persistence=t,this.Rl=new _l,this.Pl=null}function Yf(t){var e=this;return(e=vf.call(this)||this).Go=t,e}function Xf(t,e){var n=this;this.Tl={},this.Jo=new Ka(0),this.Yo=!1,this.Yo=!0,this.Lr=t(this),this.ra=new Ef(this),this.Fi=new Vc,this.Ni=(t=this.Fi,new bf(t,function(t){return n.Lr.El(t)})),this.serializer=new cc(e),this.oa=new If(this.serializer)}function Jf(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function $f(t){this.persistence=t,this.hl=new jr(ui,ai),this.lastRemoteSnapshotVersion=Gr.min(),this.highestTargetId=0,this.ll=0,this._l=new _l,this.targetCount=0,this.fl=dh.po()}function Zf(t){var e=this;return(e=gf.call(this)||this).To=t,e}function tp(t,e){this.Fi=t,this.cl=e,this.docs=new mi(Qr.V),this.size=0}function ep(t,e){this.Fi=t,this.Lr=e,this.xi=[],this.nl=1,this.sl=new Ni(El.cu)}function np(){}function rp(t,e,n){if(!n)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function ip(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function op(t,e,n,r){if(!0===e&&!0===r)throw new qr(Fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function sp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function up(t,e){if(t instanceof Mf&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new qr(Fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=sp(t),new qr(Fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function ap(t,e){if(e<=0)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var cp,hp=function(t){this.a_=t},lp=(n(fp,cp=hp),fp.prototype.c_=function(t){if(2!==t.u_)throw 1===t.u_?t.h_(this.a_+"() can only appear at the top level of your update data"):t.h_(this.a_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},fp.prototype.isEqual=function(t){return t instanceof fp},fp);function fp(){return null!==cp&&cp.apply(this,arguments)||this}function pp(t,e,n){return new cd({u_:3,l_:e.settings.l_,methodName:t.a_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var dp,yp,vp,gp,mp=(n(Pp,gp=hp),Pp.prototype.c_=function(t){return new ls(t.path,new Xo)},Pp.prototype.isEqual=function(t){return t instanceof Pp},Pp),wp=(n(Dp,vp=hp),Dp.prototype.c_=function(t){var e=pp(this,t,!0),n=this.f_.map(function(t){return gd(t,e)}),n=new Jo(n);return new ls(t.path,n)},Dp.prototype.isEqual=function(t){return this===t},Dp),bp=(n(kp,yp=hp),kp.prototype.c_=function(t){var e=pp(this,t,!0),n=this.f_.map(function(t){return gd(t,e)}),n=new ns(n);return new ls(t.path,n)},kp.prototype.isEqual=function(t){return this===t},kp),_p=(n(Op,dp=hp),Op.prototype.c_=function(t){var e=new ss(t.serializer,To(t.serializer,this.d_));return new ls(t.path,e)},Op.prototype.isEqual=function(t){return this===t},Op),Ep=(Object.defineProperty(Sp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"longitude",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Sp.prototype.isEqual=function(t){return this.w_===t.w_&&this.T_===t.T_},Sp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.T_}},Sp.prototype.I=function(t){return kr(this.w_,t.w_)||kr(this.T_,t.T_)},Sp),Ip=(Ap.fromBase64String=function(t){try{return new Ap(hi.fromBase64String(t))}catch(t){throw new qr(Fr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Ap.fromUint8Array=function(t){return new Ap(hi.fromUint8Array(t))},Ap.prototype.toBase64=function(){return this.E_.toBase64()},Ap.prototype.toUint8Array=function(){return this.E_.toUint8Array()},Ap.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ap.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},Ap),Tp=new Map,Np=(xp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},xp);function xp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qr(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qr(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,op("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Ap(t){this.E_=t}function Sp(t,e){if(!isFinite(t)||t<-90||90<t)throw new qr(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qr(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.T_=e}function Op(t,e){var n=this;return(n=dp.call(this,t)||this).d_=e,n}function kp(t,e){var n=this;return(n=yp.call(this,t)||this).f_=e,n}function Dp(t,e){var n=this;return(n=vp.call(this,t)||this).f_=e,n}function Pp(){return null!==gp&&gp.apply(this,arguments)||this}function Cp(){if("undefined"==typeof Uint8Array)throw new qr(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Lp(){if("undefined"==typeof atob)throw new qr(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Rp,Vp,Mp,Up=(n(Kp,Mp=Ip),Kp.fromBase64String=function(t){Lp();try{return new Kp(hi.fromBase64String(t))}catch(t){throw new qr(Fr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Kp.fromUint8Array=function(t){return Cp(),new Kp(hi.fromUint8Array(t))},Kp.prototype.toBase64=function(){return Lp(),Mp.prototype.toBase64.call(this)},Kp.prototype.toUint8Array=function(){return Cp(),Mp.prototype.toUint8Array.call(this)},Kp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Kp),h=(zp.prototype.I_=function(t,e){switch(void 0===e&&(e="none"),ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ho(t.integerValue||t.doubleValue);case 3:return this.m_(t.timestampValue);case 4:return this.A_(t,e);case 5:return t.stringValue;case 6:return this.R_(lo(t.bytesValue));case 7:return this.P_(t.referenceValue);case 8:return this.g_(t.geoPointValue);case 9:return this.V_(t.arrayValue,e);case 10:return this.y_(t.mapValue,e);default:throw xr()}},zp.prototype.y_=function(t,n){var r=this,i={};return Lr(t.fields||{},function(t,e){i[t]=r.I_(e,n)}),i},zp.prototype.g_=function(t){return new Ep(ho(t.latitude),ho(t.longitude))},zp.prototype.V_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.I_(t,e)})},zp.prototype.A_=function(t,e){switch(e){case"previous":var n=function t(e){return to(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.I_(n,e);case"estimate":return this.m_(eo(t));default:return null}},zp.prototype.m_=function(t){return t=co(t),new Br(t.seconds,t.nanos)},zp.prototype.p_=function(t,e){var n=zr.k(t);return Ar(Ho(n)),t=new gr(n.get(1),n.get(3)),n=new Qr(n.v(5)),t.isEqual(e)||Ir("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},zp),jp=(n(Gp,Vp=h),Gp.prototype.R_=function(t){return new Up(t)},Gp.prototype.P_=function(t){return t=this.p_(t,this.firestore.v_),by.b_(t,this.firestore,null)},Gp),ge=(Object.defineProperty(Bp.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"ref",{get:function(){return new Yp(this.S_,this.x_,this.C_)},enumerable:!1,configurable:!0}),Bp.prototype.exists=function(){return null!==this.N_},Bp.prototype.data=function(){if(this.N_){if(this.x_){var t=new Fp(this.S_,this.D_,this.C_,this.N_,null);return this.x_.fromFirestore(t)}return this.D_.I_(this.N_.sn())}},Bp.prototype.get=function(t){if(this.N_&&null!==(t=this.N_.data().field(Hp("DocumentSnapshot.get",t))))return this.D_.I_(t)},Bp),Fp=(n(qp,Rp=ge),qp.prototype.data=function(){return Rp.prototype.data.call(this)},qp);function qp(){return null!==Rp&&Rp.apply(this,arguments)||this}function Bp(t,e,n,r,i){this.S_=t,this.D_=e,this.C_=n,this.N_=r,this.x_=i}function Gp(t){var e=this;return(e=Vp.call(this)||this).firestore=t,e}function zp(){}function Kp(){return null!==Mp&&Mp.apply(this,arguments)||this}function Hp(t,e){return"string"==typeof e?Id(t,e):(e instanceof Mf?e.o_:e).F_}var Qp,Wp=(ed.prototype.isEqual=function(t){return this.F_.isEqual(t.F_)},ed),Yp=(Object.defineProperty(td.prototype,"O_",{get:function(){return this.C_.path},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"path",{get:function(){return this.C_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"parent",{get:function(){return new Jp(this.firestore,this.x_,this.C_.path.S())},enumerable:!1,configurable:!0}),td.prototype.withConverter=function(t){return new td(this.firestore,t,this.C_)},td),Xp=(Zp.prototype.withConverter=function(t){return new Zp(this.firestore,t,this.M_)},Zp),Jp=(n($p,Qp=Xp),Object.defineProperty($p.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"parent",{get:function(){var t=this.O_.S();return t.T()?null:new Yp(this.firestore,null,new Qr(t))},enumerable:!1,configurable:!0}),$p.prototype.withConverter=function(t){return new $p(this.firestore,t,this.O_)},$p);function $p(t,e,n){var r=this;return(r=Qp.call(this,t,e,$s(n))||this).firestore=t,r.O_=n,r.type="collection",r}function Zp(t,e,n){this.x_=e,this.M_=n,this.type="query",this.firestore=t}function td(t,e,n){this.x_=e,this.C_=n,this.type="document",this.firestore=t}function ed(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new Hr(t)}function nd(t){var e=t.k_(),n=Fa(t.v_);return new hd(t.v_,!!e.ignoreUndefinedProperties,n)}var rd=/^__.*__$/,id=(ud.prototype.L_=function(t,e){var n=[];return null!==this.Qe?n.push(new Is(t,this.data,this.Qe,e)):n.push(new Es(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ss(t,this.fieldTransforms)),n},ud),od=(sd.prototype.L_=function(t,e){return e=[new Is(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Ss(t,this.fieldTransforms)),e},sd);function sd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ud(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ad(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xr()}}var cd=(Object.defineProperty(fd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),fd.prototype.q_=function(t){return new fd(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},fd.prototype.U_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.q_({path:e,__:!1})).Q_(t),e},fd.prototype.K_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.q_({path:t,__:!1})).B_(),t},fd.prototype.W_=function(t){return this.q_({path:void 0,__:!0})},fd.prototype.h_=function(t){return Td(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.l_)},fd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.N(t)})||void 0!==this.fieldTransforms.find(function(t){return e.N(t.field)})},fd.prototype.B_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Q_(this.path.get(t))},fd.prototype.Q_=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(ad(this.u_)&&rd.test(t))throw this.h_('Document fields cannot begin and end with "__"')},fd),hd=(ld.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new cd({u_:t,methodName:e,l_:n,path:Hr.$(),__:!1,j_:r},this.t,this.serializer,this.ignoreUndefinedProperties)},ld);function ld(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Fa(t)}function fd(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.B_(),this.fieldTransforms=i||[],this.Qe=o||[]}function pd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);bd("Data must be an object, but it was:",s,r);var u,a,r=md(r,s);if(o.merge)u=new hs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=_d(e,l[h],n);if(!s.contains(f))throw new qr(Fr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Nd(c,f)||c.push(f)}u=new hs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new id(new Rs(r),u,a)}function dd(t,r,i,e){var o=t.G_(1,r,i);bd("Data must be an object, but it was:",o,e);var s=[],u=new Vs;return Lr(e,function(t,e){var n=Id(r,t,i);e instanceof Mf&&(e=e.o_),t=o.K_(n),e instanceof lp?s.push(n):null!=(t=gd(e,t))&&(s.push(n),u.set(n,t))}),e=new hs(s),new od(u.Ye(),e,o.fieldTransforms)}function yd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[_d(e,r,n)],a=[i];if(o.length%2!=0)throw new qr(Fr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(_d(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new Vs,y=u.length-1;0<=y;--y)Nd(p,u[y])||(h=u[y],(l=a[y])instanceof Mf&&(l=l.o_),f=s.K_(h),l instanceof lp?p.push(h):null!=(f=gd(l,f))&&(p.push(h),d.set(h,f)));return i=new hs(p),new od(d.Ye(),i,s.fieldTransforms)}function vd(t,e,n,r){return void 0===r&&(r=!1),gd(n,t.G_(r?4:3,e))}function gd(s,t){if(s instanceof Mf&&(s=s.o_),wd(s))return bd("Unsupported field value:",t,s),md(s,t);if(s instanceof hp)return function(t,e){if(!ad(e.u_))throw e.h_(t.a_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.a_+"() is not currently supported inside arrays");(t=t.c_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.u_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=gd(i[r],t.W_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Mf&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return To(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Br.fromDate(t);return{timestampValue:No(e.serializer,n)}}if(t instanceof Br){var r=new Br(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:No(e.serializer,r)}}if(t instanceof Ep)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ip)return{bytesValue:xo(e.serializer,t.E_)};if(t instanceof Yp){if(n=e.t,!(r=t.firestore.v_).isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:So(t.firestore.v_||e.t,t.C_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+sp(t))}(s,t)}function md(t,n){var r={};return Rr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Lr(t,function(t,e){null!=(e=gd(e,n.U_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function wd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Br||t instanceof Ep||t instanceof Ip||t instanceof Yp||t instanceof hp)}function bd(t,e,n){if(!wd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=sp(n))?e.h_(t+" a custom object"):e.h_(t+" "+n);var r}function _d(t,e,n){if(e instanceof Mf&&(e=e.o_),e instanceof Wp)return e.F_;if("string"==typeof e)return Id(t,e);throw Td("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ed=new RegExp("[~\\*/\\[\\]]");function Id(e,n,r){if(0<=n.search(Ed))throw Td("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Wp.bind.apply(Wp,i([void 0],n.split("."))))).F_}catch(t){throw Td("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Td(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new qr(Fr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Nd(t,e){return t.some(function(t){return t.isEqual(e)})}var xd=(Dd.prototype.X_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),0<this.mutations.length)throw new qr(Fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Lo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return ko(r.serializer,t)})},[4,r.Fc("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Ar(!!e.found),e.found.name,e.found.updateTime;var n=Do(t,e.found.name),t=Ao(e.found.updateTime),e=new Rs({mapValue:{fields:e.found.fields}});return new zs(n,t,e,{})}(n,t):"missing"in t?(e=n,Ar(!!(n=t).missing),Ar(!!n.readTime),e=Do(e,n.missing),n=Ao(n.readTime),new Ks(e,n)):xr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Ar(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Wc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ks||t instanceof zs?n.tf(t):xr()}),e)]}})})},Dd.prototype.set=function(t,e){this.write(e.L_(t,this.je(t))),this.Y_.add(t.toString())},Dd.prototype.update=function(t,e){try{this.write(e.L_(t,this.ef(t)))}catch(t){this.J_=t}this.Y_.add(t.toString())},Dd.prototype.delete=function(t){this.write([new Cs(t,this.je(t))]),this.Y_.add(t.toString())},Dd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Z_(),this.J_)throw this.J_;return e=this.z_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Qr.K(e),n.mutations.push(new Ls(e,n.je(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Lo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Mo(e.serializer,t)})},[4,e.xc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wc,this.mutations)];case 1:return t.sent(),this.H_=!0,[2]}})})},Dd.prototype.tf=function(t){var e;if(t instanceof zs)e=t.version;else{if(!(t instanceof Ks))throw xr();e=Gr.min()}var n=this.z_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qr(Fr.ABORTED,"Document version changed between two reads.")}else this.z_.set(t.key.toString(),e)},Dd.prototype.je=function(t){var e=this.z_.get(t.toString());return!this.Y_.has(t.toString())&&e?ds.updateTime(e):ds.Ge()},Dd.prototype.ef=function(t){var e=this.z_.get(t.toString());if(this.Y_.has(t.toString())||!e)return ds.exists(!0);if(e.isEqual(Gr.min()))throw new qr(Fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ds.updateTime(e)},Dd.prototype.write=function(t){this.Z_(),this.mutations=this.mutations.concat(t)},Dd.prototype.Z_=function(){},Dd),Ad=(kd.prototype.run=function(){this.sf()},kd.prototype.sf=function(){var t=this;this.Ps.An(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new xd(this.Wc),(n=this.rf(e))&&n.then(function(t){r.rs.fs(function(){return e.commit().then(function(){r.us.resolve(t)}).catch(function(t){r.af(t)})})}).catch(function(t){r.af(t)}),[2]})})})},kd.prototype.rf=function(t){try{var e=this.updateFunction(t);return!ni(e)&&e.catch&&e.then?e:(this.us.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.us.reject(t),null}},kd.prototype.af=function(t){var e=this;0<this.nf&&this.cf(t)?(--this.nf,this.rs.fs(function(){return e.sf(),Promise.resolve()})):this.us.reject(t)},kd.prototype.cf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!vi(t))},kd),Sd=(Od.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.oi.promise];case 1:return[2,(t.sent(),{rs:this.rs,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},Od.prototype.hf=function(t){var e=this;this.uf=t,this.oi.promise.then(function(){return e.uf(e.user)})},Od.prototype.lf=function(){if(this.rs.Vs)throw new qr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},Od.prototype.terminate=function(){var t=this;this.rs.bs();var n=new Ku;return this.rs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this._f?[4,this._f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ff?[4,this.ff.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ii(),n.resolve(),[3,6];case 5:return e=va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Od);function Od(t,e,n){var r=this;this.credentials=t,this.rs=e,this.Fl=n,this.user=Ia.UNAUTHENTICATED,this.clientId=Sr.u(),this.uf=function(){},this.oi=new Ku,this.credentials.si(function(t){Er("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.uf(t)),r.oi.resolve()})}function kd(t,e,n,r){this.rs=t,this.Wc=e,this.updateFunction=n,this.us=r,this.nf=5,this.Ps=new Hu(this.rs,"transaction_retry")}function Dd(t){this.Wc=t,this.z_=new Map,this.mutations=[],this.H_=!1,this.J_=null,this.Y_=new Set}function Pd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),Er("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.hf(function(e){return r.rs.Ss(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Vh(i.Kc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.fa(function(){return r.terminate()}),r.ff=i,[2]}})})}function Cd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.rs.Ns(),[4,Ld(r)];case 1:return e=t.sent(),Er("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.hf(function(t){return r.rs.Ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).rs.Ns(),Er("RemoteStore","RemoteStore received new credentials"),n=ll(e),e.Hc.add(3),[4,il(e)];case 1:return t.sent(),n&&e.Zc.set("Unknown"),[4,e.jc.s_(i)];case 2:return t.sent(),e.Hc.delete(3),[4,rl(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r._f=i,[2]}})})}function Ld(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ff?[3,2]:(Er("FirestoreClient","Using default OfflineComponentProvider"),[4,Pd(e,new Pf)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ff]}})})}function Rd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e._f?[3,2]:(Er("FirestoreClient","Using default OnlineComponentProvider"),[4,Cd(e,new Rf)]);case 1:t.sent(),t.label=2;case 2:return[2,e._f]}})})}function Vd(t){return Ld(t).then(function(t){return t.persistence})}function Md(t){return Ld(t).then(function(t){return t.Kc})}function Ud(t){return Rd(t).then(function(t){return t.Oh})}function jd(t){return Rd(t).then(function(t){return t.gu})}function Fd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Rd(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ls=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=lf(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wu(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,Uh(e.Kc,ou(u))];case 2:return i=t.sent(),o=e.kh.Wu(i.targetId),n=i.targetId,[4,Xl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&ol(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.gu),n.Us=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!cu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Gu(n.targetId),e.kh.Bu(n.targetId)?[3,2]:[4,jh(e.Kc,n.targetId,!1).then(function(){e.kh.Hu(n.targetId),sl(e.Oh,n.targetId),rf(e,n.targetId)}).catch(Gh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return rf(e,n.targetId),[4,jh(e.Kc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.gu),n)]}})})}function qd(n,r){var t=this,i=new Ku;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Jl,[4,jd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Bd(n,r,i,o,s){var t=new Vf({next:function(t){r.fs(function(){return ba(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new qr(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new qr(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ea($s(i.path),t,{includeMetadataChanges:!0,Hs:!0});return wa(n,u)}var Gd,zd=(Object.defineProperty(Hd.prototype,"app",{get:function(){if(!this.If)throw new qr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.If},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"mf",{get:function(){return this.Tf},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"Af",{get:function(){return void 0!==this.Rf},enumerable:!1,configurable:!0}),Hd.prototype.Pf=function(t){if(this.Tf)throw new qr(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.wf=new Np(t),void 0!==t.credentials&&(this.Ef=function(t){if(!t)return new Aa;switch(t.type){case"gapi":var e=t.client;return Ar(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ka(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Hd.prototype.gf=function(){return this.wf},Hd.prototype.k_=function(){return this.Tf=!0,this.wf},Hd.prototype._delete=function(){return this.Rf||(this.Rf=this.Vf()),this.Rf},Hd.prototype.Vf=function(){return(t=Tp.get(this))&&(Er("ComponentProvider","Removing Datastore"),Tp.delete(this),t.terminate()),Promise.resolve();var t},n(Kd,Gd=Hd),Kd.prototype.Vf=function(){return this.pf||vy(this),this.pf.terminate()},Kd);function Kd(t,e){var n=this;return(n=Gd.call(this,t,e)||this).yf=new pa,n.df="name"in t?t.name:"[DEFAULT]",n}function Hd(t,e){this.df="(lite)",this.wf=new Np({}),this.Tf=!1,t instanceof gr?(this.v_=t,this.Ef=new Aa):(this.If=t,this.v_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qr(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gr(t.options.projectId)}(t),this.Ef=new Sa(e))}function Qd(n,r,i){var t=this,o=new Ku;return n.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Pd(n,i)];case 1:return t.sent(),[4,Cd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Fr.FAILED_PRECONDITION||t.code===Fr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Wd(t){if(t.mf||t.Af)throw new qr(Fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Yd,Xd,Jd=(n(ny,Xd=ge),ny.prototype.exists=function(){return Xd.prototype.exists.call(this)},ny.prototype.data=function(t){if(void 0===t&&(t={}),this.N_){if(this.x_){var e=new $d(this.S_,this.D_,this.C_,this.N_,this.metadata,null);return this.x_.fromFirestore(e,t)}return this.D_.I_(this.N_.sn(),t.serverTimestamps)}},ny.prototype.get=function(t,e){if(void 0===e&&(e={}),this.N_&&null!==(t=this.N_.data().field(Hp("DocumentSnapshot.get",t))))return this.D_.I_(t,e.serverTimestamps)},ny),$d=(n(ey,Yd=Jd),ey.prototype.data=function(t){return void 0===t&&(t={}),Yd.prototype.data.call(this,t)},ey),Zd=(Object.defineProperty(ty.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"size",{get:function(){return this.bf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),ty.prototype.forEach=function(e,n){var r=this;this.bf.docs.forEach(function(t){e.call(n,new $d(r.S_,r.D_,t.key,t,new Ay(r.bf.Qt.has(t.key),r.bf.fromCache),r.query.x_))})},ty.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.bf.Wt)throw new qr(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Sf&&this.Df===t||(this.Sf=function(i,e){if(i.bf.Ut.T()){var n=0;return i.bf.docChanges.map(function(t){var e=new $d(i.S_,i.D_,t.doc.key,t.doc,new Ay(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.bf.Ut;return i.bf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new $d(i.S_,i.D_,t.doc.key,t.doc,new Ay(i.bf.Qt.has(t.doc.key),i.bf.fromCache),i.query.x_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Df=t),this.Sf},ty);function ty(t,e,n,r){this.S_=t,this.D_=e,this.bf=r,this.metadata=new Ay(r.hasPendingWrites,r.fromCache),this.query=n}function ey(){return null!==Yd&&Yd.apply(this,arguments)||this}function ny(t,e,n,r,i,o){var s=this;return(s=Xd.call(this,t,e,n,r,o)||this).S_=t,s.vf=t,s.metadata=i,s}function ry(t,e){return t instanceof Jd&&e instanceof Jd?t.S_===e.S_&&t.C_.isEqual(e.C_)&&(null===t.N_?null===e.N_:t.N_.isEqual(e.N_))&&t.x_===e.x_:t instanceof Zd&&e instanceof Zd&&t.S_===e.S_&&(n=t.query,r=e.query,n instanceof Xp&&r instanceof Xp&&n.firestore===r.firestore&&cu(n.M_,r.M_)&&n.x_===r.x_)&&t.metadata.isEqual(e.metadata)&&t.bf.isEqual(e.bf);var n,r}var iy,oy=(n(sy,iy=h),sy.prototype.R_=function(t){return new Ip(t)},sy.prototype.P_=function(t){return t=this.p_(t,this.firestore.v_),new Yp(this.firestore,null,t)},sy);function sy(t){var e=this;return(e=iy.call(this)||this).firestore=t,e}function uy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=up(t.firestore,zd),s=nd(o);return e instanceof Mf&&(e=e.o_),ay(o,("string"==typeof e||e instanceof Wp?yd(s,"updateDoc",t.C_,e,n,r):dd(s,"updateDoc",t.C_,e)).L_(t.C_,ds.exists(!0)))}function ay(t,e){return qd(yy(t),e)}function cy(t,e,n){var r=n.docs.get(e.C_),i=new oy(t);return new Jd(t,i,e.C_,r,new Ay(n.hasPendingWrites,n.fromCache),e.x_)}var hy,ly=(dy.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Wd(t);var n=yy(t),r=t.k_();return Qd(n,t=new Rf,new Cf(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},dy.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Wd(t);var e=yy(t),n=t.k_();return Qd(e,t=new Rf,new Lf(t,n.cacheSizeBytes))}(t.o_)},dy.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.mf&&!n.Af)throw new qr(Fr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Ku;return n.yf.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Wu.kn()?(e=n+"main",[4,Wu.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ph(n.v_,n.df))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},dy),fy=(n(py,hy=Mf),Object.defineProperty(py.prototype,"v_",{get:function(){return this.o_.v_},enumerable:!1,configurable:!0}),py.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.gf()),t)).merge,this.o_.Pf(t)},py.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.gf().host&&Tr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},py.prototype.enableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Vd(r)];case 1:return e=t.sent(),[4,Ud(r)];case 2:return n=t.sent(),[2,(e.da(!0),(t=n).Hc.delete(0),rl(t))]}})})})}(yy(this.o_))},py.prototype.disableNetwork=function(){return function(r){var t=this;return r.rs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Vd(r)];case 1:return e=t.sent(),[4,Ud(r)];case 2:return n=t.sent(),[2,(e.da(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hc.add(0),[4,il(e)];case 1:return t.sent(),e.Zc.set("Offline"),[2]}})})}(n))]}})})})}(yy(this.o_))},py.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&op("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Cf.enableMultiTabIndexedDbPersistence(this):this.Cf.enableIndexedDbPersistence(this,n)},py.prototype.clearPersistence=function(){return this.Cf.clearIndexedDbPersistence(this)},py.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},py.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Ku;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=tf,[4,jd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(yy(this.o_))},py.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=yy(t),e=qa(e)?e:{next:e},i=new Vf(e);return t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.add(e),e.next()},[4,Fd(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.yf.fs(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.$s.delete(e)},[4,Fd(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(py.prototype,"app",{get:function(){if(!this.Nf)throw new qr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nf},enumerable:!1,configurable:!0}),py.prototype.collection=function(t){return rp("Firestore.collection","path",t),yy(this.o_),new Gy(zr.k(t),this,null)},py.prototype.doc=function(t){return rp("Firestore.doc","path",t),yy(this.o_),by.xf(zr.k(t),this,null)},py.prototype.collectionGroup=function(t){if(rp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return yy(this.o_),new Fy(new Qs(zr.$(),t),this,null)},py.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Ku;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Rd(n).then(function(t){return t.Wc})];case 1:return e=t.sent(),new Ad(n.rs,e,r,i).run(),[2]}})})}),i.promise}(yy(this.o_),function(t){return e(new my(n,t))})},py.prototype.batch=function(){return yy(this.o_),new wy(this)},py);function py(t,e,n){var r=this;return(r=hy.call(this,e)||this).Cf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof gr||(r.Nf=t),r}function dy(){}function yy(t){return t.pf||vy(t),t.pf.lf(),t.pf}function vy(t){var e,n,r=t.k_(),r=(e=t.v_,n=t.df,new vr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.pf=new Sd(t.Ef,t.yf,r)}var gy,my=(Iy.prototype.get=function(t){var e=this,n=Wy(0,t,this.S_),r=new jp(this.S_);return this.Ff.X_([n.C_]).then(function(t){if(!t||1!==t.length)return xr();if((t=t[0])instanceof Ks)return new Sy(e.S_,new Jd(e.S_.o_,r,n.C_,null,new Ay(!1,!1),n.x_));if(t instanceof zs)return new Sy(e.S_,new Jd(e.S_.o_,r,n.C_,t,new Ay(!1,!1),n.x_));throw xr()})},Iy.prototype.set=function(t,e,n){return t=Wy(0,t,this.S_),n=ip("Transaction.set",n),e=Yy(t.x_,e,n),n=pd(this.Of,"Transaction.set",t.C_,e,null!==t.x_,n),this.Ff.set(t.C_,n),this},Iy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Wy(0,t,this.S_),e instanceof Mf&&(e=e.o_),e="string"==typeof e||e instanceof Wp?yd(this.Of,"Transaction.update",t.C_,e,n,r):dd(this.Of,"Transaction.update",t.C_,e),this.Ff.update(t.C_,e),this},Iy.prototype.delete=function(t){return t=Wy(0,t,this.S_),this.Ff.delete(t.C_),this},Iy),wy=(Ey.prototype.set=function(t,e,n){return this.$f(),t=Wy(0,t,this.S_),n=ip("WriteBatch.set",n),e=Yy(t.x_,e,n),n=pd(this.Of,"WriteBatch.set",t.C_,e,null!==t.x_,n),this.Mf=this.Mf.concat(n.L_(t.C_,ds.Ge())),this},Ey.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.$f(),t=Wy(0,t,this.S_),e instanceof Mf&&(e=e.o_),e="string"==typeof e||e instanceof Wp?yd(this.Of,"WriteBatch.update",t.C_,e,n,r):dd(this.Of,"WriteBatch.update",t.C_,e),this.Mf=this.Mf.concat(e.L_(t.C_,ds.exists(!0))),this},Ey.prototype.delete=function(t){return this.$f(),t=Wy(0,t,this.S_),this.Mf=this.Mf.concat(new Cs(t.C_,ds.Ge())),this},Ey.prototype.commit=function(){return this.$f(),this.kf=!0,0<this.Mf.length?qd(yy(this.S_.o_),this.Mf):Promise.resolve()},Ey.prototype.$f=function(){if(this.kf)throw new qr(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ey),by=(n(_y,gy=Mf),_y.xf=function(t,e,n){if(t.length%2!=0)throw new qr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.M()+" has "+t.length);return new _y(e,new Yp(e.o_,n,new Qr(t)))},_y.b_=function(t,e,n){return new _y(e,new Yp(e.o_,n,t))},Object.defineProperty(_y.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(_y.prototype,"parent",{get:function(){return new Gy(this.o_.O_.S(),this.firestore,this.o_.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(_y.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),_y.prototype.collection=function(t){if(rp("DocumentReference.collection","path",t),!t)throw new qr(Fr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=zr.k(t),new Gy(this.o_.O_.child(t),this.firestore,null)},_y.prototype.isEqual=function(t){return t instanceof Mf&&(t=t.o_),t instanceof Yp&&((e=this.o_)instanceof Yp||e instanceof Jp)&&(t instanceof Yp||t instanceof Jp)&&e.firestore===t.firestore&&e.path===t.path&&e.x_===t.x_;var e},_y.prototype.set=function(t,e){e=ip("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=up(n.firestore,zd),r=Yy(n.x_,r,i),ay(o,pd(nd(o),"setDoc",n.C_,r,null!==n.x_,i).L_(n.C_,ds.Ge()))}catch(t){throw Ty(t,"setDoc","DocumentReference.set")}var n,r,i,o},_y.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?uy(this.o_,t):uy.apply(void 0,i([this.o_,t,e],n))}catch(t){throw Ty(t,"updateDoc","DocumentReference.update")}},_y.prototype.delete=function(){return ay(up((t=this.o_).firestore,zd),[new Cs(t.C_,ds.Ge())]);var t},_y.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!qa(n))return n}return{}}(),o={next:function(t){n.next&&n.next(new Sy(e.firestore,new Jd(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_)))},error:null===(o=(n=qa((o=r)[0])?o[0]:qa(o[1])?o[1]:"function"==typeof o[0]?{next:o[0],error:o[1],complete:o[2]}:{next:o[1],error:o[2],complete:o[3]}).error)||void 0===o?void 0:o.bind(n),complete:null===(o=n.complete)||void 0===o?void 0:o.bind(n)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||qa(n[o])||(i=n[o],o++);var s,u,a,c,h,l={includeMetadataChanges:i.includeMetadataChanges};qa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Yp?(s=up(e.firestore,zd),u=$s(e.C_.path),h={next:function(t){n[o]&&n[o](cy(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=up(e.firestore,zd),u=e.M_,c=new oy(s),h={next:function(t){n[o]&&n[o](new Zd(s,c,e,t))},error:n[o+1],complete:n[o+2]},Vy(e.M_));var f=yy(s),p=new Vf(h),d=new Ea(u,p,l);return s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=wa,[4,Fd(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.yf.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ba,[4,Fd(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}(this.o_,i,o)},_y.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=up(e.firestore,zd),r=yy(n),i=new oy(n),o=new Ku;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Md(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ga.Oi(t,e)}))];case 1:return(r=t.sent())instanceof zs?s.resolve(r):r instanceof Ks?s.resolve(null):s.reject(new qr(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=va(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.C_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Jd(n,i,e.C_,t,new Ay(t instanceof zs&&t.Je,!0),e.x_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=up(e.firestore,zd),r=yy(n),i=new Ku;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Fd(r)];case 1:return[4,Bd(t.sent(),n.yf,e.C_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return cy(n,e,t)})}:function(e){var t=this,n=up(e.firestore,zd),r=yy(n),i=new Ku;return n.yf.fs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Fd(r)];case 1:return[4,Bd(t.sent(),n.yf,e.C_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return cy(n,e,t)})})(this.o_).then(function(t){return new Sy(e.firestore,new Jd(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_))})},_y.prototype.withConverter=function(t){return new _y(this.firestore,this.o_.withConverter(t))},_y);function _y(t,e){var n=this;return(n=gy.call(this,e)||this).firestore=t,n.D_=new jp(t),n}function Ey(t){this.S_=t,this.Mf=[],this.kf=!1,this.Of=nd(this.S_.o_)}function Iy(t,e){this.S_=t,this.Ff=e,this.Of=nd(this.S_.o_)}function Ty(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var Ny,xy,Ay=(Py.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Py),Sy=(n(Dy,xy=Mf),Object.defineProperty(Dy.prototype,"ref",{get:function(){return new by(this.S_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Dy.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Dy.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Dy.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Dy.prototype.data=function(t){return this.o_.data(t)},Dy.prototype.get=function(t,e){return this.o_.get(t,e)},Dy.prototype.isEqual=function(t){return ry(this.o_,t.o_)},Dy),Oy=(n(ky,Ny=Sy),ky.prototype.data=function(t){return this.o_.data(t)},ky);function ky(){return null!==Ny&&Ny.apply(this,arguments)||this}function Dy(t,e){var n=this;return(n=xy.call(this,e)||this).S_=t,n}function Py(t,e){this.hasPendingWrites=t,this.fromCache=e}function Cy(t,e,n){if(n instanceof Mf&&(n=n.o_),"string"==typeof n){if(""===n)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ru(e)&&-1!==n.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(zr.k(n)),!Qr.G(e))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return fo(t,new Qr(e))}if(n instanceof Yp)return fo(t,n.C_);throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+sp(n)+".")}function Ly(t,e){if(!Array.isArray(t)||0===t.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ry(t,e,n){if(!n.isEqual(e))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Vy(t){if(tu(t)&&0===t.rn.length)throw new qr(Fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var My,Uy,jy,Fy=(Qy.prototype.where=function(t,e,n){return t=_d("Query.where",t),e=function(t,e,n,r,i,o){if(r.B()){if("array-contains"===i||"array-contains-any"===i)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Ly(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Cy(n,t,c))}h={arrayValue:{values:s}}}else h=Cy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Ly(o,i),h=vd(e,"Query.where",o,"in"===i||"not-in"===i);var h=yu.create(r,i,h);return function(t,e){if(e.cn()){var n=nu(t);if(null!==n&&!n.isEqual(e.field))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=eu(t))&&Ry(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new qr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new qr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.M_,this.Lf,this.firestore.v_,t,e,n),new Qy((e=(n=this.M_).filters.concat([e]),new Qs(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},Qy.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new qr(Fr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=_d("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new zu(e,n),null!==eu(t)||null!==(t=nu(t))&&Ry(0,t,n.field),e}(this.M_,t,n);return new Qy((t=(n=this.M_).rn.concat([t]),new Qs(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.x_)},Qy.prototype.limit=function(t){return ap("Query.limit",t),new Qy(su(this.M_,t,"F"),this.firestore,this.x_)},Qy.prototype.limitToLast=function(t){return ap("Query.limitToLast",t),new Qy(su(this.M_,t,"L"),this.firestore,this.x_)},Qy.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Bf("Query.startAt",t,e,!0),new Qy(uu(this.M_,t),this.firestore,this.x_)},Qy.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Bf("Query.startAfter",t,e,!1),new Qy(uu(this.M_,t),this.firestore,this.x_)},Qy.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Bf("Query.endBefore",t,e,!0),new Qy(au(this.M_,t),this.firestore,this.x_)},Qy.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Bf("Query.endAt",t,e,!1),new Qy(au(this.M_,t),this.firestore,this.x_)},Qy.prototype.isEqual=function(t){return t instanceof Qy&&this.firestore===t.firestore&&cu(this.M_,t.M_)&&this.x_===t.x_},Qy.prototype.withConverter=function(t){return new Qy(this.M_,this.firestore,t)},Qy.prototype.Bf=function(c,t,e,n){return t instanceof Sy?function(t,e,n,r){if(!n)throw new qr(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=iu(t);o<s.length;o++){var u=s[o];if(u.field.B())i.push(fo(e,n.key));else{var a=n.field(u.field);if(to(a))throw new qr(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.M(),new qr(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Ru(i,r)}(this.M_,this.firestore.v_,t.o_.N_,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new qr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.B()){if("string"!=typeof c)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ru(t)&&-1!==c.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(zr.k(c));if(!Qr.G(h))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Qr(h),u.push(fo(e,h))}else c=vd(n,r,c),u.push(c)}return new Ru(u,o)}(this.M_,this.firestore.v_,this.Lf,c,e,n))},Qy.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||qa(n[s])||(o=n[s],s++),qa(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new By(e.firestore,new Zd(e.firestore.o_,e.D_,new Xp(e.firestore.o_,e.x_,e.M_),t)))},error:n[s+1],complete:n[s+2]};return Vy(this.M_),function(n,t,e){var r=this,i=new Vf(u),o=new Ea(t,i,e);return n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=wa,[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.rs.fs(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ba,[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(yy(this.firestore.o_),this.M_,o)},Qy.prototype.get=function(t){var e=this;Vy(this.M_);var n=yy(this.firestore.o_);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Ku;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Fh(r,i,!0)];case 1:return n=t.sent(),e=new Ml(i,n.Xa),n=e.gh(n.documents),n=e.bi(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=va(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Md(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.M_):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Ku;return n.rs.fs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Vf({next:function(t){n.fs(function(){return ba(e,s)}),t.fromCache&&"server"===r.source?i.reject(new qr(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ea(t,o,{includeMetadataChanges:!0,Hs:!0});return wa(e,s)},[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.rs,r,i,o])]}})})}),o.promise}(n,this.M_,t)).then(function(t){return new By(e.firestore,new Zd(e.firestore.o_,e.D_,new Xp(e.firestore.o_,e.x_,e.M_),t))})},Qy),qy=(n(Hy,jy=Mf),Object.defineProperty(Hy.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Hy.prototype,"doc",{get:function(){return new Oy(this.S_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Hy.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Hy.prototype,"newIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Hy),By=(n(Ky,Uy=Mf),Object.defineProperty(Ky.prototype,"query",{get:function(){return new Fy(this.o_.query.M_,this.S_,this.o_.query.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ky.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Ky.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ky.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Ky.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Oy(e.S_,t)})},enumerable:!1,configurable:!0}),Ky.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new qy(e.S_,t)})},Ky.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Oy(r.S_,t))})},Ky.prototype.isEqual=function(t){return ry(this.o_,t.o_)},Ky),Gy=(n(zy,My=Fy),Object.defineProperty(zy.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(zy.prototype,"parent",{get:function(){var t=this.M_.path.S();return t.T()?null:by.xf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(zy.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),zy.prototype.doc=function(t){return 0===arguments.length&&(t=Sr.u()),rp("CollectionReference.doc","path",t),t=zr.k(t),by.xf(this.M_.path.child(t),this.firestore,this.x_)},zy.prototype.add=function(t){var t=this.x_?this.x_.toFirestore(t):t,e=this.doc();return by.b_(e.o_.C_,this.firestore,null).set(t).then(function(){return e})},zy.prototype.withConverter=function(t){return new zy(this.O_,this.firestore,t)},zy);function zy(t,e,n){var r=this;if(((r=My.call(this,$s(t),e,n)||this).O_=t).length%2!=1)throw new qr(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.M()+" has "+t.length);return r}function Ky(t,e){var n=this;return(n=Uy.call(this,e)||this).S_=t,n}function Hy(t,e){var n=this;return(n=jy.call(this,e)||this).S_=t,n}function Qy(t,e,n){this.M_=t,this.firestore=e,this.x_=n,this.Lf=nd(e.o_),this.D_=new jp(e)}function Wy(t,e,n){if((e=up(e,Yp)).firestore!==n.o_)throw new qr(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Yy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Xy,Jy,ge=(n(Zy,Jy=Mf),Zy.documentId=function(){return new Zy(Hr.q().M())},Zy.prototype.isEqual=function(t){return t instanceof Mf&&(t=t.o_),t instanceof Wp&&this.o_.F_.isEqual(t.F_)},Zy),h=(n($y,Xy=Mf),$y.serverTimestamp=function(){var t=new mp("serverTimestamp");return t.a_="FieldValue.serverTimestamp",new $y(t)},$y.delete=function(){var t=new lp("deleteField");return t.a_="FieldValue.delete",new $y(t)},$y.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("arrayUnion",t)}.apply(void 0,t);return n.a_="FieldValue.arrayUnion",new $y(n)},$y.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bp("arrayRemove",t)}.apply(void 0,t);return n.a_="FieldValue.arrayRemove",new $y(n)},$y.increment=function(t){return(t=new _p("increment",t)).a_="FieldValue.increment",new $y(t)},$y.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},$y),h={Firestore:fy,GeoPoint:Ep,Timestamp:Br,Blob:Up,Transaction:my,WriteBatch:wy,DocumentReference:by,DocumentSnapshot:Sy,Query:Fy,QueryDocumentSnapshot:Oy,QuerySnapshot:By,CollectionReference:Gy,FieldPath:ge,FieldValue:h,setLogLevel:function(t){wr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function $y(){return null!==Xy&&Xy.apply(this,arguments)||this}function Zy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jy.call(this,new(Wp.bind.apply(Wp,i([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new N("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new fy(e,new zd(e,t),new ly);var e},"PUBLIC").setServiceProps(Object.assign({},h))),e.registerVersion("@firebase/firestore","2.0.2-20201012233953")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});