!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Hd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Hd);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=N||self;function R(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,D)&&t[D]||(t[D]=++P))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var X=S.navigator;if(X){X=X.userAgent;if(X){W=X;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=R;var nt,rt=Q(W,"Opera"),it=Q(W,"Trident")||Q(W,"MSIE"),ot=Q(W,"Edge"),st=ot||it,ut=Q(W,"Gecko")&&!(Q(W.toLowerCase(),"webkit")&&!Q(W,"Edge"))&&!(Q(W,"Trident")||Q(W,"MSIE"))&&!Q(W,"Edge"),at=Q(W.toLowerCase(),"webkit")&&!Q(W,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=W,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=Y(String(nt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=S.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",R,e),S.removeEventListener("test",R,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Et=0;function It(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new It(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Rt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[_t]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[_t]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Dt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):Tt(t)))}function Pt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Dt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(yt)return Ct(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new wt(e,this))}function Vt(t){return(t=t[St])instanceof At?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[xt]||(e[xt]=function(t){return e.handleEvent(t)}),e[xt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[_t]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Mt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Dt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Yt},function(t){t.reset()}));function Wt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Qt(t,e){var n;zt||(n=S.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Kt||(zt(),Kt=!0),Xt.add(t,e)}Gt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(I(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Dt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ee={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ie={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Oe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){mt.call(this,"d")}function Re(){mt.call(this,"c")}function Le(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=De,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Se,mt),j(Re,mt),j(Le,Te),Oe=new Le;var De=45e3,Pe={},Ce={};function Ue(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=M(),Me(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function xe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Me(t){t.T=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(V(t.Va,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(V(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Kn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Hn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(xe(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),xe(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=He.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ke(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),Ye(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Rn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Ln=S.JSON.parse;function kn(t){jt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Dn,this.D=this.F=!1}j(kn,jt);var Dn="",Pn=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),jn(t)}function xn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Mn(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",xn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Yn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Kn(t)}function Kn(t){_n(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Ue(n,r,e)}function Jn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Qt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,qt(i=ye(),new be(i)),Kn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,S.Image?((i=new Image).onload=x(Rn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(Rn,o,i,"TestLoadImage: error",!1,r),i.onabort=x(Rn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(Rn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Yn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Xe(s):new Ke(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Re.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Oe),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Kn(t)},lr.prototype.close=function(){Hn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=Bt(t),Qn(this.a,e)):Qn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Se),j(dr,Re),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=ye,gr=Ee,mr=Ie,wr=pe,br=10,_r=11,Er=Ne,Ir=kn,Tr="8.2.0-202011822428",Ar=new o("@firebase/firestore");function Nr(){return Ar.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,l(["Firestore ("+Tr+"): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,l(["Firestore ("+Tr+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,l(["Firestore ("+Tr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t;throw Sr(t),new Error(t)}function Dr(t){t||kr()}var Pr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var xr=(Mr.fromBase64String=function(t){return new Mr(atob(t))},Mr.fromUint8Array=function(t){return new Mr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Mr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Mr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Mr.prototype.o=function(){return 2*this.i.length},Mr.prototype.u=function(t){return Ur(this.i,t.i)},Mr.prototype.isEqual=function(t){return this.i===t.i},Mr);function Mr(t){this.i=t}xr.h=new xr("");var jr,qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Fr=(f(Hr,jr=Error),Hr),Br=(zr.fromBase64String=function(t){try{return new zr(xr.fromBase64String(t))}catch(t){throw new Fr(qr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},zr.fromUint8Array=function(t){return new zr(xr.fromUint8Array(t))},zr.prototype.toBase64=function(){return this.l.toBase64()},zr.prototype.toUint8Array=function(){return this.l.toUint8Array()},zr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},zr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},zr),Gr=function(t){this._=t};function zr(t){this.l=t}function Hr(t,e){var n=this;return(n=jr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Wr(){if("undefined"==typeof Uint8Array)throw new Fr(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Yr(){if("undefined"==typeof atob)throw new Fr(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Qr,Kr=(f($r,Qr=Gr),$r.fromBase64String=function(t){return Yr(),new $r(Br.fromBase64String(t))},$r.fromUint8Array=function(t){return Wr(),new $r(Br.fromUint8Array(t))},$r.prototype.toBase64=function(){return Yr(),this._.toBase64()},$r.prototype.toUint8Array=function(){return Wr(),this._.toUint8Array()},$r.prototype.isEqual=function(t){return this._.isEqual(t._)},$r.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},$r),Xr=(Jr.prototype.T=function(){return null!=this.uid},Jr.prototype.I=function(){return this.T()?"uid:"+this.uid:"anonymous-user"},Jr.prototype.isEqual=function(t){return t.uid===this.uid},Jr);function Jr(t){this.uid=t}function $r(){return null!==Qr&&Qr.apply(this,arguments)||this}Xr.UNAUTHENTICATED=new Xr(null),Xr.m=new Xr("google-credentials-uid"),Xr.A=new Xr("first-party-uid");function Zr(t,e){this.user=e,this.type="OAuth",this.R={},this.R.Authorization="Bearer "+t}var ti=(di.prototype.getToken=function(){return Promise.resolve(null)},di.prototype.g=function(){},di.prototype.V=function(t){(this.P=t)(Xr.UNAUTHENTICATED)},di.prototype.p=function(){this.P=null},di),ei=(pi.prototype.getToken=function(){var e=this,n=this.D,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.D!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new Zr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},pi.prototype.g=function(){this.forceRefresh=!0},pi.prototype.V=function(t){this.P=t,this.S&&t(this.currentUser)},pi.prototype.p=function(){this.auth&&this.auth.removeAuthTokenListener(this.v),this.v=null,this.P=null},pi.prototype.C=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new Xr(t)},pi),ni=(Object.defineProperty(li.prototype,"R",{get:function(){var t={"X-Goog-AuthUser":this.F},e=this.N.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),li),ri=(fi.prototype.getToken=function(){return Promise.resolve(new ni(this.N,this.F))},fi.prototype.V=function(t){t(Xr.A)},fi.prototype.p=function(){},fi.prototype.g=function(){},fi),ii=function(t,e,n,r,i,o){this.O=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.k=o},oi=(Object.defineProperty(hi.prototype,"M",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return t instanceof hi&&t.projectId===this.projectId&&t.database===this.database},hi),si=(ci.prototype.$=function(t){},ci.prototype.L=function(){},ci),ui=(ai.prototype.$=function(t){this.W.push(t)},ai.prototype.L=function(){window.removeEventListener("online",this.B),window.removeEventListener("offline",this.U)},ai.prototype.j=function(){window.addEventListener("online",this.B),window.addEventListener("offline",this.U)},ai.prototype.q=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(0)},ai.prototype.K=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(1)},ai.G=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ai);function ai(){var t=this;this.B=function(){return t.q()},this.U=function(){return t.K()},this.W=[],this.j()}function ci(){}function hi(t,e){this.projectId=t,this.database=e||"(default)"}function fi(t,e){this.N=t,this.F=e}function li(t,e){this.N=t,this.F=e,this.type="FirstParty",this.user=Xr.A}function pi(t){var e=this;this.v=null,this.currentUser=Xr.UNAUTHENTICATED,this.S=!1,this.D=0,this.P=null,this.forceRefresh=!1,this.v=function(){e.D++,e.currentUser=e.C(),e.S=!0,e.P&&e.P(e.currentUser)},this.D=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.v):(this.v(null),t.get().then(function(t){e.auth=t,e.v&&e.auth.addAuthTokenListener(e.v)},function(){}))}function di(){this.P=null}function yi(t){return null==t}function vi(t){return 0===t&&1/t==-1/0}var gi,mi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};function wi(t){switch(t){case qr.OK:return kr(),0;case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return 1;default:return kr(),0}}function bi(t){if(void 0===t)return Sr("GRPC error has no .code"),qr.UNKNOWN;switch(t){case gi.OK:return qr.OK;case gi.CANCELLED:return qr.CANCELLED;case gi.UNKNOWN:return qr.UNKNOWN;case gi.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case gi.INTERNAL:return qr.INTERNAL;case gi.UNAVAILABLE:return qr.UNAVAILABLE;case gi.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case gi.NOT_FOUND:return qr.NOT_FOUND;case gi.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case gi.ABORTED:return qr.ABORTED;case gi.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case gi.DATA_LOSS:return qr.DATA_LOSS;default:return kr()}}(Ie=gi=gi||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var _i,Ei,Ii,Ti=(Fi.prototype.Y=function(t){this.X=t},Fi.prototype.Z=function(t){this.tt=t},Fi.prototype.onMessage=function(t){this.et=t},Fi.prototype.close=function(){this.J()},Fi.prototype.send=function(t){this.H(t)},Fi.prototype.nt=function(){this.X()},Fi.prototype.st=function(t){this.tt(t)},Fi.prototype.it=function(t){this.et(t)},Fi),Ai=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Ni=(qi.prototype.at=function(e,t,n,r){var i=this.ut(e,t);Or("RestConnection","Sending: ",i,n);t={};return this.ht(t,r),this.lt(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},qi.prototype._t=function(t,e,n,r){return this.at(t,e,n,r)},qi.prototype.ht=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.0-202011822428",t["Content-Type"]="text/plain",e)for(var n in e.R)e.R.hasOwnProperty(n)&&(t[n]=e.R[n])},qi.prototype.ut=function(t,e){t=mi[t];return this.ot+"/v1/"+e+":"+t},f(ji,Ii=qi),ji.prototype.lt=function(o,e,s,u){return new Promise(function(n,r){var i=new Ir;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Fr(qr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(qr).indexOf(e)?e:qr.UNKNOWN,r(new Fr(e,t.message))):r(new Fr(qr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Fr(qr.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},ji.prototype.ft=function(t,e){var n,r=[this.ot,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.O.projectId+"/databases/"+this.O.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.k};this.ht(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Or("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Ti({H:function(t){a?Or("Connection","Not sending because WebChannel is closed:",t):(u||(Or("Connection","Opening WebChannel transport."),s.open(),u=!0),Or("Connection","WebChannel sending:",t),s.send(t))},J:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Er.EventType.OPEN,function(){a||Or("Connection","WebChannel transport opened.")}),t(s,Er.EventType.CLOSE,function(){a||(a=!0,Or("Connection","WebChannel transport closed"),c.st())}),t(s,Er.EventType.ERROR,function(t){a||(a=!0,Rr("Connection","WebChannel transport errored:",t),c.st(new Fr(qr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Er.EventType.MESSAGE,function(t){var e,n,r,i;a||(Dr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=gi[r];if(void 0!==t)return bi(t)}(),i=n.message,void 0===t&&(t=qr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.st(new Fr(t,i)),s.close()):(Or("Connection","WebChannel received:",e),c.it(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Or("Connection","Detected buffering proxy"):t.stat===_r&&Or("Connection","Detected no buffering proxy")}),setTimeout(function(){c.nt()},0),c},ji),Oi=(Mi.now=function(){return Mi.fromMillis(Date.now())},Mi.fromDate=function(t){return Mi.fromMillis(t.getTime())},Mi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Mi(e,1e6*(t-1e3*e))},Mi.prototype.toDate=function(){return new Date(this.toMillis())},Mi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Mi.prototype.dt=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},Mi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Mi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Mi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Mi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Mi),Si=(xi.wt=function(t){return new xi(t)},xi.min=function(){return new xi(new Oi(0,0))},xi.prototype.u=function(t){return this.timestamp.dt(t.timestamp)},xi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},xi.prototype.Et=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},xi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},xi.prototype.Tt=function(){return this.timestamp},xi),o=(Object.defineProperty(Vi.prototype,"length",{get:function(){return this.It},enumerable:!1,configurable:!0}),Vi.prototype.isEqual=function(t){return 0===Vi.At(this,t)},Vi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Vi?t.forEach(function(t){e.push(t)}):e.push(t),this.Rt(e)},Vi.prototype.limit=function(){return this.offset+this.length},Vi.prototype.Pt=function(t){return t=void 0===t?1:t,this.Rt(this.segments,this.offset+t,this.length-t)},Vi.prototype.yt=function(){return this.Rt(this.segments,this.offset,this.length-1)},Vi.prototype.gt=function(){return this.segments[this.offset]},Vi.prototype.Vt=function(){return this.get(this.length-1)},Vi.prototype.get=function(t){return this.segments[this.offset+t]},Vi.prototype.bt=function(){return 0===this.length},Vi.prototype.vt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Vi.prototype.St=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Vi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Vi.prototype.Dt=function(){return this.segments.slice(this.offset,this.limit())},Vi.At=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Vi),Ri=(f(Ui,Ei=o),Ui.prototype.Rt=function(t,e,n){return new Ui(t,e,n)},Ui.prototype.Ct=function(){return this.Dt().join("/")},Ui.prototype.toString=function(){return this.Ct()},Ui.xt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Fr(qr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Ui(n)},Ui.Nt=function(){return new Ui([])},Ui),Li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ki=(f(Ci,_i=o),Ci.prototype.Rt=function(t,e,n){return new Ci(t,e,n)},Ci.Ft=function(t){return Li.test(t)},Ci.prototype.Ct=function(){return this.Dt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ci.Ft(t)||(t="`"+t+"`"),t}).join(".")},Ci.prototype.toString=function(){return this.Ct()},Ci.prototype.Ot=function(){return 1===this.length&&"__name__"===this.get(0)},Ci.kt=function(){return new Ci(["__name__"])},Ci.Mt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Fr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Fr(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Fr(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Fr(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ci(e)},Ci.Nt=function(){return new Ci([])},Ci),Di=(Pi.$t=function(t){return new Pi(Ri.xt(t))},Pi.Lt=function(t){return new Pi(Ri.xt(t).Pt(5))},Pi.prototype.Bt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Pi.prototype.isEqual=function(t){return null!==t&&0===Ri.At(this.path,t.path)},Pi.prototype.toString=function(){return this.path.toString()},Pi.At=function(t,e){return Ri.At(t.path,e.path)},Pi.qt=function(t){return t.length%2==0},Pi.Ut=function(t){return new Pi(new Ri(t.slice()))},Pi);function Pi(t){this.path=t}function Ci(){return null!==_i&&_i.apply(this,arguments)||this}function Ui(){return null!==Ei&&Ei.apply(this,arguments)||this}function Vi(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.It=n}function xi(t){this.timestamp=t}function Mi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Fr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Fr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Fr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Fr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ji(t){var e=this;return(e=Ii.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.k=t.k,e}function qi(t){this.rt=t,this.O=t.O;var e=t.ssl?"https":"http";this.ot=e+"://"+t.host,this.ct="projects/"+this.O.projectId+"/databases/"+this.O.database+"/documents"}function Fi(t){this.H=t.H,this.J=t.J}function Bi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Gi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hi=(Yi.prototype.Qt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].vt(t))return!0;return!1},Yi.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Yi),Wi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(t){(this.fields=t).sort(ki.At)}function Qi(t){if(Dr(!!t),"string"!=typeof t)return{seconds:Ki(t.seconds),nanos:Ki(t.nanos)};var e=0,n=Wi.exec(t);Dr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ki(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Xi(t){return"string"==typeof t?xr.fromBase64String(t):xr.fromUint8Array(t)}function Ji(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function $i(t){t=Qi(t.mapValue.fields.__local_write_time__.timestampValue);return new Oi(t.seconds,t.nanos)}function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ji(t)?4:10:kr()}function to(r,i){var t,e=Zi(r);if(e!==Zi(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return $i(r).isEqual($i(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Qi(r.timestampValue),t=Qi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Xi(r.bytesValue).isEqual(Xi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ki((t=r).geoPointValue.latitude)===Ki(e.geoPointValue.latitude)&&Ki(t.geoPointValue.longitude)===Ki(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ki(t.integerValue)===Ki(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ki(t.doubleValue),e=Ki(e.doubleValue);return t===e?vi(t)===vi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],to);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Bi(e)!==Bi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!to(e[t],n[t])))return!1;return!0}();default:return kr()}}function eo(t,e){return void 0!==(t.values||[]).find(function(t){return to(t,e)})}function no(t,e){var n,r,i=Zi(t),o=Zi(e);if(i!==o)return Ur(i,o);switch(i){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return n=e,r=Ki(t.integerValue||t.doubleValue),n=Ki(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return ro(t.timestampValue,e.timestampValue);case 4:return ro($i(t),$i(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return function(t,e){t=Xi(t),e=Xi(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Ur(Ki(i.latitude),Ki(r.latitude)))?n:Ur(Ki(i.longitude),Ki(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=no(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;u=no(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function ro(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Qi(t),t=Qi(e),e=Ur(n.seconds,t.seconds);return 0!==e?e:Ur(n.nanos,t.nanos)}function io(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Qi(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Xi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Di.Lt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):kr();var e}(t)}function oo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Ct()}}function so(t){return t&&"integerValue"in t}function uo(t){return!!t&&"arrayValue"in t}function ao(t){return t&&"nullValue"in t}function co(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ho(t){return t&&"mapValue"in t}var fo=(yo.empty=function(){return new yo({mapValue:{}})},yo.prototype.field=function(t){if(t.bt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ho(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.Vt()])||null},yo.prototype.isEqual=function(t){return to(this.proto,t.proto)},yo),lo=(po.prototype.set=function(t,e){return this.jt(t,e),this},po.prototype.delete=function(t){return this.jt(t,null),this},po.prototype.jt=function(t,e){for(var n=this.Wt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Zi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.Vt(),e)},po.prototype.Gt=function(){var t=this.zt(ki.Nt(),this.Wt);return null!=t?new fo(t):this.Kt},po.prototype.zt=function(r,t){var i=this,o=!1,e=this.Kt.field(r),s=ho(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.zt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},po);function po(t){void 0===t&&(t=fo.empty()),this.Kt=t,this.Wt=new Map}function yo(t){this.proto=t}var vo,go,mo,Ie=function(t,e){this.key=t,this.version=e},wo=(f(Ao,mo=Ie),Ao.prototype.field=function(t){return this.Ht.field(t)},Ao.prototype.data=function(){return this.Ht},Ao.prototype.Yt=function(){return this.Ht.proto},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jt===t.Jt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ht.isEqual(t.Ht)},Ao.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ht.toString()+", {hasLocalMutations: "+this.Jt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return this.Jt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ao),bo=(f(To,go=Ie),To.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(To.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),To.prototype.isEqual=function(t){return t instanceof To&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},To),_o=(f(Io,vo=Ie),Io.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Io.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Io.prototype.isEqual=function(t){return t instanceof Io&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Io),Eo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Xt=null};function Io(){return null!==vo&&vo.apply(this,arguments)||this}function To(t,e,n){var r=this;return(r=go.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Ao(t,e,n,r){var i=this;return(i=mo.call(this,t,e)||this).Ht=n,i.Jt=!!r.Jt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function No(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Eo(t,e,n,r,i,o,s)}function Oo(t){var e=t;return null===e.Xt&&(t=e.path.Ct(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Ct()+t.op.toString()+io(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Ct()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ns(e.startAt)),e.endAt&&(t+="|ub:",t+=ns(e.endAt)),e.Xt=t),e.Xt}function So(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!to(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!os(t.startAt,e.startAt)&&os(t.endAt,e.endAt)}function Ro(t){return Di.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Lo,ko=(f(Do,Lo=function(){}),Do.create=function(t,e,n){return t.Ot()?"in"===e||"not-in"===e?this.Zt(t,e,n):new Vo(t,e,n):"array-contains"===e?new Yo(t,n):"in"===e?new Qo(t,n):"not-in"===e?new Ko(t,n):"array-contains-any"===e?new Xo(t,n):new Do(t,e,n)},Do.Zt=function(t,e,n){return new("in"===e?xo:Mo)(t,n)},Do.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.te(no(t,this.value)):null!==t&&Zi(this.value)===Zi(t)&&this.te(no(t,this.value))},Do.prototype.te=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},Do.prototype.ee=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Do);function Do(t,e,n){var r=this;return(r=Lo.call(this)||this).field=t,r.op=e,r.value=n,r}var Po,Co,Uo,Vo=(f(Fo,Uo=ko),Fo.prototype.matches=function(t){t=Di.At(t.key,this.key);return this.te(t)},Fo),xo=(f(qo,Co=ko),qo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qo),Mo=(f(jo,Po=ko),jo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},jo);function jo(t,e){var n=this;return(n=Po.call(this,t,"not-in",e)||this).keys=Bo(0,e),n}function qo(t,e){var n=this;return(n=Co.call(this,t,"in",e)||this).keys=Bo(0,e),n}function Fo(t,e,n){var r=this;return(r=Uo.call(this,t,e,n)||this).key=Di.Lt(n.referenceValue),r}function Bo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Di.Lt(t.referenceValue)})}var Go,zo,Ho,Wo,Yo=(f(es,Wo=ko),es.prototype.matches=function(t){t=t.field(this.field);return uo(t)&&eo(t.arrayValue,this.value)},es),Qo=(f(ts,Ho=ko),ts.prototype.matches=function(t){t=t.field(this.field);return null!==t&&eo(this.value.arrayValue,t)},ts),Ko=(f(Zo,zo=ko),Zo.prototype.matches=function(t){if(eo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!eo(this.value.arrayValue,t)},Zo),Xo=(f($o,Go=ko),$o.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!uo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return eo(e.value.arrayValue,t)})},$o),Jo=function(t,e){this.position=t,this.before=e};function $o(t,e){return Go.call(this,t,"array-contains-any",e)||this}function Zo(t,e){return zo.call(this,t,"not-in",e)||this}function ts(t,e){return Ho.call(this,t,"in",e)||this}function es(t,e){return Wo.call(this,t,"array-contains",e)||this}function ns(t){return(t.before?"b":"a")+":"+t.position.map(io).join(",")}var rs=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function is(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.Ot()?Di.At(Di.Lt(s.referenceValue),n.key):no(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function os(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!to(t.position[n],e.position[n]))return!1;return!0}var ss=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.ne=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.se=null,this.ie=null,this.startAt,this.endAt};function us(t){return new ss(t)}function as(t){return!yi(t.limit)&&"F"===t.limitType}function cs(t){return!yi(t.limit)&&"L"===t.limitType}function hs(t){return 0<t.ne.length?t.ne[0].field:null}function fs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ee())return r.field}return null}function ls(t){return null!==t.collectionGroup}function ps(t){var e=t;if(null===e.se){e.se=[];var n=fs(e),t=hs(e);if(null!==n&&null===t)n.Ot()||e.se.push(new rs(n)),e.se.push(new rs(ki.kt(),"asc"));else{for(var r=!1,i=0,o=e.ne;i<o.length;i++){var s=o[i];e.se.push(s),s.field.Ot()&&(r=!0)}r||(n=0<e.ne.length?e.ne[e.ne.length-1].dir:"asc",e.se.push(new rs(ki.kt(),n)))}}return e.se}function ds(t){var e=t;if(!e.ie)if("F"===e.limitType)e.ie=No(e.path,e.collectionGroup,ps(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ps(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new rs(o.field,s))}var u=e.endAt?new Jo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Jo(e.startAt.position,!e.startAt.before):null;e.ie=No(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ie}function ys(t,e,n){return new ss(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function vs(t,e){return So(ds(t),ds(e))&&t.limitType===e.limitType}function gs(t){return Oo(ds(t))+"|lt:"+t.limitType}function ms(t){return"Query(target="+(e=ds(t),n=e.path.Ct(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Ct()+" "+t.op+" "+io(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Ct()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ns(e.startAt)),e.endAt&&(n+=", endAt: "+ns(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ws(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Bt(e.collectionGroup)&&e.path.vt(n):Di.qt(e.path)?e.path.isEqual(n):e.path.St(n))&&function(t){for(var e=0,n=i.ne;e<n.length;e++){var r=n[e];if(!r.field.Ot()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||is(t.startAt,ps(t),n))&&(!t.endAt||!is(t.endAt,ps(t),n)));var e,n}function bs(u){return function(t,e){for(var n=!1,r=0,i=ps(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.Ot()?Di.At(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?no(n,t):kr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.Ot()}return 0}}var _s=(Es.prototype.ce=function(t){return new Es(this.target,this.targetId,this.re,t,this.oe,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Es.prototype.ae=function(t,e){return new Es(this.target,this.targetId,this.re,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Es.prototype.ue=function(t){return new Es(this.target,this.targetId,this.re,this.sequenceNumber,this.oe,t,this.resumeToken)},Es);function Es(t,e,n,r,i,o,s){void 0===i&&(i=Si.min()),void 0===o&&(o=Si.min()),void 0===s&&(s=xr.h),this.target=t,this.targetId=e,this.re=n,this.sequenceNumber=r,this.oe=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Is(t,e){if(t.he){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Ts(t){return{integerValue:""+t}}function As(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!vi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ts(e):Is(t,e);var n}o=function(){this.le=void 0};function Ns(t,e){return t instanceof js?so(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Os,Ss,Rs=(f(Ds,Ss=o),Ds),Ls=(f(ks,Os=o),ks);function ks(t){var e=this;return(e=Os.call(this)||this).elements=t,e}function Ds(){return null!==Ss&&Ss.apply(this,arguments)||this}function Ps(t,e){for(var n=Bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return to(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Cs,Us=(f(Vs,Cs=o),Vs);function Vs(t){var e=this;return(e=Cs.call(this)||this).elements=t,e}function xs(t,e){for(var n=Bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!to(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ms,js=(f(qs,Ms=o),qs);function qs(t,e){var n=this;return(n=Ms.call(this)||this).fe=t,n._e=e,n}function Fs(t){return Ki(t.integerValue||t.doubleValue)}function Bs(t){return uo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Gs(t,e){this.field=t,this.transform=e}function zs(t,e){this.version=t,this.transformResults=e}var Hs=(Ws.de=function(){return new Ws},Ws.exists=function(t){return new Ws(void 0,t)},Ws.updateTime=function(t){return new Ws(t)},Object.defineProperty(Ws.prototype,"we",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ws.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ws);function Ws(t,e){this.updateTime=t,this.exists=e}function Ys(t,e){return void 0!==t.updateTime?e instanceof wo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof wo}Ie=function(){};function Qs(t,e,n,r){return t instanceof Zs?function(t,e,n,r){if(!Ys(t.Ee,e))return e;var i=t.value;t.fieldTransforms&&(r=ou(t.fieldTransforms,n,e,r),i=su(t.fieldTransforms,i,r));e=Xs(e);return new wo(t.key,e,i,{Jt:!0})}(t,e,r,n):t instanceof tu?function(t,e,n,r){if(!Ys(t.Ee,e))return e;var i=Xs(e),r=ru(t,e,ou(t.fieldTransforms,n,e,r));return new wo(t.key,i,r,{Jt:!0})}(t,e,r,n):(e=e,Ys((t=t).Ee,e)?new bo(t.key,Si.min()):e)}function Ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ee.isEqual(e.Ee)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Vr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ls&&e instanceof Ls||t instanceof Us&&e instanceof Us?Vr(t.elements,e.elements,to):t instanceof js&&e instanceof js?to(t._e,e._e):t instanceof Rs&&e instanceof Rs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Te.isEqual(e.Te));var n,r}function Xs(t){return t instanceof wo?t.version:Si.min()}var Js,$s,Zs=(f(nu,$s=Ie),nu),tu=(f(eu,Js=Ie),eu);function eu(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Js.call(this)||this).key=t,o.data=e,o.Te=n,o.Ee=r,o.fieldTransforms=i,o.type=1,o}function nu(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=$s.call(this)||this).key=t,i.value=e,i.Ee=n,i.fieldTransforms=r,i.type=0,i}function ru(t,e,n){var r,i,o;return i=t,e=r=e instanceof wo?e.data():fo.empty(),o=new lo(e),i.Te.fields.forEach(function(t){var e;t.bt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Gt(),su(t.fieldTransforms,r,n)}function iu(t,e,n){var r=[];Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof wo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ls?Ps(o,s):o instanceof Us?xs(o,s):u))}return r}function ou(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof wo&&(h=n.field(a.field)),null===h&&r instanceof wo&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Rs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Ls?Ps(c,i):c instanceof Us?xs(c,i):(c=Ns(h=c,i),i=Fs(c)+Fs(h._e),so(c)&&so(h._e)?Ts(i):Is(h.fe,i))))}return o}function su(t,e,n){for(var r=new lo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Gt()}function uu(t){this.count=t}var au,cu,hu=(f(wu,cu=Ie),wu),fu=(f(mu,au=Ie),mu),lu=(gu.prototype.Ie=function(t,e){return new gu(this.At,this.root.Ie(t,e,this.At).copy(null,null,du.me,null,null))},gu.prototype.remove=function(t){return new gu(this.At,this.root.remove(t,this.At).copy(null,null,du.me,null,null))},gu.prototype.get=function(t){for(var e=this.root;!e.bt();){var n=this.At(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},gu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.bt();){var r=this.At(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},gu.prototype.bt=function(){return this.root.bt()},Object.defineProperty(gu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),gu.prototype.Ae=function(){return this.root.Ae()},gu.prototype.Re=function(){return this.root.Re()},gu.prototype.Pe=function(t){return this.root.Pe(t)},gu.prototype.forEach=function(n){this.Pe(function(t,e){return n(t,e),!1})},gu.prototype.toString=function(){var n=[];return this.Pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},gu.prototype.ye=function(t){return this.root.ye(t)},gu.prototype.ge=function(){return new pu(this.root,null,this.At,!1)},gu.prototype.Ve=function(t){return new pu(this.root,t,this.At,!1)},gu.prototype.pe=function(){return new pu(this.root,null,this.At,!0)},gu.prototype.be=function(t){return new pu(this.root,t,this.At,!0)},gu),pu=(vu.prototype.De=function(){var t=this.Se.pop(),e={key:t.key,value:t.value};if(this.ve)for(t=t.left;!t.bt();)this.Se.push(t),t=t.right;else for(t=t.right;!t.bt();)this.Se.push(t),t=t.left;return e},vu.prototype.Ce=function(){return 0<this.Se.length},vu.prototype.xe=function(){if(0===this.Se.length)return null;var t=this.Se[this.Se.length-1];return{key:t.key,value:t.value}},vu),du=(yu.prototype.copy=function(t,e,n,r,i){return new yu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},yu.prototype.bt=function(){return!1},yu.prototype.Pe=function(t){return this.left.Pe(t)||t(this.key,this.value)||this.right.Pe(t)},yu.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},yu.prototype.min=function(){return this.left.bt()?this:this.left.min()},yu.prototype.Ae=function(){return this.min().key},yu.prototype.Re=function(){return this.right.bt()?this.key:this.right.Re()},yu.prototype.Ie=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ie(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ie(t,e,n))).Ne()},yu.prototype.Fe=function(){if(this.left.bt())return yu.EMPTY;var t=this;return t.left.Oe()||t.left.left.Oe()||(t=t.ke()),(t=t.copy(null,null,null,t.left.Fe(),null)).Ne()},yu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.bt()||r.left.Oe()||r.left.left.Oe()||(r=r.ke()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Oe()&&(r=r.Me()),r.right.bt()||r.right.Oe()||r.right.left.Oe()||(r=r.$e()),0===e(t,r.key)){if(r.right.bt())return yu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Fe())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ne()},yu.prototype.Oe=function(){return this.color},yu.prototype.Ne=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Le()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Me()),t.left.Oe()&&t.right.Oe()&&(t=t.Be()),t},yu.prototype.ke=function(){var t=this.Be();return t.right.left.Oe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Me())).Le()).Be()),t},yu.prototype.$e=function(){var t=this.Be();return t.left.left.Oe()&&(t=(t=t.Me()).Be()),t},yu.prototype.Le=function(){var t=this.copy(null,null,yu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},yu.prototype.Me=function(){var t=this.copy(null,null,yu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},yu.prototype.Be=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},yu.prototype.qe=function(){var t=this.Ue();return Math.pow(2,t)<=this.size+1},yu.prototype.Ue=function(){if(this.Oe()&&this.left.Oe())throw kr();if(this.right.Oe())throw kr();var t=this.left.Ue();if(t!==this.right.Ue())throw kr();return t+(this.Oe()?0:1)},yu);function yu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:yu.RED,this.left=null!=r?r:yu.EMPTY,this.right=null!=i?i:yu.EMPTY,this.size=this.left.size+1+this.right.size}function vu(t,e,n,r){this.ve=r,this.Se=[];for(var i=1;!t.bt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ve?t.left:t.right;else{if(0===i){this.Se.push(t);break}this.Se.push(t),t=this.ve?t.right:t.left}}function gu(t,e){this.At=t,this.root=e||du.EMPTY}function mu(t,e){var n=this;return(n=au.call(this)||this).key=t,n.Ee=e,n.type=3,n.fieldTransforms=[],n}function wu(t,e){var n=this;return(n=cu.call(this)||this).key=t,n.Ee=e,n.type=2,n.fieldTransforms=[],n}function bu(){this.size=0}du.EMPTY=null,du.RED=!0,du.me=!1,du.EMPTY=(Object.defineProperty(bu.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(bu.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(bu.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(bu.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(bu.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),bu.prototype.copy=function(t,e,n,r,i){return this},bu.prototype.Ie=function(t,e,n){return new du(t,e)},bu.prototype.remove=function(t,e){return this},bu.prototype.bt=function(){return!0},bu.prototype.Pe=function(t){return!1},bu.prototype.ye=function(t){return!1},bu.prototype.Ae=function(){return null},bu.prototype.Re=function(){return null},bu.prototype.Oe=function(){return!1},bu.prototype.qe=function(){return!0},bu.prototype.Ue=function(){return 0},new bu);var _u=(Au.prototype.has=function(t){return null!==this.data.get(t)},Au.prototype.first=function(){return this.data.Ae()},Au.prototype.last=function(){return this.data.Re()},Object.defineProperty(Au.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Au.prototype.indexOf=function(t){return this.data.indexOf(t)},Au.prototype.forEach=function(n){this.data.Pe(function(t,e){return n(t),!1})},Au.prototype.Qe=function(t,e){for(var n=this.data.Ve(t[0]);n.Ce();){var r=n.De();if(0<=this.At(r.key,t[1]))return;e(r.key)}},Au.prototype.Ke=function(t,e){for(var n=void 0!==e?this.data.Ve(e):this.data.ge();n.Ce();)if(!t(n.De().key))return},Au.prototype.We=function(t){t=this.data.Ve(t);return t.Ce()?t.De().key:null},Au.prototype.ge=function(){return new Eu(this.data.ge())},Au.prototype.Ve=function(t){return new Eu(this.data.Ve(t))},Au.prototype.add=function(t){return this.copy(this.data.remove(t).Ie(t,!0))},Au.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Au.prototype.bt=function(){return this.data.bt()},Au.prototype.je=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Au.prototype.isEqual=function(t){if(!(t instanceof Au))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ge(),n=t.data.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(0!==this.At(r,i))return!1}return!0},Au.prototype.Dt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Au.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Au.prototype.copy=function(t){var e=new Au(this.At);return e.data=t,e},Au),Eu=(Tu.prototype.De=function(){return this.Ge.De().key},Tu.prototype.Ce=function(){return this.Ge.Ce()},Tu),Iu=new lu(Di.At);function Tu(t){this.Ge=t}function Au(t){this.At=t,this.data=new lu(this.At)}var Nu=new lu(Di.At);var Ou=new lu(Di.At);var Su=new _u(Di.At);function Ru(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Su,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Lu=new _u(Ur);var ku=(Yu.Je=function(t){return new Yu(t.At)},Yu.prototype.has=function(t){return null!=this.ze.get(t)},Yu.prototype.get=function(t){return this.ze.get(t)},Yu.prototype.first=function(){return this.He.Ae()},Yu.prototype.last=function(){return this.He.Re()},Yu.prototype.bt=function(){return this.He.bt()},Yu.prototype.indexOf=function(t){t=this.ze.get(t);return t?this.He.indexOf(t):-1},Object.defineProperty(Yu.prototype,"size",{get:function(){return this.He.size},enumerable:!1,configurable:!0}),Yu.prototype.forEach=function(n){this.He.Pe(function(t,e){return n(t),!1})},Yu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ze.Ie(t.key,t),e.He.Ie(t,null))},Yu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ze.remove(t),this.He.remove(e)):this},Yu.prototype.isEqual=function(t){if(!(t instanceof Yu))return!1;if(this.size!==t.size)return!1;for(var e=this.He.ge(),n=t.He.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(!r.isEqual(i))return!1}return!0},Yu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Yu.prototype.copy=function(t,e){var n=new Yu;return n.At=this.At,n.ze=t,n.He=e,n},Yu),Du=(Wu.prototype.track=function(t){var e=t.doc.key,n=this.Ye.get(e);!n||0!==t.type&&3===n.type?this.Ye=this.Ye.Ie(e,t):3===t.type&&1!==n.type?this.Ye=this.Ye.Ie(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ye=this.Ye.Ie(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ye=this.Ye.remove(e):1===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):kr()},Wu.prototype.Xe=function(){var n=[];return this.Ye.Pe(function(t,e){n.push(e)}),n},Wu),Pu=(Hu.sn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Hu(t,e,ku.Je(e),i,n,r,!0,!1)},Object.defineProperty(Hu.prototype,"hasPendingWrites",{get:function(){return!this.tn.bt()},enumerable:!1,configurable:!0}),Hu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.tn.isEqual(t.tn)&&vs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ze.isEqual(t.Ze)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Hu),Cu=(zu.un=function(t,e){var n=new Map;return n.set(t,Uu.hn(t,e)),new zu(Si.min(),n,Lu,Iu,Ru())},zu),Uu=(Gu.hn=function(t,e){return new Gu(xr.h,e,Ru(),Ru(),Ru())},Gu),Vu=function(t,e,n,r){this.wn=t,this.removedTargetIds=e,this.key=n,this.En=r},xu=function(t,e){this.targetId=t,this.Tn=e},Mu=function(t,e,n,r){void 0===n&&(n=xr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ju=(Object.defineProperty(Bu.prototype,"ln",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Bu.prototype,"resumeToken",{get:function(){return this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Bu.prototype,"yn",{get:function(){return 0!==this.In},enumerable:!1,configurable:!0}),Object.defineProperty(Bu.prototype,"gn",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Bu.prototype.Vn=function(t){0<t.o()&&(this.Pn=!0,this.An=t)},Bu.prototype.pn=function(){var n=Ru(),r=Ru(),i=Ru();return this.mn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Uu(this.An,this.Rn,n,r,i)},Bu.prototype.bn=function(){this.Pn=!1,this.mn=Ku()},Bu.prototype.vn=function(t,e){this.Pn=!0,this.mn=this.mn.Ie(t,e)},Bu.prototype.Sn=function(t){this.Pn=!0,this.mn=this.mn.remove(t)},Bu.prototype.Dn=function(){this.In+=1},Bu.prototype.Cn=function(){--this.In},Bu.prototype.xn=function(){this.Pn=!0,this.Rn=!0},Bu),qu=(Fu.prototype.$n=function(t){for(var e=0,n=t.wn;e<n.length;e++){var r=n[e];t.En instanceof wo?this.Ln(r,t.En):t.En instanceof bo&&this.Bn(r,t.key,t.En)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Bn(r,t.key,t.En)},Fu.prototype.qn=function(n){var r=this;this.Un(n,function(t){var e=r.Qn(t);switch(n.state){case 0:r.Kn(t)&&e.Vn(n.resumeToken);break;case 1:e.Cn(),e.yn||e.bn(),e.Vn(n.resumeToken);break;case 2:e.Cn(),e.yn||r.removeTarget(t);break;case 3:r.Kn(t)&&(e.xn(),e.Vn(n.resumeToken));break;case 4:r.Kn(t)&&(r.Wn(t),e.Vn(n.resumeToken));break;default:kr()}})},Fu.prototype.Un=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fn.forEach(function(t,e){r.Kn(e)&&n(e)})},Fu.prototype.jn=function(t){var e=t.targetId,n=t.Tn.count,t=this.Gn(e);t&&(Ro(t=t.target)?0===n?(t=new Di(t.path),this.Bn(e,t,new bo(t,Si.min()))):Dr(1===n):this.zn(e)!==n&&(this.Wn(e),this.Mn=this.Mn.add(e)))},Fu.prototype.Hn=function(r){var i=this,o=new Map;this.Fn.forEach(function(t,e){var n=i.Gn(e);n&&(t.ln&&Ro(n.target)&&(n=new Di(n.target.path),null!==i.On.get(n)||i.Jn(e,n)||i.Bn(e,n,new bo(n,r))),t.gn&&(o.set(e,t.pn()),t.bn()))});var s=Ru();this.kn.forEach(function(t,e){var n=!0;e.Ke(function(t){t=i.Gn(t);return!t||2===t.re||(n=!1)}),n&&(s=s.add(t))});var t=new Cu(r,o,this.Mn,this.On,s);return this.On=Iu,this.kn=Qu(),this.Mn=new _u(Ur),t},Fu.prototype.Ln=function(t,e){var n;this.Kn(t)&&(n=this.Jn(t,e.key)?2:0,this.Qn(t).vn(e.key,n),this.On=this.On.Ie(e.key,e),this.kn=this.kn.Ie(e.key,this.Yn(e.key).add(t)))},Fu.prototype.Bn=function(t,e,n){var r;this.Kn(t)&&(r=this.Qn(t),this.Jn(t,e)?r.vn(e,1):r.Sn(e),this.kn=this.kn.Ie(e,this.Yn(e).delete(t)),n&&(this.On=this.On.Ie(e,n)))},Fu.prototype.removeTarget=function(t){this.Fn.delete(t)},Fu.prototype.zn=function(t){var e=this.Qn(t).pn();return this.Nn.Xn(t).size+e._n.size-e.dn.size},Fu.prototype.Dn=function(t){this.Qn(t).Dn()},Fu.prototype.Qn=function(t){var e=this.Fn.get(t);return e||(e=new ju,this.Fn.set(t,e)),e},Fu.prototype.Yn=function(t){var e=this.kn.get(t);return e||(e=new _u(Ur),this.kn=this.kn.Ie(t,e)),e},Fu.prototype.Kn=function(t){var e=null!==this.Gn(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},Fu.prototype.Gn=function(t){var e=this.Fn.get(t);return e&&e.yn?null:this.Nn.Zn(t)},Fu.prototype.Wn=function(e){var n=this;this.Fn.set(e,new ju),this.Nn.Xn(e).forEach(function(t){n.Bn(e,t,null)})},Fu.prototype.Jn=function(t,e){return this.Nn.Xn(t).has(e)},Fu);function Fu(t){this.Nn=t,this.Fn=new Map,this.On=Iu,this.kn=Qu(),this.Mn=new _u(Ur)}function Bu(){this.In=0,this.mn=Ku(),this.An=xr.h,this.Rn=!1,this.Pn=!0}function Gu(t,e,n,r,i){this.resumeToken=t,this.ln=e,this._n=n,this.fn=r,this.dn=i}function zu(t,e,n,r,i){this.oe=t,this.rn=e,this.on=n,this.cn=r,this.an=i}function Hu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ze=n,this.docChanges=r,this.tn=i,this.fromCache=o,this.en=s,this.nn=u}function Wu(){this.Ye=new lu(Di.At)}function Yu(n){this.At=n?function(t,e){return n(t,e)||Di.At(t.key,e.key)}:function(t,e){return Di.At(t.key,e.key)},this.ze=Nu,this.He=new lu(this.At)}function Qu(){return new lu(Di.At)}function Ku(){return new lu(Di.At)}var Xu={asc:"ASCENDING",desc:"DESCENDING"},Ju={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$u=function(t,e){this.O=t,this.he=e};function Zu(t,e){return t.he?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ta(t,e){return t.he?e.toBase64():e.toUint8Array()}function ea(t){return Dr(!!t),Si.wt((t=Qi(t),new Oi(t.seconds,t.nanos)))}function na(t,e){return new Ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Ct()}function ra(t){t=Ri.xt(t);return Dr(ma(t)),t}function ia(t,e){return na(t.O,e.path)}function oa(t,e){e=ra(e);if(e.get(1)!==t.O.projectId)throw new Fr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.O.projectId);if(e.get(3)!==t.O.database)throw new Fr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.O.database);return new Di(aa(e))}function sa(t,e){return na(t.O,e)}function ua(t){return new Ri(["projects",t.O.projectId,"databases",t.O.database]).Ct()}function aa(t){return Dr(4<t.length&&"documents"===t.get(4)),t.Pt(5)}function ca(t,e,n){return{name:ia(t,e),fields:n.proto.mapValue.fields}}function ha(t,e){var n,r,i;if(e instanceof Zs)n={update:ca(t,e.key,e.value)};else if(e instanceof hu)n={delete:ia(t,e.key)};else if(e instanceof tu)n={update:ca(t,e.key,e.data),updateMask:(i=e.Te,r=[],i.fields.forEach(function(t){return r.push(t.Ct())}),{fieldPaths:r})};else{if(!(e instanceof fu))return kr();n={verify:ia(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Rs)return{fieldPath:t.field.Ct(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ls)return{fieldPath:t.field.Ct(),appendMissingElements:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.Ct(),removeAllFromArray:{values:e.elements}};if(e instanceof js)return{fieldPath:t.field.Ct(),increment:e._e};throw kr()})),e.Ee.we||(n.currentDocument=void 0!==(i=e.Ee).updateTime?{updateTime:(e=t,t=i.updateTime,Zu(e,t.Tt()))}:void 0!==i.exists?{exists:i.exists}:kr()),n}function fa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=sa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=sa(t,r.yt()),n.structuredQuery.from=[{collectionId:r.Vt()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(co(t.value))return{unaryFilter:{field:ya(t.field),op:"IS_NAN"}};if(ao(t.value))return{unaryFilter:{field:ya(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(co(t.value))return{unaryFilter:{field:ya(t.field),op:"IS_NOT_NAN"}};if(ao(t.value))return{unaryFilter:{field:ya(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ya(t.field),op:(e=t.op,Ju[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ya((t=t).field),direction:(t=t.dir,Xu[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.he||yi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=pa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=pa(e.endAt)),n}function la(t){var e=4===(o=ra(t.parent)).length?Ri.Nt():aa(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Dr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ga(t)]:void 0!==t.fieldFilter?[(n=t,ko.create(va(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new rs(va((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=yi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=da(n.startAt));var u=null;return n.endAt&&(u=da(n.endAt)),new ss(e,i,t,o,r,"F",s,u)}function pa(t){return{before:t.before,values:t.position}}function da(t){var e=!!t.before,t=t.values||[];return new Jo(t,e)}function ya(t){return{fieldPath:t.Ct()}}function va(t){return ki.Mt(t.fieldPath)}function ga(t){switch(t.unaryFilter.op){case"IS_NAN":var e=va(t.unaryFilter.field);return ko.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=va(t.unaryFilter.field);return ko.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=va(t.unaryFilter.field);return ko.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=va(t.unaryFilter.field);return ko.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}function ma(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function wa(t){return new $u(t,!0)}var ba=(_a.prototype.catch=function(t){return this.next(void 0,t)},_a.prototype.next=function(r,i){var o=this;return this.ss&&kr(),this.ss=!0,this.ns?this.error?this.rs(i,this.error):this.os(r,this.result):new _a(function(e,n){o.ts=function(t){o.os(r,t).next(e,n)},o.es=function(t){o.rs(i,t).next(e,n)}})},_a.prototype.cs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},_a.prototype.us=function(t){try{var e=t();return e instanceof _a?e:_a.resolve(e)}catch(t){return _a.reject(t)}},_a.prototype.os=function(t,e){return t?this.us(function(){return t(e)}):_a.resolve(e)},_a.prototype.rs=function(t,e){return t?this.us(function(){return t(e)}):_a.reject(e)},_a.resolve=function(n){return new _a(function(t,e){t(n)})},_a.reject=function(n){return new _a(function(t,e){e(n)})},_a.hs=function(t){return new _a(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},_a.ls=function(t){for(var n=_a.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?_a.resolve(t):e()})}(r[e]);return n},_a.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.hs(i)},_a);function _a(t){var e=this;this.ts=null,this.es=null,this.result=void 0,this.error=void 0,this.ns=!1,this.ss=!1,t(function(t){e.ns=!0,e.result=t,e.ts&&e.ts(t)},function(t){e.ns=!0,e.error=t,e.es&&e.es(t)})}function Ea(t){return"IndexedDbTransactionError"===t.name}var Ia=(Ta.qs=function(t,e,n,r,i){i=new Ta(t,e,Date.now()+n,r,i);return i.start(n),i},Ta.prototype.start=function(t){var e=this;this.Us=setTimeout(function(){return e.Qs()},t)},Ta.prototype.Ks=function(){return this.Qs()},Ta.prototype.cancel=function(t){null!==this.Us&&(this.clearTimeout(),this.Bs.reject(new Fr(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ta.prototype.Qs=function(){var e=this;this.ks.Ws(function(){return null!==e.Us?(e.clearTimeout(),e.op().then(function(t){return e.Bs.resolve(t)})):Promise.resolve()})},Ta.prototype.clearTimeout=function(){null!==this.Us&&(this.Ls(this),clearTimeout(this.Us),this.Us=null)},Ta);function Ta(t,e,n,r,i){this.ks=t,this.Ms=e,this.$s=n,this.op=r,this.Ls=i,this.Bs=new Ai,this.then=this.Bs.promise.then.bind(this.Bs.promise),this.Bs.promise.catch(function(t){})}function Aa(t,e){if(Sr("AsyncQueue",e+": "+t),Ea(t))return new Fr(qr.UNAVAILABLE,e+": "+t);throw t}var Na,Oa,Sa,Ra=(qa.prototype.reset=function(){this.Js=0},qa.prototype.Zs=function(){this.Js=this.Hs},qa.prototype.ti=function(t){var e=this;this.cancel();var n=Math.floor(this.Js+this.ei()),r=Math.max(0,Date.now()-this.Xs),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Js+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ys=this.js.ni(this.Ms,i,function(){return e.Xs=Date.now(),t()}),this.Js*=this.zs,this.Js<this.Gs&&(this.Js=this.Gs),this.Js>this.Hs&&(this.Js=this.Hs)},qa.prototype.si=function(){null!==this.Ys&&(this.Ys.Ks(),this.Ys=null)},qa.prototype.cancel=function(){null!==this.Ys&&(this.Ys.cancel(),this.Ys=null)},qa.prototype.ei=function(){return(Math.random()-.5)*this.Js},qa),o=(ja.prototype.hi=function(){return 1===this.state||2===this.state||4===this.state},ja.prototype.li=function(){return 2===this.state},ja.prototype.start=function(){3!==this.state?this.auth():this._i()},ja.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hi()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ja.prototype.fi=function(){this.state=0,this.ui.reset()},ja.prototype.di=function(){var t=this;this.li()&&null===this.ai&&(this.ai=this.js.ni(this.ii,6e4,function(){return t.wi()}))},ja.prototype.Ei=function(t){this.Ti(),this.stream.send(t)},ja.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.li()?[2,this.close(0)]:[2]})})},ja.prototype.Ti=function(){this.ai&&(this.ai.cancel(),this.ai=null)},ja.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti(),this.ui.cancel(),this.ci++,3!==e?this.ui.reset():n&&n.code===qr.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.ui.Zs()):n&&n.code===qr.UNAUTHENTICATED&&this.oi.g(),null!==this.stream&&(this.Ii(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Z(n)];case 1:return t.sent(),[2]}})})},ja.prototype.Ii=function(){},ja.prototype.auth=function(){var n=this;this.state=1;var t=this.mi(this.ci),e=this.ci;this.oi.getToken().then(function(t){n.ci===e&&n.Ai(t)},function(e){t(function(){var t=new Fr(qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ri(t)})})},ja.prototype.Ai=function(t){var e=this,n=this.mi(this.ci);this.stream=this.Pi(t),this.stream.Y(function(){n(function(){return e.state=2,e.listener.Y()})}),this.stream.Z(function(t){n(function(){return e.Ri(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ja.prototype._i=function(){var t=this;this.state=4,this.ui.ti(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ja.prototype.Ri=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ja.prototype.mi=function(e){var n=this;return function(t){n.js.Ws(function(){return n.ci===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ja),La=(f(Ma,Sa=o),Ma.prototype.Pi=function(t){return this.ri.ft("Listen",t)},Ma.prototype.onMessage=function(t){this.ui.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:kr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.he?(Dr(void 0===s||"string"==typeof s),xr.fromBase64String(s||"")):(Dr(void 0===s||s instanceof Uint8Array),xr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?qr.UNKNOWN:bi(c.code),new Fr(a,c.message||"")),s=new Mu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=oa(t,n.document.name),i=ea(n.document.updateTime);var u=new fo({mapValue:{fields:n.document.fields}}),a=(o=new wo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new Vu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=oa(t,n.document),i=n.readTime?ea(n.readTime):Si.min(),u=new bo(r,i),o=n.removedTargetIds||[],s=new Vu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=oa(t,n.document),i=n.removedTargetIds||[],s=new Vu([],i,r,null);else{if(!("filter"in e))return kr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new uu(n),i=e.targetId,s=new xu(i,r)}return s}(this.fe,t),t=function(t){if(!("targetChange"in t))return Si.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?ea(t.readTime):Si.min()}(t);return this.listener.yi(e,t)},Ma.prototype.gi=function(t){var e,n,r,i={};i.database=ua(this.fe),i.addTarget=(e=this.fe,(r=Ro(r=(n=t).target)?{documents:{documents:[sa(e,r.path)]}}:{query:fa(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=ta(e,n.resumeToken):0<n.oe.u(Si.min())&&(r.readTime=Zu(e,n.oe.Tt())),r);var o,t=(this.fe,o=t,null==(t=function(){switch(o.re){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Ei(i)},Ma.prototype.Vi=function(t){var e={};e.database=ua(this.fe),e.removeTarget=t,this.Ei(e)},Ma),ka=(f(xa,Oa=o),Object.defineProperty(xa.prototype,"bi",{get:function(){return this.pi},enumerable:!1,configurable:!0}),xa.prototype.start=function(){this.pi=!1,this.lastStreamToken=void 0,Oa.prototype.start.call(this)},xa.prototype.Ii=function(){this.pi&&this.vi([])},xa.prototype.Pi=function(t){return this.ri.ft("Write",t)},xa.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pi){this.ui.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Dr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?ea(t.updateTime):ea(e);n.isEqual(Si.min())&&(n=ea(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new zs(n,e)}(t,r)})):[]),n=ea(t.commitTime);return this.listener.Si(n,e)}var n,r;return Dr(!t.writeResults||0===t.writeResults.length),this.pi=!0,this.listener.Di()},xa.prototype.Ci=function(){var t={};t.database=ua(this.fe),this.Ei(t)},xa.prototype.vi=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ha(e.fe,t)})};this.Ei(t)},xa),Da=(f(Va,Na=function(){}),Va.prototype.Ni=function(){if(this.xi)throw new Fr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},Va.prototype.at=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri.at(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.g(),t})},Va.prototype._t=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri._t(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.g(),t})},Va.prototype.terminate=function(){this.xi=!1},Va),Ie=(Ua.prototype.Oi=function(t){this.Fi.push(t)},Ua.prototype.ki=function(){this.Fi.forEach(function(t){return t()})},Ua),Pa=(Ca.prototype.Ji=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ca.prototype.next=function(){var t=++this.previousValue;return this.Yi&&this.Yi(t),t},Ca);function Ca(t,e){var n=this;this.previousValue=t,e&&(e.Hi=function(t){return n.Ji(t)},this.Yi=function(t){return e.Xi(t)})}function Ua(){this.Fi=[]}function Va(t,e,n){var r=this;return(r=Na.call(this)||this).credentials=t,r.ri=e,r.fe=n,r.xi=!1,r}function xa(t,e,n,r,i){var o=this;return(o=Oa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).fe=r,o.pi=!1,o}function Ma(t,e,n,r,i){var o=this;return(o=Sa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).fe=r,o}function ja(t,e,n,r,i,o){this.js=t,this.ii=n,this.ri=r,this.oi=i,this.listener=o,this.state=0,this.ci=0,this.ai=null,this.stream=null,this.ui=new Ra(t,e)}function qa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.js=t,this.Ms=e,this.Gs=n,this.zs=r,this.Hs=i,this.Js=0,this.Ys=null,this.Xs=Date.now(),this.reset()}function Fa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==qr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}Pa.Zi=-1;function Ba(t,e){this.progress=t,this.tr=e}var Ga=(Ka.prototype.nr=function(t,e,n){for(var r,i,o,s,u,a,c=n.sr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Zs?(u=o,f=(s=r).value,u.transformResults&&(a=iu(s.fieldTransforms,i,u.transformResults),f=su(s.fieldTransforms,f,a)),new wo(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof tu?function(t,e,n){if(!Ys(t.Ee,e))return new _o(t.key,n.version);e=ru(t,e,n.transformResults?iu(t.fieldTransforms,e,n.transformResults):[]);return new wo(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new bo(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ka.prototype.ir=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Qs(i,e,e,this.er))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Qs(a,e,o,this.er))}return e},Ka.prototype.rr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ir(t.key,n.get(t.key));e&&(i=i.Ie(t.key,e))}),i},Ka.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ru())},Ka.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Ks)&&Vr(this.baseMutations,t.baseMutations,Ks)},Ka),za=(Qa.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Ou,i=t.mutations,o=0;o<i.length;o++)r=r.Ie(i[o].key,n[o].version);return new Qa(t,e,n,r)},Qa),Ha=(Ya.prototype.get=function(t){var e=this.ur(t),e=this.lr[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.hr(o,t))return i}},Ya.prototype.has=function(t){return void 0!==this.get(t)},Ya.prototype.set=function(t,e){var n=this.ur(t),r=this.lr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.hr(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.lr[n]=[[t,e]]},Ya.prototype.delete=function(t){var e=this.ur(t),n=this.lr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.hr(n[r][0],t))return 1===n.length?delete this.lr[e]:n.splice(r,1),!0;return!1},Ya.prototype.forEach=function(s){Gi(this.lr,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Ya.prototype.bt=function(){return zi(this.lr)},Ya),o=(Wa.prototype.wr=function(t){t=this._r.get(t);return t?t.readTime:Si.min()},Wa.prototype.Er=function(t,e){this.Tr(),this._r.set(t.key,{Ir:t,readTime:e})},Wa.prototype.mr=function(t,e){void 0===e&&(e=null),this.Tr(),this._r.set(t,{Ir:null,readTime:e})},Wa.prototype.Ar=function(t,e){this.Tr();var n=this._r.get(e);return void 0!==n?ba.resolve(n.Ir):this.Rr(t,e)},Wa.prototype.getEntries=function(t,e){return this.Pr(t,e)},Wa.prototype.apply=function(t){return this.Tr(),this.dr=!0,this.yr(t)},Wa.prototype.Tr=function(){},Wa);function Wa(){this._r=new Ha(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dr=!1}function Ya(t,e){this.ur=t,this.hr=e,this.lr={}}function Qa(t,e,n,r){this.batch=t,this.cr=e,this.sr=n,this.ar=r}function Ka(t,e,n,r){this.batchId=t,this.er=e,this.baseMutations=n,this.mutations=r}function Xa(t,e,n){if(!n)throw new Fr(qr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ja(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Fr(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function $a(t,e,n,r){if(!0===e&&!0===r)throw new Fr(qr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Za(t){if(!Di.qt(t))throw new Fr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function tc(t){if(Di.qt(t))throw new Fr(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ec(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function nc(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Fr(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=ec(t);throw new Fr(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function rc(t,e){if(e<=0)throw new Fr(qr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}function ic(t){this.co=t}var oc=(cc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},cc),sc=new Map,uc=(Object.defineProperty(ac.prototype,"app",{get:function(){if(!this.Jr)throw new Fr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(ac.prototype,"Yr",{get:function(){return this.Gr},enumerable:!1,configurable:!0}),Object.defineProperty(ac.prototype,"Xr",{get:function(){return void 0!==this.Zr},enumerable:!1,configurable:!0}),ac.prototype.eo=function(t){if(this.Gr)throw new Fr(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.jr=new oc(t),void 0!==t.credentials&&(this.Hr=function(t){if(!t)return new ti;switch(t.type){case"gapi":var e=t.client;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ri(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Fr(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},ac.prototype.no=function(){return this.jr},ac.prototype.so=function(){return this.Gr=!0,this.jr},ac.prototype._delete=function(){return this.Zr||(this.Zr=this.io()),this.Zr},ac.prototype.io=function(){return(t=sc.get(this))&&(Or("ComponentProvider","Removing Datastore"),sc.delete(this),t.terminate()),Promise.resolve();var t},ac);function ac(t,e){this.Wr="(lite)",this.jr=new oc({}),this.Gr=!1,t instanceof oi?(this.zr=t,this.Hr=new ti):(this.Jr=t,this.zr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Fr(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oi(t.options.projectId)}(t),this.Hr=new ei(e))}function cc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Fr(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Fr(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,$a("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function hc(t){var e=la({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ys(e,e.limit,"L"):e}var fc=(Tc.prototype.fo=function(t,e){return this._o.add(e),ba.resolve()},Tc.prototype.wo=function(t,e){return ba.resolve(this._o.getEntries(e))},Tc),lc=(Ic.prototype.add=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e]||new _u(Ri.At),t=!r.has(n);return this.index[e]=r.add(n),t},Ic.prototype.has=function(t){var e=t.Vt(),t=t.yt(),e=this.index[e];return e&&e.has(t)},Ic.prototype.getEntries=function(t){return(this.index[t]||new _u(Ri.At)).Dt()},Ic),pc=(Ec.prototype.next=function(){return this.Lo+=2,this.Lo},Ec.Bo=function(){return new Ec(0)},Ec.qo=function(){return new Ec(-1)},Ec),dc=(_c.prototype.Pa=function(e,n){var r=this;return this.Ra.So(e,n).next(function(t){return r.ya(e,n,t)})},_c.prototype.ya=function(t,r,i){return this.Kc.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ir(r,t);return t})},_c.prototype.ga=function(t,e,i){var o=Iu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ir(t,e);o=o.Ie(t,e)}),o},_c.prototype.Va=function(e,t){var n=this;return this.Kc.getEntries(e,t).next(function(t){return n.pa(e,t)})},_c.prototype.pa=function(e,r){var i=this;return this.Ra.Do(e,r).next(function(t){var t=i.ga(e,r,t),n=Iu;return t.forEach(function(t,e){e=e||new bo(t,Si.min()),n=n.Ie(t,e)}),n})},_c.prototype.Pc=function(t,e,n){return r=e,Di.qt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ba(t,e.path):ls(e)?this.va(t,e,n):this.Sa(t,e,n);var r},_c.prototype.ba=function(t,e){return this.Pa(t,new Di(e)).next(function(t){var e=Nu;return t instanceof wo&&(e=e.Ie(t.key,t)),e})},_c.prototype.va=function(n,r,i){var o=this,s=r.collectionGroup,u=Nu;return this.To.wo(n,s).next(function(t){return ba.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new ss(t,null,e.ne.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Sa(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ie(t,e)})})}).next(function(){return u})})},_c.prototype.Sa=function(e,n,t){var c,h,r=this;return this.Kc.Pc(e,n,t).next(function(t){return c=t,r.Ra.xo(e,n)}).next(function(t){return h=t,r.Da(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Qs(s,a,a,r.er);c=a instanceof wo?c.Ie(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){ws(n,e)||(c=c.remove(t))}),c})},_c.prototype.Da=function(t,e,n){for(var r=Ru(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof tu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kc.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wo&&(c=c.Ie(t,e))}),c})},_c),yc=(bc.Na=function(t,e){for(var n=Ru(),r=Ru(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new bc(t,e.fromCache,n,r)},bc),vc=(wc.prototype.Fa=function(t){this.Oa=t},wc.prototype.Pc=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.ne.length||1===r.ne.length&&r.ne[0].field.Ot())||i.isEqual(Si.min())?this.ka(e,r):this.Oa.Va(e,o).next(function(t){var n=s.Ma(r,t);return(as(r)||cs(r))&&s.$a(r.limitType,n,o,i)?s.ka(e,r):(Nr()<=u.DEBUG&&Or("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ms(r)),s.Oa.Pc(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ie(t.key,t)}),e}))})},wc.prototype.Ma=function(n,t){var r=new _u(bs(n));return t.forEach(function(t,e){e instanceof wo&&ws(n,e)&&(r=r.add(e))}),r},wc.prototype.$a=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},wc.prototype.ka=function(t,e){return Nr()<=u.DEBUG&&Or("QueryEngine","Using full collection scan to execute query:",ms(e)),this.Oa.Pc(t,e,Si.min())},wc),gc=(mc.prototype.Fr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ur(t,n.Ba)})},mc);function mc(t,e,n,r){this.persistence=t,this.La=e,this.fe=r,this.Ba=new lu(Ur),this.qa=new Ha(Oo,So),this.Ua=Si.min(),this.Ra=t.Ta(n),this.Qa=t._c(),this.Qc=t.ac(),this.Ka=new dc(this.Qa,this.Ra,this.persistence.Ia()),this.Wc=t.ma(),this.La.Fa(this.Ka)}function wc(){}function bc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ca=n,this.xa=r}function _c(t,e,n){this.Kc=t,this.Ra=e,this.To=n}function Ec(t){this.Lo=t}function Ic(){this.index={}}function Tc(){this._o=new lc}function Ac(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ra,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ra.vo(v).next(function(t){return g=t,n=e.persistence.Ta(o),m=new dc(e.Qa,n,e.persistence.Ia()),n.vo(v)}).next(function(t){for(var e=[],n=[],r=Ru(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Va(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Ra=n,e.Ka=m,e.La.Fa(e.Ka),r)]}})})}function Nc(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Qa.lc({yc:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ba.resolve(),n.forEach(function(n){u=u.next(function(){return o.Ar(r,n)}).next(function(t){var e=t,t=i.ar.get(n);Dr(null!==t),(!e||e.version.u(t)<0)&&(e=s.nr(n,e,i))&&o.Er(e,i.cr)})}),u.next(function(){return e.Ra.No(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Ra.ko(t)}).next(function(){return f.Ka.Va(t,a)})})}function Oc(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Qc.Wo(t)})}function Sc(t,r){var a=t,c=r.oe,h=a.Ba;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Qa.lc({yc:!0});h=a.Ba;var u=[];r.rn.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Qc.ic(s,t.dn,e).next(function(){return a.Qc.nc(s,t._n,e)})),0<(i=t.resumeToken).o()&&(n=o.ae(i,c).ce(s.oo),h=h.Ie(e,n),r=o,i=t,Dr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.oe.Et()-r.oe.Et()||0<i._n.size+i.fn.size+i.dn.size)&&u.push(a.Qc.Yo(s,n))))});var e,n=Iu;return r.cn.forEach(function(t,e){r.an.has(t)&&u.push(a.persistence.Io.fc(s,t))}),u.push(Rc(s,t,r.cn,c,void 0).next(function(t){n=t})),c.isEqual(Si.min())||(e=a.Qc.Wo(s).next(function(t){return a.Qc.Go(s,s.oo,c)}),u.push(e)),ba.hs(u).next(function(){return t.apply(s)}).next(function(){return a.Ka.pa(s,n)})}).then(function(t){return a.Ba=h,t})}function Rc(t,s,e,u,a){var n=Ru();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Iu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof bo&&e.version.isEqual(Si.min())?(s.mr(t,r),o=o.Ie(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.Er(e,r),o=o.Ie(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Lc(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Qc.ec(e,r).next(function(t){return t?(n=t,ba.resolve(n)):i.Qc.Uo(e).next(function(t){return n=new _s(r,t,0,e.oo),i.Qc.zo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ba.get(t.targetId);return(null===e||0<t.oe.u(e.oe))&&(i.Ba=i.Ba.Ie(t.targetId,t),i.qa.set(r,t.targetId)),t})}function kc(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ba.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Io.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ea(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ba=e.Ba.remove(o),e.qa.delete(n.target),[2]}})})}function Dc(t,o,s){var u=t,a=Si.min(),c=Ru();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ds(o),(void 0!==(t=(i=t).qa.get(r))?ba.resolve(i.Ba.get(t)):i.Qc.ec(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Qc.oc(e,t.targetId).next(function(t){c=t})}).next(function(){return u.La.Pc(e,o,s?a:Si.min(),s?c:Ru())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}var Pc,Cc,Uc=(ih.prototype.ao=function(t,e){return ba.resolve(this.Xa.get(e))},ih.prototype.uo=function(t,e){return this.Xa.set(e.id,{id:e.id,version:e.version,createTime:ea(e.createTime)}),ba.resolve()},ih.prototype.ho=function(t,e){return ba.resolve(this.Za.get(e))},ih.prototype.lo=function(t,e){return this.Za.set(e.name,{name:(e=e).name,query:hc(e.bundledQuery),readTime:ea(e.readTime)}),ba.resolve()},ih),Vc=(rh.prototype.bt=function(){return this.tu.bt()},rh.prototype.sc=function(t,e){e=new xc(t,e);this.tu=this.tu.add(e),this.nu=this.nu.add(e)},rh.prototype.iu=function(t,e){var n=this;t.forEach(function(t){return n.sc(t,e)})},rh.prototype.rc=function(t,e){this.ru(new xc(t,e))},rh.prototype.ou=function(t,e){var n=this;t.forEach(function(t){return n.rc(t,e)})},rh.prototype.cu=function(t){var e=this,n=new Di(new Ri([])),r=new xc(n,t),t=new xc(n,t+1),i=[];return this.nu.Qe([r,t],function(t){e.ru(t),i.push(t.key)}),i},rh.prototype.au=function(){var e=this;this.tu.forEach(function(t){return e.ru(t)})},rh.prototype.ru=function(t){this.tu=this.tu.delete(t),this.nu=this.nu.delete(t)},rh.prototype.uu=function(t){var e=new Di(new Ri([])),n=new xc(e,t),t=new xc(e,t+1),r=Ru();return this.nu.Qe([n,t],function(t){r=r.add(t.key)}),r},rh.prototype.Mo=function(t){var e=new xc(t,0),e=this.tu.We(e);return null!==e&&t.isEqual(e.key)},rh),xc=(nh.eu=function(t,e){return Di.At(t.key,e.key)||Ur(t.hu,e.hu)},nh.su=function(t,e){return Ur(t.hu,e.hu)||Di.At(t.key,e.key)},nh),Mc=(eh.prototype.Ro=function(t){return ba.resolve(0===this.Ra.length)},eh.prototype.Po=function(t,e,n,r){var i=this.lu;this.lu++,0<this.Ra.length&&this.Ra[this.Ra.length-1];n=new Ga(i,e,n,r);this.Ra.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this._u=this._u.add(new xc(u.key,i)),this.To.fo(t,u.key.path.yt())}return ba.resolve(n)},eh.prototype.yo=function(t,e){return ba.resolve(this.fu(e))},eh.prototype.po=function(t,e){e+=1,e=this.du(e),e=e<0?0:e;return ba.resolve(this.Ra.length>e?this.Ra[e]:null)},eh.prototype.bo=function(){return ba.resolve(0===this.Ra.length?-1:this.lu-1)},eh.prototype.vo=function(t){return ba.resolve(this.Ra.slice())},eh.prototype.So=function(t,e){var n=this,r=new xc(e,0),e=new xc(e,Number.POSITIVE_INFINITY),i=[];return this._u.Qe([r,e],function(t){t=n.fu(t.hu);i.push(t)}),ba.resolve(i)},eh.prototype.Do=function(t,e){var n=this,r=new _u(Ur);return e.forEach(function(t){var e=new xc(t,0),t=new xc(t,Number.POSITIVE_INFINITY);n._u.Qe([e,t],function(t){r=r.add(t.hu)})}),ba.resolve(this.wu(r))},eh.prototype.xo=function(t,e){var n=e.path,r=n.length+1,e=n;Di.qt(e)||(e=e.child(""));var e=new xc(new Di(e),0),i=new _u(Ur);return this._u.Ke(function(t){var e=t.key.path;return!!n.vt(e)&&(e.length===r&&(i=i.add(t.hu)),!0)},e),ba.resolve(this.wu(i))},eh.prototype.wu=function(t){var e=this,n=[];return t.forEach(function(t){t=e.fu(t);null!==t&&n.push(t)}),n},eh.prototype.No=function(n,r){var i=this;Dr(0===this.Eu(r.batchId,"removed")),this.Ra.shift();var o=this._u;return ba.forEach(r.mutations,function(t){var e=new xc(t.key,r.batchId);return o=o.delete(e),i.Io.Oo(n,t.key)}).next(function(){i._u=o})},eh.prototype.Fo=function(t){},eh.prototype.Mo=function(t,e){var n=new xc(e,0),n=this._u.We(n);return ba.resolve(e.isEqual(n&&n.key))},eh.prototype.ko=function(t){return this.Ra.length,ba.resolve()},eh.prototype.Eu=function(t,e){return this.du(t)},eh.prototype.du=function(t){return 0===this.Ra.length?0:t-this.Ra[0].batchId},eh.prototype.fu=function(t){t=this.du(t);return t<0||t>=this.Ra.length?null:this.Ra[t]},eh),jc=(th.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Tu(e);return this.docs=this.docs.Ie(r,{Ir:e,size:i,readTime:n}),this.size+=i-o,this.To.fo(t,r.path.yt())},th.prototype.mr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},th.prototype.Ar=function(t,e){e=this.docs.get(e);return ba.resolve(e?e.Ir:null)},th.prototype.getEntries=function(t,e){var n=this,r=Iu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ie(t,e?e.Ir:null)}),ba.resolve(r)},th.prototype.Pc=function(t,e,n){for(var r=Nu,i=new Di(e.path.child("")),o=this.docs.Ve(i);o.Ce();){var s=o.De(),u=s.key,a=s.value,s=a.Ir,a=a.readTime;if(!e.path.vt(u.path))break;a.u(n)<=0||s instanceof wo&&ws(e,s)&&(r=r.Ie(s.key,s))}return ba.resolve(r)},th.prototype.Iu=function(t,e){return ba.forEach(this.docs,function(t){return e(t)})},th.prototype.lc=function(t){return new qc(this)},th.prototype.dc=function(t){return ba.resolve(this.size)},th),qc=(f(Zc,Cc=o),Zc.prototype.yr=function(n){var r=this,i=[];return this._r.forEach(function(t,e){e&&e.Ir?i.push(r.gc.Er(n,e.Ir,r.wr(t))):r.gc.mr(t)}),ba.hs(i)},Zc.prototype.Rr=function(t,e){return this.gc.Ar(t,e)},Zc.prototype.Pr=function(t,e){return this.gc.getEntries(t,e)},Zc),Fc=($c.prototype.Un=function(t,n){return this.mu.forEach(function(t,e){return n(e)}),ba.resolve()},$c.prototype.Wo=function(t){return ba.resolve(this.lastRemoteSnapshotVersion)},$c.prototype.jo=function(t){return ba.resolve(this.Au)},$c.prototype.Uo=function(t){return this.highestTargetId=this.Pu.next(),ba.resolve(this.highestTargetId)},$c.prototype.Go=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Au&&(this.Au=e),ba.resolve()},$c.prototype.Ho=function(t){this.mu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pu=new pc(e),this.highestTargetId=e),t.sequenceNumber>this.Au&&(this.Au=t.sequenceNumber)},$c.prototype.zo=function(t,e){return this.Ho(e),this.targetCount+=1,ba.resolve()},$c.prototype.Yo=function(t,e){return this.Ho(e),ba.resolve()},$c.prototype.Xo=function(t,e){return this.mu.delete(e.target),this.Ru.cu(e.targetId),--this.targetCount,ba.resolve()},$c.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return this.mu.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.mu.delete(t),u.push(o.Zo(n,e.targetId)),s++)}),ba.hs(u).next(function(){return s})},$c.prototype.tc=function(t){return ba.resolve(this.targetCount)},$c.prototype.ec=function(t,e){e=this.mu.get(e)||null;return ba.resolve(e)},$c.prototype.nc=function(t,e,n){return this.Ru.iu(e,n),ba.resolve()},$c.prototype.ic=function(e,t,n){this.Ru.ou(t,n);var r=this.persistence.Io,i=[];return r&&t.forEach(function(t){i.push(r.Oo(e,t))}),ba.hs(i)},$c.prototype.Zo=function(t,e){return this.Ru.cu(e),ba.resolve()},$c.prototype.oc=function(t,e){e=this.Ru.uu(e);return ba.resolve(e)},$c.prototype.Mo=function(t,e){return ba.resolve(this.Ru.Mo(e))},$c),Bc=(Jc.prototype.start=function(){return Promise.resolve()},Jc.prototype.L=function(){return this.Oc=!1,Promise.resolve()},Object.defineProperty(Jc.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),Jc.prototype.Xc=function(){},Jc.prototype.Zc=function(){},Jc.prototype.Ia=function(){return this.To},Jc.prototype.Ta=function(t){var e=this.yu[t.I()];return e||(e=new Mc(this.To,this.Io),this.yu[t.I()]=e),e},Jc.prototype.ac=function(){return this.Qc},Jc.prototype._c=function(){return this.Kc},Jc.prototype.ma=function(){return this.Wc},Jc.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Gc(this.Fc.next());return this.Io.Vu(),n(i).next(function(t){return r.Io.pu(i).next(function(){return t})}).cs().then(function(t){return i.ki(),t})},Jc.prototype.bu=function(e,n){return ba.ls(Object.values(this.yu).map(function(t){return function(){return t.Mo(e,n)}}))},Jc),Gc=(f(Xc,Pc=Ie),Xc),zc=(Kc.Du=function(t){return new Kc(t)},Object.defineProperty(Kc.prototype,"Cu",{get:function(){if(this.Su)return this.Su;throw kr()},enumerable:!1,configurable:!0}),Kc.prototype.sc=function(t,e,n){return this.vu.sc(n,e),this.Cu.delete(n.toString()),ba.resolve()},Kc.prototype.rc=function(t,e,n){return this.vu.rc(n,e),this.Cu.add(n.toString()),ba.resolve()},Kc.prototype.Oo=function(t,e){return this.Cu.add(e.toString()),ba.resolve()},Kc.prototype.removeTarget=function(t,e){var n=this;this.vu.cu(e.targetId).forEach(function(t){return n.Cu.add(t.toString())});var r=this.persistence.ac();return r.oc(t,e.targetId).next(function(t){t.forEach(function(t){return n.Cu.add(t.toString())})}).next(function(){return r.Xo(t,e)})},Kc.prototype.Vu=function(){this.Su=new Set},Kc.prototype.pu=function(n){var r=this,i=this.persistence._c().lc();return ba.forEach(this.Cu,function(t){var e=Di.$t(t);return r.xu(n,e).next(function(t){t||i.mr(e)})}).next(function(){return r.Su=null,i.apply(n)})},Kc.prototype.fc=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Cu.delete(e.toString()):n.Cu.add(e.toString())})},Kc.prototype.gu=function(t){return 0},Kc.prototype.xu=function(t,e){var n=this;return ba.ls([function(){return ba.resolve(n.vu.Mo(e))},function(){return n.persistence.ac().Mo(t,e)},function(){return n.persistence.bu(t,e)}])},Kc),Hc=(Qc.prototype.Ou=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Qc.prototype.ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Qc.prototype.Fu=function(){var t={activeTargetIds:this.activeTargetIds.Dt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Qc),Wc=(Yc.prototype.sh=function(t){},Yc.prototype.rh=function(t,e,n){},Yc.prototype.ah=function(t){return this.xh.Ou(t),this.Nh[t]||"not-current"},Yc.prototype.fh=function(t,e,n){this.Nh[t]=e},Yc.prototype.hh=function(t){this.xh.ku(t)},Yc.prototype.lh=function(t){return this.xh.activeTargetIds.has(t)},Yc.prototype._h=function(t){delete this.Nh[t]},Yc.prototype.th=function(){return this.xh.activeTargetIds},Yc.prototype.nh=function(t){return this.xh.activeTargetIds.has(t)},Yc.prototype.start=function(){return this.xh=new Hc,Promise.resolve()},Yc.prototype.wh=function(t,e,n){},Yc.prototype.Eh=function(t){},Yc.prototype.L=function(){},Yc.prototype.Xi=function(t){},Yc.prototype.Ih=function(){},Yc);function Yc(){this.xh=new Hc,this.Nh={},this.Lu=null,this.Hi=null}function Qc(){this.activeTargetIds=Lu}function Kc(t){this.persistence=t,this.vu=new Vc,this.Su=null}function Xc(t){var e=this;return(e=Pc.call(this)||this).oo=t,e}function Jc(t,e){var n=this;this.yu={},this.Fc=new Pa(0),this.Oc=!1,this.Oc=!0,this.Io=t(this),this.Qc=new Fc(this),this.To=new fc,this.Kc=(t=this.To,new jc(t,function(t){return n.Io.gu(t)})),this.fe=new ic(e),this.Wc=new Uc(this.fe)}function $c(t){this.persistence=t,this.mu=new Ha(Oo,So),this.lastRemoteSnapshotVersion=Si.min(),this.highestTargetId=0,this.Au=0,this.Ru=new Vc,this.targetCount=0,this.Pu=pc.Bo()}function Zc(t){var e=this;return(e=Cc.call(this)||this).gc=t,e}function th(t,e){this.To=t,this.Tu=e,this.docs=new lu(Di.At),this.size=0}function eh(t,e){this.To=t,this.Io=e,this.Ra=[],this.lu=1,this._u=new _u(xc.eu)}function nh(t,e){this.key=t,this.hu=e}function rh(){this.tu=new _u(xc.eu),this.nu=new _u(xc.su)}function ih(t){this.fe=t,this.Xa=new Map,this.Za=new Map}function oh(){return"undefined"!=typeof document?document:null}function sh(t,e,n,r,i){var o=this;this.Uh=t,this.Qh=e,this.ks=n,this.Kh={},this.Wh=[],this.jh=new Map,this.Gh=new Set,this.zh=[],this.Hh=i,this.Hh.$(function(t){n.Ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return gh(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(4),[4,hh(e)];case 1:return t.sent(),e.Jh.set("Unknown"),e.Gh.delete(4),[4,ch(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jh=new uh(n,r)}var uh=(ah.prototype.Mh=function(){var t=this;0===this.Fh&&(this.$h("Unknown"),this.Oh=this.ks.ni("online_state_timeout",1e4,function(){return t.Oh=null,t.Lh("Backend didn't respond within 10 seconds."),t.$h("Offline"),Promise.resolve()}))},ah.prototype.Bh=function(t){"Online"===this.state?this.$h("Unknown"):(this.Fh++,1<=this.Fh&&(this.qh(),this.Lh("Connection failed 1 times. Most recent error: "+t.toString()),this.$h("Offline")))},ah.prototype.set=function(t){this.qh(),this.Fh=0,"Online"===t&&(this.kh=!1),this.$h(t)},ah.prototype.$h=function(t){t!==this.state&&(this.state=t,this.Lu(t))},ah.prototype.Lh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kh?(Sr(t),this.kh=!1):Or("OnlineStateTracker",t)},ah.prototype.qh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},ah);function ah(t,e){this.ks=t,this.Lu=e,this.state="Unknown",this.Fh=0,this.Oh=null,this.kh=!0}function ch(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!gh(r))return[3,4];e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function hh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function fh(t,e){t.jh.has(e.targetId)||(t.jh.set(e.targetId,e),vh(t)?yh(t):Ah(t).li()&&ph(t,e))}function lh(t,e){var n=t,t=Ah(n);n.jh.delete(e),t.li()&&dh(n,e),0===n.jh.size&&(t.li()?t.di():gh(n)&&n.Jh.set("Unknown"))}function ph(t,e){t.Yh.Dn(e.targetId),Ah(t).gi(e)}function dh(t,e){t.Yh.Dn(e),Ah(t).Vi(e)}function yh(e){e.Yh=new qu({Xn:function(t){return e.Kh.Xn(t)},Zn:function(t){return e.jh.get(t)||null}}),Ah(e).start(),e.Jh.Mh()}function vh(t){return gh(t)&&!Ah(t).hi()&&0<t.jh.size}function gh(t){return 0===t.Gh.size}function mh(t){t.Yh=void 0}function wh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jh.set("Online"),!(u instanceof Mu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.jh.has(i)?[4,o.Kh.Xh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.jh.delete(i),o.Yh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,bh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Vu?s.Yh.$n(u):u instanceof xu?s.Yh.jn(u):s.Yh.qn(u),a.isEqual(Si.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Oc(s.Uh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yh.Hn(i)).rn.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.jh.get(e))&&r.jh.set(e,n.ae(t.resumeToken,i)))}),e.on.forEach(function(t){var e=r.jh.get(t);e&&(r.jh.set(t,e.ae(xr.h,e.oe)),dh(r,t),e=new _s(e.target,t,1,e.sequenceNumber),ph(r,e))}),r.Kh.Zh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,bh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function bh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ea(r))throw r;return n.Gh.add(1),[4,hh(n)];case 1:return t.sent(),n.Jh.set("Offline"),i=i||function(){return Oc(n.Uh)},n.ks.ea(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Gh.delete(1),[4,ch(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function _h(e,n){return n().catch(function(t){return bh(e,t,n)})}function Eh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Nh(i=a),s=0<i.Wh.length?i.Wh[i.Wh.length-1].batchId:-1,t.label=1;case 1:if(!(gh(i)&&i.Wh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Uh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ra.po(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Wh.length&&o.di(),[3,7]):(s=u.batchId,function(t,e){t.Wh.push(e);t=Nh(t);t.li()&&t.bi&&t.vi(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,bh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Ih(i)&&Th(i),[2]}var e,n,r})})}function Ih(t){return gh(t)&&!Nh(t).hi()&&0<t.Wh.length}function Th(t){Nh(t).start()}function Ah(n){var t,e,r,i=this;return n.nl||(n.nl=(t=n.Qh,e=n.ks,r={Y:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.jh.forEach(function(t,e){ph(n,t)}),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return mh(e),vh(e)?(e.Jh.Bh(n),yh(e)):e.Jh.set("Unknown"),[2]})})}.bind(null,n),yi:wh.bind(null,n)},t.Ni(),new La(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nl.fi(),vh(n)?yh(n):n.Jh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.nl.stop()];case 2:t.sent(),mh(n),t.label=3;case 3:return[2]}})})})),n.nl}function Nh(n){var t,e,r,i=this;return n.sl||(n.sl=(t=n.Qh,e=n.ks,r={Y:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Nh(e).Ci(),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Nh(e).bi?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return wi(n=i.code)&&n!==qr.ABORTED?(e=r.Wh.shift(),Nh(r).fi(),[4,_h(r,function(){return r.Kh.el(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Eh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Ih(e)&&Th(e),[2]}})})}.bind(null,n),Di:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Nh(o),n=0,r=o.Wh;n<r.length;n++)i=r[n],e.vi(i.mutations);return[2]})})}.bind(null,n),Si:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wh.shift(),n=za.from(e,i,o),[4,_h(r,function(){return r.Kh.tl(n)})];case 1:return t.sent(),[4,Eh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ni(),new ka(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.sl.fi(),[4,Eh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.sl.stop()];case 3:t.sent(),0<n.Wh.length&&(Or("RemoteStore","Stopping write stream with "+n.Wh.length+" pending writes"),n.Wh=[]),t.label=4;case 4:return[2]}})})})),n.sl}function Oh(){this.queries=new Ha(gs,vs),this.onlineState="Unknown",this.rl=new Set}var Sh=function(){this.il=void 0,this.listeners=[]};function Rh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Sh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ol(n)];case 2:return o.il=t.sent(),[3,4];case 3:return o=t.sent(),o=Aa(o,"Initialization of query '"+ms(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.cl(e.onlineState),i.il&&u.al(i.il)&&kh(e),[2]}})})}function Lh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.ul(n))]:[2]})})}function kh(t){t.rl.forEach(function(t){t.next()})}var Dh=(jh.prototype.al=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Pu(t.query,t.docs,t.Ze,e,t.tn,t.fromCache,t.en,!0)}var o=!1;return this.ll?this.fl(t)&&(this.hl.next(t),o=!0):this.dl(t,this.onlineState)&&(this.wl(t),o=!0),this._l=t,o},jh.prototype.onError=function(t){this.hl.error(t)},jh.prototype.cl=function(t){this.onlineState=t;var e=!1;return this._l&&!this.ll&&this.dl(this._l,t)&&(this.wl(this._l),e=!0),e},jh.prototype.dl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.El&&n||t.docs.bt()&&"Offline"!==e)},jh.prototype.fl=function(t){if(0<t.docChanges.length)return!0;var e=this._l&&this._l.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},jh.prototype.wl=function(t){t=Pu.sn(t.query,t.docs,t.tn,t.fromCache),this.ll=!0,this.hl.next(t)},jh),Ph=(Mh.prototype.Tl=function(){return"metadata"in this.payload},Mh),Ch=(xh.prototype.Ha=function(t){return oa(this.fe,t)},xh.prototype.Ja=function(t){return t.metadata.exists?(e=this.fe,n=t.document,r=oa(e,n.name),e=ea(n.updateTime),n=new fo({mapValue:{fields:n.fields}}),new wo(r,e,n,{hasCommittedMutations:!1})):new bo(this.Ha(t.metadata.name),this.Ya(t.metadata.readTime));var e,n,r},xh.prototype.Ya=ea,xh),Uh=(Vh.prototype.ml=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Vh.prototype.Al=function(t){for(var e=new Map,n=new Ch(this.fe),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ha(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Ru()).add(s);e.set(c,h)}}return e},Vh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=Ru(),i=Iu,o=Ou,e=0,s=p;e<s.length;e++)u=s[e],a=l.Ha(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ie(a,l.Ja(u)),o=o.Ie(a,l.Ya(u.metadata.readTime));return c=n.Qa.lc({yc:!0}),[4,Lc(n,ds(us(Ri.xt("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Rc(e,c,i,Si.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Qc.Zo(e,h.targetId).next(function(){return n.Qc.nc(e,r,h.targetId)}).next(function(){return n.Ka.pa(e,t)})})})]}})})}(this.Uh,new Ch(this.fe),this.documents,this.Il.id)];case 1:e=t.sent(),n=this.Al(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Ru()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Lc(e,ds(hc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ea(i.readTime);if(0<=n.oe.u(e))return r.Wc.lo(t,i);e=n.ae(xr.h,e);return r.Ba=r.Ba.Ie(e.targetId,e),r.Qc.Yo(t,e).next(function(){return r.Qc.Zo(t,n.targetId)}).next(function(){return r.Qc.nc(t,o,n.targetId)}).next(function(){return r.Wc.lo(t,i)})})]}})})}(this.Uh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ba(Object.assign({},this.progress),e))]}})})},Vh);function Vh(t,e,n){this.Il=t,this.Uh=e,this.fe=n,this.queries=[],this.documents=[],this.progress=qh(t)}function xh(t){this.fe=t}function Mh(t,e){this.payload=t,this.byteLength=e}function jh(t,e,n){this.query=t,this.hl=e,this.ll=!1,this._l=null,this.onlineState="Unknown",this.options=n||{}}function qh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Fh=function(t){this.key=t},Bh=function(t){this.key=t},Gh=(Object.defineProperty(Qh.prototype,"pl",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),Qh.prototype.bl=function(t,e){var s=this,u=e?e.vl:new Du,a=(e||this).Vl,c=(e||this).tn,h=a,f=!1,l=as(this.query)&&a.size===this.query.limit?a.last():null,p=cs(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pe(function(t,e){var n=a.get(t),r=(r=e instanceof wo?e:null)&&(ws(s.query,r)?r:null),i=!!n&&s.tn.has(n.key),o=!!r&&(r.Jt||s.tn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Sl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.gl(r,l)||p&&s.gl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),as(this.query)||cs(this.query))for(;h.size>this.query.limit;){var n=as(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Vl:h,vl:u,$a:f,tn:c}},Qh.prototype.Sl=function(t,e){return t.Jt&&e.hasCommittedMutations&&!e.Jt},Qh.prototype.yr=function(t,e,n){var o=this,r=this.Vl;this.Vl=t.Vl,this.tn=t.tn;var i=t.vl.Xe();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.gl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Dl(n);var s=e?this.Cl():[],n=0===this.yl.size&&this.ln?1:0,e=n!==this.Pl;return this.Pl=n,0!==i.length||e?{snapshot:new Pu(this.query,t.Vl,r,i,t.tn,0==n,e,!1),xl:s}:{xl:s}},Qh.prototype.cl=function(t){return this.ln&&"Offline"===t?(this.ln=!1,this.yr({Vl:this.Vl,vl:new Du,tn:this.tn,$a:!1},!1)):{xl:[]}},Qh.prototype.Nl=function(t){return!this.Rl.has(t)&&!!this.Vl.has(t)&&!this.Vl.get(t).Jt},Qh.prototype.Dl=function(t){var e=this;t&&(t._n.forEach(function(t){return e.Rl=e.Rl.add(t)}),t.fn.forEach(function(t){}),t.dn.forEach(function(t){return e.Rl=e.Rl.delete(t)}),this.ln=t.ln)},Qh.prototype.Cl=function(){var e=this;if(!this.ln)return[];var n=this.yl;this.yl=Ru(),this.Vl.forEach(function(t){e.Nl(t.key)&&(e.yl=e.yl.add(t.key))});var r=[];return n.forEach(function(t){e.yl.has(t)||r.push(new Bh(t))}),this.yl.forEach(function(t){n.has(t)||r.push(new Fh(t))}),r},Qh.prototype.Fl=function(t){this.Rl=t.za,this.yl=Ru();t=this.bl(t.documents);return this.yr(t,!0)},Qh.prototype.Ol=function(){return Pu.sn(this.query,this.Vl,this.tn,0===this.Pl)},Qh),zh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Hh=function(t){this.key=t,this.kl=!1},Wh=(Object.defineProperty(Yh.prototype,"Xl",{get:function(){return!0===this.Yl},enumerable:!1,configurable:!0}),Yh);function Yh(t,e,n,r,i,o){this.Uh=t,this.Ml=e,this.$l=n,this.Ll=r,this.currentUser=i,this.Bl=o,this.ql={},this.Ul=new Ha(gs,vs),this.Ql=new Map,this.Kl=[],this.Wl=new lu(Di.At),this.jl=new Map,this.Gl=new Vc,this.zl={},this.Hl=new Map,this.Jl=pc.qo(),this.onlineState="Unknown",this.Yl=void 0}function Qh(t,e){this.query=t,this.Rl=e,this.Pl=null,this.ln=!1,this.yl=Ru(),this.tn=Ru(),this.gl=bs(t),this.Vl=new ku(this.gl)}function Kh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ml.Kh.Zh=Jh.bind(null,e),e.Ml.Kh.Xn=function(t,e){var n=t,t=n.jl.get(e);if(t&&t.kl)return Ru().add(t.key);var r=Ru(),e=n.Ql.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Ul.get(s);r=r.je(s.view.pl)}return r}.bind(null,e),e.Ml.Kh.Xh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ll.fh(s,"rejected",u),i=e.jl.get(s),(n=i&&i.key)?(r=(r=new lu(Di.At)).Ie(n,new bo(n,Si.min())),i=Ru().add(n),i=new Cu(Si.min(),new Map,new _u(Ur),r,i),[4,Jh(e,i)]):[3,2];case 1:return t.sent(),e.Wl=e.Wl.remove(n),e.jl.delete(s),sf(e),[3,4];case 2:return[4,kc(e.Uh,s,!1).then(function(){return nf(e,s,u)}).catch(Fa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.ql.yi=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].al(s)&&(r=!0);u.il=s}}r&&kh(n)}.bind(null,e.$l),e.ql.t_=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.$l),(s=(n=e).Ul.get(a))?(r=s.targetId,n.Ll.ah(r),i=s.view.Ol(),[3,4]):[3,1];case 1:return[4,Lc(n.Uh,ds(a))];case 2:return o=t.sent(),s=n.Ll.ah(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Zl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.bl(o)).$a?[4,Dc(r.Uh,i.query,!1).then(function(t){t=t.documents;return i.view.bl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.rn.get(i.targetId),n=i.view.yr(e,r.Xl,n),[2,(of(r,i.targetId,n.xl),n.snapshot)]}})})}(i,t,e,n)},[4,Dc(i.Uh,o,!0)];case 1:return n=t.sent(),r=new Gh(o,n.za),e=r.bl(n.documents),n=Uu.hn(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Xl,n),of(i,s,n.xl),r=new zh(o,s,r),[2,(i.Ul.set(o,r),i.Ql.has(s)?i.Ql.get(s).push(o):i.Ql.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.Xl&&fh(n.Ml,o),t.label=4;case 4:return[2,i]}var e})})}function Xh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).Ml.Kh.tl=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Nc(e.Uh,o)];case 2:return r=t.sent(),ef(e,n,null),tf(e,n),e.Ll.rh(n,"acknowledged"),[4,uf(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Ml.Kh.el=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ra.yo(e,r).next(function(t){return Dr(null!==t),n=t.keys(),i.Ra.No(e,t)}).next(function(){return i.Ra.ko(e)}).next(function(){return i.Ka.Va(e,n)})}))];case 2:return o=t.sent(),ef(n,u,a),tf(n,u),n.Ll.rh(u,"rejected",a),[4,uf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Uh,a=p,h=r,f=Oi.now(),i=a.reduce(function(t,e){return t.add(e.key)},Ru()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.Va(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof wo?e.field(o.field):void 0,s=Ns(o.transform,s||null);null!=s&&(n=(null==n?new lo:n).set(o.field,s))}return n?n.Gt():null}(e.fieldTransforms,s):null);null!=s&&n.push(new tu(o.key,s,function s(t){var u=[];return Gi(t.fields||{},function(t,e){var n=new ki([t]);if(ho(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Hi(u)}(s.proto.mapValue),Hs.exists(!0)))}return h.Ra.Po(u,f,n,a)})}).then(function(t){var e=t.rr(c);return{batchId:t.batchId,_r:e}}))];case 2:return s=t.sent(),u.Ll.sh(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.zl[e.currentUser.I()])||new lu(Ur)).Ie(n,o),e.zl[e.currentUser.I()]=r,[4,uf(u,s._r)];case 3:return t.sent(),[4,Eh(u.Ml)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Aa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Jh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Sc(n.Uh,i)];case 2:return e=t.sent(),i.rn.forEach(function(t,e){e=n.jl.get(e);e&&(Dr(t._n.size+t.fn.size+t.dn.size<=1),0<t._n.size?e.kl=!0:0<t.fn.size?Dr(e.kl):0<t.dn.size&&(Dr(e.kl),e.kl=!1))}),[4,uf(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function $h(t,n,e){var r,t=t;(t.Xl&&0===e||!t.Xl&&1===e)&&(r=[],t.Ul.forEach(function(t,e){e=e.view.cl(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].cl(i)&&(o=!0)}),o&&kh(t)}(t.$l,n),r.length&&t.ql.yi(r),t.onlineState=n,t.Xl&&t.Ll.Eh(n))}function Zh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:gh((n=o).Ml)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Uh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ra.bo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Hl.get(r)||[]).push(s),n.Hl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Aa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function tf(t,e){(t.Hl.get(e)||[]).forEach(function(t){t.resolve()}),t.Hl.delete(e)}function ef(t,e,n){var r=t,i=r.zl[r.currentUser.I()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.zl[r.currentUser.I()]=i)}function nf(e,t,n){void 0===n&&(n=null),e.Ll.hh(t);for(var r=0,i=e.Ql.get(t);r<i.length;r++){var o=i[r];e.Ul.delete(o),n&&e.ql.t_(o,n)}e.Ql.delete(t),e.Xl&&e.Gl.cu(t).forEach(function(t){e.Gl.Mo(t)||rf(e,t)})}function rf(t,e){var n=t.Wl.get(e);null!==n&&(lh(t.Ml,n),t.Wl=t.Wl.remove(e),t.jl.delete(n),sf(t))}function of(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Fh?(t.Gl.sc(o.key,e),function(t,e){e=e.key;t.Wl.get(e)||(Or("SyncEngine","New document in limbo: "+e),t.Kl.push(e),sf(t))}(t,o)):o instanceof Bh?(Or("SyncEngine","Document no longer in limbo: "+o.key),t.Gl.rc(o.key,e),t.Gl.Mo(o.key)||rf(t,o.key)):kr()}}function sf(t){for(;0<t.Kl.length&&t.Wl.size<t.Bl;){var e=t.Kl.shift(),n=t.Jl.next();t.jl.set(n,new Hh(e)),t.Wl=t.Wl.Ie(e,n),fh(t.Ml,new _s(ds(us(e.path)),n,2,Pa.Zi))}}function uf(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ul.bt()?[3,3]:(n.Ul.forEach(function(t,e){o.push(n.Zl(e,s,u).then(function(t){t&&(n.Xl&&n.Ll.fh(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=yc.Na(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ql.yi(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ba.forEach(c,function(e){return ba.forEach(e.Ca,function(t){return r.persistence.Io.sc(n,e.targetId,t)}).next(function(){return ba.forEach(e.xa,function(t){return r.persistence.Io.rc(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ba.get(o),u=s.oe,u=s.ue(u),r.Ba=r.Ba.Ie(o,u));return[2]}})})}(n.Uh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function af(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.I()),[4,Ac(n.Uh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Hl.forEach(function(t){t.forEach(function(t){t.reject(new Fr(qr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Hl.clear(),n.Ll.wh(o,r.ja,r.Ga),[4,uf(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function cf(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Uh,o=r,s=ea((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Wc.ao(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.e_({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.n_(qh(u)),a=new Uh(u,l.Uh,p.fe),[4,p.s_()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ml(c)]:[3,10];case 7:return(h=t.sent())&&d.n_(h),[4,p.s_()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,uf(l,f.tr,void 0)];case 12:return t.sent(),[4,(r=l.Uh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Wc.uo(t,e)}))];case 13:return t.sent(),d.e_(f.progress),[3,15];case 14:return Rr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.i_(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Ll.Ih()})}var hf=(pf.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.fe=wa(e.rt.O),this.Ll=this.r_(e),this.persistence=this.o_(e),[4,this.persistence.start()];case 1:return t.sent(),this.c_=this.a_(e),this.Uh=this.u_(e),[2]}})})},pf.prototype.a_=function(t){return null},pf.prototype.u_=function(t){return e=this.persistence,n=new vc,r=t.h_,t=this.fe,new gc(e,n,r,t);var e,n,r},pf.prototype.o_=function(t){return new Bc(zc.Du,this.fe)},pf.prototype.r_=function(t){return new Wc},pf.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.c_&&this.c_.stop(),[4,this.Ll.L()];case 1:return t.sent(),[4,this.persistence.L()];case 2:return t.sent(),[2]}})})},pf),ff=(lf.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh?[3,2]:(this.Uh=n.Uh,this.Ll=n.Ll,this.Qh=this.__(r),this.Ml=this.f_(r),this.$l=this.d_(r),this.$u=this.w_(r,!n.synchronizeTabs),this.Ll.Lu=function(t){return $h(e.$u,t,1)},this.Ml.Kh.E_=af.bind(null,this.$u),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Gh.delete(2),[4,ch(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Gh.add(2),[4,hh(e)]);case 3:t.sent(),e.Jh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ml,this.$u.Xl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},lf.prototype.d_=function(t){return new Oh},lf.prototype.__=function(t){var e=wa(t.rt.O),n=(n=t.rt,new Ni(n));return t=t.credentials,new Da(t,n,e)},lf.prototype.f_=function(t){var e=this,n=this.Uh,r=this.Qh,i=t.ks,o=function(t){return $h(e.$u,t,0)},t=new(ui.G()?ui:si);return new sh(n,r,i,o,t)},lf.prototype.w_=function(t,e){return function(t,e,n,r,i,o,s){o=new Wh(t,e,n,r,i,o);return s&&(o.Yl=!0),o}(this.Uh,this.Ml,this.$l,this.Ll,t.h_,t.Bl,e)},lf.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Gh.add(5),[4,hh(e)];case 1:return t.sent(),e.Hh.L(),e.Jh.set("Unknown"),[2]}})})}(this.Ml)},lf);function lf(){}function pf(){this.synchronizeTabs=!1}function df(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var yf,vf=(Sf.prototype.next=function(t){this.observer.next&&this.T_(this.observer.next,t)},Sf.prototype.error=function(t){this.observer.error?this.T_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Sf.prototype.I_=function(){this.muted=!0},Sf.prototype.T_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Sf),gf=(Of.prototype.close=function(){return this.m_.cancel()},Of.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Of.prototype.s_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.R_())]}})})},Of.prototype.R_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.P_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.A_.decode(e),n=Number(r),isNaN(n)&&this.y_("length string ("+r+") is not valid number"),[4,this.g_(n)]);case 2:return r=t.sent(),[2,new Ph(JSON.parse(r),e.length+n)]}})})},Of.prototype.V_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Of.prototype.P_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.V_()<0?[4,this.p_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.V_())<0&&this.y_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Of.prototype.g_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.p_()]:[3,3];case 1:t.sent()&&this.y_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.A_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Of.prototype.y_=function(t){throw this.m_.cancel(),new Error("Invalid bundle format: "+t)},Of.prototype.p_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.m_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Of),mf=(Nf.prototype.isEqual=function(t){return this.b_.isEqual(t.b_)},Nf),wf=function(t){this._methodName=t},bf=(Object.defineProperty(Af.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"path",{get:function(){return this.S_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"parent",{get:function(){return new Ef(this.firestore,this.v_,this.S_.path.yt())},enumerable:!1,configurable:!0}),Af.prototype.withConverter=function(t){return new Af(this.firestore,t,this.S_)},Af),_f=(Tf.prototype.withConverter=function(t){return new Tf(this.firestore,t,this.C_)},Tf),Ef=(f(If,yf=_f),Object.defineProperty(If.prototype,"id",{get:function(){return this.C_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"path",{get:function(){return this.C_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"parent",{get:function(){var t=this.D_.yt();return t.bt()?null:new bf(this.firestore,null,new Di(t))},enumerable:!1,configurable:!0}),If.prototype.withConverter=function(t){return new If(this.firestore,t,this.D_)},If);function If(t,e,n){var r=this;return(r=yf.call(this,t,e,us(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Tf(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Af(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Nf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Fr(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.b_=new ki(t)}function Of(t,e){var n=this;this.m_=t,this.fe=e,this.metadata=new Ai,this.buffer=new Uint8Array,this.A_=new TextDecoder("utf-8"),this.R_().then(function(t){t&&t.Tl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Sf(t){this.observer=t,this.muted=!1}function Rf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),Xa("collection","path",e),t instanceof uc)return tc(n=Ri.xt.apply(Ri,l([e],r))),new Ef(t,null,n);if(!(t instanceof bf||t instanceof Ef))throw new Fr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tc(n=Ri.xt.apply(Ri,l([t.path],r)).child(Ri.xt(e))),new Ef(t.firestore,null,n)}function Lf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),1===arguments.length&&(e=Pr.t()),Xa("doc","path",e),t instanceof uc)return Za(n=Ri.xt.apply(Ri,l([e],r))),new bf(t,null,new Di(n));if(!(t instanceof bf||t instanceof Ef))throw new Fr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Za(n=t.D_.child(Ri.xt.apply(Ri,l([e],r)))),new bf(t.firestore,t instanceof Ef?t.v_:null,new Di(n))}function kf(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),(t instanceof bf||t instanceof Ef)&&(e instanceof bf||e instanceof Ef)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Df(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),t instanceof _f&&e instanceof _f&&t.firestore===e.firestore&&vs(t.C_,e.C_)&&t.v_===e.v_}var Pf=(Object.defineProperty(jf.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),jf.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},jf.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},jf.prototype.dt=function(t){return Ur(this.x_,t.x_)||Ur(this.N_,t.N_)},jf),Cf=/^__.*__$/,Uf=(Mf.prototype.F_=function(t,e){return null!==this.Te?new tu(t,this.data,this.Te,e,this.fieldTransforms):new Zs(t,this.data,e,this.fieldTransforms)},Mf),Vf=(xf.prototype.F_=function(t,e){return new tu(t,this.data,this.Te,e,this.fieldTransforms)},xf);function xf(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function Mf(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function jf(t,e){if(!isFinite(t)||t<-90||90<t)throw new Fr(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Fr(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function qf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Ff=(Object.defineProperty(zf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(zf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),zf.prototype.M_=function(t){return new zf(Object.assign(Object.assign({},this.settings),t),this.O,this.fe,this.ignoreUndefinedProperties,this.fieldTransforms,this.Te)},zf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},zf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},zf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},zf.prototype.K_=function(t){return wl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},zf.prototype.contains=function(e){return void 0!==this.Te.find(function(t){return e.vt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.vt(t.field)})},zf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},zf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(qf(this.k_)&&Cf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},zf),Bf=(Gf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Ff({k_:t,methodName:e,j_:n,path:ki.Nt(),B_:!1,W_:r},this.O,this.fe,this.ignoreUndefinedProperties)},Gf);function Gf(t,e,n){this.O=t,this.ignoreUndefinedProperties=e,this.fe=n||wa(t)}function zf(t,e,n,r,i,o){this.settings=t,this.O=e,this.fe=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Te=o||[]}function Hf(t){var e=t.so(),n=wa(t.zr);return new Bf(t.zr,!!e.ignoreUndefinedProperties,n)}function Wf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);yl("Data must be an object, but it was:",s,r);var u,a,r=pl(r,s);if(o.merge)u=new Hi(s.Te),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=vl(e,f[h],n);if(!s.contains(l))throw new Fr(qr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");bl(c,l)||c.push(l)}u=new Hi(c),a=s.fieldTransforms.filter(function(t){return u.Qt(t.field)})}else u=null,a=s.fieldTransforms;return new Uf(new fo(r),u,a)}var Yf,Qf=(f(Kf,Yf=wf),Kf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Te.push(t.path),null},Kf.prototype.isEqual=function(t){return t instanceof Kf},Kf);function Kf(){return null!==Yf&&Yf.apply(this,arguments)||this}function Xf(t,e,n){return new Ff({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.O,e.fe,e.ignoreUndefinedProperties)}var Jf,$f,Zf,tl,el=(f(al,tl=wf),al.prototype.z_=function(t){return new Gs(t.path,new Rs)},al.prototype.isEqual=function(t){return t instanceof al},al),nl=(f(ul,Zf=wf),ul.prototype.z_=function(t){var e=Xf(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),n=new Ls(n);return new Gs(t.path,n)},ul.prototype.isEqual=function(t){return this===t},ul),rl=(f(sl,$f=wf),sl.prototype.z_=function(t){var e=Xf(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),n=new Us(n);return new Gs(t.path,n)},sl.prototype.isEqual=function(t){return this===t},sl),il=(f(ol,Jf=wf),ol.prototype.z_=function(t){var e=new js(t.fe,As(t.fe,this.J_));return new Gs(t.path,e)},ol.prototype.isEqual=function(t){return this===t},ol);function ol(t,e){var n=this;return(n=Jf.call(this,t)||this).J_=e,n}function sl(t,e){var n=this;return(n=$f.call(this,t)||this).H_=e,n}function ul(t,e){var n=this;return(n=Zf.call(this,t)||this).H_=e,n}function al(){return null!==tl&&tl.apply(this,arguments)||this}function cl(t,r,i,e){var o=t.G_(1,r,i);yl("Data must be an object, but it was:",o,e);var s=[],u=new lo;Gi(e,function(t,e){var n=ml(r,t,i);e instanceof Gr&&(e=e._);t=o.U_(n);e instanceof Qf?s.push(n):null!=(t=ll(e,t))&&(s.push(n),u.set(n,t))});e=new Hi(s);return new Vf(u.Gt(),e,o.fieldTransforms)}function hl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[vl(e,r,n)],a=[i];if(o.length%2!=0)throw new Fr(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(vl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new lo,y=u.length-1;0<=y;--y){bl(p,u[y])||(h=u[y],(f=a[y])instanceof Gr&&(f=f._),l=s.U_(h),f instanceof Qf?p.push(h):null!=(l=ll(f,l))&&(p.push(h),d.set(h,l)))}i=new Hi(p);return new Vf(d.Gt(),i,s.fieldTransforms)}function fl(t,e,n,r){return void 0===r&&(r=!1),ll(n,t.G_(r?4:3,e))}function ll(s,t){if(s instanceof Gr&&(s=s._),dl(s))return yl("Unsupported field value:",t,s),pl(s,t);if(s instanceof wf)return function(t,e){if(!qf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Te.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ll(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Gr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return As(e.fe,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Oi.fromDate(t);return{timestampValue:Zu(e.fe,n)}}if(t instanceof Oi)return n=new Oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Zu(e.fe,n)};if(t instanceof Pf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Br)return{bytesValue:ta(e.fe,t.l)};if(t instanceof bf){n=e.O;var r=t.firestore.zr;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:na(t.firestore.zr||e.O,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+ec(t))}(s,t)}function pl(t,n){var r={};return zi(t)?n.path&&0<n.path.length&&n.Te.push(n.path):Gi(t,function(t,e){e=ll(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function dl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Oi||t instanceof Pf||t instanceof Br||t instanceof bf||t instanceof wf)}function yl(t,e,n){if(!dl(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=ec(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function vl(t,e,n){if(e instanceof Gr&&(e=e._),e instanceof mf)return e.b_;if("string"==typeof e)return ml(t,e);throw wl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var gl=new RegExp("[~\\*/\\[\\]]");function ml(e,n,r){if(0<=n.search(gl))throw wl("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(mf.bind.apply(mf,l([void 0],n.split("."))))).b_}catch(t){throw wl("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function wl(t,e,n,r,i){var o=r&&!r.bt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Fr(qr.INVALID_ARGUMENT,(e+=". ")+t+n)}function bl(t,e){return t.some(function(t){return t.isEqual(e)})}var _l=(Nl.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Fr(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=ua((n=s).fe)+"/documents",r={documents:u.map(function(t){return ia(n.fe,t)})},[4,n._t("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.fe,"found"in(t=t)?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=oa(t,e.found.name),t=ea(e.found.updateTime),e=new fo({mapValue:{fields:e.found.fields}});return new wo(n,t,e,{})}(e,t):"missing"in t?function(t,e){Dr(!!e.missing),Dr(!!e.readTime);t=oa(t,e.missing),e=ea(e.readTime);return new bo(t,e)}(e,t):kr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Dr(!!t),o.push(t)}),o)]}})})}(this.Qh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof bo||t instanceof wo?n.sf(t):kr()}),e)]}})})},Nl.prototype.set=function(t,e){this.write(e.F_(t,this.Ee(t))),this.tf.add(t.toString())},Nl.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Nl.prototype.delete=function(t){this.write(new hu(t,this.Ee(t))),this.tf.add(t.toString())},Nl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Di.$t(e);n.mutations.push(new fu(e,n.Ee(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ua((e=i).fe)+"/documents",r={writes:o.map(function(t){return ha(e.fe,t)})},[4,e.at("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},Nl.prototype.sf=function(t){var e;if(t instanceof wo)e=t.version;else{if(!(t instanceof bo))throw kr();e=Si.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Fr(qr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Nl.prototype.Ee=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Hs.updateTime(e):Hs.de()},Nl.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Hs.exists(!0);if(e.isEqual(Si.min()))throw new Fr(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Hs.updateTime(e)},Nl.prototype.write=function(t){this.nf(),this.mutations.push(t)},Nl.prototype.nf=function(){},Nl),El=(Al.prototype.run=function(){this.af()},Al.prototype.af=function(){var t=this;this.ui.ti(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new _l(this.Qh),(n=this.uf(e))&&n.then(function(t){r.ks.Ws(function(){return e.commit().then(function(){r.Bs.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Al.prototype.uf=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.Bs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Bs.reject(t),null}},Al.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.ks.Ws(function(){return e.af(),Promise.resolve()})):this.Bs.reject(t)},Al.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!wi(t)},Al),Il=(Tl.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.S.promise];case 1:return[2,(t.sent(),{ks:this.ks,rt:this.rt,clientId:this.clientId,credentials:this.credentials,h_:this.user,Bl:100})]}})})},Tl.prototype.ff=function(t){var e=this;this._f=t,this.S.promise.then(function(){return e._f(e.user)})},Tl.prototype.df=function(){if(this.ks.wf)throw new Fr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},Tl.prototype.terminate=function(){var t=this;this.ks.Ef();var n=new Ai;return this.ks.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.p(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Aa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Tl);function Tl(t,e,n){var r=this;this.credentials=t,this.ks=e,this.rt=n,this.user=Xr.UNAUTHENTICATED,this.clientId=Pr.t(),this._f=function(){},this.S=new Ai,this.credentials.V(function(t){Or("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r._f(t)),r.S.resolve()})}function Al(t,e,n,r){this.ks=t,this.Qh=e,this.updateFunction=n,this.Bs=r,this.cf=5,this.ui=new Ra(this.ks,"transaction_retry")}function Nl(t){this.Qh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Ol(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Or("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),Or("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ff(function(e){return r.ks.ea(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ac(i.Uh,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Xc(function(){return r.terminate()}),r.mf=i,[2]}})})}(e,new hf)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Sl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Or("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),[4,Ol(r)];case 1:return e=t.sent(),Or("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.ks.ea(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ks.Af(),Or("RemoteStore","RemoteStore received new credentials"),n=gh(e),e.Gh.add(3),[4,hh(e)];case 1:return t.sent(),n&&e.Jh.set("Unknown"),[4,e.Kh.E_(i)];case 2:return t.sent(),e.Gh.delete(3),[4,ch(e)];case 3:return t.sent(),[2]}})})}(i.Ml,t)})}),r.If=i,[2]}})})}(e,new ff)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Rl(t){return Ol(t).then(function(t){return t.persistence})}function Ll(t){return Ol(t).then(function(t){return t.Uh})}function kl(t){return Sl(t).then(function(t){return t.Ml})}function Dl(t){return Sl(t).then(function(t){return t.$u})}function Pl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Sl(r)];case 1:return e=t.sent(),[2,((n=e.$l).ol=Kh.bind(null,e.$u),n.ul=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ul.get(o),1<(r=e.Ql.get(n.targetId)).length?[2,(e.Ql.set(n.targetId,r.filter(function(t){return!vs(t,o)})),void e.Ul.delete(o))]:e.Xl?(e.Ll.hh(n.targetId),e.Ll.nh(n.targetId)?[3,2]:[4,kc(e.Uh,n.targetId,!1).then(function(){e.Ll._h(n.targetId),lh(e.Ml,n.targetId),nf(e,n.targetId)}).catch(Fa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return nf(e,n.targetId),[4,kc(e.Uh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.$u),n)]}})})}function Cl(n,r,i){var t=this;void 0===i&&(i={});var o=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new vf({next:function(t){r.Ws(function(){return Lh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Fr(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Fr(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Dh(us(i.path),t,{includeMetadataChanges:!0,El:!0});return Rh(n,u)},[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}function Ul(n,r,i){var t=this;void 0===i&&(i={});var o=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new vf({next:function(t){n.Ws(function(){return Lh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Fr(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Dh(t,o,{includeMetadataChanges:!0,El:!0});return Rh(e,s)},[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}var Vl,xl=(Object.defineProperty(ql.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),ql.prototype.Ws=function(t){this.enqueue(t)},ql.prototype.Tf=function(t){this.Sf(),this.Df(t)},ql.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=oh())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},ql.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},ql.prototype.ea=function(t){var e=this;this.Ws(function(){return e.Pf.push(t),e.Cf()})},ql.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.ui.reset(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.ui.ti(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},ql.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},ql.prototype.ni=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=Ia.qs(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},ql.prototype.Sf=function(){this.Vf&&kr()},ql.prototype.Af=function(){},ql.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},ql.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].Ms===t)return!0;return!1},ql.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.$s-e.$s});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ms===r)break}return i.Nf()})},ql.prototype.kf=function(t){this.bf.push(t)},ql.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},ql),Ml=(f(jl,Vl=uc),jl.prototype.io=function(){return this.$f||Bl(this),this.$f.terminate()},jl);function jl(t,e){var n=this;return(n=Vl.call(this,t,e)||this).Mf=new xl,n.Wr="name"in t?t.name:"[DEFAULT]",n}function ql(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.ui=new Ra(this,"async_queue_retry"),this.vf=function(){var t=oh();t&&Or("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ui.si()};var t=oh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function Fl(t){return t.$f||Bl(t),t.$f.df(),t.$f}function Bl(t){var e,n,r=t.so(),r=(e=t.zr,n=t.Wr,new ii(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new Il(t.Hr,t.Mf,r)}var Gl,o=(Ql.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),Zi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ki(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Xi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw kr()}},Ql.prototype.jf=function(t,n){var r=this,i={};return Gi(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},Ql.prototype.Kf=function(t){return new Pf(Ki(t.latitude),Ki(t.longitude))},Ql.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},Ql.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Ji(e)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf($i(t));default:return null}},Ql.prototype.Bf=function(t){t=Qi(t);return new Oi(t.seconds,t.nanos)},Ql.prototype.Gf=function(t,e){var n=Ri.xt(t);Dr(ma(n));t=new oi(n.get(1),n.get(3)),n=new Di(n.Pt(5));return t.isEqual(e)||Sr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Ql),zl=(Object.defineProperty(Yl.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"ref",{get:function(){return new bf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Yl.prototype.exists=function(){return null!==this.Jf},Yl.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Hl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.Yt())}},Yl.prototype.get=function(t){if(this.Jf){t=this.Jf.data().field(Kl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t)}},Yl),Hl=(f(Wl,Gl=zl),Wl.prototype.data=function(){return Gl.prototype.data.call(this)},Wl);function Wl(){return null!==Gl&&Gl.apply(this,arguments)||this}function Yl(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Ql(){}function Kl(t,e){return"string"==typeof e?ml(t,e):(e instanceof Gr?e._:e).b_}function Xl(t){if(cs(t)&&0===t.ne.length)throw new Fr(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Ie=function(){};function Jl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var $l,Zl,tp,ep,np,rp=(f(lp,np=Ie),lp.prototype.Yf=function(t){var e=Hf(t.firestore),e=function(t,e,n,r,i,o){if(r.Ot()){if("array-contains"===i||"array-contains-any"===i)throw new Fr(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){yp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(dp(n,t,c))}h={arrayValue:{values:s}}}else h=dp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||yp(o,i),h=fl(e,"where",o,"in"===i||"not-in"===i);var h=ko.create(r,i,h);return function(t,e){if(e.ee()){var n=fs(t);if(null!==n&&!n.isEqual(e.field))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=hs(t);null!==n&&vp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Fr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Fr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.zr,this.Xf,this.Zf,this.td);return new _f(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new ss(t.path,t.collectionGroup,t.ne.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},lp),ip=(f(fp,ep=Ie),fp.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new rs(e,n);return e=r,null!==hs(n=t)||null!==(t=fs(n))&&vp(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new _f(t.firestore,t.v_,(t=t.C_,e=t.ne.concat([e]),new ss(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},fp),op=(f(hp,tp=Ie),hp.prototype.Yf=function(t){return new _f(t.firestore,t.v_,ys(t.C_,this.nd,this.sd))},hp),sp=(f(cp,Zl=Ie),cp.prototype.Yf=function(t){var e=pp(t,this.type,this.rd,this.od);return new _f(t.firestore,t.v_,(t=t.C_,e=e,new ss(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},cp),up=(f(ap,$l=Ie),ap.prototype.Yf=function(t){var e=pp(t,this.type,this.rd,this.od);return new _f(t.firestore,t.v_,(t=t.C_,e=e,new ss(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},ap);function ap(t,e,n){var r=this;return(r=$l.call(this)||this).type=t,r.rd=e,r.od=n,r}function cp(t,e,n){var r=this;return(r=Zl.call(this)||this).type=t,r.rd=e,r.od=n,r}function hp(t,e,n){var r=this;return(r=tp.call(this)||this).type=t,r.nd=e,r.sd=n,r}function fp(t,e){var n=this;return(n=ep.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function lp(t,e,n){var r=this;return(r=np.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function pp(t,c,e,n){if(e[0]instanceof Gr&&(e[0]=e[0]._),e[0]instanceof zl)return function(t,e,n,r){if(!n)throw new Fr(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ps(t);o<s.length;o++){var u=s[o];if(u.field.Ot())i.push(oo(e,n.key));else{var a=n.field(u.field);if(Ji(a))throw new Fr(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Ct();throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Jo(i,r)}(t.C_,t.firestore.zr,e[0].Jf,n);var r=Hf(t.firestore);return function(t,e,n,r,i,o){var s=t.ne;if(i.length>s.length)throw new Fr(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.Ot()){if("string"!=typeof c)throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ls(t)&&-1!==c.indexOf("/"))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Ri.xt(c));if(!Di.qt(h))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Di(h);u.push(oo(e,h))}else{c=fl(n,r,c);u.push(c)}}return new Jo(u,o)}(t.C_,t.firestore.zr,r,c,e,n)}function dp(t,e,n){if(n instanceof Gr&&(n=n._),"string"==typeof n){if(""===n)throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ls(e)&&-1!==n.indexOf("/"))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Ri.xt(n));if(!Di.qt(e))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return oo(t,new Di(e))}if(n instanceof bf)return oo(t,n.S_);throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ec(n)+".")}function yp(t,e){if(!Array.isArray(t)||0===t.length)throw new Fr(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Fr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function vp(t,e,n){if(!n.isEqual(e))throw new Fr(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var mp,wp=(f(bp,mp=o),bp.prototype.Uf=function(t){return new Br(t)},bp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return new bf(this.firestore,null,t)},bp);function bp(t){var e=this;return(e=mp.call(this)||this).firestore=t,e}function _p(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Ep,Ip,Tp=(kp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},kp),Ap=(f(Lp,Ip=zl),Lp.prototype.exists=function(){return Ip.prototype.exists.call(this)},Lp.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Np(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.Yt(),t.serverTimestamps)}},Lp.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){t=this.Jf.data().field(Kl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t,e.serverTimestamps)}},Lp),Np=(f(Rp,Ep=Ap),Rp.prototype.data=function(t){return void 0===t&&(t={}),Ep.prototype.data.call(this,t)},Rp),Op=(Object.defineProperty(Sp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Sp.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new Np(r.zf,r.Hf,t.key,t,new Tp(r.ud.tn.has(t.key),r.ud.fromCache),r.query.v_))})},Sp.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.ud.nn)throw new Fr(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.Ze.bt()){var n=0;return i.ud.docChanges.map(function(t){var e=new Np(i.zf,i.Hf,t.doc.key,t.doc,new Tp(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.Ze;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Np(i.zf,i.Hf,t.doc.key,t.doc,new Tp(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},Sp);function Sp(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Tp(r.hasPendingWrites,r.fromCache),this.query=n}function Rp(){return null!==Ep&&Ep.apply(this,arguments)||this}function Lp(t,e,n,r,i,o){var s=this;return(s=Ip.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function kp(t,e){this.hasPendingWrites=t,this.fromCache=e}function Dp(t,e){return t instanceof Ap&&e instanceof Ap?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Op&&e instanceof Op&&t.zf===e.zf&&Df(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Pp,Cp=(f(Up,Pp=o),Up.prototype.Uf=function(t){return new Br(t)},Up.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return new bf(this.firestore,null,t)},Up);function Up(t){var e=this;return(e=Pp.call(this)||this).firestore=t,e}function Vp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=nc(t,bf);var o=nc(t.firestore,Ml),s=Hf(o);return e instanceof Gr&&(e=e._),Mp(o,[("string"==typeof e||e instanceof mf?hl(s,"updateDoc",t.S_,e,n,r):cl(s,"updateDoc",t.S_,e)).F_(t.S_,Hs.exists(!0))])}function xp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Gr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||_p(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return _p(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof bf?(u=nc(e.firestore,Ml),a=us(e.S_.path),h={next:function(t){n[i]&&n[i](jp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=nc(e,_f),u=nc(s.firestore,Ml),a=s.C_,c=new Cp(u),h={next:function(t){n[i]&&n[i](new Op(u,c,s,t))},error:n[i+1],complete:n[i+2]},Xl(e.C_)),function(n,t,e){var r=this,i=new vf(h),o=new Dh(t,i,e);return n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rh,[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.I_(),n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Fl(u),a,f)}function Mp(t,e){return function(n,r){var t=this,i=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Xh,[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Fl(t),e)}function jp(t,e,n){var r=n.docs.get(e.S_),i=new Cp(t);return new Ap(t,i,e.S_,r,new Tp(n.hasPendingWrites,n.fromCache),e.v_)}var qp=(Fp.prototype.set=function(t,e,n){this.Ed();t=Bp(t,this.zf),e=gp(t.v_,e,n),n=Wf(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.fd.push(n.F_(t.S_,Hs.de())),this},Fp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();t=Bp(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof mf?hl(this.wd,"WriteBatch.update",t.S_,e,n,r):cl(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Hs.exists(!0))),this},Fp.prototype.delete=function(t){this.Ed();t=Bp(t,this.zf);return this.fd=this.fd.concat(new hu(t.S_,Hs.de())),this},Fp.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},Fp.prototype.Ed=function(){if(this.dd)throw new Fr(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Fp);function Fp(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Hf(t)}function Bp(t,e){if(t instanceof Gr&&(t=t._),t.firestore!==e)throw new Fr(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Gp,zp,Hp,Wp=(ed.prototype.get=function(t){var e=this,n=Bp(t,this.zf),r=new wp(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return kr();t=t[0];if(t instanceof bo)return new zl(e.zf,r,n.S_,null,n.v_);if(t instanceof wo)return new zl(e.zf,r,t.key,t,n.v_);throw kr()})},ed.prototype.set=function(t,e,n){t=Bp(t,this.zf),e=gp(t.v_,e,n),n=Wf(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Td.set(t.S_,n),this},ed.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Bp(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof mf?hl(this.wd,"Transaction.update",t.S_,e,n,r):cl(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},ed.prototype.delete=function(t){t=Bp(t,this.zf);return this.Td.delete(t.S_),this},f(td,Hp=ed),td.prototype.get=function(t){var e=this,n=Bp(t,this.zf),r=new Cp(this.zf);return Hp.prototype.get.call(this,t).then(function(t){return new Ap(e.zf,r,n.S_,t.Jf,new Tp(!1,!1),n.v_)})},td),Yp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Qp=(Zp.prototype.enableIndexedDbPersistence=function(t,e){throw new Fr(qr.FAILED_PRECONDITION,Yp)},Zp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Fr(qr.FAILED_PRECONDITION,Yp)},Zp.prototype.clearIndexedDbPersistence=function(t){throw new Fr(qr.FAILED_PRECONDITION,Yp)},Zp),Kp=(f($p,zp=Gr),Object.defineProperty($p.prototype,"zr",{get:function(){return this._.zr},enumerable:!1,configurable:!0}),$p.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.no()),t)).merge,this._.eo(t)},$p.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.no().host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},$p.prototype.enableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Rl(r)];case 1:return e=t.sent(),[4,kl(r)];case 2:return n=t.sent(),[2,(e.Zc(!0),(t=n).Gh.delete(0),ch(t))]}})})})}(Fl(nc(this._,Ml)))},$p.prototype.disableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Rl(r)];case 1:return e=t.sent(),[4,kl(r)];case 2:return n=t.sent(),[2,(e.Zc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(0),[4,hh(e)];case 1:return t.sent(),e.Jh.set("Offline"),[2]}})})}(n))]}})})})}(Fl(nc(this._,Ml)))},$p.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&$a("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},$p.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},$p.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},$p.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zh,[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Fl(nc(this._,Ml)))},$p.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new vf(t);return n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.add(e),e.next()},[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.I_(),n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.delete(e)},[4,Pl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Fl(nc(e,Ml)),_p(t)?t:{next:t});var e},Object.defineProperty($p.prototype,"app",{get:function(){if(!this.md)throw new Fr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),$p.prototype.collection=function(t){try{return new Ad(this,Rf(this._,t))}catch(t){throw fd(t,"collection()","Firestore.collection()")}},$p.prototype.doc=function(t){try{return new ud(this,Lf(this._,t))}catch(t){throw fd(t,"doc()","Firestore.doc()")}},$p.prototype.collectionGroup=function(t){try{return new Ed(this,function(t,e){if(t=nc(t,uc),Xa("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Fr(qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new _f(t,null,(e=e,new ss(Ri.Nt(),e)))}(this._,t))}catch(t){throw fd(t,"collectionGroup()","Firestore.collectionGroup()")}},$p.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Sl(n).then(function(t){return t.Qh})];case 1:return e=t.sent(),new El(n.ks,e,r,i).run(),[2]}})})}),i.promise}(Fl(n=this._),function(t){return t=new Wp(n,t),e(new od(r,t))})},$p.prototype.batch=function(){var e=this;return Fl(this._),new sd(new qp(this._,function(t){return Mp(e._,t)}))},$p.prototype.loadBundle=function(t){throw new Fr(qr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},$p.prototype.namedQuery=function(t){throw new Fr(qr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},$p),Xp=(f(Jp,Gp=o),Jp.prototype.Uf=function(t){return new Kr(new Br(t))},Jp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return ud.Ad(t,this.firestore,null)},Jp);function Jp(t){var e=this;return(e=Gp.call(this)||this).firestore=t,e}function $p(t,e,n){var r=this;return(r=zp.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof oi||(r.md=t),r}function Zp(){}function td(t,e){var n=this;return(n=Hp.call(this,t,e)||this).zf=t,n}function ed(t,e){this.zf=t,this.Td=e,this.wd=Hf(t)}var nd,rd,id,od=(f(hd,id=Gr),hd.prototype.get=function(t){var e=this,t=Dd(t);return this._.get(t).then(function(t){return new bd(e.zf,t)})},hd.prototype.set=function(t,e,n){t=Dd(t);return n?(Ja("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},hd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Dd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},hd.prototype.delete=function(t){t=Dd(t);return this._.delete(t),this},hd),sd=(f(cd,rd=Gr),cd.prototype.set=function(t,e,n){t=Dd(t);return n?(Ja("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},cd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Dd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},cd.prototype.delete=function(t){t=Dd(t);return this._.delete(t),this},cd.prototype.commit=function(){return this._.commit()},cd),ud=(f(ad,nd=Gr),ad.Rd=function(t,e,n){if(t.length%2!=0)throw new Fr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Ct()+" has "+t.length);return new ad(e,new bf(e._,n,new Di(t)))},ad.Ad=function(t,e,n){return new ad(e,new bf(e._,n,t))},Object.defineProperty(ad.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"parent",{get:function(){return new Ad(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),ad.prototype.collection=function(t){try{return new Ad(this.firestore,Rf(this._,t))}catch(t){throw fd(t,"collection()","DocumentReference.collection()")}},ad.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof bf&&kf(this._,t)},ad.prototype.set=function(t,e){e=Ja("DocumentReference.set",e);try{return function(t,e,n){t=nc(t,bf);var r=nc(t.firestore,Ml),e=gp(t.v_,e,n);return Mp(r,[Wf(Hf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Hs.de())])}(this._,t,e)}catch(t){throw fd(t,"setDoc()","DocumentReference.set()")}},ad.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Vp(this._,t):Vp.apply(void 0,l([this._,t,e],n))}catch(t){throw fd(t,"updateDoc()","DocumentReference.update()")}},ad.prototype.delete=function(){return Mp(nc((t=this._).firestore,Ml),[new hu(t.S_,Hs.de())]);var t},ad.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ld(t),i=pd(t,function(t){return new bd(e.firestore,new Ap(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return xp(this._,r,i)},ad.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=nc(e,bf);var n=nc(e.firestore,Ml),t=Fl(n),r=new Cp(n);return function(n,r){var t=this,i=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Pa(t,e)}))];case 1:return(i=t.sent())instanceof wo?u.resolve(i):i instanceof bo?u.resolve(null):u.reject(new Fr(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Aa(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Ap(n,r,e.S_,t,new Tp(t instanceof wo&&t.Jt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=nc(e,bf);var n=nc(e.firestore,Ml);return Cl(Fl(n),e.S_,{source:"server"}).then(function(t){return jp(n,e,t)})}:function(e){e=nc(e,bf);var n=nc(e.firestore,Ml);return Cl(Fl(n),e.S_).then(function(t){return jp(n,e,t)})})(this._).then(function(t){return new bd(e.firestore,new Ap(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},ad.prototype.withConverter=function(t){return new ad(this.firestore,this._.withConverter(t))},ad);function ad(t,e){var n=this;return(n=nd.call(this,e)||this).firestore=t,n.Hf=new Xp(t),n}function cd(){return null!==rd&&rd.apply(this,arguments)||this}function hd(t,e){var n=this;return(n=id.call(this,e)||this).zf=t,n}function fd(t,e,n){return t.message=t.message.replace(e,n),t}function ld(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!_p(r))return r}return{}}function pd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=_p(t[0])?t[0]:_p(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var dd,yd,vd,gd,md,wd,bd=(f(kd,wd=Gr),Object.defineProperty(kd.prototype,"ref",{get:function(){return new ud(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),kd.prototype.data=function(t){return this._.data(t)},kd.prototype.get=function(t,e){return this._.get(t,e)},kd.prototype.isEqual=function(t){return Dp(this._,t._)},kd),_d=(f(Ld,md=bd),Ld.prototype.data=function(t){return this._.data(t)},Ld),Ed=(f(Rd,gd=Gr),Rd.prototype.where=function(t,e,n){try{return new Rd(this.firestore,Jl(this._,(r=n,i=e,o=Kl("where",t),new rp(o,i,r))))}catch(t){throw fd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Rd.prototype.orderBy=function(n,t){try{return new Rd(this.firestore,Jl(this._,function(t){void 0===t&&(t="asc");var e=t,t=Kl("orderBy",n);return new ip(t,e)}(t)))}catch(n){throw fd(n,/(orderBy|where)\(\)/,"Query.$1()")}},Rd.prototype.limit=function(t){try{return new Rd(this.firestore,Jl(this._,(rc("limit",e=t),new op("limit",e,"F"))))}catch(t){throw fd(t,"limit()","Query.limit()")}var e},Rd.prototype.limitToLast=function(t){try{return new Rd(this.firestore,Jl(this._,(rc("limitToLast",e=t),new op("limitToLast",e,"L"))))}catch(t){throw fd(t,"limitToLast()","Query.limitToLast()")}var e},Rd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Jl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw fd(t,"startAt()","Query.startAt()")}},Rd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Jl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw fd(t,"startAfter()","Query.startAfter()")}},Rd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Jl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw fd(t,"endBefore()","Query.endBefore()")}},Rd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Jl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw fd(t,"endAt()","Query.endAt()")}},Rd.prototype.isEqual=function(t){return Df(this._,t._)},Rd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=nc(e,_f);var n=nc(e.firestore,Ml),t=Fl(n),r=new Cp(n);return function(n,r){var t=this,i=new Ai;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Dc(i,o,!0)];case 1:return r=t.sent(),e=new Gh(o,r.za),n=e.bl(r.documents),n=e.yr(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Aa(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Op(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=nc(e,_f);var n=nc(e.firestore,Ml),t=Fl(n),r=new Cp(n);return Ul(t,e.C_,{source:"server"}).then(function(t){return new Op(n,r,e,t)})}:function(e){e=nc(e,_f);var n=nc(e.firestore,Ml),t=Fl(n),r=new Cp(n);return Xl(e.C_),Ul(t,e.C_).then(function(t){return new Op(n,r,e,t)})})(this._).then(function(t){return new Td(e.firestore,new Op(e.firestore._,e.Hf,e._,t.ud))})},Rd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ld(t),i=pd(t,function(t){return new Td(e.firestore,new Op(e.firestore._,e.Hf,e._,t.ud))});return xp(this._,r,i)},Rd.prototype.withConverter=function(t){return new Rd(this.firestore,this._.withConverter(t))},Rd),Id=(f(Sd,vd=Gr),Object.defineProperty(Sd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"doc",{get:function(){return new _d(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Sd),Td=(f(Od,yd=Gr),Object.defineProperty(Od.prototype,"query",{get:function(){return new Ed(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new _d(e.zf,t)})},enumerable:!1,configurable:!0}),Od.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Id(e.zf,t)})},Od.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new _d(r.zf,t))})},Od.prototype.isEqual=function(t){return Dp(this._,t._)},Od),Ad=(f(Nd,dd=Ed),Object.defineProperty(Nd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"parent",{get:function(){var t=this._.parent;return t?new ud(this.firestore,t):null},enumerable:!1,configurable:!0}),Nd.prototype.doc=function(t){try{return new ud(this.firestore,void 0===t?Lf(this._):Lf(this._,t))}catch(t){throw fd(t,"doc()","CollectionReference.doc()")}},Nd.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=nc(e.firestore,Ml),r=Lf(e),n=gp(e.v_,n),Mp(t,[Wf(Hf(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Hs.exists(!1))]).then(function(){return r}).then(function(t){return new ud(i.firestore,t)})},Nd.prototype.isEqual=function(t){return kf(this._,t._)},Nd.prototype.withConverter=function(t){return new Nd(this.firestore,this._.withConverter(t))},Nd);function Nd(t,e){var n=this;return(n=dd.call(this,t,e)||this).firestore=t,n._=e,n}function Od(t,e){var n=this;return(n=yd.call(this,e)||this).zf=t,n}function Sd(t,e){var n=this;return(n=vd.call(this,e)||this).zf=t,n}function Rd(t,e){var n=this;return(n=gd.call(this,e)||this).firestore=t,n.Hf=new Xp(t),n}function Ld(){return null!==md&&md.apply(this,arguments)||this}function kd(t,e){var n=this;return(n=wd.call(this,e)||this).zf=t,n}function Dd(t){return t instanceof Gr&&(t=t._),nc(t,bf)}var Pd,Cd,Ie=(f(Md,Cd=Gr),Md.documentId=function(){return new Md(ki.kt().Ct())},Md.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof mf&&this._.b_.isEqual(t.b_)},Md),o=(f(xd,Pd=Gr),xd.serverTimestamp=function(){var t=new el("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new xd(t)},xd.delete=function(){var t=new Qf("deleteField");return t._methodName="FieldValue.delete",new xd(t)},xd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nl("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new xd(n)},xd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rl("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new xd(n)},xd.increment=function(t){t=new il("increment",t);return t._methodName="FieldValue.increment",new xd(t)},xd.prototype.isEqual=function(t){return this._.isEqual(t._)},xd),Ud=(Vd.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},Vd.prototype.catch=function(t){return this.yd.promise.catch(t)},Vd.prototype.then=function(t,e){return this.yd.promise.then(t,e)},Vd.prototype.e_=function(t){this.n_(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},Vd.prototype.i_=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},Vd.prototype.n_=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},Vd);function Vd(){this.Pd={},this.yd=new Ai,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function xd(){return null!==Pd&&Pd.apply(this,arguments)||this}function Md(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cd.call(this,new(mf.bind.apply(mf,l([void 0],t))))||this}function jd(t,s){var e=new Ud;return function(n,t,r){var e,i=this,o=(e=s,t=wa(t),e=function(t){if(t instanceof Uint8Array)return df(t,void 0);if(t instanceof ArrayBuffer)return df(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new gf(e,t));n.ks.Ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=cf,[4,Dl(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(Fl(t._),t.zr,e),e}var qd=(Fd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Fd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Fd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Fd);function Fd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Bd,Gd,zd={Firestore:Kp,GeoPoint:Pf,Timestamp:Oi,Blob:Kr,Transaction:od,WriteBatch:sd,DocumentReference:ud,DocumentSnapshot:bd,Query:Ed,QueryDocumentSnapshot:_d,QuerySnapshot:Td,CollectionReference:Ad,FieldPath:Ie,FieldValue:o,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Bd=e.default).INTERNAL.registerComponent(new qd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Kp(e,new Ml(e,t),new Qp)},"PUBLIC").setServiceProps(Object.assign({},zd))),Bd.registerVersion("@firebase/firestore","2.1.0-202011822428"),(Gd=Kp).prototype.loadBundle=function(t){return jd(this,t)},Gd.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Wc.ho(t,e)})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Fl((e=this)._),t).then(function(t){return t?new Ed(e,new _f(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
