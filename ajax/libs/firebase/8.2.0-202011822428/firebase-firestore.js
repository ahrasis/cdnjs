!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Tg){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(Tg);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=l=l||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((_e={})[l.DEBUG]="log",_e[l.VERBOSE]="log",_e[l.INFO]="info",_e[l.WARN]="warn",_e[l.ERROR]="error",_e),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},O=N||self;function D(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++R))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=O.navigator;if(J){J=J.userAgent;if(J){K=J;break t}}K=""}function X(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Q(K,"Opera"),it=Q(K,"Trident")||Q(K,"MSIE"),ot=Q(K,"Edge"),st=ot||it,ut=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),at=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ct(){var t=O.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=O.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",D,e),O.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Dt={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ut(t);if(c||(t[Ot]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Tt(t)))}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Lt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new wt(e,this))}function Ut(t){return(t=t[Ot])instanceof At?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function jt(){F.call(this),this.c=new At(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=qt(o,r,!0,e)&&s;if(s=qt(o=e.a=t,r,!0,e)&&s,s=qt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=qt(o=e.a=n[i],r,!1,e)&&s}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,F),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Mt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=O.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Ht=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Wt},function(t){t.reset()}));function Kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Qt(t,e){var n;zt||(n=O.Promise.resolve(void 0),zt=function(){n.then(Xt)}),Yt||(zt(),Yt=!0),Jt.add(t,e)}Gt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Gt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||O,this.f=U(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(_(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){F.call(this),this.b=t,this.a={}}j(ue,F);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){X(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();Ft(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();Ft(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ee={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},_e={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Se,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Oe(){mt.call(this,"d")}function De(){mt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Oe,mt),j(De,mt),j(xe,Te),Se=new xe;var Pe=45e3,Re={},Le={};function Ce(t,e,n){t.H=1,t.i=nn(Je(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=M(),Me(t),t.l=Je(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(U(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),qe(t))}function Me(t){t.T=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Va,t),e)}function Fe(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||_n(u.b,t)))if(u.I=t.N,!t.C&&_n(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Kn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ie(U(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Hn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ve(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,qe(this)):je(this,this.T-n)},(A=He.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Ke(this),this.a.concat()},A.get=function(t,e){return We(this.b,t)?this.b[t]:e},A.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Je(t){return new Ye(t)}function Xe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function On(){this.a=new Sn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var xn=O.JSON.parse;function kn(t){jt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}j(kn,jt);var Pn="",Rn=/^https?$/i,Ln=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),jn(t)}function Vn(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))te(t.za,0,t);else if(Ft(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n);if(e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Vn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",X(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,en(n=Je(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Xn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Je(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Kn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Wn(t){Kn(t),t.j&&(O.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Yn(t)}function Yn(t){In(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,r=Je(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Xn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Ce(n,r,e)}function Xn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Qt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ie(U(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Xn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Je(e)),n.j=null,n.I=!0,Ue(n,t)}function rr(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,Ft(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ie(U(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Ya,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Xe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,O.Image?((i=new Image).onload=V(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Dn,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Wn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Je(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=O.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Xe(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&X(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Xn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Se),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Je(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||In(this.b)||Jn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Kn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Kn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Hn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=Bt(t),Qn(this.a,e)):Qn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Oe),j(dr,De),j(yr,hr),yr.prototype.ta=function(){Ft(this.a,"a")},yr.prototype.sa=function(t){Ft(this.a,new pr(t))},yr.prototype.ra=function(t){Ft(this.a,new dr)},yr.prototype.qa=function(){Ft(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,_e.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=ye,gr=Ee,mr=_e,wr=pe,br=10,Ir=11,Er=Ne,_r=kn,Tr="8.2.0-202011822428",Ar=new o("@firebase/firestore");function Nr(){return Ar.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.DEBUG&&(e=n.map(xr),Ar.debug.apply(Ar,f(["Firestore ("+Tr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.ERROR&&(e=n.map(xr),Ar.error.apply(Ar,f(["Firestore ("+Tr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.WARN&&(e=n.map(xr),Ar.warn.apply(Ar,f(["Firestore ("+Tr+"): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t;throw Or(t),new Error(t)}function Pr(t){t||kr()}var Rr=(Lr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Lr);function Lr(){}function Cr(t,e){return t<e?-1:e<t?1:0}function Ur(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Vr(t){return t+"\0"}var Mr=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.u=function(t){return Cr(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}Mr.h=new Mr("");var Fr,qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=(h(Kr,Fr=Error),Kr),Gr=(Hr.fromBase64String=function(t){try{return new Hr(Mr.fromBase64String(t))}catch(t){throw new Br(qr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Hr.fromUint8Array=function(t){return new Hr(Mr.fromUint8Array(t))},Hr.prototype.toBase64=function(){return this.l.toBase64()},Hr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Hr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Hr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Hr),zr=function(t){this._=t};function Hr(t){this.l=t}function Kr(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Wr(){if("undefined"==typeof Uint8Array)throw new Br(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Qr(){if("undefined"==typeof atob)throw new Br(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Yr,Jr=(h(Zr,Yr=zr),Zr.fromBase64String=function(t){return Qr(),new Zr(Gr.fromBase64String(t))},Zr.fromUint8Array=function(t){return Wr(),new Zr(Gr.fromUint8Array(t))},Zr.prototype.toBase64=function(){return Qr(),this._.toBase64()},Zr.prototype.toUint8Array=function(){return Wr(),this._.toUint8Array()},Zr.prototype.isEqual=function(t){return this._.isEqual(t._)},Zr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Zr),Xr=($r.prototype.T=function(){return null!=this.uid},$r.prototype.I=function(){return this.T()?"uid:"+this.uid:"anonymous-user"},$r.prototype.isEqual=function(t){return t.uid===this.uid},$r);function $r(t){this.uid=t}function Zr(){return null!==Yr&&Yr.apply(this,arguments)||this}Xr.UNAUTHENTICATED=new Xr(null),Xr.m=new Xr("google-credentials-uid"),Xr.A=new Xr("first-party-uid");function ti(t,e){this.user=e,this.type="OAuth",this.R={},this.R.Authorization="Bearer "+t}var ei=(yi.prototype.getToken=function(){return Promise.resolve(null)},yi.prototype.g=function(){},yi.prototype.V=function(t){(this.P=t)(Xr.UNAUTHENTICATED)},yi.prototype.p=function(){this.P=null},yi),ni=(di.prototype.getToken=function(){var e=this,n=this.D,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.D!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new ti(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},di.prototype.g=function(){this.forceRefresh=!0},di.prototype.V=function(t){this.P=t,this.S&&t(this.currentUser)},di.prototype.p=function(){this.auth&&this.auth.removeAuthTokenListener(this.v),this.v=null,this.P=null},di.prototype.C=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new Xr(t)},di),ri=(Object.defineProperty(pi.prototype,"R",{get:function(){var t={"X-Goog-AuthUser":this.F},e=this.N.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),pi),ii=(li.prototype.getToken=function(){return Promise.resolve(new ri(this.N,this.F))},li.prototype.V=function(t){t(Xr.A)},li.prototype.p=function(){},li.prototype.g=function(){},li),oi=function(t,e,n,r,i,o){this.O=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.k=o},si=(Object.defineProperty(fi.prototype,"M",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return t instanceof fi&&t.projectId===this.projectId&&t.database===this.database},fi),ui=(hi.prototype.$=function(t){},hi.prototype.L=function(){},hi),ai=(ci.prototype.$=function(t){this.W.push(t)},ci.prototype.L=function(){window.removeEventListener("online",this.B),window.removeEventListener("offline",this.U)},ci.prototype.j=function(){window.addEventListener("online",this.B),window.addEventListener("offline",this.U)},ci.prototype.q=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(0)},ci.prototype.K=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(1)},ci.G=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ci);function ci(){var t=this;this.B=function(){return t.q()},this.U=function(){return t.K()},this.W=[],this.j()}function hi(){}function fi(t,e){this.projectId=t,this.database=e||"(default)"}function li(t,e){this.N=t,this.F=e}function pi(t,e){this.N=t,this.F=e,this.type="FirstParty",this.user=Xr.A}function di(t){var e=this;this.v=null,this.currentUser=Xr.UNAUTHENTICATED,this.S=!1,this.D=0,this.P=null,this.forceRefresh=!1,this.v=function(){e.D++,e.currentUser=e.C(),e.S=!0,e.P&&e.P(e.currentUser)},this.D=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.v):(this.v(null),t.get().then(function(t){e.auth=t,e.v&&e.auth.addAuthTokenListener(e.v)},function(){}))}function yi(){this.P=null}function vi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}function mi(t){return"number"==typeof t&&Number.isInteger(t)&&!gi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var wi,bi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};function Ii(t){switch(t){case qr.OK:return kr(),0;case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return 1;default:return kr(),0}}function Ei(t){if(void 0===t)return Or("GRPC error has no .code"),qr.UNKNOWN;switch(t){case wi.OK:return qr.OK;case wi.CANCELLED:return qr.CANCELLED;case wi.UNKNOWN:return qr.UNKNOWN;case wi.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case wi.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case wi.INTERNAL:return qr.INTERNAL;case wi.UNAVAILABLE:return qr.UNAVAILABLE;case wi.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case wi.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case wi.NOT_FOUND:return qr.NOT_FOUND;case wi.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case wi.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case wi.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case wi.ABORTED:return qr.ABORTED;case wi.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case wi.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case wi.DATA_LOSS:return qr.DATA_LOSS;default:return kr()}}(_e=wi=wi||{})[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";var _i,Ti,Ai,Ni=(Gi.prototype.Y=function(t){this.X=t},Gi.prototype.Z=function(t){this.tt=t},Gi.prototype.onMessage=function(t){this.et=t},Gi.prototype.close=function(){this.J()},Gi.prototype.send=function(t){this.H(t)},Gi.prototype.nt=function(){this.X()},Gi.prototype.st=function(t){this.tt(t)},Gi.prototype.it=function(t){this.et(t)},Gi),Si=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Oi=(Bi.prototype.at=function(e,t,n,r){var i=this.ut(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.ht(t,r),this.lt(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Bi.prototype._t=function(t,e,n,r){return this.at(t,e,n,r)},Bi.prototype.ht=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.0-202011822428",t["Content-Type"]="text/plain",e)for(var n in e.R)e.R.hasOwnProperty(n)&&(t[n]=e.R[n])},Bi.prototype.ut=function(t,e){t=bi[t];return this.ot+"/v1/"+e+":"+t},h(qi,Ai=Bi),qi.prototype.lt=function(o,e,s,u){return new Promise(function(n,r){var i=new _r;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Br(qr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(qr).indexOf(e)?e:qr.UNKNOWN,r(new Br(e,t.message))):r(new Br(qr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Br(qr.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},qi.prototype.ft=function(t,e){var n,r=[this.ot,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.O.projectId+"/databases/"+this.O.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.k};this.ht(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Ni({H:function(t){a?Sr("Connection","Not sending because WebChannel is closed:",t):(u||(Sr("Connection","Opening WebChannel transport."),s.open(),u=!0),Sr("Connection","WebChannel sending:",t),s.send(t))},J:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Er.EventType.OPEN,function(){a||Sr("Connection","WebChannel transport opened.")}),t(s,Er.EventType.CLOSE,function(){a||(a=!0,Sr("Connection","WebChannel transport closed"),c.st())}),t(s,Er.EventType.ERROR,function(t){a||(a=!0,Dr("Connection","WebChannel transport errored:",t),c.st(new Br(qr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Er.EventType.MESSAGE,function(t){var e,n,r,i;a||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=wi[r];if(void 0!==t)return Ei(t)}(),i=n.message,void 0===t&&(t=qr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.st(new Br(t,i)),s.close()):(Sr("Connection","WebChannel received:",e),c.it(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Sr("Connection","Detected buffering proxy"):t.stat===Ir&&Sr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.nt()},0),c},qi),Di=(Fi.now=function(){return Fi.fromMillis(Date.now())},Fi.fromDate=function(t){return Fi.fromMillis(t.getTime())},Fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Fi(e,1e6*(t-1e3*e))},Fi.prototype.toDate=function(){return new Date(this.toMillis())},Fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Fi.prototype.dt=function(t){return this.seconds===t.seconds?Cr(this.nanoseconds,t.nanoseconds):Cr(this.seconds,t.seconds)},Fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Fi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Fi),xi=(ji.wt=function(t){return new ji(t)},ji.min=function(){return new ji(new Di(0,0))},ji.prototype.u=function(t){return this.timestamp.dt(t.timestamp)},ji.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ji.prototype.Et=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ji.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ji.prototype.Tt=function(){return this.timestamp},ji),o=(Object.defineProperty(Mi.prototype,"length",{get:function(){return this.It},enumerable:!1,configurable:!0}),Mi.prototype.isEqual=function(t){return 0===Mi.At(this,t)},Mi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Mi?t.forEach(function(t){e.push(t)}):e.push(t),this.Rt(e)},Mi.prototype.limit=function(){return this.offset+this.length},Mi.prototype.Pt=function(t){return t=void 0===t?1:t,this.Rt(this.segments,this.offset+t,this.length-t)},Mi.prototype.yt=function(){return this.Rt(this.segments,this.offset,this.length-1)},Mi.prototype.gt=function(){return this.segments[this.offset]},Mi.prototype.Vt=function(){return this.get(this.length-1)},Mi.prototype.get=function(t){return this.segments[this.offset+t]},Mi.prototype.bt=function(){return 0===this.length},Mi.prototype.vt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Mi.prototype.St=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Mi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Mi.prototype.Dt=function(){return this.segments.slice(this.offset,this.limit())},Mi.At=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Mi),ki=(h(Vi,Ti=o),Vi.prototype.Rt=function(t,e,n){return new Vi(t,e,n)},Vi.prototype.Ct=function(){return this.Dt().join("/")},Vi.prototype.toString=function(){return this.Ct()},Vi.xt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Br(qr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Vi(n)},Vi.Nt=function(){return new Vi([])},Vi),Pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ri=(h(Ui,_i=o),Ui.prototype.Rt=function(t,e,n){return new Ui(t,e,n)},Ui.Ft=function(t){return Pi.test(t)},Ui.prototype.Ct=function(){return this.Dt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ui.Ft(t)||(t="`"+t+"`"),t}).join(".")},Ui.prototype.toString=function(){return this.Ct()},Ui.prototype.Ot=function(){return 1===this.length&&"__name__"===this.get(0)},Ui.kt=function(){return new Ui(["__name__"])},Ui.Mt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Br(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Br(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Br(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ui(e)},Ui.Nt=function(){return new Ui([])},Ui),Li=(Ci.$t=function(t){return new Ci(ki.xt(t))},Ci.Lt=function(t){return new Ci(ki.xt(t).Pt(5))},Ci.prototype.Bt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ci.prototype.isEqual=function(t){return null!==t&&0===ki.At(this.path,t.path)},Ci.prototype.toString=function(){return this.path.toString()},Ci.At=function(t,e){return ki.At(t.path,e.path)},Ci.qt=function(t){return t.length%2==0},Ci.Ut=function(t){return new Ci(new ki(t.slice()))},Ci);function Ci(t){this.path=t}function Ui(){return null!==_i&&_i.apply(this,arguments)||this}function Vi(){return null!==Ti&&Ti.apply(this,arguments)||this}function Mi(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.It=n}function ji(t){this.timestamp=t}function Fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function qi(t){var e=this;return(e=Ai.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.k=t.k,e}function Bi(t){this.rt=t,this.O=t.O;var e=t.ssl?"https":"http";this.ot=e+"://"+t.host,this.ct="projects/"+this.O.projectId+"/databases/"+this.O.database+"/documents"}function Gi(t){this.H=t.H,this.J=t.J}function zi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Hi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ki(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wi=(Yi.prototype.Qt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].vt(t))return!0;return!1},Yi.prototype.isEqual=function(t){return Ur(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Yi),Qi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(t){(this.fields=t).sort(Ri.At)}function Ji(t){if(Pr(!!t),"string"!=typeof t)return{seconds:Xi(t.seconds),nanos:Xi(t.nanos)};var e=0,n=Qi.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Xi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $i(t){return"string"==typeof t?Mr.fromBase64String(t):Mr.fromUint8Array(t)}function Zi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function to(t){t=Ji(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(t.seconds,t.nanos)}function eo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zi(t)?4:10:kr()}function no(r,i){var t,e=eo(r);if(e!==eo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return to(r).isEqual(to(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ji(r.timestampValue),t=Ji(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,$i(r.bytesValue).isEqual($i(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Xi((t=r).geoPointValue.latitude)===Xi(e.geoPointValue.latitude)&&Xi(t.geoPointValue.longitude)===Xi(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Xi(t.integerValue)===Xi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Xi(t.doubleValue),e=Xi(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Ur(r.arrayValue.values||[],i.arrayValue.values||[],no);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(zi(e)!==zi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!no(e[t],n[t])))return!1;return!0}();default:return kr()}}function ro(t,e){return void 0!==(t.values||[]).find(function(t){return no(t,e)})}function io(t,e){var n,r,i=eo(t),o=eo(e);if(i!==o)return Cr(i,o);switch(i){case 0:return 0;case 1:return Cr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Xi(t.integerValue||t.doubleValue),n=Xi(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return oo(t.timestampValue,e.timestampValue);case 4:return oo(to(t),to(e));case 5:return Cr(t.stringValue,e.stringValue);case 6:return function(t,e){t=$i(t),e=$i(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Cr(n[i],r[i]);if(0!==o)return o}return Cr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Cr(Xi(i.latitude),Xi(r.latitude)))?n:Cr(Xi(i.longitude),Xi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=io(n[i],r[i]);if(o)return o}return Cr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Cr(r[s],o[s]);if(0!==u)return u;u=io(n[r[s]],i[o[s]]);if(0!==u)return u}return Cr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function oo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Cr(t,e);var n=Ji(t),t=Ji(e),e=Cr(n.seconds,t.seconds);return 0!==e?e:Cr(n.nanos,t.nanos)}function so(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ji(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?$i(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Li.Lt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):kr();var e}(t)}function uo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Ct()}}function ao(t){return t&&"integerValue"in t}function co(t){return!!t&&"arrayValue"in t}function ho(t){return t&&"nullValue"in t}function fo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lo(t){return t&&"mapValue"in t}var po=(go.empty=function(){return new go({mapValue:{}})},go.prototype.field=function(t){if(t.bt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!lo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.Vt()])||null},go.prototype.isEqual=function(t){return no(this.proto,t.proto)},go),yo=(vo.prototype.set=function(t,e){return this.jt(t,e),this},vo.prototype.delete=function(t){return this.jt(t,null),this},vo.prototype.jt=function(t,e){for(var n=this.Wt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===eo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.Vt(),e)},vo.prototype.Gt=function(){var t=this.zt(Ri.Nt(),this.Wt);return null!=t?new po(t):this.Kt},vo.prototype.zt=function(r,t){var i=this,o=!1,e=this.Kt.field(r),s=lo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.zt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},vo);function vo(t){void 0===t&&(t=po.empty()),this.Kt=t,this.Wt=new Map}function go(t){this.proto=t}var mo,wo,bo,_e=function(t,e){this.key=t,this.version=e},Io=(h(So,bo=_e),So.prototype.field=function(t){return this.Ht.field(t)},So.prototype.data=function(){return this.Ht},So.prototype.Yt=function(){return this.Ht.proto},So.prototype.isEqual=function(t){return t instanceof So&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jt===t.Jt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ht.isEqual(t.Ht)},So.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ht.toString()+", {hasLocalMutations: "+this.Jt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return this.Jt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),So),Eo=(h(No,wo=_e),No.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(No.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),No.prototype.isEqual=function(t){return t instanceof No&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},No),_o=(h(Ao,mo=_e),Ao.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ao.prototype.isEqual=function(t){return t instanceof Ao&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ao),To=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Xt=null};function Ao(){return null!==mo&&mo.apply(this,arguments)||this}function No(t,e,n){var r=this;return(r=wo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function So(t,e,n,r){var i=this;return(i=bo.call(this,t,e)||this).Ht=n,i.Jt=!!r.Jt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Oo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new To(t,e,n,r,i,o,s)}function Do(t){var e=t;return null===e.Xt&&(t=e.path.Ct(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Ct()+t.op.toString()+so(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Ct()+t.dir}).join(","),vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=is(e.startAt)),e.endAt&&(t+="|ub:",t+=is(e.endAt)),e.Xt=t),e.Xt}function xo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!no(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!us(t.startAt,e.startAt)&&us(t.endAt,e.endAt)}function ko(t){return Li.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Po,Ro=(h(Lo,Po=function(){}),Lo.create=function(t,e,n){return t.Ot()?"in"===e||"not-in"===e?this.Zt(t,e,n):new Mo(t,e,n):"array-contains"===e?new Yo(t,n):"in"===e?new Jo(t,n):"not-in"===e?new Xo(t,n):"array-contains-any"===e?new $o(t,n):new Lo(t,e,n)},Lo.Zt=function(t,e,n){return new("in"===e?jo:Fo)(t,n)},Lo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.te(io(t,this.value)):null!==t&&eo(this.value)===eo(t)&&this.te(io(t,this.value))},Lo.prototype.te=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},Lo.prototype.ee=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Lo);function Lo(t,e,n){var r=this;return(r=Po.call(this)||this).field=t,r.op=e,r.value=n,r}var Co,Uo,Vo,Mo=(h(Go,Vo=Ro),Go.prototype.matches=function(t){t=Li.At(t.key,this.key);return this.te(t)},Go),jo=(h(Bo,Uo=Ro),Bo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bo),Fo=(h(qo,Co=Ro),qo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},qo);function qo(t,e){var n=this;return(n=Co.call(this,t,"not-in",e)||this).keys=zo(0,e),n}function Bo(t,e){var n=this;return(n=Uo.call(this,t,"in",e)||this).keys=zo(0,e),n}function Go(t,e,n){var r=this;return(r=Vo.call(this,t,e,n)||this).key=Li.Lt(n.referenceValue),r}function zo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Li.Lt(t.referenceValue)})}var Ho,Ko,Wo,Qo,Yo=(h(rs,Qo=Ro),rs.prototype.matches=function(t){t=t.field(this.field);return co(t)&&ro(t.arrayValue,this.value)},rs),Jo=(h(ns,Wo=Ro),ns.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ro(this.value.arrayValue,t)},ns),Xo=(h(es,Ko=Ro),es.prototype.matches=function(t){if(ro(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ro(this.value.arrayValue,t)},es),$o=(h(ts,Ho=Ro),ts.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!co(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ro(e.value.arrayValue,t)})},ts),Zo=function(t,e){this.position=t,this.before=e};function ts(t,e){return Ho.call(this,t,"array-contains-any",e)||this}function es(t,e){return Ko.call(this,t,"not-in",e)||this}function ns(t,e){return Wo.call(this,t,"in",e)||this}function rs(t,e){return Qo.call(this,t,"array-contains",e)||this}function is(t){return(t.before?"b":"a")+":"+t.position.map(so).join(",")}var os=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ss(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.Ot()?Li.At(Li.Lt(s.referenceValue),n.key):io(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function us(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!no(t.position[n],e.position[n]))return!1;return!0}var as=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.ne=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.se=null,this.ie=null,this.startAt,this.endAt};function cs(t,e,n,r,i,o,s,u){return new as(t,e,n,r,i,o,s,u)}function hs(t){return new as(t)}function fs(t){return!vi(t.limit)&&"F"===t.limitType}function ls(t){return!vi(t.limit)&&"L"===t.limitType}function ps(t){return 0<t.ne.length?t.ne[0].field:null}function ds(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ee())return r.field}return null}function ys(t){return null!==t.collectionGroup}function vs(t){var e=t;if(null===e.se){e.se=[];var n=ds(e),t=ps(e);if(null!==n&&null===t)n.Ot()||e.se.push(new os(n)),e.se.push(new os(Ri.kt(),"asc"));else{for(var r=!1,i=0,o=e.ne;i<o.length;i++){var s=o[i];e.se.push(s),s.field.Ot()&&(r=!0)}r||(n=0<e.ne.length?e.ne[e.ne.length-1].dir:"asc",e.se.push(new os(Ri.kt(),n)))}}return e.se}function gs(t){var e=t;if(!e.ie)if("F"===e.limitType)e.ie=Oo(e.path,e.collectionGroup,vs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new os(o.field,s))}var u=e.endAt?new Zo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Zo(e.startAt.position,!e.startAt.before):null;e.ie=Oo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ie}function ms(t,e,n){return new as(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ws(t,e){return xo(gs(t),gs(e))&&t.limitType===e.limitType}function bs(t){return Do(gs(t))+"|lt:"+t.limitType}function Is(t){return"Query(target="+(e=gs(t),n=e.path.Ct(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Ct()+" "+t.op+" "+so(t.value)}).join(", ")+"]"),vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Ct()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+is(e.startAt)),e.endAt&&(n+=", endAt: "+is(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Es(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Bt(e.collectionGroup)&&e.path.vt(n):Li.qt(e.path)?e.path.isEqual(n):e.path.St(n))&&function(t){for(var e=0,n=i.ne;e<n.length;e++){var r=n[e];if(!r.field.Ot()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ss(t.startAt,vs(t),n))&&(!t.endAt||!ss(t.endAt,vs(t),n)));var e,n}function _s(u){return function(t,e){for(var n=!1,r=0,i=vs(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.Ot()?Li.At(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?io(n,t):kr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.Ot()}return 0}}var Ts=(As.prototype.ce=function(t){return new As(this.target,this.targetId,this.re,t,this.oe,this.lastLimboFreeSnapshotVersion,this.resumeToken)},As.prototype.ae=function(t,e){return new As(this.target,this.targetId,this.re,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},As.prototype.ue=function(t){return new As(this.target,this.targetId,this.re,this.sequenceNumber,this.oe,t,this.resumeToken)},As);function As(t,e,n,r,i,o,s){void 0===i&&(i=xi.min()),void 0===o&&(o=xi.min()),void 0===s&&(s=Mr.h),this.target=t,this.targetId=e,this.re=n,this.sequenceNumber=r,this.oe=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ns(t,e){if(t.he){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Ss(t){return{integerValue:""+t}}function Os(t,e){return mi(e)?Ss(e):Ns(t,e)}o=function(){this.le=void 0};function Ds(t,e){return t instanceof Bs?ao(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var xs,ks,Ps=(h(Cs,ks=o),Cs),Rs=(h(Ls,xs=o),Ls);function Ls(t){var e=this;return(e=xs.call(this)||this).elements=t,e}function Cs(){return null!==ks&&ks.apply(this,arguments)||this}function Us(t,e){for(var n=Hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return no(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Vs,Ms=(h(js,Vs=o),js);function js(t){var e=this;return(e=Vs.call(this)||this).elements=t,e}function Fs(t,e){for(var n=Hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!no(t,e)})}(i[r]);return{arrayValue:{values:n}}}var qs,Bs=(h(Gs,qs=o),Gs);function Gs(t,e){var n=this;return(n=qs.call(this)||this).fe=t,n._e=e,n}function zs(t){return Xi(t.integerValue||t.doubleValue)}function Hs(t){return co(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ks(t,e){this.version=t,this.transformResults=e}var Ws=function(t,e){this.field=t,this.transform=e},Qs=(Ys.de=function(){return new Ys},Ys.exists=function(t){return new Ys(void 0,t)},Ys.updateTime=function(t){return new Ys(t)},Object.defineProperty(Ys.prototype,"we",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ys.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ys);function Ys(t,e){this.updateTime=t,this.exists=e}function Js(t,e){return void 0!==t.updateTime?e instanceof Io&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Io}_e=function(){};function Xs(t,e,n,r){return t instanceof nu?function(t,e,n,r){if(!Js(t.Ee,e))return e;var i=t.value;t.fieldTransforms&&(r=au(t.fieldTransforms,n,e,r),i=cu(t.fieldTransforms,i,r));e=Zs(e);return new Io(t.key,e,i,{Jt:!0})}(t,e,r,n):t instanceof ru?function(t,e,n,r){if(!Js(t.Ee,e))return e;var i=Zs(e),r=su(t,e,au(t.fieldTransforms,n,e,r));return new Io(t.key,i,r,{Jt:!0})}(t,e,r,n):(e=e,Js((t=t).Ee,e)?new Eo(t.key,xi.min()):e)}function $s(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ee.isEqual(e.Ee)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ur(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Rs&&e instanceof Rs||t instanceof Ms&&e instanceof Ms?Ur(t.elements,e.elements,no):t instanceof Bs&&e instanceof Bs?no(t._e,e._e):t instanceof Ps&&e instanceof Ps)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Te.isEqual(e.Te));var n,r}function Zs(t){return t instanceof Io?t.version:xi.min()}var tu,eu,nu=(h(ou,eu=_e),ou),ru=(h(iu,tu=_e),iu);function iu(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=tu.call(this)||this).key=t,o.data=e,o.Te=n,o.Ee=r,o.fieldTransforms=i,o.type=1,o}function ou(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=eu.call(this)||this).key=t,i.value=e,i.Ee=n,i.fieldTransforms=r,i.type=0,i}function su(t,e,n){var r,i,o;return i=t,e=r=e instanceof Io?e.data():po.empty(),o=new yo(e),i.Te.fields.forEach(function(t){var e;t.bt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Gt(),cu(t.fieldTransforms,r,n)}function uu(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Io&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Rs?Us(o,s):o instanceof Ms?Fs(o,s):u))}return r}function au(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Io&&(h=n.field(a.field)),null===h&&r instanceof Io&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ps?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Rs?Us(c,i):c instanceof Ms?Fs(c,i):(c=Ds(h=c,i),i=zs(c)+zs(h._e),ao(c)&&ao(h._e)?Ss(i):Ns(h.fe,i))))}return o}function cu(t,e,n){for(var r=new yo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Gt()}function hu(t){this.count=t}var fu,lu,pu=(h(Eu,lu=_e),Eu),du=(h(Iu,fu=_e),Iu),yu=(bu.prototype.Ie=function(t,e){return new bu(this.At,this.root.Ie(t,e,this.At).copy(null,null,gu.me,null,null))},bu.prototype.remove=function(t){return new bu(this.At,this.root.remove(t,this.At).copy(null,null,gu.me,null,null))},bu.prototype.get=function(t){for(var e=this.root;!e.bt();){var n=this.At(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},bu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.bt();){var r=this.At(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},bu.prototype.bt=function(){return this.root.bt()},Object.defineProperty(bu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),bu.prototype.Ae=function(){return this.root.Ae()},bu.prototype.Re=function(){return this.root.Re()},bu.prototype.Pe=function(t){return this.root.Pe(t)},bu.prototype.forEach=function(n){this.Pe(function(t,e){return n(t,e),!1})},bu.prototype.toString=function(){var n=[];return this.Pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},bu.prototype.ye=function(t){return this.root.ye(t)},bu.prototype.ge=function(){return new vu(this.root,null,this.At,!1)},bu.prototype.Ve=function(t){return new vu(this.root,t,this.At,!1)},bu.prototype.pe=function(){return new vu(this.root,null,this.At,!0)},bu.prototype.be=function(t){return new vu(this.root,t,this.At,!0)},bu),vu=(wu.prototype.De=function(){var t=this.Se.pop(),e={key:t.key,value:t.value};if(this.ve)for(t=t.left;!t.bt();)this.Se.push(t),t=t.right;else for(t=t.right;!t.bt();)this.Se.push(t),t=t.left;return e},wu.prototype.Ce=function(){return 0<this.Se.length},wu.prototype.xe=function(){if(0===this.Se.length)return null;var t=this.Se[this.Se.length-1];return{key:t.key,value:t.value}},wu),gu=(mu.prototype.copy=function(t,e,n,r,i){return new mu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},mu.prototype.bt=function(){return!1},mu.prototype.Pe=function(t){return this.left.Pe(t)||t(this.key,this.value)||this.right.Pe(t)},mu.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},mu.prototype.min=function(){return this.left.bt()?this:this.left.min()},mu.prototype.Ae=function(){return this.min().key},mu.prototype.Re=function(){return this.right.bt()?this.key:this.right.Re()},mu.prototype.Ie=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ie(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ie(t,e,n))).Ne()},mu.prototype.Fe=function(){if(this.left.bt())return mu.EMPTY;var t=this;return t.left.Oe()||t.left.left.Oe()||(t=t.ke()),(t=t.copy(null,null,null,t.left.Fe(),null)).Ne()},mu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.bt()||r.left.Oe()||r.left.left.Oe()||(r=r.ke()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Oe()&&(r=r.Me()),r.right.bt()||r.right.Oe()||r.right.left.Oe()||(r=r.$e()),0===e(t,r.key)){if(r.right.bt())return mu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Fe())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ne()},mu.prototype.Oe=function(){return this.color},mu.prototype.Ne=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Le()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Me()),t.left.Oe()&&t.right.Oe()&&(t=t.Be()),t},mu.prototype.ke=function(){var t=this.Be();return t.right.left.Oe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Me())).Le()).Be()),t},mu.prototype.$e=function(){var t=this.Be();return t.left.left.Oe()&&(t=(t=t.Me()).Be()),t},mu.prototype.Le=function(){var t=this.copy(null,null,mu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},mu.prototype.Me=function(){var t=this.copy(null,null,mu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},mu.prototype.Be=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},mu.prototype.qe=function(){var t=this.Ue();return Math.pow(2,t)<=this.size+1},mu.prototype.Ue=function(){if(this.Oe()&&this.left.Oe())throw kr();if(this.right.Oe())throw kr();var t=this.left.Ue();if(t!==this.right.Ue())throw kr();return t+(this.Oe()?0:1)},mu);function mu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:mu.RED,this.left=null!=r?r:mu.EMPTY,this.right=null!=i?i:mu.EMPTY,this.size=this.left.size+1+this.right.size}function wu(t,e,n,r){this.ve=r,this.Se=[];for(var i=1;!t.bt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ve?t.left:t.right;else{if(0===i){this.Se.push(t);break}this.Se.push(t),t=this.ve?t.right:t.left}}function bu(t,e){this.At=t,this.root=e||gu.EMPTY}function Iu(t,e){var n=this;return(n=fu.call(this)||this).key=t,n.Ee=e,n.type=3,n.fieldTransforms=[],n}function Eu(t,e){var n=this;return(n=lu.call(this)||this).key=t,n.Ee=e,n.type=2,n.fieldTransforms=[],n}function _u(){this.size=0}gu.EMPTY=null,gu.RED=!0,gu.me=!1,gu.EMPTY=(Object.defineProperty(_u.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),_u.prototype.copy=function(t,e,n,r,i){return this},_u.prototype.Ie=function(t,e,n){return new gu(t,e)},_u.prototype.remove=function(t,e){return this},_u.prototype.bt=function(){return!0},_u.prototype.Pe=function(t){return!1},_u.prototype.ye=function(t){return!1},_u.prototype.Ae=function(){return null},_u.prototype.Re=function(){return null},_u.prototype.Oe=function(){return!1},_u.prototype.qe=function(){return!0},_u.prototype.Ue=function(){return 0},new _u);var Tu=(Ou.prototype.has=function(t){return null!==this.data.get(t)},Ou.prototype.first=function(){return this.data.Ae()},Ou.prototype.last=function(){return this.data.Re()},Object.defineProperty(Ou.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ou.prototype.indexOf=function(t){return this.data.indexOf(t)},Ou.prototype.forEach=function(n){this.data.Pe(function(t,e){return n(t),!1})},Ou.prototype.Qe=function(t,e){for(var n=this.data.Ve(t[0]);n.Ce();){var r=n.De();if(0<=this.At(r.key,t[1]))return;e(r.key)}},Ou.prototype.Ke=function(t,e){for(var n=void 0!==e?this.data.Ve(e):this.data.ge();n.Ce();)if(!t(n.De().key))return},Ou.prototype.We=function(t){t=this.data.Ve(t);return t.Ce()?t.De().key:null},Ou.prototype.ge=function(){return new Au(this.data.ge())},Ou.prototype.Ve=function(t){return new Au(this.data.Ve(t))},Ou.prototype.add=function(t){return this.copy(this.data.remove(t).Ie(t,!0))},Ou.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ou.prototype.bt=function(){return this.data.bt()},Ou.prototype.je=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ou.prototype.isEqual=function(t){if(!(t instanceof Ou))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ge(),n=t.data.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(0!==this.At(r,i))return!1}return!0},Ou.prototype.Dt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ou.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ou.prototype.copy=function(t){var e=new Ou(this.At);return e.data=t,e},Ou),Au=(Su.prototype.De=function(){return this.Ge.De().key},Su.prototype.Ce=function(){return this.Ge.Ce()},Su),Nu=new yu(Li.At);function Su(t){this.Ge=t}function Ou(t){this.At=t,this.data=new yu(this.At)}var Du=new yu(Li.At);var xu=new yu(Li.At);var ku=new Tu(Li.At);function Pu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ku,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ru=new Tu(Cr);var Lu=(Ju.Je=function(t){return new Ju(t.At)},Ju.prototype.has=function(t){return null!=this.ze.get(t)},Ju.prototype.get=function(t){return this.ze.get(t)},Ju.prototype.first=function(){return this.He.Ae()},Ju.prototype.last=function(){return this.He.Re()},Ju.prototype.bt=function(){return this.He.bt()},Ju.prototype.indexOf=function(t){t=this.ze.get(t);return t?this.He.indexOf(t):-1},Object.defineProperty(Ju.prototype,"size",{get:function(){return this.He.size},enumerable:!1,configurable:!0}),Ju.prototype.forEach=function(n){this.He.Pe(function(t,e){return n(t),!1})},Ju.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ze.Ie(t.key,t),e.He.Ie(t,null))},Ju.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ze.remove(t),this.He.remove(e)):this},Ju.prototype.isEqual=function(t){if(!(t instanceof Ju))return!1;if(this.size!==t.size)return!1;for(var e=this.He.ge(),n=t.He.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(!r.isEqual(i))return!1}return!0},Ju.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ju.prototype.copy=function(t,e){var n=new Ju;return n.At=this.At,n.ze=t,n.He=e,n},Ju),Cu=(Yu.prototype.track=function(t){var e=t.doc.key,n=this.Ye.get(e);!n||0!==t.type&&3===n.type?this.Ye=this.Ye.Ie(e,t):3===t.type&&1!==n.type?this.Ye=this.Ye.Ie(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ye=this.Ye.Ie(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ye=this.Ye.remove(e):1===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):kr()},Yu.prototype.Xe=function(){var n=[];return this.Ye.Pe(function(t,e){n.push(e)}),n},Yu),Uu=(Qu.sn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Qu(t,e,Lu.Je(e),i,n,r,!0,!1)},Object.defineProperty(Qu.prototype,"hasPendingWrites",{get:function(){return!this.tn.bt()},enumerable:!1,configurable:!0}),Qu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.tn.isEqual(t.tn)&&ws(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ze.isEqual(t.Ze)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Qu),Vu=(Wu.un=function(t,e){var n=new Map;return n.set(t,Mu.hn(t,e)),new Wu(xi.min(),n,Ru,Nu,Pu())},Wu),Mu=(Ku.hn=function(t,e){return new Ku(Mr.h,e,Pu(),Pu(),Pu())},Ku),ju=function(t,e,n,r){this.wn=t,this.removedTargetIds=e,this.key=n,this.En=r},Fu=function(t,e){this.targetId=t,this.Tn=e},qu=function(t,e,n,r){void 0===n&&(n=Mr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Bu=(Object.defineProperty(Hu.prototype,"ln",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Hu.prototype,"resumeToken",{get:function(){return this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Hu.prototype,"yn",{get:function(){return 0!==this.In},enumerable:!1,configurable:!0}),Object.defineProperty(Hu.prototype,"gn",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Hu.prototype.Vn=function(t){0<t.o()&&(this.Pn=!0,this.An=t)},Hu.prototype.pn=function(){var n=Pu(),r=Pu(),i=Pu();return this.mn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Mu(this.An,this.Rn,n,r,i)},Hu.prototype.bn=function(){this.Pn=!1,this.mn=$u()},Hu.prototype.vn=function(t,e){this.Pn=!0,this.mn=this.mn.Ie(t,e)},Hu.prototype.Sn=function(t){this.Pn=!0,this.mn=this.mn.remove(t)},Hu.prototype.Dn=function(){this.In+=1},Hu.prototype.Cn=function(){--this.In},Hu.prototype.xn=function(){this.Pn=!0,this.Rn=!0},Hu),Gu=(zu.prototype.$n=function(t){for(var e=0,n=t.wn;e<n.length;e++){var r=n[e];t.En instanceof Io?this.Ln(r,t.En):t.En instanceof Eo&&this.Bn(r,t.key,t.En)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Bn(r,t.key,t.En)},zu.prototype.qn=function(n){var r=this;this.Un(n,function(t){var e=r.Qn(t);switch(n.state){case 0:r.Kn(t)&&e.Vn(n.resumeToken);break;case 1:e.Cn(),e.yn||e.bn(),e.Vn(n.resumeToken);break;case 2:e.Cn(),e.yn||r.removeTarget(t);break;case 3:r.Kn(t)&&(e.xn(),e.Vn(n.resumeToken));break;case 4:r.Kn(t)&&(r.Wn(t),e.Vn(n.resumeToken));break;default:kr()}})},zu.prototype.Un=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fn.forEach(function(t,e){r.Kn(e)&&n(e)})},zu.prototype.jn=function(t){var e=t.targetId,n=t.Tn.count,t=this.Gn(e);t&&(ko(t=t.target)?0===n?(t=new Li(t.path),this.Bn(e,t,new Eo(t,xi.min()))):Pr(1===n):this.zn(e)!==n&&(this.Wn(e),this.Mn=this.Mn.add(e)))},zu.prototype.Hn=function(r){var i=this,o=new Map;this.Fn.forEach(function(t,e){var n=i.Gn(e);n&&(t.ln&&ko(n.target)&&(n=new Li(n.target.path),null!==i.On.get(n)||i.Jn(e,n)||i.Bn(e,n,new Eo(n,r))),t.gn&&(o.set(e,t.pn()),t.bn()))});var s=Pu();this.kn.forEach(function(t,e){var n=!0;e.Ke(function(t){t=i.Gn(t);return!t||2===t.re||(n=!1)}),n&&(s=s.add(t))});var t=new Vu(r,o,this.Mn,this.On,s);return this.On=Nu,this.kn=Xu(),this.Mn=new Tu(Cr),t},zu.prototype.Ln=function(t,e){var n;this.Kn(t)&&(n=this.Jn(t,e.key)?2:0,this.Qn(t).vn(e.key,n),this.On=this.On.Ie(e.key,e),this.kn=this.kn.Ie(e.key,this.Yn(e.key).add(t)))},zu.prototype.Bn=function(t,e,n){var r;this.Kn(t)&&(r=this.Qn(t),this.Jn(t,e)?r.vn(e,1):r.Sn(e),this.kn=this.kn.Ie(e,this.Yn(e).delete(t)),n&&(this.On=this.On.Ie(e,n)))},zu.prototype.removeTarget=function(t){this.Fn.delete(t)},zu.prototype.zn=function(t){var e=this.Qn(t).pn();return this.Nn.Xn(t).size+e._n.size-e.dn.size},zu.prototype.Dn=function(t){this.Qn(t).Dn()},zu.prototype.Qn=function(t){var e=this.Fn.get(t);return e||(e=new Bu,this.Fn.set(t,e)),e},zu.prototype.Yn=function(t){var e=this.kn.get(t);return e||(e=new Tu(Cr),this.kn=this.kn.Ie(t,e)),e},zu.prototype.Kn=function(t){var e=null!==this.Gn(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},zu.prototype.Gn=function(t){var e=this.Fn.get(t);return e&&e.yn?null:this.Nn.Zn(t)},zu.prototype.Wn=function(e){var n=this;this.Fn.set(e,new Bu),this.Nn.Xn(e).forEach(function(t){n.Bn(e,t,null)})},zu.prototype.Jn=function(t,e){return this.Nn.Xn(t).has(e)},zu);function zu(t){this.Nn=t,this.Fn=new Map,this.On=Nu,this.kn=Xu(),this.Mn=new Tu(Cr)}function Hu(){this.In=0,this.mn=$u(),this.An=Mr.h,this.Rn=!1,this.Pn=!0}function Ku(t,e,n,r,i){this.resumeToken=t,this.ln=e,this._n=n,this.fn=r,this.dn=i}function Wu(t,e,n,r,i){this.oe=t,this.rn=e,this.on=n,this.cn=r,this.an=i}function Qu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ze=n,this.docChanges=r,this.tn=i,this.fromCache=o,this.en=s,this.nn=u}function Yu(){this.Ye=new yu(Li.At)}function Ju(n){this.At=n?function(t,e){return n(t,e)||Li.At(t.key,e.key)}:function(t,e){return Li.At(t.key,e.key)},this.ze=Du,this.He=new yu(this.At)}function Xu(){return new yu(Li.At)}function $u(){return new yu(Li.At)}var Zu={asc:"ASCENDING",desc:"DESCENDING"},ta={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ea=function(t,e){this.O=t,this.he=e};function na(t,e){return t.he?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ra(t,e){return t.he?e.toBase64():e.toUint8Array()}function ia(t){return Pr(!!t),xi.wt((t=Ji(t),new Di(t.seconds,t.nanos)))}function oa(t,e){return new ki(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Ct()}function sa(t){t=ki.xt(t);return Pr(Aa(t)),t}function ua(t,e){return oa(t.O,e.path)}function aa(t,e){e=sa(e);if(e.get(1)!==t.O.projectId)throw new Br(qr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.O.projectId);if(e.get(3)!==t.O.database)throw new Br(qr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.O.database);return new Li(la(e))}function ca(t,e){return oa(t.O,e)}function ha(t){t=sa(t);return 4===t.length?ki.Nt():la(t)}function fa(t){return new ki(["projects",t.O.projectId,"databases",t.O.database]).Ct()}function la(t){return Pr(4<t.length&&"documents"===t.get(4)),t.Pt(5)}function pa(t,e,n){return{name:ua(t,e),fields:n.proto.mapValue.fields}}function da(t,e,n){var r=aa(t,e.name),t=ia(e.updateTime),e=new po({mapValue:{fields:e.fields}});return new Io(r,t,e,{hasCommittedMutations:!!n})}function ya(t,e){var n,r,i;if(e instanceof nu)n={update:pa(t,e.key,e.value)};else if(e instanceof pu)n={delete:ua(t,e.key)};else if(e instanceof ru)n={update:pa(t,e.key,e.data),updateMask:(i=e.Te,r=[],i.fields.forEach(function(t){return r.push(t.Ct())}),{fieldPaths:r})};else{if(!(e instanceof du))return kr();n={verify:ua(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ps)return{fieldPath:t.field.Ct(),setToServerValue:"REQUEST_TIME"};if(e instanceof Rs)return{fieldPath:t.field.Ct(),appendMissingElements:{values:e.elements}};if(e instanceof Ms)return{fieldPath:t.field.Ct(),removeAllFromArray:{values:e.elements}};if(e instanceof Bs)return{fieldPath:t.field.Ct(),increment:e._e};throw kr()})),e.Ee.we||(n.currentDocument=void 0!==(i=e.Ee).updateTime?{updateTime:(e=t,t=i.updateTime,na(e,t.Tt()))}:void 0!==i.exists?{exists:i.exists}:kr()),n}function va(e,t){var n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Qs.updateTime(ia(s.updateTime)):void 0!==s.exists?Qs.exists(s.exists):Qs.de():Qs.de(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Pr("REQUEST_TIME"===e.setToServerValue),r=new Ps):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new Rs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Ms(n)):"increment"in e?r=new Bs(t,e.increment):kr();e=Ri.Mt(e.fieldPath);return new Ws(e,r)}(e,t)}):[];if(t.update){t.update.name;var i=aa(e,t.update.name),o=new po({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Wi(s.map(function(t){return Ri.Mt(t)})));return new ru(i,o,s,n,r)}return new nu(i,o,n,r)}if(t.delete){r=aa(e,t.delete);return new pu(r,n)}if(t.verify){t=aa(e,t.verify);return new du(t,n)}return kr()}function ga(t,e){return{documents:[ca(t,e.path)]}}function ma(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ca(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ca(t,r.yt()),n.structuredQuery.from=[{collectionId:r.Vt()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(fo(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NAN"}};if(ho(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(fo(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NAN"}};if(ho(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ea(t.field),op:(e=t.op,ta[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ea((t=t).field),direction:(t=t.dir,Zu[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.he||vi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ba(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ba(e.endAt)),n}function wa(t){var e=ha(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Ta(t)]:void 0!==t.fieldFilter?[(n=t,Ro.create(_a(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new os(_a((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=vi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Ia(n.startAt));var u=null;return n.endAt&&(u=Ia(n.endAt)),cs(e,i,t,o,r,"F",s,u)}function ba(t){return{before:t.before,values:t.position}}function Ia(t){var e=!!t.before,t=t.values||[];return new Zo(t,e)}function Ea(t){return{fieldPath:t.Ct()}}function _a(t){return Ri.Mt(t.fieldPath)}function Ta(t){switch(t.unaryFilter.op){case"IS_NAN":var e=_a(t.unaryFilter.field);return Ro.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=_a(t.unaryFilter.field);return Ro.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=_a(t.unaryFilter.field);return Ro.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=_a(t.unaryFilter.field);return Ro.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}function Aa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Na(t){return new ea(t,!0)}var Sa,Oa=(Va.prototype.catch=function(t){return this.next(void 0,t)},Va.prototype.next=function(r,i){var o=this;return this.ss&&kr(),this.ss=!0,this.ns?this.error?this.rs(i,this.error):this.os(r,this.result):new Va(function(e,n){o.ts=function(t){o.os(r,t).next(e,n)},o.es=function(t){o.rs(i,t).next(e,n)}})},Va.prototype.cs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Va.prototype.us=function(t){try{var e=t();return e instanceof Va?e:Va.resolve(e)}catch(t){return Va.reject(t)}},Va.prototype.os=function(t,e){return t?this.us(function(){return t(e)}):Va.resolve(e)},Va.prototype.rs=function(t,e){return t?this.us(function(){return t(e)}):Va.reject(e)},Va.resolve=function(n){return new Va(function(t,e){t(n)})},Va.reject=function(n){return new Va(function(t,e){e(n)})},Va.hs=function(t){return new Va(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Va.ls=function(t){for(var n=Va.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Va.resolve(t):e()})}(r[e]);return n},Va.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.hs(i)},Va),Da=(Ua.open=function(t,e,n,r){try{return new Ua(e,t.transaction(r,n))}catch(t){throw new Pa(e,t)}},Object.defineProperty(Ua.prototype,"fs",{get:function(){return this._s.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this._s.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){t=this.transaction.objectStore(t);return new ja(t)},Ua),xa=(Ca.delete=function(t){return Sr("SimpleDb","Removing database:",t),qa(window.indexedDB.deleteDatabase(t)).cs()},Ca.G=function(){if("undefined"==typeof indexedDB)return!1;if(Ca.Es())return!0;var t=p(),e=Ca.ws(t),n=0<e&&e<10,e=Ca.Ts(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Ca.Es=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Is)},Ca.As=function(t,e){return t.store(e)},Ca.ws=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Ca.Ts=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Ca.prototype.Rs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Pa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Br(qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Pa(o,t))},r.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.ds.Ps(e,r.transaction,t.oldVersion,i.version).next(function(){Sr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.ys&&(this.db.onversionchange=function(t){return i.ys(t)}),this.db)]}})})},Ca.prototype.gs=function(e){this.ys=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Ca.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Rs(u)];case 2:return s.db=t.sent(),e=Da.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Oa.reject(t)}).cs(),r={},n.catch(function(){}),[4,e.fs];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Sr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Ca.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Ca),ka=(Object.defineProperty(La.prototype,"ns",{get:function(){return this.ps},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"vs",{get:function(){return this.bs},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"cursor",{set:function(t){this.Vs=t},enumerable:!1,configurable:!0}),La.prototype.done=function(){this.ps=!0},La.prototype.Ss=function(t){this.bs=t},La.prototype.delete=function(){return qa(this.Vs.delete())},La),Pa=(h(Ra,Sa=Br),Ra);function Ra(t,e){var n=this;return(n=Sa.call(this,qr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function La(t){this.Vs=t,this.ps=!1,this.bs=null}function Ca(t,e,n){this.name=t,this.version=e,this.ds=n,12.2===Ca.ws(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ua(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this._s=new Si,this.transaction.oncomplete=function(){n._s.resolve()},this.transaction.onabort=function(){t.error?n._s.reject(new Pa(e,t.error)):n._s.resolve()},this.transaction.onerror=function(t){t=Ga(t.target.error);n._s.reject(new Pa(e,t))}}function Va(t){var e=this;this.ts=null,this.es=null,this.result=void 0,this.error=void 0,this.ns=!1,this.ss=!1,t(function(t){e.ns=!0,e.result=t,e.ts&&e.ts(t)},function(t){e.ns=!0,e.error=t,e.es&&e.es(t)})}function Ma(t){return"IndexedDbTransactionError"===t.name}var ja=(Fa.prototype.put=function(t,e){t=void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return qa(t)},Fa.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),qa(this.store.add(t))},Fa.prototype.get=function(e){var n=this;return qa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},Fa.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),qa(this.store.delete(t))},Fa.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),qa(this.store.count())},Fa.prototype.Ds=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Cs(e,function(t,e){n.push(e)}).next(function(){return n})},Fa.prototype.xs=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.Ns=!1;e=this.cursor(e);return this.Cs(e,function(t,e,n){return n.delete()})},Fa.prototype.Fs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Cs(n,e)},Fa.prototype.Os=function(r){var t=this.cursor({});return new Oa(function(n,e){t.onerror=function(t){t=Ga(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Fa.prototype.Cs=function(t,i){var o=[];return new Oa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new ka(n),(t=i(n.primaryKey,n.value,e))instanceof Oa&&(t=t.catch(function(t){return e.done(),Oa.reject(t)}),o.push(t)),e.ns?r():null===e.vs?n.continue():n.continue(e.vs)):r()}}).next(function(){return Oa.hs(o)})},Fa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Fa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Fa);function Fa(t){this.store=t}function qa(t){return new Oa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ga(t.target.error);n(t)}})}var Ba=!1;function Ga(t){var e=xa.ws(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Br("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ba||(Ba=!0,setTimeout(function(){throw n},0)),n}}return t}var za=(Ha.qs=function(t,e,n,r,i){i=new Ha(t,e,Date.now()+n,r,i);return i.start(n),i},Ha.prototype.start=function(t){var e=this;this.Us=setTimeout(function(){return e.Qs()},t)},Ha.prototype.Ks=function(){return this.Qs()},Ha.prototype.cancel=function(t){null!==this.Us&&(this.clearTimeout(),this.Bs.reject(new Br(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ha.prototype.Qs=function(){var e=this;this.ks.Ws(function(){return null!==e.Us?(e.clearTimeout(),e.op().then(function(t){return e.Bs.resolve(t)})):Promise.resolve()})},Ha.prototype.clearTimeout=function(){null!==this.Us&&(this.Ls(this),clearTimeout(this.Us),this.Us=null)},Ha);function Ha(t,e,n,r,i){this.ks=t,this.Ms=e,this.$s=n,this.op=r,this.Ls=i,this.Bs=new Si,this.then=this.Bs.promise.then.bind(this.Bs.promise),this.Bs.promise.catch(function(t){})}function Ka(t,e){if(Or("AsyncQueue",e+": "+t),Ma(t))return new Br(qr.UNAVAILABLE,e+": "+t);throw t}var Wa,Qa,Ya,Ja=(cc.prototype.reset=function(){this.Js=0},cc.prototype.Zs=function(){this.Js=this.Hs},cc.prototype.ti=function(t){var e=this;this.cancel();var n=Math.floor(this.Js+this.ei()),r=Math.max(0,Date.now()-this.Xs),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Js+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ys=this.js.ni(this.Ms,i,function(){return e.Xs=Date.now(),t()}),this.Js*=this.zs,this.Js<this.Gs&&(this.Js=this.Gs),this.Js>this.Hs&&(this.Js=this.Hs)},cc.prototype.si=function(){null!==this.Ys&&(this.Ys.Ks(),this.Ys=null)},cc.prototype.cancel=function(){null!==this.Ys&&(this.Ys.cancel(),this.Ys=null)},cc.prototype.ei=function(){return(Math.random()-.5)*this.Js},cc),o=(ac.prototype.hi=function(){return 1===this.state||2===this.state||4===this.state},ac.prototype.li=function(){return 2===this.state},ac.prototype.start=function(){3!==this.state?this.auth():this._i()},ac.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hi()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ac.prototype.fi=function(){this.state=0,this.ui.reset()},ac.prototype.di=function(){var t=this;this.li()&&null===this.ai&&(this.ai=this.js.ni(this.ii,6e4,function(){return t.wi()}))},ac.prototype.Ei=function(t){this.Ti(),this.stream.send(t)},ac.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.li()?[2,this.close(0)]:[2]})})},ac.prototype.Ti=function(){this.ai&&(this.ai.cancel(),this.ai=null)},ac.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti(),this.ui.cancel(),this.ci++,3!==e?this.ui.reset():n&&n.code===qr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.ui.Zs()):n&&n.code===qr.UNAUTHENTICATED&&this.oi.g(),null!==this.stream&&(this.Ii(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Z(n)];case 1:return t.sent(),[2]}})})},ac.prototype.Ii=function(){},ac.prototype.auth=function(){var n=this;this.state=1;var t=this.mi(this.ci),e=this.ci;this.oi.getToken().then(function(t){n.ci===e&&n.Ai(t)},function(e){t(function(){var t=new Br(qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ri(t)})})},ac.prototype.Ai=function(t){var e=this,n=this.mi(this.ci);this.stream=this.Pi(t),this.stream.Y(function(){n(function(){return e.state=2,e.listener.Y()})}),this.stream.Z(function(t){n(function(){return e.Ri(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ac.prototype._i=function(){var t=this;this.state=4,this.ui.ti(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ac.prototype.Ri=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ac.prototype.mi=function(e){var n=this;return function(t){n.js.Ws(function(){return n.ci===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ac),Xa=(h(uc,Ya=o),uc.prototype.Pi=function(t){return this.ri.ft("Listen",t)},uc.prototype.onMessage=function(t){this.ui.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:kr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.he?(Pr(void 0===s||"string"==typeof s),Mr.fromBase64String(s||"")):(Pr(void 0===s||s instanceof Uint8Array),Mr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?qr.UNKNOWN:Ei(c.code),new Br(a,c.message||"")),s=new qu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=aa(t,n.document.name),i=ia(n.document.updateTime);var u=new po({mapValue:{fields:n.document.fields}}),a=(o=new Io(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new ju(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=aa(t,n.document),i=n.readTime?ia(n.readTime):xi.min(),u=new Eo(r,i),o=n.removedTargetIds||[],s=new ju([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=aa(t,n.document),i=n.removedTargetIds||[],s=new ju([],i,r,null);else{if(!("filter"in e))return kr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new hu(n),i=e.targetId,s=new Fu(i,r)}return s}(this.fe,t),t=function(t){if(!("targetChange"in t))return xi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?ia(t.readTime):xi.min()}(t);return this.listener.yi(e,t)},uc.prototype.gi=function(t){var e,n,r,i={};i.database=fa(this.fe),i.addTarget=(e=this.fe,(r=ko(r=(n=t).target)?{documents:ga(e,r)}:{query:ma(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=ra(e,n.resumeToken):0<n.oe.u(xi.min())&&(r.readTime=na(e,n.oe.Tt())),r);var o,t=(this.fe,o=t,null==(t=function(){switch(o.re){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Ei(i)},uc.prototype.Vi=function(t){var e={};e.database=fa(this.fe),e.removeTarget=t,this.Ei(e)},uc),$a=(h(sc,Qa=o),Object.defineProperty(sc.prototype,"bi",{get:function(){return this.pi},enumerable:!1,configurable:!0}),sc.prototype.start=function(){this.pi=!1,this.lastStreamToken=void 0,Qa.prototype.start.call(this)},sc.prototype.Ii=function(){this.pi&&this.vi([])},sc.prototype.Pi=function(t){return this.ri.ft("Write",t)},sc.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pi){this.ui.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?ia(t.updateTime):ia(e);n.isEqual(xi.min())&&(n=ia(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ks(n,e)}(t,r)})):[]),n=ia(t.commitTime);return this.listener.Si(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.pi=!0,this.listener.Di()},sc.prototype.Ci=function(){var t={};t.database=fa(this.fe),this.Ei(t)},sc.prototype.vi=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ya(e.fe,t)})};this.Ei(t)},sc),Za=(h(oc,Wa=function(){}),oc.prototype.Ni=function(){if(this.xi)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},oc.prototype.at=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri.at(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.g(),t})},oc.prototype._t=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri._t(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.g(),t})},oc.prototype.terminate=function(){this.xi=!1},oc),tc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_e=(ic.prototype.Oi=function(t){this.Fi.push(t)},ic.prototype.ki=function(){this.Fi.forEach(function(t){return t()})},ic),ec={Mi:!1,$i:0,Li:0,Bi:0},nc=(rc.Ki=function(t){return new rc(t,rc.Wi,rc.ji)},rc);function rc(t,e,n){this.qi=t,this.Ui=e,this.Qi=n}function ic(){this.Fi=[]}function oc(t,e,n){var r=this;return(r=Wa.call(this)||this).credentials=t,r.ri=e,r.fe=n,r.xi=!1,r}function sc(t,e,n,r,i){var o=this;return(o=Qa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).fe=r,o.pi=!1,o}function uc(t,e,n,r,i){var o=this;return(o=Ya.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).fe=r,o}function ac(t,e,n,r,i,o){this.js=t,this.ii=n,this.ri=r,this.oi=i,this.listener=o,this.state=0,this.ci=0,this.ai=null,this.stream=null,this.ui=new Ja(t,e)}function cc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.js=t,this.Ms=e,this.Gs=n,this.zs=r,this.Hs=i,this.Js=0,this.Ys=null,this.Xs=Date.now(),this.reset()}nc.Wi=10,nc.ji=1e3,nc.Gi=new nc(41943040,nc.Wi,nc.ji),nc.zi=new nc(-1,0,0);var hc=(fc.prototype.Ji=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},fc.prototype.next=function(){var t=++this.previousValue;return this.Yi&&this.Yi(t),t},fc);function fc(t,e){var n=this;this.previousValue=t,e&&(e.Hi=function(t){return n.Ji(t)},this.Yi=function(t){return e.Xi(t)})}function lc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==qr.FAILED_PRECONDITION||e.message!==tc)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}hc.Zi=-1;function pc(t,e){this.progress=t,this.tr=e}var dc=(bc.prototype.nr=function(t,e,n){for(var r,i,o,s,u,a,c=n.sr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof nu?(u=o,f=(s=r).value,u.transformResults&&(a=uu(s.fieldTransforms,i,u.transformResults),f=cu(s.fieldTransforms,f,a)),new Io(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof ru?function(t,e,n){if(!Js(t.Ee,e))return new _o(t.key,n.version);e=su(t,e,n.transformResults?uu(t.fieldTransforms,e,n.transformResults):[]);return new Io(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new Eo(r.key,o.version,{hasCommittedMutations:!0}))}return e},bc.prototype.ir=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Xs(i,e,e,this.er))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Xs(a,e,o,this.er))}return e},bc.prototype.rr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ir(t.key,n.get(t.key));e&&(i=i.Ie(t.key,e))}),i},bc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Pu())},bc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ur(this.mutations,t.mutations,$s)&&Ur(this.baseMutations,t.baseMutations,$s)},bc),yc=(wc.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=xu,i=t.mutations,o=0;o<i.length;o++)r=r.Ie(i[o].key,n[o].version);return new wc(t,e,n,r)},wc),vc=(mc.prototype.get=function(t){var e=this.ur(t),e=this.lr[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.hr(o,t))return i}},mc.prototype.has=function(t){return void 0!==this.get(t)},mc.prototype.set=function(t,e){var n=this.ur(t),r=this.lr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.hr(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.lr[n]=[[t,e]]},mc.prototype.delete=function(t){var e=this.ur(t),n=this.lr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.hr(n[r][0],t))return 1===n.length?delete this.lr[e]:n.splice(r,1),!0;return!1},mc.prototype.forEach=function(s){Hi(this.lr,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},mc.prototype.bt=function(){return Ki(this.lr)},mc),o=(gc.prototype.wr=function(t){t=this._r.get(t);return t?t.readTime:xi.min()},gc.prototype.Er=function(t,e){this.Tr(),this._r.set(t.key,{Ir:t,readTime:e})},gc.prototype.mr=function(t,e){void 0===e&&(e=null),this.Tr(),this._r.set(t,{Ir:null,readTime:e})},gc.prototype.Ar=function(t,e){this.Tr();var n=this._r.get(e);return void 0!==n?Oa.resolve(n.Ir):this.Rr(t,e)},gc.prototype.getEntries=function(t,e){return this.Pr(t,e)},gc.prototype.apply=function(t){return this.Tr(),this.dr=!0,this.yr(t)},gc.prototype.Tr=function(){},gc);function gc(){this._r=new vc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dr=!1}function mc(t,e){this.ur=t,this.hr=e,this.lr={}}function wc(t,e,n,r){this.batch=t,this.cr=e,this.sr=n,this.ar=r}function bc(t,e,n,r){this.batchId=t,this.er=e,this.baseMutations=n,this.mutations=r}function Ic(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Cr(n,t);return 0===t?Cr(r,e):t}var Ec=(Sc.prototype.pr=function(){return++this.Vr},Sc.prototype.br=function(t){var e=[t,this.pr()];this.buffer.size<this.gr?this.buffer=this.buffer.add(e):Ic(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Sc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Sc),_c=(Nc.prototype.start=function(t){-1!==this.vr.params.qi&&this.Cr(t)},Nc.prototype.stop=function(){this.Dr&&(this.Dr.cancel(),this.Dr=null)},Object.defineProperty(Nc.prototype,"Nr",{get:function(){return null!==this.Dr},enumerable:!1,configurable:!0}),Nc.prototype.Cr=function(n){var t=this,e=this.Sr?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Dr=this.ks.ni("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Dr=null,this.Sr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Fr(this.vr)];case 2:return t.sent(),[3,7];case 3:return Ma(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,lc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Cr(n)];case 8:return t.sent(),[2]}})})})},Nc),Tc=(Ac.prototype.kr=function(t,e){return this.Or.Mr(t).next(function(t){return Math.floor(e/100*t)})},Ac.prototype.$r=function(t,e){var n=this;if(0===e)return Oa.resolve(hc.Zi);var r=new Ec(e);return this.Or.Un(t,function(t){return r.br(t.sequenceNumber)}).next(function(){return n.Or.Lr(t,function(t){return r.br(t)})}).next(function(){return r.maxValue})},Ac.prototype.Br=function(t,e,n){return this.Or.Br(t,e,n)},Ac.prototype.qr=function(t,e){return this.Or.qr(t,e)},Ac.prototype.Ur=function(e,n){var r=this;return-1===this.params.qi?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),Oa.resolve(ec)):this.Qr(e).next(function(t){return t<r.params.qi?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.qi),ec):r.Kr(e,n)})},Ac.prototype.Qr=function(t){return this.Or.Qr(t)},Ac.prototype.Kr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.kr(e,this.params.Ui).next(function(t){return i=t>h.params.Qi?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Qi+" from "+t),h.params.Qi):t,s=Date.now(),h.$r(e,i)}).next(function(t){return r=t,u=Date.now(),h.Br(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.qr(e,r)}).next(function(t){return c=Date.now(),Nr()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Oa.resolve({Mi:!0,$i:i,Li:o,Bi:t})})},Ac);function Ac(t,e){this.Or=t,this.params=e}function Nc(t,e){this.vr=t,this.ks=e,this.Sr=!1,this.Dr=null}function Sc(t){this.gr=t,this.buffer=new Tu(Ic),this.Vr=0}function Oc(t,e,n){if(!n)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Dc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function xc(t,e,n,r){if(!0===e&&!0===r)throw new Br(qr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function kc(t){if(!Li.qt(t))throw new Br(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Pc(t){if(Li.qt(t))throw new Br(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Rc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Lc(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Br(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Rc(t);throw new Br(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Cc(t,e){if(e<=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uc=(Fc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fc),Vc=new Map,Mc=(Object.defineProperty(jc.prototype,"app",{get:function(){if(!this.Jr)throw new Br(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(jc.prototype,"Yr",{get:function(){return this.Gr},enumerable:!1,configurable:!0}),Object.defineProperty(jc.prototype,"Xr",{get:function(){return void 0!==this.Zr},enumerable:!1,configurable:!0}),jc.prototype.eo=function(t){if(this.Gr)throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.jr=new Uc(t),void 0!==t.credentials&&(this.Hr=function(t){if(!t)return new ei;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ii(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Br(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},jc.prototype.no=function(){return this.jr},jc.prototype.so=function(){return this.Gr=!0,this.jr},jc.prototype._delete=function(){return this.Zr||(this.Zr=this.io()),this.Zr},jc.prototype.io=function(){return(t=Vc.get(this))&&(Sr("ComponentProvider","Removing Datastore"),Vc.delete(this),t.terminate()),Promise.resolve();var t},jc);function jc(t,e){this.Wr="(lite)",this.jr=new Uc({}),this.Gr=!1,t instanceof si?(this.zr=t,this.Hr=new ei):(this.Jr=t,this.zr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Br(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new si(t.options.projectId)}(t),this.Hr=new ni(e))}function Fc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Br(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,xc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function qc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Bc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Bc(e)}function Bc(t){return t+"\x01\x01"}function Gc(t){var e=t.length;if(Pr(2<=e),2===e)return Pr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ki.Nt();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&kr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:kr()}o=s+2}return new ki(r)}function zc(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Hc=function(t,e){this.seconds=t,this.nanoseconds=e};zc.store="owner",zc.key="owner";function Kc(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}Kc.store="mutationQueues",Kc.keyPath="userId";function Wc(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Wc.store="mutations",Wc.keyPath="batchId",Wc.userMutationsIndex="userMutationsIndex",Wc.userMutationsKeyPath=["userId","batchId"];var Qc=(Yc.prefixForUser=function(t){return[t]},Yc.prefixForPath=function(t,e){return[t,qc(e)]},Yc.key=function(t,e,n){return[t,qc(e),n]},Yc);function Yc(){}Qc.store="documentMutations",Qc.PLACEHOLDER=new Qc;function Jc(t,e){this.path=t,this.readTime=e}function Xc(t,e){this.path=t,this.version=e}var $c=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$c.store="remoteDocuments",$c.readTimeIndex="readTimeIndex",$c.readTimeIndexPath="readTime",$c.collectionReadTimeIndex="collectionReadTimeIndex",$c.collectionReadTimeIndexPath=["parentPath","readTime"];function Zc(t){this.byteSize=t}Zc.store="remoteDocumentGlobal",Zc.key="remoteDocumentGlobalKey";function th(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}th.store="targets",th.keyPath="targetId",th.queryTargetsIndexName="queryTargetsIndex",th.queryTargetsKeyPath=["canonicalId","targetId"];var eh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};eh.store="targetDocuments",eh.keyPath=["targetId","path"],eh.documentTargetsIndex="documentTargetsIndex",eh.documentTargetsKeyPath=["path","targetId"];function nh(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}nh.key="targetGlobalKey",nh.store="targetGlobal";function rh(t,e){this.collectionId=t,this.parent=e}rh.store="collectionParents",rh.keyPath=["collectionId","parent"];function ih(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}ih.store="clientMetadata",ih.keyPath="clientId";function oh(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}oh.store="bundles",oh.keyPath="bundleId";function sh(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}sh.store="namedQueries",sh.keyPath="name";var uh,ah=f(f(f(f([Kc.store,Wc.store,Qc.store,$c.store,th.store,zc.store,nh.store,eh.store],[ih.store]),[Zc.store]),[rh.store]),[oh.store,sh.store]),ch=(h(hh,uh=_e),hh);function hh(t,e){var n=this;return(n=uh.call(this)||this).ro=t,n.oo=e,n}function fh(t,e){return xa.As(t.ro,e)}var lh=function(t){this.co=t};function ph(t,e){if(e.document)return da(t.co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Li.Ut(e.noDocument.path),r=mh(e.noDocument.readTime);return new Eo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=Li.Ut(e.unknownDocument.path),r=mh(e.unknownDocument.version);return new _o(n,r)}return kr()}function dh(t,e,n){var r=yh(n),n=e.key.path.yt().Dt();if(e instanceof Io){var i={name:ua(o=t.co,(s=e).key),fields:s.Yt().mapValue.fields,updateTime:na(o,s.version.Tt())},o=e.hasCommittedMutations;return new $c(null,null,i,o,r,n)}if(e instanceof Eo){var s=e.key.path.Dt(),i=gh(e.version),o=e.hasCommittedMutations;return new $c(null,new Jc(s,i),null,o,r,n)}if(e instanceof _o){o=e.key.path.Dt(),e=gh(e.version);return new $c(new Xc(o,e),null,null,!0,r,n)}return kr()}function yh(t){t=t.Tt();return[t.seconds,t.nanoseconds]}function vh(t){t=new Di(t[0],t[1]);return xi.wt(t)}function gh(t){t=t.Tt();return new Hc(t.seconds,t.nanoseconds)}function mh(t){t=new Di(t.seconds,t.nanoseconds);return xi.wt(t)}function wh(e,t){for(var n=(t.baseMutations||[]).map(function(t){return va(e.co,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return va(e.co,t)}),s=Di.fromMillis(t.localWriteTimeMs);return new dc(t.batchId,s,n,o)}function bh(t){var e=mh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?mh(t.lastLimboFreeSnapshotVersion):xi.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),gs(hs(ha(r.documents[0])))):gs(wa(t.query));return new Ts(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Mr.fromBase64String(t.resumeToken))}function Ih(t,e){var n=gh(e.oe),r=gh(e.lastLimboFreeSnapshotVersion),i=(ko(e.target)?ga:ma)(t.co,e.target),t=e.resumeToken.toBase64();return new th(e.targetId,Do(e.target),n,t,e.sequenceNumber,r,i)}function Eh(t){var e=wa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ms(e,e.limit,"L"):e}var _h=(Th.prototype.ao=function(t,e){return Ah(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:mh(t.createTime),version:t.version}})},Th.prototype.uo=function(t,e){return Ah(t).put({bundleId:(e=e).id,createTime:gh(ia(e.createTime)),version:e.version})},Th.prototype.ho=function(t,e){return Nh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Eh(t.bundledQuery),readTime:mh(t.readTime)}})},Th.prototype.lo=function(t,e){return Nh(t).put({name:(e=e).name,readTime:gh(ia(e.readTime)),bundledQuery:e.bundledQuery})},Th);function Th(){}function Ah(t){return fh(t,oh.store)}function Nh(t){return fh(t,sh.store)}var Sh=(Ph.prototype.fo=function(t,e){return this._o.add(e),Oa.resolve()},Ph.prototype.wo=function(t,e){return Oa.resolve(this._o.getEntries(e))},Ph),Oh=(kh.prototype.add=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e]||new Tu(ki.At),t=!r.has(n);return this.index[e]=r.add(n),t},kh.prototype.has=function(t){var e=t.Vt(),t=t.yt(),e=this.index[e];return e&&e.has(t)},kh.prototype.getEntries=function(t){return(this.index[t]||new Tu(ki.At)).Dt()},kh),Dh=(xh.prototype.fo=function(t,e){var n=this;if(this.Eo.has(e))return Oa.resolve();var r=e.Vt(),i=e.yt();t.Oi(function(){n.Eo.add(e)});i={collectionId:r,parent:qc(i)};return Rh(t).put(i)},xh.prototype.wo=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Vr(i),""],!1,!0);return Rh(t).Ds(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Gc(r.parent))}return o})},xh);function xh(){this.Eo=new Oh}function kh(){this.index={}}function Ph(){this._o=new Oh}function Rh(t){return fh(t,rh.store)}function Lh(t,e,n){var r=t.store(Wc.store),i=t.store(Qc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.Fs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Pr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Qc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return Oa.hs(o).next(function(){return u})}function Ch(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}var Uh=(Vh.Ao=function(t,e,n,r){return Pr(""!==t.uid),new Vh(t.T()?t.uid:"",e,n,r)},Vh.prototype.Ro=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jh(t).Fs({index:Wc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Vh.prototype.Po=function(d,y,v,g){var m=this,w=Fh(d),b=jh(d);return b.add({}).next(function(t){Pr("number"==typeof t);for(var e,n,r,i,o,s=new dc(t,y,v,g),u=(e=m.fe,n=m.userId,i=(r=s).baseMutations.map(function(t){return ya(e.co,t)}),o=r.mutations.map(function(t){return ya(e.co,t)}),new Wc(n,r.batchId,r.er.toMillis(),i,o)),a=[],c=new Tu(function(t,e){return Cr(t.Ct(),e.Ct())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Qc.key(m.userId,l.key.path,t),c=c.add(l.key.path.yt());a.push(b.put(u)),a.push(w.put(p,Qc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.To.fo(d,t))}),d.Oi(function(){m.mo[t]=s.keys()}),Oa.hs(a).next(function(){return s})})},Vh.prototype.yo=function(t,e){var n=this;return jh(t).get(e).next(function(t){return t?(Pr(t.userId===n.userId),wh(n.fe,t)):null})},Vh.prototype.Vo=function(t,e){var n=this;return this.mo[e]?Oa.resolve(this.mo[e]):this.yo(t,e).next(function(t){if(t){t=t.keys();return n.mo[e]=t}return null})},Vh.prototype.po=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return jh(t).Fs({index:Wc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Pr(e.batchId>=i),o=wh(r.fe,e)),n.done()}).next(function(){return o})},Vh.prototype.bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return jh(t).Fs({index:Wc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Vh.prototype.vo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jh(t).Ds(Wc.userMutationsIndex,n).next(function(t){return t.map(function(t){return wh(e.fe,t)})})},Vh.prototype.So=function(o,s){var u=this,t=Qc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Fh(o).Fs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Gc(i);if(r===u.userId&&s.path.isEqual(i))return jh(o).get(t).next(function(t){if(!t)throw kr();Pr(t.userId===u.userId),a.push(wh(u.fe,t))});n.done()}).next(function(){return a})},Vh.prototype.Do=function(e,t){var s=this,u=new Tu(Cr),n=[];return t.forEach(function(o){var t=Qc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Fh(e).Fs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Gc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Oa.hs(n).next(function(){return s.Co(e,u)})},Vh.prototype.xo=function(t,e){var o=this,s=e.path,u=s.length+1,e=Qc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Tu(Cr);return Fh(t).Fs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Gc(i);r===o.userId&&s.vt(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Co(t,a)})},Vh.prototype.Co=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(jh(e).get(t).next(function(t){if(null===t)throw kr();Pr(t.userId===n.userId),r.push(wh(n.fe,t))}))}),Oa.hs(i).next(function(){return r})},Vh.prototype.No=function(e,n){var r=this;return Lh(e.ro,this.userId,n).next(function(t){return e.Oi(function(){r.Fo(n.batchId)}),Oa.forEach(t,function(t){return r.Io.Oo(e,t)})})},Vh.prototype.Fo=function(t){delete this.mo[t]},Vh.prototype.ko=function(e){var i=this;return this.Ro(e).next(function(t){if(!t)return Oa.resolve();var t=IDBKeyRange.lowerBound(Qc.prefixForUser(i.userId)),r=[];return Fh(e).Fs({range:t},function(t,e,n){t[0]===i.userId?(t=Gc(t[1]),r.push(t)):n.done()}).next(function(){Pr(0===r.length)})})},Vh.prototype.Mo=function(t,e){return Mh(t,this.userId,e)},Vh.prototype.$o=function(t){var e=this;return qh(t).get(this.userId).next(function(t){return t||new Kc(e.userId,-1,"")})},Vh);function Vh(t,e,n,r){this.userId=t,this.fe=e,this.To=n,this.Io=r,this.mo={}}function Mh(t,o,e){var e=Qc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Fh(t).Fs({range:e,Ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function jh(t){return fh(t,Wc.store)}function Fh(t){return fh(t,Qc.store)}function qh(t){return fh(t,Kc.store)}var Bh=(Hh.prototype.next=function(){return this.Lo+=2,this.Lo},Hh.Bo=function(){return new Hh(0)},Hh.qo=function(){return new Hh(-1)},Hh),Gh=(zh.prototype.Uo=function(n){var r=this;return this.Qo(n).next(function(t){var e=new Bh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ko(n,t).next(function(){return t.highestTargetId})})},zh.prototype.Wo=function(t){return this.Qo(t).next(function(t){return xi.wt(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},zh.prototype.jo=function(t){return this.Qo(t).next(function(t){return t.highestListenSequenceNumber})},zh.prototype.Go=function(e,n,r){var i=this;return this.Qo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.Tt()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ko(e,t)})},zh.prototype.zo=function(e,n){var r=this;return this.Ho(e,n).next(function(){return r.Qo(e).next(function(t){return t.targetCount+=1,r.Jo(n,t),r.Ko(e,t)})})},zh.prototype.Yo=function(t,e){return this.Ho(t,e)},zh.prototype.Xo=function(e,t){var n=this;return this.Zo(e,t.targetId).next(function(){return Kh(e).delete(t.targetId)}).next(function(){return n.Qo(e)}).next(function(t){return Pr(0<t.targetCount),--t.targetCount,n.Ko(e,t)})},zh.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return Kh(n).Fs(function(t,e){e=bh(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Xo(n,e)))}).next(function(){return Oa.hs(u)}).next(function(){return s})},zh.prototype.Un=function(t,n){return Kh(t).Fs(function(t,e){e=bh(e);n(e)})},zh.prototype.Qo=function(t){return Wh(t).get(nh.key).next(function(t){return Pr(null!==t),t})},zh.prototype.Ko=function(t,e){return Wh(t).put(nh.key,e)},zh.prototype.Ho=function(t,e){return Kh(t).put(Ih(this.fe,e))},zh.prototype.Jo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},zh.prototype.tc=function(t){return this.Qo(t).next(function(t){return t.targetCount})},zh.prototype.ec=function(t,r){var e=Do(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Kh(t).Fs({range:e,index:th.queryTargetsIndexName},function(t,e,n){e=bh(e);xo(r,e.target)&&(i=e,n.done())}).next(function(){return i})},zh.prototype.nc=function(n,t,r){var i=this,o=[],s=Qh(n);return t.forEach(function(t){var e=qc(t.path);o.push(s.put(new eh(r,e))),o.push(i.Io.sc(n,r,t))}),Oa.hs(o)},zh.prototype.ic=function(n,t,r){var i=this,o=Qh(n);return Oa.forEach(t,function(t){var e=qc(t.path);return Oa.hs([o.delete([r,e]),i.Io.rc(n,r,t)])})},zh.prototype.Zo=function(t,e){t=Qh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},zh.prototype.oc=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Qh(t),r=Pu();return t.Fs({range:e,Ns:!0},function(t,e,n){t=Gc(t[1]),t=new Li(t);r=r.add(t)}).next(function(){return r})},zh.prototype.Mo=function(t,e){var e=qc(e.path),e=IDBKeyRange.bound([e],[Vr(e)],!1,!0),i=0;return Qh(t).Fs({index:eh.documentTargetsIndex,Ns:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},zh.prototype.Zn=function(t,e){return Kh(t).get(e).next(function(t){return t?bh(t):null})},zh);function zh(t,e){this.Io=t,this.fe=e}function Hh(t){this.Lo=t}function Kh(t){return fh(t,th.store)}function Wh(t){return fh(t,nh.store)}function Qh(t){return fh(t,eh.store)}var Yh=(Jh.prototype.Mr=function(t){var n=this.cc(t);return this.db.ac().tc(t).next(function(e){return n.next(function(t){return e+t})})},Jh.prototype.cc=function(t){var e=0;return this.Lr(t,function(t){e++}).next(function(){return e})},Jh.prototype.Un=function(t,e){return this.db.ac().Un(t,e)},Jh.prototype.Lr=function(t,n){return this.uc(t,function(t,e){return n(e)})},Jh.prototype.sc=function(t,e,n){return Xh(t,n)},Jh.prototype.rc=function(t,e,n){return Xh(t,n)},Jh.prototype.Br=function(t,e,n){return this.db.ac().Br(t,e,n)},Jh.prototype.Oo=Xh,Jh.prototype.hc=function(t,e){return r=e,i=!1,qh(n=t).Os(function(t){return Mh(n,t,r).next(function(t){return t&&(i=!0),Oa.resolve(!t)})}).next(function(){return i});var n,r,i},Jh.prototype.qr=function(n,r){var i=this,o=this.db._c().lc(),s=[],u=0;return this.uc(n,function(e,t){t<=r&&(t=i.hc(n,e).next(function(t){if(!t)return u++,o.Ar(n,e).next(function(){return o.mr(e),Qh(n).delete([0,qc(e.path)])})}),s.push(t))}).next(function(){return Oa.hs(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Jh.prototype.removeTarget=function(t,e){e=e.ce(t.oo);return this.db.ac().Yo(t,e)},Jh.prototype.fc=Xh,Jh.prototype.uc=function(t,r){var i,t=Qh(t),o=hc.Zi;return t.Fs({index:eh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==hc.Zi&&r(new Li(Gc(i)),o),o=e,i=t):o=hc.Zi}).next(function(){o!==hc.Zi&&r(new Li(Gc(i)),o)})},Jh.prototype.Qr=function(t){return this.db._c().dc(t)},Jh);function Jh(t,e){this.db=t,this.vr=new Tc(this,e)}function Xh(t,e){return Qh(t).put((t=t.oo,new eh(0,qc(e.path),t)))}var $h,Zh=(nf.prototype.Er=function(t,e,n){return of(t).put(sf(e),n)},nf.prototype.mr=function(t,e){t=of(t),e=sf(e);return t.delete(e)},nf.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.wc(e,t)})},nf.prototype.Ar=function(t,e){var n=this;return of(t).get(sf(e)).next(function(t){return n.Ec(t)})},nf.prototype.Tc=function(t,e){var n=this;return of(t).get(sf(e)).next(function(t){var e=n.Ec(t);return e?{Ir:e,size:Ch(t)}:null})},nf.prototype.getEntries=function(t,e){var n=this,r=Nu;return this.Ic(t,e,function(t,e){e=n.Ec(e);r=r.Ie(t,e)}).next(function(){return r})},nf.prototype.mc=function(t,e){var r=this,i=Nu,o=new yu(Li.At);return this.Ic(t,e,function(t,e){var n=r.Ec(e);o=n?(i=i.Ie(t,n),o.Ie(t,Ch(e))):(i=i.Ie(t,null),o.Ie(t,0))}).next(function(){return{Ac:i,Rc:o}})},nf.prototype.Ic=function(t,e,i){if(e.bt())return Oa.resolve();var n=IDBKeyRange.bound(e.first().path.Dt(),e.last().path.Dt()),o=e.ge(),s=o.De();return of(t).Fs({range:n},function(t,e,n){for(var r=Li.Ut(t);s&&Li.At(s,r)<0;)i(s,null),s=o.De();s&&s.isEqual(r)&&(i(s,e),s=o.Ce()?o.De():null),s?n.Ss(s.path.Dt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Ce()?o.De():null})},nf.prototype.Pc=function(t,r,e){var n,i=this,o=Du,s=r.path.length+1,u={};return e.isEqual(xi.min())?(n=r.path.Dt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.Dt(),e=yh(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=$c.collectionReadTimeIndex),of(t).Fs(u,function(t,e,n){t.length===s&&(e=ph(i.fe,e),r.path.vt(e.key.path)?e instanceof Io&&Es(r,e)&&(o=o.Ie(e.key,e)):n.done())}).next(function(){return o})},nf.prototype.lc=function(t){return new tf(this,!!t&&t.yc)},nf.prototype.dc=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},nf.prototype.getMetadata=function(t){return rf(t).get(Zc.key).next(function(t){return Pr(!!t),t})},nf.prototype.wc=function(t,e){return rf(t).put(Zc.key,e)},nf.prototype.Ec=function(t){if(t){t=ph(this.fe,t);return t instanceof Eo&&t.version.isEqual(xi.min())?null:t}return null},nf),tf=(h(ef,$h=o),ef.prototype.yr=function(i){var o=this,s=[],u=0,a=new Tu(function(t,e){return Cr(t.Ct(),e.Ct())});return this._r.forEach(function(t,e){var n,r=o.Vc.get(t);e.Ir?(n=dh(o.gc.fe,e.Ir,o.wr(t)),a=a.add(t.path.yt()),e=Ch(n),u+=e-r,s.push(o.gc.Er(i,t,n))):(u-=r,o.yc?(r=dh(o.gc.fe,new Eo(t,xi.min()),o.wr(t)),s.push(o.gc.Er(i,t,r))):s.push(o.gc.mr(i,t)))}),a.forEach(function(t){s.push(o.gc.To.fo(i,t))}),s.push(this.gc.updateMetadata(i,u)),Oa.hs(s)},ef.prototype.Rr=function(t,e){var n=this;return this.gc.Tc(t,e).next(function(t){return null===t?(n.Vc.set(e,0),null):(n.Vc.set(e,t.size),t.Ir)})},ef.prototype.Pr=function(t,e){var n=this;return this.gc.mc(t,e).next(function(t){var e=t.Ac;return t.Rc.forEach(function(t,e){n.Vc.set(t,e)}),e})},ef);function ef(t,e){var n=this;return(n=$h.call(this)||this).gc=t,n.yc=e,n.Vc=new vc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function nf(t,e){this.fe=t,this.To=e}function rf(t){return fh(t,Zc.store)}function of(t){return fh(t,$c.store)}function sf(t){return t.path.Dt()}var uf=(af.prototype.Ps=function(e,n,t,r){var i=this;Pr(t<r&&0<=t&&r<=11);var o=new Da("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(zc.store),(s=e).createObjectStore(Kc.store,{keyPath:Kc.keyPath}),s.createObjectStore(Wc.store,{keyPath:Wc.keyPath,autoIncrement:!0}).createIndex(Wc.userMutationsIndex,Wc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Qc.store),cf(e),e.createObjectStore($c.store));var s,u=Oa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(eh.store),s.deleteObjectStore(th.store),s.deleteObjectStore(nh.store),cf(e)),u=u.next(function(){return t=o.store(nh.store),e=new nh(0,0,xi.min().Tt(),0),t.put(nh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Wc.store).Ds().next(function(t){n.deleteObjectStore(Wc.store),n.createObjectStore(Wc.store,{keyPath:Wc.keyPath,autoIncrement:!0}).createIndex(Wc.userMutationsIndex,Wc.userMutationsKeyPath,{unique:!0});var e=r.store(Wc.store),t=t.map(function(t){return e.put(t)});return Oa.hs(t)});var n,r})),u=u.next(function(){e.createObjectStore(ih.store,{keyPath:ih.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.bc(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Zc.store),i.vc(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Sc(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Dc(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore($c.store)).createIndex($c.readTimeIndex,$c.readTimeIndexPath,{unique:!1}),t.createIndex($c.collectionReadTimeIndex,$c.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Cc(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(oh.store,{keyPath:oh.keyPath}),e.createObjectStore(sh.store,{keyPath:sh.keyPath})})),u},af.prototype.vc=function(e){var n=0;return e.store($c.store).Fs(function(t,e){n+=Ch(e)}).next(function(){var t=new Zc(n);return e.store(Zc.store).put(Zc.key,t)})},af.prototype.bc=function(n){var r=this,t=n.store(Kc.store),i=n.store(Wc.store);return t.Ds().next(function(t){return Oa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Ds(Wc.userMutationsIndex,t).next(function(t){return Oa.forEach(t,function(t){Pr(t.userId===e.userId);t=wh(r.fe,t);return Lh(n,e.userId,t).next(function(){})})})})})},af.prototype.Sc=function(t){var o=t.store(eh.store),e=t.store($c.store);return t.store(nh.store).get(nh.key).next(function(r){var i=[];return e.Fs(function(t,e){var n=new ki(t),t=[0,qc(n)];i.push(o.get(t).next(function(t){return t?Oa.resolve():o.put(new eh(0,qc(n),r.highestListenSequenceNumber))}))}).next(function(){return Oa.hs(i)})})},af.prototype.Dc=function(t,e){t.createObjectStore(rh.store,{keyPath:rh.keyPath});function r(t){if(i.add(t)){var e=t.Vt(),t=t.yt();return n.put({collectionId:e,parent:qc(t)})}}var n=e.store(rh.store),i=new Oh;return e.store($c.store).Fs({Ns:!0},function(t,e){t=new ki(t);return r(t.yt())}).next(function(){return e.store(Qc.store).Fs({Ns:!0},function(t,e){t[0];var n=t[1],n=(t[2],Gc(n));return r(n.yt())})})},af.prototype.Cc=function(t){var n=this,r=t.store(th.store);return r.Fs(function(t,e){e=bh(e),e=Ih(n.fe,e);return r.put(e)})},af);function af(t){this.fe=t}function cf(t){t.createObjectStore(eh.store,{keyPath:eh.keyPath}).createIndex(eh.documentTargetsIndex,eh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(th.store,{keyPath:th.keyPath}).createIndex(th.queryTargetsIndexName,th.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(nh.store)}var hf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ff=(lf.prototype.start=function(){var e=this;return this.Gc().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Br(qr.FAILED_PRECONDITION,hf);return e.zc(),e.Hc(),e.Jc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Qc.jo(t)})}).then(function(t){e.Fc=new hc(t,e.xc)}).then(function(){e.Oc=!0}).catch(function(t){return e.Uc&&e.Uc.close(),Promise.reject(t)})},lf.prototype.Yc=function(n){var t=this;return this.Bc=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Nr?[2,n(e)]:[2]})})},n(this.isPrimary)},lf.prototype.Xc=function(n){var t=this;this.Uc.gs(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},lf.prototype.Zc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.js.Ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Nr?[4,this.Gc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},lf.prototype.Gc=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return df(e).put(new ih(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ta(e).next(function(t){t||(n.isPrimary=!1,n.js.ea(function(){return n.Bc(!1)}))})}).next(function(){return n.na(e)}).next(function(t){return n.isPrimary&&!t?n.sa(e).next(function(){return!1}):!!t&&n.ia(e).next(function(){return!0})})}).catch(function(t){if(Ma(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.js.ea(function(){return n.Bc(t)}),n.isPrimary=t})},lf.prototype.ta=function(t){var e=this;return pf(t).get(zc.key).next(function(t){return Oa.resolve(e.ra(t))})},lf.prototype.oa=function(t){return df(t).delete(this.clientId)},lf.prototype.ca=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.aa(this.Lc,18e5)?[3,2]:(this.Lc=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=fh(t,ih.store);return r.Ds().next(function(t){var e=o.ua(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Oa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.jc)for(n=0,r=e;n<r.length;n++)i=r[n],this.jc.removeItem(this.ha(i.clientId));t.label=2;case 2:return[2]}})})},lf.prototype.Jc=function(){var t=this;this.$c=this.js.ni("client_metadata_refresh",4e3,function(){return t.Gc().then(function(){return t.ca()}).then(function(){return t.Jc()})})},lf.prototype.ra=function(t){return!!t&&t.ownerId===this.clientId},lf.prototype.na=function(e){var r=this;return this.Nc?Oa.resolve(!0):pf(e).get(zc.key).next(function(t){if(null!==t&&r.aa(t.leaseTimestampMs,5e3)&&!r.la(t.ownerId)){if(r.ra(t)&&r.networkEnabled)return!0;if(!r.ra(t)){if(!t.allowTabSynchronization)throw new Br(qr.FAILED_PRECONDITION,hf);return!1}}return!(!r.networkEnabled||!r.inForeground)||df(e).Ds().next(function(t){return void 0===r.ua(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},lf.prototype.L=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Oc=!1,this._a(),this.$c&&(this.$c.cancel(),this.$c=null),this.fa(),this.da(),[4,this.Uc.runTransaction("shutdown","readwrite",[zc.store,ih.store],function(t){var e=new ch(t,hc.Zi);return n.sa(e).next(function(){return n.oa(e)})})];case 1:return t.sent(),this.Uc.close(),this.wa(),[2]}})})},lf.prototype.ua=function(t,e){var n=this;return t.filter(function(t){return n.aa(t.updateTimeMs,e)&&!n.la(t.clientId)})},lf.prototype.Ea=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return df(t).Ds().next(function(t){return e.ua(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(lf.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),lf.prototype.Ta=function(t){return Uh.Ao(t,this.fe,this.To,this.Io)},lf.prototype.ac=function(){return this.Qc},lf.prototype._c=function(){return this.Kc},lf.prototype.Ia=function(){return this.To},lf.prototype.ma=function(){return this.Wc},lf.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Uc.runTransaction(e,t,ah,function(t){return o=new ch(t,i.Fc?i.Fc.next():hc.Zi),"readwrite-primary"===n?i.ta(o).next(function(t){return!!t||i.na(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.js.ea(function(){return i.Bc(!1)}),new Br(qr.FAILED_PRECONDITION,tc);return r(o)}).next(function(t){return i.ia(o).next(function(){return t})}):i.Aa(o).next(function(){return r(o)})}).then(function(t){return o.ki(),t})},lf.prototype.Aa=function(t){var e=this;return pf(t).get(zc.key).next(function(t){if(null!==t&&e.aa(t.leaseTimestampMs,5e3)&&!e.la(t.ownerId)&&!e.ra(t)&&!(e.Nc||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Br(qr.FAILED_PRECONDITION,hf)})},lf.prototype.ia=function(t){var e=new zc(this.clientId,this.allowTabSynchronization,Date.now());return pf(t).put(zc.key,e)},lf.G=function(){return xa.G()},lf.prototype.sa=function(t){var e=this,n=pf(t);return n.get(zc.key).next(function(t){return e.ra(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(zc.key)):Oa.resolve()})},lf.prototype.aa=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},lf.prototype.zc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Mc=function(){t.js.Ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.Gc()})},this.document.addEventListener("visibilitychange",this.Mc),this.inForeground="visible"===this.document.visibilityState)},lf.prototype.fa=function(){this.Mc&&(this.document.removeEventListener("visibilitychange",this.Mc),this.Mc=null)},lf.prototype.Hc=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.kc=function(){e._a(),e.js.Ws(function(){return e.L()})},this.window.addEventListener("unload",this.kc))},lf.prototype.da=function(){this.kc&&(this.window.removeEventListener("unload",this.kc),this.kc=null)},lf.prototype.la=function(t){try{var e=null!==(null===(e=this.jc)||void 0===e?void 0:e.getItem(this.ha(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},lf.prototype._a=function(){if(this.jc)try{this.jc.setItem(this.ha(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},lf.prototype.wa=function(){if(this.jc)try{this.jc.removeItem(this.ha(this.clientId))}catch(t){}},lf.prototype.ha=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},lf);function lf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.js=i,this.window=o,this.document=s,this.xc=a,this.Nc=c,this.Fc=null,this.Oc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kc=null,this.inForeground=!1,this.Mc=null,this.$c=null,this.Lc=Number.NEGATIVE_INFINITY,this.Bc=function(t){return Promise.resolve()},!lf.G())throw new Br(qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Io=new Yh(this,r),this.qc=e+"main",this.fe=new lh(u),this.Uc=new xa(this.qc,11,new uf(this.fe)),this.Qc=new Gh(this.Io,this.fe),this.To=new Dh,this.Kc=(e=this.fe,u=this.To,new Zh(e,u)),this.Wc=new _h,this.window&&this.window.localStorage?this.jc=this.window.localStorage:(this.jc=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function pf(t){return fh(t,zc.store)}function df(t){return fh(t,ih.store)}function yf(t,e){var n=t.projectId;return t.M||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var vf=(_f.prototype.Pa=function(e,n){var r=this;return this.Ra.So(e,n).next(function(t){return r.ya(e,n,t)})},_f.prototype.ya=function(t,r,i){return this.Kc.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ir(r,t);return t})},_f.prototype.ga=function(t,e,i){var o=Nu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ir(t,e);o=o.Ie(t,e)}),o},_f.prototype.Va=function(e,t){var n=this;return this.Kc.getEntries(e,t).next(function(t){return n.pa(e,t)})},_f.prototype.pa=function(e,r){var i=this;return this.Ra.Do(e,r).next(function(t){var t=i.ga(e,r,t),n=Nu;return t.forEach(function(t,e){e=e||new Eo(t,xi.min()),n=n.Ie(t,e)}),n})},_f.prototype.Pc=function(t,e,n){return r=e,Li.qt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ba(t,e.path):ys(e)?this.va(t,e,n):this.Sa(t,e,n);var r},_f.prototype.ba=function(t,e){return this.Pa(t,new Li(e)).next(function(t){var e=Du;return t instanceof Io&&(e=e.Ie(t.key,t)),e})},_f.prototype.va=function(n,r,i){var o=this,s=r.collectionGroup,u=Du;return this.To.wo(n,s).next(function(t){return Oa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new as(t,null,e.ne.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Sa(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ie(t,e)})})}).next(function(){return u})})},_f.prototype.Sa=function(e,n,t){var c,h,r=this;return this.Kc.Pc(e,n,t).next(function(t){return c=t,r.Ra.xo(e,n)}).next(function(t){return h=t,r.Da(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Xs(s,a,a,r.er);c=a instanceof Io?c.Ie(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Es(n,e)||(c=c.remove(t))}),c})},_f.prototype.Da=function(t,e,n){for(var r=Pu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ru&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kc.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Io&&(c=c.Ie(t,e))}),c})},_f),gf=(Ef.Na=function(t,e){for(var n=Pu(),r=Pu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ef(t,e.fromCache,n,r)},Ef),mf=(If.prototype.Fa=function(t){this.Oa=t},If.prototype.Pc=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.ne.length||1===r.ne.length&&r.ne[0].field.Ot())||i.isEqual(xi.min())?this.ka(e,r):this.Oa.Va(e,o).next(function(t){var n=s.Ma(r,t);return(fs(r)||ls(r))&&s.$a(r.limitType,n,o,i)?s.ka(e,r):(Nr()<=l.DEBUG&&Sr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Is(r)),s.Oa.Pc(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ie(t.key,t)}),e}))})},If.prototype.Ma=function(n,t){var r=new Tu(_s(n));return t.forEach(function(t,e){e instanceof Io&&Es(n,e)&&(r=r.add(e))}),r},If.prototype.$a=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},If.prototype.ka=function(t,e){return Nr()<=l.DEBUG&&Sr("QueryEngine","Using full collection scan to execute query:",Is(e)),this.Oa.Pc(t,e,xi.min())},If),wf=(bf.prototype.Fr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ur(t,n.Ba)})},bf);function bf(t,e,n,r){this.persistence=t,this.La=e,this.fe=r,this.Ba=new yu(Cr),this.qa=new vc(Do,xo),this.Ua=xi.min(),this.Ra=t.Ta(n),this.Qa=t._c(),this.Qc=t.ac(),this.Ka=new vf(this.Qa,this.Ra,this.persistence.Ia()),this.Wc=t.ma(),this.La.Fa(this.Ka)}function If(){}function Ef(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ca=n,this.xa=r}function _f(t,e,n){this.Kc=t,this.Ra=e,this.To=n}function Tf(t,e,n,r){return new wf(t,e,n,r)}function Af(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ra,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ra.vo(v).next(function(t){return g=t,n=e.persistence.Ta(o),m=new vf(e.Qa,n,e.persistence.Ia()),n.vo(v)}).next(function(t){for(var e=[],n=[],r=Pu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Va(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Ra=n,e.Ka=m,e.La.Fa(e.Ka),r)]}})})}function Nf(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Qa.lc({yc:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=Oa.resolve(),n.forEach(function(n){u=u.next(function(){return o.Ar(r,n)}).next(function(t){var e=t,t=i.ar.get(n);Pr(null!==t),(!e||e.version.u(t)<0)&&(e=s.nr(n,e,i))&&o.Er(e,i.cr)})}),u.next(function(){return e.Ra.No(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Ra.ko(t)}).next(function(){return f.Ka.Va(t,a)})})}function Sf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Qc.Wo(t)})}function Of(t,r){var a=t,c=r.oe,h=a.Ba;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Qa.lc({yc:!0});h=a.Ba;var u=[];r.rn.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Qc.ic(s,t.dn,e).next(function(){return a.Qc.nc(s,t._n,e)})),0<(i=t.resumeToken).o()&&(n=o.ae(i,c).ce(s.oo),h=h.Ie(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.oe.Et()-r.oe.Et()||0<i._n.size+i.fn.size+i.dn.size)&&u.push(a.Qc.Yo(s,n))))});var e,n=Nu;return r.cn.forEach(function(t,e){r.an.has(t)&&u.push(a.persistence.Io.fc(s,t))}),u.push(Df(s,t,r.cn,c,void 0).next(function(t){n=t})),c.isEqual(xi.min())||(e=a.Qc.Wo(s).next(function(t){return a.Qc.Go(s,s.oo,c)}),u.push(e)),Oa.hs(u).next(function(){return t.apply(s)}).next(function(){return a.Ka.pa(s,n)})}).then(function(t){return a.Ba=h,t})}function Df(t,s,e,u,a){var n=Pu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Nu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Eo&&e.version.isEqual(xi.min())?(s.mr(t,r),o=o.Ie(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.Er(e,r),o=o.Ie(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function xf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Qc.ec(e,r).next(function(t){return t?(n=t,Oa.resolve(n)):i.Qc.Uo(e).next(function(t){return n=new Ts(r,t,0,e.oo),i.Qc.zo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ba.get(t.targetId);return(null===e||0<t.oe.u(e.oe))&&(i.Ba=i.Ba.Ie(t.targetId,t),i.qa.set(r,t.targetId)),t})}function kf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ba.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Io.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ma(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ba=e.Ba.remove(o),e.qa.delete(n.target),[2]}})})}function Pf(t,o,s){var u=t,a=xi.min(),c=Pu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=gs(o),(void 0!==(t=(i=t).qa.get(r))?Oa.resolve(i.Ba.get(t)):i.Qc.ec(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Qc.oc(e,t.targetId).next(function(t){c=t})}).next(function(){return u.La.Pc(e,o,s?a:xi.min(),s?c:Pu())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}function Rf(t,e){var n=t,r=n.Qc,t=n.Ba.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Zn(t,e).next(function(t){return t?t.target:null})})}function Lf(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Qa,n=t,t=s.Ua,r=e,i=Nu,o=yh(t),t=of(n),n=IDBKeyRange.lowerBound(o,!0),t.Fs({index:$c.readTimeIndex,range:n},function(t,e){var n=ph(r.fe,e);i=i.Ie(n.key,n),o=e.readTime}).next(function(){return{tr:i,readTime:vh(o)}});var e,n,r,i,o}).then(function(t){var e=t.tr,t=t.readTime;return s.Ua=t,e})}function Cf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=of(t),r=xi.min(),t.Fs({index:$c.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=vh(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Ua=t})]})})}var Uf,Vf,Mf=(rl.prototype.ao=function(t,e){return Oa.resolve(this.Xa.get(e))},rl.prototype.uo=function(t,e){return this.Xa.set(e.id,{id:e.id,version:e.version,createTime:ia(e.createTime)}),Oa.resolve()},rl.prototype.ho=function(t,e){return Oa.resolve(this.Za.get(e))},rl.prototype.lo=function(t,e){return this.Za.set(e.name,{name:(e=e).name,query:Eh(e.bundledQuery),readTime:ia(e.readTime)}),Oa.resolve()},rl),jf=(nl.prototype.bt=function(){return this.tu.bt()},nl.prototype.sc=function(t,e){e=new Ff(t,e);this.tu=this.tu.add(e),this.nu=this.nu.add(e)},nl.prototype.iu=function(t,e){var n=this;t.forEach(function(t){return n.sc(t,e)})},nl.prototype.rc=function(t,e){this.ru(new Ff(t,e))},nl.prototype.ou=function(t,e){var n=this;t.forEach(function(t){return n.rc(t,e)})},nl.prototype.cu=function(t){var e=this,n=new Li(new ki([])),r=new Ff(n,t),t=new Ff(n,t+1),i=[];return this.nu.Qe([r,t],function(t){e.ru(t),i.push(t.key)}),i},nl.prototype.au=function(){var e=this;this.tu.forEach(function(t){return e.ru(t)})},nl.prototype.ru=function(t){this.tu=this.tu.delete(t),this.nu=this.nu.delete(t)},nl.prototype.uu=function(t){var e=new Li(new ki([])),n=new Ff(e,t),t=new Ff(e,t+1),r=Pu();return this.nu.Qe([n,t],function(t){r=r.add(t.key)}),r},nl.prototype.Mo=function(t){var e=new Ff(t,0),e=this.tu.We(e);return null!==e&&t.isEqual(e.key)},nl),Ff=(el.eu=function(t,e){return Li.At(t.key,e.key)||Cr(t.hu,e.hu)},el.su=function(t,e){return Cr(t.hu,e.hu)||Li.At(t.key,e.key)},el),qf=(tl.prototype.Ro=function(t){return Oa.resolve(0===this.Ra.length)},tl.prototype.Po=function(t,e,n,r){var i=this.lu;this.lu++,0<this.Ra.length&&this.Ra[this.Ra.length-1];n=new dc(i,e,n,r);this.Ra.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this._u=this._u.add(new Ff(u.key,i)),this.To.fo(t,u.key.path.yt())}return Oa.resolve(n)},tl.prototype.yo=function(t,e){return Oa.resolve(this.fu(e))},tl.prototype.po=function(t,e){e+=1,e=this.du(e),e=e<0?0:e;return Oa.resolve(this.Ra.length>e?this.Ra[e]:null)},tl.prototype.bo=function(){return Oa.resolve(0===this.Ra.length?-1:this.lu-1)},tl.prototype.vo=function(t){return Oa.resolve(this.Ra.slice())},tl.prototype.So=function(t,e){var n=this,r=new Ff(e,0),e=new Ff(e,Number.POSITIVE_INFINITY),i=[];return this._u.Qe([r,e],function(t){t=n.fu(t.hu);i.push(t)}),Oa.resolve(i)},tl.prototype.Do=function(t,e){var n=this,r=new Tu(Cr);return e.forEach(function(t){var e=new Ff(t,0),t=new Ff(t,Number.POSITIVE_INFINITY);n._u.Qe([e,t],function(t){r=r.add(t.hu)})}),Oa.resolve(this.wu(r))},tl.prototype.xo=function(t,e){var n=e.path,r=n.length+1,e=n;Li.qt(e)||(e=e.child(""));var e=new Ff(new Li(e),0),i=new Tu(Cr);return this._u.Ke(function(t){var e=t.key.path;return!!n.vt(e)&&(e.length===r&&(i=i.add(t.hu)),!0)},e),Oa.resolve(this.wu(i))},tl.prototype.wu=function(t){var e=this,n=[];return t.forEach(function(t){t=e.fu(t);null!==t&&n.push(t)}),n},tl.prototype.No=function(n,r){var i=this;Pr(0===this.Eu(r.batchId,"removed")),this.Ra.shift();var o=this._u;return Oa.forEach(r.mutations,function(t){var e=new Ff(t.key,r.batchId);return o=o.delete(e),i.Io.Oo(n,t.key)}).next(function(){i._u=o})},tl.prototype.Fo=function(t){},tl.prototype.Mo=function(t,e){var n=new Ff(e,0),n=this._u.We(n);return Oa.resolve(e.isEqual(n&&n.key))},tl.prototype.ko=function(t){return this.Ra.length,Oa.resolve()},tl.prototype.Eu=function(t,e){return this.du(t)},tl.prototype.du=function(t){return 0===this.Ra.length?0:t-this.Ra[0].batchId},tl.prototype.fu=function(t){t=this.du(t);return t<0||t>=this.Ra.length?null:this.Ra[t]},tl),Bf=(Zf.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Tu(e);return this.docs=this.docs.Ie(r,{Ir:e,size:i,readTime:n}),this.size+=i-o,this.To.fo(t,r.path.yt())},Zf.prototype.mr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Zf.prototype.Ar=function(t,e){e=this.docs.get(e);return Oa.resolve(e?e.Ir:null)},Zf.prototype.getEntries=function(t,e){var n=this,r=Nu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ie(t,e?e.Ir:null)}),Oa.resolve(r)},Zf.prototype.Pc=function(t,e,n){for(var r=Du,i=new Li(e.path.child("")),o=this.docs.Ve(i);o.Ce();){var s=o.De(),u=s.key,a=s.value,s=a.Ir,a=a.readTime;if(!e.path.vt(u.path))break;a.u(n)<=0||s instanceof Io&&Es(e,s)&&(r=r.Ie(s.key,s))}return Oa.resolve(r)},Zf.prototype.Iu=function(t,e){return Oa.forEach(this.docs,function(t){return e(t)})},Zf.prototype.lc=function(t){return new Gf(this)},Zf.prototype.dc=function(t){return Oa.resolve(this.size)},Zf),Gf=(h($f,Vf=o),$f.prototype.yr=function(n){var r=this,i=[];return this._r.forEach(function(t,e){e&&e.Ir?i.push(r.gc.Er(n,e.Ir,r.wr(t))):r.gc.mr(t)}),Oa.hs(i)},$f.prototype.Rr=function(t,e){return this.gc.Ar(t,e)},$f.prototype.Pr=function(t,e){return this.gc.getEntries(t,e)},$f),zf=(Xf.prototype.Un=function(t,n){return this.mu.forEach(function(t,e){return n(e)}),Oa.resolve()},Xf.prototype.Wo=function(t){return Oa.resolve(this.lastRemoteSnapshotVersion)},Xf.prototype.jo=function(t){return Oa.resolve(this.Au)},Xf.prototype.Uo=function(t){return this.highestTargetId=this.Pu.next(),Oa.resolve(this.highestTargetId)},Xf.prototype.Go=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Au&&(this.Au=e),Oa.resolve()},Xf.prototype.Ho=function(t){this.mu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pu=new Bh(e),this.highestTargetId=e),t.sequenceNumber>this.Au&&(this.Au=t.sequenceNumber)},Xf.prototype.zo=function(t,e){return this.Ho(e),this.targetCount+=1,Oa.resolve()},Xf.prototype.Yo=function(t,e){return this.Ho(e),Oa.resolve()},Xf.prototype.Xo=function(t,e){return this.mu.delete(e.target),this.Ru.cu(e.targetId),--this.targetCount,Oa.resolve()},Xf.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return this.mu.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.mu.delete(t),u.push(o.Zo(n,e.targetId)),s++)}),Oa.hs(u).next(function(){return s})},Xf.prototype.tc=function(t){return Oa.resolve(this.targetCount)},Xf.prototype.ec=function(t,e){e=this.mu.get(e)||null;return Oa.resolve(e)},Xf.prototype.nc=function(t,e,n){return this.Ru.iu(e,n),Oa.resolve()},Xf.prototype.ic=function(e,t,n){this.Ru.ou(t,n);var r=this.persistence.Io,i=[];return r&&t.forEach(function(t){i.push(r.Oo(e,t))}),Oa.hs(i)},Xf.prototype.Zo=function(t,e){return this.Ru.cu(e),Oa.resolve()},Xf.prototype.oc=function(t,e){e=this.Ru.uu(e);return Oa.resolve(e)},Xf.prototype.Mo=function(t,e){return Oa.resolve(this.Ru.Mo(e))},Xf),Hf=(Jf.prototype.start=function(){return Promise.resolve()},Jf.prototype.L=function(){return this.Oc=!1,Promise.resolve()},Object.defineProperty(Jf.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),Jf.prototype.Xc=function(){},Jf.prototype.Zc=function(){},Jf.prototype.Ia=function(){return this.To},Jf.prototype.Ta=function(t){var e=this.yu[t.I()];return e||(e=new qf(this.To,this.Io),this.yu[t.I()]=e),e},Jf.prototype.ac=function(){return this.Qc},Jf.prototype._c=function(){return this.Kc},Jf.prototype.ma=function(){return this.Wc},Jf.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Kf(this.Fc.next());return this.Io.Vu(),n(i).next(function(t){return r.Io.pu(i).next(function(){return t})}).cs().then(function(t){return i.ki(),t})},Jf.prototype.bu=function(e,n){return Oa.ls(Object.values(this.yu).map(function(t){return function(){return t.Mo(e,n)}}))},Jf),Kf=(h(Yf,Uf=_e),Yf),Wf=(Qf.Du=function(t){return new Qf(t)},Object.defineProperty(Qf.prototype,"Cu",{get:function(){if(this.Su)return this.Su;throw kr()},enumerable:!1,configurable:!0}),Qf.prototype.sc=function(t,e,n){return this.vu.sc(n,e),this.Cu.delete(n.toString()),Oa.resolve()},Qf.prototype.rc=function(t,e,n){return this.vu.rc(n,e),this.Cu.add(n.toString()),Oa.resolve()},Qf.prototype.Oo=function(t,e){return this.Cu.add(e.toString()),Oa.resolve()},Qf.prototype.removeTarget=function(t,e){var n=this;this.vu.cu(e.targetId).forEach(function(t){return n.Cu.add(t.toString())});var r=this.persistence.ac();return r.oc(t,e.targetId).next(function(t){t.forEach(function(t){return n.Cu.add(t.toString())})}).next(function(){return r.Xo(t,e)})},Qf.prototype.Vu=function(){this.Su=new Set},Qf.prototype.pu=function(n){var r=this,i=this.persistence._c().lc();return Oa.forEach(this.Cu,function(t){var e=Li.$t(t);return r.xu(n,e).next(function(t){t||i.mr(e)})}).next(function(){return r.Su=null,i.apply(n)})},Qf.prototype.fc=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Cu.delete(e.toString()):n.Cu.add(e.toString())})},Qf.prototype.gu=function(t){return 0},Qf.prototype.xu=function(t,e){var n=this;return Oa.ls([function(){return Oa.resolve(n.vu.Mo(e))},function(){return n.persistence.ac().Mo(t,e)},function(){return n.persistence.bu(t,e)}])},Qf);function Qf(t){this.persistence=t,this.vu=new jf,this.Su=null}function Yf(t){var e=this;return(e=Uf.call(this)||this).oo=t,e}function Jf(t,e){var n=this;this.yu={},this.Fc=new hc(0),this.Oc=!1,this.Oc=!0,this.Io=t(this),this.Qc=new zf(this),this.To=new Sh,this.Kc=(t=this.To,new Bf(t,function(t){return n.Io.gu(t)})),this.fe=new lh(e),this.Wc=new Mf(this.fe)}function Xf(t){this.persistence=t,this.mu=new vc(Do,xo),this.lastRemoteSnapshotVersion=xi.min(),this.highestTargetId=0,this.Au=0,this.Ru=new jf,this.targetCount=0,this.Pu=Bh.Bo()}function $f(t){var e=this;return(e=Vf.call(this)||this).gc=t,e}function Zf(t,e){this.To=t,this.Tu=e,this.docs=new yu(Li.At),this.size=0}function tl(t,e){this.To=t,this.Io=e,this.Ra=[],this.lu=1,this._u=new Tu(Ff.eu)}function el(t,e){this.key=t,this.hu=e}function nl(){this.tu=new Tu(Ff.eu),this.nu=new Tu(Ff.su)}function rl(t){this.fe=t,this.Xa=new Map,this.Za=new Map}function il(t,e){return"firestore_clients_"+t+"_"+e}function ol(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.T()&&(n+="_"+e.uid),n}function sl(t,e){return"firestore_targets_"+t+"_"+e}var ul=(bl.Nu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Br(r.error.code,r.error.message)),i?new bl(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},bl.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},bl),al=(wl.Nu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Br(n.error.code,n.error.message)),r?new wl(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},wl.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},wl),cl=(ml.Nu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ru,o=0;r&&o<n.activeTargetIds.length;++o)r=mi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ml(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ml),hl=(gl.Nu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new gl(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},gl),fl=(vl.prototype.Ou=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},vl.prototype.ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},vl.prototype.Fu=function(){var t={activeTargetIds:this.activeTargetIds.Dt(),updateTimeMs:Date.now()};return JSON.stringify(t)},vl),ll=(yl.G=function(t){return!(!t||!t.localStorage)},yl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.$u.Ea()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Mu&&(i=this.getItem(il(this.persistenceKey,r)))&&(o=cl.Nu(r,i))&&(this.Uu=this.Uu.Ie(o.clientId,o));for(this.Yu(),(s=this.storage.getItem(this.Hu))&&(u=this.Xu(s))&&this.Zu(u),a=0,c=this.Qu;a<c.length;a++)h=c[a],this.qu(h);return this.Qu=[],this.window.addEventListener("unload",function(){return f.L()}),this.Nr=!0,[2]}})})},yl.prototype.Xi=function(t){this.setItem(this.Wu,JSON.stringify(t))},yl.prototype.th=function(){return this.eh(this.Uu)},yl.prototype.nh=function(n){var r=!1;return this.Uu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},yl.prototype.sh=function(t){this.ih(t,"pending")},yl.prototype.rh=function(t,e,n){this.ih(t,e,n),this.oh(t)},yl.prototype.ah=function(t){var e,n="not-current";return this.nh(t)&&(!(e=this.storage.getItem(sl(this.persistenceKey,t)))||(e=al.Nu(t,e))&&(n=e.state)),this.uh.Ou(t),this.Yu(),n},yl.prototype.hh=function(t){this.uh.ku(t),this.Yu()},yl.prototype.lh=function(t){return this.uh.activeTargetIds.has(t)},yl.prototype._h=function(t){this.removeItem(sl(this.persistenceKey,t))},yl.prototype.fh=function(t,e,n){this.dh(t,e,n)},yl.prototype.wh=function(t,e,n){var r=this;e.forEach(function(t){r.oh(t)}),this.currentUser=t,n.forEach(function(t){r.sh(t)})},yl.prototype.Eh=function(t){this.Th(t)},yl.prototype.Ih=function(){this.mh()},yl.prototype.L=function(){this.Nr&&(this.window.removeEventListener("storage",this.Bu),this.removeItem(this.Ku),this.Nr=!1)},yl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},yl.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},yl.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},yl.prototype.qu=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Sr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Ku)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.ea(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Nr){if(null!==o.key)if(this.ju.test(o.key)){if(null==o.newValue)return e=this.Ah(o.key),[2,this.Rh(e,null)];if(e=this.Ph(o.key,o.newValue))return[2,this.Rh(e.clientId,e)]}else if(this.Gu.test(o.key)){if(null!==o.newValue&&(n=this.yh(o.key,o.newValue)))return[2,this.gh(n)]}else if(this.zu.test(o.key)){if(null!==o.newValue&&(r=this.Vh(o.key,o.newValue)))return[2,this.ph(r)]}else if(o.key===this.Hu){if(null!==o.newValue&&(i=this.Xu(o.newValue)))return[2,this.Zu(i)]}else if(o.key===this.Wu)(i=function(t){var e=hc.Zi;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==hc.Zi&&this.Hi(i);else if(o.key===this.Ju)return[2,this.$u.bh()]}else this.Qu.push(o);return[2]})})})}},Object.defineProperty(yl.prototype,"uh",{get:function(){return this.Uu.get(this.Mu)},enumerable:!1,configurable:!0}),yl.prototype.Yu=function(){this.setItem(this.Ku,this.uh.Fu())},yl.prototype.ih=function(t,e,n){n=new ul(this.currentUser,t,e,n),t=ol(this.persistenceKey,this.currentUser,t);this.setItem(t,n.Fu())},yl.prototype.oh=function(t){t=ol(this.persistenceKey,this.currentUser,t);this.removeItem(t)},yl.prototype.Th=function(t){t={clientId:this.Mu,onlineState:t};this.storage.setItem(this.Hu,JSON.stringify(t))},yl.prototype.dh=function(t,e,n){var r=sl(this.persistenceKey,t),n=new al(t,e,n);this.setItem(r,n.Fu())},yl.prototype.mh=function(){this.setItem(this.Ju,"value-not-used")},yl.prototype.Ah=function(t){t=this.ju.exec(t);return t?t[1]:null},yl.prototype.Ph=function(t,e){t=this.Ah(t);return cl.Nu(t,e)},yl.prototype.yh=function(t,e){var n=this.Gu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return ul.Nu(new Xr(n),t,e)},yl.prototype.Vh=function(t,e){t=this.zu.exec(t),t=Number(t[1]);return al.Nu(t,e)},yl.prototype.Xu=function(t){return hl.Nu(t)},yl.prototype.gh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.$u.Sh(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},yl.prototype.ph=function(t){return this.$u.Dh(t.targetId,t.state,t.error)},yl.prototype.Rh=function(t,e){var n=this,r=e?this.Uu.Ie(t,e):this.Uu.remove(t),i=this.eh(this.Uu),o=this.eh(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.$u.Ch(s,u).then(function(){n.Uu=r})},yl.prototype.Zu=function(t){this.Uu.get(t.clientId)&&this.Lu(t.onlineState)},yl.prototype.eh=function(t){var n=Ru;return t.forEach(function(t,e){n=n.je(e.activeTargetIds)}),n},yl),pl=(dl.prototype.sh=function(t){},dl.prototype.rh=function(t,e,n){},dl.prototype.ah=function(t){return this.xh.Ou(t),this.Nh[t]||"not-current"},dl.prototype.fh=function(t,e,n){this.Nh[t]=e},dl.prototype.hh=function(t){this.xh.ku(t)},dl.prototype.lh=function(t){return this.xh.activeTargetIds.has(t)},dl.prototype._h=function(t){delete this.Nh[t]},dl.prototype.th=function(){return this.xh.activeTargetIds},dl.prototype.nh=function(t){return this.xh.activeTargetIds.has(t)},dl.prototype.start=function(){return this.xh=new fl,Promise.resolve()},dl.prototype.wh=function(t,e,n){},dl.prototype.Eh=function(t){},dl.prototype.L=function(){},dl.prototype.Xi=function(t){},dl.prototype.Ih=function(){},dl);function dl(){this.xh=new fl,this.Nh={},this.Lu=null,this.Hi=null}function yl(t,e,n,r,i){this.window=t,this.js=e,this.persistenceKey=n,this.Mu=r,this.$u=null,this.Lu=null,this.Hi=null,this.Bu=this.qu.bind(this),this.Uu=new yu(Cr),this.Nr=!1,this.Qu=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ku=il(this.persistenceKey,this.Mu),this.Wu="firestore_sequence_number_"+this.persistenceKey,this.Uu=this.Uu.Ie(this.Mu,new fl),this.ju=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Gu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.zu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Hu="firestore_online_state_"+this.persistenceKey,this.Ju="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Bu)}function vl(){this.activeTargetIds=Ru}function gl(t,e){this.clientId=t,this.onlineState=e}function ml(t,e){this.clientId=t,this.activeTargetIds=e}function wl(t,e,n){this.targetId=t,this.state=e,this.error=n}function bl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Il(){return"undefined"!=typeof window?window:null}function El(){return"undefined"!=typeof document?document:null}function _l(t,e,n,r,i){var o=this;this.Uh=t,this.Qh=e,this.ks=n,this.Kh={},this.Wh=[],this.jh=new Map,this.Gh=new Set,this.zh=[],this.Hh=i,this.Hh.$(function(t){n.Ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ll(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(4),[4,Sl(e)];case 1:return t.sent(),e.Jh.set("Unknown"),e.Gh.delete(4),[4,Nl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jh=new Tl(n,r)}var Tl=(Al.prototype.Mh=function(){var t=this;0===this.Fh&&(this.$h("Unknown"),this.Oh=this.ks.ni("online_state_timeout",1e4,function(){return t.Oh=null,t.Lh("Backend didn't respond within 10 seconds."),t.$h("Offline"),Promise.resolve()}))},Al.prototype.Bh=function(t){"Online"===this.state?this.$h("Unknown"):(this.Fh++,1<=this.Fh&&(this.qh(),this.Lh("Connection failed 1 times. Most recent error: "+t.toString()),this.$h("Offline")))},Al.prototype.set=function(t){this.qh(),this.Fh=0,"Online"===t&&(this.kh=!1),this.$h(t)},Al.prototype.$h=function(t){t!==this.state&&(this.state=t,this.Lu(t))},Al.prototype.Lh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kh?(Or(t),this.kh=!1):Sr("OnlineStateTracker",t)},Al.prototype.qh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},Al);function Al(t,e){this.ks=t,this.Lu=e,this.state="Unknown",this.Fh=0,this.Oh=null,this.kh=!0}function Nl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Ll(r))return[3,4];e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Sl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ol(t,e){t.jh.has(e.targetId)||(t.jh.set(e.targetId,e),Rl(t)?Pl(t):Gl(t).li()&&xl(t,e))}function Dl(t,e){var n=t,t=Gl(n);n.jh.delete(e),t.li()&&kl(n,e),0===n.jh.size&&(t.li()?t.di():Ll(n)&&n.Jh.set("Unknown"))}function xl(t,e){t.Yh.Dn(e.targetId),Gl(t).gi(e)}function kl(t,e){t.Yh.Dn(e),Gl(t).Vi(e)}function Pl(e){e.Yh=new Gu({Xn:function(t){return e.Kh.Xn(t)},Zn:function(t){return e.jh.get(t)||null}}),Gl(e).start(),e.Jh.Mh()}function Rl(t){return Ll(t)&&!Gl(t).hi()&&0<t.jh.size}function Ll(t){return 0===t.Gh.size}function Cl(t){t.Yh=void 0}function Ul(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jh.set("Online"),!(u instanceof qu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.jh.has(i)?[4,o.Kh.Xh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.jh.delete(i),o.Yh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Vl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof ju?s.Yh.$n(u):u instanceof Fu?s.Yh.jn(u):s.Yh.qn(u),a.isEqual(xi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Sf(s.Uh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yh.Hn(i)).rn.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.jh.get(e))&&r.jh.set(e,n.ae(t.resumeToken,i)))}),e.on.forEach(function(t){var e=r.jh.get(t);e&&(r.jh.set(t,e.ae(Mr.h,e.oe)),kl(r,t),e=new Ts(e.target,t,1,e.sequenceNumber),xl(r,e))}),r.Kh.Zh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Vl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Vl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ma(r))throw r;return n.Gh.add(1),[4,Sl(n)];case 1:return t.sent(),n.Jh.set("Offline"),i=i||function(){return Sf(n.Uh)},n.ks.ea(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Gh.delete(1),[4,Nl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Ml(e,n){return n().catch(function(t){return Vl(e,t,n)})}function jl(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=zl(i=a),s=0<i.Wh.length?i.Wh[i.Wh.length-1].batchId:-1,t.label=1;case 1:if(!(Ll(i)&&i.Wh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Uh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ra.po(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Wh.length&&o.di(),[3,7]):(s=u.batchId,function(t,e){t.Wh.push(e);t=zl(t);t.li()&&t.bi&&t.vi(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Vl(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Fl(i)&&ql(i),[2]}var e,n,r})})}function Fl(t){return Ll(t)&&!zl(t).hi()&&0<t.Wh.length}function ql(t){zl(t).start()}function Bl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Gh.delete(2),[4,Nl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Gh.add(2),[4,Sl(e)]);case 3:t.sent(),e.Jh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Gl(n){var t,e,r,i=this;return n.nl||(n.nl=(t=n.Qh,e=n.ks,r={Y:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.jh.forEach(function(t,e){xl(n,t)}),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Cl(e),Rl(e)?(e.Jh.Bh(n),Pl(e)):e.Jh.set("Unknown"),[2]})})}.bind(null,n),yi:Ul.bind(null,n)},t.Ni(),new Xa(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nl.fi(),Rl(n)?Pl(n):n.Jh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.nl.stop()];case 2:t.sent(),Cl(n),t.label=3;case 3:return[2]}})})})),n.nl}function zl(n){var t,e,r,i=this;return n.sl||(n.sl=(t=n.Qh,e=n.ks,r={Y:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return zl(e).Ci(),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&zl(e).bi?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ii(n=i.code)&&n!==qr.ABORTED?(e=r.Wh.shift(),zl(r).fi(),[4,Ml(r,function(){return r.Kh.el(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,jl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Fl(e)&&ql(e),[2]}})})}.bind(null,n),Di:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=zl(o),n=0,r=o.Wh;n<r.length;n++)i=r[n],e.vi(i.mutations);return[2]})})}.bind(null,n),Si:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wh.shift(),n=yc.from(e,i,o),[4,Ml(r,function(){return r.Kh.tl(n)})];case 1:return t.sent(),[4,jl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ni(),new $a(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.sl.fi(),[4,jl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.sl.stop()];case 3:t.sent(),0<n.Wh.length&&(Sr("RemoteStore","Stopping write stream with "+n.Wh.length+" pending writes"),n.Wh=[]),t.label=4;case 4:return[2]}})})})),n.sl}function Hl(){this.queries=new vc(bs,ws),this.onlineState="Unknown",this.rl=new Set}var Kl=function(){this.il=void 0,this.listeners=[]};function Wl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Kl),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ol(n)];case 2:return o.il=t.sent(),[3,4];case 3:return o=t.sent(),o=Ka(o,"Initialization of query '"+Is(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.cl(e.onlineState),i.il&&u.al(i.il)&&Yl(e),[2]}})})}function Ql(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.ul(n))]:[2]})})}function Yl(t){t.rl.forEach(function(t){t.next()})}var Jl=(rp.prototype.al=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Uu(t.query,t.docs,t.Ze,e,t.tn,t.fromCache,t.en,!0)}var o=!1;return this.ll?this.fl(t)&&(this.hl.next(t),o=!0):this.dl(t,this.onlineState)&&(this.wl(t),o=!0),this._l=t,o},rp.prototype.onError=function(t){this.hl.error(t)},rp.prototype.cl=function(t){this.onlineState=t;var e=!1;return this._l&&!this.ll&&this.dl(this._l,t)&&(this.wl(this._l),e=!0),e},rp.prototype.dl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.El&&n||t.docs.bt()&&"Offline"!==e)},rp.prototype.fl=function(t){if(0<t.docChanges.length)return!0;var e=this._l&&this._l.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},rp.prototype.wl=function(t){t=Uu.sn(t.query,t.docs,t.tn,t.fromCache),this.ll=!0,this.hl.next(t)},rp),Xl=(np.prototype.Tl=function(){return"metadata"in this.payload},np),$l=(ep.prototype.Ha=function(t){return aa(this.fe,t)},ep.prototype.Ja=function(t){return t.metadata.exists?da(this.fe,t.document,!1):new Eo(this.Ha(t.metadata.name),this.Ya(t.metadata.readTime))},ep.prototype.Ya=ia,ep),Zl=(tp.prototype.ml=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},tp.prototype.Al=function(t){for(var e=new Map,n=new $l(this.fe),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ha(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Pu()).add(s);e.set(c,h)}}return e},tp.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=Pu(),i=Nu,o=xu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Ha(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ie(a,l.Ja(u)),o=o.Ie(a,l.Ya(u.metadata.readTime));return c=n.Qa.lc({yc:!0}),[4,xf(n,gs(hs(ki.xt("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Df(e,c,i,xi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Qc.Zo(e,h.targetId).next(function(){return n.Qc.nc(e,r,h.targetId)}).next(function(){return n.Ka.pa(e,t)})})})]}})})}(this.Uh,new $l(this.fe),this.documents,this.Il.id)];case 1:e=t.sent(),n=this.Al(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Pu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,xf(e,gs(Eh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ia(i.readTime);if(0<=n.oe.u(e))return r.Wc.lo(t,i);e=n.ae(Mr.h,e);return r.Ba=r.Ba.Ie(e.targetId,e),r.Qc.Yo(t,e).next(function(){return r.Qc.Zo(t,n.targetId)}).next(function(){return r.Qc.nc(t,o,n.targetId)}).next(function(){return r.Wc.lo(t,i)})})]}})})}(this.Uh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new pc(Object.assign({},this.progress),e))]}})})},tp);function tp(t,e,n){this.Il=t,this.Uh=e,this.fe=n,this.queries=[],this.documents=[],this.progress=ip(t)}function ep(t){this.fe=t}function np(t,e){this.payload=t,this.byteLength=e}function rp(t,e,n){this.query=t,this.hl=e,this.ll=!1,this._l=null,this.onlineState="Unknown",this.options=n||{}}function ip(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var op=function(t){this.key=t},sp=function(t){this.key=t},up=(Object.defineProperty(lp.prototype,"pl",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),lp.prototype.bl=function(t,e){var s=this,u=e?e.vl:new Cu,a=(e||this).Vl,c=(e||this).tn,h=a,f=!1,l=fs(this.query)&&a.size===this.query.limit?a.last():null,p=ls(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pe(function(t,e){var n=a.get(t),r=(r=e instanceof Io?e:null)&&(Es(s.query,r)?r:null),i=!!n&&s.tn.has(n.key),o=!!r&&(r.Jt||s.tn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Sl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.gl(r,l)||p&&s.gl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),fs(this.query)||ls(this.query))for(;h.size>this.query.limit;){var n=fs(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Vl:h,vl:u,$a:f,tn:c}},lp.prototype.Sl=function(t,e){return t.Jt&&e.hasCommittedMutations&&!e.Jt},lp.prototype.yr=function(t,e,n){var o=this,r=this.Vl;this.Vl=t.Vl,this.tn=t.tn;var i=t.vl.Xe();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.gl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Dl(n);var s=e?this.Cl():[],n=0===this.yl.size&&this.ln?1:0,e=n!==this.Pl;return this.Pl=n,0!==i.length||e?{snapshot:new Uu(this.query,t.Vl,r,i,t.tn,0==n,e,!1),xl:s}:{xl:s}},lp.prototype.cl=function(t){return this.ln&&"Offline"===t?(this.ln=!1,this.yr({Vl:this.Vl,vl:new Cu,tn:this.tn,$a:!1},!1)):{xl:[]}},lp.prototype.Nl=function(t){return!this.Rl.has(t)&&!!this.Vl.has(t)&&!this.Vl.get(t).Jt},lp.prototype.Dl=function(t){var e=this;t&&(t._n.forEach(function(t){return e.Rl=e.Rl.add(t)}),t.fn.forEach(function(t){}),t.dn.forEach(function(t){return e.Rl=e.Rl.delete(t)}),this.ln=t.ln)},lp.prototype.Cl=function(){var e=this;if(!this.ln)return[];var n=this.yl;this.yl=Pu(),this.Vl.forEach(function(t){e.Nl(t.key)&&(e.yl=e.yl.add(t.key))});var r=[];return n.forEach(function(t){e.yl.has(t)||r.push(new sp(t))}),this.yl.forEach(function(t){n.has(t)||r.push(new op(t))}),r},lp.prototype.Fl=function(t){this.Rl=t.za,this.yl=Pu();t=this.bl(t.documents);return this.yr(t,!0)},lp.prototype.Ol=function(){return Uu.sn(this.query,this.Vl,this.tn,0===this.Pl)},lp),ap=function(t,e,n){this.query=t,this.targetId=e,this.view=n},cp=function(t){this.key=t,this.kl=!1},hp=(Object.defineProperty(fp.prototype,"Xl",{get:function(){return!0===this.Yl},enumerable:!1,configurable:!0}),fp);function fp(t,e,n,r,i,o){this.Uh=t,this.Ml=e,this.$l=n,this.Ll=r,this.currentUser=i,this.Bl=o,this.ql={},this.Ul=new vc(bs,ws),this.Ql=new Map,this.Kl=[],this.Wl=new yu(Li.At),this.jl=new Map,this.Gl=new jf,this.zl={},this.Hl=new Map,this.Jl=Bh.qo(),this.onlineState="Unknown",this.Yl=void 0}function lp(t,e){this.query=t,this.Rl=e,this.Pl=null,this.ln=!1,this.yl=Pu(),this.tn=Pu(),this.gl=_s(t),this.Vl=new Lu(this.gl)}function pp(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Zl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.bl(o)).$a?[4,Pf(r.Uh,i.query,!1).then(function(t){t=t.documents;return i.view.bl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.rn.get(i.targetId),n=i.view.yr(e,r.Xl,n),[2,(_p(r,i.targetId,n.xl),n.snapshot)]}})})}(i,t,e,n)},[4,Pf(i.Uh,o,!0)];case 1:return n=t.sent(),r=new up(o,n.za),e=r.bl(n.documents),n=Mu.hn(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Xl,n),_p(i,s,n.xl),r=new ap(o,s,r),[2,(i.Ul.set(o,r),i.Ql.has(s)?i.Ql.get(s).push(o):i.Ql.set(s,[o]),n.snapshot)]}})})}function dp(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Pp(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Uh,a=p,h=i,f=Di.now(),o=a.reduce(function(t,e){return t.add(e.key)},Pu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.Va(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Io?e.field(o.field):void 0,s=Ds(o.transform,s||null);null!=s&&(n=(null==n?new yo:n).set(o.field,s))}return n?n.Gt():null}(e.fieldTransforms,s):null);null!=s&&n.push(new ru(o.key,s,function s(t){var u=[];return Hi(t.fields||{},function(t,e){var n=new Ri([t]);if(lo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Wi(u)}(s.proto.mapValue),Qs.exists(!0)))}return h.Ra.Po(u,f,n,a)})}).then(function(t){var e=t.rr(c);return{batchId:t.batchId,_r:e}}))];case 2:return s=t.sent(),u.Ll.sh(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.zl[e.currentUser.I()])||new yu(Cr)).Ie(n,r),e.zl[e.currentUser.I()]=i,[4,Ap(u,s._r)];case 3:return t.sent(),[4,jl(u.Ml)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ka(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function yp(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Of(n.Uh,i)];case 2:return e=t.sent(),i.rn.forEach(function(t,e){e=n.jl.get(e);e&&(Pr(t._n.size+t.fn.size+t.dn.size<=1),0<t._n.size?e.kl=!0:0<t.fn.size?Pr(e.kl):0<t.dn.size&&(Pr(e.kl),e.kl=!1))}),[4,Ap(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,lc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function vp(t,n,e){var r,t=t;(t.Xl&&0===e||!t.Xl&&1===e)&&(r=[],t.Ul.forEach(function(t,e){e=e.view.cl(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].cl(i)&&(o=!0)}),o&&Yl(t)}(t.$l,n),r.length&&t.ql.yi(r),t.onlineState=n,t.Xl&&t.Ll.Eh(n))}function gp(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ra.yo(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.Ra.No(e,t)}).next(function(){return i.Ra.ko(e)}).next(function(){return i.Ka.Va(e,n)})}))];case 2:return o=t.sent(),bp(n,u,a),wp(n,u),n.Ll.rh(u,"rejected",a),[4,Ap(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,lc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function mp(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Ll((n=o).Ml)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Uh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ra.bo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Hl.get(r)||[]).push(s),n.Hl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ka(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function wp(t,e){(t.Hl.get(e)||[]).forEach(function(t){t.resolve()}),t.Hl.delete(e)}function bp(t,e,n){var r=t,i=r.zl[r.currentUser.I()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.zl[r.currentUser.I()]=i)}function Ip(e,t,n){void 0===n&&(n=null),e.Ll.hh(t);for(var r=0,i=e.Ql.get(t);r<i.length;r++){var o=i[r];e.Ul.delete(o),n&&e.ql.t_(o,n)}e.Ql.delete(t),e.Xl&&e.Gl.cu(t).forEach(function(t){e.Gl.Mo(t)||Ep(e,t)})}function Ep(t,e){var n=t.Wl.get(e);null!==n&&(Dl(t.Ml,n),t.Wl=t.Wl.remove(e),t.jl.delete(n),Tp(t))}function _p(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof op?(t.Gl.sc(o.key,e),function(t,e){e=e.key;t.Wl.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.Kl.push(e),Tp(t))}(t,o)):o instanceof sp?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Gl.rc(o.key,e),t.Gl.Mo(o.key)||Ep(t,o.key)):kr()}}function Tp(t){for(;0<t.Kl.length&&t.Wl.size<t.Bl;){var e=t.Kl.shift(),n=t.Jl.next();t.jl.set(n,new cp(e)),t.Wl=t.Wl.Ie(e,n),Ol(t.Ml,new Ts(gs(hs(e.path)),n,2,hc.Zi))}}function Ap(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ul.bt()?[3,3]:(n.Ul.forEach(function(t,e){o.push(n.Zl(e,s,u).then(function(t){t&&(n.Xl&&n.Ll.fh(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=gf.Na(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ql.yi(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Oa.forEach(c,function(e){return Oa.forEach(e.Ca,function(t){return r.persistence.Io.sc(n,e.targetId,t)}).next(function(){return Oa.forEach(e.xa,function(t){return r.persistence.Io.rc(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ba.get(o),u=s.oe,u=s.ue(u),r.Ba=r.Ba.Ie(o,u));return[2]}})})}(n.Uh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Np(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.I()),[4,Af(n.Uh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Hl.forEach(function(t){t.forEach(function(t){t.reject(new Br(qr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Hl.clear(),n.Ll.wh(o,r.ja,r.Ga),[4,Ap(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Sp(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Uh,n=a,i=(r=e).Ra,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Vo(e,n).next(function(t){return t?r.Ka.Va(e,t):Oa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,jl(o.Ml)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(bp(o,a,h||null),wp(o,a),o.Uh.Ra.Fo(a)):kr(),t.label=4;case 4:return[4,Ap(o,s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Op(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return kp(r=h),Pp(r),!0!==f||!0===r.Yl?[3,3]:(e=r.Ll.th(),[4,Dp(r,e.Dt())]);case 1:return i=t.sent(),r.Yl=!0,[4,Bl(r.Ml,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Ol(r.Ml,u);return[3,7];case 3:return!1!==f||!1===r.Yl?[3,7]:(a=[],c=Promise.resolve(),r.Ql.forEach(function(t,e){r.Ll.lh(e)?a.push(e):c=c.then(function(){return Ip(r,e),kf(r.Uh,e,!0)}),Dl(r.Ml,e)}),[4,c]);case 4:return t.sent(),[4,Dp(r,a)];case 5:return t.sent(),(n=r).jl.forEach(function(t,e){Dl(n.Ml,e)}),n.Gl.au(),n.jl=new Map,n.Wl=new yu(Li.At),r.Yl=!1,[4,Bl(r.Ml,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Dp(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Ql.get(s))&&0!==a.length?[4,xf(e.Uh,gs(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Ul.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Pf((e=r).Uh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Fl(n),[2,(e.Xl&&_p(e,i.targetId,n.xl),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Rf(e.Uh,s)];case 8:return l=t.sent(),[4,xf(e.Uh,l)];case 9:return u=t.sent(),[4,pp(e,xp(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.ql.yi(r),n)]}})})}function xp(t){return cs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function kp(t){return t.Ml.Kh.Zh=yp.bind(null,t),t.Ml.Kh.Xn=function(t,e){var n=t;if((t=n.jl.get(e))&&t.kl)return Pu().add(t.key);var r=Pu();if(!(e=n.Ql.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Ul.get(s),r=r.je(s.view.pl);return r}.bind(null,t),t.Ml.Kh.Xh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ll.fh(s,"rejected",u),i=e.jl.get(s),(n=i&&i.key)?(r=(r=new yu(Li.At)).Ie(n,new Eo(n,xi.min())),i=Pu().add(n),i=new Vu(xi.min(),new Map,new Tu(Cr),r,i),[4,yp(e,i)]):[3,2];case 1:return t.sent(),e.Wl=e.Wl.remove(n),e.jl.delete(s),Tp(e),[3,4];case 2:return[4,kf(e.Uh,s,!1).then(function(){return Ip(e,s,u)}).catch(lc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.ql.yi=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].al(s)&&(r=!0);u.il=s}}r&&Yl(n)}.bind(null,t.$l),t.ql.t_=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.$l),t}function Pp(t){return t.Ml.Kh.tl=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Nf(e.Uh,o)];case 2:return r=t.sent(),bp(e,n,null),wp(e,n),e.Ll.rh(n,"acknowledged"),[4,Ap(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,lc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Ml.Kh.el=gp.bind(null,t),t}function Rp(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Uh,o=r,s=ia((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Wc.ao(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.e_({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.n_(ip(u)),a=new Zl(u,l.Uh,p.fe),[4,p.s_()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ml(c)]:[3,10];case 7:return(h=t.sent())&&d.n_(h),[4,p.s_()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Ap(l,f.tr,void 0)];case 12:return t.sent(),[4,(r=l.Uh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Wc.uo(t,e)}))];case 13:return t.sent(),d.e_(f.progress),[3,15];case 14:return Dr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.i_(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Ll.Ih()})}var Lp,Cp,Up=(Gp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.fe=Na(e.rt.O),this.Ll=this.r_(e),this.persistence=this.o_(e),[4,this.persistence.start()];case 1:return t.sent(),this.c_=this.a_(e),this.Uh=this.u_(e),[2]}})})},Gp.prototype.a_=function(t){return null},Gp.prototype.u_=function(t){return Tf(this.persistence,new mf,t.h_,this.fe)},Gp.prototype.o_=function(t){return new Hf(Wf.Du,this.fe)},Gp.prototype.r_=function(t){return new pl},Gp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.c_&&this.c_.stop(),[4,this.Ll.L()];case 1:return t.sent(),[4,this.persistence.L()];case 2:return t.sent(),[2]}})})},Gp),Vp=(h(Bp,Cp=Up),Bp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Cp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Cf(this.Uh)];case 2:return t.sent(),[4,this.l_.initialize(this,e)];case 3:return t.sent(),[4,Pp(this.l_.$u)];case 4:return t.sent(),[4,jl(this.l_.Ml)];case 5:return t.sent(),[2]}})})},Bp.prototype.u_=function(t){return Tf(this.persistence,new mf,t.h_,this.fe)},Bp.prototype.a_=function(t){var e=this.persistence.Io.vr;return new _c(e,t.ks)},Bp.prototype.o_=function(t){var e=yf(t.rt.O,t.rt.persistenceKey),n=void 0!==this.cacheSizeBytes?nc.Ki(this.cacheSizeBytes):nc.Gi;return new ff(this.synchronizeTabs,e,t.clientId,n,t.ks,Il(),El(),this.fe,this.Ll,!!this.forceOwnership)},Bp.prototype.r_=function(t){return new pl},Bp),Mp=(h(qp,Lp=Vp),qp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Lp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.l_.$u,this.Ll instanceof ll?(this.Ll.$u={Sh:Sp.bind(null,e),Dh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Yl?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Ql.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Lf(e.Uh)];case 3:return n=t.sent(),r=Vu.un(o,"current"===s),[4,Ap(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,kf(e.Uh,o,!0)];case 6:return t.sent(),Ip(e,o,u),[3,8];case 7:kr(),t.label=8;case 8:return[2]}})})}.bind(null,e),Ch:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=kp(c)).Yl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Ql.has(r)?(Sr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Rf(n.Uh,r)]):[3,6];case 2:return i=t.sent(),[4,xf(n.Uh,i)];case 3:return o=t.sent(),[4,pp(n,xp(i),o.targetId,!1)];case 4:t.sent(),Ol(n.Ml,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Ql.has(e)?[4,kf(n.Uh,e,!1).then(function(){Dl(n.Ml,e),Ip(n,e)}).catch(lc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ea:function(t){return t.Uh.persistence.Ea()}.bind(null,e),bh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Lf((e=n).Uh).then(function(t){return Ap(e,t)})]})})}.bind(null,e)},[4,this.Ll.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Yc(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Op(this.l_.$u,e)];case 1:return t.sent(),this.c_&&(e&&!this.c_.Nr?this.c_.start(this.Uh):e||this.c_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},qp.prototype.r_=function(t){var e=Il();if(!ll.G(e))throw new Br(qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=yf(t.rt.O,t.rt.persistenceKey);return new ll(e,t.ks,n,t.clientId,t.h_)},qp),jp=(Fp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh?[3,2]:(this.Uh=n.Uh,this.Ll=n.Ll,this.Qh=this.__(r),this.Ml=this.f_(r),this.$l=this.d_(r),this.$u=this.w_(r,!n.synchronizeTabs),this.Ll.Lu=function(t){return vp(e.$u,t,1)},this.Ml.Kh.E_=Np.bind(null,this.$u),[4,Bl(this.Ml,this.$u.Xl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Fp.prototype.d_=function(t){return new Hl},Fp.prototype.__=function(t){var e=Na(t.rt.O),n=(n=t.rt,new Oi(n));return t=t.credentials,new Za(t,n,e)},Fp.prototype.f_=function(t){var e=this,n=this.Uh,r=this.Qh,i=t.ks,o=function(t){return vp(e.$u,t,0)},t=new(ai.G()?ai:ui);return new _l(n,r,i,o,t)},Fp.prototype.w_=function(t,e){return function(t,e,n,r,i,o,s){o=new hp(t,e,n,r,i,o);return s&&(o.Yl=!0),o}(this.Uh,this.Ml,this.$l,this.Ll,t.h_,t.Bl,e)},Fp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Gh.add(5),[4,Sl(e)];case 1:return t.sent(),e.Hh.L(),e.Jh.set("Unknown"),[2]}})})}(this.Ml)},Fp);function Fp(){}function qp(t,e){var n=this;return(n=Lp.call(this,t,e,!1)||this).l_=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Bp(t,e,n){var r=this;return(r=Cp.call(this)||this).l_=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Gp(){this.synchronizeTabs=!1}function zp(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var Hp,Kp=(id.prototype.next=function(t){this.observer.next&&this.T_(this.observer.next,t)},id.prototype.error=function(t){this.observer.error?this.T_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},id.prototype.I_=function(){this.muted=!0},id.prototype.T_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},id),Wp=(rd.prototype.close=function(){return this.m_.cancel()},rd.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},rd.prototype.s_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.R_())]}})})},rd.prototype.R_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.P_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.A_.decode(e),n=Number(r),isNaN(n)&&this.y_("length string ("+r+") is not valid number"),[4,this.g_(n)]);case 2:return r=t.sent(),[2,new Xl(JSON.parse(r),e.length+n)]}})})},rd.prototype.V_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},rd.prototype.P_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.V_()<0?[4,this.p_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.V_())<0&&this.y_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},rd.prototype.g_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.p_()]:[3,3];case 1:t.sent()&&this.y_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.A_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},rd.prototype.y_=function(t){throw this.m_.cancel(),new Error("Invalid bundle format: "+t)},rd.prototype.p_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.m_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},rd),Qp=(nd.prototype.isEqual=function(t){return this.b_.isEqual(t.b_)},nd),Yp=function(t){this._methodName=t},Jp=(Object.defineProperty(ed.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"path",{get:function(){return this.S_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"parent",{get:function(){return new $p(this.firestore,this.v_,this.S_.path.yt())},enumerable:!1,configurable:!0}),ed.prototype.withConverter=function(t){return new ed(this.firestore,t,this.S_)},ed),Xp=(td.prototype.withConverter=function(t){return new td(this.firestore,t,this.C_)},td),$p=(h(Zp,Hp=Xp),Object.defineProperty(Zp.prototype,"id",{get:function(){return this.C_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"path",{get:function(){return this.C_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"parent",{get:function(){var t=this.D_.yt();return t.bt()?null:new Jp(this.firestore,null,new Li(t))},enumerable:!1,configurable:!0}),Zp.prototype.withConverter=function(t){return new Zp(this.firestore,t,this.D_)},Zp);function Zp(t,e,n){var r=this;return(r=Hp.call(this,t,e,hs(n))||this).firestore=t,r.D_=n,r.type="collection",r}function td(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function ed(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function nd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.b_=new Ri(t)}function rd(t,e){var n=this;this.m_=t,this.fe=e,this.metadata=new Si,this.buffer=new Uint8Array,this.A_=new TextDecoder("utf-8"),this.R_().then(function(t){t&&t.Tl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function id(t){this.observer=t,this.muted=!1}function od(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),Oc("collection","path",e),t instanceof Mc)return Pc(n=ki.xt.apply(ki,f([e],r))),new $p(t,null,n);if(!(t instanceof Jp||t instanceof $p))throw new Br(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Pc(n=ki.xt.apply(ki,f([t.path],r)).child(ki.xt(e))),new $p(t.firestore,null,n)}function sd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),1===arguments.length&&(e=Rr.t()),Oc("doc","path",e),t instanceof Mc)return kc(n=ki.xt.apply(ki,f([e],r))),new Jp(t,null,new Li(n));if(!(t instanceof Jp||t instanceof $p))throw new Br(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kc(n=t.D_.child(ki.xt.apply(ki,f([e],r)))),new Jp(t.firestore,t instanceof $p?t.v_:null,new Li(n))}function ud(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),(t instanceof Jp||t instanceof $p)&&(e instanceof Jp||e instanceof $p)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function ad(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),t instanceof Xp&&e instanceof Xp&&t.firestore===e.firestore&&ws(t.C_,e.C_)&&t.v_===e.v_}var cd=(Object.defineProperty(yd.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),yd.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},yd.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},yd.prototype.dt=function(t){return Cr(this.x_,t.x_)||Cr(this.N_,t.N_)},yd),hd=/^__.*__$/,fd=(dd.prototype.F_=function(t,e){return null!==this.Te?new ru(t,this.data,this.Te,e,this.fieldTransforms):new nu(t,this.data,e,this.fieldTransforms)},dd),ld=(pd.prototype.F_=function(t,e){return new ru(t,this.data,this.Te,e,this.fieldTransforms)},pd);function pd(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function dd(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function yd(t,e){if(!isFinite(t)||t<-90||90<t)throw new Br(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Br(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function vd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var gd=(Object.defineProperty(bd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),bd.prototype.M_=function(t){return new bd(Object.assign(Object.assign({},this.settings),t),this.O,this.fe,this.ignoreUndefinedProperties,this.fieldTransforms,this.Te)},bd.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},bd.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},bd.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},bd.prototype.K_=function(t){return Yd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},bd.prototype.contains=function(e){return void 0!==this.Te.find(function(t){return e.vt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.vt(t.field)})},bd.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},bd.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(vd(this.k_)&&hd.test(t))throw this.K_('Document fields cannot begin and end with "__"')},bd),md=(wd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new gd({k_:t,methodName:e,j_:n,path:Ri.Nt(),B_:!1,W_:r},this.O,this.fe,this.ignoreUndefinedProperties)},wd);function wd(t,e,n){this.O=t,this.ignoreUndefinedProperties=e,this.fe=n||Na(t)}function bd(t,e,n,r,i,o){this.settings=t,this.O=e,this.fe=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Te=o||[]}function Id(t){var e=t.so(),n=Na(t.zr);return new md(t.zr,!!e.ignoreUndefinedProperties,n)}function Ed(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Hd("Data must be an object, but it was:",s,r);var u,a,r=Gd(r,s);if(o.merge)u=new Wi(s.Te),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Kd(e,f[h],n);if(!s.contains(l))throw new Br(qr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Jd(c,l)||c.push(l)}u=new Wi(c),a=s.fieldTransforms.filter(function(t){return u.Qt(t.field)})}else u=null,a=s.fieldTransforms;return new fd(new po(r),u,a)}var _d,Td=(h(Ad,_d=Yp),Ad.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Te.push(t.path),null},Ad.prototype.isEqual=function(t){return t instanceof Ad},Ad);function Ad(){return null!==_d&&_d.apply(this,arguments)||this}function Nd(t,e,n){return new gd({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.O,e.fe,e.ignoreUndefinedProperties)}var Sd,Od,Dd,xd,kd=(h(Md,xd=Yp),Md.prototype.z_=function(t){return new Ws(t.path,new Ps)},Md.prototype.isEqual=function(t){return t instanceof Md},Md),Pd=(h(Vd,Dd=Yp),Vd.prototype.z_=function(t){var e=Nd(this,t,!0),n=this.H_.map(function(t){return Bd(t,e)}),n=new Rs(n);return new Ws(t.path,n)},Vd.prototype.isEqual=function(t){return this===t},Vd),Rd=(h(Ud,Od=Yp),Ud.prototype.z_=function(t){var e=Nd(this,t,!0),n=this.H_.map(function(t){return Bd(t,e)}),n=new Ms(n);return new Ws(t.path,n)},Ud.prototype.isEqual=function(t){return this===t},Ud),Ld=(h(Cd,Sd=Yp),Cd.prototype.z_=function(t){var e=new Bs(t.fe,Os(t.fe,this.J_));return new Ws(t.path,e)},Cd.prototype.isEqual=function(t){return this===t},Cd);function Cd(t,e){var n=this;return(n=Sd.call(this,t)||this).J_=e,n}function Ud(t,e){var n=this;return(n=Od.call(this,t)||this).H_=e,n}function Vd(t,e){var n=this;return(n=Dd.call(this,t)||this).H_=e,n}function Md(){return null!==xd&&xd.apply(this,arguments)||this}function jd(t,r,i,e){var o=t.G_(1,r,i);Hd("Data must be an object, but it was:",o,e);var s=[],u=new yo;Hi(e,function(t,e){var n=Qd(r,t,i);e instanceof zr&&(e=e._);t=o.U_(n);e instanceof Td?s.push(n):null!=(t=Bd(e,t))&&(s.push(n),u.set(n,t))});e=new Wi(s);return new ld(u.Gt(),e,o.fieldTransforms)}function Fd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Kd(e,r,n)],a=[i];if(o.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Kd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new yo,y=u.length-1;0<=y;--y){Jd(p,u[y])||(h=u[y],(f=a[y])instanceof zr&&(f=f._),l=s.U_(h),f instanceof Td?p.push(h):null!=(l=Bd(f,l))&&(p.push(h),d.set(h,l)))}i=new Wi(p);return new ld(d.Gt(),i,s.fieldTransforms)}function qd(t,e,n,r){return void 0===r&&(r=!1),Bd(n,t.G_(r?4:3,e))}function Bd(s,t){if(s instanceof zr&&(s=s._),zd(s))return Hd("Unsupported field value:",t,s),Gd(s,t);if(s instanceof Yp)return function(t,e){if(!vd(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Te.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Bd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof zr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Os(e.fe,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:na(e.fe,n)}}if(t instanceof Di)return n=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:na(e.fe,n)};if(t instanceof cd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gr)return{bytesValue:ra(e.fe,t.l)};if(t instanceof Jp){n=e.O;var r=t.firestore.zr;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:oa(t.firestore.zr||e.O,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Rc(t))}(s,t)}function Gd(t,n){var r={};return Ki(t)?n.path&&0<n.path.length&&n.Te.push(n.path):Hi(t,function(t,e){e=Bd(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function zd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof cd||t instanceof Gr||t instanceof Jp||t instanceof Yp)}function Hd(t,e,n){if(!zd(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Rc(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function Kd(t,e,n){if(e instanceof zr&&(e=e._),e instanceof Qp)return e.b_;if("string"==typeof e)return Qd(t,e);throw Yd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Wd=new RegExp("[~\\*/\\[\\]]");function Qd(e,n,r){if(0<=n.search(Wd))throw Yd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Qp.bind.apply(Qp,f([void 0],n.split("."))))).b_}catch(t){throw Yd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Yd(t,e,n,r,i){var o=r&&!r.bt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Br(qr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Jd(t,e){return t.some(function(t){return t.isEqual(e)})}var Xd=(ny.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Br(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fa((n=s).fe)+"/documents",r={documents:u.map(function(t){return ua(n.fe,t)})},[4,n._t("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.fe,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=aa(t,e.found.name),t=ia(e.found.updateTime),e=new po({mapValue:{fields:e.found.fields}});return new Io(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=aa(t,e.missing),e=ia(e.readTime);return new Eo(t,e)}(e,t):kr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.Qh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Eo||t instanceof Io?n.sf(t):kr()}),e)]}})})},ny.prototype.set=function(t,e){this.write(e.F_(t,this.Ee(t))),this.tf.add(t.toString())},ny.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},ny.prototype.delete=function(t){this.write(new pu(t,this.Ee(t))),this.tf.add(t.toString())},ny.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Li.$t(e);n.mutations.push(new du(e,n.Ee(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=fa((e=i).fe)+"/documents",r={writes:o.map(function(t){return ya(e.fe,t)})},[4,e.at("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},ny.prototype.sf=function(t){var e;if(t instanceof Io)e=t.version;else{if(!(t instanceof Eo))throw kr();e=xi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(qr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},ny.prototype.Ee=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Qs.updateTime(e):Qs.de()},ny.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Qs.exists(!0);if(e.isEqual(xi.min()))throw new Br(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qs.updateTime(e)},ny.prototype.write=function(t){this.nf(),this.mutations.push(t)},ny.prototype.nf=function(){},ny),$d=(ey.prototype.run=function(){this.af()},ey.prototype.af=function(){var t=this;this.ui.ti(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Xd(this.Qh),(n=this.uf(e))&&n.then(function(t){r.ks.Ws(function(){return e.commit().then(function(){r.Bs.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},ey.prototype.uf=function(t){try{var e=this.updateFunction(t);return!vi(e)&&e.catch&&e.then?e:(this.Bs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Bs.reject(t),null}},ey.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.ks.Ws(function(){return e.af(),Promise.resolve()})):this.Bs.reject(t)},ey.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ii(t)},ey),Zd=(ty.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.S.promise];case 1:return[2,(t.sent(),{ks:this.ks,rt:this.rt,clientId:this.clientId,credentials:this.credentials,h_:this.user,Bl:100})]}})})},ty.prototype.ff=function(t){var e=this;this._f=t,this.S.promise.then(function(){return e._f(e.user)})},ty.prototype.df=function(){if(this.ks.wf)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},ty.prototype.terminate=function(){var t=this;this.ks.Ef();var n=new Si;return this.ks.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.p(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ka(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},ty);function ty(t,e,n){var r=this;this.credentials=t,this.ks=e,this.rt=n,this.user=Xr.UNAUTHENTICATED,this.clientId=Rr.t(),this._f=function(){},this.S=new Si,this.credentials.V(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r._f(t)),r.S.resolve()})}function ey(t,e,n,r){this.ks=t,this.Qh=e,this.updateFunction=n,this.Bs=r,this.cf=5,this.ui=new Ja(this.ks,"transaction_retry")}function ny(t){this.Qh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function ry(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ff(function(e){return r.ks.ea(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Af(i.Uh,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Xc(function(){return r.terminate()}),r.mf=i,[2]}})})}function iy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),[4,oy(r)];case 1:return e=t.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.ks.ea(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ks.Af(),Sr("RemoteStore","RemoteStore received new credentials"),n=Ll(e),e.Gh.add(3),[4,Sl(e)];case 1:return t.sent(),n&&e.Jh.set("Unknown"),[4,e.Kh.E_(i)];case 2:return t.sent(),e.Gh.delete(3),[4,Nl(e)];case 3:return t.sent(),[2]}})})}(i.Ml,t)})}),r.If=i,[2]}})})}function oy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,ry(e,new Up)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function sy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,iy(e,new jp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function uy(t){return oy(t).then(function(t){return t.persistence})}function ay(t){return oy(t).then(function(t){return t.Uh})}function cy(t){return sy(t).then(function(t){return t.Ml})}function hy(t){return sy(t).then(function(t){return t.$u})}function fy(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,sy(r)];case 1:return e=t.sent(),[2,((n=e.$l).ol=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=kp(s),(o=e.Ul.get(u))?(n=o.targetId,e.Ll.ah(n),r=o.view.Ol(),[3,4]):[3,1];case 1:return[4,xf(e.Uh,gs(u))];case 2:return i=t.sent(),o=e.Ll.ah(i.targetId),n=i.targetId,[4,pp(e,u,n,"current"===o)];case 3:r=t.sent(),e.Xl&&Ol(e.Ml,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.$u),n.ul=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ul.get(o),1<(r=e.Ql.get(n.targetId)).length?[2,(e.Ql.set(n.targetId,r.filter(function(t){return!ws(t,o)})),void e.Ul.delete(o))]:e.Xl?(e.Ll.hh(n.targetId),e.Ll.nh(n.targetId)?[3,2]:[4,kf(e.Uh,n.targetId,!1).then(function(){e.Ll._h(n.targetId),Dl(e.Ml,n.targetId),Ip(e,n.targetId)}).catch(lc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ip(e,n.targetId),[4,kf(e.Uh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.$u),n)]}})})}function ly(n,r,i){var t=this;void 0===i&&(i={});var o=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Kp({next:function(t){r.Ws(function(){return Ql(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Br(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Br(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Jl(hs(i.path),t,{includeMetadataChanges:!0,El:!0});return Wl(n,u)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}function py(n,r,i){var t=this;void 0===i&&(i={});var o=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Kp({next:function(t){n.Ws(function(){return Ql(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Br(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Jl(t,o,{includeMetadataChanges:!0,El:!0});return Wl(e,s)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}var dy,yy=(Object.defineProperty(my.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),my.prototype.Ws=function(t){this.enqueue(t)},my.prototype.Tf=function(t){this.Sf(),this.Df(t)},my.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=El())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},my.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},my.prototype.ea=function(t){var e=this;this.Ws(function(){return e.Pf.push(t),e.Cf()})},my.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.ui.reset(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.ui.ti(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},my.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},my.prototype.ni=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=za.qs(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},my.prototype.Sf=function(){this.Vf&&kr()},my.prototype.Af=function(){},my.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},my.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].Ms===t)return!0;return!1},my.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.$s-e.$s});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ms===r)break}return i.Nf()})},my.prototype.kf=function(t){this.bf.push(t)},my.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},my),vy=(h(gy,dy=Mc),gy.prototype.io=function(){return this.$f||by(this),this.$f.terminate()},gy);function gy(t,e){var n=this;return(n=dy.call(this,t,e)||this).Mf=new yy,n.Wr="name"in t?t.name:"[DEFAULT]",n}function my(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.ui=new Ja(this,"async_queue_retry"),this.vf=function(){var t=El();t&&Sr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ui.si()};var t=El();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function wy(t){return t.$f||by(t),t.$f.df(),t.$f}function by(t){var e,n,r=t.so(),r=(e=t.zr,n=t.Wr,new oi(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new Zd(t.Hr,t.Mf,r)}function Iy(n,r,i){var t=this,o=new Si;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,ry(n,i)];case 1:return t.sent(),[4,iy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===qr.FAILED_PRECONDITION||t.code===qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Ey(t){if(t.Yr||t.Xr)throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var _y,o=(Oy.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),eo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Xi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf($i(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw kr()}},Oy.prototype.jf=function(t,n){var r=this,i={};return Hi(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},Oy.prototype.Kf=function(t){return new cd(Xi(t.latitude),Xi(t.longitude))},Oy.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},Oy.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Zi(e)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf(to(t));default:return null}},Oy.prototype.Bf=function(t){t=Ji(t);return new Di(t.seconds,t.nanos)},Oy.prototype.Gf=function(t,e){var n=ki.xt(t);Pr(Aa(n));t=new si(n.get(1),n.get(3)),n=new Li(n.Pt(5));return t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Oy),Ty=(Object.defineProperty(Sy.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Sy.prototype,"ref",{get:function(){return new Jp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Sy.prototype.exists=function(){return null!==this.Jf},Sy.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Ay(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.Yt())}},Sy.prototype.get=function(t){if(this.Jf){t=this.Jf.data().field(Dy("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t)}},Sy),Ay=(h(Ny,_y=Ty),Ny.prototype.data=function(){return _y.prototype.data.call(this)},Ny);function Ny(){return null!==_y&&_y.apply(this,arguments)||this}function Sy(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Oy(){}function Dy(t,e){return"string"==typeof e?Qd(t,e):(e instanceof zr?e._:e).b_}function xy(t){if(ls(t)&&0===t.ne.length)throw new Br(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}_e=function(){};function ky(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var Py,Ry,Ly,Cy,Uy,Vy=(h(Ky,Uy=_e),Ky.prototype.Yf=function(t){var e=Id(t.firestore),e=function(t,e,n,r,i,o){if(r.Ot()){if("array-contains"===i||"array-contains-any"===i)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Yy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Qy(n,t,c))}h={arrayValue:{values:s}}}else h=Qy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Yy(o,i),h=qd(e,"where",o,"in"===i||"not-in"===i);var h=Ro.create(r,i,h);return function(t,e){if(e.ee()){var n=ds(t);if(null!==n&&!n.isEqual(e.field))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=ps(t);null!==n&&Jy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Br(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Br(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.zr,this.Xf,this.Zf,this.td);return new Xp(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new as(t.path,t.collectionGroup,t.ne.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Ky),My=(h(Hy,Cy=_e),Hy.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new os(e,n);return e=r,null!==ps(n=t)||null!==(t=ds(n))&&Jy(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Xp(t.firestore,t.v_,(t=t.C_,e=t.ne.concat([e]),new as(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Hy),jy=(h(zy,Ly=_e),zy.prototype.Yf=function(t){return new Xp(t.firestore,t.v_,ms(t.C_,this.nd,this.sd))},zy),Fy=(h(Gy,Ry=_e),Gy.prototype.Yf=function(t){var e=Wy(t,this.type,this.rd,this.od);return new Xp(t.firestore,t.v_,(t=t.C_,e=e,new as(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Gy),qy=(h(By,Py=_e),By.prototype.Yf=function(t){var e=Wy(t,this.type,this.rd,this.od);return new Xp(t.firestore,t.v_,(t=t.C_,e=e,new as(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},By);function By(t,e,n){var r=this;return(r=Py.call(this)||this).type=t,r.rd=e,r.od=n,r}function Gy(t,e,n){var r=this;return(r=Ry.call(this)||this).type=t,r.rd=e,r.od=n,r}function zy(t,e,n){var r=this;return(r=Ly.call(this)||this).type=t,r.nd=e,r.sd=n,r}function Hy(t,e){var n=this;return(n=Cy.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function Ky(t,e,n){var r=this;return(r=Uy.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function Wy(t,c,e,n){if(e[0]instanceof zr&&(e[0]=e[0]._),e[0]instanceof Ty)return function(t,e,n,r){if(!n)throw new Br(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=vs(t);o<s.length;o++){var u=s[o];if(u.field.Ot())i.push(uo(e,n.key));else{var a=n.field(u.field);if(Zi(a))throw new Br(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Ct();throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Zo(i,r)}(t.C_,t.firestore.zr,e[0].Jf,n);var r=Id(t.firestore);return function(t,e,n,r,i,o){var s=t.ne;if(i.length>s.length)throw new Br(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.Ot()){if("string"!=typeof c)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ys(t)&&-1!==c.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ki.xt(c));if(!Li.qt(h))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Li(h);u.push(uo(e,h))}else{c=qd(n,r,c);u.push(c)}}return new Zo(u,o)}(t.C_,t.firestore.zr,r,c,e,n)}function Qy(t,e,n){if(n instanceof zr&&(n=n._),"string"==typeof n){if(""===n)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ys(e)&&-1!==n.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ki.xt(n));if(!Li.qt(e))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return uo(t,new Li(e))}if(n instanceof Jp)return uo(t,n.S_);throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Rc(n)+".")}function Yy(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Jy(t,e,n){if(!n.isEqual(e))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Xy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var $y,Zy=(h(tv,$y=o),tv.prototype.Uf=function(t){return new Gr(t)},tv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return new Jp(this.firestore,null,t)},tv);function tv(t){var e=this;return(e=$y.call(this)||this).firestore=t,e}function ev(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var nv,rv,iv=(fv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},fv),ov=(h(hv,rv=Ty),hv.prototype.exists=function(){return rv.prototype.exists.call(this)},hv.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new sv(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.Yt(),t.serverTimestamps)}},hv.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){t=this.Jf.data().field(Dy("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t,e.serverTimestamps)}},hv),sv=(h(cv,nv=ov),cv.prototype.data=function(t){return void 0===t&&(t={}),nv.prototype.data.call(this,t)},cv),uv=(Object.defineProperty(av.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(av.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),av.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new sv(r.zf,r.Hf,t.key,t,new iv(r.ud.tn.has(t.key),r.ud.fromCache),r.query.v_))})},av.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.ud.nn)throw new Br(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.Ze.bt()){var n=0;return i.ud.docChanges.map(function(t){var e=new sv(i.zf,i.Hf,t.doc.key,t.doc,new iv(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.Ze;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new sv(i.zf,i.Hf,t.doc.key,t.doc,new iv(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},av);function av(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new iv(r.hasPendingWrites,r.fromCache),this.query=n}function cv(){return null!==nv&&nv.apply(this,arguments)||this}function hv(t,e,n,r,i,o){var s=this;return(s=rv.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function fv(t,e){this.hasPendingWrites=t,this.fromCache=e}function lv(t,e){return t instanceof ov&&e instanceof ov?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof uv&&e instanceof uv&&t.zf===e.zf&&ad(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var pv,dv=(h(yv,pv=o),yv.prototype.Uf=function(t){return new Gr(t)},yv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return new Jp(this.firestore,null,t)},yv);function yv(t){var e=this;return(e=pv.call(this)||this).firestore=t,e}function vv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Lc(t,Jp);var o=Lc(t.firestore,vy),s=Id(o);return e instanceof zr&&(e=e._),mv(o,[("string"==typeof e||e instanceof Qp?Fd(s,"updateDoc",t.S_,e,n,r):jd(s,"updateDoc",t.S_,e)).F_(t.S_,Qs.exists(!0))])}function gv(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof zr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ev(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return ev(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Jp?(u=Lc(e.firestore,vy),a=hs(e.S_.path),h={next:function(t){n[i]&&n[i](wv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Lc(e,Xp),u=Lc(s.firestore,vy),a=s.C_,c=new dv(u),h={next:function(t){n[i]&&n[i](new uv(u,c,s,t))},error:n[i+1],complete:n[i+2]},xy(e.C_)),function(n,t,e){var r=this,i=new Kp(h),o=new Jl(t,i,e);return n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Wl,[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.I_(),n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ql,[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(wy(u),a,f)}function mv(t,e){return function(n,r){var t=this,i=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=dp,[4,hy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(wy(t),e)}function wv(t,e,n){var r=n.docs.get(e.S_),i=new dv(t);return new ov(t,i,e.S_,r,new iv(n.hasPendingWrites,n.fromCache),e.v_)}var bv=(Iv.prototype.set=function(t,e,n){this.Ed();t=Ev(t,this.zf),e=Xy(t.v_,e,n),n=Ed(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.fd.push(n.F_(t.S_,Qs.de())),this},Iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();t=Ev(t,this.zf);return e instanceof zr&&(e=e._),e="string"==typeof e||e instanceof Qp?Fd(this.wd,"WriteBatch.update",t.S_,e,n,r):jd(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Qs.exists(!0))),this},Iv.prototype.delete=function(t){this.Ed();t=Ev(t,this.zf);return this.fd=this.fd.concat(new pu(t.S_,Qs.de())),this},Iv.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},Iv.prototype.Ed=function(){if(this.dd)throw new Br(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Iv);function Iv(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Id(t)}function Ev(t,e){if(t instanceof zr&&(t=t._),t.firestore!==e)throw new Br(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var _v,Tv,Av,Nv=(Lv.prototype.get=function(t){var e=this,n=Ev(t,this.zf),r=new Zy(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return kr();t=t[0];if(t instanceof Eo)return new Ty(e.zf,r,n.S_,null,n.v_);if(t instanceof Io)return new Ty(e.zf,r,t.key,t,n.v_);throw kr()})},Lv.prototype.set=function(t,e,n){t=Ev(t,this.zf),e=Xy(t.v_,e,n),n=Ed(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Td.set(t.S_,n),this},Lv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ev(t,this.zf);return e instanceof zr&&(e=e._),e="string"==typeof e||e instanceof Qp?Fd(this.wd,"Transaction.update",t.S_,e,n,r):jd(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},Lv.prototype.delete=function(t){t=Ev(t,this.zf);return this.Td.delete(t.S_),this},h(Rv,Av=Lv),Rv.prototype.get=function(t){var e=this,n=Ev(t,this.zf),r=new dv(this.zf);return Av.prototype.get.call(this,t).then(function(t){return new ov(e.zf,r,n.S_,t.Jf,new iv(!1,!1),n.v_)})},Rv),Sv=(Pv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Ey(t=Lc(t,vy));var n=wy(t),r=t.so(),t=new jp;return Iy(n,t,new Vp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},Pv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Ey(t=Lc(t,vy));var e=wy(t),n=t.so(),t=new jp;return Iy(e,t,new Mp(t,n.cacheSizeBytes))}(t._)},Pv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.Yr&&!n.Xr)throw new Br(qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Si;return n.Mf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return xa.G()?(e=n+"main",[4,xa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(yf(n.zr,n.Wr))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},Pv),Ov=(h(kv,Tv=zr),Object.defineProperty(kv.prototype,"zr",{get:function(){return this._.zr},enumerable:!1,configurable:!0}),kv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.no()),t)).merge,this._.eo(t)},kv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.no().host&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},kv.prototype.enableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,uy(r)];case 1:return e=t.sent(),[4,cy(r)];case 2:return n=t.sent(),[2,(e.Zc(!0),(t=n).Gh.delete(0),Nl(t))]}})})})}(wy(Lc(this._,vy)))},kv.prototype.disableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,uy(r)];case 1:return e=t.sent(),[4,cy(r)];case 2:return n=t.sent(),[2,(e.Zc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(0),[4,Sl(e)];case 1:return t.sent(),e.Jh.set("Offline"),[2]}})})}(n))]}})})})}(wy(Lc(this._,vy)))},kv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&xc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},kv.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},kv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},kv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=mp,[4,hy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(wy(Lc(this._,vy)))},kv.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new Kp(t);return n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.add(e),e.next()},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.I_(),n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.delete(e)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(wy(Lc(e,vy)),ev(t)?t:{next:t});var e},Object.defineProperty(kv.prototype,"app",{get:function(){if(!this.md)throw new Br(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),kv.prototype.collection=function(t){try{return new ig(this,od(this._,t))}catch(t){throw zv(t,"collection()","Firestore.collection()")}},kv.prototype.doc=function(t){try{return new Fv(this,sd(this._,t))}catch(t){throw zv(t,"doc()","Firestore.doc()")}},kv.prototype.collectionGroup=function(t){try{return new eg(this,function(t,e){if(t=Lc(t,Mc),Oc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Xp(t,null,(e=e,new as(ki.Nt(),e)))}(this._,t))}catch(t){throw zv(t,"collectionGroup()","Firestore.collectionGroup()")}},kv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,sy(n).then(function(t){return t.Qh})];case 1:return e=t.sent(),new $d(n.ks,e,r,i).run(),[2]}})})}),i.promise}(wy(n=this._),function(t){return t=new Nv(n,t),e(new Mv(r,t))})},kv.prototype.batch=function(){var e=this;return wy(this._),new jv(new bv(this._,function(t){return mv(e._,t)}))},kv.prototype.loadBundle=function(t){throw new Br(qr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},kv.prototype.namedQuery=function(t){throw new Br(qr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},kv),Dv=(h(xv,_v=o),xv.prototype.Uf=function(t){return new Jr(new Gr(t))},xv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.zr);return Fv.Ad(t,this.firestore,null)},xv);function xv(t){var e=this;return(e=_v.call(this)||this).firestore=t,e}function kv(t,e,n){var r=this;return(r=Tv.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof si||(r.md=t),r}function Pv(){}function Rv(t,e){var n=this;return(n=Av.call(this,t,e)||this).zf=t,n}function Lv(t,e){this.zf=t,this.Td=e,this.wd=Id(t)}var Cv,Uv,Vv,Mv=(h(Gv,Vv=zr),Gv.prototype.get=function(t){var e=this,t=fg(t);return this._.get(t).then(function(t){return new Zv(e.zf,t)})},Gv.prototype.set=function(t,e,n){t=fg(t);return n?(Dc("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=fg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Gv.prototype.delete=function(t){t=fg(t);return this._.delete(t),this},Gv),jv=(h(Bv,Uv=zr),Bv.prototype.set=function(t,e,n){t=fg(t);return n?(Dc("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Bv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=fg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Bv.prototype.delete=function(t){t=fg(t);return this._.delete(t),this},Bv.prototype.commit=function(){return this._.commit()},Bv),Fv=(h(qv,Cv=zr),qv.Rd=function(t,e,n){if(t.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Ct()+" has "+t.length);return new qv(e,new Jp(e._,n,new Li(t)))},qv.Ad=function(t,e,n){return new qv(e,new Jp(e._,n,t))},Object.defineProperty(qv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(qv.prototype,"parent",{get:function(){return new ig(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(qv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),qv.prototype.collection=function(t){try{return new ig(this.firestore,od(this._,t))}catch(t){throw zv(t,"collection()","DocumentReference.collection()")}},qv.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof Jp&&ud(this._,t)},qv.prototype.set=function(t,e){e=Dc("DocumentReference.set",e);try{return function(t,e,n){t=Lc(t,Jp);var r=Lc(t.firestore,vy),e=Xy(t.v_,e,n);return mv(r,[Ed(Id(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Qs.de())])}(this._,t,e)}catch(t){throw zv(t,"setDoc()","DocumentReference.set()")}},qv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?vv(this._,t):vv.apply(void 0,f([this._,t,e],n))}catch(t){throw zv(t,"updateDoc()","DocumentReference.update()")}},qv.prototype.delete=function(){return mv(Lc((t=this._).firestore,vy),[new pu(t.S_,Qs.de())]);var t},qv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Hv(t),i=Kv(t,function(t){return new Zv(e.firestore,new ov(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return gv(this._,r,i)},qv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Lc(e,Jp);var n=Lc(e.firestore,vy),t=wy(n),r=new dv(n);return function(n,r){var t=this,i=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Pa(t,e)}))];case 1:return(i=t.sent())instanceof Io?u.resolve(i):i instanceof Eo?u.resolve(null):u.reject(new Br(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Ka(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new ov(n,r,e.S_,t,new iv(t instanceof Io&&t.Jt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Lc(e,Jp);var n=Lc(e.firestore,vy);return ly(wy(n),e.S_,{source:"server"}).then(function(t){return wv(n,e,t)})}:function(e){e=Lc(e,Jp);var n=Lc(e.firestore,vy);return ly(wy(n),e.S_).then(function(t){return wv(n,e,t)})})(this._).then(function(t){return new Zv(e.firestore,new ov(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},qv.prototype.withConverter=function(t){return new qv(this.firestore,this._.withConverter(t))},qv);function qv(t,e){var n=this;return(n=Cv.call(this,e)||this).firestore=t,n.Hf=new Dv(t),n}function Bv(){return null!==Uv&&Uv.apply(this,arguments)||this}function Gv(t,e){var n=this;return(n=Vv.call(this,e)||this).zf=t,n}function zv(t,e,n){return t.message=t.message.replace(e,n),t}function Hv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ev(r))return r}return{}}function Kv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ev(t[0])?t[0]:ev(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Wv,Qv,Yv,Jv,Xv,$v,Zv=(h(hg,$v=zr),Object.defineProperty(hg.prototype,"ref",{get:function(){return new Fv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),hg.prototype.data=function(t){return this._.data(t)},hg.prototype.get=function(t,e){return this._.get(t,e)},hg.prototype.isEqual=function(t){return lv(this._,t._)},hg),tg=(h(cg,Xv=Zv),cg.prototype.data=function(t){return this._.data(t)},cg),eg=(h(ag,Jv=zr),ag.prototype.where=function(t,e,n){try{return new ag(this.firestore,ky(this._,(r=n,i=e,o=Dy("where",t),new Vy(o,i,r))))}catch(t){throw zv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},ag.prototype.orderBy=function(n,t){try{return new ag(this.firestore,ky(this._,function(t){void 0===t&&(t="asc");var e=t,t=Dy("orderBy",n);return new My(t,e)}(t)))}catch(n){throw zv(n,/(orderBy|where)\(\)/,"Query.$1()")}},ag.prototype.limit=function(t){try{return new ag(this.firestore,ky(this._,(Cc("limit",e=t),new jy("limit",e,"F"))))}catch(t){throw zv(t,"limit()","Query.limit()")}var e},ag.prototype.limitToLast=function(t){try{return new ag(this.firestore,ky(this._,(Cc("limitToLast",e=t),new jy("limitToLast",e,"L"))))}catch(t){throw zv(t,"limitToLast()","Query.limitToLast()")}var e},ag.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ky(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Fy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw zv(t,"startAt()","Query.startAt()")}},ag.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ky(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Fy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw zv(t,"startAfter()","Query.startAfter()")}},ag.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ky(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw zv(t,"endBefore()","Query.endBefore()")}},ag.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ky(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw zv(t,"endAt()","Query.endAt()")}},ag.prototype.isEqual=function(t){return ad(this._,t._)},ag.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Lc(e,Xp);var n=Lc(e.firestore,vy),t=wy(n),r=new dv(n);return function(n,r){var t=this,i=new Si;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Pf(i,o,!0)];case 1:return r=t.sent(),e=new up(o,r.za),n=e.bl(r.documents),n=e.yr(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Ka(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new uv(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Lc(e,Xp);var n=Lc(e.firestore,vy),t=wy(n),r=new dv(n);return py(t,e.C_,{source:"server"}).then(function(t){return new uv(n,r,e,t)})}:function(e){e=Lc(e,Xp);var n=Lc(e.firestore,vy),t=wy(n),r=new dv(n);return xy(e.C_),py(t,e.C_).then(function(t){return new uv(n,r,e,t)})})(this._).then(function(t){return new rg(e.firestore,new uv(e.firestore._,e.Hf,e._,t.ud))})},ag.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Hv(t),i=Kv(t,function(t){return new rg(e.firestore,new uv(e.firestore._,e.Hf,e._,t.ud))});return gv(this._,r,i)},ag.prototype.withConverter=function(t){return new ag(this.firestore,this._.withConverter(t))},ag),ng=(h(ug,Yv=zr),Object.defineProperty(ug.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"doc",{get:function(){return new tg(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),ug),rg=(h(sg,Qv=zr),Object.defineProperty(sg.prototype,"query",{get:function(){return new eg(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new tg(e.zf,t)})},enumerable:!1,configurable:!0}),sg.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new ng(e.zf,t)})},sg.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new tg(r.zf,t))})},sg.prototype.isEqual=function(t){return lv(this._,t._)},sg),ig=(h(og,Wv=eg),Object.defineProperty(og.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"parent",{get:function(){var t=this._.parent;return t?new Fv(this.firestore,t):null},enumerable:!1,configurable:!0}),og.prototype.doc=function(t){try{return new Fv(this.firestore,void 0===t?sd(this._):sd(this._,t))}catch(t){throw zv(t,"doc()","CollectionReference.doc()")}},og.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=Lc(e.firestore,vy),r=sd(e),n=Xy(e.v_,n),mv(t,[Ed(Id(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Qs.exists(!1))]).then(function(){return r}).then(function(t){return new Fv(i.firestore,t)})},og.prototype.isEqual=function(t){return ud(this._,t._)},og.prototype.withConverter=function(t){return new og(this.firestore,this._.withConverter(t))},og);function og(t,e){var n=this;return(n=Wv.call(this,t,e)||this).firestore=t,n._=e,n}function sg(t,e){var n=this;return(n=Qv.call(this,e)||this).zf=t,n}function ug(t,e){var n=this;return(n=Yv.call(this,e)||this).zf=t,n}function ag(t,e){var n=this;return(n=Jv.call(this,e)||this).firestore=t,n.Hf=new Dv(t),n}function cg(){return null!==Xv&&Xv.apply(this,arguments)||this}function hg(t,e){var n=this;return(n=$v.call(this,e)||this).zf=t,n}function fg(t){return t instanceof zr&&(t=t._),Lc(t,Jp)}var lg,pg,_e=(h(gg,pg=zr),gg.documentId=function(){return new gg(Ri.kt().Ct())},gg.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof Qp&&this._.b_.isEqual(t.b_)},gg),o=(h(vg,lg=zr),vg.serverTimestamp=function(){var t=new kd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new vg(t)},vg.delete=function(){var t=new Td("deleteField");return t._methodName="FieldValue.delete",new vg(t)},vg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new vg(n)},vg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new vg(n)},vg.increment=function(t){t=new Ld("increment",t);return t._methodName="FieldValue.increment",new vg(t)},vg.prototype.isEqual=function(t){return this._.isEqual(t._)},vg),dg=(yg.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},yg.prototype.catch=function(t){return this.yd.promise.catch(t)},yg.prototype.then=function(t,e){return this.yd.promise.then(t,e)},yg.prototype.e_=function(t){this.n_(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},yg.prototype.i_=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},yg.prototype.n_=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},yg);function yg(){this.Pd={},this.yd=new Si,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function vg(){return null!==lg&&lg.apply(this,arguments)||this}function gg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pg.call(this,new(Qp.bind.apply(Qp,f([void 0],t))))||this}function mg(t,s){var e=new dg;return function(n,t,r){var e,i=this,o=(e=s,t=Na(t),e=function(t){if(t instanceof Uint8Array)return zp(t,void 0);if(t instanceof ArrayBuffer)return zp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Wp(e,t));n.ks.Ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rp,[4,hy(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(wy(t._),t.zr,e),e}var wg=(bg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},bg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},bg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},bg);function bg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ig,Eg,_g={Firestore:Ov,GeoPoint:cd,Timestamp:Di,Blob:Jr,Transaction:Mv,WriteBatch:jv,DocumentReference:Fv,DocumentSnapshot:Zv,Query:eg,QueryDocumentSnapshot:tg,QuerySnapshot:rg,CollectionReference:ig,FieldPath:_e,FieldValue:o,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Ig=e.default).INTERNAL.registerComponent(new wg("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Ov(e,new vy(e,t),new Sv)},"PUBLIC").setServiceProps(Object.assign({},_g))),Ig.registerVersion("@firebase/firestore","2.1.0-202011822428"),(Eg=Ov).prototype.loadBundle=function(t){return mg(this,t)},Eg.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Wc.ho(t,e)})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(wy((e=this)._),t).then(function(t){return t?new eg(e,new Xp(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
