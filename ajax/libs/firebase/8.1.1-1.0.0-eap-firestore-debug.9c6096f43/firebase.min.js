!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,function(){"use strict";function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return"string"!=typeof e&&(e=String(e)),e}function e(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return p&&(e[Symbol.iterator]=function(){return e}),e}function a(t){this.map={},t instanceof a?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function t(e){var t=new FileReader,n=s(t);return t.readAsArrayBuffer(e),n}function n(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(d&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(g&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(f&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(y&&d&&v(e))this._bodyArrayBuffer=n(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y||!ArrayBuffer.prototype.isPrototypeOf(e)&&!b(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=n(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(t)}),this.text=function(){var e,t,n=o(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,n=s(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var n,r=(t=t||{}).body;if(e instanceof c){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new a(t.headers)),this.method=(e=(n=t.method||this.method||"GET").toUpperCase(),-1<_.indexOf(e)?e:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function l(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(e=(t=e.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),n.append(decodeURIComponent(e),decodeURIComponent(t)))}),n}function h(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new a(t.headers),this.url=t.url||"",this._initBody(e)}var f,p,d,g,y,m,v,b,_,w;(Gt="undefined"!=typeof self?self:void 0).fetch||(f="URLSearchParams"in Gt,p="Symbol"in Gt&&"iterator"in Symbol,d="FileReader"in Gt&&"Blob"in Gt&&function(){try{return new Blob,!0}catch(e){return!1}}(),g="FormData"in Gt,(y="ArrayBuffer"in Gt)&&(m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},b=ArrayBuffer.isView||function(e){return e&&-1<m.indexOf(Object.prototype.toString.call(e))}),a.prototype.append=function(e,t){e=r(e),t=i(t);var n=this.map[e];this.map[e]=n?n+","+t:t},a.prototype.delete=function(e){delete this.map[r(e)]},a.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},a.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},a.prototype.set=function(e,t){this.map[r(e)]=i(t)},a.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},a.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),e(n)},a.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),e(t)},a.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),e(n)},p&&(a.prototype[Symbol.iterator]=a.prototype.entries),_=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],c.prototype.clone=function(){return new c(this,{body:this._bodyInit})},u.call(c.prototype),u.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},h.error=function(){var e=new h(null,{status:0,statusText:""});return e.type="error",e},w=[301,302,303,307,308],h.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new h(null,{status:t,headers:{location:e}})},Gt.Headers=a,Gt.Request=c,Gt.Response=h,Gt.fetch=function(n,o){return new Promise(function(r,e){var t=new c(n,o),i=new XMLHttpRequest;i.onload=function(){var n,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",n=new a,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":");(e=t.shift().trim())&&(t=t.join(":").trim(),n.append(e,t))}),n)};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new h(t,e))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.open(t.method,t.url,!0),"include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),"responseType"in i&&d&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},Gt.fetch.polyfill=!0);var E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function T(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}function I(e){try{return!!e()}catch(e){return!0}}function S(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function C(e){return j.call(e).slice(8,-1)}function A(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function k(e){return B(A(e))}function N(e){return"object"==typeof e?null!==e:"function"==typeof e}function D(e,t){if(!N(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!N(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!N(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!N(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function R(e,t){return K.call(e,t)}function O(e){return z?W.createElement(e):{}}function P(e){if(!N(e))throw TypeError(String(e)+" is not an object");return e}function x(t,n){try{J(L,t,n)}catch(e){L[t]=n}return n}var L=(Xt=function(e){return e&&e.Math==Math&&e})("object"==typeof globalThis&&globalThis)||Xt("object"==typeof window&&window)||Xt("object"==typeof self&&self)||Xt("object"==typeof E&&E)||function(){return this}()||Function("return this")(),M=!I(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),F={}.propertyIsEnumerable,U=Object.getOwnPropertyDescriptor,q={f:U&&!F.call({1:2},1)?function(e){return!!(e=U(this,e))&&e.enumerable}:F},j={}.toString,V="".split,B=I(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==C(e)?V.call(e,""):Object(e)}:Object,K={}.hasOwnProperty,W=L.document,z=N(W)&&N(W.createElement),H=!M&&!I(function(){return 7!=Object.defineProperty(O("div"),"a",{get:function(){return 7}}).a}),G=Object.getOwnPropertyDescriptor,Q={f:M?G:function(e,t){if(e=k(e),t=D(t,!0),H)try{return G(e,t)}catch(e){}if(R(e,t))return S(!q.f.call(e,t),e[t])}},Y=Object.defineProperty,X={f:M?Y:function(e,t,n){if(P(e),t=D(t,!0),P(n),H)try{return Y(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},J=M?function(e,t,n){return X.f(e,t,S(1,n))}:function(e,t,n){return e[t]=n,e},$=L[$t="__core-js_shared__"]||x($t,{}),Z=Function.toString;function ee(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++pe+de).toString(36)}"function"!=typeof $.inspectSource&&($.inspectSource=function(e){return Z.call(e)});var te,ne,re,ie,oe,ae,se,ue,ce=$.inspectSource,le="function"==typeof(Tt=L.WeakMap)&&/native code/.test(ce(Tt)),he=!1,fe=T(function(e){(e.exports=function(e,t){return $[e]||($[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.7.0",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),pe=0,de=Math.random(),ge=fe("keys"),ye=function(e){return ge[e]||(ge[e]=ee(e))},me={},ve=L.WeakMap;function be(e){return"function"==typeof e?e:void 0}function _e(e,t){return arguments.length<2?be(Oe[e])||be(L[e]):Oe[e]&&Oe[e][t]||L[e]&&L[e][t]}function we(e){return isNaN(e=+e)?0:(0<e?xe:Pe)(e)}function Ee(e){return 0<e?Le(we(e),9007199254740991):0}function Te(e,t){var n,r=k(e),i=0,o=[];for(n in r)!R(me,n)&&R(r,n)&&o.push(n);for(;t.length>i;)R(r,n=t[i++])&&(~Ue(o,n)||o.push(n));return o}function Ie(e,t){for(var n=Ke(t),r=X.f,i=Q.f,o=0;o<n.length;o++){var a=n[o];R(e,a)||r(e,a,i(t,a))}}function Se(e,t){var n,r,i,o=e.target,a=e.global,s=e.stat,u=a?L:s?L[o]||x(o,{}):(L[o]||{}).prototype;if(u)for(n in t){if(r=t[n],i=e.noTargetGet?(i=Xe(u,n))&&i.value:u[n],!Ye(a?n:o+(s?".":"#")+n,e.forced)&&void 0!==i){if(typeof r==typeof i)continue;Ie(r,i)}(e.sham||i&&i.sham)&&J(r,"sham",!0),Re(u,n,r,e)}}function Ce(e){return Object(A(e))}function Ae(){}function ke(e){return"<script>"+e+"<\/script>"}se=le?(te=$.state||($.state=new ve),ne=te.get,re=te.has,ie=te.set,oe=function(e,t){return t.facade=e,ie.call(te,e,t),t},ae=function(e){return ne.call(te,e)||{}},function(e){return re.call(te,e)}):(ue=ye("state"),me[ue]=!0,oe=function(e,t){return t.facade=e,J(e,ue,t),t},ae=function(e){return R(e,ue)?e[ue]:{}},function(e){return R(e,ue)});var Ne,De={set:oe,get:ae,has:se,enforce:function(e){return se(e)?ae(e):oe(e,{})},getterFor:function(n){return function(e){var t;if(!N(e)||(t=ae(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}},Re=T(function(e){var t=De.get,s=De.enforce,u=String(String).split("String");(e.exports=function(e,t,n,r){var i=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||R(n,"name")||J(n,"name",t),(r=s(n)).source||(r.source=u.join("string"==typeof t?t:""))),e!==L?(i?!a&&e[t]&&(o=!0):delete e[t],o?e[t]=n:J(e,t,n)):o?e[t]=n:x(t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||ce(this)})}),Oe=L,Pe=Math.ceil,xe=Math.floor,Le=Math.min,Me=Math.max,Fe=Math.min,Ue=((Gt=function(s){return function(e,t,n){var r,i=k(e),o=Ee(i.length),a=(e=o,(n=we(n=n))<0?Me(n+e,0):Fe(n,e));if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}})(!0),Gt(!1)),qe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],je=qe.concat("length","prototype"),Ve={f:Object.getOwnPropertyNames||function(e){return Te(e,je)}},Be={f:Object.getOwnPropertySymbols},Ke=_e("Reflect","ownKeys")||function(e){var t=Ve.f(P(e)),n=Be.f;return n?t.concat(n(e)):t},We=/#|\.prototype\./,ze=(Xt=function(e,t){return(e=He[ze(e)])==Qe||e!=Ge&&("function"==typeof t?I(t):!!t)}).normalize=function(e){return String(e).replace(We,".").toLowerCase()},He=Xt.data={},Ge=Xt.NATIVE="N",Qe=Xt.POLYFILL="P",Ye=Xt,Xe=Q.f,E=!I(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Je=ye("IE_PROTO"),$e=Object.prototype,Ze=E?Object.getPrototypeOf:function(e){return R(e=Ce(e),Je)?e[Je]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?$e:null},et=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return P(e),function(){if(!N(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(),r?n.call(e,t):e.__proto__=t,e}}():void 0),tt=Object.keys||function(e){return Te(e,qe)},nt=M?Object.defineProperties:function(e,t){P(e);for(var n,r=tt(t),i=r.length,o=0;o<i;)X.f(e,n=r[o++],t[n]);return e},rt=_e("document","documentElement"),it="prototype",ot=ye("IE_PROTO"),at=function(){try{Ne=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e;at=Ne?function(e){e.write(ke("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Ne):((e=O("iframe")).style.display="none",rt.appendChild(e),e.src=String("javascript:"),(e=e.contentWindow.document).open(),e.write(ke("document.F=Object")),e.close(),e.F);for(var t=qe.length;t--;)delete at[it][qe[t]];return at()};function st(e){return R(pt,e)||(ft&&R(dt,e)?pt[e]=dt[e]:pt[e]=gt("Symbol."+e)),pt[e]}function ut(e){return void 0!==e&&(yt.Array===e||vt[mt]===e)}function ct(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function lt(r,i,e){if(ct(r),void 0===i)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}me[ot]=!0;var ht=Object.create||function(e,t){var n;return null!==e?(Ae[it]=P(e),n=new Ae,Ae[it]=null,n[ot]=e):n=at(),void 0===t?n:nt(n,t)},ft=!!Object.getOwnPropertySymbols&&!I(function(){return!String(Symbol())}),F=ft&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,pt=fe("wks"),dt=L.Symbol,gt=F?dt:dt&&dt.withoutSetter||ee,yt={},mt=st("iterator"),vt=Array.prototype;function bt(e){if(null!=e)return e[At]||e["@@iterator"]||yt[Ct(e)]}function _t(e){var t=e.return;return void 0!==t&&P(t.call(e)).value}function wt(e,t){this.stopped=e,this.result=t}function Et(e,t,n){function r(e){return o&&_t(o),new wt(!0,e)}function i(e){return f?(P(e),d?g(e[0],e[1],r):g(e[0],e[1])):d?g(e,r):g(e)}var o,a,s,u,c,l,h=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),g=lt(t,h,1+f+d);if(p)o=e;else{if("function"!=typeof(p=bt(e)))throw TypeError("Target is not iterable");if(ut(p)){for(a=0,s=Ee(e.length);a<s;a++)if((u=i(e[a]))&&u instanceof wt)return u;return new wt(!1)}o=p.call(e)}for(c=o.next;!(l=c.call(o)).done;){try{u=i(l.value)}catch(e){throw _t(o),e}if("object"==typeof u&&u&&u instanceof wt)return u}return new wt(!1)}($t={})[st("toStringTag")]="z";var Tt="[object z]"===String($t),It=st("toStringTag"),St="Arguments"==C(function(){return arguments}()),Ct=Tt?C:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),It))?e:St?C(t):"Object"==(e=C(t))&&"function"==typeof t.callee?"Arguments":e},At=st("iterator"),kt=function(e,t){var n=this;return n instanceof kt?(et&&(n=et(new Error(void 0),Ze(n))),void 0!==t&&J(n,"message",String(t)),Et(e,(t=[]).push,{that:t}),J(n,"errors",t),n):new kt(e,t)};function Nt(e,t,n){for(var r in t)Re(e,r,t[r],n);return e}function Dt(e,t,n){e&&!R(e=n?e:e.prototype,Lt)&&xt(e,Lt,{configurable:!0,value:t})}function Rt(e){var t=_e(e),e=X.f;M&&t&&!t[Mt]&&e(t,Mt,{configurable:!0,get:function(){return this}})}function Ot(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}kt.prototype=ht(Error.prototype,{constructor:S(5,kt),message:S(5,""),name:S(5,"AggregateError")}),Se({global:!0},{AggregateError:kt}),le=Tt?{}.toString:function(){return"[object "+Ct(this)+"]"},Tt||Re(Object.prototype,"toString",le,{unsafe:!0});var Pt=L.Promise,xt=X.f,Lt=st("toStringTag"),Mt=st("species"),Ft=st("iterator"),Ut=!1;try{var qt=0,jt={next:function(){return{done:!!qt++}},return:function(){Ut=!0}};jt[Ft]=function(){return this},Array.from(jt,function(){throw 2})}catch(Ga){}function Vt(e,t){if(!t&&!Ut)return!1;var n=!1;try{var r={};r[Ft]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}function Bt(e,t){var n;return void 0===(e=P(e).constructor)||null==(n=P(e)[Ht])?t:ct(n)}function Kt(e){var t;tn.hasOwnProperty(e)&&(t=tn[e],delete tn[e],t())}function Wt(e){return function(){Kt(e)}}var zt,Ht=st("species"),ve=_e("navigator","userAgent")||"",Gt=/(iphone|ipod|ipad).*applewebkit/i.test(ve),Qt="process"==C(L.process),Yt=L.location,Xt=L.setImmediate,E=L.clearImmediate,Jt=L.process,$t=L.MessageChannel,Zt=L.Dispatch,en=0,tn={},nn="onreadystatechange",Tt=function(e){Kt(e.data)},le=function(e){L.postMessage(e+"",Yt.protocol+"//"+Yt.host)};Xt&&E||(Xt=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return tn[++en]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},zt(en),en},E=function(e){delete tn[e]},Qt?zt=function(e){Jt.nextTick(Wt(e))}:Zt&&Zt.now?zt=function(e){Zt.now(Wt(e))}:$t&&!Gt?(fn=($t=new $t).port2,$t.port1.onmessage=Tt,zt=lt(fn.postMessage,fn,1)):L.addEventListener&&"function"==typeof postMessage&&!L.importScripts&&Yt&&"file:"!==Yt.protocol&&!I(le)?(zt=le,L.addEventListener("message",Tt,!1)):zt=nn in O("script")?function(e){rt.appendChild(O("script"))[nn]=function(){rt.removeChild(this),Kt(e)}}:function(e){setTimeout(Wt(e),0)});var rn,on,an,sn,un,cn,ln,hn,fn={set:Xt,clear:E},le=Q.f,pn=fn.set,Tt=L.MutationObserver||L.WebKitMutationObserver,Xt=L.document,dn=L.process,E=L.Promise;function gn(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=ct(n),this.reject=ct(r)}function yn(e,t){return P(e),N(t)&&t.constructor===e?t:((0,(e=bn.f(e)).resolve)(t),e.promise)}function mn(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}(le=(le=le(L,"queueMicrotask"))&&le.value)||(rn=function(){var e,t;for(Qt&&(e=dn.domain)&&e.exit();on;){t=on.fn,on=on.next;try{t()}catch(e){throw on?sn():an=void 0,e}}an=void 0,e&&e.enter()},sn=!Gt&&!Qt&&Tt&&Xt?(un=!0,cn=Xt.createTextNode(""),new Tt(rn).observe(cn,{characterData:!0}),function(){cn.data=un=!un}):E&&E.resolve?(ln=E.resolve(void 0),hn=ln.then,function(){hn.call(ln,rn)}):Qt?function(){dn.nextTick(rn)}:function(){pn.call(L,rn)});var vn=le||function(e){e={fn:e,next:void 0},an&&(an.next=e),on||(on=e,sn()),an=e},bn={f:function(e){return new gn(e)}};function _n(e){var t;return!(!N(e)||"function"!=typeof(t=e.then))&&t}function wn(h,f){var p;h.notified||(h.notified=!0,p=h.reactions,vn(function(){for(var e=h.value,t=1==h.state,n=0;p.length>n;){var r,i,o,a=p[n++],s=t?a.ok:a.fail,u=a.resolve,c=a.reject,l=a.domain;try{s?(t||(2===h.rejection&&Yn(h),h.rejection=1),!0===s?r=e:(l&&l.enter(),r=s(e),l&&(l.exit(),o=!0)),r===a.promise?c(Fn("Promise-chain cycle")):(i=_n(r))?i.call(r,u,c):u(r)):c(e)}catch(e){l&&!o&&l.exit(),c(e)}}h.reactions=[],h.notified=!1,f&&!h.rejection&&Gn(h)}))}function En(e,t,n){var r,i;Kn?((r=Un.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),L.dispatchEvent(r)):r={promise:t,reason:n},!Wn&&(i=L["on"+e])?i(r):e===zn&&function(e,t){var n=L.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)}function Tn(t,n,r){return function(e){t(n,e,r)}}function In(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,wn(e,!0))}(le=(le=(le=L.process)&&le.versions)&&le.v8)?Wr=(Hn=le.split("."))[0]+Hn[1]:ve&&(!(Hn=ve.match(/Edge\/(\d+)/))||74<=Hn[1])&&(Hn=ve.match(/Chrome\/(\d+)/))&&(Wr=Hn[1]);var Sn,Cn,An,kn,Nn=Wr&&+Wr,Dn=fn.set,Rn=st("species"),On="Promise",Pn=De.get,xn=De.set,Ln=De.getterFor(On),Mn=Pt,Fn=L.TypeError,Un=L.document,qn=L.process,jn=_e("fetch"),Vn=bn.f,Bn=Vn,Kn=!!(Un&&Un.createEvent&&L.dispatchEvent),Wn="function"==typeof PromiseRejectionEvent,zn="unhandledrejection",Hn=(ve=Ye(On,function(){if(ce(Mn)===String(Mn)){if(66===Nn)return!0;if(!Qt&&!Wn)return!0}if(51<=Nn&&/native code/.test(Mn))return!1;function e(e){e(function(){},function(){})}var t=Mn.resolve(1);return(t.constructor={})[Rn]=e,!(t.then(function(){})instanceof e)}))||!Vt(function(e){Mn.all(e).catch(function(){})}),Gn=function(r){Dn.call(L,function(){var e,t=r.facade,n=r.value;if(Qn(r)&&(e=mn(function(){Qt?qn.emit("unhandledRejection",n,t):En(zn,t,n)}),r.rejection=Qt||Qn(r)?2:1,e.error))throw e.value})},Qn=function(e){return 1!==e.rejection&&!e.parent},Yn=function(t){Dn.call(L,function(){var e=t.facade;Qt?qn.emit("rejectionHandled",e):En("rejectionhandled",e,t.value)})},Xn=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw Fn("Promise can't be resolved itself");var r=_n(e);r?vn(function(){var t={done:!1};try{r.call(e,Tn(Xn,t,n),Tn(In,t,n))}catch(e){In(t,e,n)}}):(n.value=e,n.state=1,wn(n,!1))}catch(e){In({done:!1},e,n)}}};ve&&(Mn=function(e){Ot(this,Mn,On),ct(e),Sn.call(this);var t=Pn(this);try{e(Tn(Xn,t),Tn(In,t))}catch(e){In(t,e)}},(Sn=function(){xn(this,{type:On,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Nt(Mn.prototype,{then:function(e,t){var n=Ln(this),r=Vn(Bt(this,Mn));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Qt?qn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&wn(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Cn=function(){var e=new Sn,t=Pn(e);this.promise=e,this.resolve=Tn(Xn,t),this.reject=Tn(In,t)},bn.f=Vn=function(e){return e===Mn||e===An?new Cn:Bn(e)},"function"==typeof Pt&&(kn=Pt.prototype.then,Re(Pt.prototype,"then",function(e,t){var n=this;return new Mn(function(e,t){kn.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof jn&&Se({global:!0,enumerable:!0,forced:!0},{fetch:function(){return yn(Mn,jn.apply(L,arguments))}}))),Se({global:!0,wrap:!0,forced:ve},{Promise:Mn}),Dt(Mn,On,!1),Rt(On),An=_e(On),Se({target:On,stat:!0,forced:ve},{reject:function(e){var t=Vn(this);return t.reject.call(void 0,e),t.promise}}),Se({target:On,stat:!0,forced:ve},{resolve:function(e){return yn(this,e)}}),Se({target:On,stat:!0,forced:Hn},{all:function(e){var s=this,t=Vn(s),u=t.resolve,c=t.reject,n=mn(function(){var r=ct(s.resolve),i=[],o=0,a=1;Et(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(s,e).then(function(e){n||(n=!0,i[t]=e,--a||u(i))},c)}),--a||u(i)});return n.error&&c(n.value),t.promise},race:function(e){var n=this,r=Vn(n),i=r.reject,t=mn(function(){var t=ct(n.resolve);Et(e,function(e){t.call(n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}}),Se({target:"Promise",stat:!0},{allSettled:function(e){var s=this,t=bn.f(s),u=t.resolve,n=t.reject,r=mn(function(){var r=ct(s.resolve),i=[],o=0,a=1;Et(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(s,e).then(function(e){n||(n=!0,i[t]={status:"fulfilled",value:e},--a||u(i))},function(e){n||(n=!0,i[t]={status:"rejected",reason:e},--a||u(i))})}),--a||u(i)});return r.error&&n(r.value),t.promise}});var Jn="No one promise resolved";function $n(){return this}function Zn(){return this}function er(e,t,n,r,i,o,a){function s(e){if(e===i&&g)return g;if(!rr&&e in p)return p[e];switch(e){case"keys":case or:case ar:return function(){return new n(this,e)}}return function(){return new n(this)}}var u;h=t,h+=" Iterator",(u=n).prototype=ht(tr,{next:S(1,r)}),Dt(u,h,!1),yt[h]=$n;var c,l,h=t+" Iterator",f=!1,p=e.prototype,d=p[ir]||p["@@iterator"]||i&&p[i],g=!rr&&d||s(i);if((r="Array"==t&&p.entries||d)&&(e=Ze(r.call(new e)),nr!==Object.prototype&&e.next&&(Ze(e)!==nr&&(et?et(e,nr):"function"!=typeof e[ir]&&J(e,ir,Zn)),Dt(e,h,!0))),i==or&&d&&d.name!==or&&(f=!0,g=function(){return d.call(this)}),p[ir]!==g&&J(p,ir,g),yt[t]=g,i)if(c={values:s(or),keys:o?g:s("keys"),entries:s(ar)},a)for(l in c)!rr&&!f&&l in p||Re(p,l,c[l]);else Se({target:t,proto:!0,forced:rr||f},c);return c}Se({target:"Promise",stat:!0},{any:function(e){var u=this,t=bn.f(u),c=t.resolve,l=t.reject,n=mn(function(){var r=ct(u.resolve),i=[],o=0,a=1,s=!1;Et(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(u,e).then(function(e){n||s||(s=!0,c(e))},function(e){n||s||(n=!0,i[t]=e,--a||l(new(_e("AggregateError"))(i,Jn)))})}),--a||l(new(_e("AggregateError"))(i,Jn))});return n.error&&l(n.value),t.promise}}),Se({target:"Promise",proto:!0,real:!0,forced:Wr=!!Pt&&I(function(){Pt.prototype.finally.call({then:function(){}},function(){})})},{finally:function(t){var n=Bt(this,_e("Promise")),e="function"==typeof t;return this.then(e?function(e){return yn(n,t()).then(function(){return e})}:t,e?function(e){return yn(n,t()).then(function(){throw e})}:t)}}),"function"!=typeof Pt||Pt.prototype.finally||Re(Pt.prototype,"finally",_e("Promise").prototype.finally),ve={codeAt:(fn=function(o){return function(e,t){var n,r=String(A(e)),i=we(t),e=r.length;return i<0||e<=i?o?"":void 0:(t=r.charCodeAt(i))<55296||56319<t||i+1===e||(n=r.charCodeAt(i+1))<56320||57343<n?o?r.charAt(i):t:o?r.slice(i,i+2):n-56320+(t-55296<<10)+65536}})(!1),charAt:fn(!0)},Hn=st("iterator"),Wr=!1,[].keys&&("next"in(dr=[].keys())?(Kr=Ze(Ze(dr)))!==Object.prototype&&(Pr=Kr):Wr=!0),null==Pr&&(Pr={}),R(Pr,Hn)||J(Pr,Hn,function(){return this});var tr=(fn={IteratorPrototype:Pr,BUGGY_SAFARI_ITERATORS:Wr}).IteratorPrototype,nr=fn.IteratorPrototype,rr=fn.BUGGY_SAFARI_ITERATORS,ir=st("iterator"),or="values",ar="entries",sr=ve.charAt,ur="String Iterator",cr=De.set,lr=De.getterFor(ur);er(String,"String",function(e){cr(this,{type:ur,string:String(e),index:0})},function(){var e=lr(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(n=sr(t,n),e.index+=n.length,{value:n,done:!1})});var hr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},fr=st("unscopables"),pr=Array.prototype;null==pr[fr]&&X.f(pr,fr,{configurable:!0,value:ht(null)});var dr=function(e){pr[fr][e]=!0},gr="Array Iterator",yr=De.set,mr=De.getterFor(gr),vr=er(Array,"Array",function(e,t){yr(this,{type:gr,target:k(e),index:0,kind:t})},function(){var e=mr(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");yt.Arguments=yt.Array,dr("keys"),dr("values"),dr("entries");var br,_r=st("iterator"),wr=st("toStringTag"),Er=vr.values;for(br in hr){var Tr=L[br],Ir=Tr&&Tr.prototype;if(Ir){if(Ir[_r]!==Er)try{J(Ir,_r,Er)}catch(Ga){Ir[_r]=Er}if(Ir[wr]||J(Ir,wr,br),hr[br])for(var Sr in vr)if(Ir[Sr]!==vr[Sr])try{J(Ir,Sr,vr[Sr])}catch(Ga){Ir[Sr]=vr[Sr]}}}function Cr(e,t){var n;return kr(e)&&("function"==typeof(n=e.constructor)&&(n===Array||kr(n.prototype))||N(n)&&null===(n=n[Nr]))&&(n=void 0),new(void 0===n?Array:n)(0===t?0:t)}function Ar(e){throw e}Oe.Promise,Se({target:"Promise",stat:!0},{try:function(e){var t=bn.f(this);return((e=mn(e)).error?t.reject:t.resolve)(e.value),t.promise}});var kr=Array.isArray||function(e){return"Array"==C(e)},Nr=st("species"),Dr=[].push,Hn={forEach:(Kr=function(f){var p=1==f,d=2==f,g=3==f,y=4==f,m=6==f,v=5==f||m;return function(e,t,n,r){for(var i,o,a=Ce(e),s=B(a),u=lt(t,n,3),c=Ee(s.length),l=0,r=r||Cr,h=p?r(e,c):d?r(e,0):void 0;l<c;l++)if((v||l in s)&&(o=u(i=s[l],l,a),f))if(p)h[l]=o;else if(o)switch(f){case 3:return!0;case 5:return i;case 6:return l;case 2:Dr.call(h,i)}else if(y)return!1;return m?-1:g||y?y:h}})(0),map:Kr(1),filter:Kr(2),some:Kr(3),every:Kr(4),find:Kr(5),findIndex:Kr(6)},Rr=Object.defineProperty,Or={},Pr=function(e,t){if(R(Or,e))return Or[e];var n=[][e],r=!!R(t=t||{},"ACCESSORS")&&t.ACCESSORS,i=R(t,0)?t[0]:Ar,o=R(t,1)?t[1]:void 0;return Or[e]=!!n&&!I(function(){if(r&&!M)return 1;var e={length:-1};r?Rr(e,1,{enumerable:!0,get:Ar}):e[1]=1,n.call(e,i,o)})},xr=Hn.find,Lr=!0,fn=Pr(Wr="find");Wr in[]&&Array(1)[Wr](function(){Lr=!1}),Se({target:"Array",proto:!0,forced:Lr||!fn},{find:function(e,t){return xr(this,e,1<arguments.length?t:void 0)}}),dr(Wr);var Mr=Function.call,Fr=((ve=function(e,t,n){return lt(Mr,L[e].prototype[t],n)})("Array","find"),Hn.findIndex),Ur=!0,fn=Pr(Kr="findIndex");function qr(e,t,n){(t=D(t))in e?X.f(e,t,S(0,n)):e[t]=n}Kr in[]&&Array(1)[Kr](function(){Ur=!1}),Se({target:"Array",proto:!0,forced:Ur||!fn},{findIndex:function(e,t){return Fr(this,e,1<arguments.length?t:void 0)}}),dr(Kr),ve("Array","findIndex"),Se({target:"Array",stat:!0,forced:Wr=!Vt(function(e){Array.from(e)})},{from:function(e,t,n){var r,i,o,a,s,u=Ce(e),c="function"==typeof this?this:Array,l=1<(e=arguments.length)?t:void 0,h=void 0!==l,t=bt(u),f=0;if(h&&(l=lt(l,2<e?n:void 0,2)),null==t||c==Array&&ut(t))for(i=new c(r=Ee(u.length));f<r;f++)qr(i,f,h?l(u[f],f):u[f]);else for(s=(a=t.call(u)).next,i=new c;!(o=s.call(a)).done;f++)qr(i,f,h?function(e,t,n){try{return t(P(n)[0],n[1])}catch(t){throw _t(e),t}}(a,l,[o.value,f]):o.value);return i.length=f,i}}),Oe.Array.from;var jr,Vr=Hn.some,fn=!!(jr=[].some)&&I(function(){jr.call(null,function(){throw 1},1)}),dr=Pr("some");Se({target:"Array",proto:!0,forced:!fn||!dr},{some:function(e,t){return Vr(this,e,1<arguments.length?t:void 0)}}),ve("Array","some");var Br,Kr="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Wr=X.f,le=L.Int8Array,zr=le&&le.prototype,fn=(Pr=L.Uint8ClampedArray)&&Pr.prototype,Hr=le&&Ze(le),Gr=zr&&Ze(zr),Pr=((dr=Object.prototype).isPrototypeOf,st("toStringTag")),Qr=ee("TYPED_ARRAY_TAG"),Yr=Kr&&!!et&&"Opera"!==Ct(L.opera),Kr=!1,Xr={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(Br in Xr)L[Br]||(Yr=!1);if((!Yr||"function"!=typeof Hr||Hr===Function.prototype)&&(Hr=function(){throw TypeError("Incorrect invocation")},Yr))for(Br in Xr)L[Br]&&et(L[Br],Hr);if((!Yr||!Gr||Gr===dr)&&(Gr=Hr.prototype,Yr))for(Br in Xr)L[Br]&&et(L[Br].prototype,Gr);if(Yr&&Ze(fn)!==Gr&&et(fn,Gr),M&&!R(Gr,Pr))for(Br in Kr=!0,Wr(Gr,Pr,{get:function(){return N(this)?this[Qr]:void 0}}),Xr)L[Br]&&J(L[Br],Qr,Br);var fn=function(e){if(N(t=e)&&R(Xr,Ct(t)))return e;var t;throw TypeError("Target is not a typed array")},Wr=function(e,t,n){if(M){if(n)for(var r in Xr){var i=L[r];i&&R(i.prototype,e)&&delete i.prototype[e]}Gr[e]&&!n||Re(Gr,e,!n&&Yr&&zr[e]||t)}},Pr=st("iterator"),Kr=L.Uint8Array,Jr=vr.values,$r=vr.keys,Zr=vr.entries,ei=fn,fn=Wr,Kr=!!(Wr=Kr&&Kr.prototype[Pr])&&("values"==Wr.name||null==Wr.name),Wr=function(){return Jr.call(ei(this))};fn("entries",function(){return Zr.call(ei(this))}),fn("keys",function(){return $r.call(ei(this))}),fn("values",Wr,!Kr),fn(Pr,Wr,!Kr);var ti=Object.assign,ni=Object.defineProperty,Wr=!ti||I(function(){if(M&&1!==ti({b:1},ti(ni({},"a",{enumerable:!0,get:function(){ni(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return 1;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=ti({},e)[n]||tt(ti({},t)).join("")!=r})?function(e){for(var t=Ce(e),n=arguments.length,r=1,i=Be.f,o=q.f;r<n;)for(var a,s=B(arguments[r++]),u=i?tt(s).concat(i(s)):tt(s),c=u.length,l=0;l<c;)a=u[l++],M&&!o.call(s,a)||(t[a]=s[a]);return t}:ti;Se({target:"Object",stat:!0,forced:Object.assign!==Wr},{assign:Wr}),Oe.Object.assign;var ri=q.f,ii=(Wr={entries:(Kr=function(s){return function(e){for(var t,n=k(e),r=tt(n),i=r.length,o=0,a=[];o<i;)t=r[o++],M&&!ri.call(n,t)||a.push(s?[t,n[t]]:n[t]);return a}})(!0),values:Kr(!1)}).entries;Se({target:"Object",stat:!0},{entries:function(e){return ii(e)}}),Oe.Object.entries;var oi=Wr.values;function ai(e){if(N(t=e)&&(void 0!==(n=t[si])?n:"RegExp"==C(t)))throw TypeError("The method doesn't accept regular expressions");var t,n;return e}Se({target:"Object",stat:!0},{values:function(e){return oi(e)}}),Oe.Object.values;var si=st("match"),ui=st("match");Se({target:"String",proto:!0,forced:!(Kr=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[ui]=!1,"/./"[t](n)}catch(e){}}return!1})("includes")},{includes:function(e,t){return!!~String(A(this)).indexOf(ai(e),1<arguments.length?t:void 0)}}),ve("String","includes");var Wr=Q.f,ci="".startsWith,li=Math.min,hi=!((Kr=Kr("startsWith"))||!(hi=Wr(String.prototype,"startsWith"))||hi.writable);Se({target:"String",proto:!0,forced:!hi&&!Kr},{startsWith:function(e,t){var n=String(A(this));return ai(e),t=Ee(li(1<arguments.length?t:void 0,n.length)),e=String(e),ci?ci.call(n,e,t):n.slice(t,t+e.length)===e}}),ve("String","startsWith"),Se({target:"String",proto:!0},{repeat:"".repeat||function(e){var t=String(A(this)),n="",r=we(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}),ve("String","repeat");var fi=st("species"),pi=st("isConcatSpreadable"),di=9007199254740991,gi="Maximum allowed index exceeded",Kr=51<=Nn||!I(function(){var e=[];return e[pi]=!1,e.concat()[0]!==e}),ve=51<=Nn||!I(function(){var e=[];return(e.constructor={})[fi]=function(){return{foo:1}},1!==e.concat(Boolean).foo});function yi(e){var t=Oe.Symbol||(Oe.Symbol={});R(t,e)||Si(t,e,{value:Ii.f(e)})}function mi(e,t){var n=qi[e]=ht(Pi[Ni]);return Di(n,{type:ki,tag:e,description:t}),M||(n.description=t),n}function vi(t,e){P(t);var n=k(e),e=tt(n).concat(_i(n));return Ci(e,function(e){M&&!bi.call(n,e)||Hi(t,e,n[e])}),t}Se({target:"Array",proto:!0,forced:!Kr||!ve},{concat:function(){for(var e,t,n,r=Ce(this),i=Cr(r,0),o=0,a=-1,s=arguments.length;a<s;a++)if(function(e){if(N(e)){var t=e[pi];return void 0!==t?t:kr(e)}}(n=-1===a?r:arguments[a])){if(t=Ee(n.length),di<o+t)throw TypeError(gi);for(e=0;e<t;e++,o++)e in n&&qr(i,o,n[e])}else{if(di<=o)throw TypeError(gi);qr(i,o++,n)}return i.length=o,i}});function bi(e){var t=D(e,!0),e=Ui.call(this,t);return!(this===Oi&&R(qi,t)&&!R(ji,t))&&(!(e||!R(this,t)||!R(qi,t)||R(this,Ai)&&this[Ai][t])||e)}function _i(e){var t=e===Oi,e=Fi(t?ji:k(e)),n=[];return Ci(e,function(e){!R(qi,e)||t&&!R(Oi,e)||n.push(qi[e])}),n}var wi=Ve.f,Ei={}.toString,Ti="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ve={f:function(e){return Ti&&"[object Window]"==Ei.call(e)?function(e){try{return wi(e)}catch(e){return Ti.slice()}}(e):wi(k(e))}},Ii={f:st},Si=X.f,Ci=Hn.forEach,Ai=ye("hidden"),ki="Symbol",Ni="prototype",Hn=st("toPrimitive"),Di=De.set,Ri=De.getterFor(ki),Oi=Object[Ni],Pi=L.Symbol,xi=_e("JSON","stringify"),Li=Q.f,Mi=X.f,Fi=ve.f,Ui=q.f,qi=fe("symbols"),ji=fe("op-symbols"),Vi=fe("string-to-symbol-registry"),Bi=fe("symbol-to-string-registry"),ye=fe("wks"),Ki=!(fe=L.QObject)||!fe[Ni]||!fe[Ni].findChild,Wi=M&&I(function(){return 7!=ht(Mi({},"a",{get:function(){return Mi(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=Li(Oi,t);r&&delete Oi[t],Mi(e,t,n),r&&e!==Oi&&Mi(Oi,t,r)}:Mi,zi=F?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Pi},Hi=function(e,t,n){return e===Oi&&Hi(ji,t,n),P(e),t=D(t,!0),P(n),R(qi,t)?(n.enumerable?(R(e,Ai)&&e[Ai][t]&&(e[Ai][t]=!1),n=ht(n,{enumerable:S(0,!1)})):(R(e,Ai)||Mi(e,Ai,S(1,{})),e[Ai][t]=!0),Wi(e,t,n)):Mi(e,t,n)},fe=function(e,t){var n=k(e),e=D(t,!0);if(n!==Oi||!R(qi,e)||R(ji,e))return!(t=Li(n,e))||!R(qi,e)||R(n,Ai)&&n[Ai][e]||(t.enumerable=!0),t},F=function(e){var e=Fi(k(e)),t=[];return Ci(e,function(e){R(qi,e)||R(me,e)||t.push(e)}),t};ft||(Re((Pi=function(e){if(this instanceof Pi)throw TypeError("Symbol is not a constructor");var t=ee(e=arguments.length&&void 0!==e?String(e):void 0),n=function(e){this===Oi&&n.call(ji,e),R(this,Ai)&&R(this[Ai],t)&&(this[Ai][t]=!1),Wi(this,t,S(1,e))};return M&&Ki&&Wi(Oi,t,{configurable:!0,set:n}),mi(t,e)})[Ni],"toString",function(){return Ri(this).tag}),Re(Pi,"withoutSetter",function(e){return mi(ee(e),e)}),q.f=bi,X.f=Hi,Q.f=fe,Ve.f=ve.f=F,Be.f=_i,Ii.f=function(e){return mi(st(e),e)},M&&(Mi(Pi[Ni],"description",{configurable:!0,get:function(){return Ri(this).description}}),Re(Oi,"propertyIsEnumerable",bi,{unsafe:!0}))),Se({global:!0,wrap:!0,forced:!ft,sham:!ft},{Symbol:Pi}),Ci(tt(ye),function(e){yi(e)}),Se({target:ki,stat:!0,forced:!ft},{for:function(e){var t=String(e);return R(Vi,t)?Vi[t]:(e=Pi(t),Vi[t]=e,Bi[e]=t,e)},keyFor:function(e){if(!zi(e))throw TypeError(e+" is not a symbol");if(R(Bi,e))return Bi[e]},useSetter:function(){Ki=!0},useSimple:function(){Ki=!1}}),Se({target:"Object",stat:!0,forced:!ft,sham:!M},{create:function(e,t){return void 0===t?ht(e):vi(ht(e),t)},defineProperty:Hi,defineProperties:vi,getOwnPropertyDescriptor:fe}),Se({target:"Object",stat:!0,forced:!ft},{getOwnPropertyNames:F,getOwnPropertySymbols:_i}),Se({target:"Object",stat:!0,forced:I(function(){Be.f(1)})},{getOwnPropertySymbols:function(e){return Be.f(Ce(e))}}),xi&&Se({target:"JSON",stat:!0,forced:oo=!ft||I(function(){var e=Pi();return"[null]"!=xi([e])||"{}"!=xi({a:e})||"{}"!=xi(Object(e))})},{stringify:function(e,t){for(var n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if((N(n=t)||void 0!==e)&&!zi(e))return kr(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!zi(t))return t}),r[1]=t,xi.apply(null,r)}}),Pi[Ni][Hn]||J(Pi[Ni],Hn,Pi[Ni].valueOf),Dt(Pi,ki),me[Ai]=!0,yi("asyncIterator");var Gi,Qi,Yi,Xi,Ji,fe=X.f,$i=L.Symbol;!M||"function"!=typeof $i||"description"in $i.prototype&&void 0===$i().description||(Gi={},Ie(Qi=function(e){var t=arguments.length<1||void 0===e?void 0:String(e),e=this instanceof Qi?new $i(t):void 0===t?$i():$i(t);return""===t&&(Gi[e]=!0),e},$i),(uo=Qi.prototype=$i.prototype).constructor=Qi,Yi=uo.toString,Xi="Symbol(test)"==String($i("test")),Ji=/^Symbol\((.*)\)[^)]+$/,fe(uo,"description",{configurable:!0,get:function(){var e=N(this)?this.valueOf():this,t=Yi.call(e);return R(Gi,e)?"":""===(t=Xi?t.slice(7,-1):t.replace(Ji,"$1"))?void 0:t}}),Se({global:!0,forced:!0},{Symbol:Qi})),yi("hasInstance"),yi("isConcatSpreadable"),yi("iterator"),yi("match"),yi("matchAll"),yi("replace"),yi("search"),yi("species"),yi("split"),yi("toPrimitive"),yi("toStringTag"),yi("unscopables"),Dt(L.JSON,"JSON",!0),Dt(Math,"Math",!0),Se({global:!0},{Reflect:{}}),Dt(L.Reflect,"Reflect",!0),Oe.Symbol,yi("asyncDispose"),yi("dispose"),yi("observable"),yi("patternMatch"),yi("replaceAll"),Ii.f("iterator");var Zi=!I(function(){return Object.isExtensible(Object.preventExtensions({}))}),eo=T(function(e){function n(e){t(e,r,{value:{objectID:"O"+ ++i,weakData:{}}})}var t=X.f,r=ee("meta"),i=0,o=Object.isExtensible||function(){return!0},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!N(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!R(e,r)){if(!o(e))return"F";if(!t)return"E";n(e)}return e[r].objectID},getWeakData:function(e,t){if(!R(e,r)){if(!o(e))return!0;if(!t)return!1;n(e)}return e[r].weakData},onFreeze:function(e){return Zi&&a.REQUIRED&&o(e)&&!R(e,r)&&n(e),e}};me[r]=!0}),F=function(a,e,t){function n(e){var n=p[e];Re(p,e,"add"==e?function(e){return n.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(l&&!N(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return l&&!N(e)?void 0:n.call(this,0===e?0:e)}:"has"==e?function(e){return!(l&&!N(e))&&n.call(this,0===e?0:e)}:function(e,t){return n.call(this,0===e?0:e,t),this})}var r,i,o,s,u,c=-1!==a.indexOf("Map"),l=-1!==a.indexOf("Weak"),h=c?"set":"add",f=L[a],p=f&&f.prototype,d=f,g={};return Ye(a,"function"!=typeof f||!(l||p.forEach&&!I(function(){(new f).entries().next()})))?(d=t.getConstructor(e,a,c,h),eo.REQUIRED=!0):Ye(a,!0)&&(i=(r=new d)[h](l?{}:-0,1)!=r,o=I(function(){r.has(1)}),s=Vt(function(e){new f(e)}),u=!l&&I(function(){for(var e=new f,t=5;t--;)e[h](t,t);return!e.has(-0)}),s||(((d=e(function(e,t){Ot(e,d,a);var n,r,i,o=(o=new f,n=e,e=d,et&&"function"==typeof(r=n.constructor)&&r!==e&&N(i=r.prototype)&&i!==e.prototype&&et(o,i),o);return null!=t&&Et(t,o[h],{that:o,AS_ENTRIES:c}),o})).prototype=p).constructor=d),(o||u)&&(n("delete"),n("has"),c&&n("get")),(u||i)&&n(h),l&&p.clear&&delete p.clear),Se({global:!0,forced:(g[a]=d)!=f},g),Dt(d,a),l||t.setStrong(d,a,c),d},to=X.f,no=eo.fastKey,ro=De.set,io=De.getterFor,oo={getConstructor:function(e,n,r,i){function o(e,t,n){var r,i=u(e),o=a(e,t);return o?o.value=n:(i.last=o={index:r=no(t,!0),key:t,value:n,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=o),n&&(n.next=o),M?i.size++:e.size++,"F"!==r&&(i.index[r]=o)),e}function a(e,t){var n,r=u(e);if("F"!==(e=no(t)))return r.index[e];for(n=r.first;n;n=n.next)if(n.key==t)return n}var s=e(function(e,t){Ot(e,s,n),ro(e,{type:n,index:ht(null),first:void 0,last:void 0,size:0}),M||(e.size=0),null!=t&&Et(t,e[i],{that:e,AS_ENTRIES:r})}),u=io(n);return Nt(s.prototype,{clear:function(){for(var e=u(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,M?e.size=0:this.size=0},delete:function(e){var t,n=u(this),r=a(this,e);return r&&(t=r.next,e=r.previous,delete n.index[r.index],r.removed=!0,e&&(e.next=t),t&&(t.previous=e),n.first==r&&(n.first=t),n.last==r&&(n.last=e),M?n.size--:this.size--),!!r},forEach:function(e,t){for(var n,r=u(this),i=lt(e,1<arguments.length?t:void 0,3);n=n?n.next:r.first;)for(i(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(e){return!!a(this,e)}}),Nt(s.prototype,r?{get:function(e){return(e=a(this,e))&&e.value},set:function(e,t){return o(this,0===e?0:e,t)}}:{add:function(e){return o(this,e=0===e?0:e,e)}}),M&&to(s.prototype,"size",{get:function(){return u(this).size}}),s},setStrong:function(e,t,n){var r=t+" Iterator",i=io(t),o=io(r);er(e,t,function(e,t){ro(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),Rt(t)}};function ao(){for(var e,t=P(this),n=ct(t.delete),r=!0,i=0,o=arguments.length;i<o;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r}function so(e){return Map.prototype.entries.call(e)}Se({target:"Map",stat:!0},{from:Hn=(F("Map",function(t){return function(e){return t(this,arguments.length?e:void 0)}},oo),Oe.Map,function(e,t,n){var r,i,o,a=arguments.length,s=1<a?t:void 0;return ct(this),(t=void 0!==s)&&ct(s),null==e?new this:(r=[],t?(i=0,o=lt(s,2<a?n:void 0,2),Et(e,function(e){r.push(o(e,i++))})):Et(e,r.push,{that:r}),new this(r))})}),Se({target:"Map",stat:!0},{of:fe=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}}),Se({target:"Map",proto:!0,real:!0,forced:he},{deleteAll:function(){return ao.apply(this,arguments)}}),Se({target:"Map",proto:!0,real:!0,forced:he},{emplace:function(e,t){var n=P(this),t=n.has(e)&&"update"in t?t.update(n.get(e),e,n):t.insert(e,n);return n.set(e,t),t}}),Se({target:"Map",proto:!0,real:!0,forced:he},{every:function(e,t){var r=P(this),n=so(r),i=lt(e,1<arguments.length?t:void 0,3);return!Et(n,function(e,t,n){if(!i(t,e,r))return n()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Map",proto:!0,real:!0,forced:he},{filter:function(e,t){var n=P(this),r=so(n),i=lt(e,1<arguments.length?t:void 0,3),o=new(Bt(n,_e("Map"))),a=ct(o.set);return Et(r,function(e,t){i(t,e,n)&&a.call(o,e,t)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Se({target:"Map",proto:!0,real:!0,forced:he},{find:function(e,t){var r=P(this),n=so(r),i=lt(e,1<arguments.length?t:void 0,3);return Et(n,function(e,t,n){if(i(t,e,r))return n(t)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Se({target:"Map",proto:!0,real:!0,forced:he},{findKey:function(e,t){var r=P(this),n=so(r),i=lt(e,1<arguments.length?t:void 0,3);return Et(n,function(e,t,n){if(i(t,e,r))return n(e)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Se({target:"Map",stat:!0},{groupBy:function(e,n){var r=new this;ct(n);var i=ct(r.has),o=ct(r.get),a=ct(r.set);return Et(e,function(e){var t=n(e);i.call(r,t)?o.call(r,t).push(e):a.call(r,t,[e])}),r}}),Se({target:"Map",proto:!0,real:!0,forced:he},{includes:function(i){return Et(so(P(this)),function(e,t,n){if((r=t)===(t=i)||r!=r&&t!=t)return n();var r},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;ct(t);var r=ct(n.set);return Et(e,function(e){r.call(n,t(e),e)}),n}}),Se({target:"Map",proto:!0,real:!0,forced:he},{keyOf:function(r){return Et(so(P(this)),function(e,t,n){if(t===r)return n(e)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Se({target:"Map",proto:!0,real:!0,forced:he},{mapKeys:function(e,t){var n=P(this),r=so(n),i=lt(e,1<arguments.length?t:void 0,3),o=new(Bt(n,_e("Map"))),a=ct(o.set);return Et(r,function(e,t){a.call(o,i(t,e,n),t)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Se({target:"Map",proto:!0,real:!0,forced:he},{mapValues:function(e,t){var n=P(this),r=so(n),i=lt(e,1<arguments.length?t:void 0,3),o=new(Bt(n,_e("Map"))),a=ct(o.set);return Et(r,function(e,t){a.call(o,e,i(t,e,n))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Se({target:"Map",proto:!0,real:!0,forced:he},{merge:function(){for(var e=P(this),t=ct(e.set),n=0;n<arguments.length;)Et(arguments[n++],t,{that:e,AS_ENTRIES:!0});return e}}),Se({target:"Map",proto:!0,real:!0,forced:he},{reduce:function(n,e){var r=P(this),t=so(r),i=arguments.length<2,o=i?void 0:e;if(ct(n),Et(t,function(e,t){o=i?(i=!1,t):n(o,t,e,r)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),i)throw TypeError("Reduce of empty map with no initial value");return o}}),Se({target:"Map",proto:!0,real:!0,forced:he},{some:function(e,t){var r=P(this),n=so(r),i=lt(e,1<arguments.length?t:void 0,3);return Et(n,function(e,t,n){if(i(t,e,r))return n()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Map",proto:!0,real:!0,forced:he},{update:function(e,t,n){var r=P(this),i=arguments.length;ct(t);var o=r.has(e);if(!o&&i<3)throw TypeError("Updating absent value");return n=o?r.get(e):ct(2<i?n:void 0)(e,r),r.set(e,t(n,e,r)),r}});var uo=function(e,t,n){var r,i=P(this),n=2<arguments.length?n:void 0;if("function"!=typeof t&&"function"!=typeof n)throw TypeError("At least one callback required");return i.has(e)?(r=i.get(e),"function"==typeof t&&(r=t(r),i.set(e,r))):"function"==typeof n&&(r=n(),i.set(e,r)),r};function co(e){return Set.prototype.values.call(e)}Se({target:"Map",proto:!0,real:!0,forced:he},{upsert:uo}),Se({target:"Map",proto:!0,real:!0,forced:he},{updateOrInsert:uo}),F("Set",function(t){return function(e){return t(this,arguments.length?e:void 0)}},oo),Oe.Set,Se({target:"Set",stat:!0},{from:Hn}),Se({target:"Set",stat:!0},{of:fe}),Se({target:"Set",proto:!0,real:!0,forced:he},{addAll:function(){return function(){for(var e=P(this),t=ct(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e}.apply(this,arguments)}}),Se({target:"Set",proto:!0,real:!0,forced:he},{deleteAll:function(){return ao.apply(this,arguments)}}),Se({target:"Set",proto:!0,real:!0,forced:he},{every:function(e,t){var n=P(this),r=co(n),i=lt(e,1<arguments.length?t:void 0,3);return!Et(r,function(e,t){if(!i(e,e,n))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Set",proto:!0,real:!0,forced:he},{difference:function(e){var t=P(this),n=new(Bt(t,_e("Set")))(t),r=ct(n.delete);return Et(e,function(e){r.call(n,e)}),n}}),Se({target:"Set",proto:!0,real:!0,forced:he},{filter:function(e,t){var n=P(this),r=co(n),i=lt(e,1<arguments.length?t:void 0,3),o=new(Bt(n,_e("Set"))),a=ct(o.add);return Et(r,function(e){i(e,e,n)&&a.call(o,e)},{IS_ITERATOR:!0}),o}}),Se({target:"Set",proto:!0,real:!0,forced:he},{find:function(e,t){var n=P(this),r=co(n),i=lt(e,1<arguments.length?t:void 0,3);return Et(r,function(e,t){if(i(e,e,n))return t(e)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Se({target:"Set",proto:!0,real:!0,forced:he},{intersection:function(e){var t=P(this),n=new(Bt(t,_e("Set"))),r=ct(t.has),i=ct(n.add);return Et(e,function(e){r.call(t,e)&&i.call(n,e)}),n}}),Se({target:"Set",proto:!0,real:!0,forced:he},{isDisjointFrom:function(e){var n=P(this),r=ct(n.has);return!Et(e,function(e,t){if(!0===r.call(n,e))return t()},{INTERRUPTED:!0}).stopped}}),Se({target:"Set",proto:!0,real:!0,forced:he},{isSubsetOf:function(e){var t=function(e){var t=bt(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return P(t.call(e))}(this),n=P(e),r=n.has;return"function"!=typeof r&&(n=new(_e("Set"))(e),r=ct(n.has)),!Et(t,function(e,t){if(!1===r.call(n,e))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Set",proto:!0,real:!0,forced:he},{isSupersetOf:function(e){var n=P(this),r=ct(n.has);return!Et(e,function(e,t){if(!1===r.call(n,e))return t()},{INTERRUPTED:!0}).stopped}}),Se({target:"Set",proto:!0,real:!0,forced:he},{join:function(e){var t=co(n=P(this)),n=void 0===e?",":String(e);return Et(t,(e=[]).push,{that:e,IS_ITERATOR:!0}),e.join(n)}}),Se({target:"Set",proto:!0,real:!0,forced:he},{map:function(e,t){var n=P(this),r=co(n),i=lt(e,1<arguments.length?t:void 0,3),o=new(Bt(n,_e("Set"))),a=ct(o.add);return Et(r,function(e){a.call(o,i(e,e,n))},{IS_ITERATOR:!0}),o}}),Se({target:"Set",proto:!0,real:!0,forced:he},{reduce:function(t,e){var n=P(this),r=co(n),i=arguments.length<2,o=i?void 0:e;if(ct(t),Et(r,function(e){o=i?(i=!1,e):t(o,e,e,n)},{IS_ITERATOR:!0}),i)throw TypeError("Reduce of empty set with no initial value");return o}}),Se({target:"Set",proto:!0,real:!0,forced:he},{some:function(e,t){var n=P(this),r=co(n),i=lt(e,1<arguments.length?t:void 0,3);return Et(r,function(e,t){if(i(e,e,n))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Se({target:"Set",proto:!0,real:!0,forced:he},{symmetricDifference:function(e){var t=P(this),n=new(Bt(t,_e("Set")))(t),r=ct(n.delete),i=ct(n.add);return Et(e,function(e){r.call(n,e)||i.call(n,e)}),n}}),Se({target:"Set",proto:!0,real:!0,forced:he},{union:function(e){var t=P(this);return Et(e,ct((t=new(Bt(t,_e("Set")))(t)).add),{that:t}),t}});var lo=Math.floor;Se({target:"Number",stat:!0},{isInteger:function(e){return!N(e)&&isFinite(e)&&lo(e)===e}}),Oe.Number.isInteger,Se({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),Oe.Number.isNaN;var ho=function(e,t){return(ho=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function fo(e,t){function n(){this.constructor=e}ho(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var po=function(){return(po=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function go(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})}function yo(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function mo(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vo(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function bo(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(vo(arguments[t]));return e}function _o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function wo(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t}function Eo(e){try{return Co.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}var To={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Io=function(e,t){if(!e)throw So(t)},So=function(e){return new Error("Firebase Database ("+To.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},Co={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=o>>2,o=(3&o)<<4|s>>4,s=(15&s)<<2|(l=u?e[i+2]:0)>>6,l=63&l;u||(l=64,a||(s=64)),r.push(n[c],n[o],n[s],n[l])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(wo(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i,o,a,s=e[n++];s<128?t[r++]=String.fromCharCode(s):191<s&&s<224?(o=e[n++],t[r++]=String.fromCharCode((31&s)<<6|63&o)):239<s&&s<365?(i=((7&s)<<18|(63&(o=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))):(o=e[n++],a=e[n++],t[r++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&a))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();o=o<<2|a>>4,r.push(o),64!==s&&(a=a<<4&240|s>>2,r.push(a),64!==u&&(u|=s<<6&192,r.push(u)))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};function Ao(e){return ko(void 0,e)}function ko(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=ko(e[n],t[n]));return e}var No=(Do.prototype.wrapCallback=function(n){var r=this;return function(e,t){e?r.reject(e):r.resolve(t),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(e):n(e,t))}},Do);function Do(){var n=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}function Ro(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Oo(){return"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ro())}function Po(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function xo(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Lo(){return!0===To.NODE_ADMIN}function Mo(){return"indexedDB"in self&&null!=indexedDB}function Fo(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}function Uo(){return navigator&&navigator.cookieEnabled}var qo,jo="FirebaseError",Vo=(fo(Bo,qo=Error),Bo);function Bo(e,t,n){return(t=qo.call(this,t)||this).code=e,t.customData=n,t.name=jo,Object.setPrototypeOf(t,Bo.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,Ko.prototype.create),t}var Ko=(Wo.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e,e=(e=this.errors[e])?(r=i,e.replace(zo,function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"})):"Error",e=this.serviceName+": "+e+" ("+o+").";return new Vo(o,e,i)},Wo);function Wo(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var zo=/\{\$([^}]+)}/g;function Ho(e){return JSON.parse(e)}function Go(e){return JSON.stringify(e)}function Qo(e){var t={},n={},r={},i="";try{var o=e.split("."),t=Ho(Eo(o[0])||""),n=Ho(Eo(o[1])||""),i=o[2],r=n.d||{};delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}}function Yo(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xo(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Jo(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function $o(e,t,n){var r,i={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}var Zo=(ea.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},ea.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4],r=0;r<80;r++)a=r<40?r<20?(o=l^u&(c^l),1518500249):(o=u^c^l,1859775393):r<60?(o=u&c|l&(u|c),2400959708):(o=u^c^l,3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},ea.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},ea.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},ea);function ea(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}function ta(e,t){return(t=new na(e,t)).subscribe.bind(t)}var na=(ra.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},ra.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},ra.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},ra.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");return void 0===(r=function(e){if("object"==typeof e&&null!==e)for(var t=0,n=["next","error","complete"];t<n.length;t++){var r=n[t];if(r in e&&"function"==typeof e[r])return 1}}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=ia),void 0===r.error&&(r.error=ia),void 0===r.complete&&(r.complete=ia),n=this.unsubscribeOne.bind(this,this.observers.length),this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),n},ra.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ra.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},ra.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},ra.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},ra);function ra(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function ia(){}function oa(e,t,n,r){var i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function aa(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return(e+=" failed: ")+(r+" argument ")}function sa(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(aa(e,t,r)+"must be a valid function.")}function ua(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(aa(e,t,r)+"must be a valid context object.")}function ca(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?(t+=4,n++):t+=3}return t}var la=1e3,ha=2,fa=144e5,pa=.5;function da(e,t,n){return void 0===t&&(t=la),void 0===n&&(n=ha),n=t*Math.pow(n,e),e=Math.round(pa*n*(Math.random()-.5)*2),Math.min(fa,n+e)}var ga=(ya.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},ya.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},ya.prototype.setServiceProps=function(e){return this.serviceProps=e,this},ya);function ya(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var ma="[DEFAULT]",va=(ba.prototype.get=function(e){void 0===e&&(e=ma);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new No;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},ba.prototype.getImmediate=function(e){var t=po({identifier:ma,optional:!1},e),e=t.identifier,n=t.optional,r=this.normalizeInstanceIdentifier(e);try{var i=this.getOrInitializeService(r);if(i)return i;if(n)return null;throw Error("Service "+this.name+" is not available")}catch(e){if(n)return null;throw e}},ba.prototype.getComponent=function(){return this.component},ba.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=e).instantiationMode)try{this.getOrInitializeService(ma)}catch(e){}try{for(var r=mo(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=vo(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},ba.prototype.clearInstance=function(e){void 0===e&&(e=ma),this.instancesDeferred.delete(e),this.instances.delete(e)},ba.prototype.delete=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(bo(t.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}),t.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()})))];case 1:return e.sent(),[2]}})})},ba.prototype.isComponentSet=function(){return null!=this.component},ba.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,e===ma?void 0:e),this.instances.set(e,t)),t||null},ba.prototype.normalizeInstanceIdentifier=function(e){return!this.component||this.component.multipleInstances?e:ma},ba);function ba(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var _a=(wa.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},wa.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},wa.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new va(e,this);return this.providers.set(e,t),t},wa.prototype.getProviders=function(){return Array.from(this.providers.values())},wa);function wa(e){this.name=e,this.providers=new Map}function Ea(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var Ta,Ia=[];function Sa(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=ka[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,Ea(["["+i+"]  "+e.name+":"],n))}}(Hn=Ta=Ta||{})[Hn.DEBUG=0]="DEBUG",Hn[Hn.VERBOSE=1]="VERBOSE",Hn[Hn.INFO=2]="INFO",Hn[Hn.WARN=3]="WARN",Hn[Hn.ERROR=4]="ERROR",Hn[Hn.SILENT=5]="SILENT";var Ca={debug:Ta.DEBUG,verbose:Ta.VERBOSE,info:Ta.INFO,warn:Ta.WARN,error:Ta.ERROR,silent:Ta.SILENT},Aa=Ta.INFO,ka=((fe={})[Ta.DEBUG]="log",fe[Ta.VERBOSE]="log",fe[Ta.INFO]="info",fe[Ta.WARN]="warn",fe[Ta.ERROR]="error",fe),Na=(Object.defineProperty(Da.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in Ta))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),Da.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Ca[e]:e},Object.defineProperty(Da.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),Da.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Ea([this,Ta.DEBUG],e)),this._logHandler.apply(this,Ea([this,Ta.DEBUG],e))},Da.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Ea([this,Ta.VERBOSE],e)),this._logHandler.apply(this,Ea([this,Ta.VERBOSE],e))},Da.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Ea([this,Ta.INFO],e)),this._logHandler.apply(this,Ea([this,Ta.INFO],e))},Da.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Ea([this,Ta.WARN],e)),this._logHandler.apply(this,Ea([this,Ta.WARN],e))},Da.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Ea([this,Ta.ERROR],e)),this._logHandler.apply(this,Ea([this,Ta.ERROR],e))},Da);function Da(e){this.name=e,this._logLevel=Aa,this._logHandler=Sa,this._userLogHandler=null,Ia.push(this)}function Ra(t){Ia.forEach(function(e){e.setLogLevel(t)})}var Hn=((he={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",he["bad-app-name"]="Illegal App name: '{$appName}",he["duplicate-app"]="Firebase App named '{$appName}' already exists",he["app-deleted"]="Firebase App named '{$appName}' already deleted",he["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",he["invalid-log-argument"]="First argument to `onLog` must be null or a function.",he),Oa=new Ko("app","Firebase",Hn),ve="@firebase/app",Pa="[DEFAULT]",xa=((fe={})[ve]="fire-core",fe["@firebase/analytics"]="fire-analytics",fe["@firebase/auth"]="fire-auth",fe["@firebase/database"]="fire-rtdb",fe["@firebase/functions"]="fire-fn",fe["@firebase/installations"]="fire-iid",fe["@firebase/messaging"]="fire-fcm",fe["@firebase/performance"]="fire-perf",fe["@firebase/remote-config"]="fire-rc",fe["@firebase/storage"]="fire-gcs",fe["@firebase/firestore"]="fire-fst",fe["fire-js"]="fire-js",fe["firebase-wrapper"]="fire-js-all",fe),La=new Na("@firebase/app"),Ma=(Object.defineProperty(Fa.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),Fa.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(e){return e.delete()}))}).then(function(){t.isDeleted_=!0})},Fa.prototype._getService=function(e,t){return void 0===t&&(t=Pa),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},Fa.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=Pa),this.container.getProvider(e).clearInstance(t)},Fa.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){La.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},Fa.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},Fa.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Oa.create("app-deleted",{appName:this.name_})},Fa);function Fa(e,t,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Ao(e),this.container=new _a(t.name),this._addComponent(new ga("app",function(){return o},"PUBLIC"));try{for(var a=mo(this.firebase_.INTERNAL.components.values()),s=a.next();!s.done;s=a.next()){var u=s.value;this._addComponent(u)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}Ma.prototype.name&&Ma.prototype.options||Ma.prototype.delete||console.log("dc");var he=function e(){var u,c,l,h,t=(u=Ma,c={},l=new Map,(h={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={}),"object"==typeof t&&null!==t||(t={name:t});var n=t;if(void 0===n.name&&(n.name=Pa),"string"!=typeof(t=n.name)||!t)throw Oa.create("bad-app-name",{appName:String(t)});if(Yo(c,t))throw Oa.create("duplicate-app",{appName:t});return n=new u(e,n,h),c[t]=n},app:f,registerVersion:function(e,t,n){var r=null!==(i=xa[e])&&void 0!==i?i:e;n&&(r+="-"+n);var i=r.match(/\s|\//),e=t.match(/\s|\//);if(i||e)return n=['Unable to register library "'+r+'" with version "'+t+'":'],i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&e&&n.push("and"),e&&n.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void La.warn(n.join(" "));o(new ga(r+"-version",function(){return{library:r,version:t}},"VERSION"))},setLogLevel:Ra,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw Oa.create("invalid-log-argument",{appName:name});!function(a,t){for(var e=0,n=Ia;e<n.length;e++)!function(e){var o=null;t&&t.level&&(o=Ca[t.level]),e.userLogHandler=null===a?null:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(function(e){return e}).join(" ");t>=(null!=o?o:e.logLevel)&&a({level:Ta[t].toLowerCase(),message:i,args:n,type:e.name})}}(n[e])}(e,t)},apps:null,SDK_VERSION:"8.1.1-1.0.0-eap-firestore-debug.9c6096f43",INTERNAL:{registerComponent:o,removeApp:function(e){delete c[e]},components:l,useAsService:function(e,t){return"serverAuth"===t?null:t}}}).default=h,Object.defineProperty(h,"apps",{get:function(){return Object.keys(c).map(function(e){return c[e]})}}),f.App=u,h);function f(e){if(!Yo(c,e=e||Pa))throw Oa.create("no-app",{appName:e});return c[e]}function o(n){var e,t,r,i=n.name;if(l.has(i))return La.debug("There were multiple attempts to register component "+i+"."),"PUBLIC"===n.type?h[i]:null;l.set(i,n),"PUBLIC"===n.type&&(r=function(e){if(void 0===e&&(e=f()),"function"!=typeof e[i])throw Oa.create("invalid-app-argument",{appName:i});return e[i]()},void 0!==n.serviceProps&&ko(r,n.serviceProps),h[i]=r,u.prototype[i]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,i).apply(this,n.multipleInstances?e:[])});try{for(var o=mo(Object.keys(c)),a=o.next();!a.done;a=o.next()){var s=a.value;c[s]._addComponent(n)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return"PUBLIC"===n.type?h[i]:null}return t.INTERNAL=po(po({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){ko(t,e)},createSubscribe:ta,ErrorFactory:Ko,deepExtend:ko}),t}(),Ua=(qa.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){return"VERSION"===(null==(t=(t=e).getComponent())?void 0:t.type)?(e=e.getImmediate()).library+"/"+e.version:null;var t}).filter(function(e){return e}).join(" ")},qa);function qa(e){this.container=e}"object"==typeof self&&self.self===self&&void 0!==self.firebase&&(La.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  "),(iu=self.firebase.SDK_VERSION)&&0<=iu.indexOf("LITE")&&La.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    "));var ja=he.initializeApp;he.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return}}()&&La.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),ja.apply(void 0,e)};var jh=he;(ye=jh).INTERNAL.registerComponent(new ga("platform-logger",function(e){return new Ua(e)},"PRIVATE")),ye.registerVersion(ve,"0.6.13-1.0.0-eap-firestore-debug.9c6096f43",void 0),ye.registerVersion("fire-js",""),jh.registerVersion("firebase","8.1.1-1.0.0-eap-firestore-debug.9c6096f43","app"),function(){var e,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},u=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}return globalThis}(this);function c(e){var t,n,r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return r?r.call(e):{next:(t=e,n=0,function(){return n<t.length?{done:!1,value:t[n++]}:{done:!0}})}}!function(e,t){var n=u;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];i in n||(n[i]={}),n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&o(n,e,{configurable:!0,writable:!0,value:t})}("Promise",function(e){function a(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.a=null}function s(t){return t instanceof a?t:new a(function(e){e(t)})}if(e)return e;t.prototype.b=function(e){var t;null==this.a&&(this.a=[],(t=this).c(function(){t.g()})),this.a.push(e)};var n=u.setTimeout;t.prototype.c=function(e){n(e,0)},t.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.f(e)}}}this.a=null},t.prototype.f=function(e){this.c(function(){throw e})},a.prototype.f=function(){function e(t){return function(e){r||(r=!0,t.call(n,e))}}var n=this,r=!1;return{resolve:e(this.v),reject:e(this.g)}},a.prototype.v=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof a)this.s(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.m(e):this.h(e)}},a.prototype.m=function(e){var t=void 0;try{t=e.then}catch(e){return void this.g(e)}"function"==typeof t?this.u(t,e):this.h(e)},a.prototype.g=function(e){this.i(2,e)},a.prototype.h=function(e){this.i(1,e)},a.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},a.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)i.b(this.a[e]);this.a=null}};var i=new t;return a.prototype.s=function(e){var t=this.f();e.Pa(t.resolve,t.reject)},a.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},a.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(e){i(e)}}:e}var r,i,o=new a(function(e,t){r=e,i=t});return this.Pa(n(e,r),n(t,i)),o},a.prototype.catch=function(e){return this.then(void 0,e)},a.prototype.Pa=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?i.b(n):this.a.push(n)},a.resolve=s,a.reject=function(n){return new a(function(e,t){t(n)})},a.race=function(i){return new a(function(e,t){for(var n=c(i),r=n.next();!r.done;r=n.next())s(r.value).Pa(e,t)})},a.all=function(e){var t=c(e),o=t.next();return o.done?s([]):new a(function(n,e){for(var r=[],i=0;r.push(void 0),i++,s(o.value).Pa(function(t){return function(e){r[t]=e,0==--i&&n(r)}}(r.length-1),e),!(o=t.next()).done;);})},a});var l=l||{},h=this||self,t=/^[\w+/_-]+[=]{0,2}$/,s=null;function f(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&t.test(e)?e:""}function a(){}function p(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function d(e){var t=p(e);return"array"==t||"object"==t&&"number"==typeof e.length}function g(e){return"function"==p(e)}function y(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var n="closure_uid_"+(1e9*Math.random()>>>0),r=0;function i(e,t,n){return e.call.apply(e.bind,arguments)}function m(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function v(e,t,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:m).apply(null,arguments)}function b(t){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now;function w(e,t){function n(){}n.prototype=t.prototype,e.$a=t.prototype,e.prototype=new n,e.prototype.constructor=e}function E(e){return e}function T(e,t,n){this.code=C+e,this.message=t||A[e]||"",this.a=n||null}function I(e){var t=e&&e.code;return t?new T(t.substring(C.length),e.message,e.serverResponse):null}w(T,Error),T.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},T.prototype.toJSON=function(){return this.w()};var S,C="auth/",A={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},k={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function N(e){for(var t in k)if(k[t].id===e)return e=k[t],{firebaseEndpoint:e.Sa,secureTokenEndpoint:e.Ya,identityPlatformEndpoint:e.Va};return null}function D(e){if(e)try{return e.$goog_Thenable}catch(e){return}}function R(e){var t;Error.captureStackTrace?Error.captureStackTrace(this,R):(t=Error().stack)&&(this.stack=t),e&&(this.message=String(e))}function O(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");R.call(this,n+e[r])}function P(e){throw new O("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function x(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function L(e,t){e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}function M(){this.b=this.a=null}S=N("__EID__")?"__EID__":void 0,w(R,Error),R.prototype.name="CustomError",w(O,R),O.prototype.name="AssertionError",x.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e};var F=new x(function(){return new U},function(e){e.reset()});function U(){this.next=this.b=this.a=null}M.prototype.add=function(e,t){var n=F.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},j=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},V=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n,r=e.length,i=[],o=0,a="string"==typeof e?e.split(""):e,s=0;s<r;s++)s in a&&(n=a[s],t.call(void 0,n,s,e)&&(i[o++]=n));return i},B=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},K=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function W(e,t){return 0<=q(e,t)}function z(e,t){var n;return(n=0<=(t=q(e,t)))&&Array.prototype.splice.call(e,t,1),n}function H(n,r){!function(e,t){for(var n="string"==typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(n,function(e,t){r.call(void 0,e,t,n)&&Array.prototype.splice.call(n,t,1).length})}function G(){return Array.prototype.concat.apply([],arguments)}function Q(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var Y,X=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},J=/&/g,$=/</g,Z=/>/g,ee=/"/g,te=/'/g,ne=/\x00/g,re=/[\x00&<>"']/;function ie(e,t){return-1!=e.indexOf(t)}function oe(e,t){return e<t?-1:t<e?1:0}var ae=h.navigator;function se(e){return ie(Y,e)}function ue(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function ce(e){for(var t in e)return;return 1}function le(e){var t,n={};for(t in e)n[t]=e[t];return n}Y=(ae=ae&&ae.userAgent)?ae:"";var he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(e){for(var t,n,r=1;r<arguments.length;r++){for(t in n=arguments[r])e[t]=n[t];for(var i=0;i<he.length;i++)t=he[i],Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}}function pe(e,t){e:{try{var n=e&&e.ownerDocument;if((n=(n=n&&(n.defaultView||n.parentWindow))||h).Element&&n.Location){var r=n;break e}}catch(e){}r=null}if(r&&void 0!==r[t]&&(!e||!(e instanceof r[t])&&(e instanceof r.Location||e instanceof r.Element))){if(y(e))try{var i=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(e){i="<object could not be stringified>"}else i=void 0===e?"undefined":null===e?"null":typeof e;P("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,i)}}function de(e,t){this.a=e===ve&&t||"",this.b=me}function ge(e){return e instanceof de&&e.constructor===de&&e.b===me?e.a:(P("expected object of type Const, got '"+e+"'"),"type_error:Const")}de.prototype.sa=!0,de.prototype.ra=function(){return this.a},de.prototype.toString=function(){return"Const{"+this.a+"}"};var ye,me={},ve={};function be(){if(void 0===ye){var e=null,t=h.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:E,createScript:E,createScriptURL:E})}catch(e){h.console&&h.console.error(e.message)}ye=e}else ye=e}return ye}function _e(e,t){this.a=t===Se?e:""}function we(e){return e instanceof _e&&e.constructor===_e?e.a:(P("expected object of type TrustedResourceUrl, got '"+e+"' of type "+p(e)),"type_error:TrustedResourceUrl")}function Ee(e,n){var t,r=ge(e);if(!Ie.test(r))throw Error("Invalid TrustedResourceUrl format: "+r);return t=e=r.replace(Te,function(e,t){if(!Object.prototype.hasOwnProperty.call(n,t))throw Error('Found marker, "'+t+'", in format string, "'+r+'", but no valid label mapping found in args: '+JSON.stringify(n));return(e=n[t])instanceof de?ge(e):encodeURIComponent(String(e))}),new _e(t=(e=be())?e.createScriptURL(t):t,Se)}_e.prototype.sa=!0,_e.prototype.ra=function(){return this.a.toString()},_e.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Te=/%{(\w+)}/g,Ie=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Se={};function Ce(e,t){this.a=t===Pe?e:""}function Ae(e){return e instanceof Ce&&e.constructor===Ce?e.a:(P("expected object of type SafeUrl, got '"+e+"' of type "+p(e)),"type_error:SafeUrl")}Ce.prototype.sa=!0,Ce.prototype.ra=function(){return this.a.toString()},Ce.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var ke=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Ne=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,De=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Re(e){return e instanceof Ce?e:(e="object"==typeof e&&e.sa?e.ra():String(e),e=De.test(e)||(t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(Ne))&&ke.test(t[1])?new Ce(e,Pe):null);var t}function Oe(e){return e instanceof Ce?e:(e="object"==typeof e&&e.sa?e.ra():String(e),De.test(e)||(e="about:invalid#zClosurez"),new Ce(e,Pe))}var Pe={},xe=new Ce("about:invalid#zClosurez",Pe);function Le(e,t,n){this.a=n===Me?e:""}Le.prototype.sa=!0,Le.prototype.ra=function(){return this.a.toString()},Le.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Me={};function Fe(e,t,n,r){return e=e instanceof Ce?e:Oe(e),t=t||h,n=n instanceof de?ge(n):n||"",t.open(Ae(e),n,r,void 0)}function Ue(e){for(var t=e.split("%s"),n="",r=Array.prototype.slice.call(arguments,1);r.length&&1<t.length;)n+=t.shift()+r.shift();return n+t.join("%s")}function qe(e){return re.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(J,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace($,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(Z,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(ee,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(te,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(ne,"&#0;"))),e}function je(e){return je[" "](e),e}je[" "]=a;var Ve,Be=se("Opera"),Ke=se("Trident")||se("MSIE"),We=se("Edge"),ze=We||Ke,He=se("Gecko")&&!(ie(Y.toLowerCase(),"webkit")&&!se("Edge"))&&!(se("Trident")||se("MSIE"))&&!se("Edge"),Ge=ie(Y.toLowerCase(),"webkit")&&!se("Edge");function Qe(){var e=h.document;return e?e.documentMode:void 0}var Ye="",ae=(ae=Y,He?/rv:([^\);]+)(\)|;)/.exec(ae):We?/Edge\/([\d\.]+)/.exec(ae):Ke?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ae):Ge?/WebKit\/(\S+)/.exec(ae):Be?/(?:Version)[ \/]?(\S+)/.exec(ae):void 0);ae&&(Ye=ae?ae[1]:""),Ve=Ke&&null!=(ae=Qe())&&ae>parseFloat(Ye)?String(ae):Ye;var Xe={};function Je(s){return e=s,t=function(){for(var e=0,t=X(String(Ve)).split("."),n=X(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++)for(var o=t[i]||"",a=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],(0!=o[0].length||0!=a[0].length)&&(e=oe(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||oe(0==o[2].length,0==a[2].length)||oe(o[2],a[2]),o=o[3],a=a[3],0==e););return 0<=e},n=Xe,Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t();var e,t,n}var $e=h.document&&Ke&&(Qe()||parseInt(Ve,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(e){}var Ze=!Ke||9<=Number($e);function et(e){var t=document;return"string"==typeof e?t.getElementById(e):e}function tt(n,e){ue(e,function(e,t){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==t?n.style.cssText=e:"class"==t?n.className=e:"for"==t?n.htmlFor=e:it.hasOwnProperty(t)?n.setAttribute(it[t],e):0==t.lastIndexOf("aria-",0)||0==t.lastIndexOf("data-",0)?n.setAttribute(t,e):n[t]=e})}var nt,rt,it={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ot(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function at(e){h.setTimeout(function(){throw e},0)}function st(e,t){var n;rt=rt||(h.Promise&&h.Promise.resolve?(n=h.Promise.resolve(void 0),function(){n.then(lt)}):function(){var e=lt;!g(h.setImmediate)||h.Window&&h.Window.prototype&&!se("Edge")&&h.Window.prototype.setImmediate==h.setImmediate?(nt=nt||function(){var e=h.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!se("Presto")&&(e=function(){(r=ot(document,"IFRAME")).style.display="none",document.documentElement.appendChild(r);var e=r.contentWindow;(r=e.document).open(),r.close();var t="callImmediate"+Math.random(),n="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host,r=v(function(e){"*"!=n&&e.origin!=n||e.data!=t||this.port1.onmessage()},this);e.addEventListener("message",r,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(t,n)}}}),void 0===e||se("Trident")||se("MSIE"))return function(e){h.setTimeout(e,0)};var t=new e,n={},r=n;return t.port1.onmessage=function(){var e;void 0!==n.next&&(e=(n=n.next).Fb,n.Fb=null,e())},function(e){r.next={Fb:e},r=r.next,t.port2.postMessage(0)}}())(e):h.setImmediate(e)}),ut||(rt(),ut=!0),ct.add(e,t)}var ut=!1,ct=new M;function lt(){for(var e,t,n;n=t=void 0,n=null,(t=ct).a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),e=n;){try{e.a.call(e.b)}catch(e){at(e)}L(F,e)}ut=!1}function ht(e,t){if(this.a=ft,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=a)try{var n=this;e.call(t,function(e){It(n,pt,e)},function(e){if(!(e instanceof Rt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}It(n,dt,e)})}catch(e){It(this,dt,e)}}var ft=0,pt=2,dt=3;function gt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}gt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var yt=new x(function(){return new gt},function(e){e.reset()});function mt(e,t,n){var r=yt.get();return r.g=e,r.b=t,r.f=n,r}function vt(e){if(e instanceof ht)return e;var t=new ht(a);return It(t,pt,e),t}function bt(n){return new ht(function(e,t){t(n)})}function _t(e,t,n){St(e,t,n,null)||st(b(t,e))}function wt(n){return new ht(function(r){var i=n.length,o=[];if(i)for(var e=function(e,t,n){i--,o[e]=t?{Ob:!0,value:n}:{Ob:!1,reason:n},0==i&&r(o)},t=0;t<n.length;t++)_t(n[t],b(e,t,!0),b(e,t,!1));else r(o)})}function Et(e,t){e.b||e.a!=pt&&e.a!=dt||Ct(e),e.f?e.f.next=t:e.b=t,e.f=t}function Tt(e,i,o,a){var t=mt(null,null,null);return t.a=new ht(function(n,r){t.g=i?function(e){try{var t=i.call(a,e);n(t)}catch(e){r(e)}}:n,t.b=o?function(e){try{var t=o.call(a,e);void 0===t&&e instanceof Rt?r(e):n(t)}catch(e){r(e)}}:r}),Et(t.a.c=e,t),t.a}function It(e,t,n){var r,i;e.a==ft&&(e===n&&(t=dt,n=new TypeError("Promise cannot resolve to itself")),e.a=1,St(n,e.Zc,e.$c,e)||(e.i=n,e.a=t,e.c=null,Ct(e),t!=dt||n instanceof Rt||(i=n,(r=e).g=!0,st(function(){r.g&&Dt.call(null,i)}))))}function St(e,t,n,r){if(e instanceof ht)return Et(e,mt(t||a,n||null,r)),1;if(D(e))return e.then(t,n,r),1;if(y(e))try{var i=e.then;return g(i)?(function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,function(e){a||(a=!0,n.call(i,e))},o)}catch(e){o(e)}}(e,i,t,n,r),1):void 0}catch(e){return n.call(r,e),1}}function Ct(e){e.h||(e.h=!0,st(e.fc,e))}function At(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function kt(e,t,n,r){if(n==dt&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,Nt(t,n,r);else try{t.c?t.g.call(t.f):Nt(t,n,r)}catch(e){Dt.call(null,e)}L(yt,t)}function Nt(e,t,n){t==pt?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}ht.prototype.then=function(e,t,n){return Tt(this,g(e)?e:null,g(t)?t:null,n)},ht.prototype.$goog_Thenable=!0,(e=ht.prototype).na=function(e,t){return(e=mt(e,e,t)).c=!0,Et(this,e),this},e.o=function(e,t){return Tt(this,null,e,t)},e.cancel=function(e){var t;this.a==ft&&(t=new Rt(e),st(function(){!function e(t,n){if(t.a==ft)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==t&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==ft&&1==i?e(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):At(r),kt(r,o,dt,n)))}t.c=null}else It(t,dt,n)}(this,t)},this))},e.Zc=function(e){this.a=ft,It(this,pt,e)},e.$c=function(e){this.a=ft,It(this,dt,e)},e.fc=function(){for(var e;e=At(this);)kt(this,e,this.a,this.i);this.h=!1};var Dt=at;function Rt(e){R.call(this,e)}function Ot(){this.xa=this.xa,this.oa=this.oa}w(Rt,R);var Pt=0;function xt(e){e.xa||(e.xa=!0,e.Da(),0==Pt)||Object.prototype.hasOwnProperty.call(e,n)&&e[n]||(e[n]=++r)}Ot.prototype.xa=!(Rt.prototype.name="cancel"),Ot.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var Ye=Object.freeze||function(e){return e},Lt=!Ke||9<=Number($e),Mt=Ke&&!Je("9"),Ft=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{h.addEventListener("test",a,t),h.removeEventListener("test",a,t)}catch(e){}return e}();function Ut(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function qt(e,t){if(Ut.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(He){e:{try{je(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:jt[e.pointerType]||"",(this.a=e).defaultPrevented&&this.preventDefault()}}Ut.prototype.preventDefault=function(){this.defaultPrevented=!0},w(qt,Ut);var jt=Ye({2:"touch",3:"pen",4:"mouse"});qt.prototype.preventDefault=function(){qt.$a.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Mt)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}},qt.prototype.g=function(){return this.a};var Vt="closure_listenable_"+(1e6*Math.random()|0),Bt=0;function Kt(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Bt,this.va=this.Oa=!1}function Wt(e){e.va=!0,e.listener=null,e.proxy=null,e.src=null,e.Ua=null}function zt(e){this.src=e,this.a={},this.b=0}function Ht(e,t){var n=t.type;n in e.a&&z(e.a[n],t)&&(Wt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function Gt(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.va&&o.listener==t&&o.capture==!!n&&o.Ua==r)return i}return-1}zt.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Gt(e,t,r,i);return-1<a?(t=e[a],n||(t.Oa=!1)):((t=new Kt(t,this.src,o,!!r,i)).Oa=n,e.push(t)),t};var Qt="closure_lm_"+(1e6*Math.random()|0),Yt={};function Xt(e,t,n,r,i){if(r&&r.once)$t(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)Xt(e,t[o],n,r,i);else n=un(n),e&&e[Vt]?ln(e,t,n,y(r)?!!r.capture:!!r,i):Jt(e,t,n,!1,r,i)}function Jt(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a,s,u=y(i)?!!i.capture:!!i,c=an(e);if(c||(e[Qt]=c=new zt(e)),!(n=c.add(t,n,r,u,o)).proxy)if(a=on,r=s=Lt?function(e){return a.call(s.src,s.listener,e)}:function(e){if(!(e=a.call(s.src,s.listener,e)))return e},(n.proxy=r).src=e,r.listener=n,e.addEventListener)Ft||(i=u),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(tn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function $t(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)$t(e,t[o],n,r,i);else n=un(n),e&&e[Vt]?hn(e,t,n,y(r)?!!r.capture:!!r,i):Jt(e,t,n,!0,r,i)}function Zt(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)Zt(e,t[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=un(n),e&&e[Vt]?(e=e.v,(t=String(t).toString())in e.a&&-1<(n=Gt(o=e.a[t],n,r,i))&&(Wt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):(e=e&&an(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Gt(t,n,r,i)),(n=-1<e?t[e]:null)&&en(n))}function en(e){var t,n,r;"number"!=typeof e&&e&&!e.va&&((t=e.src)&&t[Vt]?Ht(t.v,e):(n=e.type,r=e.proxy,t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(tn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=an(t))?(Ht(n,e),0==n.b&&(n.src=null,t[Qt]=null)):Wt(e)))}function tn(e){return e in Yt?Yt[e]:Yt[e]="on"+e}function nn(e,t,n,r){var i=!0;if((e=an(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.va&&(o=rn(o,r),i=i&&!1!==o)}return i}function rn(e,t){var n=e.listener,r=e.Ua||e.src;return e.Oa&&en(e),n.call(r,t)}function on(e,t){if(e.va)return!0;if(Lt)return rn(e,new qt(t,this));if(!t)e:{t=["window","event"];for(var n=h,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new qt(r=t,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}!i&&null!=r.returnValue||(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=nn(r[i],e,!0,t),n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=nn(r[i],e,!1,t),n=n&&o}return n}function an(e){return(e=e[Qt])instanceof zt?e:null}var sn="__closure_events_fn_"+(1e9*Math.random()>>>0);function un(t){return g(t)?t:(t[sn]||(t[sn]=function(e){return t.handleEvent(e)}),t[sn])}function cn(){Ot.call(this),this.v=new zt(this),(this.$b=this).fb=null}function ln(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function hn(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function fn(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a,s,u=t[o];u&&!u.va&&u.capture==n&&(a=u.listener,s=u.Ua||u.src,u.Oa&&Ht(e.v,u),i=!1!==a.call(s,r)&&i)}return i&&!r.defaultPrevented}function pn(e,t,n){if(g(e))n&&(e=v(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=v(e.handleEvent,e)}return 2147483647<Number(t)?-1:h.setTimeout(e,t||0)}function dn(n){var r=null;return new ht(function(e,t){-1==(r=pn(function(){e(void 0)},n))&&t(Error("Failed to schedule timer."))}).o(function(e){throw h.clearTimeout(r),e})}function gn(e){if(e.V&&"function"==typeof e.V)return e.V();if("string"==typeof e)return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function yn(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.V||"function"!=typeof e.V){if(d(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function mn(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof mn)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function vn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];bn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){for(var i={},n=t=0;t<e.a.length;)bn(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function bn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}w(cn,Ot),cn.prototype[Vt]=!0,cn.prototype.addEventListener=function(e,t,n,r){Xt(this,e,t,n,r)},cn.prototype.removeEventListener=function(e,t,n,r){Zt(this,e,t,n,r)},cn.prototype.dispatchEvent=function(e){var t,n=this.fb;if(n)for(t=[];n;n=n.fb)t.push(n);n=this.$b;var r=e.type||e;if("string"==typeof e?e=new Ut(e,n):e instanceof Ut?e.target=e.target||n:(a=e,fe(e=new Ut(r,n),a)),a=!0,t)for(var i=t.length-1;0<=i;i--)var o=e.b=t[i],a=fn(o,r,!0,e)&&a;if(a=fn(o=e.b=n,r,!0,e)&&a,a=fn(o,r,!1,e)&&a,t)for(i=0;i<t.length;i++)a=fn(o=e.b=t[i],r,!1,e)&&a;return a},cn.prototype.Da=function(){if(cn.$a.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Wt(n[r]);delete t.a[e],t.b--}}this.fb=null},(e=mn.prototype).V=function(){vn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.Y=function(){return vn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return bn(this.b,e)?this.b[e]:t},e.set=function(e,t){bn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var _n=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function wn(e,t){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,e instanceof wn?(this.i=void 0!==t?t:e.i,En(this,e.f),this.l=e.l,this.a=e.a,Tn(this,e.g),this.c=e.c,In(this,Kn(e.b)),this.h=e.h):e&&(n=String(e).match(_n))?(this.i=!!t,En(this,n[1]||"",!0),this.l=Nn(n[2]||""),this.a=Nn(n[3]||"",!0),Tn(this,n[4]),this.c=Nn(n[5]||"",!0),In(this,n[6]||"",!0),this.h=Nn(n[7]||"")):(this.i=!!t,this.b=new Fn(null,this.i))}function En(e,t,n){e.f=n?Nn(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Tn(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.g=t}else e.g=null}function In(e,t,n){var r,i;t instanceof Fn?(e.b=t,r=e.b,(i=e.i)&&!r.f&&(Un(r),r.c=null,r.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(jn(this,t),Bn(this,n,e))},r)),r.f=i):(n||(t=Dn(t,Ln)),e.b=new Fn(t,e.i))}function Sn(e,t,n){e.b.set(t,n)}function Cn(e,t){return e.b.get(t)}function An(e){return e instanceof wn?new wn(e):new wn(e,void 0)}function kn(e,t,n,r){var i=new wn(null,void 0);return e&&En(i,e),t&&(i.a=t),n&&Tn(i,n),r&&(i.c=r),i}function Nn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Dn(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Rn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Rn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}wn.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Dn(t,On,!0),":");var n=this.a;return!n&&"file"!=t||(e.push("//"),(t=this.l)&&e.push(Dn(t,On,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(Dn(n,"/"==n.charAt(0)?xn:Pn,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",Dn(n,Mn)),e.join("")},wn.prototype.resolve=function(e){var t=new wn(this),n=!!e.f;n?En(t,e.f):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r,i=e.c;if(n)Tn(t,e.g);else if(n=!!e.c)if("/"!=i.charAt(0)&&(this.a&&!this.c?i="/"+i:-1!=(r=t.c.lastIndexOf("/"))&&(i=t.c.substr(0,r+1)+i)),".."==(r=i)||"."==r)i="";else if(ie(r,"./")||ie(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r;return n?t.c=i:n=""!==e.b.toString(),n?In(t,Kn(e.b)):n=!!e.h,n&&(t.h=e.h),t};var On=/[#\/\?@]/g,Pn=/[#\?:]/g,xn=/[#\?]/g,Ln=/[#\?@]/g,Mn=/#/g;function Fn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Un(o){o.a||(o.a=new mn,o.b=0,o.c&&function(e){if(e){e=e.split("&");for(var t=0;t<e.length;t++){var n,r=e[t].indexOf("="),i=null;0<=r?(n=e[t].substring(0,r),i=e[t].substring(r+1)):n=e[t],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function qn(e){var t=yn(e);if(void 0===t)throw Error("Keys are undefined");var n=new Fn(null,void 0);e=gn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?Bn(n,i,o):n.add(i,o)}return n}function jn(e,t){Un(e),t=Wn(e,t),bn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,bn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&vn(e)))}function Vn(e,t){return Un(e),t=Wn(e,t),bn(e.a.b,t)}function Bn(e,t,n){jn(e,t),0<n.length&&(e.c=null,e.a.set(Wn(e,t),Q(n)),e.b+=n.length)}function Kn(e){var t=new Fn;return t.c=e.c,e.a&&(t.a=new mn(e.a),t.b=e.b),t}function Wn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function zn(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),e(t,i[a],r),o=",";return r.push("]"),0}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&(a=n[i],"function"!=typeof a&&(r.push(o),Yn(i,r),r.push(":"),e(t,a,r),o=","));return r.push("}"),0}n=n.valueOf()}switch(typeof n){case"string":Yn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Hn,e,t),t.join("")}function Hn(){}(e=Fn.prototype).add=function(e,t){Un(this),this.c=null,e=Wn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(n,r){Un(this),this.a.forEach(function(e,t){j(e,function(e){n.call(r,e,t,this)},this)},this)},e.Y=function(){Un(this);for(var e=this.a.V(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.V=function(e){Un(this);var t=[];if("string"==typeof e)Vn(this,e)&&(t=G(t,this.a.get(Wn(this,e))));else{e=this.a.V();for(var n=0;n<e.length;n++)t=G(t,e[n])}return t},e.set=function(e,t){return Un(this),this.c=null,Vn(this,e=Wn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.V(r),o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}return this.c=e.join("&")};var Gn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Qn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Yn(e,t){t.push('"',e.replace(Qn,function(e){var t=Gn[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Gn[e]=t),t}),'"')}function Xn(){var e=gr();return Ke&&$e&&11==$e||/Edge\/\d+/.test(e)}function Jn(){return h.window&&h.window.location.href||self&&self.location&&self.location.href||""}function $n(e,t){t=t||h.window;var n="about:blank";e&&(n=Ae(Re(e)||xe)),t.location.href=n}function Zn(e){return!!((e=(e||gr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function er(e){e=e||h.window;try{e.close()}catch(e){}}function tr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=gr().toLowerCase(),r&&(t.target=r,ie(n,"crios/")&&(t.target="_blank")),fr(gr())==lr&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Ce?n:Re(void 0!==n.href?n.href:String(n))||xe,n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((se("iPhone")&&!se("iPod")&&!se("iPad")||se("iPad")||se("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(pe(a=ot(document,"A"),"HTMLAnchorElement"),t=t instanceof Ce?t:Oe(t),a.href=Ae(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=Fe("",r,n,a),e=Ae(t),a&&(ze&&ie(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+qe(e)+'">',e=new Le(e=(r=be())?r.createHTML(e):e,0,Me),r=a.document)&&(r.write((o=e)instanceof Le&&o.constructor===Le?o.a:(P("expected object of type SafeHtml, got '"+o+"' of type "+p(o)),"type_error:SafeHtml")),r.close())):(a=Fe(t,r,n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(e){}return a}var nr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rr=/^[^@]+@[^@]+$/;function ir(){var t=null;return new ht(function(e){"complete"==h.document.readyState?e():(t=function(){e()},$t(window,"load",t))}).o(function(e){throw Zt(window,"load",t),e})}function or(e){return e=e||gr(),!("file:"!==_r()&&"ionic:"!==_r()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function ar(){var e=h.window;try{return e&&e!=e.top}catch(e){return}}function sr(){return void 0!==h.WorkerGlobalScope&&"function"==typeof h.importScripts}function ur(){return jh.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":jh.INTERNAL.hasOwnProperty("node")?"Node":sr()?"Worker":"Browser"}function cr(){var e=ur();return"ReactNative"===e||"Node"===e}var lr="Firefox",hr="Chrome";function fr(e){var t=e.toLowerCase();return ie(t,"opera/")||ie(t,"opr/")||ie(t,"opios/")?"Opera":ie(t,"iemobile")?"IEMobile":ie(t,"msie")||ie(t,"trident/")?"IE":ie(t,"edge/")?"Edge":ie(t,"firefox/")?lr:ie(t,"silk/")?"Silk":ie(t,"blackberry")?"Blackberry":ie(t,"webos")?"Webos":!ie(t,"safari/")||ie(t,"chrome/")||ie(t,"crios/")||ie(t,"android")?!ie(t,"chrome/")&&!ie(t,"crios/")||ie(t,"edge/")?ie(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":hr:"Safari"}var pr={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function dr(e,t){t=t||[];var n,r=[],i={};for(n in pr)i[pr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=ur())?r=fr(i=gr()):"Worker"===r&&(r=fr(i=gr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function gr(){return h.navigator&&h.navigator.userAgent||""}function yr(e,t){e=e.split("."),t=t||h;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function mr(){try{var e=h.localStorage,t=Sr();if(e)return e.setItem(t,"1"),e.removeItem(t),!Xn()||!!h.indexedDB}catch(e){return sr()&&!!h.indexedDB}return!1}function vr(){return(br()||"chrome-extension:"===_r()||or())&&!cr()&&mr()&&!sr()}function br(){return"http:"===_r()||"https:"===_r()}function _r(){return h.location&&h.location.protocol||null}function wr(e){return!Zn(e=e||gr())&&fr(e)!=lr}function Er(e){return void 0===e?null:zn(e)}function Tr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function Ir(e){if(null!==e)return JSON.parse(e)}function Sr(e){return e||Math.floor(1e9*Math.random()).toString()}function Cr(e){return"Safari"!=fr(e=e||gr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Ar(){var e=h.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function kr(e,t){if(t<e)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=gr(),t=ur(),this.b=Zn(e)||"ReactNative"===t}function Nr(){var e=h.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function Dr(e){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e)}function Rr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function Or(){return yr("fireauth.oauthhelper",h)||yr("fireauth.iframe",h)}kr.prototype.get=function(){var e=h.navigator;return!e||"boolean"!=typeof e.onLine||!br()&&"chrome-extension:"!==_r()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Pr,xr={};function Lr(e){xr[e]||(xr[e]=!0,Dr(e))}try{var Mr={};Object.defineProperty(Mr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Mr,"abcd",{configurable:!0,enumerable:!0,value:2}),Pr=2==Mr.abcd}catch(e){Pr=!1}function Fr(e,t,n){Pr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Ur(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Fr(e,n,t[n])}function qr(e){var t={};return Ur(t,e),t}function jr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Fr(t,n,jr(e[n]));return t}function Vr(e){var t=e&&(e[Hr]?"phone":null);if(!(t&&e&&e[zr]))throw new T("internal-error","Internal assert: invalid MultiFactorInfo object");Fr(this,"uid",e[zr]),Fr(this,"displayName",e[Kr]||null);var n=null;e[Wr]&&(n=new Date(e[Wr]).toUTCString()),Fr(this,"enrollmentTime",n),Fr(this,"factorId",t)}function Br(e){try{var t=new Gr(e)}catch(e){t=null}return t}Vr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Kr="displayName",Wr="enrolledAt",zr="mfaEnrollmentId",Hr="phoneInfo";function Gr(e){Vr.call(this,e),Fr(this,"phoneNumber",e[Hr])}function Qr(e){var t={},n=e[$r],r=e[ei],i=e[ti];if(e=Br(e[Zr]),!i||i!=Xr&&i!=Jr&&!n||i==Jr&&!r||i==Yr&&!e)throw Error("Invalid checkActionCode response!");i==Jr?(t[ri]=n||null,t[oi]=n||null,t[ni]=r):(t[ri]=r||null,t[oi]=r||null,t[ni]=n||null),t[ii]=e||null,Fr(this,si,i),Fr(this,ai,jr(t))}w(Gr,Vr),Gr.prototype.w=function(){var e=Gr.$a.w.call(this);return e.phoneNumber=this.phoneNumber,e};var Yr="REVERT_SECOND_FACTOR_ADDITION",Xr="EMAIL_SIGNIN",Jr="VERIFY_AND_CHANGE_EMAIL",$r="email",Zr="mfaInfo",ei="newEmail",ti="requestType",ni="email",ri="fromEmail",ii="multiFactorInfo",oi="previousEmail",ai="data",si="operation";function ui(e){var t=Cn(e=An(e),ci)||null,n=Cn(e,li)||null,r=(r=Cn(e,pi)||null)&&gi[r]||null;if(!t||!n||!r)throw new T("argument-error",ci+", "+li+"and "+pi+" are required in a valid action code URL.");Ur(this,{apiKey:t,operation:r,code:n,continueUrl:Cn(e,hi)||null,languageCode:Cn(e,fi)||null,tenantId:Cn(e,di)||null})}var ci="apiKey",li="oobCode",hi="continueUrl",fi="languageCode",pi="mode",di="tenantId",gi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:Yr,signIn:Xr,verifyAndChangeEmail:Jr,verifyEmail:"VERIFY_EMAIL"};function yi(e){try{return new ui(e)}catch(e){return null}}function mi(e){var t=e[Ei];if(void 0===t)throw new T("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new T("invalid-continue-uri");if(this.h=t,this.b=this.a=null,this.g=!1,(r=e[vi])&&"object"==typeof r){t=r[Si];var n=r[Ti],r=r[Ii];if("string"==typeof t&&t.length){if(this.a=t,void 0!==n&&"boolean"!=typeof n)throw new T("argument-error",Ti+" property must be a boolean when specified.");if(this.g=!!n,void 0!==r&&("string"!=typeof r||"string"==typeof r&&!r.length))throw new T("argument-error",Ii+" property must be a non empty string when specified.");this.b=r||null}else{if(void 0!==t)throw new T("argument-error",Si+" property must be a non empty string when specified.");if(void 0!==n||void 0!==r)throw new T("missing-android-pkg-name")}}else if(void 0!==r)throw new T("argument-error",vi+" property must be a non null object when specified.");if(this.f=null,(t=e[wi])&&"object"==typeof t){if("string"==typeof(t=t[Ci])&&t.length)this.f=t;else if(void 0!==t)throw new T("argument-error",Ci+" property must be a non empty string when specified.")}else if(void 0!==t)throw new T("argument-error",wi+" property must be a non null object when specified.");if(void 0!==(t=e[_i])&&"boolean"!=typeof t)throw new T("argument-error",_i+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[bi])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new T("argument-error",bi+" property must be a non empty string when specified.");this.i=e||null}var vi="android",bi="dynamicLinkDomain",_i="handleCodeInApp",wi="iOS",Ei="url",Ti="installApp",Ii="minimumVersion",Si="packageName",Ci="bundleId";function Ai(e){var t,n={};for(t in n.continueUrl=e.h,n.canHandleCodeInApp=e.c,(n.androidPackageName=e.a)&&(n.androidMinimumVersion=e.b,n.androidInstallApp=e.g),n.iOSBundleId=e.f,n.dynamicLinkDomain=e.i,n)null===n[t]&&delete n[t];return n}var ki=null;function Ni(e){var t=Ri(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.g=e,this.c=t.exp,this.h=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Di(e){try{return new Ni(e)}catch(e){return null}}function Ri(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t,n=(4-(e=e[1]).length%4)%4,r=0;r<n;r++)e+=".";try{return JSON.parse((t="",function(r,e){function t(e){for(;i<r.length;){var t=r.charAt(i++),n=ki[t];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(t))throw Error("Unknown base64 encoding at char: "+t)}return e}!function(){if(!ki){ki={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;n<5;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===ki[o]&&(ki[o]=i)}}}();for(var i=0;;){var n=t(-1),o=t(0),a=t(64),s=t(64);if(64===s&&-1===n)break;e(n<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(e,function(e){t+=String.fromCharCode(e)}),t))}catch(e){}return null}Ni.prototype.S=function(){return this.f},Ni.prototype.i=function(){return this.b},Ni.prototype.toString=function(){return this.g};var Oi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Pi=["client_id","response_type","scope","redirect_uri","state"],xi={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:Pi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:Pi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:Pi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:Oi},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function Li(e){for(var t in xi)if(xi[t].fa==e)return xi[t];return null}function Mi(e){var t={};t["facebook.com"]=Vi,t["google.com"]=Ki,t["github.com"]=Bi,t["twitter.com"]=Wi;var n=e&&e[Ui];try{if(n)return new(t[n]||ji)(e);if(void 0!==e[Fi])return new qi(e)}catch(e){}return null}var Fi="idToken",Ui="providerId";function qi(e){var t,n=e[Ui];if(n||!e[Fi]||(t=Di(e[Fi]))&&t.a&&(n=t.a),!n)throw Error("Invalid additional user info!");"anonymous"!=n&&"custom"!=n||(n=null),t=!1,void 0!==e.isNewUser?t=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(t=!0),Fr(this,"providerId",n),Fr(this,"isNewUser",t)}function ji(e){qi.call(this,e),Fr(this,"profile",jr((e=Ir(e.rawUserInfo||"{}"))||{}))}function Vi(e){if(ji.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Bi(e){if(ji.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Fr(this,"username",this.profile&&this.profile.login||null)}function Ki(e){if(ji.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Wi(e){if(ji.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Fr(this,"username",e.screenName||null)}function zi(e){var t=Cn(r=An(e),"link"),n=Cn(An(t),"link"),r=Cn(r,"deep_link_id");return Cn(An(r),"link")||r||n||t||e}function Hi(e,t){if(!e&&!t)throw new T("internal-error","Internal assert: no raw session string available");if(e&&t)throw new T("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?Gi:Qi}w(ji,qi),w(Vi,ji),w(Bi,ji),w(Ki,ji),w(Wi,ji);var Gi="enroll",Qi="signin";function Yi(){}function Xi(e,n){return e.then(function(e){if(e[Ua]){var t=Di(e[Ua]);if(!t||n!=t.h)throw new T("user-mismatch");return e}throw new T("user-mismatch")}).o(function(e){throw e&&e.code&&e.code==C+"user-not-found"?new T("user-mismatch"):e})}function Ji(e,t){if(!t)throw new T("internal-error","failed to construct a credential");this.a=t,Fr(this,"providerId",e),Fr(this,"signInMethod",e)}function $i(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function Zi(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new Ji(e.providerId,e.pendingToken)}catch(e){}return null}function eo(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&Fr(this,"idToken",t.idToken),t.accessToken&&Fr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&Fr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new T("internal-error","failed to construct a credential");Fr(this,"accessToken",t.oauthToken),Fr(this,"secret",t.oauthTokenSecret)}Fr(this,"providerId",e),Fr(this,"signInMethod",n)}function to(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:qn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function no(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new eo(e.providerId,t,e.signInMethod)}catch(e){}}return null}function ro(e,t){this.Pc=t||[],Ur(this,{providerId:e,isOAuthProvider:!0}),this.Hb={},this.ob=(Li(e)||{}).Ja||null,this.nb=null}function io(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new T("argument-error",'SAML provider IDs must be prefixed with "saml."');ro.call(this,e,[])}function oo(e){ro.call(this,e,Pi),this.a=[]}function ao(){oo.call(this,"facebook.com")}function so(e){if(!e)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new ao).credential({accessToken:t})}function uo(){oo.call(this,"github.com")}function co(e){if(!e)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new uo).credential({accessToken:t})}function lo(){oo.call(this,"google.com"),this.Ca("profile")}function ho(e,t){var n=e;return y(e)&&(n=e.idToken,t=e.accessToken),(new lo).credential({idToken:n,accessToken:t})}function fo(){ro.call(this,"twitter.com",Oi)}function po(e,t){var n=e;if(y(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new T("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new eo("twitter.com",n,"twitter.com")}function go(e,t,n){this.a=e,this.f=t,Fr(this,"providerId","password"),Fr(this,"signInMethod",n===mo.EMAIL_LINK_SIGN_IN_METHOD?mo.EMAIL_LINK_SIGN_IN_METHOD:mo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function yo(e){return e&&e.email&&e.password?new go(e.email,e.password,e.signInMethod):null}function mo(){Ur(this,{providerId:"password",isOAuthProvider:!1})}function vo(e,t){if(!(t=bo(t)))throw new T("argument-error","Invalid email link!");return new go(e,t.code,mo.EMAIL_LINK_SIGN_IN_METHOD)}function bo(e){return(e=yi(e=zi(e)))&&e.operation===Xr?e:null}function _o(e){if(!(e.cb&&e.bb||e.La&&e.ea))throw new T("internal-error");this.a=e,Fr(this,"providerId","phone"),this.fa="phone",Fr(this,"signInMethod","phone")}function wo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var n={};return j(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(e){t[e]&&(n[e]=t[e])}),new _o(n)}return null}function Eo(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.cb,code:e.a.bb}}function To(e){try{this.a=e||jh.auth()}catch(e){throw new T("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ur(this,{providerId:"phone",isOAuthProvider:!1})}function Io(e,t){if(!e)throw new T("missing-verification-id");if(!t)throw new T("missing-verification-code");return new _o({cb:e,bb:t})}function So(e){if(e.temporaryProof&&e.phoneNumber)return new _o({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return ho(o,n);case"facebook.com":return so(n);case"github.com":return co(n);case"twitter.com":return po(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new Ji(t,a):new eo(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new oo(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(e){return null}}function Co(e){if(!e.isOAuthProvider)throw new T("invalid-oauth-provider")}function Ao(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new T("invalid-auth-event");if(this.g&&this.a)throw new T("invalid-auth-event");if(this.g&&!this.f)throw new T("invalid-auth-event")}function ko(e){return(e=e||{}).type?new Ao(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&I(e.error),e.postBody,e.tenantId):null}function No(){this.b=null,this.a=[]}Hi.prototype.Ha=function(){return this.a?vt(this.a):vt(this.b)},Hi.prototype.w=function(){return this.type==Gi?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Yi.prototype.ja=function(){},Yi.prototype.b=function(){},Yi.prototype.c=function(){},Yi.prototype.w=function(){},Ji.prototype.ja=function(e){return os(e,$i(this))},Ji.prototype.b=function(e,t){var n=$i(this);return n.idToken=t,as(e,n)},Ji.prototype.c=function(e,t){return Xi(ss(e,$i(this)),t)},Ji.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},eo.prototype.ja=function(e){return os(e,to(this))},eo.prototype.b=function(e,t){var n=to(this);return n.idToken=t,as(e,n)},eo.prototype.c=function(e,t){return Xi(ss(e,to(this)),t)},eo.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},ro.prototype.Ka=function(e){return this.Hb=le(e),this},w(io,ro),w(oo,ro),oo.prototype.Ca=function(e){return W(this.a,e)||this.a.push(e),this},oo.prototype.Pb=function(){return Q(this.a)},oo.prototype.credential=function(e,t){if(!(t=y(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!t.accessToken)throw new T("argument-error","credential failed: must provide the ID token and/or the access token.");return new eo(this.providerId,t,this.providerId)},w(ao,oo),Fr(ao,"PROVIDER_ID","facebook.com"),Fr(ao,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),w(uo,oo),Fr(uo,"PROVIDER_ID","github.com"),Fr(uo,"GITHUB_SIGN_IN_METHOD","github.com"),w(lo,oo),Fr(lo,"PROVIDER_ID","google.com"),Fr(lo,"GOOGLE_SIGN_IN_METHOD","google.com"),w(fo,ro),Fr(fo,"PROVIDER_ID","twitter.com"),Fr(fo,"TWITTER_SIGN_IN_METHOD","twitter.com"),go.prototype.ja=function(e){return this.signInMethod==mo.EMAIL_LINK_SIGN_IN_METHOD?Bs(e,gs,{email:this.a,oobCode:this.f}):Bs(e,Fs,{email:this.a,password:this.f})},go.prototype.b=function(e,t){return this.signInMethod==mo.EMAIL_LINK_SIGN_IN_METHOD?Bs(e,ys,{idToken:t,email:this.a,oobCode:this.f}):Bs(e,Ns,{idToken:t,email:this.a,password:this.f})},go.prototype.c=function(e,t){return Xi(this.ja(e),t)},go.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Ur(mo,{PROVIDER_ID:"password"}),Ur(mo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ur(mo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),_o.prototype.ja=function(e){return e.eb(Eo(this))},_o.prototype.b=function(e,t){var n=Eo(this);return n.idToken=t,Bs(e,qs,n)},_o.prototype.c=function(e,t){var n=Eo(this);return n.operation="REAUTH",Xi(e=Bs(e,js,n),t)},_o.prototype.w=function(){var e={providerId:"phone"};return this.a.cb&&(e.verificationId=this.a.cb),this.a.bb&&(e.verificationCode=this.a.bb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},To.prototype.eb=function(r,i){var o=this.a.a;return vt(i.verify()).then(function(t){if("string"!=typeof t)throw new T("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");if("recaptcha"!==i.type)throw new T("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.');var e=y(r)?r.session:null,n=y(r)?r.phoneNumber:r;return(e=e&&e.type==Gi?e.Ha().then(function(e){return Bs(o,Rs,{idToken:e,phoneEnrollmentInfo:{phoneNumber:n,recaptchaToken:t}}).then(function(e){return e.phoneSessionInfo.sessionInfo})}):e&&e.type==Qi?e.Ha().then(function(e){return e={mfaPendingCredential:e,mfaEnrollmentId:r.multiFactorHint&&r.multiFactorHint.uid||r.multiFactorUid,phoneSignInInfo:{recaptchaToken:t}},Bs(o,Os,e).then(function(e){return e.phoneResponseInfo.sessionInfo})}):Bs(o,As,{phoneNumber:n,recaptchaToken:t})).then(function(e){return"function"==typeof i.reset&&i.reset(),e},function(e){throw"function"==typeof i.reset&&i.reset(),e})})},Ur(To,{PROVIDER_ID:"phone"}),Ur(To,{PHONE_SIGN_IN_METHOD:"phone"}),Ao.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},Ao.prototype.S=function(){return this.h},Ao.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Do,Ro=null;function Oo(e){var t="unauthorized-domain",n=void 0,r=An(e);e=r.a,"chrome-extension"==(r=r.f)?n=Ue("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=Ue("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",T.call(this,t,n)}function Po(e,t,n){T.call(this,e,n),(e=t||{}).Ib&&Fr(this,"email",e.Ib),e.ea&&Fr(this,"phoneNumber",e.ea),e.credential&&Fr(this,"credential",e.credential),e.Yb&&Fr(this,"tenantId",e.Yb)}function xo(e){if(e.code){var t=e.code||"";0==t.indexOf(C)&&(t=t.substring(C.length));var n={credential:So(e),Yb:e.tenantId};if(e.email)n.Ib=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new T(t,e.message||void 0);return new Po(t,n,e.message)}return null}function Lo(){}function Mo(e){return e.c||(e.c=e.b())}function Fo(){}function Uo(e){if(e.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return e.f;for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function qo(){}function jo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=v(this.pc,this),this.a.onerror=v(this.Rb,this),this.a.onprogress=v(this.qc,this),this.a.ontimeout=v(this.uc,this)}function Vo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Bo(e,t,n){this.reset(e,t,n,void 0,void 0)}function Ko(e){this.f=e,this.b=this.c=this.a=null}function Wo(e,t){this.name=e,this.value=t}w(Oo,T),w(Po,T),Po.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&fe(e,t),e},Po.prototype.toJSON=function(){return this.w()},Lo.prototype.c=null,w(Fo,Lo),Fo.prototype.a=function(){var e=Uo(this);return e?new ActiveXObject(e):new XMLHttpRequest},Fo.prototype.b=function(){var e={};return Uo(this)&&(e[0]=!0,e[1]=!0),e},Do=new Fo,w(qo,Lo),qo.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new jo;throw Error("Unsupported browser")},qo.prototype.b=function(){return{}},(e=jo.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Vo(this,4)},e.Rb=function(){this.status=500,this.response=this.responseText="",Vo(this,4)},e.uc=function(){this.Rb()},e.qc=function(){this.status=200,Vo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Bo.prototype.a=null,Bo.prototype.reset=function(e,t,n,r,i){delete this.a},Wo.prototype.toString=function(){return this.name};var zo=new Wo("SEVERE",1e3),Ho=new Wo("WARNING",900),Go=new Wo("CONFIG",700),Qo=new Wo("FINE",500);Ko.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c||(t.a?e(t.a):(P("Root logger has no level set."),null))}(this).value)for(g(t)&&(t=t()),e=new Bo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Yo,Xo={},Jo=null;function $o(e){var t,n,r;return Jo||(Jo=new Ko(""),(Xo[""]=Jo).c=Go),(t=Xo[e])||(t=new Ko(e),r=e.lastIndexOf("."),n=e.substr(r+1),(r=$o(e.substr(0,r))).b||(r.b={}),(r.b[n]=t).a=r,Xo[e]=t),t}function Zo(e,t){e&&e.log(Qo,t,void 0)}function ea(e){this.f=e}function ta(e){cn.call(this),this.u=e,this.h=void 0,this.readyState=na,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=$o("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}w(ea,Lo),ea.prototype.a=function(){return new ta(this.f)},ea.prototype.b=(Yo={},function(){return Yo}),w(ta,cn);var na=0;function ra(e){e.c.read().then(e.oc.bind(e)).catch(e.Ta.bind(e))}function ia(e){e.readyState=4,e.g=null,e.c=null,e.m=null,oa(e)}function oa(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function aa(e){cn.call(this),this.headers=new mn,this.O=e||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.s=null,this.m=sa,this.u=this.R=!1}(e=ta.prototype).open=function(e,t){if(this.readyState!=na)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,oa(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.tc.bind(this),this.Ta.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ia(this)),this.readyState=na},e.tc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,oa(this)),this.a&&(this.readyState=3,oa(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==h.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,ra(this)):e.text().then(this.sc.bind(this),this.Ta.bind(this)))))},e.oc=function(e){var t;this.a&&((t=this.m.decode(e.value||new Uint8Array(0),{stream:!e.done}))&&(this.response=this.responseText+=t),(e.done?ia:oa)(this),3==this.readyState&&ra(this))},e.sc=function(e){this.a&&(this.response=this.responseText=e,ia(this))},e.rc=function(e){this.a&&(this.response=e,ia(this))},e.Ta=function(e){var t=this.i;t&&t.log(Ho,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&ia(this)},e.setRequestHeader=function(e,t){this.l.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(Ho,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(Ho,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ta.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),w(aa,cn);var sa="";aa.prototype.b=$o("goog.net.XhrIo");var ua=/^https?$/i,ca=["POST","PUT"];function la(e){return"content-type"==e.toLowerCase()}function ha(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,fa(e),da(e)}function fa(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function pa(e){if(e.c&&void 0!==l)if(e.A[1]&&4==ya(e)&&2==ma(e))Zo(e.b,va(e,"Local request error detected and ignored"));else if(e.i&&4==ya(e))pn(e.Ub,0,e);else if(e.dispatchEvent("readystatechange"),4==ya(e)){Zo(e.b,va(e,"Request complete")),e.c=!1;try{var t,n,r,i,o=ma(e);e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}if((t=a)||((n=0===o)&&(!(i=String(e.l).match(_n)[1]||null)&&h.self&&h.self.location&&(i=(r=h.self.location.protocol).substr(0,r.length-1)),n=!ua.test(i?i.toLowerCase():"")),t=n),t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var s=2<ya(e)?e.a.statusText:""}catch(t){Zo(e.b,"Can not get status: "+t.message),s=""}e.h=s+" ["+ma(e)+"]",fa(e)}}finally{da(e)}}}function da(e,t){if(e.a){ga(e);var n=e.a,r=e.A[0]?a:null;e.a=null,e.A=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(zo,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function ga(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(h.clearTimeout(e.s),e.s=null)}function ya(e){return e.a?e.a.readyState:0}function ma(e){try{return 2<ya(e)?e.a.status:-1}catch(e){return-1}}function va(e,t){return t+" ["+e.P+" "+e.l+" "+ma(e)+"]"}function ba(e){var t=Da;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function _a(e,t,n){e.a=!0,e.c=n,e.f=!t,Ia(e)}function wa(e){if(e.a){if(!e.m)throw new Sa;e.m=!1}}function Ea(e,t,n,r){e.g.push([t,n,r]),e.a&&Ia(e)}function Ta(e){return K(e.g,function(e){return g(e[1])})}function Ia(e){var t,n;e.h&&e.a&&Ta(e)&&(t=e.h,(n=ka[t])&&(h.clearTimeout(n.a),delete ka[t]),e.h=0),e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=(a=e.g.shift())[0],o=a[1],a=a[2];if(i=e.f?o:i)try{var s=i.call(a||e.s,t);void 0!==s&&(e.f=e.f&&(s==t||s instanceof Error),e.c=t=s),(D(t)||"function"==typeof h.Promise&&t instanceof h.Promise)&&(r=!0,e.i=!0)}catch(r){t=r,e.f=!0,Ta(e)||(n=!0)}}e.c=t,r&&(s=v(e.v,e,!0),r=v(e.v,e,!1),t instanceof ba?(Ea(t,s,r),t.A=!0):t.then(s,r)),n&&(t=new Aa(t),ka[t.a]=t,e.h=t.a)}function Sa(){R.call(this)}function Ca(){R.call(this)}function Aa(e){this.a=h.setTimeout(v(this.c,this),0),this.b=e}(e=aa.prototype).Ma=function(){void 0!==l&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Zo(this.b,va(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Zo(this.b,va(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),da(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),da(this,!0)),aa.$a.Da.call(this)},e.Ub=function(){this.xa||(this.N||this.i||this.f?pa(this):this.Ic())},e.Ic=function(){pa(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case sa:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(zo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return Zo(this.b,"Can not get response: "+e.message),null}},ba.prototype.cancel=function(e){var t;this.a?this.c instanceof ba&&this.c.cancel():(this.b&&(t=this.b,delete this.b,e?t.cancel(e):(t.l--,t.l<=0&&t.cancel())),this.u?this.u.call(this.s,this):this.m=!0,this.a||(e=new Ca,wa(this),_a(this,!1,e)))},ba.prototype.v=function(e,t){this.i=!1,_a(this,e,t)},ba.prototype.then=function(e,t,n){var r,i,o=new ht(function(e,t){r=e,i=t});return Ea(this,r,function(e){e instanceof Ca?o.cancel():i(e)}),o.then(e,t,n)},ba.prototype.$goog_Thenable=!0,w(Sa,R),Sa.prototype.message="Deferred has already fired",Sa.prototype.name="AlreadyCalledError",w(Ca,R),Ca.prototype.message="Deferred was canceled",Ca.prototype.name="CanceledError",Aa.prototype.c=function(){throw delete ka[this.a],this.b};var ka={};function Na(e){var t=document,n=we(e).toString(),r=ot(document,"SCRIPT"),i={Vb:r,Ma:void 0},o=new ba(i),a=window.setTimeout(function(){Ra(r,!0);var e=new xa(Pa,"Timeout reached for loading script "+n);wa(o),_a(o,!1,e)},5e3);return i.Ma=a,r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Ra(r,!1,a),wa(o),_a(o,!0,null))},r.onerror=function(){Ra(r,!0,a);var e=new xa(Oa,"Error while loading script "+n);wa(o),_a(o,!1,e)},fe(i={},{type:"text/javascript",charset:"UTF-8"}),tt(r,i),i=e,pe(e=r,"HTMLScriptElement"),e.src=we(i),(i=(i=e.ownerDocument&&e.ownerDocument.defaultView)&&i!=h?f(i.document):(null===s&&(s=f(h.document)),s))&&e.setAttribute("nonce",i),((t=((i=t)||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:i.documentElement).appendChild(r),o}function Da(){var e;this&&this.Vb&&(e=this.Vb)&&"SCRIPT"==e.tagName&&Ra(e,!0,this.Ma)}function Ra(e,t,n){null!=n&&h.clearTimeout(n),e.onload=a,e.onerror=a,e.onreadystatechange=a,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var Oa=0,Pa=1;function xa(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),R.call(this,n),this.code=e}function La(e){this.f=e}function Ma(e,t,n){if(this.c=e,e=t||{},this.l=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=e.secureTokenTimeout||qa,this.g=le(e.secureTokenHeaders||ja),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=e.firebaseTimeout||Va,this.a=le(e.firebaseHeaders||Ba),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==ur(),!(n=h.XMLHttpRequest||n&&jh.INTERNAL.node&&jh.INTERNAL.node.XMLHttpRequest)&&!sr())throw new T("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,sr()?this.f=new ea(self):cr()?this.f=new La(n):this.f=new qo,this.b=null}w(xa,R),w(La,Lo),La.prototype.a=function(){return new this.f},La.prototype.b=function(){return{}};var Fa,Ua="idToken",qa=new kr(3e4,6e4),ja={"Content-Type":"application/x-www-form-urlencoded"},Va=new kr(3e4,6e4),Ba={"Content-Type":"application/json"};function Ka(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Wa(e,t){t&&(e.l=za("https://securetoken.googleapis.com/v1/token",t),e.h=za("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=za("https://identitytoolkit.googleapis.com/v2/",t))}function za(e,t){return e=An(e),t=An(t.url),e.c=e.a+e.c,En(e,t.f),e.a=t.a,Tn(e,t.g),e.toString()}function Ha(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function Ga(e,t,n,r,i,o,a){var s;(e=((s=fr(s=gr())==hr&&(s=s.match(/\sChrome\/(\d+)/i))&&2==s.length?parseInt(s[1],10):null)&&s<30||Ke&&$e&&!(9<$e))&&!sr()?(Fa=Fa||new ht(function(e,t){var n,r;n=e,r=t,((window.gapi||{}).client||{}).request?n():(h[Ya]=function(){((window.gapi||{}).client||{}).request?n():r(Error("CORS_UNSUPPORTED"))},Ea(Na(Ee(Qa,{onload:Ya})),null,function(){r(Error("CORS_UNSUPPORTED"))},void 0))}),v(e.s,e)):v(e.u,e))(t,n,r,i,o,a)}Ma.prototype.S=function(){return this.b},Ma.prototype.u=function(e,n,t,r,i,o){if(sr()&&(void 0===h.fetch||void 0===h.Headers||void 0===h.Request))throw new T("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a,s=new aa(this.f);o&&(s.g=Math.max(0,o),a=setTimeout(function(){s.dispatchEvent("timeout")},o)),ln(s,"complete",function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Zo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}n&&n(t)}),hn(s,"ready",function(){a&&clearTimeout(a),xt(this)}),hn(s,"timeout",function(){a&&clearTimeout(a),xt(this),n&&n(null)}),function(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.P=n,e.G=!1,e.c=!0,e.a=(e.O||Do).a(),e.A=e.O?Mo(e.O):Mo(Do),e.a.onreadystatechange=v(e.Ub,e);try{Zo(e.b,va(e,"Opening Xhr")),e.N=!0,e.a.open(n,String(t),!0),e.N=!1}catch(t){return Zo(e.b,va(e,"Error opening Xhr: "+t.message)),ha(e,t)}t=r||"";var o,a=new mn(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||"string"==typeof e)j(e,t,void 0);else for(var n=yn(e),r=gn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){a.set(t,e)}),i=function(e){e:{for(var t=la,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:"string"==typeof e?e.charAt(t):e[t]}(a.Y()),r=h.FormData&&t instanceof h.FormData,!W(ca,n)||i||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.R&&(e.a.withCredentials=e.R);try{ga(e),0<e.g&&(e.u=(o=e.a,Ke&&Je(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),Zo(e.b,va(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=v(e.Ma,e)):e.s=pn(e.Ma,e.g,e)),Zo(e.b,va(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){Zo(e.b,va(e,"Send error: "+t.message)),ha(e,t)}}(s,e,t,r,i)};var Qa=new de(ve,"https://apis.google.com/js/client.js?onload=%{onload}"),Ya="__fcb"+Math.floor(1e6*Math.random()).toString();function Xa(e){if("string"!=typeof(e=e.email)||!rr.test(e))throw new T("invalid-email")}function Ja(e){"email"in e&&Xa(e)}function $a(e){if(!e[Ua]){if(e.mfaPendingCredential)throw new T("multi-factor-auth-required",null,le(e));throw new T("internal-error")}}function Za(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new T("internal-error")}else{if(!e.sessionInfo)throw new T("missing-verification-id");if(!e.code)throw new T("missing-verification-code")}}Ma.prototype.s=function(e,n,r,i,o){var a=this;Fa.then(function(){window.gapi.client.setApiKey(a.c);var t=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:r,body:i,headers:o,authType:"none",callback:function(e){window.gapi.auth.setToken(t),n&&n(e)}})}).o(function(e){n&&n({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},Ma.prototype.yb=function(){return Bs(this,Ds,{})},Ma.prototype.Ab=function(e,t){return Bs(this,ks,{idToken:e,email:t})},Ma.prototype.Bb=function(e,t){return Bs(this,Ns,{idToken:e,password:t})};var es={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ts(e){if(!e.phoneVerificationInfo)throw new T("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new T("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new T("missing-verification-code")}function ns(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new T("internal-error")}function rs(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&Vn(e=new Fn(e.postBody),"nonce")&&(t.nonce=e.get("nonce"))),t}function is(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=xo(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=xo(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=xo(e)):e.errorMessage&&(t=Ks(e.errorMessage)),t)throw t;$a(e)}function os(e,t){return t.returnIdpCredential=!0,Bs(e,Ps,t)}function as(e,t){return t.returnIdpCredential=!0,Bs(e,Ls,t)}function ss(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Bs(e,xs,t)}function us(e){if(!e.oobCode)throw new T("invalid-action-code")}(e=Ma.prototype).Cb=function(e,r){var i={idToken:e},o=[];return ue(es,function(e,t){var n=r[t];null===n?o.push(e):t in r&&(i[t]=n)}),o.length&&(i.deleteAttribute=o),Bs(this,ks,i)},e.ub=function(e,t){return fe(e={requestType:"PASSWORD_RESET",email:e},t),Bs(this,Ts,e)},e.vb=function(e,t){return fe(e={requestType:"EMAIL_SIGNIN",email:e},t),Bs(this,_s,e)},e.tb=function(e,t){return fe(e={requestType:"VERIFY_EMAIL",idToken:e},t),Bs(this,ws,e)},e.Db=function(e,t,n){return fe(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),Bs(this,Es,e)},e.eb=function(e){return Bs(this,Us,e)},e.mb=function(e,t){return Bs(this,Cs,{oobCode:e,newPassword:t})},e.Qa=function(e){return Bs(this,ls,{oobCode:e})},e.ib=function(e){return Bs(this,cs,{oobCode:e})};var cs={endpoint:"setAccountInfo",B:us,Z:"email",C:!0},ls={endpoint:"resetPassword",B:us,F:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new T("internal-error")},C:!0},hs={endpoint:"signupNewUser",B:function(e){if(Xa(e),!e.password)throw new T("weak-password")},F:$a,U:!0,C:!0},fs={endpoint:"createAuthUri",C:!0},ps={endpoint:"deleteAccount",M:["idToken"]},ds={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(e){if(!Array.isArray(e.deleteProvider))throw new T("internal-error")}},gs={endpoint:"emailLinkSignin",M:["email","oobCode"],B:Xa,F:$a,U:!0,C:!0},ys={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:Xa,F:$a,U:!0},ms={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:ts,F:$a,C:!0,Na:!0},vs={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:ts,F:$a,C:!0,Na:!0},bs={endpoint:"getAccountInfo"},_s={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new T("internal-error");Xa(e)},Z:"email",C:!0},ws={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new T("internal-error")},Z:"email",C:!0},Es={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new T("internal-error")},Z:"email",C:!0},Ts={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(e){if("PASSWORD_RESET"!=e.requestType)throw new T("internal-error");Xa(e)},Z:"email",C:!0},Is={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Ss={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(e){if(!e.recaptchaSiteKey)throw new T("internal-error")}},Cs={endpoint:"resetPassword",B:us,Z:"email",C:!0},As={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},ks={endpoint:"setAccountInfo",M:["idToken"],B:Ja,U:!0},Ns={endpoint:"setAccountInfo",M:["idToken"],B:function(e){if(Ja(e),!e.password)throw new T("weak-password")},F:$a,U:!0},Ds={endpoint:"signupNewUser",F:$a,U:!0,C:!0},Rs={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(e){if(!e.phoneEnrollmentInfo)throw new T("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new T("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},Os={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},Ps={endpoint:"verifyAssertion",B:ns,Xa:rs,F:is,U:!0,C:!0},xs={endpoint:"verifyAssertion",B:ns,Xa:rs,F:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new T("user-not-found");if(e.errorMessage)throw Ks(e.errorMessage);$a(e)},U:!0,C:!0},Ls={endpoint:"verifyAssertion",B:function(e){if(ns(e),!e.idToken)throw new T("internal-error")},Xa:rs,F:is,U:!0},Ms={endpoint:"verifyCustomToken",B:function(e){if(!e.token)throw new T("invalid-custom-token")},F:$a,U:!0,C:!0},Fs={endpoint:"verifyPassword",B:function(e){if(Xa(e),!e.password)throw new T("wrong-password")},F:$a,U:!0,C:!0},Us={endpoint:"verifyPhoneNumber",B:Za,F:$a,C:!0},qs={endpoint:"verifyPhoneNumber",B:function(e){if(!e.idToken)throw new T("internal-error");Za(e)},F:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",xo(e);$a(e)}},js={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:Za,F:$a,C:!0},Vs={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(e){if(!!e[Ua]^!!e.refreshToken)throw new T("internal-error")},C:!0,Na:!0};function Bs(e,t,n){if(!function(e,t){if(!t||!t.length)return 1;if(e){for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return}return 1}}(n,t.M))return bt(new T("internal-error"));var r,i=!!t.Na,o=t.Tb||"POST";return vt(n).then(t.B).then(function(){return t.U&&(n.returnSecureToken=!0),t.C&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),function(e,t,n,r,i,o,a){var s=An(t+n);Sn(s,"key",e.c),a&&Sn(s,"cb",_().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Sn(s,c,i[c]);return new ht(function(t,n){Ga(e,s.toString(),function(e){e?e.error?n(Ws(e,o||{})):t(e):n(new T("network-request-failed"))},r,u?void 0:zn(Tr(i)),e.a,e.m.get())})}(e,i?e.i:e.h,t.endpoint,o,n,t.Gb,t.kb||!1)}).then(function(e){return r=e,t.Xa?t.Xa(n,r):r}).then(t.F).then(function(){if(!t.Z)return r;if(!(t.Z in r))throw new T("internal-error");return r[t.Z]})}function Ks(e){return Ws({error:{errors:[{message:e}],code:400,message:e}})}function Ws(e,t){var n,r=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(r=i[r]?new T(i[r]):null)return r;for(n in r=e.error&&e.error.message||"",fe(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=r.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,i)if(0===r.indexOf(n))return new T(i[n],t);return!t&&e&&(t=Er(e)),new T("internal-error",t)}function zs(e){var o;this.b=e,this.a=null,this.qb=(o=this,(Ys=Ys||new ht(function(e,t){function n(){Ar(),yr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Ar(),t(Error("Network Error"))},timeout:Gs.get()})}var r;yr("gapi.iframes.Iframe")?e():yr("gapi.load")?n():(r="__iframefcb"+Math.floor(1e6*Math.random()).toString(),h[r]=function(){yr("gapi.load")?n():t(Error("Network Error"))},vt(Na(Ee(Hs,{onload:r}))).o(function(){t(Error("Network Error"))}))}).o(function(e){throw Ys=null,e})).then(function(){return new ht(function(r,i){yr("gapi.iframes.getContext")().open({where:document.body,url:o.b,messageHandlersFilter:yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(e){function t(){clearTimeout(n),r()}o.a=e,o.a.restyle({setHideOnLeave:!1});var n=setTimeout(function(){i(Error("Network Error"))},Qs.get());e.ping(t).then(t,function(){i(Error("Network Error"))})})})}))}var Hs=new de(ve,"https://apis.google.com/js/api.js?onload=%{onload}"),Gs=new kr(3e4,6e4),Qs=new kr(5e3,15e3),Ys=null;function Xs(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,e=this.g?kn((e=An(this.g.url)).f,e.a,e.g,"/emulator/auth/iframe"):kn("https",this.l,null,"/__/auth/iframe"),this.a=e,Sn(this.a,"apiKey",this.h),Sn(this.a,"appName",this.i),this.b=null,this.c=[]}function Js(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function $s(e){try{return jh.app(e).auth().Ga()}catch(e){return[]}}function Zs(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function eu(e){var s=Jn();return Bs(e,Is,{}).then(function(e){return e.authorizedDomains||[]}).then(function(e){e:{for(var t=(n=An(s)).f,n=n.a,r=0;r<e.length;r++){var i=e[r],o=n,a=t;if(o=0==i.indexOf("chrome-extension://")?An(i).a==o&&"chrome-extension"==a:("http"==a||"https"==a)&&(nr.test(i)?o==i:(i=i.split(".").join("\\."),new RegExp("^(.+\\."+i+"|"+i+")$","i").test(o)))){e=!0;break e}}e=!1}if(!e)throw new Oo(Jn())})}function tu(i){return i.v||(i.v=ir().then(function(){var e,t,n,r;i.u||(e=i.c,t=i.i,n=$s(i.b),(r=new Xs(i.s,i.g,i.b,i.f)).f=e,r.b=t,r.c=Q(n||[]),i.u=r.toString()),i.m=new zs(i.u),function(r){if(!r.m)throw Error("IfcHandler must be initialized!");var e,t;e=r.m,t=function(e){var t={};if(e&&e.authEvent){var n=!1;for(e=ko(e.authEvent),t=0;t<r.h.length;t++)n=r.h[t](e)||n;return(t={}).status=n?"ACK":"ERROR",vt(t)}return t.status="ERROR",vt(t)},e.qb.then(function(){e.a.register("authEvent",t,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(i)})),i.v}function nu(e){return e.l||(e.A=e.c?dr(e.c,$s(e.b)):null,e.l=new Ma(e.g,N(e.i),e.A),e.f&&Wa(e.l,e.f)),e.l}function ru(e,t,n,r,i,o,a,s,u,c,l,h){return(e=new Js(e,t,n,r,i,h)).l=o,e.g=a,e.i=s,e.b=le(u||null),e.f=c,e.xb(l).toString()}function iu(e){if(this.a=e||jh.INTERNAL.reactNative&&jh.INTERNAL.reactNative.AsyncStorage,!this.a)throw new T("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ou(e){this.b=e,this.a={},this.f=v(this.c,this)}Xs.prototype.toString=function(){return this.f?Sn(this.a,"v",this.f):jn(this.a.b,"v"),this.b?Sn(this.a,"eid",this.b):jn(this.a.b,"eid"),this.c.length?Sn(this.a,"fw",this.c.join(",")):jn(this.a.b,"fw"),this.a.toString()},Js.prototype.xb=function(e){return this.h=e,this},Js.prototype.toString=function(){var e;if(Sn(e=this.m?kn((e=An(this.m.url)).f,e.a,e.g,"/emulator/auth/handler"):kn("https",this.u,null,"/__/auth/handler"),"apiKey",this.s),Sn(e,"appName",this.c),Sn(e,"authType",this.v),this.a.isOAuthProvider){var t,n=this.a;try{var r=jh.app(this.c).auth().ka()}catch(e){r=null}for(t in n.nb=r,Sn(e,"providerId",this.a.providerId),n=Tr((r=this.a).Hb))n[t]=n[t].toString();t=r.Pc,n=le(n);for(var i=0;i<t.length;i++){var o=t[i];o in n&&delete n[o]}r.ob&&r.nb&&!n[r.ob]&&(n[r.ob]=r.nb),ce(n)||Sn(e,"customParameters",Er(n))}if("function"==typeof this.a.Pb&&(r=this.a.Pb()).length&&Sn(e,"scopes",r.join(",")),this.l?Sn(e,"redirectUrl",this.l):jn(e.b,"redirectUrl"),this.g?Sn(e,"eventId",this.g):jn(e.b,"eventId"),this.i?Sn(e,"v",this.i):jn(e.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Cn(e,a)&&Sn(e,a,this.b[a]);return this.h?Sn(e,"tid",this.h):jn(e.b,"tid"),this.f?Sn(e,"eid",this.f):jn(e.b,"eid"),(a=$s(this.c)).length&&Sn(e,"fw",a.join(",")),e.toString()},(e=Zs.prototype).Nb=function(t,n,e){var r=new T("popup-closed-by-user"),i=new T("web-storage-unsupported"),o=this,a=!1;return this.la().then(function(){var e,r={type:"webStorageSupport"};tu(e=o).then(function(){return t=e.m,n=r,t.qb.then(function(){return new ht(function(e){t.a.send(n.type,n,e,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var t,n}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()}).then(function(e){e||(t&&er(t),n(i),a=!0)})}).o(function(){}).then(function(){if(!a)return n=t,new ht(function(t){return function e(){dn(2e3).then(function(){return n&&!n.closed?e():void t()})}()});var n}).then(function(){if(!a)return dn(e).then(function(){n(r)})})},e.Wb=function(){var e=gr();return!wr(e)&&!Cr(e)},e.Sb=function(){return!1},e.Lb=function(t,e,n,r,i,o,a,s){if(!t)return bt(new T("popup-blocked"));if(a&&!wr())return this.la().o(function(e){er(t),i(e)}),r(),vt();this.a||(this.a=eu(nu(this)));var u=this;return this.a.then(function(){var e=u.la().o(function(e){throw er(t),i(e),e});return r(),e}).then(function(){Co(n),a||$n(ru(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)}).o(function(e){throw"auth/network-request-failed"==e.code&&(u.a=null),e})},e.Mb=function(e,t,n,r){this.a||(this.a=eu(nu(this)));var i=this;return this.a.then(function(){Co(t),$n(ru(i.s,i.g,i.b,e,t,Jn(),n,i.c,void 0,i.i,r,i.f))}).o(function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e})},e.la=function(){var e=this;return tu(this).then(function(){return e.m.qb}).o(function(){throw e.a=null,new T("network-request-failed")})},e.Zb=function(){return!0},e.Ea=function(e){this.h.push(e)},e.Ra=function(t){H(this.h,function(e){return e==t})},(e=iu.prototype).get=function(e){return vt(this.a.getItem(e)).then(function(e){return e&&Ir(e)})},e.set=function(e,t){return vt(this.a.setItem(e,Er(t)))},e.T=function(e){return vt(this.a.removeItem(e))},e.ca=function(){},e.ia=function(){};var au,su=[];function uu(e,t,n){ce(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function cu(e){this.a=e}function lu(e){this.c=e,this.b=!1,this.a=[]}function hu(r,e,t,n){var i,o,a,s,u=t||{},c=null;if(r.b)return bt(Error("connection_unavailable"));var l=n?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new ht(function(t,n){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){n(Error("unsupported_event"))},l),c={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout(function(){n(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?t(e.data.response):n(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),n(Error("invalid_response"))))}},r.a.push(c),h.port1.addEventListener("message",o),r.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):n(Error("connection_unavailable"))}).then(function(e){return fu(r,c),e}).o(function(e){throw fu(r,c),e})}function fu(e,t){var n,r;t&&(n=t.messageChannel,r=t.onMessage,n&&(n.port1.removeEventListener("message",r),n.port1.close()),H(e.a,function(e){return e==t}))}function pu(){if(!yu())throw new T("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.v=h.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.l=null,this.s=!1,this.h=null;var e,t,n,r=this;sr()&&self?(this.m=(n=sr()?self:null,j(su,function(e){e.b==n&&(t=e)}),t||(t=new ou(n),su.push(t)),t),uu(this.m,"keyChanged",function(e,n){return wu(r).then(function(t){return 0<t.length&&j(r.a,function(e){e(t)}),{keyProcessed:W(t,n.key)}})}),uu(this.m,"ping",function(){return vt(["keyChanged"])})):((e=h.navigator)&&e.serviceWorker?vt().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).o(function(){return null}):vt(null)).then(function(e){(r.h=e)&&(r.g=new lu(new cu(e)),hu(r.g,"ping",null,!0).then(function(e){e[0].fulfilled&&W(e[0].value,"keyChanged")&&(r.s=!0)}).o(function(){}))})}function du(e){return e.i||(e.i=function i(o){return new ht(function(t,n){var e=o.v.open("firebaseLocalStorageDb",1);e.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},e.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},e.onsuccess=function(e){var r;(e=e.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(e):(r=o,new ht(function(e,t){var n=r.v.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){e()},n.onerror=function(e){t(Error(e.target.error))}}).then(function(){return i(o)}).then(function(e){t(e)}).o(function(e){n(e)}))}})}(e)),e.i}function gu(i,e){var o=0;return new ht(function t(n,r){du(i).then(e).then(n).o(function(e){return 3<++o?void r(e):du(i).then(function(e){return e.close(),i.i=void 0,t(n,r)}).o(function(e){r(e)})})})}function yu(){try{return h.indexedDB}catch(e){return}}function mu(e){return e.objectStore("firebaseLocalStorage")}function vu(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function bu(e){return new ht(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function _u(e,t){return e.g&&e.h&&((n=h.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===e.h?hu(e.g,"keyChanged",{key:t},e.s).then(function(){}).o(function(){}):vt();var n}function wu(r){return du(r).then(function(e){var i=mu(vu(e,!1));return i.getAll?bu(i.getAll()):new ht(function(t,n){var r=[],e=i.openCursor();e.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},e.onerror=function(e){n(e.target.error)}})}).then(function(e){var t={},n=[];if(0==r.b){for(n=0;n<e.length;n++)t[e[n].fbase_key]=e[n].value;n=function e(t,n){var r,i=[];for(r in t)r in n&&typeof t[r]==typeof n[r]?"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(r.c,t),r.c=t}return n})}function Eu(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Tu(e){var r=this,i=null;this.a=[],this.type="indexedDB",this.c=e,this.b=vt().then(function(){if(yu()){var t=Sr(),n="__sak"+t;return au=au||new pu,(i=au).set(n,t).then(function(){return i.get(n)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return i.T(n)}).then(function(){return i}).o(function(){return r.c})}return r.c}).then(function(e){return r.type=e.type,e.ca(function(t){j(r.a,function(e){e(t)})}),e})}function Iu(){this.a={},this.type="inMemory"}function Su(){if(!function(){var e="Node"==ur();if(e=Cu()||e&&jh.INTERNAL.node&&jh.INTERNAL.node.localStorage)try{return e.setItem("__sak","1"),e.removeItem("__sak"),1}catch(e){return}}()){if("Node"==ur())throw new T("internal-error","The LocalStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Cu()||jh.INTERNAL.node.localStorage,this.type="localStorage"}function Cu(){try{var e=h.localStorage,t=Sr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function Au(){this.type="nullStorage"}function ku(){if(!function(){var e="Node"==ur();if(e=Nu()||e&&jh.INTERNAL.node&&jh.INTERNAL.node.sessionStorage)try{return e.setItem("__sak","1"),e.removeItem("__sak"),1}catch(e){return}}()){if("Node"==ur())throw new T("internal-error","The SessionStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Nu()||jh.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Nu(){try{var e=h.sessionStorage,t=Sr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function Du(){var e={};e.Browser=Pu,e.Node=xu,e.ReactNative=Lu,e.Worker=Mu,this.a=e[ur()]}ou.prototype.c=function(n){var t,r=n.data.eventType,i=n.data.eventId,e=this.a[r];e&&0<e.length&&(n.ports[0].postMessage({status:"ack",eventId:i,eventType:r,response:null}),t=[],j(e,function(e){t.push(vt().then(function(){return e(n.origin,n.data.data)}))}),wt(t).then(function(e){var t=[];j(e,function(e){t.push({fulfilled:e.Ob,value:e.value,reason:e.reason?e.reason.message:void 0})}),j(t,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:t})}))},cu.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},lu.prototype.close=function(){for(;0<this.a.length;)fu(this,this.a[0]);this.b=!0},(e=pu.prototype).set=function(r,i){var o=this,a=!1;return gu(this,function(e){return bu((e=mu(vu(e,!0))).get(r))}).then(function(n){return gu(o,function(e){if(e=mu(vu(e,!0)),n)return n.value=i,bu(e.put(n));o.b++,a=!0;var t={};return t.fbase_key=r,t.value=i,bu(e.add(t))})}).then(function(){return o.c[r]=i,_u(o,r)}).na(function(){a&&o.b--})},e.get=function(t){return gu(this,function(e){return bu(mu(vu(e,!1)).get(t))}).then(function(e){return e&&e.value})},e.T=function(t){var n=this,r=!1;return gu(this,function(e){return r=!0,n.b++,bu(mu(vu(e,!0)).delete(t))}).then(function(){return delete n.c[t],_u(n,t)}).na(function(){r&&n.b--})},e.ca=function(e){var n;0==this.a.length&&(Eu(n=this),function t(){n.f=setTimeout(function(){n.l=wu(n).then(function(t){0<t.length&&j(n.a,function(e){e(t)})}).then(function(){t()}).o(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()),this.a.push(e)},e.ia=function(t){H(this.a,function(e){return e==t}),0==this.a.length&&Eu(this)},(e=Tu.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},e.set=function(t,n){return this.b.then(function(e){return e.set(t,n)})},e.T=function(t){return this.b.then(function(e){return e.T(t)})},e.ca=function(e){this.a.push(e)},e.ia=function(t){H(this.a,function(e){return e==t})},(e=Iu.prototype).get=function(e){return vt(this.a[e])},e.set=function(e,t){return this.a[e]=t,vt()},e.T=function(e){return delete this.a[e],vt()},e.ca=function(){},e.ia=function(){},(e=Su.prototype).get=function(e){var t=this;return vt().then(function(){return Ir(t.a.getItem(e))})},e.set=function(t,n){var r=this;return vt().then(function(){var e=Er(n);null===e?r.T(t):r.a.setItem(t,e)})},e.T=function(e){var t=this;return vt().then(function(){t.a.removeItem(e)})},e.ca=function(e){h.window&&Xt(h.window,"storage",e)},e.ia=function(e){h.window&&Zt(h.window,"storage",e)},(e=Au.prototype).get=function(){return vt(null)},e.set=function(){return vt()},e.T=function(){return vt()},e.ca=function(){},e.ia=function(){},(e=ku.prototype).get=function(e){var t=this;return vt().then(function(){return Ir(t.a.getItem(e))})},e.set=function(t,n){var r=this;return vt().then(function(){var e=Er(n);null===e?r.T(t):r.a.setItem(t,e)})},e.T=function(e){var t=this;return vt().then(function(){t.a.removeItem(e)})},e.ca=function(){},e.ia=function(){};var Ru,Ou,Pu={D:Su,ab:ku},xu={D:Su,ab:ku},Lu={D:iu,ab:Au},Mu={D:Su,ab:Au},Fu={qd:"local",NONE:"none",sd:"session"};function Uu(){var e=!(Cr(gr())||!ar()),t=wr(),n=mr();this.v=e,this.h=t,this.l=n,this.a={},e=Ru=Ru||new Du;try{this.g=!Xn()&&Or()||!h.indexedDB?new e.a.D:new Tu(new(sr()?Iu:e.a.D))}catch(e){this.g=new Iu,this.h=!0}try{this.i=new e.a.ab}catch(e){this.i=new Iu}this.m=new Iu,this.f=v(this.Xb,this),this.b={}}function qu(){return Ou=Ou||new Uu}function ju(e,t){switch(t){case"session":return e.i;case"none":return e.m;default:return e.g}}function Vu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function Bu(e,t,n){return n=Vu(t,n),"local"==t.D&&(e.b[n]=null),ju(e,t.D).T(n)}function Ku(e){e.c&&(clearInterval(e.c),e.c=null)}function Wu(e){this.a=e,this.b=qu()}(e=Uu.prototype).get=function(e,t){return ju(this,e.D).get(Vu(e,t))},e.set=function(t,e,n){var r=Vu(t,n),i=this,o=ju(this,t.D);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.D&&(i.b[r]=e)})},e.addListener=function(e,t,n){var r;e=Vu(e,t),this.l&&(this.b[e]=h.localStorage.getItem(e)),ce(this.a)&&(ju(this,"local").ca(this.f),this.h||(Xn()||!Or())&&h.indexedDB||!this.l||(Ku(r=this),r.c=setInterval(function(){for(var e in r.a){var t=h.localStorage.getItem(e),n=r.b[e];t!=n&&(r.b[e]=t,t=new qt({type:"storage",key:e,target:window,oldValue:n,newValue:t,a:!0}),r.Xb(t))}},1e3))),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Vu(e,t),this.a[e]&&(H(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),ce(this.a)&&(ju(this,"local").ia(this.f),Ku(this))},e.Xb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=h.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?ju(this,"local").ia(this.f):Ku(this),this.v)if(n=h.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?h.localStorage.setItem(t,r):h.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this,n=function(){void 0===e.a.a&&o.b[t]===h.localStorage.getItem(t)||(o.b[t]=h.localStorage.getItem(t),o.lb(t))};Ke&&$e&&10==$e&&h.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else j(e,v(this.lb,this))},e.lb=function(e){this.a[e]&&j(this.a[e],function(e){e()})};var zu,Hu={name:"authEvent",D:"local"};function Gu(){this.a=qu()}function Qu(e,t){this.b=Yu,this.f=h.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=h.Int32Array?new Int32Array(64):Array(64),void 0===zu&&(zu=h.Int32Array?new Int32Array(nc):nc),this.reset()}w(Qu,function(){this.b=-1});for(var Yu=64,Xu=Yu-1,Ju=[],$u=0;$u<Xu;$u++)Ju[$u]=0;var Zu=G(128,Ju);function ec(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;t<64;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;t<64;t++)var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0,a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|zu[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0;e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function tc(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"==typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(ec(e),i=0);else{if(!d(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(ec(e),i=0)}}e.c=i,e.g+=n}Qu.prototype.reset=function(){this.g=this.c=0,this.a=h.Int32Array?new Int32Array(this.h):Q(this.h)};var nc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function rc(){Qu.call(this,8,ic)}w(rc,Qu);var ic=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function oc(e,t,n,r,i,o){this.m=e,this.i=t,this.l=n,this.v=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.A=new Gu,this.g=new Wu(this.h),this.f=null,this.b=[],this.a=this.c=null}function ac(e){return new T("invalid-cordova-configuration",e)}function sc(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function uc(c){return c.f||(c.f=c.la().then(function(){return new ht(function(n){function t(r){e=!0,a&&a.cancel(),cc(i).then(function(e){var t,n=o;e&&r&&r.url&&(t=null,-1!=(n=zi(r.url)).indexOf("/__/auth/callback")&&(t=(t="object"==typeof(t=Ir(Cn(t=An(n),"firebaseError")||null))?I(t):null)?new Ao(e.c,e.b,null,null,t,null,e.S()):new Ao(e.c,e.b,n,e.f,null,null,e.S())),n=t||o),sc(i,n)})}var i,o,e,a,r,s,u;c.Ea(function e(t){return n(t),c.Ra(e),!1}),i=c,o=new Ao("unknown",null,null,null,new T("no-auth-event")),e=!1,a=dn(500).then(function(){return cc(i).then(function(){e||sc(i,o)})}),r=h.handleOpenURL,h.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(yr("BuildInfo.packageName",h).toLowerCase()+"://")&&t({url:e}),"function"==typeof r)try{r(e)}catch(e){console.error(e)}},Ro=Ro||new No,s=t,(u=Ro).a.push(s),u.b||(u.b=function(e){for(var t=0;t<u.a.length;t++)u.a[t](e)},"function"==typeof(s=yr("universalLinks.subscribe",h))&&s(null,u.b))})})),c.f}function cc(t){var e,n=null;return(e=t.g).b.get(Hu,e.a).then(ko).then(function(e){return n=e,Bu((e=t.g).b,Hu,e.a)}).then(function(){return n})}function lc(e){this.a=e,this.b=qu()}(e=oc.prototype).la=function(){return this.Ia||(this.Ia=(or(void 0)?ir().then(function(){return new ht(function(e,t){var n=h.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):bt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof yr("universalLinks.subscribe",h))throw ac("cordova-universal-links-plugin-fix is not installed");if(void 0===yr("BuildInfo.packageName",h))throw ac("cordova-plugin-buildinfo is not installed");if("function"!=typeof yr("cordova.plugins.browsertab.openUrl",h))throw ac("cordova-plugin-browsertab is not installed");if("function"!=typeof yr("cordova.InAppBrowser.open",h))throw ac("cordova-plugin-inappbrowser is not installed")},function(){throw new T("cordova-not-ready")}))},e.Nb=function(e,t){return t(new T("operation-not-supported-in-this-environment")),vt()},e.Lb=function(){return bt(new T("operation-not-supported-in-this-environment"))},e.Zb=function(){return!1},e.Wb=function(){return!0},e.Sb=function(){return!0},e.Mb=function(e,t,n,r){if(this.c)return bt(new T("redirect-operation-pending"));var i=this,o=h.document,a=null,s=null,u=null,c=null;return this.c=vt().then(function(){return Co(t),uc(i)}).then(function(){return function(n,e,t,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),a=new Ao(e,r,null,o,new T("no-auth-event"),null,i),s=yr("BuildInfo.packageName",h);if("string"!=typeof s)throw new T("invalid-cordova-configuration");var u=yr("BuildInfo.displayName",h),c={};if(gr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!gr().toLowerCase().match(/android/))return bt(new T("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=function(e){var t=new rc;tc(t,e),e=[];var n=8*t.g;t.c<56?tc(t,Zu,56-t.c):tc(t,Zu,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(ec(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return B(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}(o),c.sessionId=o;var l=ru(n.m,n.i,n.l,e,t,null,r,n.v,c,n.u,i,n.s);return n.la().then(function(){var e=n.h;return n.A.a.set(Hu,a.w(),e)}).then(function(){var e=yr("cordova.plugins.browsertab.isAvailable",h);if("function"!=typeof e)throw new T("invalid-cordova-configuration");var t=null;e(function(e){if(e){if("function"!=typeof(t=yr("cordova.plugins.browsertab.openUrl",h)))throw new T("invalid-cordova-configuration");t(l)}else{if("function"!=typeof(t=yr("cordova.InAppBrowser.open",h)))throw new T("invalid-cordova-configuration");e=gr(),n.a=t(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,e,t,n,r)}).then(function(){return new ht(function(t,e){s=function(){var e=yr("cordova.plugins.browsertab.close",h);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),u=function(){a=a||dn(2e3).then(function(){e(new T("redirect-cancelled-by-user"))})},c=function(){Nr()&&u()},o.addEventListener("resume",u,!1),gr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).o(function(e){return cc(i).then(function(){throw e})})}).na(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&i.Ra(s),i.c=null})},e.Ea=function(t){this.b.push(t),uc(this).o(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ao("unknown",null,null,null,new T("no-auth-event")),t(e))})},e.Ra=function(t){H(this.b,function(e){return e==t})};var hc={name:"pendingRedirect",D:"session"};function fc(e){return Bu(e.b,hc,e.a)}function pc(e,t,n,r){this.i={},this.u=0,this.O=e,this.m=t,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=v(this.s,this),this.b=new kc,this.A=new Pc,this.g=new lc(Cc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=dc(this.O,this.m,this.v,S,this.G)}function dc(e,t,n,r,i){var o=jh.SDK_VERSION||null;return new(or()?oc:Zs)(e,t,n,o,r,i)}function gc(t){t.f||(t.f=!0,t.a.Ea(t.l));var n=t.a;return t.a.la().o(function(e){throw t.a==n&&t.reset(),e})}function yc(n){n.a.Wb()&&gc(n).o(function(e){var t=new Ao("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Ec(e)&&n.s(t)}),n.a.Sb()||Nc(n.b)}function mc(n,e){W(n.h,e)||n.h.push(e),n.f||(e=n.g).b.get(hc,e.a).then(function(e){return"pending"==e}).then(function(e){e?fc(n.g).then(function(){gc(n).o(function(e){var t=new Ao("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Ec(e)&&n.s(t)})}):yc(n)}).o(function(){yc(n)})}function vc(e,t){H(e.h,function(e){return e==t})}pc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=dc(this.O,this.m,this.v,null,this.G),this.i={}},pc.prototype.s=function(e){if(!e)throw new T("invalid-auth-event");if(6e5<=_()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=_())),t=!0;break}}return Nc(this.b),t};var bc=new kr(2e3,1e4),_c=new kr(3e4,6e4);function wc(e,t,n,r,i,o,a){return e.a.Lb(t,n,r,function(){e.f||(e.f=!0,e.a.Ea(e.l))},function(){e.reset()},i,o,a)}function Ec(e){return e&&"auth/cordova-not-ready"==e.code}function Tc(t,e,n,r,i){var o,a;return(a=t.g).b.set(hc,"pending",a.a).then(function(){return t.a.Mb(e,n,r,i).o(function(e){if(Ec(e))throw new T("operation-not-supported-in-this-environment");return o=e,fc(t.g).then(function(){throw o})}).then(function(){return t.a.Zb()?new ht(function(){}):fc(t.g).then(function(){return t.qa()}).then(function(){}).o(function(){})})})}function Ic(e,t,n,r,i){return e.a.Nb(r,function(e){t.ma(n,null,e,i)},bc.get())}pc.prototype.qa=function(){return this.b.qa()};var Sc={};function Cc(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function Ac(e,t,n,r){var i=Cc(t,n,r);return Sc[i]||(Sc[i]=new pc(e,t,n,r)),Sc[i]}function kc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Nc(e){e.g||(e.g=!0,Oc(e,!1,null,null))}function Dc(e){e.g&&!e.i&&Oc(e,!1,null,null)}function Rc(e,t){if(e.b=function(){return vt(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Oc(e,t,n,r){t?r?function(e,t){if(e.b=function(){return bt(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):Rc(e,n):Rc(e,{user:null}),e.f=[],e.c=[]}function Pc(){}function xc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(e){this.hb=e},enumerable:!1})}function Lc(e,t){this.a=t,Fr(this,"verificationId",e)}function Mc(e,t,n,r){return new To(e).eb(t,n).then(function(e){return new Lc(e,r)})}function Fc(e){var t=Ri(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new T("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ur(this,{token:e,expirationTime:Rr(1e3*t.exp),authTime:Rr(1e3*t.auth_time),issuedAtTime:Rr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function Uc(e,t,n){var r=t&&t[jc];if(!r)throw new T("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=le(t),this.g=n,this.c=new Hi(null,r),this.b=[];var i=this;j(t[qc]||[],function(e){(e=Br(e))&&i.b.push(e)}),Fr(this,"auth",this.a),Fr(this,"session",this.c),Fr(this,"hints",this.b)}kc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},kc.prototype.h=function(e,t){var n,r,i,o;e?(this.reset(),this.g=!0,n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code,this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Oc(this,!0,null,e.a),vt()):t.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then(function(e){Oc(t,s,e,null)}).o(function(e){Oc(t,s,null,e)})}(this,e,t):bt(new T("invalid-auth-event")):(Oc(this,!1,null,null),vt())):bt(new T("invalid-auth-event"))},kc.prototype.qa=function(){var i=this;return new ht(function(e,t){var n,r;i.b?i.b().then(e,t):(i.f.push(e),i.c.push(t),n=i,r=new T("timeout"),n.a&&n.a.cancel(),n.a=dn(_c.get()).then(function(){n.b||(n.g=!0,Oc(n,!0,null,r))}))})},Pc.prototype.h=function(e,t){var n,r,i,o,a;e?(n=e.c,r=e.b,e.a?(t.ma(e.c,null,e.a,e.b),vt()):t.Fa(n,r)?(i=t,o=e.b,a=e.c,i.Fa(a,o)(e.g,e.f,e.S(),e.i).then(function(e){i.ma(a,e,null,o)}).o(function(e){i.ma(a,null,e,o)})):bt(new T("invalid-auth-event"))):bt(new T("invalid-auth-event"))},Lc.prototype.confirm=function(e){return e=Io(this.verificationId,e),this.a(e)};var qc="mfaInfo",jc="mfaPendingCredential";function Vc(e,t,n,r){T.call(this,"multi-factor-auth-required",r,t),this.b=new Uc(e,t,n),Fr(this,"resolver",this.b)}function Bc(e,t,n){if(e&&y(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new Vc(t,e.serverResponse,n,e.message)}catch(e){}return null}function Kc(){}function Wc(e){Fr(this,"factorId",e.fa),this.a=e}function zc(e){if(Wc.call(this,e),this.a.fa!=To.PROVIDER_ID)throw new T("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Hc(e,t){for(var n in Ut.call(this,e),t)this[n]=t[n]}function Gc(e,t){this.a=e,this.b=[],this.c=v(this.xc,this),Xt(this.a,"userReloaded",this.c);var r=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&j(t.multiFactor.enrolledFactors,function(e){var t=null,n={};if(e){e.uid&&(n[zr]=e.uid),e.displayName&&(n[Kr]=e.displayName),e.enrollmentTime&&(n[Wr]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(n[Hr]=e.phoneNumber);try{t=new Gr(n)}catch(e){}e=t}else e=null;e&&r.push(e)}),Qc(this,r)}function Qc(e,t){e.b=t,Fr(e,"enrolledFactors",t)}function Yc(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Xc(e){this.c=e,this.b=this.a=null}function Jc(e){return e.b&&1e3*e.b.c||0}function $c(e,t){var n=t.refreshToken;e.b=Di(t[Ua]||""),e.a=n}function Zc(e,t){this.a=e||null,this.b=t||null,Ur(this,{lastSignInTime:Rr(t||null),creationTime:Rr(e||null)})}function el(e,t,n,r,i,o){Ur(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function tl(e,t,n){this.G=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var r,i=jh.SDK_VERSION?dr(jh.SDK_VERSION):null;this.a=new Ma(this.l,N(S),i),e.emulatorConfig&&Wa(this.a,e.emulatorConfig),this.b=new Xc(this.a),cl(this,t[Ua]),$c(this.b,t),Fr(this,"refreshToken",this.b.a),fl(this,n||{}),cn.call(this),this.P=!1,this.s&&vr()&&(this.i=Ac(this.s,this.l,this.m)),this.R=[],this.f=null,this.u=(r=this,new Yc(function(){return r.I(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var e=Jc(r.b)-_()-3e5;return 0<e?e:0})),this.$=v(this.gb,this);var o=this;this.pa=null,this.Ba=function(e){o.wa(e.h)},this.ba=null,this.za=function(e){Wa(o.a,e.c)},this.W=null,this.X=[],this.Aa=function(e){il(o,e.f)},this.aa=null,this.N=new Gc(this,n),Fr(this,"multiFactor",this.N)}function nl(e,t){e.ba&&Zt(e.ba,"languageCodeChanged",e.Ba),(e.ba=t)&&Xt(t,"languageCodeChanged",e.Ba)}function rl(e,t){e.W&&Zt(e.W,"emulatorConfigChanged",e.za),(e.W=t)&&Xt(t,"emulatorConfigChanged",e.za)}function il(e,t){e.X=t,Ha(e.a,jh.SDK_VERSION?dr(jh.SDK_VERSION,e.X):null)}function ol(e,t){e.aa&&Zt(e.aa,"frameworkChanged",e.Aa),(e.aa=t)&&Xt(t,"frameworkChanged",e.Aa)}function al(t){try{return jh.app(t.m).auth()}catch(e){throw new T("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function sl(e){e.A||e.u.b||(e.u.start(),Zt(e,"tokenChanged",e.$),Xt(e,"tokenChanged",e.$))}function ul(e){Zt(e,"tokenChanged",e.$),e.u.stop()}function cl(e,t){e.ya=t,Fr(e,"_lat",t)}function ll(e){for(var t=[],n=0;n<e.R.length;n++)t.push(e.R[n](e));return wt(t).then(function(){return e})}function hl(e){e.i&&!e.P&&(e.P=!0,mc(e.i,e))}function fl(e,t){Ur(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new Zc(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function pl(){}function dl(e){return vt().then(function(){if(e.A)throw new T("app-deleted")})}function gl(e){return B(e.providerData,function(e){return e.providerId})}function yl(e,t){t&&(ml(e,t.providerId),e.providerData.push(t))}function ml(e,t){H(e.providerData,function(e){return e.providerId==t})}function vl(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Fr(e,t,n)}function bl(t,e){var n,r;t!=e&&(Ur(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Fr(t,"metadata",new Zc((r=e.metadata).a,r.b)):Fr(t,"metadata",new Zc),j(e.providerData,function(e){yl(t,e)}),n=t.b,r=e.b,n.b=r.b,n.a=r.a,Fr(t,"refreshToken",t.b.a),Qc(t.N,e.N.b))}function _l(r){return r.I().then(function(e){var t,n=r.isAnonymous;return Bs((t=r).a,bs,{idToken:e}).then(v(t.Jc,t)).then(function(){return n||vl(r,"isAnonymous",!1),e})})}function wl(e,t){t[Ua]&&e.ya!=t[Ua]&&($c(e.b,t),e.dispatchEvent(new Hc("tokenChanged")),cl(e,t[Ua]),vl(e,"refreshToken",e.b.a))}function El(e,t){return _l(e).then(function(){if(W(gl(e),t))return ll(e).then(function(){throw new T("provider-already-linked")})})}function Tl(e,t,n){return qr({user:e,credential:So(t),additionalUserInfo:t=Mi(t),operationType:n})}function Il(e,t){return wl(e,t),e.reload().then(function(){return e})}function Sl(n,r,e,t,i){if(!vr())return bt(new T("operation-not-supported-in-this-environment"));if(n.f&&!i)return bt(n.f);var o=Li(e.providerId),a=Sr(n.uid+":::"),s=null;(!wr()||ar())&&n.s&&e.isOAuthProvider&&(s=ru(n.s,n.l,n.m,r,e,null,a,jh.SDK_VERSION||null,null,null,n.tenantId));var u=tr(s,o&&o.ua,o&&o.ta);return t=t().then(function(){if(Al(n),!i)return n.I().then(function(){})}).then(function(){return wc(n.i,u,r,e,a,!!s,n.tenantId)}).then(function(){return new ht(function(e,t){n.ma(r,null,new T("cancelled-popup-request"),n.h||null),n.g=e,n.O=t,n.h=a,n.c=Ic(n.i,n,r,u,a)})}).then(function(e){return u&&er(u),e?qr(e):null}).o(function(e){throw u&&er(u),e}),kl(n,t,i)}function Cl(t,e,n,r,i){if(!vr())return bt(new T("operation-not-supported-in-this-environment"));if(t.f&&!i)return bt(t.f);var o=null,a=Sr(t.uid+":::");return r=r().then(function(){if(Al(t),!i)return t.I().then(function(){})}).then(function(){return t.ga=a,ll(t)}).then(function(e){return t.ha&&(e=(e=t.ha).b.set(Rl,t.w(),e.a)),e}).then(function(){return Tc(t.i,e,n,a,t.tenantId)}).o(function(e){if(o=e,t.ha)return Ol(t.ha);throw o}).then(function(){if(o)throw o}),kl(t,r,i)}function Al(e){if(!e.i||!e.P){if(e.i&&!e.P)throw new T("internal-error");throw new T("auth-domain-config-required")}}function kl(n,e,t){var r,i=(r=n).f&&!t?(e.cancel(),bt(r.f)):e.o(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(r.f||r.dispatchEvent(new Hc("userInvalidated")),r.f=e),e});return n.G.push(i),i.na(function(){z(n.G,i)}),i.o(function(e){var t=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(t=Bc(e.w(),al(n),v(n.ic,n))),t||e})}function Nl(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[Ua]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=new tl(t,n,e);return e.providerData&&j(e.providerData,function(e){e&&yl(r,qr(e))}),e.redirectEventId&&(r.ga=e.redirectEventId),r}function Dl(e){this.a=e,this.b=qu()}Uc.prototype.Qc=function(e){var n=this;return e.rb(this.a.a,this.c).then(function(e){var t=le(n.f);return delete t[qc],delete t[jc],fe(t,e),n.g(t)})},w(Vc,T),Kc.prototype.rb=function(e,t,n){return t.type==Gi?(o=this,a=e,s=n,t.Ha().then(function(e){return e={idToken:e},void 0!==s&&(e.displayName=s),fe(e,{phoneVerificationInfo:Eo(o.a)}),Bs(a,ms,e)})):(r=this,i=e,t.Ha().then(function(e){return fe(e={mfaPendingCredential:e},{phoneVerificationInfo:Eo(r.a)}),Bs(i,vs,e)}));var r,i,o,a,s},w(Wc,Kc),w(zc,Wc),w(Hc,Ut),(e=Gc.prototype).xc=function(e){var t;Qc(this,(e=e.gd,t=[],j(e.mfaInfo||[],function(e){(e=Br(e))&&t.push(e)}),t))},e.Qb=function(){return this.a.I().then(function(e){return new Hi(e,null)})},e.ec=function(t,n){var r=this,i=this.a.a;return this.Qb().then(function(e){return t.rb(i,e,n)}).then(function(e){return wl(r.a,e),r.a.reload()})},e.ad=function(e){var n=this,r="string"==typeof e?e:e.uid,t=this.a.a;return this.a.I().then(function(e){return Bs(t,Vs,{idToken:e,mfaEnrollmentId:r})}).then(function(e){var t=V(n.b,function(e){return e.uid!=r});return Qc(n,t),wl(n.a,e),n.a.reload().o(function(e){if("auth/user-token-expired"!=e.code)throw e})})},e.w=function(){return{multiFactor:{enrolledFactors:B(this.b,function(e){return e.w()})}}},Yc.prototype.start=function(){this.a=this.c,function t(n,e){var r;n.stop(),n.b=dn((r=n,(e=e)?(r.a=r.c,r.g()):(e=r.a,r.a*=2,r.a>r.f&&(r.a=r.f),e))).then(function(){return t=h.document,n=null,Nr()||!t?vt():new ht(function(e){n=function(){Nr()&&(t.removeEventListener("visibilitychange",n,!1),e())},t.addEventListener("visibilitychange",n,!1)}).o(function(e){throw t.removeEventListener("visibilitychange",n,!1),e});var t,n}).then(function(){return n.h()}).then(function(){t(n,!0)}).o(function(e){n.i(e)&&t(n,!1)})}(this,!0)},Yc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Xc.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:Jc(this)}},Xc.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?bt(new T("user-token-expired")):e||!this.b||_()>Jc(this)-3e4?this.a?(e={grant_type:"refresh_token",refresh_token:(t=this).a},r=t.c,i=e,new ht(function(t,n){"refresh_token"==i.grant_type&&i.refresh_token||"authorization_code"==i.grant_type&&i.code?Ga(r,r.l+"?key="+encodeURIComponent(r.c),function(e){e?e.error?n(Ws(e)):e.access_token&&e.refresh_token?t(e):n(new T("internal-error")):n(new T("network-request-failed"))},"POST",qn(i).toString(),r.g,r.v.get()):n(new T("internal-error"))}).then(function(e){return t.b=Di(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}}).o(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})):vt(null):vt({accessToken:this.b.toString(),refreshToken:this.a});var t,r,i},Zc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},w(tl,cn),tl.prototype.wa=function(e){this.pa=e,Ka(this.a,e)},tl.prototype.ka=function(){return this.pa},tl.prototype.Ga=function(){return Q(this.X)},tl.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},Fr(tl.prototype,"providerId","firebase"),(e=tl.prototype).reload=function(){var e=this;return kl(this,dl(this).then(function(){return _l(e).then(function(){return ll(e)}).then(pl)}))},e.nc=function(e){return this.I(e).then(function(e){return new Fc(e)})},e.I=function(e){var t=this;return kl(this,dl(this).then(function(){return t.b.getToken(e)}).then(function(e){if(!e)throw new T("internal-error");return e.accessToken!=t.ya&&(cl(t,e.accessToken),t.dispatchEvent(new Hc("tokenChanged"))),vl(t,"refreshToken",e.refreshToken),e.accessToken}))},e.Jc=function(e){if(!(e=e.users)||!e.length)throw new T("internal-error");fl(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t,n=(t=e.providerUserInfo)&&t.length?B(t,function(e){return new el(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[],r=0;r<n.length;r++)yl(this,n[r]);vl(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new Hc("userReloaded",{gd:e}))},e.Kc=function(e){return Lr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(e)},e.sb=function(e){var t=this,n=null;return kl(this,e.c(this.a,this.uid).then(function(e){return wl(t,e),n=Tl(t,e,"reauthenticate"),t.f=null,t.reload()}).then(function(){return n}),!0)},e.Bc=function(e){return Lr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(e)},e.pb=function(t){var n=this,r=null;return kl(this,El(this,t.providerId).then(function(){return n.I()}).then(function(e){return t.b(n.a,e)}).then(function(e){return r=Tl(n,e,"link"),Il(n,e)}).then(function(){return r}))},e.Cc=function(e,t){var n=this;return kl(this,El(this,"phone").then(function(){return Mc(al(n),e,t,v(n.pb,n))}))},e.Lc=function(e,t){var n=this;return kl(this,vt().then(function(){return Mc(al(n),e,t,v(n.sb,n))}),!0)},e.Ab=function(t){var n=this;return kl(this,this.I().then(function(e){return n.a.Ab(e,t)}).then(function(e){return wl(n,e),n.reload()}))},e.dd=function(t){var n=this;return kl(this,this.I().then(function(e){return t.b(n.a,e)}).then(function(e){return wl(n,e),n.reload()}))},e.Bb=function(t){var n=this;return kl(this,this.I().then(function(e){return n.a.Bb(e,t)}).then(function(e){return wl(n,e),n.reload()}))},e.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return dl(this);var n=this;return kl(this,this.I().then(function(e){return n.a.Cb(e,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(e){return wl(n,e),vl(n,"displayName",e.displayName||null),vl(n,"photoURL",e.photoUrl||null),j(n.providerData,function(e){"password"===e.providerId&&(Fr(e,"displayName",n.displayName),Fr(e,"photoURL",n.photoURL))}),ll(n)}).then(pl))},e.bd=function(t){var n=this;return kl(this,_l(this).then(function(e){return W(gl(n),t)?Bs(n.a,ds,{idToken:e,deleteProvider:[t]}).then(function(e){var t={};return j(e.providerUserInfo||[],function(e){t[e.providerId]=!0}),j(gl(n),function(e){t[e]||ml(n,e)}),t[To.PROVIDER_ID]||Fr(n,"phoneNumber",null),ll(n)}):ll(n).then(function(){throw new T("no-such-provider")})}))},e.delete=function(){var t=this;return kl(this,this.I().then(function(e){return Bs(t.a,ps,{idToken:e})}).then(function(){t.dispatchEvent(new Hc("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");nl(t,null),rl(t,null),ol(t,null),t.G=[],t.A=!0,ul(t),Fr(t,"refreshToken",null),t.i&&vc(t.i,t)})},e.Eb=function(e,t){return!!("linkViaPopup"==e&&(this.h||null)==t&&this.g||"reauthViaPopup"==e&&(this.h||null)==t&&this.g||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},e.ma=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.h||null)||(n&&this.O?this.O(n):t&&!n&&this.g&&this.g(t),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.h||null)?v(this.Jb,this):"reauthViaPopup"==e&&t==(this.h||null)?v(this.Kb,this):"linkViaRedirect"==e&&(this.ga||null)==t?v(this.Jb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?v(this.Kb,this):null},e.Dc=function(e){var t=this;return Sl(this,"linkViaPopup",e,function(){return El(t,e.providerId).then(function(){return ll(t)})},!1)},e.Mc=function(e){return Sl(this,"reauthViaPopup",e,function(){return vt()},!0)},e.Ec=function(e){var t=this;return Cl(this,"linkViaRedirect",e,function(){return El(t,e.providerId)},!1)},e.Nc=function(e){return Cl(this,"reauthViaRedirect",e,function(){return vt()},!0)},e.Jb=function(t,n,e,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return e=this.I().then(function(e){return as(i.a,{requestUri:t,postBody:r,sessionId:n,idToken:e})}).then(function(e){return o=Tl(i,e,"link"),Il(i,e)}).then(function(){return o}),kl(this,e)},e.Kb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return kl(this,vt().then(function(){return Xi(ss(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)}).then(function(e){return o=Tl(i,e,"reauthenticate"),wl(i,e),i.f=null,i.reload()}).then(function(){return o}),!0)},e.tb=function(t){var n=this,r=null;return kl(this,this.I().then(function(e){return r=e,void 0===t||ce(t)?{}:Ai(new mi(t))}).then(function(e){return n.a.tb(r,e)}).then(function(e){if(n.email!=e)return n.reload()}).then(function(){}))},e.Db=function(t,n){var r=this,i=null;return kl(this,this.I().then(function(e){return i=e,void 0===n||ce(n)?{}:Ai(new mi(n))}).then(function(e){return r.a.Db(i,t,e)}).then(function(e){if(r.email!=e)return r.reload()}).then(function(){}))},e.ic=function(e){var t=null,n=this;return kl(this,e=Xi(vt(e),n.uid).then(function(e){return t=Tl(n,e,"reauthenticate"),wl(n,e),n.f=null,n.reload()}).then(function(){return t}),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&fe(t,this.metadata.w()),j(this.providerData,function(e){t.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(e))}),fe(t,this.N.w()),t};var Rl={name:"redirectUser",D:"session"};function Ol(e){return Bu(e.b,Rl,e.a)}function Pl(e){var t,n,r,i,o,a,s,u,c;this.a=e,this.b=qu(),this.c=null,this.f=(n=Ml("local"),r=Ml("session"),i=Ml("none"),o=(t=this).b,a=n,s=t.a,u=Vu(a,s),c=ju(o,a.D),o.get(a,s).then(function(e){var t=null;try{t=Ir(h.localStorage.getItem(u))}catch(e){}if(t&&!e)return h.localStorage.removeItem(u),o.set(a,t,s);t&&e&&"localStorage"!=c.type&&h.localStorage.removeItem(u)}).then(function(){return t.b.get(r,t.a)}).then(function(e){return e?r:t.b.get(i,t.a).then(function(e){return e?i:t.b.get(n,t.a).then(function(e){return e?n:t.b.get(Ll,t.a).then(function(e){return e?Ml(e):n})})})}).then(function(e){return t.c=e,xl(t,e.D)}).o(function(){t.c||(t.c=n)})),this.b.addListener(Ml("local"),this.a,v(this.g,this))}function xl(e,t){var n,s,r=[];for(n in Fu)Fu[n]!==t&&r.push(Bu(e.b,Ml(Fu[n]),e.a));return r.push(Bu(e.b,Ll,e.a)),s=r,new ht(function(n,t){var r=s.length,i=[];if(r)for(var e=function(e,t){r--,i[e]=t,0==r&&n(i)},o=function(e){t(e)},a=0;a<s.length;a++)_t(s[a],b(e,a),o);else n(i)})}Pl.prototype.g=function(){var t=this,n=Ml("local");jl(this,function(){return vt().then(function(){return t.c&&"local"!=t.c.D?t.b.get(n,t.a):null}).then(function(e){if(e)return xl(t,"local").then(function(){t.c=n})})})};var Ll={name:"persistence",D:"session"};function Ml(e){return{name:"authUser",D:e}}function Fl(e,t){return jl(e,function(){return e.b.set(e.c,t.w(),e.a)})}function Ul(e){return jl(e,function(){return Bu(e.b,e.c,e.a)})}function ql(e,t,n){return jl(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),Nl(e||{})})})}function jl(e,t){return e.f=e.f.then(t,t),e.f}function Vl(e){if(this.m=!1,Fr(this,"settings",new xc),Fr(this,"app",e),!this.app.options||!this.app.options.apiKey)throw new T("invalid-api-key");var n,t,r,i,o,a,s,u,c;e=jh.SDK_VERSION?dr(jh.SDK_VERSION):null,this.a=new Ma(this.app.options&&this.app.options.apiKey,N(S),e),this.R=[],this.u=[],this.P=[],this.ac=jh.INTERNAL.createSubscribe(v(this.yc,this)),this.X=void 0,this.bc=jh.INTERNAL.createSubscribe(v(this.zc,this)),Gl(this,null),this.l=new Pl(this.app.options.apiKey+":"+this.app.name),this.G=new Dl(this.app.options.apiKey+":"+this.app.name),this.$=$l(this,(t=(n=this).app.options.authDomain,u=(s=n).G,c=s.app.options.authDomain,u=u.b.get(Rl,u.a).then(function(e){return e&&c&&(e.authDomain=c),Nl(e||{})}).then(function(e){return(s.s=e)&&(e.ha=s.G),Ol(s.G)}),e=$l(s,u).then(function(){return ql(n.l,t,n.f)}).then(function(t){return t?(t.ha=n.G,n.s&&(n.s.ga||null)==(t.ga||null)?t:t.reload().then(function(){return Fl(n.l,t).then(function(){return t})}).o(function(e){return"auth/network-request-failed"==e.code?t:Ul(n.l)})):null}).then(function(e){Gl(n,e||null)}),$l(n,e))),this.i=$l(this,(r=this).$.then(function(){return Hl(r)}).o(function(){}).then(function(){if(!r.m)return r.pa()}).o(function(){}).then(function(){var e;r.m||(r.ba=!0,(e=r.l).b.addListener(Ml("local"),e.a,r.pa))})),this.ba=!1,this.pa=v(this.Yc,this),this.Ba=v(this.da,this),this.ya=v(this.kc,this),this.za=v(this.vc,this),this.Aa=v(this.wc,this),this.b=null,o=(i=this).app.options.authDomain,a=i.app.options.apiKey,o&&vr()&&(i.gb=i.$.then(function(){var e;if(!i.m)return i.b=Ac(o,a,i.app.name,i.f),mc(i.b,i),Yl(i)&&hl(Yl(i)),i.s&&(hl(i.s),(e=i.s).wa(i.ka()),nl(e,i),il(e=i.s,i.N),ol(e,i),Wa((e=i.s).a,i.f),rl(e,i),i.s=null),i.b})),this.INTERNAL={},this.INTERNAL.delete=v(this.delete,this),this.INTERNAL.logFramework=v(this.Fc,this),this.A=0,cn.call(this),e=this,Object.defineProperty(e,"lc",{get:function(){return this.ka()},set:function(e){this.wa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.S()},set:function(e){this.xb(e)},enumerable:!1}),e.W=null,this.N=[],this.f=null}function Bl(e){Ut.call(this,"languageCodeChanged"),this.h=e}function Kl(e){Ut.call(this,"emulatorConfigChanged"),this.c=e}function Wl(e){Ut.call(this,"frameworkChanged"),this.f=e}function zl(e){return e.gb||bt(new T("auth-domain-config-required"))}function Hl(e){if(!vr())return bt(new T("operation-not-supported-in-this-environment"));var t=zl(e).then(function(){return e.b.qa()}).then(function(e){return e?qr(e):null});return $l(e,t)}function Gl(e,t){var n,r;Yl(e)&&(n=Yl(e),r=e.Ba,H(n.R,function(e){return e==r}),Zt(Yl(e),"tokenChanged",e.ya),Zt(Yl(e),"userDeleted",e.za),Zt(Yl(e),"userInvalidated",e.Aa),ul(Yl(e))),t&&(t.R.push(e.Ba),Xt(t,"tokenChanged",e.ya),Xt(t,"userDeleted",e.za),Xt(t,"userInvalidated",e.Aa),0<e.A&&sl(t)),Fr(e,"currentUser",t),t&&(t.wa(e.ka()),nl(t,e),il(t,e.N),ol(t,e),Wa(t.a,e.f),rl(t,e))}function Ql(n,e){var t=null,r=null;return $l(n,e.then(function(e){return t=So(e),r=Mi(e),a=e,(s={}).apiKey=(o=n).app.options.apiKey,s.authDomain=o.app.options.authDomain,s.appName=o.app.name,o.f&&(s.emulatorConfig=o.f),o.$.then(function(){return e=s,t=a,n=o.G,r=o.Ga(),i=new tl(e,t),n&&(i.ha=n),r&&il(i,r),i.reload().then(function(){return i});var e,t,n,r,i}).then(function(e){return Yl(o)&&e.uid==Yl(o).uid?bl(Yl(o),e):(Gl(o,e),hl(e)),o.da(e)}).then(function(){Jl(o)});var o,a,s},function(e){var t=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(t=Bc(e.w(),n,v(n.jc,n))),t||e}).then(function(){return qr({user:Yl(n),credential:t,additionalUserInfo:r,operationType:"signIn"})}))}function Yl(e){return e.currentUser}function Xl(e){return Yl(e)&&Yl(e)._lat||null}function Jl(e){if(e.ba){for(var t=0;t<e.u.length;t++)e.u[t]&&e.u[t](Xl(e));if(e.X!==e.getUid()&&e.P.length)for(e.X=e.getUid(),t=0;t<e.P.length;t++)e.P[t]&&e.P[t](Xl(e))}}function $l(e,t){return e.R.push(t),t.na(function(){z(e.R,t)}),t}function Zl(){}function eh(){this.a={},this.b=1e12}Pl.prototype.wb=function(t){var n=null,r=this;return function(e){var t=new T("invalid-persistence-type"),n=new T("unsupported-persistence-type");e:{for(r in Fu)if(Fu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(ur()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!yu()&&"none"!==e)throw n;break;default:if(!mr()&&"none"!==e)throw n}}(t),jl(this,function(){return t!=r.c.D?r.b.get(r.c,r.a).then(function(e){return n=e,xl(r,t)}).then(function(){if(r.c=Ml(t),n)return r.b.set(r.c,n,r.a)}):vt()})},w(Vl,cn),w(Bl,Ut),w(Kl,Ut),w(Wl,Ut),(e=Vl.prototype).wb=function(e){return e=this.l.wb(e),$l(this,e)},e.wa=function(e){this.aa===e||this.m||(this.aa=e,Ka(this.a,this.aa),this.dispatchEvent(new Bl(this.ka())))},e.ka=function(){return this.aa},e.ed=function(){var e=h.navigator;this.wa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.fd=function(e){if(!this.f){if(!/^https?:\/\//.test(e))throw new T("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Dr("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),h.document&&ir().then(function(){var e=h.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#ff0000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),h.document.body.appendChild(e)}),this.f={url:e},this.settings.hb=!0,Wa(this.a,this.f),this.dispatchEvent(new Kl(this.f))}},e.Fc=function(e){this.N.push(e),Ha(this.a,jh.SDK_VERSION?dr(jh.SDK_VERSION,this.N):null),this.dispatchEvent(new Wl(this.N))},e.Ga=function(){return Q(this.N)},e.xb=function(e){this.W===e||this.m||(this.W=e,this.a.b=this.W)},e.S=function(){return this.W},e.toJSON=function(){return{apiKey:this.app.options.apiKey,authDomain:this.app.options.authDomain,appName:this.app.name,currentUser:Yl(this)&&Yl(this).w()}},e.Eb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==t&&!!this.g;default:return!1}},e.ma=function(e,t,n,r){"signInViaPopup"==e&&this.h==r&&(n&&this.O?this.O(n):t&&!n&&this.g&&this.g(t),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.h==t&&this.g?v(this.hc,this):null},e.hc=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then(function(){return Ql(i,os(i.a,o))})},e.Wc=function(t){if(!vr())return bt(new T("operation-not-supported-in-this-environment"));var n=this,e=Li(t.providerId),r=Sr(),i=null;(!wr()||ar())&&this.app.options.authDomain&&t.isOAuthProvider&&(i=ru(this.app.options.authDomain,this.app.options.apiKey,this.app.name,"signInViaPopup",t,null,r,jh.SDK_VERSION||null,null,null,this.S(),this.f));var o=tr(i,e&&e.ua,e&&e.ta);return $l(this,e=zl(this).then(function(e){return wc(e,o,"signInViaPopup",t,r,!!i,n.S())}).then(function(){return new ht(function(e,t){n.ma("signInViaPopup",null,new T("cancelled-popup-request"),n.h),n.g=e,n.O=t,n.h=r,n.c=Ic(n.b,n,"signInViaPopup",o,r)})}).then(function(e){return o&&er(o),e?qr(e):null}).o(function(e){throw o&&er(o),e}))},e.Xc=function(e){if(!vr())return bt(new T("operation-not-supported-in-this-environment"));var t=this;return $l(this,zl(this).then(function(){return jl(e=t.l,function(){return e.b.set(Ll,e.c.D,e.a)});var e}).then(function(){return Tc(t.b,"signInViaRedirect",e,void 0,t.S())}))},e.qa=function(){var t=this;return Hl(this).then(function(e){return t.b&&Dc(t.b.b),e}).o(function(e){throw t.b&&Dc(t.b.b),e})},e.cd=function(e){if(!e)return bt(new T("null-user"));if(this.W!=e.tenantId)return bt(new T("tenant-id-mismatch"));var t=this,n={};n.apiKey=this.app.options.apiKey,n.authDomain=this.app.options.authDomain,n.appName=this.app.name;var r,i,o,a,s,u=(r=e,i=n,o=t.G,a=t.Ga(),s=r.b,(n={})[Ua]=s.b&&s.b.toString(),n.refreshToken=s.a,i=new tl(i||{apiKey:r.l,authDomain:r.s,appName:r.m},n),o&&(i.ha=o),a&&il(i,a),bl(i,r),i);return $l(this,this.i.then(function(){if(t.app.options.apiKey!=e.l)return u.reload()}).then(function(){return Yl(t)&&e.uid==Yl(t).uid?(bl(Yl(t),e),t.da(e)):(Gl(t,u),hl(u),t.da(u))}).then(function(){Jl(t)}))},e.zb=function(){var e=this,t=this.i.then(function(){return e.b&&Dc(e.b.b),Yl(e)?(Gl(e,null),Ul(e.l).then(function(){Jl(e)})):vt()});return $l(this,t)},e.Yc=function(){var r=this;return ql(this.l,this.app.options.authDomain).then(function(e){if(!r.m){var t,n;if((n=Yl(r)&&e)&&(n=Yl(r).uid,t=e.uid,n=null!=n&&""!==n&&null!=t&&""!==t&&n==t),n)return bl(Yl(r),e),Yl(r).I();(Yl(r)||e)&&(Gl(r,e),e&&(hl(e),e.ha=r.G),r.b&&mc(r.b,r),Jl(r))}})},e.da=function(e){return Fl(this.l,e)},e.kc=function(){Jl(this),this.da(Yl(this))},e.vc=function(){this.zb()},e.wc=function(){this.zb()},e.jc=function(e){var t=this;return this.i.then(function(){return Ql(t,vt(e))})},e.yc=function(e){var t=this;this.addAuthTokenListener(function(){e.next(Yl(t))})},e.zc=function(e){var t,n=this,r=function(){e.next(Yl(n))};(t=this).P.push(r),$l(t,t.i.then(function(){!t.m&&W(t.P,r)&&t.X!==t.getUid()&&(t.X=t.getUid(),r(Xl(t)))}))},e.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof e?e(Yl(r)):"function"==typeof e.next&&e.next(Yl(r))}),this.ac(e,t,n)},e.Gc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){r.X=r.getUid(),"function"==typeof e?e(Yl(r)):"function"==typeof e.next&&e.next(Yl(r))}),this.bc(e,t,n)},e.mc=function(e){var t=this,n=this.i.then(function(){return Yl(t)?Yl(t).I(e).then(function(e){return{accessToken:e}}):null});return $l(this,n)},e.Sc=function(e){var n=this;return this.i.then(function(){return Ql(n,Bs(n.a,Ms,{token:e}))}).then(function(e){var t=e.user;return vl(t,"isAnonymous",!1),n.da(t),e})},e.Tc=function(e,t){var n=this;return this.i.then(function(){return Ql(n,Bs(n.a,Fs,{email:e,password:t}))})},e.dc=function(e,t){var n=this;return this.i.then(function(){return Ql(n,Bs(n.a,hs,{email:e,password:t}))})},e.Za=function(e){var t=this;return this.i.then(function(){return Ql(t,e.ja(t.a))})},e.Rc=function(e){return Lr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(e)},e.yb=function(){var n=this;return this.i.then(function(){var e=Yl(n);if(e&&e.isAnonymous){var t=qr({providerId:null,isNewUser:!1});return qr({user:e,credential:null,additionalUserInfo:t,operationType:"signIn"})}return Ql(n,n.a.yb()).then(function(e){var t=e.user;return vl(t,"isAnonymous",!0),n.da(t),e})})},e.getUid=function(){return Yl(this)&&Yl(this).uid||null},e.cc=function(e){this.addAuthTokenListener(e),this.A++,0<this.A&&Yl(this)&&sl(Yl(this))},e.Oc=function(t){var n=this;j(this.u,function(e){e==t&&n.A--}),this.A<0&&(this.A=0),0==this.A&&Yl(this)&&ul(Yl(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(e){var t=this;this.u.push(e),$l(this,this.i.then(function(){t.m||W(t.u,e)&&e(Xl(t))}))},e.removeAuthTokenListener=function(t){H(this.u,function(e){return e==t})},e.delete=function(){this.m=!0;for(var e=0;e<this.R.length;e++)this.R[e].cancel("app-deleted");return this.R=[],this.l&&(e=this.l).b.removeListener(Ml("local"),e.a,this.pa),this.b&&(vc(this.b,this),Dc(this.b.b)),Promise.resolve()},e.gc=function(e){return $l(this,Bs(this.a,fs,{identifier:e,continueUri:br()?Jn():"http://localhost"}).then(function(e){return e.signinMethods||[]}))},e.Ac=function(e){return!!bo(e)},e.vb=function(t,n){var r=this;return $l(this,vt().then(function(){var e=new mi(n);if(!e.c)throw new T("argument-error",_i+" must be true when sending sign in link to email");return Ai(e)}).then(function(e){return r.a.vb(t,e)}).then(function(){}))},e.hd=function(e){return this.Qa(e).then(function(e){return e.data.email})},e.mb=function(e,t){return $l(this,this.a.mb(e,t).then(function(){}))},e.Qa=function(e){return $l(this,this.a.Qa(e).then(function(e){return new Qr(e)}))},e.ib=function(e){return $l(this,this.a.ib(e).then(function(){}))},e.ub=function(t,e){var n=this;return $l(this,vt().then(function(){return void 0===e||ce(e)?{}:Ai(new mi(e))}).then(function(e){return n.a.ub(t,e)}).then(function(){}))},e.Vc=function(e,t){return $l(this,Mc(this,e,t,v(this.Za,this)))},e.Uc=function(n,r){var i=this;return $l(this,vt().then(function(){var e=r||Jn(),t=vo(n,e);if(!(e=bo(e)))throw new T("argument-error","Invalid email link!");if(e.tenantId!==i.S())throw new T("tenant-id-mismatch");return i.Za(t)}))},Zl.prototype.render=function(){},Zl.prototype.reset=function(){},Zl.prototype.getResponse=function(){},Zl.prototype.execute=function(){};var th=null;function nh(e,t){return(t=rh(t))&&e.a[t]||null}function rh(e){return(e=void 0===e?1e12:e)?e.toString():null}function ih(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=et(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():Xt(this.f,"click",this.i)}function oh(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function ah(){}function sh(){}eh.prototype.render=function(e,t){return this.a[this.b.toString()]=new ih(e,t),this.b++},eh.prototype.reset=function(e){var t=nh(this,e);e=rh(e),t&&e&&(t.delete(),delete this.a[e])},eh.prototype.getResponse=function(e){return(e=nh(this,e))?e.getResponse():null},eh.prototype.execute=function(e){(e=nh(this,e))&&e.execute()},ih.prototype.getResponse=function(){return oh(this),this.b},ih.prototype.execute=function(){oh(this);var n=this;this.a||(this.a=setTimeout(function(){n.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var e=n.c.callback,t=n.c["expired-callback"];if(e)try{e(n.b)}catch(e){}n.a=setTimeout(function(){if(n.a=null,n.b=null,t)try{t()}catch(e){}n.h&&n.execute()},6e4)},500))},ih.prototype.delete=function(){oh(this),this.g=!0,clearTimeout(this.a),this.a=null,Zt(this.f,"click",this.i)},Fr(ah,"FACTOR_ID","phone"),sh.prototype.g=function(){return vt(th=th||new eh)},sh.prototype.c=function(){};var uh=null;function ch(){this.b=h.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var lh=new de(ve,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),hh=new kr(3e4,6e4);ch.prototype.g=function(i){var o=this;return new ht(function(e,t){var r=setTimeout(function(){t(new T("network-request-failed"))},hh.get());!h.grecaptcha||i!==o.f&&!o.b?(h[o.a]=function(){var n;h.grecaptcha?(o.f=i,n=h.grecaptcha.render,h.grecaptcha.render=function(e,t){return e=n(e,t),o.b++,e},clearTimeout(r),e(h.grecaptcha)):(clearTimeout(r),t(new T("internal-error"))),delete h[o.a]},vt(Na(Ee(lh,{onload:o.a,hl:i||""}))).o(function(){clearTimeout(r),t(new T("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),e(h.grecaptcha))})},ch.prototype.c=function(){this.b--};var fh=null;function ph(e,t,n,r,i,o,a){if(Fr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=t,this.g=null,a=a?uh=uh||new sh:fh=fh||new ch,this.v=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[yh])throw new T("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[mh],!h.document)throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!et(t)||!this.i&&et(t).hasChildNodes())throw new T("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ma(e,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var u=this.a[dh];this.a[dh]=function(e){var t;vh(s,e),"function"==typeof u?u(e):"string"!=typeof u||"function"==typeof(t=yr(u,h))&&t(e)};var c=this.a[gh];this.a[gh]=function(){var e;vh(s,null),"function"==typeof c?c():"string"!=typeof c||"function"==typeof(e=yr(c,h))&&e()}}var dh="callback",gh="expired-callback",yh="sitekey",mh="size";function vh(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(e){}}function bh(e,t){return e.h.push(t),t.na(function(){z(e.h,t)}),t}function _h(e){if(e.A)throw new T("internal-error","RecaptchaVerifier instance has been destroyed.")}function wh(e,t,n){var r=!1;try{this.b=n||jh.app()}catch(e){throw new T("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new T("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(e){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}o=jh.SDK_VERSION?dr(jh.SDK_VERSION,o):null,ph.call(this,n,e,t,function(){try{var t=i.b.auth().ka()}catch(e){t=null}return t},o,N(S),r)}function Eh(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new T("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].K(n[i])&&!o){if(t=t[i],i<0||i>=Th.length)throw new T("internal-error","Argument validator received an unsupported number of arguments.");n=Th[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.J+".";break e}r=null}}if(r)throw new T("argument-error",e+" failed: "+r)}(e=ph.prototype).Ia=function(){var t=this;return this.f||(this.f=bh(this,vt().then(function(){if(br()&&!sr())return ir();throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.v.g(t.u())}).then(function(e){return t.g=e,Bs(t.s,Ss,{})}).then(function(e){t.a[yh]=e.recaptchaSiteKey}).o(function(e){throw t.f=null,e})))},e.render=function(){_h(this);var n=this;return bh(this,this.Ia().then(function(){var e,t;return null===n.c&&(t=n.m,n.i||(e=et(t),t=function(){var e,t=arguments,n=document,r=String(t[0]),i=t[1];return!Ze&&i&&(i.name||i.type)&&(r=["<",r],i.name&&r.push(' name="',qe(i.name),'"'),i.type&&(r.push(' type="',qe(i.type),'"'),fe(e={},i),delete e.type,i=e),r.push(">"),r=r.join("")),r=ot(n,r),i&&("string"==typeof i?r.className=i:Array.isArray(i)?r.className=i.join(" "):tt(r,i)),2<t.length&&function(t,n,e){function r(e){e&&n.appendChild("string"==typeof e?t.createTextNode(e):e)}for(var i=2;i<e.length;i++){var o=e[i];if(!d(o)||y(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(y(o)){var a="function"==typeof o.item||"string"==typeof o.item;break e}if(g(o)){a="function"==typeof o.item;break e}}a=!1}j(a?Q(o):o,r)}}}(n,r,t),r}("DIV"),e.appendChild(t)),n.c=n.g.render(t,n.a)),n.c}))},e.verify=function(){_h(this);var i=this;return bh(this,this.render().then(function(t){return new ht(function(n){var r,e=i.g.getResponse(t);e?n(e):(r=function(e){var t;e&&(t=r,H(i.l,function(e){return e==t}),n(e))},i.l.push(r),i.i&&i.g.execute(i.c))})}))},e.reset=function(){_h(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){_h(this),this.A=!0,this.v.c();for(var e,t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i)for(t=et(this.m);e=t.firstChild;)t.removeChild(e)},w(wh,ph);var Th="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ih(e,t){return{name:e||"",J:"a valid string",optional:!!t,K:function(e){return"string"==typeof e}}}function Sh(e,t){return{name:e||"",J:"a boolean",optional:!!t,K:function(e){return"boolean"==typeof e}}}function Ch(e,t){return{name:e||"",J:"a valid object",optional:!!t,K:y}}function Ah(e,t){return{name:e||"",J:"a function",optional:!!t,K:function(e){return"function"==typeof e}}}function kh(e,t){return{name:e||"",J:"null",optional:!!t,K:function(e){return null===e}}}function Nh(n){return{name:n?n+"Credential":"credential",J:n?"a valid "+n+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var t=!n||e.providerId===n;return!(!e.ja||!t)}}}function Dh(){return{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(e){return!!e&&!!e.rb}}}function Rh(){return{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}}function Oh(e,t){return y(e)&&"string"==typeof e.type&&e.type===t&&"function"==typeof e.Ha}function Ph(e){return y(e)&&"string"==typeof e.uid}function xh(){return{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}}function Lh(t,n,e,r){return{name:e||"",J:t.J+" or "+n.J,optional:!!r,K:function(e){return t.K(e)||n.K(e)}}}function Mh(e,t){for(var n in t){var r=t[n].name;e[r]=qh(r,e[n],t[n].j)}}function Fh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:b(function(e){return this[e]},n),set:b(function(e,t,n,r){Eh(e,[n],[r],!0),this[t]=r},r,n,t[n].jb),enumerable:!0})}}function Uh(e,t,n,r){e[t]=qh(t,n,r)}function qh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return Eh(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=(e=e.split("."))[e.length-1];for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}Mh(Vl.prototype,{ib:{name:"applyActionCode",j:[Ih("code")]},Qa:{name:"checkActionCode",j:[Ih("code")]},mb:{name:"confirmPasswordReset",j:[Ih("code"),Ih("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ih("email"),Ih("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Ih("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Ih("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Lh(Ch(),Ah(),"nextOrObserver"),Ah("opt_error",!0),Ah("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Lh(Ch(),Ah(),"nextOrObserver"),Ah("opt_error",!0),Ah("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Ih("email"),Lh(Ch("opt_actionCodeSettings",!0),kh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Ih("email"),Ch("actionCodeSettings")]},wb:{name:"setPersistence",j:[Ih("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Nh()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Nh()]},Sc:{name:"signInWithCustomToken",j:[Ih("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Ih("email"),Ih("password")]},Uc:{name:"signInWithEmailLink",j:[Ih("email"),Ih("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Ih("phoneNumber"),xh()]},Wc:{name:"signInWithPopup",j:[Rh()]},Xc:{name:"signInWithRedirect",j:[Rh()]},cd:{name:"updateCurrentUser",j:[Lh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(e){return!!(e&&e instanceof tl)}},kh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ih(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Ih("url")]},hd:{name:"verifyPasswordResetCode",j:[Ih("code")]}}),Fh(Vl.prototype,{lc:{name:"languageCode",jb:Lh(Ih(),kh(),"languageCode")},ti:{name:"tenantId",jb:Lh(Ih(),kh(),"tenantId")}}),(Vl.Persistence=Fu).LOCAL="local",Vl.Persistence.SESSION="session",Vl.Persistence.NONE="none",Mh(tl.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Sh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Sh("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Nh()]},pb:{name:"linkWithCredential",j:[Nh()]},Cc:{name:"linkWithPhoneNumber",j:[Ih("phoneNumber"),xh()]},Dc:{name:"linkWithPopup",j:[Rh()]},Ec:{name:"linkWithRedirect",j:[Rh()]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Nh()]},sb:{name:"reauthenticateWithCredential",j:[Nh()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Ih("phoneNumber"),xh()]},Mc:{name:"reauthenticateWithPopup",j:[Rh()]},Nc:{name:"reauthenticateWithRedirect",j:[Rh()]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Lh(Ch("opt_actionCodeSettings",!0),kh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ih(null,!0)]},bd:{name:"unlink",j:[Ih("provider")]},Ab:{name:"updateEmail",j:[Ih("email")]},Bb:{name:"updatePassword",j:[Ih("password")]},dd:{name:"updatePhoneNumber",j:[Nh("phone")]},Cb:{name:"updateProfile",j:[Ch("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Ih("email"),Lh(Ch("opt_actionCodeSettings",!0),kh(null,!0),"opt_actionCodeSettings",!0)]}}),Mh(eh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Mh(Zl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Mh(ht.prototype,{na:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Fh(xc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Sh("appVerificationDisabledForTesting")}}),Mh(Lc.prototype,{confirm:{name:"confirm",j:[Ih("verificationCode")]}}),Uh(Yi,"fromJSON",function(e){e="string"==typeof e?JSON.parse(e):e;for(var t,n=[no,yo,wo,Zi],r=0;r<n.length;r++)if(t=n[r](e))return t;return null},[Lh(Ih(),Ch(),"json")]),Uh(mo,"credential",function(e,t){return new go(e,t)},[Ih("email"),Ih("password")]),Mh(go.prototype,{w:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(ao.prototype,{Ca:{name:"addScope",j:[Ih("scope")]},Ka:{name:"setCustomParameters",j:[Ch("customOAuthParameters")]}}),Uh(ao,"credential",so,[Lh(Ih(),Ch(),"token")]),Uh(mo,"credentialWithLink",vo,[Ih("email"),Ih("emailLink")]),Mh(uo.prototype,{Ca:{name:"addScope",j:[Ih("scope")]},Ka:{name:"setCustomParameters",j:[Ch("customOAuthParameters")]}}),Uh(uo,"credential",co,[Lh(Ih(),Ch(),"token")]),Mh(lo.prototype,{Ca:{name:"addScope",j:[Ih("scope")]},Ka:{name:"setCustomParameters",j:[Ch("customOAuthParameters")]}}),Uh(lo,"credential",ho,[Lh(Ih(),Lh(Ch(),kh()),"idToken"),Lh(Ih(),kh(),"accessToken",!0)]),Mh(fo.prototype,{Ka:{name:"setCustomParameters",j:[Ch("customOAuthParameters")]}}),Uh(fo,"credential",po,[Lh(Ih(),Ch(),"token"),Ih("secret",!0)]),Mh(oo.prototype,{Ca:{name:"addScope",j:[Ih("scope")]},credential:{name:"credential",j:[Lh(Ih(),Lh(Ch(),kh()),"optionsOrIdToken"),Lh(Ih(),kh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Ch("customOAuthParameters")]}}),Mh(eo.prototype,{w:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(Ji.prototype,{w:{name:"toJSON",j:[Ih(null,!0)]}}),Uh(To,"credential",Io,[Ih("verificationId"),Ih("verificationCode")]),Mh(To.prototype,{eb:{name:"verifyPhoneNumber",j:[Lh(Ih(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(e){return!!e&&(e.session&&e.phoneNumber?Oh(e.session,Gi)&&"string"==typeof e.phoneNumber:e.session&&e.multiFactorHint?Oh(e.session,Qi)&&Ph(e.multiFactorHint):e.session&&e.multiFactorUid?Oh(e.session,Qi)&&"string"==typeof e.multiFactorUid:!!e.phoneNumber&&"string"==typeof e.phoneNumber)}},"phoneInfoOptions"),xh()]}}),Mh(_o.prototype,{w:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(T.prototype,{toJSON:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(Po.prototype,{toJSON:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(Oo.prototype,{toJSON:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(Vc.prototype,{toJSON:{name:"toJSON",j:[Ih(null,!0)]}}),Mh(Uc.prototype,{Qc:{name:"resolveSignIn",j:[Dh()]}}),Mh(Gc.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[Dh(),Ih("displayName",!0)]},ad:{name:"unenroll",j:[Lh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Ph},Ih(),"multiFactorInfoIdentifier")]}}),Mh(wh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Uh(ui,"parseLink",yi,[Ih("link")]),Uh(ah,"assertion",function(e){return new zc(e)},[Nh("phone")]),function(){if(void 0===jh||!jh.INTERNAL||!jh.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Xr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:Yr,VERIFY_AND_CHANGE_EMAIL:Jr,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Vl,AuthCredential:Yi,Error:T};Uh(e,"EmailAuthProvider",mo,[]),Uh(e,"FacebookAuthProvider",ao,[]),Uh(e,"GithubAuthProvider",uo,[]),Uh(e,"GoogleAuthProvider",lo,[]),Uh(e,"TwitterAuthProvider",fo,[]),Uh(e,"OAuthProvider",oo,[Ih("providerId")]),Uh(e,"SAMLAuthProvider",io,[Ih("providerId")]),Uh(e,"PhoneAuthProvider",To,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(e){return!!(e&&e instanceof Vl)}}]),Uh(e,"RecaptchaVerifier",wh,[Lh(Ih(),{name:"",J:"an HTML element",optional:!1,K:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Ch("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(e){return!!(e&&e instanceof jh.app.App)}}]),Uh(e,"ActionCodeURL",ui,[]),Uh(e,"PhoneMultiFactorGenerator",ah,[]),jh.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new Vl(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),jh.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:v((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:v(e.mc,e),addAuthTokenListener:v(e.cc,e),removeAuthTokenListener:v(e.Oc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),jh.registerVersion("@firebase/auth","0.15.2-1.0.0-eap-firestore-debug.9c6096f43"),jh.INTERNAL.extendNamespace({User:tl})}()}.apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Va=(Ba.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Go(t))},Ba.prototype.get=function(e){return null==(e=this.domStorage_.getItem(this.prefixedName_(e)))?null:Ho(e)},Ba.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},Ba.prototype.prefixedName_=function(e){return this.prefix_+e},Ba.prototype.toString=function(){return this.domStorage_.toString()},Ba);function Ba(e){this.domStorage_=e,this.prefix_="firebase:"}var Ka=(Wa.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},Wa.prototype.get=function(e){return Yo(this.cache_,e)?this.cache_[e]:null},Wa.prototype.remove=function(e){delete this.cache_[e]},Wa);function Wa(){this.cache_={},this.isInMemoryStorage=!0}function za(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i,o=e.charCodeAt(r);55296<=o&&o<=56319&&(i=o-55296,Io(++r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(i<<10)+(e.charCodeAt(r)-56320)),o<128?t[n++]=o:(o<2048?t[n++]=o>>6|192:(o<65536?t[n++]=o>>12|224:(t[n++]=o>>18|240,t[n++]=o>>12&63|128),t[n++]=o>>6&63|128),t[n++]=63&o|128)}return t}(e);return(e=new Zo).update(t),e=e.digest(),Co.encodeByteArray(e)}function Ha(e,t){Io(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(rs.logLevel=Ta.VERBOSE,as=rs.log.bind(rs),t&&ns.set("logging_enabled",!0)):"function"==typeof e?as=e:(as=null,ns.remove("logging_enabled"))}function Ga(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+os.apply(void 0,bo(e));rs.error(n)}function Qa(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+os.apply(void 0,bo(e));throw rs.error(n),new Error(n)}function Ya(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+os.apply(void 0,bo(e));rs.warn(n)}function Xa(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}function Ja(e,t){return e===t?0:e<t?-1:1}function $a(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Go(t))}function Za(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)n<i+t?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r}var es,ts=(Hn=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Va(t)}}catch(e){}return new Ka})("localStorage"),ns=Hn("sessionStorage"),rs=new Na("@firebase/database"),is=(es=1,function(){return es++}),os=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=os.apply(null,i):n+="object"==typeof i?Go(i):i,n+=" "}return n},as=null,ss=!0,us=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];!0===ss&&(ss=!1,null===as&&!0===ns.get("logging_enabled")&&Ha(!0)),as&&(e=os.apply(null,t),as(e))},cs=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];us.apply(void 0,bo([n],e))}},ls="[MIN_NAME]",hs="[MAX_NAME]",fs=function(e,t){if(e===t)return 0;if(e===ls||t===hs)return-1;if(t===ls||e===hs)return 1;var n=bs(e),r=bs(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1},ps=function(e){if("object"!=typeof e||null===e)return Go(e);var t,n=[];for(t in e)n.push(t);n.sort();for(var r="{",i=0;i<n.length;i++)0!==i&&(r+=","),r+=Go(n[i]),r+=":",r+=ps(e[n[i]]);return r+"}"};function ds(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function gs(e){var t,n,r,i;Io(!Xa(e),"Invalid JSON number"),0===e?t=1/e==-1/(r=n=0)?1:0:(t=e<0,r=(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(e/Math.pow(2,-1074))));for(var o=[],a=52;a;--a)o.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;--a)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();for(var s=o.join(""),u="",a=0;a<64;a+=8){var c=parseInt(s.substr(a,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()}function ys(e){try{e()}catch(e){setTimeout(function(){throw Ya("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}}function ms(e,t){return"object"==typeof(t=setTimeout(e,t))&&t.unref&&t.unref(),t}var vs=new RegExp("^-?(0*)\\d{1,10}$"),bs=function(e){return vs.test(e)&&-2147483648<=(e=Number(e))&&e<=2147483647?e:null},_s=(Object.defineProperty(ws,"Empty",{get:function(){return new ws("")},enumerable:!1,configurable:!0}),ws.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},ws.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},ws.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new ws(this.pieces_,e)},ws.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},ws.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},ws.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},ws.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},ws.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],t=this.pieceNum_;t<this.pieces_.length-1;t++)e.push(this.pieces_[t]);return new ws(e,0)},ws.prototype.child=function(e){for(var t=[],n=this.pieceNum_;n<this.pieces_.length;n++)t.push(this.pieces_[n]);if(e instanceof ws)for(n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);else for(var r=e.split("/"),n=0;n<r.length;n++)0<r[n].length&&t.push(r[n]);return new ws(t,0)},ws.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},ws.relativePath=function(e,t){var n=e.getFront(),r=t.getFront();if(null===n)return t;if(n===r)return ws.relativePath(e.popFront(),t.popFront());throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")},ws.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=fs(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},ws.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},ws.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},ws);function ws(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}var Es=(Object.defineProperty(Ts,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(Ts,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),Ts.prototype.push=function(e){0<this.parts_.length&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=ca(e),this.checkValid_()},Ts.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=ca(e),0<this.parts_.length&&--this.byteLength_},Ts.prototype.checkValid_=function(){if(this.byteLength_>Ts.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+Ts.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>Ts.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ts.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},Ts.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},Ts);function Ts(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=ca(this.parts_[n]);this.checkValid_()}var Is="firebaseio.com",Ss="websocket",Cs="long_polling",As=(ks.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},ks.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},ks.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},ks.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},ks.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ts.set("host:"+this.host,this.internalHost))},ks.prototype.connectionURL=function(e,t){var n;if(Io("string"==typeof e,"typeof type must == string"),Io("object"==typeof t,"typeof params must == object"),e===Ss)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==Cs)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return ds(t,function(e,t){r.push(e+"="+t)}),n+r.join("&")},ks.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},ks.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},ks);function ks(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=ts.get("host:"+e)||this.host}function Ns(e,t){var i,o,a,n,r,s,u,c,l,h,f,p,c=(h=!(l=c=u=s=r=""),f="https",p=443,"string"==typeof(i=e)&&(0<=(n=i.indexOf("//"))&&(f=i.substring(0,n-1),i=i.substring(n+2)),-1===(o=i.indexOf("/"))&&(o=i.length),-1===(a=i.indexOf("?"))&&(a=i.length),r=i.substring(0,Math.min(o,a)),o<a&&(c=function(){for(var e="",t=i.substring(o,a).split("/"),n=0;n<t.length;n++)if(0<t[n].length){var r=t[n];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}e+="/"+r}return e}()),a=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=mo(e.split("&")),o=i.next();!o.done;o=i.next()){var a,s=o.value;0!==s.length&&(2===(a=s.split("=")).length?r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):Ya("Invalid query segment '"+s+"' in query '"+e+"'"))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(i.substring(Math.min(i.length,a))),0<=(n=r.indexOf(":"))?(h="https"===f||"wss"===f,p=parseInt(r.substring(n+1),10)):n=r.length,"localhost"===(n=r.slice(0,n)).toLowerCase()?s="localhost":n.split(".").length<=2?s=n:(n=r.indexOf("."),u=r.substring(0,n).toLowerCase(),s=r.substring(n+1),l=u),"ns"in a&&(l=a.ns)),{host:r,port:p,domain:s,subdomain:u,secure:h,scheme:f,pathString:c,namespace:l}),l=c.namespace;return"firebase.com"===c.domain&&Qa(c.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),l&&"undefined"!==l||"localhost"===c.domain||Qa("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),c.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Ya("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new As(c.host,c.secure,l,t,e="ws"===c.scheme||"wss"===c.scheme,"",l!==c.subdomain),path:new _s(c.pathString)}}function Ds(e){return"string"==typeof e&&0!==e.length&&!Vs.test(e)}function Rs(e){return"string"==typeof e&&0!==e.length&&!Bs.test(e)}function Os(e){return null===e||"string"==typeof e||"number"==typeof e&&!Xa(e)||e&&"object"==typeof e&&Yo(e,".sv")}function Ps(e,t,n,r,i){i&&void 0===n||Ws(aa(e,t,i),n,r)}function xs(e,t,n,r,i){if(!i||void 0!==n){var o=aa(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];ds(n,function(e,t){if(e=new _s(e),Ws(o,t,r.child(e)),".priority"===e.getBack()&&!Os(t))throw new Error(o+"contains an invalid value for '"+e.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(e)}),function(e,t){for(var n,r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),o=0;o<i.length;o++)if((".priority"!==i[o]||o!==i.length-1)&&!Ds(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+n.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(_s.comparePaths);for(var a=null,r=0;r<t.length;r++){if(n=t[r],null!==a&&a.contains(n))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+n.toString());a=n}}(o,a)}}function Ls(e,t,n,r){if(!r||void 0!==n){if(Xa(n))throw new Error(aa(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Os(n))throw new Error(aa(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function Ms(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(aa(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function Fs(e,t,n,r){if(!(r&&void 0===n||Ds(n)))throw new Error(aa(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function Us(e,t,n,r){if(!(r&&void 0===n||Rs(n)))throw new Error(aa(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function qs(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")}function js(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Ds(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!Rs(r=r&&r.replace(/^\/*\.info(\/|$)/,"/")))throw new Error(aa(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')}var Vs=/[\[\].#$\/\u0000-\u001F\u007F]/,Bs=/[\[\].#$\u0000-\u001F\u007F]/,Ks=10485760,Ws=function(n,e,t){var r=t instanceof _s?new Es(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(n+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(Xa(e))throw new Error(n+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>Ks/3&&ca(e)>Ks)throw new Error(n+"contains a string greater than "+Ks+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(ds(e,function(e,t){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!Ds(e)))throw new Error(n+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),Ws(n,t,r),r.pop()}),i&&o)throw new Error(n+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},zs=(Hs.prototype.cancel=function(e){oa("OnDisconnect.cancel",0,1,arguments.length),sa("OnDisconnect.cancel",1,e,!0);var t=new No;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},Hs.prototype.remove=function(e){oa("OnDisconnect.remove",0,1,arguments.length),qs("OnDisconnect.remove",this.path_),sa("OnDisconnect.remove",1,e,!0);var t=new No;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},Hs.prototype.set=function(e,t){oa("OnDisconnect.set",1,2,arguments.length),qs("OnDisconnect.set",this.path_),Ps("OnDisconnect.set",1,e,this.path_,!1),sa("OnDisconnect.set",2,t,!0);var n=new No;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},Hs.prototype.setWithPriority=function(e,t,n){oa("OnDisconnect.setWithPriority",2,3,arguments.length),qs("OnDisconnect.setWithPriority",this.path_),Ps("OnDisconnect.setWithPriority",1,e,this.path_,!1),Ls("OnDisconnect.setWithPriority",2,t,!1),sa("OnDisconnect.setWithPriority",3,n,!0);var r=new No;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},Hs.prototype.update=function(e,t){if(oa("OnDisconnect.update",1,2,arguments.length),qs("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Ya("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}xs("OnDisconnect.update",1,e,this.path_,!1),sa("OnDisconnect.update",2,t,!0);var i=new No;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},Hs);function Hs(e,t){this.repo_=e,this.path_=t}var Gs=(Qs.prototype.toJSON=function(){return oa("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},Qs);function Qs(e,t){this.committed=e,this.snapshot=t}var Ys,Xs,Js,$s=(Ys="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Xs=0,Js=[],function(e){var t=e===Xs;Xs=e;for(var n=new Array(8),r=7;0<=r;r--)n[r]=Ys.charAt(e%64),e=Math.floor(e/64);Io(0===e,"Cannot push at time == 0");var i=n.join("");if(t){for(r=11;0<=r&&63===Js[r];r--)Js[r]=0;Js[r]++}else for(r=0;r<12;r++)Js[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)i+=Ys.charAt(Js[r]);return Io(20===i.length,"nextPushId: Length should be 20."),i}),Zs=(eu.Wrap=function(e,t){return new eu(e,t)},eu);function eu(e,t){this.name=e,this.node=t}var tu,fe=(nu.prototype.getCompare=function(){return this.compare.bind(this)},nu.prototype.indexedValueChanged=function(e,t){return e=new Zs(ls,e),t=new Zs(ls,t),0!==this.compare(e,t)},nu.prototype.minPost=function(){return Zs.MIN},nu);function nu(){}var ru,iu=(fo(ou,ru=fe),Object.defineProperty(ou,"__EMPTY_NODE",{get:function(){return tu},set:function(e){tu=e},enumerable:!1,configurable:!0}),ou.prototype.compare=function(e,t){return fs(e.name,t.name)},ou.prototype.isDefinedOn=function(e){throw So("KeyIndex.isDefinedOn not expected to be called.")},ou.prototype.indexedValueChanged=function(e,t){return!1},ou.prototype.minPost=function(){return Zs.MIN},ou.prototype.maxPost=function(){return new Zs(hs,tu)},ou.prototype.makePost=function(e,t){return Io("string"==typeof e,"KeyIndex indexValue must always be a string."),new Zs(e,tu)},ou.prototype.toString=function(){return".key"},ou);function ou(){return null!==ru&&ru.apply(this,arguments)||this}var au,su=new iu;function uu(e){return"number"==typeof e?"number:"+gs(e):"string:"+e}var cu,lu,hu,fu,pu=function(e){var t;e.isLeafNode()?(t=e.val(),Io("string"==typeof t||"number"==typeof t||"object"==typeof t&&Yo(t,".sv"),"Priority must be a string or number.")):Io(e===au||e.isEmpty(),"priority of unexpected type."),Io(e===au||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},du=(Object.defineProperty(gu,"__childrenNodeConstructor",{get:function(){return cu},set:function(e){cu=e},enumerable:!1,configurable:!0}),gu.prototype.isLeafNode=function(){return!0},gu.prototype.getPriority=function(){return this.priorityNode_},gu.prototype.updatePriority=function(e){return new gu(this.value_,e)},gu.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:gu.__childrenNodeConstructor.EMPTY_NODE},gu.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:gu.__childrenNodeConstructor.EMPTY_NODE},gu.prototype.hasChild=function(){return!1},gu.prototype.getPredecessorChildName=function(e,t){return null},gu.prototype.updateImmediateChild=function(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:gu.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)},gu.prototype.updateChild=function(e,t){var n=e.getFront();return null===n?t:t.isEmpty()&&".priority"!==n?this:(Io(".priority"!==n||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,gu.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),t)))},gu.prototype.isEmpty=function(){return!1},gu.prototype.numChildren=function(){return 0},gu.prototype.forEachChild=function(e,t){return!1},gu.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},gu.prototype.hash=function(){var e,t;return null===this.lazyHash_&&(e="",this.priorityNode_.isEmpty()||(e+="priority:"+uu(this.priorityNode_.val())+":"),e+=(t=typeof this.value_)+":",e+="number"==t?gs(this.value_):this.value_,this.lazyHash_=za(e)),this.lazyHash_},gu.prototype.getValue=function(){return this.value_},gu.prototype.compareTo=function(e){return e===gu.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof gu.__childrenNodeConstructor?-1:(Io(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},gu.prototype.compareToLeafNode_=function(e){var t=typeof e.value_,n=typeof this.value_,r=gu.VALUE_TYPE_ORDER.indexOf(t),i=gu.VALUE_TYPE_ORDER.indexOf(n);return Io(0<=r,"Unknown leaf type: "+t),Io(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r},gu.prototype.withIndex=function(){return this},gu.prototype.isIndexed=function(){return!0},gu.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)},gu.VALUE_TYPE_ORDER=["object","boolean","number","string"],gu);function gu(e,t){void 0===t&&(t=gu.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Io(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),pu(this.priorityNode_)}function yu(){return null!==fu&&fu.apply(this,arguments)||this}var mu=(fo(yu,fu=fe),yu.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority();return 0===(r=n.compareTo(r))?fs(e.name,t.name):r},yu.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},yu.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},yu.prototype.minPost=function(){return Zs.MIN},yu.prototype.maxPost=function(){return new Zs(hs,new du("[PRIORITY-POST]",hu))},yu.prototype.makePost=function(e,t){return e=lu(e),new Zs(t,new du("[PRIORITY-POST]",e))},yu.prototype.toString=function(){return".priority"},new yu),vu=(bu.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_.pop(),t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value};if(this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},bu.prototype.hasNext=function(){return 0<this.nodeStack_.length},bu.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},bu);function bu(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}var _u=(wu.prototype.copy=function(e,t,n,r,i){return new wu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},wu.prototype.count=function(){return this.left.count()+1+this.right.count()},wu.prototype.isEmpty=function(){return!1},wu.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},wu.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},wu.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},wu.prototype.minKey=function(){return this.min_().key},wu.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},wu.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},wu.prototype.removeMin_=function(){if(this.left.isEmpty())return Tu.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},wu.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return Tu.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},wu.prototype.isRed_=function(){return this.color},wu.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},wu.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},wu.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},wu.prototype.rotateLeft_=function(){var e=this.copy(null,null,wu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},wu.prototype.rotateRight_=function(){var e=this.copy(null,null,wu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},wu.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},wu.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},wu.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},wu.RED=!0,wu.BLACK=!1,wu);function wu(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:wu.RED,this.left=null!=r?r:Tu.EMPTY_NODE,this.right=null!=i?i:Tu.EMPTY_NODE}function Eu(){}Eu.prototype.copy=function(e,t,n,r,i){return this},Eu.prototype.insert=function(e,t,n){return new _u(e,t,null)},Eu.prototype.remove=function(e,t){return this},Eu.prototype.count=function(){return 0},Eu.prototype.isEmpty=function(){return!0},Eu.prototype.inorderTraversal=function(e){return!1},Eu.prototype.reverseTraversal=function(e){return!1},Eu.prototype.minKey=function(){return null},Eu.prototype.maxKey=function(){return null},Eu.prototype.check_=function(){return 0},Eu.prototype.isRed_=function(){return!1},he=Eu;var Tu=(Iu.prototype.insert=function(e,t){return new Iu(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,_u.BLACK,null,null))},Iu.prototype.remove=function(e){return new Iu(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,_u.BLACK,null,null))},Iu.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null},Iu.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},Iu.prototype.isEmpty=function(){return this.root_.isEmpty()},Iu.prototype.count=function(){return this.root_.count()},Iu.prototype.minKey=function(){return this.root_.minKey()},Iu.prototype.maxKey=function(){return this.root_.maxKey()},Iu.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},Iu.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},Iu.prototype.getIterator=function(e){return new vu(this.root_,null,this.comparator_,!1,e)},Iu.prototype.getIteratorFrom=function(e,t){return new vu(this.root_,e,this.comparator_,!1,t)},Iu.prototype.getReverseIteratorFrom=function(e,t){return new vu(this.root_,e,this.comparator_,!0,t)},Iu.prototype.getReverseIterator=function(e){return new vu(this.root_,null,this.comparator_,!0,e)},Iu.EMPTY_NODE=new he,Iu);function Iu(e,t){void 0===t&&(t=Iu.EMPTY_NODE),this.comparator_=e,this.root_=t}var Su=Math.log(2),Cu=(Au.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},Au);function Au(e){this.count=(t=e+1,parseInt(Math.log(t)/Su,10)),this.current_=this.count-1;var t=(t=this.count,parseInt(Array(t+1).join("1"),2));this.bits_=e+1&t}var ku,Nu,Du=function(c,e,l,t){c.sort(e);var h=function(e,t){if(0==(n=t-e))return null;if(1==n)return r=c[e],i=l?l(r):r,new _u(i,r.node,_u.BLACK,null,null);var n=parseInt(n/2,10)+e,e=h(e,n),t=h(n+1,t),r=c[n],i=l?l(r):r;return new _u(i,r.node,_u.BLACK,e,t)},n=function(e){for(var t=null,n=null,i=c.length,r=function(e,t){var n=i-e,r=i;i-=e,e=h(1+n,r),r=c[n],n=l?l(r):r,o(new _u(n,r.node,t,null,e))},o=function(e){t=t?t.left=e:n=e},a=0;a<e.count;++a){var s=e.nextBitIsOne(),u=Math.pow(2,e.count-(a+1));s?r(u,_u.BLACK):(r(u,_u.BLACK),r(u,_u.RED))}return n}(new Cu(c.length));return new Tu(t||e,n)},Ru={},Ou=(Object.defineProperty(Pu,"Default",{get:function(){return Io(mu,"ChildrenNode.ts has not been loaded"),ku=ku||new Pu({".priority":Ru},{".priority":mu})},enumerable:!1,configurable:!0}),Pu.prototype.get=function(e){var t=Xo(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Tu?t:null},Pu.prototype.hasIndex=function(e){return Yo(this.indexSet_,e.toString())},Pu.prototype.addIndex=function(e,t){Io(e!==su,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,r=[],i=!1,o=t.getIterator(Zs.Wrap),a=o.getNext();a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();n=i?Du(r,e.getCompare()):Ru;var s=e.toString(),u=po({},this.indexSet_);return u[s]=e,(t=po({},this.indexes_))[s]=n,new Pu(t,u)},Pu.prototype.addToIndexes=function(a,s){var u=this;return new Pu($o(this.indexes_,function(e,t){var n=Xo(u.indexSet_,t);if(Io(n,"Missing index implementation for "+t),e!==Ru)return(n=s.get(a.name))&&(e=e.remove(new Zs(a.name,n))),e.insert(a,a.node);if(n.isDefinedOn(a.node)){for(var r=[],i=s.getIterator(Zs.Wrap),o=i.getNext();o;)o.name!==a.name&&r.push(o),o=i.getNext();return r.push(a),Du(r,n.getCompare())}return Ru}),this.indexSet_)},Pu.prototype.removeFromIndexes=function(n,r){return new Pu($o(this.indexes_,function(e){if(e===Ru)return e;var t=r.get(n.name);return t?e.remove(new Zs(n.name,t)):e}),this.indexSet_)},Pu);function Pu(e,t){this.indexes_=e,this.indexSet_=t}function xu(e,t){return fs(e.name,t.name)}function Lu(e,t){return fs(e,t)}var Mu,Fu=(Object.defineProperty(Uu,"EMPTY_NODE",{get:function(){return Nu=Nu||new Uu(new Tu(Lu),null,Ou.Default)},enumerable:!1,configurable:!0}),Uu.prototype.isLeafNode=function(){return!1},Uu.prototype.getPriority=function(){return this.priorityNode_||Nu},Uu.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new Uu(this.children_,e,this.indexMap_)},Uu.prototype.getImmediateChild=function(e){return".priority"===e?this.getPriority():null===(e=this.children_.get(e))?Nu:e},Uu.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},Uu.prototype.hasChild=function(e){return null!==this.children_.get(e)},Uu.prototype.updateImmediateChild=function(e,t){if(Io(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);var n=new Zs(e,t),r=void 0,i=t.isEmpty()?(r=this.children_.remove(e),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),this.indexMap_.addToIndexes(n,this.children_)),n=r.isEmpty()?Nu:this.priorityNode_;return new Uu(r,n,i)},Uu.prototype.updateChild=function(e,t){var n=e.getFront();return null===n?t:(Io(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path"),t=this.getImmediateChild(n).updateChild(e.popFront(),t),this.updateImmediateChild(n,t))},Uu.prototype.isEmpty=function(){return this.children_.isEmpty()},Uu.prototype.numChildren=function(){return this.children_.count()},Uu.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,a=!0;if(this.forEachChild(mu,function(e,t){r[e]=t.val(n),i++,a&&Uu.INTEGER_REGEXP_.test(e)?o=Math.max(o,Number(e)):a=!1}),!n&&a&&o<2*i){var e,t=[];for(e in r)t[e]=r[e];return t}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},Uu.prototype.hash=function(){var n;return null===this.lazyHash_&&(n="",this.getPriority().isEmpty()||(n+="priority:"+uu(this.getPriority().val())+":"),this.forEachChild(mu,function(e,t){""!==(t=t.hash())&&(n+=":"+e+":"+t)}),this.lazyHash_=""===n?"":za(n)),this.lazyHash_},Uu.prototype.getPredecessorChildName=function(e,t,n){return(n=this.resolveIndex_(n))?(t=n.getPredecessorKey(new Zs(e,t)))?t.name:null:this.children_.getPredecessorKey(e)},Uu.prototype.getFirstChildName=function(e){return(e=this.resolveIndex_(e))?(e=e.minKey())&&e.name:this.children_.minKey()},Uu.prototype.getFirstChild=function(e){return(e=this.getFirstChildName(e))?new Zs(e,this.children_.get(e)):null},Uu.prototype.getLastChildName=function(e){return(e=this.resolveIndex_(e))?(e=e.maxKey())&&e.name:this.children_.maxKey()},Uu.prototype.getLastChild=function(e){return(e=this.getLastChildName(e))?new Zs(e,this.children_.get(e)):null},Uu.prototype.forEachChild=function(e,t){return(e=this.resolveIndex_(e))?e.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},Uu.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},Uu.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,Zs.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},Uu.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},Uu.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,Zs.Wrap),i=r.peek();null!=i&&0<t.compare(i,e);)r.getNext(),i=r.peek();return r},Uu.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ju?-1:0},Uu.prototype.withIndex=function(e){return e===su||this.indexMap_.hasIndex(e)?this:(e=this.indexMap_.addIndex(e,this.children_),new Uu(this.children_,this.priorityNode_,e))},Uu.prototype.isIndexed=function(e){return e===su||this.indexMap_.hasIndex(e)},Uu.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var t=this.getIterator(mu),n=e.getIterator(mu),r=t.getNext(),i=n.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1},Uu.prototype.resolveIndex_=function(e){return e===su?null:this.indexMap_.get(e.toString())},Uu.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,Uu);function Uu(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&pu(this.priorityNode_),this.children_.isEmpty()&&Io(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}function qu(){return Mu.call(this,new Tu(Lu),Fu.EMPTY_NODE,Ou.Default)||this}var ju=(fo(qu,Mu=Fu),qu.prototype.compareTo=function(e){return e===this?0:1},qu.prototype.equals=function(e){return e===this},qu.prototype.getPriority=function(){return this},qu.prototype.getImmediateChild=function(e){return Fu.EMPTY_NODE},qu.prototype.isEmpty=function(){return!1},new qu);Object.defineProperties(Zs,{MIN:{value:new Zs(ls,Fu.EMPTY_NODE)},MAX:{value:new Zs(hs,ju)}}),iu.__EMPTY_NODE=Fu.EMPTY_NODE,du.__childrenNodeConstructor=Fu,hu=au=ju;var Vu,Bu=!0;function Ku(n,e){if(void 0===e&&(e=null),null===n)return Fu.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),Io(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new du(n,Ku(e));if(n instanceof Array||!Bu){var r=Fu.EMPTY_NODE;return ds(n,function(e,t){Yo(n,e)&&"."!==e.substring(0,1)&&(!(t=Ku(t)).isLeafNode()&&t.isEmpty()||(r=r.updateImmediateChild(e,t)))}),r.updatePriority(Ku(e))}var i=[],o=!1;if(ds(n,function(e,t){"."!==e.substring(0,1)&&((t=Ku(t)).isEmpty()||(o=o||!t.getPriority().isEmpty(),i.push(new Zs(e,t))))}),0===i.length)return Fu.EMPTY_NODE;var t=Du(i,xu,function(e){return e.name},Lu);if(o){var a=Du(i,mu.getCompare());return new Fu(t,Ku(e),new Ou({".priority":a},{".priority":mu}))}return new Fu(t,Ku(e),Ou.Default)}function Wu(){return null!==Vu&&Vu.apply(this,arguments)||this}lu=Ku;var zu,Hu=(fo(Wu,Vu=fe),Wu.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?fs(e.name,t.name):n},Wu.prototype.isDefinedOn=function(e){return!0},Wu.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},Wu.prototype.minPost=function(){return Zs.MIN},Wu.prototype.maxPost=function(){return Zs.MAX},Wu.prototype.makePost=function(e,t){return e=Ku(e),new Zs(t,e)},Wu.prototype.toString=function(){return".value"},new Wu),Gu=(fo(Qu,zu=fe),Qu.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},Qu.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},Qu.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node);return 0===(r=n.compareTo(r))?fs(e.name,t.name):r},Qu.prototype.makePost=function(e,t){return e=Ku(e),e=Fu.EMPTY_NODE.updateChild(this.indexPath_,e),new Zs(t,e)},Qu.prototype.maxPost=function(){var e=Fu.EMPTY_NODE.updateChild(this.indexPath_,ju);return new Zs(hs,e)},Qu.prototype.toString=function(){return this.indexPath_.slice().join("/")},Qu);function Qu(e){var t=zu.call(this)||this;return t.indexPath_=e,Io(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),t}var Yu=(Xu.prototype.val=function(){return oa("DataSnapshot.val",0,0,arguments.length),this.node_.val()},Xu.prototype.exportVal=function(){return oa("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},Xu.prototype.toJSON=function(){return oa("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},Xu.prototype.exists=function(){return oa("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},Xu.prototype.child=function(e){oa("DataSnapshot.child",0,1,arguments.length),Us("DataSnapshot.child",1,e=String(e),!1);var t=new _s(e),e=this.ref_.child(t);return new Xu(this.node_.getChild(t),e,mu)},Xu.prototype.hasChild=function(e){return oa("DataSnapshot.hasChild",1,1,arguments.length),Us("DataSnapshot.hasChild",1,e,!1),e=new _s(e),!this.node_.getChild(e).isEmpty()},Xu.prototype.getPriority=function(){return oa("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},Xu.prototype.forEach=function(n){var r=this;return oa("DataSnapshot.forEach",1,1,arguments.length),sa("DataSnapshot.forEach",1,n,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(e,t){return n(new Xu(t,r.ref_.child(e),mu))})},Xu.prototype.hasChildren=function(){return oa("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(Xu.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),Xu.prototype.numChildren=function(){return oa("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},Xu.prototype.getRef=function(){return oa("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(Xu.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),Xu);function Xu(e,t,n){this.node_=e,this.ref_=t,this.index_=n}var Ju=($u.prototype.getPath=function(){var e=this.snapshot.getRef();return("value"===this.eventType?e:e.getParent()).path},$u.prototype.getEventType=function(){return this.eventType},$u.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},$u.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Go(this.snapshot.exportVal())},$u);function $u(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}var Zu=(ec.prototype.getPath=function(){return this.path},ec.prototype.getEventType=function(){return"cancel"},ec.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},ec.prototype.toString=function(){return this.path.toString()+":cancel"},ec);function ec(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}var tc=(nc.prototype.respondsTo=function(e){return"value"===e},nc.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new Ju("value",this,new Yu(e.snapshotNode,t.getRef(),n))},nc.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){Io(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},nc.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Zu(this,e,t):null},nc.prototype.matches=function(e){return e instanceof nc&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},nc.prototype.hasAnyCallback=function(){return null!==this.callback_},nc);function nc(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}var rc,ic=(oc.prototype.respondsTo=function(e){return e="children_removed"===(e="children_added"===e?"child_added":e)?"child_removed":e,Yo(this.callbacks_,e)},oc.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Zu(this,e,t):null},oc.prototype.createEvent=function(e,t){Io(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),t=t.getQueryParams().getIndex();return new Ju(e.type,this,new Yu(e.snapshotNode,n,t),e.prevName)},oc.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){Io(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},oc.prototype.matches=function(t){var n=this;if(t instanceof oc){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var e=Object.keys(t.callbacks_),r=Object.keys(this.callbacks_),i=e.length;if(i===r.length)return 1!==i?r.every(function(e){return t.callbacks_[e]===n.callbacks_[e]}):(e=e[0],!((r=r[0])!==e||t.callbacks_[e]&&this.callbacks_[r]&&t.callbacks_[e]!==this.callbacks_[r]))}}return!1},oc.prototype.hasAnyCallback=function(){return null!==this.callbacks_},oc);function oc(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}Object.defineProperty(ac,"__referenceConstructor",{get:function(){return Io(rc,"Reference.ts has not been loaded"),rc},set:function(e){rc=e},enumerable:!1,configurable:!0}),ac.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===su){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==ls)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==hs)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===mu){if(null!=t&&!Os(t)||null!=n&&!Os(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Io(e.getIndex()instanceof Gu||e.getIndex()===Hu,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},ac.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},ac.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},ac.prototype.getQueryParams=function(){return this.queryParams_},ac.prototype.getRef=function(){return oa("Query.ref",0,0,arguments.length),new ac.__referenceConstructor(this.repo,this.path)},ac.prototype.on=function(e,t,n,r){return oa("Query.on",2,4,arguments.length),Ms("Query.on",1,e,!1),sa("Query.on",2,t,!1),n=ac.getCancelAndContextArgs_("Query.on",n,r),"value"===e?this.onValueEvent(t,n.cancel,n.context):((r={})[e]=t,this.onChildEvent(r,n.cancel,n.context)),t},ac.prototype.onValueEvent=function(e,t,n){n=new tc(e,t||null,n||null),this.repo.addEventCallbackForQuery(this,n)},ac.prototype.onChildEvent=function(e,t,n){n=new ic(e,t,n),this.repo.addEventCallbackForQuery(this,n)},ac.prototype.off=function(e,t,n){oa("Query.off",0,3,arguments.length),Ms("Query.off",1,e,!0),sa("Query.off",2,t,!0),ua("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new tc(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new ic(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},ac.prototype.get=function(){return this.repo.getValue(this)},ac.prototype.once=function(t,n,e,r){var i=this;oa("Query.once",1,4,arguments.length),Ms("Query.once",1,t,!1),sa("Query.once",2,n,!0);var o=ac.getCancelAndContextArgs_("Query.once",e,r),a=!0,s=new No;s.promise.catch(function(){});var u=function(e){a&&(a=!1,i.off(t,u),n&&n.bind(o.context)(e),s.resolve(e))};return this.on(t,u,function(e){i.off(t,u),o.cancel&&o.cancel.bind(o.context)(e),s.reject(e)}),s.promise},ac.prototype.limitToFirst=function(e){if(oa("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new ac(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},ac.prototype.limitToLast=function(e){if(oa("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new ac(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},ac.prototype.orderByChild=function(e){if(oa("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');if(Us("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild"),(e=new _s(e)).isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");return e=new Gu(e),e=this.queryParams_.orderBy(e),ac.validateQueryEndpoints_(e),new ac(this.repo,this.path,e,!0)},ac.prototype.orderByKey=function(){oa("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(su);return ac.validateQueryEndpoints_(e),new ac(this.repo,this.path,e,!0)},ac.prototype.orderByPriority=function(){oa("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(mu);return ac.validateQueryEndpoints_(e),new ac(this.repo,this.path,e,!0)},ac.prototype.orderByValue=function(){oa("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Hu);return ac.validateQueryEndpoints_(e),new ac(this.repo,this.path,e,!0)},ac.prototype.startAt=function(e,t){void 0===e&&(e=null),oa("Query.startAt",0,2,arguments.length),Ps("Query.startAt",1,e,this.path,!0),Fs("Query.startAt",2,t,!0);var n=this.queryParams_.startAt(e,t);if(ac.validateLimit_(n),ac.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(t=e=null),new ac(this.repo,this.path,n,this.orderByCalled_)},ac.prototype.endAt=function(e,t){if(void 0===e&&(e=null),oa("Query.endAt",0,2,arguments.length),Ps("Query.endAt",1,e,this.path,!0),Fs("Query.endAt",2,t,!0),t=this.queryParams_.endAt(e,t),ac.validateLimit_(t),ac.validateQueryEndpoints_(t),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new ac(this.repo,this.path,t,this.orderByCalled_)},ac.prototype.equalTo=function(e,t){if(oa("Query.equalTo",1,2,arguments.length),Ps("Query.equalTo",1,e,this.path,!1),Fs("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},ac.prototype.toString=function(){return oa("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},ac.prototype.toJSON=function(){return oa("Query.toJSON",0,1,arguments.length),this.toString()},ac.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},ac.prototype.queryIdentifier=function(){var e=this.queryObject();return"{}"===(e=ps(e))?"default":e},ac.prototype.isEqual=function(e){if(oa("Query.isEqual",1,1,arguments.length),!(e instanceof ac))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var t=this.repo===e.repo,n=this.path.equals(e.path),e=this.queryIdentifier()===e.queryIdentifier();return t&&n&&e},ac.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,sa(e,3,r.cancel,!0),r.context=n,ua(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(aa(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(ac.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),uo=ac;function ac(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}var sc=(uc.prototype.getImmediateChild=function(e){return new uc(this.node_.getImmediateChild(e))},uc.prototype.node=function(){return this.node_},uc);function uc(e){this.node_=e}var cc=(lc.prototype.getImmediateChild=function(e){return e=this.path_.child(e),new lc(this.syncTree_,e)},lc.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},lc);function lc(e,t){this.syncTree_=e,this.path_=t}function hc(e,t,n,r){return yc(t,new cc(n,e),r)}function fc(e,t,n){return yc(e,new sc(t),n)}var pc=function(e,t,n){return e&&"object"==typeof e?(Io(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?dc(e[".sv"],t,n):"object"==typeof e[".sv"]?gc(e[".sv"],t):void Io(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},dc=function(e,t,n){if("timestamp"===e)return n.timestamp;Io(!1,"Unexpected server value: "+e)},gc=function(e,t,n){return e.hasOwnProperty("increment")||Io(!1,"Unexpected server value: "+JSON.stringify(e,null,2)),"number"!=typeof(e=e.increment)&&Io(!1,"Unexpected increment value: "+e),t=t.node(),Io(null!=t,"Expected ChildrenNode.EMPTY_NODE for nulls"),!t.isLeafNode()||"number"!=typeof(t=t.getValue())?e:t+e};function yc(e,r,i){var t=e.getPriority().val(),n=pc(t,r.getImmediateChild(".priority"),i);if(e.isLeafNode()){var o=e;return(t=pc(o.getValue(),r,i))!==o.getValue()||n!==o.getPriority().val()?new du(t,Ku(n)):e}var a=e=e;return n!==e.getPriority().val()&&(a=a.updatePriority(new du(n))),e.forEachChild(mu,function(e,t){var n=yc(t,r.getImmediateChild(e),i);n!==t&&(a=a.updateImmediateChild(e,n))}),a}var mc,vc=(bc.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&0<this.children.size){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},bc.prototype.remember=function(e,t){var n;e.isEmpty()?(this.value=t,this.children.clear()):null!==this.value?this.value=this.value.updateChild(e,t):(n=e.getFront(),this.children.has(n)||this.children.set(n,new bc),n=this.children.get(n),e=e.popFront(),n.remember(e,t))},bc.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null===this.value)return!(0<this.children.size)||(t=e.getFront(),e=e.popFront(),this.children.has(t)&&this.children.get(t).forget(e)&&this.children.delete(t),0===this.children.size);if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var n=this;return t.forEachChild(mu,function(e,t){n.remember(new _s(e),t)}),this.forget(e)},bc.prototype.forEachTree=function(n,r){null!==this.value?r(n,this.value):this.forEachChild(function(e,t){e=new _s(n.toString()+"/"+e),t.forEachTree(e,r)})},bc.prototype.forEachChild=function(n){this.children.forEach(function(e,t){n(t,e)})},bc);function bc(){this.value=null,this.children=new Map}(Hn=mc={})[Hn.OVERWRITE=0]="OVERWRITE",Hn[Hn.MERGE=1]="MERGE",Hn[Hn.ACK_USER_WRITE=2]="ACK_USER_WRITE",Hn[Hn.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var _c=(wc.User=new wc(!0,!1,null,!1),wc.Server=new wc(!1,!0,null,!1),wc.forServerTaggedQuery=function(e){return new wc(!1,!0,e,!0)},wc);function wc(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,Io(!r||t,"Tagged queries must be from server.")}var Ec,Tc=(Ic.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Io(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new _s(e));return new Ic(_s.Empty,t,this.revert)}return Io(this.path.getFront()===e,"operationForChild called for unrelated child."),new Ic(this.path.popFront(),this.affectedTree,this.revert)},Ic);function Ic(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=mc.ACK_USER_WRITE,this.source=_c.User}var Sc=(Cc.fromObject=function(e){var n=Cc.Empty;return ds(e,function(e,t){n=n.set(new _s(e),t)}),n},Cc.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},Cc.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:_s.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);return null===r||null==(t=r.findRootMostMatchingPathAndValue(e.popFront(),t))?null:{path:new _s(n).child(t.path),value:t.value}},Cc.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},Cc.prototype.subtree=function(e){if(e.isEmpty())return this;var t=e.getFront();return null!==(t=this.children.get(t))?t.subtree(e.popFront()):Cc.Empty},Cc.prototype.set=function(e,t){if(e.isEmpty())return new Cc(t,this.children);var n=e.getFront(),t=(this.children.get(n)||Cc.Empty).set(e.popFront(),t),t=this.children.insert(n,t);return new Cc(this.value,t)},Cc.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?Cc.Empty:new Cc(null,this.children);var t=e.getFront(),n=this.children.get(t);return n?(n=n.remove(e.popFront()),e=void 0,e=n.isEmpty()?this.children.remove(t):this.children.insert(t,n),null===this.value&&e.isEmpty()?Cc.Empty:new Cc(this.value,e)):this},Cc.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront();return(t=this.children.get(t))?t.get(e.popFront()):null},Cc.prototype.setTree=function(e,t){if(e.isEmpty())return t;var n=e.getFront(),e=(this.children.get(n)||Cc.Empty).setTree(e.popFront(),t),t=void 0,t=e.isEmpty()?this.children.remove(n):this.children.insert(n,e);return new Cc(this.value,t)},Cc.prototype.fold=function(e){return this.fold_(_s.Empty,e)},Cc.prototype.fold_=function(n,r){var i={};return this.children.inorderTraversal(function(e,t){i[e]=t.fold_(n.child(e),r)}),r(n,this.value,i)},Cc.prototype.findOnPath=function(e,t){return this.findOnPath_(e,_s.Empty,t)},Cc.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront();return(r=this.children.get(i))?r.findOnPath_(e.popFront(),t.child(i),n):null},Cc.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,_s.Empty,t)},Cc.prototype.foreachOnPath_=function(e,t,n){if(e.isEmpty())return this;this.value&&n(t,this.value);var r=e.getFront(),i=this.children.get(r);return i?i.foreachOnPath_(e.popFront(),t.child(r),n):Cc.Empty},Cc.prototype.foreach=function(e){this.foreach_(_s.Empty,e)},Cc.prototype.foreach_=function(n,r){this.children.inorderTraversal(function(e,t){t.foreach_(n.child(e),r)}),this.value&&r(n,this.value)},Cc.prototype.foreachChild=function(n){this.children.inorderTraversal(function(e,t){t.value&&n(e,t.value)})},Cc.Empty=new Cc(null),Cc);function Cc(e,t){void 0===t&&(t=Ec=Ec||new Tu(Ja)),this.value=e,this.children=t}var Ac=(kc.prototype.operationForChild=function(e){return this.path.isEmpty()?new kc(this.source,_s.Empty):new kc(this.source,this.path.popFront())},kc);function kc(e,t){this.source=e,this.path=t,this.type=mc.LISTEN_COMPLETE}var Nc=(Dc.prototype.operationForChild=function(e){return this.path.isEmpty()?new Dc(this.source,_s.Empty,this.snap.getImmediateChild(e)):new Dc(this.source,this.path.popFront(),this.snap)},Dc);function Dc(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=mc.OVERWRITE}var Rc=(Oc.prototype.operationForChild=function(e){if(this.path.isEmpty()){var t=this.children.subtree(new _s(e));return t.isEmpty()?null:t.value?new Nc(this.source,_s.Empty,t.value):new Oc(this.source,_s.Empty,t)}return Io(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new Oc(this.source,this.path.popFront(),this.children)},Oc.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Oc);function Oc(e,t,n){this.source=e,this.path=t,this.children=n,this.type=mc.MERGE}var Pc=(xc.prototype.isFullyInitialized=function(){return this.fullyInitialized_},xc.prototype.isFiltered=function(){return this.filtered_},xc.prototype.isCompleteForPath=function(e){return e.isEmpty()?this.isFullyInitialized()&&!this.filtered_:(e=e.getFront(),this.isCompleteForChild(e))},xc.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},xc.prototype.getNode=function(){return this.node_},xc);function xc(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}var Lc=(Mc.prototype.updateEventSnap=function(e,t,n){return new Mc(new Pc(e,t,n),this.serverCache_)},Mc.prototype.updateServerSnap=function(e,t,n){return new Mc(this.eventCache_,new Pc(e,t,n))},Mc.prototype.getEventCache=function(){return this.eventCache_},Mc.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},Mc.prototype.getServerCache=function(){return this.serverCache_},Mc.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},Mc.Empty=new Mc(new Pc(Fu.EMPTY_NODE,!1,!1),new Pc(Fu.EMPTY_NODE,!1,!1)),Mc);function Mc(e,t){this.eventCache_=e,this.serverCache_=t}var Fc=(Uc.valueChange=function(e){return new Uc(Uc.VALUE,e)},Uc.childAddedChange=function(e,t){return new Uc(Uc.CHILD_ADDED,t,e)},Uc.childRemovedChange=function(e,t){return new Uc(Uc.CHILD_REMOVED,t,e)},Uc.childChangedChange=function(e,t,n){return new Uc(Uc.CHILD_CHANGED,t,e,n)},Uc.childMovedChange=function(e,t){return new Uc(Uc.CHILD_MOVED,t,e)},Uc.CHILD_ADDED="child_added",Uc.CHILD_REMOVED="child_removed",Uc.CHILD_CHANGED="child_changed",Uc.CHILD_MOVED="child_moved",Uc.VALUE="value",Uc);function Uc(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}var qc=(jc.prototype.updateChild=function(e,t,n,r,i,o){Io(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Fc.childRemovedChange(t,a)):Io(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Fc.childAddedChange(t,n)):o.trackChildChange(Fc.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},jc.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(mu,function(e,t){n.hasChild(e)||i.trackChildChange(Fc.childRemovedChange(e,t))}),n.isLeafNode()||n.forEachChild(mu,function(e,t){var n;r.hasChild(e)?(n=r.getImmediateChild(e)).equals(t)||i.trackChildChange(Fc.childChangedChange(e,t,n)):i.trackChildChange(Fc.childAddedChange(e,t))})),n.withIndex(this.index_)},jc.prototype.updatePriority=function(e,t){return e.isEmpty()?Fu.EMPTY_NODE:e.updatePriority(t)},jc.prototype.filtersNodes=function(){return!1},jc.prototype.getIndexedFilter=function(){return this},jc.prototype.getIndex=function(){return this.index_},jc);function jc(e){this.index_=e}var Vc=(Bc.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Io(t===Fc.CHILD_ADDED||t===Fc.CHILD_CHANGED||t===Fc.CHILD_REMOVED,"Only child changes supported for tracking"),Io(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(t===Fc.CHILD_ADDED&&i===Fc.CHILD_REMOVED)this.changeMap.set(n,Fc.childChangedChange(n,e.snapshotNode,r.snapshotNode));else if(t===Fc.CHILD_REMOVED&&i===Fc.CHILD_ADDED)this.changeMap.delete(n);else if(t===Fc.CHILD_REMOVED&&i===Fc.CHILD_CHANGED)this.changeMap.set(n,Fc.childRemovedChange(n,r.oldSnap));else if(t===Fc.CHILD_CHANGED&&i===Fc.CHILD_ADDED)this.changeMap.set(n,Fc.childAddedChange(n,e.snapshotNode));else{if(t!==Fc.CHILD_CHANGED||i!==Fc.CHILD_CHANGED)throw So("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Fc.childChangedChange(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},Bc.prototype.getChanges=function(){return Array.from(this.changeMap.values())},Bc);function Bc(){this.changeMap=new Map}function Kc(){}var Wc=(Kc.prototype.getCompleteChild=function(e){return null},Kc.prototype.getChildAfterChild=function(e,t,n){return null},new Kc),zc=(Hc.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();return t.isCompleteForChild(e)?t.getNode().getImmediateChild(e):(t=null!=this.optCompleteServerCache_?new Pc(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache(),this.writes_.calcCompleteChild(e,t))},Hc.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap();return 0===(e=this.writes_.calcIndexedSlice(r,t,1,n,e)).length?null:e[0]},Hc);function Hc(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}function Gc(e,t){this.viewCache=e,this.changes=t}var Qc=(Yc.prototype.assertIndexed=function(e){Io(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Io(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},Yc.prototype.applyOperation=function(e,t,n,r){var i=new Vc;if(t.type===mc.OVERWRITE)var o=t,a=o.source.fromUser?this.applyUserOverwrite_(e,o.path,o.snap,n,r,i):(Io(o.source.fromServer,"Unknown source."),s=o.source.tagged||e.getServerCache().isFiltered()&&!o.path.isEmpty(),this.applyServerOverwrite_(e,o.path,o.snap,n,r,s,i));else if(t.type===mc.MERGE)a=(o=t).source.fromUser?this.applyUserMerge_(e,o.path,o.children,n,r,i):(Io(o.source.fromServer,"Unknown source."),s=o.source.tagged||e.getServerCache().isFiltered(),this.applyServerMerge_(e,o.path,o.children,n,r,s,i));else if(t.type===mc.ACK_USER_WRITE)var s=t,a=s.revert?this.revertUserWrite_(e,s.path,n,r,i):this.ackUserWrite_(e,s.path,s.affectedTree,n,r,i);else{if(t.type!==mc.LISTEN_COMPLETE)throw So("Unknown operation type: "+t.type);a=this.listenComplete_(e,t.path,n,i)}return i=i.getChanges(),Yc.maybeAddValueEvent_(e,a,i),new Gc(a,i)},Yc.maybeAddValueEvent_=function(e,t,n){var r,i,o=t.getEventCache();o.isFullyInitialized()&&(r=o.getNode().isLeafNode()||o.getNode().isEmpty(),i=e.getCompleteEventSnap(),(0<n.length||!e.getEventCache().isFullyInitialized()||r&&!o.getNode().equals(i)||!o.getNode().getPriority().equals(i.getPriority()))&&n.push(Fc.valueChange(t.getCompleteEventSnap())))},Yc.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a,s,u,c,l=void 0,h=t.isEmpty()?(Io(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()?(a=(a=e.getCompleteServerSnap())instanceof Fu?a:Fu.EMPTY_NODE,a=n.calcCompleteEventChildren(a),this.filter_.updateFullNode(e.getEventCache().getNode(),a,i)):(s=n.calcCompleteEventCache(e.getCompleteServerSnap()),this.filter_.updateFullNode(e.getEventCache().getNode(),s,i))):".priority"===(s=t.getFront())?(Io(1===t.getLength(),"Can't have a priority with additional path components"),u=o.getNode(),l=e.getServerCache().getNode(),null!=(c=n.calcEventCacheAfterServerOverwrite(t,u,l))?this.filter_.updatePriority(u,c):o.getNode()):(u=t.popFront(),c=void 0,null!=(c=o.isCompleteForChild(s)?(l=e.getServerCache().getNode(),null!=(l=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),l))?o.getNode().getImmediateChild(s).updateChild(u,l):o.getNode().getImmediateChild(s)):n.calcCompleteChild(s,e.getServerCache()))?this.filter_.updateChild(o.getNode(),s,c,u,r,i):o.getNode());return e.updateEventSnap(h,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},Yc.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s=e.getServerCache(),u=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())l=u.updateFullNode(s.getNode(),n,null);else if(u.filtersNodes()&&!s.isFiltered())var c=s.getNode().updateChild(t,n),l=u.updateFullNode(s.getNode(),c,null);else{if(o=t.getFront(),!s.isCompleteForPath(t)&&1<t.getLength())return e;c=t.popFront(),n=s.getNode().getImmediateChild(o).updateChild(c,n),l=".priority"===o?u.updatePriority(s.getNode(),n):u.updateChild(s.getNode(),o,n,c,Wc,null)}return u=e.updateServerSnap(l,s.isFullyInitialized()||t.isEmpty(),u.filtersNodes()),i=new zc(r,u,i),this.generateEventCacheAfterServerEvent_(u,t,r,i,a)},Yc.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,s,u=e.getEventCache(),c=new zc(r,e,i);return t.isEmpty()?(s=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),e.updateEventSnap(s,!0,this.filter_.filtersNodes())):".priority"===(a=t.getFront())?(s=this.filter_.updatePriority(e.getEventCache().getNode(),n),e.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered())):(r=t.popFront(),i=u.getNode().getImmediateChild(a),s=void 0,s=r.isEmpty()?n:null!=(t=c.getCompleteChild(a))?".priority"===r.getBack()&&t.getChild(r.parent()).isEmpty()?t:t.updateChild(r,n):Fu.EMPTY_NODE,i.equals(s)?e:(o=this.filter_.updateChild(u.getNode(),a,s,r,c,o),e.updateEventSnap(o,u.isFullyInitialized(),this.filter_.filtersNodes())))},Yc.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},Yc.prototype.applyUserMerge_=function(n,r,e,i,o,a){var s=this,u=n;return e.foreach(function(e,t){e=r.child(e),Yc.cacheHasChild_(n,e.getFront())&&(u=s.applyUserOverwrite_(u,e,t,i,o,a))}),e.foreach(function(e,t){e=r.child(e),Yc.cacheHasChild_(n,e.getFront())||(u=s.applyUserOverwrite_(u,e,t,i,o,a))}),u},Yc.prototype.applyMerge_=function(n,e){return e.foreach(function(e,t){n=n.updateChild(e,t)}),n},Yc.prototype.applyServerMerge_=function(r,e,t,i,o,a,s){var u=this;if(r.getServerCache().getNode().isEmpty()&&!r.getServerCache().isFullyInitialized())return r;var c=r,t=e.isEmpty()?t:Sc.Empty.setTree(e,t),l=r.getServerCache().getNode();return t.children.inorderTraversal(function(e,t){var n;l.hasChild(e)&&(n=r.getServerCache().getNode().getImmediateChild(e),t=u.applyMerge_(n,t),c=u.applyServerOverwrite_(c,new _s(e),t,i,o,a,s))}),t.children.inorderTraversal(function(e,t){var n=!r.getServerCache().isCompleteForChild(e)&&null==t.value;l.hasChild(e)||n||(n=r.getServerCache().getNode().getImmediateChild(e),t=u.applyMerge_(n,t),c=u.applyServerOverwrite_(c,new _s(e),t,i,o,a,s))}),c},Yc.prototype.ackUserWrite_=function(e,r,t,n,i,o){if(null!=n.shadowingWrite(r))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=t.value){if(r.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(r))return this.applyServerOverwrite_(e,r,s.getNode().getChild(r),n,i,a,o);if(r.isEmpty()){var u=Sc.Empty;return s.getNode().forEachChild(su,function(e,t){u=u.set(new _s(e),t)}),this.applyServerMerge_(e,r,u,n,i,a,o)}return e}var c=Sc.Empty;return t.foreach(function(e,t){var n=r.child(e);s.isCompleteForPath(n)&&(c=c.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,r,c,n,i,a,o)},Yc.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),i=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(i,t,n,Wc,r)},Yc.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a,s,u=new zc(n,e,r),c=e.getEventCache().getNode(),r=void 0;return t.isEmpty()||".priority"===t.getFront()?(s=void 0,s=e.getServerCache().isFullyInitialized()?n.calcCompleteEventCache(e.getCompleteServerSnap()):(a=e.getServerCache().getNode(),Io(a instanceof Fu,"serverChildren would be complete if leaf node"),n.calcCompleteEventChildren(a)),r=this.filter_.updateFullNode(c,s,i)):(a=t.getFront(),null==(s=n.calcCompleteChild(a,e.getServerCache()))&&e.getServerCache().isCompleteForChild(a)&&(s=c.getImmediateChild(a)),(r=null!=s?this.filter_.updateChild(c,a,s,t.popFront(),u,i):e.getEventCache().getNode().hasChild(a)?this.filter_.updateChild(c,a,Fu.EMPTY_NODE,t.popFront(),u,i):c).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(r=this.filter_.updateFullNode(r,o,i))),o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(_s.Empty),e.updateEventSnap(r,o,this.filter_.filtersNodes())},Yc);function Yc(e){this.filter_=e}var Xc=(Jc.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach(function(e){e.type===Fc.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Fc.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,Fc.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,Fc.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,Fc.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,Fc.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,Fc.VALUE,e,n,t),i},Jc.prototype.generateEventsForType_=function(r,t,e,i,o){var a=this;(e=e.filter(function(e){return e.type===t})).sort(this.compareChanges_.bind(this)),e.forEach(function(t){var n=a.materializeSingleChange_(t,o);i.forEach(function(e){e.respondsTo(t.type)&&r.push(e.createEvent(n,a.query_))})})},Jc.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_)),e},Jc.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw So("Should only compare child_ events.");return e=new Zs(e.childName,e.snapshotNode),t=new Zs(t.childName,t.snapshotNode),this.index_.compare(e,t)},Jc);function Jc(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}var $c,Zc=(el.prototype.getQuery=function(){return this.query_},el.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},el.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},el.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},el.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},el.prototype.removeEventRegistration=function(e,t){var n,r=[];if(t&&(Io(null==e,"A cancel should cancel all event registrations."),n=this.query_.path,this.eventRegistrations_.forEach(function(e){(e=e.createCancelEvent(t,n))&&r.push(e)})),e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},el.prototype.applyOperation=function(e,t,n){e.type===mc.MERGE&&null!==e.source.queryId&&(Io(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Io(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,n=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(n.viewCache),Io(n.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=n.viewCache,this.generateEventsForChanges_(n.changes,n.viewCache.getEventCache().getNode(),null)},el.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(mu,function(e,t){n.push(Fc.childAddedChange(e,t))}),t.isFullyInitialized()&&n.push(Fc.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},el.prototype.generateEventsForChanges_=function(e,t,n){return n=n?[n]:this.eventRegistrations_,this.eventGenerator_.generateEventsForChanges(e,t,n)},el);function el(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new qc(n.getIndex()),i=n.getNodeFilter();this.processor_=new Qc(i);var o=t.getServerCache(),e=t.getEventCache(),n=r.updateFullNode(Fu.EMPTY_NODE,o.getNode(),null),t=i.updateFullNode(Fu.EMPTY_NODE,e.getNode(),null),r=new Pc(n,o.isFullyInitialized(),r.filtersNodes()),i=new Pc(t,e.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Lc(i,r),this.eventGenerator_=new Xc(this.query_)}var tl=(Object.defineProperty(nl,"__referenceConstructor",{get:function(){return Io($c,"Reference.ts has not been loaded"),$c},set:function(e){Io(!$c,"__referenceConstructor has already been defined"),$c=e},enumerable:!1,configurable:!0}),nl.prototype.isEmpty=function(){return 0===this.views.size},nl.prototype.applyOperation=function(e,t,n){var r,i,o=e.source.queryId;if(null!==o){var a=this.views.get(o);return Io(null!=a,"SyncTree gave us an op for an invalid query."),a.applyOperation(e,t,n)}var s=[];try{for(var u=mo(this.views.values()),c=u.next();!c.done;c=u.next())a=c.value,s=s.concat(a.applyOperation(e,t,n))}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s},nl.prototype.addEventRegistration=function(e,t,n,r,i){var o,a,s=e.queryIdentifier(),u=this.views.get(s);return u||(a=!!(o=n.calcCompleteEventCache(i?r:null))||(o=r instanceof Fu?n.calcCompleteEventChildren(r):Fu.EMPTY_NODE,!1),i=new Lc(new Pc(o,a,!1),new Pc(r,i,!1)),u=new Zc(e,i),this.views.set(s,u)),u.addEventRegistration(t),u.getInitialEvents(t)},nl.prototype.removeEventRegistration=function(e,t,n){var r,i,o=e.queryIdentifier(),a=[],s=[],u=this.hasCompleteView();if("default"===o)try{for(var c=mo(this.views.entries()),l=c.next();!l.done;l=c.next()){var h=vo(l.value,2),f=h[0],p=h[1],s=s.concat(p.removeEventRegistration(t,n));p.isEmpty()&&(this.views.delete(f),p.getQuery().getQueryParams().loadsAllData()||a.push(p.getQuery()))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}else(p=this.views.get(o))&&(s=s.concat(p.removeEventRegistration(t,n)),p.isEmpty()&&(this.views.delete(o),p.getQuery().getQueryParams().loadsAllData()||a.push(p.getQuery())));return u&&!this.hasCompleteView()&&a.push(new nl.__referenceConstructor(e.repo,e.path)),{removed:a,events:s}},nl.prototype.getQueryViews=function(){var e,t,n=[];try{for(var r=mo(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},nl.prototype.getCompleteServerCache=function(e){var t,n,r=null;try{for(var i=mo(this.views.values()),o=i.next();!o.done;o=i.next())var a=o.value,r=r||a.getCompleteServerCache(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},nl.prototype.viewForQuery=function(e){return e.getQueryParams().loadsAllData()?this.getCompleteView():(e=e.queryIdentifier(),this.views.get(e))},nl.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},nl.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},nl.prototype.getCompleteView=function(){var e,t;try{for(var n=mo(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},nl);function nl(){this.views=new Map}var rl=(il.prototype.addWrite=function(e,t){if(e.isEmpty())return new il(new Sc(t));if(null==(i=this.writeTree_.findRootMostValueAndPath(e)))return t=new Sc(t),new il(this.writeTree_.setTree(e,t));var n=i.path,r=i.value,i=_s.relativePath(n,e),r=r.updateChild(i,t);return new il(this.writeTree_.set(n,r))},il.prototype.addWrites=function(n,e){var r=this;return ds(e,function(e,t){r=r.addWrite(n.child(e),t)}),r},il.prototype.removeWrite=function(e){return e.isEmpty()?il.Empty:new il(this.writeTree_.setTree(e,Sc.Empty))},il.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},il.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(_s.relativePath(t.path,e)):null},il.prototype.getCompleteChildren=function(){var n=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(mu,function(e,t){n.push(new Zs(e,t))}):this.writeTree_.children.inorderTraversal(function(e,t){null!=t.value&&n.push(new Zs(e,t.value))}),n},il.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var t=this.getCompleteNode(e);return new il(null!=t?new Sc(t):this.writeTree_.subtree(e))},il.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},il.prototype.apply=function(e){return function n(r,e,i){if(null!=e.value)return i.updateChild(r,e.value);var o=null;return e.children.inorderTraversal(function(e,t){".priority"===e?(Io(null!==t.value,"Priority writes must always be leaf nodes"),o=t.value):i=n(r.child(e),t,i)}),i.getChild(r).isEmpty()||null===o||(i=i.updateChild(r.child(".priority"),o)),i}(_s.Empty,this.writeTree_,e)},il.Empty=new il(new Sc(null)),il);function il(e){this.writeTree_=e}var ol=(al.prototype.childWrites=function(e){return new sl(e,this)},al.prototype.addOverwrite=function(e,t,n,r){Io(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},al.prototype.addMerge=function(e,t,n){Io(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},al.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},al.prototype.removeWrite=function(t){var n=this,e=this.allWrites_.findIndex(function(e){return e.writeId===t});Io(0<=e,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[e];this.allWrites_.splice(e,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&0<=a;){var s=this.allWrites_[a];s.visible&&(e<=a&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}return!!i&&(o?this.resetTree_():r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):ds(r.children,function(e){n.visibleWrites_=n.visibleWrites_.removeWrite(r.path.child(e))}),!0)},al.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},al.prototype.calcCompleteEventCache=function(t,e,n,r){if(n||r){var i=this.visibleWrites_.childCompoundWrite(t);if(!r&&i.isEmpty())return e;if(r||null!=e||i.hasCompleteWrite(_s.Empty)){var o=al.layerTree_(this.allWrites_,function(e){return(e.visible||r)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t),a=e||Fu.EMPTY_NODE;return o.apply(a)}return null}if(null!=(o=this.visibleWrites_.getCompleteNode(t)))return o;if((o=this.visibleWrites_.childCompoundWrite(t)).isEmpty())return e;if(null!=e||o.hasCompleteWrite(_s.Empty)){a=e||Fu.EMPTY_NODE;return o.apply(a)}return null},al.prototype.calcCompleteEventChildren=function(e,t){var n=Fu.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(mu,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(mu,function(e,t){t=i.childCompoundWrite(new _s(e)).apply(t),n=n.updateImmediateChild(e,t)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},al.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){return Io(n||r,"Either existingEventSnap or existingServerSnap must exist"),e=e.child(t),this.visibleWrites_.hasCompleteWrite(e)?null:(e=this.visibleWrites_.childCompoundWrite(e)).isEmpty()?r.getChild(t):e.apply(r.getChild(t))},al.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t);return null!=(e=this.visibleWrites_.getCompleteNode(r))?e:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},al.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},al.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e);if(null!=(e=s.getCompleteNode(_s.Empty)))a=e;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var u=[],c=o.getCompare(),l=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),h=l.getNext();h&&u.length<r;)0!==c(h,n)&&u.push(h),h=l.getNext();return u},al.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&e.path.child(n).contains(t))return!0;return!1},al.prototype.resetTree_=function(){this.visibleWrites_=al.layerTree_(this.allWrites_,al.DefaultFilter_,_s.Empty),0<this.allWrites_.length?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},al.DefaultFilter_=function(e){return e.visible},al.layerTree_=function(e,t,n){for(var r=rl.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=_s.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=_s.relativePath(a,n),r=r.addWrite(_s.Empty,o.snap.getChild(s)));else{if(!o.children)throw So("WriteRecord should have .snap or .children");n.contains(a)?(s=_s.relativePath(n,a),r=r.addWrites(s,o.children)):a.contains(n)&&((s=_s.relativePath(a,n)).isEmpty()?r=r.addWrites(_s.Empty,o.children):(o=Xo(o.children,s.getFront()))&&(s=o.getChild(s.popFront()),r=r.addWrite(_s.Empty,s)))}}}return r},al);function al(){this.visibleWrites_=rl.Empty,this.allWrites_=[],this.lastWriteId_=-1}var sl=(ul.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},ul.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},ul.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},ul.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},ul.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},ul.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},ul.prototype.child=function(e){return new ul(this.treePath_.child(e),this.writeTree_)},ul);function ul(e,t){this.treePath_=e,this.writeTree_=t}var cl=(ll.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new Nc(_c.User,e,t)):[]},ll.prototype.applyUserMerge=function(e,t,n){return this.pendingWriteTree_.addMerge(e,t,n),t=Sc.fromObject(t),this.applyOperationToSyncPoints_(new Rc(_c.User,e,t))},ll.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=Sc.Empty;return null!=n.snap?r=r.set(_s.Empty,!0):ds(n.children,function(e,t){r=r.set(new _s(e),t)}),this.applyOperationToSyncPoints_(new Tc(n.path,r,t))}return[]},ll.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new Nc(_c.Server,e,t))},ll.prototype.applyServerMerge=function(e,t){return t=Sc.fromObject(t),this.applyOperationToSyncPoints_(new Rc(_c.Server,e,t))},ll.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new Ac(_c.Server,e))},ll.prototype.applyTaggedQueryOverwrite=function(e,t,n){var r=this.queryKeyForTag_(n);return null==r?[]:(r=(n=ll.parseQueryKey_(r)).path,n=n.queryId,e=_s.relativePath(r,e),t=new Nc(_c.forServerTaggedQuery(n),e,t),this.applyTaggedOperation_(r,t))},ll.prototype.applyTaggedQueryMerge=function(e,t,n){var r=this.queryKeyForTag_(n);return r?(r=(n=ll.parseQueryKey_(r)).path,n=n.queryId,e=_s.relativePath(r,e),t=Sc.fromObject(t),t=new Rc(_c.forServerTaggedQuery(n),e,t),this.applyTaggedOperation_(r,t)):[]},ll.prototype.applyTaggedListenComplete=function(e,t){var n=this.queryKeyForTag_(t);return n?(n=(t=ll.parseQueryKey_(n)).path,t=t.queryId,e=_s.relativePath(n,e),e=new Ac(_c.forServerTaggedQuery(t),e),this.applyTaggedOperation_(n,e)):[]},ll.prototype.addEventRegistration=function(e,t){var n=e.path,r=null,i=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){e=_s.relativePath(e,n),r=r||t.getCompleteServerCache(e),i=i||t.hasCompleteView()});var o=this.syncPointTree_.get(n);o?(i=i||o.hasCompleteView(),r=r||o.getCompleteServerCache(_s.Empty)):(o=new tl,this.syncPointTree_=this.syncPointTree_.set(n,o)),null!=r?c=!0:(c=!1,r=Fu.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){(t=t.getCompleteServerCache(_s.Empty))&&(r=r.updateImmediateChild(e,t))}));var a,s=o.viewExistsForQuery(e);s||e.getQueryParams().loadsAllData()||(u=ll.makeQueryKey_(e),Io(!this.queryToTagMap.has(u),"View does not exist, but we have a tag"),a=ll.getNextQueryTag_(),this.queryToTagMap.set(u,a),this.tagToQueryMap.set(a,u));var u=this.pendingWriteTree_.childWrites(n),c=o.addEventRegistration(e,t,u,r,c);return s||i||(o=o.viewForQuery(e),c=c.concat(this.setupListener_(e,o))),c},ll.prototype.removeEventRegistration=function(e,t,n){var r=this,i=e.path,o=this.syncPointTree_.get(i),a=[];if(o&&("default"===e.queryIdentifier()||o.viewExistsForQuery(e))){var s=o.removeEventRegistration(e,t,n);if(o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i)),t=s.removed,a=s.events,o=-1!==t.findIndex(function(e){return e.getQueryParams().loadsAllData()}),s=this.syncPointTree_.findOnPath(i,function(e,t){return t.hasCompleteView()}),o&&!s&&!(i=this.syncPointTree_.subtree(i)).isEmpty())for(var u=this.collectDistinctViewsForSubTree_(i),c=0;c<u.length;++c){var l=(h=u[c]).getQuery(),h=this.createListenerForView_(h);this.listenProvider_.startListening(ll.queryForListening_(l),this.tagForQuery_(l),h.hashFn,h.onComplete)}!s&&0<t.length&&!n&&(o?this.listenProvider_.stopListening(ll.queryForListening_(e),null):t.forEach(function(e){var t=r.queryToTagMap.get(ll.makeQueryKey_(e));r.listenProvider_.stopListening(ll.queryForListening_(e),t)})),this.removeTags_(t)}return a},ll.prototype.calcCompleteEventCache=function(n,e){var t=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(n,function(e,t){if(e=_s.relativePath(e,n),e=t.getCompleteServerCache(e))return e});return t.calcCompleteEventCache(n,r,e,!0)},ll.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),ds(n,function(e,t){r=r.concat(t)}),r})},ll.prototype.removeTags_=function(e){for(var t=0;t<e.length;++t){var n,r=e[t];r.getQueryParams().loadsAllData()||(n=ll.makeQueryKey_(r),r=this.queryToTagMap.get(n),this.queryToTagMap.delete(n),this.tagToQueryMap.delete(r))}},ll.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},ll.prototype.setupListener_=function(e,t){var n=e.path,r=this.tagForQuery_(e),t=this.createListenerForView_(t),t=this.listenProvider_.startListening(ll.queryForListening_(e),r,t.hashFn,t.onComplete),n=this.syncPointTree_.subtree(n);if(r)Io(!n.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var i=n.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),ds(n,function(e,t){r=r.concat(t)}),r}),o=0;o<i.length;++o){var a=i[o];this.listenProvider_.stopListening(ll.queryForListening_(a),this.tagForQuery_(a))}return t},ll.prototype.createListenerForView_=function(e){var r=this,i=e.getQuery(),o=this.tagForQuery_(i);return{hashFn:function(){return(e.getServerCache()||Fu.EMPTY_NODE).hash()},onComplete:function(e){return"ok"===e?o?r.applyTaggedListenComplete(i.path,o):r.applyListenComplete(i.path):(n="Unknown Error","too_big"===(t=e)?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable"),(n=new Error(t+" at "+i.path.toString()+": "+n)).code=t.toUpperCase(),e=n,r.removeEventRegistration(i,null,e));var t,n}}},ll.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},ll.parseQueryKey_=function(e){var t=e.indexOf("$");return Io(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new _s(e.substr(0,t))}},ll.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},ll.prototype.tagForQuery_=function(e){return e=ll.makeQueryKey_(e),this.queryToTagMap.get(e)},ll.getNextQueryTag_=function(){return ll.nextQueryTag_++},ll.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);return Io(n,"Missing sync point for query tag that we're tracking"),e=this.pendingWriteTree_.childWrites(e),n.applyOperation(t,e,null)},ll.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(_s.Empty))},ll.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(_s.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(_s.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);return u&&s&&(t=n?n.getImmediateChild(a):null,a=r.child(a),o=o.concat(this.applyOperationHelper_(s,u,t,a))),i&&(o=o.concat(i.applyOperation(e,r,n))),o},ll.prototype.applyOperationDescendantsHelper_=function(i,e,o,a){var s=this,t=e.get(_s.Empty);null==o&&null!=t&&(o=t.getCompleteServerCache(_s.Empty));var u=[];return e.children.inorderTraversal(function(e,t){var n=o?o.getImmediateChild(e):null,r=a.child(e);(e=i.operationForChild(e))&&(u=u.concat(s.applyOperationDescendantsHelper_(e,t,n,r)))}),t&&(u=u.concat(t.applyOperation(i,a,o))),u},ll.nextQueryTag_=1,ll);function ll(e){this.listenProvider_=e,this.syncPointTree_=Sc.Empty,this.pendingWriteTree_=new ol,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}var hl=(fl.prototype.getNode=function(e){return this.rootNode_.getChild(e)},fl.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},fl);function fl(){this.rootNode_=Fu.EMPTY_NODE}var pl=(dl.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Yo(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},dl.prototype.get=function(){return Ao(this.counters_)},dl);function dl(){this.counters_={}}var gl=(yl.getCollection=function(e){return e=e.toString(),this.collections_[e]||(this.collections_[e]=new pl),this.collections_[e]},yl.getOrCreateReporter=function(e,t){return e=e.toString(),this.reporters_[e]||(this.reporters_[e]=t()),this.reporters_[e]},yl.collections_={},yl.reporters_={},yl);function yl(){}var ml=(vl.prototype.get=function(){var e=this.collection_.get(),n=po({},e);return this.last_&&ds(this.last_,function(e,t){n[e]=n[e]-t}),this.last_=e,n},vl);function vl(e){this.collection_=e,this.last_=null}var bl=(_l.prototype.includeStat=function(e){this.statsToReport_[e]=!0},_l.prototype.reportStats_=function(){var n=this,e=this.statsListener_.get(),r={},i=!1;ds(e,function(e,t){0<t&&Yo(n.statsToReport_,e)&&(r[e]=t,i=!0)}),i&&this.server_.reportStats(r),ms(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},_l);function _l(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ml(e),e=1e4+2e4*Math.random(),ms(this.reportStats_.bind(this),Math.floor(e))}var wl=(El.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new Tl(i)),t.add(r)}t&&this.eventLists_.push(t)},El.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},El.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},El.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1)}t&&(this.eventLists_=[]),this.recursionDepth_--},El);function El(){this.eventLists_=[],this.recursionDepth_=0}var Tl=(Il.prototype.add=function(e){this.events_.push(e)},Il.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t,n=this.events_[e];null!==n&&(this.events_[e]=null,t=n.getEventRunner(),as&&us("event: "+n.toString()),ys(t))}},Il.prototype.getPath=function(){return this.path_},Il);function Il(e){this.path_=e,this.events_=[]}function Sl(e){this.allowedEvents_=e,this.listeners_={},Io(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}Sl.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=bo(this.listeners_[e]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},Sl.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n}),(e=this.getInitialEvent(e))&&t.apply(n,e)},Sl.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},Sl.prototype.validateEventType_=function(t){Io(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)};var Cl,Al=(fo(kl,Cl=he=Sl),kl.getInstance=function(){return new kl},kl.prototype.getInitialEvent=function(e){return Io("visible"===e,"Unknown event type: "+e),[this.visible_]},kl);function kl(){var t,e,n=Cl.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,e&&document.addEventListener(e,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}var Nl,Dl=(fo(Rl,Nl=he),Rl.getInstance=function(){return new Rl},Rl.prototype.getInitialEvent=function(e){return Io("online"===e,"Unknown event type: "+e),[this.online_]},Rl.prototype.currentlyOnline=function(){return this.online_},Rl);function Rl(){var e=Nl.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Oo()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}var Ol=(Pl.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},Pl.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&ys(function(){n.onMessage_(t[e])})}(e);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}(););},Pl);function Pl(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}var xl="pLPCommand",Ll="pRTLPCB",Ml=(Fl.prototype.open=function(e,t){var n,r,i,a=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ol(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){a.log_("Timed out trying to connect."),a.onClosed_(),a.connectTimeoutTimer_=null},Math.floor(3e4)),n=function(){var e;a.isClosed_||(a.scriptTagHolder=new Ul(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=vo(e,5),r=n[0],i=n[1],o=n[2];if(n[3],n[4],a.incrementIncomingBytes_(e),a.scriptTagHolder)if(a.connectTimeoutTimer_&&(clearTimeout(a.connectTimeoutTimer_),a.connectTimeoutTimer_=null),a.everConnected_=!0,"start"===r)a.id=i,a.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(a.scriptTagHolder.sendNewPolls=!1,a.myPacketOrderer.closeAfter(i,function(){a.onClosed_()})):a.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(r=vo(e,2))[0],r=r[1];a.incrementIncomingBytes_(e),a.myPacketOrderer.handleResponse(n,r)},function(){a.onClosed_()},a.urlFn),(e={start:"t"}).ser=Math.floor(1e8*Math.random()),a.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=a.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",a.transportSessionId&&(e.s=a.transportSessionId),a.lastSessionId&&(e.ls=a.lastSessionId),a.applicationId&&(e.p=a.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Is)&&(e.r="f"),e=a.urlFn(e),a.log_("Connecting via long-poll to "+e),a.scriptTagHolder.addTag(e,function(){}))},"complete"===document.readyState?n():(r=!1,i=function(){document.body?r||(r=!0,n()):setTimeout(i,Math.floor(10))},document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&i()}),window.attachEvent("onload",i)))},Fl.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},Fl.forceAllow=function(){Fl.forceAllow_=!0},Fl.forceDisallow=function(){Fl.forceDisallow_=!0},Fl.isAvailable=function(){return!!Fl.forceAllow_||!(Fl.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},Fl.prototype.markConnectionHealthy=function(){},Fl.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},Fl.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},Fl.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},Fl.prototype.send=function(e){e=Go(e),this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var t,n=Za(e=(t=wo(t=e),Co.encodeByteArray(t,!0)),1840),r=0;r<n.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[r]),this.curSegmentNum++},Fl.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},Fl.prototype.incrementIncomingBytes_=function(e){e=Go(e).length,this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},Fl);function Fl(e,t,n,r,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=cs(e),this.stats_=gl.getCollection(t),this.urlFn=function(e){return t.connectionURL(Cs,e)}}var Ul=(ql.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||us("No IE domain setting required")}catch(e){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},ql.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},ql.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},ql.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++,(e={}).id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var e=this.urlFn(e),t="",n=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+t.length<=1870;){var r=this.pendingSegs.shift(),t=t+"&seg"+n+"="+r.seg+"&ts"+n+"="+r.ts+"&d"+n+"="+r.d;n++}return e+=t,this.addLongPollTag_(e,this.currentSerial),!0}return!1},ql.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},ql.prototype.addLongPollTag_=function(e,t){var n=this;function r(){n.outstandingRequests.delete(t),n.newRequest_()}this.outstandingRequests.add(t);var i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},ql.prototype.addTag=function(e,n){var r=this;setTimeout(function(){try{if(!r.sendNewPolls)return;var t=r.myIFrame.doc.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){var e=t.readyState;e&&"loaded"!==e&&"complete"!==e||(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),n())},t.onerror=function(){us("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(t)}catch(e){}},Math.floor(1))},ql);function ql(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=is(),window[xl+this.uniqueCallbackIdentifier]=e,window[Ll+this.uniqueCallbackIdentifier]=t,this.myIFrame=ql.createIFrame_(),t="",this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(t='<script>document.domain="'+document.domain+'";<\/script>');var i="<html><body>"+t+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){us("frame writing exception"),e.stack&&us(e.stack),us(e)}}var jl="";function Vl(e){jl=e}var Bl=null;"undefined"!=typeof MozWebSocket?Bl=MozWebSocket:"undefined"!=typeof WebSocket&&(Bl=WebSocket);var Kl=(Wl.connectionURL_=function(e,t,n){var r={v:"5"};return"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Is)&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),e.connectionURL(Ss,r)},Wl.prototype.open=function(e,t){var n,r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ts.set("previous_websocket_failure",!0);try{Lo()||(n={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new Bl(this.connURL,[],n))}catch(t){return this.log_("Error instantiating WebSocket."),(e=t.message||t.data)&&this.log_(e),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection."),(e=e.message||e.data)&&r.log_(e),r.onClosed_()}},Wl.prototype.start=function(){},Wl.forceDisallow=function(){Wl.forceDisallow_=!0},Wl.isAvailable=function(){var e,t=!1;return"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/))&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0),!t&&null!==Bl&&!Wl.forceDisallow_},Wl.previouslyFailed=function(){return ts.isInMemoryStorage||!0===ts.get("previous_websocket_failure")},Wl.prototype.markConnectionHealthy=function(){ts.remove("previous_websocket_failure")},Wl.prototype.appendFrame_=function(e){this.frames.push(e),this.frames.length===this.totalFrames&&(e=this.frames.join(""),this.frames=null,e=Ho(e),this.onMessage(e))},Wl.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},Wl.prototype.extractFrameCount_=function(e){if(Io(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},Wl.prototype.handleIncomingFrame=function(e){null!==this.mySock&&(e=e.data,this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null===this.frames&&null===(e=this.extractFrameCount_(e))||this.appendFrame_(e))},Wl.prototype.send=function(e){this.resetKeepAlive(),e=Go(e),this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var t=Za(e,16384);1<t.length&&this.sendString_(String(t.length));for(var n=0;n<t.length;n++)this.sendString_(t[n])},Wl.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},Wl.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},Wl.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},Wl.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},Wl.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},Wl.responsesRequiredToBeHealthy=2,Wl.healthyTimeout=3e4,Wl);function Wl(e,t,n,r,i){this.connId=e,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=cs(this.connId),this.stats_=gl.getCollection(t),this.connURL=Wl.connectionURL_(t,r,i),this.nodeAdmin=t.nodeAdmin}var zl=(Object.defineProperty(Hl,"ALL_TRANSPORTS",{get:function(){return[Ml,Kl]},enumerable:!1,configurable:!0}),Hl.prototype.initTransports_=function(e){var t,n,r=Kl&&Kl.isAvailable(),i=r&&!Kl.previouslyFailed();if(e.webSocketOnly&&(r||Ya("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Kl];else{var o=this.transports_=[];try{for(var a=mo(Hl.ALL_TRANSPORTS),s=a.next();!s.done;s=a.next()){var u=s.value;u&&u.isAvailable()&&o.push(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}},Hl.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},Hl.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},Hl);function Hl(e){this.initTransports_(e)}var Gl=(Ql.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0)),0<(t=t.healthyTimeout||0)&&(this.healthyTimeout_=ms(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&102400<e.conn_.bytesReceived?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&10240<e.conn_.bytesSent?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(t)))},Ql.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},Ql.prototype.disconnReceiver_=function(t){var n=this;return function(e){t===n.conn_?n.onConnectionLost_(e):t===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},Ql.prototype.connReceiver_=function(t){var n=this;return function(e){2!==n.state_&&(t===n.rx_?n.onPrimaryMessageReceived_(e):t===n.secondaryConn_?n.onSecondaryMessageReceived_(e):n.log_("message on old connection"))}},Ql.prototype.sendRequest=function(e){e={t:"d",d:e},this.sendData_(e)},Ql.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},Ql.prototype.onSecondaryControl_=function(e){"t"in e&&("a"===(e=e.t)?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_()))},Ql.prototype.onSecondaryMessageReceived_=function(e){var t=$a("t",e),e=$a("d",e);if("c"===t)this.onSecondaryControl_(e);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(e)}},Ql.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},Ql.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},Ql.prototype.onPrimaryMessageReceived_=function(e){var t=$a("t",e),e=$a("d",e);"c"===t?this.onControl_(e):"d"===t&&this.onDataMessage_(e)},Ql.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},Ql.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},Ql.prototype.onControl_=function(e){var t=$a("t",e);if("d"in e)if(e=e.d,"h"===t)this.onHandshake_(e);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(e):"r"===t?this.onReset_(e):"e"===t?Ga("Server Error: "+e):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ga("Unknown control packet command: "+t)},Ql.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Ya("Protocol version mismatch detected"),this.tryStartUpgrade_())},Ql.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},Ql.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),e=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,e),ms(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},Ql.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},Ql.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ms(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},Ql.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},Ql.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},Ql.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ts.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},Ql.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},Ql.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},Ql.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},Ql.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},Ql);function Ql(e,t,n,r,i,o,a,s){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=cs("c:"+this.id+":"),this.transportManager_=new zl(t),this.log_("Connection created"),this.start_()}function Yl(){}Yl.prototype.put=function(e,t,n,r){},Yl.prototype.merge=function(e,t,n,r){},Yl.prototype.refreshAuthToken=function(e){},Yl.prototype.onDisconnectPut=function(e,t,n){},Yl.prototype.onDisconnectMerge=function(e,t,n){},Yl.prototype.onDisconnectCancel=function(e,t){},Yl.prototype.reportStats=function(e){};var Xl,Jl=1e3,$l=3e5,Zl=(fo(eh,Xl=iu=Yl),eh.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,t={r:r,a:e,b:t};this.log_(Go(t)),Io(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(t),n&&(this.requestCBHash_[r]=n)},eh.prototype.get=function(e){var n=this,r=new No,i={p:e.path.toString(),q:e.queryObject()},t={action:"g",request:i,onComplete:function(e){var t=e.d;"ok"===e.s?(n.onDataUpdate_(i.p,t,!1,null),r.resolve(t)):r.reject(t)}};this.outstandingGets_.push(t),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=n.outstandingGets_[o];void 0!==e&&t===e&&(delete n.outstandingGets_[o],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),n.log_("get "+o+" timed out on connection"),r.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),r.promise},eh.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Io(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Io(!this.listens.get(o).has(i),"listen() called twice for same path/queryId."),n={onComplete:r,hashFn:t,query:e,tag:n},this.listens.get(o).set(i,n),this.connected_&&this.sendListen_(n)},eh.prototype.sendGet_=function(t){var n=this,r=this.outstandingGets_[t];this.sendRequest("g",r.request,function(e){delete n.outstandingGets_[t],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),r.onComplete&&r.onComplete(e)})},eh.prototype.sendListen_=function(r){var i=this,o=r.query,a=o.path.toString(),s=o.queryIdentifier();this.log_("Listen on "+a+" for "+s);var e={p:a};r.tag&&(e.q=o.queryObject(),e.t=r.tag),e.h=r.hashFn(),this.sendRequest("q",e,function(e){var t=e.d,n=e.s;eh.warnOnListenWarnings_(t,o),(i.listens.get(a)&&i.listens.get(a).get(s))===r&&(i.log_("listen response",e),"ok"!==n&&i.removeListen_(a,s),r.onComplete&&r.onComplete(n,t))})},eh.warnOnListenWarnings_=function(e,t){e&&"object"==typeof e&&Yo(e,"w")&&(e=Xo(e,"w"),Array.isArray(e)&&~e.indexOf("no_index")&&Ya("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+(e='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"')+" at "+(t=t.path.toString())+" to your security rules for better performance."))},eh.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},eh.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||"object"==typeof(e=Qo(e=e).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},eh.prototype.tryAuth=function(){var n,e,t,r=this;this.connected_&&this.authToken_&&(e=(t=Qo(t=n=this.authToken_).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",t={cred:n},null===this.authOverride_?t.noauth=!0:"object"==typeof this.authOverride_&&(t.authvar=this.authOverride_),this.sendRequest(e,t,function(e){var t=e.s,e=e.d||"error";r.authToken_===n&&("ok"===t?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(t,e))}))},eh.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Io(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},eh.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t),e={p:e},r&&(e.q=n,e.t=r),this.sendRequest("n",e)},eh.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},eh.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},eh.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},eh.prototype.sendOnDisconnect_=function(e,t,n,r){n={p:t,d:n},this.log_("onDisconnect "+e,n),this.sendRequest(e,n,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},eh.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},eh.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},eh.prototype.putInternal=function(e,t,n,r,i){n={p:t,d:n},void 0!==i&&(n.h=i),this.outstandingPuts_.push({action:e,request:n,onComplete:r}),this.outstandingPutCount_++,r=this.outstandingPuts_.length-1,this.connected_?this.sendPut_(r):this.log_("Buffering put: "+t)},eh.prototype.sendPut_=function(t){var n=this,r=this.outstandingPuts_[t].action,e=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,e,function(e){n.log_(r+" response",e),delete n.outstandingPuts_[t],n.outstandingPutCount_--,0===n.outstandingPutCount_&&(n.outstandingPuts_=[]),i&&i(e.s,e.d)})},eh.prototype.reportStats=function(e){var t=this;this.connected_&&(e={c:e},this.log_("reportStats",e),this.sendRequest("s",e,function(e){"ok"!==e.s&&(e=e.d,t.log_("reportStats","Error sending stats: "+e))}))},eh.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Go(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},eh.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Ga("Unrecognized action received from server: "+Go(e)+"\nAre you using the latest client?")},eh.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},eh.prototype.scheduleConnect_=function(e){var t=this;Io(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},eh.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Jl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},eh.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Jl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},eh.prototype.onRealtimeDisconnect_=function(){var e;this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()&&(this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=Jl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime()),e=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-e),e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)),this.onConnectStatus_(!1)},eh.prototype.establishConnection_=function(){var t,n,r,i,o,a,s,u,c,e,l=this;this.shouldReconnect_()&&(this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+eh.nextConnectionId_++,a=(o=this).lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},this.realtime_={close:c,sendRequest:function(e){Io(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)}},e=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(e).then(function(e){s?us("getToken() completed but was canceled"):(us("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new Gl(i,o.repoInfo_,o.applicationId_,t,n,r,function(e){Ya(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.log_("Failed to get token: "+e),s||(l.repoInfo_.nodeAdmin&&Ya(e),c())}))},eh.prototype.interrupt=function(e){us("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},eh.prototype.resume=function(e){us("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Jo(this.interruptReasons_)&&(this.reconnectDelay_=Jl,this.realtime_||this.scheduleConnect_(0))},eh.prototype.handleTimestamp_=function(e){e-=(new Date).getTime(),this.onServerInfoUpdate_({serverTimeOffset:e})},eh.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},eh.prototype.onListenRevoked_=function(e,t){t=t?t.map(function(e){return ps(e)}).join("$"):"default",(t=this.removeListen_(e,t))&&t.onComplete&&t.onComplete("permission_denied")},eh.prototype.removeListen_=function(e,t){var n,r=new _s(e).toString();return this.listens.has(r)?(n=(e=this.listens.get(r)).get(t),e.delete(t),0===e.size&&this.listens.delete(r)):n=void 0,n},eh.prototype.onAuthRevoked_=function(e,t){us("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},eh.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},eh.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=mo(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,mo(a.values())),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},eh.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+jl.replace(/\./g,"-")]=1,Oo()?e["framework.cordova"]=1:xo()&&(e["framework.reactnative"]=1),this.reportStats(e)},eh.prototype.shouldReconnect_=function(){var e=Dl.getInstance().currentlyOnline();return Jo(this.interruptReasons_)&&e},eh.nextPersistentConnectionId_=0,eh.nextConnectionId_=0,eh);function eh(e,t,n,r,i,o,a){var s=Xl.call(this)||this;if(s.repoInfo_=e,s.applicationId_=t,s.onDataUpdate_=n,s.onConnectStatus_=r,s.onServerInfoUpdate_=i,s.authTokenProvider_=o,s.authOverride_=a,s.id=eh.nextPersistentConnectionId_++,s.log_=cs("p:"+s.id+":"),s.interruptReasons_={},s.listens=new Map,s.outstandingPuts_=[],s.outstandingGets_=[],s.outstandingPutCount_=0,s.outstandingGetCount_=0,s.onDisconnectRequestQueue_=[],s.connected_=!1,s.reconnectDelay_=Jl,s.maxReconnectDelay_=$l,s.securityDebugCallback_=null,s.lastSessionId=null,s.establishConnectionTimer_=null,s.visible_=!1,s.requestCBHash_={},s.requestNumber_=0,s.realtime_=null,s.authToken_=null,s.forceTokenRefresh_=!1,s.invalidAuthTokenCount_=0,s.firstConnection_=!0,s.lastConnectionAttemptTime_=null,s.lastConnectionEstablishedTime_=null,a&&!Lo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return s.scheduleConnect_(0),Al.getInstance().on("visible",s.onVisible_,s),-1===e.host.indexOf("fblocal")&&Dl.getInstance().on("online",s.onOnline_,s),s}var th,nh=(fo(rh,th=iu),rh.prototype.reportStats=function(e){throw new Error("Method not implemented.")},rh.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Io(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},rh.prototype.listen=function(e,t,n,r){var i=this,o=e.path.toString();this.log_("Listen called for "+o+" "+e.queryIdentifier());var a=rh.getListenId_(e,n),s={};this.listens_[a]=s,e=e.getQueryParams().toRestQueryStringParameters(),this.restRequest_(o+".json",e,function(e,t){404===e&&(e=t=null),null===e&&i.onDataUpdate_(o,t,!1,n),Xo(i.listens_,a)===s&&r(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},rh.prototype.unlisten=function(e,t){t=rh.getListenId_(e,t),delete this.listens_[t]},rh.prototype.get=function(e){var n=this,t=e.getQueryParams().toRestQueryStringParameters(),r=e.path.toString(),i=new No;return this.restRequest_(r+".json",t,function(e,t){404===e&&(e=t=null),null===e?(n.onDataUpdate_(r,t,!1,null),i.resolve(t)):i.reject(new Error(t))}),i.promise},rh.prototype.refreshAuthToken=function(e){},rh.prototype.restRequest_=function(r,i,o){var a=this;void 0===i&&(i={}),i.format="export",this.authTokenProvider_.getToken(!1).then(function(e){(e=e&&e.accessToken)&&(i.auth=e);var t=(a.repoInfo_.secure?"https://":"http://")+a.repoInfo_.host+r+"?ns="+a.repoInfo_.namespace+function(){for(var n=[],e=0,t=Object.entries(i);e<t.length;e++){var r=t[e];!function(t,e){Array.isArray(e)?e.forEach(function(e){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}(r[0],r[1])}return n.length?"&"+n.join("&"):""}();a.log_("Sending REST request for "+t);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(o&&4===n.readyState){a.log_("REST Response for "+t+" received. status:",n.status,"response:",n.responseText);var e=null;if(200<=n.status&&n.status<300){try{e=Ho(n.responseText)}catch(e){Ya("Failed to parse JSON response for "+t+": "+n.responseText)}o(null,e)}else 401!==n.status&&404!==n.status&&Ya("Got unsuccessful REST response for "+t+" Status: "+n.status),o(n.status);o=null}},n.open("GET",t,!0),n.send()})},rh);function rh(e,t,n){var r=th.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=t,r.authTokenProvider_=n,r.log_=cs("p:rest:"),r.listens_={},r}var ih="repo_interrupt",oh=(ah.prototype.start=function(){var a=this;if(this.stats_=gl.getCollection(this.repoInfo_),this.forceRestClient_||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.server_=new nh(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Go(e)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new Zl(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener(function(e){a.server_.refreshAuthToken(e)}),this.statsReporter_=gl.getOrCreateReporter(this.repoInfo_,function(){return new bl(a.stats_,a.server_)}),this.transactionsInit_(),this.infoData_=new hl,this.infoSyncTree_=new cl({startListening:function(e,t,n,r){var i=[],o=a.infoData_.getNode(e.path);return o.isEmpty()||(i=a.infoSyncTree_.applyServerOverwrite(e.path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new cl({startListening:function(n,e,t,r){return a.server_.listen(n,t,e,function(e,t){t=r(e,t),a.eventQueue_.raiseEventsForChangedPath(n.path,t)}),[]},stopListening:function(e,t){a.server_.unlisten(e,t)}})},ah.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},ah.prototype.name=function(){return this.repoInfo_.namespace},ah.prototype.serverTime=function(){var e=this.infoData_.getNode(new _s(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},ah.prototype.generateServerValues=function(){return(e=e={timestamp:this.serverTime()}).timestamp=e.timestamp||(new Date).getTime(),e;var e},ah.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new _s(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o,a,e=i;0<(a=r?n?(o=$o(t,function(e){return Ku(e)}),this.serverSyncTree_.applyTaggedQueryMerge(i,o,r)):(o=Ku(t),this.serverSyncTree_.applyTaggedQueryOverwrite(i,o,r)):n?(n=$o(t,function(e){return Ku(e)}),this.serverSyncTree_.applyServerMerge(i,n)):(t=Ku(t),this.serverSyncTree_.applyServerOverwrite(i,t))).length&&(e=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(e,a)},ah.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},ah.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},ah.prototype.onServerInfoUpdate_=function(e){var n=this;ds(e,function(e,t){n.updateInfo_(e,t)})},ah.prototype.updateInfo_=function(e,t){e=new _s("/.info/"+e),t=Ku(t),this.infoData_.updateSnapshot(e,t),t=this.infoSyncTree_.applyServerOverwrite(e,t),this.eventQueue_.raiseEventsForChangedPath(e,t)},ah.prototype.getNextWriteId_=function(){return this.nextWriteId_++},ah.prototype.getValue=function(n){var r=this;return this.server_.get(n).then(function(e){var t=Ku(e),e=r.serverSyncTree_.applyServerOverwrite(n.path,t);return r.eventQueue_.raiseEventsAtPath(n.path,e),Promise.resolve(new Yu(t,n.getRef(),n.getQueryParams().getIndex()))},function(e){r.log_("get for query "+Go(n)+" falling back to cache after error: "+e);var t=r.serverSyncTree_.calcCompleteEventCache(n.path);return t.isEmpty()?Promise.reject(new Error(e)):Promise.resolve(new Yu(t,n.getRef(),n.getQueryParams().getIndex()))})},ah.prototype.setWithPriority=function(r,e,t,i){var o=this;this.log_("set",{path:r.toString(),value:e,priority:t});var n=this.generateServerValues(),n=fc(e=Ku(e,t),t=this.serverSyncTree_.calcCompleteEventCache(r),n),a=this.getNextWriteId_(),n=this.serverSyncTree_.applyUserOverwrite(r,n,a,!0);this.eventQueue_.queueEvents(n),this.server_.put(r.toString(),e.val(!0),function(e,t){var n="ok"===e;n||Ya("set at "+r+" failed: "+e),n=o.serverSyncTree_.ackUserWrite(a,!n),o.eventQueue_.raiseEventsForChangedPath(r,n),o.callOnCompleteCallback(i,e,t)}),e=this.abortTransactions_(r),this.rerunTransactions_(e),this.eventQueue_.raiseEventsForChangedPath(e,[])},ah.prototype.update=function(i,e,o){var a=this;this.log_("update",{path:i.toString(),value:e});var s,t,n=!0,r=this.generateServerValues(),u={};ds(e,function(e,t){n=!1,u[e]=hc(i.child(e),Ku(t),a.serverSyncTree_,r)}),n?(us("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(o,"ok")):(s=this.getNextWriteId_(),t=this.serverSyncTree_.applyUserMerge(i,u,s),this.eventQueue_.queueEvents(t),this.server_.merge(i.toString(),e,function(e,t){(r="ok"===e)||Ya("update at "+i+" failed: "+e);var n=a.serverSyncTree_.ackUserWrite(s,!r),r=0<n.length?a.rerunTransactions_(i):i;a.eventQueue_.raiseEventsForChangedPath(r,n),a.callOnCompleteCallback(o,e,t)}),ds(e,function(e){e=a.abortTransactions_(i.child(e)),a.rerunTransactions_(e)}),this.eventQueue_.raiseEventsForChangedPath(i,[]))},ah.prototype.runOnDisconnectEvents_=function(){var n=this;this.log_("onDisconnectEvents");var r=this.generateServerValues(),i=new vc;this.onDisconnect_.forEachTree(_s.Empty,function(e,t){t=hc(e,t,n.serverSyncTree_,r),i.remember(e,t)});var o=[];i.forEachTree(_s.Empty,function(e,t){o=o.concat(n.serverSyncTree_.applyServerOverwrite(e,t)),e=n.abortTransactions_(e),n.rerunTransactions_(e)}),this.onDisconnect_=new vc,this.eventQueue_.raiseEventsForChangedPath(_s.Empty,o)},ah.prototype.onDisconnectCancel=function(n,r){var i=this;this.server_.onDisconnectCancel(n.toString(),function(e,t){"ok"===e&&i.onDisconnect_.forget(n),i.callOnCompleteCallback(r,e,t)})},ah.prototype.onDisconnectSet=function(n,e,r){var i=this,o=Ku(e);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},ah.prototype.onDisconnectSetWithPriority=function(n,e,t,r){var i=this,o=Ku(e,t);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},ah.prototype.onDisconnectUpdate=function(n,r,i){var o=this;if(Jo(r))return us("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.server_.onDisconnectMerge(n.toString(),r,function(e,t){"ok"===e&&ds(r,function(e,t){t=Ku(t),o.onDisconnect_.remember(n.child(e),t)}),o.callOnCompleteCallback(i,e,t)})},ah.prototype.addEventCallbackForQuery=function(e,t){t=(".info"===e.path.getFront()?this.infoSyncTree_:this.serverSyncTree_).addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,t)},ah.prototype.removeEventCallbackForQuery=function(e,t){t=(".info"===e.path.getFront()?this.infoSyncTree_:this.serverSyncTree_).removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,t)},ah.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(ih)},ah.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(ih)},ah.prototype.stats=function(e){var i;void 0===e&&(e=!1),"undefined"!=typeof console&&(e=e?(this.statsListener_||(this.statsListener_=new ml(this.stats_)),this.statsListener_.get()):this.stats_.get(),i=Object.keys(e).reduce(function(e,t){return Math.max(t.length,e)},0),ds(e,function(e,t){for(var n=e,r=e.length;r<i+2;r++)n+=" ";console.log(n+t)}))},ah.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},ah.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),us.apply(void 0,bo([n],e))},ah.prototype.callOnCompleteCallback=function(n,r,i){n&&ys(function(){var e,t;"ok"===r?n(null):(t=e=(r||"error").toUpperCase(),i&&(t+=": "+i),(t=new Error(t)).code=e,n(t))})},Object.defineProperty(ah.prototype,"database",{get:function(){return this.__database||(this.__database=new Ah(this))},enumerable:!1,configurable:!0}),ah);function ah(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new wl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new vc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}var sh=(uh.prototype.getStartPost=function(){return this.startPost_},uh.prototype.getEndPost=function(){return this.endPost_},uh.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},uh.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new Zs(t,n))||(n=Fu.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},uh.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Fu.EMPTY_NODE);var r=(r=t.withIndex(this.index_)).updatePriority(Fu.EMPTY_NODE),i=this;return t.forEachChild(mu,function(e,t){i.matches(new Zs(e,t))||(r=r.updateImmediateChild(e,Fu.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},uh.prototype.updatePriority=function(e,t){return e},uh.prototype.filtersNodes=function(){return!0},uh.prototype.getIndexedFilter=function(){return this.indexedFilter_},uh.prototype.getIndex=function(){return this.index_},uh.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},uh.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},uh);function uh(e){this.indexedFilter_=new qc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=uh.getStartPost_(e),this.endPost_=uh.getEndPost_(e)}var ch=(lh.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Zs(t,n))||(n=Fu.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},lh.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Fu.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Fu.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Fu.EMPTY_NODE);for(var s,u=void 0,c=void 0,l=void 0,i=void 0,l=this.reverse_?(i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost(),s=this.index_.getCompare(),function(e,t){return s(t,e)}):(i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),this.index_.getCompare()),o=0,h=!1;i.hasNext();)a=i.getNext(),!h&&l(u,a)<=0&&(h=!0),h&&o<this.limit_&&l(a,c)<=0?o++:r=r.updateImmediateChild(a.name,Fu.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},lh.prototype.updatePriority=function(e,t){return e},lh.prototype.filtersNodes=function(){return!0},lh.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},lh.prototype.getIndex=function(){return this.index_},lh.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o,a=this.reverse_?(o=this.index_.getCompare(),function(e,t){return o(t,e)}):this.index_.getCompare(),s=e;Io(s.numChildren()===this.limit_,"");var u=new Zs(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:a(f,u);return l&&!n.isEmpty()&&0<=p?(null!=i&&i.trackChildChange(Fc.childChangedChange(t,n,h)),s.updateImmediateChild(t,n)):(null!=i&&i.trackChildChange(Fc.childRemovedChange(t,h)),h=s.updateImmediateChild(t,Fu.EMPTY_NODE),null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Fc.childAddedChange(f.name,f.node)),h.updateImmediateChild(f.name,f.node)):h)}return!n.isEmpty()&&l&&0<=a(c,u)?(null!=i&&(i.trackChildChange(Fc.childRemovedChange(c.name,c.node)),i.trackChildChange(Fc.childAddedChange(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,Fu.EMPTY_NODE)):e},lh);function lh(e){this.rangedFilter_=new sh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}var hh=(fh.prototype.hasStart=function(){return this.startSet_},fh.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===fh.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},fh.prototype.getIndexStartValue=function(){return Io(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},fh.prototype.getIndexStartName=function(){return Io(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ls},fh.prototype.hasEnd=function(){return this.endSet_},fh.prototype.getIndexEndValue=function(){return Io(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},fh.prototype.getIndexEndName=function(){return Io(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:hs},fh.prototype.hasLimit=function(){return this.limitSet_},fh.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},fh.prototype.getLimit=function(){return Io(this.limitSet_,"Only valid if limit has been set"),this.limit_},fh.prototype.getIndex=function(){return this.index_},fh.prototype.copy_=function(){var e=new fh;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},fh.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},fh.prototype.limitToFirst=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=fh.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,t},fh.prototype.limitToLast=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=fh.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,t},fh.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},fh.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},fh.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},fh.prototype.getQueryObject=function(){var e,t=fh.WIRE_PROTOCOL_CONSTANTS_,n={};return this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_&&(n[t.LIMIT]=this.limit_,""===(e=this.viewFrom_)&&(e=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=e),this.index_!==mu&&(n[t.INDEX]=this.index_.toString()),n},fh.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},fh.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===mu},fh.prototype.getNodeFilter=function(){return this.loadsAllData()?new qc(this.getIndex()):new(this.hasLimit()?ch:sh)(this)},fh.prototype.toRestQueryStringParameters=function(){var e,t=fh.REST_QUERY_CONSTANTS_,n={};return this.isDefault()||(e=this.index_===mu?t.PRIORITY_INDEX:this.index_===Hu?t.VALUE_INDEX:this.index_===su?t.KEY_INDEX:(Io(this.index_ instanceof Gu,"Unrecognized index type!"),this.index_.toString()),n[t.ORDER_BY]=Go(e),this.startSet_&&(n[t.START_AT]=Go(this.indexStartValue_),this.startNameSet_&&(n[t.START_AT]+=","+Go(this.indexStartName_))),this.endSet_&&(n[t.END_AT]=Go(this.indexEndValue_),this.endNameSet_&&(n[t.END_AT]+=","+Go(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_)),n},fh.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},fh.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},fh.DEFAULT=new fh,fh);function fh(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=mu}var ph,dh=(fo(gh,ph=uo),gh.prototype.getKey=function(){return oa("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},gh.prototype.child=function(e){var t;return oa("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof _s||(null===this.path.getFront()?(0,Us("Reference.child",1,t=(t=e)&&t.replace(/^\/*\.info(\/|$)/,"/"),!1)):Us("Reference.child",1,e,!1)),new gh(this.repo,this.path.child(e))},gh.prototype.getParent=function(){oa("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new gh(this.repo,e)},gh.prototype.getRoot=function(){oa("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},gh.prototype.databaseProp=function(){return this.repo.database},gh.prototype.set=function(e,t){oa("Reference.set",1,2,arguments.length),qs("Reference.set",this.path),Ps("Reference.set",1,e,this.path,!1),sa("Reference.set",2,t,!0);var n=new No;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},gh.prototype.update=function(e,t){if(oa("Reference.update",1,2,arguments.length),qs("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Ya("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}xs("Reference.update",1,e,this.path,!1),sa("Reference.update",2,t,!0);var i=new No;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},gh.prototype.setWithPriority=function(e,t,n){if(oa("Reference.setWithPriority",2,3,arguments.length),qs("Reference.setWithPriority",this.path),Ps("Reference.setWithPriority",1,e,this.path,!1),Ls("Reference.setWithPriority",2,t,!1),sa("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new No;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},gh.prototype.remove=function(e){return oa("Reference.remove",0,1,arguments.length),qs("Reference.remove",this.path),sa("Reference.remove",1,e,!0),this.set(null,e)},gh.prototype.transaction=function(e,r,t){if(oa("Reference.transaction",1,3,arguments.length),qs("Reference.transaction",this.path),sa("Reference.transaction",1,e,!1),sa("Reference.transaction",2,r,!0),function(){if(void 0!==t&&"boolean"!=typeof t)throw new Error(aa("Reference.transaction",3,!0)+"must be a boolean.")}(),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===t&&(t=!0);var i=new No;return"function"==typeof r&&i.promise.catch(function(){}),this.repo.startTransaction(this.path,e,function(e,t,n){e?i.reject(e):i.resolve(new Gs(t,n)),"function"==typeof r&&r(e,t,n)},t),i.promise},gh.prototype.setPriority=function(e,t){oa("Reference.setPriority",1,2,arguments.length),qs("Reference.setPriority",this.path),Ls("Reference.setPriority",1,e,!1),sa("Reference.setPriority",2,t,!0);var n=new No;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},gh.prototype.push=function(e,t){oa("Reference.push",0,2,arguments.length),qs("Reference.push",this.path),Ps("Reference.push",1,e,this.path,!0),sa("Reference.push",2,t,!0);var n=this.repo.serverTime(),r=$s(n),n=this.child(r),i=this.child(r),e=null!=e?n.set(e,t).then(function(){return i}):Promise.resolve(i);return n.then=e.then.bind(e),n.catch=e.then.bind(e,void 0),"function"==typeof t&&e.catch(function(){}),n},gh.prototype.onDisconnect=function(){return qs("Reference.onDisconnect",this.path),new zs(this.repo,this.path)},Object.defineProperty(gh.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),gh);function gh(e,t){if(!(e instanceof oh))throw new Error("new Reference() no longer supported - use app.database().");return ph.call(this,e,t,hh.DEFAULT,!1)||this}uo.__referenceConstructor=dh,tl.__referenceConstructor=dh;function yh(){this.children={},this.childCount=0,this.value=null}var mh,vh=(bh.prototype.subTree=function(e){for(var t=e instanceof _s?e:new _s(e),n=this,r=t.getFront();null!==r;)n=new bh(r,n,Xo(n.node_.children,r)||new yh),r=(t=t.popFront()).getFront();return n},bh.prototype.getValue=function(){return this.node_.value},bh.prototype.setValue=function(e){Io(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},bh.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},bh.prototype.hasChildren=function(){return 0<this.node_.childCount},bh.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},bh.prototype.forEachChild=function(n){var r=this;ds(this.node_.children,function(e,t){n(new bh(e,r,t))})},bh.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},bh.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},bh.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},bh.prototype.path=function(){return new _s(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},bh.prototype.name=function(){return this.name_},bh.prototype.parent=function(){return this.parent_},bh.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},bh.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=Yo(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},bh);function bh(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new yh),this.name_=e,this.parent_=t,this.node_=n}(fe=mh={})[fe.RUN=0]="RUN",fe[fe.SENT=1]="SENT",fe[fe.COMPLETED=2]="COMPLETED",fe[fe.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",fe[fe.NEEDS_ABORT=4]="NEEDS_ABORT",oh.MAX_TRANSACTION_RETRIES_=25,oh.prototype.transactionsInit_=function(){this.transactionQueueTree_=new vh},oh.prototype.startTransaction=function(e,t,n,r){function i(){}this.log_("transaction on "+e);var o=new dh(this,e);o.on("value",i);var a,s={path:e,update:t,onComplete:n,status:null,order:is(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},t=this.getLatestState_(e);s.currentInputSnapshot=t,void 0===(n=s.update(t.val()))?(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&(a=new Yu(s.currentInputSnapshot,new dh(this,s.path),mu),s.onComplete(null,!1,a))):(Ws("transaction failed: Data returned ",n,s.path),s.status=mh.RUN,(a=(r=this.transactionQueueTree_.subTree(e)).getValue()||[]).push(s),r.setValue(a),r=void 0,"object"==typeof n&&null!==n&&Yo(n,".priority")?(r=Xo(n,".priority"),Io(Os(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):r=(this.serverSyncTree_.calcCompleteEventCache(e)||Fu.EMPTY_NODE).getPriority().val(),a=this.generateServerValues(),a=fc(r=Ku(n,r),t,a),s.currentOutputSnapshotRaw=r,s.currentOutputSnapshotResolved=a,s.currentWriteId=this.getNextWriteId_(),s=this.serverSyncTree_.applyUserOverwrite(e,a,s.currentWriteId,s.applyLocally),this.eventQueue_.raiseEventsForChangedPath(e,s),this.sendReadyTransactions_())},oh.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||Fu.EMPTY_NODE},oh.prototype.sendReadyTransactions_=function(e){var t,n=this;void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()?(t=this.buildTransactionQueue_(e),Io(0<t.length,"Sending zero length transaction queue"),t.every(function(e){return e.status===mh.RUN})&&this.sendTransactionQueue_(e.path(),t)):e.hasChildren()&&e.forEachChild(function(e){n.sendReadyTransactions_(e)})},oh.prototype.sendTransactionQueue_=function(a,s){for(var u=this,e=s.map(function(e){return e.currentWriteId}),t=o=this.getLatestState_(a,e),e=o.hash(),n=0;n<s.length;n++){var r=s[n];Io(r.status===mh.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=mh.SENT,r.retryCount++;var i=_s.relativePath(a,r.path),t=t.updateChild(i,r.currentOutputSnapshotRaw)}var o=t.val(!0),c=a;this.server_.put(c.toString(),o,function(e){u.log_("transaction put response",{path:c.toString(),status:e});var t=[];if("ok"===e){for(var n,r,i=[],o=0;o<s.length;o++)s[o].status=mh.COMPLETED,t=t.concat(u.serverSyncTree_.ackUserWrite(s[o].currentWriteId)),s[o].onComplete&&(n=s[o].currentOutputSnapshotResolved,r=new dh(u,s[o].path),r=new Yu(n,r,mu),i.push(s[o].onComplete.bind(null,null,!0,r))),s[o].unwatcher();for(u.pruneCompletedTransactionsBelowNode_(u.transactionQueueTree_.subTree(a)),u.sendReadyTransactions_(),u.eventQueue_.raiseEventsForChangedPath(a,t),o=0;o<i.length;o++)ys(i[o])}else{if("datastale"===e)for(o=0;o<s.length;o++)s[o].status===mh.SENT_NEEDS_ABORT?s[o].status=mh.NEEDS_ABORT:s[o].status=mh.RUN;else for(Ya("transaction at "+c.toString()+" failed: "+e),o=0;o<s.length;o++)s[o].status=mh.NEEDS_ABORT,s[o].abortReason=e;u.rerunTransactions_(a)}},e)},oh.prototype.rerunTransactions_=function(e){var e=(t=this.getAncestorTransactionNode_(e)).path(),t=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(t,e),e},oh.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],r=[],i=e.filter(function(e){return e.status===mh.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var a,s,u,c=e[o],l=_s.relativePath(t,c.path),h=!1,f=void 0;Io(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===mh.NEEDS_ABORT?(h=!0,f=c.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))):c.status===mh.RUN&&(r=c.retryCount>=oh.MAX_TRANSACTION_RETRIES_?(h=!0,f="maxretry",r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))):(a=this.getLatestState_(c.path,i),c.currentInputSnapshot=a,void 0!==(u=e[o].update(a.val()))?(Ws("transaction failed: Data returned ",u,c.path),s=Ku(u),"object"==typeof u&&null!=u&&Yo(u,".priority")||(s=s.updatePriority(a.getPriority())),l=c.currentWriteId,u=fc(s,a,u=this.generateServerValues()),c.currentOutputSnapshotRaw=s,c.currentOutputSnapshotResolved=u,c.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(l),1),(r=r.concat(this.serverSyncTree_.applyUserOverwrite(c.path,u,c.currentWriteId,c.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(l,!0))):(h=!0,f="nodata",r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))))),this.eventQueue_.raiseEventsForChangedPath(t,r),r=[],h&&(e[o].status=mh.COMPLETED,c=e[o].unwatcher,setTimeout(c,Math.floor(0)),e[o].onComplete&&("nodata"===f?(h=new dh(this,e[o].path),c=e[o].currentInputSnapshot,h=new Yu(c,h,mu),n.push(e[o].onComplete.bind(null,null,!1,h))):n.push(e[o].onComplete.bind(null,new Error(f),!1,null))))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),o=0;o<n.length;o++)ys(n[o]);this.sendReadyTransactions_()}},oh.prototype.getAncestorTransactionNode_=function(e){for(var t=this.transactionQueueTree_,n=e.getFront();null!==n&&null===t.getValue();)t=t.subTree(n),n=(e=e.popFront()).getFront();return t},oh.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},oh.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},oh.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==mh.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(0<n.length?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},oh.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path();return(e=this.transactionQueueTree_.subTree(e)).forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(e),e.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},oh.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++)t[o].status===mh.SENT_NEEDS_ABORT||(t[o].status===mh.SENT?(Io(i===o-1,"All SENT items should be at beginning of queue."),t[i=o].status=mh.SENT_NEEDS_ABORT,t[o].abortReason="set"):(Io(t[o].status===mh.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r),o=0;o<n.length;o++)ys(n[o])}};var _h=(wh.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(us("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):Promise.resolve(null)},wh.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout(function(){return t(null)},0),this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)}))},wh.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},wh.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ya(e)},wh);function wh(e,t){var n=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then(function(e){return n.auth_=e})}var Eh=(Th.prototype.getToken=function(e){return Promise.resolve({accessToken:Th.EMULATOR_AUTH_TOKEN})},Th.prototype.addTokenChangeListener=function(e){e(Th.EMULATOR_AUTH_TOKEN)},Th.prototype.removeTokenChangeListener=function(e){},Th.prototype.notifyForInvalidToken=function(){},Th.EMULATOR_AUTH_TOKEN="owner",Th);function Th(){}var Ih,Sh=(Ch.getInstance=function(){return Ih=Ih||new Ch},Ch.prototype.interrupt=function(){var e,t,n,r;try{for(var i=mo(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,mo(Object.keys(this.repos_[a]))),u=s.next();!u.done;u=s.next()){var c=u.value;this.repos_[a][c].interrupt()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Ch.prototype.resume=function(){var e,t,n,r;try{for(var i=mo(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,mo(Object.keys(this.repos_[a]))),u=s.next();!u.done;u=s.next()){var c=u.value;this.repos_[a][c].resume()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Ch.prototype.applyEmulatorSettings=function(e,t,n){e.repoInfo_=new As(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),e.repoInfo_.nodeAdmin&&(e.authTokenProvider_=new Eh)},Ch.prototype.databaseFromApp=function(e,t,n,r){var i=n||e.options.databaseURL;void 0===i&&(e.options.projectId||Qa("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),us("Using default host for project ",e.options.projectId),i=e.options.projectId+"-default-rtdb.firebaseio.com");var o,a=Ns(i,r),s=a.repoInfo,n=void 0;return"undefined"!=typeof process&&(n=process.env.FIREBASE_DATABASE_EMULATOR_HOST),n?(o=!0,s=(a=Ns(i="http://"+n+"?ns="+s.namespace,r)).repoInfo):o=!a.repoInfo.secure,t=r&&o?new Eh:new _h(e,t),js("Invalid Firebase Database URL",1,a),a.path.isEmpty()||Qa("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(s,e,t).database},Ch.prototype.deleteRepo=function(e){var t=Xo(this.repos_,e.app.name);t&&Xo(t,e.key)===e||Qa("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.key]},Ch.prototype.createRepo=function(e,t,n){var r=Xo(this.repos_,t.name);r||(r={},this.repos_[t.name]=r);var i=Xo(r,e.toURLString());return i&&Qa("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new oh(e,this.useRestClient_,t,n),r[e.toURLString()]=i},Ch.prototype.forceRestClient=function(e){this.useRestClient_=e},Ch);function Ch(){this.repos_={},this.useRestClient_=!1}var Ah=(Object.defineProperty(kh.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(kh.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new dh(this.repo_,_s.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(kh.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),kh.prototype.useEmulator=function(e,t){this.checkDeleted_("useEmulator"),this.instanceStarted_?Qa("Cannot call useEmulator() after instance has already been initialized."):Sh.getInstance().applyEmulatorSettings(this.repoInternal_,e,t)},kh.prototype.ref=function(e){return this.checkDeleted_("ref"),oa("database.ref",0,1,arguments.length),e instanceof dh?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},kh.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),oa(t,1,1,arguments.length);var n=Ns(e,this.repo_.repoInfo_.nodeAdmin);return js(t,1,n),(e=n.repoInfo).isCustomHost()||e.host===this.repo_.repoInfo_.host||Qa(t+": Host name does not match the current database: (found "+e.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},kh.prototype.checkDeleted_=function(e){null===this.repoInternal_&&Qa("Cannot call "+e+" on a deleted database.")},kh.prototype.goOffline=function(){oa("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},kh.prototype.goOnline=function(){oa("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},kh.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},kh);function kh(e){var t=this;this.repoInternal_=e,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return go(t,void 0,void 0,function(){return yo(this,function(e){return this.checkDeleted_("delete"),Sh.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]})})}},e instanceof oh||Qa("Don't call new Database() directly - please use firebase.database().")}F=Object.freeze({__proto__:null,forceLongPolling:function(){Kl.forceDisallow(),Ml.forceAllow()},forceWebSockets:function(){Ml.forceDisallow()},isWebSocketsAvailable:function(){return Kl.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace,e=void 0!==(e=e.nodeAdmin)&&e;return Vl(r),(r=new va("auth-internal",new _a("database-standalone"))).setComponent(new ga("auth-internal",function(){return i},"PRIVATE")),{instance:Sh.getInstance().databaseFromApp(t,r,n,e),namespace:o}}}),Hn=Zl;Zl.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Zl.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};oo=Object.freeze({__proto__:null,DataConnection:Hn,RealTimeConnection:Gl,hijackHash:function(i){var o=Zl.prototype.put;return Zl.prototype.put=function(e,t,n,r){void 0!==r&&(r=i()),o.call(this,e,t,n,r)},function(){Zl.prototype.put=o}},ConnectionTarget:As,queryIdentifier:function(e){return e.queryIdentifier()},forceRestClient:function(e){Sh.getInstance().forceRestClient(e)}}),ve=Ah.ServerValue;Vl((ye=jh).SDK_VERSION),ye.INTERNAL.registerComponent(new ga("database",function(e,t){var n=e.getProvider("app").getImmediate(),e=e.getProvider("auth-internal");return Sh.getInstance().databaseFromApp(n,e,t)},"PUBLIC").setServiceProps({Reference:dh,Query:uo,Database:Ah,DataSnapshot:Yu,enableLogging:Ha,INTERNAL:F,ServerValue:ve,TEST_ACCESS:oo}).setMultipleInstances(!0)),ye.registerVersion("@firebase/database","0.8.1-1.0.0-eap-firestore-debug.9c6096f43");var Nh=function(e,t){return(Nh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Dh(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var he="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Rh=he||self;function Oh(){}function Ph(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function xh(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Lh="closure_uid_"+(1e9*Math.random()>>>0),Mh=0;function Fh(e,t,n){return e.call.apply(e.bind,arguments)}function Uh(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function qh(e,t,n){return(qh=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Fh:Uh).apply(null,arguments)}function Vh(t){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Bh(){return Date.now()}function Kh(e,o){function t(){}t.prototype=o.prototype,e.X=o.prototype,e.prototype=new t,(e.prototype.constructor=e).Kb=function(e,t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[t].apply(e,r)}}function Wh(){this.j=this.j,this.i=this.i}Wh.prototype.j=!1,Wh.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,Lh)&&this[Lh]||(this[Lh]=++Mh))},Wh.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var zh=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Hh=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function Gh(){return Array.prototype.concat.apply([],arguments)}function Qh(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Yh(e){return/^[\s\xa0]*$/.test(e)}var Xh=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Jh(e,t){return-1!=e.indexOf(t)}function $h(e,t){return e<t?-1:t<e?1:0}F=Rh.navigator;function Zh(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ef(e){var t,n={};for(t in e)n[t]=e[t];return n}lf=(F=F&&F.userAgent)?F:"";var tf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nf(e){for(var t,n,r=1;r<arguments.length;r++){for(t in n=arguments[r])e[t]=n[t];for(var i=0;i<tf.length;i++)t=tf[i],Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}}function rf(e){return rf[" "](e),e}rf[" "]=Oh;var of,ve=Jh(lf,"Opera"),af=Jh(lf,"Trident")||Jh(lf,"MSIE"),oo=Jh(lf,"Edge"),sf=oo||af,uf=Jh(lf,"Gecko")&&!(Jh(lf.toLowerCase(),"webkit")&&!Jh(lf,"Edge"))&&!(Jh(lf,"Trident")||Jh(lf,"MSIE"))&&!Jh(lf,"Edge"),ye=Jh(lf.toLowerCase(),"webkit")&&!Jh(lf,"Edge");function cf(){var e=Rh.document;return e?e.documentMode:void 0}var F="",lf=(lf=lf,uf?/rv:([^\);]+)(\)|;)/.exec(lf):oo?/Edge\/([\d\.]+)/.exec(lf):af?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lf):ye?/WebKit\/(\S+)/.exec(lf):ve?/(?:Version)[ \/]?(\S+)/.exec(lf):void 0);lf&&(F=lf?lf[1]:""),of=af&&null!=(lf=cf())&&lf>parseFloat(F)?String(lf):F;var hf={};function ff(s){return e=s,t=function(){for(var e=0,t=Xh(String(of)).split("."),n=Xh(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++)for(var o=t[i]||"",a=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],(0!=o[0].length||0!=a[0].length)&&(e=$h(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||$h(0==o[2].length,0==a[2].length)||$h(o[2],a[2]),o=o[3],a=a[3],0==e););return 0<=e},n=hf,Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t();var e,t,n}var pf=Rh.document&&af&&(cf()||parseInt(of,10))||void 0,df=!af||9<=Number(pf),gf=af&&!ff("9"),yf=function(){if(!Rh.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Rh.addEventListener("test",Oh,t),Rh.removeEventListener("test",Oh,t)}catch(e){}return e}();function mf(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function vf(e,t){if(mf.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(uf){e:{try{rf(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:bf[e.pointerType]||"",(this.c=e).defaultPrevented&&this.b()}}mf.prototype.b=function(){this.defaultPrevented=!0},Kh(vf,mf);var bf={2:"touch",3:"pen",4:"mouse"};vf.prototype.b=function(){vf.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,gf)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}};var _f="closure_listenable_"+(1e6*Math.random()|0),wf=0;function Ef(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++wf,this.Y=this.Z=!1}function Tf(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function If(e){this.src=e,this.a={},this.b=0}function Sf(e,t){var n,r,i,o=t.type;o in e.a&&(n=e.a[o],(i=0<=(r=zh(n,t)))&&Array.prototype.splice.call(n,r,1),i&&(Tf(t),0==e.a[o].length&&(delete e.a[o],e.b--)))}function Cf(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.ca==r)return i}return-1}If.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Cf(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new Ef(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var Af="closure_lm_"+(1e6*Math.random()|0),kf={};function Nf(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}return r=Ff(r),t&&t[_f]?t.wa(n,r,xh(i)?!!i.capture:!!i,o):Df(t,n,r,!0,i,o)}(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)Nf(e,t[o],n,r,i);return null}return n=Ff(n),e&&e[_f]?e.va(t,n,xh(r)?!!r.capture:!!r,i):Df(e,t,n,!1,r,i)}function Df(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=xh(i)?!!i.capture:!!i;if(a&&!df)return null;var s,u,c=Lf(e);if(c||(e[Af]=c=new If(e)),(n=c.add(t,n,r,a,o)).proxy)return n;if(s=xf,r=u=df?function(e){return s.call(u.src,u.listener,e)}:function(e){if(!(e=s.call(u.src,u.listener,e)))return e},(n.proxy=r).src=e,r.listener=n,e.addEventListener)yf||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Of(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Rf(e){var t,n,r;"number"!=typeof e&&e&&!e.Y&&((t=e.src)&&t[_f]?Sf(t.c,e):(n=e.type,r=e.proxy,t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Of(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Lf(t))?(Sf(n,e),0==n.b&&(n.src=null,t[Af]=null)):Tf(e)))}function Of(e){return e in kf?kf[e]:kf[e]="on"+e}function Pf(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&Rf(e),n.call(r,t)}function xf(e,t){if(e.Y)return!0;if(df)return Pf(e,new vf(t,this));if(!t)e:{t=["window","event"];for(var n=Rh,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return Pf(e,t=new vf(t,this))}function Lf(e){return(e=e[Af])instanceof If?e:null}var Mf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ff(t){return"function"==typeof t?t:(t[Mf]||(t[Mf]=function(e){return t.handleEvent(e)}),t[Mf])}function Uf(){Wh.call(this),this.c=new If(this),(this.J=this).C=null}function qf(e,t){var n,r=e.C;if(r)for(n=[];r;r=r.C)n.push(r);if(e=e.J,r=t.type||t,"string"==typeof t?t=new mf(t,e):t instanceof mf?t.target=t.target||e:(a=t,nf(t=new mf(r,e),a)),a=!0,n)for(var i=n.length-1;0<=i;i--)var o=t.a=n[i],a=jf(o,r,!0,t)&&a;if(a=jf(o=t.a=e,r,!0,t)&&a,a=jf(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=jf(o=t.a=n[i],r,!1,t)&&a}function jf(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a,s,u=t[o];u&&!u.Y&&u.capture==n&&(a=u.listener,s=u.ca||u.src,u.Z&&Sf(e.c,u),i=!1!==a.call(s,r)&&i)}return i&&!r.defaultPrevented}Kh(Uf,Wh),Uf.prototype[_f]=!0,(iu=Uf.prototype).addEventListener=function(e,t,n,r){Nf(this,e,t,n,r)},iu.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=xh(i)?!!i.capture:!!i,r=Ff(r),t&&t[_f]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=Cf(a=t.a[n],r,i,o))&&(Tf(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):(t=t&&Lf(t))&&(n=t.a[n.toString()],t=-1,n&&(t=Cf(n,r,i,o)),(r=-1<t?n[t]:null)&&Rf(r))}(this,e,t,n,r)},iu.G=function(){if(Uf.X.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Tf(n[r]);delete t.a[e],t.b--}}this.C=null},iu.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},iu.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Vf=Rh.JSON.stringify;function Bf(){this.b=this.a=null}var Kf,Wf=(zf.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},new zf(function(){return new Hf},function(e){e.reset()}));function zf(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function Hf(){this.next=this.b=this.a=null}function Gf(e,t){var n;Kf||(n=Rh.Promise.resolve(void 0),Kf=function(){n.then(Xf)}),Qf||(Kf(),Qf=!0),Yf.add(e,t)}Bf.prototype.add=function(e,t){var n=Wf.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Hf.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null};var Qf=!(Hf.prototype.reset=function(){this.next=this.b=this.a=null}),Yf=new Bf;function Xf(){for(var e,t;n=t=void 0,n=null,(t=Yf).a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),e=n;){try{e.a.call(e.b)}catch(e){!function(e){Rh.setTimeout(function(){throw e},0)}(e)}var n=Wf;n.f(e),n.b<100&&(n.b++,e.next=n.a,n.a=e)}Qf=!1}function Jf(e,t){Uf.call(this),this.b=e||1,this.a=t||Rh,this.f=qh(this.Za,this),this.g=Bh()}function $f(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function Zf(e,t,n){if("function"==typeof e)n&&(e=qh(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=qh(e.handleEvent,e)}return 2147483647<Number(t)?-1:Rh.setTimeout(e,t||0)}Kh(Jf,Uf),(iu=Jf.prototype).aa=!1,iu.M=null,iu.Za=function(){var e;this.aa&&(0<(e=Bh()-this.g)&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qf(this,"tick"),this.aa&&($f(this),this.start())))},iu.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Bh())},iu.G=function(){Jf.X.G.call(this),$f(this),delete this.a};var ep,tp,np=(Nh(tp=ip,F=ep=Wh),tp.prototype=null===F?Object.create(F):(rp.prototype=F.prototype,new rp),ip.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:function e(t){t.a=Zf(function(){t.a=null,t.c&&(t.c=!1,e(t))},t.h);var n=t.b;t.b=null,t.g.apply(null,n)}(this)},ip.prototype.G=function(){ep.prototype.G.call(this),this.a&&(Rh.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ip);function rp(){this.constructor=tp}function ip(e,t){var n=ep.call(this)||this;return n.g=e,n.h=t,n.b=null,n.c=!1,n.a=null,n}function op(e){Wh.call(this),this.b=e,this.a={}}Kh(op,Wh);var ap=[];function sp(e,t,n,r){Array.isArray(n)||(n&&(ap[0]=n.toString()),n=ap);for(var i=0;i<n.length;i++){var o=Nf(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function up(e){Zh(e.a,function(e,t){this.a.hasOwnProperty(t)&&Rf(e)},e),e.a={}}function cp(){this.a=!0}function lp(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Vf(n)}catch(e){return t}}(e,n)+(r?" "+r:"")})}op.prototype.G=function(){op.X.G.call(this),up(this)},op.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},cp.prototype.info=function(){};var hp={},fp=null;function pp(){return fp=fp||new Uf}function dp(e){mf.call(this,hp.Fa,e)}function gp(){var e=pp();qf(e,new dp(e))}function yp(e,t){mf.call(this,hp.STAT_EVENT,e),this.stat=t}function mp(e){var t=pp();qf(t,new yp(t,e))}function vp(e){mf.call(this,hp.Ga,e)}function bp(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Rh.setTimeout(function(){e()},t)}function _p(){}function wp(e){var t;return(t=e.a)||(t=e.a={}),t}function Ep(){}hp.Fa="serverreachability",Kh(dp,mf),hp.STAT_EVENT="statevent",Kh(yp,mf),hp.Ga="timingevent",Kh(vp,mf),fe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Hn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"},_p.prototype.a=null;var Tp,he={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ip(){mf.call(this,"d")}function Sp(){mf.call(this,"c")}function Cp(){}function Ap(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new op(this),this.P=kp,e=sf?125:void 0,this.R=new Jf(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Kh(Ip,mf),Kh(Sp,mf),Kh(Cp,_p),Tp=new Cp;var kp=45e3,Np={},Dp={};function Rp(e,t,n){e.H=1,e.i=$p(Hp(t)),e.j=n,e.I=!0,Op(e,null)}function Op(e,t){e.u=Bh(),xp(e),e.l=Hp(e.i);var a,s,u,c,l,h,n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),hd(n.b,"t",r),e.D=0,e.a=ig(e.g,e.g.C?t:null),0<e.O&&(e.F=new np(qh(e.Ca,e,e.a),e.O)),sp(e.J,e.a,"readystatechange",e.Xa),t=e.B?ef(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),gp(),a=e.c,s=e.m,u=e.l,c=e.f,l=e.S,h=e.j,a.info(function(){if(a.a)if(h)for(var e="",t=h.split("&"),n=0;n<t.length;n++){var r,i,o=t[n].split("=");1<o.length&&(r=o[0],o=o[1],e=2<=(i=r.split("_")).length&&"type"==i[1]?e+(r+"=")+o+"&":e+(r+"=redacted&"))}else e=null;else e=h;return"XMLHTTP REQ ("+c+") [attempt "+l+"]: "+s+"\n"+u+"\n"+e})}function Pp(e,t,n){for(var r,i,o,a=!0;!e.A&&e.D<n.length;){var s=(s=n,o=void 0,i=(r=e).D,-1==(o=s.indexOf("\n",i))?Dp:(i=Number(s.substring(i,o)),isNaN(i)?Np:(o+=1)+i>s.length?Dp:(s=s.substr(o,i),r.D=o+i,s)));if(s==Dp){4==t&&(e.h=4,mp(14),a=!1),lp(e.c,e.f,null,"[Incomplete Response]");break}if(s==Np){e.h=4,mp(15),lp(e.c,e.f,n,"[Invalid Chunk]"),a=!1;break}lp(e.c,e.f,s,null),qp(e,s)}4==t&&0==n.length&&(e.h=1,mp(16),a=!1),e.b=e.b&&a,a?0<n.length&&!e.V&&(e.V=!0,(t=e.g).a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xd(t),t.F=!0,mp(11))):(lp(e.c,e.f,n,"[Invalid Chunked Response]"),Up(e),Fp(e))}function xp(e){e.T=Bh()+e.P,Lp(e,e.P)}function Lp(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=bp(qh(e.Va,e),t)}function Mp(e){e.o&&(Rh.clearTimeout(e.o),e.o=null)}function Fp(e){0==e.g.v||e.A||Zd(e.g,e)}function Up(e){Mp(e);var t=e.F;t&&"function"==typeof t.ja&&t.ja(),e.F=null,$f(e.R),up(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function qp(e,t){try{var n,r,i,o,a,s=e.g;if(0!=s.v&&(s.a==e||vd(s.b,e)))if(s.I=e.N,!e.C&&vd(s.b,e)&&3==s.v){try{var u=s.ka.a.parse(t)}catch(e){u=null}if(Array.isArray(u)&&3==u.length){var c=u;if(0==c[0]){e:if(!s.j){if(s.a){if(!(s.a.u+3e3<e.u))break e;$d(s),Vd(s)}Yd(s),mp(18)}}else s.oa=c[1],0<s.oa-s.P&&c[2]<37500&&s.H&&0==s.o&&!s.m&&(s.m=bp(qh(s.Sa,s),6e3));if(md(s.b)<=1&&s.ea){try{s.ea()}catch(e){}s.ea=void 0}}else tg(s,11)}else if(!e.C&&s.a!=e||$d(s),!Yh(t))for(t=u=s.ka.a.parse(t),u=0;u<t.length;u++)c=t[u],s.P=c[0],c=c[1],2==s.v?"c"==c[0]?(s.J=c[1],s.ga=c[2],null!=(r=c[3])&&(s.ha=r,s.c.info("VER="+s.ha)),null!=(o=c[4])&&(s.pa=o,s.c.info("SVER="+s.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,s.D=n,s.c.info("backChannelRequestTimeoutMs_="+n)),n=s,(o=e.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Jh(r,"spdy")||Jh(r,"quic")||Jh(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(bd(i,i.b),i.b=null)),!n.A||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=a,Jp(n.B,n.A,a))),s.v=3,s.f&&s.f.ta(),s.U&&(s.N=Bh()-e.u,s.c.info("Handshake RTT: "+s.N+"ms")),i=e,(n=s).la=rg(n,n.C?n.ga:null,n.fa),i.C?(_d(n.b,i),o=i,(a=n.D)&&o.setTimeout(a),o.o&&(Mp(o),xp(o)),n.a=i):Qd(n),0<s.g.length&&Wd(s)):"stop"!=c[0]&&"close"!=c[0]||tg(s,7):3==s.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?tg(s,7):jd(s):"noop"!=c[0]&&s.f&&s.f.sa(c),s.o=0);gp()}catch(e){}}function jp(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Ph(e)||"string"==typeof e)Hh(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(Ph(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"==typeof e)return e.split("");if(Ph(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function Vp(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Vp)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Bp(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Kp(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){for(var i={},n=t=0;t<e.a.length;)Kp(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function Kp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(iu=Ap.prototype).setTimeout=function(e){this.P=e},iu.Xa=function(e){e=e.target;var t=this.F;t&&3==Md(e)?t.f():this.Ca(e)},iu.Ca=function(e){try{if(e==this.a)e:{var t=Md(this.a),n=this.a.ua(),r=this.a.W();if(!(t<3||3==t&&!sf&&!this.a.$())){this.A||4!=t||7==n||gp(),Mp(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,s=this.m,u=this.l,c=this.f,l=this.S,h=t,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+l+"]: "+s+"\n"+u+"\n"+h+" "+f}),this.b){if(this.U&&!this.C){t:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Yh(o)){var a=o;break t}}a=null}if(!a){this.b=!1,this.h=3,mp(12),Up(this),Fp(this);break e}lp(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qp(this,a)}this.I?(Pp(this,t,n),sf&&this.b&&3==t&&(sp(this.J,this.R,"tick",this.Wa),this.R.start())):(lp(this.c,this.f,n,null),qp(this,n)),4==t&&Up(this),this.b&&!this.A&&(4==t?Zd(this.g,this):(this.b=!1,xp(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,mp(12)):(this.h=0,mp(13)),Up(this),Fp(this)}}}catch(e){}var s,u,c,l,h,f},iu.Wa=function(){var e,t;this.a&&(e=Md(this.a),t=this.a.$(),this.D<t.length&&(Mp(this),Pp(this,e,t),this.b&&4!=e&&xp(this)))},iu.cancel=function(){this.A=!0,Up(this)},iu.Va=function(){this.o=null;var e,t,n=Bh();0<=n-this.T?(e=this.c,t=this.l,e.info(function(){return"TIMEOUT: "+t}),2!=this.H&&(gp(),mp(17)),Up(this),this.h=2,Fp(this)):Lp(this,this.T-n)},(iu=Vp.prototype).K=function(){Bp(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},iu.L=function(){return Bp(this),this.a.concat()},iu.get=function(e,t){return Kp(this.b,e)?this.b[e]:t},iu.set=function(e,t){Kp(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},iu.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Wp=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function zp(e,t){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof zp?(this.a=void 0!==t?t:e.a,Gp(this,e.f),this.j=e.j,Qp(this,e.c),Yp(this,e.h),this.g=e.g,t=e.b,(n=new sd).c=t.c,t.a&&(n.a=new Vp(t.a),n.b=t.b),Xp(this,n),this.i=e.i):e&&(n=String(e).match(Wp))?(this.a=!!t,Gp(this,n[1]||"",!0),this.j=Zp(n[2]||""),Qp(this,n[3]||"",!0),Yp(this,n[4]),this.g=Zp(n[5]||"",!0),Xp(this,n[6]||"",!0),this.i=Zp(n[7]||"")):(this.a=!!t,this.b=new sd(null,this.a))}function Hp(e){return new zp(e)}function Gp(e,t,n){e.f=n?Zp(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Qp(e,t,n){e.c=n?Zp(t,!0):t}function Yp(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.h=t}else e.h=null}function Xp(e,t,n){var r,i;t instanceof sd?(e.b=t,r=e.b,(i=e.a)&&!r.f&&(ud(r),r.c=null,r.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(cd(this,t),hd(this,n,e))},r)),r.f=i):(n||(t=ed(t,od)),e.b=new sd(t,e.a))}function Jp(e,t,n){e.b.set(t,n)}function $p(e){return Jp(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Bh()).toString(36)),e}function Zp(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ed(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,td),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function td(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}zp.prototype.toString=function(){var e=[],t=this.f;t&&e.push(ed(t,nd,!0),":");var n=this.c;return!n&&"file"!=t||(e.push("//"),(t=this.j)&&e.push(ed(t,nd,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(ed(n,"/"==n.charAt(0)?id:rd,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",ed(n,ad)),e.join("")};var nd=/[#\/\?@]/g,rd=/[#\?:]/g,id=/[#\?]/g,od=/[#\?@]/g,ad=/#/g;function sd(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function ud(o){o.a||(o.a=new Vp,o.b=0,o.c&&function(e){if(e){e=e.split("&");for(var t=0;t<e.length;t++){var n,r=e[t].indexOf("="),i=null;0<=r?(n=e[t].substring(0,r),i=e[t].substring(r+1)):n=e[t],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cd(e,t){ud(e),t=fd(e,t),Kp(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Kp((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Bp(e)))}function ld(e,t){return ud(e),t=fd(e,t),Kp(e.a.b,t)}function hd(e,t,n){cd(e,t),0<n.length&&(e.c=null,e.a.set(fd(e,t),Qh(n)),e.b+=n.length)}function fd(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(iu=sd.prototype).add=function(e,t){ud(this),this.c=null,e=fd(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},iu.forEach=function(n,r){ud(this),this.a.forEach(function(e,t){Hh(e,function(e){n.call(r,e,t,this)},this)},this)},iu.L=function(){ud(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},iu.K=function(e){ud(this);var t=[];if("string"==typeof e)ld(this,e)&&(t=Gh(t,this.a.get(fd(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=Gh(t,e[n])}return t},iu.set=function(e,t){return ud(this),this.c=null,ld(this,e=fd(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},iu.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},iu.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}return this.c=e.join("&")};function pd(e,t){this.b=e,this.a=t}function dd(e){this.g=e||gd,e=Rh.PerformanceNavigationTiming?0<(e=Rh.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Rh.ia&&Rh.ia.ya&&Rh.ia.ya()&&Rh.ia.ya().Lb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var gd=10;function yd(e){return e.b||e.a&&e.a.size>=e.f}function md(e){return e.b?1:e.a?e.a.size:0}function vd(e,t){return e.b?e.b==t:e.a&&e.a.has(t)}function bd(e,t){e.a?e.a.add(t):e.b=t}function _d(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function wd(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null==e.a||0===e.a.size)return Qh(e.c);var r=e.c;try{for(var i=Dh(e.a.values()),o=i.next();!o.done;o=i.next())var a=o.value,r=r.concat(a.s)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Ed(){}function Td(){this.a=new Ed}function Id(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}dd.prototype.cancel=function(){var e,t;if(this.c=wd(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Dh(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Ed.prototype.stringify=function(e){return Rh.JSON.stringify(e,void 0)},Ed.prototype.parse=function(e){return Rh.JSON.parse(e,void 0)};var Sd=Rh.JSON.parse;function Cd(e){Uf.call(this),this.headers=new Vp,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ad,this.D=this.F=!1}Kh(Cd,Uf);var Ad="",kd=/^https?$/i,Nd=["POST","PUT"];function Dd(e){return"content-type"==e.toLowerCase()}function Rd(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Od(e),xd(e)}function Od(e){e.u||(e.u=!0,qf(e,"complete"),qf(e,"error"))}function Pd(e){if(e.b&&(!e.s[1]||4!=Md(e)||2!=e.W()))if(e.l&&4==Md(e))Zf(e.za,0,e);else if(qf(e,"readystatechange"),4==Md(e)){e.b=!1;try{var t,n,r,i,o=e.W();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}if((t=a)||((n=0===o)&&(!(i=String(e.B).match(Wp)[1]||null)&&Rh.self&&Rh.self.location&&(i=(r=Rh.self.location.protocol).substr(0,r.length-1)),n=!kd.test(i?i.toLowerCase():"")),t=n),t)qf(e,"complete"),qf(e,"success");else{e.h=6;try{var s=2<Md(e)?e.a.statusText:""}catch(o){s=""}e.f=s+" ["+e.W()+"]",Od(e)}}finally{xd(e)}}}function xd(e,t){if(e.a){Ld(e);var n=e.a,r=e.s[0]?Oh:null;e.a=null,e.s=null,t||qf(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Ld(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(Rh.clearTimeout(e.m),e.m=null)}function Md(e){return e.a?e.a.readyState:0}function Fd(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}var i;r||(i="",Zh(n,function(e,t){i+=t,i+=":",i+=e,i+="\r\n"}),n=i,"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Jp(e,t,n))}function Ud(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function qd(e){this.pa=0,this.g=[],this.c=new cp,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ud("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ud("baseRetryDelayMs",5e3,e),this.Ra=Ud("retryDelaySeedMs",1e4,e),this.Ma=Ud("forwardChannelMaxRetries",2,e),this.ma=Ud("forwardChannelRequestTimeoutMs",2e4,e),this.Na=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new dd(e&&e.concurrentRequestLimit),this.ka=new Td,this.da=e&&e.fastHandshake||!1,this.Ia=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&e&&e.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function jd(e){var t,n;Bd(e),3==e.v&&(t=e.R++,Jp(n=Hp(e.B),"SID",e.J),Jp(n,"RID",t),Jp(n,"TYPE","terminate"),Hd(e,n),(t=new Ap(e,e.c,t,void 0)).H=2,t.i=$p(Hp(n)),n=!1,Rh.navigator&&Rh.navigator.sendBeacon&&(n=Rh.navigator.sendBeacon(t.i.toString(),"")),!n&&Rh.Image&&((new Image).src=t.i,n=!0),n||(t.a=ig(t.g,null),t.a.ba(t.i)),t.u=Bh(),xp(t)),ng(e)}function Vd(e){e.a&&(Xd(e),e.a.cancel(),e.a=null)}function Bd(e){Vd(e),e.j&&(Rh.clearTimeout(e.j),e.j=null),$d(e),e.b.cancel(),e.h&&("number"==typeof e.h&&Rh.clearTimeout(e.h),e.h=null)}function Kd(e,t){e.g.push(new pd(e.Oa++,t)),3==e.v&&Wd(e)}function Wd(e){yd(e.b)||e.h||(e.h=!0,Gf(e.Ba,e),e.u=0)}function zd(e,t){var n=t?t.f:e.R++,r=Hp(e.B);Jp(r,"SID",e.J),Jp(r,"RID",n),Jp(r,"AID",e.P),Hd(e,r),e.i&&e.l&&Fd(r,e.i,e.l),n=new Ap(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=Gd(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),bd(e.b,n),Rp(n,r,t)}function Hd(e,n){e.f&&jp({},function(e,t){Jp(n,t,e)})}function Gd(e,t,n){n=Math.min(e.g.length,n);var r=e.f?qh(e.f.Ja,e.f,e):null;e:for(var i=e.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{!function(e,r){var i="req"+c+"_"||"";try{jp(e,function(e,t){var n=e;xh(e)&&(n=Vf(e)),r.push(i+t+"="+encodeURIComponent(n))})}catch(e){throw r.push(i+"type="+encodeURIComponent("_badmap")),e}}(l,a)}catch(e){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function Qd(e){e.a||e.j||(e.T=1,Gf(e.Aa,e),e.o=0)}function Yd(e){return!(e.a||e.j||3<=e.o)&&(e.T++,e.j=bp(qh(e.Aa,e),eg(e,e.o)),e.o++,1)}function Xd(e){null!=e.s&&(Rh.clearTimeout(e.s),e.s=null)}function Jd(e){e.a=new Ap(e,e.c,"rpc",e.T),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=Hp(e.la);Jp(t,"RID","rpc"),Jp(t,"SID",e.J),Jp(t,"CI",e.H?"0":"1"),Jp(t,"AID",e.P),Hd(e,t),Jp(t,"TYPE","xmlhttp"),e.i&&e.l&&Fd(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=$p(Hp(t)),n.j=null,n.I=!0,Op(n,e)}function $d(e){null!=e.m&&(Rh.clearTimeout(e.m),e.m=null)}function Zd(e,t){var n,r,i,o=null;if(e.a==t){$d(e),Xd(e),e.a=null;var a=2}else{if(!vd(e.b,t))return;o=t.s,_d(e.b,t),a=1}if(e.I=t.N,0!=e.v)if(t.b)1==a?(o=t.j?t.j.length:0,t=Bh()-t.u,n=e.u,qf(a=pp(),new vp(a)),Wd(e)):Qd(e);else if(3==(n=t.h)||0==n&&0<e.I||(1!=a||(i=t,md((r=e).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=bp(qh(r.Ba,r,i),eg(r,r.u)),r.u++,0))))&&(2!=a||!Yd(e)))switch(o&&0<o.length&&(t=e.b,t.c=t.c.concat(o)),n){case 1:tg(e,5);break;case 4:tg(e,10);break;case 3:tg(e,6);break;default:tg(e,2)}}function eg(e,t){var n=e.Ha+Math.floor(Math.random()*e.Ra);return e.f||(n*=2),n*t}function tg(e,t){var n,r,i,o;e.c.info("Error code "+t),2==t?(r=null,e.f&&(r=null),o=qh(e.Ya,e),r||(r=new zp("//www.google.com/images/cleardot.gif"),Rh.location&&"http"==Rh.location.protocol||Gp(r,"https"),$p(r)),n=r.toString(),r=o,o=new cp,Rh.Image?((i=new Image).onload=Vh(Id,o,i,"TestLoadImage: loaded",!0,r),i.onerror=Vh(Id,o,i,"TestLoadImage: error",!1,r),i.onabort=Vh(Id,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=Vh(Id,o,i,"TestLoadImage: timeout",!1,r),Rh.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):mp(2),e.v=0,e.f&&e.f.ra(t),ng(e),Bd(e)}function ng(e){e.v=0,e.I=-1,e.f&&(0==wd(e.b).length&&0==e.g.length||(e.b.c.length=0,Qh(e.g),e.g.length=0),e.f.qa())}function rg(e,t,n){var r,i,o,a,s,u=(a=n)instanceof zp?Hp(a):new zp(a,void 0);return""!=u.c?(t&&Qp(u,t+"."+u.c),Yp(u,u.h)):(r=(s=Rh.location).protocol,i=t?t+"."+s.hostname:s.hostname,o=+s.port,a=n,s=new zp(null,void 0),r&&Gp(s,r),i&&Qp(s,i),o&&Yp(s,o),a&&(s.g=a),u=s),e.V&&Zh(e.V,function(e,t){Jp(u,t,e)}),t=e.A,n=e.na,t&&n&&Jp(u,t,n),Jp(u,"VER",e.ha),Hd(e,u),u}function ig(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Cd(e.Na)).F=e.C,t}function og(){}function ag(){if(af&&!(10<=Number(pf)))throw Error("Environmental error: no available transport.")}function sg(e,t){Uf.call(this),this.a=new qd(t),this.o=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!Yh(e)&&(this.a.i=e),this.m=t&&t.supportsCrossDomainXhr||!1,this.l=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Yh(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new lg(this)}function ug(e){Ip.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function cg(){Sp.call(this),this.status=1}function lg(e){this.a=e}(iu=Cd.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?wp(this.H):wp(Tp),this.a.onreadystatechange=qh(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(e){return void Rd(this,e)}e=n||"";var i,o=new Vp(this.headers);r&&jp(r,function(e,t){o.set(t,e)}),r=function(e){e:{for(var t=Dd,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:"string"==typeof e?e.charAt(t):e[t]}(o.L()),n=Rh.FormData&&e instanceof Rh.FormData,0<=zh(Nd,t)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ld(this),0<this.o&&((this.D=(i=this.a,af&&ff(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=qh(this.xa,this)):this.m=Zf(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(e){Rd(this,e)}},iu.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qf(this,"timeout"),this.abort(8))},iu.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,qf(this,"complete"),qf(this,"abort"),xd(this))},iu.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xd(this,!0)),Cd.X.G.call(this)},iu.za=function(){this.j||(this.A||this.l||this.g?Pd(this):this.Ua())},iu.Ua=function(){Pd(this)},iu.W=function(){try{return 2<Md(this)?this.a.status:-1}catch(e){return-1}},iu.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},iu.Pa=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Sd(t)}},iu.ua=function(){return this.h},iu.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(iu=qd.prototype).ha=8,iu.v=1,iu.Ba=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new Ap(this,this.c,e,void 0),r=this.l;if(this.O&&(r?nf(r=ef(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)e:{for(var i=t=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Gd(this,n,t),Jp(i=Hp(this.B),"RID",e),Jp(i,"CVER",22),this.A&&Jp(i,"X-HTTP-Session-Id",this.A),Hd(this,i),this.i&&r&&Fd(i,this.i,r),bd(this.b,n),this.Ia&&Jp(i,"TYPE","init"),this.da?(Jp(i,"$req",t),Jp(i,"SID","null"),n.U=!0,Rp(n,i,null)):Rp(n,i,t),this.v=2}}else 3==this.v&&(e?zd(this,e):0==this.g.length||yd(this.b)||zd(this))},iu.Aa=function(){var e;this.j=null,Jd(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(e=2*this.N,this.c.info("BP detection timer enabled: "+e),this.s=bp(qh(this.Ta,this),e))},iu.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,mp(10),Vd(this),Jd(this))},iu.Sa=function(){null!=this.m&&(this.m=null,Vd(this),Yd(this),mp(19))},iu.Ya=function(e){e?(this.c.info("Successfully pinged google.com"),mp(2)):(this.c.info("Failed to ping google.com"),mp(1))},(iu=og.prototype).ta=function(){},iu.sa=function(){},iu.ra=function(){},iu.qa=function(){},iu.Ja=function(){},ag.prototype.a=function(e,t){return new sg(e,t)},Kh(sg,Uf),sg.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var e=this.a,t=this.o,n=this.b||void 0;mp(0),e.fa=t,e.V=n||{},e.H=e.S,e.B=rg(e,null,e.fa),Wd(e)},sg.prototype.close=function(){jd(this.a)},sg.prototype.h=function(e){var t;"string"==typeof e?((t={}).__data__=e,Kd(this.a,t)):this.l?((t={}).__data__=Vf(e),Kd(this.a,t)):Kd(this.a,e)},sg.prototype.G=function(){this.a.f=null,delete this.f,jd(this.a),delete this.a,sg.X.G.call(this)},Kh(ug,Ip),Kh(cg,Sp),Kh(lg,og),lg.prototype.ta=function(){qf(this.a,"a")},lg.prototype.sa=function(e){qf(this.a,new ug(e))},lg.prototype.ra=function(e){qf(this.a,new cg)},lg.prototype.qa=function(){qf(this.a,"b")},ag.prototype.createWebChannel=ag.prototype.a,sg.prototype.send=sg.prototype.h,sg.prototype.open=sg.prototype.g,fe.NO_ERROR=0,fe.TIMEOUT=8,fe.HTTP_ERROR=6,Hn.COMPLETE="complete",(Ep.EventType=he).OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",Uf.prototype.listen=Uf.prototype.va,Cd.prototype.listenOnce=Cd.prototype.wa,Cd.prototype.getLastError=Cd.prototype.Qa,Cd.prototype.getLastErrorCode=Cd.prototype.ua,Cd.prototype.getStatus=Cd.prototype.W,Cd.prototype.getResponseJson=Cd.prototype.Pa,Cd.prototype.getResponseText=Cd.prototype.$,Cd.prototype.send=Cd.prototype.ba;var hg=pp,fg=fe,pg=Hn,dg=hp,gg=Ep,yg=Cd,mg=function(e,t,n,r,i,o){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o},vg="(default)",bg=(Object.defineProperty(_g.prototype,"isDefaultDatabase",{get:function(){return this.database===vg},enumerable:!1,configurable:!0}),_g.prototype.isEqual=function(e){return e instanceof _g&&e.projectId===this.projectId&&e.database===this.database},_g);function _g(e,t){this.projectId=e,this.database=t||vg}var wg=(Eg.prototype.isAuthenticated=function(){return null!=this.uid},Eg.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Eg.prototype.isEqual=function(e){return e.uid===this.uid},Eg);function Eg(e){this.uid=e}wg.UNAUTHENTICATED=new wg(null),wg.GOOGLE_CREDENTIALS=new wg("google-credentials-uid"),wg.FIRST_PARTY=new wg("first-party-uid");var Tg,Ig={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Sg=(fo(Cg,Tg=Error),Cg);function Cg(e,t){var n=Tg.call(this,t)||this;return n.code=e,n.message=t,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Ag="8.1.1-1.0.0-eap-firestore-debug.9c6096f43",kg=new Na("@firebase/firestore");function Ng(){return kg.logLevel}function Dg(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kg.logLevel<=Ta.DEBUG&&(t=n.map(Pg),kg.debug.apply(kg,_o(["Firestore ("+Ag+"): "+e],t)))}function Rg(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kg.logLevel<=Ta.ERROR&&(t=n.map(Pg),kg.error.apply(kg,_o(["Firestore ("+Ag+"): "+e],t)))}function Og(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kg.logLevel<=Ta.WARN&&(t=n.map(Pg),kg.warn.apply(kg,_o(["Firestore ("+Ag+"): "+e],t)))}function Pg(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function xg(e){throw void 0===e&&(e="Unexpected state"),Rg(e="FIRESTORE ("+Ag+") INTERNAL ASSERTION FAILED: "+e),new Error(e)}function Lg(e,t){e||xg(t)}function Mg(e,t){e||xg(t)}function Fg(e,t){return Mg(e instanceof t,"Expected type '"+t.name+"', but was '"+e.constructor.name+"'"),e}var Ug=(qg.newId=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;Mg(0<t&&t<256,"Expect maxMultiple to be (0, 256), but got "+t);for(var n="";n.length<20;)for(var r=function(){Mg(!0,"Expecting non-negative nBytes, got: 40");var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(40);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(var n=0;n<40;n++)t[n]=Math.floor(256*Math.random());return t}(),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return Mg(20===n.length,"Invalid auto ID: "+n),n},qg);function qg(){}function jg(e,t){return e<t?-1:t<e?1:0}function Vg(e,n,r){return e.length===n.length&&e.every(function(e,t){return r(e,n[t])})}function Bg(e){return e+"\0"}var Kg=-62135596800,Wg=(zg.now=function(){return zg.fromMillis(Date.now())},zg.fromDate=function(e){return zg.fromMillis(e.getTime())},zg.fromMillis=function(e){var t=Math.floor(e/1e3);return new zg(t,1e6*(e-1e3*t))},zg.prototype.toDate=function(){return new Date(this.toMillis())},zg.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},zg.prototype._compareTo=function(e){return this.seconds===e.seconds?jg(this.nanoseconds,e.nanoseconds):jg(this.seconds,e.seconds)},zg.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},zg.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},zg.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},zg.prototype.valueOf=function(){var e=this.seconds-Kg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},zg);function zg(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new Sg(Ig.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new Sg(Ig.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Kg)throw new Sg(Ig.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new Sg(Ig.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}function Hg(e){var t,n=0;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n++;return n}function Gg(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Qg(e){for(var t in Mg(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Yg=(Xg.fromBase64String=function(e){return new Xg(atob(e))},Xg.fromUint8Array=function(e){return new Xg(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))},Xg.prototype.toBase64=function(){return e=this.binaryString,btoa(e);var e},Xg.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},Xg.prototype.approximateByteSize=function(){return 2*this.binaryString.length},Xg.prototype.compareTo=function(e){return jg(this.binaryString,e.binaryString)},Xg.prototype.isEqual=function(e){return this.binaryString===e.binaryString},Xg);function Xg(e){this.binaryString=e}function Jg(e){return null==e}function $g(e){return 0===e&&1/e==-1/0}function Zg(e){return"number"==typeof e&&Number.isInteger(e)&&!$g(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}Yg.EMPTY_BYTE_STRING=new Yg("");var ey="__name__",he=(Object.defineProperty(ty.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),ty.prototype.isEqual=function(e){return 0===ty.comparator(this,e)},ty.prototype.child=function(e){var t=this.segments.slice(this.offset,this.limit());return e instanceof ty?e.forEach(function(e){t.push(e)}):t.push(e),this.construct(t)},ty.prototype.limit=function(){return this.offset+this.length},ty.prototype.popFirst=function(e){return e=void 0===e?1:e,Mg(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},ty.prototype.popLast=function(){return Mg(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},ty.prototype.firstSegment=function(){return Mg(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},ty.prototype.lastSegment=function(){return this.get(this.length-1)},ty.prototype.get=function(e){return Mg(e<this.length,"Index out of range"),this.segments[this.offset+e]},ty.prototype.isEmpty=function(){return 0===this.length},ty.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},ty.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},ty.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},ty.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},ty.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(o<i)return 1}return e.length<t.length?-1:e.length>t.length?1:0},ty);function ty(e,t,n){void 0===t?t=0:t>e.length&&xg("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&xg("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}var ny,ry=(fo(iy,ny=he),iy.prototype.construct=function(e,t,n){return new iy(e,t,n)},iy.prototype.canonicalString=function(){return this.toArray().join("/")},iy.prototype.toString=function(){return this.canonicalString()},iy.fromString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(e){return 0<e.length}))}return new iy(n)},iy.emptyPath=function(){return new iy([])},iy);function iy(){return null!==ny&&ny.apply(this,arguments)||this}var oy,ay=/^[_a-zA-Z][_a-zA-Z0-9]*$/,sy=(fo(uy,oy=he),uy.prototype.construct=function(e,t,n){return new uy(e,t,n)},uy.isValidIdentifier=function(e){return ay.test(e)},uy.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),uy.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},uy.prototype.toString=function(){return this.canonicalString()},uy.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===ey},uy.keyField=function(){return new uy([ey])},uy.fromServerFormat=function(e){for(var t=[],n="",r=0,i=function(){if(0===n.length)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");t.push(n),n=""},o=!1;r<e.length;){var a=e[r];if("\\"===a){if(r+1===e.length)throw new Sg(Ig.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[r+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Sg(Ig.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,r+=2}else"`"===a?o=!o:"."!==a||o?n+=a:i(),r++}if(i(),o)throw new Sg(Ig.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new uy(t)},uy.emptyPath=function(){return new uy([])},uy);function uy(){return null!==oy&&oy.apply(this,arguments)||this}var cy=(ly.fromPath=function(e){return new ly(ry.fromString(e))},ly.fromName=function(e){return new ly(ry.fromString(e).popFirst(5))},ly.prototype.hasCollectionId=function(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e},ly.prototype.isEqual=function(e){return null!==e&&0===ry.comparator(this.path,e.path)},ly.prototype.toString=function(){return this.path.toString()},ly.comparator=function(e,t){return ry.comparator(e.path,t.path)},ly.isDocumentKey=function(e){return e.length%2==0},ly.fromSegments=function(e){return new ly(new ry(e.slice()))},ly);function ly(e){this.path=e,Mg(ly.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}var hy="server_timestamp",fy="__type__",py="__previous_value__",dy="__local_write_time__";function gy(e){return(null===(e=((null===(e=null==e?void 0:e.mapValue)||void 0===e?void 0:e.fields)||{})[fy])||void 0===e?void 0:e.stringValue)===hy}function yy(e){return e=Iy(e.mapValue.fields[dy].timestampValue),new Wg(e.seconds,e.nanos)}var my=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vy(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?gy(e)?4:10:xg("Invalid value type: "+JSON.stringify(e))}function by(r,i){var e,t,n,o=vy(r);if(o!==vy(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yy(r).isEqual(yy(i));case 3:return n=i,"string"==typeof(t=r).timestampValue&&"string"==typeof n.timestampValue&&t.timestampValue.length===n.timestampValue.length?t.timestampValue===n.timestampValue:(t=Iy(t.timestampValue),n=Iy(n.timestampValue),t.seconds===n.seconds&&t.nanos===n.nanos);case 5:return r.stringValue===i.stringValue;case 6:return e=i,Cy(r.bytesValue).isEqual(Cy(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Sy((e=r).geoPointValue.latitude)===Sy(o.geoPointValue.latitude)&&Sy(e.geoPointValue.longitude)===Sy(o.geoPointValue.longitude);case 2:return e=i,"integerValue"in(o=r)&&"integerValue"in e?Sy(o.integerValue)===Sy(e.integerValue):"doubleValue"in o&&"doubleValue"in e&&((o=Sy(o.doubleValue))===(e=Sy(e.doubleValue))?$g(o)===$g(e):isNaN(o)&&isNaN(e));case 9:return Vg(r.arrayValue.values||[],i.arrayValue.values||[],by);case 10:return function(){var e,t=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Hg(t)!==Hg(n))return!1;for(e in t)if(t.hasOwnProperty(e)&&(void 0===n[e]||!by(t[e],n[e])))return!1;return!0}();default:return xg("Unexpected value type: "+JSON.stringify(r))}}function _y(e,t){return void 0!==(e.values||[]).find(function(e){return by(e,t)})}function wy(e,t){var n,r,i,o,a=vy(e),s=vy(t);if(a!==s)return jg(a,s);switch(a){case 0:return 0;case 1:return jg(e.booleanValue,t.booleanValue);case 2:return o=t,(i=Sy((i=e).integerValue||i.doubleValue))<(o=Sy(o.integerValue||o.doubleValue))?-1:o<i?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1;case 3:return Ey(e.timestampValue,t.timestampValue);case 4:return Ey(yy(e),yy(t));case 5:return jg(e.stringValue,t.stringValue);case 6:return n=e.bytesValue,r=t.bytesValue,n=Cy(n),r=Cy(r),n.compareTo(r);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=jg(n[i],r[i]);if(0!==o)return o}return jg(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return n=e.geoPointValue,r=t.geoPointValue,0===(s=jg(Sy(n.latitude),Sy(r.latitude)))?jg(Sy(n.longitude),Sy(r.longitude)):s;case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=wy(n[i],r[i]);if(o)return o}return jg(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=jg(r[a],o[a]);if(0!==s)return s;if(0!==(s=wy(n[r[a]],i[o[a]])))return s}return jg(r.length,o.length)}(e.mapValue,t.mapValue);default:throw xg("Invalid value type: "+a)}}function Ey(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return jg(e,t);var n=Iy(e),e=Iy(t);return 0!==(t=jg(n.seconds,e.seconds))?t:jg(n.nanos,e.nanos)}function Ty(e){return function s(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){return"time("+(e=Iy(e)).seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Cy(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,cy.fromName(t).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++)n?n=!1:t+=",",t+=s(i[r]);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=0,o=t;i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+s(e.fields[a])}return n+"}"}(e.mapValue):xg("Invalid value type: "+JSON.stringify(e));var t}(e)}function Iy(e){if(Lg(!!e,"Cannot normalize null or undefined timestamp."),"string"!=typeof e)return{seconds:Sy(e.seconds),nanos:t=Sy(e.nanos)};var t=0,n=my.exec(e);return Lg(!!n,"invalid timestamp: "+e),n[1]&&(n=(n[1]+"000000000").substr(0,9),t=Number(n)),e=new Date(e),{seconds:Math.floor(e.getTime()/1e3),nanos:t}}function Sy(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Cy(e){return"string"==typeof e?Yg.fromBase64String(e):Yg.fromUint8Array(e)}function Ay(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function ky(e){return!!e&&"integerValue"in e}function Ny(e){return ky(e)||!!e&&"doubleValue"in e}function Dy(e){return!!e&&"arrayValue"in e}function Ry(e){return!!e&&"referenceValue"in e}function Oy(e){return e&&"nullValue"in e}function Py(e){return e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function xy(e){return e&&"mapValue"in e}var Ly,My=(fo(Fy,Ly=fe=function(e,t){this.key=e,this.version=t}),Fy.prototype.field=function(e){return this.objectValue.field(e)},Fy.prototype.data=function(){return this.objectValue},Fy.prototype.toProto=function(){return this.objectValue.proto},Fy.prototype.isEqual=function(e){return e instanceof Fy&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.objectValue.isEqual(e.objectValue)},Fy.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.objectValue.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Fy.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Fy);function Fy(e,t,n,r){return(t=Ly.call(this,e,t)||this).objectValue=n,t.hasLocalMutations=!!r.hasLocalMutations,t.hasCommittedMutations=!!r.hasCommittedMutations,t}var Uy,qy=(fo(jy,Uy=fe),jy.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(jy.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),jy.prototype.isEqual=function(e){return e instanceof jy&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},jy);function jy(e,t,n){return(t=Uy.call(this,e,t)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),t}var Vy,By=(fo(Ky,Vy=fe),Ky.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ky.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ky.prototype.isEqual=function(e){return e instanceof Ky&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},Ky);function Ky(){return null!==Vy&&Vy.apply(this,arguments)||this}var Wy=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null};function zy(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Wy(e,t,n,r,i,o,a)}function Hy(e){var t=Fg(e,Wy);return null===t.memoizedCanonicalId&&(e=t.path.canonicalString(),null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(function(e){return Mg(e instanceof pm,"canonifyFilter() only supports FieldFilters"),e.field.canonicalString()+e.op.toString()+Ty(e.value)}).join(","),e+="|ob:",e+=t.orderBy.map(function(e){return e.field.canonicalString()+e.dir}).join(","),Jg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=Um(t.startAt)),t.endAt&&(e+="|ub:",e+=Um(t.endAt)),t.memoizedCanonicalId=e),t.memoizedCanonicalId}function Gy(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n,r,i=0;i<e.orderBy.length;i++)if(n=e.orderBy[i],r=t.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(e.filters.length!==t.filters.length)return!1;for(var o,a,i=0;i<e.filters.length;i++)if(o=e.filters[i],a=t.filters[i],Mg(o instanceof pm&&a instanceof pm,"Only FieldFilters can be compared"),o.op!==a.op||!o.field.isEqual(a.field)||!by(o.value,a.value))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!jm(e.startAt,t.startAt)&&jm(e.endAt,t.endAt)}function Qy(e){return cy.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var Yy=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&Mg(this.startAt.position.length<=im(this).length,"Bound is longer than orderBy"),this.endAt&&Mg(this.endAt.position.length<=im(this).length,"Bound is longer than orderBy")};function Xy(e,t,n,r,i,o,a,s){return new Yy(e,t,n,r,i,o,a,s)}function Jy(e){return new Yy(e)}function $y(e){return!Jg(e.limit)&&"F"===e.limitType}function Zy(e){return!Jg(e.limit)&&"L"===e.limitType}function em(e){return 0<e.explicitOrderBy.length?e.explicitOrderBy[0].field:null}function tm(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(Mg(r instanceof pm,"Only FieldFilters are supported"),r.isInequality())return r.field}return null}function nm(e){return cy.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function rm(e){return null!==e.collectionGroup}function im(e){var t=Fg(e,Yy);if(null===t.memoizedOrderBy){t.memoizedOrderBy=[];var n=tm(t),e=em(t);if(null!==n&&null===e)n.isKeyField()||t.memoizedOrderBy.push(new Vm(n)),t.memoizedOrderBy.push(new Vm(sy.keyField(),"asc"));else{Mg(null===n||null!==e&&n.isEqual(e),"First orderBy should match inequality field.");for(var r=!1,i=0,o=t.explicitOrderBy;i<o.length;i++){var a=o[i];t.memoizedOrderBy.push(a),a.field.isKeyField()&&(r=!0)}r||(e=0<t.explicitOrderBy.length?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",t.memoizedOrderBy.push(new Vm(sy.keyField(),e)))}}return t.memoizedOrderBy}function om(e){var t=Fg(e,Yy);if(!t.memoizedTarget)if("F"===t.limitType)t.memoizedTarget=zy(t.path,t.collectionGroup,im(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=im(t);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Vm(o.field,a))}var s=t.endAt?new Fm(t.endAt.position,!t.endAt.before):null,e=t.startAt?new Fm(t.startAt.position,!t.startAt.before):null;t.memoizedTarget=zy(t.path,t.collectionGroup,n,t.filters,t.limit,s,e)}return t.memoizedTarget}function am(e,t,n){return new Yy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function sm(e,t){return Gy(om(e),om(t))&&e.limitType===t.limitType}function um(e){return Hy(om(e))+"|lt:"+e.limitType}function cm(e){return"Query(target="+(t=om(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),0<t.filters.length&&(n+=", filters: ["+t.filters.map(function(e){return Mg(e instanceof pm,"stringifyFilter() only supports FieldFilters"),e.field.canonicalString()+" "+e.op+" "+Ty(e.value)}).join(", ")+"]"),Jg(t.limit)||(n+=", limit: "+t.limit),0<t.orderBy.length&&(n+=", orderBy: ["+t.orderBy.map(function(e){return e.field.canonicalString()+" ("+e.dir+")"}).join(", ")+"]"),t.startAt&&(n+=", startAt: "+Um(t.startAt)),t.endAt&&(n+=", endAt: "+Um(t.endAt)),"Target("+n+")")+"; limitType="+e.limitType+")";var t,n}function lm(i,e){return t=i,n=e.key.path,(null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):cy.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n))&&function(e){for(var t=0,n=i.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&null===e.field(r.field))return}return 1}(e)&&function(e){for(var t=0,n=i.filters;t<n.length;t++)if(!n[t].matches(e))return;return 1}(e)&&(n=e,(!(e=i).startAt||qm(e.startAt,im(e),n))&&(!e.endAt||!qm(e.endAt,im(e),n)));var t,n}function hm(s){return function(e,t){for(var n=!1,r=0,i=im(s);r<i.length;r++){var o=i[r],a=function(e,t,n){var r,i;switch(n=e.field.isKeyField()?cy.comparator(t.key,n.key):(r=e.field,i=n,t=(t=t).field(r),r=i.field(r),null!==t&&null!==r?wy(t,r):xg("Trying to compare documents on fields that don't exist")),e.dir){case"asc":return n;case"desc":return-1*n;default:return xg("Unknown direction: "+e.dir)}}(o,e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return Mg(n,"orderBy used that doesn't compare on key field"),0}}var fm,pm=(fo(dm,fm=function(){}),dm.create=function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):(Mg(Ry(n),"Comparing on key, but filter value not a RefValue"),Mg("array-contains"!==t&&"array-contains-any"!==t,"'"+t.toString()+"' queries don't make sense on document keys."),new ym(e,t,n)):"array-contains"===t?new Cm(e,n):"in"===t?(Mg(Dy(n),"IN filter has invalid value: "+n.toString()),new Nm(e,n)):"not-in"===t?(Mg(Dy(n),"NOT_IN filter has invalid value: "+n.toString()),new Om(e,n)):"array-contains-any"===t?(Mg(Dy(n),"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new Lm(e,n)):new dm(e,t,n)},dm.createKeyFieldInFilter=function(e,t,n){return Mg(Dy(n),"Comparing on key with "+t.toString()+", but filter value not an ArrayValue"),Mg((n.arrayValue.values||[]).every(Ry),"Comparing on key with "+t.toString()+", but an array value was not a RefValue"),new("in"===t?bm:Em)(e,n)},dm.prototype.matches=function(e){return e=e.field(this.field),"!="===this.op?null!==e&&this.matchesComparison(wy(e,this.value)):null!==e&&vy(this.value)===vy(e)&&this.matchesComparison(wy(e,this.value))},dm.prototype.matchesComparison=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return 0<e;case">=":return 0<=e;default:return xg("Unknown FieldFilter operator: "+this.op)}},dm.prototype.isInequality=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},dm);function dm(e,t,n){var r=fm.call(this)||this;return r.field=e,r.op=t,r.value=n,r}var gm,ym=(fo(mm,gm=pm),mm.prototype.matches=function(e){return e=cy.comparator(e.key,this.key),this.matchesComparison(e)},mm);function mm(e,t,n){return t=gm.call(this,e,t,n)||this,Mg(Ry(n),"KeyFieldFilter expects a ReferenceValue"),t.key=cy.fromName(n.referenceValue),t}var vm,bm=(fo(_m,vm=pm),_m.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},_m);function _m(e,t){return(e=vm.call(this,e,"in",t)||this).keys=Im("in",t),e}var wm,Em=(fo(Tm,wm=pm),Tm.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},Tm);function Tm(e,t){return(e=wm.call(this,e,"not-in",t)||this).keys=Im("not-in",t),e}function Im(t,e){return Mg(Dy(e),"KeyFieldInFilter/KeyFieldNotInFilter expects an ArrayValue"),((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(e){return Mg(Ry(e),"Comparing on key with "+t.toString()+", but an array value was not a ReferenceValue"),cy.fromName(e.referenceValue)})}var Sm,Cm=(fo(Am,Sm=pm),Am.prototype.matches=function(e){return Dy(e=e.field(this.field))&&_y(e.arrayValue,this.value)},Am);function Am(e,t){return Sm.call(this,e,"array-contains",t)||this}var km,Nm=(fo(Dm,km=pm),Dm.prototype.matches=function(e){return null!==(e=e.field(this.field))&&_y(this.value.arrayValue,e)},Dm);function Dm(e,t){return e=km.call(this,e,"in",t)||this,Mg(Dy(t),"InFilter expects an ArrayValue"),e}var Rm,Om=(fo(Pm,Rm=pm),Pm.prototype.matches=function(e){return!_y(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(e=e.field(this.field))&&!_y(this.value.arrayValue,e))},Pm);function Pm(e,t){return e=Rm.call(this,e,"not-in",t)||this,Mg(Dy(t),"NotInFilter expects an ArrayValue"),e}var xm,Lm=(fo(Mm,xm=pm),Mm.prototype.matches=function(e){var t=this;return!(!Dy(e=e.field(this.field))||!e.arrayValue.values)&&e.arrayValue.values.some(function(e){return _y(t.value.arrayValue,e)})},Mm);function Mm(e,t){return e=xm.call(this,e,"array-contains-any",t)||this,Mg(Dy(t),"ArrayContainsAnyFilter expects an ArrayValue"),e}var Fm=function(e,t){this.position=e,this.before=t};function Um(e){return(e.before?"b":"a")+":"+e.position.map(Ty).join(",")}function qm(e,t,n){Mg(e.position.length<=t.length,"Bound has more components than query's orderBy");for(var r=0,i=0;i<e.position.length;i++){var o,a=t[i],s=e.position[i],r=a.field.isKeyField()?(Mg(Ry(s),"Bound has a non-key value where the key path is being used."),cy.comparator(cy.fromName(s.referenceValue),n.key)):(Mg(null!==(o=n.field(a.field)),"Field should exist since document matched the orderBy already."),wy(s,o));if("desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function jm(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!by(e.position[n],t.position[n]))return!1;return!0}var Vm=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t},Bm=(Km.fromTimestamp=function(e){return new Km(e)},Km.min=function(){return new Km(new Wg(0,0))},Km.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},Km.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},Km.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Km.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Km.prototype.toTimestamp=function(){return this.timestamp},Km);function Km(e){this.timestamp=e}var Wm=(zm.prototype.insert=function(e,t){return new zm(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qm.BLACK,null,null))},zm.prototype.remove=function(e){return new zm(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qm.BLACK,null,null))},zm.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:0<n&&(t=t.right)}return null},zm.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;n=r<0?n.left:(t+=n.left.size+1,n.right)}return-1},zm.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(zm.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),zm.prototype.minKey=function(){return this.root.minKey()},zm.prototype.maxKey=function(){return this.root.maxKey()},zm.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},zm.prototype.forEach=function(n){this.inorderTraversal(function(e,t){return n(e,t),!1})},zm.prototype.toString=function(){var n=[];return this.inorderTraversal(function(e,t){return n.push(e+":"+t),!1}),"{"+n.join(", ")+"}"},zm.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},zm.prototype.getIterator=function(){return new Hm(this.root,null,this.comparator,!1)},zm.prototype.getIteratorFrom=function(e){return new Hm(this.root,e,this.comparator,!1)},zm.prototype.getReverseIterator=function(){return new Hm(this.root,null,this.comparator,!0)},zm.prototype.getReverseIteratorFrom=function(e){return new Hm(this.root,e,this.comparator,!0)},zm);function zm(e,t){this.comparator=e,this.root=t||Qm.EMPTY}var Hm=(Gm.prototype.getNext=function(){Mg(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},Gm.prototype.hasNext=function(){return 0<this.nodeStack.length},Gm.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},Gm);function Gm(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}var Qm=(Ym.prototype.copy=function(e,t,n,r,i){return new Ym(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ym.prototype.isEmpty=function(){return!1},Ym.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},Ym.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},Ym.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},Ym.prototype.minKey=function(){return this.min().key},Ym.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Ym.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},Ym.prototype.removeMin=function(){if(this.left.isEmpty())return Ym.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},Ym.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ym.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()},Ym.prototype.isRed=function(){return this.color},Ym.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},Ym.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},Ym.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},Ym.prototype.rotateLeft=function(){var e=this.copy(null,null,Ym.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},Ym.prototype.rotateRight=function(){var e=this.copy(null,null,Ym.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},Ym.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},Ym.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},Ym.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw xg("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw xg("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw xg("Black depths differ");return e+(this.isRed()?0:1)},Ym);function Ym(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ym.RED,this.left=null!=r?r:Ym.EMPTY,this.right=null!=i?i:Ym.EMPTY,this.size=this.left.size+1+this.right.size}function Xm(){this.size=0}Qm.EMPTY=null,Qm.RED=!0,Qm.BLACK=!1,Object.defineProperty(Xm.prototype,"key",{get:function(){throw xg("LLRBEmptyNode has no key.")},enumerable:!1,configurable:!0}),Object.defineProperty(Xm.prototype,"value",{get:function(){throw xg("LLRBEmptyNode has no value.")},enumerable:!1,configurable:!0}),Object.defineProperty(Xm.prototype,"color",{get:function(){throw xg("LLRBEmptyNode has no color.")},enumerable:!1,configurable:!0}),Object.defineProperty(Xm.prototype,"left",{get:function(){throw xg("LLRBEmptyNode has no left child.")},enumerable:!1,configurable:!0}),Object.defineProperty(Xm.prototype,"right",{get:function(){throw xg("LLRBEmptyNode has no right child.")},enumerable:!1,configurable:!0}),Xm.prototype.copy=function(e,t,n,r,i){return this},Xm.prototype.insert=function(e,t,n){return new Qm(e,t)},Xm.prototype.remove=function(e,t){return this},Xm.prototype.isEmpty=function(){return!0},Xm.prototype.inorderTraversal=function(e){return!1},Xm.prototype.reverseTraversal=function(e){return!1},Xm.prototype.minKey=function(){return null},Xm.prototype.maxKey=function(){return null},Xm.prototype.isRed=function(){return!1},Xm.prototype.checkMaxDepth=function(){return!0},Xm.prototype.check=function(){return 0},Hn=Xm,Qm.EMPTY=new Hn;var Jm=($m.prototype.has=function(e){return null!==this.data.get(e)},$m.prototype.first=function(){return this.data.minKey()},$m.prototype.last=function(){return this.data.maxKey()},Object.defineProperty($m.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),$m.prototype.indexOf=function(e){return this.data.indexOf(e)},$m.prototype.forEach=function(n){this.data.inorderTraversal(function(e,t){return n(e),!1})},$m.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,e[1]))return;t(r.key)}},$m.prototype.forEachWhile=function(e,t){for(var n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},$m.prototype.firstAfterOrEqual=function(e){return(e=this.data.getIteratorFrom(e)).hasNext()?e.getNext().key:null},$m.prototype.getIterator=function(){return new Zm(this.data.getIterator())},$m.prototype.getIteratorFrom=function(e){return new Zm(this.data.getIteratorFrom(e))},$m.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},$m.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},$m.prototype.isEmpty=function(){return this.data.isEmpty()},$m.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t},$m.prototype.isEqual=function(e){if(!(e instanceof $m))return!1;if(this.size!==e.size)return!1;for(var t=this.data.getIterator(),n=e.data.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},$m.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},$m.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},$m.prototype.copy=function(e){var t=new $m(this.comparator);return t.data=e,t},$m);function $m(e){this.comparator=e,this.data=new Wm(this.comparator)}var Zm=(ev.prototype.getNext=function(){return this.iter.getNext().key},ev.prototype.hasNext=function(){return this.iter.hasNext()},ev);function ev(e){this.iter=e}var tv=new Wm(cy.comparator),nv=new Wm(cy.comparator),rv=new Wm(cy.comparator),iv=new Jm(cy.comparator);function ov(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=iv,r=0,i=e;r<i.length;r++)var o=i[r],n=n.add(o);return n}var av=new Jm(jg),sv=(uv.empty=function(){return new uv({mapValue:{}})},uv.prototype.field=function(e){if(e.isEmpty())return this.proto;for(var t=this.proto,n=0;n<e.length-1;++n){if(!t.mapValue.fields)return null;if(!xy(t=t.mapValue.fields[e.get(n)]))return null}return(t=(t.mapValue.fields||{})[e.lastSegment()])||null},uv.prototype.isEqual=function(e){return by(this.proto,e.proto)},uv);function uv(e){Mg(!gy(this.proto=e),"ServerTimestamps should be converted to ServerTimestampValue")}var cv=(lv.prototype.set=function(e,t){return Mg(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),this.setOverlay(e,t),this},lv.prototype.delete=function(e){return Mg(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),this.setOverlay(e,null),this},lv.prototype.setOverlay=function(e,t){for(var n=this.overlayMap,r=0;r<e.length-1;++r)var i=e.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===vy(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(e.lastSegment(),t)},lv.prototype.build=function(){var e=this.applyOverlay(sy.emptyPath(),this.overlayMap);return null!=e?new sv(e):this.baseObject},lv.prototype.applyOverlay=function(r,e){var i=this,o=!1,t=this.baseObject.field(r),a=xy(t)?Object.assign({},t.mapValue.fields):{};return e.forEach(function(e,t){var n;e instanceof Map?null!=(n=i.applyOverlay(r.child(t),e))&&(a[t]=n,o=!0):null!==e?(a[t]=e,o=!0):a.hasOwnProperty(t)&&(delete a[t],o=!0)}),o?{mapValue:{fields:a}}:null},lv);function lv(e){void 0===e&&(e=sv.empty()),this.baseObject=e,this.overlayMap=new Map}function hv(e){this.count=e}var fv;function pv(e){switch(e){case Ig.OK:return xg("Treated status OK as error"),0;case Ig.CANCELLED:case Ig.UNKNOWN:case Ig.DEADLINE_EXCEEDED:case Ig.RESOURCE_EXHAUSTED:case Ig.INTERNAL:case Ig.UNAVAILABLE:case Ig.UNAUTHENTICATED:return;case Ig.INVALID_ARGUMENT:case Ig.NOT_FOUND:case Ig.ALREADY_EXISTS:case Ig.PERMISSION_DENIED:case Ig.FAILED_PRECONDITION:case Ig.ABORTED:case Ig.OUT_OF_RANGE:case Ig.UNIMPLEMENTED:case Ig.DATA_LOSS:return 1;default:return xg("Unknown status code: "+e),0}}function dv(e){if(void 0===e)return Rg("GRPC error has no .code"),Ig.UNKNOWN;switch(e){case fv.OK:return Ig.OK;case fv.CANCELLED:return Ig.CANCELLED;case fv.UNKNOWN:return Ig.UNKNOWN;case fv.DEADLINE_EXCEEDED:return Ig.DEADLINE_EXCEEDED;case fv.RESOURCE_EXHAUSTED:return Ig.RESOURCE_EXHAUSTED;case fv.INTERNAL:return Ig.INTERNAL;case fv.UNAVAILABLE:return Ig.UNAVAILABLE;case fv.UNAUTHENTICATED:return Ig.UNAUTHENTICATED;case fv.INVALID_ARGUMENT:return Ig.INVALID_ARGUMENT;case fv.NOT_FOUND:return Ig.NOT_FOUND;case fv.ALREADY_EXISTS:return Ig.ALREADY_EXISTS;case fv.PERMISSION_DENIED:return Ig.PERMISSION_DENIED;case fv.FAILED_PRECONDITION:return Ig.FAILED_PRECONDITION;case fv.ABORTED:return Ig.ABORTED;case fv.OUT_OF_RANGE:return Ig.OUT_OF_RANGE;case fv.UNIMPLEMENTED:return Ig.UNIMPLEMENTED;case fv.DATA_LOSS:return Ig.DATA_LOSS;default:return xg("Unknown status code: "+e)}}(he=fv=fv||{})[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";var gv=(yv.createSynthesizedRemoteEventForCurrentChange=function(e,t){var n=new Map;return n.set(e,mv.createSynthesizedTargetChangeForCurrentChange(e,t)),new yv(Bm.min(),n,av,tv,ov())},yv);function yv(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}var mv=(vv.createSynthesizedTargetChangeForCurrentChange=function(e,t){return new vv(Yg.EMPTY_BYTE_STRING,t,ov(),ov(),ov())},vv);function vv(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}var bv=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},_v=function(e,t){this.targetId=e,this.existenceFilter=t},wv=function(e,t,n,r){void 0===n&&(n=Yg.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Ev=(Object.defineProperty(Tv.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!1,configurable:!0}),Tv.prototype.updateResumeToken=function(e){0<e.approximateByteSize()&&(this._hasPendingChanges=!0,this._resumeToken=e)},Tv.prototype.toTargetChange=function(){var n=ov(),r=ov(),i=ov();return this.documentChanges.forEach(function(e,t){switch(t){case 0:n=n.add(e);break;case 2:r=r.add(e);break;case 1:i=i.add(e);break;default:xg("Encountered invalid change type: "+t)}}),new mv(this._resumeToken,this._current,n,r,i)},Tv.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Av()},Tv.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},Tv.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},Tv.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},Tv.prototype.recordTargetResponse=function(){--this.pendingResponses},Tv.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},Tv);function Tv(){this.pendingResponses=0,this.documentChanges=Av(),this._resumeToken=Yg.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}var Iv=(Sv.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof My?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof qy&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)r=o[i],this.removeDocumentFromTarget(r,e.key,e.newDoc)},Sv.prototype.handleTargetChange=function(n){var r=this;this.forEachTarget(n,function(e){var t=r.ensureTargetState(e);switch(n.state){case 0:r.isActiveTarget(e)&&t.updateResumeToken(n.resumeToken);break;case 1:t.recordTargetResponse(),t.isPending||t.clearPendingChanges(),t.updateResumeToken(n.resumeToken);break;case 2:t.recordTargetResponse(),t.isPending||r.removeTarget(e),Mg(!n.cause,"WatchChangeAggregator does not handle errored targets");break;case 3:r.isActiveTarget(e)&&(t.markCurrent(),t.updateResumeToken(n.resumeToken));break;case 4:r.isActiveTarget(e)&&(r.resetTarget(e),t.updateResumeToken(n.resumeToken));break;default:xg("Unknown target watch change state: "+n.state)}})},Sv.prototype.forEachTarget=function(e,n){var r=this;0<e.targetIds.length?e.targetIds.forEach(n):this.targetStates.forEach(function(e,t){r.isActiveTarget(t)&&n(t)})},Sv.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count;(e=this.targetDataForActiveTarget(t))&&(Qy(e=e.target)?0===n?(e=new cy(e.path),this.removeDocumentFromTarget(t,e,new qy(e,Bm.min()))):Lg(1===n,"Single document existence filter with count: "+n):this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t)))},Sv.prototype.createRemoteEvent=function(r){var i=this,o=new Map;this.targetStates.forEach(function(e,t){var n=i.targetDataForActiveTarget(t);n&&(e.current&&Qy(n.target)&&(n=new cy(n.target.path),null!==i.pendingDocumentUpdates.get(n)||i.targetContainsDocument(t,n)||i.removeDocumentFromTarget(t,n,new qy(n,r))),e.hasPendingChanges&&(o.set(t,e.toTargetChange()),e.clearPendingChanges()))});var a=ov();this.pendingDocumentTargetMapping.forEach(function(e,t){var n=!0;t.forEachWhile(function(e){return!(e=i.targetDataForActiveTarget(e))||2===e.purpose||(n=!1)}),n&&(a=a.add(e))});var e=new gv(r,o,this.pendingTargetResets,this.pendingDocumentUpdates,a);return this.pendingDocumentUpdates=tv,this.pendingDocumentTargetMapping=Cv(),this.pendingTargetResets=new Jm(jg),e},Sv.prototype.addDocumentToTarget=function(e,t){var n;this.isActiveTarget(e)&&(n=this.targetContainsDocument(e,t.key)?2:0,this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e)))},Sv.prototype.removeDocumentFromTarget=function(e,t,n){var r;this.isActiveTarget(e)&&(r=this.ensureTargetState(e),this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n)))},Sv.prototype.removeTarget=function(e){this.targetStates.delete(e)},Sv.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},Sv.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},Sv.prototype.ensureTargetState=function(e){var t=this.targetStates.get(e);return t||(t=new Ev,this.targetStates.set(e,t)),t},Sv.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Jm(jg),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},Sv.prototype.isActiveTarget=function(e){var t=null!==this.targetDataForActiveTarget(e);return t||Dg("WatchChangeAggregator","Detected inactive target",e),t},Sv.prototype.targetDataForActiveTarget=function(e){var t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)},Sv.prototype.resetTarget=function(t){var n=this;Mg(!this.targetStates.get(t).isPending,"Should only reset active targets"),this.targetStates.set(t,new Ev),this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(e){n.removeDocumentFromTarget(t,e,null)})},Sv.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},Sv);function Sv(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=tv,this.pendingDocumentTargetMapping=Cv(),this.pendingTargetResets=new Jm(jg)}function Cv(){return new Wm(cy.comparator)}function Av(){return new Wm(cy.comparator)}var kv={asc:"ASCENDING",desc:"DESCENDING"},Nv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};function Dv(e,t){Mg(!Jg(e),t+" is missing")}var Rv=function(e,t){this.databaseId=e,this.useProto3Json=t};function Ov(e){return{integerValue:""+e}}function Pv(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$g(t)?"-0":t}}function xv(e,t){return Zg(t)?Ov(t):Pv(e,t)}function Lv(e,t){return e.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function Mv(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Fv(e){return Lg(!!e,"Trying to deserialize version that isn't set"),Bm.fromTimestamp((e=Iy(e),new Wg(e.seconds,e.nanos)))}function Uv(e,t){return new ry(["projects",e.projectId,"databases",e.database]).child("documents").child(t).canonicalString()}function qv(e){return Lg(nb(e=ry.fromString(e)),"Tried to deserialize invalid key "+e.toString()),e}function jv(e,t){return Uv(e.databaseId,t.path)}function Vv(e,t){if((t=qv(t)).get(1)!==e.databaseId.projectId)throw new Sg(Ig.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+e.databaseId.projectId);if(t.get(3)!==e.databaseId.database)throw new Sg(Ig.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+e.databaseId.database);return new cy(zv(t))}function Bv(e,t){return Uv(e.databaseId,t)}function Kv(e){return 4===(e=qv(e)).length?ry.emptyPath():zv(e)}function Wv(e){return new ry(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function zv(e){return Lg(4<e.length&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)}function Hv(e,t,n){return{name:jv(e,t),fields:n.proto.mapValue.fields}}function Gv(e,t){var n,r,i;if(t instanceof xb)n={update:Hv(e,t.key,t.value)};else if(t instanceof Hb)n={delete:jv(e,t.key)};else if(t instanceof Fb)n={update:Hv(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach(function(e){return i.push(e.canonicalString())}),{fieldPaths:i})};else if(t instanceof Vb)n={transform:{document:jv(e,t.key),fieldTransforms:t.fieldTransforms.map(function(e){var t=e.transform;if(t instanceof ob)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof ub)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof fb)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof yb)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw xg("Unknown transform: "+e.transform)})}};else{if(!(t instanceof Yb))return xg("Unknown mutation type "+t.type);n={verify:jv(e,t.key)}}return t.precondition.isNone||(n.currentDocument=(Mg(!(t=t.precondition).isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:Lv(e,t.updateTime.toTimestamp())}:void 0!==t.exists?{exists:t.exists}:xg("Unknown precondition"))),n}function Qv(i,e){var t,n=e.currentDocument?void 0!==(a=e.currentDocument).updateTime?Sb.updateTime(Fv(a.updateTime)):void 0!==a.exists?Sb.exists(a.exists):Sb.none():Sb.none();if(e.update){Dv(e.update.name,"name");var r=Vv(i,e.update.name),o=new sv({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=(t=(t=e.updateMask).fieldPaths||[],new _b(t.map(function(e){return sy.fromServerFormat(e)})));return new Fb(r,o,a,n)}return new xb(r,o,n)}return e.delete?(r=Vv(i,e.delete),new Hb(r,n)):e.transform?(r=Vv(i,e.transform.document),o=e.transform.fieldTransforms.map(function(e){return t=i,r=null,"setToServerValue"in(e=e)?(Lg("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),r=new ob):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ub(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new fb(n)):"increment"in e?r=new yb(t,e.increment):xg("Unknown transform proto: "+JSON.stringify(e)),e=sy.fromServerFormat(e.fieldPath),new Eb(e,r);var t,n,r}),Lg(!0===n.exists,'Transforms only support precondition "exists == true"'),new Vb(r,o)):e.verify?(r=Vv(i,e.verify),new Yb(r,n)):xg("unknown mutation proto: "+JSON.stringify(e))}function Yv(e,t){return{documents:[Bv(e,t.path)]}}function Xv(e,t){var n={structuredQuery:{}},r=t.path;return null!==t.collectionGroup?(Mg(r.length%2==0,"Collection Group queries should be within a document path or root."),n.parent=Bv(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Mg(r.length%2!=0,"Document queries with filters are not supported."),n.parent=Bv(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),(r=function(e){if(0!==e.length)return 1!==(e=e.map(function(e){return Mg(e instanceof pm,"Only FieldFilters are supported"),function(e){if("=="===e.op){if(Py(e.value))return{unaryFilter:{field:eb(e.field),op:"IS_NAN"}};if(Oy(e.value))return{unaryFilter:{field:eb(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Py(e.value))return{unaryFilter:{field:eb(e.field),op:"IS_NOT_NAN"}};if(Oy(e.value))return{unaryFilter:{field:eb(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eb(e.field),op:(t=e.op,Nv[t]),value:e.value}};var t}(e)})).length?{compositeFilter:{op:"AND",filters:e}}:e[0]}(t.filters))&&(n.structuredQuery.where=r),(r=0!==(r=t.orderBy).length?r.map(function(e){return{field:eb(e.field),direction:(e=e.dir,kv[e])}}):void 0)&&(n.structuredQuery.orderBy=r),r=e,e=t.limit,null!==(e=r.useProto3Json||Jg(e)?e:{value:e})&&(n.structuredQuery.limit=e),t.startAt&&(n.structuredQuery.startAt=$v(t.startAt)),t.endAt&&(n.structuredQuery.endAt=$v(t.endAt)),n}function Jv(e){var t=Kv(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lg(1===r,"StructuredQuery.from with more than one collection is not supported."),(a=n.from[0]).allDescendants?i=a.collectionId:t=t.child(a.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=tb(e.unaryFilter.field);return pm.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=tb(e.unaryFilter.field);return pm.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=tb(e.unaryFilter.field),pm.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return e=tb(e.unaryFilter.field),pm.create(e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xg("Unspecified filter");default:return xg("Unknown filter")}}(t)]:void 0!==t.fieldFilter?[(n=t,pm.create(tb(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xg("Unspecified operator");default:return xg("Unknown operator")}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(e).reduce(function(e,t){return e.concat(t)}):xg("Unknown filter: "+JSON.stringify(t)):[];var n}(n.where)),e=[],n.orderBy&&(e=n.orderBy.map(function(e){return new Vm(tb(e.field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}())})),r=null,n.limit&&(r=Jg(s="object"==typeof(s=n.limit)?s.value:s)?null:s);var a=null;n.startAt&&(a=Zv(n.startAt));var s=null;return n.endAt&&(s=Zv(n.endAt)),Xy(t,i,e,o,r,"F",a,s)}function $v(e){return{before:e.before,values:e.position}}function Zv(e){var t=!!e.before,e=e.values||[];return new Fm(e,t)}function eb(e){return{fieldPath:e.canonicalString()}}function tb(e){return sy.fromServerFormat(e.fieldPath)}function nb(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)}function rb(e,t){return e instanceof yb?Ny(t)?t:{integerValue:0}:null}var ib,ob=(fo(ab,ib=fe=function(){this._=void 0}),ab);function ab(){return null!==ib&&ib.apply(this,arguments)||this}var sb,ub=(fo(cb,sb=fe),cb);function cb(e){var t=sb.call(this)||this;return t.elements=e,t}function lb(e,t){for(var n=bb(t),r=0,i=e.elements;r<i.length;r++)!function(t){n.some(function(e){return by(e,t)})||n.push(t)}(i[r]);return{arrayValue:{values:n}}}var hb,fb=(fo(pb,hb=fe),pb);function pb(e){var t=hb.call(this)||this;return t.elements=e,t}function db(e,t){for(var n=bb(t),r=0,i=e.elements;r<i.length;r++)!function(t){n=n.filter(function(e){return!by(e,t)})}(i[r]);return{arrayValue:{values:n}}}var gb,yb=(fo(mb,gb=fe),mb);function mb(e,t){var n=gb.call(this)||this;return n.serializer=e,Mg(Ny(n.operand=t),"NumericIncrementTransform transform requires a NumberValue"),n}function vb(e){return Sy(e.integerValue||e.doubleValue)}function bb(e){return Dy(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var _b=(wb.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},wb.prototype.isEqual=function(e){return Vg(this.fields,e.fields,function(e,t){return e.isEqual(t)})},wb);function wb(n){(this.fields=n).sort(sy.comparator),Mg(!n.some(function(e,t){return 0!==t&&e.isEqual(n[t-1])}),"FieldMask contains field that is not unique: "+n.find(function(e,t){return 0!==t&&e.isEqual(n[t-1])}))}var Eb=function(e,t){this.field=e,this.transform=t};function Tb(e,t){return e.field.isEqual(t.field)&&(e=e.transform,t=t.transform,e instanceof ub&&t instanceof ub||e instanceof fb&&t instanceof fb?Vg(e.elements,t.elements,by):e instanceof yb&&t instanceof yb?by(e.operand,t.operand):e instanceof ob&&t instanceof ob)}function Ib(e,t){this.version=e,this.transformResults=t}var Sb=(Cb.none=function(){return new Cb},Cb.exists=function(e){return new Cb(void 0,e)},Cb.updateTime=function(e){return new Cb(e)},Object.defineProperty(Cb.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Cb.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},Cb);function Cb(e,t){this.updateTime=e,this.exists=t,Mg(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}function Ab(e,t){return void 0!==e.updateTime?t instanceof My&&t.version.isEqual(e.updateTime):void 0!==e.exists?e.exists===t instanceof My:(Mg(e.isNone,"Precondition should be empty"),1)}function kb(e,t,n){return Rb(e,t),e instanceof xb?(i=e,Mg(null==(o=n).transformResults,"Transform results received by SetMutation."),new My(i.key,o.version,i.value,{hasCommittedMutations:!0})):e instanceof Fb?(r=e,o=t,Mg(null==(i=n).transformResults,"Transform results received by PatchMutation."),Ab(r.precondition,o)?(o=qb(r,o),new My(r.key,i.version,o,{hasCommittedMutations:!0})):new By(r.key,i.version)):e instanceof Vb?function(e,t,n){if(Lg(null!=n.transformResults,"Transform results missing for TransformMutation."),!Ab(e.precondition,t))return new By(e.key,n.version);var r=Kb(e,t),t=function(e,t,n){var r=[];Lg(e.length===n.length,"server transform result count ("+n.length+") should match field transform count ("+e.length+")");for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=null;t instanceof My&&(s=t.field(o.field)),r.push((o=a,a=s,s=n[i],o instanceof ub?lb(o,a):o instanceof fb?db(o,a):(Mg(null!==s,"Didn't receive transformResult for non-array transform"),s)))}return r}(e.fieldTransforms,t,n.transformResults),n=n.version,t=Wb(e,r.data(),t);return new My(e.key,n,t,{hasCommittedMutations:!0})}(e,t,n):(Mg(e instanceof Hb,"Unexpected mutation type: "+e),Mg(null==n.transformResults,"Transform results received by DeleteMutation."),new qy(e.key,n.version,{hasCommittedMutations:!0}));var r,i,o}function Nb(e,t,n,r){return Rb(e,t),e instanceof xb?(o=t,Ab((i=e).precondition,o)?(o=Ob(o),new My(i.key,o,i.value,{hasLocalMutations:!0})):o):e instanceof Fb?function(e,t){if(!Ab(e.precondition,t))return t;var n=Ob(t),t=qb(e,t);return new My(e.key,n,t,{hasLocalMutations:!0})}(e,t):e instanceof Vb?function(e,t,n,r){if(!Ab(e.precondition,t))return t;var i=Kb(e,t),r=function(e,t,n,r){for(var i,o,a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=c.transform,h=null;n instanceof My&&(h=n.field(c.field)),null===h&&r instanceof My&&(h=r.field(c.field)),a.push((i=h,o=t,h=c=void 0,(l=l)instanceof ob?(c=o,o=i,h={fields:((h={})[fy]={stringValue:hy},h[dy]={timestampValue:{seconds:c.seconds,nanos:c.nanoseconds}},h)},o&&(h.fields[py]=o),{mapValue:h}):l instanceof ub?lb(l,i):l instanceof fb?db(l,i):(Mg(l instanceof yb,"Expected NumericIncrementTransformOperation but was: "+l),l=vb(i=rb(h=l,l=i))+vb(h.operand),ky(i)&&ky(h.operand)?Ov(l):Pv(h.serializer,l))))}return a}(e.fieldTransforms,n,t,r),r=Wb(e,i.data(),r);return new My(e.key,i.version,r,{hasLocalMutations:!0})}(e,t,r,n):(Mg(e instanceof Hb,"Unexpected mutation type: "+e),t=t,Ab((e=e).precondition,t)?(t&&Mg(t.key.isEqual(e.key),"Can only apply mutation to document with same key"),new qy(e.key,Bm.min())):t);var i,o}function Db(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(0===e.type?e.value.isEqual(t.value):1===e.type?e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask):2!==e.type||Vg(e.fieldTransforms,e.fieldTransforms,Tb))}function Rb(e,t){null!=t&&Mg(t.key.isEqual(e.key),"Can only apply a mutation to a document with the same key")}function Ob(e){return e instanceof My?e.version:Bm.min()}var Pb,xb=(fo(Lb,Pb=Hn=function(){}),Lb);function Lb(e,t,n){var r=Pb.call(this)||this;return r.key=e,r.value=t,r.precondition=n,r.type=0,r}var Mb,Fb=(fo(Ub,Mb=Hn),Ub);function Ub(e,t,n,r){var i=Mb.call(this)||this;return i.key=e,i.data=t,i.fieldMask=n,i.precondition=r,i.type=1,i}function qb(e,t){var t=t instanceof My?t.data():sv.empty(),n=e,r=new cv(t);return n.fieldMask.fields.forEach(function(e){var t;e.isEmpty()||(null!==(t=n.data.field(e))?r.set(e,t):r.delete(e))}),r.build()}var jb,Vb=(fo(Bb,jb=Hn),Bb);function Bb(e,t){var n=jb.call(this)||this;return n.key=e,n.fieldTransforms=t,n.type=2,n.precondition=Sb.exists(!0),n}function Kb(e,t){return Mg(t instanceof My,"Unknown MaybeDocument type "+t),Mg(t.key.isEqual(e.key),"Can only transform a document with the same key"),t}function Wb(e,t,n){Mg(n.length===e.fieldTransforms.length,"TransformResults length mismatch.");for(var r=new cv(t),i=0;i<e.fieldTransforms.length;i++){var o=e.fieldTransforms[i];r.set(o.field,n[i])}return r.build()}var zb,Hb=(fo(Gb,zb=Hn),Gb);function Gb(e,t){var n=zb.call(this)||this;return n.key=e,n.precondition=t,n.type=3,n}var Qb,Yb=(fo(Xb,Qb=Hn),Xb);function Xb(e,t){var n=Qb.call(this)||this;return n.key=e,n.precondition=t,n.type=4,n}var Jb=-1,$b=(Zb.prototype.applyToRemoteDocument=function(e,t,n){t&&Mg(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;Mg(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(e)&&(t=kb(o,t,r[i]))}return t},Zb.prototype.applyToLocalView=function(e,t){t&&Mg(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(e)&&(t=Nb(i,t,t,this.localWriteTime));for(var i,o=t,a=0,s=this.mutations;a<s.length;a++)(i=s[a]).key.isEqual(e)&&(t=Nb(i,t,o,this.localWriteTime));return t},Zb.prototype.applyToLocalDocumentSet=function(n){var r=this,i=n;return this.mutations.forEach(function(e){var t=r.applyToLocalView(e.key,n.get(e.key));t&&(i=i.insert(e.key,t))}),i},Zb.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},ov())},Zb.prototype.isEqual=function(e){return this.batchId===e.batchId&&Vg(this.mutations,e.mutations,Db)&&Vg(this.baseMutations,e.baseMutations,Db)},Zb);function Zb(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,Mg(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}var e_=(t_.from=function(e,t,n){Lg(e.mutations.length===n.length,"Mutations sent "+e.mutations.length+" must equal results received "+n.length);for(var r=rv,i=e.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new t_(e,t,n,r)},t_);function t_(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}var n_=(r_.prototype.get=function(e){var t=this.mapKeyFn(e);if(void 0!==(t=this.inner[t]))for(var n=0,r=t;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.equalsFn(i,e))return o}},r_.prototype.has=function(e){return void 0!==this.get(e)},r_.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},r_.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},r_.prototype.forEach=function(a){Gg(this.inner,function(e,t){for(var n=0,r=t;n<r.length;n++){var i=(o=r[n])[0],o=o[1];a(i,o)}})},r_.prototype.isEmpty=function(){return Qg(this.inner)},r_);function r_(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}var i_=(o_.prototype.catch=function(e){return this.next(void 0,e)},o_.prototype.next=function(r,i){var o=this;return this.callbackAttached&&xg("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new o_(function(t,n){o.nextCallback=function(e){o.wrapSuccess(r,e).next(t,n)},o.catchCallback=function(e){o.wrapFailure(i,e).next(t,n)}})},o_.prototype.toPromise=function(){var n=this;return new Promise(function(e,t){n.next(e,t)})},o_.prototype.wrapUserFunction=function(e){try{var t=e();return t instanceof o_?t:o_.resolve(t)}catch(e){return o_.reject(e)}},o_.prototype.wrapSuccess=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):o_.resolve(t)},o_.prototype.wrapFailure=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):o_.reject(t)},o_.resolve=function(n){return new o_(function(e,t){e(n)})},o_.reject=function(n){return new o_(function(e,t){t(n)})},o_.waitFor=function(e){return new o_(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(e){return n(e)})}),o=!0,i===r&&t()})},o_.or=function(e){for(var n=o_.resolve(!1),t=0,r=e;t<r.length;t++)!function(t){n=n.next(function(e){return e?o_.resolve(e):t()})}(r[t]);return n},o_.forEach=function(e,n){var r=this,i=[];return e.forEach(function(e,t){i.push(n.call(r,e,t))}),this.waitFor(i)},o_);function o_(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}var a_=(s_.prototype.getDocument=function(t,n){var r=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,n).next(function(e){return r.getDocumentInternal(t,n,e)})},s_.prototype.getDocumentInternal=function(e,r,i){return this.remoteDocumentCache.getEntry(e,r).next(function(e){for(var t=0,n=i;t<n.length;t++)e=n[t].applyToLocalView(r,e);return e})},s_.prototype.applyLocalMutationsToDocuments=function(e,t,i){var o=tv;return t.forEach(function(e,t){for(var n=0,r=i;n<r.length;n++)t=r[n].applyToLocalView(e,t);o=o.insert(e,t)}),o},s_.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},s_.prototype.getLocalViewOfDocuments=function(t,r){var i=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(function(e){var e=i.applyLocalMutationsToDocuments(t,r,e),n=tv;return e.forEach(function(e,t){t=t||new qy(e,Bm.min()),n=n.insert(e,t)}),n})},s_.prototype.getDocumentsMatchingQuery=function(e,t,n){return nm(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)},s_.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new cy(t)).next(function(e){var t=nv;return e instanceof My&&(t=t.insert(e.key,e)),t})},s_.prototype.getDocumentsMatchingCollectionGroupQuery=function(n,r,i){var o=this;Mg(r.path.isEmpty(),"Currently we only support collection group queries at the root.");var a=r.collectionGroup,s=nv;return this.indexManager.getCollectionParents(n,a).next(function(e){return i_.forEach(e,function(e){var t=(t=r,e=e.child(a),new Yy(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt));return o.getDocumentsMatchingCollectionQuery(n,t,i).next(function(e){e.forEach(function(e,t){s=s.insert(e,t)})})}).next(function(){return s})})},s_.prototype.getDocumentsMatchingCollectionQuery=function(t,n,e){var u,c,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,e).next(function(e){return u=e,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,n)}).next(function(e){return c=e,r.addMissingBaseDocuments(t,c,u).next(function(e){u=e;for(var t=0,n=c;t<n.length;t++)for(var r=n[t],i=0,o=r.mutations;i<o.length;i++){var a=o[i],s=a.key,a=Nb(a,a=u.get(s),a,r.localWriteTime);u=a instanceof My?u.insert(s,a):u.remove(s)}})}).next(function(){return u.forEach(function(e,t){lm(n,t)||(u=u.remove(e))}),u})},s_.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=ov(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Fb&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(e,r).next(function(e){return e.forEach(function(e,t){null!==t&&t instanceof My&&(c=c.insert(e,t))}),c})},s_);function s_(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}var u_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",he=(c_.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},c_.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},c_);function c_(){this.onCommittedListeners=[]}var l_=(h_.prototype.withSequenceNumber=function(e){return new h_(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},h_.prototype.withResumeToken=function(e,t){return new h_(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)},h_.prototype.withLastLimboFreeSnapshotVersion=function(e){return new h_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},h_);function h_(e,t,n,r,i,o,a){void 0===i&&(i=Bm.min()),void 0===o&&(o=Bm.min()),void 0===a&&(a=Yg.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}var f_=(p_.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},p_.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},p_);function p_(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}f_.INVALID=-1;var d_="",g_="",y_="",m_="";function v_(e){for(var o="",t=0;t<e.length;t++)0<o.length&&(o=b_(o)),o=function(e){for(var t=o,n=e.length,r=0;r<n;r++){var i=e.charAt(r);switch(i){case"\0":t+=d_+y_;break;case d_:t+=d_+m_;break;default:t+=i}}return t}(e.get(t));return b_(o)}function b_(e){return e+d_+g_}function __(e){var t=e.length;if(Lg(2<=t,"Invalid path "+e),2===t)return Lg(e.charAt(0)===d_&&e.charAt(1)===g_,"Non-empty path "+e+" had length 2"),ry.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(d_,o);switch((a<0||n<a)&&xg('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case g_:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case y_:i+=e.substring(o,a),i+="\0";break;case m_:i+=e.substring(o,a+1);break;default:xg('Invalid encoded resource path: "'+e+'"')}o=a+2}return new ry(r)}var w_=function(e){this.remoteSerializer=e};function E_(e,t){if(t.document)return i=e.remoteSerializer,o=t.document,r=!!t.hasCommittedMutations,e=Vv(i,o.name),i=Fv(o.updateTime),o=new sv({mapValue:{fields:o.fields}}),new My(e,i,o,{hasCommittedMutations:!!r});if(t.noDocument){var n=cy.fromSegments(t.noDocument.path),r=A_(t.noDocument.readTime);return new qy(n,r,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(n=cy.fromSegments(t.unknownDocument.path),t=A_(t.unknownDocument.version),new By(n,t)):xg("Unexpected DbRemoteDocument");var i,o}function T_(e,t,n){var r=I_(n),n=t.key.path.popLast().toArray();if(t instanceof My){var i=(i=e.remoteSerializer,Mg(!(o=t).hasLocalMutations,"Can't serialize documents with mutations."),{name:jv(i,o.key),fields:o.toProto().mapValue.fields,updateTime:Lv(i,o.version.toTimestamp())}),o=t.hasCommittedMutations;return new Aw(null,null,i,o,r,n)}if(t instanceof qy){var a=t.key.path.toArray(),i=C_(t.version),o=t.hasCommittedMutations;return new Aw(null,new Sw(a,i),null,o,r,n)}return t instanceof By?(a=t.key.path.toArray(),t=C_(t.version),new Aw(new Cw(a,t),null,null,!0,r,n)):xg("Unexpected MaybeDocument")}function I_(e){return[(e=e.toTimestamp()).seconds,e.nanoseconds]}function S_(e){return e=new Wg(e[0],e[1]),Bm.fromTimestamp(e)}function C_(e){return e=e.toTimestamp(),new bw(e.seconds,e.nanoseconds)}function A_(e){return e=new Wg(e.seconds,e.nanoseconds),Bm.fromTimestamp(e)}function k_(t,e){var n=(e.baseMutations||[]).map(function(e){return Qv(t.remoteSerializer,e)}),r=e.mutations.map(function(e){return Qv(t.remoteSerializer,e)}),i=Wg.fromMillis(e.localWriteTimeMs);return new $b(e.batchId,i,n,r)}function N_(e){var t,n=A_(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?A_(e.lastLimboFreeSnapshotVersion):Bm.min(),i=void 0!==e.query.documents?(Lg(1===(t=(i=e.query).documents.length),"DocumentsTarget contained other than 1 document: "+t),om(Jy(Kv(i.documents[0])))):om(Jv(e.query));return new l_(i,e.targetId,0,e.lastListenSequenceNumber,n,r,Yg.fromBase64String(e.resumeToken))}function D_(e,t){Mg(0===t.purpose,"Only queries with purpose 0 may be stored, got "+t.purpose);var n=C_(t.snapshotVersion),r=C_(t.lastLimboFreeSnapshotVersion),i=(Qy(t.target)?Yv:Xv)(e.remoteSerializer,t.target),e=t.resumeToken.toBase64();return new Nw(t.targetId,Hy(t.target),n,e,t.sequenceNumber,r,i)}function R_(e){var t=Jv({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?(Mg(!!t.limit,"Bundled query has limitType LAST, but limit is null"),am(t,t.limit,"L")):t}var O_=(P_.forUser=function(e,t,n,r){return Lg(""!==e.uid,"UserID must not be an empty string."),new P_(e.isAuthenticated()?e.uid:"",t,n,r)},P_.prototype.checkEmpty=function(e){var r=!0,t=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return M_(e).iterate({index:Ew.userMutationsIndex,range:t},function(e,t,n){r=!1,n.done()}).next(function(){return r})},P_.prototype.addMutationBatch=function(d,g,y,m){var v=this,b=F_(d),_=M_(d);return _.add({}).next(function(e){Lg("number"==typeof e,"Auto-generated key is not a number");for(var t,n,r,i,o,a=new $b(e,g,y,m),s=(t=v.serializer,n=v.userId,i=(r=a).baseMutations.map(function(e){return Gv(t.remoteSerializer,e)}),o=r.mutations.map(function(e){return Gv(t.remoteSerializer,e)}),new Ew(n,r.batchId,r.localWriteTime.toMillis(),i,o)),u=[],c=new Jm(function(e,t){return jg(e.canonicalString(),t.canonicalString())}),l=0,h=m;l<h.length;l++){var f=h[l],p=Tw.key(v.userId,f.key.path,e),c=c.add(f.key.path.popLast());u.push(_.put(s)),u.push(b.put(p,Tw.PLACEHOLDER))}return c.forEach(function(e){u.push(v.indexManager.addToCollectionParentIndex(d,e))}),d.addOnCommittedListener(function(){v.documentKeysByBatchId[e]=a.keys()}),i_.waitFor(u).next(function(){return a})})},P_.prototype.lookupMutationBatch=function(e,t){var n=this;return M_(e).get(t).next(function(e){return e?(Lg(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),k_(n.serializer,e)):null})},P_.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?i_.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(function(e){return e?(e=e.keys(),n.documentKeysByBatchId[t]=e):null})},P_.prototype.getNextMutationBatchAfterBatchId=function(e,t){var r=this,i=t+1,t=IDBKeyRange.lowerBound([this.userId,i]),o=null;return M_(e).iterate({index:Ew.userMutationsIndex,range:t},function(e,t,n){t.userId===r.userId&&(Lg(t.batchId>=i,"Should have found mutation after "+i),o=k_(r.serializer,t)),n.done()}).next(function(){return o})},P_.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Jb;return M_(e).iterate({index:Ew.userMutationsIndex,range:t,reverse:!0},function(e,t,n){r=t.batchId,n.done()}).next(function(){return r})},P_.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,Jb],[this.userId,Number.POSITIVE_INFINITY]);return M_(e).loadAll(Ew.userMutationsIndex,n).next(function(e){return e.map(function(e){return k_(t.serializer,e)})})},P_.prototype.getAllMutationBatchesAffectingDocumentKey=function(a,s){var u=this,e=Tw.prefixForPath(this.userId,s.path),e=IDBKeyRange.lowerBound(e),c=[];return F_(a).iterate({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],i=__(i);if(r===u.userId&&s.path.isEqual(i))return M_(a).get(o).next(function(e){if(!e)throw xg("Dangling document-mutation reference found: "+t+" which points to "+o);Lg(e.userId===u.userId,"Unexpected user '"+e.userId+"' for mutation batch "+o),c.push(k_(u.serializer,e))});n.done()}).next(function(){return c})},P_.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var a=this,s=new Jm(jg),n=[];return e.forEach(function(o){var e=Tw.prefixForPath(a.userId,o.path),e=IDBKeyRange.lowerBound(e),e=F_(t).iterate({range:e},function(e,t,n){var r=e[0],i=e[1],e=e[2],i=__(i);r===a.userId&&o.path.isEqual(i)?s=s.add(e):n.done()});n.push(e)}),i_.waitFor(n).next(function(){return a.lookupMutationBatches(t,s)})},P_.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var o=this;Mg(!nm(t),"Document queries shouldn't go down this path"),Mg(!rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");var a=t.path,s=a.length+1,t=Tw.prefixForPath(this.userId,a),t=IDBKeyRange.lowerBound(t),u=new Jm(jg);return F_(e).iterate({range:t},function(e,t,n){var r=e[0],i=e[1],e=e[2],i=__(i);r===o.userId&&a.isPrefixOf(i)?i.length===s&&(u=u.add(e)):n.done()}).next(function(){return o.lookupMutationBatches(e,u)})},P_.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(M_(e).get(t).next(function(e){if(null===e)throw xg("Dangling document-mutation reference found, which points to "+t);Lg(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(k_(n.serializer,e))}))}),i_.waitFor(i).next(function(){return r})},P_.prototype.removeMutationBatch=function(t,n){var r=this;return L_(t.simpleDbTransaction,this.userId,n).next(function(e){return t.addOnCommittedListener(function(){r.removeCachedMutationKeys(n.batchId)}),i_.forEach(e,function(e){return r.referenceDelegate.markPotentiallyOrphaned(t,e)})})},P_.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},P_.prototype.performConsistencyCheck=function(t){var i=this;return this.checkEmpty(t).next(function(e){if(!e)return i_.resolve();var e=IDBKeyRange.lowerBound(Tw.prefixForUser(i.userId)),r=[];return F_(t).iterate({range:e},function(e,t,n){e[0]===i.userId?(e=__(e[1]),r.push(e)):n.done()}).next(function(){Lg(0===r.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+r.map(function(e){return e.canonicalString()}))})})},P_.prototype.containsKey=function(e,t){return x_(e,this.userId,t)},P_.prototype.getMutationQueueMetadata=function(e){var t=this;return U_(e).get(this.userId).next(function(e){return e||new ww(t.userId,Jb,"")})},P_);function P_(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}function x_(e,o,t){var a=(t=Tw.prefixForPath(o,t.path))[1],t=IDBKeyRange.lowerBound(t),s=!1;return F_(e).iterate({range:t,keysOnly:!0},function(e,t,n){var r=e[0],i=e[1];e[2],r===o&&i===a&&(s=!0),n.done()}).next(function(){return s})}function L_(e,t,n){var r=e.store(Ew.store),i=e.store(Tw.store),o=[],e=IDBKeyRange.only(n.batchId),a=0,e=r.iterate({range:e},function(e,t,n){return a++,n.delete()});o.push(e.next(function(){Lg(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var s=[],u=0,c=n.mutations;u<c.length;u++){var l=c[u],h=Tw.key(t,l.key.path,n.batchId);o.push(i.delete(h)),s.push(l.key)}return i_.waitFor(o).next(function(){return s})}function M_(e){return gE.getStore(e,Ew.store)}function F_(e){return gE.getStore(e,Tw.store)}function U_(e){return gE.getStore(e,ww.store)}function q_(){this.changes=new n_(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}q_.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?(Mg(!!t.readTime,"Read time is not set for "+e+". All removeEntry() calls must include a readTime if 'trackRemovals' is used."),t.readTime):Bm.min()},q_.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{maybeDocument:e,readTime:t})},q_.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{maybeDocument:null,readTime:t})},q_.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?i_.resolve(n.maybeDocument):this.getFromCache(e,t)},q_.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},q_.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},q_.prototype.assertNotApplied=function(){Mg(!this.changesApplied,"Changes have already been applied.")},fe=q_;var j_=(V_.prototype.addEntry=function(e,t,n){return H_(e).put(G_(t),n)},V_.prototype.removeEntry=function(e,t){return e=H_(e),t=G_(t),e.delete(t)},V_.prototype.updateMetadata=function(t,n){var r=this;return this.getMetadata(t).next(function(e){return e.byteSize+=n,r.setMetadata(t,e)})},V_.prototype.getEntry=function(e,t){var n=this;return H_(e).get(G_(t)).next(function(e){return n.maybeDecodeDocument(e)})},V_.prototype.getSizedEntry=function(e,t){var n=this;return H_(e).get(G_(t)).next(function(e){var t=n.maybeDecodeDocument(e);return t?{maybeDocument:t,size:Q_(e)}:null})},V_.prototype.getEntries=function(e,t){var n=this,r=tv;return this.forEachDbEntry(e,t,function(e,t){t=n.maybeDecodeDocument(t),r=r.insert(e,t)}).next(function(){return r})},V_.prototype.getSizedEntries=function(e,t){var r=this,i=tv,o=new Wm(cy.comparator);return this.forEachDbEntry(e,t,function(e,t){var n=r.maybeDecodeDocument(t);o=n?(i=i.insert(e,n),o.insert(e,Q_(t))):(i=i.insert(e,null),o.insert(e,0))}).next(function(){return{maybeDocuments:i,sizeMap:o}})},V_.prototype.forEachDbEntry=function(e,t,i){if(t.isEmpty())return i_.resolve();var n=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),o=t.getIterator(),a=o.getNext();return H_(e).iterate({range:n},function(e,t,n){for(var r=cy.fromSegments(e);a&&cy.comparator(a,r)<0;)i(a,null),a=o.getNext();a&&a.isEqual(r)&&(i(a,t),a=o.hasNext()?o.getNext():null),a?n.skip(a.path.toArray()):n.done()}).next(function(){for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})},V_.prototype.getDocumentsMatchingQuery=function(e,r,t){var i=this;Mg(!rm(r),"CollectionGroup queries should be handled in LocalDocumentsView");var n,o=nv,a=r.path.length+1,s={};return t.isEqual(Bm.min())?(n=r.path.toArray(),s.range=IDBKeyRange.lowerBound(n)):(n=r.path.toArray(),t=I_(t),s.range=IDBKeyRange.lowerBound([n,t],!0),s.index=Aw.collectionReadTimeIndex),H_(e).iterate(s,function(e,t,n){e.length===a&&(t=E_(i.serializer,t),r.path.isPrefixOf(t.key.path)?t instanceof My&&lm(r,t)&&(o=o.insert(t.key,t)):n.done())}).next(function(){return o})},V_.prototype.newChangeBuffer=function(e){return new K_(this,!!e&&e.trackRemovals)},V_.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},V_.prototype.getMetadata=function(e){return z_(e).get(kw.key).next(function(e){return Lg(!!e,"Missing document cache metadata"),e})},V_.prototype.setMetadata=function(e,t){return z_(e).put(kw.key,t)},V_.prototype.maybeDecodeDocument=function(e){return!e||(e=E_(this.serializer,e))instanceof qy&&e.version.isEqual(Bm.min())?null:e},V_);function V_(e,t){this.serializer=e,this.indexManager=t}var B_,K_=(fo(W_,B_=fe),W_.prototype.applyChanges=function(i){var o=this,a=[],s=0,u=new Jm(function(e,t){return jg(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(e,t){var n,r=o.documentSizes.get(e);Mg(void 0!==r,"Cannot modify a document that wasn't read (for "+e+")"),t.maybeDocument?(Mg(!o.getReadTime(e).isEqual(Bm.min()),"Cannot add a document with a read time of zero"),n=T_(o.documentCache.serializer,t.maybeDocument,o.getReadTime(e)),u=u.add(e.path.popLast()),t=Q_(n),s+=t-r,a.push(o.documentCache.addEntry(i,e,n))):(s-=r,o.trackRemovals?(r=T_(o.documentCache.serializer,new qy(e,Bm.min()),o.getReadTime(e)),a.push(o.documentCache.addEntry(i,e,r))):a.push(o.documentCache.removeEntry(i,e)))}),u.forEach(function(e){a.push(o.documentCache.indexManager.addToCollectionParentIndex(i,e))}),a.push(this.documentCache.updateMetadata(i,s)),i_.waitFor(a)},W_.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next(function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)})},W_.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next(function(e){var t=e.maybeDocuments;return e.sizeMap.forEach(function(e,t){n.documentSizes.set(e,t)}),t})},W_);function W_(e,t){var n=B_.call(this)||this;return n.documentCache=e,n.trackRemovals=t,n.documentSizes=new n_(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),n}function z_(e){return gE.getStore(e,kw.store)}function H_(e){return gE.getStore(e,Aw.store)}function G_(e){return e.path.toArray()}function Q_(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw xg("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var Y_=(X_.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),i_.resolve()},X_.prototype.getCollectionParents=function(e,t){return i_.resolve(this.collectionParentIndex.getEntries(t))},X_);function X_(){this.collectionParentIndex=new J_}var J_=($_.prototype.add=function(e){Mg(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Jm(ry.comparator),e=!r.has(n);return this.index[t]=r.add(n),e},$_.prototype.has=function(e){var t=e.lastSegment(),e=e.popLast();return(t=this.index[t])&&t.has(e)},$_.prototype.getEntries=function(e){return(this.index[e]||new Jm(ry.comparator)).toArray()},$_);function $_(){this.index={}}var Z_=function(){var n=this;this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})},ew="SimpleDb",tw=(nw.delete=function(e){return Dg(ew,"Removing database:",e),pw(window.indexedDB.deleteDatabase(e)).toPromise()},nw.isAvailable=function(){if("undefined"==typeof indexedDB)return!1;if(nw.isMockPersistence())return!0;var e=Ro(),t=0<(n=nw.getIOSVersion(e))&&n<10,n=0<(n=nw.getAndroidVersion(e))&&n<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||t||n)},nw.isMockPersistence=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},nw.getStore=function(e,t){return e.store(t)},nw.getIOSVersion=function(e){return e=(e=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?e[1].split("_").slice(0,2).join("."):"-1",Number(e)},nw.getAndroidVersion=function(e){return e=(e=e.match(/Android ([\d.]+)/i))?e[1].split(".").slice(0,2).join("."):"-1",Number(e)},nw.prototype.ensureDb=function(o){return go(this,void 0,void 0,function(){var t,i=this;return yo(this,function(e){switch(e.label){case 0:return this.db?[3,2]:(Dg(ew,"Opening database:",this.name),t=this,[4,new Promise(function(t,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(e){e=e.target.result,t(e)},r.onblocked=function(){n(new aw(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(e){"VersionError"===(e=e.target.error).name?n(new Sg(Ig.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new aw(o,e))},r.onupgradeneeded=function(e){Dg(ew,'Database "'+i.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;i.schemaConverter.createOrUpgrade(t,r.transaction,e.oldVersion,i.version).next(function(){Dg(ew,"Database upgrade to version "+i.version+" complete")})}})]);case 1:t.db=e.sent(),e.label=2;case 2:return this.versionchangelistener&&(this.db.onversionchange=function(e){return i.versionchangelistener(e)}),[2,this.db]}})})},nw.prototype.setVersionChangeListener=function(t){this.versionchangelistener=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},nw.prototype.runTransaction=function(s,n,u,c){return go(this,void 0,void 0,function(){var i,o,a,t;return yo(this,function(e){switch(e.label){case 0:i="readonly"===n,o=0,t=function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:++o,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,a.ensureDb(s)];case 2:return a.db=e.sent(),t=cw.open(a.db,s,i?"readonly":"readwrite",u),(r=c(t).catch(function(e){return t.abort(e),i_.reject(e)}).toPromise()).catch(function(){}),[4,t.completionPromise];case 3:return e.sent(),[2,{value:r}];case 4:return n=e.sent(),r="FirebaseError"!==n.name&&o<3,Dg(ew,"Transaction failed with error:",n.message,"Retrying:",r),a.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},a=this,e.label=1;case 1:return[5,t()];case 2:return"object"==typeof(t=e.sent())?[2,t.value]:[3,1];case 3:return[2]}})})},nw.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},nw);function nw(e,t,n){this.name=e,this.version=t,this.schemaConverter=n,Mg(nw.isAvailable(),"IndexedDB not supported in current environment."),12.2===nw.getIOSVersion(Ro())&&Rg("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}var rw=(Object.defineProperty(iw.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!1,configurable:!0}),iw.prototype.done=function(){this.shouldStop=!0},iw.prototype.skip=function(e){this.nextKey=e},iw.prototype.delete=function(){return pw(this.dbCursor.delete())},iw);function iw(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}var ow,aw=(fo(sw,ow=Sg),sw);function sw(e,t){return(t=ow.call(this,Ig.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+t)||this).name="IndexedDbTransactionError",t}function uw(e){return"IndexedDbTransactionError"===e.name}var cw=(lw.open=function(e,t,n,r){try{return new lw(t,e.transaction(r,n))}catch(e){throw new aw(t,e)}},Object.defineProperty(lw.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!1,configurable:!0}),lw.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(Dg(ew,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},lw.prototype.store=function(e){var t=this.transaction.objectStore(e);return Mg(!!t,"Object store not part of transaction: "+e),new hw(t)},lw);function lw(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.completionDeferred=new Z_,this.transaction.oncomplete=function(){n.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?n.completionDeferred.reject(new aw(t,e.error)):n.completionDeferred.resolve()},this.transaction.onerror=function(e){e=gw(e.target.error),n.completionDeferred.reject(new aw(t,e))}}var hw=(fw.prototype.put=function(e,t){return pw(e=void 0!==t?(Dg(ew,"PUT",this.store.name,e,t),this.store.put(t,e)):(Dg(ew,"PUT",this.store.name,"<auto-key>",e),this.store.put(e)))},fw.prototype.add=function(e){return Dg(ew,"ADD",this.store.name,e,e),pw(this.store.add(e))},fw.prototype.get=function(t){var n=this;return pw(this.store.get(t)).next(function(e){return void 0===e&&(e=null),Dg(ew,"GET",n.store.name,t,e),e})},fw.prototype.delete=function(e){return Dg(ew,"DELETE",this.store.name,e),pw(this.store.delete(e))},fw.prototype.count=function(){return Dg(ew,"COUNT",this.store.name),pw(this.store.count())},fw.prototype.loadAll=function(e,t){var t=this.cursor(this.options(e,t)),n=[];return this.iterateCursor(t,function(e,t){n.push(t)}).next(function(){return n})},fw.prototype.deleteAll=function(e,t){return Dg(ew,"DELETE ALL",this.store.name),(t=this.options(e,t)).keysOnly=!1,t=this.cursor(t),this.iterateCursor(t,function(e,t,n){return n.delete()})},fw.prototype.iterate=function(e,t){t?n=e:(n={},t=e);var n=this.cursor(n);return this.iterateCursor(n,t)},fw.prototype.iterateSerial=function(r){var e=this.cursor({});return new i_(function(n,t){e.onerror=function(e){e=gw(e.target.error),t(e)},e.onsuccess=function(e){var t=e.target.result;t?r(t.primaryKey,t.value).next(function(e){e?t.continue():n()}):n()}})},fw.prototype.iterateCursor=function(e,i){var o=[];return new i_(function(r,t){e.onerror=function(e){t(e.target.error)},e.onsuccess=function(e){var t,n=e.target.result;n?(t=new rw(n),(e=i(n.primaryKey,n.value,t))instanceof i_&&(e=e.catch(function(e){return t.done(),i_.reject(e)}),o.push(e)),t.isDone?r():null===t.skipToKey?n.continue():n.continue(t.skipToKey)):r()}}).next(function(){return i_.waitFor(o)})},fw.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(Mg(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},fw.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},fw);function fw(e){this.store=e}function pw(e){return new i_(function(t,n){e.onsuccess=function(e){e=e.target.result,t(e)},e.onerror=function(e){e=gw(e.target.error),n(e)}})}var dw=!1;function gw(e){var t=tw.getIOSVersion(Ro());if(12.2<=t&&t<13&&(t="An internal error was encountered in the Indexed Database server",0<=e.message.indexOf(t))){var n=new Sg("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+t+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return dw||(dw=!0,setTimeout(function(){throw n},0)),n}return e}var yw=11,mw=(vw.prototype.createOrUpgrade=function(t,n,e,r){var i=this;Lg(e<r&&0<=e&&r<=yw,"Unexpected schema upgrade from v"+e+" to v"+r+".");var o=new cw("createOrUpgrade",n);e<1&&1<=r&&(t.createObjectStore(_w.store),(a=t).createObjectStore(ww.store,{keyPath:ww.keyPath}),a.createObjectStore(Ew.store,{keyPath:Ew.keyPath,autoIncrement:!0}).createIndex(Ew.userMutationsIndex,Ew.userMutationsKeyPath,{unique:!0}),a.createObjectStore(Tw.store),Pw(t),t.createObjectStore(Aw.store));var a,s=i_.resolve();return e<3&&3<=r&&(0!==e&&((a=t).deleteObjectStore(Dw.store),a.deleteObjectStore(Nw.store),a.deleteObjectStore(Rw.store),Pw(t)),s=s.next(function(){return t=(e=o).store(Rw.store),e=new Rw(0,0,Bm.min().toTimestamp(),0),t.put(Rw.key,e);var e,t})),e<4&&4<=r&&(0!==e&&(s=s.next(function(){return n=t,(r=o).store(Ew.store).loadAll().next(function(e){n.deleteObjectStore(Ew.store),n.createObjectStore(Ew.store,{keyPath:Ew.keyPath,autoIncrement:!0}).createIndex(Ew.userMutationsIndex,Ew.userMutationsKeyPath,{unique:!0});var t=r.store(Ew.store),e=e.map(function(e){return t.put(e)});return i_.waitFor(e)});var n,r})),s=s.next(function(){t.createObjectStore(xw.store,{keyPath:xw.keyPath})})),e<5&&5<=r&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),e<6&&6<=r&&(s=s.next(function(){return t.createObjectStore(kw.store),i.addDocumentGlobal(o)})),e<7&&7<=r&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),e<8&&8<=r&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),e<9&&9<=r&&(s=s.next(function(){var e;(e=t).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(e=(e=n).objectStore(Aw.store)).createIndex(Aw.readTimeIndex,Aw.readTimeIndexPath,{unique:!1}),e.createIndex(Aw.collectionReadTimeIndex,Aw.collectionReadTimeIndexPath,{unique:!1})})),e<10&&10<=r&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),e<11&&11<=r&&(s=s.next(function(){t.createObjectStore(Lw.store,{keyPath:Lw.keyPath}),t.createObjectStore(Mw.store,{keyPath:Mw.keyPath})})),s},vw.prototype.addDocumentGlobal=function(t){var n=0;return t.store(Aw.store).iterate(function(e,t){n+=Q_(t)}).next(function(){var e=new kw(n);return t.store(kw.store).put(kw.key,e)})},vw.prototype.removeAcknowledgedMutations=function(n){var r=this,e=n.store(ww.store),i=n.store(Ew.store);return e.loadAll().next(function(e){return i_.forEach(e,function(t){var e=IDBKeyRange.bound([t.userId,Jb],[t.userId,t.lastAcknowledgedBatchId]);return i.loadAll(Ew.userMutationsIndex,e).next(function(e){return i_.forEach(e,function(e){return Lg(e.userId===t.userId,"Cannot process batch "+e.batchId+" from unexpected user"),e=k_(r.serializer,e),L_(n,t.userId,e).next(function(){})})})})})},vw.prototype.ensureSequenceNumbers=function(e){var o=e.store(Dw.store),t=e.store(Aw.store);return e.store(Rw.store).get(Rw.key).next(function(r){Mg(!!r,"Metadata should have been written during the version 3 migration");var i=[];return t.iterate(function(e,t){var n=new ry(e),e=[0,v_(n)];i.push(o.get(e).next(function(e){return e?i_.resolve():(e=n,o.put(new Dw(0,v_(e),r.highestListenSequenceNumber)))}))}).next(function(){return i_.waitFor(i)})})},vw.prototype.createCollectionParentIndex=function(e,t){function r(e){if(i.add(e)){var t=e.lastSegment(),e=e.popLast();return n.put({collectionId:t,parent:v_(e)})}}e.createObjectStore(Ow.store,{keyPath:Ow.keyPath});var n=t.store(Ow.store),i=new J_;return t.store(Aw.store).iterate({keysOnly:!0},function(e,t){return r((e=new ry(e)).popLast())}).next(function(){return t.store(Tw.store).iterate({keysOnly:!0},function(e,t){e[0];var n=e[1];return r((n=(e[2],__(n))).popLast())})})},vw.prototype.rewriteCanonicalIds=function(e){var n=this,r=e.store(Nw.store);return r.iterate(function(e,t){return t=N_(t),t=D_(n.serializer,t),r.put(t)})},vw);function vw(e){this.serializer=e}var bw=function(e,t){this.seconds=e,this.nanoseconds=t},_w=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};_w.store="owner",_w.key="owner";var ww=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};ww.store="mutationQueues",ww.keyPath="userId";var Ew=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ew.store="mutations",Ew.keyPath="batchId",Ew.userMutationsIndex="userMutationsIndex",Ew.userMutationsKeyPath=["userId","batchId"];var Tw=(Iw.prefixForUser=function(e){return[e]},Iw.prefixForPath=function(e,t){return[e,v_(t)]},Iw.key=function(e,t,n){return[e,v_(t),n]},Iw);function Iw(){}Tw.store="documentMutations",Tw.PLACEHOLDER=new Tw;var Sw=function(e,t){this.path=e,this.readTime=t},Cw=function(e,t){this.path=e,this.version=t},Aw=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Aw.store="remoteDocuments",Aw.readTimeIndex="readTimeIndex",Aw.readTimeIndexPath="readTime",Aw.collectionReadTimeIndex="collectionReadTimeIndex",Aw.collectionReadTimeIndexPath=["parentPath","readTime"];var kw=function(e){this.byteSize=e};kw.store="remoteDocumentGlobal",kw.key="remoteDocumentGlobalKey";var Nw=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Nw.store="targets",Nw.keyPath="targetId",Nw.queryTargetsIndexName="queryTargetsIndex",Nw.queryTargetsKeyPath=["canonicalId","targetId"];var Dw=function(e,t,n){this.targetId=e,this.path=t,Mg(0===e==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")};Dw.store="targetDocuments",Dw.keyPath=["targetId","path"],Dw.documentTargetsIndex="documentTargetsIndex",Dw.documentTargetsKeyPath=["path","targetId"];var Rw=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Rw.key="targetGlobalKey",Rw.store="targetGlobal";var Ow=function(e,t){this.collectionId=e,this.parent=t};function Pw(e){e.createObjectStore(Dw.store,{keyPath:Dw.keyPath}).createIndex(Dw.documentTargetsIndex,Dw.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Nw.store,{keyPath:Nw.keyPath}).createIndex(Nw.queryTargetsIndexName,Nw.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Rw.store)}Ow.store="collectionParents",Ow.keyPath=["collectionId","parent"];var xw=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};xw.store="clientMetadata",xw.keyPath="clientId";var Lw=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};Lw.store="bundles",Lw.keyPath="bundleId";var Mw=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};Mw.store="namedQueries",Mw.keyPath="name";var Hn=_o([ww.store,Ew.store,Tw.store,Aw.store,Nw.store,_w.store,Rw.store,Dw.store],[xw.store]),Hn=_o(Hn,[kw.store]),Hn=_o(Hn,[Ow.store]),Fw=_o(Hn,[Lw.store,Mw.store]),Uw=(qw.prototype.getBundleMetadata=function(e,t){return jw(e).get(t).next(function(e){if(e)return{id:e.bundleId,createTime:A_(e.createTime),version:e.version}})},qw.prototype.saveBundleMetadata=function(e,t){return jw(e).put({bundleId:t.id,createTime:C_(Fv(t.createTime)),version:t.version})},qw.prototype.getNamedQuery=function(e,t){return Vw(e).get(t).next(function(e){if(e)return{name:e.name,query:R_(e.bundledQuery),readTime:A_(e.readTime)}})},qw.prototype.saveNamedQuery=function(e,t){return Vw(e).put({name:t.name,readTime:C_(Fv(t.readTime)),bundledQuery:t.bundledQuery})},qw);function qw(e){this.serializer=e}function jw(e){return gE.getStore(e,Lw.store)}function Vw(e){return gE.getStore(e,Mw.store)}var Bw=(Kw.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(Mg(t.length%2==1,"Expected a collection path."),this.collectionParentsCache.has(t))return i_.resolve();var r=t.lastSegment(),i=t.popLast();return e.addOnCommittedListener(function(){n.collectionParentsCache.add(t)}),i={collectionId:r,parent:v_(i)},Ww(e).put(i)},Kw.prototype.getCollectionParents=function(e,i){var o=[],t=IDBKeyRange.bound([i,""],[Bg(i),""],!1,!0);return Ww(e).loadAll(t).next(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.collectionId!==i)break;o.push(__(r.parent))}return o})},Kw);function Kw(){this.collectionParentsCache=new J_}function Ww(e){return gE.getStore(e,Ow.store)}var zw=(Hw.prototype.next=function(){return this.lastId+=2,this.lastId},Hw.forTargetCache=function(){return new Hw(0)},Hw.forSyncEngine=function(){return new Hw(-1)},Hw);function Hw(e){this.lastId=e}var Gw=(Qw.prototype.allocateTargetId=function(n){var r=this;return this.retrieveMetadata(n).next(function(e){var t=new zw(e.highestTargetId);return e.highestTargetId=t.next(),r.saveMetadata(n,e).next(function(){return e.highestTargetId})})},Qw.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next(function(e){return Bm.fromTimestamp(new Wg(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},Qw.prototype.getHighestSequenceNumber=function(e){return this.retrieveMetadata(e).next(function(e){return e.highestListenSequenceNumber})},Qw.prototype.setTargetsMetadata=function(t,n,r){var i=this;return this.retrieveMetadata(t).next(function(e){return e.highestListenSequenceNumber=n,r&&(e.lastRemoteSnapshotVersion=r.toTimestamp()),n>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=n),i.saveMetadata(t,e)})},Qw.prototype.addTargetData=function(t,n){var r=this;return this.saveTargetData(t,n).next(function(){return r.retrieveMetadata(t).next(function(e){return e.targetCount+=1,r.updateMetadataFromTargetData(n,e),r.saveMetadata(t,e)})})},Qw.prototype.updateTargetData=function(e,t){return this.saveTargetData(e,t)},Qw.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Yw(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return Lg(0<e.targetCount,"Removing from an empty target cache"),--e.targetCount,n.saveMetadata(t,e)})},Qw.prototype.removeTargets=function(n,r,i){var o=this,a=0,s=[];return Yw(n).iterate(function(e,t){(t=N_(t)).sequenceNumber<=r&&null===i.get(t.targetId)&&(a++,s.push(o.removeTargetData(n,t)))}).next(function(){return i_.waitFor(s)}).next(function(){return a})},Qw.prototype.forEachTarget=function(e,n){return Yw(e).iterate(function(e,t){t=N_(t),n(t)})},Qw.prototype.retrieveMetadata=function(e){return Xw(e).get(Rw.key).next(function(e){return Lg(null!==e,"Missing metadata row."),e})},Qw.prototype.saveMetadata=function(e,t){return Xw(e).put(Rw.key,t)},Qw.prototype.saveTargetData=function(e,t){return Yw(e).put(D_(this.serializer,t))},Qw.prototype.updateMetadataFromTargetData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},Qw.prototype.getTargetCount=function(e){return this.retrieveMetadata(e).next(function(e){return e.targetCount})},Qw.prototype.getTargetData=function(e,r){var t=Hy(r),t=IDBKeyRange.bound([t,Number.NEGATIVE_INFINITY],[t,Number.POSITIVE_INFINITY]),i=null;return Yw(e).iterate({range:t,index:Nw.queryTargetsIndexName},function(e,t,n){t=N_(t),Gy(r,t.target)&&(i=t,n.done())}).next(function(){return i})},Qw.prototype.addMatchingKeys=function(n,e,r){var i=this,o=[],a=Jw(n);return e.forEach(function(e){var t=v_(e.path);o.push(a.put(new Dw(r,t))),o.push(i.referenceDelegate.addReference(n,r,e))}),i_.waitFor(o)},Qw.prototype.removeMatchingKeys=function(n,e,r){var i=this,o=Jw(n);return i_.forEach(e,function(e){var t=v_(e.path);return i_.waitFor([o.delete([r,t]),i.referenceDelegate.removeReference(n,r,e)])})},Qw.prototype.removeMatchingKeysForTargetId=function(e,t){return e=Jw(e),t=IDBKeyRange.bound([t],[t+1],!1,!0),e.delete(t)},Qw.prototype.getMatchingKeysForTargetId=function(e,t){var t=IDBKeyRange.bound([t],[t+1],!1,!0),e=Jw(e),r=ov();return e.iterate({range:t,keysOnly:!0},function(e,t,n){e=__(e[1]),e=new cy(e),r=r.add(e)}).next(function(){return r})},Qw.prototype.containsKey=function(e,t){var t=v_(t.path),t=IDBKeyRange.bound([t],[Bg(t)],!1,!0),i=0;return Jw(e).iterate({index:Dw.documentTargetsIndex,keysOnly:!0,range:t},function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Qw.prototype.getTargetDataForTarget=function(e,t){return Yw(e).get(t).next(function(e){return e?N_(e):null})},Qw);function Qw(e,t){this.referenceDelegate=e,this.serializer=t}function Yw(e){return gE.getStore(e,Nw.store)}function Xw(e){return gE.getStore(e,Rw.store)}function Jw(e){return gE.getStore(e,Dw.store)}function $w(e,t){var n=e[0],r=e[1],e=t[0],t=t[1];return 0===(e=jg(n,e))?jg(r,t):e}var Zw=(eE.prototype.nextIndex=function(){return++this.previousIndex},eE.prototype.addElement=function(e){var t=[e,this.nextIndex()];this.buffer.size<this.maxElements?this.buffer=this.buffer.add(t):$w(t,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(t))},Object.defineProperty(eE.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),eE);function eE(e){this.maxElements=e,this.buffer=new Jm($w),this.previousIndex=0}var tE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nE=(rE.withCacheSize=function(e){return new rE(e,rE.DEFAULT_COLLECTION_PERCENTILE,rE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},rE);function rE(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}nE.DEFAULT_COLLECTION_PERCENTILE=10,nE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nE.DEFAULT=new nE(41943040,nE.DEFAULT_COLLECTION_PERCENTILE,nE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nE.DISABLED=new nE(-1,0,0);var iE=(oE.prototype.start=function(e){Mg(null===this.gcTask,"Cannot start an already started LruScheduler"),-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.scheduleGC(e)},oE.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(oE.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!1,configurable:!0}),oE.prototype.scheduleGC=function(n){var e=this;Mg(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;Dg("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:this.gcTask=null,this.hasRun=!0,e.label=1;case 1:return e.trys.push([1,3,,7]),[4,n.collectGarbage(this.garbageCollector)];case 2:return e.sent(),[3,7];case 3:return uw(t=e.sent())?(Dg("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,FE(t)];case 5:e.sent(),e.label=6;case 6:return[3,7];case 7:return[4,this.scheduleGC(n)];case 8:return e.sent(),[2]}})})})},oE);function oE(e,t){this.garbageCollector=e,this.asyncQueue=t,this.hasRun=!1,this.gcTask=null}var aE=(sE.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next(function(e){return Math.floor(t/100*e)})},sE.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return i_.resolve(f_.INVALID);var r=new Zw(t);return this.delegate.forEachTarget(e,function(e){return r.addElement(e.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,function(e){return r.addElement(e)})}).next(function(){return r.maxValue})},sE.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},sE.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},sE.prototype.collect=function(t,n){var r=this;return-1===this.params.cacheSizeCollectionThreshold?(Dg("LruGarbageCollector","Garbage collection skipped; disabled"),i_.resolve(tE)):this.getCacheSize(t).next(function(e){return e<r.params.cacheSizeCollectionThreshold?(Dg("LruGarbageCollector","Garbage collection skipped; Cache size "+e+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),tE):r.runGarbageCollection(t,n)})},sE.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},sE.prototype.runGarbageCollection=function(t,n){var r,i,o,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return i=e>l.params.maximumSequenceNumbersToCollect?(Dg("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),l.params.maximumSequenceNumbersToCollect):e,a=Date.now(),l.nthSequenceNumber(t,i)}).next(function(e){return r=e,s=Date.now(),l.removeTargets(t,r,n)}).next(function(e){return o=e,u=Date.now(),l.removeOrphanedDocuments(t,r)}).next(function(e){return c=Date.now(),Ng()<=Ta.DEBUG&&Dg("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+i+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+e+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),i_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:e})})},sE);function sE(e,t){this.delegate=e,this.params=t}var uE,cE="IndexedDbPersistence",lE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hE="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",fE="main",pE=(fo(dE,uE=he),dE);function dE(e,t){var n=uE.call(this)||this;return n.simpleDbTransaction=e,n.currentSequenceNumber=t,n}var gE=(yE.getStore=function(e,t){if(e instanceof pE)return tw.getStore(e.simpleDbTransaction,t);throw xg("IndexedDbPersistence must use instances of IndexedDbTransaction")},yE.prototype.start=function(){var t=this;return Mg(!this.started,"IndexedDbPersistence double-started!"),Mg(null!==this.window,"Expected 'window' to be defined"),this.updateClientMetadataAndTryBecomePrimary().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Sg(Ig.FAILED_PRECONDITION,lE);return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.targetCache.getHighestSequenceNumber(e)})}).then(function(e){t.listenSequence=new f_(e,t.sequenceNumberSyncer)}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},yE.prototype.setPrimaryStateListener=function(n){var e=this;return this.primaryStateListener=function(t){return go(e,void 0,void 0,function(){return yo(this,function(e){return this.started?[2,n(t)]:[2]})})},n(this.isPrimary)},yE.prototype.setDatabaseDeletedListener=function(n){var e=this;this.simpleDb.setVersionChangeListener(function(t){return go(e,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return null!==t.newVersion?[3,2]:[4,n()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},yE.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(function(){return go(t,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},yE.prototype.updateClientMetadataAndTryBecomePrimary=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return vE(t).put(new xw(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.verifyPrimaryLease(t).next(function(e){e||(n.isPrimary=!1,n.queue.enqueueRetryable(function(){return n.primaryStateListener(!1)}))})}).next(function(){return n.canActAsPrimary(t)}).next(function(e){return n.isPrimary&&!e?n.releasePrimaryLeaseIfHeld(t).next(function(){return!1}):!!e&&n.acquireOrExtendPrimaryLease(t).next(function(){return!0})})}).catch(function(e){if(uw(e))return Dg(cE,"Failed to extend owner lease: ",e),n.isPrimary;if(!n.allowTabSynchronization)throw e;return Dg(cE,"Releasing owner lease after error during lease refresh",e),!1}).then(function(e){n.isPrimary!==e&&n.queue.enqueueRetryable(function(){return n.primaryStateListener(e)}),n.isPrimary=e})},yE.prototype.verifyPrimaryLease=function(e){var t=this;return mE(e).get(_w.key).next(function(e){return i_.resolve(t.isLocalClient(e))})},yE.prototype.removeClientMetadata=function(e){return vE(e).delete(this.clientId)},yE.prototype.maybeGarbageCollectMultiClientState=function(){return go(this,void 0,void 0,function(){var t,n,r,i,o=this;return yo(this,function(e){switch(e.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var r=yE.getStore(e,xw.store);return r.loadAll().next(function(e){var t=o.filterActiveClients(e,18e5),n=e.filter(function(e){return-1===t.indexOf(e)});return i_.forEach(n,function(e){return r.delete(e.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(t=e.sent(),this.webStorage)for(n=0,r=t;n<r.length;n++)i=r[n],this.webStorage.removeItem(this.zombiedClientLocalStorageKey(i.clientId));e.label=2;case 2:return[2]}})})},yE.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.maybeGarbageCollectMultiClientState()}).then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},yE.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},yE.prototype.canActAsPrimary=function(t){var r=this;return this.forceOwningTab?i_.resolve(!0):mE(t).get(_w.key).next(function(e){if(null!==e&&r.isWithinAge(e.leaseTimestampMs,5e3)&&!r.isClientZombied(e.ownerId)){if(r.isLocalClient(e)&&r.networkEnabled)return!0;if(!r.isLocalClient(e)){if(!e.allowTabSynchronization)throw new Sg(Ig.FAILED_PRECONDITION,lE);return!1}}return!(!r.networkEnabled||!r.inForeground)||vE(t).loadAll().next(function(e){return void 0===r.filterActiveClients(e,5e3).find(function(e){if(r.clientId!==e.clientId){var t=!r.networkEnabled&&e.networkEnabled,n=!r.inForeground&&e.inForeground,e=r.networkEnabled===e.networkEnabled;if(t||n&&e)return!0}return!1})})}).next(function(e){return r.isPrimary!==e&&Dg(cE,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},yE.prototype.shutdown=function(){return go(this,void 0,void 0,function(){var n=this;return yo(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("shutdown","readwrite",[_w.store,xw.store],function(e){var t=new pE(e,f_.INVALID);return n.releasePrimaryLeaseIfHeld(t).next(function(){return n.removeClientMetadata(t)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},yE.prototype.filterActiveClients=function(e,t){var n=this;return e.filter(function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)})},yE.prototype.getActiveClients=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return vE(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(e){return e.clientId})})})},Object.defineProperty(yE.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),yE.prototype.getMutationQueue=function(e){return Mg(this.started,"Cannot initialize MutationQueue before persistence is started."),O_.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},yE.prototype.getTargetCache=function(){return Mg(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},yE.prototype.getRemoteDocumentCache=function(){return Mg(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},yE.prototype.getIndexManager=function(){return Mg(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},yE.prototype.getBundleCache=function(){return Mg(this.started,"Cannot initialize BundleCache before persistence is started."),this.bundleCache},yE.prototype.runTransaction=function(t,n,r){var i=this;Dg(cE,"Starting transaction:",t);var o,e="readonly"===n?"readonly":"readwrite";return this.simpleDb.runTransaction(t,e,Fw,function(e){return o=new pE(e,i.listenSequence?i.listenSequence.next():f_.INVALID),"readwrite-primary"===n?i.verifyPrimaryLease(o).next(function(e){return!!e||i.canActAsPrimary(o)}).next(function(e){if(!e)throw Rg("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.queue.enqueueRetryable(function(){return i.primaryStateListener(!1)}),new Sg(Ig.FAILED_PRECONDITION,u_);return r(o)}).next(function(e){return i.acquireOrExtendPrimaryLease(o).next(function(){return e})}):i.verifyAllowTabSynchronization(o).next(function(){return r(o)})}).then(function(e){return o.raiseOnCommittedEvent(),e})},yE.prototype.verifyAllowTabSynchronization=function(e){var t=this;return mE(e).get(_w.key).next(function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!(t.forceOwningTab||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Sg(Ig.FAILED_PRECONDITION,lE)})},yE.prototype.acquireOrExtendPrimaryLease=function(e){var t=new _w(this.clientId,this.allowTabSynchronization,Date.now());return mE(e).put(_w.key,t)},yE.isAvailable=function(){return tw.isAvailable()},yE.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=mE(e);return n.get(_w.key).next(function(e){return t.isLocalClient(e)?(Dg(cE,"Releasing primary lease."),n.delete(_w.key)):i_.resolve()})},yE.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t||n<e&&(Rg("Detected an update time that is in the future: "+e+" > "+n),1))},yE.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},yE.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(Mg(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},yE.prototype.attachWindowUnloadHook=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},yE.prototype.detachWindowUnloadHook=function(){var e;this.windowUnloadHandler&&(Mg("function"==typeof(null===(e=this.window)||void 0===e?void 0:e.removeEventListener),"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},yE.prototype.isClientZombied=function(e){try{var t=null!==(null===(t=this.webStorage)||void 0===t?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)));return Dg(cE,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(e){return Rg(cE,"Failed to get zombied client id.",e),!1}},yE.prototype.markClientZombied=function(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){Rg("Failed to set zombie client id.",e)}},yE.prototype.removeClientZombiedEntry=function(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},yE.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},yE);function yE(e,t,n,r,i,o,a,s,u,c){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.queue=i,this.window=o,this.document=a,this.sequenceNumberSyncer=u,this.forceOwningTab=c,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},!yE.isAvailable())throw new Sg(Ig.UNIMPLEMENTED,hE);this.referenceDelegate=new bE(this,r),this.dbName=t+fE,this.serializer=new w_(s),this.simpleDb=new tw(this.dbName,yw,new mw(this.serializer)),this.targetCache=new Gw(this.referenceDelegate,this.serializer),this.indexManager=new Bw,this.remoteDocumentCache=(t=this.serializer,s=this.indexManager,new j_(t,s)),this.bundleCache=new Uw(this.serializer),this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===c&&Rg(cE,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function mE(e){return gE.getStore(e,_w.store)}function vE(e){return gE.getStore(e,xw.store)}var bE=(_E.prototype.getSequenceNumberCount=function(e){var n=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(function(t){return n.next(function(e){return t+e})})},_E.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},_E.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},_E.prototype.forEachOrphanedDocumentSequenceNumber=function(e,n){return this.forEachOrphanedDocument(e,function(e,t){return n(t)})},_E.prototype.addReference=function(e,t,n){return wE(e,n)},_E.prototype.removeReference=function(e,t,n){return wE(e,n)},_E.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},_E.prototype.markPotentiallyOrphaned=wE,_E.prototype.isPinned=function(e,t){return r=t,i=!1,U_(n=e).iterateSerial(function(e){return x_(n,e,r).next(function(e){return e&&(i=!0),i_.resolve(!e)})}).next(function(){return i});var n,r,i},_E.prototype.removeOrphanedDocuments=function(n,r){var i=this,o=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[],s=0;return this.forEachOrphanedDocument(n,function(t,e){e<=r&&(e=i.isPinned(n,t).next(function(e){if(!e)return s++,o.getEntry(n,t).next(function(){return o.removeEntry(t),Jw(n).delete([0,v_(t.path)])})}),a.push(e))}).next(function(){return i_.waitFor(a)}).next(function(){return o.apply(n)}).next(function(){return s})},_E.prototype.removeTarget=function(e,t){return t=t.withSequenceNumber(e.currentSequenceNumber),this.db.getTargetCache().updateTargetData(e,t)},_E.prototype.updateLimboDocument=wE,_E.prototype.forEachOrphanedDocument=function(e,r){var i,e=Jw(e),o=f_.INVALID;return e.iterate({index:Dw.documentTargetsIndex},function(e,t){var n=e[0],e=(e[1],t.path),t=t.sequenceNumber;0===n?(o!==f_.INVALID&&r(new cy(__(i)),o),o=t,i=e):o=f_.INVALID}).next(function(){o!==f_.INVALID&&r(new cy(__(i)),o)})},_E.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},_E);function _E(e,t){this.db=e,this.garbageCollector=new aE(this,t)}function wE(e,t){return Jw(e).put((e=e.currentSequenceNumber,new Dw(0,v_(t.path),e)))}function EE(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var TE="LocalStore",IE=3e8,SE=(CE.prototype.collectGarbage=function(t){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(e){return t.collect(e,n.targetDataByTarget)})},CE);function CE(e,t,n,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new Wm(jg),this.targetIdByTarget=new n_(Hy,Gy),this.lastDocumentChangeReadTime=Bm.min(),Mg(e.started,"LocalStore was passed an unstarted persistence implementation"),this.mutationQueue=e.getMutationQueue(n),this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.localDocuments=new a_(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.bundleCache=e.getBundleCache(),this.queryEngine.setLocalDocumentsView(this.localDocuments)}function AE(e,t,n,r){return new SE(e,t,n,r)}function kE(i,o){return go(this,void 0,void 0,function(){var t,n,y,r;return yo(this,function(e){switch(e.label){case 0:return t=Fg(i,SE),n=t.mutationQueue,y=t.localDocuments,[4,t.persistence.runTransaction("Handle user change","readonly",function(d){var g;return t.mutationQueue.getAllMutationBatches(d).next(function(e){return g=e,n=t.persistence.getMutationQueue(o),y=new a_(t.remoteDocuments,n,t.persistence.getIndexManager()),n.getAllMutationBatches(d)}).next(function(e){for(var t=[],n=[],r=ov(),i=0,o=g;i<o.length;i++){var a=o[i];t.push(a.batchId);for(var s=0,u=a.mutations;s<u.length;s++)var c=u[s],r=r.add(c.key)}for(var l=0,h=e;l<h.length;l++){a=h[l],n.push(a.batchId);for(var f=0,p=a.mutations;f<p.length;f++)c=p[f],r=r.add(c.key)}return y.getDocuments(d,r).next(function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:n}})})})];case 1:return r=e.sent(),t.mutationQueue=n,t.localDocuments=y,t.queryEngine.setLocalDocumentsView(t.localDocuments),[2,r]}})})}function NE(e,u){var c,l=Fg(e,SE),h=Wg.now(),t=u.reduce(function(e,t){return e.add(t.key)},ov());return l.persistence.runTransaction("Locally write mutations","readwrite",function(s){return l.localDocuments.getDocuments(s,t).next(function(e){c=e;for(var a,t=[],n=0,r=u;n<r.length;n++){var i=r[n],o=(a=i,o=c.get(i.key),a instanceof Vb?function(e){for(var t=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=e instanceof My?e.field(i.field):void 0;null!=(o=rb(i.transform,o||null))&&(t=(null==t?new cv:t).set(i.field,o))}return t?t.build():null}(o):null);null!=o&&t.push(new Fb(i.key,o,function a(e){var s=[];return Gg(e.fields||{},function(e,t){var n=new sy([e]);if(xy(t))if(0===(t=a(t.mapValue).fields).length)s.push(n);else for(var r=0,i=t;r<i.length;r++){var o=i[r];s.push(n.child(o))}else s.push(n)}),new _b(s)}(o.proto.mapValue),Sb.exists(!0)))}return l.mutationQueue.addMutationBatch(s,h,t,u)})}).then(function(e){var t=e.applyToLocalDocumentSet(c);return{batchId:e.batchId,changes:t}})}function DE(e){var t=Fg(e,SE);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)})}function RE(e,o){var l=Fg(e,SE),h=o.snapshotVersion,f=l.targetDataByTarget;return l.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var e=l.remoteDocuments.newChangeBuffer({trackRemovals:!0});f=l.targetDataByTarget;var s=[];o.targetChanges.forEach(function(e,t){var n,r,i,o=f.get(t);o&&(s.push(l.targetCache.removeMatchingKeys(a,e.removedDocuments,t).next(function(){return l.targetCache.addMatchingKeys(a,e.addedDocuments,t)})),0<(n=e.resumeToken).approximateByteSize()&&(n=o.withResumeToken(n,h).withSequenceNumber(a.currentSequenceNumber),f=f.insert(t,n),r=o,i=e,Lg(0<(o=n).resumeToken.approximateByteSize(),"Attempted to persist target data with no resume token"),0!==r.resumeToken.approximateByteSize()&&!(o.snapshotVersion.toMicroseconds()-r.snapshotVersion.toMicroseconds()>=IE||0<i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size)||s.push(l.targetCache.updateTargetData(a,n))))});var u,t,c,n,r,i=tv;return o.documentUpdates.forEach(function(e,t){o.resolvedLimboDocuments.has(e)&&s.push(l.persistence.referenceDelegate.updateLimboDocument(a,e))}),s.push((r=a,u=e,t=o.documentUpdates,c=h,n=ov(),t.forEach(function(e){return n=n.add(e)}),u.getEntries(r,n).next(function(i){var o=tv;return t.forEach(function(e,t){var n=i.get(e),r=c;t instanceof qy&&t.version.isEqual(Bm.min())?(u.removeEntry(e,r),o=o.insert(e,t)):null==n||0<t.version.compareTo(n.version)||0===t.version.compareTo(n.version)&&n.hasPendingWrites?(Mg(!Bm.min().isEqual(r),"Cannot add a document when the remote version is zero"),u.addEntry(t,r),o=o.insert(e,t)):Dg(TE,"Ignoring outdated watch update for ",e,". Current version:",n.version," Watch version:",t.version)}),o}).next(function(e){i=e}))),h.isEqual(Bm.min())||(r=l.targetCache.getLastRemoteSnapshotVersion(a).next(function(e){return Mg(0<=h.compareTo(e),"Watch stream reverted to previous snapshot?? "+h+" < "+e),l.targetCache.setTargetsMetadata(a,a.currentSequenceNumber,h)}),s.push(r)),i_.waitFor(s).next(function(){return e.apply(a)}).next(function(){return l.localDocuments.getLocalViewOfDocuments(a,i)})}).then(function(e){return l.targetDataByTarget=f,e})}function OE(e,r){var i=Fg(e,SE);return i.persistence.runTransaction("Allocate target","readwrite",function(t){var n;return i.targetCache.getTargetData(t,r).next(function(e){return e?(n=e,i_.resolve(n)):i.targetCache.allocateTargetId(t).next(function(e){return n=new l_(r,e,0,t.currentSequenceNumber),i.targetCache.addTargetData(t,n).next(function(){return n})})})}).then(function(e){var t=i.targetDataByTarget.get(e.targetId);return(null===t||0<e.snapshotVersion.compareTo(t.snapshotVersion))&&(i.targetDataByTarget=i.targetDataByTarget.insert(e.targetId,e),i.targetIdByTarget.set(r,e.targetId)),e})}function PE(i,o,a){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:t=Fg(i,SE),Mg(null!==(n=t.targetDataByTarget.get(o)),"Tried to release nonexistent target: "+o),r=a?"readwrite":"readwrite-primary",e.label=1;case 1:return e.trys.push([1,4,,5]),a?[3,3]:[4,t.persistence.runTransaction("Release target",r,function(e){return t.persistence.referenceDelegate.removeTarget(e,n)})];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:if(!uw(r=e.sent()))throw r;return Dg(TE,"Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return t.targetDataByTarget=t.targetDataByTarget.remove(o),t.targetIdByTarget.delete(n.target),[2]}})})}function xE(e,o,a){var s=Fg(e,SE),u=Bm.min(),c=ov();return s.persistence.runTransaction("Execute query","readonly",function(t){return e=s,n=t,r=om(o),(void 0!==(e=(i=Fg(e,SE)).targetIdByTarget.get(r))?i_.resolve(i.targetDataByTarget.get(e)):i.targetCache.getTargetData(n,r)).next(function(e){if(e)return u=e.lastLimboFreeSnapshotVersion,s.targetCache.getMatchingKeysForTargetId(t,e.targetId).next(function(e){c=e})}).next(function(){return s.queryEngine.getDocumentsMatchingQuery(t,o,a?u:Bm.min(),a?c:ov())}).next(function(e){return{documents:e,remoteKeys:c}});var e,n,r,i})}function LE(e,t){var n=Fg(e,SE),r=Fg(n.targetCache,Gw);return(e=n.targetDataByTarget.get(t))?Promise.resolve(e.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.getTargetDataForTarget(e,t).next(function(e){return e?e.target:null})})}function ME(e){var a=Fg(e,SE);return a.persistence.runTransaction("Get new document changes","readonly",function(e){return t=a.remoteDocuments,n=e,e=a.lastDocumentChangeReadTime,r=Fg(t,j_),i=tv,o=I_(e),e=H_(n),n=IDBKeyRange.lowerBound(o,!0),e.iterate({index:Aw.readTimeIndex,range:n},function(e,t){var n=E_(r.serializer,t);i=i.insert(n.key,n),o=t.readTime}).next(function(){return{changedDocs:i,readTime:S_(o)}});var t,n,r,i,o}).then(function(e){var t=e.changedDocs,e=e.readTime;return a.lastDocumentChangeReadTime=e,t})}function FE(t){return go(this,void 0,void 0,function(){return yo(this,function(e){if(t.code!==Ig.FAILED_PRECONDITION||t.message!==u_)throw t;return Dg(TE,"Unexpectedly lost primary lease"),[2]})})}var UE=(qE.prototype.reset=function(){this.currentBaseMs=0},qE.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},qE.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<i&&Dg("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return t.lastAttemptTime=Date.now(),e()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},qE.prototype.skipBackoff=function(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)},qE.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},qE.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},qE);function qE(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}var jE="PersistentStream",Hn=(VE.prototype.isStarted=function(){return 1===this.state||2===this.state||4===this.state},VE.prototype.isOpen=function(){return 2===this.state},VE.prototype.start=function(){3!==this.state?(Mg(0===this.state,"Already started"),this.auth()):this.performBackoff()},VE.prototype.stop=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},VE.prototype.inhibitBackoff=function(){Mg(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=0,this.backoff.reset()},VE.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return e.handleIdleCloseTimer()}))},VE.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},VE.prototype.handleIdleCloseTimer=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){return this.isOpen()?[2,this.close(0)]:[2]})})},VE.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},VE.prototype.close=function(t,n){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return Mg(this.isStarted(),"Only started streams should be closed."),Mg(3===t||Jg(n),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,3!==t?this.backoff.reset():n&&n.code===Ig.RESOURCE_EXHAUSTED?(Rg(n.toString()),Rg("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):n&&n.code===Ig.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(n)];case 1:return e.sent(),[2]}})})},VE.prototype.tearDown=function(){},VE.prototype.auth=function(){var n=this;Mg(0===this.state,"Must be in initial state to auth"),this.state=1;var e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;this.credentialsProvider.getToken().then(function(e){n.closeCount===t&&n.startStream(e)},function(t){e(function(){var e=new Sg(Ig.UNKNOWN,"Fetching auth token failed: "+t.message);return n.handleStreamClose(e)})})},VE.prototype.startStream=function(e){var t=this;Mg(1===this.state,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen(function(){n(function(){return Mg(1===t.state,"Expected stream to be in state Starting, but was "+t.state),t.state=2,t.listener.onOpen()})}),this.stream.onClose(function(e){n(function(){return t.handleStreamClose(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},VE.prototype.performBackoff=function(){var e=this;Mg(3===this.state,"Should only perform backoff when in Error state"),this.state=4,this.backoff.backoffAndRun(function(){return go(e,void 0,void 0,function(){return yo(this,function(e){return Mg(4===this.state,"Backoff elapsed but state is now: "+this.state),this.state=0,this.start(),Mg(this.isStarted(),"PersistentStream should have started"),[2]})})})},VE.prototype.handleStreamClose=function(e){return Mg(this.isStarted(),"Can't handle server close on non-started stream"),Dg(jE,"close with error: "+e),this.stream=null,this.close(3,e)},VE.prototype.getCloseGuardedDispatcher=function(t){var n=this;return function(e){n.queue.enqueueAndForget(function(){return n.closeCount===t?e():(Dg(jE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},VE);function VE(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=0,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new UE(e,t)}var BE,KE=(fo(WE,BE=Hn),WE.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},WE.prototype.onMessage=function(e){this.backoff.reset();var t=function(e,t){if("targetChange"in t){Dv(t.targetChange,"targetChange");var n="NO_CHANGE"===(o=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:xg("Got unexpected TargetChange.state: "+o),r=t.targetChange.targetIds||[],i=(i=e,o=t.targetChange.resumeToken,i.useProto3Json?(Lg(void 0===o||"string"==typeof o,"value must be undefined or a string when using proto3 Json"),Yg.fromBase64String(o||"")):(Lg(void 0===o||o instanceof Uint8Array,"value must be undefined or Uint8Array"),Yg.fromUint8Array(o||new Uint8Array))),o=t.targetChange.cause,a=o&&(o=void 0===(a=o).code?Ig.UNKNOWN:dv(a.code),new Sg(o,a.message||"")),i=new wv(n,r,i,a||null)}else if("documentChange"in t){Dv(t.documentChange,"documentChange"),Dv((c=t.documentChange).document,"documentChange.name"),Dv(c.document.name,"documentChange.document.name"),Dv(c.document.updateTime,"documentChange.document.updateTime");var s=Vv(e,c.document.name),u=Fv(c.document.updateTime),a=new sv({mapValue:{fields:c.document.fields}}),u=new My(s,u,a,{}),a=c.targetIds||[],c=c.removedTargetIds||[];i=new bv(a,c,u.key,u)}else if("documentDelete"in t){Dv(t.documentDelete,"documentDelete"),Dv((u=t.documentDelete).document,"documentDelete.document");var s=Vv(e,u.document),l=u.readTime?Fv(u.readTime):Bm.min(),l=new qy(s,l),c=u.removedTargetIds||[];i=new bv([],c,l.key,l)}else if("documentRemove"in t)Dv(t.documentRemove,"documentRemove"),Dv((l=t.documentRemove).document,"documentRemove"),s=Vv(e,l.document),c=l.removedTargetIds||[],i=new bv([],c,s,null);else{if(!("filter"in t))return xg("Unknown change type "+JSON.stringify(t));Dv(t.filter,"filter"),Dv((s=t.filter).targetId,"filter.targetId"),t=s.count||0,t=new hv(t),s=s.targetId,i=new _v(s,t)}return i}(this.serializer,e),e="targetChange"in e&&(!(e=e.targetChange).targetIds||!e.targetIds.length)&&e.readTime?Fv(e.readTime):Bm.min();return this.listener.onWatchChange(t,e)},WE.prototype.watch=function(e){var t,n,r,i={};i.database=Wv(this.serializer),i.addTarget=(t=this.serializer,(r=Qy(r=(n=e).target)?{documents:Yv(t,r)}:{query:Xv(t,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=Mv(t,n.resumeToken):0<n.snapshotVersion.compareTo(Bm.min())&&(r.readTime=Lv(t,n.snapshotVersion.toTimestamp())),r),this.serializer,(e=null==(r=function(e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xg("Unrecognized query purpose: "+e)}}((r=e).purpose))?null:{"goog-listen-tags":r})&&(i.labels=e),this.sendRequest(i)},WE.prototype.unwatch=function(e){var t={};t.database=Wv(this.serializer),t.removeTarget=e,this.sendRequest(t)},WE);function WE(e,t,n,r,i){return(i=BE.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i)||this).serializer=r,i}var zE,HE=(fo(GE,zE=Hn),Object.defineProperty(GE.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!1,configurable:!0}),GE.prototype.start=function(){this.handshakeComplete_=!1,this.lastStreamToken=void 0,zE.prototype.start.call(this)},GE.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},GE.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},GE.prototype.onMessage=function(e){if(Lg(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=(n=e.writeResults,r=e.commitTime,n&&0<n.length?(Lg(void 0!==r,"Received a write result without a commit time"),n.map(function(e){return n=r,(e=(t=e).updateTime?Fv(t.updateTime):Fv(n)).isEqual(Bm.min())&&(e=Fv(n)),n=null,t.transformResults&&0<t.transformResults.length&&(n=t.transformResults),new Ib(e,n);var t,n})):[]),n=Fv(e.commitTime);return this.listener.onMutationResult(n,t)}var n,r;return Lg(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},GE.prototype.writeHandshake=function(){Mg(this.isOpen(),"Writing handshake requires an opened stream"),Mg(!this.handshakeComplete_,"Handshake already completed"),Mg(!this.lastStreamToken,"Stream token should be empty during handshake");var e={};e.database=Wv(this.serializer),this.sendRequest(e)},GE.prototype.writeMutations=function(e){var t=this;Mg(this.isOpen(),"Writing mutations requires an opened stream"),Mg(this.handshakeComplete_,"Handshake must be complete before writing mutations"),Mg(!!this.lastStreamToken,"Trying to write mutation without a token"),e={streamToken:this.lastStreamToken,writes:e.map(function(e){return Gv(t.serializer,e)})},this.sendRequest(e)},GE);function GE(e,t,n,r,i){return(i=zE.call(this,e,"write_stream_connection_backoff","write_stream_idle",t,n,i)||this).serializer=r,i.handshakeComplete_=!1,i}var QE,YE=(fo(XE,QE=function(){}),XE.prototype.verifyInitialized=function(){if(Mg(!!this.connection,"Datastore.start() not called"),this.terminated)throw new Sg(Ig.FAILED_PRECONDITION,"The client has already been terminated.")},XE.prototype.invokeRPC=function(t,n,r){var i=this;return this.verifyInitialized(),this.credentials.getToken().then(function(e){return i.connection.invokeRPC(t,n,r,e)}).catch(function(e){throw e.code===Ig.UNAUTHENTICATED&&i.credentials.invalidateToken(),e})},XE.prototype.invokeStreamingRPC=function(t,n,r){var i=this;return this.verifyInitialized(),this.credentials.getToken().then(function(e){return i.connection.invokeStreamingRPC(t,n,r,e)}).catch(function(e){throw e.code===Ig.UNAUTHENTICATED&&i.credentials.invalidateToken(),e})},XE.prototype.terminate=function(){this.terminated=!1},XE);function XE(e,t,n){var r=QE.call(this)||this;return r.credentials=e,r.connection=t,r.serializer=n,r.terminated=!1,r}var JE=($E.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),Mg(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.onlineStateTimer=null,Mg("Unknown"===e.state,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast("Offline"),Promise.resolve()}))},$E.prototype.handleWatchStreamFailure=function(e){"Online"===this.state?(this.setAndBroadcast("Unknown"),Mg(0===this.watchStreamFailures,"watchStreamFailures must be 0"),Mg(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast("Offline")))},$E.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===e&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},$E.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},$E.prototype.logClientOfflineWarningIfNecessary=function(e){e="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.shouldWarnClientIsOffline?(Rg(e),this.shouldWarnClientIsOffline=!1):Dg("OnlineStateTracker",e)},$E.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},$E);function $E(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}var ZE="RemoteStore",eT=10,tT=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(e){n.enqueueAndForget(function(){return go(o,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return lT(this)?(Dg(ZE,"Restarting streams for network reachability change."),[4,function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return(t=Fg(n,tT)).offlineCauses.add(4),[4,rT(t)];case 1:return e.sent(),t.onlineStateTracker.set("Unknown"),t.offlineCauses.delete(4),[4,nT(t)];case 2:return e.sent(),[2]}})})}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new JE(n,r)};function nT(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:if(!lT(r))return[3,4];t=0,n=r.onNetworkStatusChange,e.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function rT(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:t=0,n=r.onNetworkStatusChange,e.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function iT(e,t){(e=Fg(e,tT)).listenTargets.has(t.targetId)||(e.listenTargets.set(t.targetId,t),cT(e)?uT(e):bT(e).isOpen()&&aT(e,t))}function oT(e,t){var n=Fg(e,tT),e=bT(n);Mg(n.listenTargets.has(t),"unlisten called on target no currently watched: "+t),n.listenTargets.delete(t),e.isOpen()&&sT(n,t),0===n.listenTargets.size&&(e.isOpen()?e.markIdle():lT(n)&&n.onlineStateTracker.set("Unknown"))}function aT(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t.targetId),bT(e).watch(t)}function sT(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t),bT(e).unwatch(t)}function uT(t){Mg(cT(t),"startWatchStream() called when shouldStartWatchStream() is false."),Mg(!!t.remoteSyncer.getRemoteKeysForTarget,"getRemoteKeysForTarget() not set"),t.watchChangeAggregator=new Iv({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},getTargetDataForTarget:function(e){return t.listenTargets.get(e)||null}}),bT(t).start(),t.onlineStateTracker.handleWatchStreamStart()}function cT(e){return lT(e)&&!bT(e).isStarted()&&0<e.listenTargets.size}function lT(e){return 0===Fg(e,tT).offlineCauses.size}function hT(e){e.watchChangeAggregator=void 0}function fT(n,r,i){return go(this,void 0,void 0,function(){var t=this;return yo(this,function(e){switch(e.label){case 0:return uw(r)?(Mg(!n.offlineCauses.has(1),"Unexpected network event when IndexedDB was marked failed."),n.offlineCauses.add(1),[4,rT(n)]):[3,2];case 1:return e.sent(),n.onlineStateTracker.set("Offline"),i=i||function(){return DE(n.localStore)},n.asyncQueue.enqueueRetryable(function(){return go(t,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return Dg(ZE,"Retrying IndexedDB access"),[4,i()];case 1:return e.sent(),n.offlineCauses.delete(1),[4,nT(n)];case 2:return e.sent(),[2]}})})}),[3,3];case 2:throw r;case 3:return[2]}})})}function pT(t,n){return n().catch(function(e){return fT(t,e,n)})}function dT(c){return go(this,void 0,void 0,function(){var o,a,s,u;return yo(this,function(e){switch(e.label){case 0:o=Fg(c,tT),a=_T(o),s=0<o.writePipeline.length?o.writePipeline[o.writePipeline.length-1].batchId:Jb,e.label=1;case 1:if(!gT(o))return[3,7];e.label=2;case 2:return e.trys.push([2,4,,6]),[4,(n=o.localStore,r=s,(i=Fg(n,SE)).persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===r&&(r=Jb),i.mutationQueue.getNextMutationBatchAfterBatchId(e,r)}))];case 3:return null===(u=e.sent())?(0===o.writePipeline.length&&a.markIdle(),[3,7]):(s=u.batchId,t=u,Mg(gT(n=o),"addToWritePipeline called when pipeline is full"),n.writePipeline.push(t),(n=_T(n)).isOpen()&&n.handshakeComplete&&n.writeMutations(t.mutations),[3,6]);case 4:return u=e.sent(),[4,fT(o,u)];case 5:return e.sent(),[3,6];case 6:return[3,1];case 7:return yT(o)&&mT(o),[2]}var t,n,r,i})})}function gT(e){return lT(e)&&e.writePipeline.length<eT}function yT(e){return lT(e)&&!_T(e).isStarted()&&0<e.writePipeline.length}function mT(e){Mg(yT(e),"startWriteStream() called when shouldStartWriteStream() is false."),_T(e).start()}function vT(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return t=Fg(n,tT),r?(t.offlineCauses.delete(2),[4,nT(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return r?[3,4]:(t.offlineCauses.add(2),[4,rT(t)]);case 3:e.sent(),t.onlineStateTracker.set("Unknown"),e.label=4;case 4:return[2]}})})}function bT(n){var e,t,r,i=this;return n.watchStream||(n.watchStream=(e=n.datastore,t=n.asyncQueue,r={onOpen:function(n){return go(this,void 0,void 0,function(){return yo(this,function(e){return n.listenTargets.forEach(function(e,t){aT(n,e)}),[2]})})}.bind(null,n),onClose:function(t,n){return go(this,void 0,void 0,function(){return yo(this,function(e){return void 0===n&&Mg(!cT(t),"Watch stream was stopped gracefully while still needed."),hT(t),cT(t)?(t.onlineStateTracker.handleWatchStreamFailure(n),uT(t)):t.onlineStateTracker.set("Unknown"),[2]})})}.bind(null,n),onWatchChange:function(r,i,o){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:if(r.onlineStateTracker.set("Online"),!(i instanceof wv&&2===i.state&&i.cause))return[3,6];e.label=1;case 1:return e.trys.push([1,3,,5]),[4,function(o,a){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:Mg(!!o.remoteSyncer.rejectListen,"rejectListen() not set"),Mg(!!a.cause,"Handling target error without a cause"),t=a.cause,n=0,r=a.targetIds,e.label=1;case 1:return n<r.length?(i=r[n],o.listenTargets.has(i)?[4,o.remoteSyncer.rejectListen(i,t)]:[3,3]):[3,4];case 2:e.sent(),o.listenTargets.delete(i),o.watchChangeAggregator.removeTarget(i),e.label=3;case 3:return n++,[3,1];case 4:return[2]}})})}(r,i)];case 2:return e.sent(),[3,5];case 3:return t=e.sent(),Dg(ZE,"Failed to remove targets %s: %s ",i.targetIds.join(","),t),[4,fT(r,t)];case 4:return e.sent(),[3,5];case 5:return[2];case 6:if(i instanceof bv?r.watchChangeAggregator.handleDocumentChange(i):i instanceof _v?r.watchChangeAggregator.handleExistenceFilter(i):(Mg(i instanceof wv,"Expected watchChange to be an instance of WatchTargetChange"),r.watchChangeAggregator.handleTargetChange(i)),o.isEqual(Bm.min()))return[3,13];e.label=7;case 7:return e.trys.push([7,11,,13]),[4,DE(r.localStore)];case 8:return n=e.sent(),0<=o.compareTo(n)?[4,function(r,i){Mg(!i.isEqual(Bm.min()),"Can't raise event for unknown SnapshotVersion");var e=r.watchChangeAggregator.createRemoteEvent(i);return e.targetChanges.forEach(function(e,t){var n;0<e.resumeToken.approximateByteSize()&&(n=r.listenTargets.get(t))&&r.listenTargets.set(t,n.withResumeToken(e.resumeToken,i))}),e.targetMismatches.forEach(function(e){var t=r.listenTargets.get(e);t&&(r.listenTargets.set(e,t.withResumeToken(Yg.EMPTY_BYTE_STRING,t.snapshotVersion)),sT(r,e),t=new l_(t.target,e,1,t.sequenceNumber),aT(r,t))}),Mg(!!r.remoteSyncer.applyRemoteEvent,"applyRemoteEvent() not set"),r.remoteSyncer.applyRemoteEvent(e)}(r,o)]:[3,10];case 9:e.sent(),e.label=10;case 10:return[3,13];case 11:return n=e.sent(),Dg(ZE,"Failed to raise snapshot:",n),[4,fT(r,n)];case 12:return e.sent(),[3,13];case 13:return[2]}})})}.bind(null,n)},(e=Fg(e,YE)).verifyInitialized(),new KE(t,e.connection,e.credentials,e.serializer,r)),n.onNetworkStatusChange.push(function(t){return go(i,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return t?(n.watchStream.inhibitBackoff(),cT(n)?uT(n):n.onlineStateTracker.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.watchStream.stop()];case 2:e.sent(),hT(n),e.label=3;case 3:return[2]}})})})),n.watchStream}function _T(n){var e,t,r,i=this;return n.writeStream||(Mg(0===n.writePipeline.length,"Should not issue writes before WriteStream is enabled"),n.writeStream=(e=n.datastore,t=n.asyncQueue,r={onOpen:function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){return _T(t).writeHandshake(),[2]})})}.bind(null,n),onClose:function(t,n){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return void 0===n&&Mg(!yT(t),"Write stream was stopped gracefully while still needed."),n&&_T(t).handshakeComplete?[4,function(r,i){return go(this,void 0,void 0,function(){var n;return yo(this,function(e){switch(e.label){case 0:return pv(t=i.code)&&t!==Ig.ABORTED?(n=r.writePipeline.shift(),_T(r).inhibitBackoff(),Mg(!!r.remoteSyncer.rejectFailedWrite,"rejectFailedWrite() not set"),[4,pT(r,function(){return r.remoteSyncer.rejectFailedWrite(n.batchId,i)})]):[3,3];case 1:return e.sent(),[4,dT(r)];case 2:e.sent(),e.label=3;case 3:return[2]}var t})})}(t,n)]:[3,2];case 1:e.sent(),e.label=2;case 2:return yT(t)&&mT(t),[2]}})})}.bind(null,n),onHandshakeComplete:function(o){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){for(t=_T(o),n=0,r=o.writePipeline;n<r.length;n++)i=r[n],t.writeMutations(i.mutations);return[2]})})}.bind(null,n),onMutationResult:function(r,i,o){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return Mg(0<r.writePipeline.length,"Got result for empty write pipeline"),t=r.writePipeline.shift(),n=e_.from(t,i,o),Mg(!!r.remoteSyncer.applySuccessfulWrite,"applySuccessfulWrite() not set"),[4,pT(r,function(){return r.remoteSyncer.applySuccessfulWrite(n)})];case 1:return e.sent(),[4,dT(r)];case 2:return e.sent(),[2]}})})}.bind(null,n)},(e=Fg(e,YE)).verifyInitialized(),new HE(t,e.connection,e.credentials,e.serializer,r)),n.onNetworkStatusChange.push(function(t){return go(i,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return t?(n.writeStream.inhibitBackoff(),[4,dT(n)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n.writeStream.stop()];case 3:e.sent(),0<n.writePipeline.length&&(Dg(ZE,"Stopping write stream with "+n.writePipeline.length+" pending writes"),n.writePipeline=[]),e.label=4;case 4:return[2]}})})})),n.writeStream}function wT(){return"undefined"!=typeof window?window:null}function ET(){return"undefined"!=typeof document?document:null}var TT="AsyncQueue",IT=(ST.createAndSchedule=function(e,t,n,r,i){return(i=new ST(e,t,Date.now()+n,r,i)).start(n),i},ST.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},ST.prototype.skipDelay=function(){return this.handleDelayElapsed()},ST.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Sg(Ig.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},ST.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},ST.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},ST);function ST(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Z_,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}var CT=(Object.defineProperty(AT.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!1,configurable:!0}),AT.prototype.enqueueAndForget=function(e){this.enqueue(e)},AT.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},AT.prototype.enterRestrictedMode=function(){var e;this._isShuttingDown||(this._isShuttingDown=!0,(e=ET())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.visibilityHandler))},AT.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(e){}):this.enqueueInternal(e)},AT.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget(function(){return t.retryableOps.push(e),t.retryNextOp()})},AT.prototype.retryNextOp=function(){return go(this,void 0,void 0,function(){var t,n=this;return yo(this,function(e){switch(e.label){case 0:if(0===this.retryableOps.length)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.retryableOps[0]()];case 2:return e.sent(),this.retryableOps.shift(),this.backoff.reset(),[3,4];case 3:if(!uw(t=e.sent()))throw t;return Dg(TT,"Operation failed with retryable error: "+t),[3,4];case 4:return 0<this.retryableOps.length&&this.backoff.backoffAndRun(function(){return n.retryNextOp()}),[2]}})})},AT.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then(function(){return t.operationInProgress=!0,e().catch(function(e){throw t.failure=e,t.operationInProgress=!1,Rg("INTERNAL UNHANDLED ERROR: ",NT(e)),e}).then(function(e){return t.operationInProgress=!1,e})});return this.tail=n},AT.prototype.enqueueAfterDelay=function(e,t,n){var r=this;return this.verifyNotFailed(),Mg(0<=t,"Attempted to schedule an operation with a negative delay of "+t),-1<this.timerIdsToSkip.indexOf(e)&&(t=0),n=IT.createAndSchedule(this,e,t,n,function(e){return r.removeDelayedOperation(e)}),this.delayedOperations.push(n),n},AT.prototype.verifyNotFailed=function(){this.failure&&xg("AsyncQueue is already failed: "+NT(this.failure))},AT.prototype.verifyOperationInProgress=function(){Mg(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},AT.prototype.drain=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,t=this.tail];case 1:e.sent(),e.label=2;case 2:if(t!==this.tail)return[3,0];e.label=3;case 3:return[2]}})})},AT.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},AT.prototype.runAllDelayedOperationsUntil=function(r){var i=this;return this.drain().then(function(){i.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var e=0,t=i.delayedOperations;e<t.length;e++){var n=t[e];if(n.skipDelay(),"all"!==r&&n.timerId===r)break}return i.drain()})},AT.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},AT.prototype.removeDelayedOperation=function(e){Mg(0<=(e=this.delayedOperations.indexOf(e)),"Delayed operation not found."),this.delayedOperations.splice(e,1)},AT);function AT(){var t=this;this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[],this.backoff=new UE(this,"async_queue_retry"),this.visibilityHandler=function(){var e=ET();e&&Dg(TT,"Visibility state changed to "+e.visibilityState),t.backoff.skipBackoff()};var e=ET();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.visibilityHandler)}function kT(e,t){if(Rg(TT,t+": "+e),uw(e))return new Sg(Ig.UNAVAILABLE,t+": "+e);throw e}function NT(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}var DT=(RT.emptySet=function(e){return new RT(e.comparator)},RT.prototype.has=function(e){return null!=this.keyedMap.get(e)},RT.prototype.get=function(e){return this.keyedMap.get(e)},RT.prototype.first=function(){return this.sortedSet.minKey()},RT.prototype.last=function(){return this.sortedSet.maxKey()},RT.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},RT.prototype.indexOf=function(e){return(e=this.keyedMap.get(e))?this.sortedSet.indexOf(e):-1},Object.defineProperty(RT.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),RT.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(e,t){return n(e),!1})},RT.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},RT.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},RT.prototype.isEqual=function(e){if(!(e instanceof RT))return!1;if(this.size!==e.size)return!1;for(var t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},RT.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},RT.prototype.copy=function(e,t){var n=new RT;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n},RT);function RT(n){this.comparator=n?function(e,t){return n(e,t)||cy.comparator(e.key,t.key)}:function(e,t){return cy.comparator(e.key,t.key)},this.keyedMap=nv,this.sortedSet=new Wm(this.comparator)}var OT=(PT.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);!n||0!==e.type&&3===n.type?this.changeMap=this.changeMap.insert(t,e):3===e.type&&1!==n.type?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.changeMap=this.changeMap.remove(t):1===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):xg("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n))},PT.prototype.getChanges=function(){var n=[];return this.changeMap.inorderTraversal(function(e,t){n.push(t)}),n},PT);function PT(){this.changeMap=new Wm(cy.comparator)}var xT=(LT.fromInitialDocuments=function(e,t,n,r){var i=[];return t.forEach(function(e){i.push({type:0,doc:e})}),new LT(e,t,DT.emptySet(t),i,n,r,!0,!1)},Object.defineProperty(LT.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),LT.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},LT);function LT(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}var MT=function(){this.viewSnap=void 0,this.listeners=[]},FT=function(){this.queries=new n_(um,sm),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set};function UT(a,s){return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){switch(e.label){case 0:if(Mg(!!(t=Fg(a,FT)).onListen,"onListen not set"),n=s.query,r=!1,(i=t.queries.get(n))||(r=!0,i=new MT),!r)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),o=i,[4,t.onListen(n)];case 2:return o.viewSnap=e.sent(),[3,4];case 3:return o=kT(o=e.sent(),"Initialization of query '"+cm(s.query)+"' failed"),s.onError(o),[2];case 4:return t.queries.set(n,i),i.listeners.push(s),Mg(!s.applyOnlineStateChange(t.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),i.viewSnap&&s.onViewSnapshot(i.viewSnap)&&jT(t),[2]}})})}function qT(a,s){return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){return Mg(!!(t=Fg(a,FT)).onUnlisten,"onUnlisten not set"),n=s.query,r=!1,(i=t.queries.get(n))&&0<=(o=i.listeners.indexOf(s))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?(t.queries.delete(n),[2,t.onUnlisten(n)]):[2]})})}function jT(e){e.snapshotsInSyncListeners.forEach(function(e){e.next()})}var VT=(BT.prototype.onViewSnapshot=function(e){if(Mg(0<e.docChanges.length||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new xT(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},BT.prototype.onError=function(e){this.queryObserver.error(e)},BT.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},BT.prototype.shouldRaiseInitialEvent=function(e,t){if(Mg(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var n="Offline"!==t;return this.options.waitForSyncWhenOnline&&n?(Mg(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||"Offline"===t},BT.prototype.shouldRaiseEvent=function(e){if(0<e.docChanges.length)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},BT.prototype.raiseInitialEvent=function(e){Mg(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=xT.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},BT);function BT(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=n||{}}var KT=(WT.fromSnapshot=function(e,t){for(var n=ov(),r=ov(),i=0,o=t.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}}return new WT(e,t.fromCache,n,r)},WT);function WT(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}var zT=(HT.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},HT.prototype.addReference=function(e,t){t=new GT(e,t),this.refsByKey=this.refsByKey.add(t),this.refsByTarget=this.refsByTarget.add(t)},HT.prototype.addReferences=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},HT.prototype.removeReference=function(e,t){this.removeRef(new GT(e,t))},HT.prototype.removeReferences=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},HT.prototype.removeReferencesForId=function(e){var t=this,n=new cy(new ry([])),r=new GT(n,e),e=new GT(n,e+1),i=[];return this.refsByTarget.forEachInRange([r,e],function(e){t.removeRef(e),i.push(e.key)}),i},HT.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},HT.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},HT.prototype.referencesForId=function(e){var t=new cy(new ry([])),n=new GT(t,e),e=new GT(t,e+1),r=ov();return this.refsByTarget.forEachInRange([n,e],function(e){r=r.add(e.key)}),r},HT.prototype.containsKey=function(e){var t=new GT(e,0);return null!==(t=this.refsByKey.firstAfterOrEqual(t))&&e.isEqual(t.key)},HT);function HT(){this.refsByKey=new Jm(GT.compareByKey),this.refsByTarget=new Jm(GT.compareByTargetId)}var GT=(QT.compareByKey=function(e,t){return cy.comparator(e.key,t.key)||jg(e.targetOrBatchId,t.targetOrBatchId)},QT.compareByTargetId=function(e,t){return jg(e.targetOrBatchId,t.targetOrBatchId)||cy.comparator(e.key,t.key)},QT);function QT(e,t){this.key=e,this.targetOrBatchId=t}var YT=function(e){this.key=e},XT=function(e){this.key=e},JT=(Object.defineProperty($T.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!1,configurable:!0}),$T.prototype.computeDocChanges=function(e,t){var a=this,s=t?t.changeSet:new OT,u=(t||this).documentSet,c=(t||this).mutatedKeys,l=u,h=!1,f=$y(this.query)&&u.size===this.query.limit?u.last():null,p=Zy(this.query)&&u.size===this.query.limit?u.first():null;if(e.inorderTraversal(function(e,t){var n=u.get(e),r=t instanceof My?t:null;r&&(Mg(e.isEqual(r.key),"Mismatching keys found in document changes: "+e+" != "+r.key),r=lm(a.query,r)?r:null);var i=!!n&&a.mutatedKeys.has(n.key),o=!!r&&(r.hasLocalMutations||a.mutatedKeys.has(r.key)&&r.hasCommittedMutations),t=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(s.track({type:3,doc:r}),t=!0):a.shouldWaitForSyncedDocument(n,r)||(s.track({type:2,doc:r}),t=!0,(f&&0<a.docComparator(r,f)||p&&a.docComparator(r,p)<0)&&(h=!0)):!n&&r?(s.track({type:0,doc:r}),t=!0):n&&!r&&(s.track({type:1,doc:n}),t=!0,(f||p)&&(h=!0)),t&&(c=r?(l=l.add(r),o?c.add(e):c.delete(e)):(l=l.delete(e),c.delete(e)))}),$y(this.query)||Zy(this.query))for(;l.size>this.query.limit;){var n=$y(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);s.track({type:1,doc:n})}return Mg(!h||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:l,changeSet:s,needsRefill:h,mutatedKeys:c}},$T.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},$T.prototype.applyChanges=function(e,t,n){var o=this;Mg(!e.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var i=e.changeSet.getChanges();i.sort(function(e,t){return r=e.type,i=t.type,n(r)-n(i)||o.docComparator(e.doc,t.doc);function n(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xg("Unknown ChangeType: "+e)}}var r,i}),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],t=(n=0===this.limboDocuments.size&&this.current?1:0)!==this.syncState;return this.syncState=n,0!==i.length||t?{snapshot:new xT(this.query,e.documentSet,r,i,e.mutatedKeys,0==n,t,!1),limboChanges:a}:{limboChanges:a}},$T.prototype.applyOnlineStateChange=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new OT,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},$T.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},$T.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.add(e)}),e.modifiedDocuments.forEach(function(e){Mg(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")}),e.removedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)}),this.current=e.current)},$T.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var n=this.limboDocuments;this.limboDocuments=ov(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var r=[];return n.forEach(function(e){t.limboDocuments.has(e)||r.push(new XT(e))}),this.limboDocuments.forEach(function(e){n.has(e)||r.push(new YT(e))}),r},$T.prototype.synchronizeWithPersistedState=function(e){return this._syncedDocuments=e.remoteKeys,this.limboDocuments=ov(),e=this.computeDocChanges(e.documents),this.applyChanges(e,!0)},$T.prototype.computeInitialSnapshot=function(){return xT.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState)},$T);function $T(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=ov(),this.mutatedKeys=ov(),this.docComparator=hm(e),this.documentSet=new DT(this.docComparator)}var ZT="SyncEngine",eI=function(e,t,n){this.query=e,this.targetId=t,this.view=n},tI=function(e){this.key=e,this.receivedDocument=!1},nI=(Object.defineProperty(rI.prototype,"isPrimaryClient",{get:function(){return!0===this._isPrimaryClient},enumerable:!1,configurable:!0}),rI);function rI(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new n_(um,sm),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=[],this.activeLimboTargetsByKey=new Wm(cy.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new zT,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=zw.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}function iI(i,o,a,s){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return i.applyDocChanges=function(e,t,n){return function(r,i,o,a){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return(t=i.view.computeDocChanges(o)).needsRefill?[4,xE(r.localStore,i.query,!1).then(function(e){return e=e.documents,i.view.computeDocChanges(e,t)})]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return n=a&&a.targetChanges.get(i.targetId),n=i.view.applyChanges(t,r.isPrimaryClient,n),fI(r,i.targetId,n.limboChanges),[2,n.snapshot]}})})}(i,e,t,n)},[4,xE(i.localStore,o,!0)];case 1:return n=e.sent(),r=new JT(o,n.remoteKeys),t=r.computeDocChanges(n.documents),n=mv.createSynthesizedTargetChangeForCurrentChange(a,s&&"Offline"!==i.onlineState),n=r.applyChanges(t,i.isPrimaryClient,n),fI(i,a,n.limboChanges),Mg(!!n.snapshot,"applyChanges for new view should always return a snapshot"),r=new eI(o,a,r),i.queryViewsByQuery.set(o,r),i.queriesByTarget.has(a)?i.queriesByTarget.get(a).push(o):i.queriesByTarget.set(a,[o]),[2,n.snapshot]}})})}function oI(s,u,c){return go(this,void 0,void 0,function(){var o,a;return yo(this,function(e){switch(e.label){case 0:a=vI(s),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,NE(a.localStore,u)];case 2:return o=e.sent(),a.sharedClientState.addPendingMutation(o.batchId),t=a,n=o.batchId,r=c,i=(i=(i=t.mutationUserCallbacks[t.currentUser.toKey()])||new Wm(jg)).insert(n,r),t.mutationUserCallbacks[t.currentUser.toKey()]=i,[4,dI(a,o.changes)];case 3:return e.sent(),[4,dT(a.remoteStore)];case 4:return e.sent(),[3,6];case 5:return a=kT(a=e.sent(),"Failed to persist write"),c.reject(a),[3,6];case 6:return[2]}var t,n,r,i})})}function aI(r,i){return go(this,void 0,void 0,function(){var n,t;return yo(this,function(e){switch(e.label){case 0:n=Fg(r,nI),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,RE(n.localStore,i)];case 2:return t=e.sent(),i.targetChanges.forEach(function(e,t){(t=n.activeLimboResolutionsByTarget.get(t))&&(Lg(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<e.addedDocuments.size?t.receivedDocument=!0:0<e.modifiedDocuments.size?Lg(t.receivedDocument,"Received change for limbo target document without add."):0<e.removedDocuments.size&&(Lg(t.receivedDocument,"Received remove for limbo target document without add."),t.receivedDocument=!1))}),[4,dI(n,t,i)];case 3:return e.sent(),[3,6];case 4:return[4,FE(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function sI(e,n,t){var r;((e=Fg(e,nI)).isPrimaryClient&&0===t||!e.isPrimaryClient&&1===t)&&(r=[],e.queryViewsByQuery.forEach(function(e,t){Mg(0===(t=t.view.applyOnlineStateChange(n)).limboChanges.length,"OnlineState should not affect limbo documents."),t.snapshot&&r.push(t.snapshot)}),function(e,i){(e=Fg(e,FT)).onlineState=i;var o=!1;e.queries.forEach(function(e,t){for(var n=0,r=t.listeners;n<r.length;n++)r[n].applyOnlineStateChange(i)&&(o=!0)}),o&&jT(e)}(e.eventManager,n),r.length&&(Mg(!!e.syncEngineListener.onWatchChange,"Active views but EventManager callbacks are not assigned"),e.syncEngineListener.onWatchChange(r)),e.onlineState=n,e.isPrimaryClient&&e.sharedClientState.setOnlineState(n))}function uI(e,t){(e.pendingWritesCallbacks.get(t)||[]).forEach(function(e){e.resolve()}),e.pendingWritesCallbacks.delete(t)}function cI(e,t,n){var r=Fg(e,nI),i=r.mutationUserCallbacks[r.currentUser.toKey()];i&&((e=i.get(t))&&(Mg(t===i.minKey(),"Mutation callbacks processed out-of-order?"),n?e.reject(n):e.resolve(),i=i.remove(t)),r.mutationUserCallbacks[r.currentUser.toKey()]=i)}function lI(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e),Mg(t.queriesByTarget.has(e)&&0!==t.queriesByTarget.get(e).length,"There are no queries mapped to target id "+e);for(var r=0,i=t.queriesByTarget.get(e);r<i.length;r++){var o=i[r];t.queryViewsByQuery.delete(o),n&&t.syncEngineListener.onWatchError(o,n)}t.queriesByTarget.delete(e),t.isPrimaryClient&&t.limboDocumentRefs.removeReferencesForId(e).forEach(function(e){t.limboDocumentRefs.containsKey(e)||hI(t,e)})}function hI(e,t){var n=e.activeLimboTargetsByKey.get(t);null!==n&&(oT(e.remoteStore,n),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.remove(t),e.activeLimboResolutionsByTarget.delete(n),pI(e))}function fI(e,t,n){for(var r,i,o=0,a=n;o<a.length;o++){var s=a[o];s instanceof YT?(e.limboDocumentRefs.addReference(s.key,t),r=e,i=(i=s).key,r.activeLimboTargetsByKey.get(i)||(Dg(ZT,"New document in limbo: "+i),r.enqueuedLimboResolutions.push(i),pI(r))):s instanceof XT?(Dg(ZT,"Document no longer in limbo: "+s.key),e.limboDocumentRefs.removeReference(s.key,t),e.limboDocumentRefs.containsKey(s.key)||hI(e,s.key)):xg("Unknown limbo change: "+JSON.stringify(s))}}function pI(e){for(;0<e.enqueuedLimboResolutions.length&&e.activeLimboTargetsByKey.size<e.maxConcurrentLimboResolutions;){var t=e.enqueuedLimboResolutions.shift(),n=e.limboTargetIdGenerator.next();e.activeLimboResolutionsByTarget.set(n,new tI(t)),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.insert(t,n),iT(e.remoteStore,new l_(om(Jy(t.path)),n,2,f_.INVALID))}}function dI(t,a,s){return go(this,void 0,void 0,function(){var n,r,i,o;return yo(this,function(e){switch(e.label){case 0:return n=Fg(t,nI),r=[],i=[],o=[],n.queryViewsByQuery.isEmpty()?[2]:(n.queryViewsByQuery.forEach(function(e,t){Mg(!!n.applyDocChanges,"ApplyDocChangesHandler not set"),o.push(n.applyDocChanges(t,a,s).then(function(e){e&&(n.isPrimaryClient&&n.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),r.push(e),e=KT.fromSnapshot(t.targetId,e),i.push(e))}))}),[4,Promise.all(o)]);case 1:return e.sent(),n.syncEngineListener.onWatchChange(r),[4,function(u,c){return go(this,void 0,void 0,function(){var r,t,n,i,o,a,s;return yo(this,function(e){switch(e.label){case 0:r=Fg(u,SE),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return i_.forEach(c,function(t){return i_.forEach(t.addedKeys,function(e){return r.persistence.referenceDelegate.addReference(n,t.targetId,e)}).next(function(){return i_.forEach(t.removedKeys,function(e){return r.persistence.referenceDelegate.removeReference(n,t.targetId,e)})})})})];case 2:return e.sent(),[3,4];case 3:if(!uw(t=e.sent()))throw t;return Dg(TE,"Failed to update sequence numbers: "+t),[3,4];case 4:for(n=0,i=c;n<i.length;n++)s=i[n],o=s.targetId,s.fromCache||(Mg(null!==(a=r.targetDataByTarget.get(o)),"Can't set limbo-free snapshot version for unknown target: "+o),s=a.snapshotVersion,s=a.withLastLimboFreeSnapshotVersion(s),r.targetDataByTarget=r.targetDataByTarget.insert(o,s));return[2]}})})}(n.localStore,i)];case 2:return e.sent(),[2]}})})}function gI(p,d,g){return go(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,h,f;return yo(this,function(e){switch(e.label){case 0:t=Fg(p,nI),n=[],r=[],i=0,o=d,e.label=1;case 1:return i<o.length?(a=o[i],s=void 0,(u=t.queriesByTarget.get(a))&&0!==u.length?[4,OE(t.localStore,om(u[0]))]:[3,7]):[3,13];case 2:s=e.sent(),c=0,l=u,e.label=3;case 3:return c<l.length?(l=l[c],Mg(!!(h=t.queryViewsByQuery.get(l)),"No query view found for "+cm(l)),[4,function(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,xE((t=Fg(r,nI)).localStore,i.query,!0)];case 1:return n=e.sent(),n=i.view.synchronizeWithPersistedState(n),t.isPrimaryClient&&fI(t,i.targetId,n.limboChanges),[2,n]}})})}(t,h)]):[3,6];case 4:(h=e.sent()).snapshot&&r.push(h.snapshot),e.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return Mg(g,"A secondary tab should never have an active view without an active target."),[4,LE(t.localStore,a)];case 8:return Mg(!!(f=e.sent()),"Target for id "+a+" not found"),[4,OE(t.localStore,f)];case 9:return s=e.sent(),[4,iI(t,yI(f),a,!1)];case 10:e.sent(),e.label=11;case 11:n.push(s),e.label=12;case 12:return i++,[3,1];case 13:return t.syncEngineListener.onWatchChange(r),[2,n]}})})}function yI(e){return Xy(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function mI(e){return(e=Fg(e,nI)).remoteStore.remoteSyncer.applyRemoteEvent=aI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(e,t){var n=Fg(e,nI);if((e=n.activeLimboResolutionsByTarget.get(t))&&e.receivedDocument)return ov().add(e.key);var r=ov();if(!(t=n.queriesByTarget.get(t)))return r;for(var i=0,o=t;i<o.length;i++){var a=o[i],s=n.queryViewsByQuery.get(a);Mg(!!s,"No query view found for "+cm(a)),r=r.unionWith(s.view.syncedDocuments)}return r}.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=function(o,a,s){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:return(t=Fg(o,nI)).sharedClientState.updateQueryState(a,"rejected",s),i=t.activeLimboResolutionsByTarget.get(a),(n=i&&i.key)?(r=(r=new Wm(cy.comparator)).insert(n,new qy(n,Bm.min())),i=ov().add(n),i=new gv(Bm.min(),new Map,new Jm(jg),r,i),[4,aI(t,i)]):[3,2];case 1:return e.sent(),t.activeLimboTargetsByKey=t.activeLimboTargetsByKey.remove(n),t.activeLimboResolutionsByTarget.delete(a),pI(t),[3,4];case 2:return[4,PE(t.localStore,a,!1).then(function(){return lI(t,a,s)}).catch(FE)];case 3:e.sent(),e.label=4;case 4:return[2]}})})}.bind(null,e),e.syncEngineListener.onWatchChange=function(e,t){for(var n=Fg(e,FT),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=a.query;if(s=n.queries.get(s)){for(var u=0,c=s.listeners;u<c.length;u++)c[u].onViewSnapshot(a)&&(r=!0);s.viewSnap=a}}r&&jT(n)}.bind(null,e.eventManager),e.syncEngineListener.onWatchError=function(e,t,n){var r=Fg(e,FT);if(e=r.queries.get(t))for(var i=0,o=e.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(t)}.bind(null,e.eventManager),e}function vI(e){return(e=Fg(e,nI)).remoteStore.remoteSyncer.applySuccessfulWrite=function(o,a){return go(this,void 0,void 0,function(){var n,r,i;return yo(this,function(e){switch(e.label){case 0:n=Fg(o,nI),r=a.batch.batchId,e.label=1;case 1:return e.trys.push([1,4,,6]),[4,(t=n.localStore,l=a,(h=Fg(t,SE)).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var i,t=l.batch.keys(),n=h.remoteDocuments.newChangeBuffer({trackRemovals:!0}),r=h,o=e,a=n,s=(i=l).batch,u=s.keys(),c=i_.resolve();return u.forEach(function(r){c=c.next(function(){return a.getEntry(o,r)}).next(function(e){var t=e,n=i.docVersions.get(r);Lg(null!==n,"ackVersions should contain every doc in the write."),(!t||t.version.compareTo(n)<0)&&((t=s.applyToRemoteDocument(r,t,i))?a.addEntry(t,i.commitVersion):Mg(!e,"Mutation batch "+s+" applied to document "+e+" resulted in null"))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(o,s)}).next(function(){return n.apply(e)}).next(function(){return h.mutationQueue.performConsistencyCheck(e)}).next(function(){return h.localDocuments.getDocuments(e,t)})}))];case 2:return i=e.sent(),cI(n,r,null),uI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,dI(n,i)];case 3:return e.sent(),[3,6];case 4:return[4,FE(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}var t,l,h})})}.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=function(a,s,u){return go(this,void 0,void 0,function(){var n,o;return yo(this,function(e){switch(e.label){case 0:n=Fg(a,nI),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,(t=n.localStore,r=s,(i=Fg(t,SE)).persistence.runTransaction("Reject batch","readwrite-primary",function(t){var n;return i.mutationQueue.lookupMutationBatch(t,r).next(function(e){return Lg(null!==e,"Attempt to reject nonexistent batch!"),n=e.keys(),i.mutationQueue.removeMutationBatch(t,e)}).next(function(){return i.mutationQueue.performConsistencyCheck(t)}).next(function(){return i.localDocuments.getDocuments(t,n)})}))];case 2:return o=e.sent(),cI(n,s,u),uI(n,s),n.sharedClientState.updateMutationState(s,"rejected",u),[4,dI(n,o)];case 3:return e.sent(),[3,6];case 4:return[4,FE(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}var t,r,i})})}.bind(null,e),e}var bI="firestore_clients";function _I(e,t){return Mg(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),bI+"_"+e+"_"+t}var wI="firestore_mutations";function EI(e,t,n){return n=wI+"_"+e+"_"+n,t.isAuthenticated()&&(n+="_"+t.uid),n}var TI="firestore_targets";function II(e,t){return TI+"_"+e+"_"+t}var SI="SharedClientState",CI=(AI.fromWebStorageEntry=function(e,t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Sg(r.error.code,r.error.message)),i?new AI(e,t,r.state,o):(Rg(SI,"Failed to parse mutation state for ID '"+t+"': "+n),null)},AI.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},AI);function AI(e,t,n,r){this.user=e,this.batchId=t,this.state=n,Mg(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}var kI=(NI.fromWebStorageEntry=function(e,t){var n=JSON.parse(t),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Sg(n.error.code,n.error.message)),r?new NI(e,n.state,i):(Rg(SI,"Failed to parse target state for ID '"+e+"': "+t),null)},NI.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},NI);function NI(e,t,n){this.targetId=e,this.state=t,Mg(void 0!==(this.error=n)==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}var DI=(RI.fromWebStorageEntry=function(e,t){for(var n=JSON.parse(t),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=av,o=0;r&&o<n.activeTargetIds.length;++o)r=Zg(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new RI(e,i):(Rg(SI,"Failed to parse client data for instance '"+e+"': "+t),null)},RI);function RI(e,t){this.clientId=e,this.activeTargetIds=t}var OI=(PI.fromWebStorageEntry=function(e){var t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new PI(t.clientId,t.onlineState):(Rg(SI,"Failed to parse online state: "+e),null)},PI);function PI(e,t){this.clientId=e,this.onlineState=t}var xI=(LI.prototype.addQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},LI.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},LI.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},LI);function LI(){this.activeTargetIds=av}var MI=(FI.isAvailable=function(e){return!(!e||!e.localStorage)},FI.prototype.start=function(){return go(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,h=this;return yo(this,function(e){switch(e.label){case 0:return Mg(!this.started,"WebStorageSharedClientState already started"),Mg(null!==this.syncEngine,"syncEngine property must be set before calling start()"),Mg(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(a=e.sent(),t=0,n=a;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(_I(this.persistenceKey,r)))&&(o=DI.fromWebStorageEntry(r,i))&&(this.activeClients=this.activeClients.insert(o.clientId,o));for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)l=c[u],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.window.addEventListener("unload",function(){return h.shutdown()}),this.started=!0,[2]}})})},FI.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},FI.prototype.getAllActiveQueryTargets=function(){return this.extractActiveQueryTargets(this.activeClients)},FI.prototype.isActiveQueryTarget=function(n){var r=!1;return this.activeClients.forEach(function(e,t){t.activeTargetIds.has(n)&&(r=!0)}),r},FI.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},FI.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},FI.prototype.addLocalQueryTarget=function(e){var t,n="not-current";return this.isActiveQueryTarget(e)&&(!(t=this.storage.getItem(II(this.persistenceKey,e)))||(t=kI.fromWebStorageEntry(e,t))&&(n=t.state)),this.localClientState.addQueryTarget(e),this.persistClientState(),n},FI.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},FI.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},FI.prototype.clearQueryState=function(e){this.removeItem(II(this.persistenceKey,e))},FI.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},FI.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.removeMutationState(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},FI.prototype.setOnlineState=function(e){this.persistOnlineState(e)},FI.prototype.notifyBundleLoaded=function(){this.persistBundleLoadedState()},FI.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},FI.prototype.getItem=function(e){var t=this.storage.getItem(e);return Dg(SI,"READ",e,t),t},FI.prototype.setItem=function(e,t){Dg(SI,"SET",e,t),this.storage.setItem(e,t)},FI.prototype.removeItem=function(e){Dg(SI,"REMOVE",e),this.storage.removeItem(e)},FI.prototype.handleWebStorageEvent=function(e){var t=this,o=e;o.storageArea===this.storage&&(Dg(SI,"EVENT",o.key,o.newValue),o.key!==this.localClientStorageKey?this.queue.enqueueRetryable(function(){return go(t,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){if(!this.started)return this.earlyEvents.push(o),[2];if(null===o.key)return[2];if(this.clientStateKeyRe.test(o.key)){if(null==o.newValue)return t=this.fromWebStorageClientStateKey(o.key),[2,this.handleClientStateEvent(t,null)];if(t=this.fromWebStorageClientState(o.key,o.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(o.key)){if(null!==o.newValue&&(n=this.fromWebStorageMutationMetadata(o.key,o.newValue)))return[2,this.handleMutationBatchEvent(n)]}else if(this.queryTargetKeyRe.test(o.key)){if(null!==o.newValue&&(r=this.fromWebStorageQueryTargetMetadata(o.key,o.newValue)))return[2,this.handleQueryTargetEvent(r)]}else if(o.key===this.onlineStateKey){if(null!==o.newValue&&(i=this.fromWebStorageOnlineState(o.newValue)))return[2,this.handleOnlineStateEvent(i)]}else if(o.key===this.sequenceNumberKey)Mg(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(i=function(e){var t=f_.INVALID;if(null!=e)try{var n=JSON.parse(e);Lg("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(e){Rg(SI,"Failed to read sequence number from WebStorage",e)}return t}(o.newValue))!==f_.INVALID&&this.sequenceNumberHandler(i);else if(o.key===this.bundleLoadedKey)return[2,this.syncEngine.synchronizeWithChangedDocuments()];return[2]})})}):Rg("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(FI.prototype,"localClientState",{get:function(){return this.activeClients.get(this.localClientId)},enumerable:!1,configurable:!0}),FI.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},FI.prototype.persistMutationState=function(e,t,n){n=new CI(this.currentUser,e,t,n),e=EI(this.persistenceKey,this.currentUser,e),this.setItem(e,n.toWebStorageJSON())},FI.prototype.removeMutationState=function(e){e=EI(this.persistenceKey,this.currentUser,e),this.removeItem(e)},FI.prototype.persistOnlineState=function(e){e={clientId:this.localClientId,onlineState:e},this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},FI.prototype.persistQueryTargetState=function(e,t,n){var r=II(this.persistenceKey,e),n=new kI(e,t,n);this.setItem(r,n.toWebStorageJSON())},FI.prototype.persistBundleLoadedState=function(){this.setItem(this.bundleLoadedKey,"value-not-used")},FI.prototype.fromWebStorageClientStateKey=function(e){return(e=this.clientStateKeyRe.exec(e))?e[1]:null},FI.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return Mg(null!==n,"Cannot parse client state key '"+e+"'"),DI.fromWebStorageEntry(n,t)},FI.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);return Mg(null!==n,"Cannot parse mutation batch key '"+e+"'"),e=Number(n[1]),n=void 0!==n[2]?n[2]:null,CI.fromWebStorageEntry(new wg(n),e,t)},FI.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);return Mg(null!==n,"Cannot parse query target key '"+e+"'"),n=Number(n[1]),kI.fromWebStorageEntry(n,t)},FI.prototype.fromWebStorageOnlineState=function(e){return OI.fromWebStorageEntry(e)},FI.prototype.handleMutationBatchEvent=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){return t.user.uid!==this.currentUser.uid?(Dg(SI,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},FI.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},FI.prototype.handleClientStateEvent=function(e,t){var n=this,r=t?this.activeClients.insert(e,t):this.activeClients.remove(e),i=this.extractActiveQueryTargets(this.activeClients),o=this.extractActiveQueryTargets(r),a=[],s=[];return o.forEach(function(e){i.has(e)||a.push(e)}),i.forEach(function(e){o.has(e)||s.push(e)}),this.syncEngine.applyActiveTargetsChange(a,s).then(function(){n.activeClients=r})},FI.prototype.handleOnlineStateEvent=function(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},FI.prototype.extractActiveQueryTargets=function(e){var n=av;return e.forEach(function(e,t){n=n.unionWith(t.activeTargetIds)}),n},FI);function FI(e,t,n,r,i){this.window=e,this.queue=t,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new Wm(jg),this.started=!1,this.earlyEvents=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.localClientStorageKey=_I(this.persistenceKey,this.localClientId),this.sequenceNumberKey="firestore_sequence_number_"+(i=this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new xI),this.clientStateKeyRe=new RegExp("^"+bI+"_"+n+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+wI+"_"+n+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+TI+"_"+n+"_(\\d+)$"),this.onlineStateKey="firestore_online_state_"+(n=this.persistenceKey),this.bundleLoadedKey="firestore_bundle_loaded_"+(n=this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}var UI=(qI.prototype.addPendingMutation=function(e){},qI.prototype.updateMutationState=function(e,t,n){},qI.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},qI.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},qI.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},qI.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},qI.prototype.clearQueryState=function(e){delete this.queryState[e]},qI.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},qI.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},qI.prototype.start=function(){return this.localState=new xI,Promise.resolve()},qI.prototype.handleUserChange=function(e,t,n){},qI.prototype.setOnlineState=function(e){},qI.prototype.shutdown=function(){},qI.prototype.writeSequenceNumber=function(e){},qI.prototype.notifyBundleLoaded=function(){},qI);function qI(){this.localState=new xI,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}var jI=(VI.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},VI.prototype.getDocumentsMatchingQuery=function(t,r,i,o){var a=this;return Mg(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())||i.isEqual(Bm.min())?this.executeFullCollectionScan(t,r):this.localDocumentsView.getDocuments(t,o).next(function(e){var n=a.applyQuery(r,e);return($y(r)||Zy(r))&&a.needsRefill(r.limitType,n,o,i)?a.executeFullCollectionScan(t,r):(Ng()<=Ta.DEBUG&&Dg("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cm(r)),a.localDocumentsView.getDocumentsMatchingQuery(t,r,i).next(function(t){return n.forEach(function(e){t=t.insert(e.key,e)}),t}))})},VI.prototype.applyQuery=function(n,e){var r=new Jm(hm(n));return e.forEach(function(e,t){t instanceof My&&lm(n,t)&&(r=r.add(t))}),r},VI.prototype.needsRefill=function(e,t,n,r){return n.size!==t.size||!!(t="F"===e?t.last():t.first())&&(t.hasPendingWrites||0<t.version.compareTo(r))},VI.prototype.executeFullCollectionScan=function(e,t){return Ng()<=Ta.DEBUG&&Dg("QueryEngine","Using full collection scan to execute query:",cm(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Bm.min())},VI);function VI(){}var BI=(KI.prototype.checkEmpty=function(e){return i_.resolve(0===this.mutationQueue.length)},KI.prototype.addMutationBatch=function(e,t,n,r){Mg(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&Mg(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order"),n=new $b(i,t,n,r),this.mutationQueue.push(n);for(var o=0,a=r;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new GT(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}return i_.resolve(n)},KI.prototype.lookupMutationBatch=function(e,t){return i_.resolve(this.findMutationBatch(t))},KI.prototype.getNextMutationBatchAfterBatchId=function(e,t){return t+=1,t=(t=this.indexOfBatchId(t))<0?0:t,i_.resolve(this.mutationQueue.length>t?this.mutationQueue[t]:null)},KI.prototype.getHighestUnacknowledgedBatchId=function(){return i_.resolve(0===this.mutationQueue.length?Jb:this.nextBatchId-1)},KI.prototype.getAllMutationBatches=function(e){return i_.resolve(this.mutationQueue.slice())},KI.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new GT(t,0),i=new GT(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(e){Mg(t.isEqual(e.key),"Should only iterate over a single key's batches"),Mg(null!==(e=n.findMutationBatch(e.targetOrBatchId)),"Batches in the index must exist in the main table"),o.push(e)}),i_.resolve(o)},KI.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var r=this,i=new Jm(jg);return t.forEach(function(t){var e=new GT(t,0),n=new GT(t,Number.POSITIVE_INFINITY);r.batchesByDocumentKey.forEachInRange([e,n],function(e){Mg(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),i=i.add(e.targetOrBatchId)})}),i_.resolve(this.findMutationBatches(i))},KI.prototype.getAllMutationBatchesAffectingQuery=function(e,t){Mg(!rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,t=n;cy.isDocumentKey(t)||(t=t.child(""));var t=new GT(new cy(t),0),i=new Jm(jg);return this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.targetOrBatchId)),!0)},t),i_.resolve(this.findMutationBatches(i))},KI.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach(function(e){null!==(e=t.findMutationBatch(e))&&n.push(e)}),n},KI.prototype.removeMutationBatch=function(n,r){var i=this;Lg(0===this.indexOfExistingBatchId(r.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var o=this.batchesByDocumentKey;return i_.forEach(r.mutations,function(e){var t=new GT(e.key,r.batchId);return o=o.delete(t),i.referenceDelegate.markPotentiallyOrphaned(n,e.key)}).next(function(){i.batchesByDocumentKey=o})},KI.prototype.removeCachedMutationKeys=function(e){},KI.prototype.containsKey=function(e,t){var n=new GT(t,0),n=this.batchesByDocumentKey.firstAfterOrEqual(n);return i_.resolve(t.isEqual(n&&n.key))},KI.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&Mg(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),i_.resolve()},KI.prototype.indexOfExistingBatchId=function(e,t){return Mg(0<=(e=this.indexOfBatchId(e))&&e<this.mutationQueue.length,"Batches must exist to be "+t),e},KI.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},KI.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:(Mg((t=this.mutationQueue[t]).batchId===e,"If found batch must match"),t)},KI);function KI(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new Jm(GT.compareByKey)}var WI=(zI.prototype.addEntry=function(e,t,n){Mg(!n.isEqual(Bm.min()),"Cannot add a document with a read time of zero");var r=t.key,i=(o=this.docs.get(r))?o.size:0,o=this.sizer(t);return this.docs=this.docs.insert(r,{maybeDocument:t,size:o,readTime:n}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())},zI.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},zI.prototype.getEntry=function(e,t){return t=this.docs.get(t),i_.resolve(t?t.maybeDocument:null)},zI.prototype.getEntries=function(e,t){var n=this,r=tv;return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)}),i_.resolve(r)},zI.prototype.getDocumentsMatchingQuery=function(e,t,n){Mg(!rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=nv,i=new cy(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=(s=o.getNext()).key,s=(u=s.value).maybeDocument,u=u.readTime;if(!t.path.isPrefixOf(a.path))break;u.compareTo(n)<=0||s instanceof My&&lm(t,s)&&(r=r.insert(s.key,s))}return i_.resolve(r)},zI.prototype.forEachDocumentKey=function(e,t){return i_.forEach(this.docs,function(e){return t(e)})},zI.prototype.newChangeBuffer=function(e){return new GI(this)},zI.prototype.getSize=function(e){return i_.resolve(this.size)},zI);function zI(e,t){this.indexManager=e,this.sizer=t,this.docs=new Wm(cy.comparator),this.size=0}var HI,GI=(fo(QI,HI=fe),QI.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(e,t){t&&t.maybeDocument?i.push(r.documentCache.addEntry(n,t.maybeDocument,r.getReadTime(e))):r.documentCache.removeEntry(e)}),i_.waitFor(i)},QI.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},QI.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},QI);function QI(e){var t=HI.call(this)||this;return t.documentCache=e,t}var YI=(XI.prototype.forEachTarget=function(e,n){return this.targets.forEach(function(e,t){return n(t)}),i_.resolve()},XI.prototype.getLastRemoteSnapshotVersion=function(e){return i_.resolve(this.lastRemoteSnapshotVersion)},XI.prototype.getHighestSequenceNumber=function(e){return i_.resolve(this.highestSequenceNumber)},XI.prototype.allocateTargetId=function(e){return this.highestTargetId=this.targetIdGenerator.next(),i_.resolve(this.highestTargetId)},XI.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),i_.resolve()},XI.prototype.saveTargetData=function(e){this.targets.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new zw(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},XI.prototype.addTargetData=function(e,t){return Mg(!this.targets.has(t.target),"Adding a target that already exists"),this.saveTargetData(t),this.targetCount+=1,i_.resolve()},XI.prototype.updateTargetData=function(e,t){return Mg(this.targets.has(t.target),"Updating a non-existent target"),this.saveTargetData(t),i_.resolve()},XI.prototype.removeTargetData=function(e,t){return Mg(0<this.targetCount,"Removing a target from an empty cache"),Mg(this.targets.has(t.target),"Removing a non-existent target from the cache"),this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),--this.targetCount,i_.resolve()},XI.prototype.removeTargets=function(n,r,i){var o=this,a=0,s=[];return this.targets.forEach(function(e,t){t.sequenceNumber<=r&&null===i.get(t.targetId)&&(o.targets.delete(e),s.push(o.removeMatchingKeysForTargetId(n,t.targetId)),a++)}),i_.waitFor(s).next(function(){return a})},XI.prototype.getTargetCount=function(e){return i_.resolve(this.targetCount)},XI.prototype.getTargetData=function(e,t){return t=this.targets.get(t)||null,i_.resolve(t)},XI.prototype.addMatchingKeys=function(e,t,n){return this.references.addReferences(t,n),i_.resolve()},XI.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),i_.waitFor(i)},XI.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),i_.resolve()},XI.prototype.getMatchingKeysForTargetId=function(e,t){return t=this.references.referencesForId(t),i_.resolve(t)},XI.prototype.containsKey=function(e,t){return i_.resolve(this.references.containsKey(t))},XI);function XI(e){this.persistence=e,this.targets=new n_(Hy,Gy),this.lastRemoteSnapshotVersion=Bm.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new zT,this.targetCount=0,this.targetIdGenerator=zw.forTargetCache()}var JI=($I.prototype.getBundleMetadata=function(e,t){return i_.resolve(this.bundles.get(t))},$I.prototype.saveBundleMetadata=function(e,t){return this.bundles.set(t.id,{id:t.id,version:t.version,createTime:Fv(t.createTime)}),i_.resolve()},$I.prototype.getNamedQuery=function(e,t){return i_.resolve(this.namedQueries.get(t))},$I.prototype.saveNamedQuery=function(e,t){return this.namedQueries.set(t.name,{name:t.name,query:R_(t.bundledQuery),readTime:Fv(t.readTime)}),i_.resolve()},$I);function $I(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}var ZI=(eS.prototype.start=function(){return Promise.resolve()},eS.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(eS.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),eS.prototype.setDatabaseDeletedListener=function(){},eS.prototype.setNetworkEnabled=function(){},eS.prototype.getIndexManager=function(){return this.indexManager},eS.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new BI(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},eS.prototype.getTargetCache=function(){return this.targetCache},eS.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},eS.prototype.getBundleCache=function(){return this.bundleCache},eS.prototype.runTransaction=function(e,t,n){var r=this;Dg("MemoryPersistence","Starting transaction:",e);var i=new nS(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(e){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},eS.prototype.mutationQueuesContainKey=function(t,n){return i_.or(Object.values(this.mutationQueues).map(function(e){return function(){return e.containsKey(t,n)}}))},eS);function eS(e,t){var n=this;this.mutationQueues={},this.listenSequence=new f_(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new YI(this),this.indexManager=new Y_,this.remoteDocumentCache=(e=this.indexManager,new WI(e,function(e){return n.referenceDelegate.documentSize(e)})),this.serializer=new w_(t),this.bundleCache=new JI(this.serializer)}var tS,nS=(fo(rS,tS=he),rS);function rS(e){var t=tS.call(this)||this;return t.currentSequenceNumber=e,t}var iS=(oS.factory=function(e){return new oS(e)},Object.defineProperty(oS.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw xg("orphanedDocuments is only valid during a transaction.")},enumerable:!1,configurable:!0}),oS.prototype.addReference=function(e,t,n){return this.localViewReferences.addReference(n,t),this.orphanedDocuments.delete(n.toString()),i_.resolve()},oS.prototype.removeReference=function(e,t,n){return this.localViewReferences.removeReference(n,t),this.orphanedDocuments.add(n.toString()),i_.resolve()},oS.prototype.markPotentiallyOrphaned=function(e,t){return this.orphanedDocuments.add(t.toString()),i_.resolve()},oS.prototype.removeTarget=function(e,t){var n=this;this.localViewReferences.removeReferencesForId(t.targetId).forEach(function(e){return n.orphanedDocuments.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.orphanedDocuments.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})},oS.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},oS.prototype.onTransactionCommitted=function(n){var r=this,i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return i_.forEach(this.orphanedDocuments,function(e){var t=cy.fromPath(e);return r.isReferenced(n,t).next(function(e){e||i.removeEntry(t)})}).next(function(){return r._orphanedDocuments=null,i.apply(n)})},oS.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next(function(e){e?n.orphanedDocuments.delete(t.toString()):n.orphanedDocuments.add(t.toString())})},oS.prototype.documentSize=function(e){return 0},oS.prototype.isReferenced=function(e,t){var n=this;return i_.or([function(){return i_.resolve(n.localViewReferences.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)}])},oS);function oS(e){this.persistence=e,this.localViewReferences=new zT,this._orphanedDocuments=null}var aS=(sS.prototype.onOpen=function(e){Mg(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},sS.prototype.onClose=function(e){Mg(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},sS.prototype.onMessage=function(e){Mg(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},sS.prototype.close=function(){this.closeFn()},sS.prototype.send=function(e){this.sendFn(e)},sS.prototype.callOnOpen=function(){Mg(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},sS.prototype.callOnClose=function(e){Mg(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},sS.prototype.callOnMessage=function(e){Mg(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},sS);function sS(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}var uS="RestConnection",cS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},lS="gl-js/ fire/"+Ag,fe=(hS.prototype.invokeRPC=function(t,e,n,r){var i=this.makeUrl(t,e);return Dg(uS,"Sending: ",i,n),e={},this.modifyHeadersForRequest(e,r),this.performRPCRequest(t,i,e,n).then(function(e){return Dg(uS,"Received: ",e),e},function(e){throw Og(uS,t+" failed with error: ",e,"url: ",i,"request:",n),e})},hS.prototype.invokeStreamingRPC=function(e,t,n,r){return this.invokeRPC(e,t,n,r)},hS.prototype.modifyHeadersForRequest=function(e,t){if(e["X-Goog-Api-Client"]=lS,e["Content-Type"]="text/plain",t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},hS.prototype.makeUrl=function(e,t){var n=cS[e];return Mg(void 0!==n,"Unknown REST mapping for: "+e),this.baseUrl+"/v1/"+t+":"+n},hS);function hS(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host,this.databaseRoot="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}var fS,pS="Connection",dS=(fo(gS,fS=fe),gS.prototype.performRPCRequest=function(o,t,a,s){return new Promise(function(n,r){var i=new yg;i.listenOnce(pg.COMPLETE,function(){try{switch(i.getLastErrorCode()){case fg.NO_ERROR:var e=i.getResponseJson();Dg(pS,"XHR received:",JSON.stringify(e)),n(e);break;case fg.TIMEOUT:Dg(pS,'RPC "'+o+'" timed out'),r(new Sg(Ig.DEADLINE_EXCEEDED,"Request time out"));break;case fg.HTTP_ERROR:var t=i.getStatus();Dg(pS,'RPC "'+o+'" failed with status:',t,"response text:",i.getResponseText()),0<t?(e=i.getResponseJson().error)&&e.status&&e.message?(t=(t=e.status).toLowerCase().replace(/_/g,"-"),t=0<=Object.values(Ig).indexOf(t)?t:Ig.UNKNOWN,r(new Sg(t,e.message))):r(new Sg(Ig.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Sg(Ig.UNAVAILABLE,"Connection failed."));break;default:xg('RPC "'+o+'" failed with unanticipated webchannel error '+i.getLastErrorCode()+": "+i.getLastError()+", giving up.")}}finally{Dg(pS,'RPC "'+o+'" completed.')}});var e=JSON.stringify(s);i.send(t,"POST",e,a,15)})},gS.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new ag,i=hg(),e={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.modifyHeadersForRequest(e.initMessageHeaders,t),Oo()||xo()||0<=Ro().indexOf("Electron/")||0<=(t=Ro()).indexOf("MSIE ")||0<=t.indexOf("Trident/")||0<=Ro().indexOf("MSAppHost/")||Po()||(e.httpHeadersOverwriteParam="$httpHeaders"),n=n.join(""),Dg(pS,"Creating WebChannel: "+n,e);var o=r.createWebChannel(n,e),a=!1,s=!1,u=new aS({sendFn:function(e){s?Dg(pS,"Not sending because WebChannel is closed:",e):(a||(Dg(pS,"Opening WebChannel transport."),o.open(),a=!0),Dg(pS,"WebChannel sending:",e),o.send(e))},closeFn:function(){return o.close()}});return(e=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})})(o,gg.EventType.OPEN,function(){s||Dg(pS,"WebChannel transport opened.")}),e(o,gg.EventType.CLOSE,function(){s||(s=!0,Dg(pS,"WebChannel transport closed"),u.callOnClose())}),e(o,gg.EventType.ERROR,function(e){s||(s=!0,Og(pS,"WebChannel transport errored:",e),u.callOnClose(new Sg(Ig.UNAVAILABLE,"The operation could not be completed")))}),e(o,gg.EventType.MESSAGE,function(e){var t,n,r,i;s||(Lg(!!(t=e.data[0]),"Got a webchannel message without data."),(n=t.error||(null===(i=t[0])||void 0===i?void 0:i.error))?(Dg(pS,"WebChannel received error:",n),e=function(e){if(void 0!==(e=fv[e]))return dv(e)}(r=n.status),i=n.message,void 0===e&&(e=Ig.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),s=!0,u.callOnClose(new Sg(e,i)),o.close()):(Dg(pS,"WebChannel received:",t),u.callOnMessage(t)))}),e(i,dg.STAT_EVENT,function(e){10===e.stat?Dg(pS,"Detected buffering proxy"):11===e.stat&&Dg(pS,"Detected no buffering proxy")}),setTimeout(function(){u.callOnOpen()},0),u},gS);function gS(e){var t=fS.call(this,e)||this;return t.forceLongPolling=e.forceLongPolling,t.autoDetectLongPolling=e.autoDetectLongPolling,t}var yS="ConnectivityMonitor",mS=(vS.prototype.addCallback=function(e){this.callbacks.push(e)},vS.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},vS.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},vS.prototype.onNetworkAvailable=function(){Dg(yS,"Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(0)},vS.prototype.onNetworkUnavailable=function(){Dg(yS,"Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(1)},vS.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},vS);function vS(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}var bS=(_S.prototype.addCallback=function(e){},_S.prototype.shutdown=function(){},_S);function _S(){}function wS(e){return new Rv(e,!0)}var ES=(TS.prototype.initialize=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return this.serializer=wS(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.createGarbageCollectionScheduler(t),this.localStore=this.createLocalStore(t),[2]}})})},TS.prototype.createGarbageCollectionScheduler=function(e){return null},TS.prototype.createLocalStore=function(e){return AE(this.persistence,new jI,e.initialUser,this.serializer)},TS.prototype.createPersistence=function(e){return new ZI(iS.factory,this.serializer)},TS.prototype.createSharedClientState=function(e){return new UI},TS.prototype.terminate=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}})})},TS);function TS(){this.synchronizeTabs=!1}var IS,SS=(fo(CS,IS=ES),CS.prototype.initialize=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,IS.prototype.initialize.call(this,t)];case 1:return e.sent(),[4,function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){return[2,(t=Fg(n,SE)).persistence.runTransaction("Synchronize last document change read time","readonly",function(e){return e=H_(e),r=Bm.min(),e.iterate({index:Aw.readTimeIndex,reverse:!0},function(e,t,n){t.readTime&&(r=S_(t.readTime)),n.done()}).next(function(){return r});var r}).then(function(e){t.lastDocumentChangeReadTime=e})]})})}(this.localStore)];case 2:return e.sent(),[4,this.onlineComponentProvider.initialize(this,t)];case 3:return e.sent(),[4,vI(this.onlineComponentProvider.syncEngine)];case 4:return e.sent(),[4,dT(this.onlineComponentProvider.remoteStore)];case 5:return e.sent(),[2]}})})},CS.prototype.createLocalStore=function(e){return AE(this.persistence,new jI,e.initialUser,this.serializer)},CS.prototype.createGarbageCollectionScheduler=function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new iE(t,e.asyncQueue)},CS.prototype.createPersistence=function(e){var t=EE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?nE.withCacheSize(this.cacheSizeBytes):nE.DEFAULT;return new gE(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,wT(),ET(),this.serializer,this.sharedClientState,!!this.forceOwnership)},CS.prototype.createSharedClientState=function(e){return new UI},CS);function CS(e,t,n){var r=IS.call(this)||this;return r.onlineComponentProvider=e,r.cacheSizeBytes=t,r.forceOwnership=n,r.synchronizeTabs=!1,r}var AS,kS=(fo(NS,AS=SS),NS.prototype.initialize=function(r){return go(this,void 0,void 0,function(){var t,n=this;return yo(this,function(e){switch(e.label){case 0:return[4,AS.prototype.initialize.call(this,r)];case 1:return e.sent(),t=this.onlineComponentProvider.syncEngine,this.sharedClientState instanceof MI?(this.sharedClientState.syncEngine={applyBatchState:function(u,c,l,h){return go(this,void 0,void 0,function(){var a,s;return yo(this,function(e){switch(e.label){case 0:return[4,(n=(a=Fg(u,nI)).localStore,r=c,i=Fg(n,SE),o=Fg(i.mutationQueue,O_),i.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return o.lookupMutationKeys(t,r).next(function(e){return e?i.localDocuments.getDocuments(t,e):i_.resolve(null)})}))];case 1:return null===(s=e.sent())?(Dg(ZT,"Cannot apply mutation batch with id: "+c),[2]):"pending"!==l?[3,3]:[4,dT(a.remoteStore)];case 2:return e.sent(),[3,4];case 3:"acknowledged"===l||"rejected"===l?(cI(a,c,h||null),uI(a,c),t=a.localStore,n=c,Fg(Fg(t,SE).mutationQueue,O_).removeCachedMutationKeys(n)):xg("Unknown batchState: "+l),e.label=4;case 4:return[4,dI(a,s)];case 5:return e.sent(),[2]}var t,n,r,i,o})})}.bind(null,t),applyTargetState:function(i,o,a,s){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:if((t=Fg(i,nI))._isPrimaryClient)return Dg(ZT,"Ignoring unexpected query state notification."),[2];if(!t.queriesByTarget.has(o))return[3,7];switch(a){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,ME(t.localStore)];case 2:return n=e.sent(),r=gv.createSynthesizedRemoteEventForCurrentChange(o,"current"===a),[4,dI(t,n,r)];case 3:return e.sent(),[3,7];case 4:return[4,PE(t.localStore,o,!0)];case 5:return e.sent(),lI(t,o,s),[3,7];case 6:xg("Unexpected target state: "+a),e.label=7;case 7:return[2]}})})}.bind(null,t),applyActiveTargetsChange:function(l,h,f){return go(this,void 0,void 0,function(){var n,t,r,i,o,a,s,u,c;return yo(this,function(e){switch(e.label){case 0:if(!(n=mI(l))._isPrimaryClient)return[2];t=0,r=h,e.label=1;case 1:return t<r.length?(c=r[t],n.queriesByTarget.has(c)?(Dg(ZT,"Adding an already active target "+c),[3,5]):[4,LE(n.localStore,c)]):[3,6];case 2:return Mg(!!(i=e.sent()),"Query data for active target "+c+" not found"),[4,OE(n.localStore,i)];case 3:return o=e.sent(),[4,iI(n,yI(i),o.targetId,!1)];case 4:e.sent(),iT(n.remoteStore,o),e.label=5;case 5:return t++,[3,1];case 6:a=function(t){return yo(this,function(e){switch(e.label){case 0:return n.queriesByTarget.has(t)?[4,PE(n.localStore,t,!1).then(function(){oT(n.remoteStore,t),lI(n,t)}).catch(FE)]:[2,"continue"];case 1:return e.sent(),[2]}})},s=0,u=f,e.label=7;case 7:return s<u.length?(c=u[s],[5,a(c)]):[3,10];case 8:e.sent(),e.label=9;case 9:return s++,[3,7];case 10:return[2]}})})}.bind(null,t),getActiveClients:function(e){return e=Fg(e,nI),Fg(Fg(e.localStore,SE).persistence,gE).getActiveClients()}.bind(null,t),synchronizeWithChangedDocuments:function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){return[2,ME((t=Fg(n,nI)).localStore).then(function(e){return dI(t,e)})]})})}.bind(null,t)},[4,this.sharedClientState.start()]):[3,3];case 2:e.sent(),e.label=3;case 3:return[4,this.persistence.setPrimaryStateListener(function(t){return go(n,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,function(l,h){return go(this,void 0,void 0,function(){var r,t,i,o,a,s,u,c;return yo(this,function(e){switch(e.label){case 0:return mI(r=Fg(l,nI)),vI(r),!0!==h||!0===r._isPrimaryClient?[3,3]:(t=r.sharedClientState.getAllActiveQueryTargets(),[4,gI(r,t.toArray(),!0)]);case 1:return i=e.sent(),r._isPrimaryClient=!0,[4,vT(r.remoteStore,!0)];case 2:for(e.sent(),o=0,a=i;o<a.length;o++)s=a[o],iT(r.remoteStore,s);return[3,7];case 3:return!1!==h||!1===r._isPrimaryClient?[3,7]:(u=[],c=Promise.resolve(),r.queriesByTarget.forEach(function(e,t){r.sharedClientState.isLocalQueryTarget(t)?u.push(t):c=c.then(function(){return lI(r,t),PE(r.localStore,t,!0)}),oT(r.remoteStore,t)}),[4,c]);case 4:return e.sent(),[4,gI(r,u,!1)];case 5:return e.sent(),(n=Fg(r,nI)).activeLimboResolutionsByTarget.forEach(function(e,t){oT(n.remoteStore,t)}),n.limboDocumentRefs.removeAllReferences(),n.activeLimboResolutionsByTarget=new Map,n.activeLimboTargetsByKey=new Wm(cy.comparator),r._isPrimaryClient=!1,[4,vT(r.remoteStore,!1)];case 6:e.sent(),e.label=7;case 7:return[2]}var n})})}(this.onlineComponentProvider.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return e.sent(),[2]}})})},NS.prototype.createSharedClientState=function(e){var t=wT();if(!MI.isAvailable(t))throw new Sg(Ig.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=EE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new MI(t,e.asyncQueue,n,e.clientId,e.initialUser)},NS);function NS(e,t){var n=AS.call(this,e,t,!1)||this;return n.onlineComponentProvider=e,n.cacheSizeBytes=t,n.synchronizeTabs=!0,n}var DS=(RS.prototype.initialize=function(n,r){return go(this,void 0,void 0,function(){var t=this;return yo(this,function(e){switch(e.label){case 0:return this.localStore?[2]:(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return sI(t.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=function(i,o){return go(this,void 0,void 0,function(){var n,r;return yo(this,function(e){switch(e.label){case 0:return(n=Fg(i,nI)).currentUser.isEqual(o)?[3,3]:(Dg(ZT,"User change. New user:",o.toKey()),[4,kE(n.localStore,o)]);case 1:return r=e.sent(),n.currentUser=o,(t=n).pendingWritesCallbacks.forEach(function(e){e.forEach(function(e){e.reject(new Sg(Ig.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.pendingWritesCallbacks.clear(),n.sharedClientState.handleUserChange(o,r.removedBatchIds,r.addedBatchIds),[4,dI(n,r.affectedDocuments)];case 2:e.sent(),e.label=3;case 3:return[2]}var t})})}.bind(null,this.syncEngine),[4,vT(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:return e.sent(),[2]}})})},RS.prototype.createEventManager=function(e){return new FT},RS.prototype.createDatastore=function(e){var t=wS(e.databaseInfo.databaseId),n=(n=e.databaseInfo,new dS(n));return e=e.credentials,new YE(e,n,t)},RS.prototype.createRemoteStore=function(e){var t=this,n=this.localStore,r=this.datastore,i=e.asyncQueue,o=function(e){return sI(t.syncEngine,e,0)};return e=new(mS.isAvailable()?mS:bS),new tT(n,r,i,o,e)},RS.prototype.createSyncEngine=function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,o=this.sharedClientState,a=e.initialUser,e=e.maxConcurrentLimboResolutions,e=new nI(n,r,i,o,a,e),t&&(e._isPrimaryClient=!0),e;var n,r,i,o,a},RS.prototype.terminate=function(){return function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return t=Fg(n,tT),Dg(ZE,"RemoteStore shutting down."),t.offlineCauses.add(5),[4,rT(t)];case 1:return e.sent(),t.connectivityMonitor.shutdown(),t.onlineStateTracker.set("Unknown"),[2]}})})}(this.remoteStore)},RS);function RS(){}var OS=(PS.prototype.next=function(e){this.observer.next&&this.scheduleEvent(this.observer.next,e)},PS.prototype.error=function(e){this.observer.error?this.scheduleEvent(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},PS.prototype.mute=function(){this.muted=!0},PS.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},PS);function PS(e){this.observer=e,this.muted=!1}var xS=(LS.prototype.lookup=function(r){return go(this,void 0,void 0,function(){var t,n=this;return yo(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Sg(Ig.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,s){return go(this,void 0,void 0,function(){var i,t,n,o,r;return yo(this,function(e){switch(e.label){case 0:return i=Fg(a,YE),t=Wv(i.serializer)+"/documents",n={documents:s.map(function(e){return jv(i.serializer,e)})},[4,i.invokeStreamingRPC("BatchGetDocuments",t,n)];case 1:return n=e.sent(),o=new Map,n.forEach(function(e){var t,n,r;t=i.serializer,e="found"in(n=e)?function(e,t){Lg(!!t.found,"Tried to deserialize a found document from a missing document."),Dv(t.found.name,"doc.found.name"),Dv(t.found.updateTime,"doc.found.updateTime");var n=Vv(e,t.found.name),e=Fv(t.found.updateTime),t=new sv({mapValue:{fields:t.found.fields}});return new My(n,e,t,{})}(t,n):"missing"in n?(r=t,Lg(!!(t=n).missing,"Tried to deserialize a missing document from a found document."),Lg(!!t.readTime,"Tried to deserialize a missing document without a read time."),r=Vv(r,t.missing),t=Fv(t.readTime),new qy(r,t)):xg("invalid batch get response: "+JSON.stringify(n)),o.set(e.key.toString(),e)}),r=[],s.forEach(function(e){var t=o.get(e.toString());Lg(!!t,"Missing entity in write response for "+e),r.push(t)}),[2,r]}})})}(this.datastore,r)];case 1:return(t=e.sent()).forEach(function(e){e instanceof qy||e instanceof My?n.recordVersion(e):xg("Document in a transaction was a "+e.constructor.name)}),[2,t]}})})},LS.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e.toString())},LS.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},LS.prototype.delete=function(e){this.write([new Hb(e,this.precondition(e))]),this.writtenDocs.add(e.toString())},LS.prototype.commit=function(){return go(this,void 0,void 0,function(){var t,n=this;return yo(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(e,t){t=cy.fromPath(t),n.mutations.push(new Yb(t,n.precondition(t)))}),[4,function(i,o){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return t=Fg(i,YE),n=Wv(t.serializer)+"/documents",r={writes:o.map(function(e){return Gv(t.serializer,e)})},[4,t.invokeRPC("Commit",n,r)];case 1:return e.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}})})},LS.prototype.recordVersion=function(e){var t;if(e instanceof My)t=e.version;else{if(!(e instanceof qy))throw xg("Document in a transaction was a "+e.constructor.name);t=Bm.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Sg(Ig.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},LS.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Sb.updateTime(t):Sb.none()},LS.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return Sb.exists(!0);if(t.isEqual(Bm.min()))throw new Sg(Ig.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Sb.updateTime(t)},LS.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},LS.prototype.ensureCommitNotCalled=function(){Mg(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},LS);function LS(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}var MS=(FS.prototype.run=function(){this.runWithBackOff()},FS.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun(function(){return go(e,void 0,void 0,function(){var t,n,r=this;return yo(this,function(e){return t=new xS(this.datastore),(n=this.tryRunUpdateFunction(t))&&n.then(function(e){r.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){r.deferred.resolve(e)}).catch(function(e){r.handleTransactionError(e)})})}).catch(function(e){r.handleTransactionError(e)}),[2]})})})},FS.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!Jg(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},FS.prototype.handleTransactionError=function(e){var t=this;0<this.retries&&this.isRetryableTransactionError(e)?(--this.retries,this.asyncQueue.enqueueAndForget(function(){return t.runWithBackOff(),Promise.resolve()})):this.deferred.reject(e)},FS.prototype.isRetryableTransactionError=function(e){return"FirebaseError"===e.name&&("aborted"===(e=e.code)||"failed-precondition"===e||!pv(e))},FS);function FS(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.retries=5,this.backoff=new UE(this.asyncQueue,"transaction_retry")}var US="FirestoreClient",qS=(jS.prototype.getConfiguration=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return e.sent(),[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}})})},jS.prototype.setCredentialChangeListener=function(e){var t=this;this.credentialListener=e,this.receivedInitialUser.promise.then(function(){return t.credentialListener(t.user)})},jS.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Sg(Ig.FAILED_PRECONDITION,"The client has already been terminated.")},jS.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var n=new Z_;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:e.sent(),e.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return t=kT(e.sent(),"Failed to shutdown persistence"),n.reject(t),[3,6];case 6:return[2]}})})}),n.promise},jS);function jS(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=wg.UNAUTHENTICATED,this.clientId=Ug.newId(),this.credentialListener=function(){},this.receivedInitialUser=new Z_,this.credentials.setChangeListener(function(e){Dg(US,"Received user=",e.uid),r.user.isEqual(e)||(r.user=e,r.credentialListener(e)),r.receivedInitialUser.resolve()})}function VS(r,i){return go(this,void 0,void 0,function(){var t,n=this;return yo(this,function(e){switch(e.label){case 0:return r.asyncQueue.verifyOperationInProgress(),Dg(US,"Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return t=e.sent(),[4,i.initialize(t)];case 2:return e.sent(),r.setCredentialChangeListener(function(t){return r.asyncQueue.enqueueRetryable(function(){return go(n,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,kE(i.localStore,t)];case 1:return e.sent(),[2]}})})})}),i.persistence.setDatabaseDeletedListener(function(){return r.terminate()}),r.offlineComponents=i,[2]}})})}function BS(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return r.asyncQueue.verifyOperationInProgress(),[4,KS(r)];case 1:return t=e.sent(),Dg(US,"Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=e.sent(),[4,i.initialize(t,n)];case 3:return e.sent(),r.setCredentialChangeListener(function(e){return r.asyncQueue.enqueueRetryable(function(){return function(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return(t=Fg(r,tT)).asyncQueue.verifyOperationInProgress(),Mg(!!t.remoteSyncer.handleCredentialChange,"handleCredentialChange() not set"),Dg(ZE,"RemoteStore received new credentials"),n=lT(t),t.offlineCauses.add(3),[4,rT(t)];case 1:return e.sent(),n&&t.onlineStateTracker.set("Unknown"),[4,t.remoteSyncer.handleCredentialChange(i)];case 2:return e.sent(),t.offlineCauses.delete(3),[4,nT(t)];case 3:return e.sent(),[2]}})})}(i.remoteStore,e)})}),r.onlineComponents=i,[2]}})})}function KS(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Dg(US,"Using default OfflineComponentProvider"),[4,VS(t,new ES)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function WS(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Dg(US,"Using default OnlineComponentProvider"),[4,BS(t,new DS)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function zS(e){return KS(e).then(function(e){return e.persistence})}function HS(e){return KS(e).then(function(e){return e.localStore})}function GS(e){return WS(e).then(function(e){return e.remoteStore})}function QS(e){return WS(e).then(function(e){return e.syncEngine})}function YS(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,WS(r)];case 1:return t=e.sent(),(n=t.eventManager).onListen=function(a,s){return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){switch(e.label){case 0:return t=mI(a),(o=t.queryViewsByQuery.get(s))?(n=o.targetId,t.sharedClientState.addLocalQueryTarget(n),r=o.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,OE(t.localStore,om(s))];case 2:return i=e.sent(),o=t.sharedClientState.addLocalQueryTarget(i.targetId),n=i.targetId,[4,iI(t,s,n,"current"===o)];case 3:r=e.sent(),t.isPrimaryClient&&iT(t.remoteStore,i),e.label=4;case 4:return[2,r]}})})}.bind(null,t.syncEngine),n.onUnlisten=function(i,o){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return t=Fg(i,nI),Mg(!!(n=t.queryViewsByQuery.get(o)),"Trying to unlisten on query not found:"+cm(o)),1<(r=t.queriesByTarget.get(n.targetId)).length?(t.queriesByTarget.set(n.targetId,r.filter(function(e){return!sm(e,o)})),t.queryViewsByQuery.delete(o),[2]):t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)?[3,2]:[4,PE(t.localStore,n.targetId,!1).then(function(){t.sharedClientState.clearQueryState(n.targetId),oT(t.remoteStore,n.targetId),lI(t,n.targetId)}).catch(FE)]):[3,3];case 1:e.sent(),e.label=2;case 2:return[3,5];case 3:return lI(t,n.targetId),[4,PE(t.localStore,n.targetId,!0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})}.bind(null,t.syncEngine),[2,n]}})})}function XS(u,c,l){var e=this;void 0===l&&(l={});var h=new Z_;return u.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,YS(u)];case 1:return t=e.sent(),[2,(n=t,r=u.asyncQueue,i=c,o=l,a=h,e=new OS({next:function(e){r.enqueueAndForget(function(){return qT(n,s)});var t=e.docs.has(i);!t&&e.fromCache?a.reject(new Sg(Ig.UNAVAILABLE,"Failed to get document because the client is offline.")):t&&e.fromCache&&o&&"server"===o.source?a.reject(new Sg(Ig.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):(Mg(e.docs.size<=1,"Expected zero or a single result on a document-only query"),a.resolve(e))},error:function(e){return a.reject(e)}}),s=new VT(Jy(i.path),e,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0}),UT(n,s))]}var n,r,i,o,a,s})})}),h.promise}function JS(u,c,l){var e=this;void 0===l&&(l={});var h=new Z_;return u.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){var s;return yo(this,function(e){switch(e.label){case 0:return[4,YS(u)];case 1:return s=e.sent(),[2,(t=s,n=u.asyncQueue,r=c,i=l,o=h,e=new OS({next:function(e){n.enqueueAndForget(function(){return qT(t,a)}),e.fromCache&&"server"===i.source?o.reject(new Sg(Ig.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(e)},error:function(e){return o.reject(e)}}),a=new VT(r,e,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0}),UT(t,a))]}var t,n,r,i,o,a})})}),h.promise}function $S(e,t,n){if(!n)throw new Sg(Ig.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function ZS(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function eC(e,t,n,r){if(!0===t&&!0===r)throw new Sg(Ig.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function tC(e){if(!cy.isDocumentKey(e))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function nC(e){if(cy.isDocumentKey(e))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function rC(e){return void 0===e?"undefined":null===e?"null":"string"==typeof e?(20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e)):"number"==typeof e||"boolean"==typeof e?""+e:"object"!=typeof e?"function"==typeof e?"a function":xg("Unknown wrong type: "+typeof e):e instanceof Array?"an array":(e=(t=e).constructor&&(t=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString()))&&1<t.length?t[1]:null)?"a custom "+e+" object":"an object";var t}function iC(e,t){if("_delegate"in e&&(e=e._delegate),e instanceof t)return e;if(t.name===e.constructor.name)throw new Sg(Ig.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw e=rC(e),new Sg(Ig.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+e)}function oC(e,t){if(t<=0)throw new Sg(Ig.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}function aC(i){return function(){if("object"==typeof i&&null!==i)for(var e=i,t=0,n=["next","error","complete"];t<n.length;t++){var r=n[t];if(r in e&&"function"==typeof e[r])return 1}}()}var sC=(Object.defineProperty(uC.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(uC.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),uC.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},uC.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},uC.prototype._compareTo=function(e){return jg(this._lat,e._lat)||jg(this._long,e._long)},uC);function uC(e,t){if(!isFinite(e)||e<-90||90<e)throw new Sg(Ig.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new Sg(Ig.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}var cC=(lC.fromBase64String=function(e){try{return new lC(Yg.fromBase64String(e))}catch(e){throw new Sg(Ig.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},lC.fromUint8Array=function(e){return new lC(Yg.fromUint8Array(e))},lC.prototype.toBase64=function(){return this._byteString.toBase64()},lC.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},lC.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},lC.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},lC);function lC(e){this._byteString=e}var hC=function(e){this._delegate=e};function fC(){if("undefined"==typeof Uint8Array)throw new Sg(Ig.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function pC(){if("undefined"==typeof atob)throw new Sg(Ig.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var dC,gC=(fo(yC,dC=hC),yC.fromBase64String=function(e){return pC(),new yC(cC.fromBase64String(e))},yC.fromUint8Array=function(e){return fC(),new yC(cC.fromUint8Array(e))},yC.prototype.toBase64=function(){return pC(),this._delegate.toBase64()},yC.prototype.toUint8Array=function(){return fC(),this._delegate.toUint8Array()},yC.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},yC.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},yC);function yC(){return null!==dC&&dC.apply(this,arguments)||this}function mC(){}mC.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),vy(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sy(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Cy(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw xg("Invalid value type: "+JSON.stringify(e))}},mC.prototype.convertObject=function(e,n){var r=this,i={};return Gg(e.fields||{},function(e,t){i[e]=r.convertValue(t,n)}),i},mC.prototype.convertGeoPoint=function(e){return new sC(Sy(e.latitude),Sy(e.longitude))},mC.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})},mC.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=function e(t){return gy(t=t.mapValue.fields[py])?e(t):t}(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(yy(e));default:return null}},mC.prototype.convertTimestamp=function(e){return e=Iy(e),new Wg(e.seconds,e.nanos)},mC.prototype.convertDocumentKey=function(e,t){var n=ry.fromString(e);return Lg(nb(n),"ReferenceValue is not valid "+e),e=new bg(n.get(1),n.get(3)),n=new cy(n.popFirst(5)),e.isEqual(t)||Rg("Document "+n+" contains a document reference within a different database ("+e.projectId+"/"+e.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),n};var vC,bC=(fo(_C,vC=he=mC),_C.prototype.convertBytes=function(e){return new gC(new cC(e))},_C.prototype.convertReference=function(e){return e=this.convertDocumentKey(e,this.firestore._databaseId),eN.forKey(e,this.firestore,null)},_C);function _C(e){var t=vC.call(this)||this;return t.firestore=e,t}function wC(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e}var EC=(TC.prototype.getToken=function(){return Promise.resolve(null)},TC.prototype.invalidateToken=function(){},TC.prototype.setChangeListener=function(e){Mg(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=e)(wg.UNAUTHENTICATED)},TC.prototype.removeChangeListener=function(){this.changeListener=null},TC);function TC(){this.changeListener=null}var IC=(SC.prototype.getToken=function(){var t=this;Mg(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.tokenCounter,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(function(e){return t.tokenCounter!==n?(Dg("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):e?(Lg("string"==typeof e.accessToken,"Invalid tokenData returned from getToken():"+e),new wC(e.accessToken,t.currentUser)):null}):Promise.resolve(null)},SC.prototype.invalidateToken=function(){this.forceRefresh=!0},SC.prototype.setChangeListener=function(e){Mg(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},SC.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},SC.prototype.getUser=function(){var e=this.auth&&this.auth.getUid();return Lg(null===e||"string"==typeof e,"Received invalid UID: "+e),new wg(e)},SC);function SC(e){var t=this;this.tokenListener=null,this.currentUser=wg.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),e.get().then(function(e){t.auth=e,t.tokenListener&&t.auth.addAuthTokenListener(t.tokenListener)},function(){}))}var CC=(Object.defineProperty(AC.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!1,configurable:!0}),AC);function AC(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=wg.FIRST_PARTY}var kC=(NC.prototype.getToken=function(){return Promise.resolve(new CC(this.gapi,this.sessionIndex))},NC.prototype.setChangeListener=function(e){e(wg.FIRST_PARTY)},NC.prototype.removeChangeListener=function(){},NC.prototype.invalidateToken=function(){},NC);function NC(e,t){this.gapi=e,this.sessionIndex=t}var DC=new Map,RC=(OC.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties},OC);function OC(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Sg(Ig.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Sg(Ig.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,eC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}var PC=(Object.defineProperty(xC.prototype,"app",{get:function(){if(!this._app)throw new Sg(Ig.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(xC.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(xC.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),xC.prototype._setSettings=function(e){if(this._settingsFrozen)throw new Sg(Ig.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RC(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new EC;switch(e.type){case"gapi":var t=e.client;return Lg(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new kC(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new Sg(Ig.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},xC.prototype._getSettings=function(){return this._settings},xC.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},xC.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},xC.prototype._terminate=function(){var e;return(e=DC.get(this))&&(Dg("ComponentProvider","Removing Datastore"),DC.delete(this),e.terminate()),Promise.resolve()},xC);function xC(e,t){this._persistenceKey="(lite)",this._settings=new RC({}),this._settingsFrozen=!1,e instanceof bg?(this._databaseId=e,this._credentials=new EC):(this._app=e,this._databaseId=function(e){if(Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))return new bg(e.options.projectId);throw new Sg(Ig.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}(e),this._credentials=new IC(t))}var LC,MC=(fo(FC,LC=PC),FC.prototype._terminate=function(){return this._firestoreClient||Hk(this),this._firestoreClient.terminate()},FC);function FC(e,t){return(t=LC.call(this,e,t)||this)._queue=new CT,t._persistenceKey="name"in e?e.name:"[DEFAULT]",t}function UC(n,r,i){var e=this,o=new Z_;return n.asyncQueue.enqueue(function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,VS(n,i)];case 1:return e.sent(),[4,BS(n,r)];case 2:return e.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(e=t=e.sent()).name?e.code===Ig.FAILED_PRECONDITION||e.code===Ig.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),o.reject(t),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function qC(e){return function(t){var e=this,n=new Z_;return t.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,QS(t)];case 1:return[2,function(a,s){return go(this,void 0,void 0,function(){var r,i,o;return yo(this,function(e){switch(e.label){case 0:lT((r=Fg(a,nI)).remoteStore)||Dg(ZT,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(t=r.localStore,(n=Fg(t,SE)).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return n.mutationQueue.getHighestUnacknowledgedBatchId(e)}))];case 2:return(i=e.sent())===Jb?(s.resolve(),[2]):((o=r.pendingWritesCallbacks.get(i)||[]).push(s),r.pendingWritesCallbacks.set(i,o),[3,4]);case 3:return o=kT(o=e.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(o),[3,4];case 4:return[2]}var t,n})})}(e.sent(),n)]}})})}),n.promise}(zk(e=iC(e,MC)))}function jC(e){if(e._initialized||e._terminated)throw new Sg(Ig.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var VC,BC=function(e){this._methodName=e},KC=(fo(WC,VC=BC),WC.prototype._toFieldTransform=function(e){if(2!==e.dataSource)throw 1===e.dataSource?(Mg(0<e.path.length,this._methodName+"() at the top level should have already been handled."),e.createError(this._methodName+"() can only appear at the top level of your update data")):e.createError(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},WC.prototype.isEqual=function(e){return e instanceof WC},WC);function WC(){return null!==VC&&VC.apply(this,arguments)||this}function zC(e,t,n){return new fA({dataSource:3,targetDoc:t.settings.targetDoc,methodName:e._methodName,arrayElement:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var HC,GC=(fo(QC,HC=BC),QC.prototype._toFieldTransform=function(e){return new Eb(e.path,new ob)},QC.prototype.isEqual=function(e){return e instanceof QC},QC);function QC(){return null!==HC&&HC.apply(this,arguments)||this}var YC,XC=(fo(JC,YC=BC),JC.prototype._toFieldTransform=function(e){var t=zC(this,e,!0),n=this._elements.map(function(e){return _A(e,t)}),n=new ub(n);return new Eb(e.path,n)},JC.prototype.isEqual=function(e){return this===e},JC);function JC(e,t){return(e=YC.call(this,e)||this)._elements=t,e}var $C,ZC=(fo(eA,$C=BC),eA.prototype._toFieldTransform=function(e){var t=zC(this,e,!0),n=this._elements.map(function(e){return _A(e,t)}),n=new fb(n);return new Eb(e.path,n)},eA.prototype.isEqual=function(e){return this===e},eA);function eA(e,t){return(e=$C.call(this,e)||this)._elements=t,e}var tA,nA=(fo(rA,tA=BC),rA.prototype._toFieldTransform=function(e){var t=new yb(e.serializer,xv(e.serializer,this._operand));return new Eb(e.path,t)},rA.prototype.isEqual=function(e){return this===e},rA);function rA(e,t){return(e=tA.call(this,e)||this)._operand=t,e}var iA=(oA.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},oA);function oA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sy(e)}var aA=/^__.*__$/,sA=(uA.prototype.toMutations=function(e,t){var n=[];return null!==this.fieldMask?n.push(new Fb(e,this.data,this.fieldMask,t)):n.push(new xb(e,this.data,t)),0<this.fieldTransforms.length&&n.push(new Vb(e,this.fieldTransforms)),n},uA);function uA(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}var cA=(lA.prototype.toMutations=function(e,t){return t=[new Fb(e,this.data,this.fieldMask,t)],0<this.fieldTransforms.length&&t.push(new Vb(e,this.fieldTransforms)),t},lA);function lA(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}function hA(e){switch(e){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xg("Unexpected case for UserDataSource: "+e)}}var fA=(Object.defineProperty(pA.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(pA.prototype,"dataSource",{get:function(){return this.settings.dataSource},enumerable:!1,configurable:!0}),pA.prototype.contextWith=function(e){return new pA(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},pA.prototype.childContextForField=function(e){var t=null===(t=this.path)||void 0===t?void 0:t.child(e);return(t=this.contextWith({path:t,arrayElement:!1})).validatePathSegment(e),t},pA.prototype.childContextForFieldPath=function(e){var t,e=null===(t=this.path)||void 0===t?void 0:t.child(e);return(e=this.contextWith({path:e,arrayElement:!1})).validatePath(),e},pA.prototype.childContextForArray=function(e){return this.contextWith({path:void 0,arrayElement:!0})},pA.prototype.createError=function(e){return AA(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)},pA.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},pA.prototype.validatePath=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},pA.prototype.validatePathSegment=function(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(hA(this.dataSource)&&aA.test(e))throw this.createError('Document fields cannot begin and end with "__"')},pA);function pA(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}var dA=(gA.prototype.createContext=function(e,t,n,r){return void 0===r&&(r=!1),new fA({dataSource:e,methodName:t,targetDoc:n,path:sy.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)},gA);function gA(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||wS(e)}function yA(e,t,n,r,i,o){void 0===o&&(o={});var a=e.createContext(o.merge||o.mergeFields?2:0,t,n,i);TA("Data must be an object, but it was:",a,r);var s,u,r=wA(r,a);if(o.merge)s=new _b(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,h=o.mergeFields;l<h.length;l++){var f=IA(t,h[l],n);if(!a.contains(f))throw new Sg(Ig.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");kA(c,f)||c.push(f)}s=new _b(c),u=a.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=a.fieldTransforms;return new sA(new sv(r),s,u)}function mA(e,r,i,t){var o=e.createContext(1,r,i);TA("Data must be an object, but it was:",o,t);var a=[],s=new cv;return Gg(t,function(e,t){var n=CA(r,e,i);t instanceof hC&&(t=t._delegate),e=o.childContextForFieldPath(n),t instanceof KC?a.push(n):null!=(e=_A(t,e))&&(a.push(n),s.set(n,e))}),t=new _b(a),new cA(s.build(),t,o.fieldTransforms)}function vA(e,t,n,r,i,o){var a=e.createContext(1,t,n),s=[IA(t,r,n)],u=[i];if(o.length%2!=0)throw new Sg(Ig.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(IA(t,o[c])),u.push(o[c+1]);for(var l,h,f,p=[],d=new cv,c=s.length-1;0<=c;--c)kA(p,s[c])||(l=s[c],(h=u[c])instanceof hC&&(h=h._delegate),f=a.childContextForFieldPath(l),h instanceof KC?p.push(l):null!=(f=_A(h,f))&&(p.push(l),d.set(l,f)));return i=new _b(p),new cA(d.build(),i,a.fieldTransforms)}function bA(e,t,n,r){return void 0===r&&(r=!1),Mg(null!=(n=_A(n,t=e.createContext(r?4:3,t))),"Parsed data should not be null."),Mg(0===t.fieldTransforms.length,"Field transforms should have been disallowed."),n}function _A(a,e){if(a instanceof hC&&(a=a._delegate),EA(a))return TA("Unsupported field value:",e,a),wA(a,e);if(a instanceof BC)return function(e,t){if(!hA(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");(e=e._toFieldTransform(t))&&t.fieldTransforms.push(e)}(a,e),null;if(e.path&&e.fieldMask.push(e.path),a instanceof Array){if(e.settings.arrayElement&&4!==e.dataSource)throw e.createError("Nested arrays are not supported");return function(e){for(var t=[],n=0,r=0,i=a;r<i.length;r++){var o=_A(i[r],e.childContextForArray(n));null==o&&(o={nullValue:"NULL_VALUE"}),t.push(o),n++}return{arrayValue:{values:t}}}(e)}return function(e,t){if(e instanceof hC&&(e=e._delegate),null===e)return{nullValue:"NULL_VALUE"};if("number"==typeof e)return xv(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Wg.fromDate(e);return{timestampValue:Lv(t.serializer,n)}}if(e instanceof Wg)return n=new Wg(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)),{timestampValue:Lv(t.serializer,n)};if(e instanceof sC)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof cC)return{bytesValue:Mv(t.serializer,e._byteString)};if(e instanceof MA){var r=t.databaseId;if(!(n=e.firestore._databaseId).isEqual(r))throw t.createError("Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:Uv(e.firestore._databaseId||t.databaseId,e._key.path)}}if(void 0===e&&t.ignoreUndefinedProperties)return null;throw t.createError("Unsupported field value: "+rC(e))}(a,e)}function wA(e,n){var r={};return Qg(e)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):Gg(e,function(e,t){null!=(t=_A(t,n.childContextForField(e)))&&(r[e]=t)}),{mapValue:{fields:r}}}function EA(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Wg||e instanceof sC||e instanceof cC||e instanceof MA||e instanceof BC)}function TA(e,t,n){if(!EA(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=rC(n))?t.createError(e+" a custom object"):t.createError(e+" "+n);var r}function IA(e,t,n){if(t instanceof hC&&(t=t._delegate),t instanceof iA)return t._internalPath;if("string"==typeof t)return CA(e,t);throw AA("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var SA=new RegExp("[~\\*/\\[\\]]");function CA(t,n,r){if(0<=n.search(SA))throw AA("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,r);try{return(new(iA.bind.apply(iA,_o([void 0],n.split(".")))))._internalPath}catch(e){throw AA("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,r)}}function AA(e,t,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,t="Function "+t+"() called with invalid data";return n&&(t+=" (via `toFirestore()`)"),t+=". ",n="",(o||a)&&(n+=" (found",o&&(n+=" in field "+r),a&&(n+=" in document "+i),n+=")"),new Sg(Ig.INVALID_ARGUMENT,t+e+n)}function kA(e,t){return e.some(function(e){return e.isEqual(t)})}var NA,DA=(fo(RA,NA=he),RA.prototype.convertBytes=function(e){return new cC(e)},RA.prototype.convertReference=function(e){return e=this.convertDocumentKey(e,this.firestore._databaseId),new MA(this.firestore,null,e)},RA);function RA(e){var t=NA.call(this)||this;return t.firestore=e,t}function OA(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=iC(e,MA);var o=iC(e.firestore,MC),a=mk(o);return t instanceof hC&&(t=t._delegate),xA(o,("string"==typeof t||t instanceof iA?vA(a,"updateDoc",e._key,t,n,r):mA(a,"updateDoc",e._key,t)).toMutations(e._key,Sb.exists(!0)))}function PA(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];t instanceof hC&&(t=t._delegate);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||aC(n[i])||(r=n[i],i++);var o,a,s,u,c,l,h={includeMetadataChanges:r.includeMetadataChanges};return aC(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),t instanceof MA?(s=iC(t.firestore,MC),u=Jy(t._key.path),l={next:function(e){n[i]&&n[i](LA(s,t,e))},error:n[i+1],complete:n[i+2]}):(a=iC(t,UA),s=iC(a.firestore,MC),u=a._query,c=new DA(s),l={next:function(e){n[i]&&n[i](new Dk(s,c,a,e))},error:n[i+1],complete:n[i+2]},ak(t._query)),function(t,e,n){var r=this,i=new OS(l),o=new VT(e,i,n);return t.asyncQueue.enqueueAndForget(function(){return go(r,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,YS(t)];case 1:return[2,UT(e.sent(),o)]}})})}),function(){i.mute(),t.asyncQueue.enqueueAndForget(function(){return go(r,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,YS(t)];case 1:return[2,qT(e.sent(),o)]}})})})}}(zk(s),u,h)}function xA(e,t){return function(t,n){var e=this,r=new Z_;return t.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,QS(t)];case 1:return[2,oI(e.sent(),n,r)]}})})}),r.promise}(zk(e),t)}function LA(e,t,n){Mg(n.docs.size<=1,"Expected zero or a single result on a document-only query");var r=n.docs.get(t._key),i=new DA(e);return new Sk(e,i,t._key,r,new oN(n.hasPendingWrites,n.fromCache),t._converter)}var MA=(Object.defineProperty(FA.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(FA.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(FA.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(FA.prototype,"parent",{get:function(){return new uk(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),FA.prototype.withConverter=function(e){return new FA(this.firestore,e,this._key)},FA);function FA(e,t,n){this._converter=t,this._key=n,this.type="document",this.firestore=e}var UA=(qA.prototype.withConverter=function(e){return new qA(this.firestore,e,this._query)},qA);function qA(e,t,n){this._converter=t,this._query=n,this.type="query",this.firestore=e}function jA(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++)e=i[r]._apply(e);return e}var VA,BA=(fo(KA,VA=fe=function(){}),KA.prototype._apply=function(e){var t=mk(e.firestore),t=function(e,t,n,r,i,o){if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ik(o,i);for(var a=[],s=0,u=o;s<u.length;s++){var c=u[s];a.push(rk(n,e,c))}l={arrayValue:{values:a}}}else l=rk(n,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ik(o,i),l=bA(t,"where",o,"in"===i||"not-in"===i);var l=pm.create(r,i,l);return function(e,t){if(Mg(t instanceof pm,"Only FieldFilters are supported"),t.isInequality()){var n=tm(e);if(null!==n&&!n.isEqual(t.field))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");null!==(n=em(e))&&ok(0,t.field,n)}if(null!==(e=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(Mg(i instanceof pm,"Only FieldFilters are supported"),0<=t.indexOf(i.op))return i.op}return null}(e,function(){switch(t.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw e===t.op?new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+e.toString()+"' filters.")}(e,l),l}(e._query,t,e.firestore._databaseId,this._field,this._op,this._value);return new UA(e.firestore,e._converter,(Mg(null==tm(e=e._query)||!(t instanceof pm)||!t.isInequality()||t.field.isEqual(tm(e)),"Query must only have one inequality field."),Mg(!nm(e),"No filtering allowed for document query"),t=e.filters.concat([t]),new Yy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),t,e.limit,e.limitType,e.startAt,e.endAt)))},KA);function KA(e,t,n){var r=VA.call(this)||this;return r._field=e,r._op=t,r._value=n,r.type="where",r}var WA,zA=(fo(HA,WA=fe),HA.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=new Vm(t,n),t=n,null!==em(e)||null!==(e=tm(e))&&ok(0,e,t.field),n}(e._query,this._field,this._direction);return new UA(e.firestore,e._converter,(Mg(!(e=e._query).startAt&&!e.endAt,"Bounds must be set after orderBy"),t=e.explicitOrderBy.concat([t]),new Yy(e.path,e.collectionGroup,t,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},HA);function HA(e,t){var n=WA.call(this)||this;return n._field=e,n._direction=t,n.type="orderBy",n}var GA,QA=(fo(YA,GA=fe),YA.prototype._apply=function(e){return new UA(e.firestore,e._converter,am(e._query,this._limit,this._limitType))},YA);function YA(e,t,n){var r=GA.call(this)||this;return r.type=e,r._limit=t,r._limitType=n,r}var XA,JA=(fo($A,XA=fe),$A.prototype._apply=function(e){var t=nk(e,this.type,this._docOrFields,this._before);return new UA(e.firestore,e._converter,(e=e._query,new Yy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)))},$A);function $A(e,t,n){var r=XA.call(this)||this;return r.type=e,r._docOrFields=t,r._before=n,r}var ZA,ek=(fo(tk,ZA=fe),tk.prototype._apply=function(e){var t=nk(e,this.type,this._docOrFields,this._before);return new UA(e.firestore,e._converter,(e=e._query,new Yy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)))},tk);function tk(e,t,n){var r=ZA.call(this)||this;return r.type=e,r._docOrFields=t,r._before=n,r}function nk(e,c,t,n){if(t[0]instanceof hC&&(t[0]=t[0]._delegate),t[0]instanceof vk)return function(e,t,n,r){if(!n)throw new Sg(Ig.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,a=im(e);o<a.length;o++){var s=a[o];if(s.field.isKeyField())i.push(Ay(t,n.key));else{var u=n.field(s.field);if(gy(u))throw new Sg(Ig.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u)throw s=s.field.canonicalString(),new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+s+"' (used as the orderBy) does not exist.");i.push(u)}}return new Fm(i,r)}(e._query,e.firestore._databaseId,t[0]._document,n);var r=mk(e.firestore);return function(e,t,n,r,i,o){var a=e.explicitOrderBy;if(i.length>a.length)throw new Sg(Ig.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!rm(e)&&-1!==c.indexOf("/"))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=e.path.child(ry.fromString(c));if(!cy.isDocumentKey(l))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");l=new cy(l),s.push(Ay(t,l))}else c=bA(n,r,c),s.push(c)}return new Fm(s,o)}(e._query,e.firestore._databaseId,r,c,t,n)}function rk(e,t,n){if(n instanceof hC&&(n=n._delegate),"string"==typeof n){if(""===n)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!rm(t)&&-1!==n.indexOf("/"))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(t=t.path.child(ry.fromString(n)),!cy.isDocumentKey(t))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return Ay(e,new cy(t))}if(n instanceof MA)return Ay(e,n._key);throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+rC(n)+".")}function ik(e,t){if(!Array.isArray(e)||0===e.length)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(10<e.length)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function ok(e,t,n){if(!n.isEqual(t))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ak(e){if(Zy(e)&&0===e.explicitOrderBy.length)throw new Sg(Ig.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sk,uk=(fo(ck,sk=UA),Object.defineProperty(ck.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(ck.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(ck.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new MA(this.firestore,null,new cy(e))},enumerable:!1,configurable:!0}),ck.prototype.withConverter=function(e){return new ck(this.firestore,e,this._path)},ck);function ck(e,t,n){return(t=sk.call(this,e,t,Jy(n))||this).firestore=e,t._path=n,t.type="collection",t}function lk(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof hC&&(e=e._delegate),$S("collection","path",t),e instanceof PC)return nC(n=ry.fromString.apply(ry,_o([t],r))),new uk(e,null,n);if(!(e instanceof MA||e instanceof uk))throw new Sg(Ig.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return nC(n=ry.fromString.apply(ry,_o([e.path],r)).child(ry.fromString(t))),new uk(e.firestore,null,n)}function hk(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof hC&&(e=e._delegate),1===arguments.length&&(t=Ug.newId()),$S("doc","path",t),e instanceof PC)return tC(n=ry.fromString.apply(ry,_o([t],r))),new MA(e,null,new cy(n));if(!(e instanceof MA||e instanceof uk))throw new Sg(Ig.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tC(n=e._path.child(ry.fromString.apply(ry,_o([t],r)))),new MA(e.firestore,e instanceof uk?e._converter:null,new cy(n))}var fk,pk=(fo(dk,fk=he),dk.prototype.convertBytes=function(e){return new cC(e)},dk.prototype.convertReference=function(e){return e=this.convertDocumentKey(e,this.firestore._databaseId),new MA(this.firestore,null,e)},dk);function dk(e){var t=fk.call(this)||this;return t.firestore=e,t}function gk(e,t){return e instanceof hC&&(e=e._delegate),t instanceof hC&&(t=t._delegate),(e instanceof MA||e instanceof uk)&&(t instanceof MA||t instanceof uk)&&e.firestore===t.firestore&&e.path===t.path&&e._converter===t._converter}function yk(e,t){return e instanceof hC&&(e=e._delegate),t instanceof hC&&(t=t._delegate),e instanceof UA&&t instanceof UA&&e.firestore===t.firestore&&sm(e._query,t._query)&&e._converter===t._converter}function mk(e){var t=e._freezeSettings(),n=wS(e._databaseId);return new dA(e._databaseId,!!t.ignoreUndefinedProperties,n)}var vk=(Object.defineProperty(bk.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(bk.prototype,"ref",{get:function(){return new MA(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),bk.prototype.exists=function(){return null!==this._document},bk.prototype.data=function(){if(this._document){if(this._converter){var e=new wk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.toProto())}},bk.prototype.get=function(e){if(this._document&&null!==(e=this._document.data().field(Tk("DocumentSnapshot.get",e))))return this._userDataWriter.convertValue(e)},bk);function bk(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}var _k,wk=(fo(Ek,_k=vk),Ek.prototype.data=function(){return _k.prototype.data.call(this)},Ek);function Ek(){return null!==_k&&_k.apply(this,arguments)||this}function Tk(e,t){return"string"==typeof t?CA(e,t):(t instanceof hC?t._delegate:t)._internalPath}var Ik,Sk=(fo(Ck,Ik=vk),Ck.prototype.exists=function(){return Ik.prototype.exists.call(this)},Ck.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new kk(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.toProto(),e.serverTimestamps)}},Ck.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document&&null!==(e=this._document.data().field(Tk("DocumentSnapshot.get",e))))return this._userDataWriter.convertValue(e,t.serverTimestamps)},Ck);function Ck(e,t,n,r,i,o){return(o=Ik.call(this,e,t,n,r,o)||this)._firestore=e,o._firestoreImpl=e,o.metadata=i,o}var Ak,kk=(fo(Nk,Ak=Sk),Nk.prototype.data=function(e){return void 0===e&&(e={}),Ak.prototype.data.call(this,e)},Nk);function Nk(){return null!==Ak&&Ak.apply(this,arguments)||this}var Dk=(Object.defineProperty(Rk.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(Rk.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Rk.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Rk.prototype.forEach=function(t,n){var r=this;this._snapshot.docs.forEach(function(e){t.call(n,new kk(r._firestore,r._userDataWriter,e.key,e,new oN(r._snapshot.mutatedKeys.has(e.key),r._snapshot.fromCache),r.query._converter))})},Rk.prototype.docChanges=function(e){if(void 0===e&&(e={}),(e=!!e.includeMetadataChanges)&&this._snapshot.excludesMetadataChanges)throw new Sg(Ig.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,t){if(i._snapshot.oldDocs.isEmpty()){var n,r=0;return i._snapshot.docChanges.map(function(e){Mg(0===e.type,"Invalid event type for first snapshot"),Mg(!n||hm(i._snapshot.query)(n,e.doc)<0,"Got added events in wrong order");var t=new kk(i._firestore,i._userDataWriter,e.doc.key,e.doc,new oN(i._snapshot.mutatedKeys.has(e.doc.key),i._snapshot.fromCache),i.query._converter);return n=e.doc,{type:"added",doc:t,oldIndex:-1,newIndex:r++}})}var o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(e){var t=new kk(i._firestore,i._userDataWriter,e.doc.key,e.doc,new oN(i._snapshot.mutatedKeys.has(e.doc.key),i._snapshot.fromCache),i.query._converter),n=-1,r=-1;return 0!==e.type&&(Mg(0<=(n=o.indexOf(e.doc.key)),"Index for document not found"),o=o.delete(e.doc.key)),1!==e.type&&(r=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xg("Unknown change type: "+e)}}(e.type),doc:t,oldIndex:n,newIndex:r}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},Rk);function Rk(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new oN(r.hasPendingWrites,r.fromCache),this.query=n}function Ok(e,t){return e instanceof Sk&&t instanceof Sk?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Dk&&t instanceof Dk&&e._firestore===t._firestore&&yk(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}var Pk=(xk.prototype.set=function(e,t,n){return this._verifyNotCommitted(),t=CN((e=Lk(e,this._firestore))._converter,t,n),n=yA(this._dataReader,"WriteBatch.set",e._key,t,null!==e._converter,n),this._mutations=this._mutations.concat(n.toMutations(e._key,Sb.none())),this},xk.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this._verifyNotCommitted(),e=Lk(e,this._firestore),t instanceof hC&&(t=t._delegate),t="string"==typeof t||t instanceof iA?vA(this._dataReader,"WriteBatch.update",e._key,t,n,r):mA(this._dataReader,"WriteBatch.update",e._key,t),this._mutations=this._mutations.concat(t.toMutations(e._key,Sb.exists(!0))),this},xk.prototype.delete=function(e){return this._verifyNotCommitted(),e=Lk(e,this._firestore),this._mutations=this._mutations.concat(new Hb(e._key,Sb.none())),this},xk.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},xk.prototype._verifyNotCommitted=function(){if(this._committed)throw new Sg(Ig.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},xk);function xk(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=mk(e)}function Lk(e,t){if(e instanceof hC&&(e=e._delegate),e.firestore!==t)throw new Sg(Ig.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Mk(e,t){this._firestore=e,this._transaction=t,this._dataReader=mk(e)}Mk.prototype.get=function(e){var t=this,n=Lk(e,this._firestore),r=new pk(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return xg("Mismatch in docs returned from document lookup.");if((e=e[0])instanceof qy)return new vk(t._firestore,r,n._key,null,n._converter);if(e instanceof My)return new vk(t._firestore,r,e.key,e,n._converter);throw xg("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},Mk.prototype.set=function(e,t,n){return t=CN((e=Lk(e,this._firestore))._converter,t,n),n=yA(this._dataReader,"Transaction.set",e._key,t,null!==e._converter,n),this._transaction.set(e._key,n),this},Mk.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return e=Lk(e,this._firestore),t instanceof hC&&(t=t._delegate),t="string"==typeof t||t instanceof iA?vA(this._dataReader,"Transaction.update",e._key,t,n,r):mA(this._dataReader,"Transaction.update",e._key,t),this._transaction.update(e._key,t),this},Mk.prototype.delete=function(e){return e=Lk(e,this._firestore),this._transaction.delete(e._key),this};var Fk,Uk=(fo(qk,Fk=fe=Mk),qk.prototype.get=function(e){var t=this,n=Lk(e,this._firestore),r=new DA(this._firestore);return Fk.prototype.get.call(this,e).then(function(e){return new Sk(t._firestore,r,n._key,e._document,new oN(!1,!1),n._converter)})},qk);function qk(e,t){return(t=Fk.call(this,e,t)||this)._firestore=e,t}var jk=(Vk.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){jC(e=iC(e,MC));var n=zk(e),r=e._freezeSettings();return UC(n,e=new DS,new SS(e,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},Vk.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){jC(e=iC(e,MC));var t=zk(e),n=e._freezeSettings();return UC(t,e=new DS,new kS(e,n.cacheSizeBytes))}(e._delegate)},Vk.prototype.clearIndexedDbPersistence=function(e){return function(n){var e=this;if(n._initialized&&!n._terminated)throw new Sg(Ig.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Z_;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return tw.isAvailable()?(t=n+fE,[4,tw.delete(t)]):[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(EE(n._databaseId,n._persistenceKey))];case 1:return e.sent(),r.resolve(),[3,3];case 2:return t=e.sent(),r.reject(t),[3,3];case 3:return[2]}})})}),r.promise}(e._delegate)},Vk);function Vk(){}var Bk,Kk=(fo(Wk,Bk=hC),Object.defineProperty(Wk.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),Wk.prototype.settings=function(e){e.merge&&delete(e=Object.assign(Object.assign({},this._delegate._getSettings()),e)).merge,this._delegate._setSettings(e)},Wk.prototype.useEmulator=function(e,t){"firestore.googleapis.com"!==this._delegate._getSettings().host&&Og("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:e+":"+t,ssl:!1,merge:!0})},Wk.prototype.enableNetwork=function(){return function(r){var e=this;return r.asyncQueue.enqueue(function(){return go(e,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,zS(r)];case 1:return t=e.sent(),[4,GS(r)];case 2:return n=e.sent(),t.setNetworkEnabled(!0),[2,((e=Fg(e=n,tT)).offlineCauses.delete(0),nT(e))]}})})})}(zk(iC(this._delegate,MC)))},Wk.prototype.disableNetwork=function(){return function(r){var e=this;return r.asyncQueue.enqueue(function(){return go(e,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,zS(r)];case 1:return t=e.sent(),[4,GS(r)];case 2:return n=e.sent(),t.setNetworkEnabled(!1),[2,function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return(t=Fg(n,tT)).offlineCauses.add(0),[4,rT(t)];case 1:return e.sent(),t.onlineStateTracker.set("Offline"),[2]}})})}(n)]}})})})}(zk(iC(this._delegate,MC)))},Wk.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&eC("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)},Wk.prototype.clearPersistence=function(){return this._persistenceProvider.clearIndexedDbPersistence(this)},Wk.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._delegate._delete()},Wk.prototype.waitForPendingWrites=function(){return qC(this._delegate)},Wk.prototype.onSnapshotsInSync=function(e){return function(n,e){var t=this,r=new OS(e);return n.asyncQueue.enqueueAndForget(function(){return go(t,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,YS(n)];case 1:return t=e.sent(),[2,(e=r,Fg(t,FT).snapshotsInSyncListeners.add(e),void e.next())]}})})}),function(){r.mute(),n.asyncQueue.enqueueAndForget(function(){return go(t,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,YS(n)];case 1:return t=e.sent(),[2,(e=r,void Fg(t,FT).snapshotsInSyncListeners.delete(e))]}})})})}}(zk(iC(this._delegate,MC)),aC(e)?e:{next:e})},Object.defineProperty(Wk.prototype,"app",{get:function(){if(!this._appCompat)throw new Sg(Ig.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat},enumerable:!1,configurable:!0}),Wk.prototype.collection=function(e){try{return new TN(this,lk(this._delegate,e))}catch(e){throw nN(e,"collection()","Firestore.collection()")}},Wk.prototype.doc=function(e){try{return new eN(this,hk(this._delegate,e))}catch(e){throw nN(e,"doc()","Firestore.doc()")}},Wk.prototype.collectionGroup=function(e){try{return new dN(this,function(e,t){if(e=iC(e,PC),$S("collectionGroup","collection id",t),0<=t.indexOf("/"))throw new Sg(Ig.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new UA(e,null,new Yy(ry.emptyPath(),t))}(this._delegate,e))}catch(e){throw nN(e,"collectionGroup()","Firestore.collectionGroup()")}},Wk.prototype.runTransaction=function(t){var n=this,r=this._delegate,i=function(e){return t(new Qk(n,e))};return function(n,r){var e=this,i=new Z_;return n.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,WS(n).then(function(e){return e.datastore})];case 1:return t=e.sent(),new MS(n.asyncQueue,t,r,i).run(),[2]}})})}),i.promise}(zk(r),function(e){return i(new Uk(r,e))})},Wk.prototype.batch=function(){var t=this;return zk(this._delegate),new Jk(new Pk(this._delegate,function(e){return xA(t._delegate,e)}))},Wk);function Wk(e,t,n){var r=Bk.call(this,t)||this;return r._persistenceProvider=n,r.INTERNAL={delete:function(){return r.terminate()}},e instanceof bg||(r._appCompat=e),r}function zk(e){return e._firestoreClient||Hk(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Hk(e){Mg(!!(r=e._freezeSettings()).host,"FirestoreSettings.host is not set"),Mg(!e._firestoreClient,"configureFirestore() called multiple times");var t,n,r=(t=e._databaseId,n=e._persistenceKey,new mg(t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));e._firestoreClient=new qS(e._credentials,e._queue,r)}var Gk,Qk=(fo(Yk,Gk=hC),Yk.prototype.get=function(e){var t=this,e=SN(e);return this._delegate.get(e).then(function(e){return new uN(t._firestore,e)})},Yk.prototype.set=function(e,t,n){return e=SN(e),n?(ZS("Transaction.set",n),this._delegate.set(e,t,n)):this._delegate.set(e,t),this},Yk.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=SN(e);return 2===arguments.length?this._delegate.update(o,t):(e=this._delegate).update.apply(e,_o([o,t,n],r)),this},Yk.prototype.delete=function(e){return e=SN(e),this._delegate.delete(e),this},Yk);function Yk(e,t){return(t=Gk.call(this,t)||this)._firestore=e,t}var Xk,Jk=(fo($k,Xk=hC),$k.prototype.set=function(e,t,n){return e=SN(e),n?(ZS("WriteBatch.set",n),this._delegate.set(e,t,n)):this._delegate.set(e,t),this},$k.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=SN(e);return 2===arguments.length?this._delegate.update(o,t):(e=this._delegate).update.apply(e,_o([o,t,n],r)),this},$k.prototype.delete=function(e){return e=SN(e),this._delegate.delete(e),this},$k.prototype.commit=function(){return this._delegate.commit()},$k);function $k(){return null!==Xk&&Xk.apply(this,arguments)||this}var Zk,eN=(fo(tN,Zk=hC),tN.forPath=function(e,t,n){if(e.length%2!=0)throw new Sg(Ig.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new tN(t,new MA(t._delegate,n,new cy(e)))},tN.forKey=function(e,t,n){return new tN(t,new MA(t._delegate,n,e))},Object.defineProperty(tN.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(tN.prototype,"parent",{get:function(){return new TN(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(tN.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),tN.prototype.collection=function(e){try{return new TN(this.firestore,lk(this._delegate,e))}catch(e){throw nN(e,"collection()","DocumentReference.collection()")}},tN.prototype.isEqual=function(e){return e instanceof hC&&(e=e._delegate),e instanceof MA&&gk(this._delegate,e)},tN.prototype.set=function(e,t){t=ZS("DocumentReference.set",t);try{return function(e,t,n){e=iC(e,MA);var r=iC(e.firestore,MC),t=CN(e._converter,t,n);return xA(r,yA(mk(r),"setDoc",e._key,t,null!==e._converter,n).toMutations(e._key,Sb.none()))}(this._delegate,e,t)}catch(e){throw nN(e,"setDoc()","DocumentReference.set()")}},tN.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?OA(this._delegate,e):OA.apply(void 0,_o([this._delegate,e,t],n))}catch(e){throw nN(e,"updateDoc()","DocumentReference.update()")}},tN.prototype.delete=function(){return xA(iC((e=this._delegate).firestore,MC),[new Hb(e._key,Sb.none())]);var e},tN.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=rN(e),i=iN(e,function(e){return new uN(t.firestore,new Sk(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))});return PA(this._delegate,r,i)},tN.prototype.get=function(e){var t=this;return(e=("cache"===(null==e?void 0:e.source)?function(t){t=iC(t,MA);var n=iC(t.firestore,MC),e=zk(n),r=new DA(n);return function(t,n){var e=this,r=new Z_;return t.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,HS(t)];case 1:return[2,function(i,o,a){return go(this,void 0,void 0,function(){var r;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(t=o,(n=Fg(i,SE)).persistence.runTransaction("read document","readonly",function(e){return n.localDocuments.getDocument(e,t)}))];case 1:return(r=e.sent())instanceof My?a.resolve(r):r instanceof qy?a.resolve(null):a.reject(new Sg(Ig.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=kT(r=e.sent(),"Failed to get document '"+o+" from cache"),a.reject(r),[3,3];case 3:return[2]}var t,n})})}(e.sent(),n,r)]}})})}),r.promise}(e,t._key).then(function(e){return new Sk(n,r,t._key,e,new oN(e instanceof My&&e.hasLocalMutations,!0),t._converter)})}:"server"===(null==e?void 0:e.source)?function(t){t=iC(t,MA);var n=iC(t.firestore,MC);return XS(zk(n),t._key,{source:"server"}).then(function(e){return LA(n,t,e)})}:function(t){t=iC(t,MA);var n=iC(t.firestore,MC);return XS(zk(n),t._key).then(function(e){return LA(n,t,e)})})(this._delegate)).then(function(e){return new uN(t.firestore,new Sk(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))})},tN.prototype.withConverter=function(e){return new tN(this.firestore,this._delegate.withConverter(e))},tN);function tN(e,t){return(t=Zk.call(this,t)||this).firestore=e,t._userDataWriter=new bC(e),t}function nN(e,t,n){return e.message=e.message.replace(t,n),e}function rN(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!aC(r))return r}return{}}function iN(e,t){var n=aC(e[0])?e[0]:aC(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]};return{next:function(e){n.next&&n.next(t(e))},error:null===(e=n.error)||void 0===e?void 0:e.bind(n),complete:null===(e=n.complete)||void 0===e?void 0:e.bind(n)}}var oN=(aN.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},aN);function aN(e,t){this.hasPendingWrites=e,this.fromCache=t}var sN,uN=(fo(cN,sN=hC),Object.defineProperty(cN.prototype,"ref",{get:function(){return new eN(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(cN.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(cN.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(cN.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),cN.prototype.data=function(e){return this._delegate.data(e)},cN.prototype.get=function(e,t){return this._delegate.get(e,t)},cN.prototype.isEqual=function(e){return Ok(this._delegate,e._delegate)},cN);function cN(e,t){return(t=sN.call(this,t)||this)._firestore=e,t}var lN,hN=(fo(fN,lN=uN),fN.prototype.data=function(e){return Mg(void 0!==(e=this._delegate.data(e)),"Document in a QueryDocumentSnapshot should exist"),e},fN);function fN(){return null!==lN&&lN.apply(this,arguments)||this}var pN,dN=(fo(gN,pN=hC),gN.prototype.where=function(e,t,n){try{return new gN(this.firestore,jA(this._delegate,(i=t,o=n,r=Tk("where",e),new BA(r,i,o))))}catch(e){throw nN(e,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},gN.prototype.orderBy=function(e,t){try{return new gN(this.firestore,jA(this._delegate,(void 0===(r=t)&&(r="asc"),n=Tk("orderBy",e),new zA(n,r))))}catch(e){throw nN(e,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},gN.prototype.limit=function(e){try{return new gN(this.firestore,jA(this._delegate,(oC("limit",t=e),new QA("limit",t,"F"))))}catch(e){throw nN(e,"limit()","Query.limit()")}var t},gN.prototype.limitToLast=function(e){try{return new gN(this.firestore,jA(this._delegate,(oC("limitToLast",t=e),new QA("limitToLast",t,"L"))))}catch(e){throw nN(e,"limitToLast()","Query.limitToLast()")}var t},gN.prototype.startAt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new gN(this.firestore,jA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new JA("startAt",e,!0)}.apply(void 0,e)))}catch(e){throw nN(e,"startAt()","Query.startAt()")}},gN.prototype.startAfter=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new gN(this.firestore,jA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new JA("startAfter",e,!1)}.apply(void 0,e)))}catch(e){throw nN(e,"startAfter()","Query.startAfter()")}},gN.prototype.endBefore=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new gN(this.firestore,jA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new ek("endBefore",e,!0)}.apply(void 0,e)))}catch(e){throw nN(e,"endBefore()","Query.endBefore()")}},gN.prototype.endAt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new gN(this.firestore,jA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new ek("endAt",e,!1)}.apply(void 0,e)))}catch(e){throw nN(e,"endAt()","Query.endAt()")}},gN.prototype.isEqual=function(e){return yk(this._delegate,e._delegate)},gN.prototype.get=function(e){var t=this;return(e=("cache"===(null==e?void 0:e.source)?function(t){t=iC(t,UA);var n=iC(t.firestore,MC),e=zk(n),r=new DA(n);return function(t,n){var e=this,r=new Z_;return t.asyncQueue.enqueueAndForget(function(){return go(e,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,HS(t)];case 1:return[2,function(r,i,o){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,xE(r,i,!0)];case 1:return n=e.sent(),t=new JT(i,n.remoteKeys),n=t.computeDocChanges(n.documents),n=t.applyChanges(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=kT(n=e.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(e.sent(),n,r)]}})})}),r.promise}(e,t._query).then(function(e){return new Dk(n,r,t,e)})}:"server"===(null==e?void 0:e.source)?function(t){t=iC(t,UA);var n=iC(t.firestore,MC),e=zk(n),r=new DA(n);return JS(e,t._query,{source:"server"}).then(function(e){return new Dk(n,r,t,e)})}:function(t){t=iC(t,UA);var n=iC(t.firestore,MC),e=zk(n),r=new DA(n);return ak(t._query),JS(e,t._query).then(function(e){return new Dk(n,r,t,e)})})(this._delegate)).then(function(e){return new _N(t.firestore,new Dk(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))})},gN.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=rN(e),i=iN(e,function(e){return new _N(t.firestore,new Dk(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return PA(this._delegate,r,i)},gN.prototype.withConverter=function(e){return new gN(this.firestore,this._delegate.withConverter(e))},gN);function gN(e,t){return(t=pN.call(this,t)||this).firestore=e,t._userDataWriter=new bC(e),t}var yN,mN=(fo(vN,yN=hC),Object.defineProperty(vN.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(vN.prototype,"doc",{get:function(){return new hN(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(vN.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(vN.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),vN);function vN(e,t){return(t=yN.call(this,t)||this)._firestore=e,t}var bN,_N=(fo(wN,bN=hC),Object.defineProperty(wN.prototype,"query",{get:function(){return new dN(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(wN.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(wN.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(wN.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(wN.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new hN(t._firestore,e)})},enumerable:!1,configurable:!0}),wN.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map(function(e){return new mN(t._firestore,e)})},wN.prototype.forEach=function(t,n){var r=this;this._delegate.forEach(function(e){t.call(n,new hN(r._firestore,e))})},wN.prototype.isEqual=function(e){return Ok(this._delegate,e._delegate)},wN);function wN(e,t){return(t=bN.call(this,t)||this)._firestore=e,t}var EN,TN=(fo(IN,EN=dN),Object.defineProperty(IN.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(IN.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(IN.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new eN(this.firestore,e):null},enumerable:!1,configurable:!0}),IN.prototype.doc=function(e){try{return new eN(this.firestore,void 0===e?hk(this._delegate):hk(this._delegate,e))}catch(e){throw nN(e,"doc()","CollectionReference.doc()")}},IN.prototype.add=function(e){var t,n=this,r=this._delegate,i=e;return e=iC(r.firestore,MC),t=hk(r),i=CN(r._converter,i),xA(e,yA(mk(r.firestore),"addDoc",t._key,i,null!==r._converter,{}).toMutations(t._key,Sb.exists(!1))).then(function(){return t}).then(function(e){return new eN(n.firestore,e)})},IN.prototype.isEqual=function(e){return gk(this._delegate,e._delegate)},IN.prototype.withConverter=function(e){return new IN(this.firestore,this._delegate.withConverter(e))},IN);function IN(e,t){var n=EN.call(this,e,t)||this;return n.firestore=e,n._delegate=t,n}function SN(e){return e instanceof hC&&(e=e._delegate),iC(e,MA)}function CN(e,t,n){return t=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var AN,he=(fo(kN,AN=hC),kN.documentId=function(){return new kN(sy.keyField().canonicalString())},kN.prototype.isEqual=function(e){return e instanceof hC&&(e=e._delegate),e instanceof iA&&this._delegate._internalPath.isEqual(e._internalPath)},kN);function kN(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return AN.call(this,new(iA.bind.apply(iA,_o([void 0],e))))||this}var NN,fe=(fo(DN,NN=hC),DN.serverTimestamp=function(){var e=new GC("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new DN(e)},DN.delete=function(){var e=new KC("deleteField");return e._methodName="FieldValue.delete",new DN(e)},DN.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new XC("arrayUnion",e)}.apply(void 0,e);return n._methodName="FieldValue.arrayUnion",new DN(n)},DN.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new ZC("arrayRemove",e)}.apply(void 0,e);return n._methodName="FieldValue.arrayRemove",new DN(n)},DN.increment=function(e){return(e=new nA("increment",e))._methodName="FieldValue.increment",new DN(e)},DN.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},DN);function DN(){return null!==NN&&NN.apply(this,arguments)||this}var iu={Firestore:Kk,GeoPoint:sC,Timestamp:Wg,Blob:gC,Transaction:Qk,WriteBatch:Jk,DocumentReference:eN,DocumentSnapshot:uN,Query:dN,QueryDocumentSnapshot:hN,QuerySnapshot:_N,CollectionReference:TN,FieldPath:he,FieldValue:fe,setLogLevel:function(e){kg.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1},RN=function(e,t){return new Kk(e,new MC(e,t),new jk)};(Hn=jh).INTERNAL.registerComponent(new ga("firestore",function(e){var t=e.getProvider("app").getImmediate();return RN(t,e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},iu))),Hn.registerVersion("@firebase/firestore","2.0.4-1.0.0-eap-firestore-debug.9c6096f43");var ON,PN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xN=(fo(LN,ON=Error),LN);function LN(e,t,n){return t=ON.call(this,t)||this,Object.setPrototypeOf(t,LN.prototype),t.code=e,t.details=n,t}var MN=(FN.prototype.getAuthToken=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},FN.prototype.getInstanceIdToken=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(e){return[2,void 0]}return[2]})})},FN.prototype.getContext=function(){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,this.getAuthToken()];case 1:return t=e.sent(),[4,this.getInstanceIdToken()];case 2:return n=e.sent(),[2,{authToken:t,instanceIdToken:n}]}})})},FN);function FN(e,t){var n=this;this.auth=null,this.messaging=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(function(e){return n.auth=e},function(){}),this.messaging||t.get().then(function(e){return n.messaging=e},function(){})}function UN(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n]));return r}var qN=(jN.prototype.encode=function(e){var t=this;if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t.encode(e)});if("function"==typeof e||"object"==typeof e)return UN(e,function(e){return t.encode(e)});throw new Error("Data cannot be encoded in JSON: "+e)},jN.prototype.decode=function(e){var t=this;if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(function(e){return t.decode(e)}):"function"==typeof e||"object"==typeof e?UN(e,function(e){return t.decode(e)}):e},jN);function jN(){}var VN,BN=(Object.defineProperty(KN.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),KN.prototype._url=function(e){var t=this.app_.options.projectId;return null===this.emulatorOrigin?null!==this.customDomain?this.customDomain+"/"+e:"https://"+this.region+"-"+t+".cloudfunctions.net/"+e:this.emulatorOrigin+"/"+t+"/"+this.region+"/"+e},KN.prototype.useEmulator=function(e,t){this.emulatorOrigin="http://"+e+":"+t},KN.prototype.useFunctionsEmulator=function(e){this.emulatorOrigin=e},KN.prototype.httpsCallable=function(t,n){var r=this;return function(e){return r.call(t,e,n||{})}},KN.prototype.postJSON=function(r,i,o){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:o["Content-Type"]="application/json",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.fetchImpl(r,{method:"POST",body:JSON.stringify(i),headers:o})];case 2:return t=e.sent(),[3,4];case 3:return e.sent(),[2,{status:0,json:null}];case 4:n=null,e.label=5;case 5:return e.trys.push([5,7,,8]),[4,t.json()];case 6:return n=e.sent(),[3,8];case 7:return e.sent(),[3,8];case 8:return[2,{status:t.status,json:n}]}})})},KN.prototype.call=function(c,l,h){return go(this,void 0,void 0,function(){var i,o,a,s,u;return yo(this,function(e){switch(e.label){case 0:return i=this._url(c),l=this.serializer.encode(l),o={data:l},a={},[4,this.contextProvider.getContext()];case 1:return(s=e.sent()).authToken&&(a.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(a["Firebase-Instance-ID-Token"]=s.instanceIdToken),u=h.timeout||7e4,n=u,t=new Promise(function(e,t){r=setTimeout(function(){t(new xN("deadline-exceeded","deadline-exceeded"))},n)}),u=(s={timer:r,promise:t}).timer,s=s.promise,[4,Promise.race([WN(u,this.postJSON(i,o,a)),s,WN(u,this.cancelAllRequests)])];case 2:if(!(s=e.sent()))throw new xN("cancelled","Firebase Functions instance was deleted.");if(u=function(e,t,n){var r=function(){if(200<=e&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(),i=r,o=void 0;try{var a=t&&t.error;if(a){var s=a.status;if("string"==typeof s){if(!PN[s])return new xN("internal","internal");r=PN[s],i=s}"string"==typeof(s=a.message)&&(i=s),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(e){}return"ok"===r?null:new xN(r,i,o)}(s.status,s.json,this.serializer))throw u;if(!s.json)throw new xN("internal","Response is not valid JSON object.");if(void 0===(u=s.json.data)&&(u=s.json.result),void 0===u)throw new xN("internal","Response is missing data field.");return[2,{data:this.serializer.decode(u)}]}var n,r,t})})},KN);function KN(e,t,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=e,this.fetchImpl=i,this.serializer=new qN,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new MN(t,n),this.cancelAllRequests=new Promise(function(e){o.deleteService=function(){return e()}});try{var a=new URL(r);this.customDomain=a.origin,this.region="us-central1"}catch(e){this.customDomain=null,this.region=r}}function WN(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,r];case 1:return t=e.sent(),clearTimeout(n),[2,t]}})})}function zN(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function HN(n,r,i){var o,e=new Promise(function(e,t){zN(o=n[r].apply(n,i)).then(e,t)});return e.request=o,e}function GN(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function QN(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return HN(this[n],e,arguments)})})}function YN(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function XN(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=HN(e,n,arguments)).then(function(e){if(e)return new $N(e,t.request)});var e,t})})}function JN(e){this._index=e}function $N(e,t){this._cursor=e,this._request=t}function ZN(e){this._store=e}function eD(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function tD(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new eD(n)}function nD(e){this._db=e}function rD(e,t,n){var r=(t=HN(indexedDB,"open",[e,t])).request;return r&&(r.onupgradeneeded=function(e){n&&n(new tD(r.result,e.oldVersion,r.transaction))}),t.then(function(e){return new nD(e)})}function iD(e){return HN(indexedDB,"deleteDatabase",[e])}iu=jh,VN=fetch.bind(self),Hn={Functions:BN},iu.INTERNAL.registerComponent(new ga("functions",function(e,t){var n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),e=e.getProvider("messaging");return new BN(n,r,e,t,VN)},"PUBLIC").setServiceProps(Hn).setMultipleInstances(!0)),jh.registerVersion("@firebase/functions","0.6.1-1.0.0-eap-firestore-debug.9c6096f43"),GN(JN,"_index",["name","keyPath","multiEntry","unique"]),QN(JN,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),XN(JN,"_index",IDBIndex,["openCursor","openKeyCursor"]),GN($N,"_cursor",["direction","key","primaryKey","value"]),QN($N,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&($N.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),zN(t._request).then(function(e){if(e)return new $N(e,t._request)})})})}),ZN.prototype.createIndex=function(){return new JN(this._store.createIndex.apply(this._store,arguments))},ZN.prototype.index=function(){return new JN(this._store.index.apply(this._store,arguments))},GN(ZN,"_store",["name","keyPath","indexNames","autoIncrement"]),QN(ZN,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),XN(ZN,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),YN(ZN,"_store",IDBObjectStore,["deleteIndex"]),eD.prototype.objectStore=function(){return new ZN(this._tx.objectStore.apply(this._tx,arguments))},GN(eD,"_tx",["objectStoreNames","mode"]),YN(eD,"_tx",IDBTransaction,["abort"]),tD.prototype.createObjectStore=function(){return new ZN(this._db.createObjectStore.apply(this._db,arguments))},GN(tD,"_db",["name","version","objectStoreNames"]),YN(tD,"_db",IDBDatabase,["deleteObjectStore","close"]),nD.prototype.transaction=function(){return new eD(this._db.transaction.apply(this._db,arguments))},GN(nD,"_db",["name","version","objectStoreNames"]),YN(nD,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[ZN,JN].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e=(n=arguments,Array.prototype.slice.call(n)),t=e[e.length-1],n=this._store||this._index,r=n[i].apply(n,e.slice(0,-1));r.onsuccess=function(){t(r.result)}})})}),[JN,ZN].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,i=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(i.push(e.value),void 0===n||i.length!=n?e.continue():t(i)):t(i)})})})});var iu="0.4.19-1.0.0-eap-firestore-debug.9c6096f43",oD=1e4,aD="w:"+iu,sD="FIS_v2",uD="https://firebaseinstallations.googleapis.com/v1",cD=36e5,fe=((he={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',he["not-registered"]="Firebase Installation is not registered.",he["installation-not-found"]="Firebase Installation not found.",he["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',he["app-offline"]="Could not process request. Application offline.",he["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",he),lD=new Ko("installations","Installations",fe);function hD(e){return e instanceof Vo&&e.code.includes("request-failed")}function fD(e){return e=e.projectId,uD+"/projects/"+e+"/installations"}function pD(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}function dD(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,r.json()];case 1:return t=e.sent().error,[2,lD.create("request-failed",{requestName:n,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})]}})})}function gD(e){return e=e.apiKey,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function yD(e,t){return t=t.refreshToken,(e=gD(e)).append("Authorization",sD+" "+t),e}function mD(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return 500<=(t=e.sent()).status&&t.status<600?[2,n()]:[2,t]}})})}function vD(t){return new Promise(function(e){setTimeout(e,t)})}var bD=/^[cdef][\w-]{21}$/,_D="";function wD(e){return e.appName+"!"+e.appId}var ED=new Map;function TD(e,t){var n;ID(e=wD(e),t),n=e,e=t,(t=CD())&&t.postMessage({key:n,fid:e}),AD()}function ID(e,t){var n,r,i=ED.get(e);if(i)try{for(var o=mo(i),a=o.next();!a.done;a=o.next())(0,a.value)(t)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var SD=null;function CD(){return!SD&&"BroadcastChannel"in self&&((SD=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){ID(e.data.key,e.data.fid)}),SD}function AD(){0===ED.size&&SD&&(SD.close(),SD=null)}var kD="firebase-installations-database",ND=1,DD="firebase-installations-store",RD=null;function OD(){return RD=RD||rD(kD,ND,function(e){0===e.oldVersion&&e.createObjectStore(DD)})}function PD(o,a){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:return t=wD(o),[4,OD()];case 1:return r=e.sent(),[4,(r=(n=r.transaction(DD,"readwrite")).objectStore(DD)).get(t)];case 2:return i=e.sent(),[4,r.put(a,t)];case 3:return e.sent(),[4,n.complete];case 4:return e.sent(),i&&i.fid===a.fid||TD(o,a.fid),[2,a]}})})}function xD(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return t=wD(r),[4,OD()];case 1:return[4,(n=(n=e.sent()).transaction(DD,"readwrite")).objectStore(DD).delete(t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2]}})})}function LD(a,s){return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){switch(e.label){case 0:return t=wD(a),[4,OD()];case 1:return r=e.sent(),[4,(r=(n=r.transaction(DD,"readwrite")).objectStore(DD)).get(t)];case 2:return i=e.sent(),void 0!==(o=s(i))?[3,4]:[4,r.delete(t)];case 3:return e.sent(),[3,6];case 4:return[4,r.put(o,t)];case 5:e.sent(),e.label=6;case 6:return[4,n.complete];case 7:return e.sent(),!o||i&&i.fid===o.fid||TD(a,o.fid),[2,o]}})})}function MD(i){return go(this,void 0,void 0,function(){var r,t,n;return yo(this,function(e){switch(e.label){case 0:return[4,LD(i,function(e){var t,n;return e=UD(e||{fid:function(){try{var e=new Uint8Array(17);return(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16,e=btoa(String.fromCharCode.apply(String,bo(e))).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22),bD.test(e)?e:_D}catch(e){return _D}}(),registrationStatus:0}),t=i,e=0!==(n=e).registrationStatus?1===n.registrationStatus?{installationEntry:n,registrationPromise:function(i){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return[4,FD(i)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,vD(100)];case 3:return e.sent(),[4,FD(i)];case 4:return t=e.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,MD(i)];case 6:return r=e.sent(),n=r.installationEntry,(r=r.registrationPromise)?[2,r]:[2,n];case 7:return[2,t]}})})}(t)}:{installationEntry:n}:navigator.onLine?{installationEntry:n={fid:n.fid,registrationStatus:1,registrationTime:Date.now()},registrationPromise:t=function(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,7]),[4,function(a){var s=i.fid;return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){switch(e.label){case 0:return t=fD(a),n=gD(a),o={fid:s,authVersion:sD,appId:a.appId,sdkVersion:aD},r={method:"POST",headers:n,body:JSON.stringify(o)},[4,mD(function(){return fetch(t,r)})];case 1:return(i=e.sent()).ok?[4,i.json()]:[3,3];case 2:return[2,{fid:(o=e.sent()).fid||s,registrationStatus:2,refreshToken:o.refreshToken,authToken:pD(o.authToken)}];case 3:return[4,dD("Create Installation",i)];case 4:throw e.sent()}})})}(r)];case 1:return t=e.sent(),[2,PD(r,t)];case 2:return hD(n=e.sent())&&409===n.customData.serverCode?[4,xD(r)]:[3,4];case 3:return e.sent(),[3,6];case 4:return[4,PD(r,{fid:i.fid,registrationStatus:0})];case 5:e.sent(),e.label=6;case 6:throw n;case 7:return[2]}})})}(t,n)}:{installationEntry:n,registrationPromise:Promise.reject(lD.create("app-offline"))},r=e.registrationPromise,e.installationEntry})];case 1:return(t=e.sent()).fid!==_D?[3,3]:(n={},[4,r]);case 2:return[2,(n.installationEntry=e.sent(),n)];case 3:return[2,{installationEntry:t,registrationPromise:r}]}})})}function FD(e){return LD(e,function(e){if(!e)throw lD.create("installation-not-found");return UD(e)})}function UD(e){return 1===e.registrationStatus&&e.registrationTime+oD<Date.now()?{fid:e.fid,registrationStatus:0}:e}function qD(e,s){var u=e.appConfig,c=e.platformLoggerProvider;return go(this,void 0,void 0,function(){var n,r,i,o,a;return yo(this,function(e){switch(e.label){case 0:return t=(t=s).fid,n=fD(u)+"/"+t+"/authTokens:generate",r=yD(u,s),(a=c.getImmediate({optional:!0}))&&r.append("x-firebase-client",a.getPlatformInfoString()),a={installation:{sdkVersion:aD}},i={method:"POST",headers:r,body:JSON.stringify(a)},[4,mD(function(){return fetch(n,i)})];case 1:return(o=e.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,pD(a=e.sent())];case 3:return[4,dD("Generate Auth Token",o)];case 4:throw e.sent()}var t})})}function jD(a,s){return void 0===s&&(s=!1),go(this,void 0,void 0,function(){var o,t,n;return yo(this,function(e){switch(e.label){case 0:return[4,LD(a.appConfig,function(e){if(!BD(e))throw lD.create("not-registered");var t,n,r,i=e.authToken;if(s||2!==(t=i).requestStatus||(n=t,(r=Date.now())<n.creationTime||n.creationTime+n.expiresIn<r+cD)){if(1===i.requestStatus)return o=function(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,VD(n.appConfig)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.authToken.requestStatus?[3,5]:[4,vD(100)];case 3:return e.sent(),[4,VD(n.appConfig)];case 4:return t=e.sent(),[3,2];case 5:return 0===(t=t.authToken).requestStatus?[2,jD(n,r)]:[2,t]}})})}(a,s),e;if(!navigator.onLine)throw lD.create("app-offline");return t=e,i={requestStatus:1,requestTime:Date.now()},i=po(po({},t),{authToken:i}),o=function(i,o){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,8]),[4,qD(i,o)];case 1:return t=e.sent(),r=po(po({},o),{authToken:t}),[4,PD(i.appConfig,r)];case 2:return e.sent(),[2,t];case 3:return!hD(n=e.sent())||401!==n.customData.serverCode&&404!==n.customData.serverCode?[3,5]:[4,xD(i.appConfig)];case 4:return e.sent(),[3,7];case 5:return r=po(po({},o),{authToken:{requestStatus:0}}),[4,PD(i.appConfig,r)];case 6:e.sent(),e.label=7;case 7:throw n;case 8:return[2]}})})}(a,i),i}return e})];case 1:return t=e.sent(),o?[4,o]:[3,3];case 2:return n=e.sent(),[3,4];case 3:n=t.authToken,e.label=4;case 4:return[2,n]}})})}function VD(e){return LD(e,function(e){if(!BD(e))throw lD.create("not-registered");var t=e.authToken;return 1===t.requestStatus&&t.requestTime+oD<Date.now()?po(po({},e),{authToken:{requestStatus:0}}):e})}function BD(e){return void 0!==e&&2===e.registrationStatus}function KD(o,a){return go(this,void 0,void 0,function(){var n,r,i;return yo(this,function(e){switch(e.label){case 0:return t=(t=a).fid,n=fD(o)+"/"+t,i=yD(o,a),r={method:"DELETE",headers:i},[4,mD(function(){return fetch(n,r)})];case 1:return(i=e.sent()).ok?[3,3]:[4,dD("Delete Installation",i)];case 2:throw e.sent();case 3:return[2]}var t})})}function WD(e){return lD.create("missing-app-config-values",{valueName:e})}(Hn=jh).INTERNAL.registerComponent(new ga("installations",function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:function(e){var t,n;if(!e||!e.options)throw WD("App Configuration");if(!e.name)throw WD("App Name");try{for(var r=mo(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw WD(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return function(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,MD(r.appConfig)];case 1:return t=e.sent(),n=t.installationEntry,(t.registrationPromise||jD(r)).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(e){return function(t,n){return void 0===n&&(n=!1),go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,MD(n)];case 1:return(t=e.sent().registrationPromise)?[4,t]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return e.sent(),[4,jD(t,n)];case 2:return[2,e.sent().token]}})})}(n,e)},delete:function(){return function(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,LD(t=r.appConfig,function(e){if(!e||0!==e.registrationStatus)return e})];case 1:if(!(n=e.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw lD.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw lD.create("app-offline");case 3:return[4,KD(t,n)];case 4:return e.sent(),[4,xD(t)];case 5:e.sent(),e.label=6;case 6:return[2]}})})}(n)},onIdChange:function(e){return function(e,t){CD();var n=wD(e);(e=ED.get(n))||(e=new Set,ED.set(n,e)),e.add(t)}(i=n.appConfig,r=e),function(){var e,t=r,n=wD(e=i);(e=ED.get(n))&&(e.delete(t),0===e.size&&ED.delete(n),AD())};var r,i}}},"PUBLIC")),Hn.registerVersion("@firebase/installations",iu);var zD,fe=((he={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',he["only-available-in-window"]="This method is available in a Window context.",he["only-available-in-sw"]="This method is available in a service worker context.",he["permission-default"]="The notification permission was not granted and dismissed instead.",he["permission-blocked"]="The notification permission was not granted and blocked instead.",he["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",he["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",he["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",he["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",he["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",he["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",he["token-update-no-token"]="FCM returned no token when updating the user to push.",he["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",he["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",he["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",he["invalid-vapid-key"]="The public VAPID key must be a string.",he["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",he),HD=new Ko("messaging","Messaging",fe),GD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",QD="https://fcmregistrations.googleapis.com/v1",YD="FCM_MSG",XD="google.c.a.c_id";function JD(e){return e=new Uint8Array(e),btoa(String.fromCharCode.apply(String,bo(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(he=zD={}).PUSH_RECEIVED="push-received",he.NOTIFICATION_CLICKED="notification-clicked";var $D="fcm_token_details_db",ZD=5,eR="fcm_token_object_Store";var tR="firebase-messaging-database",nR=1,rR="firebase-messaging-store",iR=null;function oR(){return iR=iR||rD(tR,nR,function(e){0===e.oldVersion&&e.createObjectStore(rR)})}function aR(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return t=uR(r),[4,oR()];case 1:return[4,e.sent().transaction(rR).objectStore(rR).get(t)];case 2:return(t=e.sent())?[2,t]:[3,3];case 3:return[4,function(a){return go(this,void 0,void 0,function(){var o,t=this;return yo(this,function(e){switch(e.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!e.sent().map(function(e){return e.name}).includes($D))return[2,null];e.label=2;case 2:return o=null,[4,rD($D,ZD,function(i){return go(t,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return!(i.oldVersion<2)&&i.objectStoreNames.contains(eR)?[4,(r=i.transaction.objectStore(eR)).index("fcmSenderId").get(a)]:[2];case 1:return t=e.sent(),[4,r.clear()];case 2:if(e.sent(),!t)return[2];if(2===i.oldVersion){if(!(n=t).auth||!n.p256dh||!n.endpoint)return[2];o={token:n.fcmToken,createTime:null!==(r=n.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:n.auth,p256dh:n.p256dh,endpoint:n.endpoint,swScope:n.swScope,vapidKey:"string"==typeof n.vapidKey?n.vapidKey:JD(n.vapidKey)}}}else 3!==i.oldVersion&&4!==i.oldVersion||(o={token:(n=t).fcmToken,createTime:n.createTime,subscriptionOptions:{auth:JD(n.auth),p256dh:JD(n.p256dh),endpoint:n.endpoint,swScope:n.swScope,vapidKey:JD(n.vapidKey)}});return[2]}})})})];case 3:return e.sent().close(),[4,iD($D)];case 4:return e.sent(),[4,iD("fcm_vapid_details_db")];case 5:return e.sent(),[4,iD("undefined")];case 6:return e.sent(),[2,function(e){if(e&&e.subscriptionOptions){var t=e.subscriptionOptions;return"number"==typeof e.createTime&&0<e.createTime&&"string"==typeof e.token&&0<e.token.length&&"string"==typeof t.auth&&0<t.auth.length&&"string"==typeof t.p256dh&&0<t.p256dh.length&&"string"==typeof t.endpoint&&0<t.endpoint.length&&"string"==typeof t.swScope&&0<t.swScope.length&&"string"==typeof t.vapidKey&&0<t.vapidKey.length}}(o)?o:null]}})})}(r.appConfig.senderId)];case 4:return(n=e.sent())?[4,sR(r,n)]:[3,6];case 5:return e.sent(),[2,n];case 6:return[2]}})})}function sR(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return t=uR(r),[4,oR()];case 1:return[4,(n=(n=e.sent()).transaction(rR,"readwrite")).objectStore(rR).put(i,t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2,i]}})})}function uR(e){return e.appConfig.appId}function cR(r,i){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,hR(r)];case 1:t={method:"DELETE",headers:t=e.sent()},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(lR(r.appConfig)+"/"+i,t)];case 3:return[4,e.sent().json()];case 4:if((t=e.sent()).error)throw n=t.error.message,HD.create("token-unsubscribe-failed",{errorInfo:n});return[3,6];case 5:throw n=e.sent(),HD.create("token-unsubscribe-failed",{errorInfo:n});case 6:return[2]}})})}function lR(e){return e=e.projectId,QD+"/projects/"+e+"/registrations"}function hR(e){var n=e.appConfig,r=e.installations;return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,r.getToken()];case 1:return t=e.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}})})}function fR(e){var t=e.p256dh,n=e.auth,t={web:{endpoint:e.endpoint,auth:n,p256dh:t}};return(e=e.vapidKey)!==GD&&(t.web.applicationPubKey=e),t}function pR(u,c,l){return go(this,void 0,void 0,function(){var o,a,s;return yo(this,function(e){switch(e.label){case 0:if("granted"!==Notification.permission)throw HD.create("permission-blocked");return[4,function(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,n.pushManager.getSubscription()];case 1:return(t=e.sent())?[2,t]:[2,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}(r)})]}})})}(c,l)];case 1:return s=e.sent(),[4,aR(u)];case 2:return o=e.sent(),a={vapidKey:l,swScope:c.scope,endpoint:s.endpoint,auth:JD(s.getKey("auth")),p256dh:JD(s.getKey("p256dh"))},o?[3,3]:[2,gR(u,a)];case 3:if(t=o.subscriptionOptions,n=a.vapidKey===t.vapidKey,r=a.endpoint===t.endpoint,i=a.auth===t.auth,t=a.p256dh===t.p256dh,n&&r&&i&&t)return[3,8];e.label=4;case 4:return e.trys.push([4,6,,7]),[4,cR(u,o.token)];case 5:return e.sent(),[3,7];case 6:return s=e.sent(),console.warn(s),[3,7];case 7:return[2,gR(u,a)];case 8:return Date.now()>=o.createTime+6048e5?[2,function(i,o,a){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,5]),[4,function(o,a){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:return[4,hR(o)];case 1:t=e.sent(),n=fR(a.subscriptionOptions),n={method:"PATCH",headers:t,body:JSON.stringify(n)},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(lR(o.appConfig)+"/"+a.token,n)];case 3:return[4,e.sent().json()];case 4:return r=e.sent(),[3,6];case 5:throw i=e.sent(),HD.create("token-update-failed",{errorInfo:i});case 6:if(r.error)throw i=r.error.message,HD.create("token-update-failed",{errorInfo:i});if(!r.token)throw HD.create("token-update-no-token");return[2,r.token]}})})}(o,i)];case 1:return t=e.sent(),n=po(po({},i),{token:t,createTime:Date.now()}),[4,sR(o,n)];case 2:return e.sent(),[2,t];case 3:return r=e.sent(),[4,dR(o,a)];case 4:throw e.sent(),r;case 5:return[2]}})})}({token:o.token,createTime:Date.now(),subscriptionOptions:a},u,c)]:[2,o.token];case 9:return[2]}var t,n,r,i})})}function dR(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,aR(n)];case 1:return(t=e.sent())?[4,cR(n,t.token)]:[3,4];case 2:return e.sent(),[4,function(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return t=uR(r),[4,oR()];case 1:return[4,(n=(n=e.sent()).transaction(rR,"readwrite")).objectStore(rR).delete(t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2]}})})}(n)];case 3:e.sent(),e.label=4;case 4:return[4,r.pushManager.getSubscription()];case 5:return(t=e.sent())?[2,t.unsubscribe()]:[2,!0]}})})}function gR(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,function(o,a){return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:return[4,hR(o)];case 1:t=e.sent(),n=fR(a),n={method:"POST",headers:t,body:JSON.stringify(n)},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(lR(o.appConfig),n)];case 3:return[4,e.sent().json()];case 4:return r=e.sent(),[3,6];case 5:throw i=e.sent(),HD.create("token-subscribe-failed",{errorInfo:i});case 6:if(r.error)throw i=r.error.message,HD.create("token-subscribe-failed",{errorInfo:i});if(!r.token)throw HD.create("token-subscribe-no-token");return[2,r.token]}})})}(n,r)];case 1:return t={token:t=e.sent(),createTime:Date.now(),subscriptionOptions:r},[4,sR(n,t)];case 2:return e.sent(),[2,t.token]}})})}function yR(e){return"object"==typeof e&&e&&XD in e}function mR(t){return new Promise(function(e){setTimeout(e,t)})}var vR=(Object.defineProperty(bR.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),bR.prototype.setBackgroundMessageHandler=function(e){if(this.isOnBackgroundMessageUsed=!1,!e||"function"!=typeof e)throw HD.create("invalid-bg-handler");this.bgMessageHandler=e},bR.prototype.onBackgroundMessage=function(e){var t=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=e,function(){t.bgMessageHandler=null}},bR.prototype.getToken=function(){var n;return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return this.vapidKey?[3,2]:[4,aR(this.firebaseDependencies)];case 1:t=e.sent(),this.vapidKey=null!==(n=null===(n=null==t?void 0:t.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==n?n:GD,e.label=2;case 2:return[2,pR(this.firebaseDependencies,self.registration,this.vapidKey)]}})})},bR.prototype.deleteToken=function(){return dR(this.firebaseDependencies,self.registration)},bR.prototype.requestPermission=function(){throw HD.create("only-available-in-window")},bR.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw HD.create("use-vapid-key-after-get-token");if("string"!=typeof e||0===e.length)throw HD.create("invalid-vapid-key");this.vapidKey=e},bR.prototype.useServiceWorker=function(){throw HD.create("only-available-in-window")},bR.prototype.onMessage=function(){throw HD.create("only-available-in-window")},bR.prototype.onTokenRefresh=function(){throw HD.create("only-available-in-window")},bR.prototype.onPush=function(c){return go(this,void 0,void 0,function(){var a,s,u;return yo(this,function(e){switch(e.label){case 0:return(u=function(){var e=c.data;if(!e)return null;try{return e.json()}catch(e){return null}}())?[4,_R()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return(a=e.sent()).some(function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")})?[2,function(e,t){var n,r;t.isFirebaseMessaging=!0,t.messageType=zD.PUSH_RECEIVED;try{for(var i=mo(e),o=i.next();!o.done;o=i.next())o.value.postMessage(t)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(a,u)]:(s=!1,u.notification?[4,((o=po({},(r=u).notification)).data=((i={})[YD]=r,i),n=(t=o).actions,r=Notification.maxActions,n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(r=t.title)&&void 0!==r?r:"",t))]:[3,3]);case 2:e.sent(),s=!0,e.label=3;case 3:return!0===s&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(o={from:(i=u).from,collapseKey:i.collapse_key},n=o,(r=i).notification&&(n.notification={},(t=r.notification.title)&&(n.notification.title=t),(t=r.notification.body)&&(n.notification.body=t),(r=r.notification.image)&&(n.notification.image=r)),i.data&&(o.data=i.data),n=o,(r=i).fcmOptions&&(n.fcmOptions={},(i=r.fcmOptions.link)&&(n.fcmOptions.link=i),(r=r.fcmOptions.analytics_label)&&(n.fcmOptions.analyticsLabel=r)),u=o,"function"==typeof this.bgMessageHandler?this.bgMessageHandler(u):this.bgMessageHandler.next(u)),[4,mR(1e3)]);case 4:return e.sent(),[2]}var t,n,r,i,o})})},bR.prototype.onSubChange=function(n){var r;return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return n.newSubscription?[3,2]:[4,dR(this.firebaseDependencies,self.registration)];case 1:return e.sent(),[2];case 2:return[4,aR(this.firebaseDependencies)];case 3:return t=e.sent(),[4,dR(this.firebaseDependencies,self.registration)];case 4:return e.sent(),[4,pR(this.firebaseDependencies,self.registration,null!==(r=null===(r=null==t?void 0:t.subscriptionOptions)||void 0===r?void 0:r.vapidKey)&&void 0!==r?r:GD)];case 5:return e.sent(),[2]}})})},bR.prototype.onNotificationClick=function(u){var c;return go(this,void 0,void 0,function(){var r,i,o,a,s;return yo(this,function(e){switch(e.label){case 0:return!(r=null===(c=null===(c=u.notification)||void 0===c?void 0:c.data)||void 0===c?void 0:c[YD])||u.action?[2]:(u.stopImmediatePropagation(),u.notification.close(),n=null!==(t=null===(t=r.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==t?t:null===(n=r.notification)||void 0===n?void 0:n.click_action,(i=n||(yR(r.data)?self.location.origin:null))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,function(u){return go(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return yo(this,function(e){switch(e.label){case 0:return[4,_R()];case 1:t=e.sent();try{for(n=mo(t),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),u.host===o.host)return[2,i]}catch(e){a={error:e}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}})})}(o)]):[2]);case 1:return(s=e.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=e.sent(),[4,mR(3e3)];case 3:return e.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=e.sent(),e.label=6;case 6:return s?(r.messageType=zD.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}var t,n})})},bR);function bR(e){var t=this;this.firebaseDependencies=e,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",function(e){e.waitUntil(t.onPush(e))}),self.addEventListener("pushsubscriptionchange",function(e){e.waitUntil(t.onSubChange(e))}),self.addEventListener("notificationclick",function(e){e.waitUntil(t.onNotificationClick(e))})}function _R(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}var wR=(Object.defineProperty(ER.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),ER.prototype.messageEventListener=function(i){return go(this,void 0,void 0,function(){var n,r;return yo(this,function(e){switch(e.label){case 0:return(n=i.data).isFirebaseMessaging?(this.onMessageCallback&&n.messageType===zD.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback((delete(t=Object.assign({},n)).messageType,delete t.isFirebaseMessaging,t)):this.onMessageCallback.next(Object.assign({},n))),yR(r=n.data)&&"1"===r["google.c.a.e"]?[4,this.logEvent(n.messageType,r)]:[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return[2]}var t})})},ER.prototype.getVapidKey=function(){return this.vapidKey},ER.prototype.getSwReg=function(){return this.swRegistration},ER.prototype.getToken=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw HD.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,pR(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}})})},ER.prototype.updateVapidKey=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=GD),[2]})})},ER.prototype.updateSwReg=function(t){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw HD.create("invalid-sw-registration");return this.swRegistration=t,[2]}})})},ER.prototype.registerDefaultSw=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=e.sent(),this.swRegistration.update().catch(function(){}),[3,3];case 2:throw t=e.sent(),HD.create("failed-service-worker-registration",{browserErrorMessage:t.message});case 3:return[2]}})})},ER.prototype.deleteToken=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:return[2,dR(this.firebaseDependencies,this.swRegistration)]}})})},ER.prototype.requestPermission=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?HD.create("permission-blocked"):HD.create("permission-default")}})})},ER.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw HD.create("use-vapid-key-after-get-token");if("string"!=typeof e||0===e.length)throw HD.create("invalid-vapid-key");this.vapidKey=e},ER.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw HD.create("invalid-sw-registration");if(this.swRegistration)throw HD.create("use-sw-after-get-token");this.swRegistration=e},ER.prototype.onMessage=function(e){var t=this;return this.onMessageCallback=e,function(){t.onMessageCallback=null}},ER.prototype.setBackgroundMessageHandler=function(){throw HD.create("only-available-in-sw")},ER.prototype.onBackgroundMessage=function(){throw HD.create("only-available-in-sw")},ER.prototype.onTokenRefresh=function(){return function(){}},ER.prototype.logEvent=function(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return t=function(){switch(n){case zD.NOTIFICATION_CLICKED:return"notification_open";case zD.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return e.sent().logEvent(t,{message_id:r[XD],message_name:r["google.c.a.c_l"],message_time:r["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}})})},ER);function ER(e){var t=this;this.firebaseDependencies=e,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",function(e){return t.messageEventListener(e)})}function TR(e){return HD.create("missing-app-config-values",{valueName:e})}function IR(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}fe={isSupported:IR},jh.INTERNAL.registerComponent(new ga("messaging",function(e){var t=e.getProvider("app").getImmediate(),e={app:t,appConfig:function(e){var t,n;if(!e||!e.options)throw TR("App Configuration Object");if(!e.name)throw TR("App Name");var r=e.options;try{for(var i=mo(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw TR(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{appName:e.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(t),installations:e.getProvider("installations").getImmediate(),analyticsProvider:e.getProvider("analytics-internal")};if(!IR())throw HD.create("unsupported-browser");return new(self&&"ServiceWorkerGlobalScope"in self?vR:wR)(e)},"PUBLIC").setServiceProps(fe));var SR,CR="firebasestorage.googleapis.com",AR="storageBucket",kR=(fo(NR,SR=Vo),NR.prototype.codeEquals=function(e){return RR(e)===this.code},Object.defineProperty(NR.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(NR.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e},enumerable:!1,configurable:!0}),NR);function NR(e,t){return(e=SR.call(this,RR(e),"Firebase Storage: "+t+" ("+RR(e)+")")||this).customData={serverResponse:null},Object.setPrototypeOf(e,NR.prototype),e}var DR={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error",UNSUPPORTED_ENVIRONMENT:"unsupported-environment"};function RR(e){return"storage/"+e}function OR(){return new kR(DR.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function PR(){return new kR(DR.CANCELED,"User canceled the upload/download.")}function xR(){return new kR(DR.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function LR(e){return new kR(DR.INVALID_ARGUMENT,e)}function MR(){return new kR(DR.APP_DELETED,"The Firebase app was deleted.")}function FR(e){return new kR(DR.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function UR(e,t){return new kR(DR.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function qR(e){throw new kR(DR.INTERNAL_ERROR,"Internal error: "+e)}function jR(e,t){this.data=e,this.contentType=t||null}var VR={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function BR(e,t){switch(e){case VR.RAW:return new jR(KR(t));case VR.BASE64:case VR.BASE64URL:return new jR(WR(e,t));case VR.DATA_URL:return new jR((e=new zR(e=t)).base64?WR(VR.BASE64,e.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(e){throw UR(VR.DATA_URL,"Malformed data URL.")}return KR(t)}(e.rest),new zR(t).contentType)}throw OR()}function KR(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function WR(e,t){switch(e){case VR.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw UR(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case VR.BASE64URL:if(r=-1!==t.indexOf("+"),n=-1!==t.indexOf("/"),r||n)throw UR(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var i;try{i=atob(t)}catch(t){throw UR(e,"Invalid character found")}for(var o=new Uint8Array(i.length),a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return o}function zR(e){var t;if(this.base64=!1,(this.contentType=null)===(t=e.match(/^data:([^,]+)?,/)))throw UR(VR.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r=t[1]||null;null!=r&&(this.base64=(n=";base64",(t=r).length>=n.length&&t.substring(t.length-n.length)===n),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=e.substring(e.indexOf(",")+1)}var HR,GR="running",QR="pausing",YR="paused",XR="success",JR="canceling",$R="canceled",ZR="error",eO={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function tO(e){switch(e){case GR:case QR:case JR:return eO.RUNNING;case YR:return eO.PAUSED;case XR:return eO.SUCCESS;case $R:return eO.CANCELED;case ZR:default:return eO.ERROR}}(he=HR={})[he.NO_ERROR=0]="NO_ERROR",he[he.NETWORK_ERROR=1]="NETWORK_ERROR",he[he.ABORT=2]="ABORT";var nO=(rO.prototype.send=function(e,t,n,r){if(this.sent_)throw qR("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},rO.prototype.getErrorCode=function(){if(!this.sent_)throw qR("cannot .getErrorCode() before sending");return this.errorCode_},rO.prototype.getStatus=function(){if(!this.sent_)throw qR("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},rO.prototype.getResponseText=function(){if(!this.sent_)throw qR("cannot .getResponseText() before sending");return this.xhr_.responseText},rO.prototype.abort=function(){this.xhr_.abort()},rO.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},rO.prototype.addUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)},rO.prototype.removeUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)},rO);function rO(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=HR.NO_ERROR,this.sendPromise_=new Promise(function(e){t.xhr_.addEventListener("abort",function(){t.errorCode_=HR.ABORT,e(t)}),t.xhr_.addEventListener("error",function(){t.errorCode_=HR.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(){e(t)})})}var iO=(oO.prototype.createXhrIo=function(){return new nO},oO);function oO(){}function aO(e){return"string"==typeof e||e instanceof String}function sO(e){return uO()&&e instanceof Blob}function uO(){return"undefined"!=typeof Blob}function cO(e,t,n,r){if(r<t)throw new kR(DR.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+t+" or greater.");if(n<r)throw new kR(DR.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+n+" or less.")}var lO=(hO.prototype.size=function(){return this.size_},hO.prototype.type=function(){return this.type_},hO.prototype.slice=function(e,t){if(sO(this.data_)){var n=this.data_;return null===(i=(r=e,i=t,n.webkitSlice?n.webkitSlice(r,i):n.mozSlice?n.mozSlice(r,i):n.slice?n.slice(r,i):null))?null:new hO(i)}var r,i;return new hO(new Uint8Array(this.data_.buffer,e,t-e),!0)},hO.getBlob=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(uO()){var n=e.map(function(e){return e instanceof hO?e.data_:e});return new hO(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(uO())return new Blob(e);throw new kR(DR.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}.apply(null,n))}var n=e.map(function(e){return aO(e)?BR(VR.RAW,e).data:e.data_}),r=0;n.forEach(function(e){r+=e.byteLength});var i=new Uint8Array(r),o=0;return n.forEach(function(e){for(var t=0;t<e.length;t++)i[o++]=e[t]}),new hO(i,!0)},hO.prototype.uploadData=function(){return this.data_},hO);function hO(e,t){var n=0,r="";sO(e)?(n=(this.data_=e).size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}var fO=(Object.defineProperty(pO.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(pO.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),pO.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},pO.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},pO.makeFromBucketSpec=function(e){var t;try{t=pO.makeFromUrl(e)}catch(t){return new pO(e,"")}if(""===t.path)return t;throw new kR(DR.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")},pO.makeFromUrl=function(e){var t,n=null,r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}for(var o=CR.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:i}],s=0;s<a.length;s++){var u=a[s],c=u.regex.exec(e);if(c){n=new pO(c[u.indices.bucket],c[u.indices.path]||""),u.postModify(n);break}}if(null==n)throw t=e,new kR(DR.INVALID_URL,"Invalid URL '"+t+"'.");return n},pO);function pO(e,t){this.bucket=e,this.path_=t}function dO(e){var t;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof t||Array.isArray(t)?null:t}function gO(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function yO(e){return"https://"+CR+"/v0"+e}function mO(e){var t,n=encodeURIComponent,r="?";for(t in e)e.hasOwnProperty(t)&&(r=r+(n(t)+"="+n(e[t]))+"&");return r.slice(0,-1)}function vO(e,t){return t}var bO=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||vO},_O=null;function wO(){if(_O)return _O;var e=[];e.push(new bO("bucket")),e.push(new bO("generation")),e.push(new bO("metageneration")),e.push(new bO("name","fullPath",!0));var t=new bO("name");return t.xform=function(e,t){return!aO(t)||t.length<2?t:gO(t)},e.push(t),(t=new bO("size")).xform=function(e,t){return void 0!==t?Number(t):t},e.push(t),e.push(new bO("timeCreated")),e.push(new bO("updated")),e.push(new bO("md5Hash",null,!0)),e.push(new bO("cacheControl",null,!0)),e.push(new bO("contentDisposition",null,!0)),e.push(new bO("contentEncoding",null,!0)),e.push(new bO("contentLanguage",null,!0)),e.push(new bO("contentType",null,!0)),e.push(new bO("metadata","customMetadata",!0)),_O=e}function EO(e,t,n){return null===(t=dO(t))?null:function(e,t,n){for(var r,i,o={type:"file"},a=n.length,s=0;s<a;s++){var u=n[s];o[u.local]=u.xform(o,t[u.server])}return r=o,i=e,Object.defineProperty(r,"ref",{get:function(){var e=r.bucket,t=r.fullPath,t=new fO(e,t);return i.makeStorageReference(t)}}),o}(e,t,n)}function TO(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}var IO="prefixes",SO="items";var CO=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function AO(e){if(!e)throw OR()}function kO(n,r){return function(e,t){return AO(null!==(t=EO(n,t,r))),t}}function NO(o,a){return function(e,t){return AO(null!==(n=o,r=a,t=null===(i=dO(i=t))?null:function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[IO])for(var i=0,o=n[IO];i<o.length;i++){var a=o[i].replace(/\/$/,""),s=e.makeStorageReference(new fO(t,a));r.prefixes.push(s)}if(n[SO])for(var u=0,c=n[SO];u<c.length;u++){var l=c[u],s=e.makeStorageReference(new fO(t,l.name));r.items.push(s)}return r}(n,r,i))),t;var n,r,i}}function DO(i){return function(e,t){var n,r=401===e.getStatus()?new kR(DR.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(n=i.bucket,new kR(DR.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=i.path,new kR(DR.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):t;return r.serverResponse=t.serverResponse,r}}function RO(r){var i=DO(r);return function(e,t){var n=i(e,t);return 404===e.getStatus()&&(e=r.path,n=new kR(DR.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")),n.serverResponse=t.serverResponse,n}}function OO(e,t,n){var r=yO(t.fullServerUrl()),i=e.maxOperationRetryTime;return(i=new CO(r,"GET",kO(e,n),i)).errorHandler=RO(t),i}function PO(e,t,n){return(n=Object.assign({},n)).fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=(e=t,(t=null)&&t.contentType||e&&e.type()||"application/octet-stream")),n}function xO(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}function LO(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){AO(!1)}return AO(!!n&&-1!==(t||["active"]).indexOf(n)),n}function MO(e,t,n){"function"==typeof e||null!=t||null!=n?(this.next=e,this.error=t,this.complete=n):(this.next=e.next,this.error=e.error,this.complete=e.complete)}function FO(e,t,n,r,i,o){this.bytesTransferred=e,this.totalBytes=t,this.state=n,this.metadata=r,this.task=i,this.ref=o}function UO(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Promise.resolve().then(function(){return n.apply(void 0,e)})}}var qO=(jO.prototype._makeProgressCallback=function(){var t=this,n=this._transferred;return function(e){return t._updateProgress(n+e)}},jO.prototype._shouldDoResumable=function(e){return 262144<e.size()},jO.prototype._start=function(){this._state===GR&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},jO.prototype._resolveToken=function(t){var n=this;this._ref.storage.getAuthToken().then(function(e){switch(n._state){case GR:t(e);break;case JR:n._transition($R);break;case QR:n._transition(YR)}})},jO.prototype._createResumable=function(){var u=this;this._resolveToken(function(e){var t,n,r,i,o,a,s,t=(t=u._ref.storage,n=u._ref._location,r=u._mappings,i=u._blob,o=u._metadata,a=n.bucketOnlyServerUrl(),s=PO(n,i,o),o={name:s.fullPath},a=yO(a),i={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":i.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},r=TO(s,r),t=t.maxUploadRetryTime,(t=new CO(a,"POST",function(e){var t;LO(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){AO(!1)}return AO(aO(t)),t},t)).urlParams=o,t.headers=i,t.body=r,t.errorHandler=DO(n),t),e=u._ref.storage.makeRequest(t,e);(u._request=e).getPromise().then(function(e){u._request=void 0,u._uploadUrl=e,u._needToFetchStatus=!1,u.completeTransitions_()},u._errorHandler)})},jO.prototype._fetchStatus=function(){var o=this,a=this._uploadUrl;this._resolveToken(function(e){var t,n,r,i,t=(t=o._ref.storage,n=o._ref._location,r=a,i=o._blob,t=t.maxUploadRetryTime,(t=new CO(r,"POST",function(e){var t=LO(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){AO(!1)}n||AO(!1);var r=Number(n);return AO(!isNaN(r)),new xO(r,i.size(),"final"===t)},t)).headers={"X-Goog-Upload-Command":"query"},t.errorHandler=DO(n),t),e=o._ref.storage.makeRequest(t,e);(o._request=e).getPromise().then(function(e){o._request=void 0,o._updateProgress(e.current),o._needToFetchStatus=!1,e.finalized&&(o._needToFetchMetadata=!0),o.completeTransitions_()},o._errorHandler)})},jO.prototype._continueUpload=function(){var n=this,r=262144*this._chunkMultiplier,i=new xO(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken(function(e){var t;try{t=function(e,o,t,a,n,s,r,i){var u=new xO(0,0);if(r?(u.current=r.current,u.total=r.total):(u.current=0,u.total=a.size()),a.size()!==u.total)throw new kR(DR.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;if(0<n&&(l=Math.min(l,n)),n=(r=u.current)+l,c={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},null===(r=a.slice(r,n)))throw xR();return n=o.maxUploadRetryTime,(n=new CO(t,"POST",function(e,t){var n=LO(e,["active","final"]),r=u.current+l,i=a.size(),t="final"===n?kO(o,s)(e,t):null;return new xO(r,i,"final"===n,t)},n)).headers=c,n.body=r.uploadData(),n.progressCallback=i||null,n.errorHandler=DO(e),n}(n._ref._location,n._ref.storage,o,n._blob,r,n._mappings,i,n._makeProgressCallback())}catch(e){return n._error=e,void n._transition(ZR)}e=n._ref.storage.makeRequest(t,e),(n._request=e).getPromise().then(function(e){n._increaseMultiplier(),n._request=void 0,n._updateProgress(e.current),e.finalized?(n._metadata=e.metadata,n._transition(XR)):n.completeTransitions_()},n._errorHandler)})},jO.prototype._increaseMultiplier=function(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},jO.prototype._fetchMetadata=function(){var n=this;this._resolveToken(function(e){var t=OO(n._ref.storage,n._ref._location,n._mappings),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._metadata=e,n._transition(XR)},n._metadataErrorHandler)})},jO.prototype._oneShotUpload=function(){var n=this;this._resolveToken(function(e){var t=function(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=PO(t,r,i),i="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+TO(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",s="\r\n--"+s+"--";if(null===(r=lO.getBlob(i,r,s)))throw xR();return s={name:u.fullPath},u=yO(o),o=e.maxUploadRetryTime,(o=new CO(u,"POST",kO(e,n),o)).urlParams=s,o.headers=a,o.body=r.uploadData(),o.errorHandler=DO(t),o}(n._ref.storage,n._ref._location,n._mappings,n._blob,n._metadata),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._metadata=e,n._updateProgress(n._blob.size()),n._transition(XR)},n._errorHandler)})},jO.prototype._updateProgress=function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()},jO.prototype._transition=function(e){if(this._state!==e)switch(e){case JR:case QR:this._state=e,void 0!==this._request&&this._request.cancel();break;case GR:var t=this._state===YR;this._state=e,t&&(this._notifyObservers(),this._start());break;case YR:this._state=e,this._notifyObservers();break;case $R:this._error=PR(),this._state=e,this._notifyObservers();break;case ZR:case XR:this._state=e,this._notifyObservers()}},jO.prototype.completeTransitions_=function(){switch(this._state){case QR:this._transition(YR);break;case JR:this._transition($R);break;case GR:this._start()}},Object.defineProperty(jO.prototype,"snapshot",{get:function(){var e=tO(this._state);return new FO(this._transferred,this._blob.size(),e,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),jO.prototype.on=function(e,t,n,r){var i=this,o=new MO(t,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},jO.prototype.then=function(e,t){return this._promise.then(e,t)},jO.prototype.catch=function(e){return this.then(null,e)},jO.prototype._addObserver=function(e){this._observers.push(e),this._notifyObserver(e)},jO.prototype._removeObserver=function(e){-1!==(e=this._observers.indexOf(e))&&this._observers.splice(e,1)},jO.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach(function(e){t._notifyObserver(e)})},jO.prototype._finishPromise=function(){if(void 0!==this._resolve){var e=!0;switch(tO(this._state)){case eO.SUCCESS:UO(this._resolve.bind(null,this.snapshot))();break;case eO.CANCELED:case eO.ERROR:UO(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}},jO.prototype._notifyObserver=function(e){switch(tO(this._state)){case eO.RUNNING:case eO.PAUSED:e.next&&UO(e.next.bind(e,this.snapshot))();break;case eO.SUCCESS:e.complete&&UO(e.complete.bind(e))();break;case eO.CANCELED:case eO.ERROR:e.error&&UO(e.error.bind(e,this._error))();break;default:e.error&&UO(e.error.bind(e,this._error))()}},jO.prototype.resume=function(){var e=this._state===YR||this._state===QR;return e&&this._transition(GR),e},jO.prototype.pause=function(){var e=this._state===GR;return e&&this._transition(QR),e},jO.prototype.cancel=function(){var e=this._state===GR||this._state===QR;return e&&this._transition(JR),e},jO);function jO(e,t,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=wO(),this._resumable=this._shouldDoResumable(this._blob),this._state=GR,this._errorHandler=function(e){r._request=void 0,r._chunkMultiplier=1,e.codeEquals(DR.CANCELED)?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=e,r._transition(ZR))},this._metadataErrorHandler=function(e){r._request=void 0,e.codeEquals(DR.CANCELED)?r.completeTransitions_():(r._error=e,r._transition(ZR))},this._promise=new Promise(function(e,t){r._resolve=e,r._reject=t,r._start()}),this._promise.then(null,function(){})}var VO=(BO.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},BO.prototype.newRef=function(e,t){return new BO(e,t)},Object.defineProperty(BO.prototype,"root",{get:function(){var e=new fO(this._location.bucket,"");return this.newRef(this._service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(BO.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(BO.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(BO.prototype,"name",{get:function(){return gO(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(BO.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(BO.prototype,"parent",{get:function(){var e=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);return null===e?null:(e=new fO(this._location.bucket,e),new BO(this._service,e))},enumerable:!1,configurable:!0}),BO.prototype._throwIfRoot=function(e){if(""===this._location.path)throw FR(e)},BO);function BO(e,t){this._service=e,this._location=t instanceof fO?t:fO.makeFromUrl(t)}function KO(s,u){return go(this,void 0,void 0,function(){var o,a;return yo(this,function(e){switch(e.label){case 0:return null!=u&&"number"==typeof u.maxResults&&cO("options.maxResults",1,1e3,u.maxResults),[4,s.storage.getAuthToken()];case 1:return o=e.sent(),a=u||{},t=s.storage,n=s._location,r=a.pageToken,i=a.maxResults,e={},n.isRoot?e.prefix="":e.prefix=n.path+"/",0<"/".length&&(e.delimiter="/"),r&&(e.pageToken=r),i&&(e.maxResults=i),r=yO(n.bucketOnlyServerUrl()),i=t.maxOperationRetryTime,(i=new CO(r,"GET",NO(t,n.bucket),i)).urlParams=e,i.errorHandler=DO(n),[2,s.storage.makeRequest(i,o).getPromise()]}var t,n,r,i})})}function WO(u){return go(this,void 0,void 0,function(){var s;return yo(this,function(e){switch(e.label){case 0:return u._throwIfRoot("getDownloadURL"),[4,u.storage.getAuthToken()];case 1:return s=e.sent(),t=u.storage,n=u._location,o=wO(),a=yO(n.fullServerUrl()),e=t.maxOperationRetryTime,(e=new CO(a,"GET",(r=t,i=o,function(e,t){var n=EO(r,t,i);return AO(null!==n),function(r,e){if(null===(e=dO(e)))return null;if(!aO(e.downloadTokens))return null;if(0===(e=e.downloadTokens).length)return null;var i=encodeURIComponent;return e.split(",").map(function(e){var t=r.bucket,n=r.fullPath;return yO("/b/"+i(t)+"/o/"+i(n))+mO({alt:"media",token:e})})[0]}(n,t)}),e)).errorHandler=RO(n),[2,u.storage.makeRequest(e,s).getPromise().then(function(e){if(null===e)throw new kR(DR.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})]}var r,i,t,n,o,a})})}function zO(e,t){var n,t=(n=e._location.path,t=t.split("/").filter(function(e){return 0<e.length}).join("/"),0===n.length?t:n+"/"+t),t=new fO(e._location.bucket,t);return new VO(e.storage,t)}var HO=(Object.defineProperty(GO.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(GO.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(GO.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(GO.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),GO);function GO(e,t,n){this._delegate=e,this.task=t,this.ref=n}var QO=(Object.defineProperty(YO.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),YO.prototype.then=function(t,e){var n=this;return this._delegate.then(function(e){if(t)return t(new HO(e,n,n._ref))},e)},YO.prototype.on=function(e,t,n,r){var i=this,o=void 0;return t&&(o="function"==typeof t?function(e){return t(new HO(e,i,i._ref))}:{next:t.next?function(e){return t.next(new HO(e,i,i._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,o,n||void 0,r||void 0)},YO);function YO(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new HO(this._delegate.snapshot,this,this._ref)}var XO=(Object.defineProperty(JO.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map(function(e){return new $O(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(JO.prototype,"items",{get:function(){var t=this;return this._delegate.items.map(function(e){return new $O(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(JO.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),JO);function JO(e,t){this._delegate=e,this._service=t}var $O=(Object.defineProperty(ZO.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(ZO.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(ZO.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),ZO.prototype.toString=function(){return this._delegate.toString()},ZO.prototype.child=function(e){return new ZO(zO(this._delegate,e),this.storage)},Object.defineProperty(ZO.prototype,"root",{get:function(){return new ZO(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(ZO.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new ZO(e,this.storage)},enumerable:!1,configurable:!0}),ZO.prototype.put=function(e,t){return this._throwIfRoot("put"),new QO((void 0===t&&(t=null),(n=this._delegate)._throwIfRoot("uploadBytesResumable"),new qO(n,new lO(e),t)),this);var n},ZO.prototype.putString=function(e,t,n){return void 0===t&&(t=VR.RAW),this._throwIfRoot("putString"),new QO((r=this._delegate,void 0===t&&(t=VR.RAW),r._throwIfRoot("putString"),e=BR(t,e),null==(n=po({},n)).contentType&&null!=e.contentType&&(n.contentType=e.contentType),new qO(r,new lO(e.data,!0),n)),this);var r},ZO.prototype.listAll=function(){var e,t=this;return function r(i,o,a){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,KO(i,{pageToken:a})];case 1:return t=e.sent(),(n=o.prefixes).push.apply(n,t.prefixes),(n=o.items).push.apply(n,t.items),null==t.nextPageToken?[3,3]:[4,r(i,o,t.nextPageToken)];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(this._delegate,e={prefixes:[],items:[]}).then(function(){return e}).then(function(e){return new XO(e,t.storage)})},ZO.prototype.list=function(e){var t=this;return KO(this._delegate,e).then(function(e){return new XO(e,t.storage)})},ZO.prototype.getMetadata=function(){return function(r){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return r._throwIfRoot("getMetadata"),[4,r.storage.getAuthToken()];case 1:return t=e.sent(),n=OO(r.storage,r._location,wO()),[2,r.storage.makeRequest(n,t).getPromise()]}})})}(this._delegate)},ZO.prototype.updateMetadata=function(e){return function(s,u){return go(this,void 0,void 0,function(){var a;return yo(this,function(e){switch(e.label){case 0:return s._throwIfRoot("updateMetadata"),[4,s.storage.getAuthToken()];case 1:return a=e.sent(),t=s.storage,n=s._location,r=u,i=wO(),o=yO(n.fullServerUrl()),e=TO(r,i),r=t.maxOperationRetryTime,(r=new CO(o,"PATCH",kO(t,i),r)).headers={"Content-Type":"application/json; charset=utf-8"},r.body=e,r.errorHandler=RO(n),[2,s.storage.makeRequest(r,a).getPromise()]}var t,n,r,i,o})})}(this._delegate,e)},ZO.prototype.getDownloadURL=function(){return WO(this._delegate)},ZO.prototype.delete=function(){return this._throwIfRoot("delete"),function(i){return go(this,void 0,void 0,function(){var r;return yo(this,function(e){switch(e.label){case 0:return i._throwIfRoot("deleteObject"),[4,i.storage.getAuthToken()];case 1:return r=e.sent(),t=i.storage,e=yO((n=i._location).fullServerUrl()),t=t.maxOperationRetryTime,(t=new CO(e,"DELETE",function(e,t){},t)).successCodes=[200,204],t.errorHandler=RO(n),[2,i.storage.makeRequest(t,r).getPromise()]}var t,n})})}(this._delegate)},ZO.prototype._throwIfRoot=function(e){if(""===this._delegate._location.path)throw FR(e)},ZO);function ZO(e,t){this._delegate=e,this.storage=t}var eP=(tP.prototype.getPromise=function(){return this.promise_},tP.prototype.cancel=function(e){},tP);function tP(e){this.promise_=Promise.reject(e)}var nP=(rP.prototype.start_=function(){var t,n,e,r,i,o,a,s,u,c=this;function l(e,t){var n,r=c.resolve_,i=c.reject_,o=t.xhr;if(t.wasSuccessCode)try{var a=c.callback_(o,o.getResponseText());void 0!==a?r(a):r()}catch(e){i(e)}else null!==o?((n=OR()).serverResponse=o.getResponseText(),c.errorCallback_?i(c.errorCallback_(o,n)):i(n)):t.canceled?i(n=(c.appDelete_?MR:PR)()):i(n=new kR(DR.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}function h(){return 2===a}function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s||(s=!0,n.apply(null,e))}function p(e){i=setTimeout(function(){i=null,t(d,h())},e)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];s||(e||h()||o?f.call.apply(f,_o([null,e],t)):(r<64&&(r*=2),p(1===a?(a=2,0):1e3*(r+Math.random()))))}function g(e){u||(u=!0,s||(null!==i?(e||(a=2),clearTimeout(i),p(0)):e||(a=1)))}this.canceled_?l(0,new iP(!1,null,!0)):this.backoffId_=(t=function(r,e){function i(e){var t=e.loaded,e=e.lengthComputable?e.total:-1;null!==c.progressCallback_&&c.progressCallback_(t,e)}e?r(!1,new iP(!1,null,!0)):(e=c.pool_.createXhrIo(),c.pendingXhr_=e,null!==c.progressCallback_&&e.addUploadProgressListener(i),e.send(c.url_,c.method_,c.body_,c.headers_).then(function(e){null!==c.progressCallback_&&e.removeUploadProgressListener(i),c.pendingXhr_=null;var t=e.getErrorCode()===HR.NO_ERROR,n=e.getStatus();t&&!c.isRetryStatusCode_(n)?(n=-1!==c.successCodes_.indexOf(n),r(!0,new iP(n,e))):(e=e.getErrorCode()===HR.ABORT,r(!1,new iP(!1,null,e)))}))},n=l,e=this.timeout_,i=null,u=s=o=!(r=1),p(a=0),setTimeout(function(){g(o=!0)},e),g)},rP.prototype.getPromise=function(){return this.promise_},rP.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},rP.prototype.isRetryStatusCode_=function(e){var t=500<=e&&e<600,n=-1!==[408,429].indexOf(e),e=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||e},rP);function rP(e,t,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise(function(e,t){h.resolve_=e,h.reject_=t,h.start_()})}var iP=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n};function oP(e){return/^[A-Za-z]+:\/\//.test(e)}function aP(e,t){if(t&&oP(t)){if(e instanceof sP)return new VO(e,t);throw LR("To use ref(service, url), the first argument must be a Storage instance.")}return function e(t,n){if(t instanceof sP){var r=t;if(null==r._bucket)throw new kR(DR.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+AR+"' property when initializing the app?");return r=new VO(r,r._bucket),null!=n?e(r,n):r}if(void 0===n)return t;if(n.includes(".."))throw LR('`path` param cannot contain ".."');return zO(t,n)}(e,t)}var sP=(Object.defineProperty(uP.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(e){cO("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(uP.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(e){cO("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e},enumerable:!1,configurable:!0}),uP.prototype.getAuthToken=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(t=e.sent()))return[2,t.accessToken];e.label=2;case 2:return[2,null]}})})},uP.prototype._delete=function(){return this._deleted=!0,this._requests.forEach(function(e){return e.cancel()}),this._requests.clear(),Promise.resolve()},uP.prototype.makeStorageReference=function(e){return new VO(this,e)},uP.prototype.makeRequest=function(e,t){var n=this;if(this._deleted)return new eP(MR());var r,i,o,a,s,u=(r=e,i=this._appId,o=t,a=this._pool,s=mO(r.urlParams),e=r.url+s,t=Object.assign({},r.headers),s=t,i&&(s["X-Firebase-GMPID"]=i),i=t,null!==o&&0<o.length&&(i.Authorization="Firebase "+o),i=t,o=void 0!==jh?jh.SDK_VERSION:"AppManager",i["X-Firebase-Storage-Version"]="webjs/"+o,new nP(e,r.method,t,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,a));return this._requests.add(u),u.getPromise().then(function(){return n._requests.delete(u)},function(){return n._requests.delete(u)}),u},uP);function uP(e,t,n,r){this.app=e,this._authProvider=t,this._pool=n,this._url=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null==r&&null==(r=null==(r=this.app.options)?void 0:r[AR])?null:fO.makeFromBucketSpec(r)}var cP=(Object.defineProperty(lP.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(lP.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),lP.prototype.ref=function(e){if(oP(e))throw LR("ref() expected a child path but got a URL, use refFromURL instead.");return new $O(aP(this._delegate,e),this)},lP.prototype.refFromURL=function(e){if(!oP(e))throw LR("refFromURL() expected a full URL but got a child path, use ref() instead.");try{fO.makeFromUrl(e)}catch(e){throw LR("refFromUrl() expected a valid full URL but got an invalid one.")}return new $O(aP(this._delegate,e),this)},lP.prototype.setMaxUploadRetryTime=function(e){this._delegate.maxUploadRetryTime=e},lP.prototype.setMaxOperationRetryTime=function(e){this._delegate.maxOperationRetryTime=e},lP);function lP(e,t){var n=this;this.app=e,this._delegate=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}Hn={TaskState:eO,TaskEvent:{STATE_CHANGED:"state_changed"},StringFormat:VR,Storage:sP,Reference:$O},(iu=jh).INTERNAL.registerComponent(new ga("storage",function(e,t){var n=e.getProvider("app").getImmediate(),e=e.getProvider("auth-internal");return new cP(n,new sP(n,e,new iO,t))},"PUBLIC").setServiceProps(Hn).setMultipleInstances(!0)),iu.registerVersion("@firebase/storage","0.4.2-1.0.0-eap-firestore-debug.9c6096f43");var hP,fP,iu="0.4.4-1.0.0-eap-firestore-debug.9c6096f43",pP=iu,dP="FB-PERF-TRACE-MEASURE",gP="@firebase/performance/config",yP="@firebase/performance/configexpire",fe="Performance",he=((he={})["trace started"]="Trace {$traceName} was started before.",he["trace stopped"]="Trace {$traceName} is not running.",he["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",he["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",he["no window"]="Window is not available.",he["no app id"]="App id is not available.",he["no project id"]="Project id is not available.",he["no api key"]="Api key is not available.",he["invalid cc log"]="Attempted to queue invalid cc event",he["FB not default"]="Performance can only start when Firebase app instance is the default one.",he["RC response not ok"]="RC response is not ok",he["invalid attribute name"]="Attribute name {$attributeName} is invalid.",he["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",he["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",he["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",he),mP=new Ko("performance",fe,he),vP=new Na(fe);vP.logLevel=Ta.INFO;var bP,_P=(wP.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},wP.prototype.mark=function(e){this.performance&&this.performance.mark&&this.performance.mark(e)},wP.prototype.measure=function(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)},wP.prototype.getEntriesByType=function(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]},wP.prototype.getEntriesByName=function(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]},wP.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},wP.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Mo()||(vP.info("IndexedDB is not supported by current browswer"),!1):(vP.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},wP.prototype.setupObserver=function(e,i){this.PerformanceObserver&&new this.PerformanceObserver(function(e){for(var t=0,n=e.getEntries();t<n.length;t++){var r=n[t];i(r)}}).observe({entryTypes:[e]})},wP.getInstance=function(){return void 0===hP&&(hP=new wP(fP)),hP},wP);function wP(e){if(!(this.window=e))throw mP.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}function EP(e,t){var n=e.length-t.length;if(n<0||1<n)throw mP.create("invalid String merger input");for(var r=[],i=0;i<e.length;i++)r.push(e.charAt(i)),t.length>i&&r.push(t.charAt(i));return r.join("")}var TP,IP,SP=(CP.prototype.getAppId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!e)throw mP.create("no app id");return e},CP.prototype.getProjectId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!e)throw mP.create("no project id");return e},CP.prototype.getApiKey=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!e)throw mP.create("no api key");return e},CP.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},CP.getInstance=function(){return void 0===bP&&(bP=new CP),bP},CP);function CP(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=EP("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=EP("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}(fe=IP=IP||{})[fe.UNKNOWN=0]="UNKNOWN",fe[fe.VISIBLE=1]="VISIBLE",fe[fe.HIDDEN=2]="HIDDEN";var AP=["firebase_","google_","ga_"],kP=new RegExp("^[a-zA-Z]\\w*$");function NP(){switch(_P.getInstance().document.visibilityState){case"visible":return IP.VISIBLE;case"hidden":return IP.HIDDEN;default:return IP.UNKNOWN}}var DP="0.0.1",RP={loggingEnabled:!0},OP="FIREBASE_INSTALLATIONS_AUTH";function PP(e){var n,t=function(){var e=_P.getInstance().localStorage;if(e){var t=e.getItem(yP);if(t&&Number(t)>Date.now()){var n=e.getItem(gP);if(n)try{return JSON.parse(n)}catch(e){return}}}}();return t?(LP(t),Promise.resolve()):(n=e,(e=SP.getInstance().installationsService.getToken()).then(function(e){}),e.then(function(e){var t="https://firebaseremoteconfig.googleapis.com/v1/projects/"+SP.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+SP.getInstance().getApiKey(),e=new Request(t,{method:"POST",headers:{Authorization:OP+" "+e},body:JSON.stringify({app_instance_id:n,app_instance_id_token:e,app_id:SP.getInstance().getAppId(),app_version:pP,sdk_version:DP})});return fetch(e).then(function(e){if(e.ok)return e.json();throw mP.create("RC response not ok")})}).catch(function(){vP.info(xP)}).then(LP).then(function(e){var t=_P.getInstance().localStorage;e&&t&&(t.setItem(gP,JSON.stringify(e)),t.setItem(yP,String(Date.now()+60*SP.getInstance().configTimeToLive*60*1e3)))},function(){}))}var xP="Could not fetch config, will use default configs";function LP(e){if(!e)return e;var t=SP.getInstance(),n=e.entries||{};return t.loggingEnabled=void 0!==n.fpr_enabled?"true"===String(n.fpr_enabled):RP.loggingEnabled,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=MP(t.tracesSamplingRate),t.logNetworkAfterSampling=MP(t.networkRequestsSamplingRate),e}function MP(e){return Math.random()<=e}var FP,UP=1;function qP(){return UP=2,FP=FP||(n=_P.getInstance().document,new Promise(function(e){var t;n&&"complete"!==n.readyState?(t=function(){"complete"===n.readyState&&(n.removeEventListener("readystatechange",t),e())},n.addEventListener("readystatechange",t)):e()}).then(function(){return(e=SP.getInstance().installationsService.getId()).then(function(e){TP=e}),e;var e}).then(PP).then(jP,jP));var n}function jP(){UP=3}var VP,BP=1e4,KP=3,WP=KP,zP=[],HP=!1;function GP(e){setTimeout(function(){if(0!==WP)return zP.length?void function(){var e=_o(zP);zP=[];var t,r,n=e.map(function(e){return{source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}});t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:SP.getInstance().logSource,log_event:n},r=e,n=t,t=SP.getInstance().getFlTransportFullUrl(),fetch(t,{method:"POST",body:JSON.stringify(n)}).then(function(e){return e.ok||vP.info("Call to Firebase backend failed."),e.json()}).then(function(e){var t=Number(e.nextRequestWaitMillis),n=BP;isNaN(t)||(n=Math.max(t,n)),e=e.logResponseDetails,Array.isArray(e)&&0<e.length&&"RETRY_REQUEST_LATER"===e[0].responseAction&&(zP=_o(r,zP),vP.info("Retry transport request later.")),WP=KP,GP(n)}).catch(function(){zP=_o(e,zP),WP--,vP.info("Tries left: "+WP+"."),GP(BP)})}():GP(BP)},e)}function QP(e,t){var n;(VP=VP||(n=JP,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!function(e){if(!e.eventTime||!e.message)throw mP.create("invalid cc log");zP=_o(zP,[e])}({message:n.apply(void 0,e),eventTime:Date.now()})}))(e,t)}function YP(e){var t=SP.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&_P.getInstance().requiredApisAvailable()&&(e.isAuto&&NP()!==IP.VISIBLE||(3===UP?XP(e):qP().then(function(){return XP(e)},function(){return XP(e)})))}function XP(e){var t;!TP||(t=SP.getInstance()).loggingEnabled&&t.logTraceAfterSampling&&setTimeout(function(){return QP(e,1)},0)}function JP(e,t){return(0===t?function(e){return e={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},e={application_info:$P(),network_request_metric:e},JSON.stringify(e)}:function(e){var t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};return 0!==Object.keys(e.counters).length&&(t.counters=e.counters),e=e.getAttributes(),0!==Object.keys(e).length&&(t.custom_attributes=e),t={application_info:$P(),trace_metric:t},JSON.stringify(t)})(e)}function $P(){return{google_app_id:SP.getInstance().getAppId(),app_instance_id:TP,web_app_info:{sdk_version:pP,page_url:_P.getInstance().getUrl(),service_worker_status:"serviceWorker"in(e=_P.getInstance().navigator)?e.serviceWorker.controller?2:3:1,visibility_state:NP(),effective_connection_type:function(){var e=_P.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}var ZP=["_fp","_fcp","_fid"],ex=(tx.prototype.start=function(){if(1!==this.state)throw mP.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},tx.prototype.stop=function(){if(2!==this.state)throw mP.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),YP(this)},tx.prototype.record=function(e,t,n){if(e<=0)throw mP.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mP.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=po({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}YP(this)},tx.prototype.incrementMetric=function(e,t){void 0===t&&(t=1),void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)},tx.prototype.putMetric=function(e,t){if(n=e,r=this.name,0===n.length||100<n.length||!(r&&r.startsWith("_wt_")&&-1<ZP.indexOf(n))&&n.startsWith("_"))throw mP.create("invalid custom metric name",{customMetricName:e});var n,r;this.counters[e]=(e=t,(t=Math.floor(e))<e&&vP.info("Metric value should be an Integer, setting the value as : "+t+"."),t)},tx.prototype.getMetric=function(e){return this.counters[e]||0},tx.prototype.putAttribute=function(e,t){var n,r=!(0===(n=e).length||40<n.length||AP.some(function(e){return n.startsWith(e)})||!n.match(kP)),i=0!==(i=t).length&&i.length<=100;if(r&&i)this.customAttributes[e]=t;else{if(!r)throw mP.create("invalid attribute name",{attributeName:e});if(!i)throw mP.create("invalid attribute value",{attributeValue:t})}},tx.prototype.getAttribute=function(e){return this.customAttributes[e]},tx.prototype.removeAttribute=function(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]},tx.prototype.getAttributes=function(){return po({},this.customAttributes)},tx.prototype.setStartTime=function(e){this.startTimeUs=e},tx.prototype.setDuration=function(e){this.durationUs=e},tx.prototype.calculateTraceMetrics=function(){var e=this.api.getEntriesByName(this.traceMeasure);(e=e&&e[0])&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},tx.createOobTrace=function(e,t,n){var r,i=_P.getInstance().getUrl();i&&(r=new tx("_wt_"+i,!0),i=Math.floor(1e3*_P.getInstance().getTimeOrigin()),r.setStartTime(i),e&&e[0]&&(r.setDuration(Math.floor(1e3*e[0].duration)),r.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),r.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),r.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),t&&((e=t.find(function(e){return"first-paint"===e.name}))&&e.startTime&&r.putMetric("_fp",Math.floor(1e3*e.startTime)),(t=t.find(function(e){return"first-contentful-paint"===e.name}))&&t.startTime&&r.putMetric("_fcp",Math.floor(1e3*t.startTime)),n&&r.putMetric("_fid",Math.floor(1e3*n))),YP(r))},tx.createUserTimingTrace=function(e){YP(new tx(e,!1,e))},tx);function tx(e,t,n){void 0===t&&(t=!1),this.name=e,this.isAuto=t,this.state=1,this.customAttributes={},this.counters={},this.api=_P.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||dP+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}function nx(e){var t,n,r,i=e;i&&void 0!==i.responseStart&&(n=_P.getInstance().getTimeOrigin(),r=Math.floor(1e3*(i.startTime+n)),e=i.responseStart?Math.floor(1e3*(i.responseStart-i.startTime)):void 0,n=Math.floor(1e3*(i.responseEnd-i.startTime)),i={url:i.name&&i.name.split("?")[0],responsePayloadBytes:i.transferSize,startTimeUs:r,timeToResponseInitiatedUs:e,timeToResponseCompletedUs:n},t=i,(r=SP.getInstance()).instrumentationEnabled&&(e=t.url,n=r.logEndPointUrl.split("?")[0],i=r.flTransportEndpointUrl.split("?")[0],e!==n&&e!==i&&r.loggingEnabled&&r.logNetworkAfterSampling&&setTimeout(function(){return QP(t,0)},0)))}var rx=5e3;function ix(){TP&&(setTimeout(function(){var t,e=_P.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");e.onFirstInputDelay?(t=setTimeout(function(){ex.createOobTrace(n,r),t=void 0},rx),e.onFirstInputDelay(function(e){t&&(clearTimeout(t),ex.createOobTrace(n,r,e))})):ex.createOobTrace(n,r)},0),setTimeout(function(){for(var e=_P.getInstance(),t=0,n=e.getEntriesByType("resource");t<n.length;t++)nx(n[t]);e.setupObserver("resource",nx)},0),setTimeout(function(){for(var e=_P.getInstance(),t=0,n=e.getEntriesByType("measure");t<n.length;t++)ox(n[t]);e.setupObserver("measure",ox)},0))}function ox(e){(e=e.name).substring(0,dP.length)!==dP&&ex.createUserTimingTrace(e)}var ax=(sx.prototype.trace=function(e){return new ex(e)},Object.defineProperty(sx.prototype,"instrumentationEnabled",{get:function(){return SP.getInstance().instrumentationEnabled},set:function(e){SP.getInstance().instrumentationEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(sx.prototype,"dataCollectionEnabled",{get:function(){return SP.getInstance().dataCollectionEnabled},set:function(e){SP.getInstance().dataCollectionEnabled=e},enumerable:!1,configurable:!0}),sx);function sx(e){this.app=e,_P.getInstance().requiredApisAvailable()&&Fo().then(function(e){e&&(HP||(GP(5500),HP=!0),qP().then(ix,ix))}).catch(function(e){vP.info("Environment doesn't support IndexedDB: "+e)})}(he=jh).INTERNAL.registerComponent(new ga("performance",function(e){return function(e,t){if("[DEFAULT]"!==e.name)throw mP.create("FB not default");if("undefined"==typeof window)throw mP.create("no window");return fP=window,SP.getInstance().firebaseAppInstance=e,SP.getInstance().installationsService=t,new ax(e)}(e.getProvider("app").getImmediate(),e=e.getProvider("installations").getImmediate())},"PUBLIC")),he.registerVersion("@firebase/performance",iu);var ux,cx="firebase_id",lx="origin",hx=6e4,fx="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",px="https://www.googletagmanager.com/gtag/js";(fe=ux=ux||{}).EVENT="event",fe.SET="set",fe.CONFIG="config",(fe=he={}).ADD_SHIPPING_INFO="add_shipping_info",fe.ADD_PAYMENT_INFO="add_payment_info",fe.ADD_TO_CART="add_to_cart",fe.ADD_TO_WISHLIST="add_to_wishlist",fe.BEGIN_CHECKOUT="begin_checkout",fe.CHECKOUT_PROGRESS="checkout_progress",fe.EXCEPTION="exception",fe.GENERATE_LEAD="generate_lead",fe.LOGIN="login",fe.PAGE_VIEW="page_view",fe.PURCHASE="purchase",fe.REFUND="refund",fe.REMOVE_FROM_CART="remove_from_cart",fe.SCREEN_VIEW="screen_view",fe.SEARCH="search",fe.SELECT_CONTENT="select_content",fe.SELECT_ITEM="select_item",fe.SELECT_PROMOTION="select_promotion",fe.SET_CHECKOUT_OPTION="set_checkout_option",fe.SHARE="share",fe.SIGN_UP="sign_up",fe.TIMING_COMPLETE="timing_complete",fe.VIEW_CART="view_cart",fe.VIEW_ITEM="view_item",fe.VIEW_ITEM_LIST="view_item_list",fe.VIEW_PROMOTION="view_promotion",fe.VIEW_SEARCH_RESULTS="view_search_results";var dx=new Na("@firebase/analytics");var fe=((fe={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",fe["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",fe["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",fe["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",fe["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",fe["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",fe["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",fe["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',fe["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',fe),gx=new Ko("analytics","Analytics",fe),yx=30;function mx(e,t){void 0===e&&(e={}),void 0===t&&(t=1e3),this.throttleMetadata=e,this.intervalMillis=t}var vx=(mx.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},mx.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},mx.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},new mx);function bx(s,u,c){return void 0===u&&(u=vx),go(this,void 0,void 0,function(){var t,n,r,i,o,a=this;return yo(this,function(e){if(i=s.options,t=i.appId,n=i.apiKey,r=i.measurementId,!t)throw gx.create("no-app-id");if(n)return i=u.getThrottleMetadata(t)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new _x,setTimeout(function(){return go(a,void 0,void 0,function(){return yo(this,function(e){return o.abort(),[2]})})},void 0!==c?c:hx),[2,function u(c,e,l,h){var f=e.throttleEndTimeMillis,p=e.backoffCount;return void 0===h&&(h=vx),go(this,void 0,void 0,function(){var t,n,r,a,s;return yo(this,function(e){switch(e.label){case 0:t=c.appId,n=c.measurementId,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(i=l,o=f,new Promise(function(e,t){var n=Math.max(o-Date.now(),0),r=setTimeout(e,n);i.addEventListener(function(){clearTimeout(r),t(gx.create("fetch-throttle",{throttleEndTimeMillis:o}))})}))];case 2:return e.sent(),[3,4];case 3:if(a=e.sent(),n)return dx.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:t,measurementId:n}];throw a;case 4:return e.trys.push([4,6,,7]),[4,function(o){var a;return go(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(e){switch(e.label){case 0:return t=o.appId,i=o.apiKey,i={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":i})},t=fx.replace("{app-id}",t),[4,fetch(t,i)];case 1:if(200===(n=e.sent()).status||304===n.status)return[3,6];r="",e.label=2;case 2:return e.trys.push([2,4,,5]),[4,n.json()];case 3:return i=e.sent(),null!==(a=i.error)&&void 0!==a&&a.message&&(r=i.error.message),[3,5];case 4:return e.sent(),[3,5];case 5:throw gx.create("config-fetch-failed",{httpStatus:n.status,responseMessage:r});case 6:return[2,n.json()]}})})}(c)];case 5:return s=e.sent(),h.deleteThrottleMetadata(t),[2,s];case 6:if(function(e){if(e instanceof Vo&&e.customData)return 429===(e=Number(e.customData.httpStatus))||500===e||503===e||504===e}(r=e.sent()))return a=503===Number(r.customData.httpStatus)?da(p,h.intervalMillis,yx):da(p,h.intervalMillis),s={throttleEndTimeMillis:Date.now()+a,backoffCount:p+1},h.setThrottleMetadata(t,s),dx.debug("Calling attemptFetch again in "+a+" millis"),[2,u(c,s,l,h)];if(h.deleteThrottleMetadata(t),n)return dx.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+r.message+"]"),[2,{appId:t,measurementId:n}];throw r;case 7:return[2]}var i,o})})}({appId:t,apiKey:n,measurementId:r},i,o,u)];if(r)return[2,{measurementId:r,appId:t}];throw gx.create("no-api-key")})})}var _x=(wx.prototype.addEventListener=function(e){this.listeners.push(e)},wx.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},wx);function wx(){this.listeners=[]}var Ex,Tx,Ix={},Sx=[],Cx={},Ax="dataLayer",kx="gtag",Nx=!1;function Dx(e,t){n=[],Po()&&n.push("This is a browser extension environment."),Uo()||n.push("Cookies are not available."),0<n.length&&(n=n.map(function(e,t){return"("+(t+1)+") "+e}).join(" "),n=gx.create("invalid-analytics-context",{errorInfo:n}),dx.warn(n.message));var n,r,i,o,a,s,u,c,l,h,f=e.options.appId;if(!f)throw gx.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw gx.create("no-api-key");dx.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Ix[f])throw gx.create("already-exists",{id:f});return Nx||(function(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(px))return r}}()||(a=Ax,(s=document.createElement("script")).src=px+"?l="+a,s.async=!0,document.head.appendChild(s)),i=Ax,o=[],Array.isArray(window[i])?o=window[i]:window[i]=o,n=Ix,a=Sx,s=Cx,r=Ax,i=kx,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[r].push(arguments)},window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=(u=o,c=n,l=a,h=s,function(n,r,i){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),n!==ux.EVENT?[3,2]:[4,function(u,c,l,h,f){return go(this,void 0,void 0,function(){var n,r,t,i,o,a,s;return yo(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),n=[],f&&f.send_to?(s=f.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(l)]):[3,2];case 1:for(r=e.sent(),t=function(t){var e=r.find(function(e){return e.measurementId===t});if(!(e=e&&c[e.appId]))return n=[],"break";n.push(e)},i=0,o=s;i<o.length&&(a=o[i],"break"!==t(a));i++);e.label=2;case 2:return 0===n.length&&(n=Object.values(c)),[4,Promise.all(n)];case 3:return e.sent(),u(ux.EVENT,h,f||{}),[3,5];case 4:return s=e.sent(),dx.error(s),[3,5];case 5:return[2]}})})}(u,c,l,r,i)];case 1:return e.sent(),[3,5];case 2:return n!==ux.CONFIG?[3,4]:[4,function(r,i,o,a,s,u){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:t=a[s],e.label=1;case 1:return e.trys.push([1,7,,8]),t?[4,i[t]]:[3,3];case 2:return e.sent(),[3,6];case 3:return[4,Promise.all(o)];case 4:return(n=(n=e.sent()).find(function(e){return e.measurementId===s}))?[4,i[n.appId]]:[3,6];case 5:e.sent(),e.label=6;case 6:return[3,8];case 7:return n=e.sent(),dx.error(n),[3,8];case 8:return r(ux.CONFIG,s,u),[2]}})})}(u,c,l,h,r,i)];case 3:return e.sent(),[3,5];case 4:u(ux.SET,r),e.label=5;case 5:return[3,7];case 6:return t=e.sent(),dx.error(t),[3,7];case 7:return[2]}})})}),i={gtagCore:o,wrappedGtag:window[i]},Tx=i.wrappedGtag,Ex=i.gtagCore,Nx=!0),Ix[f]=function(i,o,a,s,u){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return(t=bx(i)).then(function(e){a[e.measurementId]=e.appId,i.options.measurementId&&e.measurementId!==i.options.measurementId&&dx.warn("The measurement ID in the local Firebase config ("+i.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(e){return dx.error(e)}),o.push(t),n=function(){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return Mo()?[3,1]:(dx.warn(gx.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,Fo()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),dx.warn(gx.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})}().then(function(e){return e?s.getId():void 0}),[4,Promise.all([t,n])];case 1:return r=e.sent(),t=r[0],n=r[1],u("js",new Date),(r={})[lx]="firebase",r.update=!0,null!=n&&(r[cx]=n),u(ux.CONFIG,t.measurementId,r),[2,t.measurementId]}})})}(e,Sx,Cx,t,Ex),{app:e,logEvent:function(e,t,n){(function(n,r,i,o,a){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return a&&a.global?(n(ux.EVENT,i,o),[2]):[3,1];case 1:return[4,r];case 2:t=e.sent(),t=po(po({},o),{send_to:t}),n(ux.EVENT,i,t),e.label=3;case 3:return[2]}})})})(Tx,Ix[f],e,t,n).catch(function(e){return dx.error(e)})},setCurrentScreen:function(e,t){(function(n,r,i,o){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return o&&o.global?(n(ux.SET,{screen_name:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(ux.CONFIG,t,{update:!0,screen_name:i}),e.label=3;case 3:return[2]}})})})(Tx,Ix[f],e,t).catch(function(e){return dx.error(e)})},setUserId:function(e,t){(function(n,r,i,o){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return o&&o.global?(n(ux.SET,{user_id:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(ux.CONFIG,t,{update:!0,user_id:i}),e.label=3;case 3:return[2]}})})})(Tx,Ix[f],e,t).catch(function(e){return dx.error(e)})},setUserProperties:function(e,t){(function(a,s,u,c){return go(this,void 0,void 0,function(){var t,n,r,i,o;return yo(this,function(e){switch(e.label){case 0:if(!c||!c.global)return[3,1];for(t={},n=0,r=Object.keys(u);n<r.length;n++)i=r[n],t["user_properties."+i]=u[i];return a(ux.SET,t),[2,Promise.resolve()];case 1:return[4,s];case 2:o=e.sent(),a(ux.CONFIG,o,{update:!0,user_properties:u}),e.label=3;case 3:return[2]}})})})(Tx,Ix[f],e,t).catch(function(e){return dx.error(e)})},setAnalyticsCollectionEnabled:function(e){(function(n,r){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,n];case 1:return t=e.sent(),window["ga-disable-"+t]=!r,[2]}})})})(Ix[f],e).catch(function(e){return dx.error(e)})},INTERNAL:{delete:function(){return delete Ix[f],Promise.resolve()}}}}var Rx="analytics";(iu=jh).INTERNAL.registerComponent(new ga(Rx,function(e){return Dx(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:function(e){if(Nx)throw gx.create("already-initialized");e.dataLayerName&&(Ax=e.dataLayerName),e.gtagName&&(kx=e.gtagName)},EventName:he,isSupported:function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:if(Po())return[2,!1];if(!Uo())return[2,!1];if(!Mo())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Fo()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}})})}})),iu.INTERNAL.registerComponent(new ga("analytics-internal",function(e){try{return{logEvent:e.getProvider(Rx).getImmediate().logEvent}}catch(e){throw gx.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),iu.registerVersion("@firebase/analytics","0.6.2-1.0.0-eap-firestore-debug.9c6096f43");var Ox=(Px.prototype.isCachedDataFresh=function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,t=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+e+". Is cache hit: "+t+"."),t},Px.prototype.fetch=function(i){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return r=e.sent(),t=r[0],(r=r[1])&&this.isCachedDataFresh(i.cacheMaxAgeMillis,t)?[2,r]:(i.eTag=r&&r.eTag,[4,this.client.fetch(i)]);case 2:return n=e.sent(),r=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===n.status&&r.push(this.storage.setLastSuccessfulFetchResponse(n)),[4,Promise.all(r)];case 3:return e.sent(),[2,n]}})})},Px);function Px(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}var fe=((fe={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",fe["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",fe["registration-api-key"]="Undefined API key. Check Firebase app initialization.",fe["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",fe["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",fe["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",fe["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",fe["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",fe["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",fe["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',fe["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',fe["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",fe["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",fe),xx=new Ko("remoteconfig","Remote Config",fe),Lx=(Mx.prototype.fetch=function(f){return go(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,h;return yo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:o=e.sent(),n=o[0],i=o[1],r=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=r+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,r={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":f.eTag||"*"},i={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:this.appId,language_code:(void 0===t&&(t=navigator),t.languages&&t.languages[0]||t.language)},i={method:"POST",headers:r,body:JSON.stringify(i)},o=fetch(o,i),i=new Promise(function(e,t){f.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",t(e)})}),e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Promise.race([o,i])];case 3:return e.sent(),[4,o];case 4:return h=e.sent(),[3,6];case 5:throw i=e.sent(),o="fetch-client-network","AbortError"===i.name&&(o="fetch-timeout"),xx.create(o,{originalErrorMessage:i.message});case 6:if(a=h.status,s=h.headers.get("ETag")||void 0,200!==h.status)return[3,11];l=void 0,e.label=7;case 7:return e.trys.push([7,9,,10]),[4,h.json()];case 8:return l=e.sent(),[3,10];case 9:throw h=e.sent(),xx.create("fetch-client-parse",{originalErrorMessage:h.message});case 10:u=l.entries,c=l.state,e.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===c?a=500:"NO_CHANGE"===c?a=304:"NO_TEMPLATE"!==c&&"EMPTY_CONFIG"!==c||(u={}),304!==a&&200!==a)throw xx.create("fetch-status",{httpStatus:a});return[2,{status:a,eTag:s,config:u}]}var t})})},Mx);function Mx(e,t,n,r,i,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}var Fx=(Ux.prototype.addEventListener=function(e){this.listeners.push(e)},Ux.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},Ux);function Ux(){this.listeners=[]}var qx=["1","true","t","yes","y","on"],jx=(Vx.prototype.asString=function(){return this._value},Vx.prototype.asBoolean=function(){return"static"!==this._source&&0<=qx.indexOf(this._value.toLowerCase())},Vx.prototype.asNumber=function(){if("static"===this._source)return 0;var e=Number(this._value);return isNaN(e)&&(e=0),e},Vx.prototype.getSource=function(){return this._source},Vx);function Vx(e,t){void 0===t&&(t=""),this._source=e,this._value=t}var Bx=(Kx.prototype.setLogLevel=function(e){switch(e){case"debug":this._logger.logLevel=Ta.DEBUG;break;case"silent":this._logger.logLevel=Ta.SILENT;break;default:this._logger.logLevel=Ta.ERROR}},Object.defineProperty(Kx.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(Kx.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),Kx.prototype.activate=function(){return go(this,void 0,void 0,function(){var t,n;return yo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return n=e.sent(),t=n[0],n=n[1],t&&t.config&&t.eTag&&t.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(t.config),this._storage.setActiveConfigEtag(t.eTag)])]:[2,!1];case 2:return e.sent(),[2,!0]}})})},Kx.prototype.ensureInitialized=function(){var e=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then(function(){e._isInitializationComplete=!0})),this._initializePromise},Kx.prototype.fetch=function(){return go(this,void 0,void 0,function(){var t,n,r,i=this;return yo(this,function(e){switch(e.label){case 0:t=new Fx,setTimeout(function(){return go(i,void 0,void 0,function(){return yo(this,function(e){return t.abort(),[2]})})},this.settings.fetchTimeoutMillis),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return e.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return e.sent(),[3,6];case 4:return n=e.sent(),r=n instanceof Vo&&-1!==n.code.indexOf("fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(r)];case 5:throw e.sent(),n;case 6:return[2]}})})},Kx.prototype.fetchAndActivate=function(){return go(this,void 0,void 0,function(){return yo(this,function(e){switch(e.label){case 0:return[4,this.fetch()];case 1:return e.sent(),[2,this.activate()]}})})},Kx.prototype.getAll=function(){var e,t,n=this;return e=this._storageCache.getActiveConfig(),t=this.defaultConfig,void 0===e&&(e={}),void 0===t&&(t={}),Object.keys(po(po({},e),t)).reduce(function(e,t){return e[t]=n.getValue(t),e},{})},Kx.prototype.getBoolean=function(e){return this.getValue(e).asBoolean()},Kx.prototype.getNumber=function(e){return this.getValue(e).asNumber()},Kx.prototype.getString=function(e){return this.getValue(e).asString()},Kx.prototype.getValue=function(e){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+e+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var t=this._storageCache.getActiveConfig();return t&&void 0!==t[e]?new jx("remote",t[e]):this.defaultConfig&&void 0!==this.defaultConfig[e]?new jx("default",String(this.defaultConfig[e])):(this._logger.debug('Returning static value for key "'+e+'". Define a default or remote value if this is unintentional.'),new jx("static"))},Kx);function Kx(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}function Wx(e,t){return e=e.target.error||void 0,xx.create(t,{originalErrorMessage:e&&e.message})}var zx="app_namespace_store",Hx=(Gx.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},Gx.prototype.setLastFetchStatus=function(e){return this.set("last_fetch_status",e)},Gx.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},Gx.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.set("last_successful_fetch_timestamp_millis",e)},Gx.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},Gx.prototype.setLastSuccessfulFetchResponse=function(e){return this.set("last_successful_fetch_response",e)},Gx.prototype.getActiveConfig=function(){return this.get("active_config")},Gx.prototype.setActiveConfig=function(e){return this.set("active_config",e)},Gx.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},Gx.prototype.setActiveConfigEtag=function(e){return this.set("active_config_etag",e)},Gx.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},Gx.prototype.setThrottleMetadata=function(e){return this.set("throttle_metadata",e)},Gx.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},Gx.prototype.get=function(s){return go(this,void 0,void 0,function(){var o,a=this;return yo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(t,n){var e=o.transaction([zx],"readonly").objectStore(zx),r=a.createCompositeKey(s);try{var i=e.get(r);i.onerror=function(e){n(Wx(e,"storage-get"))},i.onsuccess=function(e){e=e.target.result,t(e?e.value:void 0)}}catch(e){n(xx.create("storage-get",{originalErrorMessage:e&&e.message}))}})]}})})},Gx.prototype.set=function(s,u){return go(this,void 0,void 0,function(){var o,a=this;return yo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(e,t){var n=o.transaction([zx],"readwrite").objectStore(zx),r=a.createCompositeKey(s);try{var i=n.put({compositeKey:r,value:u});i.onerror=function(e){t(Wx(e,"storage-set"))},i.onsuccess=function(){e()}}catch(e){t(xx.create("storage-set",{originalErrorMessage:e&&e.message}))}})]}})})},Gx.prototype.delete=function(s){return go(this,void 0,void 0,function(){var o,a=this;return yo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(e,t){var n=o.transaction([zx],"readwrite").objectStore(zx),r=a.createCompositeKey(s);try{var i=n.delete(r);i.onerror=function(e){t(Wx(e,"storage-delete"))},i.onsuccess=function(){e()}}catch(e){t(xx.create("storage-delete",{originalErrorMessage:e&&e.message}))}})]}})})},Gx.prototype.createCompositeKey=function(e){return[this.appId,this.appName,this.namespace,e].join()},Gx);function Gx(e,t,n,r){void 0===r&&(r=new Promise(function(t,n){var e=indexedDB.open("firebase_remote_config",1);e.onerror=function(e){n(Wx(e,"storage-open"))},e.onsuccess=function(e){t(e.target.result)},e.onupgradeneeded=function(e){var t=e.target.result;0===e.oldVersion&&t.createObjectStore(zx,{keyPath:"compositeKey"})}})),this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}var Qx=(Yx.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},Yx.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},Yx.prototype.getActiveConfig=function(){return this.activeConfig},Yx.prototype.loadFromStorage=function(){return go(this,void 0,void 0,function(){var t,n,r;return yo(this,function(e){switch(e.label){case 0:return t=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),[4,t];case 1:return(t=e.sent())&&(this.lastFetchStatus=t),[4,n];case 2:return(n=e.sent())&&(this.lastSuccessfulFetchTimestampMillis=n),[4,r];case 3:return(r=e.sent())&&(this.activeConfig=r),[2]}})})},Yx.prototype.setLastFetchStatus=function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)},Yx.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)},Yx.prototype.setActiveConfig=function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)},Yx);function Yx(e){this.storage=e}var Xx=(Jx.prototype.fetch=function(n){return go(this,void 0,void 0,function(){var t;return yo(this,function(e){switch(e.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return t=e.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(n,t)]}})})},Jx.prototype.attemptFetch=function(a,e){var s=e.throttleEndTimeMillis,u=e.backoffCount;return go(this,void 0,void 0,function(){var n,r;return yo(this,function(e){switch(e.label){case 0:return[4,(i=a.signal,o=s,new Promise(function(e,t){var n=Math.max(o-Date.now(),0),r=setTimeout(e,n);i.addEventListener(function(){clearTimeout(r),t(xx.create("fetch-throttle",{throttleEndTimeMillis:o}))})}))];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,5,,7]),[4,this.client.fetch(a)];case 3:return n=e.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return e.sent(),[2,n];case 5:if(!((t=r=e.sent())instanceof Vo&&t.customData)||429!==(t=Number(t.customData.httpStatus))&&500!==t&&503!==t&&504!==t)throw r;return r={throttleEndTimeMillis:Date.now()+da(u),backoffCount:u+1},[4,this.storage.setThrottleMetadata(r)];case 6:return e.sent(),[2,this.attemptFetch(a,r)];case 7:return[2]}var t,i,o})})},Jx);function Jx(e,t){this.client=e,this.storage=t}var $x,Zx="@firebase/remote-config";return($x=jh).INTERNAL.registerComponent(new ga("remoteConfig",function(e,t){var n=e.getProvider("app").getImmediate(),r=e.getProvider("installations").getImmediate();if("undefined"==typeof window)throw xx.create("registration-window");var i=n.options,o=i.projectId,a=i.apiKey,s=i.appId;if(!o)throw xx.create("registration-project-id");if(!a)throw xx.create("registration-api-key");if(!s)throw xx.create("registration-app-id");t=t||"firebase";var u=new Hx(s,n.name,t),e=new Qx(u);return(i=new Na(Zx)).logLevel=Ta.ERROR,s=new Lx(r,$x.SDK_VERSION,t,o,a,s),s=new Xx(s,u),s=new Ox(s,u,e,i),(i=new Bx(n,s,e,u,i)).ensureInitialized(),i},"PUBLIC").setMultipleInstances(!0)),$x.registerVersion(Zx,"0.1.30-1.0.0-eap-firestore-debug.9c6096f43"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),jh.registerVersion("firebase","8.1.1-1.0.0-eap-firestore-debug.9c6096f43","cdn"),jh});