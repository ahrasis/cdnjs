!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,function(){"use strict";function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return"string"!=typeof e&&(e=String(e)),e}function e(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return p&&(e[Symbol.iterator]=function(){return e}),e}function a(t){this.map={},t instanceof a?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function t(e){var t=new FileReader,n=s(t);return t.readAsArrayBuffer(e),n}function n(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(d&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(g&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(f&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(y&&d&&v(e))this._bodyArrayBuffer=n(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y||!ArrayBuffer.prototype.isPrototypeOf(e)&&!b(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=n(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(t)}),this.text=function(){var e,t,n=o(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=s(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var n,r=(t=t||{}).body;if(e instanceof c){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new a(t.headers)),this.method=(n=t.method||this.method||"GET",e=n.toUpperCase(),-1<_.indexOf(e)?e:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function l(e){var n=new FormData;return e.trim().split("&").forEach(function(e){var t;e&&(e=(t=e.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),n.append(decodeURIComponent(e),decodeURIComponent(t)))}),n}function h(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new a(t.headers),this.url=t.url||"",this._initBody(e)}var f,p,d,g,y,m,v,b,_,w;(Ve="undefined"!=typeof self?self:void 0).fetch||(f="URLSearchParams"in Ve,p="Symbol"in Ve&&"iterator"in Symbol,d="FileReader"in Ve&&"Blob"in Ve&&function(){try{return new Blob,!0}catch(e){return!1}}(),g="FormData"in Ve,(y="ArrayBuffer"in Ve)&&(m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},b=ArrayBuffer.isView||function(e){return e&&-1<m.indexOf(Object.prototype.toString.call(e))}),a.prototype.append=function(e,t){e=r(e),t=i(t);var n=this.map[e];this.map[e]=n?n+","+t:t},a.prototype.delete=function(e){delete this.map[r(e)]},a.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},a.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},a.prototype.set=function(e,t){this.map[r(e)]=i(t)},a.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},a.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),e(n)},a.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),e(t)},a.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),e(n)},p&&(a.prototype[Symbol.iterator]=a.prototype.entries),_=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],c.prototype.clone=function(){return new c(this,{body:this._bodyInit})},u.call(c.prototype),u.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},h.error=function(){var e=new h(null,{status:0,statusText:""});return e.type="error",e},w=[301,302,303,307,308],h.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new h(null,{status:t,headers:{location:e}})},Ve.Headers=a,Ve.Request=c,Ve.Response=h,Ve.fetch=function(n,o){return new Promise(function(r,e){var t=new c(n,o),i=new XMLHttpRequest;i.onload=function(){var n,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",n=new a,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),e=t.shift().trim();e&&(t=t.join(":").trim(),n.append(e,t))}),n)};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new h(t,e))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.open(t.method,t.url,!0),"include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),"responseType"in i&&d&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},Ve.fetch.polyfill=!0);var E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function T(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}function I(e){try{return!!e()}catch(e){return!0}}function S(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function C(e){return V.call(e).slice(8,-1)}function k(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function A(e){return K(k(e))}function N(e){return"object"==typeof e?null!==e:"function"==typeof e}function D(e,t){if(!N(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!N(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!N(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!N(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function R(e,t){return W.call(e,t)}function O(e){return H?z.createElement(e):{}}function P(e){if(!N(e))throw TypeError(String(e)+" is not an object");return e}function x(t,n){try{$(M,t,n)}catch(e){M[t]=n}return n}var L=function(e){return e&&e.Math==Math&&e},M=L("object"==typeof globalThis&&globalThis)||L("object"==typeof window&&window)||L("object"==typeof self&&self)||L("object"==typeof E&&E)||function(){return this}()||Function("return this")(),F=!I(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),U={}.propertyIsEnumerable,q=Object.getOwnPropertyDescriptor,j={f:q&&!U.call({1:2},1)?function(e){e=q(this,e);return!!e&&e.enumerable}:U},V={}.toString,B="".split,K=I(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==C(e)?B.call(e,""):Object(e)}:Object,W={}.hasOwnProperty,z=M.document,H=N(z)&&N(z.createElement),G=!F&&!I(function(){return 7!=Object.defineProperty(O("div"),"a",{get:function(){return 7}}).a}),Q=Object.getOwnPropertyDescriptor,Y={f:F?Q:function(e,t){if(e=A(e),t=D(t,!0),G)try{return Q(e,t)}catch(e){}if(R(e,t))return S(!j.f.call(e,t),e[t])}},X=Object.defineProperty,J={f:F?X:function(e,t,n){if(P(e),t=D(t,!0),P(n),G)try{return X(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},$=F?function(e,t,n){return J.f(e,t,S(1,n))}:function(e,t,n){return e[t]=n,e},Z="__core-js_shared__",ee=M[Z]||x(Z,{}),te=Function.toString;"function"!=typeof ee.inspectSource&&(ee.inspectSource=function(e){return te.call(e)});function ne(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++ye+me).toString(36)}var re,ie,oe,ae,se,ue,ce,le,he=ee.inspectSource,fe=M.WeakMap,pe="function"==typeof fe&&/native code/.test(he(fe)),de=!1,ge=T(function(e){(e.exports=function(e,t){return ee[e]||(ee[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.7.0",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),ye=0,me=Math.random(),ve=ge("keys"),be=function(e){return ve[e]||(ve[e]=ne(e))},_e={},we=M.WeakMap;ce=pe?(re=ee.state||(ee.state=new we),ie=re.get,oe=re.has,ae=re.set,se=function(e,t){return t.facade=e,ae.call(re,e,t),t},ue=function(e){return ie.call(re,e)||{}},function(e){return oe.call(re,e)}):(le=be("state"),_e[le]=!0,se=function(e,t){return t.facade=e,$(e,le,t),t},ue=function(e){return R(e,le)?e[le]:{}},function(e){return R(e,le)});function Ee(e){return"function"==typeof e?e:void 0}function Te(e,t){return arguments.length<2?Ee(Le[e])||Ee(M[e]):Le[e]&&Le[e][t]||M[e]&&M[e][t]}function Ie(e){return isNaN(e=+e)?0:(0<e?Fe:Me)(e)}function Se(e){return 0<e?Ue(Ie(e),9007199254740991):0}function Ce(e,t){var n,r=A(e),i=0,o=[];for(n in r)!R(_e,n)&&R(r,n)&&o.push(n);for(;t.length>i;)R(r,n=t[i++])&&(~Be(o,n)||o.push(n));return o}function ke(e,t){for(var n=Ge(t),r=J.f,i=Y.f,o=0;o<n.length;o++){var a=n[o];R(e,a)||r(e,a,i(t,a))}}function Ae(e,t){var n,r,i,o=e.target,a=e.global,s=e.stat,u=a?M:s?M[o]||x(o,{}):(M[o]||{}).prototype;if(u)for(n in t){if(r=t[n],i=e.noTargetGet?(i=et(u,n))&&i.value:u[n],!Ze(a?n:o+(s?".":"#")+n,e.forced)&&void 0!==i){if(typeof r==typeof i)continue;ke(r,i)}(e.sham||i&&i.sham)&&$(r,"sham",!0),xe(u,n,r,e)}}function Ne(e){return Object(k(e))}function De(){}function Re(e){return"<script>"+e+"</"+ct+">"}var Oe,Pe={set:se,get:ue,has:ce,enforce:function(e){return ce(e)?ue(e):se(e,{})},getterFor:function(n){return function(e){var t;if(!N(e)||(t=ue(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}},xe=T(function(e){var t=Pe.get,s=Pe.enforce,u=String(String).split("String");(e.exports=function(e,t,n,r){var i=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||R(n,"name")||$(n,"name",t),(r=s(n)).source||(r.source=u.join("string"==typeof t?t:""))),e!==M?(i?!a&&e[t]&&(o=!0):delete e[t],o?e[t]=n:$(e,t,n)):o?e[t]=n:x(t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||he(this)})}),Le=M,Me=Math.ceil,Fe=Math.floor,Ue=Math.min,qe=Math.max,je=Math.min,Ve=function(s){return function(e,t,n){var r,i=A(e),o=Se(i.length),a=function(e,t){e=Ie(e);return e<0?qe(e+t,0):je(e,t)}(n,o);if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}},Be={includes:Ve(!0),indexOf:Ve(!1)}.indexOf,Ke=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],We=Ke.concat("length","prototype"),ze={f:Object.getOwnPropertyNames||function(e){return Ce(e,We)}},He={f:Object.getOwnPropertySymbols},Ge=Te("Reflect","ownKeys")||function(e){var t=ze.f(P(e)),n=He.f;return n?t.concat(n(e)):t},Qe=/#|\.prototype\./,L=function(e,t){e=Xe[Ye(e)];return e==$e||e!=Je&&("function"==typeof t?I(t):!!t)},Ye=L.normalize=function(e){return String(e).replace(Qe,".").toLowerCase()},Xe=L.data={},Je=L.NATIVE="N",$e=L.POLYFILL="P",Ze=L,et=Y.f,E=!I(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),tt=be("IE_PROTO"),nt=Object.prototype,rt=E?Object.getPrototypeOf:function(e){return e=Ne(e),R(e,tt)?e[tt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?nt:null},it=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return P(e),function(e){if(!N(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(t),r?n.call(e,t):e.__proto__=t,e}}():void 0),ot=Object.keys||function(e){return Ce(e,Ke)},at=F?Object.defineProperties:function(e,t){P(e);for(var n,r=ot(t),i=r.length,o=0;o<i;)J.f(e,n=r[o++],t[n]);return e},st=Te("document","documentElement"),ut="prototype",ct="script",lt=be("IE_PROTO"),ht=function(){try{Oe=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e;ht=Oe?function(e){e.write(Re("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Oe):((e=O("iframe")).style.display="none",st.appendChild(e),e.src=String("javascript:"),(e=e.contentWindow.document).open(),e.write(Re("document.F=Object")),e.close(),e.F);for(var t=Ke.length;t--;)delete ht[ut][Ke[t]];return ht()};_e[lt]=!0;function ft(e){return R(vt,e)||(mt&&R(bt,e)?vt[e]=bt[e]:vt[e]=_t("Symbol."+e)),vt[e]}function pt(e){return void 0!==e&&(wt.Array===e||Tt[Et]===e)}function dt(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function gt(r,i,e){if(dt(r),void 0===i)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}var yt=Object.create||function(e,t){var n;return null!==e?(De[ut]=P(e),n=new De,De[ut]=null,n[lt]=e):n=ht(),void 0===t?n:at(n,t)},mt=!!Object.getOwnPropertySymbols&&!I(function(){return!String(Symbol())}),U=mt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,vt=ge("wks"),bt=M.Symbol,_t=U?bt:bt&&bt.withoutSetter||ne,wt={},Et=ft("iterator"),Tt=Array.prototype,Z={};Z[ft("toStringTag")]="z";function It(e){if(null!=e)return e[Rt]||e["@@iterator"]||wt[Dt(e)]}function St(e){var t=e.return;return void 0!==t&&P(t.call(e)).value}function Ct(e,t){this.stopped=e,this.result=t}function kt(e,t,n){function r(e){return o&&St(o),new Ct(!0,e)}function i(e){return f?(P(e),d?g(e[0],e[1],r):g(e[0],e[1])):d?g(e,r):g(e)}var o,a,s,u,c,l,h=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),g=gt(t,h,1+f+d);if(p)o=e;else{if("function"!=typeof(p=It(e)))throw TypeError("Target is not iterable");if(pt(p)){for(a=0,s=Se(e.length);a<s;a++)if((u=i(e[a]))&&u instanceof Ct)return u;return new Ct(!1)}o=p.call(e)}for(c=o.next;!(l=c.call(o)).done;){try{u=i(l.value)}catch(e){throw St(o),e}if("object"==typeof u&&u&&u instanceof Ct)return u}return new Ct(!1)}var fe="[object z]"===String(Z),At=ft("toStringTag"),Nt="Arguments"==C(function(){return arguments}()),Dt=fe?C:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),At))?e:Nt?C(t):"Object"==(e=C(t))&&"function"==typeof t.callee?"Arguments":e},Rt=ft("iterator"),Ot=function(e,t){var n=this;if(!(n instanceof Ot))return new Ot(e,t);it&&(n=it(new Error(void 0),rt(n))),void 0!==t&&$(n,"message",String(t));t=[];return kt(e,t.push,{that:t}),$(n,"errors",t),n};Ot.prototype=yt(Error.prototype,{constructor:S(5,Ot),message:S(5,""),name:S(5,"AggregateError")}),Ae({global:!0},{AggregateError:Ot});pe=fe?{}.toString:function(){return"[object "+Dt(this)+"]"};fe||xe(Object.prototype,"toString",pe,{unsafe:!0});function Pt(e,t,n){for(var r in t)xe(e,r,t[r],n);return e}function xt(e,t,n){e&&!R(e=n?e:e.prototype,qt)&&Ut(e,qt,{configurable:!0,value:t})}function Lt(e){var t=Te(e),e=J.f;F&&t&&!t[jt]&&e(t,jt,{configurable:!0,get:function(){return this}})}function Mt(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}var Ft=M.Promise,Ut=J.f,qt=ft("toStringTag"),jt=ft("species"),Vt=ft("iterator"),Bt=!1;try{var Kt=0,Wt={next:function(){return{done:!!Kt++}},return:function(){Bt=!0}};Wt[Vt]=function(){return this},Array.from(Wt,function(){throw 2})}catch(rs){}function zt(e,t){if(!t&&!Bt)return!1;var n=!1;try{var r={};r[Vt]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}function Ht(e,t){var n;return void 0===(e=P(e).constructor)||null==(n=P(e)[Xt])?t:dt(n)}function Gt(e){var t;nn.hasOwnProperty(e)&&(t=nn[e],delete nn[e],t())}function Qt(e){return function(){Gt(e)}}var Yt,Xt=ft("species"),we=Te("navigator","userAgent")||"",Ve=/(iphone|ipod|ipad).*applewebkit/i.test(we),Jt="process"==C(M.process),$t=M.location,L=M.setImmediate,E=M.clearImmediate,Zt=M.process,Z=M.MessageChannel,en=M.Dispatch,tn=0,nn={},rn="onreadystatechange",fe=function(e){Gt(e.data)},pe=function(e){M.postMessage(e+"",$t.protocol+"//"+$t.host)};L&&E||(L=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return nn[++tn]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Yt(tn),tn},E=function(e){delete nn[e]},Jt?Yt=function(e){Zt.nextTick(Qt(e))}:en&&en.now?Yt=function(e){en.now(Qt(e))}:Z&&!Ve?(pn=(Z=new Z).port2,Z.port1.onmessage=fe,Yt=gt(pn.postMessage,pn,1)):M.addEventListener&&"function"==typeof postMessage&&!M.importScripts&&$t&&"file:"!==$t.protocol&&!I(pe)?(Yt=pe,M.addEventListener("message",fe,!1)):Yt=rn in O("script")?function(e){st.appendChild(O("script"))[rn]=function(){st.removeChild(this),Gt(e)}}:function(e){setTimeout(Qt(e),0)});var on,an,sn,un,cn,ln,hn,fn,pn={set:L,clear:E},pe=Y.f,dn=pn.set,fe=M.MutationObserver||M.WebKitMutationObserver,L=M.document,gn=M.process,E=M.Promise,pe=pe(M,"queueMicrotask"),pe=pe&&pe.value;pe||(on=function(){var e,t;for(Jt&&(e=gn.domain)&&e.exit();an;){t=an.fn,an=an.next;try{t()}catch(e){throw an?un():sn=void 0,e}}sn=void 0,e&&e.enter()},un=!Ve&&!Jt&&fe&&L?(cn=!0,ln=L.createTextNode(""),new fe(on).observe(ln,{characterData:!0}),function(){ln.data=cn=!cn}):E&&E.resolve?(hn=E.resolve(void 0),fn=hn.then,function(){fn.call(hn,on)}):Jt?function(){gn.nextTick(on)}:function(){dn.call(M,on)});function yn(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=dt(n),this.reject=dt(r)}function mn(e,t){return P(e),N(t)&&t.constructor===e?t:((0,(e=_n.f(e)).resolve)(t),e.promise)}function vn(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}var bn=pe||function(e){e={fn:e,next:void 0};sn&&(sn.next=e),an||(an=e,un()),sn=e},_n={f:function(e){return new yn(e)}},pe=M.process,pe=pe&&pe.versions,pe=pe&&pe.v8;pe?Zn=(Gn=pe.split("."))[0]+Gn[1]:we&&(!(Gn=we.match(/Edge\/(\d+)/))||74<=Gn[1])&&(Gn=we.match(/Chrome\/(\d+)/))&&(Zn=Gn[1]);function wn(e){var t;return!(!N(e)||"function"!=typeof(t=e.then))&&t}function En(h,f){var p;h.notified||(h.notified=!0,p=h.reactions,bn(function(){for(var e=h.value,t=1==h.state,n=0;p.length>n;){var r,i,o,a=p[n++],s=t?a.ok:a.fail,u=a.resolve,c=a.reject,l=a.domain;try{s?(t||(2===h.rejection&&Xn(h),h.rejection=1),!0===s?r=e:(l&&l.enter(),r=s(e),l&&(l.exit(),o=!0)),r===a.promise?c(Un("Promise-chain cycle")):(i=wn(r))?i.call(r,u,c):u(r)):c(e)}catch(e){l&&!o&&l.exit(),c(e)}}h.reactions=[],h.notified=!1,f&&!h.rejection&&Qn(h)}))}function Tn(e,t,n){var r,i;Wn?((r=qn.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),M.dispatchEvent(r)):r={promise:t,reason:n},!zn&&(i=M["on"+e])?i(r):e===Hn&&function(e,t){var n=M.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)}function In(t,n,r){return function(e){t(n,e,r)}}function Sn(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,En(e,!0))}var Cn,kn,An,Nn,Dn=Zn&&+Zn,Rn=pn.set,On=ft("species"),Pn="Promise",xn=Pe.get,Ln=Pe.set,Mn=Pe.getterFor(Pn),Fn=Ft,Un=M.TypeError,qn=M.document,jn=M.process,Vn=Te("fetch"),Bn=_n.f,Kn=Bn,Wn=!!(qn&&qn.createEvent&&M.dispatchEvent),zn="function"==typeof PromiseRejectionEvent,Hn="unhandledrejection",we=Ze(Pn,function(){if(!(he(Fn)!==String(Fn))){if(66===Dn)return!0;if(!Jt&&!zn)return!0}if(51<=Dn&&/native code/.test(Fn))return!1;function e(e){e(function(){},function(){})}var t=Fn.resolve(1);return(t.constructor={})[On]=e,!(t.then(function(){})instanceof e)}),Gn=we||!zt(function(e){Fn.all(e).catch(function(){})}),Qn=function(r){Rn.call(M,function(){var e,t=r.facade,n=r.value;if(Yn(r)&&(e=vn(function(){Jt?jn.emit("unhandledRejection",n,t):Tn(Hn,t,n)}),r.rejection=Jt||Yn(r)?2:1,e.error))throw e.value})},Yn=function(e){return 1!==e.rejection&&!e.parent},Xn=function(t){Rn.call(M,function(){var e=t.facade;Jt?jn.emit("rejectionHandled",e):Tn("rejectionhandled",e,t.value)})},Jn=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw Un("Promise can't be resolved itself");var r=wn(e);r?bn(function(){var t={done:!1};try{r.call(e,In(Jn,t,n),In(Sn,t,n))}catch(e){Sn(t,e,n)}}):(n.value=e,n.state=1,En(n,!1))}catch(e){Sn({done:!1},e,n)}}};we&&(Fn=function(e){Mt(this,Fn,Pn),dt(e),Cn.call(this);var t=xn(this);try{e(In(Jn,t),In(Sn,t))}catch(e){Sn(t,e)}},(Cn=function(){Ln(this,{type:Pn,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Pt(Fn.prototype,{then:function(e,t){var n=Mn(this),r=Bn(Ht(this,Fn));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Jt?jn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&En(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),kn=function(){var e=new Cn,t=xn(e);this.promise=e,this.resolve=In(Jn,t),this.reject=In(Sn,t)},_n.f=Bn=function(e){return e===Fn||e===An?new kn:Kn(e)},"function"==typeof Ft&&(Nn=Ft.prototype.then,xe(Ft.prototype,"then",function(e,t){var n=this;return new Fn(function(e,t){Nn.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof Vn&&Ae({global:!0,enumerable:!0,forced:!0},{fetch:function(){return mn(Fn,Vn.apply(M,arguments))}}))),Ae({global:!0,wrap:!0,forced:we},{Promise:Fn}),xt(Fn,Pn,!1),Lt(Pn),An=Te(Pn),Ae({target:Pn,stat:!0,forced:we},{reject:function(e){var t=Bn(this);return t.reject.call(void 0,e),t.promise}}),Ae({target:Pn,stat:!0,forced:we},{resolve:function(e){return mn(this,e)}}),Ae({target:Pn,stat:!0,forced:Gn},{all:function(e){var s=this,t=Bn(s),u=t.resolve,c=t.reject,n=vn(function(){var r=dt(s.resolve),i=[],o=0,a=1;kt(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(s,e).then(function(e){n||(n=!0,i[t]=e,--a||u(i))},c)}),--a||u(i)});return n.error&&c(n.value),t.promise},race:function(e){var n=this,r=Bn(n),i=r.reject,t=vn(function(){var t=dt(n.resolve);kt(e,function(e){t.call(n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}}),Ae({target:"Promise",stat:!0},{allSettled:function(e){var s=this,t=_n.f(s),u=t.resolve,n=t.reject,r=vn(function(){var r=dt(s.resolve),i=[],o=0,a=1;kt(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(s,e).then(function(e){n||(n=!0,i[t]={status:"fulfilled",value:e},--a||u(i))},function(e){n||(n=!0,i[t]={status:"rejected",reason:e},--a||u(i))})}),--a||u(i)});return r.error&&n(r.value),t.promise}});var $n="No one promise resolved";Ae({target:"Promise",stat:!0},{any:function(e){var u=this,t=_n.f(u),c=t.resolve,l=t.reject,n=vn(function(){var r=dt(u.resolve),i=[],o=0,a=1,s=!1;kt(e,function(e){var t=o++,n=!1;i.push(void 0),a++,r.call(u,e).then(function(e){n||s||(s=!0,c(e))},function(e){n||s||(n=!0,i[t]=e,--a||l(new(Te("AggregateError"))(i,$n)))})}),--a||l(new(Te("AggregateError"))(i,$n))});return n.error&&l(n.value),t.promise}});var Zn=!!Ft&&I(function(){Ft.prototype.finally.call({then:function(){}},function(){})});Ae({target:"Promise",proto:!0,real:!0,forced:Zn},{finally:function(t){var n=Ht(this,Te("Promise")),e="function"==typeof t;return this.then(e?function(e){return mn(n,t()).then(function(){return e})}:t,e?function(e){return mn(n,t()).then(function(){throw e})}:t)}}),"function"!=typeof Ft||Ft.prototype.finally||xe(Ft.prototype,"finally",Te("Promise").prototype.finally);pn=function(o){return function(e,t){var n,r=String(k(e)),i=Ie(t),e=r.length;return i<0||e<=i?o?"":void 0:(t=r.charCodeAt(i))<55296||56319<t||i+1===e||(n=r.charCodeAt(i+1))<56320||57343<n?o?r.charAt(i):t:o?r.slice(i,i+2):n-56320+(t-55296<<10)+65536}},we={codeAt:pn(!1),charAt:pn(!0)},Gn=ft("iterator"),Zn=!1;[].keys&&("next"in(yr=[].keys())?(Pr=rt(rt(yr)))!==Object.prototype&&(Mr=Pr):Zn=!0),null==Mr&&(Mr={}),R(Mr,Gn)||$(Mr,Gn,function(){return this});function er(){return this}function tr(){return this}function nr(e,t,n,r,i,o,a){function s(e){if(e===i&&d)return d;if(!or&&e in f)return f[e];switch(e){case"keys":case sr:case ur:return function(){return new n(this,e)}}return function(){return new n(this)}}!function(e,t,n){t+=" Iterator";e.prototype=yt(rr,{next:S(1,n)}),xt(e,t,!1),wt[t]=er}(n,t,r);var u,c,l=t+" Iterator",h=!1,f=e.prototype,p=f[ar]||f["@@iterator"]||i&&f[i],d=!or&&p||s(i);if((r="Array"==t&&f.entries||p)&&(e=rt(r.call(new e)),ir!==Object.prototype&&e.next&&(rt(e)!==ir&&(it?it(e,ir):"function"!=typeof e[ar]&&$(e,ar,tr)),xt(e,l,!0))),i==sr&&p&&p.name!==sr&&(h=!0,d=function(){return p.call(this)}),f[ar]!==d&&$(f,ar,d),wt[t]=d,i)if(u={values:s(sr),keys:o?d:s("keys"),entries:s(ur)},a)for(c in u)!or&&!h&&c in f||xe(f,c,u[c]);else Ae({target:t,proto:!0,forced:or||h},u);return u}var pn={IteratorPrototype:Mr,BUGGY_SAFARI_ITERATORS:Zn},rr=pn.IteratorPrototype,ir=pn.IteratorPrototype,or=pn.BUGGY_SAFARI_ITERATORS,ar=ft("iterator"),sr="values",ur="entries",cr=we.charAt,lr="String Iterator",hr=Pe.set,fr=Pe.getterFor(lr);nr(String,"String",function(e){hr(this,{type:lr,string:String(e),index:0})},function(){var e=fr(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(n=cr(t,n),e.index+=n.length,{value:n,done:!1})});var pr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},dr=ft("unscopables"),gr=Array.prototype;null==gr[dr]&&J.f(gr,dr,{configurable:!0,value:yt(null)});var yr=function(e){gr[dr][e]=!0},mr="Array Iterator",vr=Pe.set,br=Pe.getterFor(mr),_r=nr(Array,"Array",function(e,t){vr(this,{type:mr,target:A(e),index:0,kind:t})},function(){var e=br(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");wt.Arguments=wt.Array,yr("keys"),yr("values"),yr("entries");var wr,Er=ft("iterator"),Tr=ft("toStringTag"),Ir=_r.values;for(wr in pr){var Sr=M[wr],Cr=Sr&&Sr.prototype;if(Cr){if(Cr[Er]!==Ir)try{$(Cr,Er,Ir)}catch(rs){Cr[Er]=Ir}if(Cr[Tr]||$(Cr,Tr,wr),pr[wr])for(var kr in _r)if(Cr[kr]!==_r[kr])try{$(Cr,kr,_r[kr])}catch(rs){Cr[kr]=_r[kr]}}}Le.Promise;Ae({target:"Promise",stat:!0},{try:function(e){var t=_n.f(this),e=vn(e);return(e.error?t.reject:t.resolve)(e.value),t.promise}});function Ar(e,t){var n;return Dr(e)&&("function"==typeof(n=e.constructor)&&(n===Array||Dr(n.prototype))||N(n)&&null===(n=n[Rr]))&&(n=void 0),new(void 0===n?Array:n)(0===t?0:t)}function Nr(e){throw e}var Dr=Array.isArray||function(e){return"Array"==C(e)},Rr=ft("species"),Or=[].push,Pr=function(f){var p=1==f,d=2==f,g=3==f,y=4==f,m=6==f,v=5==f||m;return function(e,t,n,r){for(var i,o,a=Ne(e),s=K(a),u=gt(t,n,3),c=Se(s.length),l=0,r=r||Ar,h=p?r(e,c):d?r(e,0):void 0;l<c;l++)if((v||l in s)&&(o=u(i=s[l],l,a),f))if(p)h[l]=o;else if(o)switch(f){case 3:return!0;case 5:return i;case 6:return l;case 2:Or.call(h,i)}else if(y)return!1;return m?-1:g||y?y:h}},Gn={forEach:Pr(0),map:Pr(1),filter:Pr(2),some:Pr(3),every:Pr(4),find:Pr(5),findIndex:Pr(6)},xr=Object.defineProperty,Lr={},Mr=function(e,t){if(R(Lr,e))return Lr[e];var n=[][e],r=!!R(t=t||{},"ACCESSORS")&&t.ACCESSORS,i=R(t,0)?t[0]:Nr,o=R(t,1)?t[1]:void 0;return Lr[e]=!!n&&!I(function(){if(r&&!F)return 1;var e={length:-1};r?xr(e,1,{enumerable:!0,get:Nr}):e[1]=1,n.call(e,i,o)})},Fr=Gn.find,Zn="find",Ur=!0,pn=Mr(Zn);Zn in[]&&Array(1)[Zn](function(){Ur=!1}),Ae({target:"Array",proto:!0,forced:Ur||!pn},{find:function(e,t){return Fr(this,e,1<arguments.length?t:void 0)}}),yr(Zn);var qr=Function.call,we=function(e,t,n){return gt(qr,M[e].prototype[t],n)},jr=(we("Array","find"),Gn.findIndex),Pr="findIndex",Vr=!0,pn=Mr(Pr);Pr in[]&&Array(1)[Pr](function(){Vr=!1}),Ae({target:"Array",proto:!0,forced:Vr||!pn},{findIndex:function(e,t){return jr(this,e,1<arguments.length?t:void 0)}}),yr(Pr);function Br(e,t,n){(t=D(t))in e?J.f(e,t,S(0,n)):e[t]=n}we("Array","findIndex");Zn=!zt(function(e){Array.from(e)});Ae({target:"Array",stat:!0,forced:Zn},{from:function(e,t,n){var r,i,o,a,s,u,c=Ne(e),l="function"==typeof this?this:Array,e=arguments.length,h=1<e?t:void 0,f=void 0!==h,t=It(c),p=0;if(f&&(h=gt(h,2<e?n:void 0,2)),null==t||l==Array&&pt(t))for(i=new l(r=Se(c.length));p<r;p++)u=f?h(c[p],p):c[p],Br(i,p,u);else for(s=(a=t.call(c)).next,i=new l;!(o=s.call(a)).done;p++)u=f?function(t,e,n,r){try{return r?e(P(n)[0],n[1]):e(n)}catch(e){throw St(t),e}}(a,h,[o.value,p],!0):o.value,Br(i,p,u);return i.length=p,i}});Le.Array.from;var Kr,Wr,zr=Gn.some,pn=!!(Wr=[]["some"])&&I(function(){Wr.call(null,Kr||function(){throw 1},1)}),yr=Mr("some");Ae({target:"Array",proto:!0,forced:!pn||!yr},{some:function(e,t){return zr(this,e,1<arguments.length?t:void 0)}});we("Array","some");function Hr(e){return N(e)&&R(ei,Dt(e))}var Gr,Pr="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Zn=J.f,Qr=M.Int8Array,Yr=Qr&&Qr.prototype,Mr=M.Uint8ClampedArray,pn=Mr&&Mr.prototype,Xr=Qr&&rt(Qr),Jr=Yr&&rt(Yr),yr=Object.prototype,Mr=(yr.isPrototypeOf,ft("toStringTag")),$r=ne("TYPED_ARRAY_TAG"),Zr=Pr&&!!it&&"Opera"!==Dt(M.opera),Pr=!1,ei={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(Gr in ei)M[Gr]||(Zr=!1);if((!Zr||"function"!=typeof Xr||Xr===Function.prototype)&&(Xr=function(){throw TypeError("Incorrect invocation")},Zr))for(Gr in ei)M[Gr]&&it(M[Gr],Xr);if((!Zr||!Jr||Jr===yr)&&(Jr=Xr.prototype,Zr))for(Gr in ei)M[Gr]&&it(M[Gr].prototype,Jr);if(Zr&&rt(pn)!==Jr&&it(pn,Jr),F&&!R(Jr,Mr))for(Gr in Pr=!0,Zn(Jr,Mr,{get:function(){return N(this)?this[$r]:void 0}}),ei)M[Gr]&&$(M[Gr],$r,Gr);var pn=function(e){if(Hr(e))return e;throw TypeError("Target is not a typed array")},Zn=function(e,t,n){if(F){if(n)for(var r in ei){var i=M[r];i&&R(i.prototype,e)&&delete i.prototype[e]}Jr[e]&&!n||xe(Jr,e,!n&&Zr&&Yr[e]||t)}},Mr=ft("iterator"),Pr=M.Uint8Array,ti=_r.values,ni=_r.keys,ri=_r.entries,ii=pn,pn=Zn,Zn=Pr&&Pr.prototype[Mr],Pr=!!Zn&&("values"==Zn.name||null==Zn.name),Zn=function(){return ti.call(ii(this))};pn("entries",function(){return ri.call(ii(this))}),pn("keys",function(){return ni.call(ii(this))}),pn("values",Zn,!Pr),pn(Mr,Zn,!Pr);var oi=Object.assign,ai=Object.defineProperty,Zn=!oi||I(function(){if(F&&1!==oi({b:1},oi(ai({},"a",{enumerable:!0,get:function(){ai(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return 1;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=oi({},e)[n]||ot(oi({},t)).join("")!=r})?function(e){for(var t=Ne(e),n=arguments.length,r=1,i=He.f,o=j.f;r<n;)for(var a,s=K(arguments[r++]),u=i?ot(s).concat(i(s)):ot(s),c=u.length,l=0;l<c;)a=u[l++],F&&!o.call(s,a)||(t[a]=s[a]);return t}:oi;Ae({target:"Object",stat:!0,forced:Object.assign!==Zn},{assign:Zn});Le.Object.assign;var si=j.f,Pr=function(s){return function(e){for(var t,n=A(e),r=ot(n),i=r.length,o=0,a=[];o<i;)t=r[o++],F&&!si.call(n,t)||a.push(s?[t,n[t]]:n[t]);return a}},Zn={entries:Pr(!0),values:Pr(!1)},ui=Zn.entries;Ae({target:"Object",stat:!0},{entries:function(e){return ui(e)}});Le.Object.entries;var ci=Zn.values;Ae({target:"Object",stat:!0},{values:function(e){return ci(e)}});Le.Object.values;function li(e){if(N(t=e)&&(void 0!==(n=t[hi])?!!n:"RegExp"==C(t)))throw TypeError("The method doesn't accept regular expressions");var t,n;return e}var hi=ft("match"),fi=ft("match"),Pr=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[fi]=!1,"/./"[t](n)}catch(e){}}return!1};Ae({target:"String",proto:!0,forced:!Pr("includes")},{includes:function(e,t){return!!~String(k(this)).indexOf(li(e),1<arguments.length?t:void 0)}});we("String","includes");var pi,Zn=Y.f,di="".startsWith,gi=Math.min,Pr=Pr("startsWith"),pi=!(Pr||(!(pi=Zn(String.prototype,"startsWith"))||pi.writable));Ae({target:"String",proto:!0,forced:!pi&&!Pr},{startsWith:function(e,t){var n=String(k(this));li(e);t=Se(gi(1<arguments.length?t:void 0,n.length)),e=String(e);return di?di.call(n,e,t):n.slice(t,t+e.length)===e}});we("String","startsWith");Ae({target:"String",proto:!0},{repeat:"".repeat||function(e){var t=String(k(this)),n="",r=Ie(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}});we("String","repeat");var yi,mi=ft("species"),vi=ft("isConcatSpreadable"),bi=9007199254740991,_i="Maximum allowed index exceeded",Pr=51<=Dn||!I(function(){var e=[];return e[vi]=!1,e.concat()[0]!==e}),we=(yi="concat",51<=Dn||!I(function(){var e=[];return(e.constructor={})[mi]=function(){return{foo:1}},1!==e[yi](Boolean).foo}));Ae({target:"Array",proto:!0,forced:!Pr||!we},{concat:function(){for(var e,t,n,r=Ne(this),i=Ar(r,0),o=0,a=-1,s=arguments.length;a<s;a++)if(function(e){if(!N(e))return!1;var t=e[vi];return void 0!==t?!!t:Dr(e)}(n=-1===a?r:arguments[a])){if(t=Se(n.length),bi<o+t)throw TypeError(_i);for(e=0;e<t;e++,o++)e in n&&Br(i,o,n[e])}else{if(bi<=o)throw TypeError(_i);Br(i,o++,n)}return i.length=o,i}});function wi(e){var t=Le.Symbol||(Le.Symbol={});R(t,e)||Ai(t,e,{value:ki.f(e)})}function Ei(e,t){var n=Bi[e]=yt(Mi[Oi]);return Pi(n,{type:Ri,tag:e,description:t}),F||(n.description=t),n}function Ti(t,e){P(t);var n=A(e),e=ot(n).concat(Ji(n));return Ni(e,function(e){F&&!Xi.call(n,e)||Yi(t,e,n[e])}),t}var Ii=ze.f,Si={}.toString,Ci="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],we={f:function(e){return Ci&&"[object Window]"==Si.call(e)?function(e){try{return Ii(e)}catch(e){return Ci.slice()}}(e):Ii(A(e))}},ki={f:ft},Ai=J.f,Ni=Gn.forEach,Di=be("hidden"),Ri="Symbol",Oi="prototype",Gn=ft("toPrimitive"),Pi=Pe.set,xi=Pe.getterFor(Ri),Li=Object[Oi],Mi=M.Symbol,Fi=Te("JSON","stringify"),Ui=Y.f,qi=J.f,ji=we.f,Vi=j.f,Bi=ge("symbols"),Ki=ge("op-symbols"),Wi=ge("string-to-symbol-registry"),zi=ge("symbol-to-string-registry"),be=ge("wks"),ge=M.QObject,Hi=!ge||!ge[Oi]||!ge[Oi].findChild,Gi=F&&I(function(){return 7!=yt(qi({},"a",{get:function(){return qi(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=Ui(Li,t);r&&delete Li[t],qi(e,t,n),r&&e!==Li&&qi(Li,t,r)}:qi,Qi=U?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Mi},Yi=function(e,t,n){e===Li&&Yi(Ki,t,n),P(e);t=D(t,!0);return P(n),R(Bi,t)?(n.enumerable?(R(e,Di)&&e[Di][t]&&(e[Di][t]=!1),n=yt(n,{enumerable:S(0,!1)})):(R(e,Di)||qi(e,Di,S(1,{})),e[Di][t]=!0),Gi(e,t,n)):qi(e,t,n)},Xi=function(e){var t=D(e,!0),e=Vi.call(this,t);return!(this===Li&&R(Bi,t)&&!R(Ki,t))&&(!(e||!R(this,t)||!R(Bi,t)||R(this,Di)&&this[Di][t])||e)},ge=function(e,t){var n=A(e),e=D(t,!0);if(n!==Li||!R(Bi,e)||R(Ki,e)){t=Ui(n,e);return!t||!R(Bi,e)||R(n,Di)&&n[Di][e]||(t.enumerable=!0),t}},U=function(e){var e=ji(A(e)),t=[];return Ni(e,function(e){R(Bi,e)||R(_e,e)||t.push(e)}),t},Ji=function(e){var t=e===Li,e=ji(t?Ki:A(e)),n=[];return Ni(e,function(e){!R(Bi,e)||t&&!R(Li,e)||n.push(Bi[e])}),n};mt||(xe((Mi=function(e){if(this instanceof Mi)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==e?String(e):void 0,t=ne(e),n=function(e){this===Li&&n.call(Ki,e),R(this,Di)&&R(this[Di],t)&&(this[Di][t]=!1),Gi(this,t,S(1,e))};return F&&Hi&&Gi(Li,t,{configurable:!0,set:n}),Ei(t,e)})[Oi],"toString",function(){return xi(this).tag}),xe(Mi,"withoutSetter",function(e){return Ei(ne(e),e)}),j.f=Xi,J.f=Yi,Y.f=ge,ze.f=we.f=U,He.f=Ji,ki.f=function(e){return Ei(ft(e),e)},F&&(qi(Mi[Oi],"description",{configurable:!0,get:function(){return xi(this).description}}),xe(Li,"propertyIsEnumerable",Xi,{unsafe:!0}))),Ae({global:!0,wrap:!0,forced:!mt,sham:!mt},{Symbol:Mi}),Ni(ot(be),function(e){wi(e)}),Ae({target:Ri,stat:!0,forced:!mt},{for:function(e){var t=String(e);if(R(Wi,t))return Wi[t];e=Mi(t);return Wi[t]=e,zi[e]=t,e},keyFor:function(e){if(!Qi(e))throw TypeError(e+" is not a symbol");if(R(zi,e))return zi[e]},useSetter:function(){Hi=!0},useSimple:function(){Hi=!1}}),Ae({target:"Object",stat:!0,forced:!mt,sham:!F},{create:function(e,t){return void 0===t?yt(e):Ti(yt(e),t)},defineProperty:Yi,defineProperties:Ti,getOwnPropertyDescriptor:ge}),Ae({target:"Object",stat:!0,forced:!mt},{getOwnPropertyNames:U,getOwnPropertySymbols:Ji}),Ae({target:"Object",stat:!0,forced:I(function(){He.f(1)})},{getOwnPropertySymbols:function(e){return He.f(Ne(e))}}),Fi&&(lo=!mt||I(function(){var e=Mi();return"[null]"!=Fi([e])||"{}"!=Fi({a:e})||"{}"!=Fi(Object(e))}),Ae({target:"JSON",stat:!0,forced:lo},{stringify:function(e,t){for(var n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if((N(n=t)||void 0!==e)&&!Qi(e))return Dr(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Qi(t))return t}),r[1]=t,Fi.apply(null,r)}})),Mi[Oi][Gn]||$(Mi[Oi],Gn,Mi[Oi].valueOf),xt(Mi,Ri),_e[Di]=!0,wi("asyncIterator");var $i,Zi,eo,to,no,ge=J.f,ro=M.Symbol;!F||"function"!=typeof ro||"description"in ro.prototype&&void 0===ro().description||($i={},ke(Zi=function(e){var t=arguments.length<1||void 0===e?void 0:String(e),e=this instanceof Zi?new ro(t):void 0===t?ro():ro(t);return""===t&&($i[e]=!0),e},ro),(po=Zi.prototype=ro.prototype).constructor=Zi,eo=po.toString,to="Symbol(test)"==String(ro("test")),no=/^Symbol\((.*)\)[^)]+$/,ge(po,"description",{configurable:!0,get:function(){var e=N(this)?this.valueOf():this,t=eo.call(e);if(R($i,e))return"";t=to?t.slice(7,-1):t.replace(no,"$1");return""===t?void 0:t}}),Ae({global:!0,forced:!0},{Symbol:Zi})),wi("hasInstance"),wi("isConcatSpreadable"),wi("iterator"),wi("match"),wi("matchAll"),wi("replace"),wi("search"),wi("species"),wi("split"),wi("toPrimitive"),wi("toStringTag"),wi("unscopables"),xt(M.JSON,"JSON",!0),xt(Math,"Math",!0),Ae({global:!0},{Reflect:{}}),xt(M.Reflect,"Reflect",!0);Le.Symbol;wi("asyncDispose"),wi("dispose"),wi("observable"),wi("patternMatch"),wi("replaceAll");ki.f("iterator");var io=!I(function(){return Object.isExtensible(Object.preventExtensions({}))}),oo=T(function(e){function n(e){t(e,r,{value:{objectID:"O"+ ++i,weakData:{}}})}var t=J.f,r=ne("meta"),i=0,o=Object.isExtensible||function(){return!0},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!N(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!R(e,r)){if(!o(e))return"F";if(!t)return"E";n(e)}return e[r].objectID},getWeakData:function(e,t){if(!R(e,r)){if(!o(e))return!0;if(!t)return!1;n(e)}return e[r].weakData},onFreeze:function(e){return io&&a.REQUIRED&&o(e)&&!R(e,r)&&n(e),e}};_e[r]=!0}),U=function(a,e,t){function n(e){var n=p[e];xe(p,e,"add"==e?function(e){return n.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(l&&!N(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return l&&!N(e)?void 0:n.call(this,0===e?0:e)}:"has"==e?function(e){return!(l&&!N(e))&&n.call(this,0===e?0:e)}:function(e,t){return n.call(this,0===e?0:e,t),this})}var r,i,o,s,u,c=-1!==a.indexOf("Map"),l=-1!==a.indexOf("Weak"),h=c?"set":"add",f=M[a],p=f&&f.prototype,d=f,g={};return Ze(a,"function"!=typeof f||!(l||p.forEach&&!I(function(){(new f).entries().next()})))?(d=t.getConstructor(e,a,c,h),oo.REQUIRED=!0):Ze(a,!0)&&(i=(r=new d)[h](l?{}:-0,1)!=r,o=I(function(){r.has(1)}),s=zt(function(e){new f(e)}),u=!l&&I(function(){for(var e=new f,t=5;t--;)e[h](t,t);return!e.has(-0)}),s||(((d=e(function(e,t){Mt(e,d,a);var n,r,i,o,n=(n=new f,r=e,e=d,it&&"function"==typeof(i=r.constructor)&&i!==e&&N(o=i.prototype)&&o!==e.prototype&&it(n,o),n);return null!=t&&kt(t,n[h],{that:n,AS_ENTRIES:c}),n})).prototype=p).constructor=d),(o||u)&&(n("delete"),n("has"),c&&n("get")),(u||i)&&n(h),l&&p.clear&&delete p.clear),g[a]=d,Ae({global:!0,forced:d!=f},g),xt(d,a),l||t.setStrong(d,a,c),d},ao=J.f,so=oo.fastKey,uo=Pe.set,co=Pe.getterFor,lo={getConstructor:function(e,n,r,i){function o(e,t,n){var r,i=s(e),o=u(e,t);return o?o.value=n:(i.last=o={index:r=so(t,!0),key:t,value:n,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=o),n&&(n.next=o),F?i.size++:e.size++,"F"!==r&&(i.index[r]=o)),e}var a=e(function(e,t){Mt(e,a,n),uo(e,{type:n,index:yt(null),first:void 0,last:void 0,size:0}),F||(e.size=0),null!=t&&kt(t,e[i],{that:e,AS_ENTRIES:r})}),s=co(n),u=function(e,t){var n,r=s(e),e=so(t);if("F"!==e)return r.index[e];for(n=r.first;n;n=n.next)if(n.key==t)return n};return Pt(a.prototype,{clear:function(){for(var e=s(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,F?e.size=0:this.size=0},delete:function(e){var t,n=s(this),r=u(this,e);return r&&(t=r.next,e=r.previous,delete n.index[r.index],r.removed=!0,e&&(e.next=t),t&&(t.previous=e),n.first==r&&(n.first=t),n.last==r&&(n.last=e),F?n.size--:this.size--),!!r},forEach:function(e,t){for(var n,r=s(this),i=gt(e,1<arguments.length?t:void 0,3);n=n?n.next:r.first;)for(i(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(e){return!!u(this,e)}}),Pt(a.prototype,r?{get:function(e){e=u(this,e);return e&&e.value},set:function(e,t){return o(this,0===e?0:e,t)}}:{add:function(e){return o(this,e=0===e?0:e,e)}}),F&&ao(a.prototype,"size",{get:function(){return s(this).size}}),a},setStrong:function(e,t,n){var r=t+" Iterator",i=co(t),o=co(r);nr(e,t,function(e,t){uo(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),Lt(t)}},Gn=(U("Map",function(t){return function(e){return t(this,arguments.length?e:void 0)}},lo),Le.Map,function(e,t,n){var r,i,o,a=arguments.length,s=1<a?t:void 0;return dt(this),(t=void 0!==s)&&dt(s),null==e?new this:(r=[],t?(i=0,o=gt(s,2<a?n:void 0,2),kt(e,function(e){r.push(o(e,i++))})):kt(e,r.push,{that:r}),new this(r))});Ae({target:"Map",stat:!0},{from:Gn});ge=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};Ae({target:"Map",stat:!0},{of:ge});function ho(){for(var e,t=P(this),n=dt(t.delete),r=!0,i=0,o=arguments.length;i<o;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r}Ae({target:"Map",proto:!0,real:!0,forced:de},{deleteAll:function(){return ho.apply(this,arguments)}});Ae({target:"Map",proto:!0,real:!0,forced:de},{emplace:function(e,t){var n=P(this),t=n.has(e)&&"update"in t?t.update(n.get(e),e,n):t.insert(e,n);return n.set(e,t),t}});function fo(e){return Map.prototype.entries.call(e)}Ae({target:"Map",proto:!0,real:!0,forced:de},{every:function(e,t){var r=P(this),n=fo(r),i=gt(e,1<arguments.length?t:void 0,3);return!kt(n,function(e,t,n){if(!i(t,e,r))return n()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{filter:function(e,t){var n=P(this),r=fo(n),i=gt(e,1<arguments.length?t:void 0,3),o=new(Ht(n,Te("Map"))),a=dt(o.set);return kt(r,function(e,t){i(t,e,n)&&a.call(o,e,t)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{find:function(e,t){var r=P(this),n=fo(r),i=gt(e,1<arguments.length?t:void 0,3);return kt(n,function(e,t,n){if(i(t,e,r))return n(t)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{findKey:function(e,t){var r=P(this),n=fo(r),i=gt(e,1<arguments.length?t:void 0,3);return kt(n,function(e,t,n){if(i(t,e,r))return n(e)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",stat:!0},{groupBy:function(e,n){var r=new this;dt(n);var i=dt(r.has),o=dt(r.get),a=dt(r.set);return kt(e,function(e){var t=n(e);i.call(r,t)?o.call(r,t).push(e):a.call(r,t,[e])}),r}});Ae({target:"Map",proto:!0,real:!0,forced:de},{includes:function(i){return kt(fo(P(this)),function(e,t,n){if((r=t)===(t=i)||r!=r&&t!=t)return n();var r},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;dt(t);var r=dt(n.set);return kt(e,function(e){r.call(n,t(e),e)}),n}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{keyOf:function(r){return kt(fo(P(this)),function(e,t,n){if(t===r)return n(e)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{mapKeys:function(e,t){var n=P(this),r=fo(n),i=gt(e,1<arguments.length?t:void 0,3),o=new(Ht(n,Te("Map"))),a=dt(o.set);return kt(r,function(e,t){a.call(o,i(t,e,n),t)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{mapValues:function(e,t){var n=P(this),r=fo(n),i=gt(e,1<arguments.length?t:void 0,3),o=new(Ht(n,Te("Map"))),a=dt(o.set);return kt(r,function(e,t){a.call(o,e,i(t,e,n))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{merge:function(){for(var e=P(this),t=dt(e.set),n=0;n<arguments.length;)kt(arguments[n++],t,{that:e,AS_ENTRIES:!0});return e}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{reduce:function(n,e){var r=P(this),t=fo(r),i=arguments.length<2,o=i?void 0:e;if(dt(n),kt(t,function(e,t){o=i?(i=!1,t):n(o,t,e,r)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),i)throw TypeError("Reduce of empty map with no initial value");return o}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{some:function(e,t){var r=P(this),n=fo(r),i=gt(e,1<arguments.length?t:void 0,3);return kt(n,function(e,t,n){if(i(t,e,r))return n()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:de},{update:function(e,t,n){var r=P(this),i=arguments.length;dt(t);var o=r.has(e);if(!o&&i<3)throw TypeError("Updating absent value");n=o?r.get(e):dt(2<i?n:void 0)(e,r);return r.set(e,t(n,e,r)),r}});var po=function(e,t,n){var r,i=P(this),n=2<arguments.length?n:void 0;if("function"!=typeof t&&"function"!=typeof n)throw TypeError("At least one callback required");return i.has(e)?(r=i.get(e),"function"==typeof t&&(r=t(r),i.set(e,r))):"function"==typeof n&&(r=n(),i.set(e,r)),r};Ae({target:"Map",proto:!0,real:!0,forced:de},{upsert:po}),Ae({target:"Map",proto:!0,real:!0,forced:de},{updateOrInsert:po});U("Set",function(t){return function(e){return t(this,arguments.length?e:void 0)}},lo),Le.Set;Ae({target:"Set",stat:!0},{from:Gn}),Ae({target:"Set",stat:!0},{of:ge});Ae({target:"Set",proto:!0,real:!0,forced:de},{addAll:function(){return function(){for(var e=P(this),t=dt(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e}.apply(this,arguments)}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{deleteAll:function(){return ho.apply(this,arguments)}});function go(e){return Set.prototype.values.call(e)}Ae({target:"Set",proto:!0,real:!0,forced:de},{every:function(e,t){var n=P(this),r=go(n),i=gt(e,1<arguments.length?t:void 0,3);return!kt(r,function(e,t){if(!i(e,e,n))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{difference:function(e){var t=P(this),n=new(Ht(t,Te("Set")))(t),r=dt(n.delete);return kt(e,function(e){r.call(n,e)}),n}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{filter:function(e,t){var n=P(this),r=go(n),i=gt(e,1<arguments.length?t:void 0,3),o=new(Ht(n,Te("Set"))),a=dt(o.add);return kt(r,function(e){i(e,e,n)&&a.call(o,e)},{IS_ITERATOR:!0}),o}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{find:function(e,t){var n=P(this),r=go(n),i=gt(e,1<arguments.length?t:void 0,3);return kt(r,function(e,t){if(i(e,e,n))return t(e)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{intersection:function(e){var t=P(this),n=new(Ht(t,Te("Set"))),r=dt(t.has),i=dt(n.add);return kt(e,function(e){r.call(t,e)&&i.call(n,e)}),n}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{isDisjointFrom:function(e){var n=P(this),r=dt(n.has);return!kt(e,function(e,t){if(!0===r.call(n,e))return t()},{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{isSubsetOf:function(e){var t=function(e){var t=It(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return P(t.call(e))}(this),n=P(e),r=n.has;return"function"!=typeof r&&(n=new(Te("Set"))(e),r=dt(n.has)),!kt(t,function(e,t){if(!1===r.call(n,e))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{isSupersetOf:function(e){var n=P(this),r=dt(n.has);return!kt(e,function(e,t){if(!1===r.call(n,e))return t()},{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{join:function(e){var t=P(this),n=go(t),t=void 0===e?",":String(e),e=[];return kt(n,e.push,{that:e,IS_ITERATOR:!0}),e.join(t)}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{map:function(e,t){var n=P(this),r=go(n),i=gt(e,1<arguments.length?t:void 0,3),o=new(Ht(n,Te("Set"))),a=dt(o.add);return kt(r,function(e){a.call(o,i(e,e,n))},{IS_ITERATOR:!0}),o}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{reduce:function(t,e){var n=P(this),r=go(n),i=arguments.length<2,o=i?void 0:e;if(dt(t),kt(r,function(e){o=i?(i=!1,e):t(o,e,e,n)},{IS_ITERATOR:!0}),i)throw TypeError("Reduce of empty set with no initial value");return o}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{some:function(e,t){var n=P(this),r=go(n),i=gt(e,1<arguments.length?t:void 0,3);return kt(r,function(e,t){if(i(e,e,n))return t()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{symmetricDifference:function(e){var t=P(this),n=new(Ht(t,Te("Set")))(t),r=dt(n.delete),i=dt(n.add);return kt(e,function(e){r.call(n,e)||i.call(n,e)}),n}}),Ae({target:"Set",proto:!0,real:!0,forced:de},{union:function(e){var t=P(this),t=new(Ht(t,Te("Set")))(t);return kt(e,dt(t.add),{that:t}),t}});var yo=Math.floor;Ae({target:"Number",stat:!0},{isInteger:function(e){return!N(e)&&isFinite(e)&&yo(e)===e}});Le.Number.isInteger;Ae({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});Le.Number.isNaN;var mo=function(e,t){return(mo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function vo(e,t){function n(){this.constructor=e}mo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var bo=function(){return(bo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function _o(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})}function wo(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function Eo(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function To(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Io(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(To(arguments[t]));return e}function So(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function Co(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t}function ko(e){try{return Ro.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}var Ao={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},No=function(e,t){if(!e)throw Do(t)},Do=function(e){return new Error("Firebase Database ("+Ao.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},Ro={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,o=(3&o)<<4|s>>4,s=(15&s)<<2|c>>6,c=63&c;u||(c=64,a||(s=64)),r.push(n[l],n[o],n[s],n[c])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Co(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i,o,a,s=e[n++];s<128?t[r++]=String.fromCharCode(s):191<s&&s<224?(o=e[n++],t[r++]=String.fromCharCode((31&s)<<6|63&o)):239<s&&s<365?(i=((7&s)<<18|(63&(o=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))):(o=e[n++],a=e[n++],t[r++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&a))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();o=o<<2|a>>4;r.push(o),64!==s&&(a=a<<4&240|s>>2,r.push(a),64!==u&&(u=s<<6&192|u,r.push(u)))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};function Oo(e){return Po(void 0,e)}function Po(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Po(e[n],t[n]));return e}var xo=(Lo.prototype.wrapCallback=function(n){var r=this;return function(e,t){e?r.reject(e):r.resolve(t),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(e):n(e,t))}},Lo);function Lo(){var n=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}function Mo(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Fo(){return"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mo())}function Uo(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function qo(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function jo(){return!0===Ao.NODE_ADMIN}function Vo(){return"indexedDB"in self&&null!=indexedDB}function Bo(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}function Ko(){return!(!navigator||!navigator.cookieEnabled)}var Wo,zo="FirebaseError",Ho=(vo(Go,Wo=Error),Go);function Go(e,t,n){t=Wo.call(this,t)||this;return t.code=e,t.customData=n,t.name=zo,Object.setPrototypeOf(t,Go.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,Qo.prototype.create),t}var Qo=(Yo.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e,e=this.errors[e],e=e?(r=i,e.replace(Xo,function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"})):"Error",e=this.serviceName+": "+e+" ("+o+").";return new Ho(o,e,i)},Yo);function Yo(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var Xo=/\{\$([^}]+)}/g;function Jo(e){return JSON.parse(e)}function $o(e){return JSON.stringify(e)}function Zo(e){var t={},n={},r={},i="";try{var o=e.split("."),t=Jo(ko(o[0])||""),n=Jo(ko(o[1])||""),i=o[2],r=n.d||{};delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}}function ea(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ta(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function na(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function ra(e,t,n){var r,i={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}var ia=(oa.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},oa.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4],r=0;r<80;r++){a=r<40?r<20?(o=l^u&(c^l),1518500249):(o=u^c^l,1859775393):r<60?(o=u&c|l&(u|c),2400959708):(o=u^c^l,3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},oa.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},oa.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},oa);function oa(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}function aa(e,t){t=new sa(e,t);return t.subscribe.bind(t)}var sa=(ua.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},ua.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},ua.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},ua.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=ca),void 0===r.error&&(r.error=ca),void 0===r.complete&&(r.complete=ca);n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),n},ua.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ua.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},ua.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},ua.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},ua);function ua(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function ca(){}function la(e,t,n,r){var i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function ha(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}e+=" failed: ";return e+=r+" argument "}function fa(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ha(e,t,r)+"must be a valid function.")}function pa(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ha(e,t,r)+"must be a valid context object.")}function da(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?(t+=4,n++):t+=3}return t}var ga=1e3,ya=2,ma=144e5,va=.5;function ba(e,t,n){void 0===t&&(t=ga),void 0===n&&(n=ya);n=t*Math.pow(n,e),e=Math.round(va*n*(Math.random()-.5)*2);return Math.min(ma,n+e)}var _a=(wa.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},wa.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},wa.prototype.setServiceProps=function(e){return this.serviceProps=e,this},wa);function wa(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ea="[DEFAULT]",Ta=(Ia.prototype.get=function(e){void 0===e&&(e=Ea);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new xo;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},Ia.prototype.getImmediate=function(e){var t=bo({identifier:Ea,optional:!1},e),e=t.identifier,n=t.optional,r=this.normalizeInstanceIdentifier(e);try{var i=this.getOrInitializeService(r);if(i)return i;if(n)return null;throw Error("Service "+this.name+" is not available")}catch(e){if(n)return null;throw e}},Ia.prototype.getComponent=function(){return this.component},Ia.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=e).instantiationMode)try{this.getOrInitializeService(Ea)}catch(e){}try{for(var r=Eo(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=To(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},Ia.prototype.clearInstance=function(e){void 0===e&&(e=Ea),this.instancesDeferred.delete(e),this.instances.delete(e)},Ia.prototype.delete=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Io(t.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}),t.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()})))];case 1:return e.sent(),[2]}})})},Ia.prototype.isComponentSet=function(){return null!=this.component},Ia.prototype.getOrInitializeService=function(e){var t,n=this.instances.get(e);return!n&&this.component&&(n=this.component.instanceFactory(this.container,(t=e)===Ea?void 0:t),this.instances.set(e,n)),n||null},Ia.prototype.normalizeInstanceIdentifier=function(e){return!this.component||this.component.multipleInstances?e:Ea},Ia);function Ia(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var Sa=(Ca.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},Ca.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},Ca.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ta(e,this);return this.providers.set(e,t),t},Ca.prototype.getProviders=function(){return Array.from(this.providers.values())},Ca);function Ca(e){this.name=e,this.providers=new Map}function ka(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var Aa,Na=[];(Gn=Aa=Aa||{})[Gn.DEBUG=0]="DEBUG",Gn[Gn.VERBOSE=1]="VERBOSE",Gn[Gn.INFO=2]="INFO",Gn[Gn.WARN=3]="WARN",Gn[Gn.ERROR=4]="ERROR",Gn[Gn.SILENT=5]="SILENT";function Da(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=Pa[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,ka(["["+i+"]  "+e.name+":"],n))}}var Ra={debug:Aa.DEBUG,verbose:Aa.VERBOSE,info:Aa.INFO,warn:Aa.WARN,error:Aa.ERROR,silent:Aa.SILENT},Oa=Aa.INFO,Pa=((ge={})[Aa.DEBUG]="log",ge[Aa.VERBOSE]="log",ge[Aa.INFO]="info",ge[Aa.WARN]="warn",ge[Aa.ERROR]="error",ge),xa=(Object.defineProperty(La.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in Aa))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),La.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Ra[e]:e},Object.defineProperty(La.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),La.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,ka([this,Aa.DEBUG],e)),this._logHandler.apply(this,ka([this,Aa.DEBUG],e))},La.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,ka([this,Aa.VERBOSE],e)),this._logHandler.apply(this,ka([this,Aa.VERBOSE],e))},La.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,ka([this,Aa.INFO],e)),this._logHandler.apply(this,ka([this,Aa.INFO],e))},La.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,ka([this,Aa.WARN],e)),this._logHandler.apply(this,ka([this,Aa.WARN],e))},La.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,ka([this,Aa.ERROR],e)),this._logHandler.apply(this,ka([this,Aa.ERROR],e))},La);function La(e){this.name=e,this._logLevel=Oa,this._logHandler=Da,this._userLogHandler=null,Na.push(this)}function Ma(t){Na.forEach(function(e){e.setLogLevel(t)})}var Gn=((de={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",de["bad-app-name"]="Illegal App name: '{$appName}",de["duplicate-app"]="Firebase App named '{$appName}' already exists",de["app-deleted"]="Firebase App named '{$appName}' already deleted",de["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",de["invalid-log-argument"]="First argument to `onLog` must be null or a function.",de),Fa=new Qo("app","Firebase",Gn),Ua="@firebase/app",qa="[DEFAULT]",ja=((ge={})[Ua]="fire-core",ge["@firebase/analytics"]="fire-analytics",ge["@firebase/auth"]="fire-auth",ge["@firebase/database"]="fire-rtdb",ge["@firebase/functions"]="fire-fn",ge["@firebase/installations"]="fire-iid",ge["@firebase/messaging"]="fire-fcm",ge["@firebase/performance"]="fire-perf",ge["@firebase/remote-config"]="fire-rc",ge["@firebase/storage"]="fire-gcs",ge["@firebase/firestore"]="fire-fst",ge["fire-js"]="fire-js",ge["firebase-wrapper"]="fire-js-all",ge),Va=new xa("@firebase/app"),Ba=(Object.defineProperty(Ka.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(Ka.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(Ka.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),Ka.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(e){return e.delete()}))}).then(function(){t.isDeleted_=!0})},Ka.prototype._getService=function(e,t){return void 0===t&&(t=qa),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},Ka.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=qa),this.container.getProvider(e).clearInstance(t)},Ka.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){Va.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},Ka.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},Ka.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Fa.create("app-deleted",{appName:this.name_})},Ka);function Ka(e,t,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Oo(e),this.container=new Sa(t.name),this._addComponent(new _a("app",function(){return o},"PUBLIC"));try{for(var a=Eo(this.firebase_.INTERNAL.components.values()),s=a.next();!s.done;s=a.next()){var u=s.value;this._addComponent(u)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}Ba.prototype.name&&Ba.prototype.options||Ba.prototype.delete||console.log("dc");var Wa="8.1.1-1.0.0-eap-firestore-debug.9c6096f43";function za(u){var c={},l=new Map,h={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={});{"object"==typeof t&&null!==t||(t={name:t})}var n=t;void 0===n.name&&(n.name=qa);t=n.name;if("string"!=typeof t||!t)throw Fa.create("bad-app-name",{appName:String(t)});if(ea(c,t))throw Fa.create("duplicate-app",{appName:t});n=new u(e,n,h);return c[t]=n},app:f,registerVersion:function(e,t,n){var r=null!==(i=ja[e])&&void 0!==i?i:e;n&&(r+="-"+n);var i=r.match(/\s|\//),e=t.match(/\s|\//);if(i||e){n=['Unable to register library "'+r+'" with version "'+t+'":'];return i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&e&&n.push("and"),e&&n.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void Va.warn(n.join(" "))}o(new _a(r+"-version",function(){return{library:r,version:t}},"VERSION"))},setLogLevel:Ma,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw Fa.create("invalid-log-argument",{appName:name});!function(a,t){for(var e=0,n=Na;e<n.length;e++){!function(e){var o=null;t&&t.level&&(o=Ra[t.level]),e.userLogHandler=null===a?null:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(function(e){return e}).join(" ");t>=(null!=o?o:e.logLevel)&&a({level:Aa[t].toLowerCase(),message:i,args:n,type:e.name})}}(n[e])}}(e,t)},apps:null,SDK_VERSION:Wa,INTERNAL:{registerComponent:o,removeApp:function(e){delete c[e]},components:l,useAsService:function(e,t){if("serverAuth"===t)return null;return t}}};function f(e){if(!ea(c,e=e||qa))throw Fa.create("no-app",{appName:e});return c[e]}function o(n){var t,e,r,i=n.name;if(l.has(i))return Va.debug("There were multiple attempts to register component "+i+"."),"PUBLIC"===n.type?h[i]:null;l.set(i,n),"PUBLIC"===n.type&&(r=function(e){if(void 0===e&&(e=f()),"function"!=typeof e[i])throw Fa.create("invalid-app-argument",{appName:i});return e[i]()},void 0!==n.serviceProps&&Po(r,n.serviceProps),h[i]=r,u.prototype[i]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,i).apply(this,n.multipleInstances?e:[])});try{for(var o=Eo(Object.keys(c)),a=o.next();!a.done;a=o.next()){var s=a.value;c[s]._addComponent(n)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return"PUBLIC"===n.type?h[i]:null}return h.default=h,Object.defineProperty(h,"apps",{get:function(){return Object.keys(c).map(function(e){return c[e]})}}),f.App=u,h}var de=function e(){var t=za(Ba);return t.INTERNAL=bo(bo({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Po(t,e)},createSubscribe:aa,ErrorFactory:Qo,deepExtend:Po}),t}(),Ha=(Ga.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(function(e){e=e.getComponent();return"VERSION"===(null==e?void 0:e.type)}(e)){e=e.getImmediate();return e.library+"/"+e.version}return null}).filter(function(e){return e}).join(" ")},Ga);function Ga(e){this.container=e}"object"==typeof self&&self.self===self&&void 0!==self.firebase&&(Va.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  "),(gu=self.firebase.SDK_VERSION)&&0<=gu.indexOf("LITE")&&Va.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    "));var Qa=de.initializeApp;de.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return}}()&&Va.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Qa.apply(void 0,e)};var Ya,Xa,Jh=de;(Ya=Jh).INTERNAL.registerComponent(new _a("platform-logger",function(e){return new Ha(e)},"PRIVATE")),Ya.registerVersion(Ua,"0.6.13-1.0.0-eap-firestore-debug.9c6096f43",Xa),Ya.registerVersion("fire-js","");Jh.registerVersion("firebase","8.1.1-1.0.0-eap-firestore-debug.9c6096f43","app");(function(){var e,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};var u=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}return globalThis}(this);function c(e){var t,n,r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return r?r.call(e):{next:(t=e,n=0,function(){return n<t.length?{done:!1,value:t[n++]}:{done:!0}})}}!function(e,t){if(t){var n=u;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];i in n||(n[i]={}),n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&o(n,e,{configurable:!0,writable:!0,value:t})}}("Promise",function(e){function a(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.a=null}function s(t){return t instanceof a?t:new a(function(e){e(t)})}if(e)return e;t.prototype.b=function(e){var t;null==this.a&&(this.a=[],(t=this).c(function(){t.g()})),this.a.push(e)};var n=u.setTimeout;t.prototype.c=function(e){n(e,0)},t.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.f(e)}}}this.a=null},t.prototype.f=function(e){this.c(function(){throw e})},a.prototype.f=function(){function e(t){return function(e){r||(r=!0,t.call(n,e))}}var n=this,r=!1;return{resolve:e(this.v),reject:e(this.g)}},a.prototype.v=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof a)this.s(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.m(e):this.h(e)}},a.prototype.m=function(e){var t=void 0;try{t=e.then}catch(e){return void this.g(e)}"function"==typeof t?this.u(t,e):this.h(e)},a.prototype.g=function(e){this.i(2,e)},a.prototype.h=function(e){this.i(1,e)},a.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},a.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)i.b(this.a[e]);this.a=null}};var i=new t;return a.prototype.s=function(e){var t=this.f();e.Pa(t.resolve,t.reject)},a.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},a.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(e){i(e)}}:e}var r,i,o=new a(function(e,t){r=e,i=t});return this.Pa(n(e,r),n(t,i)),o},a.prototype.catch=function(e){return this.then(void 0,e)},a.prototype.Pa=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?i.b(n):this.a.push(n)},a.resolve=s,a.reject=function(n){return new a(function(e,t){t(n)})},a.race=function(i){return new a(function(e,t){for(var n=c(i),r=n.next();!r.done;r=n.next())s(r.value).Pa(e,t)})},a.all=function(e){var t=c(e),o=t.next();return o.done?s([]):new a(function(n,e){for(var r=[],i=0;r.push(void 0),i++,s(o.value).Pa(function(t){return function(e){r[t]=e,0==--i&&n(r)}}(r.length-1),e),!(o=t.next()).done;);})},a});var l=l||{},h=this||self,t=/^[\w+/_-]+[=]{0,2}$/,s=null;function f(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&t.test(e)?e:""}function a(){}function p(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function d(e){var t=p(e);return"array"==t||"object"==t&&"number"==typeof e.length}function g(e){return"function"==p(e)}function y(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var n="closure_uid_"+(1e9*Math.random()>>>0),r=0;function i(e,t,n){return e.call.apply(e.bind,arguments)}function m(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function v(e,t,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:m).apply(null,arguments)}function b(t){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now;function w(e,t){function n(){}n.prototype=t.prototype,e.$a=t.prototype,e.prototype=new n,e.prototype.constructor=e}function E(e){return e}function T(e,t,n){this.code=C+e,this.message=t||k[e]||"",this.a=n||null}function I(e){var t=e&&e.code;return t?new T(t.substring(C.length),e.message,e.serverResponse):null}w(T,Error),T.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},T.prototype.toJSON=function(){return this.w()};var S,C="auth/",k={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},A={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function N(e){for(var t in A)if(A[t].id===e)return e=A[t],{firebaseEndpoint:e.Sa,secureTokenEndpoint:e.Ya,identityPlatformEndpoint:e.Va};return null}function D(e){if(e)try{return e.$goog_Thenable}catch(e){return}}function R(e){var t;Error.captureStackTrace?Error.captureStackTrace(this,R):(t=Error().stack)&&(this.stack=t),e&&(this.message=String(e))}function O(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");R.call(this,n+e[r])}function P(e){throw new O("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function x(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function L(e,t){e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}function M(){this.b=this.a=null}S=N("__EID__")?"__EID__":void 0,w(R,Error),R.prototype.name="CustomError",w(O,R),O.prototype.name="AssertionError",x.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e};var F=new x(function(){return new U},function(e){e.reset()});function U(){this.next=this.b=this.a=null}M.prototype.add=function(e,t){var n=F.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},j=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};var V=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n,r=e.length,i=[],o=0,a="string"==typeof e?e.split(""):e,s=0;s<r;s++){s in a&&(n=a[s],t.call(void 0,n,s,e)&&(i[o++]=n))}return i},B=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},K=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function W(e,t){return 0<=q(e,t)}function z(e,t){var n;return(n=0<=(t=q(e,t)))&&Array.prototype.splice.call(e,t,1),n}function H(n,r){!function(e,t){for(var n="string"==typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(n,function(e,t){r.call(void 0,e,t,n)&&1==Array.prototype.splice.call(n,t,1).length&&0})}function G(){return Array.prototype.concat.apply([],arguments)}function Q(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var Y,X=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},J=/&/g,$=/</g,Z=/>/g,ee=/"/g,te=/'/g,ne=/\x00/g,re=/[\x00&<>"']/;function ie(e,t){return-1!=e.indexOf(t)}function oe(e,t){return e<t?-1:t<e?1:0}e:{var ae=h.navigator;if(ae){ae=ae.userAgent;if(ae){Y=ae;break e}}Y=""}function se(e){return ie(Y,e)}function ue(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function ce(e){for(var t in e)return;return 1}function le(e){var t,n={};for(t in e)n[t]=e[t];return n}var he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(e){for(var t,n,r=1;r<arguments.length;r++){for(t in n=arguments[r])e[t]=n[t];for(var i=0;i<he.length;i++)t=he[i],Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}}function pe(e,t){e:{try{var n=e&&e.ownerDocument,n=n&&(n.defaultView||n.parentWindow);if((n=n||h).Element&&n.Location){var r=n;break e}}catch(e){}r=null}if(r&&void 0!==r[t]&&(!e||!(e instanceof r[t])&&(e instanceof r.Location||e instanceof r.Element))){if(y(e))try{var i=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(e){i="<object could not be stringified>"}else i=void 0===e?"undefined":null===e?"null":typeof e;P("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,i)}}function de(e,t){this.a=e===ve&&t||"",this.b=me}function ge(e){return e instanceof de&&e.constructor===de&&e.b===me?e.a:(P("expected object of type Const, got '"+e+"'"),"type_error:Const")}de.prototype.sa=!0,de.prototype.ra=function(){return this.a},de.prototype.toString=function(){return"Const{"+this.a+"}"};var ye,me={},ve={};function be(){if(void 0===ye){var e=null,t=h.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:E,createScript:E,createScriptURL:E})}catch(e){h.console&&h.console.error(e.message)}ye=e}else ye=e}return ye}function _e(e,t){this.a=t===Se?e:""}function we(e){return e instanceof _e&&e.constructor===_e?e.a:(P("expected object of type TrustedResourceUrl, got '"+e+"' of type "+p(e)),"type_error:TrustedResourceUrl")}function Ee(e,n){var t,r=ge(e);if(!Ie.test(r))throw Error("Invalid TrustedResourceUrl format: "+r);return e=r.replace(Te,function(e,t){if(!Object.prototype.hasOwnProperty.call(n,t))throw Error('Found marker, "'+t+'", in format string, "'+r+'", but no valid label mapping found in args: '+JSON.stringify(n));return(e=n[t])instanceof de?ge(e):encodeURIComponent(String(e))}),t=e,e=be(),new _e(t=e?e.createScriptURL(t):t,Se)}_e.prototype.sa=!0,_e.prototype.ra=function(){return this.a.toString()},_e.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Te=/%{(\w+)}/g,Ie=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Se={};function Ce(e,t){this.a=t===Pe?e:""}function ke(e){return e instanceof Ce&&e.constructor===Ce?e.a:(P("expected object of type SafeUrl, got '"+e+"' of type "+p(e)),"type_error:SafeUrl")}Ce.prototype.sa=!0,Ce.prototype.ra=function(){return this.a.toString()},Ce.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ae=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Ne=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,De=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Re(e){return e instanceof Ce?e:(e="object"==typeof e&&e.sa?e.ra():String(e),e=De.test(e)||(t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(Ne))&&Ae.test(t[1])?new Ce(e,Pe):null);var t}function Oe(e){return e instanceof Ce?e:(e="object"==typeof e&&e.sa?e.ra():String(e),De.test(e)||(e="about:invalid#zClosurez"),new Ce(e,Pe))}var Pe={},xe=new Ce("about:invalid#zClosurez",Pe);function Le(e,t,n){this.a=n===Me?e:""}Le.prototype.sa=!0,Le.prototype.ra=function(){return this.a.toString()},Le.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Me={};function Fe(e,t,n,r){return e=e instanceof Ce?e:Oe(e),t=t||h,n=n instanceof de?ge(n):n||"",t.open(ke(e),n,r,void 0)}function Ue(e){for(var t=e.split("%s"),n="",r=Array.prototype.slice.call(arguments,1);r.length&&1<t.length;)n+=t.shift()+r.shift();return n+t.join("%s")}function qe(e){return re.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(J,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace($,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(Z,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(ee,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(te,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(ne,"&#0;"))),e}function je(e){return je[" "](e),e}je[" "]=a;var Ve,Be=se("Opera"),Ke=se("Trident")||se("MSIE"),We=se("Edge"),ze=We||Ke,He=se("Gecko")&&!(ie(Y.toLowerCase(),"webkit")&&!se("Edge"))&&!(se("Trident")||se("MSIE"))&&!se("Edge"),Ge=ie(Y.toLowerCase(),"webkit")&&!se("Edge");function Qe(){var e=h.document;return e?e.documentMode:void 0}e:{var Ye="",Xe=(Xe=Y,He?/rv:([^\);]+)(\)|;)/.exec(Xe):We?/Edge\/([\d\.]+)/.exec(Xe):Ke?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Xe):Ge?/WebKit\/(\S+)/.exec(Xe):Be?/(?:Version)[ \/]?(\S+)/.exec(Xe):void 0);if(Xe&&(Ye=Xe?Xe[1]:""),Ke){Xe=Qe();if(null!=Xe&&Xe>parseFloat(Ye)){Ve=String(Xe);break e}}Ve=Ye}var Je={};function $e(s){return e=s,t=function(){for(var e=0,t=X(String(Ve)).split("."),n=X(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=oe(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||oe(0==o[2].length,0==a[2].length)||oe(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e},n=Je,Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e);var e,t,n}var Ze=h.document&&Ke?Qe()||(parseInt(Ve,10)||void 0):void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(e){}var et=!Ke||9<=Number(Ze);function tt(e){var t=document;return"string"==typeof e?t.getElementById(e):e}function nt(n,e){ue(e,function(e,t){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==t?n.style.cssText=e:"class"==t?n.className=e:"for"==t?n.htmlFor=e:ot.hasOwnProperty(t)?n.setAttribute(ot[t],e):0==t.lastIndexOf("aria-",0)||0==t.lastIndexOf("data-",0)?n.setAttribute(t,e):n[t]=e})}var rt,it,ot={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function at(){var e,t=arguments,n=document,r=String(t[0]),i=t[1];return!et&&i&&(i.name||i.type)&&(r=["<",r],i.name&&r.push(' name="',qe(i.name),'"'),i.type&&(r.push(' type="',qe(i.type),'"'),fe(e={},i),delete e.type,i=e),r.push(">"),r=r.join("")),r=st(n,r),i&&("string"==typeof i?r.className=i:Array.isArray(i)?r.className=i.join(" "):nt(r,i)),2<t.length&&function(t,n,e){function r(e){e&&n.appendChild("string"==typeof e?t.createTextNode(e):e)}for(var i=2;i<e.length;i++){var o=e[i];if(!d(o)||y(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(y(o)){var a="function"==typeof o.item||"string"==typeof o.item;break e}if(g(o)){a="function"==typeof o.item;break e}}a=!1}j(a?Q(o):o,r)}}}(n,r,t),r}function st(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function ut(e){h.setTimeout(function(){throw e},0)}function ct(e,t){it||function(){{var e;it=h.Promise&&h.Promise.resolve?(e=h.Promise.resolve(void 0),function(){e.then(ft)}):function(){var e=ft;!g(h.setImmediate)||h.Window&&h.Window.prototype&&!se("Edge")&&h.Window.prototype.setImmediate==h.setImmediate?(rt=rt||function(){var e=h.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!se("Presto")&&(e=function(){var e=st(document,"IFRAME");e.style.display="none",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=v(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0===e||se("Trident")||se("MSIE"))return function(e){h.setTimeout(e,0)};var t=new e,n={},r=n;return t.port1.onmessage=function(){var e;void 0!==n.next&&(e=(n=n.next).Fb,n.Fb=null,e())},function(e){r.next={Fb:e},r=r.next,t.port2.postMessage(0)}}())(e):h.setImmediate(e)}}}(),lt||(it(),lt=!0),ht.add(e,t)}var lt=!1,ht=new M;function ft(){for(var e,t,n;n=t=void 0,n=null,(t=ht).a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),e=n;){try{e.a.call(e.b)}catch(e){ut(e)}L(F,e)}lt=!1}function pt(e,t){if(this.a=dt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=a)try{var n=this;e.call(t,function(e){Ct(n,gt,e)},function(e){if(!(e instanceof Pt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}Ct(n,yt,e)})}catch(e){Ct(this,yt,e)}}var dt=0,gt=2,yt=3;function mt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}mt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var vt=new x(function(){return new mt},function(e){e.reset()});function bt(e,t,n){var r=vt.get();return r.g=e,r.b=t,r.f=n,r}function _t(e){if(e instanceof pt)return e;var t=new pt(a);return Ct(t,gt,e),t}function wt(n){return new pt(function(e,t){t(n)})}function Et(e,t,n){kt(e,t,n,null)||ct(b(t,e))}function Tt(n){return new pt(function(r){var i=n.length,o=[];if(i)for(var e=function(e,t,n){i--,o[e]=t?{Ob:!0,value:n}:{Ob:!1,reason:n},0==i&&r(o)},t=0;t<n.length;t++)Et(n[t],b(e,t,!0),b(e,t,!1));else r(o)})}function It(e,t){e.b||e.a!=gt&&e.a!=yt||At(e),e.f?e.f.next=t:e.b=t,e.f=t}function St(e,i,o,a){var t=bt(null,null,null);return t.a=new pt(function(n,r){t.g=i?function(e){try{var t=i.call(a,e);n(t)}catch(e){r(e)}}:n,t.b=o?function(e){try{var t=o.call(a,e);void 0===t&&e instanceof Pt?r(e):n(t)}catch(e){r(e)}}:r}),It(t.a.c=e,t),t.a}function Ct(e,t,n){var r,i;e.a==dt&&(e===n&&(t=yt,n=new TypeError("Promise cannot resolve to itself")),e.a=1,kt(n,e.Zc,e.$c,e)||(e.i=n,e.a=t,e.c=null,At(e),t!=yt||n instanceof Pt||(i=n,(r=e).g=!0,ct(function(){r.g&&Ot.call(null,i)}))))}function kt(e,t,n,r){if(e instanceof pt)return It(e,bt(t||a,n||null,r)),1;if(D(e))return e.then(t,n,r),1;if(y(e))try{var i=e.then;if(g(i))return function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,function(e){a||(a=!0,n.call(i,e))},o)}catch(e){o(e)}}(e,i,t,n,r),1}catch(e){return n.call(r,e),1}}function At(e){e.h||(e.h=!0,ct(e.fc,e))}function Nt(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function Dt(e,t,n,r){if(n==yt&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,Rt(t,n,r);else try{t.c?t.g.call(t.f):Rt(t,n,r)}catch(e){Ot.call(null,e)}L(vt,t)}function Rt(e,t,n){t==gt?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}pt.prototype.then=function(e,t,n){return St(this,g(e)?e:null,g(t)?t:null,n)},pt.prototype.$goog_Thenable=!0,(e=pt.prototype).na=function(e,t){return(e=bt(e,e,t)).c=!0,It(this,e),this},e.o=function(e,t){return St(this,null,e,t)},e.cancel=function(e){var t;this.a==dt&&(t=new Pt(e),ct(function(){!function e(t,n){if(t.a==dt)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==t&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==dt&&1==i?e(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Nt(r),Dt(r,o,yt,n)))}t.c=null}else Ct(t,yt,n)}(this,t)},this))},e.Zc=function(e){this.a=dt,Ct(this,gt,e)},e.$c=function(e){this.a=dt,Ct(this,yt,e)},e.fc=function(){for(var e;e=Nt(this);)Dt(this,e,this.a,this.i);this.h=!1};var Ot=ut;function Pt(e){R.call(this,e)}function xt(){this.xa=this.xa,this.oa=this.oa}w(Pt,R);var Lt=0;function Mt(e){e.xa||(e.xa=!0,e.Da(),0==Lt)||(e=e,Object.prototype.hasOwnProperty.call(e,n)&&e[n]||(e[n]=++r))}xt.prototype.xa=!(Pt.prototype.name="cancel"),xt.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var Ft=Object.freeze||function(e){return e},Ut=!Ke||9<=Number(Ze),qt=Ke&&!$e("9"),jt=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{h.addEventListener("test",a,t),h.removeEventListener("test",a,t)}catch(e){}return e}();function Vt(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function Bt(e,t){if(Vt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(He){e:{try{je(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Kt[e.pointerType]||"",(this.a=e).defaultPrevented&&this.preventDefault()}}Vt.prototype.preventDefault=function(){this.defaultPrevented=!0},w(Bt,Vt);var Kt=Ft({2:"touch",3:"pen",4:"mouse"});Bt.prototype.preventDefault=function(){Bt.$a.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,qt)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}},Bt.prototype.g=function(){return this.a};var Wt="closure_listenable_"+(1e6*Math.random()|0),zt=0;function Ht(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Ua=i,this.key=++zt,this.va=this.Oa=!1}function Gt(e){e.va=!0,e.listener=null,e.proxy=null,e.src=null,e.Ua=null}function Qt(e){this.src=e,this.a={},this.b=0}function Yt(e,t){var n=t.type;n in e.a&&z(e.a[n],t)&&(Gt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function Xt(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.va&&o.listener==t&&o.capture==!!n&&o.Ua==r)return i}return-1}Qt.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Xt(e,t,r,i);return-1<a?(t=e[a],n||(t.Oa=!1)):((t=new Ht(t,this.src,o,!!r,i)).Oa=n,e.push(t)),t};var Jt="closure_lm_"+(1e6*Math.random()|0),$t={};function Zt(e,t,n,r,i){if(r&&r.once)tn(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)Zt(e,t[o],n,r,i);else n=hn(n),e&&e[Wt]?pn(e,t,n,y(r)?!!r.capture:!!r,i):en(e,t,n,!1,r,i)}function en(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a,s,u=y(i)?!!i.capture:!!i,c=cn(e);if(c||(e[Jt]=c=new Qt(e)),!(n=c.add(t,n,r,u,o)).proxy)if(a=un,r=s=Ut?function(e){return a.call(s.src,s.listener,e)}:function(e){if(!(e=a.call(s.src,s.listener,e)))return e},(n.proxy=r).src=e,r.listener=n,e.addEventListener)jt||(i=u),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(on(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function tn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)tn(e,t[o],n,r,i);else n=hn(n),e&&e[Wt]?dn(e,t,n,y(r)?!!r.capture:!!r,i):en(e,t,n,!0,r,i)}function nn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)nn(e,t[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=hn(n),e&&e[Wt]?(e=e.v,(t=String(t).toString())in e.a&&(-1<(n=Xt(o=e.a[t],n,r,i))&&(Gt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):(e=e&&cn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Xt(t,n,r,i)),(n=-1<e?t[e]:null)&&rn(n))}function rn(e){var t,n,r;"number"!=typeof e&&e&&!e.va&&((t=e.src)&&t[Wt]?Yt(t.v,e):(n=e.type,r=e.proxy,t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(on(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=cn(t))?(Yt(n,e),0==n.b&&(n.src=null,t[Jt]=null)):Gt(e)))}function on(e){return e in $t?$t[e]:$t[e]="on"+e}function an(e,t,n,r){var i=!0;if((e=cn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.va&&(o=sn(o,r),i=i&&!1!==o)}return i}function sn(e,t){var n=e.listener,r=e.Ua||e.src;return e.Oa&&rn(e),n.call(r,t)}function un(e,t){if(e.va)return!0;if(Ut)return sn(e,new Bt(t,this));if(!t)e:{t=["window","event"];for(var n=h,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Bt(r=t,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}!i&&null!=r.returnValue||(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=an(r[i],e,!0,t),n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=an(r[i],e,!1,t),n=n&&o}return n}function cn(e){return(e=e[Jt])instanceof Qt?e:null}var ln="__closure_events_fn_"+(1e9*Math.random()>>>0);function hn(t){return g(t)?t:(t[ln]||(t[ln]=function(e){return t.handleEvent(e)}),t[ln])}function fn(){xt.call(this),this.v=new Qt(this),(this.$b=this).fb=null}function pn(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function dn(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function gn(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a,s,u=t[o];u&&!u.va&&u.capture==n&&(a=u.listener,s=u.Ua||u.src,u.Oa&&Yt(e.v,u),i=!1!==a.call(s,r)&&i)}return i&&!r.defaultPrevented}function yn(e,t,n){if(g(e))n&&(e=v(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=v(e.handleEvent,e)}return 2147483647<Number(t)?-1:h.setTimeout(e,t||0)}function mn(n){var r=null;return new pt(function(e,t){-1==(r=yn(function(){e(void 0)},n))&&t(Error("Failed to schedule timer."))}).o(function(e){throw h.clearTimeout(r),e})}function vn(e){if(e.V&&"function"==typeof e.V)return e.V();if("string"==typeof e)return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function bn(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.V||"function"!=typeof e.V){if(d(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function _n(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof _n)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function wn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];En(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){for(var i={},n=t=0;t<e.a.length;)En(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function En(e,t){return Object.prototype.hasOwnProperty.call(e,t)}w(fn,xt),fn.prototype[Wt]=!0,fn.prototype.addEventListener=function(e,t,n,r){Zt(this,e,t,n,r)},fn.prototype.removeEventListener=function(e,t,n,r){nn(this,e,t,n,r)},fn.prototype.dispatchEvent=function(e){var t,n=this.fb;if(n)for(t=[];n;n=n.fb)t.push(n);n=this.$b;var r=e.type||e;if("string"==typeof e?e=new Vt(e,n):e instanceof Vt?e.target=e.target||n:(a=e,fe(e=new Vt(r,n),a)),a=!0,t)for(var i=t.length-1;0<=i;i--)var o=e.b=t[i],a=gn(o,r,!0,e)&&a;if(a=gn(o=e.b=n,r,!0,e)&&a,a=gn(o,r,!1,e)&&a,t)for(i=0;i<t.length;i++)a=gn(o=e.b=t[i],r,!1,e)&&a;return a},fn.prototype.Da=function(){if(fn.$a.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Gt(n[r]);delete t.a[e],t.b--}}this.fb=null},(e=_n.prototype).V=function(){wn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.Y=function(){return wn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return En(this.b,e)?this.b[e]:t},e.set=function(e,t){En(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Tn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function In(e,t){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,e instanceof In?(this.i=void 0!==t?t:e.i,Sn(this,e.f),this.l=e.l,this.a=e.a,Cn(this,e.g),this.c=e.c,kn(this,Hn(e.b)),this.h=e.h):e&&(n=String(e).match(Tn))?(this.i=!!t,Sn(this,n[1]||"",!0),this.l=On(n[2]||""),this.a=On(n[3]||"",!0),Cn(this,n[4]),this.c=On(n[5]||"",!0),kn(this,n[6]||"",!0),this.h=On(n[7]||"")):(this.i=!!t,this.b=new jn(null,this.i))}function Sn(e,t,n){e.f=n?On(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Cn(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.g=t}else e.g=null}function kn(e,t,n){var r,i;t instanceof jn?(e.b=t,r=e.b,(i=e.i)&&!r.f&&(Vn(r),r.c=null,r.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Kn(this,t),zn(this,n,e))},r)),r.f=i):(n||(t=Pn(t,Un)),e.b=new jn(t,e.i))}function An(e,t,n){e.b.set(t,n)}function Nn(e,t){return e.b.get(t)}function Dn(e){return e instanceof In?new In(e):new In(e,void 0)}function Rn(e,t,n,r){var i=new In(null,void 0);return e&&Sn(i,e),t&&(i.a=t),n&&Cn(i,n),r&&(i.c=r),i}function On(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Pn(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,xn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function xn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}In.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Pn(t,Ln,!0),":");var n=this.a;return!n&&"file"!=t||(e.push("//"),(t=this.l)&&e.push(Pn(t,Ln,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(Pn(n,"/"==n.charAt(0)?Fn:Mn,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",Pn(n,qn)),e.join("")},In.prototype.resolve=function(e){var t=new In(this),n=!!e.f;n?Sn(t,e.f):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r,i=e.c;if(n)Cn(t,e.g);else if(n=!!e.c){if("/"!=i.charAt(0)&&(this.a&&!this.c?i="/"+i:-1!=(r=t.c.lastIndexOf("/"))&&(i=t.c.substr(0,r+1)+i)),".."==(r=i)||"."==r)i="";else if(ie(r,"./")||ie(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?t.c=i:n=""!==e.b.toString(),n?kn(t,Hn(e.b)):n=!!e.h,n&&(t.h=e.h),t};var Ln=/[#\/\?@]/g,Mn=/[#\?:]/g,Fn=/[#\?]/g,Un=/[#\?@]/g,qn=/#/g;function jn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Vn(n){n.a||(n.a=new _n,n.b=0,n.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r,i=e[n].indexOf("="),o=null;0<=i?(r=e[n].substring(0,i),o=e[n].substring(i+1)):r=e[n],t(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Bn(e){var t=bn(e);if(void 0===t)throw Error("Keys are undefined");var n=new jn(null,void 0);e=vn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?zn(n,i,o):n.add(i,o)}return n}function Kn(e,t){Vn(e),t=Gn(e,t),En(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,En((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&wn(e)))}function Wn(e,t){return Vn(e),t=Gn(e,t),En(e.a.b,t)}function zn(e,t,n){Kn(e,t),0<n.length&&(e.c=null,e.a.set(Gn(e,t),Q(n)),e.b+=n.length)}function Hn(e){var t=new jn;return t.c=e.c,e.a&&(t.a=new _n(e.a),t.b=e.b),t}function Gn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function Qn(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),e(t,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&(a=n[i],"function"!=typeof a&&(r.push(o),$n(i,r),r.push(":"),e(t,a,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":$n(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Yn,e,t),t.join("")}function Yn(){}(e=jn.prototype).add=function(e,t){Vn(this),this.c=null,e=Gn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(n,r){Vn(this),this.a.forEach(function(e,t){j(e,function(e){n.call(r,e,t,this)},this)},this)},e.Y=function(){Vn(this);for(var e=this.a.V(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.V=function(e){Vn(this);var t=[];if("string"==typeof e)Wn(this,e)&&(t=G(t,this.a.get(Gn(this,e))));else{e=this.a.V();for(var n=0;n<e.length;n++)t=G(t,e[n])}return t},e.set=function(e,t){return Vn(this),this.c=null,Wn(this,e=Gn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.V(r),o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}return this.c=e.join("&")};var Xn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Jn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function $n(e,t){t.push('"',e.replace(Jn,function(e){var t=Xn[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Xn[e]=t),t}),'"')}function Zn(){var e=vr();return Ke&&Ze&&11==Ze||/Edge\/\d+/.test(e)}function er(){return h.window&&h.window.location.href||self&&self.location&&self.location.href||""}function tr(e,t){t=t||h.window;var n="about:blank";e&&(n=ke(Re(e)||xe)),t.location.href=n}function nr(e){return!!((e=(e||vr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function rr(e){e=e||h.window;try{e.close()}catch(e){}}function ir(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=vr().toLowerCase(),r&&(t.target=r,ie(n,"crios/")&&(t.target="_blank")),gr(vr())==pr&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Ce?n:Re(void 0!==n.href?n.href:String(n))||xe,n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((se("iPhone")&&!se("iPod")&&!se("iPad")||se("iPad")||se("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(pe(a=st(document,"A"),"HTMLAnchorElement"),t=t instanceof Ce?t:Oe(t),a.href=ke(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=Fe("",r,n,a),e=ke(t),a&&(ze&&ie(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+qe(e)+'">',e=new Le(e=(r=be())?r.createHTML(e):e,0,Me),r=a.document)&&(r.write((o=e)instanceof Le&&o.constructor===Le?o.a:(P("expected object of type SafeHtml, got '"+o+"' of type "+p(o)),"type_error:SafeHtml")),r.close())):(a=Fe(t,r,n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(e){}return a}var or=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ar=/^[^@]+@[^@]+$/;function sr(){var t=null;return new pt(function(e){"complete"==h.document.readyState?e():(t=function(){e()},tn(window,"load",t))}).o(function(e){throw nn(window,"load",t),e})}function ur(e){return e=e||vr(),!("file:"!==Tr()&&"ionic:"!==Tr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function cr(){var e=h.window;try{return e&&e!=e.top}catch(e){return}}function lr(){return void 0!==h.WorkerGlobalScope&&"function"==typeof h.importScripts}function hr(){return Jh.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Jh.INTERNAL.hasOwnProperty("node")?"Node":lr()?"Worker":"Browser"}function fr(){var e=hr();return"ReactNative"===e||"Node"===e}var pr="Firefox",dr="Chrome";function gr(e){var t=e.toLowerCase();return ie(t,"opera/")||ie(t,"opr/")||ie(t,"opios/")?"Opera":ie(t,"iemobile")?"IEMobile":ie(t,"msie")||ie(t,"trident/")?"IE":ie(t,"edge/")?"Edge":ie(t,"firefox/")?pr:ie(t,"silk/")?"Silk":ie(t,"blackberry")?"Blackberry":ie(t,"webos")?"Webos":!ie(t,"safari/")||ie(t,"chrome/")||ie(t,"crios/")||ie(t,"android")?!ie(t,"chrome/")&&!ie(t,"crios/")||ie(t,"edge/")?ie(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":dr:"Safari"}var yr={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function mr(e,t){t=t||[];var n,r=[],i={};for(n in yr)i[yr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=hr())?r=gr(i=vr()):"Worker"===r&&(r=gr(i=vr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function vr(){return h.navigator&&h.navigator.userAgent||""}function br(e,t){e=e.split("."),t=t||h;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function _r(){try{var e=h.localStorage,t=Ar();if(e)return e.setItem(t,"1"),e.removeItem(t),!Zn()||!!h.indexedDB}catch(e){return lr()&&!!h.indexedDB}return!1}function wr(){return(Er()||"chrome-extension:"===Tr()||ur())&&!fr()&&_r()&&!lr()}function Er(){return"http:"===Tr()||"https:"===Tr()}function Tr(){return h.location&&h.location.protocol||null}function Ir(e){return!nr(e=e||vr())&&gr(e)!=pr}function Sr(e){return void 0===e?null:Qn(e)}function Cr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function kr(e){if(null!==e)return JSON.parse(e)}function Ar(e){return e||Math.floor(1e9*Math.random()).toString()}function Nr(e){return"Safari"!=gr(e=e||vr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Dr(){var e=h.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Rr(e,t){if(t<e)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=vr(),t=hr(),this.b=nr(e)||"ReactNative"===t}function Or(){var e=h.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function Pr(e){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e)}function xr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function Lr(){return br("fireauth.oauthhelper",h)||br("fireauth.iframe",h)}Rr.prototype.get=function(){var e=h.navigator;return!e||"boolean"!=typeof e.onLine||!Er()&&"chrome-extension:"!==Tr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Mr,Fr={};function Ur(e){Fr[e]||(Fr[e]=!0,Pr(e))}try{var qr={};Object.defineProperty(qr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(qr,"abcd",{configurable:!0,enumerable:!0,value:2}),Mr=2==qr.abcd}catch(e){Mr=!1}function jr(e,t,n){Mr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Vr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&jr(e,n,t[n])}function Br(e){var t={};return Vr(t,e),t}function Kr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)jr(t,n,Kr(e[n]));return t}function Wr(e){var t=e&&(e[Yr]?"phone":null);if(!(t&&e&&e[Qr]))throw new T("internal-error","Internal assert: invalid MultiFactorInfo object");jr(this,"uid",e[Qr]),jr(this,"displayName",e[Hr]||null);var n=null;e[Gr]&&(n=new Date(e[Gr]).toUTCString()),jr(this,"enrollmentTime",n),jr(this,"factorId",t)}function zr(e){try{var t=new Xr(e)}catch(e){t=null}return t}Wr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Hr="displayName",Gr="enrolledAt",Qr="mfaEnrollmentId",Yr="phoneInfo";function Xr(e){Wr.call(this,e),jr(this,"phoneNumber",e[Yr])}function Jr(e){var t={},n=e[ti],r=e[ri],i=e[ii];if(e=zr(e[ni]),!i||i!=Zr&&i!=ei&&!n||i==ei&&!r||i==$r&&!e)throw Error("Invalid checkActionCode response!");i==ei?(t[ai]=n||null,t[ui]=n||null,t[oi]=r):(t[ai]=r||null,t[ui]=r||null,t[oi]=n||null),t[si]=e||null,jr(this,li,i),jr(this,ci,Kr(t))}w(Xr,Wr),Xr.prototype.w=function(){var e=Xr.$a.w.call(this);return e.phoneNumber=this.phoneNumber,e};var $r="REVERT_SECOND_FACTOR_ADDITION",Zr="EMAIL_SIGNIN",ei="VERIFY_AND_CHANGE_EMAIL",ti="email",ni="mfaInfo",ri="newEmail",ii="requestType",oi="email",ai="fromEmail",si="multiFactorInfo",ui="previousEmail",ci="data",li="operation";function hi(e){var t=Nn(e=Dn(e),fi)||null,n=Nn(e,pi)||null,r=(r=Nn(e,yi)||null)&&vi[r]||null;if(!t||!n||!r)throw new T("argument-error",fi+", "+pi+"and "+yi+" are required in a valid action code URL.");Vr(this,{apiKey:t,operation:r,code:n,continueUrl:Nn(e,di)||null,languageCode:Nn(e,gi)||null,tenantId:Nn(e,mi)||null})}var fi="apiKey",pi="oobCode",di="continueUrl",gi="languageCode",yi="mode",mi="tenantId",vi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:$r,signIn:Zr,verifyAndChangeEmail:ei,verifyEmail:"VERIFY_EMAIL"};function bi(e){try{return new hi(e)}catch(e){return null}}function _i(e){var t=e[Si];if(void 0===t)throw new T("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new T("invalid-continue-uri");if(this.h=t,this.b=this.a=null,this.g=!1,(r=e[wi])&&"object"==typeof r){t=r[Ai];var n=r[Ci],r=r[ki];if("string"==typeof t&&t.length){if(this.a=t,void 0!==n&&"boolean"!=typeof n)throw new T("argument-error",Ci+" property must be a boolean when specified.");if(this.g=!!n,void 0!==r&&("string"!=typeof r||"string"==typeof r&&!r.length))throw new T("argument-error",ki+" property must be a non empty string when specified.");this.b=r||null}else{if(void 0!==t)throw new T("argument-error",Ai+" property must be a non empty string when specified.");if(void 0!==n||void 0!==r)throw new T("missing-android-pkg-name")}}else if(void 0!==r)throw new T("argument-error",wi+" property must be a non null object when specified.");if(this.f=null,(t=e[Ii])&&"object"==typeof t){if("string"==typeof(t=t[Ni])&&t.length)this.f=t;else if(void 0!==t)throw new T("argument-error",Ni+" property must be a non empty string when specified.")}else if(void 0!==t)throw new T("argument-error",Ii+" property must be a non null object when specified.");if(void 0!==(t=e[Ti])&&"boolean"!=typeof t)throw new T("argument-error",Ti+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[Ei])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new T("argument-error",Ei+" property must be a non empty string when specified.");this.i=e||null}var wi="android",Ei="dynamicLinkDomain",Ti="handleCodeInApp",Ii="iOS",Si="url",Ci="installApp",ki="minimumVersion",Ai="packageName",Ni="bundleId";function Di(e){var t,n={};for(t in n.continueUrl=e.h,n.canHandleCodeInApp=e.c,(n.androidPackageName=e.a)&&(n.androidMinimumVersion=e.b,n.androidInstallApp=e.g),n.iOSBundleId=e.f,n.dynamicLinkDomain=e.i,n)null===n[t]&&delete n[t];return n}var Ri=null;function Oi(e){var t="";return function(r,e){function t(e){for(;i<r.length;){var t=r.charAt(i++),n=Ri[t];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(t))throw Error("Unknown base64 encoding at char: "+t)}return e}!function(){if(!Ri){Ri={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;n<5;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ri[o]&&(Ri[o]=i)}}}();for(var i=0;;){var n=t(-1),o=t(0),a=t(64),s=t(64);if(64===s&&-1===n)break;e(n<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(e,function(e){t+=String.fromCharCode(e)}),t}function Pi(e){var t=Li(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.g=e,this.c=t.exp,this.h=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function xi(e){try{return new Pi(e)}catch(e){return null}}function Li(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse(Oi(e))}catch(e){}return null}Pi.prototype.S=function(){return this.f},Pi.prototype.i=function(){return this.b},Pi.prototype.toString=function(){return this.g};var Mi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Fi=["client_id","response_type","scope","redirect_uri","state"],Ui={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:Fi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:Fi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:Fi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:Mi},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function qi(e){for(var t in Ui)if(Ui[t].fa==e)return Ui[t];return null}function ji(e){var t={};t["facebook.com"]=zi,t["google.com"]=Gi,t["github.com"]=Hi,t["twitter.com"]=Qi;var n=e&&e[Bi];try{if(n)return new(t[n]?t[n]:Wi)(e);if(void 0!==e[Vi])return new Ki(e)}catch(e){}return null}var Vi="idToken",Bi="providerId";function Ki(e){var t,n=e[Bi];if(n||!e[Vi]||(t=xi(e[Vi]))&&t.a&&(n=t.a),!n)throw Error("Invalid additional user info!");"anonymous"!=n&&"custom"!=n||(n=null),t=!1,void 0!==e.isNewUser?t=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(t=!0),jr(this,"providerId",n),jr(this,"isNewUser",t)}function Wi(e){Ki.call(this,e),jr(this,"profile",Kr((e=kr(e.rawUserInfo||"{}"))||{}))}function zi(e){if(Wi.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Hi(e){if(Wi.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");jr(this,"username",this.profile&&this.profile.login||null)}function Gi(e){if(Wi.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qi(e){if(Wi.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");jr(this,"username",e.screenName||null)}function Yi(e){var t=Nn(r=Dn(e),"link"),n=Nn(Dn(t),"link"),r=Nn(r,"deep_link_id");return Nn(Dn(r),"link")||r||n||t||e}function Xi(e,t){if(!e&&!t)throw new T("internal-error","Internal assert: no raw session string available");if(e&&t)throw new T("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?Ji:$i}w(Wi,Ki),w(zi,Wi),w(Hi,Wi),w(Gi,Wi),w(Qi,Wi);var Ji="enroll",$i="signin";function Zi(){}function eo(e,n){return e.then(function(e){if(e[Ka]){var t=xi(e[Ka]);if(!t||n!=t.h)throw new T("user-mismatch");return e}throw new T("user-mismatch")}).o(function(e){throw e&&e.code&&e.code==C+"user-not-found"?new T("user-mismatch"):e})}function to(e,t){if(!t)throw new T("internal-error","failed to construct a credential");this.a=t,jr(this,"providerId",e),jr(this,"signInMethod",e)}function no(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function ro(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new to(e.providerId,e.pendingToken)}catch(e){}return null}function io(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&jr(this,"idToken",t.idToken),t.accessToken&&jr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&jr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new T("internal-error","failed to construct a credential");jr(this,"accessToken",t.oauthToken),jr(this,"secret",t.oauthTokenSecret)}jr(this,"providerId",e),jr(this,"signInMethod",n)}function oo(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Bn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function ao(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new io(e.providerId,t,e.signInMethod)}catch(e){}}return null}function so(e,t){this.Pc=t||[],Vr(this,{providerId:e,isOAuthProvider:!0}),this.Hb={},this.ob=(qi(e)||{}).Ja||null,this.nb=null}function uo(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new T("argument-error",'SAML provider IDs must be prefixed with "saml."');so.call(this,e,[])}function co(e){so.call(this,e,Fi),this.a=[]}function lo(){co.call(this,"facebook.com")}function ho(e){if(!e)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new lo).credential({accessToken:t})}function fo(){co.call(this,"github.com")}function po(e){if(!e)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new fo).credential({accessToken:t})}function go(){co.call(this,"google.com"),this.Ca("profile")}function yo(e,t){var n=e;return y(e)&&(n=e.idToken,t=e.accessToken),(new go).credential({idToken:n,accessToken:t})}function mo(){so.call(this,"twitter.com",Mi)}function vo(e,t){var n=e;if(y(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new T("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new io("twitter.com",n,"twitter.com")}function bo(e,t,n){this.a=e,this.f=t,jr(this,"providerId","password"),jr(this,"signInMethod",n===wo.EMAIL_LINK_SIGN_IN_METHOD?wo.EMAIL_LINK_SIGN_IN_METHOD:wo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function _o(e){return e&&e.email&&e.password?new bo(e.email,e.password,e.signInMethod):null}function wo(){Vr(this,{providerId:"password",isOAuthProvider:!1})}function Eo(e,t){if(!(t=To(t)))throw new T("argument-error","Invalid email link!");return new bo(e,t.code,wo.EMAIL_LINK_SIGN_IN_METHOD)}function To(e){return(e=bi(e=Yi(e)))&&e.operation===Zr?e:null}function Io(e){if(!(e.cb&&e.bb||e.La&&e.ea))throw new T("internal-error");this.a=e,jr(this,"providerId","phone"),this.fa="phone",jr(this,"signInMethod","phone")}function So(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var n={};return j(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(e){t[e]&&(n[e]=t[e])}),new Io(n)}return null}function Co(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.cb,code:e.a.bb}}function ko(e){try{this.a=e||Jh.auth()}catch(e){throw new T("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Vr(this,{providerId:"phone",isOAuthProvider:!1})}function Ao(e,t){if(!e)throw new T("missing-verification-id");if(!t)throw new T("missing-verification-code");return new Io({cb:e,bb:t})}function No(e){if(e.temporaryProof&&e.phoneNumber)return new Io({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return yo(o,n);case"facebook.com":return ho(n);case"github.com":return po(n);case"twitter.com":return vo(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new to(t,a):new io(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new co(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(e){return null}}function Do(e){if(!e.isOAuthProvider)throw new T("invalid-oauth-provider")}function Ro(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new T("invalid-auth-event");if(this.g&&this.a)throw new T("invalid-auth-event");if(this.g&&!this.f)throw new T("invalid-auth-event")}function Oo(e){return(e=e||{}).type?new Ro(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&I(e.error),e.postBody,e.tenantId):null}function Po(){this.b=null,this.a=[]}Xi.prototype.Ha=function(){return this.a?_t(this.a):_t(this.b)},Xi.prototype.w=function(){return this.type==Ji?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Zi.prototype.ja=function(){},Zi.prototype.b=function(){},Zi.prototype.c=function(){},Zi.prototype.w=function(){},to.prototype.ja=function(e){return hs(e,no(this))},to.prototype.b=function(e,t){var n=no(this);return n.idToken=t,fs(e,n)},to.prototype.c=function(e,t){return eo(ps(e,no(this)),t)},to.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},io.prototype.ja=function(e){return hs(e,oo(this))},io.prototype.b=function(e,t){var n=oo(this);return n.idToken=t,fs(e,n)},io.prototype.c=function(e,t){return eo(ps(e,oo(this)),t)},io.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},so.prototype.Ka=function(e){return this.Hb=le(e),this},w(uo,so),w(co,so),co.prototype.Ca=function(e){return W(this.a,e)||this.a.push(e),this},co.prototype.Pb=function(){return Q(this.a)},co.prototype.credential=function(e,t){t=y(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null};if(!t.idToken&&!t.accessToken)throw new T("argument-error","credential failed: must provide the ID token and/or the access token.");return new io(this.providerId,t,this.providerId)},w(lo,co),jr(lo,"PROVIDER_ID","facebook.com"),jr(lo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),w(fo,co),jr(fo,"PROVIDER_ID","github.com"),jr(fo,"GITHUB_SIGN_IN_METHOD","github.com"),w(go,co),jr(go,"PROVIDER_ID","google.com"),jr(go,"GOOGLE_SIGN_IN_METHOD","google.com"),w(mo,so),jr(mo,"PROVIDER_ID","twitter.com"),jr(mo,"TWITTER_SIGN_IN_METHOD","twitter.com"),bo.prototype.ja=function(e){return this.signInMethod==wo.EMAIL_LINK_SIGN_IN_METHOD?Qs(e,ws,{email:this.a,oobCode:this.f}):Qs(e,Ks,{email:this.a,password:this.f})},bo.prototype.b=function(e,t){return this.signInMethod==wo.EMAIL_LINK_SIGN_IN_METHOD?Qs(e,Es,{idToken:t,email:this.a,oobCode:this.f}):Qs(e,Ls,{idToken:t,email:this.a,password:this.f})},bo.prototype.c=function(e,t){return eo(this.ja(e),t)},bo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Vr(wo,{PROVIDER_ID:"password"}),Vr(wo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Vr(wo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Io.prototype.ja=function(e){return e.eb(Co(this))},Io.prototype.b=function(e,t){var n=Co(this);return n.idToken=t,Qs(e,zs,n)},Io.prototype.c=function(e,t){var n=Co(this);return n.operation="REAUTH",eo(e=Qs(e,Hs,n),t)},Io.prototype.w=function(){var e={providerId:"phone"};return this.a.cb&&(e.verificationId=this.a.cb),this.a.bb&&(e.verificationCode=this.a.bb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},ko.prototype.eb=function(r,i){var o=this.a.a;return _t(i.verify()).then(function(n){if("string"!=typeof n)throw new T("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");if("recaptcha"!==i.type)throw new T("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.');var e=y(r)?r.session:null,t=y(r)?r.phoneNumber:r,e=e&&e.type==Ji?e.Ha().then(function(e){return Qs(o,Fs,{idToken:e,phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:n}}).then(function(e){return e.phoneSessionInfo.sessionInfo})}):e&&e.type==$i?e.Ha().then(function(e){return t=o,e={mfaPendingCredential:e,mfaEnrollmentId:r.multiFactorHint&&r.multiFactorHint.uid||r.multiFactorUid,phoneSignInInfo:{recaptchaToken:n}},Qs(t,Us,e).then(function(e){return e.phoneResponseInfo.sessionInfo});var t}):Qs(o,Ps,{phoneNumber:t,recaptchaToken:n});return e.then(function(e){return"function"==typeof i.reset&&i.reset(),e},function(e){throw"function"==typeof i.reset&&i.reset(),e})})},Vr(ko,{PROVIDER_ID:"phone"}),Vr(ko,{PHONE_SIGN_IN_METHOD:"phone"}),Ro.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},Ro.prototype.S=function(){return this.h},Ro.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var xo,Lo=null;function Mo(e){var t="unauthorized-domain",n=void 0,r=Dn(e);e=r.a,"chrome-extension"==(r=r.f)?n=Ue("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=Ue("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",T.call(this,t,n)}function Fo(e,t,n){T.call(this,e,n),(e=t||{}).Ib&&jr(this,"email",e.Ib),e.ea&&jr(this,"phoneNumber",e.ea),e.credential&&jr(this,"credential",e.credential),e.Yb&&jr(this,"tenantId",e.Yb)}function Uo(e){if(e.code){var t=e.code||"";0==t.indexOf(C)&&(t=t.substring(C.length));var n={credential:No(e),Yb:e.tenantId};if(e.email)n.Ib=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new T(t,e.message||void 0);return new Fo(t,n,e.message)}return null}function qo(){}function jo(e){return e.c||(e.c=e.b())}function Vo(){}function Bo(e){if(e.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return e.f;for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function Ko(){}function Wo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=v(this.pc,this),this.a.onerror=v(this.Rb,this),this.a.onprogress=v(this.qc,this),this.a.ontimeout=v(this.uc,this)}function zo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Ho(e,t,n){this.reset(e,t,n,void 0,void 0)}function Go(e){this.f=e,this.b=this.c=this.a=null}function Qo(e,t){this.name=e,this.value=t}w(Mo,T),w(Fo,T),Fo.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&fe(e,t),e},Fo.prototype.toJSON=function(){return this.w()},qo.prototype.c=null,w(Vo,qo),Vo.prototype.a=function(){var e=Bo(this);return e?new ActiveXObject(e):new XMLHttpRequest},Vo.prototype.b=function(){var e={};return Bo(this)&&(e[0]=!0,e[1]=!0),e},xo=new Vo,w(Ko,qo),Ko.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Wo;throw Error("Unsupported browser")},Ko.prototype.b=function(){return{}},(e=Wo.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,zo(this,4)},e.Rb=function(){this.status=500,this.response=this.responseText="",zo(this,4)},e.uc=function(){this.Rb()},e.qc=function(){this.status=200,zo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Ho.prototype.a=null,Ho.prototype.reset=function(e,t,n,r,i){delete this.a},Qo.prototype.toString=function(){return this.name};var Yo=new Qo("SEVERE",1e3),Xo=new Qo("WARNING",900),Jo=new Qo("CONFIG",700),$o=new Qo("FINE",500);Go.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c?t.c:t.a?e(t.a):(P("Root logger has no level set."),null)}(this).value)for(g(t)&&(t=t()),e=new Ho(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Zo,ea={},ta=null;function na(e){var t,n,r;return ta||(ta=new Go(""),(ea[""]=ta).c=Jo),(t=ea[e])||(t=new Go(e),r=e.lastIndexOf("."),n=e.substr(r+1),(r=na(e.substr(0,r))).b||(r.b={}),(r.b[n]=t).a=r,ea[e]=t),t}function ra(e,t){e&&e.log($o,t,void 0)}function ia(e){this.f=e}function oa(e){fn.call(this),this.u=e,this.h=void 0,this.readyState=aa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=na("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}w(ia,qo),ia.prototype.a=function(){return new oa(this.f)},ia.prototype.b=(Zo={},function(){return Zo}),w(oa,fn);var aa=0;function sa(e){e.c.read().then(e.oc.bind(e)).catch(e.Ta.bind(e))}function ua(e){e.readyState=4,e.g=null,e.c=null,e.m=null,ca(e)}function ca(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function la(e){fn.call(this),this.headers=new _n,this.O=e||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.s=null,this.m=ha,this.u=this.R=!1}(e=oa.prototype).open=function(e,t){if(this.readyState!=aa)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,ca(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.tc.bind(this),this.Ta.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ua(this)),this.readyState=aa},e.tc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,ca(this)),this.a&&(this.readyState=3,ca(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==h.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,sa(this)):e.text().then(this.sc.bind(this),this.Ta.bind(this)))))},e.oc=function(e){var t;this.a&&((t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done}))&&(this.response=this.responseText+=t),(e.done?ua:ca)(this),3==this.readyState&&sa(this))},e.sc=function(e){this.a&&(this.response=this.responseText=e,ua(this))},e.rc=function(e){this.a&&(this.response=e,ua(this))},e.Ta=function(e){var t=this.i;t&&t.log(Xo,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&ua(this)},e.setRequestHeader=function(e,t){this.l.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(Xo,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(Xo,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(oa.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),w(la,fn);var ha="";la.prototype.b=na("goog.net.XhrIo");var fa=/^https?$/i,pa=["POST","PUT"];function da(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=(t.O?t.O:xo).a(),t.A=t.O?jo(t.O):jo(xo),t.a.onreadystatechange=v(t.Ub,t);try{ra(t.b,Ta(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return ra(t.b,Ta(t,"Error opening Xhr: "+e.message)),void ya(t,e)}e=r||"";var o,a=new _n(t.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||"string"==typeof e)j(e,t,void 0);else for(var n=bn(e),r=vn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){a.set(t,e)}),i=function(e){e:{for(var t=ga,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:"string"==typeof e?e.charAt(t):e[t]}(a.Y()),r=h.FormData&&e instanceof h.FormData,!W(pa,n)||i||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(e,t){this.a.setRequestHeader(t,e)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{_a(t),0<t.g&&(t.u=(o=t.a,Ke&&$e(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),ra(t.b,Ta(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=v(t.Ma,t)):t.s=yn(t.Ma,t.g,t)),ra(t.b,Ta(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){ra(t.b,Ta(t,"Send error: "+e.message)),ya(t,e)}}function ga(e){return"content-type"==e.toLowerCase()}function ya(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,ma(e),ba(e)}function ma(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function va(t){if(t.c&&void 0!==l)if(t.A[1]&&4==wa(t)&&2==Ea(t))ra(t.b,Ta(t,"Local request error detected and ignored"));else if(t.i&&4==wa(t))yn(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==wa(t)){ra(t.b,Ta(t,"Request complete")),t.c=!1;try{var e,n,r,i,o=Ea(t);e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}if((e=a)||((n=0===o)&&(!(i=String(t.l).match(Tn)[1]||null)&&h.self&&h.self.location&&(i=(r=h.self.location.protocol).substr(0,r.length-1)),n=!fa.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var s=2<wa(t)?t.a.statusText:""}catch(e){ra(t.b,"Can not get status: "+e.message),s=""}t.h=s+" ["+Ea(t)+"]",ma(t)}}finally{ba(t)}}}function ba(t,e){if(t.a){_a(t);var n=t.a,r=t.A[0]?a:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(Yo,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function _a(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(h.clearTimeout(e.s),e.s=null)}function wa(e){return e.a?e.a.readyState:0}function Ea(e){try{return 2<wa(e)?e.a.status:-1}catch(e){return-1}}function Ta(e,t){return t+" ["+e.P+" "+e.l+" "+Ea(e)+"]"}function Ia(e){var t=La;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function Sa(e,t,n){e.a=!0,e.c=n,e.f=!t,Na(e)}function Ca(e){if(e.a){if(!e.m)throw new Da;e.m=!1}}function ka(e,t,n,r){e.g.push([t,n,r]),e.a&&Na(e)}function Aa(e){return K(e.g,function(e){return g(e[1])})}function Na(t){var n,r;t.h&&t.a&&Aa(t)&&(n=t.h,(r=Pa[n])&&(h.clearTimeout(r.a),delete Pa[n]),t.h=0),t.b&&(t.b.l--,delete t.b),n=t.c;for(var e=r=!1;t.g.length&&!t.i;){var i=(a=t.g.shift())[0],o=a[1],a=a[2];if(i=t.f?o:i)try{var s=i.call(a||t.s,n);void 0!==s&&(t.f=t.f&&(s==n||s instanceof Error),t.c=n=s),(D(n)||"function"==typeof h.Promise&&n instanceof h.Promise)&&(e=!0,t.i=!0)}catch(e){n=e,t.f=!0,Aa(t)||(r=!0)}}t.c=n,e&&(s=v(t.v,t,!0),e=v(t.v,t,!1),n instanceof Ia?(ka(n,s,e),n.A=!0):n.then(s,e)),r&&(n=new Oa(n),Pa[n.a]=n,t.h=n.a)}function Da(){R.call(this)}function Ra(){R.call(this)}function Oa(e){this.a=h.setTimeout(v(this.c,this),0),this.b=e}(e=la.prototype).Ma=function(){void 0!==l&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ra(this.b,Ta(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(ra(this.b,Ta(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ba(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ba(this,!0)),la.$a.Da.call(this)},e.Ub=function(){this.xa||(this.N||this.i||this.f?va(this):this.Ic())},e.Ic=function(){va(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ha:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(Yo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ra(this.b,"Can not get response: "+e.message),null}},Ia.prototype.cancel=function(e){var t;this.a?this.c instanceof Ia&&this.c.cancel():(this.b&&(t=this.b,delete this.b,e?t.cancel(e):(t.l--,t.l<=0&&t.cancel())),this.u?this.u.call(this.s,this):this.m=!0,this.a||(e=new Ra,Ca(this),Sa(this,!1,e)))},Ia.prototype.v=function(e,t){this.i=!1,Sa(this,e,t)},Ia.prototype.then=function(e,t,n){var r,i,o=new pt(function(e,t){r=e,i=t});return ka(this,r,function(e){e instanceof Ra?o.cancel():i(e)}),o.then(e,t,n)},Ia.prototype.$goog_Thenable=!0,w(Da,R),Da.prototype.message="Deferred has already fired",Da.prototype.name="AlreadyCalledError",w(Ra,R),Ra.prototype.message="Deferred was canceled",Ra.prototype.name="CanceledError",Oa.prototype.c=function(){throw delete Pa[this.a],this.b};var Pa={};function xa(e){var t=document,n=we(e).toString(),r=st(document,"SCRIPT"),i={Vb:r,Ma:void 0},o=new Ia(i),a=window.setTimeout(function(){Ma(r,!0);var e=new qa(Ua,"Timeout reached for loading script "+n);Ca(o),Sa(o,!1,e)},5e3);return i.Ma=a,r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Ma(r,!1,a),Ca(o),Sa(o,!0,null))},r.onerror=function(){Ma(r,!0,a);var e=new qa(Fa,"Error while loading script "+n);Ca(o),Sa(o,!1,e)},fe(i={},{type:"text/javascript",charset:"UTF-8"}),nt(r,i),i=e,pe(e=r,"HTMLScriptElement"),e.src=we(i),(i=(i=e.ownerDocument&&e.ownerDocument.defaultView)&&i!=h?f(i.document):(null===s&&(s=f(h.document)),s))&&e.setAttribute("nonce",i),((t=((i=t)||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:i.documentElement).appendChild(r),o}function La(){var e;this&&this.Vb&&((e=this.Vb)&&"SCRIPT"==e.tagName&&Ma(e,!0,this.Ma))}function Ma(e,t,n){null!=n&&h.clearTimeout(n),e.onload=a,e.onerror=a,e.onreadystatechange=a,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var Fa=0,Ua=1;function qa(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),R.call(this,n),this.code=e}function ja(e){this.f=e}function Va(e,t,n){if(this.c=e,e=t||{},this.l=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=e.secureTokenTimeout||Wa,this.g=le(e.secureTokenHeaders||za),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=e.firebaseTimeout||Ha,this.a=le(e.firebaseHeaders||Ga),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==hr(),!(n=h.XMLHttpRequest||n&&Jh.INTERNAL.node&&Jh.INTERNAL.node.XMLHttpRequest)&&!lr())throw new T("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,lr()?this.f=new ia(self):fr()?this.f=new ja(n):this.f=new Ko,this.b=null}w(qa,R),w(ja,qo),ja.prototype.a=function(){return new this.f},ja.prototype.b=function(){return{}};var Ba,Ka="idToken",Wa=new Rr(3e4,6e4),za={"Content-Type":"application/x-www-form-urlencoded"},Ha=new Rr(3e4,6e4),Ga={"Content-Type":"application/json"};function Qa(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Ya(e,t){t&&(e.l=Xa("https://securetoken.googleapis.com/v1/token",t),e.h=Xa("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=Xa("https://identitytoolkit.googleapis.com/v2/",t))}function Xa(e,t){return e=Dn(e),t=Dn(t.url),e.c=e.a+e.c,Sn(e,t.f),e.a=t.a,Cn(e,t.g),e.toString()}function Ja(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function $a(e,t,n,r,i,o,a){var s;(e=((s=gr(s=vr())==dr&&(s=s.match(/\sChrome\/(\d+)/i))&&2==s.length?parseInt(s[1],10):null)&&s<30||Ke&&Ze&&!(9<Ze))&&!lr()?(Ba=Ba||new pt(function(e,t){!function(e,t){{((window.gapi||{}).client||{}).request?e():(h[es]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){ka(e,null,t,void 0)}(xa(Ee(Za,{onload:es})),function(){t(Error("CORS_UNSUPPORTED"))}))}}(e,t)}),v(e.s,e)):v(e.u,e))(t,n,r,i,o,a)}Va.prototype.S=function(){return this.b},Va.prototype.u=function(e,n,t,r,i,o){if(lr()&&(void 0===h.fetch||void 0===h.Headers||void 0===h.Request))throw new T("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a,s=new la(this.f);o&&(s.g=Math.max(0,o),a=setTimeout(function(){s.dispatchEvent("timeout")},o)),pn(s,"complete",function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ra(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}n&&n(t)}),dn(s,"ready",function(){a&&clearTimeout(a),Mt(this)}),dn(s,"timeout",function(){a&&clearTimeout(a),Mt(this),n&&n(null)}),da(s,e,t,r,i)};var Za=new de(ve,"https://apis.google.com/js/client.js?onload=%{onload}"),es="__fcb"+Math.floor(1e6*Math.random()).toString();function ts(e,t,n,r,i,o,a){var s=Dn(t+n);An(s,"key",e.c),a&&An(s,"cb",_().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&An(s,c,i[c]);return new pt(function(t,n){$a(e,s.toString(),function(e){e?e.error?n(Xs(e,o||{})):t(e):n(new T("network-request-failed"))},r,u?void 0:Qn(Cr(i)),e.a,e.m.get())})}function ns(e){if("string"!=typeof(e=e.email)||!ar.test(e))throw new T("invalid-email")}function rs(e){"email"in e&&ns(e)}function is(e){if(!e[Ka]){if(e.mfaPendingCredential)throw new T("multi-factor-auth-required",null,le(e));throw new T("internal-error")}}function os(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new T("internal-error")}else{if(!e.sessionInfo)throw new T("missing-verification-id");if(!e.code)throw new T("missing-verification-code")}}Va.prototype.s=function(e,n,r,i,o){var a=this;Ba.then(function(){window.gapi.client.setApiKey(a.c);var t=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:r,body:i,headers:o,authType:"none",callback:function(e){window.gapi.auth.setToken(t),n&&n(e)}})}).o(function(e){n&&n({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},Va.prototype.yb=function(){return Qs(this,Ms,{})},Va.prototype.Ab=function(e,t){return Qs(this,xs,{idToken:e,email:t})},Va.prototype.Bb=function(e,t){return Qs(this,Ls,{idToken:e,password:t})};var as={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ss(e){if(!e.phoneVerificationInfo)throw new T("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new T("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new T("missing-verification-code")}function us(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new T("internal-error")}function cs(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&(Wn(e=new jn(e.postBody),"nonce")&&(t.nonce=e.get("nonce")))),t}function ls(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Uo(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Uo(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Uo(e)):e.errorMessage&&(t=Ys(e.errorMessage)),t)throw t;is(e)}function hs(e,t){return t.returnIdpCredential=!0,Qs(e,qs,t)}function fs(e,t){return t.returnIdpCredential=!0,Qs(e,Vs,t)}function ps(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Qs(e,js,t)}function ds(e){if(!e.oobCode)throw new T("invalid-action-code")}(e=Va.prototype).Cb=function(e,r){var i={idToken:e},o=[];return ue(as,function(e,t){var n=r[t];null===n?o.push(e):t in r&&(i[t]=n)}),o.length&&(i.deleteAttribute=o),Qs(this,xs,i)},e.ub=function(e,t){return fe(e={requestType:"PASSWORD_RESET",email:e},t),Qs(this,Ns,e)},e.vb=function(e,t){return fe(e={requestType:"EMAIL_SIGNIN",email:e},t),Qs(this,Cs,e)},e.tb=function(e,t){return fe(e={requestType:"VERIFY_EMAIL",idToken:e},t),Qs(this,ks,e)},e.Db=function(e,t,n){return fe(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),Qs(this,As,e)},e.eb=function(e){return Qs(this,Ws,e)},e.mb=function(e,t){return Qs(this,Os,{oobCode:e,newPassword:t})},e.Qa=function(e){return Qs(this,ys,{oobCode:e})},e.ib=function(e){return Qs(this,gs,{oobCode:e})};var gs={endpoint:"setAccountInfo",B:ds,Z:"email",C:!0},ys={endpoint:"resetPassword",B:ds,F:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new T("internal-error")},C:!0},ms={endpoint:"signupNewUser",B:function(e){if(ns(e),!e.password)throw new T("weak-password")},F:is,U:!0,C:!0},vs={endpoint:"createAuthUri",C:!0},bs={endpoint:"deleteAccount",M:["idToken"]},_s={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(e){if(!Array.isArray(e.deleteProvider))throw new T("internal-error")}},ws={endpoint:"emailLinkSignin",M:["email","oobCode"],B:ns,F:is,U:!0,C:!0},Es={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:ns,F:is,U:!0},Ts={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:ss,F:is,C:!0,Na:!0},Is={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:ss,F:is,C:!0,Na:!0},Ss={endpoint:"getAccountInfo"},Cs={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new T("internal-error");ns(e)},Z:"email",C:!0},ks={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new T("internal-error")},Z:"email",C:!0},As={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new T("internal-error")},Z:"email",C:!0},Ns={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(e){if("PASSWORD_RESET"!=e.requestType)throw new T("internal-error");ns(e)},Z:"email",C:!0},Ds={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Rs={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(e){if(!e.recaptchaSiteKey)throw new T("internal-error")}},Os={endpoint:"resetPassword",B:ds,Z:"email",C:!0},Ps={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},xs={endpoint:"setAccountInfo",M:["idToken"],B:rs,U:!0},Ls={endpoint:"setAccountInfo",M:["idToken"],B:function(e){if(rs(e),!e.password)throw new T("weak-password")},F:is,U:!0},Ms={endpoint:"signupNewUser",F:is,U:!0,C:!0},Fs={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(e){if(!e.phoneEnrollmentInfo)throw new T("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new T("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},Us={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},qs={endpoint:"verifyAssertion",B:us,Xa:cs,F:ls,U:!0,C:!0},js={endpoint:"verifyAssertion",B:us,Xa:cs,F:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new T("user-not-found");if(e.errorMessage)throw Ys(e.errorMessage);is(e)},U:!0,C:!0},Vs={endpoint:"verifyAssertion",B:function(e){if(us(e),!e.idToken)throw new T("internal-error")},Xa:cs,F:ls,U:!0},Bs={endpoint:"verifyCustomToken",B:function(e){if(!e.token)throw new T("invalid-custom-token")},F:is,U:!0,C:!0},Ks={endpoint:"verifyPassword",B:function(e){if(ns(e),!e.password)throw new T("wrong-password")},F:is,U:!0,C:!0},Ws={endpoint:"verifyPhoneNumber",B:os,F:is,C:!0},zs={endpoint:"verifyPhoneNumber",B:function(e){if(!e.idToken)throw new T("internal-error");os(e)},F:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Uo(e);is(e)}},Hs={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:os,F:is,C:!0},Gs={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(e){if(!!e[Ka]^!!e.refreshToken)throw new T("internal-error")},C:!0,Na:!0};function Qs(e,t,n){if(!function(e,t){if(!t||!t.length)return 1;if(e){for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return}return 1}}(n,t.M))return wt(new T("internal-error"));var r,i=!!t.Na,o=t.Tb||"POST";return _t(n).then(t.B).then(function(){return t.U&&(n.returnSecureToken=!0),t.C&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),ts(e,i?e.i:e.h,t.endpoint,o,n,t.Gb,t.kb||!1)}).then(function(e){return r=e,t.Xa?t.Xa(n,r):r}).then(t.F).then(function(){if(!t.Z)return r;if(!(t.Z in r))throw new T("internal-error");return r[t.Z]})}function Ys(e){return Xs({error:{errors:[{message:e}],code:400,message:e}})}function Xs(e,t){var n,r=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(r=i[r]?new T(i[r]):null)return r;for(n in r=e.error&&e.error.message||"",fe(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=r.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,i)if(0===r.indexOf(n))return new T(i[n],t);return!t&&e&&(t=Sr(e)),new T("internal-error",t)}function Js(e){var o;this.b=e,this.a=null,this.qb=(o=this,(tu||(tu=new pt(function(e,t){function n(){Dr(),br("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Dr(),t(Error("Network Error"))},timeout:Zs.get()})}var r;br("gapi.iframes.Iframe")?e():br("gapi.load")?n():(r="__iframefcb"+Math.floor(1e6*Math.random()).toString(),h[r]=function(){br("gapi.load")?n():t(Error("Network Error"))},_t(xa(r=Ee($s,{onload:r}))).o(function(){t(Error("Network Error"))}))}).o(function(e){throw tu=null,e}))).then(function(){return new pt(function(r,i){br("gapi.iframes.getContext")().open({where:document.body,url:o.b,messageHandlersFilter:br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(e){function t(){clearTimeout(n),r()}o.a=e,o.a.restyle({setHideOnLeave:!1});var n=setTimeout(function(){i(Error("Network Error"))},eu.get());e.ping(t).then(t,function(){i(Error("Network Error"))})})})}))}var $s=new de(ve,"https://apis.google.com/js/api.js?onload=%{onload}"),Zs=new Rr(3e4,6e4),eu=new Rr(5e3,15e3),tu=null;function nu(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,e=this.g?Rn((e=Dn(this.g.url)).f,e.a,e.g,"/emulator/auth/iframe"):Rn("https",this.l,null,"/__/auth/iframe"),this.a=e,An(this.a,"apiKey",this.h),An(this.a,"appName",this.i),this.b=null,this.c=[]}function ru(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function iu(e){try{return Jh.app(e).auth().Ga()}catch(e){return[]}}function ou(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function au(e){var s=er();return Qs(e,Ds,{}).then(function(e){return e.authorizedDomains||[]}).then(function(e){e:{for(var t=(n=Dn(s)).f,n=n.a,r=0;r<e.length;r++){var i=e[r],o=n,a=t;if(o=0==i.indexOf("chrome-extension://")?Dn(i).a==o&&"chrome-extension"==a:("http"==a||"https"==a)&&(or.test(i)?o==i:(i=i.split(".").join("\\."),new RegExp("^(.+\\."+i+"|"+i+")$","i").test(o)))){e=!0;break e}}e=!1}if(!e)throw new Mo(er())})}function su(i){return i.v||(i.v=sr().then(function(){var e,t,n,r;i.u||(e=i.c,t=i.i,n=iu(i.b),(r=new nu(i.s,i.g,i.b,i.f)).f=e,r.b=t,r.c=Q(n||[]),i.u=r.toString()),i.m=new Js(i.u),function(r){if(!r.m)throw Error("IfcHandler must be initialized!");!function(e,t){e.qb.then(function(){e.a.register("authEvent",t,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(r.m,function(e){var t={};if(e&&e.authEvent){var n=!1;for(e=Oo(e.authEvent),t=0;t<r.h.length;t++)n=r.h[t](e)||n;return(t={}).status=n?"ACK":"ERROR",_t(t)}return t.status="ERROR",_t(t)})}(i)})),i.v}function uu(e){return e.l||(e.A=e.c?mr(e.c,iu(e.b)):null,e.l=new Va(e.g,N(e.i),e.A),e.f&&Ya(e.l,e.f)),e.l}function cu(e,t,n,r,i,o,a,s,u,c,l,h){return(e=new ru(e,t,n,r,i,h)).l=o,e.g=a,e.i=s,e.b=le(u||null),e.f=c,e.xb(l).toString()}function lu(e){if(this.a=e||Jh.INTERNAL.reactNative&&Jh.INTERNAL.reactNative.AsyncStorage,!this.a)throw new T("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function hu(e){this.b=e,this.a={},this.f=v(this.c,this)}nu.prototype.toString=function(){return this.f?An(this.a,"v",this.f):Kn(this.a.b,"v"),this.b?An(this.a,"eid",this.b):Kn(this.a.b,"eid"),this.c.length?An(this.a,"fw",this.c.join(",")):Kn(this.a.b,"fw"),this.a.toString()},ru.prototype.xb=function(e){return this.h=e,this},ru.prototype.toString=function(){var e;if(An(e=this.m?Rn((e=Dn(this.m.url)).f,e.a,e.g,"/emulator/auth/handler"):Rn("https",this.u,null,"/__/auth/handler"),"apiKey",this.s),An(e,"appName",this.c),An(e,"authType",this.v),this.a.isOAuthProvider){var t,n=this.a;try{var r=Jh.app(this.c).auth().ka()}catch(e){r=null}for(t in n.nb=r,An(e,"providerId",this.a.providerId),n=Cr((r=this.a).Hb))n[t]=n[t].toString();t=r.Pc,n=le(n);for(var i=0;i<t.length;i++){var o=t[i];o in n&&delete n[o]}r.ob&&r.nb&&!n[r.ob]&&(n[r.ob]=r.nb),ce(n)||An(e,"customParameters",Sr(n))}if("function"==typeof this.a.Pb&&((r=this.a.Pb()).length&&An(e,"scopes",r.join(","))),this.l?An(e,"redirectUrl",this.l):Kn(e.b,"redirectUrl"),this.g?An(e,"eventId",this.g):Kn(e.b,"eventId"),this.i?An(e,"v",this.i):Kn(e.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Nn(e,a)&&An(e,a,this.b[a]);return this.h?An(e,"tid",this.h):Kn(e.b,"tid"),this.f?An(e,"eid",this.f):Kn(e.b,"eid"),(a=iu(this.c)).length&&An(e,"fw",a.join(",")),e.toString()},(e=ou.prototype).Nb=function(t,n,e){var r=new T("popup-closed-by-user"),i=new T("web-storage-unsupported"),o=this,a=!1;return this.la().then(function(){var e,r;r={type:"webStorageSupport"},su(e=o).then(function(){return t=e.m,n=r,t.qb.then(function(){return new pt(function(e){t.a.send(n.type,n,e,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var t,n}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()}).then(function(e){e||(t&&rr(t),n(i),a=!0)})}).o(function(){}).then(function(){if(!a)return n=t,new pt(function(t){return function e(){mn(2e3).then(function(){return n&&!n.closed?e():void t()})}()});var n}).then(function(){if(!a)return mn(e).then(function(){n(r)})})},e.Wb=function(){var e=vr();return!Ir(e)&&!Nr(e)},e.Sb=function(){return!1},e.Lb=function(t,e,n,r,i,o,a,s){if(!t)return wt(new T("popup-blocked"));if(a&&!Ir())return this.la().o(function(e){rr(t),i(e)}),r(),_t();this.a||(this.a=au(uu(this)));var u=this;return this.a.then(function(){var e=u.la().o(function(e){throw rr(t),i(e),e});return r(),e}).then(function(){Do(n),a||tr(cu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)}).o(function(e){throw"auth/network-request-failed"==e.code&&(u.a=null),e})},e.Mb=function(e,t,n,r){this.a||(this.a=au(uu(this)));var i=this;return this.a.then(function(){Do(t),tr(cu(i.s,i.g,i.b,e,t,er(),n,i.c,void 0,i.i,r,i.f))}).o(function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e})},e.la=function(){var e=this;return su(this).then(function(){return e.m.qb}).o(function(){throw e.a=null,new T("network-request-failed")})},e.Zb=function(){return!0},e.Ea=function(e){this.h.push(e)},e.Ra=function(t){H(this.h,function(e){return e==t})},(e=lu.prototype).get=function(e){return _t(this.a.getItem(e)).then(function(e){return e&&kr(e)})},e.set=function(e,t){return _t(this.a.setItem(e,Sr(t)))},e.T=function(e){return _t(this.a.removeItem(e))},e.ca=function(){},e.ia=function(){};var fu,pu=[];function du(e,t,n){ce(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function gu(e){this.a=e}function yu(e){this.c=e,this.b=!1,this.a=[]}function mu(r,e,t,n){var i,o,a,s,u=t||{},c=null;if(r.b)return wt(Error("connection_unavailable"));var l=n?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new pt(function(t,n){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){n(Error("unsupported_event"))},l),c={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout(function(){n(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?t(e.data.response):n(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),n(Error("invalid_response"))))}},r.a.push(c),h.port1.addEventListener("message",o),r.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):n(Error("connection_unavailable"))}).then(function(e){return vu(r,c),e}).o(function(e){throw vu(r,c),e})}function vu(e,t){var n,r;t&&(n=t.messageChannel,r=t.onMessage,n&&(n.port1.removeEventListener("message",r),n.port1.close()),H(e.a,function(e){return e==t}))}function bu(){if(!Tu())throw new T("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.v=h.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.l=null,this.s=!1,this.h=null;var e,t,n,r=this;lr()&&self?(this.m=(n=lr()?self:null,j(pu,function(e){e.b==n&&(t=e)}),t||(t=new hu(n),pu.push(t)),t),du(this.m,"keyChanged",function(e,n){return Au(r).then(function(t){return 0<t.length&&j(r.a,function(e){e(t)}),{keyProcessed:W(t,n.key)}})}),du(this.m,"ping",function(){return _t(["keyChanged"])})):((e=h.navigator)&&e.serviceWorker?_t().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).o(function(){return null}):_t(null)).then(function(e){(r.h=e)&&(r.g=new yu(new gu(e)),mu(r.g,"ping",null,!0).then(function(e){e[0].fulfilled&&W(e[0].value,"keyChanged")&&(r.s=!0)}).o(function(){}))})}function _u(i){return new pt(function(t,n){var e=i.v.open("firebaseLocalStorageDb",1);e.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},e.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},e.onsuccess=function(e){var r;(e=e.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(e):(r=i,new pt(function(e,t){var n=r.v.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){e()},n.onerror=function(e){t(Error(e.target.error))}}).then(function(){return _u(i)}).then(function(e){t(e)}).o(function(e){n(e)}))}})}function wu(e){return e.i||(e.i=_u(e)),e.i}function Eu(i,e){var o=0;return new pt(function t(n,r){wu(i).then(e).then(n).o(function(e){return 3<++o?void r(e):wu(i).then(function(e){return e.close(),i.i=void 0,t(n,r)}).o(function(e){r(e)})})})}function Tu(){try{return h.indexedDB}catch(e){return}}function Iu(e){return e.objectStore("firebaseLocalStorage")}function Su(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function Cu(e){return new pt(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function ku(e,t){return e.g&&e.h&&((n=h.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===e.h?mu(e.g,"keyChanged",{key:t},e.s).then(function(){}).o(function(){}):_t();var n}function Au(r){return wu(r).then(function(e){var i=Iu(Su(e,!1));return i.getAll?Cu(i.getAll()):new pt(function(t,n){var r=[],e=i.openCursor();e.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},e.onerror=function(e){n(e.target.error)}})}).then(function(e){var t={},n=[];if(0==r.b){for(n=0;n<e.length;n++)t[e[n].fbase_key]=e[n].value;n=function e(t,n){var r,i=[];for(r in t)r in n&&typeof t[r]==typeof n[r]?"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(r.c,t),r.c=t}return n})}function Nu(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Du(e){var r=this,i=null;this.a=[],this.type="indexedDB",this.c=e,this.b=_t().then(function(){if(Tu()){var t=Ar(),n="__sak"+t;return fu=fu||new bu,(i=fu).set(n,t).then(function(){return i.get(n)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return i.T(n)}).then(function(){return i}).o(function(){return r.c})}return r.c}).then(function(e){return r.type=e.type,e.ca(function(t){j(r.a,function(e){e(t)})}),e})}function Ru(){this.a={},this.type="inMemory"}function Ou(){if(!function(){var e="Node"==hr();if(!(e=Pu()||e&&Jh.INTERNAL.node&&Jh.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==hr())throw new T("internal-error","The LocalStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Pu()||Jh.INTERNAL.node.localStorage,this.type="localStorage"}function Pu(){try{var e=h.localStorage,t=Ar();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function xu(){this.type="nullStorage"}function Lu(){if(!function(){var e="Node"==hr();if(!(e=Mu()||e&&Jh.INTERNAL.node&&Jh.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==hr())throw new T("internal-error","The SessionStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Mu()||Jh.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Mu(){try{var e=h.sessionStorage,t=Ar();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function Fu(){var e={};e.Browser=ju,e.Node=Vu,e.ReactNative=Bu,e.Worker=Ku,this.a=e[hr()]}hu.prototype.c=function(n){var t,r=n.data.eventType,i=n.data.eventId,e=this.a[r];e&&0<e.length&&(n.ports[0].postMessage({status:"ack",eventId:i,eventType:r,response:null}),t=[],j(e,function(e){t.push(_t().then(function(){return e(n.origin,n.data.data)}))}),Tt(t).then(function(e){var t=[];j(e,function(e){t.push({fulfilled:e.Ob,value:e.value,reason:e.reason?e.reason.message:void 0})}),j(t,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:t})}))},gu.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},yu.prototype.close=function(){for(;0<this.a.length;)vu(this,this.a[0]);this.b=!0},(e=bu.prototype).set=function(r,i){var o=this,a=!1;return Eu(this,function(e){return Cu((e=Iu(Su(e,!0))).get(r))}).then(function(n){return Eu(o,function(e){if(e=Iu(Su(e,!0)),n)return n.value=i,Cu(e.put(n));o.b++,a=!0;var t={};return t.fbase_key=r,t.value=i,Cu(e.add(t))})}).then(function(){return o.c[r]=i,ku(o,r)}).na(function(){a&&o.b--})},e.get=function(t){return Eu(this,function(e){return Cu(Iu(Su(e,!1)).get(t))}).then(function(e){return e&&e.value})},e.T=function(t){var n=this,r=!1;return Eu(this,function(e){return r=!0,n.b++,Cu(Iu(Su(e,!0)).delete(t))}).then(function(){return delete n.c[t],ku(n,t)}).na(function(){r&&n.b--})},e.ca=function(e){var n;0==this.a.length&&(Nu(n=this),function t(){n.f=setTimeout(function(){n.l=Au(n).then(function(t){0<t.length&&j(n.a,function(e){e(t)})}).then(function(){t()}).o(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()),this.a.push(e)},e.ia=function(t){H(this.a,function(e){return e==t}),0==this.a.length&&Nu(this)},(e=Du.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},e.set=function(t,n){return this.b.then(function(e){return e.set(t,n)})},e.T=function(t){return this.b.then(function(e){return e.T(t)})},e.ca=function(e){this.a.push(e)},e.ia=function(t){H(this.a,function(e){return e==t})},(e=Ru.prototype).get=function(e){return _t(this.a[e])},e.set=function(e,t){return this.a[e]=t,_t()},e.T=function(e){return delete this.a[e],_t()},e.ca=function(){},e.ia=function(){},(e=Ou.prototype).get=function(e){var t=this;return _t().then(function(){return kr(t.a.getItem(e))})},e.set=function(t,n){var r=this;return _t().then(function(){var e=Sr(n);null===e?r.T(t):r.a.setItem(t,e)})},e.T=function(e){var t=this;return _t().then(function(){t.a.removeItem(e)})},e.ca=function(e){h.window&&Zt(h.window,"storage",e)},e.ia=function(e){h.window&&nn(h.window,"storage",e)},(e=xu.prototype).get=function(){return _t(null)},e.set=function(){return _t()},e.T=function(){return _t()},e.ca=function(){},e.ia=function(){},(e=Lu.prototype).get=function(e){var t=this;return _t().then(function(){return kr(t.a.getItem(e))})},e.set=function(t,n){var r=this;return _t().then(function(){var e=Sr(n);null===e?r.T(t):r.a.setItem(t,e)})},e.T=function(e){var t=this;return _t().then(function(){t.a.removeItem(e)})},e.ca=function(){},e.ia=function(){};var Uu,qu,ju={D:Ou,ab:Lu},Vu={D:Ou,ab:Lu},Bu={D:lu,ab:xu},Ku={D:Ou,ab:xu},Wu={qd:"local",NONE:"none",sd:"session"};function zu(){var e=!(Nr(vr())||!cr()),t=Ir(),n=_r();this.v=e,this.h=t,this.l=n,this.a={},e=Uu=Uu||new Fu;try{this.g=!Zn()&&Lr()||!h.indexedDB?new e.a.D:new Du(new(lr()?Ru:e.a.D))}catch(e){this.g=new Ru,this.h=!0}try{this.i=new e.a.ab}catch(e){this.i=new Ru}this.m=new Ru,this.f=v(this.Xb,this),this.b={}}function Hu(){return qu=qu||new zu}function Gu(e,t){switch(t){case"session":return e.i;case"none":return e.m;default:return e.g}}function Qu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function Yu(e,t,n){return n=Qu(t,n),"local"==t.D&&(e.b[n]=null),Gu(e,t.D).T(n)}function Xu(e){e.c&&(clearInterval(e.c),e.c=null)}function Ju(e){this.a=e,this.b=Hu()}(e=zu.prototype).get=function(e,t){return Gu(this,e.D).get(Qu(e,t))},e.set=function(t,e,n){var r=Qu(t,n),i=this,o=Gu(this,t.D);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.D&&(i.b[r]=e)})},e.addListener=function(e,t,n){var r;e=Qu(e,t),this.l&&(this.b[e]=h.localStorage.getItem(e)),ce(this.a)&&(Gu(this,"local").ca(this.f),this.h||(Zn()||!Lr())&&h.indexedDB||!this.l||(Xu(r=this),r.c=setInterval(function(){for(var e in r.a){var t=h.localStorage.getItem(e),n=r.b[e];t!=n&&(r.b[e]=t,t=new Bt({type:"storage",key:e,target:window,oldValue:n,newValue:t,a:!0}),r.Xb(t))}},1e3))),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Qu(e,t),this.a[e]&&(H(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),ce(this.a)&&(Gu(this,"local").ia(this.f),Xu(this))},e.Xb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=h.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?Gu(this,"local").ia(this.f):Xu(this),this.v)if(n=h.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?h.localStorage.setItem(t,r):h.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this,n=function(){void 0===e.a.a&&o.b[t]===h.localStorage.getItem(t)||(o.b[t]=h.localStorage.getItem(t),o.lb(t))};Ke&&Ze&&10==Ze&&h.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else j(e,v(this.lb,this))},e.lb=function(e){this.a[e]&&j(this.a[e],function(e){e()})};var $u,Zu={name:"authEvent",D:"local"};function ec(){this.a=Hu()}function tc(e,t){this.b=nc,this.f=h.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=h.Int32Array?new Int32Array(64):Array(64),void 0===$u&&($u=h.Int32Array?new Int32Array(cc):cc),this.reset()}w(tc,function(){this.b=-1});for(var nc=64,rc=nc-1,ic=[],oc=0;oc<rc;oc++)ic[oc]=0;var ac=G(128,ic);function sc(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;t<64;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;t<64;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|$u[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function uc(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"==typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(sc(e),i=0);else{if(!d(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(sc(e),i=0)}}e.c=i,e.g+=n}tc.prototype.reset=function(){this.g=this.c=0,this.a=h.Int32Array?new Int32Array(this.h):Q(this.h)};var cc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function lc(){tc.call(this,8,hc)}w(lc,tc);var hc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function fc(e,t,n,r,i,o){this.m=e,this.i=t,this.l=n,this.v=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.A=new ec,this.g=new Ju(this.h),this.f=null,this.b=[],this.a=this.c=null}function pc(e){return new T("invalid-cordova-configuration",e)}function dc(e){var t=new lc;uc(t,e),e=[];var n=8*t.g;t.c<56?uc(t,ac,56-t.c):uc(t,ac,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(sc(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return B(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}function gc(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function yc(s){return s.f||(s.f=s.la().then(function(){return new pt(function(n){function t(r){e=!0,a&&a.cancel(),mc(i).then(function(e){var t,n=o;e&&r&&r.url&&(t=null,-1!=(n=Yi(r.url)).indexOf("/__/auth/callback")&&(t=(t="object"==typeof(t=kr(Nn(t=Dn(n),"firebaseError")||null))?I(t):null)?new Ro(e.c,e.b,null,null,t,null,e.S()):new Ro(e.c,e.b,n,e.f,null,null,e.S())),n=t||o),gc(i,n)})}var i,o,e,a,r;s.Ea(function e(t){return n(t),s.Ra(e),!1}),i=s,o=new Ro("unknown",null,null,null,new T("no-auth-event")),e=!1,a=mn(500).then(function(){return mc(i).then(function(){e||gc(i,o)})}),r=h.handleOpenURL,h.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(br("BuildInfo.packageName",h).toLowerCase()+"://")&&t({url:e}),"function"==typeof r)try{r(e)}catch(e){console.error(e)}},Lo=Lo||new Po,function(e){var n=Lo;n.a.push(e),n.b||(n.b=function(e){for(var t=0;t<n.a.length;t++)n.a[t](e)},"function"==typeof(e=br("universalLinks.subscribe",h))&&e(null,n.b))}(t)})})),s.f}function mc(t){var e,n=null;return(e=t.g).b.get(Zu,e.a).then(Oo).then(function(e){return n=e,Yu((e=t.g).b,Zu,e.a)}).then(function(){return n})}function vc(e){this.a=e,this.b=Hu()}(e=fc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(ur(void 0)?sr().then(function(){return new pt(function(e,t){var n=h.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):wt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof br("universalLinks.subscribe",h))throw pc("cordova-universal-links-plugin-fix is not installed");if(void 0===br("BuildInfo.packageName",h))throw pc("cordova-plugin-buildinfo is not installed");if("function"!=typeof br("cordova.plugins.browsertab.openUrl",h))throw pc("cordova-plugin-browsertab is not installed");if("function"!=typeof br("cordova.InAppBrowser.open",h))throw pc("cordova-plugin-inappbrowser is not installed")},function(){throw new T("cordova-not-ready")})},e.Nb=function(e,t){return t(new T("operation-not-supported-in-this-environment")),_t()},e.Lb=function(){return wt(new T("operation-not-supported-in-this-environment"))},e.Zb=function(){return!1},e.Wb=function(){return!0},e.Sb=function(){return!0},e.Mb=function(e,t,n,r){if(this.c)return wt(new T("redirect-operation-pending"));var i=this,o=h.document,a=null,s=null,u=null,c=null;return this.c=_t().then(function(){return Do(t),yc(i)}).then(function(){return function(n,e,t,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),a=new Ro(e,r,null,o,new T("no-auth-event"),null,i),s=br("BuildInfo.packageName",h);if("string"!=typeof s)throw new T("invalid-cordova-configuration");var u=br("BuildInfo.displayName",h),c={};if(vr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!vr().toLowerCase().match(/android/))return wt(new T("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=dc(o),c.sessionId=o;var l=cu(n.m,n.i,n.l,e,t,null,r,n.v,c,n.u,i,n.s);return n.la().then(function(){var e=n.h;return n.A.a.set(Zu,a.w(),e)}).then(function(){var e=br("cordova.plugins.browsertab.isAvailable",h);if("function"!=typeof e)throw new T("invalid-cordova-configuration");var t=null;e(function(e){if(e){if("function"!=typeof(t=br("cordova.plugins.browsertab.openUrl",h)))throw new T("invalid-cordova-configuration");t(l)}else{if("function"!=typeof(t=br("cordova.InAppBrowser.open",h)))throw new T("invalid-cordova-configuration");e=vr(),n.a=t(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,e,t,n,r)}).then(function(){return new pt(function(t,e){s=function(){var e=br("cordova.plugins.browsertab.close",h);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),u=function(){a=a||mn(2e3).then(function(){e(new T("redirect-cancelled-by-user"))})},c=function(){Or()&&u()},o.addEventListener("resume",u,!1),vr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).o(function(e){return mc(i).then(function(){throw e})})}).na(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&i.Ra(s),i.c=null})},e.Ea=function(t){this.b.push(t),yc(this).o(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ro("unknown",null,null,null,new T("no-auth-event")),t(e))})},e.Ra=function(t){H(this.b,function(e){return e==t})};var bc={name:"pendingRedirect",D:"session"};function _c(e){return Yu(e.b,bc,e.a)}function wc(e,t,n,r){this.i={},this.u=0,this.O=e,this.m=t,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=v(this.s,this),this.b=new Mc,this.A=new Vc,this.g=new vc(xc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=Ec(this.O,this.m,this.v,S,this.G)}function Ec(e,t,n,r,i){var o=Jh.SDK_VERSION||null;return new(ur()?fc:ou)(e,t,n,o,r,i)}function Tc(t){t.f||(t.f=!0,t.a.Ea(t.l));var n=t.a;return t.a.la().o(function(e){throw t.a==n&&t.reset(),e})}function Ic(n){n.a.Wb()&&Tc(n).o(function(e){var t=new Ro("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Dc(e)&&n.s(t)}),n.a.Sb()||Fc(n.b)}function Sc(n,e){W(n.h,e)||n.h.push(e),n.f||(e=n.g).b.get(bc,e.a).then(function(e){return"pending"==e}).then(function(e){e?_c(n.g).then(function(){Tc(n).o(function(e){var t=new Ro("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Dc(e)&&n.s(t)})}):Ic(n)}).o(function(){Ic(n)})}function Cc(e,t){H(e.h,function(e){return e==t})}wc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=Ec(this.O,this.m,this.v,null,this.G),this.i={}},wc.prototype.s=function(e){if(!e)throw new T("invalid-auth-event");if(6e5<=_()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=_())),t=!0;break}}return Fc(this.b),t};var kc=new Rr(2e3,1e4),Ac=new Rr(3e4,6e4);function Nc(e,t,n,r,i,o,a){return e.a.Lb(t,n,r,function(){e.f||(e.f=!0,e.a.Ea(e.l))},function(){e.reset()},i,o,a)}function Dc(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function Rc(t,e,n,r,i){var o,a;return(a=t.g).b.set(bc,"pending",a.a).then(function(){return t.a.Mb(e,n,r,i).o(function(e){if(Dc(e))throw new T("operation-not-supported-in-this-environment");return o=e,_c(t.g).then(function(){throw o})}).then(function(){return t.a.Zb()?new pt(function(){}):_c(t.g).then(function(){return t.qa()}).then(function(){}).o(function(){})})})}function Oc(e,t,n,r,i){return e.a.Nb(r,function(e){t.ma(n,null,e,i)},kc.get())}wc.prototype.qa=function(){return this.b.qa()};var Pc={};function xc(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function Lc(e,t,n,r){var i=xc(t,n,r);return Pc[i]||(Pc[i]=new wc(e,t,n,r)),Pc[i]}function Mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Fc(e){e.g||(e.g=!0,jc(e,!1,null,null))}function Uc(e){e.g&&!e.i&&jc(e,!1,null,null)}function qc(e,t){if(e.b=function(){return _t(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function jc(e,t,n,r){t?r?function(e,t){if(e.b=function(){return wt(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):qc(e,n):qc(e,{user:null}),e.f=[],e.c=[]}function Vc(){}function Bc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(e){this.hb=e},enumerable:!1})}function Kc(e,t){this.a=t,jr(this,"verificationId",e)}function Wc(e,t,n,r){return new ko(e).eb(t,n).then(function(e){return new Kc(e,r)})}function zc(e){var t=Li(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new T("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Vr(this,{token:e,expirationTime:xr(1e3*t.exp),authTime:xr(1e3*t.auth_time),issuedAtTime:xr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function Hc(e,t,n){var r=t&&t[Qc];if(!r)throw new T("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=le(t),this.g=n,this.c=new Xi(null,r),this.b=[];var i=this;j(t[Gc]||[],function(e){(e=zr(e))&&i.b.push(e)}),jr(this,"auth",this.a),jr(this,"session",this.c),jr(this,"hints",this.b)}Mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Mc.prototype.h=function(e,t){var n,r,i,o;e?(this.reset(),this.g=!0,n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code,this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(jc(this,!0,null,e.a),_t()):t.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then(function(e){jc(t,s,e,null)}).o(function(e){jc(t,s,null,e)})}(this,e,t):wt(new T("invalid-auth-event")):(jc(this,!1,null,null),_t())):wt(new T("invalid-auth-event"))},Mc.prototype.qa=function(){var i=this;return new pt(function(e,t){var n,r;i.b?i.b().then(e,t):(i.f.push(e),i.c.push(t),n=i,r=new T("timeout"),n.a&&n.a.cancel(),n.a=mn(Ac.get()).then(function(){n.b||(n.g=!0,jc(n,!0,null,r))}))})},Vc.prototype.h=function(e,t){var n,r,i,o,a;e?(n=e.c,r=e.b,e.a?(t.ma(e.c,null,e.a,e.b),_t()):t.Fa(n,r)?(i=t,o=(e=e).b,a=e.c,i.Fa(a,o)(e.g,e.f,e.S(),e.i).then(function(e){i.ma(a,e,null,o)}).o(function(e){i.ma(a,null,e,o)})):wt(new T("invalid-auth-event"))):wt(new T("invalid-auth-event"))},Kc.prototype.confirm=function(e){return e=Ao(this.verificationId,e),this.a(e)};var Gc="mfaInfo",Qc="mfaPendingCredential";function Yc(e,t,n,r){T.call(this,"multi-factor-auth-required",r,t),this.b=new Hc(e,t,n),jr(this,"resolver",this.b)}function Xc(e,t,n){if(e&&y(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new Yc(t,e.serverResponse,n,e.message)}catch(e){}return null}function Jc(){}function $c(e){jr(this,"factorId",e.fa),this.a=e}function Zc(e){if($c.call(this,e),this.a.fa!=ko.PROVIDER_ID)throw new T("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function el(e,t){for(var n in Vt.call(this,e),t)this[n]=t[n]}function tl(e,t){this.a=e,this.b=[],this.c=v(this.xc,this),Zt(this.a,"userReloaded",this.c);var r=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&j(t.multiFactor.enrolledFactors,function(e){var t=null,n={};if(e){e.uid&&(n[Qr]=e.uid),e.displayName&&(n[Hr]=e.displayName),e.enrollmentTime&&(n[Gr]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(n[Yr]=e.phoneNumber);try{t=new Xr(n)}catch(e){}e=t}else e=null;e&&r.push(e)}),nl(this,r)}function nl(e,t){e.b=t,jr(e,"enrolledFactors",t)}function rl(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function il(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}function ol(e){this.c=e,this.b=this.a=null}function al(e){return e.b&&1e3*e.b.c||0}function sl(e,t){var n=t.refreshToken;e.b=xi(t[Ka]||""),e.a=n}function ul(t,e){return r=t.c,i=e,new pt(function(t,n){"refresh_token"==i.grant_type&&i.refresh_token||"authorization_code"==i.grant_type&&i.code?$a(r,r.l+"?key="+encodeURIComponent(r.c),function(e){e?e.error?n(Xs(e)):e.access_token&&e.refresh_token?t(e):n(new T("internal-error")):n(new T("network-request-failed"))},"POST",Bn(i).toString(),r.g,r.v.get()):n(new T("internal-error"))}).then(function(e){return t.b=xi(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}}).o(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e});var r,i}function cl(e,t){this.a=e||null,this.b=t||null,Vr(this,{lastSignInTime:xr(t||null),creationTime:xr(e||null)})}function ll(e,t,n,r,i,o){Vr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function hl(e,t,n){this.G=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var r,i=Jh.SDK_VERSION?mr(Jh.SDK_VERSION):null;this.a=new Va(this.l,N(S),i),e.emulatorConfig&&Ya(this.a,e.emulatorConfig),this.b=new ol(this.a),bl(this,t[Ka]),sl(this.b,t),jr(this,"refreshToken",this.b.a),El(this,n||{}),fn.call(this),this.P=!1,this.s&&wr()&&(this.i=Lc(this.s,this.l,this.m)),this.R=[],this.f=null,this.u=(r=this,new rl(function(){return r.I(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var e=al(r.b)-_()-3e5;return 0<e?e:0})),this.$=v(this.gb,this);var o=this;this.pa=null,this.Ba=function(e){o.wa(e.h)},this.ba=null,this.za=function(e){Ya(o.a,e.c)},this.W=null,this.X=[],this.Aa=function(e){dl(o,e.f)},this.aa=null,this.N=new tl(this,n),jr(this,"multiFactor",this.N)}function fl(e,t){e.ba&&nn(e.ba,"languageCodeChanged",e.Ba),(e.ba=t)&&Zt(t,"languageCodeChanged",e.Ba)}function pl(e,t){e.W&&nn(e.W,"emulatorConfigChanged",e.za),(e.W=t)&&Zt(t,"emulatorConfigChanged",e.za)}function dl(e,t){e.X=t,Ja(e.a,Jh.SDK_VERSION?mr(Jh.SDK_VERSION,e.X):null)}function gl(e,t){e.aa&&nn(e.aa,"frameworkChanged",e.Aa),(e.aa=t)&&Zt(t,"frameworkChanged",e.Aa)}function yl(t){try{return Jh.app(t.m).auth()}catch(e){throw new T("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function ml(e){e.A||e.u.b||(e.u.start(),nn(e,"tokenChanged",e.$),Zt(e,"tokenChanged",e.$))}function vl(e){nn(e,"tokenChanged",e.$),e.u.stop()}function bl(e,t){e.ya=t,jr(e,"_lat",t)}function _l(e){for(var t=[],n=0;n<e.R.length;n++)t.push(e.R[n](e));return Tt(t).then(function(){return e})}function wl(e){e.i&&!e.P&&(e.P=!0,Sc(e.i,e))}function El(e,t){Vr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new cl(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function Tl(){}function Il(e){return _t().then(function(){if(e.A)throw new T("app-deleted")})}function Sl(e){return B(e.providerData,function(e){return e.providerId})}function Cl(e,t){t&&(kl(e,t.providerId),e.providerData.push(t))}function kl(e,t){H(e.providerData,function(e){return e.providerId==t})}function Al(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&jr(e,t,n)}function Nl(t,e){var n,r;t!=e&&(Vr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?jr(t,"metadata",new cl((r=e.metadata).a,r.b)):jr(t,"metadata",new cl),j(e.providerData,function(e){Cl(t,e)}),n=t.b,r=e.b,n.b=r.b,n.a=r.a,jr(t,"refreshToken",t.b.a),nl(t.N,e.N.b))}function Dl(i){return i.I().then(function(e){var t,n,r=i.isAnonymous;return n=e,Qs((t=i).a,Ss,{idToken:n}).then(v(t.Jc,t)).then(function(){return r||Al(i,"isAnonymous",!1),e})})}function Rl(e,t){t[Ka]&&e.ya!=t[Ka]&&(sl(e.b,t),e.dispatchEvent(new el("tokenChanged")),bl(e,t[Ka]),Al(e,"refreshToken",e.b.a))}function Ol(e,t){return Dl(e).then(function(){if(W(Sl(e),t))return _l(e).then(function(){throw new T("provider-already-linked")})})}function Pl(e,t,n){return Br({user:e,credential:No(t),additionalUserInfo:t=ji(t),operationType:n})}function xl(e,t){return Rl(e,t),e.reload().then(function(){return e})}function Ll(n,r,e,t,i){if(!wr())return wt(new T("operation-not-supported-in-this-environment"));if(n.f&&!i)return wt(n.f);var o=qi(e.providerId),a=Ar(n.uid+":::"),s=null;(!Ir()||cr())&&n.s&&e.isOAuthProvider&&(s=cu(n.s,n.l,n.m,r,e,null,a,Jh.SDK_VERSION||null,null,null,n.tenantId));var u=ir(s,o&&o.ua,o&&o.ta);return t=t().then(function(){if(Fl(n),!i)return n.I().then(function(){})}).then(function(){return Nc(n.i,u,r,e,a,!!s,n.tenantId)}).then(function(){return new pt(function(e,t){n.ma(r,null,new T("cancelled-popup-request"),n.h||null),n.g=e,n.O=t,n.h=a,n.c=Oc(n.i,n,r,u,a)})}).then(function(e){return u&&rr(u),e?Br(e):null}).o(function(e){throw u&&rr(u),e}),Ul(n,t,i)}function Ml(t,e,n,r,i){if(!wr())return wt(new T("operation-not-supported-in-this-environment"));if(t.f&&!i)return wt(t.f);var o=null,a=Ar(t.uid+":::");return r=r().then(function(){if(Fl(t),!i)return t.I().then(function(){})}).then(function(){return t.ga=a,_l(t)}).then(function(e){return t.ha&&(e=(e=t.ha).b.set(Vl,t.w(),e.a)),e}).then(function(){return Rc(t.i,e,n,a,t.tenantId)}).o(function(e){if(o=e,t.ha)return Bl(t.ha);throw o}).then(function(){if(o)throw o}),Ul(t,r,i)}function Fl(e){if(!e.i||!e.P){if(e.i&&!e.P)throw new T("internal-error");throw new T("auth-domain-config-required")}}function Ul(n,e,t){var r,i=(e=e,t=t,(r=n).f&&!t?(e.cancel(),wt(r.f)):e.o(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(r.f||r.dispatchEvent(new el("userInvalidated")),r.f=e),e}));return n.G.push(i),i.na(function(){z(n.G,i)}),i.o(function(e){var t=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(t=Xc(e.w(),yl(n),v(n.ic,n))),t||e})}function ql(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[Ka]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=new hl(t,n,e);return e.providerData&&j(e.providerData,function(e){e&&Cl(r,Br(e))}),e.redirectEventId&&(r.ga=e.redirectEventId),r}function jl(e){this.a=e,this.b=Hu()}Hc.prototype.Qc=function(e){var n=this;return e.rb(this.a.a,this.c).then(function(e){var t=le(n.f);return delete t[Gc],delete t[Qc],fe(t,e),n.g(t)})},w(Yc,T),Jc.prototype.rb=function(e,t,n){return t.type==Ji?(o=this,a=e,s=n,t.Ha().then(function(e){return e={idToken:e},void 0!==s&&(e.displayName=s),fe(e,{phoneVerificationInfo:Co(o.a)}),Qs(a,Ts,e)})):(r=this,i=e,t.Ha().then(function(e){return fe(e={mfaPendingCredential:e},{phoneVerificationInfo:Co(r.a)}),Qs(i,Is,e)}));var r,i,o,a,s},w($c,Jc),w(Zc,$c),w(el,Vt),(e=tl.prototype).xc=function(e){var t;nl(this,(e=e.gd,t=[],j(e.mfaInfo||[],function(e){(e=zr(e))&&t.push(e)}),t))},e.Qb=function(){return this.a.I().then(function(e){return new Xi(e,null)})},e.ec=function(t,n){var r=this,i=this.a.a;return this.Qb().then(function(e){return t.rb(i,e,n)}).then(function(e){return Rl(r.a,e),r.a.reload()})},e.ad=function(e){var n=this,r="string"==typeof e?e:e.uid,t=this.a.a;return this.a.I().then(function(e){return Qs(t,Gs,{idToken:e,mfaEnrollmentId:r})}).then(function(e){var t=V(n.b,function(e){return e.uid!=r});return nl(n,t),Rl(n.a,e),n.a.reload().o(function(e){if("auth/user-token-expired"!=e.code)throw e})})},e.w=function(){return{multiFactor:{enrolledFactors:B(this.b,function(e){return e.w()})}}},rl.prototype.start=function(){this.a=this.c,function t(n,e){n.stop();n.b=mn(il(n,e)).then(function(){return t=h.document,n=null,Or()||!t?_t():new pt(function(e){n=function(){Or()&&(t.removeEventListener("visibilitychange",n,!1),e())},t.addEventListener("visibilitychange",n,!1)}).o(function(e){throw t.removeEventListener("visibilitychange",n,!1),e});var t,n}).then(function(){return n.h()}).then(function(){t(n,!0)}).o(function(e){n.i(e)&&t(n,!1)})}(this,!0)},rl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ol.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:al(this)}},ol.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?wt(new T("user-token-expired")):e||!this.b||_()>al(this)-3e4?this.a?ul(this,{grant_type:"refresh_token",refresh_token:this.a}):_t(null):_t({accessToken:this.b.toString(),refreshToken:this.a})},cl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},w(hl,fn),hl.prototype.wa=function(e){this.pa=e,Qa(this.a,e)},hl.prototype.ka=function(){return this.pa},hl.prototype.Ga=function(){return Q(this.X)},hl.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},jr(hl.prototype,"providerId","firebase"),(e=hl.prototype).reload=function(){var e=this;return Ul(this,Il(this).then(function(){return Dl(e).then(function(){return _l(e)}).then(Tl)}))},e.nc=function(e){return this.I(e).then(function(e){return new zc(e)})},e.I=function(e){var t=this;return Ul(this,Il(this).then(function(){return t.b.getToken(e)}).then(function(e){if(!e)throw new T("internal-error");return e.accessToken!=t.ya&&(bl(t,e.accessToken),t.dispatchEvent(new el("tokenChanged"))),Al(t,"refreshToken",e.refreshToken),e.accessToken}))},e.Jc=function(e){if(!(e=e.users)||!e.length)throw new T("internal-error");El(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t,n=(t=(t=e).providerUserInfo)&&t.length?B(t,function(e){return new ll(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[],r=0;r<n.length;r++)Cl(this,n[r]);Al(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new el("userReloaded",{gd:e}))},e.Kc=function(e){return Ur("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(e)},e.sb=function(e){var t=this,n=null;return Ul(this,e.c(this.a,this.uid).then(function(e){return Rl(t,e),n=Pl(t,e,"reauthenticate"),t.f=null,t.reload()}).then(function(){return n}),!0)},e.Bc=function(e){return Ur("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(e)},e.pb=function(t){var n=this,r=null;return Ul(this,Ol(this,t.providerId).then(function(){return n.I()}).then(function(e){return t.b(n.a,e)}).then(function(e){return r=Pl(n,e,"link"),xl(n,e)}).then(function(){return r}))},e.Cc=function(e,t){var n=this;return Ul(this,Ol(this,"phone").then(function(){return Wc(yl(n),e,t,v(n.pb,n))}))},e.Lc=function(e,t){var n=this;return Ul(this,_t().then(function(){return Wc(yl(n),e,t,v(n.sb,n))}),!0)},e.Ab=function(t){var n=this;return Ul(this,this.I().then(function(e){return n.a.Ab(e,t)}).then(function(e){return Rl(n,e),n.reload()}))},e.dd=function(t){var n=this;return Ul(this,this.I().then(function(e){return t.b(n.a,e)}).then(function(e){return Rl(n,e),n.reload()}))},e.Bb=function(t){var n=this;return Ul(this,this.I().then(function(e){return n.a.Bb(e,t)}).then(function(e){return Rl(n,e),n.reload()}))},e.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Il(this);var n=this;return Ul(this,this.I().then(function(e){return n.a.Cb(e,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(e){return Rl(n,e),Al(n,"displayName",e.displayName||null),Al(n,"photoURL",e.photoUrl||null),j(n.providerData,function(e){"password"===e.providerId&&(jr(e,"displayName",n.displayName),jr(e,"photoURL",n.photoURL))}),_l(n)}).then(Tl))},e.bd=function(t){var n=this;return Ul(this,Dl(this).then(function(e){return W(Sl(n),t)?Qs(n.a,_s,{idToken:e,deleteProvider:[t]}).then(function(e){var t={};return j(e.providerUserInfo||[],function(e){t[e.providerId]=!0}),j(Sl(n),function(e){t[e]||kl(n,e)}),t[ko.PROVIDER_ID]||jr(n,"phoneNumber",null),_l(n)}):_l(n).then(function(){throw new T("no-such-provider")})}))},e.delete=function(){var t=this;return Ul(this,this.I().then(function(e){return Qs(t.a,bs,{idToken:e})}).then(function(){t.dispatchEvent(new el("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");fl(t,null),pl(t,null),gl(t,null),t.G=[],t.A=!0,vl(t),jr(t,"refreshToken",null),t.i&&Cc(t.i,t)})},e.Eb=function(e,t){return!!("linkViaPopup"==e&&(this.h||null)==t&&this.g||"reauthViaPopup"==e&&(this.h||null)==t&&this.g||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},e.ma=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.h||null)||(n&&this.O?this.O(n):t&&!n&&this.g&&this.g(t),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.h||null)?v(this.Jb,this):"reauthViaPopup"==e&&t==(this.h||null)?v(this.Kb,this):"linkViaRedirect"==e&&(this.ga||null)==t?v(this.Jb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?v(this.Kb,this):null},e.Dc=function(e){var t=this;return Ll(this,"linkViaPopup",e,function(){return Ol(t,e.providerId).then(function(){return _l(t)})},!1)},e.Mc=function(e){return Ll(this,"reauthViaPopup",e,function(){return _t()},!0)},e.Ec=function(e){var t=this;return Ml(this,"linkViaRedirect",e,function(){return Ol(t,e.providerId)},!1)},e.Nc=function(e){return Ml(this,"reauthViaRedirect",e,function(){return _t()},!0)},e.Jb=function(t,n,e,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return e=this.I().then(function(e){return fs(i.a,{requestUri:t,postBody:r,sessionId:n,idToken:e})}).then(function(e){return o=Pl(i,e,"link"),xl(i,e)}).then(function(){return o}),Ul(this,e)},e.Kb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Ul(this,_t().then(function(){return eo(ps(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)}).then(function(e){return o=Pl(i,e,"reauthenticate"),Rl(i,e),i.f=null,i.reload()}).then(function(){return o}),!0)},e.tb=function(t){var n=this,r=null;return Ul(this,this.I().then(function(e){return r=e,void 0===t||ce(t)?{}:Di(new _i(t))}).then(function(e){return n.a.tb(r,e)}).then(function(e){if(n.email!=e)return n.reload()}).then(function(){}))},e.Db=function(t,n){var r=this,i=null;return Ul(this,this.I().then(function(e){return i=e,void 0===n||ce(n)?{}:Di(new _i(n))}).then(function(e){return r.a.Db(i,t,e)}).then(function(e){if(r.email!=e)return r.reload()}).then(function(){}))},e.ic=function(e){var t=null,n=this;return Ul(this,e=eo(_t(e),n.uid).then(function(e){return t=Pl(n,e,"reauthenticate"),Rl(n,e),n.f=null,n.reload()}).then(function(){return t}),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&fe(t,this.metadata.w()),j(this.providerData,function(e){t.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(e))}),fe(t,this.N.w()),t};var Vl={name:"redirectUser",D:"session"};function Bl(e){return Yu(e.b,Vl,e.a)}function Kl(e){var t,n,r,i;this.a=e,this.b=Hu(),this.c=null,this.f=(n=Hl("local"),r=Hl("session"),i=Hl("none"),function(n,r,i){var o=Qu(r,i),a=Gu(n,r.D);return n.get(r,i).then(function(e){var t=null;try{t=kr(h.localStorage.getItem(o))}catch(e){}if(t&&!e)return h.localStorage.removeItem(o),n.set(r,t,i);t&&e&&"localStorage"!=a.type&&h.localStorage.removeItem(o)})}((t=this).b,n,t.a).then(function(){return t.b.get(r,t.a)}).then(function(e){return e?r:t.b.get(i,t.a).then(function(e){return e?i:t.b.get(n,t.a).then(function(e){return e?n:t.b.get(zl,t.a).then(function(e){return e?Hl(e):n})})})}).then(function(e){return t.c=e,Wl(t,e.D)}).o(function(){t.c||(t.c=n)})),this.b.addListener(Hl("local"),this.a,v(this.g,this))}function Wl(e,t){var n,s,r=[];for(n in Wu)Wu[n]!==t&&r.push(Yu(e.b,Hl(Wu[n]),e.a));return r.push(Yu(e.b,zl,e.a)),s=r,new pt(function(n,t){var r=s.length,i=[];if(r)for(var e=function(e,t){r--,i[e]=t,0==r&&n(i)},o=function(e){t(e)},a=0;a<s.length;a++)Et(s[a],b(e,a),o);else n(i)})}Kl.prototype.g=function(){var t=this,n=Hl("local");Xl(this,function(){return _t().then(function(){return t.c&&"local"!=t.c.D?t.b.get(n,t.a):null}).then(function(e){if(e)return Wl(t,"local").then(function(){t.c=n})})})};var zl={name:"persistence",D:"session"};function Hl(e){return{name:"authUser",D:e}}function Gl(e,t){return Xl(e,function(){return e.b.set(e.c,t.w(),e.a)})}function Ql(e){return Xl(e,function(){return Yu(e.b,e.c,e.a)})}function Yl(e,t,n){return Xl(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),ql(e||{})})})}function Xl(e,t){return e.f=e.f.then(t,t),e.f}function Jl(e){if(this.m=!1,jr(this,"settings",new Bc),jr(this,"app",e),!this.app.options||!this.app.options.apiKey)throw new T("invalid-api-key");var n,t,r,i,o,a;e=Jh.SDK_VERSION?mr(Jh.SDK_VERSION):null,this.a=new Va(this.app.options&&this.app.options.apiKey,N(S),e),this.R=[],this.u=[],this.P=[],this.ac=Jh.INTERNAL.createSubscribe(v(this.yc,this)),this.X=void 0,this.bc=Jh.INTERNAL.createSubscribe(v(this.zc,this)),ih(this,null),this.l=new Kl(this.app.options.apiKey+":"+this.app.name),this.G=new jl(this.app.options.apiKey+":"+this.app.name),this.$=ch(this,(t=(n=this).app.options.authDomain,e=function(t){var e=function(e,t){return e.b.get(Vl,e.a).then(function(e){return e&&t&&(e.authDomain=t),ql(e||{})})}(t.G,t.app.options.authDomain).then(function(e){return(t.s=e)&&(e.ha=t.G),Bl(t.G)});return ch(t,e)}(n).then(function(){return Yl(n.l,t,n.f)}).then(function(t){return t?(t.ha=n.G,n.s&&(n.s.ga||null)==(t.ga||null)?t:t.reload().then(function(){return Gl(n.l,t).then(function(){return t})}).o(function(e){return"auth/network-request-failed"==e.code?t:Ql(n.l)})):null}).then(function(e){ih(n,e||null)}),ch(n,e))),this.i=ch(this,(r=this).$.then(function(){return nh(r)}).o(function(){}).then(function(){if(!r.m)return r.pa()}).o(function(){}).then(function(){var e;r.m||(r.ba=!0,(e=r.l).b.addListener(Hl("local"),e.a,r.pa))})),this.ba=!1,this.pa=v(this.Yc,this),this.Ba=v(this.da,this),this.ya=v(this.kc,this),this.za=v(this.vc,this),this.Aa=v(this.wc,this),this.b=null,o=(i=this).app.options.authDomain,a=i.app.options.apiKey,o&&wr()&&(i.gb=i.$.then(function(){var e;if(!i.m)return i.b=Lc(o,a,i.app.name,i.f),Sc(i.b,i),ah(i)&&wl(ah(i)),i.s&&(wl(i.s),(e=i.s).wa(i.ka()),fl(e,i),dl(e=i.s,i.N),gl(e,i),Ya((e=i.s).a,i.f),pl(e,i),i.s=null),i.b})),this.INTERNAL={},this.INTERNAL.delete=v(this.delete,this),this.INTERNAL.logFramework=v(this.Fc,this),this.A=0,fn.call(this),e=this,Object.defineProperty(e,"lc",{get:function(){return this.ka()},set:function(e){this.wa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.S()},set:function(e){this.xb(e)},enumerable:!1}),e.W=null,this.N=[],this.f=null}function $l(e){Vt.call(this,"languageCodeChanged"),this.h=e}function Zl(e){Vt.call(this,"emulatorConfigChanged"),this.c=e}function eh(e){Vt.call(this,"frameworkChanged"),this.f=e}function th(e){return e.gb||wt(new T("auth-domain-config-required"))}function nh(e){if(!wr())return wt(new T("operation-not-supported-in-this-environment"));var t=th(e).then(function(){return e.b.qa()}).then(function(e){return e?Br(e):null});return ch(e,t)}function rh(o,a){var s={};return s.apiKey=o.app.options.apiKey,s.authDomain=o.app.options.authDomain,s.appName=o.app.name,o.f&&(s.emulatorConfig=o.f),o.$.then(function(){return e=s,t=a,n=o.G,r=o.Ga(),i=new hl(e,t),n&&(i.ha=n),r&&dl(i,r),i.reload().then(function(){return i});var e,t,n,r,i}).then(function(e){return ah(o)&&e.uid==ah(o).uid?Nl(ah(o),e):(ih(o,e),wl(e)),o.da(e)}).then(function(){uh(o)})}function ih(e,t){var n,r;ah(e)&&(n=ah(e),r=e.Ba,H(n.R,function(e){return e==r}),nn(ah(e),"tokenChanged",e.ya),nn(ah(e),"userDeleted",e.za),nn(ah(e),"userInvalidated",e.Aa),vl(ah(e))),t&&(t.R.push(e.Ba),Zt(t,"tokenChanged",e.ya),Zt(t,"userDeleted",e.za),Zt(t,"userInvalidated",e.Aa),0<e.A&&ml(t)),jr(e,"currentUser",t),t&&(t.wa(e.ka()),fl(t,e),dl(t,e.N),gl(t,e),Ya(t.a,e.f),pl(t,e))}function oh(n,e){var t=null,r=null;return ch(n,e.then(function(e){return t=No(e),r=ji(e),rh(n,e)},function(e){var t=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(t=Xc(e.w(),n,v(n.jc,n))),t||e}).then(function(){return Br({user:ah(n),credential:t,additionalUserInfo:r,operationType:"signIn"})}))}function ah(e){return e.currentUser}function sh(e){return ah(e)&&ah(e)._lat||null}function uh(e){if(e.ba){for(var t=0;t<e.u.length;t++)e.u[t]&&e.u[t](sh(e));if(e.X!==e.getUid()&&e.P.length)for(e.X=e.getUid(),t=0;t<e.P.length;t++)e.P[t]&&e.P[t](sh(e))}}function ch(e,t){return e.R.push(t),t.na(function(){z(e.R,t)}),t}function lh(){}function hh(){this.a={},this.b=1e12}Kl.prototype.wb=function(t){var n=null,r=this;return function(e){var t=new T("invalid-persistence-type"),n=new T("unsupported-persistence-type");e:{for(r in Wu)if(Wu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(hr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!Tu()&&"none"!==e)throw n;break;default:if(!_r()&&"none"!==e)throw n}}(t),Xl(this,function(){return t!=r.c.D?r.b.get(r.c,r.a).then(function(e){return n=e,Wl(r,t)}).then(function(){if(r.c=Hl(t),n)return r.b.set(r.c,n,r.a)}):_t()})},w(Jl,fn),w($l,Vt),w(Zl,Vt),w(eh,Vt),(e=Jl.prototype).wb=function(e){return e=this.l.wb(e),ch(this,e)},e.wa=function(e){this.aa===e||this.m||(this.aa=e,Qa(this.a,this.aa),this.dispatchEvent(new $l(this.ka())))},e.ka=function(){return this.aa},e.ed=function(){var e=h.navigator;this.wa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.fd=function(e){if(!this.f){if(!/^https?:\/\//.test(e))throw new T("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Pr("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),h.document&&sr().then(function(){var e=h.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#ff0000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),h.document.body.appendChild(e)}),this.f={url:e},this.settings.hb=!0,Ya(this.a,this.f),this.dispatchEvent(new Zl(this.f))}},e.Fc=function(e){this.N.push(e),Ja(this.a,Jh.SDK_VERSION?mr(Jh.SDK_VERSION,this.N):null),this.dispatchEvent(new eh(this.N))},e.Ga=function(){return Q(this.N)},e.xb=function(e){this.W===e||this.m||(this.W=e,this.a.b=this.W)},e.S=function(){return this.W},e.toJSON=function(){return{apiKey:this.app.options.apiKey,authDomain:this.app.options.authDomain,appName:this.app.name,currentUser:ah(this)&&ah(this).w()}},e.Eb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==t&&!!this.g;default:return!1}},e.ma=function(e,t,n,r){"signInViaPopup"==e&&this.h==r&&(n&&this.O?this.O(n):t&&!n&&this.g&&this.g(t),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.h==t&&this.g?v(this.hc,this):null},e.hc=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then(function(){return oh(i,hs(i.a,o))})},e.Wc=function(t){if(!wr())return wt(new T("operation-not-supported-in-this-environment"));var n=this,e=qi(t.providerId),r=Ar(),i=null;(!Ir()||cr())&&this.app.options.authDomain&&t.isOAuthProvider&&(i=cu(this.app.options.authDomain,this.app.options.apiKey,this.app.name,"signInViaPopup",t,null,r,Jh.SDK_VERSION||null,null,null,this.S(),this.f));var o=ir(i,e&&e.ua,e&&e.ta);return ch(this,e=th(this).then(function(e){return Nc(e,o,"signInViaPopup",t,r,!!i,n.S())}).then(function(){return new pt(function(e,t){n.ma("signInViaPopup",null,new T("cancelled-popup-request"),n.h),n.g=e,n.O=t,n.h=r,n.c=Oc(n.b,n,"signInViaPopup",o,r)})}).then(function(e){return o&&rr(o),e?Br(e):null}).o(function(e){throw o&&rr(o),e}))},e.Xc=function(e){if(!wr())return wt(new T("operation-not-supported-in-this-environment"));var t=this;return ch(this,th(this).then(function(){return Xl(e=t.l,function(){return e.b.set(zl,e.c.D,e.a)});var e}).then(function(){return Rc(t.b,"signInViaRedirect",e,void 0,t.S())}))},e.qa=function(){var t=this;return nh(this).then(function(e){return t.b&&Uc(t.b.b),e}).o(function(e){throw t.b&&Uc(t.b.b),e})},e.cd=function(e){if(!e)return wt(new T("null-user"));if(this.W!=e.tenantId)return wt(new T("tenant-id-mismatch"));var t=this,n={};n.apiKey=this.app.options.apiKey,n.authDomain=this.app.options.authDomain,n.appName=this.app.name;var r,i,o,a,s,u=(r=e,i=n,o=t.G,a=t.Ga(),s=r.b,(n={})[Ka]=s.b&&s.b.toString(),n.refreshToken=s.a,i=new hl(i||{apiKey:r.l,authDomain:r.s,appName:r.m},n),o&&(i.ha=o),a&&dl(i,a),Nl(i,r),i);return ch(this,this.i.then(function(){if(t.app.options.apiKey!=e.l)return u.reload()}).then(function(){return ah(t)&&e.uid==ah(t).uid?(Nl(ah(t),e),t.da(e)):(ih(t,u),wl(u),t.da(u))}).then(function(){uh(t)}))},e.zb=function(){var e=this,t=this.i.then(function(){return e.b&&Uc(e.b.b),ah(e)?(ih(e,null),Ql(e.l).then(function(){uh(e)})):_t()});return ch(this,t)},e.Yc=function(){var r=this;return Yl(this.l,this.app.options.authDomain).then(function(e){if(!r.m){var t,n;if((n=ah(r)&&e)&&(n=ah(r).uid,t=e.uid,n=null!=n&&""!==n&&null!=t&&""!==t&&n==t),n)return Nl(ah(r),e),ah(r).I();(ah(r)||e)&&(ih(r,e),e&&(wl(e),e.ha=r.G),r.b&&Sc(r.b,r),uh(r))}})},e.da=function(e){return Gl(this.l,e)},e.kc=function(){uh(this),this.da(ah(this))},e.vc=function(){this.zb()},e.wc=function(){this.zb()},e.jc=function(e){var t=this;return this.i.then(function(){return oh(t,_t(e))})},e.yc=function(e){var t=this;this.addAuthTokenListener(function(){e.next(ah(t))})},e.zc=function(e){var t,n,r=this;n=function(){e.next(ah(r))},(t=this).P.push(n),ch(t,t.i.then(function(){!t.m&&W(t.P,n)&&t.X!==t.getUid()&&(t.X=t.getUid(),n(sh(t)))}))},e.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof e?e(ah(r)):"function"==typeof e.next&&e.next(ah(r))}),this.ac(e,t,n)},e.Gc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){r.X=r.getUid(),"function"==typeof e?e(ah(r)):"function"==typeof e.next&&e.next(ah(r))}),this.bc(e,t,n)},e.mc=function(e){var t=this,n=this.i.then(function(){return ah(t)?ah(t).I(e).then(function(e){return{accessToken:e}}):null});return ch(this,n)},e.Sc=function(e){var n=this;return this.i.then(function(){return oh(n,Qs(n.a,Bs,{token:e}))}).then(function(e){var t=e.user;return Al(t,"isAnonymous",!1),n.da(t),e})},e.Tc=function(e,t){var n=this;return this.i.then(function(){return oh(n,Qs(n.a,Ks,{email:e,password:t}))})},e.dc=function(e,t){var n=this;return this.i.then(function(){return oh(n,Qs(n.a,ms,{email:e,password:t}))})},e.Za=function(e){var t=this;return this.i.then(function(){return oh(t,e.ja(t.a))})},e.Rc=function(e){return Ur("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(e)},e.yb=function(){var n=this;return this.i.then(function(){var e=ah(n);if(e&&e.isAnonymous){var t=Br({providerId:null,isNewUser:!1});return Br({user:e,credential:null,additionalUserInfo:t,operationType:"signIn"})}return oh(n,n.a.yb()).then(function(e){var t=e.user;return Al(t,"isAnonymous",!0),n.da(t),e})})},e.getUid=function(){return ah(this)&&ah(this).uid||null},e.cc=function(e){this.addAuthTokenListener(e),this.A++,0<this.A&&ah(this)&&ml(ah(this))},e.Oc=function(t){var n=this;j(this.u,function(e){e==t&&n.A--}),this.A<0&&(this.A=0),0==this.A&&ah(this)&&vl(ah(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(e){var t=this;this.u.push(e),ch(this,this.i.then(function(){t.m||W(t.u,e)&&e(sh(t))}))},e.removeAuthTokenListener=function(t){H(this.u,function(e){return e==t})},e.delete=function(){this.m=!0;for(var e=0;e<this.R.length;e++)this.R[e].cancel("app-deleted");return this.R=[],this.l&&(e=this.l).b.removeListener(Hl("local"),e.a,this.pa),this.b&&(Cc(this.b,this),Uc(this.b.b)),Promise.resolve()},e.gc=function(e){return ch(this,Qs(this.a,vs,{identifier:e,continueUri:Er()?er():"http://localhost"}).then(function(e){return e.signinMethods||[]}))},e.Ac=function(e){return!!To(e)},e.vb=function(t,n){var r=this;return ch(this,_t().then(function(){var e=new _i(n);if(!e.c)throw new T("argument-error",Ti+" must be true when sending sign in link to email");return Di(e)}).then(function(e){return r.a.vb(t,e)}).then(function(){}))},e.hd=function(e){return this.Qa(e).then(function(e){return e.data.email})},e.mb=function(e,t){return ch(this,this.a.mb(e,t).then(function(){}))},e.Qa=function(e){return ch(this,this.a.Qa(e).then(function(e){return new Jr(e)}))},e.ib=function(e){return ch(this,this.a.ib(e).then(function(){}))},e.ub=function(t,e){var n=this;return ch(this,_t().then(function(){return void 0===e||ce(e)?{}:Di(new _i(e))}).then(function(e){return n.a.ub(t,e)}).then(function(){}))},e.Vc=function(e,t){return ch(this,Wc(this,e,t,v(this.Za,this)))},e.Uc=function(n,r){var i=this;return ch(this,_t().then(function(){var e=r||er(),t=Eo(n,e);if(!(e=To(e)))throw new T("argument-error","Invalid email link!");if(e.tenantId!==i.S())throw new T("tenant-id-mismatch");return i.Za(t)}))},lh.prototype.render=function(){},lh.prototype.reset=function(){},lh.prototype.getResponse=function(){},lh.prototype.execute=function(){};var fh=null;function ph(e,t){return(t=dh(t))&&e.a[t]||null}function dh(e){return(e=void 0===e?1e12:e)?e.toString():null}function gh(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=tt(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():Zt(this.f,"click",this.i)}function yh(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function mh(){}function vh(){}hh.prototype.render=function(e,t){return this.a[this.b.toString()]=new gh(e,t),this.b++},hh.prototype.reset=function(e){var t=ph(this,e);e=dh(e),t&&e&&(t.delete(),delete this.a[e])},hh.prototype.getResponse=function(e){return(e=ph(this,e))?e.getResponse():null},hh.prototype.execute=function(e){(e=ph(this,e))&&e.execute()},gh.prototype.getResponse=function(){return yh(this),this.b},gh.prototype.execute=function(){yh(this);var n=this;this.a||(this.a=setTimeout(function(){n.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var e=n.c.callback,t=n.c["expired-callback"];if(e)try{e(n.b)}catch(e){}n.a=setTimeout(function(){if(n.a=null,n.b=null,t)try{t()}catch(e){}n.h&&n.execute()},6e4)},500))},gh.prototype.delete=function(){yh(this),this.g=!0,clearTimeout(this.a),this.a=null,nn(this.f,"click",this.i)},jr(mh,"FACTOR_ID","phone"),vh.prototype.g=function(){return _t(fh=fh||new hh)},vh.prototype.c=function(){};var bh=null;function _h(){this.b=h.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var wh=new de(ve,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Eh=new Rr(3e4,6e4);_h.prototype.g=function(i){var o=this;return new pt(function(e,t){var r=setTimeout(function(){t(new T("network-request-failed"))},Eh.get());!h.grecaptcha||i!==o.f&&!o.b?(h[o.a]=function(){var n;h.grecaptcha?(o.f=i,n=h.grecaptcha.render,h.grecaptcha.render=function(e,t){return e=n(e,t),o.b++,e},clearTimeout(r),e(h.grecaptcha)):(clearTimeout(r),t(new T("internal-error"))),delete h[o.a]},_t(xa(Ee(wh,{onload:o.a,hl:i||""}))).o(function(){clearTimeout(r),t(new T("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),e(h.grecaptcha))})},_h.prototype.c=function(){this.b--};var Th=null;function Ih(e,t,n,r,i,o,a){if(jr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=t,this.g=null,a=a?bh=bh||new vh:Th=Th||new _h,this.v=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[kh])throw new T("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ah],!h.document)throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!tt(t)||!this.i&&tt(t).hasChildNodes())throw new T("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Va(e,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var u=this.a[Sh];this.a[Sh]=function(e){var t;Nh(s,e),"function"==typeof u?u(e):"string"!=typeof u||"function"==typeof(t=br(u,h))&&t(e)};var c=this.a[Ch];this.a[Ch]=function(){var e;Nh(s,null),"function"==typeof c?c():"string"!=typeof c||"function"==typeof(e=br(c,h))&&e()}}var Sh="callback",Ch="expired-callback",kh="sitekey",Ah="size";function Nh(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(e){}}function Dh(e,t){return e.h.push(t),t.na(function(){z(e.h,t)}),t}function Rh(e){if(e.A)throw new T("internal-error","RecaptchaVerifier instance has been destroyed.")}function Oh(e,t,n){var r=!1;try{this.b=n||Jh.app()}catch(e){throw new T("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new T("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(e){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}o=Jh.SDK_VERSION?mr(Jh.SDK_VERSION,o):null,Ih.call(this,n,e,t,function(){try{var t=i.b.auth().ka()}catch(e){t=null}return t},o,N(S),r)}function Ph(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new T("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].K(n[i])&&!o){if(t=t[i],i<0||i>=xh.length)throw new T("internal-error","Argument validator received an unsupported number of arguments.");n=xh[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.J+".";break e}r=null}}if(r)throw new T("argument-error",e+" failed: "+r)}(e=Ih.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Dh(this,_t().then(function(){if(Er()&&!lr())return sr();throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.v.g(t.u())}).then(function(e){return t.g=e,Qs(t.s,Rs,{})}).then(function(e){t.a[kh]=e.recaptchaSiteKey}).o(function(e){throw t.f=null,e}))},e.render=function(){Rh(this);var n=this;return Dh(this,this.Ia().then(function(){var e,t;return null===n.c&&(t=n.m,n.i||(e=tt(t),t=at("DIV"),e.appendChild(t)),n.c=n.g.render(t,n.a)),n.c}))},e.verify=function(){Rh(this);var i=this;return Dh(this,this.render().then(function(t){return new pt(function(n){var r,e=i.g.getResponse(t);e?n(e):(r=function(e){var t;e&&(t=r,H(i.l,function(e){return e==t}),n(e))},i.l.push(r),i.i&&i.g.execute(i.c))})}))},e.reset=function(){Rh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Rh(this),this.A=!0,this.v.c();for(var e,t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=tt(this.m);for(;e=t.firstChild;)t.removeChild(e)}},w(Oh,Ih);var xh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Lh(e,t){return{name:e||"",J:"a valid string",optional:!!t,K:function(e){return"string"==typeof e}}}function Mh(e,t){return{name:e||"",J:"a boolean",optional:!!t,K:function(e){return"boolean"==typeof e}}}function Fh(e,t){return{name:e||"",J:"a valid object",optional:!!t,K:y}}function Uh(e,t){return{name:e||"",J:"a function",optional:!!t,K:function(e){return"function"==typeof e}}}function qh(e,t){return{name:e||"",J:"null",optional:!!t,K:function(e){return null===e}}}function jh(n){return{name:n?n+"Credential":"credential",J:n?"a valid "+n+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var t=!n||e.providerId===n;return!(!e.ja||!t)}}}function Vh(){return{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(e){return!!e&&!!e.rb}}}function Bh(){return{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}}function Kh(e,t){return y(e)&&"string"==typeof e.type&&e.type===t&&"function"==typeof e.Ha}function Wh(e){return y(e)&&"string"==typeof e.uid}function zh(){return{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}}function Hh(t,n,e,r){return{name:e||"",J:t.J+" or "+n.J,optional:!!r,K:function(e){return t.K(e)||n.K(e)}}}function Gh(e,t){for(var n in t){var r=t[n].name;e[r]=Xh(r,e[n],t[n].j)}}function Qh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:b(function(e){return this[e]},n),set:b(function(e,t,n,r){Ph(e,[n],[r],!0),this[t]=r},r,n,t[n].jb),enumerable:!0})}}function Yh(e,t,n,r){e[t]=Xh(t,n,r)}function Xh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return Ph(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=(e=(e=e).split("."))[e.length-1];for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}Gh(Jl.prototype,{ib:{name:"applyActionCode",j:[Lh("code")]},Qa:{name:"checkActionCode",j:[Lh("code")]},mb:{name:"confirmPasswordReset",j:[Lh("code"),Lh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Lh("email"),Lh("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Lh("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Lh("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Hh(Fh(),Uh(),"nextOrObserver"),Uh("opt_error",!0),Uh("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Hh(Fh(),Uh(),"nextOrObserver"),Uh("opt_error",!0),Uh("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Lh("email"),Hh(Fh("opt_actionCodeSettings",!0),qh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Lh("email"),Fh("actionCodeSettings")]},wb:{name:"setPersistence",j:[Lh("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[jh()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[jh()]},Sc:{name:"signInWithCustomToken",j:[Lh("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Lh("email"),Lh("password")]},Uc:{name:"signInWithEmailLink",j:[Lh("email"),Lh("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Lh("phoneNumber"),zh()]},Wc:{name:"signInWithPopup",j:[Bh()]},Xc:{name:"signInWithRedirect",j:[Bh()]},cd:{name:"updateCurrentUser",j:[Hh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(e){return!!(e&&e instanceof hl)}},qh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Lh(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Lh("url")]},hd:{name:"verifyPasswordResetCode",j:[Lh("code")]}}),Qh(Jl.prototype,{lc:{name:"languageCode",jb:Hh(Lh(),qh(),"languageCode")},ti:{name:"tenantId",jb:Hh(Lh(),qh(),"tenantId")}}),(Jl.Persistence=Wu).LOCAL="local",Jl.Persistence.SESSION="session",Jl.Persistence.NONE="none",Gh(hl.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Mh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Mh("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[jh()]},pb:{name:"linkWithCredential",j:[jh()]},Cc:{name:"linkWithPhoneNumber",j:[Lh("phoneNumber"),zh()]},Dc:{name:"linkWithPopup",j:[Bh()]},Ec:{name:"linkWithRedirect",j:[Bh()]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[jh()]},sb:{name:"reauthenticateWithCredential",j:[jh()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Lh("phoneNumber"),zh()]},Mc:{name:"reauthenticateWithPopup",j:[Bh()]},Nc:{name:"reauthenticateWithRedirect",j:[Bh()]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Hh(Fh("opt_actionCodeSettings",!0),qh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Lh(null,!0)]},bd:{name:"unlink",j:[Lh("provider")]},Ab:{name:"updateEmail",j:[Lh("email")]},Bb:{name:"updatePassword",j:[Lh("password")]},dd:{name:"updatePhoneNumber",j:[jh("phone")]},Cb:{name:"updateProfile",j:[Fh("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Lh("email"),Hh(Fh("opt_actionCodeSettings",!0),qh(null,!0),"opt_actionCodeSettings",!0)]}}),Gh(hh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Gh(lh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Gh(pt.prototype,{na:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Qh(Bc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Mh("appVerificationDisabledForTesting")}}),Gh(Kc.prototype,{confirm:{name:"confirm",j:[Lh("verificationCode")]}}),Yh(Zi,"fromJSON",function(e){e="string"==typeof e?JSON.parse(e):e;for(var t,n=[ao,_o,So,ro],r=0;r<n.length;r++)if(t=n[r](e))return t;return null},[Hh(Lh(),Fh(),"json")]),Yh(wo,"credential",function(e,t){return new bo(e,t)},[Lh("email"),Lh("password")]),Gh(bo.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(lo.prototype,{Ca:{name:"addScope",j:[Lh("scope")]},Ka:{name:"setCustomParameters",j:[Fh("customOAuthParameters")]}}),Yh(lo,"credential",ho,[Hh(Lh(),Fh(),"token")]),Yh(wo,"credentialWithLink",Eo,[Lh("email"),Lh("emailLink")]),Gh(fo.prototype,{Ca:{name:"addScope",j:[Lh("scope")]},Ka:{name:"setCustomParameters",j:[Fh("customOAuthParameters")]}}),Yh(fo,"credential",po,[Hh(Lh(),Fh(),"token")]),Gh(go.prototype,{Ca:{name:"addScope",j:[Lh("scope")]},Ka:{name:"setCustomParameters",j:[Fh("customOAuthParameters")]}}),Yh(go,"credential",yo,[Hh(Lh(),Hh(Fh(),qh()),"idToken"),Hh(Lh(),qh(),"accessToken",!0)]),Gh(mo.prototype,{Ka:{name:"setCustomParameters",j:[Fh("customOAuthParameters")]}}),Yh(mo,"credential",vo,[Hh(Lh(),Fh(),"token"),Lh("secret",!0)]),Gh(co.prototype,{Ca:{name:"addScope",j:[Lh("scope")]},credential:{name:"credential",j:[Hh(Lh(),Hh(Fh(),qh()),"optionsOrIdToken"),Hh(Lh(),qh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Fh("customOAuthParameters")]}}),Gh(io.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(to.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),Yh(ko,"credential",Ao,[Lh("verificationId"),Lh("verificationCode")]),Gh(ko.prototype,{eb:{name:"verifyPhoneNumber",j:[Hh(Lh(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(e){return!!e&&(e.session&&e.phoneNumber?Kh(e.session,Ji)&&"string"==typeof e.phoneNumber:e.session&&e.multiFactorHint?Kh(e.session,$i)&&Wh(e.multiFactorHint):e.session&&e.multiFactorUid?Kh(e.session,$i)&&"string"==typeof e.multiFactorUid:!!e.phoneNumber&&"string"==typeof e.phoneNumber)}},"phoneInfoOptions"),zh()]}}),Gh(Io.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(T.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(Fo.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(Mo.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(Yc.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(Hc.prototype,{Qc:{name:"resolveSignIn",j:[Vh()]}}),Gh(tl.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[Vh(),Lh("displayName",!0)]},ad:{name:"unenroll",j:[Hh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Wh},Lh(),"multiFactorInfoIdentifier")]}}),Gh(Oh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Yh(hi,"parseLink",bi,[Lh("link")]),Yh(mh,"assertion",function(e){return new Zc(e)},[jh("phone")]),function(){if(void 0===Jh||!Jh.INTERNAL||!Jh.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Zr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:$r,VERIFY_AND_CHANGE_EMAIL:ei,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Jl,AuthCredential:Zi,Error:T};Yh(e,"EmailAuthProvider",wo,[]),Yh(e,"FacebookAuthProvider",lo,[]),Yh(e,"GithubAuthProvider",fo,[]),Yh(e,"GoogleAuthProvider",go,[]),Yh(e,"TwitterAuthProvider",mo,[]),Yh(e,"OAuthProvider",co,[Lh("providerId")]),Yh(e,"SAMLAuthProvider",uo,[Lh("providerId")]),Yh(e,"PhoneAuthProvider",ko,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(e){return!!(e&&e instanceof Jl)}}]),Yh(e,"RecaptchaVerifier",Oh,[Hh(Lh(),{name:"",J:"an HTML element",optional:!1,K:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Fh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(e){return!!(e&&e instanceof Jh.app.App)}}]),Yh(e,"ActionCodeURL",hi,[]),Yh(e,"PhoneMultiFactorGenerator",mh,[]),Jh.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new Jl(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),Jh.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:v((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:v(e.mc,e),addAuthTokenListener:v(e.cc,e),removeAuthTokenListener:v(e.Oc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),Jh.registerVersion("@firebase/auth","0.15.2-1.0.0-eap-firestore-debug.9c6096f43"),Jh.INTERNAL.extendNamespace({User:hl})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ja=($a.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),$o(t))},$a.prototype.get=function(e){e=this.domStorage_.getItem(this.prefixedName_(e));return null==e?null:Jo(e)},$a.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},$a.prototype.prefixedName_=function(e){return this.prefix_+e},$a.prototype.toString=function(){return this.domStorage_.toString()},$a);function $a(e){this.domStorage_=e,this.prefix_="firebase:"}var Za=(es.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},es.prototype.get=function(e){return ea(this.cache_,e)?this.cache_[e]:null},es.prototype.remove=function(e){delete this.cache_[e]},es);function es(){this.cache_={},this.isInMemoryStorage=!0}function ts(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i,o=e.charCodeAt(r);55296<=o&&o<=56319&&(i=o-55296,No(++r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(i<<10)+(e.charCodeAt(r)-56320)),o<128?t[n++]=o:(o<2048?t[n++]=o>>6|192:(o<65536?t[n++]=o>>12|224:(t[n++]=o>>18|240,t[n++]=o>>12&63|128),t[n++]=o>>6&63|128),t[n++]=63&o|128)}return t}(e);return(e=new ia).update(t),e=e.digest(),Ro.encodeByteArray(e)}function ns(e,t){No(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(ps.logLevel=Aa.VERBOSE,ys=ps.log.bind(ps),t&&fs.set("logging_enabled",!0)):"function"==typeof e?ys=e:(ys=null,fs.remove("logging_enabled"))}function rs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+gs.apply(void 0,Io(e));ps.error(n)}function is(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+gs.apply(void 0,Io(e));throw ps.error(n),new Error(n)}function os(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+gs.apply(void 0,Io(e));ps.warn(n)}function as(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}function ss(e,t){return e===t?0:e<t?-1:1}function us(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+$o(t))}function cs(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)n<i+t?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r}var ls,Gn=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Ja(t)}}catch(e){}return new Za},hs=Gn("localStorage"),fs=Gn("sessionStorage"),ps=new xa("@firebase/database"),ds=(ls=1,function(){return ls++}),gs=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=gs.apply(null,i):n+="object"==typeof i?$o(i):i,n+=" "}return n},ys=null,ms=!0,vs=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];!0===ms&&(ms=!1,null===ys&&!0===fs.get("logging_enabled")&&ns(!0)),ys&&(e=gs.apply(null,t),ys(e))},bs=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];vs.apply(void 0,Io([n],e))}},_s="[MIN_NAME]",ws="[MAX_NAME]",Es=function(e,t){if(e===t)return 0;if(e===_s||t===ws)return-1;if(t===_s||e===ws)return 1;var n=Ns(e),r=Ns(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1},Ts=function(e){if("object"!=typeof e||null===e)return $o(e);var t,n=[];for(t in e)n.push(t);n.sort();for(var r="{",i=0;i<n.length;i++)0!==i&&(r+=","),r+=$o(n[i]),r+=":",r+=Ts(e[n[i]]);return r+="}"};function Is(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function Ss(e){var t,n,r,i;No(!as(e),"Invalid JSON number"),0===e?t=1/e==-1/(r=n=0)?1:0:(t=e<0,r=(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(e/Math.pow(2,-1074))));for(var o=[],a=52;a;--a)o.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;--a)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();var s=o.join(""),u="";for(a=0;a<64;a+=8){var c=parseInt(s.substr(a,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()}function Cs(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw os("Exception was thrown by user callback.",e),t},Math.floor(0))}}function ks(e,t){return"object"==typeof(t=setTimeout(e,t))&&t.unref&&t.unref(),t}var As=new RegExp("^-?(0*)\\d{1,10}$"),Ns=function(e){if(As.test(e)){e=Number(e);if(-2147483648<=e&&e<=2147483647)return e}return null},Ds=(Object.defineProperty(Rs,"Empty",{get:function(){return new Rs("")},enumerable:!1,configurable:!0}),Rs.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},Rs.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},Rs.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new Rs(this.pieces_,e)},Rs.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},Rs.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},Rs.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},Rs.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},Rs.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],t=this.pieceNum_;t<this.pieces_.length-1;t++)e.push(this.pieces_[t]);return new Rs(e,0)},Rs.prototype.child=function(e){for(var t=[],n=this.pieceNum_;n<this.pieces_.length;n++)t.push(this.pieces_[n]);if(e instanceof Rs)for(n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);else for(var r=e.split("/"),n=0;n<r.length;n++)0<r[n].length&&t.push(r[n]);return new Rs(t,0)},Rs.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},Rs.relativePath=function(e,t){var n=e.getFront(),r=t.getFront();if(null===n)return t;if(n===r)return Rs.relativePath(e.popFront(),t.popFront());throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")},Rs.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=Es(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},Rs.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},Rs.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},Rs);function Rs(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}var Os=(Object.defineProperty(Ps,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(Ps,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),Ps.prototype.push=function(e){0<this.parts_.length&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=da(e),this.checkValid_()},Ps.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=da(e),0<this.parts_.length&&--this.byteLength_},Ps.prototype.checkValid_=function(){if(this.byteLength_>Ps.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+Ps.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>Ps.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ps.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},Ps.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},Ps);function Ps(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=da(this.parts_[n]);this.checkValid_()}var xs="firebaseio.com",Ls="websocket",Ms="long_polling",Fs=(Us.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},Us.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},Us.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},Us.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},Us.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&hs.set("host:"+this.host,this.internalHost))},Us.prototype.connectionURL=function(e,t){var n;if(No("string"==typeof e,"typeof type must == string"),No("object"==typeof t,"typeof params must == object"),e===Ls)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==Ms)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return Is(t,function(e,t){r.push(e+"="+t)}),n+r.join("&")},Us.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},Us.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},Us);function Us(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=hs.get("host:"+e)||this.host}function qs(e,t){var n=Js(e),r=n.namespace;return"firebase.com"===n.domain&&is(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||is("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&os("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),e="ws"===n.scheme||"wss"===n.scheme,{repoInfo:new Fs(n.host,n.secure,r,t,e,"",r!==n.subdomain),path:new Ds(n.pathString)}}function js(e){return"string"==typeof e&&0!==e.length&&!$s.test(e)}function Vs(e){return"string"==typeof e&&0!==e.length&&!Zs.test(e)}function Bs(e){return null===e||"string"==typeof e||"number"==typeof e&&!as(e)||e&&"object"==typeof e&&ea(e,".sv")}function Ks(e,t,n,r,i){i&&void 0===n||tu(ha(e,t,i),n,r)}function Ws(e,t,n,r,i){if(!i||void 0!==n){var o=ha(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];Is(n,function(e,t){e=new Ds(e);if(tu(o,t,r.child(e)),".priority"===e.getBack()&&!Bs(t))throw new Error(o+"contains an invalid value for '"+e.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(e)}),function(e,t){for(var n,r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),o=0;o<i.length;o++)if((".priority"!==i[o]||o!==i.length-1)&&!js(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+n.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Ds.comparePaths);var a=null;for(r=0;r<t.length;r++){if(n=t[r],null!==a&&a.contains(n))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+n.toString());a=n}}(o,a)}}function zs(e,t,n,r){if(!r||void 0!==n){if(as(n))throw new Error(ha(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Bs(n))throw new Error(ha(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function Hs(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ha(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function Gs(e,t,n,r){if(!(r&&void 0===n||js(n)))throw new Error(ha(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function Qs(e,t,n,r){if(!(r&&void 0===n||Vs(n)))throw new Error(ha(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function Ys(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")}function Xs(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!js(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&(r=(r=r)&&r.replace(/^\/*\.info(\/|$)/,"/"),!Vs(r)))throw new Error(ha(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')}var Js=function(e){var t,n,r,i="",o="",a="",s="",u="",c=!0,l="https",h=443;return"string"==typeof e&&(0<=(r=e.indexOf("//"))&&(l=e.substring(0,r-1),e=e.substring(r+2)),-1===(t=e.indexOf("/"))&&(t=e.length),-1===(n=e.indexOf("?"))&&(n=e.length),i=e.substring(0,Math.min(t,n)),t<n&&(s=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(t,n))),n=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Eo(e.split("&")),o=i.next();!o.done;o=i.next()){var a,s=o.value;0!==s.length&&(2===(a=s.split("=")).length?r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):os("Invalid query segment '"+s+"' in query '"+e+"'"))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,n))),0<=(r=i.indexOf(":"))?(c="https"===l||"wss"===l,h=parseInt(i.substring(r+1),10)):r=i.length,"localhost"===(r=i.slice(0,r)).toLowerCase()?o="localhost":r.split(".").length<=2?o=r:(r=i.indexOf("."),a=i.substring(0,r).toLowerCase(),o=i.substring(r+1),u=a),"ns"in n&&(u=n.ns)),{host:i,port:h,domain:o,subdomain:a,secure:c,scheme:l,pathString:s,namespace:u}},$s=/[\[\].#$\/\u0000-\u001F\u007F]/,Zs=/[\[\].#$\u0000-\u001F\u007F]/,eu=10485760,tu=function(n,e,t){var r=t instanceof Ds?new Os(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(n+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(as(e))throw new Error(n+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>eu/3&&da(e)>eu)throw new Error(n+"contains a string greater than "+eu+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(Is(e,function(e,t){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!js(e)))throw new Error(n+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),tu(n,t,r),r.pop()}),i&&o)throw new Error(n+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},nu=(ru.prototype.cancel=function(e){la("OnDisconnect.cancel",0,1,arguments.length),fa("OnDisconnect.cancel",1,e,!0);var t=new xo;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},ru.prototype.remove=function(e){la("OnDisconnect.remove",0,1,arguments.length),Ys("OnDisconnect.remove",this.path_),fa("OnDisconnect.remove",1,e,!0);var t=new xo;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},ru.prototype.set=function(e,t){la("OnDisconnect.set",1,2,arguments.length),Ys("OnDisconnect.set",this.path_),Ks("OnDisconnect.set",1,e,this.path_,!1),fa("OnDisconnect.set",2,t,!0);var n=new xo;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},ru.prototype.setWithPriority=function(e,t,n){la("OnDisconnect.setWithPriority",2,3,arguments.length),Ys("OnDisconnect.setWithPriority",this.path_),Ks("OnDisconnect.setWithPriority",1,e,this.path_,!1),zs("OnDisconnect.setWithPriority",2,t,!1),fa("OnDisconnect.setWithPriority",3,n,!0);var r=new xo;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},ru.prototype.update=function(e,t){if(la("OnDisconnect.update",1,2,arguments.length),Ys("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,os("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ws("OnDisconnect.update",1,e,this.path_,!1),fa("OnDisconnect.update",2,t,!0);var i=new xo;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},ru);function ru(e,t){this.repo_=e,this.path_=t}var iu=(ou.prototype.toJSON=function(){return la("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},ou);function ou(e,t){this.committed=e,this.snapshot=t}var au,su,uu,cu=(au="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",su=0,uu=[],function(e){var t=e===su;su=e;for(var n=new Array(8),r=7;0<=r;r--)n[r]=au.charAt(e%64),e=Math.floor(e/64);No(0===e,"Cannot push at time == 0");var i=n.join("");if(t){for(r=11;0<=r&&63===uu[r];r--)uu[r]=0;uu[r]++}else for(r=0;r<12;r++)uu[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)i+=au.charAt(uu[r]);return No(20===i.length,"nextPushId: Length should be 20."),i}),lu=(hu.Wrap=function(e,t){return new hu(e,t)},hu);function hu(e,t){this.name=e,this.node=t}var fu,ge=(pu.prototype.getCompare=function(){return this.compare.bind(this)},pu.prototype.indexedValueChanged=function(e,t){e=new lu(_s,e),t=new lu(_s,t);return 0!==this.compare(e,t)},pu.prototype.minPost=function(){return lu.MIN},pu);function pu(){}var du,gu=(vo(yu,du=ge),Object.defineProperty(yu,"__EMPTY_NODE",{get:function(){return fu},set:function(e){fu=e},enumerable:!1,configurable:!0}),yu.prototype.compare=function(e,t){return Es(e.name,t.name)},yu.prototype.isDefinedOn=function(e){throw Do("KeyIndex.isDefinedOn not expected to be called.")},yu.prototype.indexedValueChanged=function(e,t){return!1},yu.prototype.minPost=function(){return lu.MIN},yu.prototype.maxPost=function(){return new lu(ws,fu)},yu.prototype.makePost=function(e,t){return No("string"==typeof e,"KeyIndex indexValue must always be a string."),new lu(e,fu)},yu.prototype.toString=function(){return".key"},yu);function yu(){return null!==du&&du.apply(this,arguments)||this}var mu,vu=new gu;function bu(e){return"number"==typeof e?"number:"+Ss(e):"string:"+e}var _u,wu,Eu,Tu,Iu=function(e){var t;e.isLeafNode()?(t=e.val(),No("string"==typeof t||"number"==typeof t||"object"==typeof t&&ea(t,".sv"),"Priority must be a string or number.")):No(e===mu||e.isEmpty(),"priority of unexpected type."),No(e===mu||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Su=(Object.defineProperty(Cu,"__childrenNodeConstructor",{get:function(){return _u},set:function(e){_u=e},enumerable:!1,configurable:!0}),Cu.prototype.isLeafNode=function(){return!0},Cu.prototype.getPriority=function(){return this.priorityNode_},Cu.prototype.updatePriority=function(e){return new Cu(this.value_,e)},Cu.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:Cu.__childrenNodeConstructor.EMPTY_NODE},Cu.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:Cu.__childrenNodeConstructor.EMPTY_NODE},Cu.prototype.hasChild=function(){return!1},Cu.prototype.getPredecessorChildName=function(e,t){return null},Cu.prototype.updateImmediateChild=function(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Cu.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)},Cu.prototype.updateChild=function(e,t){var n=e.getFront();return null===n?t:t.isEmpty()&&".priority"!==n?this:(No(".priority"!==n||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,Cu.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),t)))},Cu.prototype.isEmpty=function(){return!1},Cu.prototype.numChildren=function(){return 0},Cu.prototype.forEachChild=function(e,t){return!1},Cu.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},Cu.prototype.hash=function(){var e,t;return null===this.lazyHash_&&(e="",this.priorityNode_.isEmpty()||(e+="priority:"+bu(this.priorityNode_.val())+":"),e+=(t=typeof this.value_)+":",e+="number"==t?Ss(this.value_):this.value_,this.lazyHash_=ts(e)),this.lazyHash_},Cu.prototype.getValue=function(){return this.value_},Cu.prototype.compareTo=function(e){return e===Cu.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Cu.__childrenNodeConstructor?-1:(No(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},Cu.prototype.compareToLeafNode_=function(e){var t=typeof e.value_,n=typeof this.value_,r=Cu.VALUE_TYPE_ORDER.indexOf(t),i=Cu.VALUE_TYPE_ORDER.indexOf(n);return No(0<=r,"Unknown leaf type: "+t),No(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r},Cu.prototype.withIndex=function(){return this},Cu.prototype.isIndexed=function(){return!0},Cu.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))},Cu.VALUE_TYPE_ORDER=["object","boolean","number","string"],Cu);function Cu(e,t){void 0===t&&(t=Cu.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=t,this.lazyHash_=null,No(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Iu(this.priorityNode_)}function ku(){return null!==Tu&&Tu.apply(this,arguments)||this}var Au=new(vo(ku,Tu=ge),ku.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),r=n.compareTo(r);return 0===r?Es(e.name,t.name):r},ku.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},ku.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},ku.prototype.minPost=function(){return lu.MIN},ku.prototype.maxPost=function(){return new lu(ws,new Su("[PRIORITY-POST]",Eu))},ku.prototype.makePost=function(e,t){e=wu(e);return new lu(t,new Su("[PRIORITY-POST]",e))},ku.prototype.toString=function(){return".priority"},ku),Nu=(Du.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_.pop(),t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value};if(this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},Du.prototype.hasNext=function(){return 0<this.nodeStack_.length},Du.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},Du);function Du(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}var Ru=(Ou.prototype.copy=function(e,t,n,r,i){return new Ou(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ou.prototype.count=function(){return this.left.count()+1+this.right.count()},Ou.prototype.isEmpty=function(){return!1},Ou.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},Ou.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},Ou.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},Ou.prototype.minKey=function(){return this.min_().key},Ou.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Ou.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},Ou.prototype.removeMin_=function(){if(this.left.isEmpty())return xu.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},Ou.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return xu.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},Ou.prototype.isRed_=function(){return this.color},Ou.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},Ou.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},Ou.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},Ou.prototype.rotateLeft_=function(){var e=this.copy(null,null,Ou.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},Ou.prototype.rotateRight_=function(){var e=this.copy(null,null,Ou.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},Ou.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},Ou.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},Ou.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},Ou.RED=!0,Ou.BLACK=!1,Ou);function Ou(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ou.RED,this.left=null!=r?r:xu.EMPTY_NODE,this.right=null!=i?i:xu.EMPTY_NODE}Pu.prototype.copy=function(e,t,n,r,i){return this},Pu.prototype.insert=function(e,t,n){return new Ru(e,t,null)},Pu.prototype.remove=function(e,t){return this},Pu.prototype.count=function(){return 0},Pu.prototype.isEmpty=function(){return!0},Pu.prototype.inorderTraversal=function(e){return!1},Pu.prototype.reverseTraversal=function(e){return!1},Pu.prototype.minKey=function(){return null},Pu.prototype.maxKey=function(){return null},Pu.prototype.check_=function(){return 0},Pu.prototype.isRed_=function(){return!1},de=Pu;function Pu(){}var xu=(Lu.prototype.insert=function(e,t){return new Lu(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ru.BLACK,null,null))},Lu.prototype.remove=function(e){return new Lu(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ru.BLACK,null,null))},Lu.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null},Lu.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},Lu.prototype.isEmpty=function(){return this.root_.isEmpty()},Lu.prototype.count=function(){return this.root_.count()},Lu.prototype.minKey=function(){return this.root_.minKey()},Lu.prototype.maxKey=function(){return this.root_.maxKey()},Lu.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},Lu.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},Lu.prototype.getIterator=function(e){return new Nu(this.root_,null,this.comparator_,!1,e)},Lu.prototype.getIteratorFrom=function(e,t){return new Nu(this.root_,e,this.comparator_,!1,t)},Lu.prototype.getReverseIteratorFrom=function(e,t){return new Nu(this.root_,e,this.comparator_,!0,t)},Lu.prototype.getReverseIterator=function(e){return new Nu(this.root_,null,this.comparator_,!0,e)},Lu.EMPTY_NODE=new de,Lu);function Lu(e,t){void 0===t&&(t=Lu.EMPTY_NODE),this.comparator_=e,this.root_=t}var Mu=Math.log(2),Fu=(Uu.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},Uu);function Uu(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Mu,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}var qu,ju,Vu=function(c,e,l,t){c.sort(e);var h=function(e,t){var n=t-e;if(0==n)return null;if(1==n)return r=c[e],i=l?l(r):r,new Ru(i,r.node,Ru.BLACK,null,null);var n=parseInt(n/2,10)+e,e=h(e,n),t=h(n+1,t),r=c[n],i=l?l(r):r;return new Ru(i,r.node,Ru.BLACK,e,t)},n=function(e){for(var t=null,n=null,i=c.length,r=function(e,t){var n=i-e,r=i;i-=e;e=h(1+n,r),r=c[n],n=l?l(r):r;o(new Ru(n,r.node,t,null,e))},o=function(e){t=t?t.left=e:n=e},a=0;a<e.count;++a){var s=e.nextBitIsOne(),u=Math.pow(2,e.count-(a+1));s?r(u,Ru.BLACK):(r(u,Ru.BLACK),r(u,Ru.RED))}return n}(new Fu(c.length));return new xu(t||e,n)},Bu={},Ku=(Object.defineProperty(Wu,"Default",{get:function(){return No(Au,"ChildrenNode.ts has not been loaded"),qu=qu||new Wu({".priority":Bu},{".priority":Au})},enumerable:!1,configurable:!0}),Wu.prototype.get=function(e){var t=ta(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof xu?t:null},Wu.prototype.hasIndex=function(e){return ea(this.indexSet_,e.toString())},Wu.prototype.addIndex=function(e,t){No(e!==vu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,r=[],i=!1,o=t.getIterator(lu.Wrap),a=o.getNext();a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();n=i?Vu(r,e.getCompare()):Bu;var s=e.toString(),u=bo({},this.indexSet_);u[s]=e;t=bo({},this.indexes_);return t[s]=n,new Wu(t,u)},Wu.prototype.addToIndexes=function(a,s){var u=this;return new Wu(ra(this.indexes_,function(e,t){var n=ta(u.indexSet_,t);if(No(n,"Missing index implementation for "+t),e===Bu){if(n.isDefinedOn(a.node)){for(var r=[],i=s.getIterator(lu.Wrap),o=i.getNext();o;)o.name!==a.name&&r.push(o),o=i.getNext();return r.push(a),Vu(r,n.getCompare())}return Bu}n=s.get(a.name);return n&&(e=e.remove(new lu(a.name,n))),e.insert(a,a.node)}),this.indexSet_)},Wu.prototype.removeFromIndexes=function(n,r){return new Wu(ra(this.indexes_,function(e){if(e===Bu)return e;var t=r.get(n.name);return t?e.remove(new lu(n.name,t)):e}),this.indexSet_)},Wu);function Wu(e,t){this.indexes_=e,this.indexSet_=t}function zu(e,t){return Es(e.name,t.name)}function Hu(e,t){return Es(e,t)}var Gu,Qu=(Object.defineProperty(Yu,"EMPTY_NODE",{get:function(){return ju=ju||new Yu(new xu(Hu),null,Ku.Default)},enumerable:!1,configurable:!0}),Yu.prototype.isLeafNode=function(){return!1},Yu.prototype.getPriority=function(){return this.priorityNode_||ju},Yu.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new Yu(this.children_,e,this.indexMap_)},Yu.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();e=this.children_.get(e);return null===e?ju:e},Yu.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},Yu.prototype.hasChild=function(e){return null!==this.children_.get(e)},Yu.prototype.updateImmediateChild=function(e,t){if(No(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);var n=new lu(e,t),r=void 0,i=void 0,i=t.isEmpty()?(r=this.children_.remove(e),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),this.indexMap_.addToIndexes(n,this.children_)),n=r.isEmpty()?ju:this.priorityNode_;return new Yu(r,n,i)},Yu.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;No(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");t=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,t)},Yu.prototype.isEmpty=function(){return this.children_.isEmpty()},Yu.prototype.numChildren=function(){return this.children_.count()},Yu.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,a=!0;if(this.forEachChild(Au,function(e,t){r[e]=t.val(n),i++,a&&Yu.INTEGER_REGEXP_.test(e)?o=Math.max(o,Number(e)):a=!1}),!n&&a&&o<2*i){var e,t=[];for(e in r)t[e]=r[e];return t}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},Yu.prototype.hash=function(){var n;return null===this.lazyHash_&&(n="",this.getPriority().isEmpty()||(n+="priority:"+bu(this.getPriority().val())+":"),this.forEachChild(Au,function(e,t){t=t.hash();""!==t&&(n+=":"+e+":"+t)}),this.lazyHash_=""===n?"":ts(n)),this.lazyHash_},Yu.prototype.getPredecessorChildName=function(e,t,n){n=this.resolveIndex_(n);if(n){t=n.getPredecessorKey(new lu(e,t));return t?t.name:null}return this.children_.getPredecessorKey(e)},Yu.prototype.getFirstChildName=function(e){e=this.resolveIndex_(e);if(e){e=e.minKey();return e&&e.name}return this.children_.minKey()},Yu.prototype.getFirstChild=function(e){e=this.getFirstChildName(e);return e?new lu(e,this.children_.get(e)):null},Yu.prototype.getLastChildName=function(e){e=this.resolveIndex_(e);if(e){e=e.maxKey();return e&&e.name}return this.children_.maxKey()},Yu.prototype.getLastChild=function(e){e=this.getLastChildName(e);return e?new lu(e,this.children_.get(e)):null},Yu.prototype.forEachChild=function(e,t){e=this.resolveIndex_(e);return e?e.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},Yu.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},Yu.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,lu.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},Yu.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},Yu.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,lu.Wrap),i=r.peek();null!=i&&0<t.compare(i,e);)r.getNext(),i=r.peek();return r},Yu.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ju?-1:0},Yu.prototype.withIndex=function(e){if(e===vu||this.indexMap_.hasIndex(e))return this;e=this.indexMap_.addIndex(e,this.children_);return new Yu(this.children_,this.priorityNode_,e)},Yu.prototype.isIndexed=function(e){return e===vu||this.indexMap_.hasIndex(e)},Yu.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var t=this.getIterator(Au),n=e.getIterator(Au),r=t.getNext(),i=n.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1},Yu.prototype.resolveIndex_=function(e){return e===vu?null:this.indexMap_.get(e.toString())},Yu.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,Yu);function Yu(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Iu(this.priorityNode_),this.children_.isEmpty()&&No(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}function Xu(){return Gu.call(this,new xu(Hu),Qu.EMPTY_NODE,Ku.Default)||this}var Ju=new(vo(Xu,Gu=Qu),Xu.prototype.compareTo=function(e){return e===this?0:1},Xu.prototype.equals=function(e){return e===this},Xu.prototype.getPriority=function(){return this},Xu.prototype.getImmediateChild=function(e){return Qu.EMPTY_NODE},Xu.prototype.isEmpty=function(){return!1},Xu);Object.defineProperties(lu,{MIN:{value:new lu(_s,Qu.EMPTY_NODE)},MAX:{value:new lu(ws,Ju)}}),gu.__EMPTY_NODE=Qu.EMPTY_NODE,Su.__childrenNodeConstructor=Qu,mu=Ju,Eu=Ju;var $u,Zu=!0;function ec(n,e){if(void 0===e&&(e=null),null===n)return Qu.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),No(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Su(n,ec(e));if(n instanceof Array||!Zu){var r=Qu.EMPTY_NODE;return Is(n,function(e,t){ea(n,e)&&"."!==e.substring(0,1)&&(!(t=ec(t)).isLeafNode()&&t.isEmpty()||(r=r.updateImmediateChild(e,t)))}),r.updatePriority(ec(e))}var i=[],o=!1;if(Is(n,function(e,t){"."!==e.substring(0,1)&&((t=ec(t)).isEmpty()||(o=o||!t.getPriority().isEmpty(),i.push(new lu(e,t))))}),0===i.length)return Qu.EMPTY_NODE;var t=Vu(i,zu,function(e){return e.name},Hu);if(o){var a=Vu(i,Au.getCompare());return new Qu(t,ec(e),new Ku({".priority":a},{".priority":Au}))}return new Qu(t,ec(e),Ku.Default)}function tc(){return null!==$u&&$u.apply(this,arguments)||this}wu=ec;var nc,rc=new(vo(tc,$u=ge),tc.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?Es(e.name,t.name):n},tc.prototype.isDefinedOn=function(e){return!0},tc.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},tc.prototype.minPost=function(){return lu.MIN},tc.prototype.maxPost=function(){return lu.MAX},tc.prototype.makePost=function(e,t){e=ec(e);return new lu(t,e)},tc.prototype.toString=function(){return".value"},tc),ic=(vo(oc,nc=ge),oc.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},oc.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},oc.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),r=n.compareTo(r);return 0===r?Es(e.name,t.name):r},oc.prototype.makePost=function(e,t){e=ec(e),e=Qu.EMPTY_NODE.updateChild(this.indexPath_,e);return new lu(t,e)},oc.prototype.maxPost=function(){var e=Qu.EMPTY_NODE.updateChild(this.indexPath_,Ju);return new lu(ws,e)},oc.prototype.toString=function(){return this.indexPath_.slice().join("/")},oc);function oc(e){var t=nc.call(this)||this;return t.indexPath_=e,No(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),t}var ac=(sc.prototype.val=function(){return la("DataSnapshot.val",0,0,arguments.length),this.node_.val()},sc.prototype.exportVal=function(){return la("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},sc.prototype.toJSON=function(){return la("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},sc.prototype.exists=function(){return la("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},sc.prototype.child=function(e){la("DataSnapshot.child",0,1,arguments.length),e=String(e),Qs("DataSnapshot.child",1,e,!1);var t=new Ds(e),e=this.ref_.child(t);return new sc(this.node_.getChild(t),e,Au)},sc.prototype.hasChild=function(e){la("DataSnapshot.hasChild",1,1,arguments.length),Qs("DataSnapshot.hasChild",1,e,!1);e=new Ds(e);return!this.node_.getChild(e).isEmpty()},sc.prototype.getPriority=function(){return la("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},sc.prototype.forEach=function(n){var r=this;return la("DataSnapshot.forEach",1,1,arguments.length),fa("DataSnapshot.forEach",1,n,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(e,t){return n(new sc(t,r.ref_.child(e),Au))})},sc.prototype.hasChildren=function(){return la("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(sc.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),sc.prototype.numChildren=function(){return la("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},sc.prototype.getRef=function(){return la("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(sc.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),sc);function sc(e,t,n){this.node_=e,this.ref_=t,this.index_=n}var uc=(cc.prototype.getPath=function(){var e=this.snapshot.getRef();return("value"===this.eventType?e:e.getParent()).path},cc.prototype.getEventType=function(){return this.eventType},cc.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},cc.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+$o(this.snapshot.exportVal())},cc);function cc(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}var lc=(hc.prototype.getPath=function(){return this.path},hc.prototype.getEventType=function(){return"cancel"},hc.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},hc.prototype.toString=function(){return this.path.toString()+":cancel"},hc);function hc(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}var fc=(pc.prototype.respondsTo=function(e){return"value"===e},pc.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new uc("value",this,new ac(e.snapshotNode,t.getRef(),n))},pc.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){No(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},pc.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new lc(this,e,t):null},pc.prototype.matches=function(e){return e instanceof pc&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},pc.prototype.hasAnyCallback=function(){return null!==this.callback_},pc);function pc(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}var dc,gc=(yc.prototype.respondsTo=function(e){e="children_removed"===(e="children_added"===e?"child_added":e)?"child_removed":e;return ea(this.callbacks_,e)},yc.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new lc(this,e,t):null},yc.prototype.createEvent=function(e,t){No(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),t=t.getQueryParams().getIndex();return new uc(e.type,this,new ac(e.snapshotNode,n,t),e.prevName)},yc.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){No(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},yc.prototype.matches=function(t){var n=this;if(t instanceof yc){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var e=Object.keys(t.callbacks_),r=Object.keys(this.callbacks_),i=e.length;if(i===r.length){if(1!==i)return r.every(function(e){return t.callbacks_[e]===n.callbacks_[e]});e=e[0],r=r[0];return!(r!==e||t.callbacks_[e]&&this.callbacks_[r]&&t.callbacks_[e]!==this.callbacks_[r])}}}return!1},yc.prototype.hasAnyCallback=function(){return null!==this.callbacks_},yc);function yc(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}var mc=(Object.defineProperty(vc,"__referenceConstructor",{get:function(){return No(dc,"Reference.ts has not been loaded"),dc},set:function(e){dc=e},enumerable:!1,configurable:!0}),vc.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===vu){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==_s)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==ws)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Au){if(null!=t&&!Bs(t)||null!=n&&!Bs(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(No(e.getIndex()instanceof ic||e.getIndex()===rc,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},vc.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},vc.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},vc.prototype.getQueryParams=function(){return this.queryParams_},vc.prototype.getRef=function(){return la("Query.ref",0,0,arguments.length),new vc.__referenceConstructor(this.repo,this.path)},vc.prototype.on=function(e,t,n,r){la("Query.on",2,4,arguments.length),Hs("Query.on",1,e,!1),fa("Query.on",2,t,!1);n=vc.getCancelAndContextArgs_("Query.on",n,r);return"value"===e?this.onValueEvent(t,n.cancel,n.context):((r={})[e]=t,this.onChildEvent(r,n.cancel,n.context)),t},vc.prototype.onValueEvent=function(e,t,n){n=new fc(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,n)},vc.prototype.onChildEvent=function(e,t,n){n=new gc(e,t,n);this.repo.addEventCallbackForQuery(this,n)},vc.prototype.off=function(e,t,n){la("Query.off",0,3,arguments.length),Hs("Query.off",1,e,!0),fa("Query.off",2,t,!0),pa("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new fc(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new gc(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},vc.prototype.get=function(){return this.repo.getValue(this)},vc.prototype.once=function(t,n,e,r){var i=this;la("Query.once",1,4,arguments.length),Hs("Query.once",1,t,!1),fa("Query.once",2,n,!0);var o=vc.getCancelAndContextArgs_("Query.once",e,r),a=!0,s=new xo;s.promise.catch(function(){});var u=function(e){a&&(a=!1,i.off(t,u),n&&n.bind(o.context)(e),s.resolve(e))};return this.on(t,u,function(e){i.off(t,u),o.cancel&&o.cancel.bind(o.context)(e),s.reject(e)}),s.promise},vc.prototype.limitToFirst=function(e){if(la("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new vc(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},vc.prototype.limitToLast=function(e){if(la("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new vc(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},vc.prototype.orderByChild=function(e){if(la("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Qs("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");e=new Ds(e);if(e.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");e=new ic(e),e=this.queryParams_.orderBy(e);return vc.validateQueryEndpoints_(e),new vc(this.repo,this.path,e,!0)},vc.prototype.orderByKey=function(){la("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(vu);return vc.validateQueryEndpoints_(e),new vc(this.repo,this.path,e,!0)},vc.prototype.orderByPriority=function(){la("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Au);return vc.validateQueryEndpoints_(e),new vc(this.repo,this.path,e,!0)},vc.prototype.orderByValue=function(){la("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(rc);return vc.validateQueryEndpoints_(e),new vc(this.repo,this.path,e,!0)},vc.prototype.startAt=function(e,t){void 0===e&&(e=null),la("Query.startAt",0,2,arguments.length),Ks("Query.startAt",1,e,this.path,!0),Gs("Query.startAt",2,t,!0);var n=this.queryParams_.startAt(e,t);if(vc.validateLimit_(n),vc.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(t=e=null),new vc(this.repo,this.path,n,this.orderByCalled_)},vc.prototype.endAt=function(e,t){void 0===e&&(e=null),la("Query.endAt",0,2,arguments.length),Ks("Query.endAt",1,e,this.path,!0),Gs("Query.endAt",2,t,!0);t=this.queryParams_.endAt(e,t);if(vc.validateLimit_(t),vc.validateQueryEndpoints_(t),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new vc(this.repo,this.path,t,this.orderByCalled_)},vc.prototype.equalTo=function(e,t){if(la("Query.equalTo",1,2,arguments.length),Ks("Query.equalTo",1,e,this.path,!1),Gs("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},vc.prototype.toString=function(){return la("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},vc.prototype.toJSON=function(){return la("Query.toJSON",0,1,arguments.length),this.toString()},vc.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},vc.prototype.queryIdentifier=function(){var e=this.queryObject(),e=Ts(e);return"{}"===e?"default":e},vc.prototype.isEqual=function(e){if(la("Query.isEqual",1,1,arguments.length),!(e instanceof vc)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var t=this.repo===e.repo,n=this.path.equals(e.path),e=this.queryIdentifier()===e.queryIdentifier();return t&&n&&e},vc.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,fa(e,3,r.cancel,!0),r.context=n,pa(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(ha(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(vc.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),vc);function vc(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}var bc=(_c.prototype.getImmediateChild=function(e){return new _c(this.node_.getImmediateChild(e))},_c.prototype.node=function(){return this.node_},_c);function _c(e){this.node_=e}var wc=(Ec.prototype.getImmediateChild=function(e){e=this.path_.child(e);return new Ec(this.syncTree_,e)},Ec.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},Ec);function Ec(e,t){this.syncTree_=e,this.path_=t}function Tc(e,t,n,r){return Ac(t,new wc(n,e),r)}function Ic(e,t,n){return Ac(e,new bc(t),n)}var Sc=function(e,t,n){return e&&"object"==typeof e?(No(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Cc(e[".sv"],t,n):"object"==typeof e[".sv"]?kc(e[".sv"],t):void No(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Cc=function(e,t,n){if("timestamp"===e)return n.timestamp;No(!1,"Unexpected server value: "+e)},kc=function(e,t,n){e.hasOwnProperty("increment")||No(!1,"Unexpected server value: "+JSON.stringify(e,null,2));e=e.increment;"number"!=typeof e&&No(!1,"Unexpected increment value: "+e);t=t.node();if(No(null!=t,"Expected ChildrenNode.EMPTY_NODE for nulls"),!t.isLeafNode())return e;t=t.getValue();return"number"!=typeof t?e:t+e};function Ac(e,r,i){var t=e.getPriority().val(),n=Sc(t,r.getImmediateChild(".priority"),i);if(e.isLeafNode()){var o=e,t=Sc(o.getValue(),r,i);return t!==o.getValue()||n!==o.getPriority().val()?new Su(t,ec(n)):e}var e=e,a=e;return n!==e.getPriority().val()&&(a=a.updatePriority(new Su(n))),e.forEachChild(Au,function(e,t){var n=Ac(t,r.getImmediateChild(e),i);n!==t&&(a=a.updateImmediateChild(e,n))}),a}var Nc,Dc=(Rc.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&0<this.children.size){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},Rc.prototype.remember=function(e,t){var n;e.isEmpty()?(this.value=t,this.children.clear()):null!==this.value?this.value=this.value.updateChild(e,t):(n=e.getFront(),this.children.has(n)||this.children.set(n,new Rc),n=this.children.get(n),e=e.popFront(),n.remember(e,t))},Rc.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var n=this;return t.forEachChild(Au,function(e,t){n.remember(new Ds(e),t)}),this.forget(e)}if(0<this.children.size){t=e.getFront();return e=e.popFront(),this.children.has(t)&&this.children.get(t).forget(e)&&this.children.delete(t),0===this.children.size}return!0},Rc.prototype.forEachTree=function(n,r){null!==this.value?r(n,this.value):this.forEachChild(function(e,t){e=new Ds(n.toString()+"/"+e);t.forEachTree(e,r)})},Rc.prototype.forEachChild=function(n){this.children.forEach(function(e,t){n(t,e)})},Rc);function Rc(){this.value=null,this.children=new Map}(Gn=Nc=Nc||{})[Gn.OVERWRITE=0]="OVERWRITE",Gn[Gn.MERGE=1]="MERGE",Gn[Gn.ACK_USER_WRITE=2]="ACK_USER_WRITE",Gn[Gn.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Oc=(Pc.User=new Pc(!0,!1,null,!1),Pc.Server=new Pc(!1,!0,null,!1),Pc.forServerTaggedQuery=function(e){return new Pc(!1,!0,e,!0)},Pc);function Pc(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,No(!r||t,"Tagged queries must be from server.")}var xc,Lc=(Mc.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return No(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new Ds(e));return new Mc(Ds.Empty,t,this.revert)}return No(this.path.getFront()===e,"operationForChild called for unrelated child."),new Mc(this.path.popFront(),this.affectedTree,this.revert)},Mc);function Mc(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Nc.ACK_USER_WRITE,this.source=Oc.User}var Fc=(Uc.fromObject=function(e){var n=Uc.Empty;return Is(e,function(e,t){n=n.set(new Ds(e),t)}),n},Uc.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},Uc.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:Ds.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null===r)return null;t=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null==t?null:{path:new Ds(n).child(t.path),value:t.value}},Uc.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},Uc.prototype.subtree=function(e){if(e.isEmpty())return this;var t=e.getFront(),t=this.children.get(t);return null!==t?t.subtree(e.popFront()):Uc.Empty},Uc.prototype.set=function(e,t){if(e.isEmpty())return new Uc(t,this.children);var n=e.getFront(),t=(this.children.get(n)||Uc.Empty).set(e.popFront(),t),t=this.children.insert(n,t);return new Uc(this.value,t)},Uc.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?Uc.Empty:new Uc(null,this.children);var t=e.getFront(),n=this.children.get(t);if(n){n=n.remove(e.popFront()),e=void 0,e=n.isEmpty()?this.children.remove(t):this.children.insert(t,n);return null===this.value&&e.isEmpty()?Uc.Empty:new Uc(this.value,e)}return this},Uc.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),t=this.children.get(t);return t?t.get(e.popFront()):null},Uc.prototype.setTree=function(e,t){if(e.isEmpty())return t;var n=e.getFront(),e=(this.children.get(n)||Uc.Empty).setTree(e.popFront(),t),t=void 0,t=e.isEmpty()?this.children.remove(n):this.children.insert(n,e);return new Uc(this.value,t)},Uc.prototype.fold=function(e){return this.fold_(Ds.Empty,e)},Uc.prototype.fold_=function(n,r){var i={};return this.children.inorderTraversal(function(e,t){i[e]=t.fold_(n.child(e),r)}),r(n,this.value,i)},Uc.prototype.findOnPath=function(e,t){return this.findOnPath_(e,Ds.Empty,t)},Uc.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),r=this.children.get(i);return r?r.findOnPath_(e.popFront(),t.child(i),n):null},Uc.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,Ds.Empty,t)},Uc.prototype.foreachOnPath_=function(e,t,n){if(e.isEmpty())return this;this.value&&n(t,this.value);var r=e.getFront(),i=this.children.get(r);return i?i.foreachOnPath_(e.popFront(),t.child(r),n):Uc.Empty},Uc.prototype.foreach=function(e){this.foreach_(Ds.Empty,e)},Uc.prototype.foreach_=function(n,r){this.children.inorderTraversal(function(e,t){t.foreach_(n.child(e),r)}),this.value&&r(n,this.value)},Uc.prototype.foreachChild=function(n){this.children.inorderTraversal(function(e,t){t.value&&n(e,t.value)})},Uc.Empty=new Uc(null),Uc);function Uc(e,t){void 0===t&&(t=xc=xc||new xu(ss)),this.value=e,this.children=t}var qc=(jc.prototype.operationForChild=function(e){return this.path.isEmpty()?new jc(this.source,Ds.Empty):new jc(this.source,this.path.popFront())},jc);function jc(e,t){this.source=e,this.path=t,this.type=Nc.LISTEN_COMPLETE}var Vc=(Bc.prototype.operationForChild=function(e){return this.path.isEmpty()?new Bc(this.source,Ds.Empty,this.snap.getImmediateChild(e)):new Bc(this.source,this.path.popFront(),this.snap)},Bc);function Bc(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Nc.OVERWRITE}var Kc=(Wc.prototype.operationForChild=function(e){if(this.path.isEmpty()){var t=this.children.subtree(new Ds(e));return t.isEmpty()?null:t.value?new Vc(this.source,Ds.Empty,t.value):new Wc(this.source,Ds.Empty,t)}return No(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new Wc(this.source,this.path.popFront(),this.children)},Wc.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Wc);function Wc(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Nc.MERGE}var zc=(Hc.prototype.isFullyInitialized=function(){return this.fullyInitialized_},Hc.prototype.isFiltered=function(){return this.filtered_},Hc.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;e=e.getFront();return this.isCompleteForChild(e)},Hc.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},Hc.prototype.getNode=function(){return this.node_},Hc);function Hc(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}var Gc=(Qc.prototype.updateEventSnap=function(e,t,n){return new Qc(new zc(e,t,n),this.serverCache_)},Qc.prototype.updateServerSnap=function(e,t,n){return new Qc(this.eventCache_,new zc(e,t,n))},Qc.prototype.getEventCache=function(){return this.eventCache_},Qc.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},Qc.prototype.getServerCache=function(){return this.serverCache_},Qc.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},Qc.Empty=new Qc(new zc(Qu.EMPTY_NODE,!1,!1),new zc(Qu.EMPTY_NODE,!1,!1)),Qc);function Qc(e,t){this.eventCache_=e,this.serverCache_=t}var Yc=(Xc.valueChange=function(e){return new Xc(Xc.VALUE,e)},Xc.childAddedChange=function(e,t){return new Xc(Xc.CHILD_ADDED,t,e)},Xc.childRemovedChange=function(e,t){return new Xc(Xc.CHILD_REMOVED,t,e)},Xc.childChangedChange=function(e,t,n){return new Xc(Xc.CHILD_CHANGED,t,e,n)},Xc.childMovedChange=function(e,t){return new Xc(Xc.CHILD_MOVED,t,e)},Xc.CHILD_ADDED="child_added",Xc.CHILD_REMOVED="child_removed",Xc.CHILD_CHANGED="child_changed",Xc.CHILD_MOVED="child_moved",Xc.VALUE="value",Xc);function Xc(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}var Jc=($c.prototype.updateChild=function(e,t,n,r,i,o){No(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Yc.childRemovedChange(t,a)):No(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Yc.childAddedChange(t,n)):o.trackChildChange(Yc.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},$c.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(Au,function(e,t){n.hasChild(e)||i.trackChildChange(Yc.childRemovedChange(e,t))}),n.isLeafNode()||n.forEachChild(Au,function(e,t){var n;r.hasChild(e)?(n=r.getImmediateChild(e)).equals(t)||i.trackChildChange(Yc.childChangedChange(e,t,n)):i.trackChildChange(Yc.childAddedChange(e,t))})),n.withIndex(this.index_)},$c.prototype.updatePriority=function(e,t){return e.isEmpty()?Qu.EMPTY_NODE:e.updatePriority(t)},$c.prototype.filtersNodes=function(){return!1},$c.prototype.getIndexedFilter=function(){return this},$c.prototype.getIndex=function(){return this.index_},$c);function $c(e){this.index_=e}var Zc=(el.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;No(t===Yc.CHILD_ADDED||t===Yc.CHILD_CHANGED||t===Yc.CHILD_REMOVED,"Only child changes supported for tracking"),No(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(t===Yc.CHILD_ADDED&&i===Yc.CHILD_REMOVED)this.changeMap.set(n,Yc.childChangedChange(n,e.snapshotNode,r.snapshotNode));else if(t===Yc.CHILD_REMOVED&&i===Yc.CHILD_ADDED)this.changeMap.delete(n);else if(t===Yc.CHILD_REMOVED&&i===Yc.CHILD_CHANGED)this.changeMap.set(n,Yc.childRemovedChange(n,r.oldSnap));else if(t===Yc.CHILD_CHANGED&&i===Yc.CHILD_ADDED)this.changeMap.set(n,Yc.childAddedChange(n,e.snapshotNode));else{if(t!==Yc.CHILD_CHANGED||i!==Yc.CHILD_CHANGED)throw Do("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Yc.childChangedChange(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},el.prototype.getChanges=function(){return Array.from(this.changeMap.values())},el);function el(){this.changeMap=new Map}function tl(){}var nl=new(tl.prototype.getCompleteChild=function(e){return null},tl.prototype.getChildAfterChild=function(e,t,n){return null},tl),rl=(il.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);t=null!=this.optCompleteServerCache_?new zc(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,t)},il.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),e=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===e.length?null:e[0]},il);function il(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}var ol=function(e,t){this.viewCache=e,this.changes=t},al=(sl.prototype.assertIndexed=function(e){No(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),No(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},sl.prototype.applyOperation=function(e,t,n,r){var i=new Zc;if(t.type===Nc.OVERWRITE)var o=t,a=o.source.fromUser?this.applyUserOverwrite_(e,o.path,o.snap,n,r,i):(No(o.source.fromServer,"Unknown source."),s=o.source.tagged||e.getServerCache().isFiltered()&&!o.path.isEmpty(),this.applyServerOverwrite_(e,o.path,o.snap,n,r,s,i));else if(t.type===Nc.MERGE){o=t;a=o.source.fromUser?this.applyUserMerge_(e,o.path,o.children,n,r,i):(No(o.source.fromServer,"Unknown source."),s=o.source.tagged||e.getServerCache().isFiltered(),this.applyServerMerge_(e,o.path,o.children,n,r,s,i))}else if(t.type===Nc.ACK_USER_WRITE){var s=t;a=s.revert?this.revertUserWrite_(e,s.path,n,r,i):this.ackUserWrite_(e,s.path,s.affectedTree,n,r,i)}else{if(t.type!==Nc.LISTEN_COMPLETE)throw Do("Unknown operation type: "+t.type);a=this.listenComplete_(e,t.path,n,i)}i=i.getChanges();return sl.maybeAddValueEvent_(e,a,i),new ol(a,i)},sl.maybeAddValueEvent_=function(e,t,n){var r,i,o=t.getEventCache();o.isFullyInitialized()&&(r=o.getNode().isLeafNode()||o.getNode().isEmpty(),i=e.getCompleteEventSnap(),(0<n.length||!e.getEventCache().isFullyInitialized()||r&&!o.getNode().equals(i)||!o.getNode().getPriority().equals(i.getPriority()))&&n.push(Yc.valueChange(t.getCompleteEventSnap())))},sl.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a,s,u,c,l=void 0,h=void 0;return l=t.isEmpty()?(No(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()?(a=(a=e.getCompleteServerSnap())instanceof Qu?a:Qu.EMPTY_NODE,a=n.calcCompleteEventChildren(a),this.filter_.updateFullNode(e.getEventCache().getNode(),a,i)):(s=n.calcCompleteEventCache(e.getCompleteServerSnap()),this.filter_.updateFullNode(e.getEventCache().getNode(),s,i))):".priority"===(s=t.getFront())?(No(1===t.getLength(),"Can't have a priority with additional path components"),u=o.getNode(),h=e.getServerCache().getNode(),null!=(c=n.calcEventCacheAfterServerOverwrite(t,u,h))?this.filter_.updatePriority(u,c):o.getNode()):(u=t.popFront(),c=void 0,null!=(c=o.isCompleteForChild(s)?(h=e.getServerCache().getNode(),null!=(h=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),h))?o.getNode().getImmediateChild(s).updateChild(u,h):o.getNode().getImmediateChild(s)):n.calcCompleteChild(s,e.getServerCache()))?this.filter_.updateChild(o.getNode(),s,c,u,r,i):o.getNode()),e.updateEventSnap(l,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},sl.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s=e.getServerCache(),u=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())l=u.updateFullNode(s.getNode(),n,null);else if(u.filtersNodes()&&!s.isFiltered())var c=s.getNode().updateChild(t,n),l=u.updateFullNode(s.getNode(),c,null);else{o=t.getFront();if(!s.isCompleteForPath(t)&&1<t.getLength())return e;c=t.popFront(),n=s.getNode().getImmediateChild(o).updateChild(c,n);l=".priority"===o?u.updatePriority(s.getNode(),n):u.updateChild(s.getNode(),o,n,c,nl,null)}u=e.updateServerSnap(l,s.isFullyInitialized()||t.isEmpty(),u.filtersNodes()),i=new rl(r,u,i);return this.generateEventCacheAfterServerEvent_(u,t,r,i,a)},sl.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,s,u=e.getEventCache(),c=new rl(r,e,i);return t.isEmpty()?(s=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),e.updateEventSnap(s,!0,this.filter_.filtersNodes())):".priority"===(a=t.getFront())?(s=this.filter_.updatePriority(e.getEventCache().getNode(),n),e.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered())):(r=t.popFront(),i=u.getNode().getImmediateChild(a),s=void 0,s=r.isEmpty()?n:null!=(t=c.getCompleteChild(a))?".priority"===r.getBack()&&t.getChild(r.parent()).isEmpty()?t:t.updateChild(r,n):Qu.EMPTY_NODE,i.equals(s)?e:(o=this.filter_.updateChild(u.getNode(),a,s,r,c,o),e.updateEventSnap(o,u.isFullyInitialized(),this.filter_.filtersNodes())))},sl.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},sl.prototype.applyUserMerge_=function(n,r,e,i,o,a){var s=this,u=n;return e.foreach(function(e,t){e=r.child(e);sl.cacheHasChild_(n,e.getFront())&&(u=s.applyUserOverwrite_(u,e,t,i,o,a))}),e.foreach(function(e,t){e=r.child(e);sl.cacheHasChild_(n,e.getFront())||(u=s.applyUserOverwrite_(u,e,t,i,o,a))}),u},sl.prototype.applyMerge_=function(n,e){return e.foreach(function(e,t){n=n.updateChild(e,t)}),n},sl.prototype.applyServerMerge_=function(r,e,t,i,o,a,s){var u=this;if(r.getServerCache().getNode().isEmpty()&&!r.getServerCache().isFullyInitialized())return r;var c=r,t=e.isEmpty()?t:Fc.Empty.setTree(e,t),l=r.getServerCache().getNode();return t.children.inorderTraversal(function(e,t){var n;l.hasChild(e)&&(n=r.getServerCache().getNode().getImmediateChild(e),t=u.applyMerge_(n,t),c=u.applyServerOverwrite_(c,new Ds(e),t,i,o,a,s))}),t.children.inorderTraversal(function(e,t){var n=!r.getServerCache().isCompleteForChild(e)&&null==t.value;l.hasChild(e)||n||(n=r.getServerCache().getNode().getImmediateChild(e),t=u.applyMerge_(n,t),c=u.applyServerOverwrite_(c,new Ds(e),t,i,o,a,s))}),c},sl.prototype.ackUserWrite_=function(e,r,t,n,i,o){if(null!=n.shadowingWrite(r))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=t.value){if(r.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(r))return this.applyServerOverwrite_(e,r,s.getNode().getChild(r),n,i,a,o);if(r.isEmpty()){var u=Fc.Empty;return s.getNode().forEachChild(vu,function(e,t){u=u.set(new Ds(e),t)}),this.applyServerMerge_(e,r,u,n,i,a,o)}return e}var c=Fc.Empty;return t.foreach(function(e,t){var n=r.child(e);s.isCompleteForPath(n)&&(c=c.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,r,c,n,i,a,o)},sl.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),i=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(i,t,n,nl,r)},sl.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a,s,u=new rl(n,e,r),c=e.getEventCache().getNode(),r=void 0;return t.isEmpty()||".priority"===t.getFront()?(s=void 0,s=e.getServerCache().isFullyInitialized()?n.calcCompleteEventCache(e.getCompleteServerSnap()):(a=e.getServerCache().getNode(),No(a instanceof Qu,"serverChildren would be complete if leaf node"),n.calcCompleteEventChildren(a)),r=this.filter_.updateFullNode(c,s,i)):(a=t.getFront(),null==(s=n.calcCompleteChild(a,e.getServerCache()))&&e.getServerCache().isCompleteForChild(a)&&(s=c.getImmediateChild(a)),(r=null!=s?this.filter_.updateChild(c,a,s,t.popFront(),u,i):e.getEventCache().getNode().hasChild(a)?this.filter_.updateChild(c,a,Qu.EMPTY_NODE,t.popFront(),u,i):c).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(r=this.filter_.updateFullNode(r,o,i))),o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Ds.Empty),e.updateEventSnap(r,o,this.filter_.filtersNodes())},sl);function sl(e){this.filter_=e}var ul=(cl.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach(function(e){e.type===Yc.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Yc.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,Yc.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,Yc.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,Yc.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,Yc.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,Yc.VALUE,e,n,t),i},cl.prototype.generateEventsForType_=function(r,t,e,i,o){var a=this,e=e.filter(function(e){return e.type===t});e.sort(this.compareChanges_.bind(this)),e.forEach(function(t){var n=a.materializeSingleChange_(t,o);i.forEach(function(e){e.respondsTo(t.type)&&r.push(e.createEvent(n,a.query_))})})},cl.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_)),e},cl.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw Do("Should only compare child_ events.");e=new lu(e.childName,e.snapshotNode),t=new lu(t.childName,t.snapshotNode);return this.index_.compare(e,t)},cl);function cl(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}var ll,hl=(fl.prototype.getQuery=function(){return this.query_},fl.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},fl.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},fl.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},fl.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},fl.prototype.removeEventRegistration=function(e,t){var n,r=[];if(t&&(No(null==e,"A cancel should cancel all event registrations."),n=this.query_.path,this.eventRegistrations_.forEach(function(e){e=e.createCancelEvent(t,n);e&&r.push(e)})),e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},fl.prototype.applyOperation=function(e,t,n){e.type===Nc.MERGE&&null!==e.source.queryId&&(No(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),No(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,n=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(n.viewCache),No(n.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=n.viewCache,this.generateEventsForChanges_(n.changes,n.viewCache.getEventCache().getNode(),null)},fl.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Au,function(e,t){n.push(Yc.childAddedChange(e,t))}),t.isFullyInitialized()&&n.push(Yc.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},fl.prototype.generateEventsForChanges_=function(e,t,n){n=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,n)},fl);function fl(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Jc(n.getIndex()),i=n.getNodeFilter();this.processor_=new al(i);var o=t.getServerCache(),e=t.getEventCache(),n=r.updateFullNode(Qu.EMPTY_NODE,o.getNode(),null),t=i.updateFullNode(Qu.EMPTY_NODE,e.getNode(),null),r=new zc(n,o.isFullyInitialized(),r.filtersNodes()),i=new zc(t,e.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Gc(i,r),this.eventGenerator_=new ul(this.query_)}var pl=(Object.defineProperty(dl,"__referenceConstructor",{get:function(){return No(ll,"Reference.ts has not been loaded"),ll},set:function(e){No(!ll,"__referenceConstructor has already been defined"),ll=e},enumerable:!1,configurable:!0}),dl.prototype.isEmpty=function(){return 0===this.views.size},dl.prototype.applyOperation=function(e,t,n){var r,i,o=e.source.queryId;if(null!==o){var a=this.views.get(o);return No(null!=a,"SyncTree gave us an op for an invalid query."),a.applyOperation(e,t,n)}var s=[];try{for(var u=Eo(this.views.values()),c=u.next();!c.done;c=u.next())a=c.value,s=s.concat(a.applyOperation(e,t,n))}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s},dl.prototype.addEventRegistration=function(e,t,n,r,i){var o,a,s=e.queryIdentifier(),u=this.views.get(s);return u||(a=!1,a=!!(o=n.calcCompleteEventCache(i?r:null))||(o=r instanceof Qu?n.calcCompleteEventChildren(r):Qu.EMPTY_NODE,!1),i=new Gc(new zc(o,a,!1),new zc(r,i,!1)),u=new hl(e,i),this.views.set(s,u)),u.addEventRegistration(t),u.getInitialEvents(t)},dl.prototype.removeEventRegistration=function(e,t,n){var r,i,o=e.queryIdentifier(),a=[],s=[],u=this.hasCompleteView();if("default"===o)try{for(var c=Eo(this.views.entries()),l=c.next();!l.done;l=c.next()){var h=To(l.value,2),f=h[0],p=h[1],s=s.concat(p.removeEventRegistration(t,n));p.isEmpty()&&(this.views.delete(f),p.getQuery().getQueryParams().loadsAllData()||a.push(p.getQuery()))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}else(p=this.views.get(o))&&(s=s.concat(p.removeEventRegistration(t,n)),p.isEmpty()&&(this.views.delete(o),p.getQuery().getQueryParams().loadsAllData()||a.push(p.getQuery())));return u&&!this.hasCompleteView()&&a.push(new dl.__referenceConstructor(e.repo,e.path)),{removed:a,events:s}},dl.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=Eo(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},dl.prototype.getCompleteServerCache=function(e){var t,n,r=null;try{for(var i=Eo(this.views.values()),o=i.next();!o.done;o=i.next())var a=o.value,r=r||a.getCompleteServerCache(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},dl.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();e=e.queryIdentifier();return this.views.get(e)},dl.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},dl.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},dl.prototype.getCompleteView=function(){var t,e;try{for(var n=Eo(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},dl);function dl(){this.views=new Map}var gl=(yl.prototype.addWrite=function(e,t){if(e.isEmpty())return new yl(new Fc(t));var n=this.writeTree_.findRootMostValueAndPath(e);if(null!=n){var r=n.path,i=n.value,n=Ds.relativePath(r,e),i=i.updateChild(n,t);return new yl(this.writeTree_.set(r,i))}t=new Fc(t);return new yl(this.writeTree_.setTree(e,t))},yl.prototype.addWrites=function(n,e){var r=this;return Is(e,function(e,t){r=r.addWrite(n.child(e),t)}),r},yl.prototype.removeWrite=function(e){return e.isEmpty()?yl.Empty:new yl(this.writeTree_.setTree(e,Fc.Empty))},yl.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},yl.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(Ds.relativePath(t.path,e)):null},yl.prototype.getCompleteChildren=function(){var n=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Au,function(e,t){n.push(new lu(e,t))}):this.writeTree_.children.inorderTraversal(function(e,t){null!=t.value&&n.push(new lu(e,t.value))}),n},yl.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var t=this.getCompleteNode(e);return new yl(null!=t?new Fc(t):this.writeTree_.subtree(e))},yl.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},yl.prototype.apply=function(e){return function n(r,e,i){{if(null!=e.value)return i.updateChild(r,e.value);var o=null;return e.children.inorderTraversal(function(e,t){".priority"===e?(No(null!==t.value,"Priority writes must always be leaf nodes"),o=t.value):i=n(r.child(e),t,i)}),i.getChild(r).isEmpty()||null===o||(i=i.updateChild(r.child(".priority"),o)),i}}(Ds.Empty,this.writeTree_,e)},yl.Empty=new yl(new Fc(null)),yl);function yl(e){this.writeTree_=e}var ml=(vl.prototype.childWrites=function(e){return new bl(e,this)},vl.prototype.addOverwrite=function(e,t,n,r){No(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},vl.prototype.addMerge=function(e,t,n){No(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},vl.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},vl.prototype.removeWrite=function(t){var n=this,e=this.allWrites_.findIndex(function(e){return e.writeId===t});No(0<=e,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[e];this.allWrites_.splice(e,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&0<=a;){var s=this.allWrites_[a];s.visible&&(e<=a&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}return!!i&&(o?this.resetTree_():r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):Is(r.children,function(e){n.visibleWrites_=n.visibleWrites_.removeWrite(r.path.child(e))}),!0)},vl.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},vl.prototype.calcCompleteEventCache=function(t,e,n,r){if(n||r){var i=this.visibleWrites_.childCompoundWrite(t);if(!r&&i.isEmpty())return e;if(r||null!=e||i.hasCompleteWrite(Ds.Empty)){var o=vl.layerTree_(this.allWrites_,function(e){return(e.visible||r)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t),a=e||Qu.EMPTY_NODE;return o.apply(a)}return null}o=this.visibleWrites_.getCompleteNode(t);if(null!=o)return o;o=this.visibleWrites_.childCompoundWrite(t);if(o.isEmpty())return e;if(null!=e||o.hasCompleteWrite(Ds.Empty)){var a=e||Qu.EMPTY_NODE;return o.apply(a)}return null},vl.prototype.calcCompleteEventChildren=function(e,t){var n=Qu.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(Au,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(Au,function(e,t){t=i.childCompoundWrite(new Ds(e)).apply(t);n=n.updateImmediateChild(e,t)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},vl.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){No(n||r,"Either existingEventSnap or existingServerSnap must exist");e=e.child(t);if(this.visibleWrites_.hasCompleteWrite(e))return null;e=this.visibleWrites_.childCompoundWrite(e);return e.isEmpty()?r.getChild(t):e.apply(r.getChild(t))},vl.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),e=this.visibleWrites_.getCompleteNode(r);return null!=e?e:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},vl.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},vl.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e),e=s.getCompleteNode(Ds.Empty);if(null!=e)a=e;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var u=[],c=o.getCompare(),l=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),h=l.getNext();h&&u.length<r;)0!==c(h,n)&&u.push(h),h=l.getNext();return u},vl.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&e.path.child(n).contains(t))return!0;return!1},vl.prototype.resetTree_=function(){this.visibleWrites_=vl.layerTree_(this.allWrites_,vl.DefaultFilter_,Ds.Empty),0<this.allWrites_.length?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},vl.DefaultFilter_=function(e){return e.visible},vl.layerTree_=function(e,t,n){for(var r=gl.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=Ds.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=Ds.relativePath(a,n),r=r.addWrite(Ds.Empty,o.snap.getChild(s)));else{if(!o.children)throw Do("WriteRecord should have .snap or .children");n.contains(a)?(s=Ds.relativePath(n,a),r=r.addWrites(s,o.children)):a.contains(n)&&((s=Ds.relativePath(a,n)).isEmpty()?r=r.addWrites(Ds.Empty,o.children):(o=ta(o.children,s.getFront()))&&(s=o.getChild(s.popFront()),r=r.addWrite(Ds.Empty,s)))}}}return r},vl);function vl(){this.visibleWrites_=gl.Empty,this.allWrites_=[],this.lastWriteId_=-1}var bl=(_l.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},_l.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},_l.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},_l.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},_l.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},_l.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},_l.prototype.child=function(e){return new _l(this.treePath_.child(e),this.writeTree_)},_l);function _l(e,t){this.treePath_=e,this.writeTree_=t}var wl=(El.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new Vc(Oc.User,e,t)):[]},El.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);t=Fc.fromObject(t);return this.applyOperationToSyncPoints_(new Kc(Oc.User,e,t))},El.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=Fc.Empty;return null!=n.snap?r=r.set(Ds.Empty,!0):Is(n.children,function(e,t){r=r.set(new Ds(e),t)}),this.applyOperationToSyncPoints_(new Lc(n.path,r,t))}return[]},El.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new Vc(Oc.Server,e,t))},El.prototype.applyServerMerge=function(e,t){t=Fc.fromObject(t);return this.applyOperationToSyncPoints_(new Kc(Oc.Server,e,t))},El.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new qc(Oc.Server,e))},El.prototype.applyTaggedQueryOverwrite=function(e,t,n){var r=this.queryKeyForTag_(n);if(null==r)return[];n=El.parseQueryKey_(r),r=n.path,n=n.queryId,e=Ds.relativePath(r,e),t=new Vc(Oc.forServerTaggedQuery(n),e,t);return this.applyTaggedOperation_(r,t)},El.prototype.applyTaggedQueryMerge=function(e,t,n){var r=this.queryKeyForTag_(n);if(r){n=El.parseQueryKey_(r),r=n.path,n=n.queryId,e=Ds.relativePath(r,e),t=Fc.fromObject(t),t=new Kc(Oc.forServerTaggedQuery(n),e,t);return this.applyTaggedOperation_(r,t)}return[]},El.prototype.applyTaggedListenComplete=function(e,t){var n=this.queryKeyForTag_(t);if(n){t=El.parseQueryKey_(n),n=t.path,t=t.queryId,e=Ds.relativePath(n,e),e=new qc(Oc.forServerTaggedQuery(t),e);return this.applyTaggedOperation_(n,e)}return[]},El.prototype.addEventRegistration=function(e,t){var n=e.path,r=null,i=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){e=Ds.relativePath(e,n);r=r||t.getCompleteServerCache(e),i=i||t.hasCompleteView()});var o=this.syncPointTree_.get(n);o?(i=i||o.hasCompleteView(),r=r||o.getCompleteServerCache(Ds.Empty)):(o=new pl,this.syncPointTree_=this.syncPointTree_.set(n,o)),null!=r?c=!0:(c=!1,r=Qu.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){t=t.getCompleteServerCache(Ds.Empty);t&&(r=r.updateImmediateChild(e,t))}));var a,s=o.viewExistsForQuery(e);s||e.getQueryParams().loadsAllData()||(u=El.makeQueryKey_(e),No(!this.queryToTagMap.has(u),"View does not exist, but we have a tag"),a=El.getNextQueryTag_(),this.queryToTagMap.set(u,a),this.tagToQueryMap.set(a,u));var u=this.pendingWriteTree_.childWrites(n),c=o.addEventRegistration(e,t,u,r,c);return s||i||(o=o.viewForQuery(e),c=c.concat(this.setupListener_(e,o))),c},El.prototype.removeEventRegistration=function(e,t,n){var r=this,i=e.path,o=this.syncPointTree_.get(i),a=[];if(o&&("default"===e.queryIdentifier()||o.viewExistsForQuery(e))){var s=o.removeEventRegistration(e,t,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i));t=s.removed,a=s.events,o=-1!==t.findIndex(function(e){return e.getQueryParams().loadsAllData()}),s=this.syncPointTree_.findOnPath(i,function(e,t){return t.hasCompleteView()});if(o&&!s){i=this.syncPointTree_.subtree(i);if(!i.isEmpty())for(var u=this.collectDistinctViewsForSubTree_(i),c=0;c<u.length;++c){var l=u[c],h=l.getQuery(),l=this.createListenerForView_(l);this.listenProvider_.startListening(El.queryForListening_(h),this.tagForQuery_(h),l.hashFn,l.onComplete)}}!s&&0<t.length&&!n&&(o?this.listenProvider_.stopListening(El.queryForListening_(e),null):t.forEach(function(e){var t=r.queryToTagMap.get(El.makeQueryKey_(e));r.listenProvider_.stopListening(El.queryForListening_(e),t)})),this.removeTags_(t)}return a},El.prototype.calcCompleteEventCache=function(n,e){var t=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(n,function(e,t){e=Ds.relativePath(e,n),e=t.getCompleteServerCache(e);if(e)return e});return t.calcCompleteEventCache(n,r,e,!0)},El.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),Is(n,function(e,t){r=r.concat(t)}),r})},El.prototype.removeTags_=function(e){for(var t=0;t<e.length;++t){var n,r=e[t];r.getQueryParams().loadsAllData()||(n=El.makeQueryKey_(r),r=this.queryToTagMap.get(n),this.queryToTagMap.delete(n),this.tagToQueryMap.delete(r))}},El.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},El.prototype.setupListener_=function(e,t){var n=e.path,r=this.tagForQuery_(e),t=this.createListenerForView_(t),t=this.listenProvider_.startListening(El.queryForListening_(e),r,t.hashFn,t.onComplete),n=this.syncPointTree_.subtree(n);if(r)No(!n.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var i=n.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),Is(n,function(e,t){r=r.concat(t)}),r}),o=0;o<i.length;++o){var a=i[o];this.listenProvider_.stopListening(El.queryForListening_(a),this.tagForQuery_(a))}return t},El.prototype.createListenerForView_=function(e){var t=this,n=e.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(e.getServerCache()||Qu.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);e=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");n=new Error(e+" at "+t.path.toString()+": "+n);return n.code=e.toUpperCase(),n}(e,n);return t.removeEventRegistration(n,null,e)}}},El.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},El.parseQueryKey_=function(e){var t=e.indexOf("$");return No(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ds(e.substr(0,t))}},El.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},El.prototype.tagForQuery_=function(e){e=El.makeQueryKey_(e);return this.queryToTagMap.get(e)},El.getNextQueryTag_=function(){return El.nextQueryTag_++},El.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);No(n,"Missing sync point for query tag that we're tracking");e=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,e,null)},El.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Ds.Empty))},El.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(Ds.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Ds.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);return u&&s&&(t=n?n.getImmediateChild(a):null,a=r.child(a),o=o.concat(this.applyOperationHelper_(s,u,t,a))),i&&(o=o.concat(i.applyOperation(e,r,n))),o},El.prototype.applyOperationDescendantsHelper_=function(i,e,o,a){var s=this,t=e.get(Ds.Empty);null==o&&null!=t&&(o=t.getCompleteServerCache(Ds.Empty));var u=[];return e.children.inorderTraversal(function(e,t){var n=o?o.getImmediateChild(e):null,r=a.child(e),e=i.operationForChild(e);e&&(u=u.concat(s.applyOperationDescendantsHelper_(e,t,n,r)))}),t&&(u=u.concat(t.applyOperation(i,a,o))),u},El.nextQueryTag_=1,El);function El(e){this.listenProvider_=e,this.syncPointTree_=Fc.Empty,this.pendingWriteTree_=new ml,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}var Tl=(Il.prototype.getNode=function(e){return this.rootNode_.getChild(e)},Il.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},Il);function Il(){this.rootNode_=Qu.EMPTY_NODE}var Sl=(Cl.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),ea(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},Cl.prototype.get=function(){return Oo(this.counters_)},Cl);function Cl(){this.counters_={}}var kl=(Al.getCollection=function(e){e=e.toString();return this.collections_[e]||(this.collections_[e]=new Sl),this.collections_[e]},Al.getOrCreateReporter=function(e,t){e=e.toString();return this.reporters_[e]||(this.reporters_[e]=t()),this.reporters_[e]},Al.collections_={},Al.reporters_={},Al);function Al(){}var Nl=(Dl.prototype.get=function(){var e=this.collection_.get(),n=bo({},e);return this.last_&&Is(this.last_,function(e,t){n[e]=n[e]-t}),this.last_=e,n},Dl);function Dl(e){this.collection_=e,this.last_=null}var Rl=(Ol.prototype.includeStat=function(e){this.statsToReport_[e]=!0},Ol.prototype.reportStats_=function(){var n=this,e=this.statsListener_.get(),r={},i=!1;Is(e,function(e,t){0<t&&ea(n.statsToReport_,e)&&(r[e]=t,i=!0)}),i&&this.server_.reportStats(r),ks(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},Ol);function Ol(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Nl(e);e=1e4+2e4*Math.random();ks(this.reportStats_.bind(this),Math.floor(e))}var Pl=(xl.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new Ll(i)),t.add(r)}t&&this.eventLists_.push(t)},xl.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},xl.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},xl.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1)}t&&(this.eventLists_=[]),this.recursionDepth_--},xl);function xl(){this.eventLists_=[],this.recursionDepth_=0}var Ll=(Ml.prototype.add=function(e){this.events_.push(e)},Ml.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t,n=this.events_[e];null!==n&&(this.events_[e]=null,t=n.getEventRunner(),ys&&vs("event: "+n.toString()),Cs(t))}},Ml.prototype.getPath=function(){return this.path_},Ml);function Ml(e){this.path_=e,this.events_=[]}Fl.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Io(this.listeners_[e]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},Fl.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});e=this.getInitialEvent(e);e&&t.apply(n,e)},Fl.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},Fl.prototype.validateEventType_=function(t){No(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},de=Fl;function Fl(e){this.allowedEvents_=e,this.listeners_={},No(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}var Ul,ql=(vo(jl,Ul=de),jl.getInstance=function(){return new jl},jl.prototype.getInitialEvent=function(e){return No("visible"===e,"Unknown event type: "+e),[this.visible_]},jl);function jl(){var t,e,n=Ul.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,e&&document.addEventListener(e,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}var Vl,Bl=(vo(Kl,Vl=de),Kl.getInstance=function(){return new Kl},Kl.prototype.getInitialEvent=function(e){return No("online"===e,"Unknown event type: "+e),[this.online_]},Kl.prototype.currentlyOnline=function(){return this.online_},Kl);function Kl(){var e=Vl.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Fo()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}var Wl=(zl.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},zl.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&Cs(function(){n.onMessage_(t[e])})}(e);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}())break}},zl);function zl(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}var Hl="pLPCommand",Gl="pRTLPCB",Ql=(Yl.prototype.open=function(e,t){var n,r,i,a=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Wl(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){a.log_("Timed out trying to connect."),a.onClosed_(),a.connectTimeoutTimer_=null},Math.floor(3e4)),n=function(){var e;a.isClosed_||(a.scriptTagHolder=new Xl(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=To(e,5),r=n[0],i=n[1],o=n[2];n[3],n[4];if(a.incrementIncomingBytes_(e),a.scriptTagHolder)if(a.connectTimeoutTimer_&&(clearTimeout(a.connectTimeoutTimer_),a.connectTimeoutTimer_=null),a.everConnected_=!0,"start"===r)a.id=i,a.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(a.scriptTagHolder.sendNewPolls=!1,a.myPacketOrderer.closeAfter(i,function(){a.onClosed_()})):a.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=To(e,2),r=n[0],n=n[1];a.incrementIncomingBytes_(e),a.myPacketOrderer.handleResponse(r,n)},function(){a.onClosed_()},a.urlFn),(e={start:"t"}).ser=Math.floor(1e8*Math.random()),a.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=a.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",a.transportSessionId&&(e.s=a.transportSessionId),a.lastSessionId&&(e.ls=a.lastSessionId),a.applicationId&&(e.p=a.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(xs)&&(e.r="f"),e=a.urlFn(e),a.log_("Connecting via long-poll to "+e),a.scriptTagHolder.addTag(e,function(){}))},"complete"===document.readyState?n():(r=!1,i=function(){document.body?r||(r=!0,n()):setTimeout(i,Math.floor(10))},document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&i()}),window.attachEvent("onload",i)))},Yl.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},Yl.forceAllow=function(){Yl.forceAllow_=!0},Yl.forceDisallow=function(){Yl.forceDisallow_=!0},Yl.isAvailable=function(){return!!Yl.forceAllow_||!(Yl.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},Yl.prototype.markConnectionHealthy=function(){},Yl.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},Yl.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},Yl.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},Yl.prototype.send=function(e){e=$o(e);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var e=function(e){e=Co(e);return Ro.encodeByteArray(e,!0)}(e),t=cs(e,1840),n=0;n<t.length;n++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,t.length,t[n]),this.curSegmentNum++},Yl.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},Yl.prototype.incrementIncomingBytes_=function(e){e=$o(e).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},Yl);function Yl(e,t,n,r,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bs(e),this.stats_=kl.getCollection(t),this.urlFn=function(e){return t.connectionURL(Ms,e)}}var Xl=(Jl.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||vs("No IE domain setting required")}catch(e){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},Jl.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},Jl.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},Jl.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var e=this.urlFn(e),t="",n=0;0<this.pendingSegs.length;){if(!(this.pendingSegs[0].d.length+30+t.length<=1870))break;var r=this.pendingSegs.shift(),t=t+"&seg"+n+"="+r.seg+"&ts"+n+"="+r.ts+"&d"+n+"="+r.d;n++}return e+=t,this.addLongPollTag_(e,this.currentSerial),!0}return!1},Jl.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},Jl.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);function r(){n.outstandingRequests.delete(t),n.newRequest_()}var i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},Jl.prototype.addTag=function(e,n){var r=this;setTimeout(function(){try{if(!r.sendNewPolls)return;var t=r.myIFrame.doc.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){var e=t.readyState;e&&"loaded"!==e&&"complete"!==e||(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),n())},t.onerror=function(){vs("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(t)}catch(e){}},Math.floor(1))},Jl);function Jl(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=ds(),window[Hl+this.uniqueCallbackIdentifier]=e,window[Gl+this.uniqueCallbackIdentifier]=t,this.myIFrame=Jl.createIFrame_();t="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(t='<script>document.domain="'+document.domain+'";<\/script>');var i="<html><body>"+t+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){vs("frame writing exception"),e.stack&&vs(e.stack),vs(e)}}var $l="";function Zl(e){$l=e}var eh=null;"undefined"!=typeof MozWebSocket?eh=MozWebSocket:"undefined"!=typeof WebSocket&&(eh=WebSocket);var th=(nh.connectionURL_=function(e,t,n){var r={v:"5"};return"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(xs)&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),e.connectionURL(Ls,r)},nh.prototype.open=function(t,e){var n,r=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,hs.set("previous_websocket_failure",!0);try{jo()||(n={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new eh(this.connURL,[],n))}catch(e){this.log_("Error instantiating WebSocket.");t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");e=e.message||e.data;e&&r.log_(e),r.onClosed_()}},nh.prototype.start=function(){},nh.forceDisallow=function(){nh.forceDisallow_=!0},nh.isAvailable=function(){var e,t=!1;return"undefined"!=typeof navigator&&navigator.userAgent&&((e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/))&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0)),!t&&null!==eh&&!nh.forceDisallow_},nh.previouslyFailed=function(){return hs.isInMemoryStorage||!0===hs.get("previous_websocket_failure")},nh.prototype.markConnectionHealthy=function(){hs.remove("previous_websocket_failure")},nh.prototype.appendFrame_=function(e){this.frames.push(e),this.frames.length===this.totalFrames&&(e=this.frames.join(""),this.frames=null,e=Jo(e),this.onMessage(e))},nh.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},nh.prototype.extractFrameCount_=function(e){if(No(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},nh.prototype.handleIncomingFrame=function(e){null!==this.mySock&&(e=e.data,this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames?this.appendFrame_(e):null!==(e=this.extractFrameCount_(e))&&this.appendFrame_(e))},nh.prototype.send=function(e){this.resetKeepAlive();e=$o(e);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var t=cs(e,16384);1<t.length&&this.sendString_(String(t.length));for(var n=0;n<t.length;n++)this.sendString_(t[n])},nh.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},nh.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},nh.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},nh.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},nh.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},nh.responsesRequiredToBeHealthy=2,nh.healthyTimeout=3e4,nh);function nh(e,t,n,r,i){this.connId=e,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bs(this.connId),this.stats_=kl.getCollection(t),this.connURL=nh.connectionURL_(t,r,i),this.nodeAdmin=t.nodeAdmin}var rh=(Object.defineProperty(ih,"ALL_TRANSPORTS",{get:function(){return[Ql,th]},enumerable:!1,configurable:!0}),ih.prototype.initTransports_=function(e){var t,n,r=th&&th.isAvailable(),i=r&&!th.previouslyFailed();if(e.webSocketOnly&&(r||os("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[th];else{var o=this.transports_=[];try{for(var a=Eo(ih.ALL_TRANSPORTS),s=a.next();!s.done;s=a.next()){var u=s.value;u&&u.isAvailable()&&o.push(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}},ih.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},ih.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},ih);function ih(e){this.initTransports_(e)}var oh=(ah.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));t=t.healthyTimeout||0;0<t&&(this.healthyTimeout_=ks(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&102400<e.conn_.bytesReceived?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&10240<e.conn_.bytesSent?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(t)))},ah.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},ah.prototype.disconnReceiver_=function(t){var n=this;return function(e){t===n.conn_?n.onConnectionLost_(e):t===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},ah.prototype.connReceiver_=function(t){var n=this;return function(e){2!==n.state_&&(t===n.rx_?n.onPrimaryMessageReceived_(e):t===n.secondaryConn_?n.onSecondaryMessageReceived_(e):n.log_("message on old connection"))}},ah.prototype.sendRequest=function(e){e={t:"d",d:e};this.sendData_(e)},ah.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},ah.prototype.onSecondaryControl_=function(e){"t"in e&&("a"===(e=e.t)?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_()))},ah.prototype.onSecondaryMessageReceived_=function(e){var t=us("t",e),e=us("d",e);if("c"===t)this.onSecondaryControl_(e);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(e)}},ah.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},ah.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},ah.prototype.onPrimaryMessageReceived_=function(e){var t=us("t",e),e=us("d",e);"c"===t?this.onControl_(e):"d"===t&&this.onDataMessage_(e)},ah.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},ah.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},ah.prototype.onControl_=function(e){var t=us("t",e);if("d"in e){e=e.d;if("h"===t)this.onHandshake_(e);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(e):"r"===t?this.onReset_(e):"e"===t?rs("Server Error: "+e):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rs("Unknown control packet command: "+t)}},ah.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&os("Protocol version mismatch detected"),this.tryStartUpgrade_())},ah.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},ah.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),e=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,e),ks(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},ah.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},ah.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ks(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},ah.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},ah.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},ah.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(hs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},ah.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},ah.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},ah.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},ah.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},ah);function ah(e,t,n,r,i,o,a,s){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bs("c:"+this.id+":"),this.transportManager_=new rh(t),this.log_("Connection created"),this.start_()}sh.prototype.put=function(e,t,n,r){},sh.prototype.merge=function(e,t,n,r){},sh.prototype.refreshAuthToken=function(e){},sh.prototype.onDisconnectPut=function(e,t,n){},sh.prototype.onDisconnectMerge=function(e,t,n){},sh.prototype.onDisconnectCancel=function(e,t){},sh.prototype.reportStats=function(e){},gu=sh;function sh(){}var uh,ch=1e3,lh=3e5,hh=(vo(fh,uh=gu),fh.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,t={r:r,a:e,b:t};this.log_($o(t)),No(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(t),n&&(this.requestCBHash_[r]=n)},fh.prototype.get=function(e){var n=this,r=new xo,i={p:e.path.toString(),q:e.queryObject()},t={action:"g",request:i,onComplete:function(e){var t=e.d;"ok"===e.s?(n.onDataUpdate_(i.p,t,!1,null),r.resolve(t)):r.reject(t)}};this.outstandingGets_.push(t),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=n.outstandingGets_[o];void 0!==e&&t===e&&(delete n.outstandingGets_[o],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),n.log_("get "+o+" timed out on connection"),r.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),r.promise},fh.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),No(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),No(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");n={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,n),this.connected_&&this.sendListen_(n)},fh.prototype.sendGet_=function(t){var n=this,r=this.outstandingGets_[t];this.sendRequest("g",r.request,function(e){delete n.outstandingGets_[t],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),r.onComplete&&r.onComplete(e)})},fh.prototype.sendListen_=function(r){var i=this,o=r.query,a=o.path.toString(),s=o.queryIdentifier();this.log_("Listen on "+a+" for "+s);var e={p:a};r.tag&&(e.q=o.queryObject(),e.t=r.tag),e.h=r.hashFn(),this.sendRequest("q",e,function(e){var t=e.d,n=e.s;fh.warnOnListenWarnings_(t,o),(i.listens.get(a)&&i.listens.get(a).get(s))===r&&(i.log_("listen response",e),"ok"!==n&&i.removeListen_(a,s),r.onComplete&&r.onComplete(n,t))})},fh.warnOnListenWarnings_=function(e,t){e&&"object"==typeof e&&ea(e,"w")&&(e=ta(e,"w"),Array.isArray(e)&&~e.indexOf("no_index")&&(e='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',t=t.path.toString(),os("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+e+" at "+t+" to your security rules for better performance.")))},fh.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},fh.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||function(e){e=Zo(e).claims;return"object"==typeof e&&!0===e.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},fh.prototype.tryAuth=function(){var n,e,t,r=this;this.connected_&&this.authToken_&&(e=function(e){e=Zo(e).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(n=this.authToken_)?"auth":"gauth",t={cred:n},null===this.authOverride_?t.noauth=!0:"object"==typeof this.authOverride_&&(t.authvar=this.authOverride_),this.sendRequest(e,t,function(e){var t=e.s,e=e.d||"error";r.authToken_===n&&("ok"===t?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(t,e))}))},fh.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),No(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},fh.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);e={p:e};r&&(e.q=n,e.t=r),this.sendRequest("n",e)},fh.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},fh.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},fh.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},fh.prototype.sendOnDisconnect_=function(e,t,n,r){n={p:t,d:n};this.log_("onDisconnect "+e,n),this.sendRequest(e,n,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},fh.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},fh.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},fh.prototype.putInternal=function(e,t,n,r,i){n={p:t,d:n};void 0!==i&&(n.h=i),this.outstandingPuts_.push({action:e,request:n,onComplete:r}),this.outstandingPutCount_++;r=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(r):this.log_("Buffering put: "+t)},fh.prototype.sendPut_=function(t){var n=this,r=this.outstandingPuts_[t].action,e=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,e,function(e){n.log_(r+" response",e),delete n.outstandingPuts_[t],n.outstandingPutCount_--,0===n.outstandingPutCount_&&(n.outstandingPuts_=[]),i&&i(e.s,e.d)})},fh.prototype.reportStats=function(e){var t=this;this.connected_&&(e={c:e},this.log_("reportStats",e),this.sendRequest("s",e,function(e){"ok"!==e.s&&(e=e.d,t.log_("reportStats","Error sending stats: "+e))}))},fh.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+$o(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},fh.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):rs("Unrecognized action received from server: "+$o(e)+"\nAre you using the latest client?")},fh.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},fh.prototype.scheduleConnect_=function(e){var t=this;No(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},fh.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},fh.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},fh.prototype.onRealtimeDisconnect_=function(){var e;this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()&&(this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=ch),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime()),e=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-e),e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)),this.onConnectStatus_(!1)},fh.prototype.establishConnection_=function(){var t,n,r,i,o,a,s,u,c,e,l=this;this.shouldReconnect_()&&(this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+fh.nextConnectionId_++,a=(o=this).lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},this.realtime_={close:c,sendRequest:function(e){No(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)}},e=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(e).then(function(e){s?vs("getToken() completed but was canceled"):(vs("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new oh(i,o.repoInfo_,o.applicationId_,t,n,r,function(e){os(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.log_("Failed to get token: "+e),s||(l.repoInfo_.nodeAdmin&&os(e),c())}))},fh.prototype.interrupt=function(e){vs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},fh.prototype.resume=function(e){vs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],na(this.interruptReasons_)&&(this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0))},fh.prototype.handleTimestamp_=function(e){e-=(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},fh.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},fh.prototype.onListenRevoked_=function(e,t){t=t?t.map(function(e){return Ts(e)}).join("$"):"default",t=this.removeListen_(e,t);t&&t.onComplete&&t.onComplete("permission_denied")},fh.prototype.removeListen_=function(e,t){var n,r=new Ds(e).toString();return this.listens.has(r)?(n=(e=this.listens.get(r)).get(t),e.delete(t),0===e.size&&this.listens.delete(r)):n=void 0,n},fh.prototype.onAuthRevoked_=function(e,t){vs("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},fh.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},fh.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=Eo(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,Eo(a.values())),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},fh.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+$l.replace(/\./g,"-")]=1,Fo()?e["framework.cordova"]=1:qo()&&(e["framework.reactnative"]=1),this.reportStats(e)},fh.prototype.shouldReconnect_=function(){var e=Bl.getInstance().currentlyOnline();return na(this.interruptReasons_)&&e},fh.nextPersistentConnectionId_=0,fh.nextConnectionId_=0,fh);function fh(e,t,n,r,i,o,a){var s=uh.call(this)||this;if(s.repoInfo_=e,s.applicationId_=t,s.onDataUpdate_=n,s.onConnectStatus_=r,s.onServerInfoUpdate_=i,s.authTokenProvider_=o,s.authOverride_=a,s.id=fh.nextPersistentConnectionId_++,s.log_=bs("p:"+s.id+":"),s.interruptReasons_={},s.listens=new Map,s.outstandingPuts_=[],s.outstandingGets_=[],s.outstandingPutCount_=0,s.outstandingGetCount_=0,s.onDisconnectRequestQueue_=[],s.connected_=!1,s.reconnectDelay_=ch,s.maxReconnectDelay_=lh,s.securityDebugCallback_=null,s.lastSessionId=null,s.establishConnectionTimer_=null,s.visible_=!1,s.requestCBHash_={},s.requestNumber_=0,s.realtime_=null,s.authToken_=null,s.forceTokenRefresh_=!1,s.invalidAuthTokenCount_=0,s.firstConnection_=!0,s.lastConnectionAttemptTime_=null,s.lastConnectionEstablishedTime_=null,a&&!jo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return s.scheduleConnect_(0),ql.getInstance().on("visible",s.onVisible_,s),-1===e.host.indexOf("fblocal")&&Bl.getInstance().on("online",s.onOnline_,s),s}var ph,dh=(vo(gh,ph=gu),gh.prototype.reportStats=function(e){throw new Error("Method not implemented.")},gh.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(No(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},gh.prototype.listen=function(e,t,n,r){var i=this,o=e.path.toString();this.log_("Listen called for "+o+" "+e.queryIdentifier());var a=gh.getListenId_(e,n),s={};this.listens_[a]=s;e=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(o+".json",e,function(e,t){404===e&&(e=t=null),null===e&&i.onDataUpdate_(o,t,!1,n),ta(i.listens_,a)===s&&r(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},gh.prototype.unlisten=function(e,t){t=gh.getListenId_(e,t);delete this.listens_[t]},gh.prototype.get=function(e){var n=this,t=e.getQueryParams().toRestQueryStringParameters(),r=e.path.toString(),i=new xo;return this.restRequest_(r+".json",t,function(e,t){404===e&&(e=t=null),null===e?(n.onDataUpdate_(r,t,!1,null),i.resolve(t)):i.reject(new Error(t))}),i.promise},gh.prototype.refreshAuthToken=function(e){},gh.prototype.restRequest_=function(r,i,o){var a=this;void 0===i&&(i={}),i.format="export",this.authTokenProvider_.getToken(!1).then(function(e){e=e&&e.accessToken;e&&(i.auth=e);var t=(a.repoInfo_.secure?"https://":"http://")+a.repoInfo_.host+r+"?ns="+a.repoInfo_.namespace+function(e){for(var n=[],t=0,r=Object.entries(e);t<r.length;t++){var i=r[t];!function(t,e){Array.isArray(e)?e.forEach(function(e){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}(i[0],i[1])}return n.length?"&"+n.join("&"):""}(i);a.log_("Sending REST request for "+t);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(o&&4===n.readyState){a.log_("REST Response for "+t+" received. status:",n.status,"response:",n.responseText);var e=null;if(200<=n.status&&n.status<300){try{e=Jo(n.responseText)}catch(e){os("Failed to parse JSON response for "+t+": "+n.responseText)}o(null,e)}else 401!==n.status&&404!==n.status&&os("Got unsuccessful REST response for "+t+" Status: "+n.status),o(n.status);o=null}},n.open("GET",t,!0),n.send()})},gh);function gh(e,t,n){var r=ph.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=t,r.authTokenProvider_=n,r.log_=bs("p:rest:"),r.listens_={},r}var yh="repo_interrupt",mh=(vh.prototype.start=function(){var a=this;if(this.stats_=kl.getCollection(this.repoInfo_),this.forceRestClient_||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.server_=new dh(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{$o(e)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new hh(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener(function(e){a.server_.refreshAuthToken(e)}),this.statsReporter_=kl.getOrCreateReporter(this.repoInfo_,function(){return new Rl(a.stats_,a.server_)}),this.transactionsInit_(),this.infoData_=new Tl,this.infoSyncTree_=new wl({startListening:function(e,t,n,r){var i=[],o=a.infoData_.getNode(e.path);return o.isEmpty()||(i=a.infoSyncTree_.applyServerOverwrite(e.path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new wl({startListening:function(n,e,t,r){return a.server_.listen(n,t,e,function(e,t){t=r(e,t);a.eventQueue_.raiseEventsForChangedPath(n.path,t)}),[]},stopListening:function(e,t){a.server_.unlisten(e,t)}})},vh.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},vh.prototype.name=function(){return this.repoInfo_.namespace},vh.prototype.serverTime=function(){var e=this.infoData_.getNode(new Ds(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},vh.prototype.generateServerValues=function(){return(e=(e={timestamp:this.serverTime()})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e},vh.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new Ds(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o,a=[],e=i;0<(a=r?n?(o=ra(t,function(e){return ec(e)}),this.serverSyncTree_.applyTaggedQueryMerge(i,o,r)):(o=ec(t),this.serverSyncTree_.applyTaggedQueryOverwrite(i,o,r)):n?(n=ra(t,function(e){return ec(e)}),this.serverSyncTree_.applyServerMerge(i,n)):(t=ec(t),this.serverSyncTree_.applyServerOverwrite(i,t))).length&&(e=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(e,a)},vh.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},vh.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},vh.prototype.onServerInfoUpdate_=function(e){var n=this;Is(e,function(e,t){n.updateInfo_(e,t)})},vh.prototype.updateInfo_=function(e,t){e=new Ds("/.info/"+e),t=ec(t);this.infoData_.updateSnapshot(e,t);t=this.infoSyncTree_.applyServerOverwrite(e,t);this.eventQueue_.raiseEventsForChangedPath(e,t)},vh.prototype.getNextWriteId_=function(){return this.nextWriteId_++},vh.prototype.getValue=function(n){var r=this;return this.server_.get(n).then(function(e){var t=ec(e),e=r.serverSyncTree_.applyServerOverwrite(n.path,t);return r.eventQueue_.raiseEventsAtPath(n.path,e),Promise.resolve(new ac(t,n.getRef(),n.getQueryParams().getIndex()))},function(e){r.log_("get for query "+$o(n)+" falling back to cache after error: "+e);var t=r.serverSyncTree_.calcCompleteEventCache(n.path);return t.isEmpty()?Promise.reject(new Error(e)):Promise.resolve(new ac(t,n.getRef(),n.getQueryParams().getIndex()))})},vh.prototype.setWithPriority=function(r,e,t,i){var o=this;this.log_("set",{path:r.toString(),value:e,priority:t});var n=this.generateServerValues(),e=ec(e,t),t=this.serverSyncTree_.calcCompleteEventCache(r),n=Ic(e,t,n),a=this.getNextWriteId_(),n=this.serverSyncTree_.applyUserOverwrite(r,n,a,!0);this.eventQueue_.queueEvents(n),this.server_.put(r.toString(),e.val(!0),function(e,t){var n="ok"===e;n||os("set at "+r+" failed: "+e);n=o.serverSyncTree_.ackUserWrite(a,!n);o.eventQueue_.raiseEventsForChangedPath(r,n),o.callOnCompleteCallback(i,e,t)});e=this.abortTransactions_(r);this.rerunTransactions_(e),this.eventQueue_.raiseEventsForChangedPath(e,[])},vh.prototype.update=function(i,e,o){var a=this;this.log_("update",{path:i.toString(),value:e});var s,t,n=!0,r=this.generateServerValues(),u={};Is(e,function(e,t){n=!1,u[e]=Tc(i.child(e),ec(t),a.serverSyncTree_,r)}),n?(vs("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(o,"ok")):(s=this.getNextWriteId_(),t=this.serverSyncTree_.applyUserMerge(i,u,s),this.eventQueue_.queueEvents(t),this.server_.merge(i.toString(),e,function(e,t){var n="ok"===e;n||os("update at "+i+" failed: "+e);var r=a.serverSyncTree_.ackUserWrite(s,!n),n=0<r.length?a.rerunTransactions_(i):i;a.eventQueue_.raiseEventsForChangedPath(n,r),a.callOnCompleteCallback(o,e,t)}),Is(e,function(e){e=a.abortTransactions_(i.child(e));a.rerunTransactions_(e)}),this.eventQueue_.raiseEventsForChangedPath(i,[]))},vh.prototype.runOnDisconnectEvents_=function(){var n=this;this.log_("onDisconnectEvents");var r=this.generateServerValues(),i=new Dc;this.onDisconnect_.forEachTree(Ds.Empty,function(e,t){t=Tc(e,t,n.serverSyncTree_,r);i.remember(e,t)});var o=[];i.forEachTree(Ds.Empty,function(e,t){o=o.concat(n.serverSyncTree_.applyServerOverwrite(e,t));e=n.abortTransactions_(e);n.rerunTransactions_(e)}),this.onDisconnect_=new Dc,this.eventQueue_.raiseEventsForChangedPath(Ds.Empty,o)},vh.prototype.onDisconnectCancel=function(n,r){var i=this;this.server_.onDisconnectCancel(n.toString(),function(e,t){"ok"===e&&i.onDisconnect_.forget(n),i.callOnCompleteCallback(r,e,t)})},vh.prototype.onDisconnectSet=function(n,e,r){var i=this,o=ec(e);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},vh.prototype.onDisconnectSetWithPriority=function(n,e,t,r){var i=this,o=ec(e,t);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},vh.prototype.onDisconnectUpdate=function(n,r,i){var o=this;if(na(r))return vs("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.server_.onDisconnectMerge(n.toString(),r,function(e,t){"ok"===e&&Is(r,function(e,t){t=ec(t);o.onDisconnect_.remember(n.child(e),t)}),o.callOnCompleteCallback(i,e,t)})},vh.prototype.addEventCallbackForQuery=function(e,t){t=(".info"===e.path.getFront()?this.infoSyncTree_:this.serverSyncTree_).addEventRegistration(e,t);this.eventQueue_.raiseEventsAtPath(e.path,t)},vh.prototype.removeEventCallbackForQuery=function(e,t){t=(".info"===e.path.getFront()?this.infoSyncTree_:this.serverSyncTree_).removeEventRegistration(e,t);this.eventQueue_.raiseEventsAtPath(e.path,t)},vh.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(yh)},vh.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(yh)},vh.prototype.stats=function(e){var i;void 0===e&&(e=!1),"undefined"!=typeof console&&(e=e?(this.statsListener_||(this.statsListener_=new Nl(this.stats_)),this.statsListener_.get()):this.stats_.get(),i=Object.keys(e).reduce(function(e,t){return Math.max(t.length,e)},0),Is(e,function(e,t){for(var n=e,r=e.length;r<i+2;r++)n+=" ";console.log(n+t)}))},vh.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},vh.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),vs.apply(void 0,Io([n],e))},vh.prototype.callOnCompleteCallback=function(n,r,i){n&&Cs(function(){var e,t;"ok"===r?n(null):(t=e=(r||"error").toUpperCase(),i&&(t+=": "+i),(t=new Error(t)).code=e,n(t))})},Object.defineProperty(vh.prototype,"database",{get:function(){return this.__database||(this.__database=new qh(this))},enumerable:!1,configurable:!0}),vh);function vh(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Pl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Dc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}var bh=(_h.prototype.getStartPost=function(){return this.startPost_},_h.prototype.getEndPost=function(){return this.endPost_},_h.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},_h.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new lu(t,n))||(n=Qu.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},_h.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Qu.EMPTY_NODE);var r=(r=t.withIndex(this.index_)).updatePriority(Qu.EMPTY_NODE),i=this;return t.forEachChild(Au,function(e,t){i.matches(new lu(e,t))||(r=r.updateImmediateChild(e,Qu.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},_h.prototype.updatePriority=function(e,t){return e},_h.prototype.filtersNodes=function(){return!0},_h.prototype.getIndexedFilter=function(){return this.indexedFilter_},_h.prototype.getIndex=function(){return this.index_},_h.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},_h.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},_h);function _h(e){this.indexedFilter_=new Jc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_h.getStartPost_(e),this.endPost_=_h.getEndPost_(e)}var wh=(Eh.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new lu(t,n))||(n=Qu.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},Eh.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Qu.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Qu.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Qu.EMPTY_NODE);var s,u=void 0,c=void 0,l=void 0,i=void 0;l=this.reverse_?(i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost(),s=this.index_.getCompare(),function(e,t){return s(t,e)}):(i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),this.index_.getCompare());for(var o=0,h=!1;i.hasNext();){a=i.getNext();!h&&l(u,a)<=0&&(h=!0),h&&o<this.limit_&&l(a,c)<=0?o++:r=r.updateImmediateChild(a.name,Qu.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},Eh.prototype.updatePriority=function(e,t){return e},Eh.prototype.filtersNodes=function(){return!0},Eh.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},Eh.prototype.getIndex=function(){return this.index_},Eh.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o,a;a=this.reverse_?(o=this.index_.getCompare(),function(e,t){return o(t,e)}):this.index_.getCompare();var s=e;No(s.numChildren()===this.limit_,"");var u=new lu(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:a(f,u);if(l&&!n.isEmpty()&&0<=p)return null!=i&&i.trackChildChange(Yc.childChangedChange(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(Yc.childRemovedChange(t,h));h=s.updateImmediateChild(t,Qu.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Yc.childAddedChange(f.name,f.node)),h.updateImmediateChild(f.name,f.node)):h}return!n.isEmpty()&&l&&0<=a(c,u)?(null!=i&&(i.trackChildChange(Yc.childRemovedChange(c.name,c.node)),i.trackChildChange(Yc.childAddedChange(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,Qu.EMPTY_NODE)):e},Eh);function Eh(e){this.rangedFilter_=new bh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}var Th=(Ih.prototype.hasStart=function(){return this.startSet_},Ih.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===Ih.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},Ih.prototype.getIndexStartValue=function(){return No(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},Ih.prototype.getIndexStartName=function(){return No(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:_s},Ih.prototype.hasEnd=function(){return this.endSet_},Ih.prototype.getIndexEndValue=function(){return No(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},Ih.prototype.getIndexEndName=function(){return No(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ws},Ih.prototype.hasLimit=function(){return this.limitSet_},Ih.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},Ih.prototype.getLimit=function(){return No(this.limitSet_,"Only valid if limit has been set"),this.limit_},Ih.prototype.getIndex=function(){return this.index_},Ih.prototype.copy_=function(){var e=new Ih;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},Ih.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},Ih.prototype.limitToFirst=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=Ih.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,t},Ih.prototype.limitToLast=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=Ih.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,t},Ih.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},Ih.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},Ih.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},Ih.prototype.getQueryObject=function(){var e,t=Ih.WIRE_PROTOCOL_CONSTANTS_,n={};return this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_&&(n[t.LIMIT]=this.limit_,""===(e=this.viewFrom_)&&(e=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=e),this.index_!==Au&&(n[t.INDEX]=this.index_.toString()),n},Ih.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},Ih.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Au},Ih.prototype.getNodeFilter=function(){return this.loadsAllData()?new Jc(this.getIndex()):new(this.hasLimit()?wh:bh)(this)},Ih.prototype.toRestQueryStringParameters=function(){var e,t=Ih.REST_QUERY_CONSTANTS_,n={};return this.isDefault()||(e=this.index_===Au?t.PRIORITY_INDEX:this.index_===rc?t.VALUE_INDEX:this.index_===vu?t.KEY_INDEX:(No(this.index_ instanceof ic,"Unrecognized index type!"),this.index_.toString()),n[t.ORDER_BY]=$o(e),this.startSet_&&(n[t.START_AT]=$o(this.indexStartValue_),this.startNameSet_&&(n[t.START_AT]+=","+$o(this.indexStartName_))),this.endSet_&&(n[t.END_AT]=$o(this.indexEndValue_),this.endNameSet_&&(n[t.END_AT]+=","+$o(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_)),n},Ih.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},Ih.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},Ih.DEFAULT=new Ih,Ih);function Ih(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Au}var Sh,Ch=(vo(kh,Sh=mc),kh.prototype.getKey=function(){return la("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},kh.prototype.child=function(e){var t,n,r,i;return la("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof Ds||(null===this.path.getFront()?(t="Reference.child",i=!(n=1),r=(r=e)&&r.replace(/^\/*\.info(\/|$)/,"/"),Qs(t,n,r,i)):Qs("Reference.child",1,e,!1)),new kh(this.repo,this.path.child(e))},kh.prototype.getParent=function(){la("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new kh(this.repo,e)},kh.prototype.getRoot=function(){la("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},kh.prototype.databaseProp=function(){return this.repo.database},kh.prototype.set=function(e,t){la("Reference.set",1,2,arguments.length),Ys("Reference.set",this.path),Ks("Reference.set",1,e,this.path,!1),fa("Reference.set",2,t,!0);var n=new xo;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},kh.prototype.update=function(e,t){if(la("Reference.update",1,2,arguments.length),Ys("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,os("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ws("Reference.update",1,e,this.path,!1),fa("Reference.update",2,t,!0);var i=new xo;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},kh.prototype.setWithPriority=function(e,t,n){if(la("Reference.setWithPriority",2,3,arguments.length),Ys("Reference.setWithPriority",this.path),Ks("Reference.setWithPriority",1,e,this.path,!1),zs("Reference.setWithPriority",2,t,!1),fa("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new xo;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},kh.prototype.remove=function(e){return la("Reference.remove",0,1,arguments.length),Ys("Reference.remove",this.path),fa("Reference.remove",1,e,!0),this.set(null,e)},kh.prototype.transaction=function(e,r,t){if(la("Reference.transaction",1,3,arguments.length),Ys("Reference.transaction",this.path),fa("Reference.transaction",1,e,!1),fa("Reference.transaction",2,r,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(ha(e,t,r)+"must be a boolean.")}("Reference.transaction",3,t,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===t&&(t=!0);var i=new xo;"function"==typeof r&&i.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,t,n){e?i.reject(e):i.resolve(new iu(t,n)),"function"==typeof r&&r(e,t,n)},t),i.promise},kh.prototype.setPriority=function(e,t){la("Reference.setPriority",1,2,arguments.length),Ys("Reference.setPriority",this.path),zs("Reference.setPriority",1,e,!1),fa("Reference.setPriority",2,t,!0);var n=new xo;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},kh.prototype.push=function(e,t){la("Reference.push",0,2,arguments.length),Ys("Reference.push",this.path),Ks("Reference.push",1,e,this.path,!0),fa("Reference.push",2,t,!0);var n=this.repo.serverTime(),r=cu(n),n=this.child(r),i=this.child(r),e=null!=e?n.set(e,t).then(function(){return i}):Promise.resolve(i);return n.then=e.then.bind(e),n.catch=e.then.bind(e,void 0),"function"==typeof t&&e.catch(function(){}),n},kh.prototype.onDisconnect=function(){return Ys("Reference.onDisconnect",this.path),new nu(this.repo,this.path)},Object.defineProperty(kh.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(kh.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(kh.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(kh.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),kh);function kh(e,t){if(!(e instanceof mh))throw new Error("new Reference() no longer supported - use app.database().");return Sh.call(this,e,t,Th.DEFAULT,!1)||this}mc.__referenceConstructor=Ch,pl.__referenceConstructor=Ch;var Ah,Nh=function(){this.children={},this.childCount=0,this.value=null},Dh=(Rh.prototype.subTree=function(e){for(var t=e instanceof Ds?e:new Ds(e),n=this,r=t.getFront();null!==r;)n=new Rh(r,n,ta(n.node_.children,r)||new Nh),r=(t=t.popFront()).getFront();return n},Rh.prototype.getValue=function(){return this.node_.value},Rh.prototype.setValue=function(e){No(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},Rh.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},Rh.prototype.hasChildren=function(){return 0<this.node_.childCount},Rh.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},Rh.prototype.forEachChild=function(n){var r=this;Is(this.node_.children,function(e,t){n(new Rh(e,r,t))})},Rh.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},Rh.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},Rh.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},Rh.prototype.path=function(){return new Ds(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},Rh.prototype.name=function(){return this.name_},Rh.prototype.parent=function(){return this.parent_},Rh.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},Rh.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=ea(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},Rh);function Rh(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new Nh),this.name_=e,this.parent_=t,this.node_=n}(ge=Ah=Ah||{})[ge.RUN=0]="RUN",ge[ge.SENT=1]="SENT",ge[ge.COMPLETED=2]="COMPLETED",ge[ge.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",ge[ge.NEEDS_ABORT=4]="NEEDS_ABORT",mh.MAX_TRANSACTION_RETRIES_=25,mh.prototype.transactionsInit_=function(){this.transactionQueueTree_=new Dh},mh.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);function i(){}var o=new Ch(this,e);o.on("value",i);var a={path:e,update:t,onComplete:n,status:null,order:ds(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},t=this.getLatestState_(e);a.currentInputSnapshot=t;var s,n=a.update(t.val());void 0===n?(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&(s=new ac(a.currentInputSnapshot,new Ch(this,a.path),Au),a.onComplete(null,!1,s))):(tu("transaction failed: Data returned ",n,a.path),a.status=Ah.RUN,(s=(r=this.transactionQueueTree_.subTree(e)).getValue()||[]).push(a),r.setValue(s),r=void 0,"object"==typeof n&&null!==n&&ea(n,".priority")?(r=ta(n,".priority"),No(Bs(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):r=(this.serverSyncTree_.calcCompleteEventCache(e)||Qu.EMPTY_NODE).getPriority().val(),s=this.generateServerValues(),r=ec(n,r),s=Ic(r,t,s),a.currentOutputSnapshotRaw=r,a.currentOutputSnapshotResolved=s,a.currentWriteId=this.getNextWriteId_(),a=this.serverSyncTree_.applyUserOverwrite(e,s,a.currentWriteId,a.applyLocally),this.eventQueue_.raiseEventsForChangedPath(e,a),this.sendReadyTransactions_())},mh.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||Qu.EMPTY_NODE},mh.prototype.sendReadyTransactions_=function(e){var t,n=this;void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()?(t=this.buildTransactionQueue_(e),No(0<t.length,"Sending zero length transaction queue"),t.every(function(e){return e.status===Ah.RUN})&&this.sendTransactionQueue_(e.path(),t)):e.hasChildren()&&e.forEachChild(function(e){n.sendReadyTransactions_(e)})},mh.prototype.sendTransactionQueue_=function(a,s){for(var u=this,e=s.map(function(e){return e.currentWriteId}),t=this.getLatestState_(a,e),n=t,e=t.hash(),r=0;r<s.length;r++){var i=s[r];No(i.status===Ah.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=Ah.SENT,i.retryCount++;var o=Ds.relativePath(a,i.path),n=n.updateChild(o,i.currentOutputSnapshotRaw)}var t=n.val(!0),c=a;this.server_.put(c.toString(),t,function(e){u.log_("transaction put response",{path:c.toString(),status:e});var t=[];if("ok"===e){for(var n,r,i=[],o=0;o<s.length;o++){s[o].status=Ah.COMPLETED,t=t.concat(u.serverSyncTree_.ackUserWrite(s[o].currentWriteId)),s[o].onComplete&&(n=s[o].currentOutputSnapshotResolved,r=new Ch(u,s[o].path),r=new ac(n,r,Au),i.push(s[o].onComplete.bind(null,null,!0,r))),s[o].unwatcher()}u.pruneCompletedTransactionsBelowNode_(u.transactionQueueTree_.subTree(a)),u.sendReadyTransactions_(),u.eventQueue_.raiseEventsForChangedPath(a,t);for(o=0;o<i.length;o++)Cs(i[o])}else{if("datastale"===e)for(o=0;o<s.length;o++)s[o].status===Ah.SENT_NEEDS_ABORT?s[o].status=Ah.NEEDS_ABORT:s[o].status=Ah.RUN;else{os("transaction at "+c.toString()+" failed: "+e);for(o=0;o<s.length;o++)s[o].status=Ah.NEEDS_ABORT,s[o].abortReason=e}u.rerunTransactions_(a)}},e)},mh.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),e=t.path(),t=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(t,e),e},mh.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],r=[],i=e.filter(function(e){return e.status===Ah.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var a,s,u,c=e[o],l=Ds.relativePath(t,c.path),h=!1,f=void 0;No(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===Ah.NEEDS_ABORT?(h=!0,f=c.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))):c.status===Ah.RUN&&(r=c.retryCount>=mh.MAX_TRANSACTION_RETRIES_?(h=!0,f="maxretry",r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))):(a=this.getLatestState_(c.path,i),c.currentInputSnapshot=a,void 0!==(u=e[o].update(a.val()))?(tu("transaction failed: Data returned ",u,c.path),s=ec(u),"object"==typeof u&&null!=u&&ea(u,".priority")||(s=s.updatePriority(a.getPriority())),l=c.currentWriteId,u=this.generateServerValues(),u=Ic(s,a,u),c.currentOutputSnapshotRaw=s,c.currentOutputSnapshotResolved=u,c.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(l),1),(r=r.concat(this.serverSyncTree_.applyUserOverwrite(c.path,u,c.currentWriteId,c.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(l,!0))):(h=!0,f="nodata",r.concat(this.serverSyncTree_.ackUserWrite(c.currentWriteId,!0))))),this.eventQueue_.raiseEventsForChangedPath(t,r),r=[],h&&(e[o].status=Ah.COMPLETED,c=e[o].unwatcher,setTimeout(c,Math.floor(0)),e[o].onComplete&&("nodata"===f?(h=new Ch(this,e[o].path),c=e[o].currentInputSnapshot,h=new ac(c,h,Au),n.push(e[o].onComplete.bind(null,null,!1,h))):n.push(e[o].onComplete.bind(null,new Error(f),!1,null))))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(o=0;o<n.length;o++)Cs(n[o]);this.sendReadyTransactions_()}},mh.prototype.getAncestorTransactionNode_=function(e){for(var t=this.transactionQueueTree_,n=e.getFront();null!==n&&null===t.getValue();)t=t.subTree(n),n=(e=e.popFront()).getFront();return t},mh.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},mh.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},mh.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==Ah.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(0<n.length?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},mh.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),e=this.transactionQueueTree_.subTree(e);return e.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(e),e.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},mh.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++){t[o].status===Ah.SENT_NEEDS_ABORT||(t[o].status===Ah.SENT?(No(i===o-1,"All SENT items should be at beginning of queue."),t[i=o].status=Ah.SENT_NEEDS_ABORT,t[o].abortReason="set"):(No(t[o].status===Ah.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))))}-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r);for(o=0;o<n.length;o++)Cs(n[o])}};var Oh=(Ph.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(vs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):Promise.resolve(null)},Ph.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout(function(){return t(null)},0),this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)}))},Ph.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},Ph.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',os(e)},Ph);function Ph(e,t){var n=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then(function(e){return n.auth_=e})}var xh=(Lh.prototype.getToken=function(e){return Promise.resolve({accessToken:Lh.EMULATOR_AUTH_TOKEN})},Lh.prototype.addTokenChangeListener=function(e){e(Lh.EMULATOR_AUTH_TOKEN)},Lh.prototype.removeTokenChangeListener=function(e){},Lh.prototype.notifyForInvalidToken=function(){},Lh.EMULATOR_AUTH_TOKEN="owner",Lh);function Lh(){}var Mh,Fh=(Uh.getInstance=function(){return Mh=Mh||new Uh},Uh.prototype.interrupt=function(){var t,e,n,r;try{for(var i=Eo(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,Eo(Object.keys(this.repos_[a]))),u=s.next();!u.done;u=s.next()){var c=u.value;this.repos_[a][c].interrupt()}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},Uh.prototype.resume=function(){var t,e,n,r;try{for(var i=Eo(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,Eo(Object.keys(this.repos_[a]))),u=s.next();!u.done;u=s.next()){var c=u.value;this.repos_[a][c].resume()}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},Uh.prototype.applyEmulatorSettings=function(e,t,n){e.repoInfo_=new Fs(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),e.repoInfo_.nodeAdmin&&(e.authTokenProvider_=new xh)},Uh.prototype.databaseFromApp=function(e,t,n,r){var i=n||e.options.databaseURL;void 0===i&&(e.options.projectId||is("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vs("Using default host for project ",e.options.projectId),i=e.options.projectId+"-default-rtdb.firebaseio.com");var o,a=qs(i,r),s=a.repoInfo,n=void 0;"undefined"!=typeof process&&(n=process.env.FIREBASE_DATABASE_EMULATOR_HOST),n?(o=!0,i="http://"+n+"?ns="+s.namespace,s=(a=qs(i,r)).repoInfo):o=!a.repoInfo.secure;t=r&&o?new xh:new Oh(e,t);return Xs("Invalid Firebase Database URL",1,a),a.path.isEmpty()||is("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(s,e,t).database},Uh.prototype.deleteRepo=function(e){var t=ta(this.repos_,e.app.name);t&&ta(t,e.key)===e||is("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.key]},Uh.prototype.createRepo=function(e,t,n){var r=ta(this.repos_,t.name);r||(r={},this.repos_[t.name]=r);var i=ta(r,e.toURLString());return i&&is("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new mh(e,this.useRestClient_,t,n),r[e.toURLString()]=i},Uh.prototype.forceRestClient=function(e){this.useRestClient_=e},Uh);function Uh(){this.repos_={},this.useRestClient_=!1}var qh=(Object.defineProperty(jh.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new Ch(this.repo_,Ds.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),jh.prototype.useEmulator=function(e,t){this.checkDeleted_("useEmulator"),this.instanceStarted_?is("Cannot call useEmulator() after instance has already been initialized."):Fh.getInstance().applyEmulatorSettings(this.repoInternal_,e,t)},jh.prototype.ref=function(e){return this.checkDeleted_("ref"),la("database.ref",0,1,arguments.length),e instanceof Ch?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},jh.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),la(t,1,1,arguments.length);var n=qs(e,this.repo_.repoInfo_.nodeAdmin);Xs(t,1,n);e=n.repoInfo;return e.isCustomHost()||e.host===this.repo_.repoInfo_.host||is(t+": Host name does not match the current database: (found "+e.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},jh.prototype.checkDeleted_=function(e){null===this.repoInternal_&&is("Cannot call "+e+" on a deleted database.")},jh.prototype.goOffline=function(){la("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},jh.prototype.goOnline=function(){la("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},jh.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},jh);function jh(e){var t=this;this.repoInternal_=e,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return _o(t,void 0,void 0,function(){return wo(this,function(e){return this.checkDeleted_("delete"),Fh.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]})})}},e instanceof mh||is("Don't call new Database() directly - please use firebase.database().")}var Vh=Object.freeze({__proto__:null,forceLongPolling:function(){th.forceDisallow(),Ql.forceAllow()},forceWebSockets:function(){Ql.forceDisallow()},isWebSocketsAvailable:function(){return th.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace,e=void 0!==(e=e.nodeAdmin)&&e;return Zl(r),(r=new Ta("auth-internal",new Sa("database-standalone"))).setComponent(new _a("auth-internal",function(){return i},"PRIVATE")),{instance:Fh.getInstance().databaseFromApp(t,r,n,e),namespace:o}}}),Gn=hh;hh.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},hh.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Bh,Kh=Object.freeze({__proto__:null,DataConnection:Gn,RealTimeConnection:oh,hijackHash:function(i){var o=hh.prototype.put;return hh.prototype.put=function(e,t,n,r){void 0!==r&&(r=i()),o.call(this,e,t,n,r)},function(){hh.prototype.put=o}},ConnectionTarget:Fs,queryIdentifier:function(e){return e.queryIdentifier()},forceRestClient:function(e){Fh.getInstance().forceRestClient(e)}}),Wh=qh.ServerValue;Zl((Bh=Jh).SDK_VERSION),Bh.INTERNAL.registerComponent(new _a("database",function(e,t){var n=e.getProvider("app").getImmediate(),e=e.getProvider("auth-internal");return Fh.getInstance().databaseFromApp(n,e,t)},"PUBLIC").setServiceProps({Reference:Ch,Query:mc,Database:qh,DataSnapshot:ac,enableLogging:ns,INTERNAL:Vh,ServerValue:Wh,TEST_ACCESS:Kh}).setMultipleInstances(!0)),Bh.registerVersion("@firebase/database","0.8.1-1.0.0-eap-firestore-debug.9c6096f43");var zh=function(e,t){return(zh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Hh(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var de="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Gh={},Qh=de||self;function Yh(){}function Xh(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function $h(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Zh="closure_uid_"+(1e9*Math.random()>>>0),ef=0;function tf(e,t,n){return e.call.apply(e.bind,arguments)}function nf(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function rf(e,t,n){return(rf=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?tf:nf).apply(null,arguments)}function of(t){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function af(){return Date.now()}function sf(e,o){function t(){}t.prototype=o.prototype,e.X=o.prototype,e.prototype=new t,(e.prototype.constructor=e).Kb=function(e,t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[t].apply(e,r)}}function uf(){this.j=this.j,this.i=this.i}uf.prototype.j=!1,uf.prototype.ja=function(){var e;!this.j&&(this.j=!0,this.G(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Zh)&&e[Zh]||(e[Zh]=++ef))},uf.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var cf=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},lf=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function hf(){return Array.prototype.concat.apply([],arguments)}function ff(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function pf(e){return/^[\s\xa0]*$/.test(e)}var df,gf=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function yf(e,t){return-1!=e.indexOf(t)}function mf(e,t){return e<t?-1:t<e?1:0}e:{var vf=Qh.navigator;if(vf){vf=vf.userAgent;if(vf){df=vf;break e}}df=""}function bf(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function _f(e){var t,n={};for(t in e)n[t]=e[t];return n}var wf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ef(e){for(var t,n,r=1;r<arguments.length;r++){for(t in n=arguments[r])e[t]=n[t];for(var i=0;i<wf.length;i++)t=wf[i],Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}}function Tf(e){return Tf[" "](e),e}Tf[" "]=Yh;var If,Sf=yf(df,"Opera"),Cf=yf(df,"Trident")||yf(df,"MSIE"),kf=yf(df,"Edge"),Af=kf||Cf,Nf=yf(df,"Gecko")&&!(yf(df.toLowerCase(),"webkit")&&!yf(df,"Edge"))&&!(yf(df,"Trident")||yf(df,"MSIE"))&&!yf(df,"Edge"),Df=yf(df.toLowerCase(),"webkit")&&!yf(df,"Edge");function Rf(){var e=Qh.document;return e?e.documentMode:void 0}e:{var Of="",Pf=(Pf=df,Nf?/rv:([^\);]+)(\)|;)/.exec(Pf):kf?/Edge\/([\d\.]+)/.exec(Pf):Cf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Pf):Df?/WebKit\/(\S+)/.exec(Pf):Sf?/(?:Version)[ \/]?(\S+)/.exec(Pf):void 0);if(Pf&&(Of=Pf?Pf[1]:""),Cf){Pf=Rf();if(null!=Pf&&Pf>parseFloat(Of)){If=String(Pf);break e}}If=Of}var xf={};function Lf(s){return e=s,t=function(){for(var e=0,t=gf(String(If)).split("."),n=gf(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=mf(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||mf(0==o[2].length,0==a[2].length)||mf(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e},n=xf,Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e);var e,t,n}var Mf=Qh.document&&Cf?Rf()||(parseInt(If,10)||void 0):void 0,Ff=!Cf||9<=Number(Mf),Uf=Cf&&!Lf("9"),qf=function(){if(!Qh.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Qh.addEventListener("test",Yh,t),Qh.removeEventListener("test",Yh,t)}catch(e){}return e}();function jf(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function Vf(e,t){if(jf.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(Nf){e:{try{Tf(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Bf[e.pointerType]||"",(this.c=e).defaultPrevented&&this.b()}}jf.prototype.b=function(){this.defaultPrevented=!0},sf(Vf,jf);var Bf={2:"touch",3:"pen",4:"mouse"};Vf.prototype.b=function(){Vf.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Uf)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}};var Kf="closure_listenable_"+(1e6*Math.random()|0),Wf=0;function zf(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++Wf,this.Y=this.Z=!1}function Hf(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function Gf(e){this.src=e,this.a={},this.b=0}function Qf(e,t){var n,r,i,o=t.type;o in e.a&&(n=e.a[o],(i=0<=(r=cf(n,t)))&&Array.prototype.splice.call(n,r,1),i&&(Hf(t),0==e.a[o].length&&(delete e.a[o],e.b--)))}function Yf(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.ca==r)return i}return-1}Gf.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Yf(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new zf(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var Xf="closure_lm_"+(1e6*Math.random()|0),Jf={};function $f(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}r=ap(r);return t&&t[Kf]?t.wa(n,r,$h(i)?!!i.capture:!!i,o):Zf(t,n,r,!0,i,o)}(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)$f(e,t[o],n,r,i);return null}return n=ap(n),e&&e[Kf]?e.va(t,n,$h(r)?!!r.capture:!!r,i):Zf(e,t,n,!1,r,i)}function Zf(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=$h(i)?!!i.capture:!!i;if(a&&!Ff)return null;var s,u,c=ip(e);if(c||(e[Xf]=c=new Gf(e)),(n=c.add(t,n,r,a,o)).proxy)return n;if(s=rp,r=u=Ff?function(e){return s.call(u.src,u.listener,e)}:function(e){if(!(e=s.call(u.src,u.listener,e)))return e},(n.proxy=r).src=e,r.listener=n,e.addEventListener)qf||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(tp(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ep(e){var t,n,r;"number"!=typeof e&&e&&!e.Y&&((t=e.src)&&t[Kf]?Qf(t.c,e):(n=e.type,r=e.proxy,t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(tp(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ip(t))?(Qf(n,e),0==n.b&&(n.src=null,t[Xf]=null)):Hf(e)))}function tp(e){return e in Jf?Jf[e]:Jf[e]="on"+e}function np(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&ep(e),n.call(r,t)}function rp(e,t){if(e.Y)return!0;if(Ff)return np(e,new Vf(t,this));if(!t)e:{t=["window","event"];for(var n=Qh,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return np(e,t=new Vf(t,this))}function ip(e){return(e=e[Xf])instanceof Gf?e:null}var op="__closure_events_fn_"+(1e9*Math.random()>>>0);function ap(t){return"function"==typeof t?t:(t[op]||(t[op]=function(e){return t.handleEvent(e)}),t[op])}function sp(){uf.call(this),this.c=new Gf(this),(this.J=this).C=null}function up(e,t){var n,r=e.C;if(r)for(n=[];r;r=r.C)n.push(r);if(e=e.J,r=t.type||t,"string"==typeof t?t=new jf(t,e):t instanceof jf?t.target=t.target||e:(a=t,Ef(t=new jf(r,e),a)),a=!0,n)for(var i=n.length-1;0<=i;i--)var o=t.a=n[i],a=cp(o,r,!0,t)&&a;if(a=cp(o=t.a=e,r,!0,t)&&a,a=cp(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=cp(o=t.a=n[i],r,!1,t)&&a}function cp(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a,s,u=t[o];u&&!u.Y&&u.capture==n&&(a=u.listener,s=u.ca||u.src,u.Z&&Qf(e.c,u),i=!1!==a.call(s,r)&&i)}return i&&!r.defaultPrevented}sf(sp,uf),sp.prototype[Kf]=!0,(gu=sp.prototype).addEventListener=function(e,t,n,r){$f(this,e,t,n,r)},gu.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=$h(i)?!!i.capture:!!i,r=ap(r),t&&t[Kf]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=Yf(a=t.a[n],r,i,o))&&(Hf(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):(t=t&&ip(t))&&(n=t.a[n.toString()],t=-1,n&&(t=Yf(n,r,i,o)),(r=-1<t?n[t]:null)&&ep(r))}(this,e,t,n,r)},gu.G=function(){if(sp.X.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)Hf(n[r]);delete t.a[e],t.b--}}this.C=null},gu.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},gu.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var lp=Qh.JSON.stringify;function hp(){this.b=this.a=null}var fp,pp=(dp.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},new dp(function(){return new gp},function(e){e.reset()}));function dp(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function gp(){this.next=this.b=this.a=null}function yp(e,t){var n;fp||(n=Qh.Promise.resolve(void 0),fp=function(){n.then(bp)}),mp||(fp(),mp=!0),vp.add(e,t)}hp.prototype.add=function(e,t){var n=pp.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},gp.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null};var mp=!(gp.prototype.reset=function(){this.next=this.b=this.a=null}),vp=new hp;function bp(){for(var e,t;n=t=void 0,n=null,(t=vp).a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),e=n;){try{e.a.call(e.b)}catch(e){!function(e){Qh.setTimeout(function(){throw e},0)}(e)}var n=pp;n.f(e),n.b<100&&(n.b++,e.next=n.a,n.a=e)}mp=!1}function _p(e,t){sp.call(this),this.b=e||1,this.a=t||Qh,this.f=rf(this.Za,this),this.g=af()}function wp(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function Ep(e,t,n){if("function"==typeof e)n&&(e=rf(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=rf(e.handleEvent,e)}return 2147483647<Number(t)?-1:Qh.setTimeout(e,t||0)}sf(_p,sp),(gu=_p.prototype).aa=!1,gu.M=null,gu.Za=function(){var e;this.aa&&(0<(e=af()-this.g)&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),up(this,"tick"),this.aa&&(wp(this),this.start())))},gu.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=af())},gu.G=function(){_p.X.G.call(this),wp(this),delete this.a};var Tp,Ip,Sp,Cp=(zh(Ip=Ap,Sp=Tp=uf),Ip.prototype=null===Sp?Object.create(Sp):(kp.prototype=Sp.prototype,new kp),Ap.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:function e(t){t.a=Ep(function(){t.a=null,t.c&&(t.c=!1,e(t))},t.h);var n=t.b;t.b=null,t.g.apply(null,n)}(this)},Ap.prototype.G=function(){Tp.prototype.G.call(this),this.a&&(Qh.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},Ap);function kp(){this.constructor=Ip}function Ap(e,t){var n=Tp.call(this)||this;return n.g=e,n.h=t,n.b=null,n.c=!1,n.a=null,n}function Np(e){uf.call(this),this.b=e,this.a={}}sf(Np,uf);var Dp=[];function Rp(e,t,n,r){Array.isArray(n)||(n&&(Dp[0]=n.toString()),n=Dp);for(var i=0;i<n.length;i++){var o=$f(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Op(e){bf(e.a,function(e,t){this.a.hasOwnProperty(t)&&ep(e)},e),e.a={}}function Pp(){this.a=!0}function xp(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return lp(n)}catch(e){return t}}(e,n)+(r?" "+r:"")})}Np.prototype.G=function(){Np.X.G.call(this),Op(this)},Np.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Pp.prototype.info=function(){};var Lp={},Mp=null;function Fp(){return Mp=Mp||new sp}function Up(e){jf.call(this,Lp.Fa,e)}function qp(e){var t=Fp();up(t,new Up(t))}function jp(e,t){jf.call(this,Lp.STAT_EVENT,e),this.stat=t}function Vp(e){var t=Fp();up(t,new jp(t,e))}function Bp(e){jf.call(this,Lp.Ga,e)}function Kp(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Qh.setTimeout(function(){e()},t)}Lp.Fa="serverreachability",sf(Up,jf),Lp.STAT_EVENT="statevent",sf(jp,jf),Lp.Ga="timingevent",sf(Bp,jf);ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Gn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Wp(){}function zp(e){var t;return(t=e.a)||(t=e.a={}),t}function Hp(){}Wp.prototype.a=null;var Gp,de={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Qp(){jf.call(this,"d")}function Yp(){jf.call(this,"c")}function Xp(){}function Jp(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new Np(this),this.P=$p,e=Af?125:void 0,this.R=new _p(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}sf(Qp,jf),sf(Yp,jf),sf(Xp,Wp),Gp=new Xp;var $p=45e3,Zp={},ed={};function td(e,t,n){e.H=1,e.i=Ed(yd(t)),e.j=n,e.I=!0,nd(e,null)}function nd(e,t){e.u=af(),id(e),e.l=yd(e.i);var a,s,u,c,l,h,n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),Ld(n.b,"t",r),e.D=0,e.a=Ag(e.g,e.g.C?t:null),0<e.O&&(e.F=new Cp(rf(e.Ca,e,e.a),e.O)),Rp(e.J,e.a,"readystatechange",e.Xa),t=e.B?_f(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),qp(1),a=e.c,s=e.m,u=e.l,c=e.f,l=e.S,h=e.j,a.info(function(){if(a.a)if(h)for(var e="",t=h.split("&"),n=0;n<t.length;n++){var r,i,o=t[n].split("=");1<o.length&&(r=o[0],o=o[1],e=2<=(i=r.split("_")).length&&"type"==i[1]?e+(r+"=")+o+"&":e+(r+"=redacted&"))}else e=null;else e=h;return"XMLHTTP REQ ("+c+") [attempt "+l+"]: "+s+"\n"+u+"\n"+e})}function rd(e,t,n){for(var r,i,o,a=!0;!e.A&&e.D<n.length;){var s=(s=n,o=i=void 0,i=(r=e).D,-1==(o=s.indexOf("\n",i))?ed:(i=Number(s.substring(i,o)),isNaN(i)?Zp:(o+=1)+i>s.length?ed:(s=s.substr(o,i),r.D=o+i,s)));if(s==ed){4==t&&(e.h=4,Vp(14),a=!1),xp(e.c,e.f,null,"[Incomplete Response]");break}if(s==Zp){e.h=4,Vp(15),xp(e.c,e.f,n,"[Invalid Chunk]"),a=!1;break}xp(e.c,e.f,s,null),cd(e,s)}4==t&&0==n.length&&(e.h=1,Vp(16),a=!1),e.b=e.b&&a,a?0<n.length&&!e.V&&(e.V=!0,(t=e.g).a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),_g(t),t.F=!0,Vp(11))):(xp(e.c,e.f,n,"[Invalid Chunked Response]"),ud(e),sd(e))}function id(e){e.T=af()+e.P,od(e,e.P)}function od(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=Kp(rf(e.Va,e),t)}function ad(e){e.o&&(Qh.clearTimeout(e.o),e.o=null)}function sd(e){0==e.g.v||e.A||Tg(e.g,e)}function ud(e){ad(e);var t=e.F;t&&"function"==typeof t.ja&&t.ja(),e.F=null,wp(e.R),Op(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function cd(e,t){try{var n,r,i,o,a,s=e.g;if(0!=s.v&&(s.a==e||Bd(s.b,e)))if(s.I=e.N,!e.C&&Bd(s.b,e)&&3==s.v){try{var u=s.ka.a.parse(t)}catch(e){u=null}if(Array.isArray(u)&&3==u.length){var c=u;if(0==c[0]){e:if(!s.j){if(s.a){if(!(s.a.u+3e3<e.u))break e;Eg(s),hg(s)}bg(s),Vp(18)}}else s.oa=c[1],0<s.oa-s.P&&c[2]<37500&&s.H&&0==s.o&&!s.m&&(s.m=Kp(rf(s.Sa,s),6e3));if(Vd(s.b)<=1&&s.ea){try{s.ea()}catch(e){}s.ea=void 0}}else Sg(s,11)}else if(!e.C&&s.a!=e||Eg(s),!pf(t))for(t=u=s.ka.a.parse(t),u=0;u<t.length;u++){c=t[u],s.P=c[0],c=c[1],2==s.v?"c"==c[0]?(s.J=c[1],s.ga=c[2],null!=(r=c[3])&&(s.ha=r,s.c.info("VER="+s.ha)),null!=(o=c[4])&&(s.pa=o,s.c.info("SVER="+s.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,s.D=n,s.c.info("backChannelRequestTimeoutMs_="+n)),n=s,(o=e.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(yf(r,"spdy")||yf(r,"quic")||yf(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Kd(i,i.b),i.b=null)),!n.A||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=a,wd(n.B,n.A,a))),s.v=3,s.f&&s.f.ta(),s.U&&(s.N=af()-e.u,s.c.info("Handshake RTT: "+s.N+"ms")),i=e,(n=s).la=kg(n,n.C?n.ga:null,n.fa),i.C?(Wd(n.b,i),o=i,(a=n.D)&&o.setTimeout(a),o.o&&(ad(o),id(o)),n.a=i):vg(n),0<s.g.length&&dg(s)):"stop"!=c[0]&&"close"!=c[0]||Sg(s,7):3==s.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Sg(s,7):lg(s):"noop"!=c[0]&&s.f&&s.f.sa(c),s.o=0)}qp(4)}catch(e){}}function ld(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Xh(e)||"string"==typeof e)lf(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(Xh(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"==typeof e)return e.split("");if(Xh(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function hd(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof hd)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function fd(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];pd(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){for(var i={},n=t=0;t<e.a.length;)pd(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function pd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(gu=Jp.prototype).setTimeout=function(e){this.P=e},gu.Xa=function(e){e=e.target;var t=this.F;t&&3==ag(e)?t.f():this.Ca(e)},gu.Ca=function(e){try{if(e==this.a)e:{var t=ag(this.a),n=this.a.ua(),r=this.a.W();if(!(t<3||3==t&&!Af&&!this.a.$())){this.A||4!=t||7==n||qp(8==n||r<=0?3:2),ad(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,s=this.m,u=this.l,c=this.f,l=this.S,h=t,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+l+"]: "+s+"\n"+u+"\n"+h+" "+f}),this.b){if(this.U&&!this.C){t:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!pf(o)){var a=o;break t}}a=null}if(!a){this.b=!1,this.h=3,Vp(12),ud(this),sd(this);break e}xp(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,cd(this,a)}this.I?(rd(this,t,n),Af&&this.b&&3==t&&(Rp(this.J,this.R,"tick",this.Wa),this.R.start())):(xp(this.c,this.f,n,null),cd(this,n)),4==t&&ud(this),this.b&&!this.A&&(4==t?Tg(this.g,this):(this.b=!1,id(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,Vp(12)):(this.h=0,Vp(13)),ud(this),sd(this)}}}catch(e){}var s,u,c,l,h,f},gu.Wa=function(){var e,t;this.a&&(e=ag(this.a),t=this.a.$(),this.D<t.length&&(ad(this),rd(this,e,t),this.b&&4!=e&&id(this)))},gu.cancel=function(){this.A=!0,ud(this)},gu.Va=function(){this.o=null;var e,t,n=af();0<=n-this.T?(e=this.c,t=this.l,e.info(function(){return"TIMEOUT: "+t}),2!=this.H&&(qp(3),Vp(17)),ud(this),this.h=2,sd(this)):od(this,this.T-n)},(gu=hd.prototype).K=function(){fd(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},gu.L=function(){return fd(this),this.a.concat()},gu.get=function(e,t){return pd(this.b,e)?this.b[e]:t},gu.set=function(e,t){pd(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},gu.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var dd=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gd(e,t){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof gd?(this.a=void 0!==t?t:e.a,md(this,e.f),this.j=e.j,vd(this,e.c),bd(this,e.h),this.g=e.g,t=e.b,(n=new Rd).c=t.c,t.a&&(n.a=new hd(t.a),n.b=t.b),_d(this,n),this.i=e.i):e&&(n=String(e).match(dd))?(this.a=!!t,md(this,n[1]||"",!0),this.j=Td(n[2]||""),vd(this,n[3]||"",!0),bd(this,n[4]),this.g=Td(n[5]||"",!0),_d(this,n[6]||"",!0),this.i=Td(n[7]||"")):(this.a=!!t,this.b=new Rd(null,this.a))}function yd(e){return new gd(e)}function md(e,t,n){e.f=n?Td(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function vd(e,t,n){e.c=n?Td(t,!0):t}function bd(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.h=t}else e.h=null}function _d(e,t,n){var r,i;t instanceof Rd?(e.b=t,r=e.b,(i=e.a)&&!r.f&&(Od(r),r.c=null,r.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Pd(this,t),Ld(this,n,e))},r)),r.f=i):(n||(t=Id(t,Nd)),e.b=new Rd(t,e.a))}function wd(e,t,n){e.b.set(t,n)}function Ed(e){return wd(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^af()).toString(36)),e}function Td(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Id(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Sd),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Sd(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}gd.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Id(t,Cd,!0),":");var n=this.c;return!n&&"file"!=t||(e.push("//"),(t=this.j)&&e.push(Id(t,Cd,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(Id(n,"/"==n.charAt(0)?Ad:kd,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",Id(n,Dd)),e.join("")};var Cd=/[#\/\?@]/g,kd=/[#\?:]/g,Ad=/[#\?]/g,Nd=/[#\?@]/g,Dd=/#/g;function Rd(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Od(n){n.a||(n.a=new hd,n.b=0,n.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r,i=e[n].indexOf("="),o=null;0<=i?(r=e[n].substring(0,i),o=e[n].substring(i+1)):r=e[n],t(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Pd(e,t){Od(e),t=Md(e,t),pd(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,pd((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&fd(e)))}function xd(e,t){return Od(e),t=Md(e,t),pd(e.a.b,t)}function Ld(e,t,n){Pd(e,t),0<n.length&&(e.c=null,e.a.set(Md(e,t),ff(n)),e.b+=n.length)}function Md(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(gu=Rd.prototype).add=function(e,t){Od(this),this.c=null,e=Md(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},gu.forEach=function(n,r){Od(this),this.a.forEach(function(e,t){lf(e,function(e){n.call(r,e,t,this)},this)},this)},gu.L=function(){Od(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},gu.K=function(e){Od(this);var t=[];if("string"==typeof e)xd(this,e)&&(t=hf(t,this.a.get(Md(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=hf(t,e[n])}return t},gu.set=function(e,t){return Od(this),this.c=null,xd(this,e=Md(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},gu.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},gu.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}return this.c=e.join("&")};var Fd=function(e,t){this.b=e,this.a=t};function Ud(e){this.g=e||qd,e=Qh.PerformanceNavigationTiming?0<(e=Qh.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Qh.ia&&Qh.ia.ya&&Qh.ia.ya()&&Qh.ia.ya().Lb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var qd=10;function jd(e){return e.b||e.a&&e.a.size>=e.f}function Vd(e){return e.b?1:e.a?e.a.size:0}function Bd(e,t){return e.b?e.b==t:e.a&&e.a.has(t)}function Kd(e,t){e.a?e.a.add(t):e.b=t}function Wd(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function zd(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null==e.a||0===e.a.size)return ff(e.c);var r=e.c;try{for(var i=Hh(e.a.values()),o=i.next();!o.done;o=i.next())var a=o.value,r=r.concat(a.s)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Hd(){}function Gd(){this.a=new Hd}function Qd(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}Ud.prototype.cancel=function(){var t,e;if(this.c=zd(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Hh(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Hd.prototype.stringify=function(e){return Qh.JSON.stringify(e,void 0)},Hd.prototype.parse=function(e){return Qh.JSON.parse(e,void 0)};var Yd=Qh.JSON.parse;function Xd(e){sp.call(this),this.headers=new hd,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Jd,this.D=this.F=!1}sf(Xd,sp);var Jd="",$d=/^https?$/i,Zd=["POST","PUT"];function eg(e){return"content-type"==e.toLowerCase()}function tg(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,ng(e),ig(e)}function ng(e){e.u||(e.u=!0,up(e,"complete"),up(e,"error"))}function rg(e){if(e.b&&void 0!==Gh&&(!e.s[1]||4!=ag(e)||2!=e.W()))if(e.l&&4==ag(e))Ep(e.za,0,e);else if(up(e,"readystatechange"),4==ag(e)){e.b=!1;try{var t,n,r,i,o=e.W();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}(t=a)||((n=0===o)&&(!(i=String(e.B).match(dd)[1]||null)&&Qh.self&&Qh.self.location&&(i=(r=Qh.self.location.protocol).substr(0,r.length-1)),n=!$d.test(i?i.toLowerCase():"")),t=n);if(t)up(e,"complete"),up(e,"success");else{e.h=6;try{var s=2<ag(e)?e.a.statusText:""}catch(o){s=""}e.f=s+" ["+e.W()+"]",ng(e)}}finally{ig(e)}}}function ig(e,t){if(e.a){og(e);var n=e.a,r=e.s[0]?Yh:null;e.a=null,e.s=null,t||up(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function og(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(Qh.clearTimeout(e.m),e.m=null)}function ag(e){return e.a?e.a.readyState:0}function sg(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}var i;r||(i="",bf(n,function(e,t){i+=t,i+=":",i+=e,i+="\r\n"}),n=i,"string"==typeof e?null!=n&&encodeURIComponent(String(n)):wd(e,t,n))}function ug(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function cg(e){this.pa=0,this.g=[],this.c=new Pp,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=ug("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=ug("baseRetryDelayMs",5e3,e),this.Ra=ug("retryDelaySeedMs",1e4,e),this.Ma=ug("forwardChannelMaxRetries",2,e),this.ma=ug("forwardChannelRequestTimeoutMs",2e4,e),this.Na=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new Ud(e&&e.concurrentRequestLimit),this.ka=new Gd,this.da=e&&e.fastHandshake||!1,this.Ia=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&e&&e.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function lg(e){var t,n;fg(e),3==e.v&&(t=e.R++,wd(n=yd(e.B),"SID",e.J),wd(n,"RID",t),wd(n,"TYPE","terminate"),yg(e,n),(t=new Jp(e,e.c,t,void 0)).H=2,t.i=Ed(yd(n)),n=!1,Qh.navigator&&Qh.navigator.sendBeacon&&(n=Qh.navigator.sendBeacon(t.i.toString(),"")),!n&&Qh.Image&&((new Image).src=t.i,n=!0),n||(t.a=Ag(t.g,null),t.a.ba(t.i)),t.u=af(),id(t)),Cg(e)}function hg(e){e.a&&(_g(e),e.a.cancel(),e.a=null)}function fg(e){hg(e),e.j&&(Qh.clearTimeout(e.j),e.j=null),Eg(e),e.b.cancel(),e.h&&("number"==typeof e.h&&Qh.clearTimeout(e.h),e.h=null)}function pg(e,t){e.g.push(new Fd(e.Oa++,t)),3==e.v&&dg(e)}function dg(e){jd(e.b)||e.h||(e.h=!0,yp(e.Ba,e),e.u=0)}function gg(e,t){var n=t?t.f:e.R++,r=yd(e.B);wd(r,"SID",e.J),wd(r,"RID",n),wd(r,"AID",e.P),yg(e,r),e.i&&e.l&&sg(r,e.i,e.l),n=new Jp(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=mg(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),Kd(e.b,n),td(n,r,t)}function yg(e,n){e.f&&ld({},function(e,t){wd(n,t,e)})}function mg(e,t,n){n=Math.min(e.g.length,n);var r=e.f?rf(e.f.Ja,e.f,e):null;e:for(var i=e.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{!function(e,r,t){var i=t||"";try{ld(e,function(e,t){var n=e;$h(e)&&(n=lp(e)),r.push(i+t+"="+encodeURIComponent(n))})}catch(e){throw r.push(i+"type="+encodeURIComponent("_badmap")),e}}(l,a,"req"+c+"_")}catch(e){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function vg(e){e.a||e.j||(e.T=1,yp(e.Aa,e),e.o=0)}function bg(e){return!(e.a||e.j||3<=e.o)&&(e.T++,e.j=Kp(rf(e.Aa,e),Ig(e,e.o)),e.o++,1)}function _g(e){null!=e.s&&(Qh.clearTimeout(e.s),e.s=null)}function wg(e){e.a=new Jp(e,e.c,"rpc",e.T),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=yd(e.la);wd(t,"RID","rpc"),wd(t,"SID",e.J),wd(t,"CI",e.H?"0":"1"),wd(t,"AID",e.P),yg(e,t),wd(t,"TYPE","xmlhttp"),e.i&&e.l&&sg(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=Ed(yd(t)),n.j=null,n.I=!0,nd(n,e)}function Eg(e){null!=e.m&&(Qh.clearTimeout(e.m),e.m=null)}function Tg(e,t){var n,r=null;if(e.a==t){Eg(e),_g(e),e.a=null;var i=2}else{if(!Bd(e.b,t))return;r=t.s,Wd(e.b,t),i=1}if(e.I=t.N,0!=e.v)if(t.b){1==i?(r=t.j?t.j.length:0,t=af()-t.u,n=e.u,up(i=Fp(),new Bp(i)),dg(e)):vg(e)}else if(3==(n=t.h)||0==n&&0<e.I||!(1==i&&function(e,t){if(!(Vd(e.b)>=e.b.f-(e.h?1:0))){if(e.h)return e.g=t.s.concat(e.g),1;if(!(1==e.v||2==e.v||e.u>=(e.La?0:e.Ma)))return e.h=Kp(rf(e.Ba,e,t),Ig(e,e.u)),e.u++,1}}(e,t)||2==i&&bg(e)))switch(r&&0<r.length&&(t=e.b,t.c=t.c.concat(r)),n){case 1:Sg(e,5);break;case 4:Sg(e,10);break;case 3:Sg(e,6);break;default:Sg(e,2)}}function Ig(e,t){var n=e.Ha+Math.floor(Math.random()*e.Ra);return e.f||(n*=2),n*t}function Sg(e,t){var n,r,i,o;e.c.info("Error code "+t),2==t?(r=null,e.f&&(r=null),o=rf(e.Ya,e),r||(r=new gd("//www.google.com/images/cleardot.gif"),Qh.location&&"http"==Qh.location.protocol||md(r,"https"),Ed(r)),n=r.toString(),r=o,o=new Pp,Qh.Image?((i=new Image).onload=of(Qd,o,i,"TestLoadImage: loaded",!0,r),i.onerror=of(Qd,o,i,"TestLoadImage: error",!1,r),i.onabort=of(Qd,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=of(Qd,o,i,"TestLoadImage: timeout",!1,r),Qh.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):Vp(2),e.v=0,e.f&&e.f.ra(t),Cg(e),fg(e)}function Cg(e){e.v=0,e.I=-1,e.f&&(0==zd(e.b).length&&0==e.g.length||(e.b.c.length=0,ff(e.g),e.g.length=0),e.f.qa())}function kg(e,t,n){var r,i,o,a,s,u=(a=n)instanceof gd?yd(a):new gd(a,void 0);return""!=u.c?(t&&vd(u,t+"."+u.c),bd(u,u.h)):(s=Qh.location,r=s.protocol,i=t?t+"."+s.hostname:s.hostname,o=+s.port,a=n,s=new gd(null,void 0),r&&md(s,r),i&&vd(s,i),o&&bd(s,o),a&&(s.g=a),u=s),e.V&&bf(e.V,function(e,t){wd(u,t,e)}),t=e.A,n=e.na,t&&n&&wd(u,t,n),wd(u,"VER",e.ha),yg(e,u),u}function Ag(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Xd(e.Na)).F=e.C,t}function Ng(){}function Dg(){if(Cf&&!(10<=Number(Mf)))throw Error("Environmental error: no available transport.")}function Rg(e,t){sp.call(this),this.a=new cg(t),this.o=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!pf(e)&&(this.a.i=e),this.m=t&&t.supportsCrossDomainXhr||!1,this.l=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!pf(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&(t in(e=this.b)&&delete e[t])),this.f=new xg(this)}function Og(e){Qp.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function Pg(){Yp.call(this),this.status=1}function xg(e){this.a=e}(gu=Xd.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?zp(this.H):zp(Gp),this.a.onreadystatechange=rf(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(e){return void tg(this,e)}e=n||"";var i,o=new hd(this.headers);r&&ld(r,function(e,t){o.set(t,e)}),r=function(e){e:{for(var t=eg,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:"string"==typeof e?e.charAt(t):e[t]}(o.L()),n=Qh.FormData&&e instanceof Qh.FormData,0<=cf(Zd,t)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{og(this),0<this.o&&((this.D=(i=this.a,Cf&&Lf(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=rf(this.xa,this)):this.m=Ep(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(e){tg(this,e)}},gu.xa=function(){void 0!==Gh&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,up(this,"timeout"),this.abort(8))},gu.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,up(this,"complete"),up(this,"abort"),ig(this))},gu.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ig(this,!0)),Xd.X.G.call(this)},gu.za=function(){this.j||(this.A||this.l||this.g?rg(this):this.Ua())},gu.Ua=function(){rg(this)},gu.W=function(){try{return 2<ag(this)?this.a.status:-1}catch(e){return-1}},gu.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},gu.Pa=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Yd(t)}},gu.ua=function(){return this.h},gu.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(gu=cg.prototype).ha=8,gu.v=1,gu.Ba=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new Jp(this,this.c,e,void 0),r=this.l;if(this.O&&(r?Ef(r=_f(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)e:{for(var i=t=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=mg(this,n,t),wd(i=yd(this.B),"RID",e),wd(i,"CVER",22),this.A&&wd(i,"X-HTTP-Session-Id",this.A),yg(this,i),this.i&&r&&sg(i,this.i,r),Kd(this.b,n),this.Ia&&wd(i,"TYPE","init"),this.da?(wd(i,"$req",t),wd(i,"SID","null"),n.U=!0,td(n,i,null)):td(n,i,t),this.v=2}}else 3==this.v&&(e?gg(this,e):0==this.g.length||jd(this.b)||gg(this))},gu.Aa=function(){var e;this.j=null,wg(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(e=2*this.N,this.c.info("BP detection timer enabled: "+e),this.s=Kp(rf(this.Ta,this),e))},gu.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Vp(10),hg(this),wg(this))},gu.Sa=function(){null!=this.m&&(this.m=null,hg(this),bg(this),Vp(19))},gu.Ya=function(e){e?(this.c.info("Successfully pinged google.com"),Vp(2)):(this.c.info("Failed to ping google.com"),Vp(1))},(gu=Ng.prototype).ta=function(){},gu.sa=function(){},gu.ra=function(){},gu.qa=function(){},gu.Ja=function(){},Dg.prototype.a=function(e,t){return new Rg(e,t)},sf(Rg,sp),Rg.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var e=this.a,t=this.o,n=this.b||void 0;Vp(0),e.fa=t,e.V=n||{},e.H=e.S,e.B=kg(e,null,e.fa),dg(e)},Rg.prototype.close=function(){lg(this.a)},Rg.prototype.h=function(e){var t;"string"==typeof e?((t={}).__data__=e,pg(this.a,t)):this.l?((t={}).__data__=lp(e),pg(this.a,t)):pg(this.a,e)},Rg.prototype.G=function(){this.a.f=null,delete this.f,lg(this.a),delete this.a,Rg.X.G.call(this)},sf(Og,Qp),sf(Pg,Yp),sf(xg,Ng),xg.prototype.ta=function(){up(this.a,"a")},xg.prototype.sa=function(e){up(this.a,new Og(e))},xg.prototype.ra=function(e){up(this.a,new Pg)},xg.prototype.qa=function(){up(this.a,"b")},Dg.prototype.createWebChannel=Dg.prototype.a,Rg.prototype.send=Rg.prototype.h,Rg.prototype.open=Rg.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,Gn.COMPLETE="complete",(Hp.EventType=de).OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",sp.prototype.listen=sp.prototype.va,Xd.prototype.listenOnce=Xd.prototype.wa,Xd.prototype.getLastError=Xd.prototype.Qa,Xd.prototype.getLastErrorCode=Xd.prototype.ua,Xd.prototype.getStatus=Xd.prototype.W,Xd.prototype.getResponseJson=Xd.prototype.Pa,Xd.prototype.getResponseText=Xd.prototype.$,Xd.prototype.send=Xd.prototype.ba;var Lg=Fp,Mg=ge,Fg=Gn,Ug=Lp,qg=10,jg=11,Vg=Hp,Bg=Xd,Kg=function(e,t,n,r,i,o){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o},Wg="(default)",zg=(Object.defineProperty(Hg.prototype,"isDefaultDatabase",{get:function(){return this.database===Wg},enumerable:!1,configurable:!0}),Hg.prototype.isEqual=function(e){return e instanceof Hg&&e.projectId===this.projectId&&e.database===this.database},Hg);function Hg(e,t){this.projectId=e,this.database=t||Wg}var Gg=(Qg.prototype.isAuthenticated=function(){return null!=this.uid},Qg.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Qg.prototype.isEqual=function(e){return e.uid===this.uid},Qg);function Qg(e){this.uid=e}Gg.UNAUTHENTICATED=new Gg(null),Gg.GOOGLE_CREDENTIALS=new Gg("google-credentials-uid"),Gg.FIRST_PARTY=new Gg("first-party-uid");var Yg,Xg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Jg=(vo($g,Yg=Error),$g);function $g(e,t){var n=Yg.call(this,t)||this;return n.code=e,n.message=t,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Zg="8.1.1-1.0.0-eap-firestore-debug.9c6096f43";var ey=new xa("@firebase/firestore");function ty(){return ey.logLevel}function ny(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ey.logLevel<=Aa.DEBUG&&(t=n.map(oy),ey.debug.apply(ey,So(["Firestore ("+Zg+"): "+e],t)))}function ry(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ey.logLevel<=Aa.ERROR&&(t=n.map(oy),ey.error.apply(ey,So(["Firestore ("+Zg+"): "+e],t)))}function iy(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ey.logLevel<=Aa.WARN&&(t=n.map(oy),ey.warn.apply(ey,So(["Firestore ("+Zg+"): "+e],t)))}function oy(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function ay(e){void 0===e&&(e="Unexpected state");e="FIRESTORE ("+Zg+") INTERNAL ASSERTION FAILED: "+e;throw ry(e),new Error(e)}function sy(e,t){e||ay(t)}function uy(e,t){e||ay(t)}function cy(e,t){return uy(e instanceof t,"Expected type '"+t.name+"', but was '"+e.constructor.name+"'"),e}var ly=(hy.newId=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;uy(0<t&&t<256,"Expect maxMultiple to be (0, 256), but got "+t);for(var n="";n.length<20;)for(var r=function(e){uy(0<=e,"Expecting non-negative nBytes, got: "+e);var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return uy(20===n.length,"Invalid auto ID: "+n),n},hy);function hy(){}function fy(e,t){return e<t?-1:t<e?1:0}function py(e,n,r){return e.length===n.length&&e.every(function(e,t){return r(e,n[t])})}function dy(e){return e+"\0"}var gy=-62135596800,yy=(my.now=function(){return my.fromMillis(Date.now())},my.fromDate=function(e){return my.fromMillis(e.getTime())},my.fromMillis=function(e){var t=Math.floor(e/1e3);return new my(t,1e6*(e-1e3*t))},my.prototype.toDate=function(){return new Date(this.toMillis())},my.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},my.prototype._compareTo=function(e){return this.seconds===e.seconds?fy(this.nanoseconds,e.nanoseconds):fy(this.seconds,e.seconds)},my.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},my.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},my.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},my.prototype.valueOf=function(){var e=this.seconds-gy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},my);function my(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new Jg(Xg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new Jg(Xg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gy)throw new Jg(Xg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new Jg(Xg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}function vy(e){var t,n=0;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n++;return n}function by(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function _y(e){for(var t in uy(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var wy=(Ey.fromBase64String=function(e){return new Ey(atob(e))},Ey.fromUint8Array=function(e){return new Ey(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))},Ey.prototype.toBase64=function(){return e=this.binaryString,btoa(e);var e},Ey.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},Ey.prototype.approximateByteSize=function(){return 2*this.binaryString.length},Ey.prototype.compareTo=function(e){return fy(this.binaryString,e.binaryString)},Ey.prototype.isEqual=function(e){return this.binaryString===e.binaryString},Ey);function Ey(e){this.binaryString=e}function Ty(e){return null==e}function Iy(e){return 0===e&&1/e==-1/0}function Sy(e){return"number"==typeof e&&Number.isInteger(e)&&!Iy(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}wy.EMPTY_BYTE_STRING=new wy("");var Cy="__name__",de=(Object.defineProperty(ky.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),ky.prototype.isEqual=function(e){return 0===ky.comparator(this,e)},ky.prototype.child=function(e){var t=this.segments.slice(this.offset,this.limit());return e instanceof ky?e.forEach(function(e){t.push(e)}):t.push(e),this.construct(t)},ky.prototype.limit=function(){return this.offset+this.length},ky.prototype.popFirst=function(e){return e=void 0===e?1:e,uy(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},ky.prototype.popLast=function(){return uy(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},ky.prototype.firstSegment=function(){return uy(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},ky.prototype.lastSegment=function(){return this.get(this.length-1)},ky.prototype.get=function(e){return uy(e<this.length,"Index out of range"),this.segments[this.offset+e]},ky.prototype.isEmpty=function(){return 0===this.length},ky.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},ky.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},ky.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},ky.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},ky.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(o<i)return 1}return e.length<t.length?-1:e.length>t.length?1:0},ky);function ky(e,t,n){void 0===t?t=0:t>e.length&&ay("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&ay("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}var Ay,Ny=(vo(Dy,Ay=de),Dy.prototype.construct=function(e,t,n){return new Dy(e,t,n)},Dy.prototype.canonicalString=function(){return this.toArray().join("/")},Dy.prototype.toString=function(){return this.canonicalString()},Dy.fromString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(e){return 0<e.length}))}return new Dy(n)},Dy.emptyPath=function(){return new Dy([])},Dy);function Dy(){return null!==Ay&&Ay.apply(this,arguments)||this}var Ry,Oy=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Py=(vo(xy,Ry=de),xy.prototype.construct=function(e,t,n){return new xy(e,t,n)},xy.isValidIdentifier=function(e){return Oy.test(e)},xy.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xy.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},xy.prototype.toString=function(){return this.canonicalString()},xy.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===Cy},xy.keyField=function(){return new xy([Cy])},xy.fromServerFormat=function(e){for(var t=[],n="",r=0,i=function(){if(0===n.length)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");t.push(n),n=""},o=!1;r<e.length;){var a=e[r];if("\\"===a){if(r+1===e.length)throw new Jg(Xg.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[r+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Jg(Xg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,r+=2}else"`"===a?o=!o:"."!==a||o?n+=a:i(),r++}if(i(),o)throw new Jg(Xg.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xy(t)},xy.emptyPath=function(){return new xy([])},xy);function xy(){return null!==Ry&&Ry.apply(this,arguments)||this}var Ly=(My.fromPath=function(e){return new My(Ny.fromString(e))},My.fromName=function(e){return new My(Ny.fromString(e).popFirst(5))},My.prototype.hasCollectionId=function(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e},My.prototype.isEqual=function(e){return null!==e&&0===Ny.comparator(this.path,e.path)},My.prototype.toString=function(){return this.path.toString()},My.comparator=function(e,t){return Ny.comparator(e.path,t.path)},My.isDocumentKey=function(e){return e.length%2==0},My.fromSegments=function(e){return new My(new Ny(e.slice()))},My);function My(e){this.path=e,uy(My.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}var Fy="server_timestamp",Uy="__type__",qy="__previous_value__",jy="__local_write_time__";function Vy(e){return(null===(e=((null===(e=null==e?void 0:e.mapValue)||void 0===e?void 0:e.fields)||{})[Uy])||void 0===e?void 0:e.stringValue)===Fy}function By(e){e=Jy(e.mapValue.fields[jy].timestampValue);return new yy(e.seconds,e.nanos)}var Ky=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wy(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Vy(e)?4:10:ay("Invalid value type: "+JSON.stringify(e))}function zy(e,t){var n,r=Wy(e);if(r!==Wy(t))return!1;switch(r){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return By(e).isEqual(By(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;e=Jy(e.timestampValue),t=Jy(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,Zy(e.bytesValue).isEqual(Zy(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return r=t,$y((n=e).geoPointValue.latitude)===$y(r.geoPointValue.latitude)&&$y(n.geoPointValue.longitude)===$y(r.geoPointValue.longitude);case 2:return function(e,t){{if("integerValue"in e&&"integerValue"in t)return $y(e.integerValue)===$y(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){e=$y(e.doubleValue),t=$y(t.doubleValue);return e===t?Iy(e)===Iy(t):isNaN(e)&&isNaN(t)}}return!1}(e,t);case 9:return py(e.arrayValue.values||[],t.arrayValue.values||[],zy);case 10:return function(e,t){var n,r=e.mapValue.fields||{},i=t.mapValue.fields||{};if(vy(r)!==vy(i))return!1;for(n in r)if(r.hasOwnProperty(n)&&(void 0===i[n]||!zy(r[n],i[n])))return!1;return!0}(e,t);default:return ay("Unexpected value type: "+JSON.stringify(e))}}function Hy(e,t){return void 0!==(e.values||[]).find(function(e){return zy(e,t)})}function Gy(e,t){var n,r,i=Wy(e),o=Wy(t);if(i!==o)return fy(i,o);switch(i){case 0:return 0;case 1:return fy(e.booleanValue,t.booleanValue);case 2:return function(e,t){e=$y(e.integerValue||e.doubleValue),t=$y(t.integerValue||t.doubleValue);return e<t?-1:t<e?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}(e,t);case 3:return Qy(e.timestampValue,t.timestampValue);case 4:return Qy(By(e),By(t));case 5:return fy(e.stringValue,t.stringValue);case 6:return function(e,t){e=Zy(e),t=Zy(t);return e.compareTo(t)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=fy(n[i],r[i]);if(0!==o)return o}return fy(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return n=e.geoPointValue,r=t.geoPointValue,0===(o=fy($y(n.latitude),$y(r.latitude)))?fy($y(n.longitude),$y(r.longitude)):o;case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=Gy(n[i],r[i]);if(o)return o}return fy(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=fy(r[a],o[a]);if(0!==s)return s;s=Gy(n[r[a]],i[o[a]]);if(0!==s)return s}return fy(r.length,o.length)}(e.mapValue,t.mapValue);default:throw ay("Invalid value type: "+i)}}function Qy(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return fy(e,t);var n=Jy(e),e=Jy(t),t=fy(n.seconds,e.seconds);return 0!==t?t:fy(n.nanos,e.nanos)}function Yy(e){return Xy(e)}function Xy(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){e=Jy(e);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Zy(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,Ly.fromName(t).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++){n?n=!1:t+=",",t+=Xy(i[r])}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=0,o=t;i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+Xy(e.fields[a])}return n+"}"}(e.mapValue):ay("Invalid value type: "+JSON.stringify(e));var t}function Jy(e){if(sy(!!e,"Cannot normalize null or undefined timestamp."),"string"!=typeof e)return{seconds:$y(e.seconds),nanos:t=$y(e.nanos)};var t=0,n=Ky.exec(e);sy(!!n,"invalid timestamp: "+e),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),t=Number(n));e=new Date(e);return{seconds:Math.floor(e.getTime()/1e3),nanos:t}}function $y(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Zy(e){return"string"==typeof e?wy.fromBase64String(e):wy.fromUint8Array(e)}function em(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function tm(e){return!!e&&"integerValue"in e}function nm(e){return tm(e)||!!(e=e)&&"doubleValue"in e}function rm(e){return!!e&&"arrayValue"in e}function im(e){return!!e&&"referenceValue"in e}function om(e){return e&&"nullValue"in e}function am(e){return e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function sm(e){return e&&"mapValue"in e}var um,ge=function(e,t){this.key=e,this.version=t},cm=(vo(lm,um=ge),lm.prototype.field=function(e){return this.objectValue.field(e)},lm.prototype.data=function(){return this.objectValue},lm.prototype.toProto=function(){return this.objectValue.proto},lm.prototype.isEqual=function(e){return e instanceof lm&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.objectValue.isEqual(e.objectValue)},lm.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.objectValue.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lm.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lm);function lm(e,t,n,r){t=um.call(this,e,t)||this;return t.objectValue=n,t.hasLocalMutations=!!r.hasLocalMutations,t.hasCommittedMutations=!!r.hasCommittedMutations,t}var hm,fm=(vo(pm,hm=ge),pm.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(pm.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),pm.prototype.isEqual=function(e){return e instanceof pm&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},pm);function pm(e,t,n){t=hm.call(this,e,t)||this;return t.hasCommittedMutations=!(!n||!n.hasCommittedMutations),t}var dm,gm=(vo(ym,dm=ge),ym.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ym.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ym.prototype.isEqual=function(e){return e instanceof ym&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},ym);function ym(){return null!==dm&&dm.apply(this,arguments)||this}var mm=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null};function vm(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new mm(e,t,n,r,i,o,a)}function bm(e){var t=cy(e,mm);return null===t.memoizedCanonicalId&&(e=t.path.canonicalString(),null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(function(e){return uy((e=e)instanceof Vm,"canonifyFilter() only supports FieldFilters"),e.field.canonicalString()+e.op.toString()+Yy(e.value)}).join(","),e+="|ob:",e+=t.orderBy.map(function(e){return(e=e).field.canonicalString()+e.dir}).join(","),Ty(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=fv(t.startAt)),t.endAt&&(e+="|ub:",e+=fv(t.endAt)),t.memoizedCanonicalId=e),t.memoizedCanonicalId}function _m(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(t+=", filters: ["+e.filters.map(function(e){return uy((e=e)instanceof Vm,"stringifyFilter() only supports FieldFilters"),e.field.canonicalString()+" "+e.op+" "+Yy(e.value)}).join(", ")+"]"),Ty(e.limit)||(t+=", limit: "+e.limit),0<e.orderBy.length&&(t+=", orderBy: ["+e.orderBy.map(function(e){return(e=e).field.canonicalString()+" ("+e.dir+")"}).join(", ")+"]"),e.startAt&&(t+=", startAt: "+fv(e.startAt)),e.endAt&&(t+=", endAt: "+fv(e.endAt)),"Target("+t+")"}function wm(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n,r,i=0;i<e.orderBy.length;i++)if(n=e.orderBy[i],r=t.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(e.filters.length!==t.filters.length)return!1;for(var o,a,i=0;i<e.filters.length;i++)if(o=e.filters[i],a=t.filters[i],uy(o instanceof Vm&&a instanceof Vm,"Only FieldFilters can be compared"),o.op!==a.op||!o.field.isEqual(a.field)||!zy(o.value,a.value))return!1;return e.collectionGroup===t.collectionGroup&&(!!e.path.isEqual(t.path)&&(!!dv(e.startAt,t.startAt)&&dv(e.endAt,t.endAt)))}function Em(e){return Ly.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var Tm=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&uy(this.startAt.position.length<=Om(this).length,"Bound is longer than orderBy"),this.endAt&&uy(this.endAt.position.length<=Om(this).length,"Bound is longer than orderBy")};function Im(e,t,n,r,i,o,a,s){return new Tm(e,t,n,r,i,o,a,s)}function Sm(e){return new Tm(e)}function Cm(e){return!Ty(e.limit)&&"F"===e.limitType}function km(e){return!Ty(e.limit)&&"L"===e.limitType}function Am(e){return 0<e.explicitOrderBy.length?e.explicitOrderBy[0].field:null}function Nm(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(uy(r instanceof Vm,"Only FieldFilters are supported"),r.isInequality())return r.field}return null}function Dm(e){return Ly.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Rm(e){return null!==e.collectionGroup}function Om(e){var t=cy(e,Tm);if(null===t.memoizedOrderBy){t.memoizedOrderBy=[];var n=Nm(t),e=Am(t);if(null!==n&&null===e)n.isKeyField()||t.memoizedOrderBy.push(new gv(n)),t.memoizedOrderBy.push(new gv(Py.keyField(),"asc"));else{uy(null===n||null!==e&&n.isEqual(e),"First orderBy should match inequality field.");for(var r=!1,i=0,o=t.explicitOrderBy;i<o.length;i++){var a=o[i];t.memoizedOrderBy.push(a),a.field.isKeyField()&&(r=!0)}r||(e=0<t.explicitOrderBy.length?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",t.memoizedOrderBy.push(new gv(Py.keyField(),e)))}}return t.memoizedOrderBy}function Pm(e){var t=cy(e,Tm);if(!t.memoizedTarget)if("F"===t.limitType)t.memoizedTarget=vm(t.path,t.collectionGroup,Om(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Om(t);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new gv(o.field,a))}var s=t.endAt?new hv(t.endAt.position,!t.endAt.before):null,e=t.startAt?new hv(t.startAt.position,!t.startAt.before):null;t.memoizedTarget=vm(t.path,t.collectionGroup,n,t.filters,t.limit,s,e)}return t.memoizedTarget}function xm(e,t,n){return new Tm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Lm(e,t){return wm(Pm(e),Pm(t))&&e.limitType===t.limitType}function Mm(e){return bm(Pm(e))+"|lt:"+e.limitType}function Fm(e){return"Query(target="+_m(Pm(e))+"; limitType="+e.limitType+")"}function Um(e,t){return n=e,i=(r=t).key.path,(null!==n.collectionGroup?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Ly.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i))&&function(e,t){for(var n=0,r=e.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===t.field(i.field))return}return 1}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++){if(!r[n].matches(t))return}return 1}(e,t)&&function(e,t){if(e.startAt&&!pv(e.startAt,Om(e),t))return;if(e.endAt&&pv(e.endAt,Om(e),t))return;return 1}(e,t);var n,r,i}function qm(s){return function(e,t){for(var n=!1,r=0,i=Om(s);r<i.length;r++){var o=i[r],a=function(e,t,n){n=e.field.isKeyField()?Ly.comparator(t.key,n.key):function(e,t,n){return t=t.field(e),e=n.field(e),null!==t&&null!==e?Gy(t,e):ay("Trying to compare documents on fields that don't exist")}(e.field,t,n);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return ay("Unknown direction: "+e.dir)}}(o,e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return uy(n,"orderBy used that doesn't compare on key field"),0}}var jm,Vm=(vo(Bm,jm=function(){}),Bm.create=function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):(uy(im(n),"Comparing on key, but filter value not a RefValue"),uy("array-contains"!==t&&"array-contains-any"!==t,"'"+t.toString()+"' queries don't make sense on document keys."),new Wm(e,t,n)):"array-contains"===t?new ev(e,n):"in"===t?(uy(rm(n),"IN filter has invalid value: "+n.toString()),new rv(e,n)):"not-in"===t?(uy(rm(n),"NOT_IN filter has invalid value: "+n.toString()),new av(e,n)):"array-contains-any"===t?(uy(rm(n),"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new cv(e,n)):new Bm(e,t,n)},Bm.createKeyFieldInFilter=function(e,t,n){return uy(rm(n),"Comparing on key with "+t.toString()+", but filter value not an ArrayValue"),uy((n.arrayValue.values||[]).every(im),"Comparing on key with "+t.toString()+", but an array value was not a RefValue"),new("in"===t?Gm:Xm)(e,n)},Bm.prototype.matches=function(e){e=e.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Gy(e,this.value)):null!==e&&Wy(this.value)===Wy(e)&&this.matchesComparison(Gy(e,this.value))},Bm.prototype.matchesComparison=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return 0<e;case">=":return 0<=e;default:return ay("Unknown FieldFilter operator: "+this.op)}},Bm.prototype.isInequality=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Bm);function Bm(e,t,n){var r=jm.call(this)||this;return r.field=e,r.op=t,r.value=n,r}var Km,Wm=(vo(zm,Km=Vm),zm.prototype.matches=function(e){e=Ly.comparator(e.key,this.key);return this.matchesComparison(e)},zm);function zm(e,t,n){t=Km.call(this,e,t,n)||this;return uy(im(n),"KeyFieldFilter expects a ReferenceValue"),t.key=Ly.fromName(n.referenceValue),t}var Hm,Gm=(vo(Qm,Hm=Vm),Qm.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},Qm);function Qm(e,t){e=Hm.call(this,e,"in",t)||this;return e.keys=$m("in",t),e}var Ym,Xm=(vo(Jm,Ym=Vm),Jm.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},Jm);function Jm(e,t){e=Ym.call(this,e,"not-in",t)||this;return e.keys=$m("not-in",t),e}function $m(t,e){return uy(rm(e),"KeyFieldInFilter/KeyFieldNotInFilter expects an ArrayValue"),((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(e){return uy(im(e),"Comparing on key with "+t.toString()+", but an array value was not a ReferenceValue"),Ly.fromName(e.referenceValue)})}var Zm,ev=(vo(tv,Zm=Vm),tv.prototype.matches=function(e){e=e.field(this.field);return rm(e)&&Hy(e.arrayValue,this.value)},tv);function tv(e,t){return Zm.call(this,e,"array-contains",t)||this}var nv,rv=(vo(iv,nv=Vm),iv.prototype.matches=function(e){e=e.field(this.field);return null!==e&&Hy(this.value.arrayValue,e)},iv);function iv(e,t){e=nv.call(this,e,"in",t)||this;return uy(rm(t),"InFilter expects an ArrayValue"),e}var ov,av=(vo(sv,ov=Vm),sv.prototype.matches=function(e){if(Hy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;e=e.field(this.field);return null!==e&&!Hy(this.value.arrayValue,e)},sv);function sv(e,t){e=ov.call(this,e,"not-in",t)||this;return uy(rm(t),"NotInFilter expects an ArrayValue"),e}var uv,cv=(vo(lv,uv=Vm),lv.prototype.matches=function(e){var t=this,e=e.field(this.field);return!(!rm(e)||!e.arrayValue.values)&&e.arrayValue.values.some(function(e){return Hy(t.value.arrayValue,e)})},lv);function lv(e,t){e=uv.call(this,e,"array-contains-any",t)||this;return uy(rm(t),"ArrayContainsAnyFilter expects an ArrayValue"),e}var hv=function(e,t){this.position=e,this.before=t};function fv(e){return(e.before?"b":"a")+":"+e.position.map(Yy).join(",")}function pv(e,t,n){uy(e.position.length<=t.length,"Bound has more components than query's orderBy");for(var r=0,i=0;i<e.position.length;i++){var o,a=t[i],s=e.position[i],r=a.field.isKeyField()?(uy(im(s),"Bound has a non-key value where the key path is being used."),Ly.comparator(Ly.fromName(s.referenceValue),n.key)):(uy(null!==(o=n.field(a.field)),"Field should exist since document matched the orderBy already."),Gy(s,o));if("desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function dv(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++){if(!zy(e.position[n],t.position[n]))return!1}return!0}var gv=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};var yv=(mv.fromTimestamp=function(e){return new mv(e)},mv.min=function(){return new mv(new yy(0,0))},mv.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},mv.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},mv.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},mv.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},mv.prototype.toTimestamp=function(){return this.timestamp},mv);function mv(e){this.timestamp=e}var vv=(bv.prototype.insert=function(e,t){return new bv(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ev.BLACK,null,null))},bv.prototype.remove=function(e){return new bv(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ev.BLACK,null,null))},bv.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:0<n&&(t=t.right)}return null},bv.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;n=r<0?n.left:(t+=n.left.size+1,n.right)}return-1},bv.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(bv.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),bv.prototype.minKey=function(){return this.root.minKey()},bv.prototype.maxKey=function(){return this.root.maxKey()},bv.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},bv.prototype.forEach=function(n){this.inorderTraversal(function(e,t){return n(e,t),!1})},bv.prototype.toString=function(){var n=[];return this.inorderTraversal(function(e,t){return n.push(e+":"+t),!1}),"{"+n.join(", ")+"}"},bv.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},bv.prototype.getIterator=function(){return new _v(this.root,null,this.comparator,!1)},bv.prototype.getIteratorFrom=function(e){return new _v(this.root,e,this.comparator,!1)},bv.prototype.getReverseIterator=function(){return new _v(this.root,null,this.comparator,!0)},bv.prototype.getReverseIteratorFrom=function(e){return new _v(this.root,e,this.comparator,!0)},bv);function bv(e,t){this.comparator=e,this.root=t||Ev.EMPTY}var _v=(wv.prototype.getNext=function(){uy(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},wv.prototype.hasNext=function(){return 0<this.nodeStack.length},wv.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},wv);function wv(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}var Ev=(Tv.prototype.copy=function(e,t,n,r,i){return new Tv(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Tv.prototype.isEmpty=function(){return!1},Tv.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},Tv.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},Tv.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},Tv.prototype.minKey=function(){return this.min().key},Tv.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Tv.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},Tv.prototype.removeMin=function(){if(this.left.isEmpty())return Tv.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},Tv.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Tv.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()},Tv.prototype.isRed=function(){return this.color},Tv.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},Tv.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},Tv.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},Tv.prototype.rotateLeft=function(){var e=this.copy(null,null,Tv.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},Tv.prototype.rotateRight=function(){var e=this.copy(null,null,Tv.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},Tv.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},Tv.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},Tv.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ay("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw ay("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw ay("Black depths differ");return e+(this.isRed()?0:1)},Tv);function Tv(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Tv.RED,this.left=null!=r?r:Tv.EMPTY,this.right=null!=i?i:Tv.EMPTY,this.size=this.left.size+1+this.right.size}Ev.EMPTY=null,Ev.RED=!0,Ev.BLACK=!1;Object.defineProperty(Iv.prototype,"key",{get:function(){throw ay("LLRBEmptyNode has no key.")},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"value",{get:function(){throw ay("LLRBEmptyNode has no value.")},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"color",{get:function(){throw ay("LLRBEmptyNode has no color.")},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"left",{get:function(){throw ay("LLRBEmptyNode has no left child.")},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"right",{get:function(){throw ay("LLRBEmptyNode has no right child.")},enumerable:!1,configurable:!0}),Iv.prototype.copy=function(e,t,n,r,i){return this},Iv.prototype.insert=function(e,t,n){return new Ev(e,t)},Iv.prototype.remove=function(e,t){return this},Iv.prototype.isEmpty=function(){return!0},Iv.prototype.inorderTraversal=function(e){return!1},Iv.prototype.reverseTraversal=function(e){return!1},Iv.prototype.minKey=function(){return null},Iv.prototype.maxKey=function(){return null},Iv.prototype.isRed=function(){return!1},Iv.prototype.checkMaxDepth=function(){return!0},Iv.prototype.check=function(){return 0},Gn=Iv;function Iv(){this.size=0}Ev.EMPTY=new Gn;var Sv=(Cv.prototype.has=function(e){return null!==this.data.get(e)},Cv.prototype.first=function(){return this.data.minKey()},Cv.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(Cv.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Cv.prototype.indexOf=function(e){return this.data.indexOf(e)},Cv.prototype.forEach=function(n){this.data.inorderTraversal(function(e,t){return n(e),!1})},Cv.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,e[1]))return;t(r.key)}},Cv.prototype.forEachWhile=function(e,t){for(var n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();){if(!e(n.getNext().key))return}},Cv.prototype.firstAfterOrEqual=function(e){e=this.data.getIteratorFrom(e);return e.hasNext()?e.getNext().key:null},Cv.prototype.getIterator=function(){return new kv(this.data.getIterator())},Cv.prototype.getIteratorFrom=function(e){return new kv(this.data.getIteratorFrom(e))},Cv.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},Cv.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},Cv.prototype.isEmpty=function(){return this.data.isEmpty()},Cv.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t},Cv.prototype.isEqual=function(e){if(!(e instanceof Cv))return!1;if(this.size!==e.size)return!1;for(var t=this.data.getIterator(),n=e.data.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},Cv.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},Cv.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},Cv.prototype.copy=function(e){var t=new Cv(this.comparator);return t.data=e,t},Cv);function Cv(e){this.comparator=e,this.data=new vv(this.comparator)}var kv=(Av.prototype.getNext=function(){return this.iter.getNext().key},Av.prototype.hasNext=function(){return this.iter.hasNext()},Av);function Av(e){this.iter=e}var Nv=new vv(Ly.comparator);var Dv=new vv(Ly.comparator);var Rv=new vv(Ly.comparator);var Ov=new Sv(Ly.comparator);function Pv(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Ov,r=0,i=e;r<i.length;r++)var o=i[r],n=n.add(o);return n}var xv=new Sv(fy);var Lv=(Mv.empty=function(){return new Mv({mapValue:{}})},Mv.prototype.field=function(e){if(e.isEmpty())return this.proto;for(var t=this.proto,n=0;n<e.length-1;++n){if(!t.mapValue.fields)return null;if(!sm(t=t.mapValue.fields[e.get(n)]))return null}return(t=(t.mapValue.fields||{})[e.lastSegment()])||null},Mv.prototype.isEqual=function(e){return zy(this.proto,e.proto)},Mv);function Mv(e){uy(!Vy(this.proto=e),"ServerTimestamps should be converted to ServerTimestampValue")}var Fv=(Uv.prototype.set=function(e,t){return uy(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),this.setOverlay(e,t),this},Uv.prototype.delete=function(e){return uy(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),this.setOverlay(e,null),this},Uv.prototype.setOverlay=function(e,t){for(var n=this.overlayMap,r=0;r<e.length-1;++r)var i=e.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Wy(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(e.lastSegment(),t)},Uv.prototype.build=function(){var e=this.applyOverlay(Py.emptyPath(),this.overlayMap);return null!=e?new Lv(e):this.baseObject},Uv.prototype.applyOverlay=function(r,e){var i=this,o=!1,t=this.baseObject.field(r),a=sm(t)?Object.assign({},t.mapValue.fields):{};return e.forEach(function(e,t){var n;e instanceof Map?null!=(n=i.applyOverlay(r.child(t),e))&&(a[t]=n,o=!0):null!==e?(a[t]=e,o=!0):a.hasOwnProperty(t)&&(delete a[t],o=!0)}),o?{mapValue:{fields:a}}:null},Uv);function Uv(e){void 0===e&&(e=Lv.empty()),this.baseObject=e,this.overlayMap=new Map}var qv,jv=function(e){this.count=e};function Vv(e){switch(e){case Xg.OK:return ay("Treated status OK as error");case Xg.CANCELLED:case Xg.UNKNOWN:case Xg.DEADLINE_EXCEEDED:case Xg.RESOURCE_EXHAUSTED:case Xg.INTERNAL:case Xg.UNAVAILABLE:case Xg.UNAUTHENTICATED:return!1;case Xg.INVALID_ARGUMENT:case Xg.NOT_FOUND:case Xg.ALREADY_EXISTS:case Xg.PERMISSION_DENIED:case Xg.FAILED_PRECONDITION:case Xg.ABORTED:case Xg.OUT_OF_RANGE:case Xg.UNIMPLEMENTED:case Xg.DATA_LOSS:return!0;default:return ay("Unknown status code: "+e)}}function Bv(e){if(void 0===e)return ry("GRPC error has no .code"),Xg.UNKNOWN;switch(e){case qv.OK:return Xg.OK;case qv.CANCELLED:return Xg.CANCELLED;case qv.UNKNOWN:return Xg.UNKNOWN;case qv.DEADLINE_EXCEEDED:return Xg.DEADLINE_EXCEEDED;case qv.RESOURCE_EXHAUSTED:return Xg.RESOURCE_EXHAUSTED;case qv.INTERNAL:return Xg.INTERNAL;case qv.UNAVAILABLE:return Xg.UNAVAILABLE;case qv.UNAUTHENTICATED:return Xg.UNAUTHENTICATED;case qv.INVALID_ARGUMENT:return Xg.INVALID_ARGUMENT;case qv.NOT_FOUND:return Xg.NOT_FOUND;case qv.ALREADY_EXISTS:return Xg.ALREADY_EXISTS;case qv.PERMISSION_DENIED:return Xg.PERMISSION_DENIED;case qv.FAILED_PRECONDITION:return Xg.FAILED_PRECONDITION;case qv.ABORTED:return Xg.ABORTED;case qv.OUT_OF_RANGE:return Xg.OUT_OF_RANGE;case qv.UNIMPLEMENTED:return Xg.UNIMPLEMENTED;case qv.DATA_LOSS:return Xg.DATA_LOSS;default:return ay("Unknown status code: "+e)}}(de=qv=qv||{})[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";var Kv=(Wv.createSynthesizedRemoteEventForCurrentChange=function(e,t){var n=new Map;return n.set(e,zv.createSynthesizedTargetChangeForCurrentChange(e,t)),new Wv(yv.min(),n,xv,Nv,Pv())},Wv);function Wv(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}var zv=(Hv.createSynthesizedTargetChangeForCurrentChange=function(e,t){return new Hv(wy.EMPTY_BYTE_STRING,t,Pv(),Pv(),Pv())},Hv);function Hv(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}var Gv=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},Qv=function(e,t){this.targetId=e,this.existenceFilter=t},Yv=function(e,t,n,r){void 0===n&&(n=wy.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Xv=(Object.defineProperty(Jv.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!1,configurable:!0}),Jv.prototype.updateResumeToken=function(e){0<e.approximateByteSize()&&(this._hasPendingChanges=!0,this._resumeToken=e)},Jv.prototype.toTargetChange=function(){var n=Pv(),r=Pv(),i=Pv();return this.documentChanges.forEach(function(e,t){switch(t){case 0:n=n.add(e);break;case 2:r=r.add(e);break;case 1:i=i.add(e);break;default:ay("Encountered invalid change type: "+t)}}),new zv(this._resumeToken,this._current,n,r,i)},Jv.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=tb()},Jv.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},Jv.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},Jv.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},Jv.prototype.recordTargetResponse=function(){--this.pendingResponses},Jv.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},Jv);function Jv(){this.pendingResponses=0,this.documentChanges=tb(),this._resumeToken=wy.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}var $v=(Zv.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof cm?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof fm&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,e.key,e.newDoc)}},Zv.prototype.handleTargetChange=function(n){var r=this;this.forEachTarget(n,function(e){var t=r.ensureTargetState(e);switch(n.state){case 0:r.isActiveTarget(e)&&t.updateResumeToken(n.resumeToken);break;case 1:t.recordTargetResponse(),t.isPending||t.clearPendingChanges(),t.updateResumeToken(n.resumeToken);break;case 2:t.recordTargetResponse(),t.isPending||r.removeTarget(e),uy(!n.cause,"WatchChangeAggregator does not handle errored targets");break;case 3:r.isActiveTarget(e)&&(t.markCurrent(),t.updateResumeToken(n.resumeToken));break;case 4:r.isActiveTarget(e)&&(r.resetTarget(e),t.updateResumeToken(n.resumeToken));break;default:ay("Unknown target watch change state: "+n.state)}})},Zv.prototype.forEachTarget=function(e,n){var r=this;0<e.targetIds.length?e.targetIds.forEach(n):this.targetStates.forEach(function(e,t){r.isActiveTarget(t)&&n(t)})},Zv.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,e=this.targetDataForActiveTarget(t);e&&(Em(e=e.target)?0===n?(e=new Ly(e.path),this.removeDocumentFromTarget(t,e,new fm(e,yv.min()))):sy(1===n,"Single document existence filter with count: "+n):this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t)))},Zv.prototype.createRemoteEvent=function(r){var i=this,o=new Map;this.targetStates.forEach(function(e,t){var n=i.targetDataForActiveTarget(t);n&&(e.current&&Em(n.target)&&(n=new Ly(n.target.path),null!==i.pendingDocumentUpdates.get(n)||i.targetContainsDocument(t,n)||i.removeDocumentFromTarget(t,n,new fm(n,r))),e.hasPendingChanges&&(o.set(t,e.toTargetChange()),e.clearPendingChanges()))});var a=Pv();this.pendingDocumentTargetMapping.forEach(function(e,t){var n=!0;t.forEachWhile(function(e){e=i.targetDataForActiveTarget(e);return!e||2===e.purpose||(n=!1)}),n&&(a=a.add(e))});var e=new Kv(r,o,this.pendingTargetResets,this.pendingDocumentUpdates,a);return this.pendingDocumentUpdates=Nv,this.pendingDocumentTargetMapping=eb(),this.pendingTargetResets=new Sv(fy),e},Zv.prototype.addDocumentToTarget=function(e,t){var n;this.isActiveTarget(e)&&(n=this.targetContainsDocument(e,t.key)?2:0,this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e)))},Zv.prototype.removeDocumentFromTarget=function(e,t,n){var r;this.isActiveTarget(e)&&(r=this.ensureTargetState(e),this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n)))},Zv.prototype.removeTarget=function(e){this.targetStates.delete(e)},Zv.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},Zv.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},Zv.prototype.ensureTargetState=function(e){var t=this.targetStates.get(e);return t||(t=new Xv,this.targetStates.set(e,t)),t},Zv.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Sv(fy),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},Zv.prototype.isActiveTarget=function(e){var t=null!==this.targetDataForActiveTarget(e);return t||ny("WatchChangeAggregator","Detected inactive target",e),t},Zv.prototype.targetDataForActiveTarget=function(e){var t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)},Zv.prototype.resetTarget=function(t){var n=this;uy(!this.targetStates.get(t).isPending,"Should only reset active targets"),this.targetStates.set(t,new Xv),this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(e){n.removeDocumentFromTarget(t,e,null)})},Zv.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},Zv);function Zv(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=Nv,this.pendingDocumentTargetMapping=eb(),this.pendingTargetResets=new Sv(fy)}function eb(){return new vv(Ly.comparator)}function tb(){return new vv(Ly.comparator)}var nb={asc:"ASCENDING",desc:"DESCENDING"},rb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};function ib(e,t){uy(!Ty(e),t+" is missing")}var ob=function(e,t){this.databaseId=e,this.useProto3Json=t};function ab(e){return{integerValue:""+e}}function sb(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Iy(t)?"-0":t}}function ub(e,t){return Sy(t)?ab(t):sb(e,t)}function cb(e,t){return e.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function lb(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function hb(e){return sy(!!e,"Trying to deserialize version that isn't set"),yv.fromTimestamp((e=Jy(e=e),new yy(e.seconds,e.nanos)))}function fb(e,t){return new Ny(["projects",(e=e).projectId,"databases",e.database]).child("documents").child(t).canonicalString()}function pb(e){e=Ny.fromString(e);return sy(Lb(e),"Tried to deserialize invalid key "+e.toString()),e}function db(e,t){return fb(e.databaseId,t.path)}function gb(e,t){t=pb(t);if(t.get(1)!==e.databaseId.projectId)throw new Jg(Xg.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+e.databaseId.projectId);if(t.get(3)!==e.databaseId.database)throw new Jg(Xg.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+e.databaseId.database);return new Ly(bb(t))}function yb(e,t){return fb(e.databaseId,t)}function mb(e){e=pb(e);return 4===e.length?Ny.emptyPath():bb(e)}function vb(e){return new Ny(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function bb(e){return sy(4<e.length&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)}function _b(e,t,n){return{name:db(e,t),fields:n.proto.mapValue.fields}}function wb(e,t){return"found"in t?function(e,t){sy(!!t.found,"Tried to deserialize a found document from a missing document."),ib(t.found.name,"doc.found.name"),ib(t.found.updateTime,"doc.found.updateTime");var n=gb(e,t.found.name),e=hb(t.found.updateTime),t=new Lv({mapValue:{fields:t.found.fields}});return new cm(n,e,t,{})}(e,t):"missing"in t?(n=e,sy(!!(e=t).missing,"Tried to deserialize a missing document from a found document."),sy(!!e.readTime,"Tried to deserialize a missing document without a read time."),n=gb(n,e.missing),e=hb(e.readTime),new fm(n,e)):ay("invalid batch get response: "+JSON.stringify(t));var n}function Eb(e,t){if("targetChange"in t){ib(t.targetChange,"targetChange");var n="NO_CHANGE"===(o=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:ay("Got unexpected TargetChange.state: "+o),r=t.targetChange.targetIds||[],i=(i=e,o=t.targetChange.resumeToken,i.useProto3Json?(sy(void 0===o||"string"==typeof o,"value must be undefined or a string when using proto3 Json"),wy.fromBase64String(o||"")):(sy(void 0===o||o instanceof Uint8Array,"value must be undefined or Uint8Array"),wy.fromUint8Array(o||new Uint8Array))),o=t.targetChange.cause,a=o&&(o=void 0===(a=o).code?Xg.UNKNOWN:Bv(a.code),new Jg(o,a.message||"")),i=new Yv(n,r,i,a||null)}else if("documentChange"in t){ib(t.documentChange,"documentChange");var s=t.documentChange;ib(s.document,"documentChange.name"),ib(s.document.name,"documentChange.document.name"),ib(s.document.updateTime,"documentChange.document.updateTime");var u=gb(e,s.document.name),c=hb(s.document.updateTime),a=new Lv({mapValue:{fields:s.document.fields}}),c=new cm(u,c,a,{}),a=s.targetIds||[],s=s.removedTargetIds||[];i=new Gv(a,s,c.key,c)}else if("documentDelete"in t){ib(t.documentDelete,"documentDelete");c=t.documentDelete;ib(c.document,"documentDelete.document");var u=gb(e,c.document),l=c.readTime?hb(c.readTime):yv.min(),l=new fm(u,l),s=c.removedTargetIds||[];i=new Gv([],s,l.key,l)}else if("documentRemove"in t){ib(t.documentRemove,"documentRemove");l=t.documentRemove;ib(l.document,"documentRemove");u=gb(e,l.document),s=l.removedTargetIds||[];i=new Gv([],s,u,null)}else{if(!("filter"in t))return ay("Unknown change type "+JSON.stringify(t));ib(t.filter,"filter");u=t.filter;ib(u.targetId,"filter.targetId");t=u.count||0,t=new jv(t),u=u.targetId;i=new Qv(u,t)}return i}function Tb(e,t){var n,r,i;if(t instanceof g_)n={update:_b(e,t.key,t.value)};else if(t instanceof k_)n={delete:db(e,t.key)};else if(t instanceof v_)n={update:_b(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach(function(e){return i.push(e.canonicalString())}),{fieldPaths:i})};else if(t instanceof E_)n={transform:{document:db(e,t.key),fieldTransforms:t.fieldTransforms.map(function(e){var t=e.transform;{if(t instanceof qb)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof Bb)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Hb)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof Xb)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw ay("Unknown transform: "+e.transform)}})}};else{if(!(t instanceof D_))return ay("Unknown mutation type "+t.type);n={verify:db(e,t.key)}}return t.precondition.isNone||(n.currentDocument=(e=e,uy(!(t=t.precondition).isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:function(e,t){return cb(e,t.toTimestamp())}(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ay("Unknown precondition"))),n}function Ib(t,e){var n=e.currentDocument?void 0!==(o=e.currentDocument).updateTime?o_.updateTime(hb(o.updateTime)):void 0!==o.exists?o_.exists(o.exists):o_.none():o_.none();if(e.update){ib(e.update.name,"name");var r=gb(t,e.update.name),i=new Lv({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(e){e=e.fieldPaths||[];return new e_(e.map(function(e){return Py.fromServerFormat(e)}))}(e.updateMask);return new v_(r,i,o,n)}return new g_(r,i,n)}if(e.delete){r=gb(t,e.delete);return new k_(r,n)}if(e.transform){r=gb(t,e.transform.document),i=e.transform.fieldTransforms.map(function(e){return function(e,t){var n=null;{var r;"setToServerValue"in t?(sy("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=new qb):"appendMissingElements"in t?(r=t.appendMissingElements.values||[],n=new Bb(r)):"removeAllFromArray"in t?(r=t.removeAllFromArray.values||[],n=new Hb(r)):"increment"in t?n=new Xb(e,t.increment):ay("Unknown transform proto: "+JSON.stringify(t))}t=Py.fromServerFormat(t.fieldPath);return new n_(t,n)}(t,e)});return sy(!0===n.exists,'Transforms only support precondition "exists == true"'),new E_(r,i)}if(e.verify){r=gb(t,e.verify);return new D_(r,n)}return ay("unknown mutation proto: "+JSON.stringify(e))}function Sb(e,r){return e&&0<e.length?(sy(void 0!==r,"Received a write result without a commit time"),e.map(function(e){return n=r,(e=(t=e).updateTime?hb(t.updateTime):hb(n)).isEqual(yv.min())&&(e=hb(n)),n=null,t.transformResults&&0<t.transformResults.length&&(n=t.transformResults),new i_(e,n);var t,n})):[]}function Cb(e,t){return{documents:[yb(e,t.path)]}}function kb(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(uy(r.length%2==0,"Collection Group queries should be within a document path or root."),n.parent=yb(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(uy(r.length%2!=0,"Document queries with filters are not supported."),n.parent=yb(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);r=function(e){if(0===e.length)return;e=e.map(function(e){return uy(e instanceof Vm,"Only FieldFilters are supported"),function(e){if("=="===e.op){if(am(e.value))return{unaryFilter:{field:Ob(e.field),op:"IS_NAN"}};if(om(e.value))return{unaryFilter:{field:Ob(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(am(e.value))return{unaryFilter:{field:Ob(e.field),op:"IS_NOT_NAN"}};if(om(e.value))return{unaryFilter:{field:Ob(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ob(e.field),op:function(e){return rb[e]}(e.op),value:e.value}}}(e)});return 1!==e.length?{compositeFilter:{op:"AND",filters:e}}:e[0]}(t.filters);r&&(n.structuredQuery.where=r);r=0!==(r=t.orderBy).length?r.map(function(e){return{field:Ob((e=e).field),direction:function(e){return nb[e]}(e.dir)}}):void 0;r&&(n.structuredQuery.orderBy=r);r=e,e=t.limit,e=r.useProto3Json||Ty(e)?e:{value:e};return null!==e&&(n.structuredQuery.limit=e),t.startAt&&(n.structuredQuery.startAt=Db(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Db(t.endAt)),n}function Ab(e){var t=mb(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(sy(1===r,"StructuredQuery.from with more than one collection is not supported."),(a=n.from[0]).allDescendants?i=a.collectionId:t=t.child(a.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[xb(e)]:void 0!==e.fieldFilter?[(n=e,Vm.create(Pb(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ay("Unspecified operator");default:return ay("Unknown operator")}}(n.fieldFilter.op),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(e,t){return e.concat(t)}):ay("Unknown filter: "+JSON.stringify(e)):[];var n}(n.where));e=[];n.orderBy&&(e=n.orderBy.map(function(e){return new gv(Pb((e=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}));r=null;n.limit&&(r=Ty(s="object"==typeof(s=n.limit)?s.value:s)?null:s);var a=null;n.startAt&&(a=Rb(n.startAt));var s=null;return n.endAt&&(s=Rb(n.endAt)),Im(t,i,e,o,r,"F",a,s)}function Nb(e,t){t=function(e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ay("Unrecognized query purpose: "+e)}}(t.purpose);return null==t?null:{"goog-listen-tags":t}}function Db(e){return{before:e.before,values:e.position}}function Rb(e){var t=!!e.before,e=e.values||[];return new hv(e,t)}function Ob(e){return{fieldPath:e.canonicalString()}}function Pb(e){return Py.fromServerFormat(e.fieldPath)}function xb(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Pb(e.unaryFilter.field);return Vm.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Pb(e.unaryFilter.field);return Vm.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Pb(e.unaryFilter.field);return Vm.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":e=Pb(e.unaryFilter.field);return Vm.create(e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ay("Unspecified filter");default:return ay("Unknown filter")}}function Lb(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)}ge=function(){this._=void 0};function Mb(e,t,n){return e instanceof qb?(r=n,n=t,i={fields:((i={})[Uy]={stringValue:Fy},i[jy]={timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}},i)},n&&(i.fields[qy]=n),{mapValue:i}):e instanceof Bb?Wb(e,t):e instanceof Hb?Qb(e,t):(uy(e instanceof Xb,"Expected NumericIncrementTransformOperation but was: "+e),e=$b(t=Fb(i=e,e=t))+$b(i.operand),tm(t)&&tm(i.operand)?ab(e):sb(i.serializer,e));var r,i}function Fb(e,t){return e instanceof Xb?nm(t)?t:{integerValue:0}:null}var Ub,qb=(vo(jb,Ub=ge),jb);function jb(){return null!==Ub&&Ub.apply(this,arguments)||this}var Vb,Bb=(vo(Kb,Vb=ge),Kb);function Kb(e){var t=Vb.call(this)||this;return t.elements=e,t}function Wb(e,t){for(var n=Zb(t),r=0,i=e.elements;r<i.length;r++){!function(t){n.some(function(e){return zy(e,t)})||n.push(t)}(i[r])}return{arrayValue:{values:n}}}var zb,Hb=(vo(Gb,zb=ge),Gb);function Gb(e){var t=zb.call(this)||this;return t.elements=e,t}function Qb(e,t){for(var n=Zb(t),r=0,i=e.elements;r<i.length;r++){!function(t){n=n.filter(function(e){return!zy(e,t)})}(i[r])}return{arrayValue:{values:n}}}var Yb,Xb=(vo(Jb,Yb=ge),Jb);function Jb(e,t){var n=Yb.call(this)||this;return n.serializer=e,uy(nm(n.operand=t),"NumericIncrementTransform transform requires a NumberValue"),n}function $b(e){return $y(e.integerValue||e.doubleValue)}function Zb(e){return rm(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var e_=(t_.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++){if(n[t].isPrefixOf(e))return!0}return!1},t_.prototype.isEqual=function(e){return py(this.fields,e.fields,function(e,t){return e.isEqual(t)})},t_);function t_(n){(this.fields=n).sort(Py.comparator),uy(!n.some(function(e,t){return 0!==t&&e.isEqual(n[t-1])}),"FieldMask contains field that is not unique: "+n.find(function(e,t){return 0!==t&&e.isEqual(n[t-1])}))}var n_=function(e,t){this.field=e,this.transform=t};function r_(e,t){return e.field.isEqual(t.field)&&(e=e.transform,t=t.transform,e instanceof Bb&&t instanceof Bb||e instanceof Hb&&t instanceof Hb?py(e.elements,t.elements,zy):e instanceof Xb&&t instanceof Xb?zy(e.operand,t.operand):e instanceof qb&&t instanceof qb)}var i_=function(e,t){this.version=e,this.transformResults=t},o_=(a_.none=function(){return new a_},a_.exists=function(e){return new a_(void 0,e)},a_.updateTime=function(e){return new a_(e)},Object.defineProperty(a_.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),a_.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},a_);function a_(e,t){this.updateTime=e,this.exists=t,uy(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}function s_(e,t){return void 0!==e.updateTime?t instanceof cm&&t.version.isEqual(e.updateTime):void 0!==e.exists?e.exists===t instanceof cm:(uy(e.isNone,"Precondition should be empty"),1)}Gn=function(){};function u_(e,t,n){return f_(e,t),e instanceof g_?(r=e,uy(null==(i=n).transformResults,"Transform results received by SetMutation."),new cm(r.key,i.version,r.value,{hasCommittedMutations:!0})):e instanceof v_?function(e,t,n){if(uy(null==n.transformResults,"Transform results received by PatchMutation."),!s_(e.precondition,t))return new gm(e.key,n.version);t=__(e,t);return new cm(e.key,n.version,t,{hasCommittedMutations:!0})}(e,t,n):e instanceof E_?function(e,t,n){if(sy(null!=n.transformResults,"Transform results missing for TransformMutation."),!s_(e.precondition,t))return new gm(e.key,n.version);var r=I_(e,t),t=function(e,t,n){var r=[];sy(e.length===n.length,"server transform result count ("+n.length+") should match field transform count ("+e.length+")");for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=null;t instanceof cm&&(s=t.field(o.field)),r.push(function(e,t,n){return e instanceof Bb?Wb(e,t):e instanceof Hb?Qb(e,t):(uy(null!==n,"Didn't receive transformResult for non-array transform"),n)}(a,s,n[i]))}return r}(e.fieldTransforms,t,n.transformResults),n=n.version,t=S_(e,r.data(),t);return new cm(e.key,n,t,{hasCommittedMutations:!0})}(e,t,n):(uy(e instanceof k_,"Unexpected mutation type: "+e),e=e,uy(null==(n=n).transformResults,"Transform results received by DeleteMutation."),new fm(e.key,n.version,{hasCommittedMutations:!0}));var r,i}function c_(e,t,n,r){return f_(e,t),e instanceof g_?function(e,t){if(!s_(e.precondition,t))return t;t=p_(t);return new cm(e.key,t,e.value,{hasLocalMutations:!0})}(e,t):e instanceof v_?function(e,t){if(!s_(e.precondition,t))return t;var n=p_(t),t=__(e,t);return new cm(e.key,n,t,{hasLocalMutations:!0})}(e,t):e instanceof E_?function(e,t,n,r){if(!s_(e.precondition,t))return t;var i=I_(e,t),r=function(e,t,n,r){for(var i=[],o=0,a=e;o<a.length;o++){var s=a[o],u=s.transform,c=null;n instanceof cm&&(c=n.field(s.field)),null===c&&r instanceof cm&&(c=r.field(s.field)),i.push(Mb(u,c,t))}return i}(e.fieldTransforms,n,t,r),r=S_(e,i.data(),r);return new cm(e.key,i.version,r,{hasLocalMutations:!0})}(e,t,r,n):(uy(e instanceof k_,"Unexpected mutation type: "+e),function(e,t){if(!s_(e.precondition,t))return t;t&&uy(t.key.isEqual(e.key),"Can only apply mutation to document with same key");return new fm(e.key,yv.min())}(e,t))}function l_(e,t){return e instanceof E_?function(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],a=t instanceof cm?t.field(o.field):void 0,a=Fb(o.transform,a||null);null!=a&&(n=(null==n?new Fv:n).set(o.field,a))}return n?n.build():null}(e,t):null}function h_(e,t){return e.type===t.type&&(!!e.key.isEqual(t.key)&&(!!e.precondition.isEqual(t.precondition)&&(0===e.type?e.value.isEqual(t.value):1===e.type?e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask):2!==e.type||py(e.fieldTransforms,e.fieldTransforms,r_))))}function f_(e,t){null!=t&&uy(t.key.isEqual(e.key),"Can only apply a mutation to a document with the same key")}function p_(e){return e instanceof cm?e.version:yv.min()}var d_,g_=(vo(y_,d_=Gn),y_);function y_(e,t,n){var r=d_.call(this)||this;return r.key=e,r.value=t,r.precondition=n,r.type=0,r}var m_,v_=(vo(b_,m_=Gn),b_);function b_(e,t,n,r){var i=m_.call(this)||this;return i.key=e,i.data=t,i.fieldMask=n,i.precondition=r,i.type=1,i}function __(e,t){var n,r,t=t instanceof cm?t.data():Lv.empty();return n=e,r=new Fv(t),n.fieldMask.fields.forEach(function(e){var t;e.isEmpty()||(null!==(t=n.data.field(e))?r.set(e,t):r.delete(e))}),r.build()}var w_,E_=(vo(T_,w_=Gn),T_);function T_(e,t){var n=w_.call(this)||this;return n.key=e,n.fieldTransforms=t,n.type=2,n.precondition=o_.exists(!0),n}function I_(e,t){return uy(t instanceof cm,"Unknown MaybeDocument type "+t),uy(t.key.isEqual(e.key),"Can only transform a document with the same key"),t}function S_(e,t,n){uy(n.length===e.fieldTransforms.length,"TransformResults length mismatch.");for(var r=new Fv(t),i=0;i<e.fieldTransforms.length;i++){var o=e.fieldTransforms[i];r.set(o.field,n[i])}return r.build()}var C_,k_=(vo(A_,C_=Gn),A_);function A_(e,t){var n=C_.call(this)||this;return n.key=e,n.precondition=t,n.type=3,n}var N_,D_=(vo(R_,N_=Gn),R_);function R_(e,t){var n=N_.call(this)||this;return n.key=e,n.precondition=t,n.type=4,n}var O_=-1,P_=(x_.prototype.applyToRemoteDocument=function(e,t,n){t&&uy(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;uy(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(e)&&(t=u_(o,t,r[i]))}return t},x_.prototype.applyToLocalView=function(e,t){t&&uy(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(i=r[n]).key.isEqual(e)&&(t=c_(i,t,t,this.localWriteTime))}for(var i,o=t,a=0,s=this.mutations;a<s.length;a++){(i=s[a]).key.isEqual(e)&&(t=c_(i,t,o,this.localWriteTime))}return t},x_.prototype.applyToLocalDocumentSet=function(n){var r=this,i=n;return this.mutations.forEach(function(e){var t=r.applyToLocalView(e.key,n.get(e.key));t&&(i=i.insert(e.key,t))}),i},x_.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Pv())},x_.prototype.isEqual=function(e){return this.batchId===e.batchId&&py(this.mutations,e.mutations,h_)&&py(this.baseMutations,e.baseMutations,h_)},x_);function x_(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,uy(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}var L_=(M_.from=function(e,t,n){sy(e.mutations.length===n.length,"Mutations sent "+e.mutations.length+" must equal results received "+n.length);for(var r=Rv,i=e.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new M_(e,t,n,r)},M_);function M_(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}var F_=(U_.prototype.get=function(e){var t=this.mapKeyFn(e),t=this.inner[t];if(void 0!==t)for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.equalsFn(o,e))return i}},U_.prototype.has=function(e){return void 0!==this.get(e)},U_.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},U_.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},U_.prototype.forEach=function(a){by(this.inner,function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i[0],i=i[1];a(o,i)}})},U_.prototype.isEmpty=function(){return _y(this.inner)},U_);function U_(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}var q_=(j_.prototype.catch=function(e){return this.next(void 0,e)},j_.prototype.next=function(r,i){var o=this;return this.callbackAttached&&ay("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new j_(function(t,n){o.nextCallback=function(e){o.wrapSuccess(r,e).next(t,n)},o.catchCallback=function(e){o.wrapFailure(i,e).next(t,n)}})},j_.prototype.toPromise=function(){var n=this;return new Promise(function(e,t){n.next(e,t)})},j_.prototype.wrapUserFunction=function(e){try{var t=e();return t instanceof j_?t:j_.resolve(t)}catch(e){return j_.reject(e)}},j_.prototype.wrapSuccess=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):j_.resolve(t)},j_.prototype.wrapFailure=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):j_.reject(t)},j_.resolve=function(n){return new j_(function(e,t){e(n)})},j_.reject=function(n){return new j_(function(e,t){t(n)})},j_.waitFor=function(e){return new j_(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(e){return n(e)})}),o=!0,i===r&&t()})},j_.or=function(e){for(var n=j_.resolve(!1),t=0,r=e;t<r.length;t++){!function(t){n=n.next(function(e){return e?j_.resolve(e):t()})}(r[t])}return n},j_.forEach=function(e,n){var r=this,i=[];return e.forEach(function(e,t){i.push(n.call(r,e,t))}),this.waitFor(i)},j_);function j_(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}var V_=(B_.prototype.getDocument=function(t,n){var r=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,n).next(function(e){return r.getDocumentInternal(t,n,e)})},B_.prototype.getDocumentInternal=function(e,r,i){return this.remoteDocumentCache.getEntry(e,r).next(function(e){for(var t=0,n=i;t<n.length;t++){e=n[t].applyToLocalView(r,e)}return e})},B_.prototype.applyLocalMutationsToDocuments=function(e,t,i){var o=Nv;return t.forEach(function(e,t){for(var n=0,r=i;n<r.length;n++){t=r[n].applyToLocalView(e,t)}o=o.insert(e,t)}),o},B_.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},B_.prototype.getLocalViewOfDocuments=function(t,r){var i=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(function(e){var e=i.applyLocalMutationsToDocuments(t,r,e),n=Nv;return e.forEach(function(e,t){t=t||new fm(e,yv.min()),n=n.insert(e,t)}),n})},B_.prototype.getDocumentsMatchingQuery=function(e,t,n){return Dm(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)},B_.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new Ly(t)).next(function(e){var t=Dv;return e instanceof cm&&(t=t.insert(e.key,e)),t})},B_.prototype.getDocumentsMatchingCollectionGroupQuery=function(n,r,i){var o=this;uy(r.path.isEmpty(),"Currently we only support collection group queries at the root.");var a=r.collectionGroup,s=Dv;return this.indexManager.getCollectionParents(n,a).next(function(e){return q_.forEach(e,function(e){var t,t=(t=r,e=e.child(a),new Tm(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt));return o.getDocumentsMatchingCollectionQuery(n,t,i).next(function(e){e.forEach(function(e,t){s=s.insert(e,t)})})}).next(function(){return s})})},B_.prototype.getDocumentsMatchingCollectionQuery=function(t,n,e){var c,l,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,e).next(function(e){return c=e,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,n)}).next(function(e){return l=e,r.addMissingBaseDocuments(t,l,c).next(function(e){c=e;for(var t=0,n=l;t<n.length;t++)for(var r=n[t],i=0,o=r.mutations;i<o.length;i++){var a=o[i],s=a.key,u=c.get(s),u=c_(a,u,u,r.localWriteTime);c=u instanceof cm?c.insert(s,u):c.remove(s)}})}).next(function(){return c.forEach(function(e,t){Um(n,t)||(c=c.remove(e))}),c})},B_.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=Pv(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof v_&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(e,r).next(function(e){return e.forEach(function(e,t){null!==t&&t instanceof cm&&(c=c.insert(e,t))}),c})},B_);function B_(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}var K_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",de=(W_.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},W_.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},W_);function W_(){this.onCommittedListeners=[]}var z_=(H_.prototype.withSequenceNumber=function(e){return new H_(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},H_.prototype.withResumeToken=function(e,t){return new H_(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)},H_.prototype.withLastLimboFreeSnapshotVersion=function(e){return new H_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},H_);function H_(e,t,n,r,i,o,a){void 0===i&&(i=yv.min()),void 0===o&&(o=yv.min()),void 0===a&&(a=wy.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}var G_=(Q_.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},Q_.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},Q_);function Q_(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}G_.INVALID=-1;var Y_="",X_="",J_="",$_="";function Z_(e){for(var t="",n=0;n<e.length;n++)0<t.length&&(t=ew(t)),t=function(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+=Y_+J_;break;case Y_:n+=Y_+$_;break;default:n+=o}}return n}(e.get(n),t);return ew(t)}function ew(e){return e+Y_+X_}function tw(e){var t=e.length;if(sy(2<=t,"Invalid path "+e),2===t)return sy(e.charAt(0)===Y_&&e.charAt(1)===X_,"Non-empty path "+e+" had length 2"),Ny.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(Y_,o);switch((a<0||n<a)&&ay('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case X_:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case J_:i+=e.substring(o,a),i+="\0";break;case $_:i+=e.substring(o,a+1);break;default:ay('Invalid encoded resource path: "'+e+'"')}o=a+2}return new Ny(r)}var nw=function(e){this.remoteSerializer=e};function rw(e,t){if(t.document)return i=e.remoteSerializer,o=t.document,r=!!t.hasCommittedMutations,e=gb(i,o.name),i=hb(o.updateTime),o=new Lv({mapValue:{fields:o.fields}}),new cm(e,i,o,{hasCommittedMutations:!!r});if(t.noDocument){var n=Ly.fromSegments(t.noDocument.path),r=uw(t.noDocument.readTime);return new fm(n,r,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){n=Ly.fromSegments(t.unknownDocument.path),t=uw(t.unknownDocument.version);return new gm(n,t)}return ay("Unexpected DbRemoteDocument");var i,o,r}function iw(e,t,n){var r=ow(n),n=t.key.path.popLast().toArray();if(t instanceof cm){var i=(i=e.remoteSerializer,uy(!(o=t).hasLocalMutations,"Can't serialize documents with mutations."),{name:db(i,o.key),fields:o.toProto().mapValue.fields,updateTime:cb(i,o.version.toTimestamp())}),o=t.hasCommittedMutations;return new uE(null,null,i,o,r,n)}if(t instanceof fm){var a=t.key.path.toArray(),i=sw(t.version),o=t.hasCommittedMutations;return new uE(null,new aE(a,i),null,o,r,n)}if(t instanceof gm){a=t.key.path.toArray(),t=sw(t.version);return new uE(new sE(a,t),null,null,!0,r,n)}return ay("Unexpected MaybeDocument")}function ow(e){e=e.toTimestamp();return[e.seconds,e.nanoseconds]}function aw(e){e=new yy(e[0],e[1]);return yv.fromTimestamp(e)}function sw(e){e=e.toTimestamp();return new eE(e.seconds,e.nanoseconds)}function uw(e){e=new yy(e.seconds,e.nanoseconds);return yv.fromTimestamp(e)}function cw(t,e){var n=(e.baseMutations||[]).map(function(e){return Ib(t.remoteSerializer,e)}),r=e.mutations.map(function(e){return Ib(t.remoteSerializer,e)}),i=yy.fromMillis(e.localWriteTimeMs);return new P_(e.batchId,i,n,r)}function lw(e){var t,n=uw(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?uw(e.lastLimboFreeSnapshotVersion):yv.min(),i=void 0!==e.query.documents?(i=e.query,sy(1===(t=i.documents.length),"DocumentsTarget contained other than 1 document: "+t),Pm(Sm(mb(i.documents[0])))):Pm(Ab(e.query));return new z_(i,e.targetId,0,e.lastListenSequenceNumber,n,r,wy.fromBase64String(e.resumeToken))}function hw(e,t){uy(0===t.purpose,"Only queries with purpose 0 may be stored, got "+t.purpose);var n=sw(t.snapshotVersion),r=sw(t.lastLimboFreeSnapshotVersion),i=(Em(t.target)?Cb:kb)(e.remoteSerializer,t.target),e=t.resumeToken.toBase64();return new lE(t.targetId,bm(t.target),n,e,t.sequenceNumber,r,i)}function fw(e){var t=Ab({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?(uy(!!t.limit,"Bundled query has limitType LAST, but limit is null"),xm(t,t.limit,"L")):t}var pw=(dw.forUser=function(e,t,n,r){return sy(""!==e.uid,"UserID must not be an empty string."),new dw(e.isAuthenticated()?e.uid:"",t,n,r)},dw.prototype.checkEmpty=function(e){var r=!0,t=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mw(e).iterate({index:rE.userMutationsIndex,range:t},function(e,t,n){r=!1,n.done()}).next(function(){return r})},dw.prototype.addMutationBatch=function(d,g,y,m){var v=this,b=vw(d),_=mw(d);return _.add({}).next(function(e){sy("number"==typeof e,"Auto-generated key is not a number");for(var t,n,r,i,o,a=new P_(e,g,y,m),s=(t=v.serializer,n=v.userId,i=(r=a).baseMutations.map(function(e){return Tb(t.remoteSerializer,e)}),o=r.mutations.map(function(e){return Tb(t.remoteSerializer,e)}),new rE(n,r.batchId,r.localWriteTime.toMillis(),i,o)),u=[],c=new Sv(function(e,t){return fy(e.canonicalString(),t.canonicalString())}),l=0,h=m;l<h.length;l++){var f=h[l],p=iE.key(v.userId,f.key.path,e),c=c.add(f.key.path.popLast());u.push(_.put(s)),u.push(b.put(p,iE.PLACEHOLDER))}return c.forEach(function(e){u.push(v.indexManager.addToCollectionParentIndex(d,e))}),d.addOnCommittedListener(function(){v.documentKeysByBatchId[e]=a.keys()}),q_.waitFor(u).next(function(){return a})})},dw.prototype.lookupMutationBatch=function(e,t){var n=this;return mw(e).get(t).next(function(e){return e?(sy(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),cw(n.serializer,e)):null})},dw.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?q_.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){e=e.keys();return n.documentKeysByBatchId[t]=e}return null})},dw.prototype.getNextMutationBatchAfterBatchId=function(e,t){var r=this,i=t+1,t=IDBKeyRange.lowerBound([this.userId,i]),o=null;return mw(e).iterate({index:rE.userMutationsIndex,range:t},function(e,t,n){t.userId===r.userId&&(sy(t.batchId>=i,"Should have found mutation after "+i),o=cw(r.serializer,t)),n.done()}).next(function(){return o})},dw.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=O_;return mw(e).iterate({index:rE.userMutationsIndex,range:t,reverse:!0},function(e,t,n){r=t.batchId,n.done()}).next(function(){return r})},dw.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,O_],[this.userId,Number.POSITIVE_INFINITY]);return mw(e).loadAll(rE.userMutationsIndex,n).next(function(e){return e.map(function(e){return cw(t.serializer,e)})})},dw.prototype.getAllMutationBatchesAffectingDocumentKey=function(a,s){var u=this,e=iE.prefixForPath(this.userId,s.path),e=IDBKeyRange.lowerBound(e),c=[];return vw(a).iterate({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],i=tw(i);if(r===u.userId&&s.path.isEqual(i))return mw(a).get(o).next(function(e){if(!e)throw ay("Dangling document-mutation reference found: "+t+" which points to "+o);sy(e.userId===u.userId,"Unexpected user '"+e.userId+"' for mutation batch "+o),c.push(cw(u.serializer,e))});n.done()}).next(function(){return c})},dw.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var a=this,s=new Sv(fy),n=[];return e.forEach(function(o){var e=iE.prefixForPath(a.userId,o.path),e=IDBKeyRange.lowerBound(e),e=vw(t).iterate({range:e},function(e,t,n){var r=e[0],i=e[1],e=e[2],i=tw(i);r===a.userId&&o.path.isEqual(i)?s=s.add(e):n.done()});n.push(e)}),q_.waitFor(n).next(function(){return a.lookupMutationBatches(t,s)})},dw.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var o=this;uy(!Dm(t),"Document queries shouldn't go down this path"),uy(!Rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");var a=t.path,s=a.length+1,t=iE.prefixForPath(this.userId,a),t=IDBKeyRange.lowerBound(t),u=new Sv(fy);return vw(e).iterate({range:t},function(e,t,n){var r=e[0],i=e[1],e=e[2],i=tw(i);r===o.userId&&a.isPrefixOf(i)?i.length===s&&(u=u.add(e)):n.done()}).next(function(){return o.lookupMutationBatches(e,u)})},dw.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(mw(e).get(t).next(function(e){if(null===e)throw ay("Dangling document-mutation reference found, which points to "+t);sy(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(cw(n.serializer,e))}))}),q_.waitFor(i).next(function(){return r})},dw.prototype.removeMutationBatch=function(t,n){var r=this;return yw(t.simpleDbTransaction,this.userId,n).next(function(e){return t.addOnCommittedListener(function(){r.removeCachedMutationKeys(n.batchId)}),q_.forEach(e,function(e){return r.referenceDelegate.markPotentiallyOrphaned(t,e)})})},dw.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},dw.prototype.performConsistencyCheck=function(t){var i=this;return this.checkEmpty(t).next(function(e){if(!e)return q_.resolve();var e=IDBKeyRange.lowerBound(iE.prefixForUser(i.userId)),r=[];return vw(t).iterate({range:e},function(e,t,n){e[0]===i.userId?(e=tw(e[1]),r.push(e)):n.done()}).next(function(){sy(0===r.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+r.map(function(e){return e.canonicalString()}))})})},dw.prototype.containsKey=function(e,t){return gw(e,this.userId,t)},dw.prototype.getMutationQueueMetadata=function(e){var t=this;return bw(e).get(this.userId).next(function(e){return e||new nE(t.userId,O_,"")})},dw);function dw(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}function gw(e,o,t){var t=iE.prefixForPath(o,t.path),a=t[1],t=IDBKeyRange.lowerBound(t),s=!1;return vw(e).iterate({range:t,keysOnly:!0},function(e,t,n){var r=e[0],i=e[1];e[2];r===o&&i===a&&(s=!0),n.done()}).next(function(){return s})}function yw(e,t,n){var r=e.store(rE.store),i=e.store(iE.store),o=[],e=IDBKeyRange.only(n.batchId),a=0,e=r.iterate({range:e},function(e,t,n){return a++,n.delete()});o.push(e.next(function(){sy(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var s=[],u=0,c=n.mutations;u<c.length;u++){var l=c[u],h=iE.key(t,l.key.path,n.batchId);o.push(i.delete(h)),s.push(l.key)}return q_.waitFor(o).next(function(){return s})}function mw(e){return XE.getStore(e,rE.store)}function vw(e){return XE.getStore(e,iE.store)}function bw(e){return XE.getStore(e,nE.store)}_w.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?(uy(!!t.readTime,"Read time is not set for "+e+". All removeEntry() calls must include a readTime if 'trackRemovals' is used."),t.readTime):yv.min()},_w.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{maybeDocument:e,readTime:t})},_w.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{maybeDocument:null,readTime:t})},_w.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?q_.resolve(n.maybeDocument):this.getFromCache(e,t)},_w.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},_w.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},_w.prototype.assertNotApplied=function(){uy(!this.changesApplied,"Changes have already been applied.")},ge=_w;function _w(){this.changes=new F_(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}var ww=(Ew.prototype.addEntry=function(e,t,n){return kw(e).put(Aw(t),n)},Ew.prototype.removeEntry=function(e,t){e=kw(e),t=Aw(t);return e.delete(t)},Ew.prototype.updateMetadata=function(t,n){var r=this;return this.getMetadata(t).next(function(e){return e.byteSize+=n,r.setMetadata(t,e)})},Ew.prototype.getEntry=function(e,t){var n=this;return kw(e).get(Aw(t)).next(function(e){return n.maybeDecodeDocument(e)})},Ew.prototype.getSizedEntry=function(e,t){var n=this;return kw(e).get(Aw(t)).next(function(e){var t=n.maybeDecodeDocument(e);return t?{maybeDocument:t,size:Nw(e)}:null})},Ew.prototype.getEntries=function(e,t){var n=this,r=Nv;return this.forEachDbEntry(e,t,function(e,t){t=n.maybeDecodeDocument(t);r=r.insert(e,t)}).next(function(){return r})},Ew.prototype.getSizedEntries=function(e,t){var r=this,i=Nv,o=new vv(Ly.comparator);return this.forEachDbEntry(e,t,function(e,t){var n=r.maybeDecodeDocument(t);o=n?(i=i.insert(e,n),o.insert(e,Nw(t))):(i=i.insert(e,null),o.insert(e,0))}).next(function(){return{maybeDocuments:i,sizeMap:o}})},Ew.prototype.forEachDbEntry=function(e,t,i){if(t.isEmpty())return q_.resolve();var n=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),o=t.getIterator(),a=o.getNext();return kw(e).iterate({range:n},function(e,t,n){for(var r=Ly.fromSegments(e);a&&Ly.comparator(a,r)<0;)i(a,null),a=o.getNext();a&&a.isEqual(r)&&(i(a,t),a=o.hasNext()?o.getNext():null),a?n.skip(a.path.toArray()):n.done()}).next(function(){for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})},Ew.prototype.getDocumentsMatchingQuery=function(e,r,t){var i=this;uy(!Rm(r),"CollectionGroup queries should be handled in LocalDocumentsView");var n,o=Dv,a=r.path.length+1,s={};return t.isEqual(yv.min())?(n=r.path.toArray(),s.range=IDBKeyRange.lowerBound(n)):(n=r.path.toArray(),t=ow(t),s.range=IDBKeyRange.lowerBound([n,t],!0),s.index=uE.collectionReadTimeIndex),kw(e).iterate(s,function(e,t,n){e.length===a&&(t=rw(i.serializer,t),r.path.isPrefixOf(t.key.path)?t instanceof cm&&Um(r,t)&&(o=o.insert(t.key,t)):n.done())}).next(function(){return o})},Ew.prototype.newChangeBuffer=function(e){return new Iw(this,!!e&&e.trackRemovals)},Ew.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},Ew.prototype.getMetadata=function(e){return Cw(e).get(cE.key).next(function(e){return sy(!!e,"Missing document cache metadata"),e})},Ew.prototype.setMetadata=function(e,t){return Cw(e).put(cE.key,t)},Ew.prototype.maybeDecodeDocument=function(e){if(e){e=rw(this.serializer,e);return e instanceof fm&&e.version.isEqual(yv.min())?null:e}return null},Ew);function Ew(e,t){this.serializer=e,this.indexManager=t}var Tw,Iw=(vo(Sw,Tw=ge),Sw.prototype.applyChanges=function(i){var o=this,a=[],s=0,u=new Sv(function(e,t){return fy(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(e,t){var n,r=o.documentSizes.get(e);uy(void 0!==r,"Cannot modify a document that wasn't read (for "+e+")"),t.maybeDocument?(uy(!o.getReadTime(e).isEqual(yv.min()),"Cannot add a document with a read time of zero"),n=iw(o.documentCache.serializer,t.maybeDocument,o.getReadTime(e)),u=u.add(e.path.popLast()),t=Nw(n),s+=t-r,a.push(o.documentCache.addEntry(i,e,n))):(s-=r,o.trackRemovals?(r=iw(o.documentCache.serializer,new fm(e,yv.min()),o.getReadTime(e)),a.push(o.documentCache.addEntry(i,e,r))):a.push(o.documentCache.removeEntry(i,e)))}),u.forEach(function(e){a.push(o.documentCache.indexManager.addToCollectionParentIndex(i,e))}),a.push(this.documentCache.updateMetadata(i,s)),q_.waitFor(a)},Sw.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next(function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)})},Sw.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next(function(e){var t=e.maybeDocuments;return e.sizeMap.forEach(function(e,t){n.documentSizes.set(e,t)}),t})},Sw);function Sw(e,t){var n=Tw.call(this)||this;return n.documentCache=e,n.trackRemovals=t,n.documentSizes=new F_(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),n}function Cw(e){return XE.getStore(e,cE.store)}function kw(e){return XE.getStore(e,uE.store)}function Aw(e){return e.path.toArray()}function Nw(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ay("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var Dw=(Rw.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),q_.resolve()},Rw.prototype.getCollectionParents=function(e,t){return q_.resolve(this.collectionParentIndex.getEntries(t))},Rw);function Rw(){this.collectionParentIndex=new Ow}var Ow=(Pw.prototype.add=function(e){uy(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Sv(Ny.comparator),e=!r.has(n);return this.index[t]=r.add(n),e},Pw.prototype.has=function(e){var t=e.lastSegment(),e=e.popLast(),t=this.index[t];return t&&t.has(e)},Pw.prototype.getEntries=function(e){return(this.index[e]||new Sv(Ny.comparator)).toArray()},Pw);function Pw(){this.index={}}var xw=function(){var n=this;this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})},Lw="SimpleDb",Mw=(Fw.delete=function(e){return ny(Lw,"Removing database:",e),Qw(window.indexedDB.deleteDatabase(e)).toPromise()},Fw.isAvailable=function(){if("undefined"==typeof indexedDB)return!1;if(Fw.isMockPersistence())return!0;var e=Mo(),t=Fw.getIOSVersion(e),n=0<t&&t<10,t=Fw.getAndroidVersion(e),t=0<t&&t<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||n||t)},Fw.isMockPersistence=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},Fw.getStore=function(e,t){return e.store(t)},Fw.getIOSVersion=function(e){e=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),e=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(e)},Fw.getAndroidVersion=function(e){e=e.match(/Android ([\d.]+)/i),e=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(e)},Fw.prototype.ensureDb=function(o){return _o(this,void 0,void 0,function(){var t,i=this;return wo(this,function(e){switch(e.label){case 0:return this.db?[3,2]:(ny(Lw,"Opening database:",this.name),t=this,[4,new Promise(function(t,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(e){e=e.target.result;t(e)},r.onblocked=function(){n(new Vw(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(e){e=e.target.error;"VersionError"===e.name?n(new Jg(Xg.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Vw(o,e))},r.onupgradeneeded=function(e){ny(Lw,'Database "'+i.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;i.schemaConverter.createOrUpgrade(t,r.transaction,e.oldVersion,i.version).next(function(){ny(Lw,"Database upgrade to version "+i.version+" complete")})}})]);case 1:t.db=e.sent(),e.label=2;case 2:return this.versionchangelistener&&(this.db.onversionchange=function(e){return i.versionchangelistener(e)}),[2,this.db]}})})},Fw.prototype.setVersionChangeListener=function(t){this.versionchangelistener=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},Fw.prototype.runTransaction=function(s,n,u,c){return _o(this,void 0,void 0,function(){var i,o,a,t;return wo(this,function(e){switch(e.label){case 0:i="readonly"===n,o=0,t=function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:++o,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,a.ensureDb(s)];case 2:return a.db=e.sent(),t=Ww.open(a.db,s,i?"readonly":"readwrite",u),(r=c(t).catch(function(e){return t.abort(e),q_.reject(e)}).toPromise()).catch(function(){}),[4,t.completionPromise];case 3:return e.sent(),[2,{value:r}];case 4:return n=e.sent(),r="FirebaseError"!==n.name&&o<3,ny(Lw,"Transaction failed with error:",n.message,"Retrying:",r),a.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},a=this,e.label=1;case 1:return[5,t()];case 2:return"object"==typeof(t=e.sent())?[2,t.value]:[3,1];case 3:return[2]}})})},Fw.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Fw);function Fw(e,t,n){this.name=e,this.version=t,this.schemaConverter=n,uy(Fw.isAvailable(),"IndexedDB not supported in current environment."),12.2===Fw.getIOSVersion(Mo())&&ry("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}var Uw=(Object.defineProperty(qw.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!1,configurable:!0}),Object.defineProperty(qw.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!1,configurable:!0}),Object.defineProperty(qw.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!1,configurable:!0}),qw.prototype.done=function(){this.shouldStop=!0},qw.prototype.skip=function(e){this.nextKey=e},qw.prototype.delete=function(){return Qw(this.dbCursor.delete())},qw);function qw(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}var jw,Vw=(vo(Bw,jw=Jg),Bw);function Bw(e,t){t=jw.call(this,Xg.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+t)||this;return t.name="IndexedDbTransactionError",t}function Kw(e){return"IndexedDbTransactionError"===e.name}var Ww=(zw.open=function(e,t,n,r){try{return new zw(t,e.transaction(r,n))}catch(e){throw new Vw(t,e)}},Object.defineProperty(zw.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!1,configurable:!0}),zw.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(ny(Lw,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},zw.prototype.store=function(e){var t=this.transaction.objectStore(e);return uy(!!t,"Object store not part of transaction: "+e),new Hw(t)},zw);function zw(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.completionDeferred=new xw,this.transaction.oncomplete=function(){n.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?n.completionDeferred.reject(new Vw(t,e.error)):n.completionDeferred.resolve()},this.transaction.onerror=function(e){e=Xw(e.target.error);n.completionDeferred.reject(new Vw(t,e))}}var Hw=(Gw.prototype.put=function(e,t){e=void 0!==t?(ny(Lw,"PUT",this.store.name,e,t),this.store.put(t,e)):(ny(Lw,"PUT",this.store.name,"<auto-key>",e),this.store.put(e));return Qw(e)},Gw.prototype.add=function(e){return ny(Lw,"ADD",this.store.name,e,e),Qw(this.store.add(e))},Gw.prototype.get=function(t){var n=this;return Qw(this.store.get(t)).next(function(e){return void 0===e&&(e=null),ny(Lw,"GET",n.store.name,t,e),e})},Gw.prototype.delete=function(e){return ny(Lw,"DELETE",this.store.name,e),Qw(this.store.delete(e))},Gw.prototype.count=function(){return ny(Lw,"COUNT",this.store.name),Qw(this.store.count())},Gw.prototype.loadAll=function(e,t){var t=this.cursor(this.options(e,t)),n=[];return this.iterateCursor(t,function(e,t){n.push(t)}).next(function(){return n})},Gw.prototype.deleteAll=function(e,t){ny(Lw,"DELETE ALL",this.store.name);t=this.options(e,t);t.keysOnly=!1;t=this.cursor(t);return this.iterateCursor(t,function(e,t,n){return n.delete()})},Gw.prototype.iterate=function(e,t){t?n=e:(n={},t=e);var n=this.cursor(n);return this.iterateCursor(n,t)},Gw.prototype.iterateSerial=function(r){var e=this.cursor({});return new q_(function(n,t){e.onerror=function(e){e=Xw(e.target.error);t(e)},e.onsuccess=function(e){var t=e.target.result;t?r(t.primaryKey,t.value).next(function(e){e?t.continue():n()}):n()}})},Gw.prototype.iterateCursor=function(e,i){var o=[];return new q_(function(r,t){e.onerror=function(e){t(e.target.error)},e.onsuccess=function(e){var t,n=e.target.result;n?(t=new Uw(n),(e=i(n.primaryKey,n.value,t))instanceof q_&&(e=e.catch(function(e){return t.done(),q_.reject(e)}),o.push(e)),t.isDone?r():null===t.skipToKey?n.continue():n.continue(t.skipToKey)):r()}}).next(function(){return q_.waitFor(o)})},Gw.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(uy(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},Gw.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},Gw);function Gw(e){this.store=e}function Qw(e){return new q_(function(t,n){e.onsuccess=function(e){e=e.target.result;t(e)},e.onerror=function(e){e=Xw(e.target.error);n(e)}})}var Yw=!1;function Xw(e){var t=Mw.getIOSVersion(Mo());if(12.2<=t&&t<13){t="An internal error was encountered in the Indexed Database server";if(0<=e.message.indexOf(t)){var n=new Jg("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+t+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Yw||(Yw=!0,setTimeout(function(){throw n},0)),n}}return e}var Jw=11,$w=(Zw.prototype.createOrUpgrade=function(t,n,e,r){var i=this;sy(e<r&&0<=e&&r<=Jw,"Unexpected schema upgrade from v"+e+" to v"+r+".");var o=new Ww("createOrUpgrade",n);e<1&&1<=r&&(t.createObjectStore(tE.store),(a=t).createObjectStore(nE.store,{keyPath:nE.keyPath}),a.createObjectStore(rE.store,{keyPath:rE.keyPath,autoIncrement:!0}).createIndex(rE.userMutationsIndex,rE.userMutationsKeyPath,{unique:!0}),a.createObjectStore(iE.store),dE(t),t.createObjectStore(uE.store));var a,s=q_.resolve();return e<3&&3<=r&&(0!==e&&((a=t).deleteObjectStore(hE.store),a.deleteObjectStore(lE.store),a.deleteObjectStore(fE.store),dE(t)),s=s.next(function(){return t=(e=o).store(fE.store),e=new fE(0,0,yv.min().toTimestamp(),0),t.put(fE.key,e);var e,t})),e<4&&4<=r&&(0!==e&&(s=s.next(function(){return n=t,(r=o).store(rE.store).loadAll().next(function(e){n.deleteObjectStore(rE.store),n.createObjectStore(rE.store,{keyPath:rE.keyPath,autoIncrement:!0}).createIndex(rE.userMutationsIndex,rE.userMutationsKeyPath,{unique:!0});var t=r.store(rE.store),e=e.map(function(e){return t.put(e)});return q_.waitFor(e)});var n,r})),s=s.next(function(){t.createObjectStore(gE.store,{keyPath:gE.keyPath})})),e<5&&5<=r&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),e<6&&6<=r&&(s=s.next(function(){return t.createObjectStore(cE.store),i.addDocumentGlobal(o)})),e<7&&7<=r&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),e<8&&8<=r&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),e<9&&9<=r&&(s=s.next(function(){var e;(e=t).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),function(e){e=e.objectStore(uE.store);e.createIndex(uE.readTimeIndex,uE.readTimeIndexPath,{unique:!1}),e.createIndex(uE.collectionReadTimeIndex,uE.collectionReadTimeIndexPath,{unique:!1})}(n)})),e<10&&10<=r&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),e<11&&11<=r&&(s=s.next(function(){t.createObjectStore(yE.store,{keyPath:yE.keyPath}),t.createObjectStore(mE.store,{keyPath:mE.keyPath})})),s},Zw.prototype.addDocumentGlobal=function(t){var n=0;return t.store(uE.store).iterate(function(e,t){n+=Nw(t)}).next(function(){var e=new cE(n);return t.store(cE.store).put(cE.key,e)})},Zw.prototype.removeAcknowledgedMutations=function(n){var r=this,e=n.store(nE.store),i=n.store(rE.store);return e.loadAll().next(function(e){return q_.forEach(e,function(t){var e=IDBKeyRange.bound([t.userId,O_],[t.userId,t.lastAcknowledgedBatchId]);return i.loadAll(rE.userMutationsIndex,e).next(function(e){return q_.forEach(e,function(e){sy(e.userId===t.userId,"Cannot process batch "+e.batchId+" from unexpected user");e=cw(r.serializer,e);return yw(n,t.userId,e).next(function(){})})})})})},Zw.prototype.ensureSequenceNumbers=function(e){var o=e.store(hE.store),t=e.store(uE.store);return e.store(fE.store).get(fE.key).next(function(r){uy(!!r,"Metadata should have been written during the version 3 migration");var i=[];return t.iterate(function(e,t){var n=new Ny(e),e=[0,Z_(n)];i.push(o.get(e).next(function(e){return e?q_.resolve():(e=n,o.put(new hE(0,Z_(e),r.highestListenSequenceNumber)))}))}).next(function(){return q_.waitFor(i)})})},Zw.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(pE.store,{keyPath:pE.keyPath});function r(e){if(i.add(e)){var t=e.lastSegment(),e=e.popLast();return n.put({collectionId:t,parent:Z_(e)})}}var n=t.store(pE.store),i=new Ow;return t.store(uE.store).iterate({keysOnly:!0},function(e,t){e=new Ny(e);return r(e.popLast())}).next(function(){return t.store(iE.store).iterate({keysOnly:!0},function(e,t){e[0];var n=e[1],n=(e[2],tw(n));return r(n.popLast())})})},Zw.prototype.rewriteCanonicalIds=function(e){var n=this,r=e.store(lE.store);return r.iterate(function(e,t){t=lw(t),t=hw(n.serializer,t);return r.put(t)})},Zw);function Zw(e){this.serializer=e}var eE=function(e,t){this.seconds=e,this.nanoseconds=t},tE=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};tE.store="owner",tE.key="owner";var nE=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};nE.store="mutationQueues",nE.keyPath="userId";var rE=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};rE.store="mutations",rE.keyPath="batchId",rE.userMutationsIndex="userMutationsIndex",rE.userMutationsKeyPath=["userId","batchId"];var iE=(oE.prefixForUser=function(e){return[e]},oE.prefixForPath=function(e,t){return[e,Z_(t)]},oE.key=function(e,t,n){return[e,Z_(t),n]},oE);function oE(){}iE.store="documentMutations",iE.PLACEHOLDER=new iE;var aE=function(e,t){this.path=e,this.readTime=t},sE=function(e,t){this.path=e,this.version=t},uE=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};uE.store="remoteDocuments",uE.readTimeIndex="readTimeIndex",uE.readTimeIndexPath="readTime",uE.collectionReadTimeIndex="collectionReadTimeIndex",uE.collectionReadTimeIndexPath=["parentPath","readTime"];var cE=function(e){this.byteSize=e};cE.store="remoteDocumentGlobal",cE.key="remoteDocumentGlobalKey";var lE=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};lE.store="targets",lE.keyPath="targetId",lE.queryTargetsIndexName="queryTargetsIndex",lE.queryTargetsKeyPath=["canonicalId","targetId"];var hE=function(e,t,n){this.targetId=e,this.path=t,uy(0===e==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")};hE.store="targetDocuments",hE.keyPath=["targetId","path"],hE.documentTargetsIndex="documentTargetsIndex",hE.documentTargetsKeyPath=["path","targetId"];var fE=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};fE.key="targetGlobalKey",fE.store="targetGlobal";var pE=function(e,t){this.collectionId=e,this.parent=t};function dE(e){e.createObjectStore(hE.store,{keyPath:hE.keyPath}).createIndex(hE.documentTargetsIndex,hE.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(lE.store,{keyPath:lE.keyPath}).createIndex(lE.queryTargetsIndexName,lE.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(fE.store)}pE.store="collectionParents",pE.keyPath=["collectionId","parent"];var gE=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};gE.store="clientMetadata",gE.keyPath="clientId";var yE=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};yE.store="bundles",yE.keyPath="bundleId";var mE=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};mE.store="namedQueries",mE.keyPath="name";var Gn=So([nE.store,rE.store,iE.store,uE.store,lE.store,tE.store,fE.store,hE.store],[gE.store]),Gn=So(Gn,[cE.store]),Gn=So(Gn,[pE.store]),vE=So(Gn,[yE.store,mE.store]),bE=(_E.prototype.getBundleMetadata=function(e,t){return wE(e).get(t).next(function(e){if(e)return{id:(e=e).bundleId,createTime:uw(e.createTime),version:e.version}})},_E.prototype.saveBundleMetadata=function(e,t){return wE(e).put({bundleId:(t=t).id,createTime:sw(hb(t.createTime)),version:t.version})},_E.prototype.getNamedQuery=function(e,t){return EE(e).get(t).next(function(e){if(e)return{name:(e=e).name,query:fw(e.bundledQuery),readTime:uw(e.readTime)}})},_E.prototype.saveNamedQuery=function(e,t){return EE(e).put({name:(t=t).name,readTime:sw(hb(t.readTime)),bundledQuery:t.bundledQuery})},_E);function _E(e){this.serializer=e}function wE(e){return XE.getStore(e,yE.store)}function EE(e){return XE.getStore(e,mE.store)}var TE=(IE.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(uy(t.length%2==1,"Expected a collection path."),this.collectionParentsCache.has(t))return q_.resolve();var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.collectionParentsCache.add(t)});i={collectionId:r,parent:Z_(i)};return SE(e).put(i)},IE.prototype.getCollectionParents=function(e,i){var o=[],t=IDBKeyRange.bound([i,""],[dy(i),""],!1,!0);return SE(e).loadAll(t).next(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.collectionId!==i)break;o.push(tw(r.parent))}return o})},IE);function IE(){this.collectionParentsCache=new Ow}function SE(e){return XE.getStore(e,pE.store)}var CE=(kE.prototype.next=function(){return this.lastId+=2,this.lastId},kE.forTargetCache=function(){return new kE(0)},kE.forSyncEngine=function(){return new kE(-1)},kE);function kE(e){this.lastId=e}var AE=(NE.prototype.allocateTargetId=function(n){var r=this;return this.retrieveMetadata(n).next(function(e){var t=new CE(e.highestTargetId);return e.highestTargetId=t.next(),r.saveMetadata(n,e).next(function(){return e.highestTargetId})})},NE.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next(function(e){return yv.fromTimestamp(new yy(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},NE.prototype.getHighestSequenceNumber=function(e){return this.retrieveMetadata(e).next(function(e){return e.highestListenSequenceNumber})},NE.prototype.setTargetsMetadata=function(t,n,r){var i=this;return this.retrieveMetadata(t).next(function(e){return e.highestListenSequenceNumber=n,r&&(e.lastRemoteSnapshotVersion=r.toTimestamp()),n>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=n),i.saveMetadata(t,e)})},NE.prototype.addTargetData=function(t,n){var r=this;return this.saveTargetData(t,n).next(function(){return r.retrieveMetadata(t).next(function(e){return e.targetCount+=1,r.updateMetadataFromTargetData(n,e),r.saveMetadata(t,e)})})},NE.prototype.updateTargetData=function(e,t){return this.saveTargetData(e,t)},NE.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return DE(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return sy(0<e.targetCount,"Removing from an empty target cache"),--e.targetCount,n.saveMetadata(t,e)})},NE.prototype.removeTargets=function(n,r,i){var o=this,a=0,s=[];return DE(n).iterate(function(e,t){t=lw(t);t.sequenceNumber<=r&&null===i.get(t.targetId)&&(a++,s.push(o.removeTargetData(n,t)))}).next(function(){return q_.waitFor(s)}).next(function(){return a})},NE.prototype.forEachTarget=function(e,n){return DE(e).iterate(function(e,t){t=lw(t);n(t)})},NE.prototype.retrieveMetadata=function(e){return RE(e).get(fE.key).next(function(e){return sy(null!==e,"Missing metadata row."),e})},NE.prototype.saveMetadata=function(e,t){return RE(e).put(fE.key,t)},NE.prototype.saveTargetData=function(e,t){return DE(e).put(hw(this.serializer,t))},NE.prototype.updateMetadataFromTargetData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},NE.prototype.getTargetCount=function(e){return this.retrieveMetadata(e).next(function(e){return e.targetCount})},NE.prototype.getTargetData=function(e,r){var t=bm(r),t=IDBKeyRange.bound([t,Number.NEGATIVE_INFINITY],[t,Number.POSITIVE_INFINITY]),i=null;return DE(e).iterate({range:t,index:lE.queryTargetsIndexName},function(e,t,n){t=lw(t);wm(r,t.target)&&(i=t,n.done())}).next(function(){return i})},NE.prototype.addMatchingKeys=function(n,e,r){var i=this,o=[],a=OE(n);return e.forEach(function(e){var t=Z_(e.path);o.push(a.put(new hE(r,t))),o.push(i.referenceDelegate.addReference(n,r,e))}),q_.waitFor(o)},NE.prototype.removeMatchingKeys=function(n,e,r){var i=this,o=OE(n);return q_.forEach(e,function(e){var t=Z_(e.path);return q_.waitFor([o.delete([r,t]),i.referenceDelegate.removeReference(n,r,e)])})},NE.prototype.removeMatchingKeysForTargetId=function(e,t){e=OE(e),t=IDBKeyRange.bound([t],[t+1],!1,!0);return e.delete(t)},NE.prototype.getMatchingKeysForTargetId=function(e,t){var t=IDBKeyRange.bound([t],[t+1],!1,!0),e=OE(e),r=Pv();return e.iterate({range:t,keysOnly:!0},function(e,t,n){e=tw(e[1]),e=new Ly(e);r=r.add(e)}).next(function(){return r})},NE.prototype.containsKey=function(e,t){var t=Z_(t.path),t=IDBKeyRange.bound([t],[dy(t)],!1,!0),i=0;return OE(e).iterate({index:hE.documentTargetsIndex,keysOnly:!0,range:t},function(e,t,n){var r=e[0];e[1];0!==r&&(i++,n.done())}).next(function(){return 0<i})},NE.prototype.getTargetDataForTarget=function(e,t){return DE(e).get(t).next(function(e){return e?lw(e):null})},NE);function NE(e,t){this.referenceDelegate=e,this.serializer=t}function DE(e){return XE.getStore(e,lE.store)}function RE(e){return XE.getStore(e,fE.store)}function OE(e){return XE.getStore(e,hE.store)}function PE(e,t){var n=e[0],r=e[1],e=t[0],t=t[1],e=fy(n,e);return 0===e?fy(r,t):e}var xE=(LE.prototype.nextIndex=function(){return++this.previousIndex},LE.prototype.addElement=function(e){var t=[e,this.nextIndex()];this.buffer.size<this.maxElements?this.buffer=this.buffer.add(t):PE(t,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(t))},Object.defineProperty(LE.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),LE);function LE(e){this.maxElements=e,this.buffer=new Sv(PE),this.previousIndex=0}var ME={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},FE=(UE.withCacheSize=function(e){return new UE(e,UE.DEFAULT_COLLECTION_PERCENTILE,UE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},UE);function UE(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}FE.DEFAULT_COLLECTION_PERCENTILE=10,FE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,FE.DEFAULT=new FE(41943040,FE.DEFAULT_COLLECTION_PERCENTILE,FE.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),FE.DISABLED=new FE(-1,0,0);var qE=(jE.prototype.start=function(e){uy(null===this.gcTask,"Cannot start an already started LruScheduler"),-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.scheduleGC(e)},jE.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(jE.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!1,configurable:!0}),jE.prototype.scheduleGC=function(n){var e=this;uy(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;ny("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:this.gcTask=null,this.hasRun=!0,e.label=1;case 1:return e.trys.push([1,3,,7]),[4,n.collectGarbage(this.garbageCollector)];case 2:return e.sent(),[3,7];case 3:return Kw(t=e.sent())?(ny("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,_T(t)];case 5:e.sent(),e.label=6;case 6:return[3,7];case 7:return[4,this.scheduleGC(n)];case 8:return e.sent(),[2]}})})})},jE);function jE(e,t){this.garbageCollector=e,this.asyncQueue=t,this.hasRun=!1,this.gcTask=null}var VE=(BE.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next(function(e){return Math.floor(t/100*e)})},BE.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return q_.resolve(G_.INVALID);var r=new xE(t);return this.delegate.forEachTarget(e,function(e){return r.addElement(e.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,function(e){return r.addElement(e)})}).next(function(){return r.maxValue})},BE.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},BE.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},BE.prototype.collect=function(t,n){var r=this;return-1===this.params.cacheSizeCollectionThreshold?(ny("LruGarbageCollector","Garbage collection skipped; disabled"),q_.resolve(ME)):this.getCacheSize(t).next(function(e){return e<r.params.cacheSizeCollectionThreshold?(ny("LruGarbageCollector","Garbage collection skipped; Cache size "+e+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),ME):r.runGarbageCollection(t,n)})},BE.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},BE.prototype.runGarbageCollection=function(t,n){var r,i,o,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return i=e>l.params.maximumSequenceNumbersToCollect?(ny("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),l.params.maximumSequenceNumbersToCollect):e,a=Date.now(),l.nthSequenceNumber(t,i)}).next(function(e){return r=e,s=Date.now(),l.removeTargets(t,r,n)}).next(function(e){return o=e,u=Date.now(),l.removeOrphanedDocuments(t,r)}).next(function(e){return c=Date.now(),ty()<=Aa.DEBUG&&ny("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+i+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+e+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),q_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:e})})},BE);function BE(e,t){this.delegate=e,this.params=t}var KE,WE="IndexedDbPersistence",zE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",HE="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",GE="main",QE=(vo(YE,KE=de),YE);function YE(e,t){var n=KE.call(this)||this;return n.simpleDbTransaction=e,n.currentSequenceNumber=t,n}var XE=(JE.getStore=function(e,t){if(e instanceof QE)return Mw.getStore(e.simpleDbTransaction,t);throw ay("IndexedDbPersistence must use instances of IndexedDbTransaction")},JE.prototype.start=function(){var t=this;return uy(!this.started,"IndexedDbPersistence double-started!"),uy(null!==this.window,"Expected 'window' to be defined"),this.updateClientMetadataAndTryBecomePrimary().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Jg(Xg.FAILED_PRECONDITION,zE);return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.targetCache.getHighestSequenceNumber(e)})}).then(function(e){t.listenSequence=new G_(e,t.sequenceNumberSyncer)}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},JE.prototype.setPrimaryStateListener=function(n){var e=this;return this.primaryStateListener=function(t){return _o(e,void 0,void 0,function(){return wo(this,function(e){return this.started?[2,n(t)]:[2]})})},n(this.isPrimary)},JE.prototype.setDatabaseDeletedListener=function(n){var e=this;this.simpleDb.setVersionChangeListener(function(t){return _o(e,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return null!==t.newVersion?[3,2]:[4,n()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},JE.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(function(){return _o(t,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},JE.prototype.updateClientMetadataAndTryBecomePrimary=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return ZE(t).put(new gE(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.verifyPrimaryLease(t).next(function(e){e||(n.isPrimary=!1,n.queue.enqueueRetryable(function(){return n.primaryStateListener(!1)}))})}).next(function(){return n.canActAsPrimary(t)}).next(function(e){return n.isPrimary&&!e?n.releasePrimaryLeaseIfHeld(t).next(function(){return!1}):!!e&&n.acquireOrExtendPrimaryLease(t).next(function(){return!0})})}).catch(function(e){if(Kw(e))return ny(WE,"Failed to extend owner lease: ",e),n.isPrimary;if(!n.allowTabSynchronization)throw e;return ny(WE,"Releasing owner lease after error during lease refresh",e),!1}).then(function(e){n.isPrimary!==e&&n.queue.enqueueRetryable(function(){return n.primaryStateListener(e)}),n.isPrimary=e})},JE.prototype.verifyPrimaryLease=function(e){var t=this;return $E(e).get(tE.key).next(function(e){return q_.resolve(t.isLocalClient(e))})},JE.prototype.removeClientMetadata=function(e){return ZE(e).delete(this.clientId)},JE.prototype.maybeGarbageCollectMultiClientState=function(){return _o(this,void 0,void 0,function(){var t,n,r,i,o=this;return wo(this,function(e){switch(e.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var r=JE.getStore(e,gE.store);return r.loadAll().next(function(e){var t=o.filterActiveClients(e,18e5),n=e.filter(function(e){return-1===t.indexOf(e)});return q_.forEach(n,function(e){return r.delete(e.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(t=e.sent(),this.webStorage)for(n=0,r=t;n<r.length;n++)i=r[n],this.webStorage.removeItem(this.zombiedClientLocalStorageKey(i.clientId));e.label=2;case 2:return[2]}})})},JE.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.maybeGarbageCollectMultiClientState()}).then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},JE.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},JE.prototype.canActAsPrimary=function(t){var r=this;return this.forceOwningTab?q_.resolve(!0):$E(t).get(tE.key).next(function(e){if(null!==e&&r.isWithinAge(e.leaseTimestampMs,5e3)&&!r.isClientZombied(e.ownerId)){if(r.isLocalClient(e)&&r.networkEnabled)return!0;if(!r.isLocalClient(e)){if(!e.allowTabSynchronization)throw new Jg(Xg.FAILED_PRECONDITION,zE);return!1}}return!(!r.networkEnabled||!r.inForeground)||ZE(t).loadAll().next(function(e){return void 0===r.filterActiveClients(e,5e3).find(function(e){if(r.clientId!==e.clientId){var t=!r.networkEnabled&&e.networkEnabled,n=!r.inForeground&&e.inForeground,e=r.networkEnabled===e.networkEnabled;if(t||n&&e)return!0}return!1})})}).next(function(e){return r.isPrimary!==e&&ny(WE,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},JE.prototype.shutdown=function(){return _o(this,void 0,void 0,function(){var n=this;return wo(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("shutdown","readwrite",[tE.store,gE.store],function(e){var t=new QE(e,G_.INVALID);return n.releasePrimaryLeaseIfHeld(t).next(function(){return n.removeClientMetadata(t)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},JE.prototype.filterActiveClients=function(e,t){var n=this;return e.filter(function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)})},JE.prototype.getActiveClients=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ZE(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(e){return e.clientId})})})},Object.defineProperty(JE.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),JE.prototype.getMutationQueue=function(e){return uy(this.started,"Cannot initialize MutationQueue before persistence is started."),pw.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},JE.prototype.getTargetCache=function(){return uy(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},JE.prototype.getRemoteDocumentCache=function(){return uy(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},JE.prototype.getIndexManager=function(){return uy(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},JE.prototype.getBundleCache=function(){return uy(this.started,"Cannot initialize BundleCache before persistence is started."),this.bundleCache},JE.prototype.runTransaction=function(t,n,r){var i=this;ny(WE,"Starting transaction:",t);var o,e="readonly"===n?"readonly":"readwrite";return this.simpleDb.runTransaction(t,e,vE,function(e){return o=new QE(e,i.listenSequence?i.listenSequence.next():G_.INVALID),"readwrite-primary"===n?i.verifyPrimaryLease(o).next(function(e){return!!e||i.canActAsPrimary(o)}).next(function(e){if(!e)throw ry("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.queue.enqueueRetryable(function(){return i.primaryStateListener(!1)}),new Jg(Xg.FAILED_PRECONDITION,K_);return r(o)}).next(function(e){return i.acquireOrExtendPrimaryLease(o).next(function(){return e})}):i.verifyAllowTabSynchronization(o).next(function(){return r(o)})}).then(function(e){return o.raiseOnCommittedEvent(),e})},JE.prototype.verifyAllowTabSynchronization=function(e){var t=this;return $E(e).get(tE.key).next(function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!(t.forceOwningTab||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Jg(Xg.FAILED_PRECONDITION,zE)})},JE.prototype.acquireOrExtendPrimaryLease=function(e){var t=new tE(this.clientId,this.allowTabSynchronization,Date.now());return $E(e).put(tE.key,t)},JE.isAvailable=function(){return Mw.isAvailable()},JE.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=$E(e);return n.get(tE.key).next(function(e){return t.isLocalClient(e)?(ny(WE,"Releasing primary lease."),n.delete(tE.key)):q_.resolve()})},JE.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t)&&(!(n<e)||(ry("Detected an update time that is in the future: "+e+" > "+n),!1))},JE.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},JE.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(uy(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},JE.prototype.attachWindowUnloadHook=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},JE.prototype.detachWindowUnloadHook=function(){var e;this.windowUnloadHandler&&(uy("function"==typeof(null===(e=this.window)||void 0===e?void 0:e.removeEventListener),"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},JE.prototype.isClientZombied=function(e){try{var t=null!==(null===(t=this.webStorage)||void 0===t?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)));return ny(WE,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(e){return ry(WE,"Failed to get zombied client id.",e),!1}},JE.prototype.markClientZombied=function(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){ry("Failed to set zombie client id.",e)}},JE.prototype.removeClientZombiedEntry=function(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},JE.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},JE);function JE(e,t,n,r,i,o,a,s,u,c){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.queue=i,this.window=o,this.document=a,this.sequenceNumberSyncer=u,this.forceOwningTab=c,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},!JE.isAvailable())throw new Jg(Xg.UNIMPLEMENTED,HE);this.referenceDelegate=new eT(this,r),this.dbName=t+GE,this.serializer=new nw(s),this.simpleDb=new Mw(this.dbName,Jw,new $w(this.serializer)),this.targetCache=new AE(this.referenceDelegate,this.serializer),this.indexManager=new TE,this.remoteDocumentCache=(t=this.serializer,s=this.indexManager,new ww(t,s)),this.bundleCache=new bE(this.serializer),this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===c&&ry(WE,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function $E(e){return XE.getStore(e,tE.store)}function ZE(e){return XE.getStore(e,gE.store)}var eT=(tT.prototype.getSequenceNumberCount=function(e){var n=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(function(t){return n.next(function(e){return t+e})})},tT.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},tT.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},tT.prototype.forEachOrphanedDocumentSequenceNumber=function(e,n){return this.forEachOrphanedDocument(e,function(e,t){return n(t)})},tT.prototype.addReference=function(e,t,n){return nT(e,n)},tT.prototype.removeReference=function(e,t,n){return nT(e,n)},tT.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},tT.prototype.markPotentiallyOrphaned=nT,tT.prototype.isPinned=function(e,t){return r=t,i=!1,bw(n=e).iterateSerial(function(e){return gw(n,e,r).next(function(e){return e&&(i=!0),q_.resolve(!e)})}).next(function(){return i});var n,r,i},tT.prototype.removeOrphanedDocuments=function(n,r){var i=this,o=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[],s=0;return this.forEachOrphanedDocument(n,function(t,e){e<=r&&(e=i.isPinned(n,t).next(function(e){if(!e)return s++,o.getEntry(n,t).next(function(){return o.removeEntry(t),OE(n).delete([0,Z_(t.path)])})}),a.push(e))}).next(function(){return q_.waitFor(a)}).next(function(){return o.apply(n)}).next(function(){return s})},tT.prototype.removeTarget=function(e,t){t=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,t)},tT.prototype.updateLimboDocument=nT,tT.prototype.forEachOrphanedDocument=function(e,r){var i,e=OE(e),o=G_.INVALID;return e.iterate({index:hE.documentTargetsIndex},function(e,t){var n=e[0],e=(e[1],t.path),t=t.sequenceNumber;0===n?(o!==G_.INVALID&&r(new Ly(tw(i)),o),o=t,i=e):o=G_.INVALID}).next(function(){o!==G_.INVALID&&r(new Ly(tw(i)),o)})},tT.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},tT);function tT(e,t){this.db=e,this.garbageCollector=new VE(this,t)}function nT(e,t){return OE(e).put((t=t,e=e.currentSequenceNumber,new hE(0,Z_(t.path),e)))}function rT(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var iT="LocalStore",oT=3e8,aT=(sT.prototype.collectGarbage=function(t){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(e){return t.collect(e,n.targetDataByTarget)})},sT);function sT(e,t,n,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new vv(fy),this.targetIdByTarget=new F_(bm,wm),this.lastDocumentChangeReadTime=yv.min(),uy(e.started,"LocalStore was passed an unstarted persistence implementation"),this.mutationQueue=e.getMutationQueue(n),this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.localDocuments=new V_(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.bundleCache=e.getBundleCache(),this.queryEngine.setLocalDocumentsView(this.localDocuments)}function uT(e,t,n,r){return new aT(e,t,n,r)}function cT(i,o){return _o(this,void 0,void 0,function(){var t,n,y,r;return wo(this,function(e){switch(e.label){case 0:return t=cy(i,aT),n=t.mutationQueue,y=t.localDocuments,[4,t.persistence.runTransaction("Handle user change","readonly",function(d){var g;return t.mutationQueue.getAllMutationBatches(d).next(function(e){return g=e,n=t.persistence.getMutationQueue(o),y=new V_(t.remoteDocuments,n,t.persistence.getIndexManager()),n.getAllMutationBatches(d)}).next(function(e){for(var t=[],n=[],r=Pv(),i=0,o=g;i<o.length;i++){var a=o[i];t.push(a.batchId);for(var s=0,u=a.mutations;s<u.length;s++)var c=u[s],r=r.add(c.key)}for(var l=0,h=e;l<h.length;l++){a=h[l];n.push(a.batchId);for(var f=0,p=a.mutations;f<p.length;f++){c=p[f];r=r.add(c.key)}}return y.getDocuments(d,r).next(function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:n}})})})];case 1:return r=e.sent(),t.mutationQueue=n,t.localDocuments=y,t.queryEngine.setLocalDocumentsView(t.localDocuments),[2,r]}})})}function lT(e,s){var u,c=cy(e,aT),l=yy.now(),t=s.reduce(function(e,t){return e.add(t.key)},Pv());return c.persistence.runTransaction("Locally write mutations","readwrite",function(a){return c.localDocuments.getDocuments(a,t).next(function(e){u=e;for(var t=[],n=0,r=s;n<r.length;n++){var i=r[n],o=l_(i,u.get(i.key));null!=o&&t.push(new v_(i.key,o,function a(e){var s=[];return by(e.fields||{},function(e,t){var n=new Py([e]);if(sm(t))if(0===(t=a(t.mapValue).fields).length)s.push(n);else for(var r=0,i=t;r<i.length;r++){var o=i[r];s.push(n.child(o))}else s.push(n)}),new e_(s)}(o.proto.mapValue),o_.exists(!0)))}return c.mutationQueue.addMutationBatch(a,l,t,s)})}).then(function(e){var t=e.applyToLocalDocumentSet(u);return{batchId:e.batchId,changes:t}})}function hT(e,l){var h=cy(e,aT);return h.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var t,n,i,o,a,r,s,u=l.batch.keys(),c=h.remoteDocuments.newChangeBuffer({trackRemovals:!0});return t=h,n=e,o=c,a=(i=l).batch,r=a.keys(),s=q_.resolve(),r.forEach(function(r){s=s.next(function(){return o.getEntry(n,r)}).next(function(e){var t=e,n=i.docVersions.get(r);sy(null!==n,"ackVersions should contain every doc in the write."),(!t||t.version.compareTo(n)<0)&&((t=a.applyToRemoteDocument(r,t,i))?o.addEntry(t,i.commitVersion):uy(!e,"Mutation batch "+a+" applied to document "+e+" resulted in null"))})}),s.next(function(){return t.mutationQueue.removeMutationBatch(n,a)}).next(function(){return c.apply(e)}).next(function(){return h.mutationQueue.performConsistencyCheck(e)}).next(function(){return h.localDocuments.getDocuments(e,u)})})}function fT(e){var t=cy(e,aT);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)})}function pT(e,l){var h=cy(e,aT),f=l.snapshotVersion,p=h.targetDataByTarget;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var e=h.remoteDocuments.newChangeBuffer({trackRemovals:!0});p=h.targetDataByTarget;var o=[];l.targetChanges.forEach(function(e,t){var n,r=p.get(t);r&&(o.push(h.targetCache.removeMatchingKeys(i,e.removedDocuments,t).next(function(){return h.targetCache.addMatchingKeys(i,e.addedDocuments,t)})),0<(n=e.resumeToken).approximateByteSize()&&(n=r.withResumeToken(n,f).withSequenceNumber(i.currentSequenceNumber),p=p.insert(t,n),function(e,t,n){if(sy(0<t.resumeToken.approximateByteSize(),"Attempted to persist target data with no resume token"),0===e.resumeToken.approximateByteSize())return!0;if(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=oT)return!0;return 0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size}(r,n,e)&&o.push(h.targetCache.updateTargetData(i,n))))});var a,t,s,u,n,r,c=Nv;return l.documentUpdates.forEach(function(e,t){l.resolvedLimboDocuments.has(e)&&o.push(h.persistence.referenceDelegate.updateLimboDocument(i,e))}),o.push((r=i,a=e,t=l.documentUpdates,s=f,u=void 0,n=Pv(),t.forEach(function(e){return n=n.add(e)}),a.getEntries(r,n).next(function(i){var o=Nv;return t.forEach(function(e,t){var n=i.get(e),r=(null==u?void 0:u.get(e))||s;t instanceof fm&&t.version.isEqual(yv.min())?(a.removeEntry(e,r),o=o.insert(e,t)):null==n||0<t.version.compareTo(n.version)||0===t.version.compareTo(n.version)&&n.hasPendingWrites?(uy(!yv.min().isEqual(r),"Cannot add a document when the remote version is zero"),a.addEntry(t,r),o=o.insert(e,t)):ny(iT,"Ignoring outdated watch update for ",e,". Current version:",n.version," Watch version:",t.version)}),o}).next(function(e){c=e}))),f.isEqual(yv.min())||(r=h.targetCache.getLastRemoteSnapshotVersion(i).next(function(e){return uy(0<=f.compareTo(e),"Watch stream reverted to previous snapshot?? "+f+" < "+e),h.targetCache.setTargetsMetadata(i,i.currentSequenceNumber,f)}),o.push(r)),q_.waitFor(o).next(function(){return e.apply(i)}).next(function(){return h.localDocuments.getLocalViewOfDocuments(i,c)})}).then(function(e){return h.targetDataByTarget=p,e})}function dT(e,r){var i=cy(e,aT);return i.persistence.runTransaction("Allocate target","readwrite",function(t){var n;return i.targetCache.getTargetData(t,r).next(function(e){return e?(n=e,q_.resolve(n)):i.targetCache.allocateTargetId(t).next(function(e){return n=new z_(r,e,0,t.currentSequenceNumber),i.targetCache.addTargetData(t,n).next(function(){return n})})})}).then(function(e){var t=i.targetDataByTarget.get(e.targetId);return(null===t||0<e.snapshotVersion.compareTo(t.snapshotVersion))&&(i.targetDataByTarget=i.targetDataByTarget.insert(e.targetId,e),i.targetIdByTarget.set(r,e.targetId)),e})}function gT(i,o,a){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:t=cy(i,aT),uy(null!==(n=t.targetDataByTarget.get(o)),"Tried to release nonexistent target: "+o),r=a?"readwrite":"readwrite-primary",e.label=1;case 1:return e.trys.push([1,4,,5]),a?[3,3]:[4,t.persistence.runTransaction("Release target",r,function(e){return t.persistence.referenceDelegate.removeTarget(e,n)})];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:if(!Kw(r=e.sent()))throw r;return ny(iT,"Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return t.targetDataByTarget=t.targetDataByTarget.remove(o),t.targetIdByTarget.delete(n.target),[2]}})})}function yT(e,o,a){var s=cy(e,aT),u=yv.min(),c=Pv();return s.persistence.runTransaction("Execute query","readonly",function(t){return e=s,n=t,r=Pm(o),i=cy(e,aT),(void 0!==(e=i.targetIdByTarget.get(r))?q_.resolve(i.targetDataByTarget.get(e)):i.targetCache.getTargetData(n,r)).next(function(e){if(e)return u=e.lastLimboFreeSnapshotVersion,s.targetCache.getMatchingKeysForTargetId(t,e.targetId).next(function(e){c=e})}).next(function(){return s.queryEngine.getDocumentsMatchingQuery(t,o,a?u:yv.min(),a?c:Pv())}).next(function(e){return{documents:e,remoteKeys:c}});var e,n,r,i})}function mT(e,t){var n=cy(e,aT),r=cy(n.targetCache,AE),e=n.targetDataByTarget.get(t);return e?Promise.resolve(e.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.getTargetDataForTarget(e,t).next(function(e){return e?e.target:null})})}function vT(e){var a=cy(e,aT);return a.persistence.runTransaction("Get new document changes","readonly",function(e){return t=a.remoteDocuments,n=e,e=a.lastDocumentChangeReadTime,r=cy(t,ww),i=Nv,o=ow(e),e=kw(n),n=IDBKeyRange.lowerBound(o,!0),e.iterate({index:uE.readTimeIndex,range:n},function(e,t){var n=rw(r.serializer,t);i=i.insert(n.key,n),o=t.readTime}).next(function(){return{changedDocs:i,readTime:aw(o)}});var t,n,r,i,o}).then(function(e){var t=e.changedDocs,e=e.readTime;return a.lastDocumentChangeReadTime=e,t})}function bT(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){return[2,(t=cy(n,aT)).persistence.runTransaction("Synchronize last document change read time","readonly",function(e){return e=kw(e=e),r=yv.min(),e.iterate({index:uE.readTimeIndex,reverse:!0},function(e,t,n){t.readTime&&(r=aw(t.readTime)),n.done()}).next(function(){return r});var r}).then(function(e){t.lastDocumentChangeReadTime=e})]})})}function _T(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){if(t.code!==Xg.FAILED_PRECONDITION||t.message!==K_)throw t;return ny(iT,"Unexpectedly lost primary lease"),[2]})})}var wT=(ET.prototype.reset=function(){this.currentBaseMs=0},ET.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},ET.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<i&&ny("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return t.lastAttemptTime=Date.now(),e()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},ET.prototype.skipBackoff=function(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)},ET.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},ET.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},ET);function ET(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}var TT="PersistentStream",Gn=(IT.prototype.isStarted=function(){return 1===this.state||2===this.state||4===this.state},IT.prototype.isOpen=function(){return 2===this.state},IT.prototype.start=function(){3!==this.state?(uy(0===this.state,"Already started"),this.auth()):this.performBackoff()},IT.prototype.stop=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},IT.prototype.inhibitBackoff=function(){uy(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=0,this.backoff.reset()},IT.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return e.handleIdleCloseTimer()}))},IT.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},IT.prototype.handleIdleCloseTimer=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){return this.isOpen()?[2,this.close(0)]:[2]})})},IT.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},IT.prototype.close=function(t,n){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return uy(this.isStarted(),"Only started streams should be closed."),uy(3===t||Ty(n),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,3!==t?this.backoff.reset():n&&n.code===Xg.RESOURCE_EXHAUSTED?(ry(n.toString()),ry("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):n&&n.code===Xg.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(n)];case 1:return e.sent(),[2]}})})},IT.prototype.tearDown=function(){},IT.prototype.auth=function(){var n=this;uy(0===this.state,"Must be in initial state to auth"),this.state=1;var e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;this.credentialsProvider.getToken().then(function(e){n.closeCount===t&&n.startStream(e)},function(t){e(function(){var e=new Jg(Xg.UNKNOWN,"Fetching auth token failed: "+t.message);return n.handleStreamClose(e)})})},IT.prototype.startStream=function(e){var t=this;uy(1===this.state,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen(function(){n(function(){return uy(1===t.state,"Expected stream to be in state Starting, but was "+t.state),t.state=2,t.listener.onOpen()})}),this.stream.onClose(function(e){n(function(){return t.handleStreamClose(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},IT.prototype.performBackoff=function(){var e=this;uy(3===this.state,"Should only perform backoff when in Error state"),this.state=4,this.backoff.backoffAndRun(function(){return _o(e,void 0,void 0,function(){return wo(this,function(e){return uy(4===this.state,"Backoff elapsed but state is now: "+this.state),this.state=0,this.start(),uy(this.isStarted(),"PersistentStream should have started"),[2]})})})},IT.prototype.handleStreamClose=function(e){return uy(this.isStarted(),"Can't handle server close on non-started stream"),ny(TT,"close with error: "+e),this.stream=null,this.close(3,e)},IT.prototype.getCloseGuardedDispatcher=function(t){var n=this;return function(e){n.queue.enqueueAndForget(function(){return n.closeCount===t?e():(ny(TT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},IT);function IT(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=0,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new wT(e,t)}var ST,CT=(vo(kT,ST=Gn),kT.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},kT.prototype.onMessage=function(e){this.backoff.reset();var t=Eb(this.serializer,e),e="targetChange"in(e=e)&&(!(e=e.targetChange).targetIds||!e.targetIds.length)&&e.readTime?hb(e.readTime):yv.min();return this.listener.onWatchChange(t,e)},kT.prototype.watch=function(e){var t,n,r,i={};i.database=vb(this.serializer),i.addTarget=(t=this.serializer,(r=Em(r=(n=e).target)?{documents:Cb(t,r)}:{query:kb(t,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=lb(t,n.resumeToken):0<n.snapshotVersion.compareTo(yv.min())&&(r.readTime=cb(t,n.snapshotVersion.toTimestamp())),r);e=Nb(this.serializer,e);e&&(i.labels=e),this.sendRequest(i)},kT.prototype.unwatch=function(e){var t={};t.database=vb(this.serializer),t.removeTarget=e,this.sendRequest(t)},kT);function kT(e,t,n,r,i){i=ST.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i)||this;return i.serializer=r,i}var AT,NT=(vo(DT,AT=Gn),Object.defineProperty(DT.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!1,configurable:!0}),DT.prototype.start=function(){this.handshakeComplete_=!1,this.lastStreamToken=void 0,AT.prototype.start.call(this)},DT.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},DT.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},DT.prototype.onMessage=function(e){if(sy(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=Sb(e.writeResults,e.commitTime),n=hb(e.commitTime);return this.listener.onMutationResult(n,t)}return sy(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},DT.prototype.writeHandshake=function(){uy(this.isOpen(),"Writing handshake requires an opened stream"),uy(!this.handshakeComplete_,"Handshake already completed"),uy(!this.lastStreamToken,"Stream token should be empty during handshake");var e={};e.database=vb(this.serializer),this.sendRequest(e)},DT.prototype.writeMutations=function(e){var t=this;uy(this.isOpen(),"Writing mutations requires an opened stream"),uy(this.handshakeComplete_,"Handshake must be complete before writing mutations"),uy(!!this.lastStreamToken,"Trying to write mutation without a token");e={streamToken:this.lastStreamToken,writes:e.map(function(e){return Tb(t.serializer,e)})};this.sendRequest(e)},DT);function DT(e,t,n,r,i){i=AT.call(this,e,"write_stream_connection_backoff","write_stream_idle",t,n,i)||this;return i.serializer=r,i.handshakeComplete_=!1,i}var RT,OT=(vo(PT,RT=function(){}),PT.prototype.verifyInitialized=function(){if(uy(!!this.connection,"Datastore.start() not called"),this.terminated)throw new Jg(Xg.FAILED_PRECONDITION,"The client has already been terminated.")},PT.prototype.invokeRPC=function(t,n,r){var i=this;return this.verifyInitialized(),this.credentials.getToken().then(function(e){return i.connection.invokeRPC(t,n,r,e)}).catch(function(e){throw e.code===Xg.UNAUTHENTICATED&&i.credentials.invalidateToken(),e})},PT.prototype.invokeStreamingRPC=function(t,n,r){var i=this;return this.verifyInitialized(),this.credentials.getToken().then(function(e){return i.connection.invokeStreamingRPC(t,n,r,e)}).catch(function(e){throw e.code===Xg.UNAUTHENTICATED&&i.credentials.invalidateToken(),e})},PT.prototype.terminate=function(){this.terminated=!1},PT);function PT(e,t,n){var r=RT.call(this)||this;return r.credentials=e,r.connection=t,r.serializer=n,r.terminated=!1,r}var xT=(LT.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),uy(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.onlineStateTimer=null,uy("Unknown"===e.state,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast("Offline"),Promise.resolve()}))},LT.prototype.handleWatchStreamFailure=function(e){"Online"===this.state?(this.setAndBroadcast("Unknown"),uy(0===this.watchStreamFailures,"watchStreamFailures must be 0"),uy(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast("Offline")))},LT.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===e&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},LT.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},LT.prototype.logClientOfflineWarningIfNecessary=function(e){e="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(ry(e),this.shouldWarnClientIsOffline=!1):ny("OnlineStateTracker",e)},LT.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},LT);function LT(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}var MT="RemoteStore",FT=10,UT=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(e){n.enqueueAndForget(function(){return _o(o,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return GT(this)?(ny(MT,"Restarting streams for network reachability change."),[4,function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return(t=cy(n,UT)).offlineCauses.add(4),[4,jT(t)];case 1:return e.sent(),t.onlineStateTracker.set("Unknown"),t.offlineCauses.delete(4),[4,qT(t)];case 2:return e.sent(),[2]}})})}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new xT(n,r)};function qT(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:if(!GT(r))return[3,4];t=0,n=r.onNetworkStatusChange,e.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function jT(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:t=0,n=r.onNetworkStatusChange,e.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function VT(e,t){e=cy(e,UT);e.listenTargets.has(t.targetId)||(e.listenTargets.set(t.targetId,t),HT(e)?zT(e):iI(e).isOpen()&&KT(e,t))}function BT(e,t){var n=cy(e,UT),e=iI(n);uy(n.listenTargets.has(t),"unlisten called on target no currently watched: "+t),n.listenTargets.delete(t),e.isOpen()&&WT(n,t),0===n.listenTargets.size&&(e.isOpen()?e.markIdle():GT(n)&&n.onlineStateTracker.set("Unknown"))}function KT(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t.targetId),iI(e).watch(t)}function WT(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t),iI(e).unwatch(t)}function zT(t){uy(HT(t),"startWatchStream() called when shouldStartWatchStream() is false."),uy(!!t.remoteSyncer.getRemoteKeysForTarget,"getRemoteKeysForTarget() not set"),t.watchChangeAggregator=new $v({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},getTargetDataForTarget:function(e){return t.listenTargets.get(e)||null}}),iI(t).start(),t.onlineStateTracker.handleWatchStreamStart()}function HT(e){return GT(e)&&!iI(e).isStarted()&&0<e.listenTargets.size}function GT(e){return 0===cy(e,UT).offlineCauses.size}function QT(e){e.watchChangeAggregator=void 0}function YT(r,i,o){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:if(r.onlineStateTracker.set("Online"),!(i instanceof Yv&&2===i.state&&i.cause))return[3,6];e.label=1;case 1:return e.trys.push([1,3,,5]),[4,function(o,a){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:uy(!!o.remoteSyncer.rejectListen,"rejectListen() not set"),uy(!!a.cause,"Handling target error without a cause"),t=a.cause,n=0,r=a.targetIds,e.label=1;case 1:return n<r.length?(i=r[n],o.listenTargets.has(i)?[4,o.remoteSyncer.rejectListen(i,t)]:[3,3]):[3,4];case 2:e.sent(),o.listenTargets.delete(i),o.watchChangeAggregator.removeTarget(i),e.label=3;case 3:return n++,[3,1];case 4:return[2]}})})}(r,i)];case 2:return e.sent(),[3,5];case 3:return t=e.sent(),ny(MT,"Failed to remove targets %s: %s ",i.targetIds.join(","),t),[4,XT(r,t)];case 4:return e.sent(),[3,5];case 5:return[2];case 6:if(i instanceof Gv?r.watchChangeAggregator.handleDocumentChange(i):i instanceof Qv?r.watchChangeAggregator.handleExistenceFilter(i):(uy(i instanceof Yv,"Expected watchChange to be an instance of WatchTargetChange"),r.watchChangeAggregator.handleTargetChange(i)),o.isEqual(yv.min()))return[3,13];e.label=7;case 7:return e.trys.push([7,11,,13]),[4,fT(r.localStore)];case 8:return n=e.sent(),0<=o.compareTo(n)?[4,function(r,i){uy(!i.isEqual(yv.min()),"Can't raise event for unknown SnapshotVersion");var e=r.watchChangeAggregator.createRemoteEvent(i);return e.targetChanges.forEach(function(e,t){var n;0<e.resumeToken.approximateByteSize()&&((n=r.listenTargets.get(t))&&r.listenTargets.set(t,n.withResumeToken(e.resumeToken,i)))}),e.targetMismatches.forEach(function(e){var t=r.listenTargets.get(e);t&&(r.listenTargets.set(e,t.withResumeToken(wy.EMPTY_BYTE_STRING,t.snapshotVersion)),WT(r,e),t=new z_(t.target,e,1,t.sequenceNumber),KT(r,t))}),uy(!!r.remoteSyncer.applyRemoteEvent,"applyRemoteEvent() not set"),r.remoteSyncer.applyRemoteEvent(e)}(r,o)]:[3,10];case 9:e.sent(),e.label=10;case 10:return[3,13];case 11:return n=e.sent(),ny(MT,"Failed to raise snapshot:",n),[4,XT(r,n)];case 12:return e.sent(),[3,13];case 13:return[2]}})})}function XT(n,r,i){return _o(this,void 0,void 0,function(){var t=this;return wo(this,function(e){switch(e.label){case 0:return Kw(r)?(uy(!n.offlineCauses.has(1),"Unexpected network event when IndexedDB was marked failed."),n.offlineCauses.add(1),[4,jT(n)]):[3,2];case 1:return e.sent(),n.onlineStateTracker.set("Offline"),i=i||function(){return fT(n.localStore)},n.asyncQueue.enqueueRetryable(function(){return _o(t,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return ny(MT,"Retrying IndexedDB access"),[4,i()];case 1:return e.sent(),n.offlineCauses.delete(1),[4,qT(n)];case 2:return e.sent(),[2]}})})}),[3,3];case 2:throw r;case 3:return[2]}})})}function JT(t,n){return n().catch(function(e){return XT(t,e,n)})}function $T(u){return _o(this,void 0,void 0,function(){var i,o,a,s;return wo(this,function(e){switch(e.label){case 0:i=cy(u,UT),o=oI(i),a=0<i.writePipeline.length?i.writePipeline[i.writePipeline.length-1].batchId:O_,e.label=1;case 1:if(!ZT(i))return[3,7];e.label=2;case 2:return e.trys.push([2,4,,6]),[4,(t=i.localStore,n=a,(r=cy(t,aT)).persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===n&&(n=O_),r.mutationQueue.getNextMutationBatchAfterBatchId(e,n)}))];case 3:return null===(s=e.sent())?(0===i.writePipeline.length&&o.markIdle(),[3,7]):(a=s.batchId,function(e,t){uy(ZT(e),"addToWritePipeline called when pipeline is full"),e.writePipeline.push(t);e=oI(e);e.isOpen()&&e.handshakeComplete&&e.writeMutations(t.mutations)}(i,s),[3,6]);case 4:return s=e.sent(),[4,XT(i,s)];case 5:return e.sent(),[3,6];case 6:return[3,1];case 7:return eI(i)&&tI(i),[2]}var t,n,r})})}function ZT(e){return GT(e)&&e.writePipeline.length<FT}function eI(e){return GT(e)&&!oI(e).isStarted()&&0<e.writePipeline.length}function tI(e){uy(eI(e),"startWriteStream() called when shouldStartWriteStream() is false."),oI(e).start()}function nI(t,n){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return void 0===n&&uy(!eI(t),"Write stream was stopped gracefully while still needed."),n&&oI(t).handshakeComplete?[4,function(r,i){return _o(this,void 0,void 0,function(){var n;return wo(this,function(e){switch(e.label){case 0:return Vv(t=i.code)&&t!==Xg.ABORTED?(n=r.writePipeline.shift(),oI(r).inhibitBackoff(),uy(!!r.remoteSyncer.rejectFailedWrite,"rejectFailedWrite() not set"),[4,JT(r,function(){return r.remoteSyncer.rejectFailedWrite(n.batchId,i)})]):[3,3];case 1:return e.sent(),[4,$T(r)];case 2:e.sent(),e.label=3;case 3:return[2]}var t})})}(t,n)]:[3,2];case 1:e.sent(),e.label=2;case 2:return eI(t)&&tI(t),[2]}})})}function rI(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return(t=cy(n,UT),r)?(t.offlineCauses.delete(2),[4,qT(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return r?[3,4]:(t.offlineCauses.add(2),[4,jT(t)]);case 3:e.sent(),t.onlineStateTracker.set("Unknown"),e.label=4;case 4:return[2]}})})}function iI(n){var e,t,r,i=this;return n.watchStream||(n.watchStream=(e=n.datastore,t=n.asyncQueue,r={onOpen:function(n){return _o(this,void 0,void 0,function(){return wo(this,function(e){return n.listenTargets.forEach(function(e,t){KT(n,e)}),[2]})})}.bind(null,n),onClose:function(t,n){return _o(this,void 0,void 0,function(){return wo(this,function(e){return void 0===n&&uy(!HT(t),"Watch stream was stopped gracefully while still needed."),QT(t),HT(t)?(t.onlineStateTracker.handleWatchStreamFailure(n),zT(t)):t.onlineStateTracker.set("Unknown"),[2]})})}.bind(null,n),onWatchChange:YT.bind(null,n)},(e=cy(e,OT)).verifyInitialized(),new CT(t,e.connection,e.credentials,e.serializer,r)),n.onNetworkStatusChange.push(function(t){return _o(i,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return t?(n.watchStream.inhibitBackoff(),HT(n)?zT(n):n.onlineStateTracker.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.watchStream.stop()];case 2:e.sent(),QT(n),e.label=3;case 3:return[2]}})})})),n.watchStream}function oI(n){var e,t,r,i=this;return n.writeStream||(uy(0===n.writePipeline.length,"Should not issue writes before WriteStream is enabled"),n.writeStream=(e=n.datastore,t=n.asyncQueue,r={onOpen:function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){return oI(t).writeHandshake(),[2]})})}.bind(null,n),onClose:nI.bind(null,n),onHandshakeComplete:function(o){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){for(t=oI(o),n=0,r=o.writePipeline;n<r.length;n++)i=r[n],t.writeMutations(i.mutations);return[2]})})}.bind(null,n),onMutationResult:function(r,i,o){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return uy(0<r.writePipeline.length,"Got result for empty write pipeline"),t=r.writePipeline.shift(),n=L_.from(t,i,o),uy(!!r.remoteSyncer.applySuccessfulWrite,"applySuccessfulWrite() not set"),[4,JT(r,function(){return r.remoteSyncer.applySuccessfulWrite(n)})];case 1:return e.sent(),[4,$T(r)];case 2:return e.sent(),[2]}})})}.bind(null,n)},(e=cy(e,OT)).verifyInitialized(),new NT(t,e.connection,e.credentials,e.serializer,r)),n.onNetworkStatusChange.push(function(t){return _o(i,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return t?(n.writeStream.inhibitBackoff(),[4,$T(n)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n.writeStream.stop()];case 3:e.sent(),0<n.writePipeline.length&&(ny(MT,"Stopping write stream with "+n.writePipeline.length+" pending writes"),n.writePipeline=[]),e.label=4;case 4:return[2]}})})})),n.writeStream}function aI(){return"undefined"!=typeof window?window:null}function sI(){return"undefined"!=typeof document?document:null}var uI="AsyncQueue",cI=(lI.createAndSchedule=function(e,t,n,r,i){i=new lI(e,t,Date.now()+n,r,i);return i.start(n),i},lI.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},lI.prototype.skipDelay=function(){return this.handleDelayElapsed()},lI.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jg(Xg.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},lI.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},lI.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},lI);function lI(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new xw,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}var hI=(Object.defineProperty(fI.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!1,configurable:!0}),fI.prototype.enqueueAndForget=function(e){this.enqueue(e)},fI.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},fI.prototype.enterRestrictedMode=function(){var e;this._isShuttingDown||(this._isShuttingDown=!0,(e=sI())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.visibilityHandler))},fI.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(e){}):this.enqueueInternal(e)},fI.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget(function(){return t.retryableOps.push(e),t.retryNextOp()})},fI.prototype.retryNextOp=function(){return _o(this,void 0,void 0,function(){var t,n=this;return wo(this,function(e){switch(e.label){case 0:if(0===this.retryableOps.length)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.retryableOps[0]()];case 2:return e.sent(),this.retryableOps.shift(),this.backoff.reset(),[3,4];case 3:if(!Kw(t=e.sent()))throw t;return ny(uI,"Operation failed with retryable error: "+t),[3,4];case 4:return 0<this.retryableOps.length&&this.backoff.backoffAndRun(function(){return n.retryNextOp()}),[2]}})})},fI.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then(function(){return t.operationInProgress=!0,e().catch(function(e){throw t.failure=e,t.operationInProgress=!1,ry("INTERNAL UNHANDLED ERROR: ",dI(e)),e}).then(function(e){return t.operationInProgress=!1,e})});return this.tail=n},fI.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),uy(0<=t,"Attempted to schedule an operation with a negative delay of "+t),-1<this.timerIdsToSkip.indexOf(e)&&(t=0);n=cI.createAndSchedule(this,e,t,n,function(e){return r.removeDelayedOperation(e)});return this.delayedOperations.push(n),n},fI.prototype.verifyNotFailed=function(){this.failure&&ay("AsyncQueue is already failed: "+dI(this.failure))},fI.prototype.verifyOperationInProgress=function(){uy(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},fI.prototype.drain=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,t=this.tail];case 1:e.sent(),e.label=2;case 2:if(t!==this.tail)return[3,0];e.label=3;case 3:return[2]}})})},fI.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++){if(n[t].timerId===e)return!0}return!1},fI.prototype.runAllDelayedOperationsUntil=function(r){var i=this;return this.drain().then(function(){i.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var e=0,t=i.delayedOperations;e<t.length;e++){var n=t[e];if(n.skipDelay(),"all"!==r&&n.timerId===r)break}return i.drain()})},fI.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},fI.prototype.removeDelayedOperation=function(e){e=this.delayedOperations.indexOf(e);uy(0<=e,"Delayed operation not found."),this.delayedOperations.splice(e,1)},fI);function fI(){var t=this;this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[],this.backoff=new wT(this,"async_queue_retry"),this.visibilityHandler=function(){var e=sI();e&&ny(uI,"Visibility state changed to "+e.visibilityState),t.backoff.skipBackoff()};var e=sI();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.visibilityHandler)}function pI(e,t){if(ry(uI,t+": "+e),Kw(e))return new Jg(Xg.UNAVAILABLE,t+": "+e);throw e}function dI(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}var gI=(yI.emptySet=function(e){return new yI(e.comparator)},yI.prototype.has=function(e){return null!=this.keyedMap.get(e)},yI.prototype.get=function(e){return this.keyedMap.get(e)},yI.prototype.first=function(){return this.sortedSet.minKey()},yI.prototype.last=function(){return this.sortedSet.maxKey()},yI.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},yI.prototype.indexOf=function(e){e=this.keyedMap.get(e);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(yI.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),yI.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(e,t){return n(e),!1})},yI.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},yI.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},yI.prototype.isEqual=function(e){if(!(e instanceof yI))return!1;if(this.size!==e.size)return!1;for(var t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},yI.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},yI.prototype.copy=function(e,t){var n=new yI;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n},yI);function yI(n){this.comparator=n?function(e,t){return n(e,t)||Ly.comparator(e.key,t.key)}:function(e,t){return Ly.comparator(e.key,t.key)},this.keyedMap=Dv,this.sortedSet=new vv(this.comparator)}var mI=(vI.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);!n||0!==e.type&&3===n.type?this.changeMap=this.changeMap.insert(t,e):3===e.type&&1!==n.type?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.changeMap=this.changeMap.remove(t):1===e.type&&2===n.type?this.changeMap=this.changeMap.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):ay("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n))},vI.prototype.getChanges=function(){var n=[];return this.changeMap.inorderTraversal(function(e,t){n.push(t)}),n},vI);function vI(){this.changeMap=new vv(Ly.comparator)}var bI=(_I.fromInitialDocuments=function(e,t,n,r){var i=[];return t.forEach(function(e){i.push({type:0,doc:e})}),new _I(e,t,gI.emptySet(t),i,n,r,!0,!1)},Object.defineProperty(_I.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),_I.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},_I);function _I(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}var wI=function(){this.viewSnap=void 0,this.listeners=[]};var EI=function(){this.queries=new F_(Mm,Lm),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set};function TI(a,s){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:if(uy(!!(t=cy(a,EI)).onListen,"onListen not set"),n=s.query,r=!1,(i=t.queries.get(n))||(r=!0,i=new wI),!r)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),o=i,[4,t.onListen(n)];case 2:return o.viewSnap=e.sent(),[3,4];case 3:return o=e.sent(),o=pI(o,"Initialization of query '"+Fm(s.query)+"' failed"),s.onError(o),[2];case 4:return t.queries.set(n,i),i.listeners.push(s),uy(!s.applyOnlineStateChange(t.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),i.viewSnap&&s.onViewSnapshot(i.viewSnap)&&SI(t),[2]}})})}function II(a,s){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){return uy(!!(t=cy(a,EI)).onUnlisten,"onUnlisten not set"),n=s.query,r=!1,(i=t.queries.get(n))&&0<=(o=i.listeners.indexOf(s))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?(t.queries.delete(n),[2,t.onUnlisten(n)]):[2]})})}function SI(e){e.snapshotsInSyncListeners.forEach(function(e){e.next()})}var CI=(kI.prototype.onViewSnapshot=function(e){if(uy(0<e.docChanges.length||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new bI(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},kI.prototype.onError=function(e){this.queryObserver.error(e)},kI.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},kI.prototype.shouldRaiseInitialEvent=function(e,t){if(uy(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var n="Offline"!==t;return this.options.waitForSyncWhenOnline&&n?(uy(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||"Offline"===t},kI.prototype.shouldRaiseEvent=function(e){if(0<e.docChanges.length)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},kI.prototype.raiseInitialEvent=function(e){uy(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=bI.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},kI);function kI(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=n||{}}var AI=(NI.fromSnapshot=function(e,t){for(var n=Pv(),r=Pv(),i=0,o=t.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}}return new NI(e,t.fromCache,n,r)},NI);function NI(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}var DI=(RI.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},RI.prototype.addReference=function(e,t){t=new OI(e,t);this.refsByKey=this.refsByKey.add(t),this.refsByTarget=this.refsByTarget.add(t)},RI.prototype.addReferences=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},RI.prototype.removeReference=function(e,t){this.removeRef(new OI(e,t))},RI.prototype.removeReferences=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},RI.prototype.removeReferencesForId=function(e){var t=this,n=new Ly(new Ny([])),r=new OI(n,e),e=new OI(n,e+1),i=[];return this.refsByTarget.forEachInRange([r,e],function(e){t.removeRef(e),i.push(e.key)}),i},RI.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},RI.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},RI.prototype.referencesForId=function(e){var t=new Ly(new Ny([])),n=new OI(t,e),e=new OI(t,e+1),r=Pv();return this.refsByTarget.forEachInRange([n,e],function(e){r=r.add(e.key)}),r},RI.prototype.containsKey=function(e){var t=new OI(e,0),t=this.refsByKey.firstAfterOrEqual(t);return null!==t&&e.isEqual(t.key)},RI);function RI(){this.refsByKey=new Sv(OI.compareByKey),this.refsByTarget=new Sv(OI.compareByTargetId)}var OI=(PI.compareByKey=function(e,t){return Ly.comparator(e.key,t.key)||fy(e.targetOrBatchId,t.targetOrBatchId)},PI.compareByTargetId=function(e,t){return fy(e.targetOrBatchId,t.targetOrBatchId)||Ly.comparator(e.key,t.key)},PI);function PI(e,t){this.key=e,this.targetOrBatchId=t}var xI=function(e){this.key=e},LI=function(e){this.key=e},MI=(Object.defineProperty(FI.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!1,configurable:!0}),FI.prototype.computeDocChanges=function(e,t){var a=this,s=t?t.changeSet:new mI,u=(t||this).documentSet,c=(t||this).mutatedKeys,l=u,h=!1,f=Cm(this.query)&&u.size===this.query.limit?u.last():null,p=km(this.query)&&u.size===this.query.limit?u.first():null;if(e.inorderTraversal(function(e,t){var n=u.get(e),r=t instanceof cm?t:null;r&&(uy(e.isEqual(r.key),"Mismatching keys found in document changes: "+e+" != "+r.key),r=Um(a.query,r)?r:null);var i=!!n&&a.mutatedKeys.has(n.key),o=!!r&&(r.hasLocalMutations||a.mutatedKeys.has(r.key)&&r.hasCommittedMutations),t=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(s.track({type:3,doc:r}),t=!0):a.shouldWaitForSyncedDocument(n,r)||(s.track({type:2,doc:r}),t=!0,(f&&0<a.docComparator(r,f)||p&&a.docComparator(r,p)<0)&&(h=!0)):!n&&r?(s.track({type:0,doc:r}),t=!0):n&&!r&&(s.track({type:1,doc:n}),t=!0,(f||p)&&(h=!0)),t&&(c=r?(l=l.add(r),o?c.add(e):c.delete(e)):(l=l.delete(e),c.delete(e)))}),Cm(this.query)||km(this.query))for(;l.size>this.query.limit;){var n=Cm(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);s.track({type:1,doc:n})}return uy(!h||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:l,changeSet:s,needsRefill:h,mutatedKeys:c}},FI.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},FI.prototype.applyChanges=function(e,t,n){var o=this;uy(!e.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var i=e.changeSet.getChanges();i.sort(function(e,t){return r=e.type,i=t.type,n(r)-n(i)||o.docComparator(e.doc,t.doc);function n(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ay("Unknown ChangeType: "+e)}}var r,i}),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],n=0===this.limboDocuments.size&&this.current?1:0,t=n!==this.syncState;return this.syncState=n,0!==i.length||t?{snapshot:new bI(this.query,e.documentSet,r,i,e.mutatedKeys,0==n,t,!1),limboChanges:a}:{limboChanges:a}},FI.prototype.applyOnlineStateChange=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new mI,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},FI.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&(!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations)},FI.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.add(e)}),e.modifiedDocuments.forEach(function(e){uy(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")}),e.removedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)}),this.current=e.current)},FI.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var n=this.limboDocuments;this.limboDocuments=Pv(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var r=[];return n.forEach(function(e){t.limboDocuments.has(e)||r.push(new LI(e))}),this.limboDocuments.forEach(function(e){n.has(e)||r.push(new xI(e))}),r},FI.prototype.synchronizeWithPersistedState=function(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=Pv();e=this.computeDocChanges(e.documents);return this.applyChanges(e,!0)},FI.prototype.computeInitialSnapshot=function(){return bI.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState)},FI);function FI(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=Pv(),this.mutatedKeys=Pv(),this.docComparator=qm(e),this.documentSet=new gI(this.docComparator)}var UI="SyncEngine",qI=function(e,t,n){this.query=e,this.targetId=t,this.view=n},jI=function(e){this.key=e,this.receivedDocument=!1},VI=(Object.defineProperty(BI.prototype,"isPrimaryClient",{get:function(){return!0===this._isPrimaryClient},enumerable:!1,configurable:!0}),BI);function BI(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new F_(Mm,Lm),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=[],this.activeLimboTargetsByKey=new vv(Ly.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new DI,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=CE.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}function KI(i,o,a,s){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return i.applyDocChanges=function(e,t,n){return function(r,i,o,a){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return(t=i.view.computeDocChanges(o)).needsRefill?[4,yT(r.localStore,i.query,!1).then(function(e){e=e.documents;return i.view.computeDocChanges(e,t)})]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return n=a&&a.targetChanges.get(i.targetId),n=i.view.applyChanges(t,r.isPrimaryClient,n),ZI(r,i.targetId,n.limboChanges),[2,n.snapshot]}})})}(i,e,t,n)},[4,yT(i.localStore,o,!0)];case 1:return n=e.sent(),r=new MI(o,n.remoteKeys),t=r.computeDocChanges(n.documents),n=zv.createSynthesizedTargetChangeForCurrentChange(a,s&&"Offline"!==i.onlineState),n=r.applyChanges(t,i.isPrimaryClient,n),ZI(i,a,n.limboChanges),uy(!!n.snapshot,"applyChanges for new view should always return a snapshot"),r=new qI(o,a,r),i.queryViewsByQuery.set(o,r),i.queriesByTarget.has(a)?i.queriesByTarget.get(a).push(o):i.queriesByTarget.set(a,[o]),[2,n.snapshot]}})})}function WI(r,i,o){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:n=cS(r),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,lT(n.localStore,i)];case 2:return t=e.sent(),n.sharedClientState.addPendingMutation(t.batchId),function(e,t,n){var r=e.mutationUserCallbacks[e.currentUser.toKey()];r=r||new vv(fy);r=r.insert(t,n),e.mutationUserCallbacks[e.currentUser.toKey()]=r}(n,t.batchId,o),[4,tS(n,t.changes)];case 3:return e.sent(),[4,$T(n.remoteStore)];case 4:return e.sent(),[3,6];case 5:return n=e.sent(),n=pI(n,"Failed to persist write"),o.reject(n),[3,6];case 6:return[2]}})})}function zI(r,i){return _o(this,void 0,void 0,function(){var n,t;return wo(this,function(e){switch(e.label){case 0:n=cy(r,VI),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,pT(n.localStore,i)];case 2:return t=e.sent(),i.targetChanges.forEach(function(e,t){t=n.activeLimboResolutionsByTarget.get(t);t&&(sy(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<e.addedDocuments.size?t.receivedDocument=!0:0<e.modifiedDocuments.size?sy(t.receivedDocument,"Received change for limbo target document without add."):0<e.removedDocuments.size&&(sy(t.receivedDocument,"Received remove for limbo target document without add."),t.receivedDocument=!1))}),[4,tS(n,t,i)];case 3:return e.sent(),[3,6];case 4:return[4,_T(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}function HI(e,n,t){var r,e=cy(e,VI);(e.isPrimaryClient&&0===t||!e.isPrimaryClient&&1===t)&&(r=[],e.queryViewsByQuery.forEach(function(e,t){t=t.view.applyOnlineStateChange(n);uy(0===t.limboChanges.length,"OnlineState should not affect limbo documents."),t.snapshot&&r.push(t.snapshot)}),function(e,i){(e=cy(e,EI)).onlineState=i;var o=!1;e.queries.forEach(function(e,t){for(var n=0,r=t.listeners;n<r.length;n++){r[n].applyOnlineStateChange(i)&&(o=!0)}}),o&&SI(e)}(e.eventManager,n),r.length&&(uy(!!e.syncEngineListener.onWatchChange,"Active views but EventManager callbacks are not assigned"),e.syncEngineListener.onWatchChange(r)),e.onlineState=n,e.isPrimaryClient&&e.sharedClientState.setOnlineState(n))}function GI(a,s,u){return _o(this,void 0,void 0,function(){var n,o;return wo(this,function(e){switch(e.label){case 0:n=cy(a,VI),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,(t=n.localStore,r=s,(i=cy(t,aT)).persistence.runTransaction("Reject batch","readwrite-primary",function(t){var n;return i.mutationQueue.lookupMutationBatch(t,r).next(function(e){return sy(null!==e,"Attempt to reject nonexistent batch!"),n=e.keys(),i.mutationQueue.removeMutationBatch(t,e)}).next(function(){return i.mutationQueue.performConsistencyCheck(t)}).next(function(){return i.localDocuments.getDocuments(t,n)})}))];case 2:return o=e.sent(),XI(n,s,u),YI(n,s),n.sharedClientState.updateMutationState(s,"rejected",u),[4,tS(n,o)];case 3:return e.sent(),[3,6];case 4:return[4,_T(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}var t,r,i})})}function QI(a,s){return _o(this,void 0,void 0,function(){var r,i,o;return wo(this,function(e){switch(e.label){case 0:GT((r=cy(a,VI)).remoteStore)||ny(UI,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(t=r.localStore,(n=cy(t,aT)).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return n.mutationQueue.getHighestUnacknowledgedBatchId(e)}))];case 2:return(i=e.sent())===O_?(s.resolve(),[2]):((o=r.pendingWritesCallbacks.get(i)||[]).push(s),r.pendingWritesCallbacks.set(i,o),[3,4]);case 3:return o=e.sent(),o=pI(o,"Initialization of waitForPendingWrites() operation failed"),s.reject(o),[3,4];case 4:return[2]}var t,n})})}function YI(e,t){(e.pendingWritesCallbacks.get(t)||[]).forEach(function(e){e.resolve()}),e.pendingWritesCallbacks.delete(t)}function XI(e,t,n){var r=cy(e,VI),i=r.mutationUserCallbacks[r.currentUser.toKey()];i&&((e=i.get(t))&&(uy(t===i.minKey(),"Mutation callbacks processed out-of-order?"),n?e.reject(n):e.resolve(),i=i.remove(t)),r.mutationUserCallbacks[r.currentUser.toKey()]=i)}function JI(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e),uy(t.queriesByTarget.has(e)&&0!==t.queriesByTarget.get(e).length,"There are no queries mapped to target id "+e);for(var r=0,i=t.queriesByTarget.get(e);r<i.length;r++){var o=i[r];t.queryViewsByQuery.delete(o),n&&t.syncEngineListener.onWatchError(o,n)}t.queriesByTarget.delete(e),t.isPrimaryClient&&t.limboDocumentRefs.removeReferencesForId(e).forEach(function(e){t.limboDocumentRefs.containsKey(e)||$I(t,e)})}function $I(e,t){var n=e.activeLimboTargetsByKey.get(t);null!==n&&(BT(e.remoteStore,n),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.remove(t),e.activeLimboResolutionsByTarget.delete(n),eS(e))}function ZI(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof xI?(e.limboDocumentRefs.addReference(o.key,t),function(e,t){t=t.key;e.activeLimboTargetsByKey.get(t)||(ny(UI,"New document in limbo: "+t),e.enqueuedLimboResolutions.push(t),eS(e))}(e,o)):o instanceof LI?(ny(UI,"Document no longer in limbo: "+o.key),e.limboDocumentRefs.removeReference(o.key,t),e.limboDocumentRefs.containsKey(o.key)||$I(e,o.key)):ay("Unknown limbo change: "+JSON.stringify(o))}}function eS(e){for(;0<e.enqueuedLimboResolutions.length&&e.activeLimboTargetsByKey.size<e.maxConcurrentLimboResolutions;){var t=e.enqueuedLimboResolutions.shift(),n=e.limboTargetIdGenerator.next();e.activeLimboResolutionsByTarget.set(n,new jI(t)),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.insert(t,n),VT(e.remoteStore,new z_(Pm(Sm(t.path)),n,2,G_.INVALID))}}function tS(t,a,s){return _o(this,void 0,void 0,function(){var n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return(n=cy(t,VI),r=[],i=[],o=[],n.queryViewsByQuery.isEmpty())?[2]:(n.queryViewsByQuery.forEach(function(e,t){uy(!!n.applyDocChanges,"ApplyDocChangesHandler not set"),o.push(n.applyDocChanges(t,a,s).then(function(e){e&&(n.isPrimaryClient&&n.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),r.push(e),e=AI.fromSnapshot(t.targetId,e),i.push(e))}))}),[4,Promise.all(o)]);case 1:return e.sent(),n.syncEngineListener.onWatchChange(r),[4,function(u,c){return _o(this,void 0,void 0,function(){var r,t,n,i,o,a,s;return wo(this,function(e){switch(e.label){case 0:r=cy(u,aT),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return q_.forEach(c,function(t){return q_.forEach(t.addedKeys,function(e){return r.persistence.referenceDelegate.addReference(n,t.targetId,e)}).next(function(){return q_.forEach(t.removedKeys,function(e){return r.persistence.referenceDelegate.removeReference(n,t.targetId,e)})})})})];case 2:return e.sent(),[3,4];case 3:if(!Kw(t=e.sent()))throw t;return ny(iT,"Failed to update sequence numbers: "+t),[3,4];case 4:for(n=0,i=c;n<i.length;n++)s=i[n],o=s.targetId,s.fromCache||(uy(null!==(a=r.targetDataByTarget.get(o)),"Can't set limbo-free snapshot version for unknown target: "+o),s=a.snapshotVersion,s=a.withLastLimboFreeSnapshotVersion(s),r.targetDataByTarget=r.targetDataByTarget.insert(o,s));return[2]}})})}(n.localStore,i)];case 2:return e.sent(),[2]}})})}function nS(o,a){return _o(this,void 0,void 0,function(){var r,i;return wo(this,function(e){switch(e.label){case 0:return(r=cy(o,VI),!r.currentUser.isEqual(a))?(ny(UI,"User change. New user:",a.toKey()),[4,cT(r.localStore,a)]):[3,3];case 1:return i=e.sent(),r.currentUser=a,n="'waitForPendingWrites' promise is rejected due to a user change.",(t=r).pendingWritesCallbacks.forEach(function(e){e.forEach(function(e){e.reject(new Jg(Xg.CANCELLED,n))})}),t.pendingWritesCallbacks.clear(),r.sharedClientState.handleUserChange(a,i.removedBatchIds,i.addedBatchIds),[4,tS(r,i.affectedDocuments)];case 2:e.sent(),e.label=3;case 3:return[2]}var t,n})})}function rS(u,c,l,h){return _o(this,void 0,void 0,function(){var a,s;return wo(this,function(e){switch(e.label){case 0:return a=cy(u,VI),[4,(n=a.localStore,r=c,i=cy(n,aT),o=cy(i.mutationQueue,pw),i.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return o.lookupMutationKeys(t,r).next(function(e){return e?i.localDocuments.getDocuments(t,e):q_.resolve(null)})}))];case 1:return null===(s=e.sent())?(ny(UI,"Cannot apply mutation batch with id: "+c),[2]):"pending"!==l?[3,3]:[4,$T(a.remoteStore)];case 2:return e.sent(),[3,4];case 3:"acknowledged"===l||"rejected"===l?(XI(a,c,h||null),YI(a,c),t=a.localStore,n=c,cy(cy(t,aT).mutationQueue,pw).removeCachedMutationKeys(n)):ay("Unknown batchState: "+l),e.label=4;case 4:return[4,tS(a,s)];case 5:return e.sent(),[2]}var t,n,r,i,o})})}function iS(l,h){return _o(this,void 0,void 0,function(){var r,t,i,o,a,s,u,c;return wo(this,function(e){switch(e.label){case 0:return(uS(r=cy(l,VI)),cS(r),!0!==h||!0===r._isPrimaryClient)?[3,3]:(t=r.sharedClientState.getAllActiveQueryTargets(),[4,oS(r,t.toArray(),!0)]);case 1:return i=e.sent(),r._isPrimaryClient=!0,[4,rI(r.remoteStore,!0)];case 2:for(e.sent(),o=0,a=i;o<a.length;o++)s=a[o],VT(r.remoteStore,s);return[3,7];case 3:return!1!==h||!1===r._isPrimaryClient?[3,7]:(u=[],c=Promise.resolve(),r.queriesByTarget.forEach(function(e,t){r.sharedClientState.isLocalQueryTarget(t)?u.push(t):c=c.then(function(){return JI(r,t),gT(r.localStore,t,!0)}),BT(r.remoteStore,t)}),[4,c]);case 4:return e.sent(),[4,oS(r,u,!1)];case 5:return e.sent(),(n=cy(r,VI)).activeLimboResolutionsByTarget.forEach(function(e,t){BT(n.remoteStore,t)}),n.limboDocumentRefs.removeAllReferences(),n.activeLimboResolutionsByTarget=new Map,n.activeLimboTargetsByKey=new vv(Ly.comparator),r._isPrimaryClient=!1,[4,rI(r.remoteStore,!1)];case 6:e.sent(),e.label=7;case 7:return[2]}var n})})}function oS(p,d,g){return _o(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,h,f;return wo(this,function(e){switch(e.label){case 0:t=cy(p,VI),n=[],r=[],i=0,o=d,e.label=1;case 1:return i<o.length?(a=o[i],s=void 0,(u=t.queriesByTarget.get(a))&&0!==u.length?[4,dT(t.localStore,Pm(u[0]))]:[3,7]):[3,13];case 2:s=e.sent(),c=0,l=u,e.label=3;case 3:return c<l.length?(l=l[c],uy(!!(h=t.queryViewsByQuery.get(l)),"No query view found for "+Fm(l)),[4,function(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,yT((t=cy(r,VI)).localStore,i.query,!0)];case 1:return n=e.sent(),n=i.view.synchronizeWithPersistedState(n),t.isPrimaryClient&&ZI(t,i.targetId,n.limboChanges),[2,n]}})})}(t,h)]):[3,6];case 4:(h=e.sent()).snapshot&&r.push(h.snapshot),e.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return uy(g,"A secondary tab should never have an active view without an active target."),[4,mT(t.localStore,a)];case 8:return uy(!!(f=e.sent()),"Target for id "+a+" not found"),[4,dT(t.localStore,f)];case 9:return s=e.sent(),[4,KI(t,aS(f),a,!1)];case 10:e.sent(),e.label=11;case 11:n.push(s),e.label=12;case 12:return i++,[3,1];case 13:return t.syncEngineListener.onWatchChange(r),[2,n]}})})}function aS(e){return Im(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function sS(e){e=cy(e,VI);return cy(cy(e.localStore,aT).persistence,XE).getActiveClients()}function uS(e){e=cy(e,VI);return e.remoteStore.remoteSyncer.applyRemoteEvent=zI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(e,t){var n=cy(e,VI);if((e=n.activeLimboResolutionsByTarget.get(t))&&e.receivedDocument)return Pv().add(e.key);var r=Pv();if(!(t=n.queriesByTarget.get(t)))return r;for(var i=0,o=t;i<o.length;i++){var a=o[i],s=n.queryViewsByQuery.get(a);uy(!!s,"No query view found for "+Fm(a)),r=r.unionWith(s.view.syncedDocuments)}return r}.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=function(o,a,s){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:return((t=cy(o,VI)).sharedClientState.updateQueryState(a,"rejected",s),i=t.activeLimboResolutionsByTarget.get(a),n=i&&i.key)?(r=(r=new vv(Ly.comparator)).insert(n,new fm(n,yv.min())),i=Pv().add(n),i=new Kv(yv.min(),new Map,new Sv(fy),r,i),[4,zI(t,i)]):[3,2];case 1:return e.sent(),t.activeLimboTargetsByKey=t.activeLimboTargetsByKey.remove(n),t.activeLimboResolutionsByTarget.delete(a),eS(t),[3,4];case 2:return[4,gT(t.localStore,a,!1).then(function(){return JI(t,a,s)}).catch(_T)];case 3:e.sent(),e.label=4;case 4:return[2]}})})}.bind(null,e),e.syncEngineListener.onWatchChange=function(e,t){for(var n=cy(e,EI),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=a.query,s=n.queries.get(s);if(s){for(var u=0,c=s.listeners;u<c.length;u++){c[u].onViewSnapshot(a)&&(r=!0)}s.viewSnap=a}}r&&SI(n)}.bind(null,e.eventManager),e.syncEngineListener.onWatchError=function(e,t,n){var r=cy(e,EI);if(e=r.queries.get(t))for(var i=0,o=e.listeners;i<o.length;i++){o[i].onError(n)}r.queries.delete(t)}.bind(null,e.eventManager),e}function cS(e){e=cy(e,VI);return e.remoteStore.remoteSyncer.applySuccessfulWrite=function(i,o){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:t=cy(i,VI),n=o.batch.batchId,e.label=1;case 1:return e.trys.push([1,4,,6]),[4,hT(t.localStore,o)];case 2:return r=e.sent(),XI(t,n,null),YI(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),[4,tS(t,r)];case 3:return e.sent(),[3,6];case 4:return[4,_T(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})}.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GI.bind(null,e),e}var lS="firestore_clients";function hS(e,t){return uy(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),lS+"_"+e+"_"+t}var fS="firestore_mutations";function pS(e,t,n){n=fS+"_"+e+"_"+n;return t.isAuthenticated()&&(n+="_"+t.uid),n}var dS="firestore_targets";function gS(e,t){return dS+"_"+e+"_"+t}var yS="firestore_online_state";var mS="firestore_bundle_loaded";var vS="firestore_sequence_number";var bS="SharedClientState",_S=(wS.fromWebStorageEntry=function(e,t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Jg(r.error.code,r.error.message)),i?new wS(e,t,r.state,o):(ry(bS,"Failed to parse mutation state for ID '"+t+"': "+n),null)},wS.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},wS);function wS(e,t,n,r){this.user=e,this.batchId=t,this.state=n,uy(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}var ES=(TS.fromWebStorageEntry=function(e,t){var n=JSON.parse(t),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Jg(n.error.code,n.error.message)),r?new TS(e,n.state,i):(ry(bS,"Failed to parse target state for ID '"+e+"': "+t),null)},TS.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},TS);function TS(e,t,n){this.targetId=e,this.state=t,uy(void 0!==(this.error=n)==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}var IS=(SS.fromWebStorageEntry=function(e,t){for(var n=JSON.parse(t),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=xv,o=0;r&&o<n.activeTargetIds.length;++o)r=Sy(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new SS(e,i):(ry(bS,"Failed to parse client data for instance '"+e+"': "+t),null)},SS);function SS(e,t){this.clientId=e,this.activeTargetIds=t}var CS=(kS.fromWebStorageEntry=function(e){var t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new kS(t.clientId,t.onlineState):(ry(bS,"Failed to parse online state: "+e),null)},kS);function kS(e,t){this.clientId=e,this.onlineState=t}var AS=(NS.prototype.addQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},NS.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},NS.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},NS);function NS(){this.activeTargetIds=xv}var DS=(RS.isAvailable=function(e){return!(!e||!e.localStorage)},RS.prototype.start=function(){return _o(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,h=this;return wo(this,function(e){switch(e.label){case 0:return uy(!this.started,"WebStorageSharedClientState already started"),uy(null!==this.syncEngine,"syncEngine property must be set before calling start()"),uy(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(a=e.sent(),t=0,n=a;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(hS(this.persistenceKey,r)))&&(o=IS.fromWebStorageEntry(r,i))&&(this.activeClients=this.activeClients.insert(o.clientId,o));for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)l=c[u],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.window.addEventListener("unload",function(){return h.shutdown()}),this.started=!0,[2]}})})},RS.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},RS.prototype.getAllActiveQueryTargets=function(){return this.extractActiveQueryTargets(this.activeClients)},RS.prototype.isActiveQueryTarget=function(n){var r=!1;return this.activeClients.forEach(function(e,t){t.activeTargetIds.has(n)&&(r=!0)}),r},RS.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},RS.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},RS.prototype.addLocalQueryTarget=function(e){var t,n="not-current";return this.isActiveQueryTarget(e)&&(!(t=this.storage.getItem(gS(this.persistenceKey,e)))||(t=ES.fromWebStorageEntry(e,t))&&(n=t.state)),this.localClientState.addQueryTarget(e),this.persistClientState(),n},RS.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},RS.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},RS.prototype.clearQueryState=function(e){this.removeItem(gS(this.persistenceKey,e))},RS.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},RS.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.removeMutationState(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},RS.prototype.setOnlineState=function(e){this.persistOnlineState(e)},RS.prototype.notifyBundleLoaded=function(){this.persistBundleLoadedState()},RS.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},RS.prototype.getItem=function(e){var t=this.storage.getItem(e);return ny(bS,"READ",e,t),t},RS.prototype.setItem=function(e,t){ny(bS,"SET",e,t),this.storage.setItem(e,t)},RS.prototype.removeItem=function(e){ny(bS,"REMOVE",e),this.storage.removeItem(e)},RS.prototype.handleWebStorageEvent=function(e){var t=this,o=e;if(o.storageArea===this.storage){if(ny(bS,"EVENT",o.key,o.newValue),o.key===this.localClientStorageKey)return void ry("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueRetryable(function(){return _o(t,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){if(!this.started)return this.earlyEvents.push(o),[2];if(null===o.key)return[2];if(this.clientStateKeyRe.test(o.key)){if(null==o.newValue)return t=this.fromWebStorageClientStateKey(o.key),[2,this.handleClientStateEvent(t,null)];if(t=this.fromWebStorageClientState(o.key,o.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(o.key)){if(null!==o.newValue&&(n=this.fromWebStorageMutationMetadata(o.key,o.newValue)))return[2,this.handleMutationBatchEvent(n)]}else if(this.queryTargetKeyRe.test(o.key)){if(null!==o.newValue&&(r=this.fromWebStorageQueryTargetMetadata(o.key,o.newValue)))return[2,this.handleQueryTargetEvent(r)]}else if(o.key===this.onlineStateKey){if(null!==o.newValue&&(i=this.fromWebStorageOnlineState(o.newValue)))return[2,this.handleOnlineStateEvent(i)]}else if(o.key===this.sequenceNumberKey)uy(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(i=function(e){var t=G_.INVALID;if(null!=e)try{var n=JSON.parse(e);sy("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(e){ry(bS,"Failed to read sequence number from WebStorage",e)}return t}(o.newValue))!==G_.INVALID&&this.sequenceNumberHandler(i);else if(o.key===this.bundleLoadedKey)return[2,this.syncEngine.synchronizeWithChangedDocuments()];return[2]})})})}},Object.defineProperty(RS.prototype,"localClientState",{get:function(){return this.activeClients.get(this.localClientId)},enumerable:!1,configurable:!0}),RS.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},RS.prototype.persistMutationState=function(e,t,n){n=new _S(this.currentUser,e,t,n),e=pS(this.persistenceKey,this.currentUser,e);this.setItem(e,n.toWebStorageJSON())},RS.prototype.removeMutationState=function(e){e=pS(this.persistenceKey,this.currentUser,e);this.removeItem(e)},RS.prototype.persistOnlineState=function(e){e={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},RS.prototype.persistQueryTargetState=function(e,t,n){var r=gS(this.persistenceKey,e),n=new ES(e,t,n);this.setItem(r,n.toWebStorageJSON())},RS.prototype.persistBundleLoadedState=function(){this.setItem(this.bundleLoadedKey,"value-not-used")},RS.prototype.fromWebStorageClientStateKey=function(e){e=this.clientStateKeyRe.exec(e);return e?e[1]:null},RS.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return uy(null!==n,"Cannot parse client state key '"+e+"'"),IS.fromWebStorageEntry(n,t)},RS.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);uy(null!==n,"Cannot parse mutation batch key '"+e+"'");e=Number(n[1]),n=void 0!==n[2]?n[2]:null;return _S.fromWebStorageEntry(new Gg(n),e,t)},RS.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);uy(null!==n,"Cannot parse query target key '"+e+"'");n=Number(n[1]);return ES.fromWebStorageEntry(n,t)},RS.prototype.fromWebStorageOnlineState=function(e){return CS.fromWebStorageEntry(e)},RS.prototype.handleMutationBatchEvent=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){return t.user.uid!==this.currentUser.uid?(ny(bS,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},RS.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},RS.prototype.handleClientStateEvent=function(e,t){var n=this,r=t?this.activeClients.insert(e,t):this.activeClients.remove(e),i=this.extractActiveQueryTargets(this.activeClients),o=this.extractActiveQueryTargets(r),a=[],s=[];return o.forEach(function(e){i.has(e)||a.push(e)}),i.forEach(function(e){o.has(e)||s.push(e)}),this.syncEngine.applyActiveTargetsChange(a,s).then(function(){n.activeClients=r})},RS.prototype.handleOnlineStateEvent=function(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},RS.prototype.extractActiveQueryTargets=function(e){var n=xv;return e.forEach(function(e,t){n=n.unionWith(t.activeTargetIds)}),n},RS);function RS(e,t,n,r,i){this.window=e,this.queue=t,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new vv(fy),this.started=!1,this.earlyEvents=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.localClientStorageKey=hS(this.persistenceKey,this.localClientId),this.sequenceNumberKey=(i=this.persistenceKey,vS+"_"+i),this.activeClients=this.activeClients.insert(this.localClientId,new AS),this.clientStateKeyRe=new RegExp("^"+lS+"_"+n+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+fS+"_"+n+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+dS+"_"+n+"_(\\d+)$"),this.onlineStateKey=(n=this.persistenceKey,yS+"_"+n),this.bundleLoadedKey=(n=this.persistenceKey,mS+"_"+n),this.window.addEventListener("storage",this.storageListener)}var OS=(PS.prototype.addPendingMutation=function(e){},PS.prototype.updateMutationState=function(e,t,n){},PS.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},PS.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},PS.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},PS.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},PS.prototype.clearQueryState=function(e){delete this.queryState[e]},PS.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},PS.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},PS.prototype.start=function(){return this.localState=new AS,Promise.resolve()},PS.prototype.handleUserChange=function(e,t,n){},PS.prototype.setOnlineState=function(e){},PS.prototype.shutdown=function(){},PS.prototype.writeSequenceNumber=function(e){},PS.prototype.notifyBundleLoaded=function(){},PS);function PS(){this.localState=new AS,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}var xS=(LS.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},LS.prototype.getDocumentsMatchingQuery=function(t,r,i,o){var e,a=this;return uy(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),0===(e=r).filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())||i.isEqual(yv.min())?this.executeFullCollectionScan(t,r):this.localDocumentsView.getDocuments(t,o).next(function(e){var n=a.applyQuery(r,e);return(Cm(r)||km(r))&&a.needsRefill(r.limitType,n,o,i)?a.executeFullCollectionScan(t,r):(ty()<=Aa.DEBUG&&ny("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fm(r)),a.localDocumentsView.getDocumentsMatchingQuery(t,r,i).next(function(t){return n.forEach(function(e){t=t.insert(e.key,e)}),t}))})},LS.prototype.applyQuery=function(n,e){var r=new Sv(qm(n));return e.forEach(function(e,t){t instanceof cm&&Um(n,t)&&(r=r.add(t))}),r},LS.prototype.needsRefill=function(e,t,n,r){if(n.size!==t.size)return!0;t="F"===e?t.last():t.first();return!!t&&(t.hasPendingWrites||0<t.version.compareTo(r))},LS.prototype.executeFullCollectionScan=function(e,t){return ty()<=Aa.DEBUG&&ny("QueryEngine","Using full collection scan to execute query:",Fm(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,yv.min())},LS);function LS(){}var MS=(FS.prototype.checkEmpty=function(e){return q_.resolve(0===this.mutationQueue.length)},FS.prototype.addMutationBatch=function(e,t,n,r){uy(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&uy(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");n=new P_(i,t,n,r);this.mutationQueue.push(n);for(var o=0,a=r;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new OI(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}return q_.resolve(n)},FS.prototype.lookupMutationBatch=function(e,t){return q_.resolve(this.findMutationBatch(t))},FS.prototype.getNextMutationBatchAfterBatchId=function(e,t){t+=1,t=this.indexOfBatchId(t),t=t<0?0:t;return q_.resolve(this.mutationQueue.length>t?this.mutationQueue[t]:null)},FS.prototype.getHighestUnacknowledgedBatchId=function(){return q_.resolve(0===this.mutationQueue.length?O_:this.nextBatchId-1)},FS.prototype.getAllMutationBatches=function(e){return q_.resolve(this.mutationQueue.slice())},FS.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new OI(t,0),i=new OI(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(e){uy(t.isEqual(e.key),"Should only iterate over a single key's batches");e=n.findMutationBatch(e.targetOrBatchId);uy(null!==e,"Batches in the index must exist in the main table"),o.push(e)}),q_.resolve(o)},FS.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var r=this,i=new Sv(fy);return t.forEach(function(t){var e=new OI(t,0),n=new OI(t,Number.POSITIVE_INFINITY);r.batchesByDocumentKey.forEachInRange([e,n],function(e){uy(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),i=i.add(e.targetOrBatchId)})}),q_.resolve(this.findMutationBatches(i))},FS.prototype.getAllMutationBatchesAffectingQuery=function(e,t){uy(!Rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,t=n;Ly.isDocumentKey(t)||(t=t.child(""));var t=new OI(new Ly(t),0),i=new Sv(fy);return this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.targetOrBatchId)),!0)},t),q_.resolve(this.findMutationBatches(i))},FS.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach(function(e){e=t.findMutationBatch(e);null!==e&&n.push(e)}),n},FS.prototype.removeMutationBatch=function(n,r){var i=this;sy(0===this.indexOfExistingBatchId(r.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var o=this.batchesByDocumentKey;return q_.forEach(r.mutations,function(e){var t=new OI(e.key,r.batchId);return o=o.delete(t),i.referenceDelegate.markPotentiallyOrphaned(n,e.key)}).next(function(){i.batchesByDocumentKey=o})},FS.prototype.removeCachedMutationKeys=function(e){},FS.prototype.containsKey=function(e,t){var n=new OI(t,0),n=this.batchesByDocumentKey.firstAfterOrEqual(n);return q_.resolve(t.isEqual(n&&n.key))},FS.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&uy(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),q_.resolve()},FS.prototype.indexOfExistingBatchId=function(e,t){e=this.indexOfBatchId(e);return uy(0<=e&&e<this.mutationQueue.length,"Batches must exist to be "+t),e},FS.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},FS.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;t=this.mutationQueue[t];return uy(t.batchId===e,"If found batch must match"),t},FS);function FS(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new Sv(OI.compareByKey)}var US=(qS.prototype.addEntry=function(e,t,n){uy(!n.isEqual(yv.min()),"Cannot add a document with a read time of zero");var r=t.key,i=this.docs.get(r),o=i?i.size:0,i=this.sizer(t);return this.docs=this.docs.insert(r,{maybeDocument:t,size:i,readTime:n}),this.size+=i-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())},qS.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},qS.prototype.getEntry=function(e,t){t=this.docs.get(t);return q_.resolve(t?t.maybeDocument:null)},qS.prototype.getEntries=function(e,t){var n=this,r=Nv;return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)}),q_.resolve(r)},qS.prototype.getDocumentsMatchingQuery=function(e,t,n){uy(!Rm(t),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Dv,i=new Ly(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,a=u.maybeDocument,u=u.readTime;if(!t.path.isPrefixOf(s.path))break;u.compareTo(n)<=0||a instanceof cm&&Um(t,a)&&(r=r.insert(a.key,a))}return q_.resolve(r)},qS.prototype.forEachDocumentKey=function(e,t){return q_.forEach(this.docs,function(e){return t(e)})},qS.prototype.newChangeBuffer=function(e){return new VS(this)},qS.prototype.getSize=function(e){return q_.resolve(this.size)},qS);function qS(e,t){this.indexManager=e,this.sizer=t,this.docs=new vv(Ly.comparator),this.size=0}var jS,VS=(vo(BS,jS=ge),BS.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(e,t){t&&t.maybeDocument?i.push(r.documentCache.addEntry(n,t.maybeDocument,r.getReadTime(e))):r.documentCache.removeEntry(e)}),q_.waitFor(i)},BS.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},BS.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},BS);function BS(e){var t=jS.call(this)||this;return t.documentCache=e,t}var KS=(WS.prototype.forEachTarget=function(e,n){return this.targets.forEach(function(e,t){return n(t)}),q_.resolve()},WS.prototype.getLastRemoteSnapshotVersion=function(e){return q_.resolve(this.lastRemoteSnapshotVersion)},WS.prototype.getHighestSequenceNumber=function(e){return q_.resolve(this.highestSequenceNumber)},WS.prototype.allocateTargetId=function(e){return this.highestTargetId=this.targetIdGenerator.next(),q_.resolve(this.highestTargetId)},WS.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),q_.resolve()},WS.prototype.saveTargetData=function(e){this.targets.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new CE(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},WS.prototype.addTargetData=function(e,t){return uy(!this.targets.has(t.target),"Adding a target that already exists"),this.saveTargetData(t),this.targetCount+=1,q_.resolve()},WS.prototype.updateTargetData=function(e,t){return uy(this.targets.has(t.target),"Updating a non-existent target"),this.saveTargetData(t),q_.resolve()},WS.prototype.removeTargetData=function(e,t){return uy(0<this.targetCount,"Removing a target from an empty cache"),uy(this.targets.has(t.target),"Removing a non-existent target from the cache"),this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),--this.targetCount,q_.resolve()},WS.prototype.removeTargets=function(n,r,i){var o=this,a=0,s=[];return this.targets.forEach(function(e,t){t.sequenceNumber<=r&&null===i.get(t.targetId)&&(o.targets.delete(e),s.push(o.removeMatchingKeysForTargetId(n,t.targetId)),a++)}),q_.waitFor(s).next(function(){return a})},WS.prototype.getTargetCount=function(e){return q_.resolve(this.targetCount)},WS.prototype.getTargetData=function(e,t){t=this.targets.get(t)||null;return q_.resolve(t)},WS.prototype.addMatchingKeys=function(e,t,n){return this.references.addReferences(t,n),q_.resolve()},WS.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),q_.waitFor(i)},WS.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),q_.resolve()},WS.prototype.getMatchingKeysForTargetId=function(e,t){t=this.references.referencesForId(t);return q_.resolve(t)},WS.prototype.containsKey=function(e,t){return q_.resolve(this.references.containsKey(t))},WS);function WS(e){this.persistence=e,this.targets=new F_(bm,wm),this.lastRemoteSnapshotVersion=yv.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new DI,this.targetCount=0,this.targetIdGenerator=CE.forTargetCache()}var zS=(HS.prototype.getBundleMetadata=function(e,t){return q_.resolve(this.bundles.get(t))},HS.prototype.saveBundleMetadata=function(e,t){return this.bundles.set(t.id,{id:(t=t).id,version:t.version,createTime:hb(t.createTime)}),q_.resolve()},HS.prototype.getNamedQuery=function(e,t){return q_.resolve(this.namedQueries.get(t))},HS.prototype.saveNamedQuery=function(e,t){return this.namedQueries.set(t.name,{name:(t=t).name,query:fw(t.bundledQuery),readTime:hb(t.readTime)}),q_.resolve()},HS);function HS(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}var GS=(QS.prototype.start=function(){return Promise.resolve()},QS.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(QS.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),QS.prototype.setDatabaseDeletedListener=function(){},QS.prototype.setNetworkEnabled=function(){},QS.prototype.getIndexManager=function(){return this.indexManager},QS.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new MS(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},QS.prototype.getTargetCache=function(){return this.targetCache},QS.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},QS.prototype.getBundleCache=function(){return this.bundleCache},QS.prototype.runTransaction=function(e,t,n){var r=this;ny("MemoryPersistence","Starting transaction:",e);var i=new XS(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(e){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},QS.prototype.mutationQueuesContainKey=function(t,n){return q_.or(Object.values(this.mutationQueues).map(function(e){return function(){return e.containsKey(t,n)}}))},QS);function QS(e,t){var n=this;this.mutationQueues={},this.listenSequence=new G_(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new KS(this);this.indexManager=new Dw,this.remoteDocumentCache=(e=this.indexManager,new US(e,function(e){return n.referenceDelegate.documentSize(e)})),this.serializer=new nw(t),this.bundleCache=new zS(this.serializer)}var YS,XS=(vo(JS,YS=de),JS);function JS(e){var t=YS.call(this)||this;return t.currentSequenceNumber=e,t}var $S=(ZS.factory=function(e){return new ZS(e)},Object.defineProperty(ZS.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw ay("orphanedDocuments is only valid during a transaction.")},enumerable:!1,configurable:!0}),ZS.prototype.addReference=function(e,t,n){return this.localViewReferences.addReference(n,t),this.orphanedDocuments.delete(n.toString()),q_.resolve()},ZS.prototype.removeReference=function(e,t,n){return this.localViewReferences.removeReference(n,t),this.orphanedDocuments.add(n.toString()),q_.resolve()},ZS.prototype.markPotentiallyOrphaned=function(e,t){return this.orphanedDocuments.add(t.toString()),q_.resolve()},ZS.prototype.removeTarget=function(e,t){var n=this;this.localViewReferences.removeReferencesForId(t.targetId).forEach(function(e){return n.orphanedDocuments.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.orphanedDocuments.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})},ZS.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},ZS.prototype.onTransactionCommitted=function(n){var r=this,i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q_.forEach(this.orphanedDocuments,function(e){var t=Ly.fromPath(e);return r.isReferenced(n,t).next(function(e){e||i.removeEntry(t)})}).next(function(){return r._orphanedDocuments=null,i.apply(n)})},ZS.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next(function(e){e?n.orphanedDocuments.delete(t.toString()):n.orphanedDocuments.add(t.toString())})},ZS.prototype.documentSize=function(e){return 0},ZS.prototype.isReferenced=function(e,t){var n=this;return q_.or([function(){return q_.resolve(n.localViewReferences.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)}])},ZS);function ZS(e){this.persistence=e,this.localViewReferences=new DI,this._orphanedDocuments=null}var eC=(tC.prototype.onOpen=function(e){uy(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},tC.prototype.onClose=function(e){uy(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},tC.prototype.onMessage=function(e){uy(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},tC.prototype.close=function(){this.closeFn()},tC.prototype.send=function(e){this.sendFn(e)},tC.prototype.callOnOpen=function(){uy(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},tC.prototype.callOnClose=function(e){uy(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},tC.prototype.callOnMessage=function(e){uy(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},tC);function tC(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}var nC="RestConnection",rC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},iC="gl-js/ fire/"+Zg,ge=(oC.prototype.invokeRPC=function(t,e,n,r){var i=this.makeUrl(t,e);ny(nC,"Sending: ",i,n);e={};return this.modifyHeadersForRequest(e,r),this.performRPCRequest(t,i,e,n).then(function(e){return ny(nC,"Received: ",e),e},function(e){throw iy(nC,t+" failed with error: ",e,"url: ",i,"request:",n),e})},oC.prototype.invokeStreamingRPC=function(e,t,n,r){return this.invokeRPC(e,t,n,r)},oC.prototype.modifyHeadersForRequest=function(e,t){if(e["X-Goog-Api-Client"]=iC,e["Content-Type"]="text/plain",t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},oC.prototype.makeUrl=function(e,t){var n=rC[e];return uy(void 0!==n,"Unknown REST mapping for: "+e),this.baseUrl+"/v1/"+t+":"+n},oC);function oC(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host,this.databaseRoot="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}var aC,sC="Connection",uC=(vo(cC,aC=ge),cC.prototype.performRPCRequest=function(o,t,a,s){return new Promise(function(n,r){var i=new Bg;i.listenOnce(Fg.COMPLETE,function(){try{switch(i.getLastErrorCode()){case Mg.NO_ERROR:var e=i.getResponseJson();ny(sC,"XHR received:",JSON.stringify(e)),n(e);break;case Mg.TIMEOUT:ny(sC,'RPC "'+o+'" timed out'),r(new Jg(Xg.DEADLINE_EXCEEDED,"Request time out"));break;case Mg.HTTP_ERROR:var t=i.getStatus();ny(sC,'RPC "'+o+'" failed with status:',t,"response text:",i.getResponseText()),0<t?(e=i.getResponseJson().error)&&e.status&&e.message?(t=(t=e.status).toLowerCase().replace(/_/g,"-"),t=0<=Object.values(Xg).indexOf(t)?t:Xg.UNKNOWN,r(new Jg(t,e.message))):r(new Jg(Xg.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Jg(Xg.UNAVAILABLE,"Connection failed."));break;default:ay('RPC "'+o+'" failed with unanticipated webchannel error '+i.getLastErrorCode()+": "+i.getLastError()+", giving up.")}}finally{ny(sC,'RPC "'+o+'" completed.')}});var e=JSON.stringify(s);i.send(t,"POST",e,a,15)})},cC.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new Dg,i=Lg(),e={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.modifyHeadersForRequest(e.initMessageHeaders,t),Fo()||qo()||0<=Mo().indexOf("Electron/")||(0<=(t=Mo()).indexOf("MSIE ")||0<=t.indexOf("Trident/"))||0<=Mo().indexOf("MSAppHost/")||Uo()||(e.httpHeadersOverwriteParam="$httpHeaders");n=n.join("");ny(sC,"Creating WebChannel: "+n,e);var o=r.createWebChannel(n,e),a=!1,s=!1,u=new eC({sendFn:function(e){s?ny(sC,"Not sending because WebChannel is closed:",e):(a||(ny(sC,"Opening WebChannel transport."),o.open(),a=!0),ny(sC,"WebChannel sending:",e),o.send(e))},closeFn:function(){return o.close()}}),e=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return e(o,Vg.EventType.OPEN,function(){s||ny(sC,"WebChannel transport opened.")}),e(o,Vg.EventType.CLOSE,function(){s||(s=!0,ny(sC,"WebChannel transport closed"),u.callOnClose())}),e(o,Vg.EventType.ERROR,function(e){s||(s=!0,iy(sC,"WebChannel transport errored:",e),u.callOnClose(new Jg(Xg.UNAVAILABLE,"The operation could not be completed")))}),e(o,Vg.EventType.MESSAGE,function(e){var t,n,r,i;s||(sy(!!(t=e.data[0]),"Got a webchannel message without data."),(n=t.error||(null===(i=t[0])||void 0===i?void 0:i.error))?(ny(sC,"WebChannel received error:",n),e=function(e){if(void 0!==(e=qv[e]))return Bv(e)}(r=n.status),i=n.message,void 0===e&&(e=Xg.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),s=!0,u.callOnClose(new Jg(e,i)),o.close()):(ny(sC,"WebChannel received:",t),u.callOnMessage(t)))}),e(i,Ug.STAT_EVENT,function(e){e.stat===qg?ny(sC,"Detected buffering proxy"):e.stat===jg&&ny(sC,"Detected no buffering proxy")}),setTimeout(function(){u.callOnOpen()},0),u},cC);function cC(e){var t=aC.call(this,e)||this;return t.forceLongPolling=e.forceLongPolling,t.autoDetectLongPolling=e.autoDetectLongPolling,t}var lC="ConnectivityMonitor",hC=(fC.prototype.addCallback=function(e){this.callbacks.push(e)},fC.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},fC.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},fC.prototype.onNetworkAvailable=function(){ny(lC,"Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++){(0,t[e])(0)}},fC.prototype.onNetworkUnavailable=function(){ny(lC,"Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++){(0,t[e])(1)}},fC.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fC);function fC(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}var pC=(dC.prototype.addCallback=function(e){},dC.prototype.shutdown=function(){},dC);function dC(){}function gC(e){return new ob(e,!0)}var yC=(mC.prototype.initialize=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return this.serializer=gC(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.createGarbageCollectionScheduler(t),this.localStore=this.createLocalStore(t),[2]}})})},mC.prototype.createGarbageCollectionScheduler=function(e){return null},mC.prototype.createLocalStore=function(e){return uT(this.persistence,new xS,e.initialUser,this.serializer)},mC.prototype.createPersistence=function(e){return new GS($S.factory,this.serializer)},mC.prototype.createSharedClientState=function(e){return new OS},mC.prototype.terminate=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}})})},mC);function mC(){this.synchronizeTabs=!1}var vC,bC=(vo(_C,vC=yC),_C.prototype.initialize=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,vC.prototype.initialize.call(this,t)];case 1:return e.sent(),[4,bT(this.localStore)];case 2:return e.sent(),[4,this.onlineComponentProvider.initialize(this,t)];case 3:return e.sent(),[4,cS(this.onlineComponentProvider.syncEngine)];case 4:return e.sent(),[4,$T(this.onlineComponentProvider.remoteStore)];case 5:return e.sent(),[2]}})})},_C.prototype.createLocalStore=function(e){return uT(this.persistence,new xS,e.initialUser,this.serializer)},_C.prototype.createGarbageCollectionScheduler=function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new qE(t,e.asyncQueue)},_C.prototype.createPersistence=function(e){var t=rT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?FE.withCacheSize(this.cacheSizeBytes):FE.DEFAULT;return new XE(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,aI(),sI(),this.serializer,this.sharedClientState,!!this.forceOwnership)},_C.prototype.createSharedClientState=function(e){return new OS},_C);function _C(e,t,n){var r=vC.call(this)||this;return r.onlineComponentProvider=e,r.cacheSizeBytes=t,r.forceOwnership=n,r.synchronizeTabs=!1,r}var wC,EC=(vo(TC,wC=bC),TC.prototype.initialize=function(r){return _o(this,void 0,void 0,function(){var t,n=this;return wo(this,function(e){switch(e.label){case 0:return[4,wC.prototype.initialize.call(this,r)];case 1:return(e.sent(),t=this.onlineComponentProvider.syncEngine,this.sharedClientState instanceof DS)?(this.sharedClientState.syncEngine={applyBatchState:rS.bind(null,t),applyTargetState:function(i,o,a,s){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:if((t=cy(i,VI))._isPrimaryClient)return ny(UI,"Ignoring unexpected query state notification."),[2];if(!t.queriesByTarget.has(o))return[3,7];switch(a){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,vT(t.localStore)];case 2:return n=e.sent(),r=Kv.createSynthesizedRemoteEventForCurrentChange(o,"current"===a),[4,tS(t,n,r)];case 3:return e.sent(),[3,7];case 4:return[4,gT(t.localStore,o,!0)];case 5:return e.sent(),JI(t,o,s),[3,7];case 6:ay("Unexpected target state: "+a),e.label=7;case 7:return[2]}})})}.bind(null,t),applyActiveTargetsChange:function(l,h,f){return _o(this,void 0,void 0,function(){var n,t,r,i,o,a,s,u,c;return wo(this,function(e){switch(e.label){case 0:if(!(n=uS(l))._isPrimaryClient)return[2];t=0,r=h,e.label=1;case 1:return t<r.length?(c=r[t],n.queriesByTarget.has(c)?(ny(UI,"Adding an already active target "+c),[3,5]):[4,mT(n.localStore,c)]):[3,6];case 2:return uy(!!(i=e.sent()),"Query data for active target "+c+" not found"),[4,dT(n.localStore,i)];case 3:return o=e.sent(),[4,KI(n,aS(i),o.targetId,!1)];case 4:e.sent(),VT(n.remoteStore,o),e.label=5;case 5:return t++,[3,1];case 6:a=function(t){return wo(this,function(e){switch(e.label){case 0:return n.queriesByTarget.has(t)?[4,gT(n.localStore,t,!1).then(function(){BT(n.remoteStore,t),JI(n,t)}).catch(_T)]:[2,"continue"];case 1:return e.sent(),[2]}})},s=0,u=f,e.label=7;case 7:return s<u.length?(c=u[s],[5,a(c)]):[3,10];case 8:e.sent(),e.label=9;case 9:return s++,[3,7];case 10:return[2]}})})}.bind(null,t),getActiveClients:sS.bind(null,t),synchronizeWithChangedDocuments:function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){return[2,vT((t=cy(n,VI)).localStore).then(function(e){return tS(t,e)})]})})}.bind(null,t)},[4,this.sharedClientState.start()]):[3,3];case 2:e.sent(),e.label=3;case 3:return[4,this.persistence.setPrimaryStateListener(function(t){return _o(n,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,iS(this.onlineComponentProvider.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return e.sent(),[2]}})})},TC.prototype.createSharedClientState=function(e){var t=aI();if(!DS.isAvailable(t))throw new Jg(Xg.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=rT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new DS(t,e.asyncQueue,n,e.clientId,e.initialUser)},TC);function TC(e,t){var n=wC.call(this,e,t,!1)||this;return n.onlineComponentProvider=e,n.cacheSizeBytes=t,n.synchronizeTabs=!0,n}var IC=(SC.prototype.initialize=function(n,r){return _o(this,void 0,void 0,function(){var t=this;return wo(this,function(e){switch(e.label){case 0:return this.localStore?[2]:(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return HI(t.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=nS.bind(null,this.syncEngine),[4,rI(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:return e.sent(),[2]}})})},SC.prototype.createEventManager=function(e){return new EI},SC.prototype.createDatastore=function(e){var t,n=gC(e.databaseInfo.databaseId),t=(t=e.databaseInfo,new uC(t));return e=e.credentials,new OT(e,t,n)},SC.prototype.createRemoteStore=function(e){var t,n,r,i,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return HI(o.syncEngine,e,0)},e=new(hC.isAvailable()?hC:pC),new UT(t,n,r,i,e)},SC.prototype.createSyncEngine=function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,o=this.sharedClientState,a=e.initialUser,e=e.maxConcurrentLimboResolutions,t=t,e=new VI(n,r,i,o,a,e),t&&(e._isPrimaryClient=!0),e;var n,r,i,o,a},SC.prototype.terminate=function(){return function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return t=cy(n,UT),ny(MT,"RemoteStore shutting down."),t.offlineCauses.add(5),[4,jT(t)];case 1:return e.sent(),t.connectivityMonitor.shutdown(),t.onlineStateTracker.set("Unknown"),[2]}})})}(this.remoteStore)},SC);function SC(){}var CC=(kC.prototype.next=function(e){this.observer.next&&this.scheduleEvent(this.observer.next,e)},kC.prototype.error=function(e){this.observer.error?this.scheduleEvent(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},kC.prototype.mute=function(){this.muted=!0},kC.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},kC);function kC(e){this.observer=e,this.muted=!1}var AC=(NC.prototype.lookup=function(r){return _o(this,void 0,void 0,function(){var t,n=this;return wo(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Jg(Xg.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,s){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return t=cy(a,OT),n=vb(t.serializer)+"/documents",r={documents:s.map(function(e){return db(t.serializer,e)})},[4,t.invokeStreamingRPC("BatchGetDocuments",n,r)];case 1:return r=e.sent(),i=new Map,r.forEach(function(e){e=wb(t.serializer,e);i.set(e.key.toString(),e)}),o=[],s.forEach(function(e){var t=i.get(e.toString());sy(!!t,"Missing entity in write response for "+e),o.push(t)}),[2,o]}})})}(this.datastore,r)];case 1:return(t=e.sent()).forEach(function(e){e instanceof fm||e instanceof cm?n.recordVersion(e):ay("Document in a transaction was a "+e.constructor.name)}),[2,t]}})})},NC.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e.toString())},NC.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},NC.prototype.delete=function(e){this.write([new k_(e,this.precondition(e))]),this.writtenDocs.add(e.toString())},NC.prototype.commit=function(){return _o(this,void 0,void 0,function(){var t,n=this;return wo(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(e,t){t=Ly.fromPath(t);n.mutations.push(new D_(t,n.precondition(t)))}),[4,function(i,o){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return t=cy(i,OT),n=vb(t.serializer)+"/documents",r={writes:o.map(function(e){return Tb(t.serializer,e)})},[4,t.invokeRPC("Commit",n,r)];case 1:return e.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}})})},NC.prototype.recordVersion=function(e){var t;if(e instanceof cm)t=e.version;else{if(!(e instanceof fm))throw ay("Document in a transaction was a "+e.constructor.name);t=yv.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Jg(Xg.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},NC.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?o_.updateTime(t):o_.none()},NC.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return o_.exists(!0);if(t.isEqual(yv.min()))throw new Jg(Xg.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return o_.updateTime(t)},NC.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},NC.prototype.ensureCommitNotCalled=function(){uy(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},NC);function NC(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}var DC=(RC.prototype.run=function(){this.runWithBackOff()},RC.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun(function(){return _o(e,void 0,void 0,function(){var t,n,r=this;return wo(this,function(e){return t=new AC(this.datastore),(n=this.tryRunUpdateFunction(t))&&n.then(function(e){r.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){r.deferred.resolve(e)}).catch(function(e){r.handleTransactionError(e)})})}).catch(function(e){r.handleTransactionError(e)}),[2]})})})},RC.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!Ty(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},RC.prototype.handleTransactionError=function(e){var t=this;0<this.retries&&this.isRetryableTransactionError(e)?(--this.retries,this.asyncQueue.enqueueAndForget(function(){return t.runWithBackOff(),Promise.resolve()})):this.deferred.reject(e)},RC.prototype.isRetryableTransactionError=function(e){if("FirebaseError"!==e.name)return!1;e=e.code;return"aborted"===e||"failed-precondition"===e||!Vv(e)},RC);function RC(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.retries=5,this.backoff=new wT(this.asyncQueue,"transaction_retry")}var OC="FirestoreClient",PC=(xC.prototype.getConfiguration=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return e.sent(),[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}})})},xC.prototype.setCredentialChangeListener=function(e){var t=this;this.credentialListener=e,this.receivedInitialUser.promise.then(function(){return t.credentialListener(t.user)})},xC.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Jg(Xg.FAILED_PRECONDITION,"The client has already been terminated.")},xC.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var n=new xw;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:e.sent(),e.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return t=e.sent(),t=pI(t,"Failed to shutdown persistence"),n.reject(t),[3,6];case 6:return[2]}})})}),n.promise},xC);function xC(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=Gg.UNAUTHENTICATED,this.clientId=ly.newId(),this.credentialListener=function(){},this.receivedInitialUser=new xw,this.credentials.setChangeListener(function(e){ny(OC,"Received user=",e.uid),r.user.isEqual(e)||(r.user=e,r.credentialListener(e)),r.receivedInitialUser.resolve()})}function LC(r,i){return _o(this,void 0,void 0,function(){var t,n=this;return wo(this,function(e){switch(e.label){case 0:return r.asyncQueue.verifyOperationInProgress(),ny(OC,"Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return t=e.sent(),[4,i.initialize(t)];case 2:return e.sent(),r.setCredentialChangeListener(function(t){return r.asyncQueue.enqueueRetryable(function(){return _o(n,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,cT(i.localStore,t)];case 1:return e.sent(),[2]}})})})}),i.persistence.setDatabaseDeletedListener(function(){return r.terminate()}),r.offlineComponents=i,[2]}})})}function MC(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return r.asyncQueue.verifyOperationInProgress(),[4,FC(r)];case 1:return t=e.sent(),ny(OC,"Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=e.sent(),[4,i.initialize(t,n)];case 3:return e.sent(),r.setCredentialChangeListener(function(e){return r.asyncQueue.enqueueRetryable(function(){return function(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return(t=cy(r,UT)).asyncQueue.verifyOperationInProgress(),uy(!!t.remoteSyncer.handleCredentialChange,"handleCredentialChange() not set"),ny(MT,"RemoteStore received new credentials"),n=GT(t),t.offlineCauses.add(3),[4,jT(t)];case 1:return e.sent(),n&&t.onlineStateTracker.set("Unknown"),[4,t.remoteSyncer.handleCredentialChange(i)];case 2:return e.sent(),t.offlineCauses.delete(3),[4,qT(t)];case 3:return e.sent(),[2]}})})}(i.remoteStore,e)})}),r.onlineComponents=i,[2]}})})}function FC(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(ny(OC,"Using default OfflineComponentProvider"),[4,LC(t,new yC)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function UC(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(ny(OC,"Using default OnlineComponentProvider"),[4,MC(t,new IC)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function qC(e){return FC(e).then(function(e){return e.persistence})}function jC(e){return FC(e).then(function(e){return e.localStore})}function VC(e){return UC(e).then(function(e){return e.remoteStore})}function BC(e){return UC(e).then(function(e){return e.syncEngine})}function KC(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,UC(r)];case 1:return t=e.sent(),(n=t.eventManager).onListen=function(a,s){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return(t=uS(a),o=t.queryViewsByQuery.get(s))?(n=o.targetId,t.sharedClientState.addLocalQueryTarget(n),r=o.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,dT(t.localStore,Pm(s))];case 2:return i=e.sent(),o=t.sharedClientState.addLocalQueryTarget(i.targetId),n=i.targetId,[4,KI(t,s,n,"current"===o)];case 3:r=e.sent(),t.isPrimaryClient&&VT(t.remoteStore,i),e.label=4;case 4:return[2,r]}})})}.bind(null,t.syncEngine),n.onUnlisten=function(i,o){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return(t=cy(i,VI),uy(!!(n=t.queryViewsByQuery.get(o)),"Trying to unlisten on query not found:"+Fm(o)),1<(r=t.queriesByTarget.get(n.targetId)).length)?(t.queriesByTarget.set(n.targetId,r.filter(function(e){return!Lm(e,o)})),t.queryViewsByQuery.delete(o),[2]):t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)?[3,2]:[4,gT(t.localStore,n.targetId,!1).then(function(){t.sharedClientState.clearQueryState(n.targetId),BT(t.remoteStore,n.targetId),JI(t,n.targetId)}).catch(_T)]):[3,3];case 1:e.sent(),e.label=2;case 2:return[3,5];case 3:return JI(t,n.targetId),[4,gT(t.localStore,n.targetId,!0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})}.bind(null,t.syncEngine),[2,n]}})})}function WC(r){var e=this;return r.asyncQueue.enqueue(function(){return _o(e,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,qC(r)];case 1:return t=e.sent(),[4,VC(r)];case 2:return n=e.sent(),t.setNetworkEnabled(!0),[2,((e=cy(e=n,UT)).offlineCauses.delete(0),qT(e))]}})})})}function zC(r){var e=this;return r.asyncQueue.enqueue(function(){return _o(e,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,qC(r)];case 1:return t=e.sent(),[4,VC(r)];case 2:return n=e.sent(),t.setNetworkEnabled(!1),[2,function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return(t=cy(n,UT)).offlineCauses.add(0),[4,jT(t)];case 1:return e.sent(),t.onlineStateTracker.set("Offline"),[2]}})})}(n)]}})})})}function HC(t,n){var e=this,r=new xw;return t.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,jC(t)];case 1:return[2,function(i,o,a){return _o(this,void 0,void 0,function(){var r;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(t=o,(n=cy(i,aT)).persistence.runTransaction("read document","readonly",function(e){return n.localDocuments.getDocument(e,t)}))];case 1:return(r=e.sent())instanceof cm?a.resolve(r):r instanceof fm?a.resolve(null):a.reject(new Jg(Xg.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=e.sent(),r=pI(r,"Failed to get document '"+o+" from cache"),a.reject(r),[3,3];case 3:return[2]}var t,n})})}(e.sent(),n,r)]}})})}),r.promise}function GC(u,c,l){var e=this;void 0===l&&(l={});var h=new xw;return u.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,KC(u)];case 1:return t=e.sent(),[2,(n=t,r=u.asyncQueue,i=c,o=l,a=h,e=new CC({next:function(e){r.enqueueAndForget(function(){return II(n,s)});var t=e.docs.has(i);!t&&e.fromCache?a.reject(new Jg(Xg.UNAVAILABLE,"Failed to get document because the client is offline.")):t&&e.fromCache&&o&&"server"===o.source?a.reject(new Jg(Xg.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):(uy(e.docs.size<=1,"Expected zero or a single result on a document-only query"),a.resolve(e))},error:function(e){return a.reject(e)}}),s=new CI(Sm(i.path),e,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0}),TI(n,s))]}var n,r,i,o,a,s})})}),h.promise}function QC(t,n){var e=this,r=new xw;return t.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,jC(t)];case 1:return[2,function(r,i,o){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,yT(r,i,!0)];case 1:return n=e.sent(),t=new MI(i,n.remoteKeys),n=t.computeDocChanges(n.documents),n=t.applyChanges(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=e.sent(),n=pI(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(e.sent(),n,r)]}})})}),r.promise}function YC(u,c,l){var e=this;void 0===l&&(l={});var h=new xw;return u.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){var s;return wo(this,function(e){switch(e.label){case 0:return[4,KC(u)];case 1:return s=e.sent(),[2,(t=s,n=u.asyncQueue,r=c,i=l,o=h,e=new CC({next:function(e){n.enqueueAndForget(function(){return II(t,a)}),e.fromCache&&"server"===i.source?o.reject(new Jg(Xg.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(e)},error:function(e){return o.reject(e)}}),a=new CI(r,e,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0}),TI(t,a))]}var t,n,r,i,o,a})})}),h.promise}function XC(n,e){var t=this,r=new CC(e);return n.asyncQueue.enqueueAndForget(function(){return _o(t,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,KC(n)];case 1:return t=e.sent(),[2,(e=r,cy(t,EI).snapshotsInSyncListeners.add(e),void e.next())]}})})}),function(){r.mute(),n.asyncQueue.enqueueAndForget(function(){return _o(t,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,KC(n)];case 1:return t=e.sent(),[2,(e=r,void cy(t,EI).snapshotsInSyncListeners.delete(e))]}})})})}}function JC(n,r){var e=this,i=new xw;return n.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,UC(n).then(function(e){return e.datastore})];case 1:return t=e.sent(),new DC(n.asyncQueue,t,r,i).run(),[2]}})})}),i.promise}function $C(e,t,n){if(!n)throw new Jg(Xg.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function ZC(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function ek(e,t,n,r){if(!0===t&&!0===r)throw new Jg(Xg.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function tk(e){if(!Ly.isDocumentKey(e))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function nk(e){if(Ly.isDocumentKey(e))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function rk(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":ay("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";e=function(e){if(e.constructor){e=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(e&&1<e.length)return e[1]}return null}(e);return e?"a custom "+e+" object":"an object"}function ik(e,t){if("_delegate"in e&&(e=e._delegate),e instanceof t)return e;if(t.name===e.constructor.name)throw new Jg(Xg.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");e=rk(e);throw new Jg(Xg.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+e)}function ok(e,t){if(t<=0)throw new Jg(Xg.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}function ak(e){return function(e,t){if("object"!=typeof e||null===e)return;for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return 1}return}(e,["next","error","complete"])}var sk=(Object.defineProperty(uk.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(uk.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),uk.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},uk.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},uk.prototype._compareTo=function(e){return fy(this._lat,e._lat)||fy(this._long,e._long)},uk);function uk(e,t){if(!isFinite(e)||e<-90||90<e)throw new Jg(Xg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new Jg(Xg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}var ck=(lk.fromBase64String=function(e){try{return new lk(wy.fromBase64String(e))}catch(e){throw new Jg(Xg.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},lk.fromUint8Array=function(e){return new lk(wy.fromUint8Array(e))},lk.prototype.toBase64=function(){return this._byteString.toBase64()},lk.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},lk.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},lk.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},lk);function lk(e){this._byteString=e}var hk=function(e){this._delegate=e};function fk(){if("undefined"==typeof Uint8Array)throw new Jg(Xg.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function pk(){if("undefined"==typeof atob)throw new Jg(Xg.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var dk,gk=(vo(yk,dk=hk),yk.fromBase64String=function(e){return pk(),new yk(ck.fromBase64String(e))},yk.fromUint8Array=function(e){return fk(),new yk(ck.fromUint8Array(e))},yk.prototype.toBase64=function(){return pk(),this._delegate.toBase64()},yk.prototype.toUint8Array=function(){return fk(),this._delegate.toUint8Array()},yk.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},yk.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},yk);function yk(){return null!==dk&&dk.apply(this,arguments)||this}mk.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),Wy(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $y(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zy(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ay("Invalid value type: "+JSON.stringify(e))}},mk.prototype.convertObject=function(e,n){var r=this,i={};return by(e.fields||{},function(e,t){i[e]=r.convertValue(t,n)}),i},mk.prototype.convertGeoPoint=function(e){return new sk($y(e.latitude),$y(e.longitude))},mk.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})},mk.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=function e(t){t=t.mapValue.fields[qy];return Vy(t)?e(t):t}(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(By(e));default:return null}},mk.prototype.convertTimestamp=function(e){e=Jy(e);return new yy(e.seconds,e.nanos)},mk.prototype.convertDocumentKey=function(e,t){var n=Ny.fromString(e);sy(Lb(n),"ReferenceValue is not valid "+e);e=new zg(n.get(1),n.get(3)),n=new Ly(n.popFirst(5));return e.isEqual(t)||ry("Document "+n+" contains a document reference within a different database ("+e.projectId+"/"+e.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),n},de=mk;function mk(){}var vk,bk=(vo(_k,vk=de),_k.prototype.convertBytes=function(e){return new gk(new ck(e))},_k.prototype.convertReference=function(e){e=this.convertDocumentKey(e,this.firestore._databaseId);return oD.forKey(e,this.firestore,null)},_k);function _k(e){var t=vk.call(this)||this;return t.firestore=e,t}var wk=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},Ek=(Tk.prototype.getToken=function(){return Promise.resolve(null)},Tk.prototype.invalidateToken=function(){},Tk.prototype.setChangeListener=function(e){uy(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=e)(Gg.UNAUTHENTICATED)},Tk.prototype.removeChangeListener=function(){this.changeListener=null},Tk);function Tk(){this.changeListener=null}var Ik=(Sk.prototype.getToken=function(){var t=this;uy(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.tokenCounter,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(function(e){return t.tokenCounter!==n?(ny("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):e?(sy("string"==typeof e.accessToken,"Invalid tokenData returned from getToken():"+e),new wk(e.accessToken,t.currentUser)):null}):Promise.resolve(null)},Sk.prototype.invalidateToken=function(){this.forceRefresh=!0},Sk.prototype.setChangeListener=function(e){uy(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},Sk.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},Sk.prototype.getUser=function(){var e=this.auth&&this.auth.getUid();return sy(null===e||"string"==typeof e,"Received invalid UID: "+e),new Gg(e)},Sk);function Sk(e){var t=this;this.tokenListener=null,this.currentUser=Gg.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),e.get().then(function(e){t.auth=e,t.tokenListener&&t.auth.addAuthTokenListener(t.tokenListener)},function(){}))}var Ck=(Object.defineProperty(kk.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!1,configurable:!0}),kk);function kk(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=Gg.FIRST_PARTY}var Ak=(Nk.prototype.getToken=function(){return Promise.resolve(new Ck(this.gapi,this.sessionIndex))},Nk.prototype.setChangeListener=function(e){e(Gg.FIRST_PARTY)},Nk.prototype.removeChangeListener=function(){},Nk.prototype.invalidateToken=function(){},Nk);function Nk(e,t){this.gapi=e,this.sessionIndex=t}var Dk=new Map;var Rk=(Ok.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties},Ok);function Ok(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Jg(Xg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Jg(Xg.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,ek("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}var Pk=(Object.defineProperty(xk.prototype,"app",{get:function(){if(!this._app)throw new Jg(Xg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(xk.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(xk.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),xk.prototype._setSettings=function(e){if(this._settingsFrozen)throw new Jg(Xg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rk(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new Ek;switch(e.type){case"gapi":var t=e.client;return sy(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Ak(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new Jg(Xg.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},xk.prototype._getSettings=function(){return this._settings},xk.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},xk.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},xk.prototype._terminate=function(){var e,t;return e=this,(t=Dk.get(e))&&(ny("ComponentProvider","Removing Datastore"),Dk.delete(e),t.terminate()),Promise.resolve()},xk);function xk(e,t){this._persistenceKey="(lite)",this._settings=new Rk({}),this._settingsFrozen=!1,e instanceof zg?(this._databaseId=e,this._credentials=new Ek):(this._app=e,this._databaseId=function(e){if(Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))return new zg(e.options.projectId);throw new Jg(Xg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}(e),this._credentials=new Ik(t))}var Lk,Mk=11,Fk=20,Uk=22,qk=(vo(jk,Lk=Pk),jk.prototype._terminate=function(){return this._firestoreClient||JN(this),this._firestoreClient.terminate()},jk);function jk(e,t){t=Lk.call(this,e,t)||this;return t._queue=new hI,t._persistenceKey="name"in e?e.name:"[DEFAULT]",t}function Vk(n,r,i){var e=this,o=new xw;return n.asyncQueue.enqueue(function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,LC(n,i)];case 1:return e.sent(),[4,MC(n,r)];case 2:return e.sent(),o.resolve(),[3,4];case 3:if(!function(e){{if("FirebaseError"===e.name)return e.code===Xg.FAILED_PRECONDITION||e.code===Xg.UNIMPLEMENTED;if("undefined"!=typeof DOMException&&e instanceof DOMException)return e.code===Uk||e.code===Fk||e.code===Mk}return!0}(t=e.sent()))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),o.reject(t),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Bk(n){var e=this;if(n._initialized&&!n._terminated)throw new Jg(Xg.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new xw;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return _o(e,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return Mw.isAvailable()?(t=n+GE,[4,Mw.delete(t)]):[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(rT(n._databaseId,n._persistenceKey))];case 1:return e.sent(),r.resolve(),[3,3];case 2:return t=e.sent(),r.reject(t),[3,3];case 3:return[2]}})})}),r.promise}function Kk(e){return function(t){var e=this,n=new xw;return t.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,BC(t)];case 1:return[2,QI(e.sent(),n)]}})})}),n.promise}(XN(e=ik(e,qk)))}function Wk(e){if(e._initialized||e._terminated)throw new Jg(Xg.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var zk=function(e){this._methodName=e};var Hk,Gk=(vo(Qk,Hk=zk),Qk.prototype._toFieldTransform=function(e){if(2!==e.dataSource)throw 1===e.dataSource?(uy(0<e.path.length,this._methodName+"() at the top level should have already been handled."),e.createError(this._methodName+"() can only appear at the top level of your update data")):e.createError(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},Qk.prototype.isEqual=function(e){return e instanceof Qk},Qk);function Qk(){return null!==Hk&&Hk.apply(this,arguments)||this}function Yk(e,t,n){return new yA({dataSource:3,targetDoc:t.settings.targetDoc,methodName:e._methodName,arrayElement:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var Xk,Jk=(vo($k,Xk=zk),$k.prototype._toFieldTransform=function(e){return new n_(e.path,new qb)},$k.prototype.isEqual=function(e){return e instanceof $k},$k);function $k(){return null!==Xk&&Xk.apply(this,arguments)||this}var Zk,eA=(vo(tA,Zk=zk),tA.prototype._toFieldTransform=function(e){var t=Yk(this,e,!0),n=this._elements.map(function(e){return IA(e,t)}),n=new Bb(n);return new n_(e.path,n)},tA.prototype.isEqual=function(e){return this===e},tA);function tA(e,t){e=Zk.call(this,e)||this;return e._elements=t,e}var nA,rA=(vo(iA,nA=zk),iA.prototype._toFieldTransform=function(e){var t=Yk(this,e,!0),n=this._elements.map(function(e){return IA(e,t)}),n=new Hb(n);return new n_(e.path,n)},iA.prototype.isEqual=function(e){return this===e},iA);function iA(e,t){e=nA.call(this,e)||this;return e._elements=t,e}var oA,aA=(vo(sA,oA=zk),sA.prototype._toFieldTransform=function(e){var t=new Xb(e.serializer,ub(e.serializer,this._operand));return new n_(e.path,t)},sA.prototype.isEqual=function(e){return this===e},sA);function sA(e,t){e=oA.call(this,e)||this;return e._operand=t,e}var uA=(cA.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},cA);function cA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Py(e)}var lA=/^__.*__$/,hA=(fA.prototype.toMutations=function(e,t){var n=[];return null!==this.fieldMask?n.push(new v_(e,this.data,this.fieldMask,t)):n.push(new g_(e,this.data,t)),0<this.fieldTransforms.length&&n.push(new E_(e,this.fieldTransforms)),n},fA);function fA(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}var pA=(dA.prototype.toMutations=function(e,t){t=[new v_(e,this.data,this.fieldMask,t)];return 0<this.fieldTransforms.length&&t.push(new E_(e,this.fieldTransforms)),t},dA);function dA(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}function gA(e){switch(e){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw ay("Unexpected case for UserDataSource: "+e)}}var yA=(Object.defineProperty(mA.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(mA.prototype,"dataSource",{get:function(){return this.settings.dataSource},enumerable:!1,configurable:!0}),mA.prototype.contextWith=function(e){return new mA(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},mA.prototype.childContextForField=function(e){var t=null===(t=this.path)||void 0===t?void 0:t.child(e),t=this.contextWith({path:t,arrayElement:!1});return t.validatePathSegment(e),t},mA.prototype.childContextForFieldPath=function(e){var t,e=null===(t=this.path)||void 0===t?void 0:t.child(e),e=this.contextWith({path:e,arrayElement:!1});return e.validatePath(),e},mA.prototype.childContextForArray=function(e){return this.contextWith({path:void 0,arrayElement:!0})},mA.prototype.createError=function(e){return RA(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)},mA.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},mA.prototype.validatePath=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},mA.prototype.validatePathSegment=function(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(gA(this.dataSource)&&lA.test(e))throw this.createError('Document fields cannot begin and end with "__"')},mA);function mA(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}var vA=(bA.prototype.createContext=function(e,t,n,r){return void 0===r&&(r=!1),new yA({dataSource:e,methodName:t,targetDoc:n,path:Py.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)},bA);function bA(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||gC(e)}function _A(e,t,n,r,i,o){void 0===o&&(o={});var a=e.createContext(o.merge||o.mergeFields?2:0,t,n,i);kA("Data must be an object, but it was:",a,r);var s,u,r=SA(r,a);if(o.merge)s=new e_(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,h=o.mergeFields;l<h.length;l++){var f=AA(t,h[l],n);if(!a.contains(f))throw new Jg(Xg.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");OA(c,f)||c.push(f)}s=new e_(c),u=a.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=a.fieldTransforms;return new hA(new Lv(r),s,u)}function wA(e,r,i,t){var o=e.createContext(1,r,i);kA("Data must be an object, but it was:",o,t);var a=[],s=new Fv;by(t,function(e,t){var n=DA(r,e,i);t instanceof hk&&(t=t._delegate);e=o.childContextForFieldPath(n);t instanceof Gk?a.push(n):null!=(e=IA(t,e))&&(a.push(n),s.set(n,e))});t=new e_(a);return new pA(s.build(),t,o.fieldTransforms)}function EA(e,t,n,r,i,o){var a=e.createContext(1,t,n),s=[AA(t,r,n)],u=[i];if(o.length%2!=0)throw new Jg(Xg.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(AA(t,o[c])),u.push(o[c+1]);for(var l,h,f,p=[],d=new Fv,c=s.length-1;0<=c;--c){OA(p,s[c])||(l=s[c],(h=u[c])instanceof hk&&(h=h._delegate),f=a.childContextForFieldPath(l),h instanceof Gk?p.push(l):null!=(f=IA(h,f))&&(p.push(l),d.set(l,f)))}i=new e_(p);return new pA(d.build(),i,a.fieldTransforms)}function TA(e,t,n,r){void 0===r&&(r=!1);t=e.createContext(r?4:3,t),n=IA(n,t);return uy(null!=n,"Parsed data should not be null."),uy(0===t.fieldTransforms.length,"Field transforms should have been disallowed."),n}function IA(e,t){if(e instanceof hk&&(e=e._delegate),CA(e))return kA("Unsupported field value:",t,e),SA(e,t);if(e instanceof zk)return function(e,t){if(!gA(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");e=e._toFieldTransform(t);e&&t.fieldTransforms.push(e)}(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=IA(o[i],t.childContextForArray(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){e instanceof hk&&(e=e._delegate);{if(null===e)return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ub(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=yy.fromDate(e);return{timestampValue:cb(t.serializer,n)}}if(e instanceof yy){n=new yy(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:cb(t.serializer,n)}}if(e instanceof sk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ck)return{bytesValue:lb(t.serializer,e._byteString)};if(e instanceof jA){var r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError("Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:fb(e.firestore._databaseId||t.databaseId,e._key.path)}}if(void 0===e&&t.ignoreUndefinedProperties)return null;throw t.createError("Unsupported field value: "+rk(e))}}(e,t)}function SA(e,n){var r={};return _y(e)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):by(e,function(e,t){t=IA(t,n.childContextForField(e));null!=t&&(r[e]=t)}),{mapValue:{fields:r}}}function CA(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof yy||e instanceof sk||e instanceof ck||e instanceof jA||e instanceof zk)}function kA(e,t,n){if(!CA(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=rk(n);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}var r}function AA(e,t,n){if(t instanceof hk&&(t=t._delegate),t instanceof uA)return t._internalPath;if("string"==typeof t)return DA(e,t);throw RA("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var NA=new RegExp("[~\\*/\\[\\]]");function DA(t,n,r){if(0<=n.search(NA))throw RA("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,r);try{return(new(uA.bind.apply(uA,So([void 0],n.split(".")))))._internalPath}catch(e){throw RA("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,r)}}function RA(e,t,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,t="Function "+t+"() called with invalid data";n&&(t+=" (via `toFirestore()`)"),t+=". ";n="";return(o||a)&&(n+=" (found",o&&(n+=" in field "+r),a&&(n+=" in document "+i),n+=")"),new Jg(Xg.INVALID_ARGUMENT,t+e+n)}function OA(e,t){return e.some(function(e){return e.isEqual(t)})}var PA,xA=(vo(LA,PA=de),LA.prototype.convertBytes=function(e){return new ck(e)},LA.prototype.convertReference=function(e){e=this.convertDocumentKey(e,this.firestore._databaseId);return new jA(this.firestore,null,e)},LA);function LA(e){var t=PA.call(this)||this;return t.firestore=e,t}function MA(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=ik(e,jA);var o=ik(e.firestore,qk),a=EN(o);return t instanceof hk&&(t=t._delegate),UA(o,("string"==typeof t||t instanceof uA?EA(a,"updateDoc",e._key,t,n,r):wA(a,"updateDoc",e._key,t)).toMutations(e._key,o_.exists(!0)))}function FA(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];t instanceof hk&&(t=t._delegate);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ak(n[i])||(r=n[i],i++);var o,a,s,u,c,l,h={includeMetadataChanges:r.includeMetadataChanges};return ak(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),t instanceof jA?(s=ik(t.firestore,qk),u=Sm(t._key.path),l={next:function(e){n[i]&&n[i](qA(s,t,e))},error:n[i+1],complete:n[i+2]}):(a=ik(t,BA),s=ik(a.firestore,qk),u=a._query,c=new xA(s),l={next:function(e){n[i]&&n[i](new LN(s,c,a,e))},error:n[i+1],complete:n[i+2]},lN(t._query)),function(t,e,n,r){var i=this,o=new CC(r),a=new CI(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return _o(i,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,KC(t)];case 1:return[2,TI(e.sent(),a)]}})})}),function(){o.mute(),t.asyncQueue.enqueueAndForget(function(){return _o(i,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,KC(t)];case 1:return[2,II(e.sent(),a)]}})})})}}(XN(s),u,h,l)}function UA(e,t){return function(t,n){var e=this,r=new xw;return t.asyncQueue.enqueueAndForget(function(){return _o(e,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,BC(t)];case 1:return[2,WI(e.sent(),n,r)]}})})}),r.promise}(XN(e),t)}function qA(e,t,n){uy(n.docs.size<=1,"Expected zero or a single result on a document-only query");var r=n.docs.get(t._key),i=new xA(e);return new DN(e,i,t._key,r,new lD(n.hasPendingWrites,n.fromCache),t._converter)}var jA=(Object.defineProperty(VA.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(VA.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(VA.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(VA.prototype,"parent",{get:function(){return new fN(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),VA.prototype.withConverter=function(e){return new VA(this.firestore,e,this._key)},VA);function VA(e,t,n){this._converter=t,this._key=n,this.type="document",this.firestore=e}var BA=(KA.prototype.withConverter=function(e){return new KA(this.firestore,e,this._query)},KA);function KA(e,t,n){this._converter=t,this._query=n,this.type="query",this.firestore=e}ge=function(){};function WA(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){e=i[r]._apply(e)}return e}var zA,HA=(vo(GA,zA=ge),GA.prototype._apply=function(e){var t=EN(e.firestore),t=function(e,t,n,r,i,o,a){if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){uN(a,o);for(var s=[],u=0,c=a;u<c.length;u++){var l=c[u];s.push(sN(r,e,l))}h={arrayValue:{values:s}}}else h=sN(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||uN(a,o),h=TA(n,t,a,"in"===o||"not-in"===o);var h=Vm.create(i,o,h);return function(e,t){if(uy(t instanceof Vm,"Only FieldFilters are supported"),t.isInequality()){var n=Nm(e);if(null!==n&&!n.isEqual(t.field))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");n=Am(e);null!==n&&cN(0,t.field,n)}e=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(uy(i instanceof Vm,"Only FieldFilters are supported"),0<=t.indexOf(i.op))return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==e)throw e===t.op?new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+e.toString()+"' filters.")}(e,h),h}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return new BA(e.firestore,e._converter,(e=e._query,t=t,uy(null==Nm(e)||!(t instanceof Vm)||!t.isInequality()||t.field.isEqual(Nm(e)),"Query must only have one inequality field."),uy(!Dm(e),"No filtering allowed for document query"),t=e.filters.concat([t]),new Tm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),t,e.limit,e.limitType,e.startAt,e.endAt)))},GA);function GA(e,t,n){var r=zA.call(this)||this;return r._field=e,r._op=t,r._value=n,r.type="where",r}var QA,YA=(vo(XA,QA=ge),XA.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");n=new gv(t,n);return function(e,t){{var n;null!==Am(e)||null!==(n=Nm(e))&&cN(0,n,t.field)}}(e,n),n}(e._query,this._field,this._direction);return new BA(e.firestore,e._converter,(e=e._query,t=t,uy(!e.startAt&&!e.endAt,"Bounds must be set after orderBy"),t=e.explicitOrderBy.concat([t]),new Tm(e.path,e.collectionGroup,t,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},XA);function XA(e,t){var n=QA.call(this)||this;return n._field=e,n._direction=t,n.type="orderBy",n}var JA,$A=(vo(ZA,JA=ge),ZA.prototype._apply=function(e){return new BA(e.firestore,e._converter,xm(e._query,this._limit,this._limitType))},ZA);function ZA(e,t,n){var r=JA.call(this)||this;return r.type=e,r._limit=t,r._limitType=n,r}var eN,tN=(vo(nN,eN=ge),nN.prototype._apply=function(e){var t=aN(e,this.type,this._docOrFields,this._before);return new BA(e.firestore,e._converter,(e=e._query,t=t,new Tm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)))},nN);function nN(e,t,n){var r=eN.call(this)||this;return r.type=e,r._docOrFields=t,r._before=n,r}var rN,iN=(vo(oN,rN=ge),oN.prototype._apply=function(e){var t=aN(e,this.type,this._docOrFields,this._before);return new BA(e.firestore,e._converter,(e=e._query,t=t,new Tm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)))},oN);function oN(e,t,n){var r=rN.call(this)||this;return r.type=e,r._docOrFields=t,r._before=n,r}function aN(e,t,n,r){if(n[0]instanceof hk&&(n[0]=n[0]._delegate),n[0]instanceof TN)return function(e,t,n,r,i){if(!r)throw new Jg(Xg.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Om(e);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(em(t,r.key));else{var c=r.field(u.field);if(Vy(c))throw new Jg(Xg.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){u=u.field.canonicalString();throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}o.push(c)}}return new hv(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=EN(e.firestore);return function(e,t,n,r,i,o){var a=e.explicitOrderBy;if(i.length>a.length)throw new Jg(Xg.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Rm(e)&&-1!==c.indexOf("/"))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=e.path.child(Ny.fromString(c));if(!Ly.isDocumentKey(l))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");l=new Ly(l);s.push(em(t,l))}else{c=TA(n,r,c);s.push(c)}}return new hv(s,o)}(e._query,e.firestore._databaseId,i,t,n,r)}function sN(e,t,n){if(n instanceof hk&&(n=n._delegate),"string"==typeof n){if(""===n)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rm(t)&&-1!==n.indexOf("/"))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");t=t.path.child(Ny.fromString(n));if(!Ly.isDocumentKey(t))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return em(e,new Ly(t))}if(n instanceof jA)return em(e,n._key);throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+rk(n)+".")}function uN(e,t){if(!Array.isArray(e)||0===e.length)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(10<e.length)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function cN(e,t,n){if(!n.isEqual(t))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function lN(e){if(km(e)&&0===e.explicitOrderBy.length)throw new Jg(Xg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var hN,fN=(vo(pN,hN=BA),Object.defineProperty(pN.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(pN.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(pN.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new jA(this.firestore,null,new Ly(e))},enumerable:!1,configurable:!0}),pN.prototype.withConverter=function(e){return new pN(this.firestore,e,this._path)},pN);function pN(e,t,n){t=hN.call(this,e,t,Sm(n))||this;return t.firestore=e,t._path=n,t.type="collection",t}function dN(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof hk&&(e=e._delegate),$C("collection","path",t),e instanceof Pk)return nk(n=Ny.fromString.apply(Ny,So([t],r))),new fN(e,null,n);if(!(e instanceof jA||e instanceof fN))throw new Jg(Xg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return nk(n=Ny.fromString.apply(Ny,So([e.path],r)).child(Ny.fromString(t))),new fN(e.firestore,null,n)}function gN(e,t){if(e=ik(e,Pk),$C("collectionGroup","collection id",t),0<=t.indexOf("/"))throw new Jg(Xg.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new BA(e,null,(t=t,new Tm(Ny.emptyPath(),t)))}function yN(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof hk&&(e=e._delegate),1===arguments.length&&(t=ly.newId()),$C("doc","path",t),e instanceof Pk)return tk(n=Ny.fromString.apply(Ny,So([t],r))),new jA(e,null,new Ly(n));if(!(e instanceof jA||e instanceof fN))throw new Jg(Xg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tk(n=e._path.child(Ny.fromString.apply(Ny,So([t],r)))),new jA(e.firestore,e instanceof fN?e._converter:null,new Ly(n))}var mN,vN=(vo(bN,mN=de),bN.prototype.convertBytes=function(e){return new ck(e)},bN.prototype.convertReference=function(e){e=this.convertDocumentKey(e,this.firestore._databaseId);return new jA(this.firestore,null,e)},bN);function bN(e){var t=mN.call(this)||this;return t.firestore=e,t}function _N(e,t){return e instanceof hk&&(e=e._delegate),t instanceof hk&&(t=t._delegate),(e instanceof jA||e instanceof fN)&&(t instanceof jA||t instanceof fN)&&(e.firestore===t.firestore&&e.path===t.path&&e._converter===t._converter)}function wN(e,t){return e instanceof hk&&(e=e._delegate),t instanceof hk&&(t=t._delegate),e instanceof BA&&t instanceof BA&&(e.firestore===t.firestore&&Lm(e._query,t._query)&&e._converter===t._converter)}function EN(e){var t=e._freezeSettings(),n=gC(e._databaseId);return new vA(e._databaseId,!!t.ignoreUndefinedProperties,n)}var TN=(Object.defineProperty(IN.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(IN.prototype,"ref",{get:function(){return new jA(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),IN.prototype.exists=function(){return null!==this._document},IN.prototype.data=function(){if(this._document){if(this._converter){var e=new CN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.toProto())}},IN.prototype.get=function(e){if(this._document){e=this._document.data().field(AN("DocumentSnapshot.get",e));if(null!==e)return this._userDataWriter.convertValue(e)}},IN);function IN(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}var SN,CN=(vo(kN,SN=TN),kN.prototype.data=function(){return SN.prototype.data.call(this)},kN);function kN(){return null!==SN&&SN.apply(this,arguments)||this}function AN(e,t){return"string"==typeof t?DA(e,t):(t instanceof hk?t._delegate:t)._internalPath}var NN,DN=(vo(RN,NN=TN),RN.prototype.exists=function(){return NN.prototype.exists.call(this)},RN.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new PN(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.toProto(),e.serverTimestamps)}},RN.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document){e=this._document.data().field(AN("DocumentSnapshot.get",e));if(null!==e)return this._userDataWriter.convertValue(e,t.serverTimestamps)}},RN);function RN(e,t,n,r,i,o){o=NN.call(this,e,t,n,r,o)||this;return o._firestore=e,o._firestoreImpl=e,o.metadata=i,o}var ON,PN=(vo(xN,ON=DN),xN.prototype.data=function(e){return void 0===e&&(e={}),ON.prototype.data.call(this,e)},xN);function xN(){return null!==ON&&ON.apply(this,arguments)||this}var LN=(Object.defineProperty(MN.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(MN.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(MN.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),MN.prototype.forEach=function(t,n){var r=this;this._snapshot.docs.forEach(function(e){t.call(n,new PN(r._firestore,r._userDataWriter,e.key,e,new lD(r._snapshot.mutatedKeys.has(e.key),r._snapshot.fromCache),r.query._converter))})},MN.prototype.docChanges=function(e){void 0===e&&(e={});e=!!e.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Jg(Xg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,t){{if(i._snapshot.oldDocs.isEmpty()){var n,r=0;return i._snapshot.docChanges.map(function(e){uy(0===e.type,"Invalid event type for first snapshot"),uy(!n||qm(i._snapshot.query)(n,e.doc)<0,"Got added events in wrong order");var t=new PN(i._firestore,i._userDataWriter,e.doc.key,e.doc,new lD(i._snapshot.mutatedKeys.has(e.doc.key),i._snapshot.fromCache),i.query._converter);return n=e.doc,{type:"added",doc:t,oldIndex:-1,newIndex:r++}})}var o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(e){var t=new PN(i._firestore,i._userDataWriter,e.doc.key,e.doc,new lD(i._snapshot.mutatedKeys.has(e.doc.key),i._snapshot.fromCache),i.query._converter),n=-1,r=-1;return 0!==e.type&&(uy(0<=(n=o.indexOf(e.doc.key)),"Index for document not found"),o=o.delete(e.doc.key)),1!==e.type&&(r=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ay("Unknown change type: "+e)}}(e.type),doc:t,oldIndex:n,newIndex:r}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},MN);function MN(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new lD(r.hasPendingWrites,r.fromCache),this.query=n}function FN(e,t){return e instanceof DN&&t instanceof DN?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof LN&&t instanceof LN&&(e._firestore===t._firestore&&wN(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot))}var UN=(qN.prototype.set=function(e,t,n){this._verifyNotCommitted();e=jN(e,this._firestore),t=RD(e._converter,t,n),n=_A(this._dataReader,"WriteBatch.set",e._key,t,null!==e._converter,n);return this._mutations=this._mutations.concat(n.toMutations(e._key,o_.none())),this},qN.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();e=jN(e,this._firestore);return t instanceof hk&&(t=t._delegate),t="string"==typeof t||t instanceof uA?EA(this._dataReader,"WriteBatch.update",e._key,t,n,r):wA(this._dataReader,"WriteBatch.update",e._key,t),this._mutations=this._mutations.concat(t.toMutations(e._key,o_.exists(!0))),this},qN.prototype.delete=function(e){this._verifyNotCommitted();e=jN(e,this._firestore);return this._mutations=this._mutations.concat(new k_(e._key,o_.none())),this},qN.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},qN.prototype._verifyNotCommitted=function(){if(this._committed)throw new Jg(Xg.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},qN);function qN(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=EN(e)}function jN(e,t){if(e instanceof hk&&(e=e._delegate),e.firestore!==t)throw new Jg(Xg.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}VN.prototype.get=function(e){var t=this,n=jN(e,this._firestore),r=new vN(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return ay("Mismatch in docs returned from document lookup.");e=e[0];if(e instanceof fm)return new TN(t._firestore,r,n._key,null,n._converter);if(e instanceof cm)return new TN(t._firestore,r,e.key,e,n._converter);throw ay("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},VN.prototype.set=function(e,t,n){e=jN(e,this._firestore),t=RD(e._converter,t,n),n=_A(this._dataReader,"Transaction.set",e._key,t,null!==e._converter,n);return this._transaction.set(e._key,n),this},VN.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=jN(e,this._firestore);return t instanceof hk&&(t=t._delegate),t="string"==typeof t||t instanceof uA?EA(this._dataReader,"Transaction.update",e._key,t,n,r):wA(this._dataReader,"Transaction.update",e._key,t),this._transaction.update(e._key,t),this},VN.prototype.delete=function(e){e=jN(e,this._firestore);return this._transaction.delete(e._key),this},ge=VN;function VN(e,t){this._firestore=e,this._transaction=t,this._dataReader=EN(e)}var BN,KN=(vo(WN,BN=ge),WN.prototype.get=function(e){var t=this,n=jN(e,this._firestore),r=new xA(this._firestore);return BN.prototype.get.call(this,e).then(function(e){return new DN(t._firestore,r,n._key,e._document,new lD(!1,!1),n._converter)})},WN);function WN(e,t){t=BN.call(this,e,t)||this;return t._firestore=e,t}var zN=(HN.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){Wk(e=ik(e,qk));var n=XN(e),r=e._freezeSettings(),e=new IC;return Vk(n,e,new bC(e,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},HN.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){Wk(e=ik(e,qk));var t=XN(e),n=e._freezeSettings(),e=new IC;return Vk(t,e,new EC(e,n.cacheSizeBytes))}(e._delegate)},HN.prototype.clearIndexedDbPersistence=function(e){return Bk(e._delegate)},HN);function HN(){}var GN,QN=(vo(YN,GN=hk),Object.defineProperty(YN.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),YN.prototype.settings=function(e){e.merge&&delete(e=Object.assign(Object.assign({},this._delegate._getSettings()),e)).merge,this._delegate._setSettings(e)},YN.prototype.useEmulator=function(e,t){"firestore.googleapis.com"!==this._delegate._getSettings().host&&iy("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:e+":"+t,ssl:!1,merge:!0})},YN.prototype.enableNetwork=function(){return WC(XN(ik(this._delegate,qk)))},YN.prototype.disableNetwork=function(){return zC(XN(ik(this._delegate,qk)))},YN.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&ek("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)},YN.prototype.clearPersistence=function(){return this._persistenceProvider.clearIndexedDbPersistence(this)},YN.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._delegate._delete()},YN.prototype.waitForPendingWrites=function(){return Kk(this._delegate)},YN.prototype.onSnapshotsInSync=function(e){return t=this._delegate,e=e,XC(XN(t=ik(t,qk)),ak(e)?e:{next:e});var t},Object.defineProperty(YN.prototype,"app",{get:function(){if(!this._appCompat)throw new Jg(Xg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat},enumerable:!1,configurable:!0}),YN.prototype.collection=function(e){try{return new AD(this,dN(this._delegate,e))}catch(e){throw sD(e,"collection()","Firestore.collection()")}},YN.prototype.doc=function(e){try{return new oD(this,yN(this._delegate,e))}catch(e){throw sD(e,"doc()","Firestore.doc()")}},YN.prototype.collectionGroup=function(e){try{return new bD(this,gN(this._delegate,e))}catch(e){throw sD(e,"collectionGroup()","Firestore.collectionGroup()")}},YN.prototype.runTransaction=function(t){var n,r,i=this;return n=this._delegate,r=function(e){return t(new ZN(i,e))},JC(XN(n),function(e){return r(new KN(n,e))})},YN.prototype.batch=function(){var t=this;return XN(this._delegate),new nD(new UN(this._delegate,function(e){return UA(t._delegate,e)}))},YN);function YN(e,t,n){var r=GN.call(this,t)||this;return r._persistenceProvider=n,r.INTERNAL={delete:function(){return r.terminate()}},e instanceof zg||(r._appCompat=e),r}function XN(e){return e._firestoreClient||JN(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function JN(e){var t=e._freezeSettings();uy(!!t.host,"FirestoreSettings.host is not set"),uy(!e._firestoreClient,"configureFirestore() called multiple times");var n,r,t=(n=e._databaseId,r=e._persistenceKey,new Kg(n,r,(t=t).host,t.ssl,t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling));e._firestoreClient=new PC(e._credentials,e._queue,t)}var $N,ZN=(vo(eD,$N=hk),eD.prototype.get=function(e){var t=this,e=DD(e);return this._delegate.get(e).then(function(e){return new pD(t._firestore,e)})},eD.prototype.set=function(e,t,n){e=DD(e);return n?(ZC("Transaction.set",n),this._delegate.set(e,t,n)):this._delegate.set(e,t),this},eD.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=DD(e);return 2===arguments.length?this._delegate.update(o,t):(e=this._delegate).update.apply(e,So([o,t,n],r)),this},eD.prototype.delete=function(e){e=DD(e);return this._delegate.delete(e),this},eD);function eD(e,t){t=$N.call(this,t)||this;return t._firestore=e,t}var tD,nD=(vo(rD,tD=hk),rD.prototype.set=function(e,t,n){e=DD(e);return n?(ZC("WriteBatch.set",n),this._delegate.set(e,t,n)):this._delegate.set(e,t),this},rD.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=DD(e);return 2===arguments.length?this._delegate.update(o,t):(e=this._delegate).update.apply(e,So([o,t,n],r)),this},rD.prototype.delete=function(e){e=DD(e);return this._delegate.delete(e),this},rD.prototype.commit=function(){return this._delegate.commit()},rD);function rD(){return null!==tD&&tD.apply(this,arguments)||this}var iD,oD=(vo(aD,iD=hk),aD.forPath=function(e,t,n){if(e.length%2!=0)throw new Jg(Xg.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new aD(t,new jA(t._delegate,n,new Ly(e)))},aD.forKey=function(e,t,n){return new aD(t,new jA(t._delegate,n,e))},Object.defineProperty(aD.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(aD.prototype,"parent",{get:function(){return new AD(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(aD.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),aD.prototype.collection=function(e){try{return new AD(this.firestore,dN(this._delegate,e))}catch(e){throw sD(e,"collection()","DocumentReference.collection()")}},aD.prototype.isEqual=function(e){return e instanceof hk&&(e=e._delegate),e instanceof jA&&_N(this._delegate,e)},aD.prototype.set=function(e,t){t=ZC("DocumentReference.set",t);try{return function(e,t,n){e=ik(e,jA);var r=ik(e.firestore,qk),t=RD(e._converter,t,n);return UA(r,_A(EN(r),"setDoc",e._key,t,null!==e._converter,n).toMutations(e._key,o_.none()))}(this._delegate,e,t)}catch(e){throw sD(e,"setDoc()","DocumentReference.set()")}},aD.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?MA(this._delegate,e):MA.apply(void 0,So([this._delegate,e,t],n))}catch(e){throw sD(e,"updateDoc()","DocumentReference.update()")}},aD.prototype.delete=function(){return UA(ik((e=this._delegate).firestore,qk),[new k_(e._key,o_.none())]);var e},aD.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=uD(e),i=cD(e,function(e){return new pD(t.firestore,new DN(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))});return FA(this._delegate,r,i)},aD.prototype.get=function(e){var t=this,e=("cache"===(null==e?void 0:e.source)?function(t){t=ik(t,jA);var n=ik(t.firestore,qk),e=XN(n),r=new xA(n);return HC(e,t._key).then(function(e){return new DN(n,r,t._key,e,new lD(e instanceof cm&&e.hasLocalMutations,!0),t._converter)})}:"server"===(null==e?void 0:e.source)?function(t){t=ik(t,jA);var n=ik(t.firestore,qk);return GC(XN(n),t._key,{source:"server"}).then(function(e){return qA(n,t,e)})}:function(t){t=ik(t,jA);var n=ik(t.firestore,qk);return GC(XN(n),t._key).then(function(e){return qA(n,t,e)})})(this._delegate);return e.then(function(e){return new pD(t.firestore,new DN(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))})},aD.prototype.withConverter=function(e){return new aD(this.firestore,this._delegate.withConverter(e))},aD);function aD(e,t){t=iD.call(this,t)||this;return t.firestore=e,t._userDataWriter=new bk(e),t}function sD(e,t,n){return e.message=e.message.replace(t,n),e}function uD(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!ak(r))return r}return{}}function cD(e,t){var n=ak(e[0])?e[0]:ak(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]};return{next:function(e){n.next&&n.next(t(e))},error:null===(e=n.error)||void 0===e?void 0:e.bind(n),complete:null===(e=n.complete)||void 0===e?void 0:e.bind(n)}}var lD=(hD.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},hD);function hD(e,t){this.hasPendingWrites=e,this.fromCache=t}var fD,pD=(vo(dD,fD=hk),Object.defineProperty(dD.prototype,"ref",{get:function(){return new oD(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(dD.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(dD.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(dD.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),dD.prototype.data=function(e){return this._delegate.data(e)},dD.prototype.get=function(e,t){return this._delegate.get(e,t)},dD.prototype.isEqual=function(e){return FN(this._delegate,e._delegate)},dD);function dD(e,t){t=fD.call(this,t)||this;return t._firestore=e,t}var gD,yD=(vo(mD,gD=pD),mD.prototype.data=function(e){e=this._delegate.data(e);return uy(void 0!==e,"Document in a QueryDocumentSnapshot should exist"),e},mD);function mD(){return null!==gD&&gD.apply(this,arguments)||this}var vD,bD=(vo(_D,vD=hk),_D.prototype.where=function(e,t,n){try{return new _D(this.firestore,WA(this._delegate,(i=t,o=n,r=AN("where",r=e),new HA(r,i,o))))}catch(e){throw sD(e,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},_D.prototype.orderBy=function(e,t){try{return new _D(this.firestore,WA(this._delegate,(void 0===(r=t)&&(r="asc"),n=AN("orderBy",n=e),new YA(n,r))))}catch(e){throw sD(e,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},_D.prototype.limit=function(e){try{return new _D(this.firestore,WA(this._delegate,(ok("limit",t=e),new $A("limit",t,"F"))))}catch(e){throw sD(e,"limit()","Query.limit()")}var t},_D.prototype.limitToLast=function(e){try{return new _D(this.firestore,WA(this._delegate,(ok("limitToLast",t=e),new $A("limitToLast",t,"L"))))}catch(e){throw sD(e,"limitToLast()","Query.limitToLast()")}var t},_D.prototype.startAt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new _D(this.firestore,WA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new tN("startAt",e,!0)}.apply(void 0,e)))}catch(e){throw sD(e,"startAt()","Query.startAt()")}},_D.prototype.startAfter=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new _D(this.firestore,WA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new tN("startAfter",e,!1)}.apply(void 0,e)))}catch(e){throw sD(e,"startAfter()","Query.startAfter()")}},_D.prototype.endBefore=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new _D(this.firestore,WA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new iN("endBefore",e,!0)}.apply(void 0,e)))}catch(e){throw sD(e,"endBefore()","Query.endBefore()")}},_D.prototype.endAt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return new _D(this.firestore,WA(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new iN("endAt",e,!1)}.apply(void 0,e)))}catch(e){throw sD(e,"endAt()","Query.endAt()")}},_D.prototype.isEqual=function(e){return wN(this._delegate,e._delegate)},_D.prototype.get=function(e){var t=this,e=("cache"===(null==e?void 0:e.source)?function(t){t=ik(t,BA);var n=ik(t.firestore,qk),e=XN(n),r=new xA(n);return QC(e,t._query).then(function(e){return new LN(n,r,t,e)})}:"server"===(null==e?void 0:e.source)?function(t){t=ik(t,BA);var n=ik(t.firestore,qk),e=XN(n),r=new xA(n);return YC(e,t._query,{source:"server"}).then(function(e){return new LN(n,r,t,e)})}:function(t){t=ik(t,BA);var n=ik(t.firestore,qk),e=XN(n),r=new xA(n);return lN(t._query),YC(e,t._query).then(function(e){return new LN(n,r,t,e)})})(this._delegate);return e.then(function(e){return new SD(t.firestore,new LN(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))})},_D.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=uD(e),i=cD(e,function(e){return new SD(t.firestore,new LN(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return FA(this._delegate,r,i)},_D.prototype.withConverter=function(e){return new _D(this.firestore,this._delegate.withConverter(e))},_D);function _D(e,t){t=vD.call(this,t)||this;return t.firestore=e,t._userDataWriter=new bk(e),t}var wD,ED=(vo(TD,wD=hk),Object.defineProperty(TD.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(TD.prototype,"doc",{get:function(){return new yD(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(TD.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(TD.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),TD);function TD(e,t){t=wD.call(this,t)||this;return t._firestore=e,t}var ID,SD=(vo(CD,ID=hk),Object.defineProperty(CD.prototype,"query",{get:function(){return new bD(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(CD.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(CD.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(CD.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(CD.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new yD(t._firestore,e)})},enumerable:!1,configurable:!0}),CD.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map(function(e){return new ED(t._firestore,e)})},CD.prototype.forEach=function(t,n){var r=this;this._delegate.forEach(function(e){t.call(n,new yD(r._firestore,e))})},CD.prototype.isEqual=function(e){return FN(this._delegate,e._delegate)},CD);function CD(e,t){t=ID.call(this,t)||this;return t._firestore=e,t}var kD,AD=(vo(ND,kD=bD),Object.defineProperty(ND.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(ND.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(ND.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new oD(this.firestore,e):null},enumerable:!1,configurable:!0}),ND.prototype.doc=function(e){try{return new oD(this.firestore,void 0===e?yN(this._delegate):yN(this._delegate,e))}catch(e){throw sD(e,"doc()","CollectionReference.doc()")}},ND.prototype.add=function(e){var t,n,r,i=this;return t=this._delegate,n=e,e=ik(t.firestore,qk),r=yN(t),n=RD(t._converter,n),UA(e,_A(EN(t.firestore),"addDoc",r._key,n,null!==t._converter,{}).toMutations(r._key,o_.exists(!1))).then(function(){return r}).then(function(e){return new oD(i.firestore,e)})},ND.prototype.isEqual=function(e){return _N(this._delegate,e._delegate)},ND.prototype.withConverter=function(e){return new ND(this.firestore,this._delegate.withConverter(e))},ND);function ND(e,t){var n=kD.call(this,e,t)||this;return n.firestore=e,n._delegate=t,n}function DD(e){return e instanceof hk&&(e=e._delegate),ik(e,jA)}function RD(e,t,n){t=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t;return t}var OD,de=(vo(PD,OD=hk),PD.documentId=function(){return new PD(Py.keyField().canonicalString())},PD.prototype.isEqual=function(e){return e instanceof hk&&(e=e._delegate),e instanceof uA&&this._delegate._internalPath.isEqual(e._internalPath)},PD);function PD(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return OD.call(this,new(uA.bind.apply(uA,So([void 0],e))))||this}var xD,ge=(vo(LD,xD=hk),LD.serverTimestamp=function(){var e=new Jk("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new LD(e)},LD.delete=function(){var e=new Gk("deleteField");return e._methodName="FieldValue.delete",new LD(e)},LD.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new eA("arrayUnion",e)}.apply(void 0,e);return n._methodName="FieldValue.arrayUnion",new LD(n)},LD.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new rA("arrayRemove",e)}.apply(void 0,e);return n._methodName="FieldValue.arrayRemove",new LD(n)},LD.increment=function(e){e=new aA("increment",e);return e._methodName="FieldValue.increment",new LD(e)},LD.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},LD);function LD(){return null!==xD&&xD.apply(this,arguments)||this}var MD,FD,UD={Firestore:QN,GeoPoint:sk,Timestamp:yy,Blob:gk,Transaction:ZN,WriteBatch:nD,DocumentReference:oD,DocumentSnapshot:pD,Query:bD,QueryDocumentSnapshot:yD,QuerySnapshot:SD,CollectionReference:AD,FieldPath:de,FieldValue:ge,setLogLevel:function(e){e=e,ey.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};FD=function(e,t){return new QN(e,new qk(e,t),new zN)},(MD=Jh).INTERNAL.registerComponent(new _a("firestore",function(e){var t=e.getProvider("app").getImmediate();return FD(t,e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},UD))),MD.registerVersion("@firebase/firestore","2.0.4-1.0.0-eap-firestore-debug.9c6096f43");var qD,jD={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},VD=(vo(BD,qD=Error),BD);function BD(e,t,n){t=qD.call(this,t)||this;return Object.setPrototypeOf(t,BD.prototype),t.code=e,t.details=n,t}function KD(e,t,n){var r=function(e){if(200<=e&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r,o=void 0;try{var a=t&&t.error;if(a){var s=a.status;if("string"==typeof s){if(!jD[s])return new VD("internal","internal");r=jD[s],i=s}s=a.message;"string"==typeof s&&(i=s),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(e){}return"ok"===r?null:new VD(r,i,o)}var WD=(zD.prototype.getAuthToken=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},zD.prototype.getInstanceIdToken=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(e){return[2,void 0]}return[2]})})},zD.prototype.getContext=function(){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,this.getAuthToken()];case 1:return t=e.sent(),[4,this.getInstanceIdToken()];case 2:return n=e.sent(),[2,{authToken:t,instanceIdToken:n}]}})})},zD);function zD(e,t){var n=this;this.auth=null,this.messaging=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(function(e){return n.auth=e},function(){}),this.messaging||t.get().then(function(e){return n.messaging=e},function(){})}function HD(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n]));return r}var GD=(QD.prototype.encode=function(e){var t=this;if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t.encode(e)});if("function"==typeof e||"object"==typeof e)return HD(e,function(e){return t.encode(e)});throw new Error("Data cannot be encoded in JSON: "+e)},QD.prototype.decode=function(e){var t=this;if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(function(e){return t.decode(e)}):"function"==typeof e||"object"==typeof e?HD(e,function(e){return t.decode(e)}):e},QD);function QD(){}var YD=(Object.defineProperty(XD.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),XD.prototype._url=function(e){var t=this.app_.options.projectId;return null===this.emulatorOrigin?null!==this.customDomain?this.customDomain+"/"+e:"https://"+this.region+"-"+t+".cloudfunctions.net/"+e:this.emulatorOrigin+"/"+t+"/"+this.region+"/"+e},XD.prototype.useEmulator=function(e,t){this.emulatorOrigin="http://"+e+":"+t},XD.prototype.useFunctionsEmulator=function(e){this.emulatorOrigin=e},XD.prototype.httpsCallable=function(t,n){var r=this;return function(e){return r.call(t,e,n||{})}},XD.prototype.postJSON=function(r,i,o){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:o["Content-Type"]="application/json",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.fetchImpl(r,{method:"POST",body:JSON.stringify(i),headers:o})];case 2:return t=e.sent(),[3,4];case 3:return e.sent(),[2,{status:0,json:null}];case 4:n=null,e.label=5;case 5:return e.trys.push([5,7,,8]),[4,t.json()];case 6:return n=e.sent(),[3,8];case 7:return e.sent(),[3,8];case 8:return[2,{status:t.status,json:n}]}})})},XD.prototype.call=function(c,l,h){return _o(this,void 0,void 0,function(){var i,o,a,s,u;return wo(this,function(e){switch(e.label){case 0:return i=this._url(c),l=this.serializer.encode(l),o={data:l},a={},[4,this.contextProvider.getContext()];case 1:return(s=e.sent()).authToken&&(a.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(a["Firebase-Instance-ID-Token"]=s.instanceIdToken),u=h.timeout||7e4,n=u,t=new Promise(function(e,t){r=setTimeout(function(){t(new VD("deadline-exceeded","deadline-exceeded"))},n)}),u=(s={timer:r,promise:t}).timer,s=s.promise,[4,Promise.race([JD(u,this.postJSON(i,o,a)),s,JD(u,this.cancelAllRequests)])];case 2:if(!(s=e.sent()))throw new VD("cancelled","Firebase Functions instance was deleted.");if(u=KD(s.status,s.json,this.serializer))throw u;if(!s.json)throw new VD("internal","Response is not valid JSON object.");if(void 0===(u=s.json.data)&&(u=s.json.result),void 0===u)throw new VD("internal","Response is missing data field.");return[2,{data:this.serializer.decode(u)}]}var n,r,t})})},XD);function XD(e,t,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=e,this.fetchImpl=i,this.serializer=new GD,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new WD(t,n),this.cancelAllRequests=new Promise(function(e){o.deleteService=function(){return e()}});try{var a=new URL(r);this.customDomain=a.origin,this.region="us-central1"}catch(e){this.customDomain=null,this.region=r}}function JD(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,r];case 1:return t=e.sent(),clearTimeout(n),[2,t]}})})}var $D,ZD,eR;function tR(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function nR(n,r,i){var o,e=new Promise(function(e,t){tR(o=n[r].apply(n,i)).then(e,t)});return e.request=o,e}function rR(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function iR(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return nR(this[n],e,arguments)})})}function oR(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function aR(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=nR(e,n,arguments)).then(function(e){if(e)return new uR(e,t.request)});var e,t})})}function sR(e){this._index=e}function uR(e,t){this._cursor=e,this._request=t}function cR(e){this._store=e}function lR(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function hR(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new lR(n)}function fR(e){this._db=e}function pR(e,t,n){var t=nR(indexedDB,"open",[e,t]),r=t.request;return r&&(r.onupgradeneeded=function(e){n&&n(new hR(r.result,e.oldVersion,r.transaction))}),t.then(function(e){return new fR(e)})}function dR(e){return nR(indexedDB,"deleteDatabase",[e])}$D=Jh,ZD=fetch.bind(self),eR={Functions:YD},$D.INTERNAL.registerComponent(new _a("functions",function(e,t){var n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),e=e.getProvider("messaging");return new YD(n,r,e,t,ZD)},"PUBLIC").setServiceProps(eR).setMultipleInstances(!0)),Jh.registerVersion("@firebase/functions","0.6.1-1.0.0-eap-firestore-debug.9c6096f43"),rR(sR,"_index",["name","keyPath","multiEntry","unique"]),iR(sR,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),aR(sR,"_index",IDBIndex,["openCursor","openKeyCursor"]),rR(uR,"_cursor",["direction","key","primaryKey","value"]),iR(uR,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(uR.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),tR(t._request).then(function(e){if(e)return new uR(e,t._request)})})})}),cR.prototype.createIndex=function(){return new sR(this._store.createIndex.apply(this._store,arguments))},cR.prototype.index=function(){return new sR(this._store.index.apply(this._store,arguments))},rR(cR,"_store",["name","keyPath","indexNames","autoIncrement"]),iR(cR,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),aR(cR,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),oR(cR,"_store",IDBObjectStore,["deleteIndex"]),lR.prototype.objectStore=function(){return new cR(this._tx.objectStore.apply(this._tx,arguments))},rR(lR,"_tx",["objectStoreNames","mode"]),oR(lR,"_tx",IDBTransaction,["abort"]),hR.prototype.createObjectStore=function(){return new cR(this._db.createObjectStore.apply(this._db,arguments))},rR(hR,"_db",["name","version","objectStoreNames"]),oR(hR,"_db",IDBDatabase,["deleteObjectStore","close"]),fR.prototype.transaction=function(){return new lR(this._db.transaction.apply(this._db,arguments))},rR(fR,"_db",["name","version","objectStoreNames"]),oR(fR,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[cR,sR].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e=(n=arguments,Array.prototype.slice.call(n)),t=e[e.length-1],n=this._store||this._index,r=n[i].apply(n,e.slice(0,-1));r.onsuccess=function(){t(r.result)}})})}),[sR,cR].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,i=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(i.push(e.value),void 0===n||i.length!=n?e.continue():t(i)):t(i)})})})});var gR="0.4.19-1.0.0-eap-firestore-debug.9c6096f43",yR=1e4,mR="w:"+gR,vR="FIS_v2",bR="https://firebaseinstallations.googleapis.com/v1",_R=36e5,ge=((de={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',de["not-registered"]="Firebase Installation is not registered.",de["installation-not-found"]="Firebase Installation not found.",de["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',de["app-offline"]="Could not process request. Application offline.",de["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",de),wR=new Qo("installations","Installations",ge);function ER(e){return e instanceof Ho&&e.code.includes("request-failed")}function TR(e){e=e.projectId;return bR+"/projects/"+e+"/installations"}function IR(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}function SR(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,r.json()];case 1:return t=e.sent(),t=t.error,[2,wR.create("request-failed",{requestName:n,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})]}})})}function CR(e){e=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function kR(e,t){t=t.refreshToken,e=CR(e);return e.append("Authorization",vR+" "+t),e}function AR(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return 500<=(t=e.sent()).status&&t.status<600?[2,n()]:[2,t]}})})}function NR(t){return new Promise(function(e){setTimeout(e,t)})}var DR=/^[cdef][\w-]{21}$/,RR="";function OR(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;e=function(e){return btoa(String.fromCharCode.apply(String,Io(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22);return DR.test(e)?e:RR}catch(e){return RR}}function PR(e){return e.appName+"!"+e.appId}var xR=new Map;function LR(e,t){e=PR(e);MR(e,t),function(e,t){var n=UR();n&&n.postMessage({key:e,fid:t});qR()}(e,t)}function MR(e,t){var n,r,i=xR.get(e);if(i)try{for(var o=Eo(i),a=o.next();!a.done;a=o.next()){(0,a.value)(t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var FR=null;function UR(){return!FR&&"BroadcastChannel"in self&&((FR=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){MR(e.data.key,e.data.fid)}),FR}function qR(){0===xR.size&&FR&&(FR.close(),FR=null)}var jR,VR="firebase-installations-database",BR=1,KR="firebase-installations-store",WR=null;function zR(){return WR=WR||pR(VR,BR,function(e){0===e.oldVersion&&e.createObjectStore(KR)})}function HR(o,a){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:return t=PR(o),[4,zR()];case 1:return r=e.sent(),n=r.transaction(KR,"readwrite"),[4,(r=n.objectStore(KR)).get(t)];case 2:return i=e.sent(),[4,r.put(a,t)];case 3:return e.sent(),[4,n.complete];case 4:return e.sent(),i&&i.fid===a.fid||LR(o,a.fid),[2,a]}})})}function GR(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return t=PR(r),[4,zR()];case 1:return n=e.sent(),[4,(n=n.transaction(KR,"readwrite")).objectStore(KR).delete(t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2]}})})}function QR(a,s){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return t=PR(a),[4,zR()];case 1:return r=e.sent(),n=r.transaction(KR,"readwrite"),[4,(r=n.objectStore(KR)).get(t)];case 2:return i=e.sent(),void 0!==(o=s(i))?[3,4]:[4,r.delete(t)];case 3:return e.sent(),[3,6];case 4:return[4,r.put(o,t)];case 5:e.sent(),e.label=6;case 6:return[4,n.complete];case 7:return e.sent(),!o||i&&i.fid===o.fid||LR(a,o.fid),[2,o]}})})}function YR(i){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return[4,QR(i,function(e){e=JR(e||{fid:OR(),registrationStatus:0}),e=function(e,t){{if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:function(i){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return[4,XR(i)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,NR(100)];case 3:return e.sent(),[4,XR(i)];case 4:return t=e.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,YR(i)];case 6:return r=e.sent(),n=r.installationEntry,(r=r.registrationPromise)?[2,r]:[2,n];case 7:return[2,t]}})})}(e)}:{installationEntry:t};if(!navigator.onLine){var n=Promise.reject(wR.create("app-offline"));return{installationEntry:t,registrationPromise:n}}t={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},e=function(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,7]),[4,function(a,e){var s=e.fid;return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return t=TR(a),n=CR(a),o={fid:s,authVersion:vR,appId:a.appId,sdkVersion:mR},r={method:"POST",headers:n,body:JSON.stringify(o)},[4,AR(function(){return fetch(t,r)})];case 1:return(i=e.sent()).ok?[4,i.json()]:[3,3];case 2:return o=e.sent(),[2,{fid:o.fid||s,registrationStatus:2,refreshToken:o.refreshToken,authToken:IR(o.authToken)}];case 3:return[4,SR("Create Installation",i)];case 4:throw e.sent()}})})}(r,i)];case 1:return t=e.sent(),[2,HR(r,t)];case 2:return ER(n=e.sent())&&409===n.customData.serverCode?[4,GR(r)]:[3,4];case 3:return e.sent(),[3,6];case 4:return[4,HR(r,{fid:i.fid,registrationStatus:0})];case 5:e.sent(),e.label=6;case 6:throw n;case 7:return[2]}})})}(e,t);return{installationEntry:t,registrationPromise:e}}}(i,e);return t=e.registrationPromise,e.installationEntry})];case 1:return(n=e.sent()).fid!==RR?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=e.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}})})}function XR(e){return QR(e,function(e){if(!e)throw wR.create("installation-not-found");return JR(e)})}function JR(e){return 1===(t=e).registrationStatus&&t.registrationTime+yR<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function $R(e,a){var s=e.appConfig,u=e.platformLoggerProvider;return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return t=function(e,t){t=t.fid;return TR(e)+"/"+t+"/authTokens:generate"}(s,a),n=kR(s,a),(o=u.getImmediate({optional:!0}))&&n.append("x-firebase-client",o.getPlatformInfoString()),o={installation:{sdkVersion:mR}},r={method:"POST",headers:n,body:JSON.stringify(o)},[4,AR(function(){return fetch(t,r)})];case 1:return(i=e.sent()).ok?[4,i.json()]:[3,3];case 2:return o=e.sent(),[2,IR(o)];case 3:return[4,SR("Generate Auth Token",i)];case 4:throw e.sent()}})})}function ZR(i,o){return void 0===o&&(o=!1),_o(this,void 0,void 0,function(){var r,t,n;return wo(this,function(e){switch(e.label){case 0:return[4,QR(i.appConfig,function(e){if(!tO(e))throw wR.create("not-registered");var t,n=e.authToken;if(o||2!==(t=n).requestStatus||function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+_R}(t)){if(1===n.requestStatus)return r=function(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,eO(n.appConfig)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.authToken.requestStatus?[3,5]:[4,NR(100)];case 3:return e.sent(),[4,eO(n.appConfig)];case 4:return t=e.sent(),[3,2];case 5:return 0===(t=t.authToken).requestStatus?[2,ZR(n,r)]:[2,t]}})})}(i,o),e;if(!navigator.onLine)throw wR.create("app-offline");n=(t=e,n={requestStatus:1,requestTime:Date.now()},bo(bo({},t),{authToken:n}));return r=function(i,o){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,8]),[4,$R(i,o)];case 1:return t=e.sent(),r=bo(bo({},o),{authToken:t}),[4,HR(i.appConfig,r)];case 2:return e.sent(),[2,t];case 3:return!ER(n=e.sent())||401!==n.customData.serverCode&&404!==n.customData.serverCode?[3,5]:[4,GR(i.appConfig)];case 4:return e.sent(),[3,7];case 5:return r=bo(bo({},o),{authToken:{requestStatus:0}}),[4,HR(i.appConfig,r)];case 6:e.sent(),e.label=7;case 7:throw n;case 8:return[2]}})})}(i,n),n}return e})];case 1:return t=e.sent(),r?[4,r]:[3,3];case 2:return n=e.sent(),[3,4];case 3:n=t.authToken,e.label=4;case 4:return[2,n]}})})}function eO(e){return QR(e,function(e){if(!tO(e))throw wR.create("not-registered");var t=e.authToken;return 1===(t=t).requestStatus&&t.requestTime+yR<Date.now()?bo(bo({},e),{authToken:{requestStatus:0}}):e})}function tO(e){return void 0!==e&&2===e.registrationStatus}function nO(t,n){return void 0===n&&(n=!1),_o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,YR(n)];case 1:return(t=e.sent().registrationPromise)?[4,t]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return e.sent(),[4,ZR(t,n)];case 2:return[2,e.sent().token]}})})}function rO(i,o){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return t=function(e,t){t=t.fid;return TR(e)+"/"+t}(i,o),r=kR(i,o),n={method:"DELETE",headers:r},[4,AR(function(){return fetch(t,n)})];case 1:return(r=e.sent()).ok?[3,3]:[4,SR("Delete Installation",r)];case 2:throw e.sent();case 3:return[2]}})})}function iO(e,r){var i=e.appConfig;return function(e,t){UR();var n=PR(e);(e=xR.get(n))||(e=new Set,xR.set(n,e)),e.add(t)}(i,r),function(){var e,t,n;t=r,n=PR(e=i),(e=xR.get(n))&&(e.delete(t),0===e.size&&xR.delete(n),qR())}}function oO(e){return wR.create("missing-app-config-values",{valueName:e})}(jR=Jh).INTERNAL.registerComponent(new _a("installations",function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:function(e){var t,n;if(!e||!e.options)throw oO("App Configuration");if(!e.name)throw oO("App Name");try{for(var r=Eo(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw oO(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return function(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,YR(r.appConfig)];case 1:return t=e.sent(),n=t.installationEntry,(t.registrationPromise||ZR(r)).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(e){return nO(n,e)},delete:function(){return function(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,QR(t=r.appConfig,function(e){if(!e||0!==e.registrationStatus)return e})];case 1:if(!(n=e.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw wR.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw wR.create("app-offline");case 3:return[4,rO(t,n)];case 4:return e.sent(),[4,GR(t)];case 5:e.sent(),e.label=6;case 6:return[2]}})})}(n)},onIdChange:function(e){return iO(n,e)}}},"PUBLIC")),jR.registerVersion("@firebase/installations",gR);var aO,ge=((de={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',de["only-available-in-window"]="This method is available in a Window context.",de["only-available-in-sw"]="This method is available in a service worker context.",de["permission-default"]="The notification permission was not granted and dismissed instead.",de["permission-blocked"]="The notification permission was not granted and blocked instead.",de["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",de["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",de["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",de["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",de["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",de["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",de["token-update-no-token"]="FCM returned no token when updating the user to push.",de["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",de["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",de["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",de["invalid-vapid-key"]="The public VAPID key must be a string.",de["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",de),sO=new Qo("messaging","Messaging",ge),uO="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",cO="https://fcmregistrations.googleapis.com/v1",lO="FCM_MSG",hO="google.c.a.c_id";function fO(e){e=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Io(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(de=aO=aO||{}).PUSH_RECEIVED="push-received",de.NOTIFICATION_CLICKED="notification-clicked";var pO="fcm_token_details_db",dO=5,gO="fcm_token_object_Store";function yO(a){return _o(this,void 0,void 0,function(){var t,o,n=this;return wo(this,function(e){switch(e.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(t=e.sent(),!t.map(function(e){return e.name}).includes(pO))return[2,null];e.label=2;case 2:return o=null,[4,pR(pO,dO,function(i){return _o(n,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return i.oldVersion<2?[2]:i.objectStoreNames.contains(gO)?[4,(r=i.transaction.objectStore(gO)).index("fcmSenderId").get(a)]:[2];case 1:return t=e.sent(),[4,r.clear()];case 2:if(e.sent(),!t)return[2];if(2===i.oldVersion){if(!(n=t).auth||!n.p256dh||!n.endpoint)return[2];o={token:n.fcmToken,createTime:null!==(r=n.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:n.auth,p256dh:n.p256dh,endpoint:n.endpoint,swScope:n.swScope,vapidKey:"string"==typeof n.vapidKey?n.vapidKey:fO(n.vapidKey)}}}else(3===i.oldVersion||4===i.oldVersion)&&(o={token:(n=t).fcmToken,createTime:n.createTime,subscriptionOptions:{auth:fO(n.auth),p256dh:fO(n.p256dh),endpoint:n.endpoint,swScope:n.swScope,vapidKey:fO(n.vapidKey)}});return[2]}})})})];case 3:return e.sent().close(),[4,dR(pO)];case 4:return e.sent(),[4,dR("fcm_vapid_details_db")];case 5:return e.sent(),[4,dR("undefined")];case 6:return e.sent(),[2,function(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&0<e.createTime&&"string"==typeof e.token&&0<e.token.length&&"string"==typeof t.auth&&0<t.auth.length&&"string"==typeof t.p256dh&&0<t.p256dh.length&&"string"==typeof t.endpoint&&0<t.endpoint.length&&"string"==typeof t.swScope&&0<t.swScope.length&&"string"==typeof t.vapidKey&&0<t.vapidKey.length}(o)?o:null]}})})}var mO="firebase-messaging-database",vO=1,bO="firebase-messaging-store",_O=null;function wO(){return _O=_O||pR(mO,vO,function(e){0===e.oldVersion&&e.createObjectStore(bO)})}function EO(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return t=IO(r),[4,wO()];case 1:return[4,e.sent().transaction(bO).objectStore(bO).get(t)];case 2:return(t=e.sent())?[2,t]:[3,3];case 3:return[4,yO(r.appConfig.senderId)];case 4:return(n=e.sent())?[4,TO(r,n)]:[3,6];case 5:return e.sent(),[2,n];case 6:return[2]}})})}function TO(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return t=IO(r),[4,wO()];case 1:return n=e.sent(),[4,(n=n.transaction(bO,"readwrite")).objectStore(bO).put(i,t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2,i]}})})}function IO(e){return e.appConfig.appId}function SO(r,i){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,kO(r)];case 1:t=e.sent(),t={method:"DELETE",headers:t},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(CO(r.appConfig)+"/"+i,t)];case 3:return[4,e.sent().json()];case 4:if((t=e.sent()).error)throw n=t.error.message,sO.create("token-unsubscribe-failed",{errorInfo:n});return[3,6];case 5:throw n=e.sent(),sO.create("token-unsubscribe-failed",{errorInfo:n});case 6:return[2]}})})}function CO(e){e=e.projectId;return cO+"/projects/"+e+"/registrations"}function kO(e){var n=e.appConfig,r=e.installations;return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,r.getToken()];case 1:return t=e.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}})})}function AO(e){var t=e.p256dh,n=e.auth,r=e.endpoint,e=e.vapidKey,t={web:{endpoint:r,auth:n,p256dh:t}};return e!==uO&&(t.web.applicationPubKey=e),t}function NO(c,l,h){return _o(this,void 0,void 0,function(){var a,s,u;return wo(this,function(e){switch(e.label){case 0:if("granted"!==Notification.permission)throw sO.create("permission-blocked");return[4,function(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,n.pushManager.getSubscription()];case 1:return(t=e.sent())?[2,t]:[2,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}(r)})]}})})}(l,h)];case 1:return u=e.sent(),[4,EO(c)];case 2:return a=e.sent(),s={vapidKey:h,swScope:l.scope,endpoint:u.endpoint,auth:fO(u.getKey("auth")),p256dh:fO(u.getKey("p256dh"))},a?[3,3]:[2,RO(c,s)];case 3:if(t=a.subscriptionOptions,r=(n=s).vapidKey===t.vapidKey,i=n.endpoint===t.endpoint,o=n.auth===t.auth,t=n.p256dh===t.p256dh,r&&i&&o&&t)return[3,8];e.label=4;case 4:return e.trys.push([4,6,,7]),[4,SO(c,a.token)];case 5:return e.sent(),[3,7];case 6:return u=e.sent(),console.warn(u),[3,7];case 7:return[2,RO(c,s)];case 8:return Date.now()>=a.createTime+6048e5?[2,function(i,o,a){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,5]),[4,function(o,a){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:return[4,kO(o)];case 1:t=e.sent(),n=AO(a.subscriptionOptions),n={method:"PATCH",headers:t,body:JSON.stringify(n)},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(CO(o.appConfig)+"/"+a.token,n)];case 3:return[4,e.sent().json()];case 4:return r=e.sent(),[3,6];case 5:throw i=e.sent(),sO.create("token-update-failed",{errorInfo:i});case 6:if(r.error)throw i=r.error.message,sO.create("token-update-failed",{errorInfo:i});if(!r.token)throw sO.create("token-update-no-token");return[2,r.token]}})})}(o,i)];case 1:return t=e.sent(),n=bo(bo({},i),{token:t,createTime:Date.now()}),[4,TO(o,n)];case 2:return e.sent(),[2,t];case 3:return r=e.sent(),[4,DO(o,a)];case 4:throw e.sent(),r;case 5:return[2]}})})}({token:a.token,createTime:Date.now(),subscriptionOptions:s},c,l)]:[2,a.token];case 9:return[2]}var t,n,r,i,o})})}function DO(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,EO(n)];case 1:return(t=e.sent())?[4,SO(n,t.token)]:[3,4];case 2:return e.sent(),[4,function(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return t=IO(r),[4,wO()];case 1:return n=e.sent(),[4,(n=n.transaction(bO,"readwrite")).objectStore(bO).delete(t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2]}})})}(n)];case 3:e.sent(),e.label=4;case 4:return[4,r.pushManager.getSubscription()];case 5:return(t=e.sent())?[2,t.unsubscribe()]:[2,!0]}})})}function RO(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,function(o,a){return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:return[4,kO(o)];case 1:t=e.sent(),n=AO(a),n={method:"POST",headers:t,body:JSON.stringify(n)},e.label=2;case 2:return e.trys.push([2,5,,6]),[4,fetch(CO(o.appConfig),n)];case 3:return[4,e.sent().json()];case 4:return r=e.sent(),[3,6];case 5:throw i=e.sent(),sO.create("token-subscribe-failed",{errorInfo:i});case 6:if(r.error)throw i=r.error.message,sO.create("token-subscribe-failed",{errorInfo:i});if(!r.token)throw sO.create("token-subscribe-no-token");return[2,r.token]}})})}(n,r)];case 1:return t=e.sent(),t={token:t,createTime:Date.now(),subscriptionOptions:r},[4,TO(n,t)];case 2:return e.sent(),[2,t.token]}})})}function OO(e){var t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(!t.notification)return;e.notification={};var n=t.notification.title;n&&(e.notification.title=n);n=t.notification.body;n&&(e.notification.body=n);t=t.notification.image;t&&(e.notification.image=t)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};var n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);t=t.fcmOptions.analytics_label;t&&(e.fcmOptions.analyticsLabel=t)}(t,e),t}function PO(e){return"object"==typeof e&&e&&hO in e}function xO(t){return new Promise(function(e){setTimeout(e,t)})}var LO=(Object.defineProperty(MO.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),MO.prototype.setBackgroundMessageHandler=function(e){if(this.isOnBackgroundMessageUsed=!1,!e||"function"!=typeof e)throw sO.create("invalid-bg-handler");this.bgMessageHandler=e},MO.prototype.onBackgroundMessage=function(e){var t=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=e,function(){t.bgMessageHandler=null}},MO.prototype.getToken=function(){var n;return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return this.vapidKey?[3,2]:[4,EO(this.firebaseDependencies)];case 1:t=e.sent(),this.vapidKey=null!==(n=null===(n=null==t?void 0:t.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==n?n:uO,e.label=2;case 2:return[2,NO(this.firebaseDependencies,self.registration,this.vapidKey)]}})})},MO.prototype.deleteToken=function(){return DO(this.firebaseDependencies,self.registration)},MO.prototype.requestPermission=function(){throw sO.create("only-available-in-window")},MO.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw sO.create("use-vapid-key-after-get-token");if("string"!=typeof e||0===e.length)throw sO.create("invalid-vapid-key");this.vapidKey=e},MO.prototype.useServiceWorker=function(){throw sO.create("only-available-in-window")},MO.prototype.onMessage=function(){throw sO.create("only-available-in-window")},MO.prototype.onTokenRefresh=function(){throw sO.create("only-available-in-window")},MO.prototype.onPush=function(s){return _o(this,void 0,void 0,function(){var i,o,a;return wo(this,function(e){switch(e.label){case 0:return(a=function(e){var t=e.data;if(!t)return null;try{return t.json()}catch(e){return null}}(s))?[4,FO()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return(i=e.sent(),i.some(function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))?[2,function(e,t){var n,r;t.isFirebaseMessaging=!0,t.messageType=aO.PUSH_RECEIVED;try{for(var i=Eo(e),o=i.next();!o.done;o=i.next()){o.value.postMessage(t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(i,a)]:(o=!1,a.notification?[4,function(e){var t=e.actions,n=Notification.maxActions;t&&n&&t.length>n&&console.warn("This browser only supports "+n+" actions. The remaining actions will not be displayed.");return self.registration.showNotification(null!==(n=e.title)&&void 0!==n?n:"",e)}(((r=bo({},(t=a).notification)).data=((n={})[lO]=t,n),r))]:[3,3]);case 2:e.sent(),o=!0,e.label=3;case 3:return!0===o&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(a=OO(a),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(a):this.bgMessageHandler.next(a)),[4,xO(1e3)]);case 4:return e.sent(),[2]}var t,n,r})})},MO.prototype.onSubChange=function(n){var r;return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return n.newSubscription?[3,2]:[4,DO(this.firebaseDependencies,self.registration)];case 1:return e.sent(),[2];case 2:return[4,EO(this.firebaseDependencies)];case 3:return t=e.sent(),[4,DO(this.firebaseDependencies,self.registration)];case 4:return e.sent(),[4,NO(this.firebaseDependencies,self.registration,null!==(r=null===(r=null==t?void 0:t.subscriptionOptions)||void 0===r?void 0:r.vapidKey)&&void 0!==r?r:uO)];case 5:return e.sent(),[2]}})})},MO.prototype.onNotificationClick=function(a){var s;return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:return(t=null===(s=null===(s=a.notification)||void 0===s?void 0:s.data)||void 0===s?void 0:s[lO])?a.action?[2]:(a.stopImmediatePropagation(),a.notification.close(),(n=function(e){var t,n=null!==(t=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==t?t:null===(n=e.notification)||void 0===n?void 0:n.click_action;if(n)return n;return PO(e.data)?self.location.origin:null}(t))?(r=new URL(n,self.location.href),i=new URL(self.location.origin),r.host!==i.host?[2]:[4,function(u){return _o(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return wo(this,function(e){switch(e.label){case 0:return[4,FO()];case 1:t=e.sent();try{for(n=Eo(t),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),u.host===o.host)return[2,i]}catch(e){a={error:e}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}})})}(r)]):[2]):[2];case 1:return(o=e.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return o=e.sent(),[4,xO(3e3)];case 3:return e.sent(),[3,6];case 4:return[4,o.focus()];case 5:o=e.sent(),e.label=6;case 6:return o?(t.messageType=aO.NOTIFICATION_CLICKED,t.isFirebaseMessaging=!0,[2,o.postMessage(t)]):[2]}})})},MO);function MO(e){var t=this;this.firebaseDependencies=e,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",function(e){e.waitUntil(t.onPush(e))}),self.addEventListener("pushsubscriptionchange",function(e){e.waitUntil(t.onSubChange(e))}),self.addEventListener("notificationclick",function(e){e.waitUntil(t.onNotificationClick(e))})}function FO(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}var UO=(Object.defineProperty(qO.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),qO.prototype.messageEventListener=function(i){return _o(this,void 0,void 0,function(){var n,r;return wo(this,function(e){switch(e.label){case 0:return(n=i.data).isFirebaseMessaging?(this.onMessageCallback&&n.messageType===aO.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback((delete(t=Object.assign({},n)).messageType,delete t.isFirebaseMessaging,t)):this.onMessageCallback.next(Object.assign({},n))),PO(r=n.data)&&"1"===r["google.c.a.e"]?[4,this.logEvent(n.messageType,r)]:[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return[2]}var t})})},qO.prototype.getVapidKey=function(){return this.vapidKey},qO.prototype.getSwReg=function(){return this.swRegistration},qO.prototype.getToken=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw sO.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,NO(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}})})},qO.prototype.updateVapidKey=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=uO),[2]})})},qO.prototype.updateSwReg=function(t){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw sO.create("invalid-sw-registration");return this.swRegistration=t,[2]}})})},qO.prototype.registerDefaultSw=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=e.sent(),this.swRegistration.update().catch(function(){}),[3,3];case 2:throw t=e.sent(),sO.create("failed-service-worker-registration",{browserErrorMessage:t.message});case 3:return[2]}})})},qO.prototype.deleteToken=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:return[2,DO(this.firebaseDependencies,this.swRegistration)]}})})},qO.prototype.requestPermission=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?sO.create("permission-blocked"):sO.create("permission-default")}})})},qO.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw sO.create("use-vapid-key-after-get-token");if("string"!=typeof e||0===e.length)throw sO.create("invalid-vapid-key");this.vapidKey=e},qO.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw sO.create("invalid-sw-registration");if(this.swRegistration)throw sO.create("use-sw-after-get-token");this.swRegistration=e},qO.prototype.onMessage=function(e){var t=this;return this.onMessageCallback=e,function(){t.onMessageCallback=null}},qO.prototype.setBackgroundMessageHandler=function(){throw sO.create("only-available-in-sw")},qO.prototype.onBackgroundMessage=function(){throw sO.create("only-available-in-sw")},qO.prototype.onTokenRefresh=function(){return function(){}},qO.prototype.logEvent=function(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return t=function(e){switch(e){case aO.NOTIFICATION_CLICKED:return"notification_open";case aO.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(n),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return e.sent().logEvent(t,{message_id:r[hO],message_name:r["google.c.a.c_l"],message_time:r["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}})})},qO);function qO(e){var t=this;this.firebaseDependencies=e,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",function(e){return t.messageEventListener(e)})}function jO(e){return sO.create("missing-app-config-values",{valueName:e})}ge={isSupported:VO};function VO(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}Jh.INTERNAL.registerComponent(new _a("messaging",function(e){var t=e.getProvider("app").getImmediate(),e={app:t,appConfig:function(e){var t,n;if(!e||!e.options)throw jO("App Configuration Object");if(!e.name)throw jO("App Name");var r=e.options;try{for(var i=Eo(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw jO(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{appName:e.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(t),installations:e.getProvider("installations").getImmediate(),analyticsProvider:e.getProvider("analytics-internal")};if(!VO())throw sO.create("unsupported-browser");return new(self&&"ServiceWorkerGlobalScope"in self?LO:UO)(e)},"PUBLIC").setServiceProps(ge));var BO,KO="firebasestorage.googleapis.com",WO="storageBucket",zO=(vo(HO,BO=Ho),HO.prototype.codeEquals=function(e){return QO(e)===this.code},Object.defineProperty(HO.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(HO.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e},enumerable:!1,configurable:!0}),HO);function HO(e,t){e=BO.call(this,QO(e),"Firebase Storage: "+t+" ("+QO(e)+")")||this;return e.customData={serverResponse:null},Object.setPrototypeOf(e,HO.prototype),e}var GO={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error",UNSUPPORTED_ENVIRONMENT:"unsupported-environment"};function QO(e){return"storage/"+e}function YO(){return new zO(GO.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function XO(){return new zO(GO.CANCELED,"User canceled the upload/download.")}function JO(){return new zO(GO.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $O(e){return new zO(GO.INVALID_ARGUMENT,e)}function ZO(){return new zO(GO.APP_DELETED,"The Firebase app was deleted.")}function eP(e){return new zO(GO.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function tP(e,t){return new zO(GO.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function nP(e){throw new zO(GO.INTERNAL_ERROR,"Internal error: "+e)}var rP={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},iP=function(e,t){this.data=e,this.contentType=t||null};function oP(e,t){switch(e){case rP.RAW:return new iP(aP(t));case rP.BASE64:case rP.BASE64URL:return new iP(sP(e,t));case rP.DATA_URL:return new iP(function(e){e=new uP(e);return e.base64?sP(rP.BASE64,e.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(e){throw tP(rP.DATA_URL,"Malformed data URL.")}return aP(t)}(e.rest)}(t),new uP(t).contentType)}throw YO()}function aP(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function sP(t,e){switch(t){case rP.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw tP(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case rP.BASE64URL:r=-1!==e.indexOf("+"),n=-1!==e.indexOf("/");if(r||n)throw tP(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var i;try{i=atob(e)}catch(e){throw tP(t,"Invalid character found")}for(var o=new Uint8Array(i.length),a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return o}var uP=function(e){var t;if(this.base64=!1,(this.contentType=null)===(t=e.match(/^data:([^,]+)?,/)))throw tP(rP.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r=t[1]||null;null!=r&&(this.base64=(n=";base64",(t=r).length>=n.length&&t.substring(t.length-n.length)===n),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=e.substring(e.indexOf(",")+1)};var cP,lP={STATE_CHANGED:"state_changed"},hP="running",fP="pausing",pP="paused",dP="success",gP="canceling",yP="canceled",mP="error",vP={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function bP(e){switch(e){case hP:case fP:case gP:return vP.RUNNING;case pP:return vP.PAUSED;case dP:return vP.SUCCESS;case yP:return vP.CANCELED;case mP:default:return vP.ERROR}}(de=cP=cP||{})[de.NO_ERROR=0]="NO_ERROR",de[de.NETWORK_ERROR=1]="NETWORK_ERROR",de[de.ABORT=2]="ABORT";var _P=(wP.prototype.send=function(e,t,n,r){if(this.sent_)throw nP("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},wP.prototype.getErrorCode=function(){if(!this.sent_)throw nP("cannot .getErrorCode() before sending");return this.errorCode_},wP.prototype.getStatus=function(){if(!this.sent_)throw nP("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},wP.prototype.getResponseText=function(){if(!this.sent_)throw nP("cannot .getResponseText() before sending");return this.xhr_.responseText},wP.prototype.abort=function(){this.xhr_.abort()},wP.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},wP.prototype.addUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)},wP.prototype.removeUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)},wP);function wP(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=cP.NO_ERROR,this.sendPromise_=new Promise(function(e){t.xhr_.addEventListener("abort",function(){t.errorCode_=cP.ABORT,e(t)}),t.xhr_.addEventListener("error",function(){t.errorCode_=cP.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(){e(t)})})}var EP=(TP.prototype.createXhrIo=function(){return new _P},TP);function TP(){}function IP(e){return"string"==typeof e||e instanceof String}function SP(e){return CP()&&e instanceof Blob}function CP(){return"undefined"!=typeof Blob}function kP(e,t,n,r){if(r<t)throw new zO(GO.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+t+" or greater.");if(n<r)throw new zO(GO.INVALID_ARGUMENT,"Invalid value for '"+e+"'. Expected "+n+" or less.")}function AP(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(CP())return new Blob(e);throw new zO(GO.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}var NP=(DP.prototype.size=function(){return this.size_},DP.prototype.type=function(){return this.type_},DP.prototype.slice=function(e,t){if(SP(this.data_)){var n=this.data_,r=(i=e,r=t,(n=n).webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===r?null:new DP(r)}var i,r;return new DP(new Uint8Array(this.data_.buffer,e,t-e),!0)},DP.getBlob=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(CP()){var n=e.map(function(e){return e instanceof DP?e.data_:e});return new DP(AP.apply(null,n))}var n=e.map(function(e){return IP(e)?oP(rP.RAW,e).data:e.data_}),r=0;n.forEach(function(e){r+=e.byteLength});var i=new Uint8Array(r),o=0;return n.forEach(function(e){for(var t=0;t<e.length;t++)i[o++]=e[t]}),new DP(i,!0)},DP.prototype.uploadData=function(){return this.data_},DP);function DP(e,t){var n=0,r="";SP(e)?(n=(this.data_=e).size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}var RP=(Object.defineProperty(OP.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(OP.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),OP.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},OP.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},OP.makeFromBucketSpec=function(t){var e,n;try{e=OP.makeFromUrl(t)}catch(e){return new OP(t,"")}if(""===e.path)return e;throw n=t,new zO(GO.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")},OP.makeFromUrl=function(e){var t=null,n="([A-Za-z0-9.\\-_]+)";var r=new RegExp("^gs://"+n+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}for(var o=KO.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/"+n+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+n+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:i}],s=0;s<a.length;s++){var u=a[s],c=u.regex.exec(e);if(c){t=new OP(c[u.indices.bucket],c[u.indices.path]||"");u.postModify(t);break}}if(null==t)throw n=e,new zO(GO.INVALID_URL,"Invalid URL '"+n+"'.");return t},OP);function OP(e,t){this.bucket=e,this.path_=t}function PP(e){var t,n;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof(n=t)||Array.isArray(n)?null:t}function xP(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function LP(e){return"https://"+KO+"/v0"+e}function MP(e){var t,n=encodeURIComponent,r="?";for(t in e){e.hasOwnProperty(t)&&(r=r+(n(t)+"="+n(e[t]))+"&")}return r=r.slice(0,-1)}function FP(e,t){return t}var UP=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||FP},qP=null;function jP(){if(qP)return qP;var e=[];e.push(new UP("bucket")),e.push(new UP("generation")),e.push(new UP("metageneration")),e.push(new UP("name","fullPath",!0));var t=new UP("name");t.xform=function(e,t){return!IP(t=t)||t.length<2?t:xP(t)},e.push(t);t=new UP("size");return t.xform=function(e,t){return void 0!==t?Number(t):t},e.push(t),e.push(new UP("timeCreated")),e.push(new UP("updated")),e.push(new UP("md5Hash",null,!0)),e.push(new UP("cacheControl",null,!0)),e.push(new UP("contentDisposition",null,!0)),e.push(new UP("contentEncoding",null,!0)),e.push(new UP("contentLanguage",null,!0)),e.push(new UP("contentType",null,!0)),e.push(new UP("metadata","customMetadata",!0)),qP=e}function VP(n,r){Object.defineProperty(n,"ref",{get:function(){var e=n.bucket,t=n.fullPath,t=new RP(e,t);return r.makeStorageReference(t)}})}function BP(e,t,n){t=PP(t);if(null===t)return null;return function(e,t,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,t[a.server])}return VP(r,e),r}(e,t,n)}function KP(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}var WP="prefixes",zP="items";function HP(e,t,n){n=PP(n);if(null===n)return null;return function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[WP])for(var i=0,o=n[WP];i<o.length;i++){var a=o[i].replace(/\/$/,""),s=e.makeStorageReference(new RP(t,a));r.prefixes.push(s)}if(n[zP])for(var u=0,c=n[zP];u<c.length;u++){var l=c[u],s=e.makeStorageReference(new RP(t,l.name));r.items.push(s)}return r}(e,t,n)}var GP=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function QP(e){if(!e)throw YO()}function YP(n,r){return function(e,t){return QP(null!==(t=BP(n,t,r))),t}}function XP(n,r){return function(e,t){return QP(null!==(t=HP(n,r,t))),t}}function JP(r,i){return function(e,t){var n=BP(r,t,i);return QP(null!==n),function(r,e){if(null===(e=PP(e)))return null;if(!IP(e.downloadTokens))return null;if(0===(e=e.downloadTokens).length)return null;var i=encodeURIComponent;return e.split(",").map(function(e){var t=r.bucket,n=r.fullPath;return LP("/b/"+i(t)+"/o/"+i(n))+MP({alt:"media",token:e})})[0]}(n,t)}}function $P(i){return function(e,t){var n,r=401===e.getStatus()?new zO(GO.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(n=i.bucket,new zO(GO.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=i.path,new zO(GO.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):t;return r.serverResponse=t.serverResponse,r}}function ZP(r){var i=$P(r);return function(e,t){var n=i(e,t);return 404===e.getStatus()&&(e=r.path,n=new zO(GO.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")),n.serverResponse=t.serverResponse,n}}function ex(e,t,n){var r=LP(t.fullServerUrl()),i=e.maxOperationRetryTime,i=new GP(r,"GET",YP(e,n),i);return i.errorHandler=ZP(t),i}function tx(e,t,n){n=Object.assign({},n);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=(e=t,(t=null)&&t.contentType||e&&e.type()||"application/octet-stream")),n}function nx(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=tx(t,r,i),i="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+KP(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",s="\r\n--"+s+"--",r=NP.getBlob(i,r,s);if(null===r)throw JO();s={name:u.fullPath},u=LP(o),o=e.maxUploadRetryTime,o=new GP(u,"POST",YP(e,n),o);return o.urlParams=s,o.headers=a,o.body=r.uploadData(),o.errorHandler=$P(t),o}var rx=function(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null};function ix(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){QP(!1)}return QP(!!n&&-1!==(t||["active"]).indexOf(n)),n}function ox(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a=tx(t,r,i),i={name:a.fullPath},o=LP(o),r={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},n=KP(a,n),e=e.maxUploadRetryTime;e=new GP(o,"POST",function(e){var t;ix(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){QP(!1)}return QP(IP(t)),t},e);return e.urlParams=i,e.headers=r,e.body=n,e.errorHandler=$P(t),e}function ax(e,t,n,i){e=e.maxUploadRetryTime,e=new GP(n,"POST",function(e){var t=ix(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){QP(!1)}n||QP(!1);var r=Number(n);return QP(!isNaN(r)),new rx(r,i.size(),"final"===t)},e);return e.headers={"X-Goog-Upload-Command":"query"},e.errorHandler=$P(t),e}function sx(e,o,t,a,n,s,r,i){var u=new rx(0,0);if(r?(u.current=r.current,u.total=r.total):(u.current=0,u.total=a.size()),a.size()!==u.total)throw new zO(GO.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;0<n&&(l=Math.min(l,n));r=u.current,n=r+l,c={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},r=a.slice(r,n);if(null===r)throw JO();n=o.maxUploadRetryTime,n=new GP(t,"POST",function(e,t){var n=ix(e,["active","final"]),r=u.current+l,i=a.size(),t="final"===n?YP(o,s)(e,t):null;return new rx(r,i,"final"===n,t)},n);return n.headers=c,n.body=r.uploadData(),n.progressCallback=i||null,n.errorHandler=$P(e),n}var ux=function(e,t,n){"function"==typeof e||null!=t||null!=n?(this.next=e,this.error=t,this.complete=n):(e=e,this.next=e.next,this.error=e.error,this.complete=e.complete)},cx=function(e,t,n,r,i,o){this.bytesTransferred=e,this.totalBytes=t,this.state=n,this.metadata=r,this.task=i,this.ref=o};function lx(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Promise.resolve().then(function(){return n.apply(void 0,e)})}}var hx=(fx.prototype._makeProgressCallback=function(){var t=this,n=this._transferred;return function(e){return t._updateProgress(n+e)}},fx.prototype._shouldDoResumable=function(e){return 262144<e.size()},fx.prototype._start=function(){this._state===hP&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},fx.prototype._resolveToken=function(t){var n=this;this._ref.storage.getAuthToken().then(function(e){switch(n._state){case hP:t(e);break;case gP:n._transition(yP);break;case fP:n._transition(pP)}})},fx.prototype._createResumable=function(){var n=this;this._resolveToken(function(e){var t=ox(n._ref.storage,n._ref._location,n._mappings,n._blob,n._metadata),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._uploadUrl=e,n._needToFetchStatus=!1,n.completeTransitions_()},n._errorHandler)})},fx.prototype._fetchStatus=function(){var n=this,r=this._uploadUrl;this._resolveToken(function(e){var t=ax(n._ref.storage,n._ref._location,r,n._blob),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._updateProgress(e.current),n._needToFetchStatus=!1,e.finalized&&(n._needToFetchMetadata=!0),n.completeTransitions_()},n._errorHandler)})},fx.prototype._continueUpload=function(){var n=this,r=262144*this._chunkMultiplier,i=new rx(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken(function(e){var t;try{t=sx(n._ref._location,n._ref.storage,o,n._blob,r,n._mappings,i,n._makeProgressCallback())}catch(e){return n._error=e,void n._transition(mP)}e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._increaseMultiplier(),n._request=void 0,n._updateProgress(e.current),e.finalized?(n._metadata=e.metadata,n._transition(dP)):n.completeTransitions_()},n._errorHandler)})},fx.prototype._increaseMultiplier=function(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},fx.prototype._fetchMetadata=function(){var n=this;this._resolveToken(function(e){var t=ex(n._ref.storage,n._ref._location,n._mappings),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._metadata=e,n._transition(dP)},n._metadataErrorHandler)})},fx.prototype._oneShotUpload=function(){var n=this;this._resolveToken(function(e){var t=nx(n._ref.storage,n._ref._location,n._mappings,n._blob,n._metadata),e=n._ref.storage.makeRequest(t,e);(n._request=e).getPromise().then(function(e){n._request=void 0,n._metadata=e,n._updateProgress(n._blob.size()),n._transition(dP)},n._errorHandler)})},fx.prototype._updateProgress=function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()},fx.prototype._transition=function(e){if(this._state!==e)switch(e){case gP:case fP:this._state=e,void 0!==this._request&&this._request.cancel();break;case hP:var t=this._state===pP;this._state=e,t&&(this._notifyObservers(),this._start());break;case pP:this._state=e,this._notifyObservers();break;case yP:this._error=XO(),this._state=e,this._notifyObservers();break;case mP:case dP:this._state=e,this._notifyObservers()}},fx.prototype.completeTransitions_=function(){switch(this._state){case fP:this._transition(pP);break;case gP:this._transition(yP);break;case hP:this._start()}},Object.defineProperty(fx.prototype,"snapshot",{get:function(){var e=bP(this._state);return new cx(this._transferred,this._blob.size(),e,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),fx.prototype.on=function(e,t,n,r){var i=this,o=new ux(t,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},fx.prototype.then=function(e,t){return this._promise.then(e,t)},fx.prototype.catch=function(e){return this.then(null,e)},fx.prototype._addObserver=function(e){this._observers.push(e),this._notifyObserver(e)},fx.prototype._removeObserver=function(e){e=this._observers.indexOf(e);-1!==e&&this._observers.splice(e,1)},fx.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach(function(e){t._notifyObserver(e)})},fx.prototype._finishPromise=function(){if(void 0!==this._resolve){var e=!0;switch(bP(this._state)){case vP.SUCCESS:lx(this._resolve.bind(null,this.snapshot))();break;case vP.CANCELED:case vP.ERROR:lx(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}},fx.prototype._notifyObserver=function(e){switch(bP(this._state)){case vP.RUNNING:case vP.PAUSED:e.next&&lx(e.next.bind(e,this.snapshot))();break;case vP.SUCCESS:e.complete&&lx(e.complete.bind(e))();break;case vP.CANCELED:case vP.ERROR:e.error&&lx(e.error.bind(e,this._error))();break;default:e.error&&lx(e.error.bind(e,this._error))()}},fx.prototype.resume=function(){var e=this._state===pP||this._state===fP;return e&&this._transition(hP),e},fx.prototype.pause=function(){var e=this._state===hP;return e&&this._transition(fP),e},fx.prototype.cancel=function(){var e=this._state===hP||this._state===fP;return e&&this._transition(gP),e},fx);function fx(e,t,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=jP(),this._resumable=this._shouldDoResumable(this._blob),this._state=hP,this._errorHandler=function(e){r._request=void 0,r._chunkMultiplier=1,e.codeEquals(GO.CANCELED)?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=e,r._transition(mP))},this._metadataErrorHandler=function(e){r._request=void 0,e.codeEquals(GO.CANCELED)?r.completeTransitions_():(r._error=e,r._transition(mP))},this._promise=new Promise(function(e,t){r._resolve=e,r._reject=t,r._start()}),this._promise.then(null,function(){})}var px=(dx.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},dx.prototype.newRef=function(e,t){return new dx(e,t)},Object.defineProperty(dx.prototype,"root",{get:function(){var e=new RP(this._location.bucket,"");return this.newRef(this._service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(dx.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(dx.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(dx.prototype,"name",{get:function(){return xP(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(dx.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(dx.prototype,"parent",{get:function(){var e=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;e=new RP(this._location.bucket,e);return new dx(this._service,e)},enumerable:!1,configurable:!0}),dx.prototype._throwIfRoot=function(e){if(""===this._location.path)throw eP(e)},dx);function dx(e,t){this._service=e,this._location=t instanceof RP?t:RP.makeFromUrl(t)}function gx(e){var t={prefixes:[],items:[]};return function r(i,o,a){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,yx(i,{pageToken:a})];case 1:return t=e.sent(),(n=o.prefixes).push.apply(n,t.prefixes),(n=o.items).push.apply(n,t.items),null==t.nextPageToken?[3,3]:[4,r(i,o,t.nextPageToken)];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(e,t).then(function(){return t})}function yx(u,c){return _o(this,void 0,void 0,function(){var a,s;return wo(this,function(e){switch(e.label){case 0:return null!=c&&"number"==typeof c.maxResults&&kP("options.maxResults",1,1e3,c.maxResults),[4,u.storage.getAuthToken()];case 1:return a=e.sent(),s=c||{},t=u.storage,n=u._location,r="/",i=s.pageToken,o=s.maxResults,e={},n.isRoot?e.prefix="":e.prefix=n.path+"/",r&&0<r.length&&(e.delimiter=r),i&&(e.pageToken=i),o&&(e.maxResults=o),i=LP(n.bucketOnlyServerUrl()),o=t.maxOperationRetryTime,(o=new GP(i,"GET",XP(t,n.bucket),o)).urlParams=e,o.errorHandler=$P(n),[2,u.storage.makeRequest(o,a).getPromise()]}var t,n,r,i,o})})}function mx(s,u){return _o(this,void 0,void 0,function(){var a;return wo(this,function(e){switch(e.label){case 0:return s._throwIfRoot("updateMetadata"),[4,s.storage.getAuthToken()];case 1:return a=e.sent(),t=s.storage,n=s._location,r=u,i=jP(),o=LP(n.fullServerUrl()),e=KP(r,i),r=t.maxOperationRetryTime,(r=new GP(o,"PATCH",YP(t,i),r)).headers={"Content-Type":"application/json; charset=utf-8"},r.body=e,r.errorHandler=ZP(n),[2,s.storage.makeRequest(r,a).getPromise()]}var t,n,r,i,o})})}function vx(a){return _o(this,void 0,void 0,function(){var o;return wo(this,function(e){switch(e.label){case 0:return a._throwIfRoot("getDownloadURL"),[4,a.storage.getAuthToken()];case 1:return o=e.sent(),t=a.storage,n=a._location,r=jP(),i=LP(n.fullServerUrl()),e=t.maxOperationRetryTime,(e=new GP(i,"GET",JP(t,r),e)).errorHandler=ZP(n),[2,a.storage.makeRequest(e,o).getPromise().then(function(e){if(null===e)throw new zO(GO.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})]}var t,n,r,i})})}function bx(i){return _o(this,void 0,void 0,function(){var r;return wo(this,function(e){switch(e.label){case 0:return i._throwIfRoot("deleteObject"),[4,i.storage.getAuthToken()];case 1:return r=e.sent(),t=i.storage,n=i._location,e=LP(n.fullServerUrl()),t=t.maxOperationRetryTime,(t=new GP(e,"DELETE",function(e,t){},t)).successCodes=[200,204],t.errorHandler=ZP(n),[2,i.storage.makeRequest(t,r).getPromise()]}var t,n})})}function _x(e,t){var n,t=(n=e._location.path,t=(t=t).split("/").filter(function(e){return 0<e.length}).join("/"),0===n.length?t:n+"/"+t),t=new RP(e._location.bucket,t);return new px(e.storage,t)}var wx=(Object.defineProperty(Ex.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(Ex.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Ex.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(Ex.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),Ex);function Ex(e,t,n){this._delegate=e,this.task=t,this.ref=n}var Tx=(Object.defineProperty(Ix.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),Ix.prototype.then=function(t,e){var n=this;return this._delegate.then(function(e){if(t)return t(new wx(e,n,n._ref))},e)},Ix.prototype.on=function(e,t,n,r){var i=this,o=void 0;return t&&(o="function"==typeof t?function(e){return t(new wx(e,i,i._ref))}:{next:t.next?function(e){return t.next(new wx(e,i,i._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,o,n||void 0,r||void 0)},Ix);function Ix(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new wx(this._delegate.snapshot,this,this._ref)}var Sx=(Object.defineProperty(Cx.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map(function(e){return new kx(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(Cx.prototype,"items",{get:function(){var t=this;return this._delegate.items.map(function(e){return new kx(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(Cx.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),Cx);function Cx(e,t){this._delegate=e,this._service=t}var kx=(Object.defineProperty(Ax.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(Ax.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(Ax.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),Ax.prototype.toString=function(){return this._delegate.toString()},Ax.prototype.child=function(e){return new Ax(_x(this._delegate,e),this.storage)},Object.defineProperty(Ax.prototype,"root",{get:function(){return new Ax(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(Ax.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new Ax(e,this.storage)},enumerable:!1,configurable:!0}),Ax.prototype.put=function(e,t){return this._throwIfRoot("put"),new Tx((n=this._delegate,e=e,void 0===(t=t)&&(t=null),n._throwIfRoot("uploadBytesResumable"),new hx(n,new NP(e),t)),this);var n},Ax.prototype.putString=function(e,t,n){return void 0===t&&(t=rP.RAW),this._throwIfRoot("putString"),new Tx((r=this._delegate,e=e,n=n,void 0===(t=t)&&(t=rP.RAW),r._throwIfRoot("putString"),e=oP(t,e),null==(n=bo({},n)).contentType&&null!=e.contentType&&(n.contentType=e.contentType),new hx(r,new NP(e.data,!0),n)),this);var r},Ax.prototype.listAll=function(){var t=this;return gx(this._delegate).then(function(e){return new Sx(e,t.storage)})},Ax.prototype.list=function(e){var t=this;return yx(this._delegate,e).then(function(e){return new Sx(e,t.storage)})},Ax.prototype.getMetadata=function(){return function(r){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return r._throwIfRoot("getMetadata"),[4,r.storage.getAuthToken()];case 1:return t=e.sent(),n=ex(r.storage,r._location,jP()),[2,r.storage.makeRequest(n,t).getPromise()]}})})}(this._delegate)},Ax.prototype.updateMetadata=function(e){return mx(this._delegate,e)},Ax.prototype.getDownloadURL=function(){return vx(this._delegate)},Ax.prototype.delete=function(){return this._throwIfRoot("delete"),bx(this._delegate)},Ax.prototype._throwIfRoot=function(e){if(""===this._delegate._location.path)throw eP(e)},Ax);function Ax(e,t){this._delegate=e,this.storage=t}var Nx=(Dx.prototype.getPromise=function(){return this.promise_},Dx.prototype.cancel=function(e){},Dx);function Dx(e){this.promise_=Promise.reject(e)}var Rx=(Ox.prototype.start_=function(){var t,n,e,r,i,o,a,s,u,c=this;function l(e,t){var n,r=c.resolve_,i=c.reject_,o=t.xhr;if(t.wasSuccessCode)try{var a=c.callback_(o,o.getResponseText());void 0!==a?r(a):r()}catch(e){i(e)}else null!==o?((n=YO()).serverResponse=o.getResponseText(),c.errorCallback_?i(c.errorCallback_(o,n)):i(n)):t.canceled?i(n=(c.appDelete_?ZO:XO)()):i(n=new zO(GO.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}function h(){return 2===a}function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s||(s=!0,n.apply(null,e))}function p(e){i=setTimeout(function(){i=null,t(d,h())},e)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];s||(e||h()||o?f.call.apply(f,So([null,e],t)):(r<64&&(r*=2),p(1===a?(a=2,0):1e3*(r+Math.random()))))}function g(e){u||(u=!0,s||(null!==i?(e||(a=2),clearTimeout(i),p(0)):e||(a=1)))}this.canceled_?l(0,new Px(!1,null,!0)):this.backoffId_=(t=function(r,e){function i(e){var t=e.loaded,e=e.lengthComputable?e.total:-1;null!==c.progressCallback_&&c.progressCallback_(t,e)}e?r(!1,new Px(!1,null,!0)):(e=c.pool_.createXhrIo(),c.pendingXhr_=e,null!==c.progressCallback_&&e.addUploadProgressListener(i),e.send(c.url_,c.method_,c.body_,c.headers_).then(function(e){null!==c.progressCallback_&&e.removeUploadProgressListener(i),c.pendingXhr_=null;var t=e.getErrorCode()===cP.NO_ERROR,n=e.getStatus();t&&!c.isRetryStatusCode_(n)?(n=-1!==c.successCodes_.indexOf(n),r(!0,new Px(n,e))):(e=e.getErrorCode()===cP.ABORT,r(!1,new Px(!1,null,e)))}))},n=l,e=this.timeout_,i=null,u=s=o=!(r=1),p(a=0),setTimeout(function(){g(o=!0)},e),g)},Ox.prototype.getPromise=function(){return this.promise_},Ox.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},Ox.prototype.isRetryStatusCode_=function(e){var t=500<=e&&e<600,n=-1!==[408,429].indexOf(e),e=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||e},Ox);function Ox(e,t,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise(function(e,t){h.resolve_=e,h.reject_=t,h.start_()})}var Px=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n};function xx(e,t,n,r){var i=MP(e.urlParams),o=e.url+i,a=Object.assign({},e.headers);return i=a,(t=t)&&(i["X-Firebase-GMPID"]=t),t=a,null!==(n=n)&&0<n.length&&(t.Authorization="Firebase "+n),t=a,n=void 0!==Jh?Jh.SDK_VERSION:"AppManager",t["X-Firebase-Storage-Version"]="webjs/"+n,new Rx(o,e.method,a,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r)}function Lx(e){return/^[A-Za-z]+:\/\//.test(e)}function Mx(e,t){if(e instanceof Ux){var n=e;if(null==n._bucket)throw new zO(GO.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+WO+"' property when initializing the app?");n=new px(n,n._bucket);return null!=t?Mx(n,t):n}if(void 0===t)return e;if(t.includes(".."))throw $O('`path` param cannot contain ".."');return _x(e,t)}function Fx(e,t){if(t&&Lx(t)){if(e instanceof Ux)return new px(e,t);throw $O("To use ref(service, url), the first argument must be a Storage instance.")}return Mx(e,t)}var Ux=(Object.defineProperty(qx.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(e){kP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(qx.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(e){kP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e},enumerable:!1,configurable:!0}),qx.prototype.getAuthToken=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(t=e.sent()))return[2,t.accessToken];e.label=2;case 2:return[2,null]}})})},qx.prototype._delete=function(){return this._deleted=!0,this._requests.forEach(function(e){return e.cancel()}),this._requests.clear(),Promise.resolve()},qx.prototype.makeStorageReference=function(e){return new px(this,e)},qx.prototype.makeRequest=function(e,t){var n=this;if(this._deleted)return new Nx(ZO());var r=xx(e,this._appId,t,this._pool);return this._requests.add(r),r.getPromise().then(function(){return n._requests.delete(r)},function(){return n._requests.delete(r)}),r},qx);function qx(e,t,n,r){this.app=e,this._authProvider=t,this._pool=n,this._url=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?RP.makeFromBucketSpec(r):null==(r=null==(r=this.app.options)?void 0:r[WO])?null:RP.makeFromBucketSpec(r)}var jx=(Object.defineProperty(Vx.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(Vx.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),Vx.prototype.ref=function(e){if(Lx(e))throw $O("ref() expected a child path but got a URL, use refFromURL instead.");return new kx(Fx(this._delegate,e),this)},Vx.prototype.refFromURL=function(e){if(!Lx(e))throw $O("refFromURL() expected a full URL but got a child path, use ref() instead.");try{RP.makeFromUrl(e)}catch(e){throw $O("refFromUrl() expected a valid full URL but got an invalid one.")}return new kx(Fx(this._delegate,e),this)},Vx.prototype.setMaxUploadRetryTime=function(e){this._delegate.maxUploadRetryTime=e},Vx.prototype.setMaxOperationRetryTime=function(e){this._delegate.maxOperationRetryTime=e},Vx);function Vx(e,t){var n=this;this.app=e,this._delegate=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}var Bx,Kx;function Wx(e,t){var n=e.getProvider("app").getImmediate(),e=e.getProvider("auth-internal");return new jx(n,new Ux(n,e,new EP,t))}Kx={TaskState:vP,TaskEvent:lP,StringFormat:rP,Storage:Ux,Reference:kx},(Bx=Jh).INTERNAL.registerComponent(new _a("storage",Wx,"PUBLIC").setServiceProps(Kx).setMultipleInstances(!0)),Bx.registerVersion("@firebase/storage","0.4.2-1.0.0-eap-firestore-debug.9c6096f43");var zx,Hx,Gx="0.4.4-1.0.0-eap-firestore-debug.9c6096f43",Qx=Gx,Yx="FB-PERF-TRACE-MEASURE",Xx="@firebase/performance/config",Jx="@firebase/performance/configexpire",ge="Performance",de=((de={})["trace started"]="Trace {$traceName} was started before.",de["trace stopped"]="Trace {$traceName} is not running.",de["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",de["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",de["no window"]="Window is not available.",de["no app id"]="App id is not available.",de["no project id"]="Project id is not available.",de["no api key"]="Api key is not available.",de["invalid cc log"]="Attempted to queue invalid cc event",de["FB not default"]="Performance can only start when Firebase app instance is the default one.",de["RC response not ok"]="RC response is not ok",de["invalid attribute name"]="Attribute name {$attributeName} is invalid.",de["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",de["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",de["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",de),$x=new Qo("performance",ge,de),Zx=new xa(ge);Zx.logLevel=Aa.INFO;var eL,tL=(nL.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},nL.prototype.mark=function(e){this.performance&&this.performance.mark&&this.performance.mark(e)},nL.prototype.measure=function(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)},nL.prototype.getEntriesByType=function(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]},nL.prototype.getEntriesByName=function(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]},nL.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},nL.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Vo()||(Zx.info("IndexedDB is not supported by current browswer"),!1):(Zx.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},nL.prototype.setupObserver=function(e,i){this.PerformanceObserver&&new this.PerformanceObserver(function(e){for(var t=0,n=e.getEntries();t<n.length;t++){var r=n[t];i(r)}}).observe({entryTypes:[e]})},nL.getInstance=function(){return void 0===zx&&(zx=new nL(Hx)),zx},nL);function nL(e){if(!(this.window=e))throw $x.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}function rL(e,t){var n=e.length-t.length;if(n<0||1<n)throw $x.create("invalid String merger input");for(var r=[],i=0;i<e.length;i++)r.push(e.charAt(i)),t.length>i&&r.push(t.charAt(i));return r.join("")}var iL,oL,aL=(sL.prototype.getAppId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!e)throw $x.create("no app id");return e},sL.prototype.getProjectId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!e)throw $x.create("no project id");return e},sL.prototype.getApiKey=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!e)throw $x.create("no api key");return e},sL.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},sL.getInstance=function(){return void 0===eL&&(eL=new sL),eL},sL);function sL(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=rL("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=rL("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}(ge=oL=oL||{})[ge.UNKNOWN=0]="UNKNOWN",ge[ge.VISIBLE=1]="VISIBLE",ge[ge.HIDDEN=2]="HIDDEN";var uL=["firebase_","google_","ga_"],cL=new RegExp("^[a-zA-Z]\\w*$");function lL(){switch(tL.getInstance().document.visibilityState){case"visible":return oL.VISIBLE;case"hidden":return oL.HIDDEN;default:return oL.UNKNOWN}}var hL="0.0.1",fL={loggingEnabled:!0},pL="FIREBASE_INSTALLATIONS_AUTH";function dL(e){var n,t=function(){var e=tL.getInstance().localStorage;if(!e)return;var t=e.getItem(Jx);if(!t||!function(e){return Number(e)>Date.now()}(t))return;var n=e.getItem(Xx);if(!n)return;try{return JSON.parse(n)}catch(e){return}}();return t?(yL(t),Promise.resolve()):(n=e,function(){var e=aL.getInstance().installationsService.getToken();return e.then(function(e){}),e}().then(function(e){var t="https://firebaseremoteconfig.googleapis.com/v1/projects/"+aL.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+aL.getInstance().getApiKey(),e=new Request(t,{method:"POST",headers:{Authorization:pL+" "+e},body:JSON.stringify({app_instance_id:n,app_instance_id_token:e,app_id:aL.getInstance().getAppId(),app_version:Qx,sdk_version:hL})});return fetch(e).then(function(e){if(e.ok)return e.json();throw $x.create("RC response not ok")})}).catch(function(){Zx.info(gL)}).then(yL).then(function(e){var t=tL.getInstance().localStorage;if(!e||!t)return;t.setItem(Xx,JSON.stringify(e)),t.setItem(Jx,String(Date.now()+60*aL.getInstance().configTimeToLive*60*1e3))},function(){}))}var gL="Could not fetch config, will use default configs";function yL(e){if(!e)return e;var t=aL.getInstance(),n=e.entries||{};return t.loggingEnabled=void 0!==n.fpr_enabled?"true"===String(n.fpr_enabled):fL.loggingEnabled,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=mL(t.tracesSamplingRate),t.logNetworkAfterSampling=mL(t.networkRequestsSamplingRate),e}function mL(e){return Math.random()<=e}var vL,bL=1;function _L(){return bL=2,vL=vL||function(){var n=tL.getInstance().document;return new Promise(function(e){var t;n&&"complete"!==n.readyState?(t=function(){"complete"===n.readyState&&(n.removeEventListener("readystatechange",t),e())},n.addEventListener("readystatechange",t)):e()})}().then(function(){return(e=aL.getInstance().installationsService.getId()).then(function(e){iL=e}),e;var e}).then(dL).then(wL,wL)}function wL(){bL=3}var EL,TL=1e4,IL=5500,SL=3,CL=SL,kL=[],AL=!1;function NL(e){setTimeout(function(){if(0!==CL)return kL.length?void function(){var e=So(kL);kL=[];var t=e.map(function(e){return{source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}});(function(e,r){return function(e){var t=aL.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then(function(e){return e.ok||Zx.info("Call to Firebase backend failed."),e.json()}).then(function(e){var t=Number(e.nextRequestWaitMillis),n=TL;isNaN(t)||(n=Math.max(t,n));e=e.logResponseDetails;Array.isArray(e)&&0<e.length&&"RETRY_REQUEST_LATER"===e[0].responseAction&&(kL=So(r,kL),Zx.info("Retry transport request later.")),CL=SL,NL(n)})})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:aL.getInstance().logSource,log_event:t},e).catch(function(){kL=So(e,kL),CL--,Zx.info("Tries left: "+CL+"."),NL(TL)})}():NL(TL)},e)}function DL(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!function(e){if(!e.eventTime||!e.message)throw $x.create("invalid cc log");kL=So(kL,[e])}({message:n.apply(void 0,e),eventTime:Date.now()})}}function RL(e,t){(EL=EL||DL(xL))(e,t)}function OL(e){var t=aL.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&tL.getInstance().requiredApisAvailable()&&(e.isAuto&&lL()!==oL.VISIBLE||(3===bL?PL(e):_L().then(function(){return PL(e)},function(){return PL(e)})))}function PL(e){var t;!iL||(t=aL.getInstance()).loggingEnabled&&t.logTraceAfterSampling&&setTimeout(function(){return RL(e,1)},0)}function xL(e,t){return(0===t?function(e){e={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},e={application_info:LL(),network_request_metric:e};return JSON.stringify(e)}:function(e){var t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);e=e.getAttributes();0!==Object.keys(e).length&&(t.custom_attributes=e);t={application_info:LL(),trace_metric:t};return JSON.stringify(t)})(e)}function LL(){return{google_app_id:aL.getInstance().getAppId(),app_instance_id:iL,web_app_info:{sdk_version:Qx,page_url:tL.getInstance().getUrl(),service_worker_status:"serviceWorker"in(e=tL.getInstance().navigator)?e.serviceWorker.controller?2:3:1,visibility_state:lL(),effective_connection_type:function(){var e=tL.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}var ML=["_fp","_fcp","_fid"];var FL=(UL.prototype.start=function(){if(1!==this.state)throw $x.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},UL.prototype.stop=function(){if(2!==this.state)throw $x.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),OL(this)},UL.prototype.record=function(e,t,n){if(e<=0)throw $x.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw $x.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=bo({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}OL(this)},UL.prototype.incrementMetric=function(e,t){void 0===t&&(t=1),void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)},UL.prototype.putMetric=function(e,t){if(n=e,r=this.name,0===n.length||100<n.length||!(r&&r.startsWith("_wt_")&&-1<ML.indexOf(n))&&n.startsWith("_"))throw $x.create("invalid custom metric name",{customMetricName:e});var n,r;this.counters[e]=(e=t,(t=Math.floor(e))<e&&Zx.info("Metric value should be an Integer, setting the value as : "+t+"."),t)},UL.prototype.getMetric=function(e){return this.counters[e]||0},UL.prototype.putAttribute=function(e,t){var n,r,i=!(0===(n=e).length||40<n.length)&&(!uL.some(function(e){return n.startsWith(e)})&&!!n.match(cL)),r=0!==(r=t).length&&r.length<=100;if(i&&r)this.customAttributes[e]=t;else{if(!i)throw $x.create("invalid attribute name",{attributeName:e});if(!r)throw $x.create("invalid attribute value",{attributeValue:t})}},UL.prototype.getAttribute=function(e){return this.customAttributes[e]},UL.prototype.removeAttribute=function(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]},UL.prototype.getAttributes=function(){return bo({},this.customAttributes)},UL.prototype.setStartTime=function(e){this.startTimeUs=e},UL.prototype.setDuration=function(e){this.durationUs=e},UL.prototype.calculateTraceMetrics=function(){var e=this.api.getEntriesByName(this.traceMeasure),e=e&&e[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},UL.createOobTrace=function(e,t,n){var r,i=tL.getInstance().getUrl();i&&(r=new UL("_wt_"+i,!0),i=Math.floor(1e3*tL.getInstance().getTimeOrigin()),r.setStartTime(i),e&&e[0]&&(r.setDuration(Math.floor(1e3*e[0].duration)),r.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),r.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),r.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),t&&((e=t.find(function(e){return"first-paint"===e.name}))&&e.startTime&&r.putMetric("_fp",Math.floor(1e3*e.startTime)),(t=t.find(function(e){return"first-contentful-paint"===e.name}))&&t.startTime&&r.putMetric("_fcp",Math.floor(1e3*t.startTime)),n&&r.putMetric("_fid",Math.floor(1e3*n))),OL(r))},UL.createUserTimingTrace=function(e){OL(new UL(e,!1,e))},UL);function UL(e,t,n){void 0===t&&(t=!1),this.name=e,this.isAuto=t,this.state=1,this.customAttributes={},this.counters={},this.api=tL.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||Yx+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}function qL(e){var t,n,r,i=e;i&&void 0!==i.responseStart&&(n=tL.getInstance().getTimeOrigin(),r=Math.floor(1e3*(i.startTime+n)),e=i.responseStart?Math.floor(1e3*(i.responseStart-i.startTime)):void 0,n=Math.floor(1e3*(i.responseEnd-i.startTime)),i={url:i.name&&i.name.split("?")[0],responsePayloadBytes:i.transferSize,startTimeUs:r,timeToResponseInitiatedUs:e,timeToResponseCompletedUs:n},t=i,(r=aL.getInstance()).instrumentationEnabled&&(e=t.url,n=r.logEndPointUrl.split("?")[0],i=r.flTransportEndpointUrl.split("?")[0],e!==n&&e!==i&&r.loggingEnabled&&r.logNetworkAfterSampling&&setTimeout(function(){return RL(t,0)},0)))}var jL=5e3;function VL(){iL&&(setTimeout(function(){var e=tL.getInstance(),t=e.getEntriesByType("navigation"),n=e.getEntriesByType("paint");{var r;e.onFirstInputDelay?(r=setTimeout(function(){FL.createOobTrace(t,n),r=void 0},jL),e.onFirstInputDelay(function(e){r&&(clearTimeout(r),FL.createOobTrace(t,n,e))})):FL.createOobTrace(t,n)}},0),setTimeout(function(){for(var e=tL.getInstance(),t=e.getEntriesByType("resource"),n=0,r=t;n<r.length;n++){qL(r[n])}e.setupObserver("resource",qL)},0),setTimeout(function(){for(var e=tL.getInstance(),t=e.getEntriesByType("measure"),n=0,r=t;n<r.length;n++){BL(r[n])}e.setupObserver("measure",BL)},0))}function BL(e){e=e.name;e.substring(0,Yx.length)!==Yx&&FL.createUserTimingTrace(e)}var KL=(WL.prototype.trace=function(e){return new FL(e)},Object.defineProperty(WL.prototype,"instrumentationEnabled",{get:function(){return aL.getInstance().instrumentationEnabled},set:function(e){aL.getInstance().instrumentationEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(WL.prototype,"dataCollectionEnabled",{get:function(){return aL.getInstance().dataCollectionEnabled},set:function(e){aL.getInstance().dataCollectionEnabled=e},enumerable:!1,configurable:!0}),WL);function WL(e){this.app=e,tL.getInstance().requiredApisAvailable()&&Bo().then(function(e){e&&(AL||(NL(IL),AL=!0),_L().then(VL,VL))}).catch(function(e){Zx.info("Environment doesn't support IndexedDB: "+e)})}var zL;function HL(e,t){if("[DEFAULT]"!==e.name)throw $x.create("FB not default");if("undefined"==typeof window)throw $x.create("no window");return Hx=window,aL.getInstance().firebaseAppInstance=e,aL.getInstance().installationsService=t,new KL(e)}(zL=Jh).INTERNAL.registerComponent(new _a("performance",function(e){var t=e.getProvider("app").getImmediate(),e=e.getProvider("installations").getImmediate();return HL(t,e)},"PUBLIC")),zL.registerVersion("@firebase/performance",Gx);var GL,QL,YL="firebase_id",XL="origin",JL=6e4,$L="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ZL="https://www.googletagmanager.com/gtag/js";(ge=GL=GL||{}).EVENT="event",ge.SET="set",ge.CONFIG="config",(ge=QL=QL||{}).ADD_SHIPPING_INFO="add_shipping_info",ge.ADD_PAYMENT_INFO="add_payment_info",ge.ADD_TO_CART="add_to_cart",ge.ADD_TO_WISHLIST="add_to_wishlist",ge.BEGIN_CHECKOUT="begin_checkout",ge.CHECKOUT_PROGRESS="checkout_progress",ge.EXCEPTION="exception",ge.GENERATE_LEAD="generate_lead",ge.LOGIN="login",ge.PAGE_VIEW="page_view",ge.PURCHASE="purchase",ge.REFUND="refund",ge.REMOVE_FROM_CART="remove_from_cart",ge.SCREEN_VIEW="screen_view",ge.SEARCH="search",ge.SELECT_CONTENT="select_content",ge.SELECT_ITEM="select_item",ge.SELECT_PROMOTION="select_promotion",ge.SET_CHECKOUT_OPTION="set_checkout_option",ge.SHARE="share",ge.SIGN_UP="sign_up",ge.TIMING_COMPLETE="timing_complete",ge.VIEW_CART="view_cart",ge.VIEW_ITEM="view_item",ge.VIEW_ITEM_LIST="view_item_list",ge.VIEW_PROMOTION="view_promotion",ge.VIEW_SEARCH_RESULTS="view_search_results";var eM=new xa("@firebase/analytics");function tM(o,a,s,u){return function(n,r,i){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),n!==GL.EVENT?[3,2]:[4,function(u,c,l,h,f){return _o(this,void 0,void 0,function(){var n,r,t,i,o,a,s;return wo(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),n=[],f&&f.send_to)?(s=f.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(l)]):[3,2];case 1:for(r=e.sent(),t=function(t){var e=r.find(function(e){return e.measurementId===t}),e=e&&c[e.appId];if(!e)return n=[],"break";n.push(e)},i=0,o=s;i<o.length&&(a=o[i],"break"!==t(a));i++);e.label=2;case 2:return 0===n.length&&(n=Object.values(c)),[4,Promise.all(n)];case 3:return e.sent(),u(GL.EVENT,h,f||{}),[3,5];case 4:return s=e.sent(),eM.error(s),[3,5];case 5:return[2]}})})}(o,a,s,r,i)];case 1:return e.sent(),[3,5];case 2:return n!==GL.CONFIG?[3,4]:[4,function(r,i,o,a,s,u){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:t=a[s],e.label=1;case 1:return e.trys.push([1,7,,8]),t?[4,i[t]]:[3,3];case 2:return e.sent(),[3,6];case 3:return[4,Promise.all(o)];case 4:return n=e.sent(),(n=n.find(function(e){return e.measurementId===s}))?[4,i[n.appId]]:[3,6];case 5:e.sent(),e.label=6;case 6:return[3,8];case 7:return n=e.sent(),eM.error(n),[3,8];case 8:return r(GL.CONFIG,s,u),[2]}})})}(o,a,s,u,r,i)];case 3:return e.sent(),[3,5];case 4:o(GL.SET,r),e.label=5;case 5:return[3,7];case 6:return t=e.sent(),eM.error(t),[3,7];case 7:return[2]}})})}}var ge=((ge={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",ge["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",ge["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",ge["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ge["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ge["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",ge["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",ge["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',ge["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',ge),nM=new Qo("analytics","Analytics",ge),rM=30;function iM(e,t){void 0===e&&(e={}),void 0===t&&(t=1e3),this.throttleMetadata=e,this.intervalMillis=t}var oM=new(iM.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},iM.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},iM.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},iM);function aM(o){var a;return _o(this,void 0,void 0,function(){var t,n,r,i;return wo(this,function(e){switch(e.label){case 0:return t=o.appId,i=o.apiKey,i={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":i})},t=$L.replace("{app-id}",t),[4,fetch(t,i)];case 1:if(200===(n=e.sent()).status||304===n.status)return[3,6];r="",e.label=2;case 2:return e.trys.push([2,4,,5]),[4,n.json()];case 3:return i=e.sent(),null!==(a=i.error)&&void 0!==a&&a.message&&(r=i.error.message),[3,5];case 4:return e.sent(),[3,5];case 5:throw nM.create("config-fetch-failed",{httpStatus:n.status,responseMessage:r});case 6:return[2,n.json()]}})})}function sM(s,u,c){return void 0===u&&(u=oM),_o(this,void 0,void 0,function(){var t,n,r,i,o,a=this;return wo(this,function(e){if(i=s.options,t=i.appId,n=i.apiKey,r=i.measurementId,!t)throw nM.create("no-app-id");if(n)return i=u.getThrottleMetadata(t)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new cM,setTimeout(function(){return _o(a,void 0,void 0,function(){return wo(this,function(e){return o.abort(),[2]})})},void 0!==c?c:JL),[2,function u(c,e,l,h){var f=e.throttleEndTimeMillis,p=e.backoffCount;void 0===h&&(h=oM);return _o(this,void 0,void 0,function(){var t,n,r,a,s;return wo(this,function(e){switch(e.label){case 0:t=c.appId,n=c.measurementId,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(i=l,o=f,new Promise(function(e,t){var n=Math.max(o-Date.now(),0),r=setTimeout(e,n);i.addEventListener(function(){clearTimeout(r),t(nM.create("fetch-throttle",{throttleEndTimeMillis:o}))})}))];case 2:return e.sent(),[3,4];case 3:if(a=e.sent(),n)return eM.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:t,measurementId:n}];throw a;case 4:return e.trys.push([4,6,,7]),[4,aM(c)];case 5:return s=e.sent(),h.deleteThrottleMetadata(t),[2,s];case 6:if(uM(r=e.sent()))return a=503===Number(r.customData.httpStatus)?ba(p,h.intervalMillis,rM):ba(p,h.intervalMillis),s={throttleEndTimeMillis:Date.now()+a,backoffCount:p+1},h.setThrottleMetadata(t,s),eM.debug("Calling attemptFetch again in "+a+" millis"),[2,u(c,s,l,h)];if(h.deleteThrottleMetadata(t),n)return eM.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+r.message+"]"),[2,{appId:t,measurementId:n}];throw r;case 7:return[2]}var i,o})})}({appId:t,apiKey:n,measurementId:r},i,o,u)];if(r)return[2,{measurementId:r,appId:t}];throw nM.create("no-api-key")})})}function uM(e){if(e instanceof Ho&&e.customData){e=Number(e.customData.httpStatus);return 429===e||500===e||503===e||504===e}}var cM=(lM.prototype.addEventListener=function(e){this.listeners.push(e)},lM.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},lM);function lM(){this.listeners=[]}function hM(i,o,a,s,u){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return(t=sM(i)).then(function(e){a[e.measurementId]=e.appId,i.options.measurementId&&e.measurementId!==i.options.measurementId&&eM.warn("The measurement ID in the local Firebase config ("+i.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(e){return eM.error(e)}),o.push(t),n=function(){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return Vo()?[3,1]:(eM.warn(nM.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,Bo()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),eM.warn(nM.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})}().then(function(e){return e?s.getId():void 0}),[4,Promise.all([t,n])];case 1:return r=e.sent(),t=r[0],n=r[1],u("js",new Date),(r={})[XL]="firebase",r.update=!0,r=r,null!=n&&(r[YL]=n),u(GL.CONFIG,t.measurementId,r),[2,t.measurementId]}})})}var fM,pM,dM={},gM=[],yM={},mM="dataLayer",vM="gtag",bM=!1;function _M(e){if(bM)throw nM.create("already-initialized");e.dataLayerName&&(mM=e.dataLayerName),e.gtagName&&(vM=e.gtagName)}function wM(e,t){n=[],Uo()&&n.push("This is a browser extension environment."),Ko()||n.push("Cookies are not available."),0<n.length&&(n=n.map(function(e,t){return"("+(t+1)+") "+e}).join(" "),n=nM.create("invalid-analytics-context",{errorInfo:n}),eM.warn(n.message));var n,r,i,o,a,s,u=e.options.appId;if(!u)throw nM.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw nM.create("no-api-key");eM.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=dM[u])throw nM.create("already-exists",{id:u});return bM||(function(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(ZL))return r}}()||(a=mM,(s=document.createElement("script")).src=ZL+"?l="+a,s.async=!0,document.head.appendChild(s)),i=mM,o=[],Array.isArray(window[i])?o=window[i]:window[i]=o,n=dM,a=gM,s=yM,r=mM,i=vM,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[r].push(arguments)},window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=tM(o,n,a,s),i={gtagCore:o,wrappedGtag:window[i]},pM=i.wrappedGtag,fM=i.gtagCore,bM=!0),dM[u]=hM(e,gM,yM,t,fM),{app:e,logEvent:function(e,t,n){(function(n,r,i,o,a){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return a&&a.global?(n(GL.EVENT,i,o),[2]):[3,1];case 1:return[4,r];case 2:t=e.sent(),t=bo(bo({},o),{send_to:t}),n(GL.EVENT,i,t),e.label=3;case 3:return[2]}})})})(pM,dM[u],e,t,n).catch(function(e){return eM.error(e)})},setCurrentScreen:function(e,t){(function(n,r,i,o){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return o&&o.global?(n(GL.SET,{screen_name:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(GL.CONFIG,t,{update:!0,screen_name:i}),e.label=3;case 3:return[2]}})})})(pM,dM[u],e,t).catch(function(e){return eM.error(e)})},setUserId:function(e,t){(function(n,r,i,o){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return o&&o.global?(n(GL.SET,{user_id:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(GL.CONFIG,t,{update:!0,user_id:i}),e.label=3;case 3:return[2]}})})})(pM,dM[u],e,t).catch(function(e){return eM.error(e)})},setUserProperties:function(e,t){(function(a,s,u,c){return _o(this,void 0,void 0,function(){var t,n,r,i,o;return wo(this,function(e){switch(e.label){case 0:if(!c||!c.global)return[3,1];for(t={},n=0,r=Object.keys(u);n<r.length;n++)i=r[n],t["user_properties."+i]=u[i];return a(GL.SET,t),[2,Promise.resolve()];case 1:return[4,s];case 2:o=e.sent(),a(GL.CONFIG,o,{update:!0,user_properties:u}),e.label=3;case 3:return[2]}})})})(pM,dM[u],e,t).catch(function(e){return eM.error(e)})},setAnalyticsCollectionEnabled:function(e){(function(n,r){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,n];case 1:return t=e.sent(),window["ga-disable-"+t]=!r,[2]}})})})(dM[u],e).catch(function(e){return eM.error(e)})},INTERNAL:{delete:function(){return delete dM[u],Promise.resolve()}}}}var EM,TM="analytics";function IM(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:if(Uo())return[2,!1];if(!Ko())return[2,!1];if(!Vo())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Bo()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}})})}(EM=Jh).INTERNAL.registerComponent(new _a(TM,function(e){return wM(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:_M,EventName:QL,isSupported:IM})),EM.INTERNAL.registerComponent(new _a("analytics-internal",function(e){try{return{logEvent:e.getProvider(TM).getImmediate().logEvent}}catch(e){throw nM.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),EM.registerVersion("@firebase/analytics","0.6.2-1.0.0-eap-firestore-debug.9c6096f43");var SM=(CM.prototype.isCachedDataFresh=function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,t=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+e+". Is cache hit: "+t+"."),t},CM.prototype.fetch=function(i){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return(r=e.sent(),t=r[0],(r=r[1])&&this.isCachedDataFresh(i.cacheMaxAgeMillis,t))?[2,r]:(i.eTag=r&&r.eTag,[4,this.client.fetch(i)]);case 2:return n=e.sent(),r=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===n.status&&r.push(this.storage.setLastSuccessfulFetchResponse(n)),[4,Promise.all(r)];case 3:return e.sent(),[2,n]}})})},CM);function CM(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}var ge=((ge={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",ge["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",ge["registration-api-key"]="Undefined API key. Check Firebase app initialization.",ge["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",ge["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",ge["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",ge["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",ge["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",ge["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",ge["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',ge["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',ge["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",ge["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",ge),kM=new Qo("remoteconfig","Remote Config",ge);var AM=(NM.prototype.fetch=function(f){return _o(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,h;return wo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:o=e.sent(),n=o[0],i=o[1],r=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=r+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,r={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":f.eTag||"*"},i={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:this.appId,language_code:(void 0===t&&(t=navigator),t.languages&&t.languages[0]||t.language)},i={method:"POST",headers:r,body:JSON.stringify(i)},o=fetch(o,i),i=new Promise(function(e,t){f.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",t(e)})}),e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Promise.race([o,i])];case 3:return e.sent(),[4,o];case 4:return h=e.sent(),[3,6];case 5:throw i=e.sent(),o="fetch-client-network","AbortError"===i.name&&(o="fetch-timeout"),kM.create(o,{originalErrorMessage:i.message});case 6:if(a=h.status,s=h.headers.get("ETag")||void 0,200!==h.status)return[3,11];l=void 0,e.label=7;case 7:return e.trys.push([7,9,,10]),[4,h.json()];case 8:return l=e.sent(),[3,10];case 9:throw h=e.sent(),kM.create("fetch-client-parse",{originalErrorMessage:h.message});case 10:u=l.entries,c=l.state,e.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===c?a=500:"NO_CHANGE"===c?a=304:"NO_TEMPLATE"!==c&&"EMPTY_CONFIG"!==c||(u={}),304!==a&&200!==a)throw kM.create("fetch-status",{httpStatus:a});return[2,{status:a,eTag:s,config:u}]}var t})})},NM);function NM(e,t,n,r,i,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}var DM=(RM.prototype.addEventListener=function(e){this.listeners.push(e)},RM.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},RM);function RM(){this.listeners=[]}var OM=["1","true","t","yes","y","on"],PM=(xM.prototype.asString=function(){return this._value},xM.prototype.asBoolean=function(){return"static"!==this._source&&0<=OM.indexOf(this._value.toLowerCase())},xM.prototype.asNumber=function(){if("static"===this._source)return 0;var e=Number(this._value);return isNaN(e)&&(e=0),e},xM.prototype.getSource=function(){return this._source},xM);function xM(e,t){void 0===t&&(t=""),this._source=e,this._value=t}var LM=(MM.prototype.setLogLevel=function(e){switch(e){case"debug":this._logger.logLevel=Aa.DEBUG;break;case"silent":this._logger.logLevel=Aa.SILENT;break;default:this._logger.logLevel=Aa.ERROR}},Object.defineProperty(MM.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(MM.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),MM.prototype.activate=function(){return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return n=e.sent(),t=n[0],n=n[1],t&&t.config&&t.eTag&&t.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(t.config),this._storage.setActiveConfigEtag(t.eTag)])]:[2,!1];case 2:return e.sent(),[2,!0]}})})},MM.prototype.ensureInitialized=function(){var e=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then(function(){e._isInitializationComplete=!0})),this._initializePromise},MM.prototype.fetch=function(){return _o(this,void 0,void 0,function(){var r,i,o,a=this;return wo(this,function(e){switch(e.label){case 0:r=new DM,setTimeout(function(){return _o(a,void 0,void 0,function(){return wo(this,function(e){return r.abort(),[2]})})},this.settings.fetchTimeoutMillis),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:r})];case 2:return e.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return e.sent(),[3,6];case 4:return i=e.sent(),n="fetch-throttle",o=(t=i)instanceof Ho&&-1!==t.code.indexOf(n)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(o)];case 5:throw e.sent(),i;case 6:return[2]}var t,n})})},MM.prototype.fetchAndActivate=function(){return _o(this,void 0,void 0,function(){return wo(this,function(e){switch(e.label){case 0:return[4,this.fetch()];case 1:return e.sent(),[2,this.activate()]}})})},MM.prototype.getAll=function(){var n=this;return function(e,t){void 0===e&&(e={});void 0===t&&(t={});return Object.keys(bo(bo({},e),t))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce(function(e,t){return e[t]=n.getValue(t),e},{})},MM.prototype.getBoolean=function(e){return this.getValue(e).asBoolean()},MM.prototype.getNumber=function(e){return this.getValue(e).asNumber()},MM.prototype.getString=function(e){return this.getValue(e).asString()},MM.prototype.getValue=function(e){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+e+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var t=this._storageCache.getActiveConfig();return t&&void 0!==t[e]?new PM("remote",t[e]):this.defaultConfig&&void 0!==this.defaultConfig[e]?new PM("default",String(this.defaultConfig[e])):(this._logger.debug('Returning static value for key "'+e+'". Define a default or remote value if this is unintentional.'),new PM("static"))},MM);function MM(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}function FM(e,t){e=e.target.error||void 0;return kM.create(t,{originalErrorMessage:e&&e.message})}var UM="app_namespace_store",qM="firebase_remote_config",jM=1;var VM=(BM.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},BM.prototype.setLastFetchStatus=function(e){return this.set("last_fetch_status",e)},BM.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},BM.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.set("last_successful_fetch_timestamp_millis",e)},BM.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},BM.prototype.setLastSuccessfulFetchResponse=function(e){return this.set("last_successful_fetch_response",e)},BM.prototype.getActiveConfig=function(){return this.get("active_config")},BM.prototype.setActiveConfig=function(e){return this.set("active_config",e)},BM.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},BM.prototype.setActiveConfigEtag=function(e){return this.set("active_config_etag",e)},BM.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},BM.prototype.setThrottleMetadata=function(e){return this.set("throttle_metadata",e)},BM.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},BM.prototype.get=function(s){return _o(this,void 0,void 0,function(){var o,a=this;return wo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(t,n){var e=o.transaction([UM],"readonly").objectStore(UM),r=a.createCompositeKey(s);try{var i=e.get(r);i.onerror=function(e){n(FM(e,"storage-get"))},i.onsuccess=function(e){e=e.target.result;t(e?e.value:void 0)}}catch(e){n(kM.create("storage-get",{originalErrorMessage:e&&e.message}))}})]}})})},BM.prototype.set=function(s,u){return _o(this,void 0,void 0,function(){var o,a=this;return wo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(e,t){var n=o.transaction([UM],"readwrite").objectStore(UM),r=a.createCompositeKey(s);try{var i=n.put({compositeKey:r,value:u});i.onerror=function(e){t(FM(e,"storage-set"))},i.onsuccess=function(){e()}}catch(e){t(kM.create("storage-set",{originalErrorMessage:e&&e.message}))}})]}})})},BM.prototype.delete=function(s){return _o(this,void 0,void 0,function(){var o,a=this;return wo(this,function(e){switch(e.label){case 0:return[4,this.openDbPromise];case 1:return o=e.sent(),[2,new Promise(function(e,t){var n=o.transaction([UM],"readwrite").objectStore(UM),r=a.createCompositeKey(s);try{var i=n.delete(r);i.onerror=function(e){t(FM(e,"storage-delete"))},i.onsuccess=function(){e()}}catch(e){t(kM.create("storage-delete",{originalErrorMessage:e&&e.message}))}})]}})})},BM.prototype.createCompositeKey=function(e){return[this.appId,this.appName,this.namespace,e].join()},BM);function BM(e,t,n,r){void 0===r&&(r=new Promise(function(t,n){var e=indexedDB.open(qM,jM);e.onerror=function(e){n(FM(e,"storage-open"))},e.onsuccess=function(e){t(e.target.result)},e.onupgradeneeded=function(e){var t=e.target.result;0===e.oldVersion&&t.createObjectStore(UM,{keyPath:"compositeKey"})}})),this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}var KM=(WM.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},WM.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},WM.prototype.getActiveConfig=function(){return this.activeConfig},WM.prototype.loadFromStorage=function(){return _o(this,void 0,void 0,function(){var t,n,r;return wo(this,function(e){switch(e.label){case 0:return t=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),[4,t];case 1:return(t=e.sent())&&(this.lastFetchStatus=t),[4,n];case 2:return(n=e.sent())&&(this.lastSuccessfulFetchTimestampMillis=n),[4,r];case 3:return(r=e.sent())&&(this.activeConfig=r),[2]}})})},WM.prototype.setLastFetchStatus=function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)},WM.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)},WM.prototype.setActiveConfig=function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)},WM);function WM(e){this.storage=e}var zM=(HM.prototype.fetch=function(n){return _o(this,void 0,void 0,function(){var t;return wo(this,function(e){switch(e.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return t=e.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(n,t)]}})})},HM.prototype.attemptFetch=function(r,e){var a=e.throttleEndTimeMillis,s=e.backoffCount;return _o(this,void 0,void 0,function(){var t,n;return wo(this,function(e){switch(e.label){case 0:return[4,(i=r.signal,o=a,new Promise(function(e,t){var n=Math.max(o-Date.now(),0),r=setTimeout(e,n);i.addEventListener(function(){clearTimeout(r),t(kM.create("fetch-throttle",{throttleEndTimeMillis:o}))})}))];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,5,,7]),[4,this.client.fetch(r)];case 3:return t=e.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return e.sent(),[2,t];case 5:if(!function(e){if(e instanceof Ho&&e.customData){e=Number(e.customData.httpStatus);return 429===e||500===e||503===e||504===e}}(n=e.sent()))throw n;return n={throttleEndTimeMillis:Date.now()+ba(s),backoffCount:s+1},[4,this.storage.setThrottleMetadata(n)];case 6:return e.sent(),[2,this.attemptFetch(r,n)];case 7:return[2]}var i,o})})},HM);function HM(e,t){this.client=e,this.storage=t}var GM,QM="@firebase/remote-config";return(GM=Jh).INTERNAL.registerComponent(new _a("remoteConfig",function(e,t){var n=e.getProvider("app").getImmediate(),r=e.getProvider("installations").getImmediate();if("undefined"==typeof window)throw kM.create("registration-window");var i=n.options,o=i.projectId,a=i.apiKey,s=i.appId;if(!o)throw kM.create("registration-project-id");if(!a)throw kM.create("registration-api-key");if(!s)throw kM.create("registration-app-id");t=t||"firebase";var u=new VM(s,n.name,t),e=new KM(u),i=new xa(QM);i.logLevel=Aa.ERROR;s=new AM(r,GM.SDK_VERSION,t,o,a,s),s=new zM(s,u),s=new SM(s,u,e,i),i=new LM(n,s,e,u,i);return i.ensureInitialized(),i},"PUBLIC").setMultipleInstances(!0)),GM.registerVersion(QM,"0.1.30-1.0.0-eap-firestore-debug.9c6096f43"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),Jh.registerVersion("firebase","8.1.1-1.0.0-eap-firestore-debug.9c6096f43","cdn"),Jh});
//# sourceMappingURL=firebase.js.map
