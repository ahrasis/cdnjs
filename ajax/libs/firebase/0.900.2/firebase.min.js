!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.app={}))}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n=n||Promise)(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function i(t,e){var n,r,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}var a=(u.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},u);function u(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}var c,h,l,f="FirebaseError",d=(c=Error,e(h=g,l=c),h.prototype=null===l?Object.create(l):(p.prototype=l.prototype,new p),g);function p(){this.constructor=h}function g(t,e,n){return(e=c.call(this,e)||this).code=t,e.customData=n,e.name=f,Object.setPrototypeOf(e,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,m.prototype.create),e}var m=(v.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},s=this.service+"/"+t;t=(t=this.errors[t])?(r=i,t.replace(y,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+s+").";return new d(s,t,i)},v);function v(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var y=/\{\$([^}]+)}/g,w=(b.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},b.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},b.prototype.setServiceProps=function(t){return this.serviceProps=t,this},b);function b(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _="[DEFAULT]",I=(E.prototype.get=function(t){void 0===t&&(t=_);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},E.prototype.getImmediate=function(t){var e=n({identifier:_,optional:!1},t),r=(t=e.identifier,e.optional),i=this.normalizeInstanceIdentifier(t);try{var s=this.getOrInitializeService(i);if(s)return s;if(r)return null;throw Error("Service "+this.name+" is not available")}catch(t){if(r)return null;throw t}},E.prototype.getComponent=function(){return this.component},E.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=t).instantiationMode)try{this.getOrInitializeService(_)}catch(t){}try{for(var r=s(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var a=o(i.value,2),u=a[0],c=a[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},E.prototype.clearInstance=function(t){void 0===t&&(t=_),this.instancesDeferred.delete(t),this.instances.delete(t)},E.prototype.delete=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2]}})})},E.prototype.isComponentSet=function(){return null!=this.component},E.prototype.getOrInitializeService=function(t){var e,n=this.instances.get(t);return!n&&this.component&&(n=this.component.instanceFactory(this.container,(e=t)===_?void 0:e),this.instances.set(t,n)),n||null},E.prototype.normalizeInstanceIdentifier=function(t){return!this.component||this.component.multipleInstances?t:_},E);function E(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var T=(S.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},S.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},S.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new I(t,this);return this.providers.set(t,e),e},S.prototype.getProviders=function(){return Array.from(this.providers.values())},S);function S(t){this.name=t,this.providers=new Map}function A(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var k,N=[];function O(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=P[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,A(["["+i+"]  "+t.name+":"],n))}}(C=k=k||{})[C.DEBUG=0]="DEBUG",C[C.VERBOSE=1]="VERBOSE",C[C.INFO=2]="INFO",C[C.WARN=3]="WARN",C[C.ERROR=4]="ERROR",C[C.SILENT=5]="SILENT";var R={debug:k.DEBUG,verbose:k.VERBOSE,info:k.INFO,warn:k.WARN,error:k.ERROR,silent:k.SILENT},D=k.INFO,P=((C={})[k.DEBUG]="log",C[k.VERBOSE]="log",C[k.INFO]="info",C[k.WARN]="warn",C[k.ERROR]="error",C),C=(Object.defineProperty(L.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in k))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),L.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?R[t]:t},Object.defineProperty(L.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),L.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.DEBUG],t)),this._logHandler.apply(this,A([this,k.DEBUG],t))},L.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.VERBOSE],t)),this._logHandler.apply(this,A([this,k.VERBOSE],t))},L.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.INFO],t)),this._logHandler.apply(this,A([this,k.INFO],t))},L.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.WARN],t)),this._logHandler.apply(this,A([this,k.WARN],t))},L.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,k.ERROR],t)),this._logHandler.apply(this,A([this,k.ERROR],t))},L);function L(t){this.name=t,this._logLevel=D,this._logHandler=O,this._userLogHandler=null,N.push(this)}var x=(M.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){return function(t){return"VERSION"===(null==(t=t.getComponent())?void 0:t.type)}(t)?(t=t.getImmediate()).library+"/"+t.version:null}).filter(function(t){return t}).join(" ")},M);function M(t){this.container=t}var U="@firebase/app",V=new C("@firebase/app"),F="[DEFAULT]",j=((C={})[U]="fire-core",C["@firebase/app-compat"]="fire-core-compat",C["@firebase/analytics"]="fire-analytics",C["@firebase/auth"]="fire-auth",C["@firebase/database"]="fire-rtdb",C["@firebase/functions"]="fire-fn",C["@firebase/functions-compat"]="fire-fn-compat",C["@firebase/installations"]="fire-iid",C["@firebase/messaging"]="fire-fcm",C["@firebase/performance"]="fire-perf",C["@firebase/remote-config"]="fire-rc",C["@firebase/storage"]="fire-gcs",C["@firebase/firestore"]="fire-fst",C["fire-js"]="fire-js",C.firebase="fire-js-all",C),q=new Map,B=new Map;function z(t,e){try{t.container.addComponent(e)}catch(n){V.debug("Component "+e.name+" failed to register with FirebaseApp "+t.name,n)}}function G(t){var e,n,r=t.name;if(B.has(r))return V.debug("There were multiple attempts to register component "+r+"."),!1;B.set(r,t);try{for(var i=s(q.values()),o=i.next();!o.done;o=i.next())z(o.value,t)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0}function H(t,e){return t.container.getProvider(e)}(C={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",C["bad-app-name"]="Illegal App name: '{$appName}",C["duplicate-app"]="Firebase App named '{$appName}' already exists",C["app-deleted"]="Firebase App named '{$appName}' already deleted",C["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",C["invalid-log-argument"]="First argument to `onLog` must be null or a function.",C=C;var $=new m("app","Firebase",C),W=(Object.defineProperty(K.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),K.prototype.checkDestroyed=function(){if(this.isDeleted)throw $.create("app-deleted",{appName:this.name_})},K);function K(t,e,r){var i=this;this.isDeleted=!1,this.options_=n({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=r,this.container.addComponent(new w("app-exp",function(){return i},"PUBLIC"))}function Y(t,e,n){var r=null!==(i=j[t])&&void 0!==i?i:t;n&&(r+="-"+n);var i=r.match(/\s|\//);t=e.match(/\s|\//);if(i||t)return n=['Unable to register library "'+r+'" with version "'+e+'":'],i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&t&&n.push("and"),t&&n.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void V.warn(n.join(" "));G(new w(r+"-version",function(){return{library:r,version:e}},"VERSION"))}G(new w("platform-logger",function(t){return new x(t)},"PRIVATE")),Y(U,"0.0.900-exp.3c2788a40",void 0),Y("fire-js",""),Y("firebase","0.900.2","app"),t.SDK_VERSION="0.900.2",t._DEFAULT_ENTRY_NAME=F,t._addComponent=z,t._addOrOverwriteComponent=function(t,e){t.container.addOrOverwriteComponent(e)},t._apps=q,t._clearComponents=function(){B.clear()},t._components=B,t._getProvider=H,t._registerComponent=G,t._removeServiceInstance=function(t,e,n){void 0===n&&(n=F),H(t,e).clearInstance(n)},t.deleteApp=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return e=t.name,q.has(e)?(q.delete(e),[4,Promise.all(t.container.getProviders().map(function(t){return t.delete()}))]):[3,2];case 1:n.sent(),t.isDeleted=!0,n.label=2;case 2:return[2]}})})},t.getApp=function(t){void 0===t&&(t=F);var e=q.get(t);if(!e)throw $.create("no-app",{appName:t});return e},t.getApps=function(){return Array.from(q.values())},t.initializeApp=function(t,e){var r,i;void 0===e&&(e={}),"object"!=typeof e&&(e={name:e});var o=n({name:F,automaticDataCollectionEnabled:!1},e);if("string"!=typeof(e=o.name)||!e)throw $.create("bad-app-name",{appName:String(e)});if(q.has(e))throw $.create("duplicate-app",{appName:e});var a=new T(e);try{for(var u=s(B.values()),c=u.next();!c.done;c=u.next()){var h=c.value;a.addComponent(h)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return o=new W(t,o,a),q.set(e,o),o},t.onLog=function(t,e){if(null!==t&&"function"!=typeof t)throw $.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=0,r=N;n<r.length;n++)!function(n){var r=null;e&&e.level&&(r=R[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:k[n].toLowerCase(),message:o,args:i,type:e.name})}}(r[n])}(t,e)},t.registerVersion=Y,t.setLogLevel=function(t){var e;e=t,N.forEach(function(t){t.setLogLevel(e)})},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.auth=t.firebase.auth||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function o(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var s=t[i],o=i+1<t.length,a=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=s>>2,l=(3&s)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var s=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==u)throw Error();var c=s<<2|o>>4;if(r.push(c),64!==a){var h=o<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){try{return c.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f="FirebaseError",d=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=f,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,p.prototype.create),s}return r(e,t),e}(Error),p=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(g,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").";return new d(i,a,r)},t}();var g=/\{\$([^}]+)}/g;function m(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var s=i[r];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}var v,y,w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=b),void 0===r.error&&(r.error=b),void 0===r.complete&&(r.complete=b);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function b(){}function _(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(y||(y={}));var I={debug:y.DEBUG,verbose:y.VERBOSE,info:y.INFO,warn:y.WARN,error:y.ERROR,silent:y.SILENT},E=y.INFO,T=((v={})[y.DEBUG]="log",v[y.VERBOSE]="log",v[y.INFO]="info",v[y.WARN]="warn",v[y.ERROR]="error",v),S=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=T[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,_(["["+i+"]  "+t.name+":"],n))}},A=function(){function t(t){this.name=t,this._logLevel=E,this._logHandler=S,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in y))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?I[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,_([this,y.DEBUG],t)),this._logHandler.apply(this,_([this,y.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,_([this,y.VERBOSE],t)),this._logHandler.apply(this,_([this,y.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,_([this,y.INFO],t)),this._logHandler.apply(this,_([this,y.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,_([this,y.WARN],t)),this._logHandler.apply(this,_([this,y.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,_([this,y.ERROR],t)),this._logHandler.apply(this,_([this,y.ERROR],t))},t}(),k=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function N(){return{}}var O=function(){var t;return(t={})["admin-restricted-operation"]="This operation is restricted to administrators only.",t["argument-error"]="",t["app-not-authorized"]="This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",t["app-not-installed"]="The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",t["captcha-check-failed"]="The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",t["code-expired"]="The SMS code has expired. Please re-send the verification code to try again.",t["cordova-not-ready"]="Cordova framework is not ready.",t["cors-unsupported"]="This browser is not supported.",t["credential-already-in-use"]="This credential is already associated with a different user account.",t["custom-token-mismatch"]="The custom token corresponds to a different audience.",t["requires-recent-login"]="This operation is sensitive and requires recent authentication. Log in again before retrying this request.",t["dynamic-link-not-activated"]="Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",t["email-change-needs-verification"]="Multi-factor users must always have a verified email.",t["email-already-in-use"]="The email address is already in use by another account.",t["emulator-config-failed"]='Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "useEmulator()" sooner.',t["expired-action-code"]="The action code has expired.",t["cancelled-popup-request"]="This operation has been cancelled due to another conflicting popup being opened.",t["internal-error"]="An internal AuthError has occurred.",t["invalid-app-credential"]="The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",t["invalid-app-id"]="The mobile app identifier is not registed for the current project.",t["invalid-user-token"]="This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",t["invalid-auth-event"]="An internal AuthError has occurred.",t["invalid-verification-code"]="The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.",t["invalid-continue-uri"]="The continue URL provided in the request is invalid.",t["invalid-cordova-configuration"]="The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",t["invalid-custom-token"]="The custom token format is incorrect. Please check the documentation.",t["invalid-dynamic-link-domain"]="The provided dynamic link domain is not configured or authorized for the current project.",t["invalid-email"]="The email address is badly formatted.",t["invalid-emulator-scheme"]="Emulator URL must start with a valid scheme (http:// or https://).",t["invalid-api-key"]="Your API key is invalid, please check you have copied it correctly.",t["invalid-cert-hash"]="The SHA-1 certificate hash provided is invalid.",t["invalid-credential"]="The supplied auth credential is malformed or has expired.",t["invalid-message-payload"]="The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",t["invalid-multi-factor-session"]="The request does not contain a valid proof of first factor successful sign-in.",t["invalid-oauth-provider"]="EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",t["invalid-oauth-client-id"]="The OAuth client ID provided is either invalid or does not match the specified API key.",t["unauthorized-domain"]="This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",t["invalid-action-code"]="The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",t["wrong-password"]="The password is invalid or the user does not have a password.",t["invalid-persistence-type"]="The specified persistence type is invalid. It can only be local, session or none.",t["invalid-phone-number"]="The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",t["invalid-provider-id"]="The specified provider ID is invalid.",t["invalid-recipient-email"]="The email corresponding to this action failed to send as the provided recipient email address is invalid.",t["invalid-sender"]="The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",t["invalid-verification-id"]="The verification ID used to create the phone auth credential is invalid.",t["invalid-tenant-id"]="The Auth instance's tenant ID is invalid.",t["missing-android-pkg-name"]="An Android Package Name must be provided if the Android App is required to be installed.",t["auth-domain-config-required"]="Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",t["missing-app-credential"]="The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",t["missing-verification-code"]="The phone auth credential was created with an empty SMS verification code.",t["missing-continue-uri"]="A continue URL must be provided in the request.",t["missing-iframe-start"]="An internal AuthError has occurred.",t["missing-ios-bundle-id"]="An iOS Bundle ID must be provided if an App Store ID is provided.",t["missing-or-invalid-nonce"]="The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",t["missing-multi-factor-info"]="No second factor identifier is provided.",t["missing-multi-factor-session"]="The request is missing proof of first factor successful sign-in.",t["missing-phone-number"]="To send verification codes, provide a phone number for the recipient.",t["missing-verification-id"]="The phone auth credential was created with an empty verification ID.",t["app-deleted"]="This instance of FirebaseApp has been deleted.",t["multi-factor-info-not-found"]="The user does not have a second factor matching the identifier provided.",t["multi-factor-auth-required"]="Proof of ownership of a second factor is required to complete sign-in.",t["account-exists-with-different-credential"]="An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",t["network-request-failed"]="A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",t["no-auth-event"]="An internal AuthError has occurred.",t["no-such-provider"]="User was not linked to an account with the given provider.",t["null-user"]="A null user object was provided as the argument for an operation which requires a non-null user object.",t["operation-not-allowed"]="The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",t["operation-not-supported-in-this-environment"]='This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',t["popup-blocked"]="Unable to establish a connection with the popup. It may have been blocked by the browser.",t["popup-closed-by-user"]="The popup has been closed by the user before finalizing the operation.",t["provider-already-linked"]="User can only be linked to one identity for the given provider.",t["quota-exceeded"]="The project's quota for this operation has been exceeded.",t["redirect-cancelled-by-user"]="The redirect operation has been cancelled by the user before finalizing.",t["redirect-operation-pending"]="A redirect sign-in operation is already pending.",t["rejected-credential"]="The request contains malformed or mismatching credentials.",t["second-factor-already-in-use"]="The second factor is already enrolled on this account.",t["maximum-second-factor-count-exceeded"]="The maximum allowed number of second factors on a user has been exceeded.",t["tenant-id-mismatch"]="The provided tenant ID does not match the Auth instance's tenant ID",t.timeout="The operation has timed out.",t["user-token-expired"]="The user's credential is no longer valid. The user must sign in again.",t["too-many-requests"]="We have blocked all requests from this device due to unusual activity. Try again later.",t["unauthorized-continue-uri"]="The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",t["unsupported-first-factor"]="Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",t["unsupported-persistence-type"]="The current environment does not support the specified persistence type.",t["unsupported-tenant-operation"]="This operation is not supported in a multi-tenant context.",t["unverified-email"]="The operation requires a verified email.",t["user-cancelled"]="The user did not grant your application the permissions it requested.",t["user-not-found"]="There is no user record corresponding to this identifier. The user may have been deleted.",t["user-disabled"]="The user account has been disabled by an administrator.",t["user-mismatch"]="The supplied credentials do not correspond to the previously signed in user.",t["user-signed-out"]="",t["weak-password"]="The password must be 6 characters long or more.",t["web-storage-unsupported"]="This browser is not supported or 3rd party cookies and data may be disabled.",t},R=N,D=new p("auth","Firebase",{}),P=new A("@firebase/auth-exp");function C(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P.logLevel<=y.ERROR&&P.error.apply(P,u(["Auth ("+e.SDK_VERSION+"): "+t],n))}function L(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];throw M.apply(void 0,u([t],e))}function x(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return M.apply(void 0,u([t],e))}function M(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if("string"!=typeof t){var i=n[0],s=u(n.slice(1));return s[0]&&(s[0].appName=t.name),(e=t._errorFactory).create.apply(e,u([i],s))}return D.create.apply(D,u([t],n))}function U(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!t)throw M.apply(void 0,u([e],n))}function V(t){var e="INTERNAL ASSERTION FAILED: "+t;throw C(e),new Error(e)}function F(t,e){t||V(e)}var j=new Map;function q(t){F(t instanceof Function,"Expected a class definition");var e=j.get(t);return e?(F(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,j.set(t,e),e)}function B(t,n){void 0===t&&(t=e.getApp());var r=e._getProvider(t,"auth-exp").getImmediate();return function(t,e){var n=(null==e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(q);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap);t._initializeWithPersistence(r,null==e?void 0:e.popupRedirectResolver)}(r,n),r}var z=function(){function t(t,e){this.providerId=t,this.signInMethod=e}return t.prototype.toJSON=function(){return V("not implemented")},t.prototype._getIdTokenResponse=function(t){return V("not implemented")},t.prototype._linkToIdToken=function(t,e){return V("not implemented")},t.prototype._getReauthenticationResolver=function(t){return V("not implemented")},t}();function G(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function H(){return"http:"===$()||"https:"===$()}function $(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function W(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(H()||(t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0,"object"==typeof t&&void 0!==t.id)||"connection"in navigator))||navigator.onLine;var t}var K=function(){function t(t,e){this.shortDelay=t,this.longDelay=e,F(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())||"object"==typeof navigator&&"ReactNative"===navigator.product}return t.prototype.get=function(){return W()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)},t}();function Y(t,e){F(t.emulator,"Emulator should always be set here");var n=t.emulator.url,r=new URL(n).toString();return e?""+r+(e.startsWith("/")?e.slice(1):e):r}var X,J=function(){function t(){}return t.initialize=function(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)},t.fetch=function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void V("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t.headers=function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void V("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t.response=function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void V("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")},t}(),Q=((X={}).CREDENTIAL_MISMATCH="custom-token-mismatch",X.MISSING_CUSTOM_TOKEN="internal-error",X.INVALID_IDENTIFIER="invalid-email",X.MISSING_CONTINUE_URI="internal-error",X.INVALID_PASSWORD="wrong-password",X.MISSING_PASSWORD="internal-error",X.EMAIL_EXISTS="email-already-in-use",X.PASSWORD_LOGIN_DISABLED="operation-not-allowed",X.INVALID_IDP_RESPONSE="invalid-credential",X.INVALID_PENDING_TOKEN="invalid-credential",X.FEDERATED_USER_ID_ALREADY_LINKED="credential-already-in-use",X.MISSING_REQ_TYPE="internal-error",X.EMAIL_NOT_FOUND="user-not-found",X.RESET_PASSWORD_EXCEED_LIMIT="too-many-requests",X.EXPIRED_OOB_CODE="expired-action-code",X.INVALID_OOB_CODE="invalid-action-code",X.MISSING_OOB_CODE="internal-error",X.CREDENTIAL_TOO_OLD_LOGIN_AGAIN="requires-recent-login",X.INVALID_ID_TOKEN="invalid-user-token",X.TOKEN_EXPIRED="user-token-expired",X.USER_NOT_FOUND="user-token-expired",X.TOO_MANY_ATTEMPTS_TRY_LATER="too-many-requests",X.INVALID_CODE="invalid-verification-code",X.INVALID_SESSION_INFO="invalid-verification-id",X.INVALID_TEMPORARY_PROOF="invalid-credential",X.MISSING_SESSION_INFO="missing-verification-id",X.SESSION_EXPIRED="code-expired",X.MISSING_ANDROID_PACKAGE_NAME="missing-android-pkg-name",X.UNAUTHORIZED_DOMAIN="unauthorized-continue-uri",X.INVALID_OAUTH_CLIENT_ID="invalid-oauth-client-id",X.ADMIN_ONLY_OPERATION="admin-restricted-operation",X.INVALID_MFA_PENDING_CREDENTIAL="invalid-multi-factor-session",X.MFA_ENROLLMENT_NOT_FOUND="multi-factor-info-not-found",X.MISSING_MFA_ENROLLMENT_ID="missing-multi-factor-info",X.MISSING_MFA_PENDING_CREDENTIAL="missing-multi-factor-session",X.SECOND_FACTOR_EXISTS="second-factor-already-in-use",X.SECOND_FACTOR_LIMIT_EXCEEDED="maximum-second-factor-count-exceeded",X),Z=new K(3e4,6e4);function tt(t,e,n,r,s){return void 0===s&&(s={}),o(this,void 0,void 0,function(){return a(this,function(o){return[2,et(t,s,function(){var s={},o={};r&&("GET"===e?o=r:s={body:JSON.stringify(r)});var a=m(i({key:t.config.apiKey},o)).slice(1),u=new(J.headers());return u.set("Content-Type","application/json"),u.set("X-Client-Version",t.config.sdkClientVersion),t.languageCode&&u.set("X-Firebase-Locale",t.languageCode),J.fetch()(rt(t,t.config.apiHost,n,a),i({method:e,headers:u,referrerPolicy:"no-referrer"},s))})]})})}function et(t,e,n){return o(this,void 0,void 0,function(){var r,s,o,u,c,h,l;return a(this,function(a){switch(a.label){case 0:t._canInitEmulator=!1,r=i(i({},Q),e),a.label=1;case 1:return a.trys.push([1,4,,5]),s=new it(t),[4,Promise.race([n(),s.promise])];case 2:return o=a.sent(),s.clearNetworkTimeout(),[4,o.json()];case 3:if("needConfirmation"in(u=a.sent()))throw st(t,"account-exists-with-different-credential",u);if(o.ok)return[2,u];if("FEDERATED_USER_ID_ALREADY_LINKED"===(c=u.error.message.split(" : ")[0]))throw st(t,"credential-already-in-use",u);if("EMAIL_EXISTS"===c)throw st(t,"email-already-in-use",u);return h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-"),L(t,h),[3,5];case 4:if((l=a.sent())instanceof d)throw l;return L(t,"network-request-failed"),[3,5];case 5:return[2]}})})}function nt(t,e,n,r,i){return void 0===i&&(i={}),o(this,void 0,void 0,function(){var s;return a(this,function(o){switch(o.label){case 0:return[4,tt(t,e,n,r,i)];case 1:return"mfaPendingCredential"in(s=o.sent())&&L(t,"multi-factor-auth-required",{serverResponse:s}),[2,s]}})})}function rt(t,e,n,r){var i=""+e+n+"?"+r;return t.config.emulator?Y(t.config,i):t.config.apiScheme+"://"+i}var it=function(){function t(t){var e=this;this.auth=t,this.timer=null,this.promise=new Promise(function(t,n){e.timer=setTimeout(function(){return n(x(e.auth,"timeout"))},Z.get())})}return t.prototype.clearNetworkTimeout=function(){clearTimeout(this.timer)},t}();function st(t,e,n){var r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=x(t,e,r);return i.customData._tokenResponse=n,i}function ot(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:resetPassword",e)]})})}function at(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}function ut(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:sendOobCode",e)]})})}var ct=function(t){function e(e,n,r,i){void 0===i&&(i=null);var s=t.call(this,"password",r)||this;return s.email=e,s.password=n,s.tenantId=i,s}return r(e,t),e._fromEmailAndPassword=function(t,n){return new e(t,n,"password")},e._fromEmailAndCode=function(t,n,r){return void 0===r&&(r=null),new e(t,n,"emailLink",r)},e.prototype.toJSON=function(){return{email:this.email,password:this.password,signInMethod:this.signInMethod,tenantId:this.tenantId}},e.fromJSON=function(t){var e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null},e.prototype._getIdTokenResponse=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(this.signInMethod){case"password":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPassword",e)]})})}(t,{returnSecureToken:!0,email:this.email,password:this.password})];case"emailLink":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithEmailLink",e)]})})}(t,{email:this.email,oobCode:this.password})];default:L(t,"internal-error")}return[2]})})},e.prototype._linkToIdToken=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(this.signInMethod){case"password":return[2,at(t,{idToken:e,returnSecureToken:!0,email:this.email,password:this.password})];case"emailLink":return[2,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithEmailLink",e)]})})}(t,{idToken:e,email:this.email,oobCode:this.password})];default:L(t,"internal-error")}return[2]})})},e.prototype._getReauthenticationResolver=function(t){return this._getIdTokenResponse(t)},e}(z);function ht(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithIdp",e)]})})}var lt,ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pendingToken=null,e}return r(e,t),e._fromParams=function(t){var n=new e(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):L("argument-error"),n},e.prototype.toJSON=function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}},e.fromJSON=function(t){var n="string"==typeof t?JSON.parse(t):t,r=n.providerId,i=n.signInMethod,o=s(n,["providerId","signInMethod"]);if(!r||!i)return null;var a=new e(r,i);return Object.assign(a,o),a},e.prototype._getIdTokenResponse=function(t){return ht(t,this.buildRequest())},e.prototype._linkToIdToken=function(t,e){var n=this.buildRequest();return n.idToken=e,ht(t,n)},e.prototype._getReauthenticationResolver=function(t){var e=this.buildRequest();return e.autoCreate=!1,ht(t,e)},e.prototype.buildRequest=function(){var t={requestUri:"http://localhost",returnSecureToken:!0,postBody:null};if(this.pendingToken)t.pendingToken=this.pendingToken;else{var e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=m(e)}return t},e}(z);var dt=((lt={}).USER_NOT_FOUND="user-not-found",lt);var pt=function(t){function e(e){var n=t.call(this,"phone","phone")||this;return n.params=e,n}return r(e,t),e._fromVerification=function(t,n){return new e({verificationId:t,verificationCode:n})},e._fromTokenResponse=function(t,n){return new e({phoneNumber:t,temporaryProof:n})},e.prototype._getIdTokenResponse=function(t){return function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",e)]})})}(t,this._makeVerificationRequest())},e.prototype._linkToIdToken=function(t,e){return function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",e)]})})}(t,i({idToken:e},this._makeVerificationRequest()))},e.prototype._getReauthenticationResolver=function(t){return function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){return n=i(i({},e),{operation:"REAUTH"}),[2,nt(t,"POST","/v1/accounts:signInWithPhoneNumber",n,dt)]})})}(t,this._makeVerificationRequest())},e.prototype._makeVerificationRequest=function(){var t=this.params,e=t.temporaryProof,n=t.phoneNumber,r=t.verificationId,i=t.verificationCode;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}},e.prototype.toJSON=function(){var t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t},e.fromJSON=function(t){"string"==typeof t&&(t=JSON.parse(t));var n=t,r=n.verificationId,i=n.verificationCode,s=n.phoneNumber,o=n.temporaryProof;return i||r||s||o?new e({verificationId:r,verificationCode:i,phoneNumber:s,temporaryProof:o}):null},e}(z),gt=function(){function t(){this.type="NONE",this.storage={}}return t.prototype._isAvailable=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,!0]})})},t.prototype._set=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return this.storage[t]=e,[2]})})},t.prototype._get=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return[2,void 0===(e=this.storage[t])?null:e]})})},t.prototype._remove=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return delete this.storage[t],[2]})})},t.prototype._addListener=function(t,e){},t.prototype._removeListener=function(t,e){},t.type="NONE",t}();var mt=function(){function t(t){var e=new URL(t),n=e.searchParams.get("apiKey"),r=e.searchParams.get("oobCode"),i=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(e.searchParams.get("mode"));U(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=e.searchParams.get("continueUrl"),this.languageCode=e.searchParams.get("languageCode"),this.tenantId=e.searchParams.get("tenantId")}return t.parseLink=function(e){var n=function(t){var e=new URL(t),n=e.searchParams.get("link"),r=n?new URL(n).searchParams.get("link"):null,i=e.searchParams.get("deep_link_id");return(i?new URL(i).searchParams.get("link"):null)||i||r||n||t}(e);try{return new t(n)}catch(t){return null}},t}();var vt=function(){function t(){this.providerId=t.PROVIDER_ID}return t.credential=function(t,e){return ct._fromEmailAndPassword(t,e)},t.credentialWithLink=function(t,e){var n=mt.parseLink(e);return U(n,"argument-error"),ct._fromEmailAndCode(t,n.code,n.tenantId)},t.PROVIDER_ID="password",t.EMAIL_PASSWORD_SIGN_IN_METHOD="password",t.EMAIL_LINK_SIGN_IN_METHOD="emailLink",t}(),yt=function(){function t(t){this.providerId=t,this.defaultLanguageCode=null,this.scopes=[],this.customParameters={}}return t.credentialFromJSON=function(t){var e="string"==typeof t?JSON.parse(t):t;return U("providerId"in e&&"signInMethod"in e,"argument-error"),ft._fromParams(e)},t.prototype.credential=function(t){return U(t.idToken&&t.accessToken,"argument-error"),ft._fromParams(i({providerId:this.providerId,signInMethod:this.providerId},t))},t.prototype.setDefaultLanguage=function(t){this.defaultLanguageCode=t},t.prototype.setCustomParameters=function(t){return this.customParameters=t,this},t.prototype.getCustomParameters=function(){return this.customParameters},t.prototype.addScope=function(t){return this.scopes.includes(t)||this.scopes.push(t),this},t.prototype.getScopes=function(){return u(this.scopes)},t}(),wt=function(t){function e(){return t.call(this,"facebook.com")||this}return r(e,t),e.credential=function(t){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.FACEBOOK_SIGN_IN_METHOD,accessToken:t})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!(n&&"oauthAccessToken"in n))return null;if(!n.oauthAccessToken)return null;try{return e.credential(n.oauthAccessToken)}catch(t){return null}},e.FACEBOOK_SIGN_IN_METHOD="facebook.com",e.PROVIDER_ID="facebook.com",e}(yt),bt=function(t){function e(){var e=t.call(this,"google.com")||this;return e.addScope("profile"),e}return r(e,t),e.credential=function(t,n){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!n)return null;var r=n,i=r.oauthIdToken,s=r.oauthAccessToken;if(!i&&!s)return null;try{return e.credential(i,s)}catch(t){return null}},e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}(yt),_t=function(t){function e(){return t.call(this,"github.com")||this}return r(e,t),e.credential=function(t){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GITHUB_SIGN_IN_METHOD,accessToken:t})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!(n&&"oauthAccessToken"in n))return null;if(!n.oauthAccessToken)return null;try{return e.credential(n.oauthAccessToken)}catch(t){return null}},e.GITHUB_SIGN_IN_METHOD="github.com",e.PROVIDER_ID="github.com",e}(yt),It=function(t){function e(){return t.call(this,"twitter.com")||this}return r(e,t),e.credential=function(t,n){return ft._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})},e.credentialFromResult=function(t){return e.credentialFromTaggedObject(t)},e.credentialFromError=function(t){return e.credentialFromTaggedObject(t.customData||{})},e.credentialFromTaggedObject=function(t){var n=t._tokenResponse;if(!n)return null;var r=n,i=r.oauthAccessToken,s=r.oauthTokenSecret;if(!i||!s)return null;try{return e.credential(i,s)}catch(t){return null}},e.TWITTER_SIGN_IN_METHOD="twitter.com",e.PROVIDER_ID="twitter.com",e}(yt);function Et(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signUp",e)]})})}function Tt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}function St(t){if(t)try{var e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function At(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var n,r,i,s,o;return a(this,function(a){switch(a.label){case 0:return n=t,[4,t.getIdToken(e)];case 1:return r=a.sent(),U((i=Nt(r))&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error"),s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider,[2,{claims:i,token:r,authTime:St(kt(i.auth_time)),issuedAtTime:St(kt(i.iat)),expirationTime:St(kt(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}]}})})}function kt(t){return 1e3*Number(t)}function Nt(t){var e=t.split("."),n=e[0],r=e[1],i=e[2];if(void 0===n||void 0===r||void 0===i)return C("JWT malformed, contained fewer than 3 sections"),null;try{var s=h(r);return s?JSON.parse(s):(C("Failed to decode base64 JWT payload"),null)}catch(t){return C("Caught error parsing JWT payload as JSON",t),null}}function Ot(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:if(n)return[2,e];i.label=1;case 1:return i.trys.push([1,3,,6]),[4,e];case 2:return[2,i.sent()];case 3:return(r=i.sent())instanceof d&&function(t){var e=t.code;return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)?t.auth.currentUser!==t?[3,5]:[4,t.auth.signOut()]:[3,5];case 4:i.sent(),i.label=5;case 5:throw r;case 6:return[2]}})})}var Rt=function(){function t(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return t.prototype._start=function(){this.isRunning||(this.isRunning=!0,this.schedule())},t.prototype._stop=function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))},t.prototype.getInterval=function(t){var e;if(t){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;n=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,n)},t.prototype.schedule=function(t){var e=this;if(void 0===t&&(t=!1),this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(function(){return o(e,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.iteration()];case 1:return t.sent(),[2]}})})},n)}},t.prototype.iteration=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.user.getIdToken(!0)];case 1:return t.sent(),[3,3];case 2:return"auth/network-request-failed"===t.sent().code&&this.schedule(!0),[2];case 3:return this.schedule(),[2]}})})},t}(),Dt=function(){function t(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}return t.prototype._initializeTime=function(){this.lastSignInTime=St(this.lastLoginAt),this.creationTime=St(this.createdAt)},t.prototype._copy=function(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()},t.prototype.toJSON=function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}},t}();function Pt(t){var e;return o(this,void 0,void 0,function(){var n,r,i,c,h,l,f,d,p,g;return a(this,function(m){switch(m.label){case 0:return n=t.auth,[4,t.getIdToken()];case 1:return r=m.sent(),[4,Ot(t,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:lookup",e)]})})}(n,{idToken:r}))];case 2:return U(null==(i=m.sent())?void 0:i.users.length,n,"internal-error"),c=i.users[0],t._notifyReloadListener(c),h=(null===(e=c.providerUserInfo)||void 0===e?void 0:e.length)?c.providerUserInfo.map(function(t){var e=t.providerId,n=s(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],v=t.providerData,y=h,l=u(v.filter(function(t){return!y.some(function(e){return e.providerId===t.providerId})}),y),f=t.isAnonymous,d=!(t.email&&c.passwordHash||(null==l?void 0:l.length)),p=!!f&&d,g={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:l,metadata:new Dt(c.createdAt,c.lastLoginAt),isAnonymous:p},Object.assign(t,g),[2]}var v,y})})}function Ct(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,Pt(e=t)];case 1:return n.sent(),[4,e.auth._persistUserIfCurrent(e)];case 2:return n.sent(),e.auth._notifyListenersIfCurrent(e),[2]}})})}var Lt=function(){function t(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Object.defineProperty(t.prototype,"isExpired",{get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4},enumerable:!1,configurable:!0}),t.prototype.updateFromServerResponse=function(t){U(t.idToken,"internal-error"),U(void 0!==t.idToken,"internal-error"),U(void 0!==t.refreshToken,"internal-error");var e,n,r="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):(e=t.idToken,U(n=Nt(e),"internal-error"),U(void 0!==n.exp,"internal-error"),U(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)},t.prototype.getToken=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return U(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?[4,this.refresh(t,this.refreshToken)]:[3,2]:[2,this.accessToken];case 1:return n.sent(),[2,this.accessToken];case 2:return[2,null]}})})},t.prototype.clearRefreshToken=function(){this.refreshToken=null},t.prototype.refresh=function(t,e){return o(this,void 0,void 0,function(){var n,r,i,s;return a(this,function(u){switch(u.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,et(t,{},function(){var n=m({grant_type:"refresh_token",refresh_token:e}).slice(1),r=t.config,i=r.tokenApiHost,s=r.apiKey,o=r.sdkClientVersion,a=rt(t,i,"/v1/token","key="+s);return J.fetch()(a,{method:"POST",headers:{"X-Client-Version":o,"Content-Type":"application/x-www-form-urlencoded"},body:n})})];case 1:return[2,{accessToken:(n=r.sent()).access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}]}})})}(t,e)];case 1:return n=u.sent(),r=n.accessToken,i=n.refreshToken,s=n.expiresIn,this.updateTokensAndExpiration(r,i,Number(s)),[2]}})})},t.prototype.updateTokensAndExpiration=function(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n},t.fromJSON=function(e,n){var r=n.refreshToken,i=n.accessToken,s=n.expirationTime,o=new t;return r&&(U("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(U("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(U("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o},t.prototype.toJSON=function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}},t.prototype._assign=function(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime},t.prototype._clone=function(){return Object.assign(new t,this.toJSON())},t.prototype._performRefresh=function(){return V("not implemented")},t}();function xt(t,e){U("string"==typeof t||void 0===t,"internal-error",{appName:e})}var Mt=function(){function t(t){var e=t.uid,n=t.auth,r=t.stsTokenManager,i=s(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Rt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new Dt(i.createdAt||void 0,i.lastLoginAt||void 0)}return t.prototype.getIdToken=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,Ot(this,this.stsTokenManager.getToken(this.auth,t))];case 1:return U(e=n.sent(),this.auth,"internal-error"),this.accessToken===e?[3,3]:(this.accessToken=e,[4,this.auth._persistUserIfCurrent(this)]);case 2:n.sent(),this.auth._notifyListenersIfCurrent(this),n.label=3;case 3:return[2,e]}})})},t.prototype.getIdTokenResult=function(t){return At(this,t)},t.prototype.reload=function(){return Ct(this)},t.prototype._assign=function(t){this!==t&&(U(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(function(t){return i({},t)}),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))},t.prototype._clone=function(){return new t(i(i({},this),{stsTokenManager:this.stsTokenManager._clone()}))},t.prototype._onReload=function(t){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)},t.prototype._notifyReloadListener=function(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t},t.prototype._startProactiveRefresh=function(){this.proactiveRefresh._start()},t.prototype._stopProactiveRefresh=function(){this.proactiveRefresh._stop()},t.prototype._updateTokensIfNecessary=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e?[4,Pt(this)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,this.auth._persistUserIfCurrent(this)];case 3:return r.sent(),n&&this.auth._notifyListenersIfCurrent(this),[2]}})})},t.prototype.delete=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.getIdToken()];case 1:return t=e.sent(),[4,Ot(this,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:delete",e)]})})}(this.auth,{idToken:t}))];case 2:return e.sent(),this.stsTokenManager.clearRefreshToken(),[2,this.auth.signOut()]}})})},t.prototype.toJSON=function(){return i({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(t){return i({},t)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON())},Object.defineProperty(t.prototype,"refreshToken",{get:function(){return this.stsTokenManager.refreshToken||""},enumerable:!1,configurable:!0}),t._fromJSON=function(e,n){var r,s,o,a,u,c,h,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,d=null!==(s=n.email)&&void 0!==s?s:void 0,p=null!==(o=n.phoneNumber)&&void 0!==o?o:void 0,g=null!==(a=n.photoURL)&&void 0!==a?a:void 0,m=null!==(u=n.tenantId)&&void 0!==u?u:void 0,v=null!==(c=n._redirectEventId)&&void 0!==c?c:void 0,y=null!==(h=n.createdAt)&&void 0!==h?h:void 0,w=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,_=n.emailVerified,I=n.isAnonymous,E=n.providerData,T=n.stsTokenManager;U(b&&T,e,"internal-error");var S=Lt.fromJSON(this.name,T);U("string"==typeof b,e,"internal-error"),xt(f,e.name),xt(d,e.name),U("boolean"==typeof _,e,"internal-error"),U("boolean"==typeof I,e,"internal-error"),xt(p,e.name),xt(g,e.name),xt(m,e.name),xt(v,e.name),xt(y,e.name),xt(w,e.name);var A=new t({uid:b,auth:e,email:d,emailVerified:_,displayName:f,isAnonymous:I,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:S,createdAt:y,lastLoginAt:w});return E&&Array.isArray(E)&&(A.providerData=E.map(function(t){return i({},t)})),v&&(A._redirectEventId=v),A},t._fromIdTokenResponse=function(e,n,r){return void 0===r&&(r=!1),o(this,void 0,void 0,function(){var i,s;return a(this,function(o){switch(o.label){case 0:return(i=new Lt).updateFromServerResponse(n),[4,Pt(s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r}))];case 1:return o.sent(),[2,s]}})})},t}(),Ut=function(){function t(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return t._fromIdTokenResponse=function(e,n,r,i){return void 0===i&&(i=!1),o(this,void 0,void 0,function(){var s,o;return a(this,function(a){switch(a.label){case 0:return[4,Mt._fromIdTokenResponse(e,r,i)];case 1:return s=a.sent(),o=Vt(r),[2,new t({user:s,providerId:o,_tokenResponse:r,operationType:n})]}})})},t._forOperation=function(e,n,r){return o(this,void 0,void 0,function(){var i;return a(this,function(s){switch(s.label){case 0:return[4,e._updateTokensIfNecessary(r,!0)];case 1:return s.sent(),i=Vt(r),[2,new t({user:e,providerId:i,_tokenResponse:r,operationType:n})]}})})},t}();function Vt(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}function Ft(t,e,n){return"firebase:"+t+":"+e+":"+n}var jt=function(){function t(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;var r=this.auth,i=r.config,s=r.name;this.fullUserKey=Ft(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ft("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return t.prototype.setCurrentUser=function(t){return this.persistence._set(this.fullUserKey,t.toJSON())},t.prototype.getCurrentUser=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.persistence._get(this.fullUserKey)];case 1:return[2,(t=e.sent())?Mt._fromJSON(this.auth,t):null]}})})},t.prototype.removeCurrentUser=function(){return this.persistence._remove(this.fullUserKey)},t.prototype.savePersistenceForRedirect=function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)},t.prototype.setPersistence=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return this.persistence.type===t.type?[2]:[4,this.getCurrentUser()];case 1:return e=n.sent(),[4,this.removeCurrentUser()];case 2:return n.sent(),this.persistence=t,e?[2,this.setCurrentUser(e)]:[2]}})})},t.prototype.delete=function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)},t.create=function(e,n,r){return void 0===r&&(r="authUser"),o(this,void 0,void 0,function(){var i,s,o,u;return a(this,function(a){switch(a.label){case 0:if(!n.length)return[2,new t(q(gt),e,r)];i=Ft(r,e.config.apiKey,e.name),s=0,o=n,a.label=1;case 1:return s<o.length?[4,(u=o[s])._get(i)]:[3,4];case 2:if(a.sent())return[2,new t(u,e,r)];a.label=3;case 3:return s++,[3,1];case 4:return[2,new t(n[0],e,r)]}})})},t}(),qt=function(){function t(t,e){this.app=t,this.config=e,this.currentUser=null,this.operations=Promise.resolve(),this.authStateSubscription=new zt(this),this.idTokenSubscription=new zt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.redirectInitializerError=null,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=D,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.name=t.name}return t.prototype._initializeWithPersistence=function(t,e){var n=this;return this._initializationPromise=this.queue(function(){return o(n,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return this._deleted?[2]:(e&&(this._popupRedirectResolver=q(e)),n=this,[4,jt.create(this,t)]);case 1:return n.persistenceManager=r.sent(),this._deleted?[2]:[4,this.initializeCurrentUser(e)];case 2:return r.sent(),this._deleted?[2]:(this._isInitialized=!0,[2])}})})}),this._initializationPromise.then(function(){if(n.redirectInitializerError)throw n.redirectInitializerError})},t.prototype._onStorageEvent=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return this._deleted?[2]:[4,this.assertedPersistence.getCurrentUser()];case 1:return t=e.sent(),this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),[4,this.currentUser.getIdToken()]):[3,3]:[2];case 2:return e.sent(),[2];case 3:return[4,this._updateCurrentUser(t)];case 4:return e.sent(),[2]}})})},t.prototype.initializeCurrentUser=function(t){var e;return o(this,void 0,void 0,function(){var n,r,i,s;return a(this,function(o){switch(o.label){case 0:return[4,this.assertedPersistence.getCurrentUser()];case 1:return n=o.sent(),t&&this.config.authDomain?[4,this.getOrInitRedirectPersistenceManager()]:[3,4];case 2:return o.sent(),r=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,i=null==n?void 0:n._redirectEventId,[4,this.tryRedirectSignIn(t)];case 3:s=o.sent(),r&&r!==i||null==s||!s.user||(n=s.user),o.label=4;case 4:return n?n._redirectEventId?(U(this._popupRedirectResolver,this,"argument-error"),[4,this.getOrInitRedirectPersistenceManager()]):[2,this.reloadAndSetCurrentUserOrClear(n)]:[2,this.directlySetCurrentUser(null)];case 5:return o.sent(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?[2,this.directlySetCurrentUser(n)]:[2,this.reloadAndSetCurrentUserOrClear(n)]}})})},t.prototype.tryRedirectSignIn=function(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this._popupRedirectResolver._completeRedirectFn(this,t,!0)];case 2:return e=r.sent(),[3,5];case 3:return n=r.sent(),this.redirectInitializerError=n,[4,this._setRedirectUser(null)];case 4:return r.sent(),[3,5];case 5:return[2,e]}})})},t.prototype.reloadAndSetCurrentUserOrClear=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Pt(t)];case 1:return e.sent(),[3,3];case 2:return"auth/network-request-failed"!==e.sent().code?[2,this.directlySetCurrentUser(null)]:[3,3];case 3:return[2,this.directlySetCurrentUser(t)]}})})},t.prototype.useDeviceLanguage=function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var t=navigator;return t.languages&&t.languages[0]||t.language||null}()},t.prototype.useEmulator=function(t,e){U(this._canInitEmulator,this,"emulator-config-failed"),U(/^https?:\/\//.test(t),this,"invalid-emulator-scheme"),this.config.emulator={url:t},this.settings.appVerificationDisabledForTesting=!0,function(t){function e(){var t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#ff0000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||t||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}(!!(null==e?void 0:e.disableWarnings))},t.prototype._delete=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return this._deleted=!0,[2]})})},t.prototype.updateCurrentUser=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return U(!(e=t)||e.auth.name===this.name,this,"argument-error"),[2,this._updateCurrentUser(e&&e._clone())]})})},t.prototype._updateCurrentUser=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return this._deleted?[2]:(t&&U(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),[2,this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.directlySetCurrentUser(t)];case 1:return e.sent(),this.notifyAuthListeners(),[2]}})})})])})})},t.prototype.signOut=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.redirectPersistenceManager||this._popupRedirectResolver?[4,this._setRedirectUser(null)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this._updateCurrentUser(null)]}})})},t.prototype.setPersistence=function(t){var e=this;return this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.assertedPersistence.setPersistence(q(t))];case 1:return e.sent(),[2]}})})})},t.prototype._getPersistence=function(){return this.assertedPersistence.persistence.type},t.prototype._updateErrorMap=function(t){this._errorFactory=new p("auth","Firebase",t())},t.prototype.onAuthStateChanged=function(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)},t.prototype.onIdTokenChanged=function(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)},t.prototype.toJSON=function(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}},t.prototype._setRedirectUser=function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,this.getOrInitRedirectPersistenceManager(e)];case 1:return n=r.sent(),[2,null===t?n.removeCurrentUser():n.setCurrentUser(t)]}})})},t.prototype.getOrInitRedirectPersistenceManager=function(t){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:return this.redirectPersistenceManager?[3,3]:(U(e=t&&q(t)||this._popupRedirectResolver,this,"argument-error"),n=this,[4,jt.create(this,[q(e._redirectPersistence)],"redirectUser")]);case 1:return n.redirectPersistenceManager=i.sent(),r=this,[4,this.redirectPersistenceManager.getCurrentUser()];case 2:r.redirectUser=i.sent(),i.label=3;case 3:return[2,this.redirectPersistenceManager]}})})},t.prototype._redirectUserForId=function(t){var e,n;return o(this,void 0,void 0,function(){var r=this;return a(this,function(i){switch(i.label){case 0:return this._isInitialized?[4,this.queue(function(){return o(r,void 0,void 0,function(){return a(this,function(t){return[2]})})})]:[3,2];case 1:i.sent(),i.label=2;case 2:return(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?[2,this._currentUser]:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?[2,this.redirectUser]:[2,null]}})})},t.prototype._persistUserIfCurrent=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return t===this.currentUser?[2,this.queue(function(){return o(e,void 0,void 0,function(){return a(this,function(e){return[2,this.directlySetCurrentUser(t)]})})})]:[2]})})},t.prototype._notifyListenersIfCurrent=function(t){t===this.currentUser&&this.notifyAuthListeners()},t.prototype._key=function(){return this.config.authDomain+":"+this.config.apiKey+":"+this.name},t.prototype._startProactiveRefresh=function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()},t.prototype._stopProactiveRefresh=function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()},Object.defineProperty(t.prototype,"_currentUser",{get:function(){return this.currentUser},enumerable:!1,configurable:!0}),t.prototype.notifyAuthListeners=function(){var t,e;this._isInitialized&&(this.idTokenSubscription.next(this.currentUser),this.lastNotifiedUid!==(null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&(this.lastNotifiedUid=null===(e=this.currentUser)||void 0===e?void 0:e.uid,this.authStateSubscription.next(this.currentUser)))},t.prototype.registerStateListener=function(t,e,n,r){var i=this;if(this._deleted)return function(){};var s="function"==typeof e?e:e.next,o=this._isInitialized?Promise.resolve():this._initializationPromise;return U(o,this,"internal-error"),o.then(function(){return s(i.currentUser)}),"function"==typeof e?t.addObserver(e,n,r):t.addObserver(e)},t.prototype.directlySetCurrentUser=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?[4,this.assertedPersistence.setCurrentUser(t)]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.assertedPersistence.removeCurrentUser()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.queue=function(t){return this.operations=this.operations.then(t,t),this.operations},Object.defineProperty(t.prototype,"assertedPersistence",{get:function(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager},enumerable:!1,configurable:!0}),t}();function Bt(t){return t}var zt=function(){function t(t){var e,n,r=this;this.auth=t,this.observer=null,this.addObserver=(n=new w(function(t){return r.observer=t},e)).subscribe.bind(n)}return Object.defineProperty(t.prototype,"next",{get:function(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)},enumerable:!1,configurable:!0}),t}();var Gt=function(t){function e(n,r,i,s){var o,a=t.call(this,r.code,r.message)||this;return a.operationType=i,a.user=s,a.name="FirebaseError",Object.setPrototypeOf(a,e.prototype),a.appName=n.name,a.code=r.code,a.tenantId=null!==(o=n.tenantId)&&void 0!==o?o:void 0,a.serverResponse=r.customData.serverResponse,a}return r(e,t),e._fromErrorAndOperation=function(t,n,r,i){return new e(t,n,r,i)},e}(d);function Ht(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(function(n){if("auth/multi-factor-auth-required"===n.code)throw Gt._fromErrorAndOperation(t,n,e,r);throw n})}function $t(t){return new Set(t.map(function(t){return t.providerId}).filter(function(t){return!!t}))}function Wt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s,o,u,c;return a(this,function(a){switch(a.label){case 0:return i=Ot,s=[t],u=(o=e)._linkToIdToken,c=[t.auth],[4,t.getIdToken()];case 1:return[4,i.apply(void 0,s.concat([u.apply(o,c.concat([a.sent()])),n]))];case 2:return r=a.sent(),[2,Ut._forOperation(t,"link",r)]}})})}function Kt(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){switch(s.label){case 0:return[4,Pt(e)];case 1:return s.sent(),r=$t(e.providerData),i=!1===t?"provider-already-linked":"no-such-provider",U(r.has(n)===t,e.auth,i),[2]}})})}function Yt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s,o,u,c;return a(this,function(a){switch(a.label){case 0:r=t.auth,i="reauthenticate",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Ot(t,Ht(r,i,e,t),n)];case 2:return U((s=a.sent()).idToken,r,"internal-error"),U(o=Nt(s.idToken),r,"internal-error"),u=o.sub,U(t.uid===u,r,"user-mismatch"),[2,Ut._forOperation(t,i,s)];case 3:throw"auth/user-not-found"===(null==(c=a.sent())?void 0:c.code)&&L(r,"user-mismatch"),c;case 4:return[2]}})})}function Xt(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return[4,Ht(t,r="signIn",e)];case 1:return i=o.sent(),[4,Ut._fromIdTokenResponse(t,r,i)];case 2:return s=o.sent(),n?[3,4]:[4,t._updateCurrentUser(s.user)];case 3:o.sent(),o.label=4;case 4:return[2,s]}})})}function Jt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,Xt(Bt(t),e)]})})}function Qt(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return[4,Kt(!1,n=t,e.providerId)];case 1:return r.sent(),[2,Wt(n,e)]}})})}function Zt(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,Yt(t,e)]})})}var te=function(){function t(t,e){this.factorId=t,this.uid=e.mfaEnrollmentId,this.enrollmentTime=new Date(e.enrolledAt).toUTCString(),this.displayName=e.displayName}return t._fromServerResponse=function(t,e){return"phoneInfo"in e?ee._fromServerResponse(t,e):L(t,"internal-error")},t}(),ee=function(t){function e(e){var n=t.call(this,"phone",e)||this;return n.phoneNumber=e.phoneInfo,n}return r(e,t),e._fromServerResponse=function(t,n){return new e(n)},e}(te);function ne(t,e,n){var r;U((null===(r=n.url)||void 0===r?void 0:r.length)>0,t,"invalid-continue-uri"),U(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(U(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iosBundleId=n.iOS.bundleId),n.android&&(U(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}function re(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return[4,ot(t,{oobCode:e})];case 1:switch(n=s.sent(),U(r=n.requestType,t,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(n.mfaInfo,t,"internal-error");default:U(n.email,t,"internal-error")}return i=null,n.mfaInfo&&(i=te._fromServerResponse(Bt(t),n.mfaInfo)),[2,{data:{email:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.newEmail:n.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.email:n.newEmail)||null,multiFactorInfo:i},operation:r}]}})})}function ie(t,e,n){return o(this,void 0,void 0,function(){var r,i,s,o;return a(this,function(a){switch(a.label){case 0:return r=t.auth,[4,t.getIdToken()];case 1:return i=a.sent(),s={idToken:i,returnSecureToken:!0},e&&(s.email=e),n&&(s.password=n),[4,Ot(t,at(r,s))];case 2:return o=a.sent(),[4,t._updateTokensIfNecessary(o,!0)];case 3:return a.sent(),[2]}})})}var se=function(){return function(t,e,n){void 0===n&&(n={}),this.isNewUser=t,this.providerId=e,this.profile=n}}(),oe=function(t){function e(e,n,r,i){var s=t.call(this,e,n,r)||this;return s.username=i,s}return r(e,t),e}(se),ae=function(t){function e(e,n){return t.call(this,e,"facebook.com",n)||this}return r(e,t),e}(se),ue=function(t){function e(e,n){return t.call(this,e,"github.com",n,"string"==typeof(null==n?void 0:n.login)?null==n?void 0:n.login:null)||this}return r(e,t),e}(oe),ce=function(t){function e(e,n){return t.call(this,e,"google.com",n)||this}return r(e,t),e}(se),he=function(t){function e(e,n,r){return t.call(this,e,"twitter.com",n,r)||this}return r(e,t),e}(oe);var le=function(){function t(t,e){this.type=t,this.credential=e}return t._fromIdtoken=function(e){return new t("enroll",e)},t._fromMfaPendingCredential=function(e){return new t("signin",e)},t.prototype.toJSON=function(){var t;return{multiFactorSession:(t={},t["enroll"===this.type?"idToken":"pendingCredential"]=this.credential,t)}},t.fromJSON=function(e){var n,r;if(null==e?void 0:e.multiFactorSession){if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return t._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(r=e.multiFactorSession)||void 0===r?void 0:r.idToken)return t._fromIdtoken(e.multiFactorSession.idToken)}return null},t}(),fe=function(){function t(t,e,n){this.session=t,this.hints=e,this.signInResolver=n}return t._fromError=function(e,n){var r=this,s=Bt(e),u=(n.serverResponse.mfaInfo||[]).map(function(t){return te._fromServerResponse(s,t)});U(n.serverResponse.mfaPendingCredential,s,"internal-error");var c=le._fromMfaPendingCredential(n.serverResponse.mfaPendingCredential);return new t(c,u,function(t){return o(r,void 0,void 0,function(){var e,r,o;return a(this,function(a){switch(a.label){case 0:return[4,t._process(s,c)];case 1:switch(e=a.sent(),delete n.serverResponse.mfaInfo,delete n.serverResponse.mfaPendingCredential,r=i(i({},n.serverResponse),{idToken:e.idToken,refreshToken:e.refreshToken}),n.operationType){case"signIn":return[3,2];case"reauthenticate":return[3,5]}return[3,6];case 2:return[4,Ut._fromIdTokenResponse(s,n.operationType,r)];case 3:return o=a.sent(),[4,s._updateCurrentUser(o.user)];case 4:return a.sent(),[2,o];case 5:return U(n.user,s,"internal-error"),[2,Ut._forOperation(n.user,n.operationType,r)];case 6:L(s,"internal-error"),a.label=7;case 7:return[2]}})})})},t.prototype.resolveSignIn=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){return e=t,[2,this.signInResolver(e)]})})},t}();var de=function(){function t(t){var e=this;this.user=t,this.enrolledFactors=[],t._onReload(function(n){n.mfaInfo&&(e.enrolledFactors=n.mfaInfo.map(function(e){return te._fromServerResponse(t.auth,e)}))})}return t._fromUser=function(e){return new t(e)},t.prototype.getSession=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return e=(t=le)._fromIdtoken,[4,this.user.getIdToken()];case 1:return[2,e.apply(t,[n.sent()])]}})})},t.prototype.enroll=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=t,[4,this.getSession()];case 1:return r=s.sent(),[4,Ot(this.user,n._process(this.user.auth,r,e))];case 2:return i=s.sent(),[4,this.user._updateTokensIfNecessary(i)];case 3:return s.sent(),[2,this.user.reload()]}})})},t.prototype.unenroll=function(t){return o(this,void 0,void 0,function(){var e,n,r,s;return a(this,function(o){switch(o.label){case 0:return e="string"==typeof t?t:t.uid,[4,this.user.getIdToken()];case 1:return n=o.sent(),[4,Ot(this.user,(a=this.user.auth,u={idToken:n,mfaEnrollmentId:e},tt(a,"POST","/v2/accounts/mfaEnrollment:withdraw",i({tenantId:a.tenantId},u))))];case 2:return r=o.sent(),this.enrolledFactors=this.enrolledFactors.filter(function(t){return t.uid!==e}),[4,this.user._updateTokensIfNecessary(r)];case 3:o.sent(),o.label=4;case 4:return o.trys.push([4,6,,7]),[4,this.user.reload()];case 5:return o.sent(),[3,7];case 6:if("auth/user-token-expired"!==(s=o.sent()).code)throw s;return[3,7];case 7:return[2]}var a,u})})},t}(),pe=new WeakMap;var ge="0.0.900-exp.3c2788a40";function me(t){var e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(be(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ve(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ie(e))return"Blackberry";if(Ee(e))return"Webos";if(ye(e))return"Safari";if((e.includes("chrome/")||we(e))&&!e.includes("edge/"))return"Chrome";if(_e(e))return"Android";var n=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function ve(t){return/firefox\//i.test(t)}function ye(t){var e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function we(t){return/crios\//i.test(t)}function be(t){return/iemobile/i.test(t)}function _e(t){return/android/i.test(t)}function Ie(t){return/blackberry/i.test(t)}function Ee(t){return/webos/i.test(t)}function Te(t){return/iphone|ipad|ipod/i.test(t)}function Se(){return((t=l()).indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0)&&10===document.documentMode;var t}function Ae(t){var n;switch(t){case"Browser":n=me(l());break;case"Worker":n=me(l())+"-"+t;break;default:n=t}return n+"/JsCore/"+e.SDK_VERSION+"/FirebaseCore-web"}var ke=function(){function t(t){this.auth=t,this.internalListeners=new Map}return t.prototype.getUid=function(){var t;return(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null},t.prototype.getToken=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.auth._initializationPromise];case 1:return e.sent(),this.auth.currentUser?[4,this.auth.currentUser.getIdToken(t)]:[2,null];case 2:return[2,{accessToken:e.sent()}]}})})},t.prototype.addAuthTokenListener=function(t){if(!this.internalListeners.has(t)){var e=this.auth.onIdTokenChanged(function(e){var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}},t.prototype.removeAuthTokenListener=function(t){var e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())},t.prototype.updateProactiveRefresh=function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()},t}();var Ne=function(){function t(t,e){this.storage=t,this.type=e}return t.prototype._isAvailable=function(){try{return this.storage?(this.storage.setItem("__sak","1"),this.storage.removeItem("__sak"),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}},t.prototype._set=function(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()},t.prototype._get=function(t){var e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)},t.prototype._remove=function(t){return this.storage.removeItem(t),Promise.resolve()},t}();var Oe=function(t){function e(){var e,n=t.call(this,localStorage,"LOCAL")||this;return n.listeners={},n.localCache={},n.pollTimer=null,n.safariLocalStorageNotSynced=(ye(e=l())||Te(e))&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),n.fallbackToPolling=function(t){return void 0===t&&(t=l()),Te(t)||_e(t)||Ee(t)||Ie(t)||/windows phone/i.test(t)||be(t)}(),n.boundEventHandler=n.onStorageEvent.bind(n),n}return r(e,t),e.prototype.forAllChangedKeys=function(t){for(var e=0,n=Object.keys(this.listeners);e<n.length;e++){var r=n[e],i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}},e.prototype.onStorageEvent=function(t,e){var n=this;if(void 0===e&&(e=!1),t.key){var r=t.key;if(this.listeners[r]){if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(r,t.newValue):this.storage.removeItem(r);else if(this.localCache[r]===t.newValue&&!e)return}var s=function(){var t=n.storage.getItem(r);(e||n.localCache[r]!==t)&&n.notifyListeners(r,t)},o=this.storage.getItem(r);Se()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,10):s()}}else this.forAllChangedKeys(function(t,e,r){n.notifyListeners(t,r)})},e.prototype.notifyListeners=function(t,e){if(this.listeners[t]){this.localCache[t]=e;for(var n=0,r=Array.from(this.listeners[t]);n<r.length;n++){(0,r[n])(e?JSON.parse(e):e)}}},e.prototype.startPolling=function(){var t=this;this.stopPolling(),this.pollTimer=setInterval(function(){t.forAllChangedKeys(function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},1e3)},e.prototype.stopPolling=function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)},e.prototype.attachListener=function(){window.addEventListener("storage",this.boundEventHandler)},e.prototype.detachListener=function(){window.removeEventListener("storage",this.boundEventHandler)},e.prototype._addListener=function(t,e){this.localCache[t]=this.storage.getItem(t),0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]=this.listeners[t]||new Set,this.listeners[t].add(e)},e.prototype._removeListener=function(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&(delete this.listeners[t],delete this.localCache[t])),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())},e.type="LOCAL",e}(Ne);var Re=function(){function t(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return t._getInstance=function(e){var n=this.receivers.find(function(t){return t.isListeningto(e)});if(n)return n;var r=new t(e);return this.receivers.push(r),r},t.prototype.isListeningto=function(t){return this.eventTarget===t},t.prototype.handleEvent=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,u,c,h=this;return a(this,function(l){switch(l.label){case 0:return n=(e=t).data,r=n.eventId,i=n.eventType,s=n.data,(null==(u=this.handlersMap[i])?void 0:u.size)?(e.ports[0].postMessage({status:"ack",eventId:r,eventType:i}),[4,function(t){var e=this;return Promise.all(t.map(function(t){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t];case 1:return[2,{fulfilled:!0,value:e.sent()}];case 2:return[2,{fulfilled:!1,reason:e.sent()}];case 3:return[2]}})})}))}(Array.from(u).map(function(t){return o(h,void 0,void 0,function(){return a(this,function(n){return[2,t(e.origin,s)]})})}))]):[2];case 1:return c=l.sent(),e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c}),[2]}})})},t.prototype._subscribe=function(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)},t.prototype._unsubscribe=function(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)},t.receivers=[],t}();var De=function(){function t(t){this.target=t,this.handlers=new Set}return t.prototype.removeMessageHandler=function(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)},t.prototype._send=function(t,e,n){return void 0===n&&(n=50),o(this,void 0,void 0,function(){var r,i,s,o=this;return a(this,function(a){if(!(r="undefined"!=typeof MessageChannel?new MessageChannel:null))throw new Error("connection_unavailable");return[2,new Promise(function(a,u){var c,h,l=(void 0===c&&(c=""),void 0===h&&(h=20),""+c+Math.floor(Math.random()*Math.pow(10,h)));r.port1.start();var f=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage:function(t){var e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(f),i=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(e.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"))}}},o.handlers.add(s),r.port1.addEventListener("message",s.onMessage),o.target.postMessage({eventType:t,eventId:l,data:e},[r.port2])}).finally(function(){s&&o.removeMessageHandler(s)})]})})},t}();function Pe(){return window}function Ce(){return void 0!==Pe().WorkerGlobalScope&&"function"==typeof Pe().importScripts}var Le="firebaseLocalStorageDb",xe=1,Me="firebaseLocalStorage",Ue="fbase_key",Ve=function(){function t(t){this.request=t}return t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.request.addEventListener("success",function(){e(t.request.result)}),t.request.addEventListener("error",function(){n(t.request.error)})})},t}();function Fe(t,e){return t.transaction([Me],e?"readwrite":"readonly").objectStore(Me)}function je(){var t=this,e=indexedDB.open(Le,xe);return new Promise(function(n,r){e.addEventListener("error",function(){r(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(Me,{keyPath:Ue})}catch(t){r(t)}}),e.addEventListener("success",function(){return o(t,void 0,void 0,function(){var t;return a(this,function(r){switch(r.label){case 0:return(t=e.result).objectStoreNames.contains(Me)?[3,2]:[4,function(){var t=indexedDB.deleteDatabase(Le);return new Ve(t).toPromise()}()];case 1:return r.sent(),[2,je()];case 2:n(t),r.label=3;case 3:return[2]}})})})})}function qe(t,e,n){return o(this,void 0,void 0,function(){var r,i,s,o;return a(this,function(a){switch(a.label){case 0:return r=Fe(t,!1).get(e),[4,new Ve(r).toPromise()];case 1:return(i=a.sent())?(i.value=n,s=Fe(t,!0).put(i),[2,new Ve(s).toPromise()]):(s=Fe(t,!0).add(((o={})[Ue]=e,o.value=n,o)),[2,new Ve(s).toPromise()])}})})}function Be(t,e){var n=Fe(t,!0).delete(e);return new Ve(n).toPromise()}var ze=function(){function t(){this.type="LOCAL",this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return t.prototype._openDb=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return this.db?[2,this.db]:(t=this,[4,je()]);case 1:return t.db=e.sent(),[2,this.db]}})})},t.prototype._withRetries=function(t){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:e=0,i.label=1;case 1:i.label=2;case 2:return i.trys.push([2,5,,6]),[4,this._openDb()];case 3:return n=i.sent(),[4,t(n)];case 4:return[2,i.sent()];case 5:if(r=i.sent(),e++>3)throw r;return this.db&&(this.db.close(),this.db=void 0),[3,6];case 6:return[3,1];case 7:return[2]}})})},t.prototype.initializeServiceWorkerMessaging=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,Ce()?this.initializeReceiver():this.initializeSender()]})})},t.prototype.initializeReceiver=function(){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return this.receiver=Re._getInstance(Ce()?self:null),this.receiver._subscribe("keyChanged",function(e,n){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this._poll()];case 1:return[2,{keyProcessed:t.sent().includes(n.key)}]}})})}),this.receiver._subscribe("ping",function(e,n){return o(t,void 0,void 0,function(){return a(this,function(t){return[2,["keyChanged"]]})})}),[2]})})},t.prototype.initializeSender=function(){var t,e;return o(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return n=this,[4,function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return[2,null];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,navigator.serviceWorker.ready];case 2:return[2,t.sent().active];case 3:return t.sent(),[2,null];case 4:return[2]}})})}()];case 1:return n.activeServiceWorker=i.sent(),this.activeServiceWorker?(this.sender=new De(this.activeServiceWorker),[4,this.sender._send("ping",{},800)]):[2];case 2:return(r=i.sent())?((null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=r[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0),[2]):[2]}})})},t.prototype.notifyServiceWorker=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:if(!this.sender||!this.activeServiceWorker||function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()!==this.activeServiceWorker)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},t.prototype._isAvailable=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),indexedDB?[4,je()]:[2,!1];case 1:return[4,qe(t=e.sent(),"__sak","1")];case 2:return e.sent(),[4,Be(t,"__sak")];case 3:return e.sent(),[2,!0];case 4:return e.sent(),[3,5];case 5:return[2,!1]}})})},t.prototype._withPendingWrite=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:this.pendingWrites++,e.label=1;case 1:return e.trys.push([1,,3,4]),[4,t()];case 2:return e.sent(),[3,4];case 3:return this.pendingWrites--,[7];case 4:return[2]}})})},t.prototype._set=function(t,e){return o(this,void 0,void 0,function(){var n=this;return a(this,function(r){return[2,this._withPendingWrite(function(){return o(n,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,this._withRetries(function(n){return qe(n,t,e)})];case 1:return n.sent(),this.localCache[t]=e,[2,this.notifyServiceWorker(t)]}})})})]})})},t.prototype._get=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return[4,this._withRetries(function(e){return function(t,e){return o(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return n=Fe(t,!1).get(e),[4,new Ve(n).toPromise()];case 1:return[2,void 0===(r=i.sent())?null:r.value]}})})}(e,t)})];case 1:return e=n.sent(),this.localCache[t]=e,[2,e]}})})},t.prototype._remove=function(t){return o(this,void 0,void 0,function(){var e=this;return a(this,function(n){return[2,this._withPendingWrite(function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._withRetries(function(e){return Be(e,t)})];case 1:return e.sent(),delete this.localCache[t],[2,this.notifyServiceWorker(t)]}})})})]})})},t.prototype._poll=function(){return o(this,void 0,void 0,function(){var t,e,n,r,i,s,o;return a(this,function(a){switch(a.label){case 0:return[4,this._withRetries(function(t){var e=Fe(t,!1).getAll();return new Ve(e).toPromise()})];case 1:if(!(t=a.sent()))return[2,[]];if(0!==this.pendingWrites)return[2,[]];for(e=[],n=0,r=t;n<r.length;n++)i=r[n],s=i.fbase_key,o=i.value,JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),e.push(s));return[2,e]}})})},t.prototype.notifyListeners=function(t,e){if(this.listeners[t]){this.localCache[t]=e;for(var n=0,r=Array.from(this.listeners[t]);n<r.length;n++){(0,r[n])(e)}}},t.prototype.startPolling=function(){var t=this;this.stopPolling(),this.pollTimer=setInterval(function(){return o(t,void 0,void 0,function(){return a(this,function(t){return[2,this._poll()]})})},800)},t.prototype.stopPolling=function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)},t.prototype._addListener=function(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]=this.listeners[t]||new Set,this.listeners[t].add(e)},t.prototype._removeListener=function(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&(delete this.listeners[t],delete this.localCache[t])),0===Object.keys(this.listeners).length&&this.stopPolling()},t.type="LOCAL",t}(),Ge=function(){function t(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return t.prototype.registerConsumer=function(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)},t.prototype.unregisterConsumer=function(t){this.consumers.delete(t)},t.prototype.onEvent=function(t){var e=this;if(this.hasEventBeenHandled(t))return!1;var n=!1;return this.consumers.forEach(function(r){e.isEventForConsumer(t,r)&&(n=!0,e.sendToConsumer(t,r),e.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $e(t);default:return!1}}(t)?n:(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0),n)},t.prototype.sendToConsumer=function(t,e){var n;if(t.error&&!$e(t)){var r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(x(this.auth,r))}else e.onAuthEvent(t)},t.prototype.isEventForConsumer=function(t,e){var n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n},t.prototype.hasEventBeenHandled=function(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(He(t))},t.prototype.saveEventToCache=function(t){this.cachedEventUids.add(He(t)),this.lastProcessedEventTime=Date.now()},t}();function He(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(function(t){return t}).join("-")}function $e(t){var e=t.type,n=t.error;return"unknown"===e&&"auth/no-auth-event"===(null==n?void 0:n.code)}function We(t){return""+(t||"")+Math.floor(1e9*Math.random())}var Ke=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ye=/^https?/;function Xe(t){return o(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(s){switch(s.label){case 0:return t.config.emulator?[2]:[4,function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,tt(t,"GET","/v1/projects",{})]})})}(t)];case 1:for(e=s.sent().authorizedDomains,n=0,r=e;n<r.length;n++){i=r[n];try{if(Je(i))return[2]}catch(t){}}return L(t,"unauthorized-domain"),[2]}})})}function Je(t){var e=G(),n=new URL(e),r=n.protocol,i=n.hostname;if(t.startsWith("chrome-extension://")){var s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===r&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===r&&s.hostname===i}if(!Ye.test(r))return!1;if(Ke.test(t))return i===t;var o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}function Qe(t){return new Promise(function(e,n){var r,i,s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=n,s.type="text/javascript",s.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(s)})}function Ze(t){return"__"+t+Math.floor(1e6*Math.random())}var tn=new K(3e4,6e4);function en(){var t=Pe().___jsl;if(null==t?void 0:t.H)for(var e=0,n=Object.keys(t.H);e<n.length;e++){var r=n[e];if(t.H[r].r=t.H[r].r||[],t.H[r].L=t.H[r].L||[],t.H[r].r=u(t.H[r].L),t.CP)for(var i=0;i<t.CP.length;i++)t.CP[i]=null}}var nn=null;function rn(t){return nn=nn||function(t){return new Promise(function(e,n){var r,i,s;function o(){en(),gapi.load("gapi.iframes",{callback:function(){e(gapi.iframes.getContext())},ontimeout:function(){en(),n(x(t,"network-request-failed"))},timeout:tn.get()})}if(null===(i=null===(r=Pe().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=Pe().gapi)||void 0===s||!s.load){var a=Ze("iframefcb");return Pe()[a]=function(){gapi.load?o():n(x(t,"network-request-failed"))},Qe("https://apis.google.com/js/api.js?onload="+a)}o()}}).catch(function(t){throw nn=null,t})}(t)}var sn=new K(5e3,15e3),on="__/auth/iframe",an="emulator/auth/iframe",un={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}};function cn(t){return o(this,void 0,void 0,function(){var n,r,i=this;return a(this,function(s){switch(s.label){case 0:return[4,rn(t)];case 1:return n=s.sent(),U(r=Pe().gapi,t,"internal-error"),[2,n.open({where:document.body,url:function(t){var n=t.config;return U(n.authDomain,t,"auth-domain-config-required"),(n.emulator?Y(n,an):"https://"+t.config.authDomain+"/"+on)+"?"+m({apiKey:n.apiKey,appName:t.name,v:e.SDK_VERSION}).slice(1)}(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:un,dontclear:!0},function(e){return new Promise(function(n,r){return o(i,void 0,void 0,function(){function i(){Pe().clearTimeout(o),n(e)}var s,o;return a(this,function(n){switch(n.label){case 0:return[4,e.restyle({setHideOnLeave:!1})];case 1:return n.sent(),s=x(t,"network-request-failed"),o=Pe().setTimeout(function(){r(s)},sn.get()),e.ping(i).then(i,function(){r(s)}),[2]}})})})})]}})})}var hn=function(t){function e(){return t.call(this,sessionStorage,"SESSION")||this}return r(e,t),e.prototype._addListener=function(t,e){},e.prototype._removeListener=function(t,e){},e.type="SESSION",e}(Ne),ln={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fn=500,dn=600,pn="_blank",gn="http://localhost",mn=function(){function t(t){this.window=t,this.associatedEvent=null}return t.prototype.close=function(){if(this.window)try{this.window.close()}catch(t){}},t}();function vn(t,e,n,r,s){void 0===r&&(r=fn),void 0===s&&(s=dn);var o=Math.min((window.screen.availHeight-s)/2,0).toString(),a=Math.min((window.screen.availWidth-r)/2,0).toString(),u="",c=i(i({},ln),{width:r.toString(),height:s.toString(),top:o,left:a}),h=l().toLowerCase();n&&(u=we(h)?pn:n),ve(h)&&(e=e||gn,c.scrollbars="yes");var f=Object.entries(c).reduce(function(t,e){return""+t+e[0]+"="+e[1]+","},"");if(function(t){var e;return Te(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==u)return function(t,e){var n=document.createElement("a");n.href=t,n.target=e;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",u),new mn(null);var d=window.open(e||"",u,f);U(d,t,"popup-blocked");try{d.focus()}catch(t){}return new mn(d)}var yn=function(t){function e(e){var n=t.call(this,"custom","custom")||this;return n.params=e,n}return r(e,t),e.prototype._getIdTokenResponse=function(t){return ht(t,this._buildIdpRequest())},e.prototype._linkToIdToken=function(t,e){return ht(t,this._buildIdpRequest(e))},e.prototype._getReauthenticationResolver=function(t){return ht(t,this._buildIdpRequest())},e.prototype._buildIdpRequest=function(t){var e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody||null,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0};return t&&(e.idToken=t),e},e}(z);function wn(t){return Xt(t.auth,new yn(t),t.bypassAuthState)}function bn(t){var e=t.auth,n=t.user;return U(n,e,"internal-error"),Yt(n,new yn(t),t.bypassAuthState)}function _n(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){return e=t.auth,U(n=t.user,e,"internal-error"),[2,Wt(n,new yn(t),t.bypassAuthState)]})})}var In=function(){function t(t,e,n,r,i){void 0===i&&(i=!1),this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}return t.prototype.execute=function(){var t=this;return new Promise(function(e,n){return o(t,void 0,void 0,function(){var t,r;return a(this,function(i){switch(i.label){case 0:this.pendingPromise={resolve:e,reject:n},i.label=1;case 1:return i.trys.push([1,4,,5]),t=this,[4,this.resolver._initialize(this.auth)];case 2:return t.eventManager=i.sent(),[4,this.onExecution()];case 3:return i.sent(),this.eventManager.registerConsumer(this),[3,5];case 4:return r=i.sent(),this.reject(r),[3,5];case 5:return[2]}})})})},t.prototype.onAuthEvent=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,o,u,c,h;return a(this,function(a){switch(a.label){case 0:if(e=t.urlResponse,n=t.sessionId,r=t.postBody,i=t.tenantId,s=t.error,o=t.type,s)return this.reject(s),[2];u={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState},a.label=1;case 1:return a.trys.push([1,3,,4]),c=this.resolve,[4,this.getIdpTask(o)(u)];case 2:return c.apply(this,[a.sent()]),[3,4];case 3:return h=a.sent(),this.reject(h),[3,4];case 4:return[2]}})})},t.prototype.onError=function(t){this.reject(t)},t.prototype.getIdpTask=function(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return wn;case"linkViaPopup":case"linkViaRedirect":return _n;case"reauthViaPopup":case"reauthViaRedirect":return bn;default:L(this.auth,"internal-error")}},t.prototype.resolve=function(t){F(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()},t.prototype.reject=function(t){F(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()},t.prototype.unregisterAndCleanUp=function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()},t}();function En(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return r=Bt(t),i=On(r,e),[4,new An(r,i,n).execute()];case 1:return!(s=o.sent())||n?[3,4]:(delete s.user._redirectEventId,[4,r._persistUserIfCurrent(s.user)]);case 2:return o.sent(),[4,r._setRedirectUser(null,e)];case 3:o.sent(),o.label=4;case 4:return[2,s]}})})}function Tn(t){return o(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return e=We(t.uid+":::"),t._redirectEventId=e,[4,t.auth._setRedirectUser(t)];case 1:return n.sent(),[4,t.auth._persistUserIfCurrent(t)];case 2:return n.sent(),[2,e]}})})}var Sn=new Map,An=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r)||this;return i.eventId=null,i}return r(e,t),e.prototype.execute=function(){return o(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:if(e=Sn.get(this.auth._key()))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.prototype.execute.call(this)];case 2:return n=i.sent(),e=function(){return Promise.resolve(n)},[3,4];case 3:return r=i.sent(),e=function(){return Promise.reject(r)},[3,4];case 4:Sn.set(this.auth._key(),e),i.label=5;case 5:return[2,e()]}})})},e.prototype.onAuthEvent=function(e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return"signInViaRedirect"===e.type?[2,t.prototype.onAuthEvent.call(this,e)]:"unknown"===e.type?(this.resolve(null),[2]):e.eventId?[4,this.auth._redirectUserForId(e.eventId)]:[3,2];case 1:if(n=r.sent())return this.user=n,[2,t.prototype.onAuthEvent.call(this,e)];this.resolve(null),r.label=2;case 2:return[2]}})})},e.prototype.onExecution=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2]})})},e.prototype.cleanUp=function(){},e}(In),kn="__/auth/handler",Nn="emulator/auth/handler";function On(t,e){return e?q(e):(U(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var Rn=function(){function t(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hn,this._completeRedirectFn=En}return t.prototype._openPopup=function(t,e,n,r){var i;return o(this,void 0,void 0,function(){var s;return a(this,function(o){switch(o.label){case 0:return F(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),[4,this.originValidation(t)];case 1:return o.sent(),s=Dn(t,e,n,r),[2,vn(t,s,We())]}})})},t.prototype._openRedirect=function(t,e,n,r){return o(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,this.originValidation(t)];case 1:return i.sent(),s=Dn(t,e,n,r),Pe().location.href=s,[2,new Promise(function(){})]}var s})})},t.prototype._initialize=function(t){var e=t._key();if(this.eventManagers[e]){var n=this.eventManagers[e],r=n.manager,i=n.promise;return r?Promise.resolve(r):(F(i,"If manager is not set, promise should be"),i)}var s=this.initAndGetManager(t);return this.eventManagers[e]={promise:s},s},t.prototype.initAndGetManager=function(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:return[4,cn(t)];case 1:return e=r.sent(),n=new Ge(t),e.register("authEvent",function(e){return U(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,[2,n]}})})},t.prototype._isIframeWebStorageSupported=function(t,e){this.iframes[t._key()].send("webStorageSupport",{type:"webStorageSupport"},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&e(!!i),L(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)},t.prototype.originValidation=function(t){var e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=Xe(t)),this.originValidationPromises[e]},t}();function Dn(t,n,r,i){U(t.config.authDomain,t,"auth-domain-config-required"),U(t.config.apiKey,t,"invalid-api-key");var s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:G(),v:e.SDK_VERSION,eventId:i};if(n instanceof yt){n.setDefaultLanguage(t.languageCode),s.providerId=n.providerId||"",function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(n.getCustomParameters())||(s.customParameters=JSON.stringify(n.getCustomParameters()));var o=n.getScopes().filter(function(t){return""!==t});o.length>0&&(s.scopes=o.join(","))}t.tenantId&&(s.tid=t.tenantId);for(var a=0,u=Object.keys(s);a<u.length;a++){var c=u[a];void 0===s[c]&&delete s[c]}return new URL(function(t){var e=t.config;if(!e.emulator)return"https://"+e.authDomain+"/"+kn;return Y(e,Nn)}(t)+"?"+m(s).slice(1)).toString()}var Pn=1e12,Cn=function(){function t(t){this.auth=t,this.counter=Pn,this._widgets=new Map}return t.prototype.render=function(t,e){var n=this.counter;return this._widgets.set(n,new Ln(t,this.auth.name,e||{})),this.counter++,n},t.prototype.reset=function(t){var e,n=t||Pn;null===(e=this._widgets.get(n))||void 0===e||e.delete(),this._widgets.delete(n)},t.prototype.getResponse=function(t){var e,n=t||Pn;return(null===(e=this._widgets.get(n))||void 0===e?void 0:e.getResponse())||""},t.prototype.execute=function(t){var e;return o(this,void 0,void 0,function(){var n;return a(this,function(r){return n=t||Pn,null===(e=this._widgets.get(n))||void 0===e||e.execute(),[2,""]})})},t}(),Ln=function(){function t(t,e,n){var r=this;this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){r.execute()};var i="string"==typeof t?document.getElementById(t):t;U(i,"argument-error",{appName:e}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return t.prototype.getResponse=function(){return this.checkIfDeleted(),this.responseToken},t.prototype.delete=function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)},t.prototype.execute=function(){var t=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(function(){t.responseToken=function(t){for(var e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}(50);var e=t.params,n=e.callback,r=e["expired-callback"];if(n)try{n(t.responseToken)}catch(t){}t.timerId=window.setTimeout(function(){if(t.timerId=null,t.responseToken=null,r)try{r()}catch(t){}t.isVisible&&t.execute()},6e4)},500))},t.prototype.checkIfDeleted=function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")},t}();var xn=Ze("rcb"),Mn=new K(3e4,6e4),Un=function(){function t(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Pe().grecaptcha}return t.prototype.load=function(t,e){var n=this;return void 0===e&&(e=""),U(function(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}(e),t,"argument-error"),this.shouldResolveImmediately(e)?Promise.resolve(Pe().grecaptcha):new Promise(function(r,i){var s=Pe().setTimeout(function(){i(x(t,"network-request-failed"))},Mn.get());Pe()[xn]=function(){Pe().clearTimeout(s),delete Pe()[xn];var o=Pe().grecaptcha;if(o){var a=o.render;o.render=function(t,e){var r=a(t,e);return n.counter++,r},n.hostLanguage=e,r(o)}else i(x(t,"internal-error"))},Qe("https://www.google.com/recaptcha/api.js??"+m({onload:xn,render:"explicit",hl:e})).catch(function(){clearTimeout(s),i(x(t,"internal-error"))})})},t.prototype.clearedOneInstance=function(){this.counter--},t.prototype.shouldResolveImmediately=function(t){return!!Pe().grecaptcha&&(t===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)},t}();var Vn=function(){function t(){}return t.prototype.load=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,new Cn(t)]})})},t.prototype.clearedOneInstance=function(){},t}(),Fn="recaptcha",jn={theme:"light",type:"image"},qn=function(){function t(t,e,n){void 0===e&&(e=i({},jn)),this.parameters=e,this.type=Fn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Bt(n),this.isInvisible="invisible"===this.parameters.size,U("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var r="string"==typeof t?document.getElementById(t):t;U(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Vn:new Un,this.validateStartingState()}return t.prototype.verify=function(){return o(this,void 0,void 0,function(){var t,e,n,r=this;return a(this,function(i){switch(i.label){case 0:return this.assertNotDestroyed(),[4,this.render()];case 1:return t=i.sent(),e=this.getAssertedRecaptcha(),(n=e.getResponse(t))?[2,n]:[2,new Promise(function(n){var i=function(t){t&&(r.tokenChangeListeners.delete(i),n(t))};r.tokenChangeListeners.add(i),r.isInvisible&&e.execute(t)})]}})})},t.prototype.render=function(){var t=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(function(e){throw t.renderPromise=null,e}),this.renderPromise)},t.prototype._reset=function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)},t.prototype.clear=function(){var t=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(function(e){t.container.removeChild(e)})},t.prototype.validateStartingState=function(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error")},t.prototype.makeTokenCallback=function(t){var e=this;return function(n){if(e.tokenChangeListeners.forEach(function(t){return t(n)}),"function"==typeof t)t(n);else if("string"==typeof t){var r=Pe()[t];"function"==typeof r&&r(n)}}},t.prototype.assertNotDestroyed=function(){U(!this.destroyed,this.auth,"internal-error")},t.prototype.makeRenderPromise=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return[4,this.init()];case 1:return n.sent(),this.widgetId||(t=this.container,this.isInvisible||(e=document.createElement("div"),t.appendChild(e),t=e),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),[2,this.widgetId]}})})},t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return U(H()&&!Ce(),this.auth,"internal-error"),[4,(r=null,new Promise(function(t){"complete"!==document.readyState?(r=function(){return t()},window.addEventListener("load",r)):t()}).catch(function(t){throw r&&window.removeEventListener("load",r),t}))];case 1:return n.sent(),t=this,[4,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0)];case 2:return t.recaptcha=n.sent(),[4,function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,tt(t,"GET","/v1/recaptchaParams")];case 1:return[2,e.sent().recaptchaSiteKey||""]}})})}(this.auth)];case 3:return U(e=n.sent(),this.auth,"internal-error"),this.parameters.sitekey=e,[2]}var r})})},t.prototype.getAssertedRecaptcha=function(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha},t}();var Bn=function(){function t(t,e){this.verificationId=t,this.onConfirmation=e}return t.prototype.confirm=function(t){var e=pt._fromVerification(this.verificationId,t);return this.onConfirmation(e)},t}();function zn(t,e,n){var r;return o(this,void 0,void 0,function(){var s,u,c,h;return a(this,function(l){switch(l.label){case 0:return[4,n.verify()];case 1:s=l.sent(),l.label=2;case 2:return l.trys.push([2,,10,11]),U("string"==typeof s,t,"argument-error"),U(n.type===Fn,t,"argument-error"),u=void 0,"session"in(u="string"==typeof e?{phoneNumber:e}:e)?(c=u.session,"phoneNumber"in u?(U("enroll"===c.type,t,"internal-error"),[4,function(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:start",i({tenantId:t.tenantId},e))}(t,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:s}})]):[3,4]):[3,7];case 3:return[2,l.sent().phoneSessionInfo.sessionInfo];case 4:return U("signin"===c.type,t,"internal-error"),U(h=(null===(r=u.multiFactorHint)||void 0===r?void 0:r.uid)||u.multiFactorUid,t,"missing-multi-factor-info"),[4,function(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:start",i({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:s}})];case 5:return[2,l.sent().phoneResponseInfo.sessionInfo];case 6:return[3,9];case 7:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:sendVerificationCode",e)]})})}(t,{phoneNumber:u.phoneNumber,recaptchaToken:s})];case 8:return[2,l.sent().sessionInfo];case 9:return[3,11];case 10:return n._reset(),[7];case 11:return[2]}})})}var Gn=function(){function t(e){this.providerId=t.PROVIDER_ID,this.auth=Bt(e)}return t.prototype.verifyPhoneNumber=function(t,e){return zn(this.auth,t,e)},t.credential=function(t,e){return pt._fromVerification(t,e)},t.credentialFromResult=function(t){var e=t;U(e._tokenResponse,e.user.auth,"argument-error");var n=e._tokenResponse,r=n.phoneNumber,i=n.temporaryProof;if(r&&i)return pt._fromTokenResponse(r,i);L(e.user.auth,"argument-error")},t.PROVIDER_ID="phone",t.PHONE_SIGN_IN_METHOD="phone",t}(),Hn=new K(2e3,1e4);var $n,Wn=function(t){function e(n,r,i,s,o){var a=t.call(this,n,r,s,o)||this;return a.provider=i,a.authWindow=null,a.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=a,a}return r(e,t),e.prototype.executeNotNull=function(){return o(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,this.execute()];case 1:return U(t=e.sent(),this.auth,"internal-error"),[2,t]}})})},e.prototype.onExecution=function(){return o(this,void 0,void 0,function(){var t,e,n=this;return a(this,function(r){switch(r.label){case 0:return F(1===this.filter.length,"Popup operations only handle one event"),t=We(),e=this,[4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t)];case 1:return e.authWindow=r.sent(),this.authWindow.associatedEvent=t,this.resolver._isIframeWebStorageSupported(this.auth,function(t){t||n.reject(x(n.auth,"web-storage-unsupported"))}),this.pollUserCancellation(),[2]}})})},Object.defineProperty(e.prototype,"eventId",{get:function(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.reject(x(this.auth,"cancelled-popup-request"))},e.prototype.cleanUp=function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null},e.prototype.pollUserCancellation=function(){var t=this,e=function(){var n,r;null!==(r=null===(n=t.authWindow)||void 0===n?void 0:n.window)&&void 0!==r&&r.closed?t.pollId=window.setTimeout(function(){t.pollId=null,t.reject(x(t.auth,"popup-closed-by-user"))},2e3):t.pollId=window.setTimeout(e,Hn.get())};e()},e.currentPopupAction=null,e}(In),Kn=function(t){function e(e){var n=t.call(this,"phone")||this;return n.credential=e,n}return r(e,t),e._fromCredential=function(t){return new e(t)},e.prototype._finalizeEnroll=function(t,e,n){return function(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:finalize",i({tenantId:t.tenantId},e))}(t,{idToken:e,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})},e.prototype._finalizeSignIn=function(t,e){return function(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:finalize",i({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:e,phoneVerificationInfo:this.credential._makeVerificationRequest()})},e}(function(){function t(t){this.factorId=t}return t.prototype._process=function(t,e,n){switch(e.type){case"enroll":return this._finalizeEnroll(t,e.credential,n);case"signin":return this._finalizeSignIn(t,e.credential);default:return V("unexpected MultiFactorSessionType")}},t}()),Yn=function(){function t(){}return t.assertion=function(t){return Kn._fromCredential(t)},t}();$n="Browser",e._registerComponent(new k("auth-exp",function(t){var e=t.getProvider("app-exp").getImmediate(),n=e.options,r=n.apiKey,i=n.authDomain;return function(t){U(r,"invalid-api-key",{appName:t.name});var e={apiKey:r,authDomain:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ae($n)};return new qt(t,e)}(e)},"PUBLIC")),e._registerComponent(new k("auth-internal",function(t){return function(t){return new ke(t)}(Bt(t.getProvider("auth-exp").getImmediate()))},"PRIVATE")),e.registerVersion("auth-exp",ge,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";default:return}}($n)),t.ActionCodeURL=mt,t.AuthCredential=z,t.EmailAuthCredential=ct,t.EmailAuthProvider=vt,t.FacebookAuthProvider=wt,t.GithubAuthProvider=_t,t.GoogleAuthProvider=bt,t.OAuthCredential=ft,t.OAuthProvider=yt,t.PhoneAuthCredential=pt,t.PhoneAuthProvider=Gn,t.PhoneMultiFactorGenerator=Yn,t.RecaptchaVerifier=qn,t.TwitterAuthProvider=It,t.applyActionCode=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}(t,{oobCode:e})];case 1:return n.sent(),[2]}})})},t.browserLocalPersistence=Oe,t.browserPopupRedirectResolver=Rn,t.browserSessionPersistence=hn,t.checkActionCode=re,t.confirmPasswordReset=function(t,e,n){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,ot(t,{oobCode:e,newPassword:n})];case 1:return r.sent(),[2]}})})},t.createUserWithEmailAndPassword=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return r=Bt(t),[4,Et(t,{returnSecureToken:!0,email:e,password:n})];case 1:return i=o.sent(),[4,Ut._fromIdTokenResponse(r,"signIn",i)];case 2:return s=o.sent(),[4,r._updateCurrentUser(s.user)];case 3:return o.sent(),[2,s]}})})},t.debugErrorMap=O,t.deleteUser=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,t.delete()]})})},t.fetchSignInMethodsForEmail=function(t,e){return o(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=H()?G():"http://localhost",[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:createAuthUri",e)]})})}(t,{identifier:e,continueUri:n})];case 1:return[2,r.sent().signinMethods||[]]}})})},t.getAdditionalUserInfo=function(t){var e=t,n=e.user,r=e._tokenResponse;return n.isAnonymous&&!r?{providerId:null,isNewUser:!1,profile:null}:function(t){var e,n;if(!t)return null;var r=t.providerId,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||"identitytoolkit#SignupNewUserResponse"===t.kind;if(!r&&(null==t?void 0:t.idToken)){var o=null===(n=null===(e=Nt(t.idToken))||void 0===e?void 0:e.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new se(s,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new ae(s,i);case"github.com":return new ue(s,i);case"google.com":return new ce(s,i);case"twitter.com":return new he(s,i,t.screenName||null);case"custom":case"anonymous":return new se(s,null);default:return new se(s,r,i)}}(r)},t.getAuth=function(t){return B(t,{popupRedirectResolver:Rn,persistence:[ze,Oe]})},t.getIdToken=function(t,e){return void 0===e&&(e=!1),t.getIdToken(e)},t.getIdTokenResult=At,t.getMultiFactorResolver=function(t,e){var n,r=e;return U(e.operationType,t,"argument-error"),U(null===(n=r.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,t,"argument-error"),fe._fromError(t,r)},t.getRedirectResult=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Bt(t)._initializationPromise];case 1:return n.sent(),[2,En(t,e,!1)]}})})},t.inMemoryPersistence=gt,t.indexedDBLocalPersistence=ze,t.initializeAuth=B,t.isSignInWithEmailLink=function(t,e){var n=mt.parseLink(e);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)},t.linkWithCredential=Qt,t.linkWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){switch(s.label){case 0:return[4,Kt(!1,r=t,"phone")];case 1:return s.sent(),[4,zn(r.auth,e,n)];case 2:return i=s.sent(),[2,new Bn(i,function(e){return Qt(t,e)})]}})})},t.linkWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return U(e instanceof yt,(r=t).auth,"argument-error"),i=On(r.auth,n),[2,new Wn(r.auth,"linkViaPopup",e,i,r).executeNotNull()]})})},t.linkWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return U(e instanceof yt,(r=t).auth,"argument-error"),i=On(r.auth,n),[4,Kt(!1,r,e.providerId)];case 1:return o.sent(),[4,Tn(r)];case 2:return s=o.sent(),[2,i._openRedirect(r.auth,e,"linkViaRedirect",s)]}})})},t.multiFactor=function(t){return pe.has(t)||pe.set(t,de._fromUser(t)),pe.get(t)},t.onAuthStateChanged=function(t,e,n,r){return t.onAuthStateChanged(e,n,r)},t.onIdTokenChanged=function(t,e,n,r){return t.onIdTokenChanged(e,n,r)},t.parseActionCodeURL=function(t){return mt.parseLink(t)},t.prodErrorMap=R,t.reauthenticateWithCredential=Zt,t.reauthenticateWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return[4,zn(t.auth,e,n)];case 1:return r=i.sent(),[2,new Bn(r,function(e){return Zt(t,e)})]}})})},t.reauthenticateWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return U(e instanceof yt,(r=t).auth,"argument-error"),i=On(r.auth,n),[2,new Wn(r.auth,"reauthViaPopup",e,i,r).executeNotNull()]})})},t.reauthenticateWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(o){switch(o.label){case 0:return U(e instanceof yt,(r=t).auth,"argument-error"),i=On(r.auth,n),[4,Tn(r)];case 1:return s=o.sent(),[2,i._openRedirect(r.auth,e,"reauthViaRedirect",s)]}})})},t.reload=Ct,t.sendEmailVerification=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=t,[4,t.getIdToken()];case 1:return r=s.sent(),i={requestType:"VERIFY_EMAIL",idToken:r},e&&ne(n.auth,i,e),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(n.auth,i)];case 2:return s.sent().email===t.email?[3,4]:[4,t.reload()];case 3:s.sent(),s.label=4;case 4:return[2]}})})},t.sendPasswordResetEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return r={requestType:"PASSWORD_RESET",email:e},n&&ne(t,r,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(t,r)];case 1:return i.sent(),[2]}})})},t.sendSignInLinkToEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return r={requestType:"EMAIL_SIGNIN",email:e},U(null==n?void 0:n.handleCodeInApp,t,"argument-error"),n&&ne(t,r,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(t,r)];case 1:return i.sent(),[2]}})})},t.setPersistence=function(t,e){t.setPersistence(e)},t.signInAnonymously=function(t){var e;return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return n=Bt(t),(null===(e=n.currentUser)||void 0===e?void 0:e.isAnonymous)?[2,new Ut({user:n.currentUser,providerId:null,operationType:"signIn"})]:[4,Et(n,{returnSecureToken:!0})];case 1:return r=s.sent(),[4,Ut._fromIdTokenResponse(n,"signIn",r,!0)];case 2:return i=s.sent(),[4,n._updateCurrentUser(i.user)];case 3:return s.sent(),[2,i]}})})},t.signInWithCredential=Jt,t.signInWithCustomToken=function(t,e){return o(this,void 0,void 0,function(){var n,r,i;return a(this,function(s){switch(s.label){case 0:return[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,nt(t,"POST","/v1/accounts:signInWithCustomToken",e)]})})}(t,{token:e,returnSecureToken:!0})];case 1:return n=s.sent(),r=Bt(t),[4,Ut._fromIdTokenResponse(r,"signIn",n)];case 2:return i=s.sent(),[4,r._updateCurrentUser(i.user)];case 3:return s.sent(),[2,i]}})})},t.signInWithEmailAndPassword=function(t,e,n){return Jt(t,vt.credential(e,n))},t.signInWithEmailLink=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){return U((r=vt.credentialWithLink(e,n||G())).tenantId===(t.tenantId||null),t,"tenant-id-mismatch"),[2,Jt(t,r)]})})},t.signInWithPhoneNumber=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){switch(i.label){case 0:return[4,zn(Bt(t),e,n)];case 1:return r=i.sent(),[2,new Bn(r,function(e){return Jt(t,e)})]}})})},t.signInWithPopup=function(t,e,n){return o(this,void 0,void 0,function(){var r,i;return a(this,function(s){return r=Bt(t),U(e instanceof yt,t,"argument-error"),i=On(r,n),[2,new Wn(r,"signInViaPopup",e,i).executeNotNull()]})})},t.signInWithRedirect=function(t,e,n){return o(this,void 0,void 0,function(){var r;return a(this,function(i){return r=Bt(t),U(e instanceof yt,t,"argument-error"),[2,On(r,n)._openRedirect(r,e,"signInViaRedirect")]})})},t.signOut=function(t){return t.signOut()},t.unlink=function(t,e){return o(this,void 0,void 0,function(){var n,r,i,s,o,u;return a(this,function(a){switch(a.label){case 0:return[4,Kt(!0,n=t,e)];case 1:return a.sent(),i=Tt,s=[n.auth],u={},[4,t.getIdToken()];case 2:return[4,i.apply(void 0,s.concat([(u.idToken=a.sent(),u.deleteProvider=[e],u)]))];case 3:return r=a.sent().providerUserInfo,o=$t(r||[]),n.providerData=t.providerData.filter(function(t){return o.has(t.providerId)}),o.has("phone")||(n.phoneNumber=null),[4,n.auth._persistUserIfCurrent(n)];case 4:return a.sent(),[2,t]}})})},t.updateCurrentUser=function(t,e){return t.updateCurrentUser(e)},t.updateEmail=function(t,e){return ie(t,e,null)},t.updatePassword=function(t,e){return ie(t,null,e)},t.updatePhoneNumber=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Wt(t,e)];case 1:return n.sent(),[2]}})})},t.updateProfile=function(t,e){var n=e.displayName,r=e.photoURL;return o(this,void 0,void 0,function(){var e,i,s,u,c;return a(this,function(h){switch(h.label){case 0:return void 0===n&&void 0===r?[2]:(e=t,[4,t.getIdToken()]);case 1:return i=h.sent(),s={idToken:i,displayName:n,photoUrl:r,returnSecureToken:!0},[4,Ot(e,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,tt(t,"POST","/v1/accounts:update",e)]})})}(e.auth,s))];case 2:return u=h.sent(),e.displayName=u.displayName||null,e.photoURL=u.photoUrl||null,(c=e.providerData.find(function(t){return"password"===t.providerId}))&&(c.displayName=t.displayName,c.photoURL=t.photoURL),[4,e._updateTokensIfNecessary(u)];case 3:return h.sent(),[2]}})})},t.useDeviceLanguage=function(t){t.useDeviceLanguage()},t.verifyBeforeUpdateEmail=function(t,e,n){return o(this,void 0,void 0,function(){var r,i,s;return a(this,function(u){switch(u.label){case 0:return r=t,[4,t.getIdToken()];case 1:return i=u.sent(),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:e},n&&ne(r.auth,s,n),[4,function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,ut(t,e)]})})}(r.auth,s)];case 2:return u.sent().email===t.email?[3,4]:[4,t.reload()];case 3:u.sent(),u.label=4;case 4:return[2]}})})},t.verifyPasswordResetCode=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,re(t,e)];case 1:return[2,n.sent().data.email]}})})},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-auth.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.functions=t.firebase.functions||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var o="FirebaseError",a=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=o,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,u.prototype.create),s}return r(e,t),e}(Error),u=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",u=this.serviceName+": "+o+" ("+i+").";return new a(i,u,r)},t}();var c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),l="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";function d(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function p(t){if(null==t)return t;if(t["@type"])switch(t["@type"]){case l:case f:var e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return p(t)}):"function"==typeof t||"object"==typeof t?d(t,function(t){return p(t)}):t}var g="functions",m={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},v=function(t){function e(e,n,r){var i=t.call(this,g+"/"+e,n||"")||this;return i.details=r,i}return r(e,t),e}(a);var y=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return i(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return[2,null==(t=e.sent())?void 0:t.accessToken];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getMessagingToken=function(){return i(this,void 0,void 0,function(){return s(this,function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]})})},t.prototype.getContext=function(){return i(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getMessagingToken()];case 2:return e=n.sent(),[2,{authToken:t,messagingToken:e}]}})})},t}(),w="us-central1";var b=function(){function t(t,e,n,r,i){var s=this;void 0===r&&(r=w),this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new y(e,n),this.cancelAllRequests=new Promise(function(t){s.deleteService=function(){return Promise.resolve(t())}});try{var o=new URL(r);this.customDomain=o.origin,this.region=w}catch(t){this.customDomain=null,this.region=r}}return t.prototype._delete=function(){return this.deleteService()},t.prototype._url=function(t){var e=this.app.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t}();function _(t,e,n){return function(r){return function(t,e,n,r){return i(this,void 0,void 0,function(){var o,a,u,c,h,l,f,g;return s(this,function(y){switch(y.label){case 0:return o=t._url(e),n=function t(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t(e)});if("function"==typeof e||"object"==typeof e)return d(e,function(e){return t(e)});throw new Error("Data cannot be encoded in JSON: "+e)}(n),a={data:n},u={},[4,t.contextProvider.getContext()];case 1:return(c=y.sent()).authToken&&(u.Authorization="Bearer "+c.authToken),c.messagingToken&&(u["Firebase-Instance-ID-Token"]=c.messagingToken),h=r.timeout||7e4,[4,Promise.race([function(t,e,n,r){return i(this,void 0,void 0,function(){var i,o;return s(this,function(s){switch(s.label){case 0:n["Content-Type"]="application/json",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return i=s.sent(),[3,4];case 3:return s.sent(),[2,{status:0,json:null}];case 4:o=null,s.label=5;case 5:return s.trys.push([5,7,,8]),[4,i.json()];case 6:return o=s.sent(),[3,8];case 7:return s.sent(),[3,8];case 8:return[2,{status:i.status,json:o}]}})})}(o,a,u,t.fetchImpl),(w=h,new Promise(function(t,e){setTimeout(function(){e(new v("deadline-exceeded","deadline-exceeded"))},w)})),t.cancelAllRequests])];case 2:if(!(l=y.sent()))throw new v("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e){var n=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=n,i=void 0;try{var s=e&&e.error;if(s){var o=s.status;if("string"==typeof o){if(!m[o])return new v("internal","internal");n=m[o],r=o}var a=s.message;"string"==typeof a&&(r=a),void 0!==(i=s.details)&&(i=p(i))}}catch(t){}return"ok"===n?null:new v(n,r,i)}(l.status,l.json))throw f;if(!l.json)throw new v("internal","Response is not valid JSON object.");if(void 0===(g=l.json.data)&&(g=l.json.result),void 0===g)throw new v("internal","Response is missing data field.");return[2,{data:p(g)}]}var w})})}(t,e,r,n||{})}}var I;I=fetch.bind(self),e._registerComponent(new h(g,function(t,e){var n=t.getProvider("app-exp").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new b(n,r,i,e,I)},"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/functions-exp","0.0.900"),t.getFunctions=function(t,n){return void 0===n&&(n=w),e._getProvider(t,g).getImmediate({identifier:n})},t.httpsCallable=function(t,e,n){return _(t,e,n)},t.useFunctionsEmulator=function(t,e,n){!function(t,e,n){t.emulatorOrigin="http://"+e+":"+n}(t,e,n)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-functions.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.firestore=t.firebase.firestore||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var i="FirebaseError",s=function(t){function e(n,r,s){var a=t.call(this,r)||this;return a.code=n,a.customData=s,a.name=i,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,o.prototype.create),a}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",u=this.serviceName+": "+a+" ("+i+").";return new s(i,u,r)},t}();var a,u,c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(u||(u={}));var f={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},d=u.INFO,p=((a={})[u.DEBUG]="log",a[u.VERBOSE]="log",a[u.INFO]="info",a[u.WARN]="warn",a[u.ERROR]="error",a),g=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=p[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,l(["["+i+"]  "+t.name+":"],n))}},m=function(){function t(t){this.name=t,this._logLevel=d,this._logHandler=g,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?f[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.DEBUG],t)),this._logHandler.apply(this,l([this,u.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.VERBOSE],t)),this._logHandler.apply(this,l([this,u.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.INFO],t)),this._logHandler.apply(this,l([this,u.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.WARN],t)),this._logHandler.apply(this,l([this,u.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,u.ERROR],t)),this._logHandler.apply(this,l([this,u.ERROR],t))},t}(),v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function y(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var w,b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},I=b||self;function E(){}function T(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var A="closure_uid_"+(1e9*Math.random()>>>0),k=0;function N(t,e,n){return t.call.apply(t.bind,arguments)}function O(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function R(t,e,n){return(R=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?N:O).apply(null,arguments)}function D(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function P(){return Date.now()}function C(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function L(){this.j=this.j,this.i=this.i}L.prototype.j=!1,L.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,A)&&t[A]||(t[A]=++k)})(this)},L.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},M=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,s=0;s<r;s++)s in i&&e.call(n,i[s],s,t)};function U(t){return Array.prototype.concat.apply([],arguments)}function V(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function F(t){return/^[\s\xa0]*$/.test(t)}var j,q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function B(t,e){return-1!=t.indexOf(e)}function z(t,e){return t<e?-1:t>e?1:0}t:{var G=I.navigator;if(G){var H=G.userAgent;if(H){j=H;break t}}j=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function W(t){var e={};for(var n in t)e[n]=t[n];return e}var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var s=0;s<K.length;s++)n=K[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function X(t){return X[" "](t),t}X[" "]=E;var J,Q,Z=B(j,"Opera"),tt=B(j,"Trident")||B(j,"MSIE"),et=B(j,"Edge"),nt=et||tt,rt=B(j,"Gecko")&&!(B(j.toLowerCase(),"webkit")&&!B(j,"Edge"))&&!(B(j,"Trident")||B(j,"MSIE"))&&!B(j,"Edge"),it=B(j.toLowerCase(),"webkit")&&!B(j,"Edge");function st(){var t=I.document;return t?t.documentMode:void 0}t:{var ot="",at=(Q=j,rt?/rv:([^\);]+)(\)|;)/.exec(Q):et?/Edge\/([\d\.]+)/.exec(Q):tt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Q):it?/WebKit\/(\S+)/.exec(Q):Z?/(?:Version)[ \/]?(\S+)/.exec(Q):void 0);if(at&&(ot=at?at[1]:""),tt){var ut=st();if(null!=ut&&ut>parseFloat(ot)){J=String(ut);break t}}J=ot}var ct,ht={};function lt(t){return function(t,e){var n=ht;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=q(String(J)).split("."),r=q(String(t)).split("."),i=Math.max(n.length,r.length),s=0;0==e&&s<i;s++){var o=n[s]||"",a=r[s]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=z(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||z(0==o[2].length,0==a[2].length)||z(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e})}if(I.document&&tt){var ft=st();ct=ft||(parseInt(J,10)||void 0)}else ct=void 0;var dt=ct,pt=!tt||9<=Number(dt),gt=tt&&!lt("9"),mt=function(){if(!I.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{I.addEventListener("test",E,e),I.removeEventListener("test",E,e)}catch(t){}return t}();function vt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(vt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(rt){t:{try{X(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:wt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}vt.prototype.b=function(){this.defaultPrevented=!0},C(yt,vt);var wt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var bt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],s=x(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(It(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function St(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.Y&&s.listener==e&&s.capture==!!n&&s.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.a[s])||(t=this.a[s]=[],this.b++);var o=St(t,e,r,i);return-1<o?(e=t[o],n||(e.Z=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}(e,this.src,s,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),kt={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,s){if(Array.isArray(n)){for(var o=0;o<n.length;o++)t(e,n[o],r,i,s);return null}r=Mt(r);return e&&e[bt]?e.wa(n,r,S(i)?!!i.capture:!!i,s):Ot(e,n,r,!0,i,s)}(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Nt(t,e[s],n,r,i);return null}return n=Mt(n),t&&t[bt]?t.va(e,n,S(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=S(i)?!!i.capture:!!i;if(o&&!pt)return null;var a=Lt(t);if(a||(t[At]=a=new Et(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){var t=Ct,e=pt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)mt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[bt])Tt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):It(t)}}}function Dt(t){return t in kt?kt[t]:kt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(!pt){if(!e)t:{e=["window","event"];for(var n=I,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new yt(e,this))}return Pt(t,new yt(e,this))}function Lt(t){return(t=t[At])instanceof Et?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(t){return"function"==typeof t?t:(t[xt]||(t[xt]=function(e){return t.handleEvent(e)}),t[xt])}function Ut(){L.call(this),this.c=new Et(this),this.J=this,this.C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new vt(e,t);else if(e instanceof vt)e.target=e.target||t;else{var i=e;Y(e=new vt(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.a=n[s];i=Ft(o,r,!0,e)&&i}if(i=Ft(o=e.a=t,r,!0,e)&&i,i=Ft(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Ft(o=e.a=n[s],r,!1,e)&&i}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.Y&&o.capture==n){var a=o.listener,u=o.ca||o.src;o.Z&&Tt(t.c,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}C(Ut,L),Ut.prototype[bt]=!0,(w=Ut.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},w.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)t(e,n[o],r,i,s);else i=S(i)?!!i.capture:!!i,r=Mt(r),e&&e[bt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(o=e.a[n],r,i,s))&&(It(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete e.a[n],e.b--))):e&&(e=Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,s)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},w.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},w.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},w.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var jt=I.JSON.stringify;function qt(){this.b=this.a=null}var Bt,zt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Ht},function(t){t.reset()});function Gt(){var t=Yt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ht(){this.next=this.b=this.a=null}function $t(t){I.setTimeout(function(){throw t},0)}function Wt(t,e){Bt||function(){var t=I.Promise.resolve(void 0);Bt=function(){t.then(Xt)}}(),Kt||(Bt(),Kt=!0),Yt.add(t,e)}qt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ht.prototype.reset=function(){this.next=this.b=this.a=null};var Kt=!1,Yt=new qt;function Xt(){for(var t;t=Gt();){try{t.a.call(t.b)}catch(t){$t(t)}var e=zt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Kt=!1}function Jt(t,e){Ut.call(this),this.b=t||1,this.a=e||I,this.f=R(this.Za,this),this.g=P()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==typeof t)n&&(t=R(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=R(t.handleEvent,t)}return 2147483647<Number(e)?-1:I.setTimeout(t,e||0)}C(Jt,Ut),(w=Jt.prototype).aa=!1,w.M=null,w.Za=function(){if(this.aa){var t=P()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Qt(this),this.start()))}},w.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=P())},w.G=function(){Jt.X.G.call(this),Qt(this),delete this.a};var te=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(I.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(L);function ee(t){L.call(this),this.b=t,this.a={}}C(ee,L);var ne=[];function re(t,e,n,r){Array.isArray(n)||(n&&(ne[0]=n.toString()),n=ne);for(var i=0;i<n.length;i++){var s=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!s)break;t.a[s.key]=s}}function ie(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function se(){this.a=!0}function oe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return jt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ee.prototype.G=function(){ee.X.G.call(this),ie(this)},ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ue=null;function ce(){return ue=ue||new Ut}function he(t){vt.call(this,ae.Fa,t)}function le(t){var e=ce();Vt(e,new he(e,t))}function fe(t,e){vt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=ce();Vt(e,new fe(e,t))}function pe(t){vt.call(this,ae.Ga,t)}function ge(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return I.setTimeout(function(){t()},e)}ae.Fa="serverreachability",C(he,vt),ae.STAT_EVENT="statevent",C(fe,vt),ae.Ga="timingevent",C(pe,vt);var me={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ve={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ye(){}function we(t){var e;return(e=t.a)||(e=t.a={}),e}function be(){}ye.prototype.a=null;var _e,Ie={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ee(){vt.call(this,"d")}function Te(){vt.call(this,"c")}function Se(){}function Ae(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ee(this),this.P=ke,t=nt?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}C(Ee,vt),C(Te,vt),C(Se,ye),_e=new Se;var ke=45e3,Ne={},Oe={};function Re(t,e,n){t.H=1,t.i=Qe($e(e)),t.j=n,t.I=!0,De(t,null)}function De(t,e){t.u=P(),Le(t),t.l=$e(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=sr(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(R(t.Ca,t,t.a),t.O)),re(t.J,t.a,"readystatechange",t.Xa),e=t.B?W(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(1),function(t,e,n,r,i,s){t.info(function(){if(t.a)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+c+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Pe(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ce(t,n);if(i==Oe){4==e&&(t.h=4,de(14),r=!1),oe(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ne){t.h=4,de(15),oe(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}oe(t.c,t.f,i,null),Fe(t,i)}4==e&&0==n.length&&(t.h=1,de(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(e),e.F=!0,de(11))):(oe(t.c,t.f,n,"[Invalid Chunked Response]"),Ve(t),Ue(t))}function Ce(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Oe:(n=Number(e.substring(n,r)),isNaN(n)?Ne:(r+=1)+n>e.length?Oe:(e=e.substr(r,n),t.D=r+n,e))}function Le(t){t.T=P()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ge(R(t.Va,t),e)}function Me(t){t.o&&(I.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||tr(t.g,t)}function Ve(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),ie(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||wn(n.b,t)))if(n.I=t.N,!t.C&&wn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Zn(n),Bn(n)}Xn(n),de(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ge(R(n.Sa,n),6e3));if(1>=yn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else nr(n,11)}else if((t.C||n.a==t)&&Zn(n),!F(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var s=i[3];null!=s&&(n.ha=s,n.c.info("VER="+n.ha));var o=i[4];null!=o&&(n.pa=o,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(B(h,"spdy")||B(h,"quic")||B(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(bn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Je(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=P()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=ir(u,u.C?u.ga:null,u.fa),d.C){_n(u.b,d);var p=d,g=u.D;g&&p.setTimeout(g),p.o&&(Me(p),Le(p)),u.a=d}else Yn(u);0<n.g.length&&Hn(n)}else"stop"!=i[0]&&"close"!=i[0]||nr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?nr(n,7):qn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);le(4)}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(T(t)||"string"==typeof t)M(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(T(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(T(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(w=Ae.prototype).setTimeout=function(t){this.P=t},w.Xa=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},w.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!nt&&!this.a.$())){this.A||4!=e||7==n||le(8==n||0>=r?3:2),Me(this);var i=this.a.W();this.N=i;var s=this.a.$();if(this.b=200==i,function(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var o,a=this.a;if((o=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,de(12),Ve(this),Ue(this);break t}oe(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,u)}this.I?(Pe(this,e,s),nt&&this.b&&3==e&&(re(this.J,this.R,"tick",this.Wa),this.R.start())):(oe(this.c,this.f,s,null),Fe(this,s)),4==e&&Ve(this),this.b&&!this.A&&(4==e?tr(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Ve(this),Ue(this)}}}catch(t){}},w.Wa=function(){if(this.a){var t=Un(this.a),e=this.a.$();this.D<e.length&&(Me(this),Pe(this,t,e),this.b&&4!=t&&Le(this))}},w.cancel=function(){this.A=!0,Ve(this)},w.Va=function(){this.o=null;var t=P();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(le(3),de(17)),Ve(this),this.h=2,Ue(this)):xe(this,this.T-t)},(w=qe.prototype).K=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},w.L=function(){return Be(this),this.a.concat()},w.get=function(t,e){return ze(this.b,t)?this.b[t]:e},w.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},w.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);t.call(e,s,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He){this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Ke(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b;var n=new un;n.c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Xe(this,n),this.i=t.i}else t&&(n=String(t).match(Ge))?(this.a=!!e,We(this,n[1]||"",!0),this.j=Ze(n[2]||""),Ke(this,n[3]||"",!0),Ye(this,n[4]),this.g=Ze(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function $e(t){return new He(t)}function We(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?Ze(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){e instanceof un?(t.b=e,function(t,e){e&&!t.f&&(cn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),fn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=tn(e,on)),t.b=new un(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Qe(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^P()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function tn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,en),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function en(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(tn(e,nn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(tn(e,nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(tn(n,"/"==n.charAt(0)?sn:rn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",tn(n,an)),t.join("")};var nn=/[#\/\?@]/g,rn=/[#\?:]/g,sn=/[#\?]/g,on=/[#\?@]/g,an=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(t){t.a||(t.a=new qe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function hn(t,e){cn(t),e=dn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function ln(t,e){return cn(t),e=dn(t,e),ze(t.a.b,e)}function fn(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),V(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(w=un.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},w.forEach=function(t,e){cn(this),this.a.forEach(function(n,r){M(n,function(n){t.call(e,n,r,this)},this)},this)},w.L=function(){cn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],s=0;s<i.length;s++)n.push(e[r]);return n},w.K=function(t){cn(this);var e=[];if("string"==typeof t)ln(this,t)&&(e=U(e,this.a.get(dn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=U(e,t[n])}return e},w.set=function(t,e){return cn(this),this.c=null,ln(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},w.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},w.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),t.push(o)}}return this.c=t.join("&")};var pn=function(){return function(t,e){this.b=t,this.a=e}}();function gn(t){this.g=t||mn,I.PerformanceNavigationTiming?t=0<(t=I.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(I.ia&&I.ia.ya&&I.ia.ya()&&I.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var mn=10;function vn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function yn(t){return t.b?1:t.a?t.a.size:0}function wn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function bn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=y(t.a.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.s)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return V(t.c)}function En(){}function Tn(t,e,n){var r=n||"";try{je(t,function(t,n){var i=t;S(t)&&(i=jt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=y(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return I.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return I.JSON.parse(t,void 0)};var An=I.JSON.parse;function kn(t){Ut.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Nn,this.D=this.F=!1}C(kn,Ut);var Nn="",On=/^https?$/i,Rn=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),xn(t)}function Cn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Ln(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Zt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.B).match(Ge)[1]||null;if(!s&&I.self&&I.self.location){var o=I.self.location.protocol;s=o.substr(0,o.length-1)}i=!On.test(s?s.toLowerCase():"")}e=i}if(e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var a=2<Un(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Cn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?E:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(I.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function Vn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return $(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Fn("baseRetryDelayMs",5e3,t),this.Ra=Fn("retryDelaySeedMs",1e4,t),this.Ma=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new function(){this.a=new En},this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){if(zn(t),3==t.v){var e=t.R++,n=$e(t.B);Je(n,"SID",t.J),Je(n,"RID",e),Je(n,"TYPE","terminate"),Wn(t,n),(e=new Ae(t,t.c,e,void 0)).H=2,e.i=Qe($e(n)),n=!1,I.navigator&&I.navigator.sendBeacon&&(n=I.navigator.sendBeacon(e.i.toString(),"")),!n&&I.Image&&((new Image).src=e.i,n=!0),n||(e.a=sr(e.g,null),e.a.ba(e.i)),e.u=P(),Le(e)}rr(t)}function Bn(t){t.a&&(Jn(t),t.a.cancel(),t.a=null)}function zn(t){Bn(t),t.j&&(I.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&I.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Hn(t)}function Hn(t){vn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function $n(t,e){var n;n=e?e.f:t.R++;var r=$e(t.B);Je(r,"SID",t.J),Je(r,"RID",n),Je(r,"AID",t.P),Wn(t,r),t.i&&t.l&&Vn(r,t.i,t.l),n=new Ae(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),bn(t.b,n),Re(n,r,e)}function Wn(t,e){t.f&&je({},function(t,n){Je(e,n,t)})}function Kn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?R(t.f.Ja,t.f,t):null;t:for(var i=t.g,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].b,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=s))s=Math.max(0,i[u].b-100),a=!1;else try{Tn(h,o,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=o.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ge(R(t.Aa,t),er(t,t.o)),t.o++,!0)}function Jn(t){null!=t.s&&(I.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Ae(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);Je(e,"RID","rpc"),Je(e,"SID",t.J),Je(e,"CI",t.H?"0":"1"),Je(e,"AID",t.P),Wn(t,e),Je(e,"TYPE","xmlhttp"),t.i&&t.l&&Vn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe($e(e)),n.j=null,n.I=!0,De(n,t)}function Zn(t){null!=t.m&&(I.clearTimeout(t.m),t.m=null)}function tr(t,e){var n=null;if(t.a==e){Zn(t),Jn(t),t.a=null;var r=2}else{if(!wn(t.b,e))return;n=e.s,_n(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=P()-e.u;var i=t.u;Vt(r=ce(),new pe(r,n,e,i)),Hn(t)}else Yn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(yn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ge(R(t.Ba,t,e),er(t,t.u)),t.u++,0)))}(t,e)||2==r&&Xn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:nr(t,5);break;case 4:nr(t,10);break;case 3:nr(t,6);break;default:nr(t,2)}}function er(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function nr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=R(t.Ya,t);n||(n=new He("//www.google.com/images/cleardot.gif"),I.location&&"http"==I.location.protocol||We(n,"https"),Qe(n)),function(t,e){var n=new se;if(I.Image){var r=new Image;r.onload=D(Sn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=D(Sn,n,r,"TestLoadImage: error",!1,e),r.onabort=D(Sn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=D(Sn,n,r,"TestLoadImage: timeout",!1,e),I.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else de(2);t.v=0,t.f&&t.f.ra(e),rr(t),zn(t)}function rr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,V(t.g),t.g.length=0),t.f.qa())}function ir(t,e,n){var r=function(t){return t instanceof He?$e(t):new He(t,void 0)}(n);if(""!=r.c)e&&Ke(r,e+"."+r.c),Ye(r,r.h);else{var i=I.location;r=function(t,e,n,r){var i=new He(null,void 0);return t&&We(i,t),e&&Ke(i,e),n&&Ye(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&$(t.V,function(t,e){Je(r,e,t)}),e=t.A,n=t.na,e&&n&&Je(r,e,n),Je(r,"VER",t.ha),Wn(t,r),r}function sr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function or(){}function ar(){if(tt&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ut.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!F(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!F(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new lr(this)}function cr(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Te.call(this),this.status=1}function lr(t){this.a=t}(w=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?we(this.H):we(_e),this.a.onreadystatechange=R(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i=new qe(this.headers);r&&je(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Dn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=I.FormData&&t instanceof I.FormData,!(0<=x(Rn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=function(t){return tt&&lt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=R(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},w.xa=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},w.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),xn(this))},w.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),kn.X.G.call(this)},w.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Ua())},w.Ua=function(){Ln(this)},w.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},w.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},w.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},w.ua=function(){return this.h},w.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(w=jn.prototype).ha=8,w.v=1,w.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ae(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Y(r=W(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var s=this.g[i];if(void 0===(s="__data__"in s.a&&"string"==typeof(s=s.a.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),Je(i=$e(this.B),"RID",t),Je(i,"CVER",22),this.A&&Je(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&Vn(i,this.i,r),bn(this.b,n),this.Ia&&Je(i,"TYPE","init"),this.da?(Je(i,"$req",e),Je(i,"SID","null"),n.U=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||vn(this.b)||$n(this))},w.Aa=function(){if(this.j=null,Qn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ge(R(this.Ta,this),t)}},w.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Bn(this),Qn(this))},w.Sa=function(){null!=this.m&&(this.m=null,Bn(this),Xn(this),de(19))},w.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(w=or.prototype).ta=function(){},w.sa=function(){},w.ra=function(){},w.qa=function(){},w.Ja=function(){},ar.prototype.a=function(t,e){return new ur(t,e)},C(ur,Ut),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ir(t,null,t.fa),Hn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Gn(this.a,e)}else this.l?((e={}).__data__=jt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},C(cr,Ee),C(hr,Te),C(lr,or),lr.prototype.ta=function(){Vt(this.a,"a")},lr.prototype.sa=function(t){Vt(this.a,new cr(t))},lr.prototype.ra=function(t){Vt(this.a,new hr(t))},lr.prototype.qa=function(){Vt(this.a,"b")},ar.prototype.createWebChannel=ar.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,ve.COMPLETE="complete",be.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var fr=function(){return new ar},dr=function(){return ce()},pr=me,gr=ve,mr=ae,vr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},yr=be,wr=kn;class br{constructor(t){this.uid=t}t(){return null!=this.uid}i(){return this.t()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}br.UNAUTHENTICATED=new br(null),br.o=new br("google-credentials-uid"),br.u=new br("first-party-uid");const _r=new m("@firebase/firestore");function Ir(){return _r.logLevel}function Er(t,...e){if(_r.logLevel<=u.DEBUG){const n=e.map(Ar);_r.debug("Firestore (8.1.1): "+t,...n)}}function Tr(t,...e){if(_r.logLevel<=u.ERROR){const n=e.map(Ar);_r.error("Firestore (8.1.1): "+t,...n)}}function Sr(t,...e){if(_r.logLevel<=u.WARN){const n=e.map(Ar);_r.warn("Firestore (8.1.1): "+t,...n)}}function Ar(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function kr(t="Unexpected state"){const e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function Nr(t,e){t||kr()}function Or(t,e){return t}const Rr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Dr extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}class Pr{constructor(t,e){this.user=e,this.type="OAuth",this.h={},this.h.Authorization="Bearer "+t}}class Cr{constructor(){this.l=null}getToken(){return Promise.resolve(null)}_(){}T(t){this.l=t,t(br.UNAUTHENTICATED)}I(){this.l=null}}class Lr{constructor(t){this.m=null,this.currentUser=br.UNAUTHENTICATED,this.A=!1,this.R=0,this.l=null,this.forceRefresh=!1,this.m=(()=>{this.R++,this.currentUser=this.P(),this.A=!0,this.l&&this.l(this.currentUser)}),this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(t=>{this.auth=t,this.m&&this.auth.addAuthTokenListener(this.m)},()=>{}))}getToken(){const t=this.R,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.R!==t?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Nr("string"==typeof e.accessToken),new Pr(e.accessToken,this.currentUser)):null):Promise.resolve(null)}_(){this.forceRefresh=!0}T(t){this.l=t,this.A&&t(this.currentUser)}I(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.l=null}P(){const t=this.auth&&this.auth.getUid();return Nr(null===t||"string"==typeof t),new br(t)}}class xr{constructor(t,e){this.V=t,this.g=e,this.type="FirstParty",this.user=br.u}get h(){const t={"X-Goog-AuthUser":this.g},e=this.V.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t}}class Mr{constructor(t,e){this.V=t,this.g=e}getToken(){return Promise.resolve(new xr(this.V,this.g))}T(t){t(br.u)}I(){}_(){}}function Ur(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Vr{static p(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=Ur(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function Fr(t,e){return t<e?-1:t>e?1:0}function jr(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}function qr(t){return t+"\0"}class Br{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Dr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Dr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Dr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Dr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Br.fromMillis(Date.now())}static fromDate(t){return Br.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new Br(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}v(t){return this.seconds===t.seconds?Fr(this.nanoseconds,t.nanoseconds):Fr(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class zr{constructor(t){this.timestamp=t}static S(t){return new zr(t)}static min(){return new zr(new Br(0,0))}D(t){return this.timestamp.v(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}C(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}N(){return this.timestamp}}class Gr{constructor(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.M=n}get length(){return this.M}isEqual(t){return 0===Gr.k(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Gr?t.forEach(t=>{e.push(t)}):e.push(t),this.O(e)}limit(){return this.offset+this.length}F(t){return t=void 0===t?1:t,this.O(this.segments,this.offset+t,this.length-t)}$(){return this.O(this.segments,this.offset,this.length-1)}L(){return this.segments[this.offset]}B(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}q(){return 0===this.length}U(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}K(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}W(){return this.segments.slice(this.offset,this.limit())}static k(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Hr extends Gr{O(t,e,n){return new Hr(t,e,n)}j(){return this.W().join("/")}toString(){return this.j()}static G(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new Hr(e)}static H(){return new Hr([])}}const $r=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wr extends Gr{O(t,e,n){return new Wr(t,e,n)}static J(t){return $r.test(t)}j(){return this.W().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wr.J(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.j()}Y(){return 1===this.length&&"__name__"===this.get(0)}static X(){return new Wr(["__name__"])}static Z(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new Dr(Rr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Dr(Rr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new Dr(Rr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wr(e)}static H(){return new Wr([])}}class Kr{constructor(t){this.path=t}static tt(t){return new Kr(Hr.G(t))}static et(t){return new Kr(Hr.G(t).F(5))}nt(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===Hr.k(this.path,t.path)}toString(){return this.path.toString()}static k(t,e){return Hr.k(t.path,e.path)}static st(t){return t.length%2==0}static it(t){return new Kr(new Hr(t.slice()))}}class Yr{constructor(t,e,n,r,i,s){this.rt=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.ot=s}}class Xr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get ct(){return"(default)"===this.database}isEqual(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database}}function Jr(t){return null==t}function Qr(t){return 0===t&&1/t==-1/0}function Zr(t){return"number"==typeof t&&Number.isInteger(t)&&!Qr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}class ti{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ut=null}}function ei(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ti(t,e,n,r,i,s,o)}function ni(t){const e=Or(t);if(null===e.ut){let t=e.path.j();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>(function(t){return t.field.j()+t.op.toString()+Xi(t.value)})(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>(function(t){return t.field.j()+t.dir})(t)).join(","),Jr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ho(e.startAt)),e.endAt&&(t+="|ub:",t+=Ho(e.endAt)),e.ut=t}return e.ut}function ri(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Xo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!$i(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Wo(t.startAt,e.startAt)&&Wo(t.endAt,e.endAt)}function ii(t){return Kr.st(t.path)&&null===t.collectionGroup&&0===t.filters.length}class si{constructor(t){this.at=t}static fromBase64String(t){const e=atob(t);return new si(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new si(e)}toBase64(){return t=this.at,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)}ht(){return 2*this.at.length}D(t){return Fr(this.at,t.at)}isEqual(t){return this.at===t.at}}si.lt=new si("");class oi{constructor(t,e,n,r,i=zr.min(),s=zr.min(),o=si.lt){this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}dt(t){return new oi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)}wt(t,e){return new oi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}Et(t){return new oi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)}}class ai{constructor(t){this.count=t}}var ui,ci;function hi(t){switch(t){case Rr.OK:return kr();case Rr.CANCELLED:case Rr.UNKNOWN:case Rr.DEADLINE_EXCEEDED:case Rr.RESOURCE_EXHAUSTED:case Rr.INTERNAL:case Rr.UNAVAILABLE:case Rr.UNAUTHENTICATED:return!1;case Rr.INVALID_ARGUMENT:case Rr.NOT_FOUND:case Rr.ALREADY_EXISTS:case Rr.PERMISSION_DENIED:case Rr.FAILED_PRECONDITION:case Rr.ABORTED:case Rr.OUT_OF_RANGE:case Rr.UNIMPLEMENTED:case Rr.DATA_LOSS:return!0;default:return kr()}}function li(t){if(void 0===t)return Tr("GRPC error has no .code"),Rr.UNKNOWN;switch(t){case ui.OK:return Rr.OK;case ui.CANCELLED:return Rr.CANCELLED;case ui.UNKNOWN:return Rr.UNKNOWN;case ui.DEADLINE_EXCEEDED:return Rr.DEADLINE_EXCEEDED;case ui.RESOURCE_EXHAUSTED:return Rr.RESOURCE_EXHAUSTED;case ui.INTERNAL:return Rr.INTERNAL;case ui.UNAVAILABLE:return Rr.UNAVAILABLE;case ui.UNAUTHENTICATED:return Rr.UNAUTHENTICATED;case ui.INVALID_ARGUMENT:return Rr.INVALID_ARGUMENT;case ui.NOT_FOUND:return Rr.NOT_FOUND;case ui.ALREADY_EXISTS:return Rr.ALREADY_EXISTS;case ui.PERMISSION_DENIED:return Rr.PERMISSION_DENIED;case ui.FAILED_PRECONDITION:return Rr.FAILED_PRECONDITION;case ui.ABORTED:return Rr.ABORTED;case ui.OUT_OF_RANGE:return Rr.OUT_OF_RANGE;case ui.UNIMPLEMENTED:return Rr.UNIMPLEMENTED;case ui.DATA_LOSS:return Rr.DATA_LOSS;default:return kr()}}(ci=ui||(ui={}))[ci.OK=0]="OK",ci[ci.CANCELLED=1]="CANCELLED",ci[ci.UNKNOWN=2]="UNKNOWN",ci[ci.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ci[ci.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ci[ci.NOT_FOUND=5]="NOT_FOUND",ci[ci.ALREADY_EXISTS=6]="ALREADY_EXISTS",ci[ci.PERMISSION_DENIED=7]="PERMISSION_DENIED",ci[ci.UNAUTHENTICATED=16]="UNAUTHENTICATED",ci[ci.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ci[ci.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ci[ci.ABORTED=10]="ABORTED",ci[ci.OUT_OF_RANGE=11]="OUT_OF_RANGE",ci[ci.UNIMPLEMENTED=12]="UNIMPLEMENTED",ci[ci.INTERNAL=13]="INTERNAL",ci[ci.UNAVAILABLE=14]="UNAVAILABLE",ci[ci.DATA_LOSS=15]="DATA_LOSS";class fi{constructor(t,e){this.k=t,this.root=e||pi.EMPTY}Tt(t,e){return new fi(this.k,this.root.Tt(t,e,this.k).copy(null,null,pi.It,null,null))}remove(t){return new fi(this.k,this.root.remove(t,this.k).copy(null,null,pi.It,null,null))}get(t){let e=this.root;for(;!e.q();){const n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.q();){const r=this.k(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}q(){return this.root.q()}get size(){return this.root.size}At(){return this.root.At()}Rt(){return this.root.Rt()}Pt(t){return this.root.Pt(t)}forEach(t){this.Pt((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.Pt((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}Vt(t){return this.root.Vt(t)}gt(){return new di(this.root,null,this.k,!1)}yt(t){return new di(this.root,t,this.k,!1)}bt(){return new di(this.root,null,this.k,!0)}vt(t){return new di(this.root,t,this.k,!0)}}class di{constructor(t,e,n,r){this.St=r,this.Dt=[];let i=1;for(;!t.q();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}Ct(){let t=this.Dt.pop();const e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.q();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.q();)this.Dt.push(t),t=t.left;return e}Nt(){return this.Dt.length>0}xt(){if(0===this.Dt.length)return null;const t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}}}class pi{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:pi.RED,this.left=null!=r?r:pi.EMPTY,this.right=null!=i?i:pi.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}q(){return!1}Pt(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)}Vt(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)}min(){return this.left.q()?this:this.left.min()}At(){return this.min().key}Rt(){return this.right.q()?this.key:this.right.Rt()}Tt(t,e,n){let r=this;const i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Mt()}kt(){if(this.left.q())return pi.EMPTY;let t=this;return t.left.Ot()||t.left.left.Ot()||(t=t.Ft()),(t=t.copy(null,null,null,t.left.kt(),null)).Mt()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.q()||r.left.Ot()||r.left.left.Ot()||(r=r.Ft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Ot()&&(r=r.$t()),r.right.q()||r.right.Ot()||r.right.left.Ot()||(r=r.Lt()),0===e(t,r.key)){if(r.right.q())return pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.kt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Mt()}Ot(){return this.color}Mt(){let t=this;return t.right.Ot()&&!t.left.Ot()&&(t=t.Bt()),t.left.Ot()&&t.left.left.Ot()&&(t=t.$t()),t.left.Ot()&&t.right.Ot()&&(t=t.qt()),t}Ft(){let t=this.qt();return t.right.left.Ot()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t}Lt(){let t=this.qt();return t.left.left.Ot()&&(t=(t=t.$t()).qt()),t}Bt(){const t=this.copy(null,null,pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}$t(){const t=this.copy(null,null,pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}qt(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}Ut(){const t=this.Kt();return Math.pow(2,t)<=this.size+1}Kt(){if(this.Ot()&&this.left.Ot())throw kr();if(this.right.Ot())throw kr();const t=this.left.Kt();if(t!==this.right.Kt())throw kr();return t+(this.Ot()?0:1)}}pi.EMPTY=null,pi.RED=!0,pi.It=!1,pi.EMPTY=new class{constructor(){this.size=0}get key(){throw kr()}get value(){throw kr()}get color(){throw kr()}get left(){throw kr()}get right(){throw kr()}copy(t,e,n,r,i){return this}Tt(t,e,n){return new pi(t,e)}remove(t,e){return this}q(){return!0}Pt(t){return!1}Vt(t){return!1}At(){return null}Rt(){return null}Ot(){return!1}Ut(){return!0}Kt(){return 0}};class gi{constructor(t){this.k=t,this.data=new fi(this.k)}has(t){return null!==this.data.get(t)}first(){return this.data.At()}last(){return this.data.Rt()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.Pt((e,n)=>(t(e),!1))}Qt(t,e){const n=this.data.yt(t[0]);for(;n.Nt();){const r=n.Ct();if(this.k(r.key,t[1])>=0)return;e(r.key)}}Wt(t,e){let n;for(n=void 0!==e?this.data.yt(e):this.data.gt();n.Nt();)if(!t(n.Ct().key))return}jt(t){const e=this.data.yt(t);return e.Nt()?e.Ct().key:null}gt(){return new mi(this.data.gt())}yt(t){return new mi(this.data.yt(t))}add(t){return this.copy(this.data.remove(t).Tt(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}q(){return this.data.q()}Gt(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof gi))return!1;if(this.size!==t.size)return!1;const e=this.data.gt(),n=t.data.gt();for(;e.Nt();){const t=e.Ct().key,r=n.Ct().key;if(0!==this.k(t,r))return!1}return!0}W(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new gi(this.k);return e.data=t,e}}class mi{constructor(t){this.zt=t}Ct(){return this.zt.Ct().key}Nt(){return this.zt.Nt()}}const vi=new fi(Kr.k);function yi(){return vi}function wi(){return yi()}const bi=new fi(Kr.k);function _i(){return bi}const Ii=new fi(Kr.k),Ei=new gi(Kr.k);function Ti(...t){let e=Ei;for(const n of t)e=e.add(n);return e}const Si=new gi(Fr);function Ai(){return Si}class ki{constructor(t){this.k=t?(e,n)=>t(e,n)||Kr.k(e.key,n.key):(t,e)=>Kr.k(t.key,e.key),this.Ht=_i(),this.Jt=new fi(this.k)}static Yt(t){return new ki(t.k)}has(t){return null!=this.Ht.get(t)}get(t){return this.Ht.get(t)}first(){return this.Jt.At()}last(){return this.Jt.Rt()}q(){return this.Jt.q()}indexOf(t){const e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1}get size(){return this.Jt.size}forEach(t){this.Jt.Pt((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this}isEqual(t){if(!(t instanceof ki))return!1;if(this.size!==t.size)return!1;const e=this.Jt.gt(),n=t.Jt.gt();for(;e.Nt();){const t=e.Ct().key,r=n.Ct().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new ki;return n.k=this.k,n.Ht=t,n.Jt=e,n}}class Ni{constructor(){this.Xt=new fi(Kr.k)}track(t){const e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):kr():this.Xt=this.Xt.Tt(e,t)}Zt(){const t=[];return this.Xt.Pt((e,n)=>{t.push(n)}),t}}class Oi{constructor(t,e,n,r,i,s,o,a){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=s,this.ne=o,this.se=a}static ie(t,e,n,r){const i=[];return e.forEach(t=>{i.push({type:0,doc:t})}),new Oi(t,e,ki.Yt(e),i,n,r,!0,!1)}get hasPendingWrites(){return!this.ee.q()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Ro(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Ri{constructor(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}static ae(t,e){const n=new Map;return n.set(t,Di.he(t,e)),new Ri(zr.min(),n,Ai(),yi(),Ti())}}class Di{constructor(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}static he(t,e){return new Di(si.lt,e,Ti(),Ti(),Ti())}}class Pi{constructor(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r}}class Ci{constructor(t,e){this.targetId=t,this.Te=e}}class Li{constructor(t,e,n=si.lt,r=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class xi{constructor(){this.Ie=0,this.me=Vi(),this.Ae=si.lt,this.Re=!1,this.Pe=!0}get le(){return this.Re}get resumeToken(){return this.Ae}get Ve(){return 0!==this.Ie}get ge(){return this.Pe}ye(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)}pe(){let t=Ti(),e=Ti(),n=Ti();return this.me.forEach((r,i)=>{switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:kr()}}),new Di(this.Ae,this.Re,t,e,n)}be(){this.Pe=!1,this.me=Vi()}ve(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)}Se(t){this.Pe=!0,this.me=this.me.remove(t)}De(){this.Ie+=1}Ce(){this.Ie-=1}Ne(){this.Pe=!0,this.Re=!0}}class Mi{constructor(t){this.xe=t,this.Me=new Map,this.ke=yi(),this.Oe=Ui(),this.Fe=new gi(Fr)}$e(t){for(const e of t.we)t.Ee instanceof mo?this.Le(e,t.Ee):t.Ee instanceof vo&&this.Be(e,t.key,t.Ee);for(const e of t.removedTargetIds)this.Be(e,t.key,t.Ee)}qe(t){this.Ue(t,e=>{const n=this.Ke(e);switch(t.state){case 0:this.Qe(e)&&n.ye(t.resumeToken);break;case 1:n.Ce(),n.Ve||n.be(),n.ye(t.resumeToken);break;case 2:n.Ce(),n.Ve||this.removeTarget(e);break;case 3:this.Qe(e)&&(n.Ne(),n.ye(t.resumeToken));break;case 4:this.Qe(e)&&(this.We(e),n.ye(t.resumeToken));break;default:kr()}})}Ue(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Me.forEach((t,n)=>{this.Qe(n)&&e(n)})}je(t){const e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){const t=r.target;if(ii(t))if(0===n){const n=new Kr(t.path);this.Be(e,n,new vo(n,zr.min()))}else Nr(1===n);else this.ze(e)!==n&&(this.We(e),this.Fe=this.Fe.add(e))}}He(t){const e=new Map;this.Me.forEach((n,r)=>{const i=this.Ge(r);if(i){if(n.le&&ii(i.target)){const e=new Kr(i.target.path);null!==this.ke.get(e)||this.Je(r,e)||this.Be(r,e,new vo(e,t))}n.ge&&(e.set(r,n.pe()),n.be())}});let n=Ti();this.Oe.forEach((t,e)=>{let r=!0;e.Wt(t=>{const e=this.Ge(t);return!e||2===e._t||(r=!1,!1)}),r&&(n=n.add(t))});const r=new Ri(t,e,this.Fe,this.ke,n);return this.ke=yi(),this.Oe=Ui(),this.Fe=new gi(Fr),r}Le(t,e){if(!this.Qe(t))return;const n=this.Je(t,e.key)?2:0;this.Ke(t).ve(e.key,n),this.ke=this.ke.Tt(e.key,e),this.Oe=this.Oe.Tt(e.key,this.Ye(e.key).add(t))}Be(t,e,n){if(!this.Qe(t))return;const r=this.Ke(t);this.Je(t,e)?r.ve(e,1):r.Se(e),this.Oe=this.Oe.Tt(e,this.Ye(e).delete(t)),n&&(this.ke=this.ke.Tt(e,n))}removeTarget(t){this.Me.delete(t)}ze(t){const e=this.Ke(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size}De(t){this.Ke(t).De()}Ke(t){let e=this.Me.get(t);return e||(e=new xi,this.Me.set(t,e)),e}Ye(t){let e=this.Oe.get(t);return e||(e=new gi(Fr),this.Oe=this.Oe.Tt(t,e)),e}Qe(t){const e=null!==this.Ge(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e}Ge(t){const e=this.Me.get(t);return e&&e.Ve?null:this.xe.Ze(t)}We(t){this.Me.set(t,new xi),this.xe.Xe(t).forEach(e=>{this.Be(t,e,null)})}Je(t,e){return this.xe.Xe(t).has(e)}}function Ui(){return new fi(Kr.k)}function Vi(){return new fi(Kr.k)}function Fi(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ji(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qi(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Bi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zi(t){const e=Ji(t.mapValue.fields.__local_write_time__.timestampValue);return new Br(e.seconds,e.nanos)}const Gi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bi(t)?4:10:kr()}function $i(t,e){const n=Hi(t);if(n!==Hi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zi(t).isEqual(zi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Ji(t.timestampValue),r=Ji(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Zi(t.bytesValue).isEqual(Zi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Qi(t.geoPointValue.latitude)===Qi(e.geoPointValue.latitude)&&Qi(t.geoPointValue.longitude)===Qi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Qi(t.integerValue)===Qi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Qi(t.doubleValue),r=Qi(e.doubleValue);return n===r?Qr(n)===Qr(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return jr(t.arrayValue.values||[],e.arrayValue.values||[],$i);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Fi(n)!==Fi(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!$i(n[t],r[t])))return!1;return!0}(t,e);default:return kr()}}function Wi(t,e){return void 0!==(t.values||[]).find(t=>$i(t,e))}function Ki(t,e){const n=Hi(t),r=Hi(e);if(n!==r)return Fr(n,r);switch(n){case 0:return 0;case 1:return Fr(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Qi(t.integerValue||t.doubleValue),r=Qi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Yi(t.timestampValue,e.timestampValue);case 4:return Yi(zi(t),zi(e));case 5:return Fr(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Zi(t),r=Zi(e);return n.D(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=Fr(n[t],r[t]);if(0!==e)return e}return Fr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Fr(Qi(t.latitude),Qi(e.latitude));return 0!==n?n:Fr(Qi(t.longitude),Qi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=Ki(n[t],r[t]);if(e)return e}return Fr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=Fr(r[t],s[t]);if(0!==e)return e;const o=Ki(n[r[t]],i[s[t]]);if(0!==o)return o}return Fr(r.length,s.length)}(t.mapValue,e.mapValue);default:throw kr()}}function Yi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Fr(t,e);const n=Ji(t),r=Ji(e),i=Fr(n.seconds,r.seconds);return 0!==i?i:Fr(n.nanos,r.nanos)}function Xi(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){const e=Ji(t);return`time(${e.seconds},${e.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Zi(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,Kr.et(r).toString()):"geoPointValue"in e?`geo(${(n=e.geoPointValue).latitude},${n.longitude})`:"arrayValue"in e?function(e){let n="[",r=!0;for(const i of e.values||[])r?r=!1:n+=",",n+=t(i);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){const n=Object.keys(e.fields||{}).sort();let r="{",i=!0;for(const s of n)i?i=!1:r+=",",r+=`${s}:${t(e.fields[s])}`;return r+"}"}(e.mapValue):kr();var n,r}(t)}function Ji(t){if(Nr(!!t),"string"==typeof t){let e=0;const n=Gi.exec(t);if(Nr(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qi(t.seconds),nanos:Qi(t.nanos)}}function Qi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Zi(t){return"string"==typeof t?si.fromBase64String(t):si.fromUint8Array(t)}function ts(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.j()}`}}function es(t){return!!t&&"integerValue"in t}function ns(t){return!!t&&"arrayValue"in t}function rs(t){return!!t&&"nullValue"in t}function is(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ss(t){return!!t&&"mapValue"in t}const os={asc:"ASCENDING",desc:"DESCENDING"},as={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class us{constructor(t,e){this.rt=t,this.tn=e}}function cs(t){return{integerValue:""+t}}function hs(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qr(e)?"-0":e}}function ls(t,e){return Zr(e)?cs(e):hs(t,e)}function fs(t,e){return t.tn?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ds(t,e){return t.tn?e.toBase64():e.toUint8Array()}function ps(t){return Nr(!!t),zr.S(function(t){const e=Ji(t);return new Br(e.seconds,e.nanos)}(t))}function gs(t,e){return function(t){return new Hr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).j()}function ms(t){const e=Hr.G(t);return Nr(Cs(e)),e}function vs(t,e){return gs(t.rt,e.path)}function ys(t,e){const n=ms(e);if(n.get(1)!==t.rt.projectId)throw new Dr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.rt.projectId);if(n.get(3)!==t.rt.database)throw new Dr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.rt.database);return new Kr(Is(n))}function ws(t,e){return gs(t.rt,e)}function bs(t){const e=ms(t);return 4===e.length?Hr.H():Is(e)}function _s(t){return new Hr(["projects",t.rt.projectId,"databases",t.rt.database]).j()}function Is(t){return Nr(t.length>4&&"documents"===t.get(4)),t.F(5)}function Es(t,e,n){return{name:vs(t,e),fields:n.proto.mapValue.fields}}function Ts(t,e){let n;if(e instanceof ro)n={update:Es(t,e.key,e.value)};else if(e instanceof co)n={delete:vs(t,e.key)};else if(e instanceof io)n={update:Es(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.j())),{fieldPaths:e}}(e.en)};else if(e instanceof oo)n={transform:{document:vs(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof Vs)return{fieldPath:e.field.j(),setToServerValue:"REQUEST_TIME"};if(n instanceof Fs)return{fieldPath:e.field.j(),appendMissingElements:{values:n.elements}};if(n instanceof qs)return{fieldPath:e.field.j(),removeAllFromArray:{values:n.elements}};if(n instanceof zs)return{fieldPath:e.field.j(),increment:n.nn};throw kr()})(0,t))}};else{if(!(e instanceof ho))return kr();n={verify:vs(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return fs(t,e.N())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:kr()}(t,e.rn)),n}function Ss(t,e){const n=e.currentDocument?function(t){return void 0!==t.updateTime?Ys.updateTime(ps(t.updateTime)):void 0!==t.exists?Ys.exists(t.exists):Ys.on()}(e.currentDocument):Ys.on();if(e.update){e.update.name;const r=ys(t,e.update.name),i=new lo({mapValue:{fields:e.update.fields}});if(e.updateMask){const t=function(t){const e=t.fieldPaths||[];return new $s(e.map(t=>Wr.Z(t)))}(e.updateMask);return new io(r,i,t,n)}return new ro(r,i,n)}if(e.delete){const r=ys(t,e.delete);return new co(r,n)}if(e.transform){const r=ys(t,e.transform.document),i=e.transform.fieldTransforms.map(e=>(function(t,e){let n=null;if("setToServerValue"in e)Nr("REQUEST_TIME"===e.setToServerValue),n=new Vs;else if("appendMissingElements"in e){const t=e.appendMissingElements.values||[];n=new Fs(t)}else if("removeAllFromArray"in e){const t=e.removeAllFromArray.values||[];n=new qs(t)}else"increment"in e?n=new zs(t,e.increment):kr();const r=Wr.Z(e.fieldPath);return new Ws(r,n)})(t,e));return Nr(!0===n.exists),new oo(r,i)}if(e.verify){const r=ys(t,e.verify);return new ho(r,n)}return kr()}function As(t,e){return{documents:[ws(t,e.path)]}}function ks(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ws(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ws(t,r.$()),n.structuredQuery.from=[{collectionId:r.B()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(is(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NAN"}};if(rs(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(is(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NOT_NAN"}};if(rs(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ds(t.field),op:function(t){return as[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:Ds(t.field),direction:function(t){return os[t]}(t.dir)}})(t))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.tn||Jr(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Os(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Os(e.endAt)),n}function Ns(t){let e=bs(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Nr(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ps(t.unaryFilter.field);return xo.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ps(t.unaryFilter.field);return xo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ps(t.unaryFilter.field);return xo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ps(t.unaryFilter.field);return xo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[function(t){return xo.create(Ps(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(t.fieldFilter.op),t.fieldFilter.value)}(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>t(e)).reduce((t,e)=>t.concat(e)):kr():[]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(t=>(function(t){return new Ko(Ps(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))})(t)));let a=null;n.limit&&(a=function(t){let e;return Jr(e="object"==typeof t?t.value:t)?null:e}(n.limit));let u=null;n.startAt&&(u=Rs(n.startAt));let c=null;return n.endAt&&(c=Rs(n.endAt)),bo(e,i,o,s,a,"F",u,c)}function Os(t){return{before:t.before,values:t.position}}function Rs(t){const e=!!t.before,n=t.values||[];return new Go(n,e)}function Ds(t){return{fieldPath:t.j()}}function Ps(t){return Wr.Z(t.fieldPath)}function Cs(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Ls{constructor(){this.cn=void 0}}function xs(t,e,n){return t instanceof Vs?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Fs?js(t,e):t instanceof qs?Bs(t,e):function(t,e){const n=Us(t,e),r=Gs(n)+Gs(t.nn);return es(n)&&es(t.nn)?cs(r):hs(t.serializer,r)}(t,e)}function Ms(t,e,n){return t instanceof Fs?js(t,e):t instanceof qs?Bs(t,e):n}function Us(t,e){return t instanceof zs?es(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}class Vs extends Ls{}class Fs extends Ls{constructor(t){super(),this.elements=t}}function js(t,e){const n=Hs(e);for(const e of t.elements)n.some(t=>$i(t,e))||n.push(e);return{arrayValue:{values:n}}}class qs extends Ls{constructor(t){super(),this.elements=t}}function Bs(t,e){let n=Hs(e);for(const e of t.elements)n=n.filter(t=>!$i(t,e));return{arrayValue:{values:n}}}class zs extends Ls{constructor(t,e){super(),this.serializer=t,this.nn=e}}function Gs(t){return Qi(t.integerValue||t.doubleValue)}function Hs(t){return ns(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class $s{constructor(t){this.fields=t,t.sort(Wr.k)}un(t){for(const e of this.fields)if(e.U(t))return!0;return!1}isEqual(t){return jr(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class Ws{constructor(t,e){this.field=t,this.transform=e}}class Ks{constructor(t,e){this.version=t,this.transformResults=e}}class Ys{constructor(t,e){this.updateTime=t,this.exists=e}static on(){return new Ys}static exists(t){return new Ys(void 0,t)}static updateTime(t){return new Ys(t)}get sn(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Xs(t,e){return void 0!==t.updateTime?e instanceof mo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof mo}class Js{}function Qs(t,e,n){return t instanceof ro?function(t,e,n){return new mo(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof io?function(t,e,n){if(!Xs(t.rn,e))return new yo(t.key,n.version);const r=so(t,e);return new mo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof oo?function(t,e,n){if(Nr(null!=n.transformResults),!Xs(t.rn,e))return new yo(t.key,n.version);const r=ao(t,e),i=function(t,e,n){const r=[];Nr(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform;let a=null;e instanceof mo&&(a=e.field(s.field)),r.push(Ms(o,a,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),s=n.version,o=uo(t,r.data(),i);return new mo(t.key,s,o,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new vo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Zs(t,e,n,r){return t instanceof ro?function(t,e){if(!Xs(t.rn,e))return e;const n=no(e);return new mo(t.key,n,t.value,{an:!0})}(t,e):t instanceof io?function(t,e){if(!Xs(t.rn,e))return e;const n=no(e),r=so(t,e);return new mo(t.key,n,r,{an:!0})}(t,e):t instanceof oo?function(t,e,n,r){if(!Xs(t.rn,e))return e;const i=ao(t,e),s=function(t,e,n,r){const i=[];for(const s of t){const t=s.transform;let o=null;n instanceof mo&&(o=n.field(s.field)),null===o&&r instanceof mo&&(o=r.field(s.field)),i.push(xs(t,o,e))}return i}(t.fieldTransforms,n,e,r),o=uo(t,i.data(),s);return new mo(t.key,i.version,o,{an:!0})}(t,e,r,n):function(t,e){return Xs(t.rn,e)?new vo(t.key,zr.min()):e}(t,e)}function to(t,e){return t instanceof oo?function(t,e){let n=null;for(const r of t.fieldTransforms){const t=e instanceof mo?e.field(r.field):void 0,i=Us(r.transform,t||null);null!=i&&(n=null==n?(new fo).set(r.field,i):n.set(r.field,i))}return n?n.hn():null}(t,e):null}function eo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||jr(t.fieldTransforms,t.fieldTransforms,(t,e)=>(function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Fs&&e instanceof Fs||t instanceof qs&&e instanceof qs?jr(t.elements,e.elements,$i):t instanceof zs&&e instanceof zs?$i(t.nn,e.nn):t instanceof Vs&&e instanceof Vs}(t.transform,e.transform)})(t,e)))}function no(t){return t instanceof mo?t.version:zr.min()}class ro extends Js{constructor(t,e,n){super(),this.key=t,this.value=e,this.rn=n,this.type=0}}class io extends Js{constructor(t,e,n,r){super(),this.key=t,this.data=e,this.en=n,this.rn=r,this.type=1}}function so(t,e){let n;return function(t,e){const n=new fo(e);return t.en.fields.forEach(e=>{if(!e.q()){const r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,n=e instanceof mo?e.data():lo.empty())}class oo extends Js{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.rn=Ys.exists(!0)}}function ao(t,e){return e}function uo(t,e,n){const r=new fo(e);for(let e=0;e<t.fieldTransforms.length;e++){const i=t.fieldTransforms[e];r.set(i.field,n[e])}return r.hn()}class co extends Js{constructor(t,e){super(),this.key=t,this.rn=e,this.type=3}}class ho extends Js{constructor(t,e){super(),this.key=t,this.rn=e,this.type=4}}class lo{constructor(t){this.proto=t}static empty(){return new lo({mapValue:{}})}field(t){if(t.q())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ss(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.B()])||null}}isEqual(t){return $i(this.proto,t.proto)}}class fo{constructor(t=lo.empty()){this.ln=t,this._n=new Map}set(t,e){return this.fn(t,e),this}delete(t){return this.fn(t,null),this}fn(t,e){let n=this._n;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===Hi(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.B(),e)}hn(){const t=this.dn(Wr.H(),this._n);return null!=t?new lo(t):this.ln}dn(t,e){let n=!1;const r=this.ln.field(t),i=ss(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const s=this.dn(t.child(r),e);null!=s&&(i[r]=s,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}function po(t){const e=[];return ji(t.fields||{},(t,n)=>{const r=new Wr([t]);if(ss(n)){const t=po(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)}),new $s(e)}class go{constructor(t,e){this.key=t,this.version=e}}class mo extends go{constructor(t,e,n,r){super(t,e),this.wn=n,this.an=!!r.an,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.wn.field(t)}data(){return this.wn}En(){return this.wn.proto}isEqual(t){return t instanceof mo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)}toString(){return`Document(${this.key}, ${this.version}, ${this.wn.toString()}, {hasLocalMutations: ${this.an}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.an||this.hasCommittedMutations}}class vo extends go{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof vo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class yo extends go{toString(){return`UnknownDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return!0}isEqual(t){return t instanceof yo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class wo{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.In=null,this.mn=null,this.startAt,this.endAt}}function bo(t,e,n,r,i,s,o,a){return new wo(t,e,n,r,i,s,o,a)}function _o(t){return new wo(t)}function Io(t){return!Jr(t.limit)&&"F"===t.limitType}function Eo(t){return!Jr(t.limit)&&"L"===t.limitType}function To(t){return t.Tn.length>0?t.Tn[0].field:null}function So(t){for(const e of t.filters)if(e.An())return e.field;return null}function Ao(t){return null!==t.collectionGroup}function ko(t){const e=Or(t);if(null===e.In){e.In=[];const t=So(e),n=To(e);if(null!==t&&null===n)t.Y()||e.In.push(new Ko(t)),e.In.push(new Ko(Wr.X(),"asc"));else{let t=!1;for(const n of e.Tn)e.In.push(n),n.field.Y()&&(t=!0);if(!t){const t=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new Ko(Wr.X(),t))}}}return e.In}function No(t){const e=Or(t);if(!e.mn)if("F"===e.limitType)e.mn=ei(e.path,e.collectionGroup,ko(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of ko(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Ko(n.field,e))}const n=e.endAt?new Go(e.endAt.position,!e.endAt.before):null,r=e.startAt?new Go(e.startAt.position,!e.startAt.before):null;e.mn=ei(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.mn}function Oo(t,e,n){return new wo(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ro(t,e){return ri(No(t),No(e))&&t.limitType===e.limitType}function Do(t){return`${ni(No(t))}|lt:${t.limitType}`}function Po(t){return`Query(target=${function(t){let e=t.path.j();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>{return`${(e=t).field.j()} ${e.op} ${Xi(e.value)}`;var e}).join(", ")}]`),Jr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>(function(t){return`${t.field.j()} (${t.dir})`})(t)).join(", ")}]`),t.startAt&&(e+=", startAt: "+Ho(t.startAt)),t.endAt&&(e+=", endAt: "+Ho(t.endAt)),`Target(${e})`}(No(t))}; limitType=${t.limitType})`}function Co(t,e){return function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.nt(t.collectionGroup)&&t.path.U(n):Kr.st(t.path)?t.path.isEqual(n):t.path.K(n)}(t,e)&&function(t,e){for(const n of t.Tn)if(!n.field.Y()&&null===e.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!$o(t.startAt,ko(t),e))&&(!t.endAt||!$o(t.endAt,ko(t),e))}(t,e)}function Lo(t){return(e,n)=>{let r=!1;for(const i of ko(t)){const t=Yo(i,e,n);if(0!==t)return t;r=r||i.field.Y()}return 0}}class xo extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.Y()?"in"===e||"not-in"===e?this.Rn(t,e,n):new Mo(t,e,n):"array-contains"===e?new jo(t,n):"in"===e?new qo(t,n):"not-in"===e?new Bo(t,n):"array-contains-any"===e?new zo(t,n):new xo(t,e,n)}static Rn(t,e,n){return"in"===e?new Uo(t,n):new Vo(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(Ki(e,this.value)):null!==e&&Hi(this.value)===Hi(e)&&this.Pn(Ki(e,this.value))}Pn(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return kr()}}An(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Mo extends xo{constructor(t,e,n){super(t,e,n),this.key=Kr.et(n.referenceValue)}matches(t){const e=Kr.k(t.key,this.key);return this.Pn(e)}}class Uo extends xo{constructor(t,e){super(t,"in",e),this.keys=Fo("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Vo extends xo{constructor(t,e){super(t,"not-in",e),this.keys=Fo("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Fo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>Kr.et(t.referenceValue))}class jo extends xo{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return ns(e)&&Wi(e.arrayValue,this.value)}}class qo extends xo{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&Wi(this.value.arrayValue,e)}}class Bo extends xo{constructor(t,e){super(t,"not-in",e)}matches(t){if(Wi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!Wi(this.value.arrayValue,e)}}class zo extends xo{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!ns(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Wi(this.value.arrayValue,t))}}class Go{constructor(t,e){this.position=t,this.before=e}}function Ho(t){return`${t.before?"b":"a"}:${t.position.map(t=>Xi(t)).join(",")}`}function $o(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.Y()?Kr.k(Kr.et(o.referenceValue),n.key):Ki(o,n.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Wo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$i(t.position[n],e.position[n]))return!1;return!0}class Ko{constructor(t,e="asc"){this.field=t,this.dir=e}}function Yo(t,e,n){const r=t.field.Y()?Kr.k(e.key,n.key):function(t,e,n){const r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ki(r,i):kr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return kr()}}function Xo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Jo{constructor(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}gn(t,e,n){const r=n.yn;for(let n=0;n<this.mutations.length;n++){const i=this.mutations[n];i.key.isEqual(t)&&(e=Qs(i,e,r[n]))}return e}pn(t,e){for(const n of this.baseMutations)n.key.isEqual(t)&&(e=Zs(n,e,e,this.Vn));const n=e;for(const r of this.mutations)r.key.isEqual(t)&&(e=Zs(r,e,n,this.Vn));return e}bn(t){let e=t;return this.mutations.forEach(n=>{const r=this.pn(n.key,t.get(n.key));r&&(e=e.Tt(n.key,r))}),e}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Ti())}isEqual(t){return this.batchId===t.batchId&&jr(this.mutations,t.mutations,(t,e)=>eo(t,e))&&jr(this.baseMutations,t.baseMutations,(t,e)=>eo(t,e))}}class Qo{constructor(t,e,n,r){this.batch=t,this.vn=e,this.yn=n,this.Sn=r}static from(t,e,n){Nr(t.mutations.length===n.length);let r=Ii;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.Tt(i[t].key,n[t].version);return new Qo(t,e,n,r)}}class Zo{constructor(t,e){this.Dn=t,this.Cn=e,this.Nn={}}get(t){const e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(const[e,r]of n)if(this.Cn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.Cn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]}delete(t){const e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1}forEach(t){ji(this.Nn,(e,n)=>{for(const[e,r]of n)t(e,r)})}q(){return qi(this.Nn)}}class ta{constructor(t){this.xn=null,this.Mn=null,this.result=void 0,this.error=void 0,this.kn=!1,this.On=!1,t(t=>{this.kn=!0,this.result=t,this.xn&&this.xn(t)},t=>{this.kn=!0,this.error=t,this.Mn&&this.Mn(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.On&&kr(),this.On=!0,this.kn?this.error?this.Fn(e,this.error):this.$n(t,this.result):new ta((n,r)=>{this.xn=(e=>{this.$n(t,e).next(n,r)}),this.Mn=(t=>{this.Fn(e,t).next(n,r)})})}Ln(){return new Promise((t,e)=>{this.next(t,e)})}Bn(t){try{const e=t();return e instanceof ta?e:ta.resolve(e)}catch(t){return ta.reject(t)}}$n(t,e){return t?this.Bn(()=>t(e)):ta.resolve(e)}Fn(t,e){return t?this.Bn(()=>t(e)):ta.reject(e)}static resolve(t){return new ta((e,n)=>{e(t)})}static reject(t){return new ta((e,n)=>{n(t)})}static qn(t){return new ta((e,n)=>{let r=0,i=0,s=!1;t.forEach(t=>{++r,t.next(()=>{++i,s&&i===r&&e()},t=>n(t))}),s=!0,i===r&&e()})}static Un(t){let e=ta.resolve(!1);for(const n of t)e=e.next(t=>t?ta.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.qn(n)}}class ea{constructor(){this.Kn=new Zo(t=>t.toString(),(t,e)=>t.isEqual(e)),this.Qn=!1}Wn(t){const e=this.Kn.get(t);return e?e.readTime:zr.min()}jn(t,e){this.Gn(),this.Kn.set(t.key,{zn:t,readTime:e})}Hn(t,e=null){this.Gn(),this.Kn.set(t,{zn:null,readTime:e})}Jn(t,e){this.Gn();const n=this.Kn.get(e);return void 0!==n?ta.resolve(n.zn):this.Yn(t,e)}getEntries(t,e){return this.Xn(t,e)}apply(t){return this.Gn(),this.Qn=!0,this.Zn(t)}Gn(){}}class na{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}function ra(t){return new us(t,!0)}function ia(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}const sa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oa{constructor(){this.ts=[]}es(t){this.ts.push(t)}ns(){this.ts.forEach(t=>t())}}class aa{constructor(t,e,n){this.ss=t,this.rs=e,this.os=n}cs(t,e){return this.rs.us(t,e).next(n=>this.hs(t,e,n))}hs(t,e,n){return this.ss.Jn(t,e).next(t=>{for(const r of n)t=r.pn(e,t);return t})}ls(t,e,n){let r=wi();return e.forEach((t,e)=>{for(const r of n)e=r.pn(t,e);r=r.Tt(t,e)}),r}_s(t,e){return this.ss.getEntries(t,e).next(e=>this.fs(t,e))}fs(t,e){return this.rs.ds(t,e).next(n=>{const r=this.ls(t,e,n);let i=yi();return r.forEach((t,e)=>{e||(e=new vo(t,zr.min())),i=i.Tt(t,e)}),i})}ws(t,e,n){return function(t){return Kr.st(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Ao(e)?this.Ts(t,e,n):this.Is(t,e,n)}Es(t,e){return this.cs(t,new Kr(e)).next(t=>{let e=_i();return t instanceof mo&&(e=e.Tt(t.key,t)),e})}Ts(t,e,n){const r=e.collectionGroup;let i=_i();return this.os.As(t,r).next(s=>ta.forEach(s,s=>{const o=function(t,e){return new wo(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(r));return this.Is(t,o,n).next(t=>{t.forEach((t,e)=>{i=i.Tt(t,e)})})}).next(()=>i))}Is(t,e,n){let r,i;return this.ss.ws(t,e,n).next(n=>(r=n,this.rs.Rs(t,e))).next(e=>(i=e,this.Ps(t,i,r).next(t=>{r=t;for(const t of i)for(const e of t.mutations){const n=e.key,i=r.get(n),s=Zs(e,i,i,t.Vn);r=s instanceof mo?r.Tt(n,s):r.remove(n)}}))).next(()=>(r.forEach((t,n)=>{Co(e,n)||(r=r.remove(t))}),r))}Ps(t,e,n){let r=Ti();for(const t of e)for(const e of t.mutations)e instanceof io&&null===n.get(e.key)&&(r=r.add(e.key));let i=n;return this.ss.getEntries(t,r).next(t=>(t.forEach((t,e)=>{null!==e&&e instanceof mo&&(i=i.Tt(t,e))}),i))}}class ua{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.gs=r}static ys(t,e){let n=Ti(),r=Ti();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new ua(t,e.fromCache,n,r)}}class ca{constructor(t,e){this.previousValue=t,e&&(e.ps=(t=>this.bs(t)),this.vs=(t=>e.Ss(t)))}bs(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.vs&&this.vs(t),t}}ca.Ds=-1;class ha{constructor(t,e,n=1e3,r=1.5,i=6e4){this.Cs=t,this.Ns=e,this.xs=n,this.Ms=r,this.ks=i,this.Os=0,this.Fs=null,this.$s=Date.now(),this.reset()}reset(){this.Os=0}Ls(){this.Os=this.ks}Bs(t){this.cancel();const e=Math.floor(this.Os+this.qs()),n=Math.max(0,Date.now()-this.$s),r=Math.max(0,e-n);r>0&&Er("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Os} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Fs=this.Cs.Us(this.Ns,r,()=>(this.$s=Date.now(),t())),this.Os*=this.Ms,this.Os<this.xs&&(this.Os=this.xs),this.Os>this.ks&&(this.Os=this.ks)}Ks(){null!==this.Fs&&(this.Fs.Qs(),this.Fs=null)}cancel(){null!==this.Fs&&(this.Fs.cancel(),this.Fs=null)}qs(){return(Math.random()-.5)*this.Os}}class la{constructor(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===la.js(r())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Er("SimpleDb","Removing database:",t),va(window.indexedDB.deleteDatabase(t)).Ln()}static Gs(){if("undefined"==typeof indexedDB)return!1;if(la.zs())return!0;const t=r(),e=la.js(t),n=0<e&&e<10,i=la.Hs(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||s)}static zs(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)}static Ys(t,e){return t.store(e)}static js(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static Hs(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Xs(t){return this.db||(Er("SimpleDb","Opening database:",this.name),this.db=await new Promise((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=(t=>{const n=t.target.result;e(n)}),r.onblocked=(()=>{n(new da(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))}),r.onerror=(e=>{const r=e.target.error;"VersionError"===r.name?n(new Dr(Rr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new da(t,r))}),r.onupgradeneeded=(t=>{Er("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,this.version).next(()=>{Er("SimpleDb","Database upgrade to version "+this.version+" complete")})})})),this.Zs&&(this.db.onversionchange=(t=>this.Zs(t))),this.db}ti(t){this.Zs=t,this.db&&(this.db.onversionchange=(e=>t(e)))}async runTransaction(t,e,n,r){const i="readonly"===e;for(;;){0;try{this.db=await this.Xs(t);const e=ga.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).catch(t=>(e.abort(t),ta.reject(t))).Ln();return s.catch(()=>{}),await e.ei,s}catch(t){const e="FirebaseError"!==t.name&&s<3;if(Er("SimpleDb","Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class fa{constructor(t){this.ni=t,this.si=!1,this.ii=null}get kn(){return this.si}get ri(){return this.ii}set cursor(t){this.ni=t}done(){this.si=!0}oi(t){this.ii=t}delete(){return va(this.ni.delete())}}class da extends Dr{constructor(t,e){super(Rr.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function pa(t){return"IndexedDbTransactionError"===t.name}class ga{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.ci=new na,this.transaction.oncomplete=(()=>{this.ci.resolve()}),this.transaction.onabort=(()=>{e.error?this.ci.reject(new da(t,e.error)):this.ci.resolve()}),this.transaction.onerror=(e=>{const n=wa(e.target.error);this.ci.reject(new da(t,n))})}static open(t,e,n,r){try{return new ga(e,t.transaction(r,n))}catch(t){throw new da(e,t)}}get ei(){return this.ci.promise}abort(t){t&&this.ci.reject(t),this.aborted||(Er("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(t){const e=this.transaction.objectStore(t);return new ma(e)}}class ma{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Er("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Er("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),va(n)}add(t){return Er("SimpleDb","ADD",this.store.name,t,t),va(this.store.add(t))}get(t){return va(this.store.get(t)).next(e=>(void 0===e&&(e=null),Er("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return Er("SimpleDb","DELETE",this.store.name,t),va(this.store.delete(t))}count(){return Er("SimpleDb","COUNT",this.store.name),va(this.store.count())}ui(t,e){const n=this.cursor(this.options(t,e)),r=[];return this.ai(n,(t,e)=>{r.push(e)}).next(()=>r)}hi(t,e){Er("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.li=!1;const r=this.cursor(n);return this.ai(r,(t,e,n)=>n.delete())}_i(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.ai(r,e)}fi(t){const e=this.cursor({});return new ta((n,r)=>{e.onerror=(t=>{const e=wa(t.target.error);r(e)}),e.onsuccess=(e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next(t=>{t?r.continue():n()}):n()})})}ai(t,e){const n=[];return new ta((r,i)=>{t.onerror=(t=>{i(t.target.error)}),t.onsuccess=(t=>{const i=t.target.result;if(!i)return void r();const s=new fa(i),o=e(i.primaryKey,i.value,s);if(o instanceof ta){const t=o.catch(t=>(s.done(),ta.reject(t)));n.push(t)}s.kn?r():null===s.ri?i.continue():i.continue(s.ri)})}).next(()=>ta.qn(n))}options(t,e){let n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function va(t){return new ta((e,n)=>{t.onsuccess=(t=>{const n=t.target.result;e(n)}),t.onerror=(t=>{const e=wa(t.target.error);n(e)})})}let ya=!1;function wa(t){const e=la.js(r());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new Dr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ya||(ya=!0,setTimeout(()=>{throw t},0)),t}}return t}function ba(){return"undefined"!=typeof window?window:null}function _a(){return"undefined"!=typeof document?document:null}class Ia{constructor(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new na,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(t=>{})}static Ii(t,e,n,r,i){const s=Date.now()+n,o=new Ia(t,e,s,r,i);return o.start(n),o}start(t){this.mi=setTimeout(()=>this.Ai(),t)}Qs(){return this.Ai()}cancel(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Dr(Rr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}Ai(){this.di.Ri(()=>null!==this.mi?(this.clearTimeout(),this.op().then(t=>this.Ti.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)}}class Ea{constructor(){this.Pi=Promise.resolve(),this.Vi=[],this.gi=!1,this.yi=[],this.pi=null,this.bi=!1,this.vi=[],this.Si=new ha(this,"async_queue_retry"),this.Di=(()=>{const t=_a();t&&Er("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Si.Ks()});const t=_a();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}get Ci(){return this.gi}Ri(t){this.enqueue(t)}Ni(t){this.xi(),this.Mi(t)}ki(){if(!this.gi){this.gi=!0;const t=_a();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}}enqueue(t){return this.xi(),this.gi?new Promise(t=>{}):this.Mi(t)}Oi(t){this.Ri(()=>(this.Vi.push(t),this.Fi()))}async Fi(){if(0!==this.Vi.length){try{await this.Vi[0](),this.Vi.shift(),this.Si.reset()}catch(t){if(!pa(t))throw t;Er("AsyncQueue","Operation failed with retryable error: "+t)}this.Vi.length>0&&this.Si.Bs(()=>this.Fi())}}Mi(t){const e=this.Pi.then(()=>(this.bi=!0,t().catch(t=>{throw this.pi=t,this.bi=!1,Tr("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.bi=!1,t))));return this.Pi=e,e}Us(t,e,n){this.xi(),this.vi.indexOf(t)>-1&&(e=0);const r=Ia.Ii(this,t,e,n,t=>this.$i(t));return this.yi.push(r),r}xi(){this.pi&&kr()}Li(){}async Bi(){let t;do{t=this.Pi,await t}while(t!==this.Pi)}qi(t){for(const e of this.yi)if(e.Ns===t)return!0;return!1}Ui(t){return this.Bi().then(()=>{this.yi.sort((t,e)=>t.wi-e.wi);for(const e of this.yi)if(e.Qs(),"all"!==t&&e.Ns===t)break;return this.Bi()})}Ki(t){this.vi.push(t)}$i(t){const e=this.yi.indexOf(t);this.yi.splice(e,1)}}function Ta(t,e){if(Tr("AsyncQueue",`${e}: ${t}`),pa(t))return new Dr(Rr.UNAVAILABLE,`${e}: ${t}`);throw t}function Sa([t,e],[n,r]){const i=Fr(t,n);return 0===i?Fr(e,r):i}class Aa{constructor(t){this.Qi=t,this.buffer=new gi(Sa),this.Wi=0}ji(){return++this.Wi}Gi(t){const e=[t,this.ji()];if(this.buffer.size<this.Qi)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Sa(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}const ka={zi:!1,Hi:0,Ji:0,Yi:0};class Na{constructor(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}static er(t){return new Na(t,Na.nr,Na.sr)}}Na.nr=10,Na.sr=1e3,Na.ir=new Na(41943040,Na.nr,Na.sr),Na.rr=new Na(-1,0,0);class Oa{constructor(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}start(t){-1!==this.cr.params.Xi&&this.hr(t)}stop(){this.ar&&(this.ar.cancel(),this.ar=null)}get lr(){return null!==this.ar}hr(t){const e=this.ur?3e5:6e4;Er("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.ar=this.di.Us("lru_garbage_collection",e,async()=>{this.ar=null,this.ur=!0;try{await t._r(this.cr)}catch(t){pa(t)?Er("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await tc(t)}await this.hr(t)})}}class Ra{constructor(t,e){this.dr=t,this.params=e}wr(t,e){return this.dr.Er(t).next(t=>Math.floor(e/100*t))}Tr(t,e){if(0===e)return ta.resolve(ca.Ds);const n=new Aa(e);return this.dr.Ue(t,t=>n.Gi(t.sequenceNumber)).next(()=>this.dr.Ir(t,t=>n.Gi(t))).next(()=>n.maxValue)}mr(t,e,n){return this.dr.mr(t,e,n)}Ar(t,e){return this.dr.Ar(t,e)}Rr(t,e){return-1===this.params.Xi?(Er("LruGarbageCollector","Garbage collection skipped; disabled"),ta.resolve(ka)):this.Pr(t).next(n=>n<this.params.Xi?(Er("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold `+this.params.Xi),ka):this.Vr(t,e))}Pr(t){return this.dr.Pr(t)}Vr(t,e){let n,r,i,s,o,a,c;const h=Date.now();return this.wr(t,this.params.Zi).next(e=>(e>this.params.tr?(Er("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.tr} from `+e),r=this.params.tr):r=e,s=Date.now(),this.Tr(t,r))).next(r=>(n=r,o=Date.now(),this.mr(t,n,e))).next(e=>(i=e,a=Date.now(),this.Ar(t,n))).next(t=>(c=Date.now(),Ir()<=u.DEBUG&&Er("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-h}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${t} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-h}ms`),ta.resolve({zi:!0,Hi:r,Ji:i,Yi:t})))}}class Da{gr(t){this.yr=t}ws(t,e,n,r){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.Y())}(e)||n.isEqual(zr.min())?this.pr(t,e):this.yr._s(t,r).next(i=>{const s=this.br(e,i);return(Io(e)||Eo(e))&&this.vr(e.limitType,s,r,n)?this.pr(t,e):(Ir()<=u.DEBUG&&Er("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Po(e)),this.yr.ws(t,e,n).next(t=>(s.forEach(e=>{t=t.Tt(e.key,e)}),t)))})}br(t,e){let n=new gi(Lo(t));return e.forEach((e,r)=>{r instanceof mo&&Co(t,r)&&(n=n.add(r))}),n}vr(t,e,n,r){if(n.size!==e.size)return!0;const i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.D(r)>0)}pr(t,e){return Ir()<=u.DEBUG&&Er("QueryEngine","Using full collection scan to execute query:",Po(e)),this.yr.ws(t,e,zr.min())}}function Pa(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=La(e)),e=Ca(t.get(n),e);return La(e)}function Ca(t,e){let n=e;const r=t.length;for(let e=0;e<r;e++){const r=t.charAt(e);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function La(t){return t+""}function xa(t){const e=t.length;if(Nr(e>=2),2===e)return Nr(""===t.charAt(0)&&""===t.charAt(1)),Hr.H();const n=e-2,r=[];let i="";for(let n=0;n<e;){const e=t.indexOf("",n);switch((e<0||e>s)&&kr(),t.charAt(e+1)){case"":const s=t.substring(n,e);let o;0===i.length?o=s:(o=i+=s,i=""),r.push(o);break;case"":i+=t.substring(n,e),i+="\0";break;case"":i+=t.substring(n,e+1);break;default:kr()}n=e+2}return new Hr(r)}class Ma{constructor(t){this.Sr=t}}function Ua(t,e){if(e.document)return function(t,e,n){const r=ys(t,e.name),i=ps(e.updateTime),s=new lo({mapValue:{fields:e.fields}});return new mo(r,i,s,{hasCommittedMutations:!!n})}(t.Sr,e.document,!!e.hasCommittedMutations);if(e.noDocument){const t=Kr.it(e.noDocument.path),n=Ba(e.noDocument.readTime);return new vo(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){const t=Kr.it(e.unknownDocument.path),n=Ba(e.unknownDocument.version);return new yo(t,n)}return kr()}function Va(t,e,n){const r=Fa(n),i=e.key.path.$().W();if(e instanceof mo){const n=function(t,e){return{name:vs(t,e.key),fields:e.En().mapValue.fields,updateTime:fs(t,e.version.N())}}(t.Sr,e),s=e.hasCommittedMutations;return new gu(null,null,n,s,r,i)}if(e instanceof vo){const t=e.key.path.W(),n=qa(e.version),s=e.hasCommittedMutations;return new gu(null,new du(t,n),null,s,r,i)}if(e instanceof yo){const t=e.key.path.W(),n=qa(e.version);return new gu(new pu(t,n),null,null,!0,r,i)}return kr()}function Fa(t){const e=t.N();return[e.seconds,e.nanoseconds]}function ja(t){const e=new Br(t[0],t[1]);return zr.S(e)}function qa(t){const e=t.N();return new uu(e.seconds,e.nanoseconds)}function Ba(t){const e=new Br(t.seconds,t.nanoseconds);return zr.S(e)}function za(t,e){const n=(e.baseMutations||[]).map(e=>Ss(t.Sr,e)),r=e.mutations.map(e=>Ss(t.Sr,e)),i=Br.fromMillis(e.localWriteTimeMs);return new Jo(e.batchId,i,n,r)}function Ga(t){const e=Ba(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Ba(t.lastLimboFreeSnapshotVersion):zr.min();let r;var i;return void 0!==t.query.documents?(Nr(1===(i=t.query).documents.length),r=No(_o(bs(i.documents[0])))):r=function(t){return No(Ns(t))}(t.query),new oi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,si.fromBase64String(t.resumeToken))}function Ha(t,e){const n=qa(e.ft),r=qa(e.lastLimboFreeSnapshotVersion);let i;i=ii(e.target)?As(t.Sr,e.target):ks(t.Sr,e.target);const s=e.resumeToken.toBase64();return new vu(e.targetId,ni(e.target),n,s,e.sequenceNumber,r,i)}function $a(t){const e=Ns({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Oo(e,e.limit,"L"):e}class Wa{constructor(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Dr=r,this.Cr={}}static Nr(t,e,n,r){Nr(""!==t.uid);const i=t.t()?t.uid:"";return new Wa(i,e,n,r)}Mr(t){let e=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Xa(t)._i({index:lu.userMutationsIndex,range:n},(t,n,r)=>{e=!1,r.done()}).next(()=>e)}kr(t,e,n,r){const i=Ja(t),s=Xa(t);return s.add({}).next(o=>{Nr("number"==typeof o);const a=new Jo(o,e,n,r),u=function(t,e,n){const r=n.baseMutations.map(e=>Ts(t.Sr,e)),i=n.mutations.map(e=>Ts(t.Sr,e));return new lu(e,n.batchId,n.Vn.toMillis(),r,i)}(this.serializer,this.userId,a),c=[];let h=new gi((t,e)=>Fr(t.j(),e.j()));for(const t of r){const e=fu.key(this.userId,t.key.path,o);h=h.add(t.key.path.$()),c.push(s.put(u)),c.push(i.put(e,fu.PLACEHOLDER))}return h.forEach(e=>{c.push(this.os.Or(t,e))}),t.es(()=>{this.Cr[o]=a.keys()}),ta.qn(c).next(()=>a)})}Fr(t,e){return Xa(t).get(e).next(t=>t?(Nr(t.userId===this.userId),za(this.serializer,t)):null)}$r(t,e){return this.Cr[e]?ta.resolve(this.Cr[e]):this.Fr(t,e).next(t=>{if(t){const n=t.keys();return this.Cr[e]=n,n}return null})}Lr(t,e){const n=e+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Xa(t)._i({index:lu.userMutationsIndex,range:r},(t,e,r)=>{e.userId===this.userId&&(Nr(e.batchId>=n),i=za(this.serializer,e)),r.done()}).next(()=>i)}Br(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Xa(t)._i({index:lu.userMutationsIndex,range:e,reverse:!0},(t,e,r)=>{n=e.batchId,r.done()}).next(()=>n)}qr(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Xa(t).ui(lu.userMutationsIndex,e).next(t=>t.map(t=>za(this.serializer,t)))}us(t,e){const n=fu.prefixForPath(this.userId,e.path),r=IDBKeyRange.lowerBound(n),i=[];return Ja(t)._i({range:r},(n,r,s)=>{const[o,a,u]=n,c=xa(a);if(o===this.userId&&e.path.isEqual(c))return Xa(t).get(u).next(t=>{if(!t)throw kr();Nr(t.userId===this.userId),i.push(za(this.serializer,t))});s.done()}).next(()=>i)}ds(t,e){let n=new gi(Fr);const r=[];return e.forEach(e=>{const i=fu.prefixForPath(this.userId,e.path),s=IDBKeyRange.lowerBound(i),o=Ja(t)._i({range:s},(t,r,i)=>{const[s,o,a]=t,u=xa(o);s===this.userId&&e.path.isEqual(u)?n=n.add(a):i.done()});r.push(o)}),ta.qn(r).next(()=>this.Ur(t,n))}Rs(t,e){const n=e.path,r=n.length+1,i=fu.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new gi(Fr);return Ja(t)._i({range:s},(t,e,i)=>{const[s,a,u]=t,c=xa(a);s===this.userId&&n.U(c)?c.length===r&&(o=o.add(u)):i.done()}).next(()=>this.Ur(t,o))}Ur(t,e){const n=[],r=[];return e.forEach(e=>{r.push(Xa(t).get(e).next(t=>{if(null===t)throw kr();Nr(t.userId===this.userId),n.push(za(this.serializer,t))}))}),ta.qn(r).next(()=>n)}Kr(t,e){return Ya(t.Qr,this.userId,e).next(n=>(t.es(()=>{this.Wr(e.batchId)}),ta.forEach(n,e=>this.Dr.jr(t,e))))}Wr(t){delete this.Cr[t]}Gr(t){return this.Mr(t).next(e=>{if(!e)return ta.resolve();const n=IDBKeyRange.lowerBound(fu.prefixForUser(this.userId)),r=[];return Ja(t)._i({range:n},(t,e,n)=>{if(t[0]===this.userId){const e=xa(t[1]);r.push(e)}else n.done()}).next(()=>{Nr(0===r.length)})})}zr(t,e){return Ka(t,this.userId,e)}Hr(t){return Qa(t).get(this.userId).next(t=>t||new hu(this.userId,-1,""))}}function Ka(t,e,n){const r=fu.prefixForPath(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ja(t)._i({range:s,li:!0},(t,n,r)=>{const[s,a,u]=t;s===e&&a===i&&(o=!0),r.done()}).next(()=>o)}function Ya(t,e,n){const r=t.store(lu.store),i=t.store(fu.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r._i({range:o},(t,e,n)=>(a++,n.delete()));s.push(u.next(()=>{Nr(1===a)}));const c=[];for(const t of n.mutations){const r=fu.key(e,t.key.path,n.batchId);s.push(i.delete(r)),c.push(t.key)}return ta.qn(s).next(()=>c)}function Xa(t){return Vu.Ys(t,lu.store)}function Ja(t){return Vu.Ys(t,fu.store)}function Qa(t){return Vu.Ys(t,hu.store)}class Za{constructor(t,e){this.serializer=t,this.os=e}jn(t,e,n){return nu(t).put(ru(e),n)}Hn(t,e){const n=nu(t),r=ru(e);return n.delete(r)}updateMetadata(t,e){return this.getMetadata(t).next(n=>(n.byteSize+=e,this.Jr(t,n)))}Jn(t,e){return nu(t).get(ru(e)).next(t=>this.Yr(t))}Xr(t,e){return nu(t).get(ru(e)).next(t=>{const e=this.Yr(t);return e?{zn:e,size:iu(t)}:null})}getEntries(t,e){let n=wi();return this.Zr(t,e,(t,e)=>{const r=this.Yr(e);n=n.Tt(t,r)}).next(()=>n)}eo(t,e){let n=wi(),r=new fi(Kr.k);return this.Zr(t,e,(t,e)=>{const i=this.Yr(e);i?(n=n.Tt(t,i),r=r.Tt(t,iu(e))):(n=n.Tt(t,null),r=r.Tt(t,0))}).next(()=>({no:n,so:r}))}Zr(t,e,n){if(e.q())return ta.resolve();const r=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),i=e.gt();let s=i.Ct();return nu(t)._i({range:r},(t,e,r)=>{const o=Kr.it(t);for(;s&&Kr.k(s,o)<0;)n(s,null),s=i.Ct();s&&s.isEqual(o)&&(n(s,e),s=i.Nt()?i.Ct():null),s?r.oi(s.path.W()):r.done()}).next(()=>{for(;s;)n(s,null),s=i.Nt()?i.Ct():null})}ws(t,e,n){let r=_i();const i=e.path.length+1,s={};if(n.isEqual(zr.min())){const t=e.path.W();s.range=IDBKeyRange.lowerBound(t)}else{const t=e.path.W(),r=Fa(n);s.range=IDBKeyRange.lowerBound([t,r],!0),s.index=gu.collectionReadTimeIndex}return nu(t)._i(s,(t,n,s)=>{if(t.length!==i)return;const o=Ua(this.serializer,n);e.path.U(o.key.path)?o instanceof mo&&Co(e,o)&&(r=r.Tt(o.key,o)):s.done()}).next(()=>r)}io(t){return new tu(this,!!t&&t.ro)}oo(t){return this.getMetadata(t).next(t=>t.byteSize)}getMetadata(t){return eu(t).get(mu.key).next(t=>(Nr(!!t),t))}Jr(t,e){return eu(t).put(mu.key,e)}Yr(t){if(t){const e=Ua(this.serializer,t);return e instanceof vo&&e.version.isEqual(zr.min())?null:e}return null}}class tu extends ea{constructor(t,e){super(),this.co=t,this.ro=e,this.uo=new Zo(t=>t.toString(),(t,e)=>t.isEqual(e))}Zn(t){const e=[];let n=0,r=new gi((t,e)=>Fr(t.j(),e.j()));return this.Kn.forEach((i,s)=>{const o=this.uo.get(i);if(s.zn){const a=Va(this.co.serializer,s.zn,this.Wn(i));r=r.add(i.path.$());const u=iu(a);n+=u-o,e.push(this.co.jn(t,i,a))}else if(n-=o,this.ro){const n=Va(this.co.serializer,new vo(i,zr.min()),this.Wn(i));e.push(this.co.jn(t,i,n))}else e.push(this.co.Hn(t,i))}),r.forEach(n=>{e.push(this.co.os.Or(t,n))}),e.push(this.co.updateMetadata(t,n)),ta.qn(e)}Yn(t,e){return this.co.Xr(t,e).next(t=>null===t?(this.uo.set(e,0),null):(this.uo.set(e,t.size),t.zn))}Xn(t,e){return this.co.eo(t,e).next(({no:t,so:e})=>(e.forEach((t,e)=>{this.uo.set(t,e)}),t))}}function eu(t){return Vu.Ys(t,mu.store)}function nu(t){return Vu.Ys(t,gu.store)}function ru(t){return t.path.W()}function iu(t){let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}class su{constructor(){this.ao=new ou}Or(t,e){return this.ao.add(e),ta.resolve()}As(t,e){return ta.resolve(this.ao.getEntries(e))}}class ou{constructor(){this.index={}}add(t){const e=t.B(),n=t.$(),r=this.index[e]||new gi(Hr.k),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.B(),n=t.$(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new gi(Hr.k)).W()}}class au{constructor(t){this.serializer=t}createOrUpgrade(t,e,n,r){Nr(n<r&&n>=0&&r<=11);const i=new ga("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(cu.store)}(t),function(t){t.createObjectStore(hu.store,{keyPath:hu.keyPath}),t.createObjectStore(lu.store,{keyPath:lu.keyPath,autoIncrement:!0}).createIndex(lu.userMutationsIndex,lu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(fu.store)}(t),_u(t),function(t){t.createObjectStore(gu.store)}(t));let s=ta.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(yu.store),t.deleteObjectStore(vu.store),t.deleteObjectStore(wu.store)}(t),_u(t)),s=s.next(()=>(function(t){const e=i.store(wu.store),n=new wu(0,0,zr.min().N(),0);return e.put(wu.key,n)})())),n<4&&r>=4&&(0!==n&&(s=s.next(()=>(function(t,e){return e.store(lu.store).ui().next(n=>{t.deleteObjectStore(lu.store),t.createObjectStore(lu.store,{keyPath:lu.keyPath,autoIncrement:!0}).createIndex(lu.userMutationsIndex,lu.userMutationsKeyPath,{unique:!0});const r=e.store(lu.store),i=n.map(t=>r.put(t));return ta.qn(i)})})(t,i))),s=s.next(()=>{!function(t){t.createObjectStore(Iu.store,{keyPath:Iu.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(()=>this.removeAcknowledgedMutations(i))),n<6&&r>=6&&(s=s.next(()=>((function(t){t.createObjectStore(mu.store)})(t),this.addDocumentGlobal(i)))),n<7&&r>=7&&(s=s.next(()=>this.ensureSequenceNumbers(i))),n<8&&r>=8&&(s=s.next(()=>this.createCollectionParentIndex(t,i))),n<9&&r>=9&&(s=s.next(()=>{!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){const e=t.objectStore(gu.store);e.createIndex(gu.readTimeIndex,gu.readTimeIndexPath,{unique:!1}),e.createIndex(gu.collectionReadTimeIndex,gu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(()=>this.rewriteCanonicalIds(i))),n<11&&r>=11&&(s=s.next(()=>{!function(t){t.createObjectStore(Eu.store,{keyPath:Eu.keyPath})}(t),function(t){t.createObjectStore(Tu.store,{keyPath:Tu.keyPath})}(t)})),s}addDocumentGlobal(t){let e=0;return t.store(gu.store)._i((t,n)=>{e+=iu(n)}).next(()=>{const n=new mu(e);return t.store(mu.store).put(mu.key,n)})}removeAcknowledgedMutations(t){const e=t.store(hu.store),n=t.store(lu.store);return e.ui().next(e=>ta.forEach(e,e=>{const r=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return n.ui(lu.userMutationsIndex,r).next(n=>ta.forEach(n,n=>{Nr(n.userId===e.userId);const r=za(this.serializer,n);return Ya(t,e.userId,r).next(()=>{})}))}))}ensureSequenceNumbers(t){const e=t.store(yu.store),n=t.store(gu.store);return t.store(wu.store).get(wu.key).next(t=>{const r=[];return n._i((n,i)=>{const s=new Hr(n),o=function(t){return[0,Pa(s)]}();r.push(e.get(o).next(n=>n?ta.resolve():(n=>e.put(new yu(0,Pa(n),t.highestListenSequenceNumber)))(s)))}).next(()=>ta.qn(r))})}createCollectionParentIndex(t,e){t.createObjectStore(bu.store,{keyPath:bu.keyPath});const n=e.store(bu.store),r=new ou,i=t=>{if(r.add(t)){const e=t.B(),r=t.$();return n.put({collectionId:e,parent:Pa(r)})}};return e.store(gu.store)._i({li:!0},(t,e)=>{const n=new Hr(t);return i(n.$())}).next(()=>e.store(fu.store)._i({li:!0},([t,e,n],r)=>{const s=xa(e);return i(s.$())}))}rewriteCanonicalIds(t){const e=t.store(vu.store);return e._i((t,n)=>{const r=Ga(n),i=Ha(this.serializer,r);return e.put(i)})}}class uu{constructor(t,e){this.seconds=t,this.nanoseconds=e}}class cu{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}cu.store="owner",cu.key="owner";class hu{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}hu.store="mutationQueues",hu.keyPath="userId";class lu{constructor(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}lu.store="mutations",lu.keyPath="batchId",lu.userMutationsIndex="userMutationsIndex",lu.userMutationsKeyPath=["userId","batchId"];class fu{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Pa(e)]}static key(t,e,n){return[t,Pa(e),n]}}fu.store="documentMutations",fu.PLACEHOLDER=new fu;class du{constructor(t,e){this.path=t,this.readTime=e}}class pu{constructor(t,e){this.path=t,this.version=e}}class gu{constructor(t,e,n,r,i,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}gu.store="remoteDocuments",gu.readTimeIndex="readTimeIndex",gu.readTimeIndexPath="readTime",gu.collectionReadTimeIndex="collectionReadTimeIndex",gu.collectionReadTimeIndexPath=["parentPath","readTime"];class mu{constructor(t){this.byteSize=t}}mu.store="remoteDocumentGlobal",mu.key="remoteDocumentGlobalKey";class vu{constructor(t,e,n,r,i,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}vu.store="targets",vu.keyPath="targetId",vu.queryTargetsIndexName="queryTargetsIndex",vu.queryTargetsKeyPath=["canonicalId","targetId"];class yu{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}yu.store="targetDocuments",yu.keyPath=["targetId","path"],yu.documentTargetsIndex="documentTargetsIndex",yu.documentTargetsKeyPath=["path","targetId"];class wu{constructor(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}wu.key="targetGlobalKey",wu.store="targetGlobal";class bu{constructor(t,e){this.collectionId=t,this.parent=e}}function _u(t){t.createObjectStore(yu.store,{keyPath:yu.keyPath}).createIndex(yu.documentTargetsIndex,yu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(vu.store,{keyPath:vu.keyPath}).createIndex(vu.queryTargetsIndexName,vu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(wu.store)}bu.store="collectionParents",bu.keyPath=["collectionId","parent"];class Iu{constructor(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}}Iu.store="clientMetadata",Iu.keyPath="clientId";class Eu{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}Eu.store="bundles",Eu.keyPath="bundleId";class Tu{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}Tu.store="namedQueries",Tu.keyPath="name";const Su=[...[...[...[...[hu.store,lu.store,fu.store,gu.store,vu.store,cu.store,wu.store,yu.store],Iu.store],mu.store],bu.store],Eu.store,Tu.store];class Au{constructor(t){this.serializer=t}ho(t,e){return ku(t).get(e).next(t=>{if(t)return{id:(e=t).bundleId,createTime:Ba(e.createTime),version:e.version};var e})}lo(t,e){return ku(t).put({bundleId:(n=e).id,createTime:qa(ps(n.createTime)),version:n.version});var n}_o(t,e){return Nu(t).get(e).next(t=>{if(t)return{name:(e=t).name,query:$a(e.bundledQuery),readTime:Ba(e.readTime)};var e})}fo(t,e){return Nu(t).put(function(t){return{name:t.name,readTime:qa(ps(t.readTime)),bundledQuery:t.bundledQuery}}(e))}}function ku(t){return Vu.Ys(t,Eu.store)}function Nu(t){return Vu.Ys(t,Tu.store)}class Ou{constructor(){this.wo=new ou}Or(t,e){if(!this.wo.has(e)){const n=e.B(),r=e.$();t.es(()=>{this.wo.add(e)});const i={collectionId:n,parent:Pa(r)};return Ru(t).put(i)}return ta.resolve()}As(t,e){const n=[],r=IDBKeyRange.bound([e,""],[qr(e),""],!1,!0);return Ru(t).ui(r).next(t=>{for(const r of t){if(r.collectionId!==e)break;n.push(xa(r.parent))}return n})}}function Ru(t){return Vu.Ys(t,bu.store)}class Du{constructor(t){this.Eo=t}next(){return this.Eo+=2,this.Eo}static To(){return new Du(0)}static Io(){return new Du(-1)}}class Pu{constructor(t,e){this.Dr=t,this.serializer=e}mo(t){return this.Ao(t).next(e=>{const n=new Du(e.highestTargetId);return e.highestTargetId=n.next(),this.Ro(t,e).next(()=>e.highestTargetId)})}Po(t){return this.Ao(t).next(t=>zr.S(new Br(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}Vo(t){return this.Ao(t).next(t=>t.highestListenSequenceNumber)}yo(t,e,n){return this.Ao(t).next(r=>(r.highestListenSequenceNumber=e,n&&(r.lastRemoteSnapshotVersion=n.N()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Ro(t,r)))}po(t,e){return this.bo(t,e).next(()=>this.Ao(t).next(n=>(n.targetCount+=1,this.vo(e,n),this.Ro(t,n))))}So(t,e){return this.bo(t,e)}Do(t,e){return this.Co(t,e.targetId).next(()=>Cu(t).delete(e.targetId)).next(()=>this.Ao(t)).next(e=>(Nr(e.targetCount>0),e.targetCount-=1,this.Ro(t,e)))}mr(t,e,n){let r=0;const i=[];return Cu(t)._i((s,o)=>{const a=Ga(o);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r++,i.push(this.Do(t,a)))}).next(()=>ta.qn(i)).next(()=>r)}Ue(t,e){return Cu(t)._i((t,n)=>{const r=Ga(n);e(r)})}Ao(t){return Lu(t).get(wu.key).next(t=>(Nr(null!==t),t))}Ro(t,e){return Lu(t).put(wu.key,e)}bo(t,e){return Cu(t).put(Ha(this.serializer,e))}vo(t,e){let n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n}No(t){return this.Ao(t).next(t=>t.targetCount)}xo(t,e){const n=ni(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Cu(t)._i({range:r,index:vu.queryTargetsIndexName},(t,n,r)=>{const s=Ga(n);ri(e,s.target)&&(i=s,r.done())}).next(()=>i)}Mo(t,e,n){const r=[],i=xu(t);return e.forEach(e=>{const s=Pa(e.path);r.push(i.put(new yu(n,s))),r.push(this.Dr.ko(t,n,e))}),ta.qn(r)}Oo(t,e,n){const r=xu(t);return ta.forEach(e,e=>{const i=Pa(e.path);return ta.qn([r.delete([n,i]),this.Dr.Fo(t,n,e)])})}Co(t,e){const n=xu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)}$o(t,e){const n=IDBKeyRange.bound([e],[e+1],!1,!0),r=xu(t);let i=Ti();return r._i({range:n,li:!0},(t,e,n)=>{const r=xa(t[1]),s=new Kr(r);i=i.add(s)}).next(()=>i)}zr(t,e){const n=Pa(e.path),r=IDBKeyRange.bound([n],[qr(n)],!1,!0);let i=0;return xu(t)._i({index:yu.documentTargetsIndex,li:!0,range:r},([t,e],n,r)=>{0!==t&&(i++,r.done())}).next(()=>i>0)}Ze(t,e){return Cu(t).get(e).next(t=>t?Ga(t):null)}}function Cu(t){return Vu.Ys(t,vu.store)}function Lu(t){return Vu.Ys(t,wu.store)}function xu(t){return Vu.Ys(t,yu.store)}const Mu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Uu extends oa{constructor(t,e){super(),this.Qr=t,this.Lo=e}}class Vu{constructor(t,e,n,r,i,s,o,a,u,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=s,this.document=o,this.Bo=u,this.qo=c,this.Uo=null,this.Ko=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Qo=null,this.inForeground=!1,this.Wo=null,this.jo=null,this.Go=Number.NEGATIVE_INFINITY,this.zo=(t=>Promise.resolve()),!Vu.Gs())throw new Dr(Rr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Dr=new qu(this,r),this.Ho=e+"main",this.serializer=new Ma(a),this.Jo=new la(this.Ho,11,new au(this.serializer)),this.Yo=new Pu(this.Dr,this.serializer),this.os=new Ou,this.ss=function(t,e){return new Za(t,e)}(this.serializer,this.os),this.Xo=new Au(this.serializer),this.window&&this.window.localStorage?this.Zo=this.window.localStorage:(this.Zo=null,!1===c&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}static Ys(t,e){if(t instanceof Uu)return la.Ys(t.Qr,e);throw kr()}start(){return this.tc().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Dr(Rr.FAILED_PRECONDITION,Mu);return this.ec(),this.nc(),this.sc(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Yo.Vo(t))}).then(t=>{this.Uo=new ca(t,this.Bo)}).then(()=>{this.Ko=!0}).catch(t=>(this.Jo&&this.Jo.close(),Promise.reject(t)))}ic(t){return this.zo=(async e=>{if(this.lr)return t(e)}),t(this.isPrimary)}rc(t){this.Jo.ti(async e=>{null===e.newVersion&&await t()})}oc(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(async()=>{this.lr&&await this.tc()}))}tc(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>ju(t).put(new Iu(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.cc(t).next(t=>{t||(this.isPrimary=!1,this.Cs.Oi(()=>this.zo(!1)))})}).next(()=>this.uc(t)).next(e=>this.isPrimary&&!e?this.ac(t).next(()=>!1):!!e&&this.hc(t).next(()=>!0))).catch(t=>{if(pa(t))return Er("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return Er("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.Cs.Oi(()=>this.zo(t)),this.isPrimary=t})}cc(t){return Fu(t).get(cu.key).next(t=>ta.resolve(this.lc(t)))}_c(t){return ju(t).delete(this.clientId)}async fc(){if(this.isPrimary&&!this.dc(this.Go,18e5)){this.Go=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const e=Vu.Ys(t,Iu.store);return e.ui().next(t=>{const n=this.wc(t,18e5),r=t.filter(t=>-1===n.indexOf(t));return ta.forEach(r,t=>e.delete(t.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Zo)for(const e of t)this.Zo.removeItem(this.Ec(e.clientId))}}sc(){this.jo=this.Cs.Us("client_metadata_refresh",4e3,()=>this.tc().then(()=>this.fc()).then(()=>this.sc()))}lc(t){return!!t&&t.ownerId===this.clientId}uc(t){return this.qo?ta.resolve(!0):Fu(t).get(cu.key).next(e=>{if(null!==e&&this.dc(e.leaseTimestampMs,5e3)&&!this.Tc(e.ownerId)){if(this.lc(e)&&this.networkEnabled)return!0;if(!this.lc(e)){if(!e.allowTabSynchronization)throw new Dr(Rr.FAILED_PRECONDITION,Mu);return!1}}return!(!this.networkEnabled||!this.inForeground)||ju(t).ui().next(t=>void 0===this.wc(t,5e3).find(t=>{if(this.clientId!==t.clientId){const e=!this.networkEnabled&&t.networkEnabled,n=!this.inForeground&&t.inForeground,r=this.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Er("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async Ic(){this.Ko=!1,this.mc(),this.jo&&(this.jo.cancel(),this.jo=null),this.Ac(),this.Rc(),await this.Jo.runTransaction("shutdown","readwrite",[cu.store,Iu.store],t=>{const e=new Uu(t,ca.Ds);return this.ac(e).next(()=>this._c(e))}),this.Jo.close(),this.Pc()}wc(t,e){return t.filter(t=>this.dc(t.updateTimeMs,e)&&!this.Tc(t.clientId))}Vc(){return this.runTransaction("getActiveClients","readonly",t=>ju(t).ui().next(t=>this.wc(t,18e5).map(t=>t.clientId)))}get lr(){return this.Ko}gc(t){return Wa.Nr(t,this.serializer,this.os,this.Dr)}yc(){return this.Yo}bc(){return this.ss}vc(){return this.os}Sc(){return this.Xo}runTransaction(t,e,n){Er("IndexedDbPersistence","Starting transaction:",t);const r="readonly"===e?"readonly":"readwrite";let i;return this.Jo.runTransaction(t,r,Su,r=>(i=new Uu(r,this.Uo?this.Uo.next():ca.Ds),"readwrite-primary"===e?this.cc(i).next(t=>!!t||this.uc(i)).next(e=>{if(!e)throw Tr(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Cs.Oi(()=>this.zo(!1)),new Dr(Rr.FAILED_PRECONDITION,sa);return n(i)}).next(t=>this.hc(i).next(()=>t)):this.Dc(i).next(()=>n(i)))).then(t=>(i.ns(),t))}Dc(t){return Fu(t).get(cu.key).next(t=>{if(null!==t&&this.dc(t.leaseTimestampMs,5e3)&&!this.Tc(t.ownerId)&&!this.lc(t)&&!(this.qo||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Dr(Rr.FAILED_PRECONDITION,Mu)})}hc(t){const e=new cu(this.clientId,this.allowTabSynchronization,Date.now());return Fu(t).put(cu.key,e)}static Gs(){return la.Gs()}ac(t){const e=Fu(t);return e.get(cu.key).next(t=>this.lc(t)?(Er("IndexedDbPersistence","Releasing primary lease."),e.delete(cu.key)):ta.resolve())}dc(t,e){const n=Date.now();return!(t<n-e||t>n&&(Tr(`Detected an update time that is in the future: ${t} > ${n}`),1))}ec(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Wo=(()=>{this.Cs.Ri(()=>(this.inForeground="visible"===this.document.visibilityState,this.tc()))}),this.document.addEventListener("visibilitychange",this.Wo),this.inForeground="visible"===this.document.visibilityState)}Ac(){this.Wo&&(this.document.removeEventListener("visibilitychange",this.Wo),this.Wo=null)}nc(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Qo=(()=>{this.mc(),this.Cs.Ri(()=>this.Ic())}),this.window.addEventListener("unload",this.Qo))}Rc(){this.Qo&&(this.window.removeEventListener("unload",this.Qo),this.Qo=null)}Tc(t){var e;try{const n=null!==(null===(e=this.Zo)||void 0===e?void 0:e.getItem(this.Ec(t)));return Er("IndexedDbPersistence",`Client '${t}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}}mc(){if(this.Zo)try{this.Zo.setItem(this.Ec(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}}Pc(){if(this.Zo)try{this.Zo.removeItem(this.Ec(this.clientId))}catch(t){}}Ec(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Fu(t){return Vu.Ys(t,cu.store)}function ju(t){return Vu.Ys(t,Iu.store)}class qu{constructor(t,e){this.db=t,this.cr=new Ra(this,e)}Er(t){const e=this.Cc(t);return this.db.yc().No(t).next(t=>e.next(e=>t+e))}Cc(t){let e=0;return this.Ir(t,t=>{e++}).next(()=>e)}Ue(t,e){return this.db.yc().Ue(t,e)}Ir(t,e){return this.Nc(t,(t,n)=>e(n))}ko(t,e,n){return Bu(t,n)}Fo(t,e,n){return Bu(t,n)}mr(t,e,n){return this.db.yc().mr(t,e,n)}jr(t,e){return Bu(t,e)}xc(t,e){return function(t,e){let n=!1;return Qa(t).fi(r=>Ka(t,r,e).next(t=>(t&&(n=!0),ta.resolve(!t)))).next(()=>n)}(t,e)}Ar(t,e){const n=this.db.bc().io(),r=[];let i=0;return this.Nc(t,(s,o)=>{if(o<=e){const e=this.xc(t,s).next(e=>{if(!e)return i++,n.Jn(t,s).next(()=>(n.Hn(s),xu(t).delete([0,Pa(s.path)])))});r.push(e)}}).next(()=>ta.qn(r)).next(()=>n.apply(t)).next(()=>i)}removeTarget(t,e){const n=e.dt(t.Lo);return this.db.yc().So(t,n)}Mc(t,e){return Bu(t,e)}Nc(t,e){const n=xu(t);let r,i=ca.Ds;return n._i({index:yu.documentTargetsIndex},([t,n],{path:s,sequenceNumber:o})=>{0===t?(i!==ca.Ds&&e(new Kr(xa(r)),i),i=o,r=s):i=ca.Ds}).next(()=>{i!==ca.Ds&&e(new Kr(xa(r)),i)})}Pr(t){return this.db.bc().oo(t)}}function Bu(t,e){return xu(t).put(function(t,e){return new yu(0,Pa(t.path),e)}(e,t.Lo))}function zu(t,e){let n=t.projectId;return t.ct||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class Gu{constructor(t,e,n,r){this.persistence=t,this.kc=e,this.serializer=r,this.Oc=new fi(Fr),this.Fc=new Zo(t=>ni(t),ri),this.$c=zr.min(),this.rs=t.gc(n),this.Lc=t.bc(),this.Yo=t.yc(),this.Bc=new aa(this.Lc,this.rs,this.persistence.vc()),this.Xo=t.Sc(),this.kc.gr(this.Bc)}_r(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.Rr(e,this.Oc))}}function Hu(t,e,n,r){return new Gu(t,e,n,r)}async function $u(t,e){const n=Or(t);let r=n.rs,i=n.Bc;const s=await n.persistence.runTransaction("Handle user change","readonly",t=>{let s;return n.rs.qr(t).next(o=>(s=o,r=n.persistence.gc(e),i=new aa(n.Lc,r,n.persistence.vc()),r.qr(t))).next(e=>{const n=[],r=[];let o=Ti();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return i._s(t,o).next(t=>({qc:t,Uc:n,Kc:r}))})});return n.rs=r,n.Bc=i,n.kc.gr(n.Bc),s}function Wu(t){const e=Or(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Yo.Po(t))}function Ku(t,e){const n=Or(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=-1),n.rs.Lr(t,e)))}function Yu(t,e){const n=Or(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return n.Yo.xo(t,e).next(i=>i?(r=i,ta.resolve(r)):n.Yo.mo(t).next(i=>(r=new oi(e,i,0,t.Lo),n.Yo.po(t,r).next(()=>r))))}).then(t=>{const r=n.Oc.get(t.targetId);return(null===r||t.ft.D(r.ft)>0)&&(n.Oc=n.Oc.Tt(t.targetId,t),n.Fc.set(e,t.targetId)),t})}async function Xu(t,e,n){const r=Or(t),i=r.Oc.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,t=>r.persistence.Dr.removeTarget(t,i))}catch(t){if(!pa(t))throw t;Er("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}r.Oc=r.Oc.remove(e),r.Fc.delete(i.target)}function Ju(t,e,n){const r=Or(t);let i=zr.min(),s=Ti();return r.persistence.runTransaction("Execute query","readonly",t=>(function(t,e,n){const r=Or(t),i=r.Fc.get(n);return void 0!==i?ta.resolve(r.Oc.get(i)):r.Yo.xo(e,n)})(r,t,No(e)).next(e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,r.Yo.$o(t,e.targetId).next(t=>{s=t})}).next(()=>r.kc.ws(t,e,n?i:zr.min(),n?s:Ti())).next(t=>({documents:t,Qc:s})))}function Qu(t,e){const n=Or(t),r=Or(n.Yo),i=n.Oc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",t=>r.Ze(t,e).next(t=>t?t.target:null))}function Zu(t){const e=Or(t);return e.persistence.runTransaction("Get new document changes","readonly",t=>(function(t,e,n){const r=Or(t);let i=yi(),s=Fa(n);const o=nu(e),a=IDBKeyRange.lowerBound(s,!0);return o._i({index:gu.readTimeIndex,range:a},(t,e)=>{const n=Ua(r.serializer,e);i=i.Tt(n.key,n),s=e.readTime}).next(()=>({Wc:i,readTime:ja(s)}))})(e.Lc,t,e.$c)).then(({Wc:t,readTime:n})=>(e.$c=n,t))}async function tc(t){if(t.code!==Rr.FAILED_PRECONDITION||t.message!==sa)throw t;Er("LocalStore","Unexpectedly lost primary lease")}class ec{constructor(t,e,n,r,i,s){this.Cs=t,this.jc=n,this.Gc=r,this.zc=i,this.listener=s,this.state=0,this.Hc=0,this.Jc=null,this.stream=null,this.Si=new ha(t,e)}Yc(){return 1===this.state||2===this.state||4===this.state}Xc(){return 2===this.state}start(){3!==this.state?this.auth():this.Zc()}async stop(){this.Yc()&&await this.close(0)}tu(){this.state=0,this.Si.reset()}eu(){this.Xc()&&null===this.Jc&&(this.Jc=this.Cs.Us(this.jc,6e4,()=>this.nu()))}su(t){this.iu(),this.stream.send(t)}async nu(){if(this.Xc())return this.close(0)}iu(){this.Jc&&(this.Jc.cancel(),this.Jc=null)}async close(t,e){this.iu(),this.Si.cancel(),this.Hc++,3!==t?this.Si.reset():e&&e.code===Rr.RESOURCE_EXHAUSTED?(Tr(e.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===Rr.UNAUTHENTICATED&&this.zc._(),null!==this.stream&&(this.ru(),this.stream.close(),this.stream=null),this.state=t,await this.listener.ou(e)}ru(){}auth(){this.state=1;const t=this.cu(this.Hc),e=this.Hc;this.zc.getToken().then(t=>{this.Hc===e&&this.uu(t)},e=>{t(()=>{const t=new Dr(Rr.UNKNOWN,"Fetching auth token failed: "+e.message);return this.au(t)})})}uu(t){const e=this.cu(this.Hc);this.stream=this.hu(t),this.stream.lu(()=>{e(()=>(this.state=2,this.listener.lu()))}),this.stream.ou(t=>{e(()=>this.au(t))}),this.stream.onMessage(t=>{e(()=>this.onMessage(t))})}Zc(){this.state=4,this.Si.Bs(async()=>{this.state=0,this.start()})}au(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)}cu(t){return e=>{this.Cs.Ri(()=>this.Hc===t?e():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nc extends ec{constructor(t,e,n,r,i){super(t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i),this.serializer=r}hu(t){return this.Gc._u("Listen",t)}onMessage(t){this.Si.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:kr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.tn?(Nr(void 0===e||"string"==typeof e),si.fromBase64String(e||"")):(Nr(void 0===e||e instanceof Uint8Array),si.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Rr.UNKNOWN:li(t.code);return new Dr(e,t.message||"")}(o);n=new Li(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ys(t,r.document.name),s=ps(r.document.updateTime),o=new lo({mapValue:{fields:r.document.fields}}),a=new mo(i,s,o,{}),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Pi(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ys(t,r.document),s=r.readTime?ps(r.readTime):zr.min(),o=new vo(i,s),a=r.removedTargetIds||[];n=new Pi([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ys(t,r.document),s=r.removedTargetIds||[];n=new Pi([],s,i,null)}else{if(!("filter"in e))return kr();{e.filter;const t=e.filter;t.targetId;const r=t.count||0,i=new ai(r),s=t.targetId;n=new Ci(s,i)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return zr.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?zr.min():e.readTime?ps(e.readTime):zr.min()}(t);return this.listener.fu(e,n)}du(t){const e={};e.database=_s(this.serializer),e.addTarget=function(t,e){let n;const r=e.target;return(n=ii(r)?{documents:As(t,r)}:{query:ks(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=ds(t,e.resumeToken):e.ft.D(zr.min())>0&&(n.readTime=fs(t,e.ft.N())),n}(this.serializer,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.su(e)}wu(t){const e={};e.database=_s(this.serializer),e.removeTarget=t,this.su(e)}}class rc extends ec{constructor(t,e,n,r,i){super(t,"write_stream_connection_backoff","write_stream_idle",e,n,i),this.serializer=r,this.Eu=!1}get Tu(){return this.Eu}start(){this.Eu=!1,this.lastStreamToken=void 0,super.start()}ru(){this.Eu&&this.Iu([])}hu(t){return this.Gc._u("Write",t)}onMessage(t){if(Nr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Eu){this.Si.reset();const e=function(t,e){return t&&t.length>0?(Nr(void 0!==e),t.map(t=>(function(t,e){let n=t.updateTime?ps(t.updateTime):ps(e);n.isEqual(zr.min())&&(n=ps(e));let r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ks(n,r)})(t,e))):[]}(t.writeResults,t.commitTime),n=ps(t.commitTime);return this.listener.mu(n,e)}return Nr(!t.writeResults||0===t.writeResults.length),this.Eu=!0,this.listener.Au()}Ru(){const t={};t.database=_s(this.serializer),this.su(t)}Iu(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>Ts(this.serializer,t))};this.su(e)}}class ic extends class{}{constructor(t,e,n){super(),this.credentials=t,this.Gc=e,this.serializer=n,this.Pu=!1}Vu(){if(this.Pu)throw new Dr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")}gu(t,e,n){return this.Vu(),this.credentials.getToken().then(r=>this.Gc.gu(t,e,n,r)).catch(t=>{throw t.code===Rr.UNAUTHENTICATED&&this.credentials._(),t})}yu(t,e,n){return this.Vu(),this.credentials.getToken().then(r=>this.Gc.yu(t,e,n,r)).catch(t=>{throw t.code===Rr.UNAUTHENTICATED&&this.credentials._(),t})}terminate(){this.Pu=!1}}class sc{constructor(t,e){this.di=t,this.pu=e,this.state="Unknown",this.bu=0,this.vu=null,this.Su=!0}Du(){0===this.bu&&(this.Cu("Unknown"),this.vu=this.di.Us("online_state_timeout",1e4,()=>(this.vu=null,this.Nu("Backend didn't respond within 10 seconds."),this.Cu("Offline"),Promise.resolve())))}xu(t){"Online"===this.state?this.Cu("Unknown"):(this.bu++,this.bu>=1&&(this.Mu(),this.Nu("Connection failed 1 times. Most recent error: "+t.toString()),this.Cu("Offline")))}set(t){this.Mu(),this.bu=0,"Online"===t&&(this.Su=!1),this.Cu(t)}Cu(t){t!==this.state&&(this.state=t,this.pu(t))}Nu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Su?(Tr(e),this.Su=!1):Er("OnlineStateTracker",e)}Mu(){null!==this.vu&&(this.vu.cancel(),this.vu=null)}}class oc{constructor(t,e,n,r,i){this.ku=t,this.Ou=e,this.di=n,this.Fu={},this.$u=[],this.Lu=new Map,this.Bu=new Set,this.qu=[],this.Uu=i,this.Uu.Ku(t=>{n.Ri(async()=>{gc(this)&&(Er("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Or(t);e.Bu.add(4),await uc(e),e.Qu.set("Unknown"),e.Bu.delete(4),await ac(e)}(this))})}),this.Qu=new sc(n,r)}}async function ac(t){if(gc(t))for(const e of t.qu)await e(!0)}async function uc(t){for(const e of t.qu)await e(!1)}function cc(t,e){const n=Or(t);n.Lu.has(e.targetId)||(n.Lu.set(e.targetId,e),pc(n)?dc(n):Sc(n).Xc()&&lc(n,e))}function hc(t,e){const n=Or(t),r=Sc(n);n.Lu.delete(e),r.Xc()&&fc(n,e),0===n.Lu.size&&(r.Xc()?r.eu():gc(n)&&n.Qu.set("Unknown"))}function lc(t,e){t.Wu.De(e.targetId),Sc(t).du(e)}function fc(t,e){t.Wu.De(e),Sc(t).wu(e)}function dc(t){t.Wu=new Mi({Xe:e=>t.Fu.Xe(e),Ze:e=>t.Lu.get(e)||null}),Sc(t).start(),t.Qu.Du()}function pc(t){return gc(t)&&!Sc(t).Yc()&&t.Lu.size>0}function gc(t){return 0===Or(t).Bu.size}function mc(t){t.Wu=void 0}async function vc(t,e,n){if(!pa(e))throw e;t.Bu.add(1),await uc(t),t.Qu.set("Offline"),n||(n=(()=>Wu(t.ku))),t.di.Oi(async()=>{Er("RemoteStore","Retrying IndexedDB access"),await n(),t.Bu.delete(1),await ac(t)})}function yc(t,e){return e().catch(n=>vc(t,n,e))}async function wc(t){const e=Or(t),n=Ac(e);let r=e.$u.length>0?e.$u[e.$u.length-1].batchId:-1;for(;bc(e);)try{const i=await Ku(e.ku,r);if(null===i){0===e.$u.length&&n.eu();break}r=i.batchId,_c(e,i)}catch(t){await vc(e,t)}Ic(e)&&Ec(e)}function bc(t){return gc(t)&&t.$u.length<10}function _c(t,e){t.$u.push(e);const n=Ac(t);n.Xc()&&n.Tu&&n.Iu(e.mutations)}function Ic(t){return gc(t)&&!Ac(t).Yc()&&t.$u.length>0}function Ec(t){Ac(t).start()}async function Tc(t,e){const n=Or(t);e?(n.Bu.delete(2),await ac(n)):e||(n.Bu.add(2),await uc(n),n.Qu.set("Unknown"))}function Sc(t){return t.Ju||(t.Ju=function(t,e,n){const r=Or(t);return r.Vu(),new nc(e,r.Gc,r.credentials,r.serializer,n)}(t.Ou,t.di,{lu:async function(t){t.Lu.forEach((e,n)=>{lc(t,e)})}.bind(null,t),ou:async function(t,e){mc(t),pc(t)?(t.Qu.xu(e),dc(t)):t.Qu.set("Unknown")}.bind(null,t),fu:async function(t,e,n){if(t.Qu.set("Online"),e instanceof Li&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Lu.has(r)&&(await t.Fu.ju(r,n),t.Lu.delete(r),t.Wu.removeTarget(r))}(t,e)}catch(n){Er("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await vc(t,n)}else if(e instanceof Pi?t.Wu.$e(e):e instanceof Ci?t.Wu.je(e):t.Wu.qe(e),!n.isEqual(zr.min()))try{const r=await Wu(t.ku);n.D(r)>=0&&await function(t,e){const n=t.Wu.He(e);return n.re.forEach((n,r)=>{if(n.resumeToken.ht()>0){const i=t.Lu.get(r);i&&t.Lu.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(e=>{const n=t.Lu.get(e);if(!n)return;t.Lu.set(e,n.wt(si.lt,n.ft)),fc(t,e);const r=new oi(n.target,e,1,n.sequenceNumber);lc(t,r)}),t.Fu.Gu(n)}(t,n)}catch(e){Er("RemoteStore","Failed to raise snapshot:",e),await vc(t,e)}}.bind(null,t)}),t.qu.push(async e=>{e?(t.Ju.tu(),pc(t)?dc(t):t.Qu.set("Unknown")):(await t.Ju.stop(),mc(t))})),t.Ju}function Ac(t){return t.Yu||(t.Yu=function(t,e,n){const r=Or(t);return r.Vu(),new rc(e,r.Gc,r.credentials,r.serializer,n)}(t.Ou,t.di,{lu:async function(t){Ac(t).Ru()}.bind(null,t),ou:async function(t,e){e&&Ac(t).Tu&&await async function(t,e){if(hi(n=e.code)&&n!==Rr.ABORTED){const n=t.$u.shift();Ac(t).tu(),await yc(t,()=>t.Fu.Hu(n.batchId,e)),await wc(t)}var n}(t,e),Ic(t)&&Ec(t)}.bind(null,t),Au:async function(t){const e=Ac(t);for(const n of t.$u)e.Iu(n.mutations)}.bind(null,t),mu:async function(t,e,n){const r=t.$u.shift(),i=Qo.from(r,e,n);await yc(t,()=>t.Fu.zu(i)),await wc(t)}.bind(null,t)}),t.qu.push(async e=>{e?(t.Yu.tu(),await wc(t)):(await t.Yu.stop(),t.$u.length>0&&(Er("RemoteStore",`Stopping write stream with ${t.$u.length} pending writes`),t.$u=[]))})),t.Yu}class kc{constructor(){this.Xu=void 0,this.listeners=[]}}class Nc{constructor(){this.queries=new Zo(t=>Do(t),Ro),this.onlineState="Unknown",this.Zu=new Set}}async function Oc(t,e){const n=Or(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new kc),i)try{s.Xu=await n.ta(r)}catch(t){const n=Ta(t,`Initialization of query '${Po(e.query)}' failed`);return void e.onError(n)}n.queries.set(r,s),s.listeners.push(e),e.ea(n.onlineState),s.Xu&&e.na(s.Xu)&&Dc(n)}async function Rc(t,e){const n=Or(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.sa(r)}function Dc(t){t.Zu.forEach(t=>{t.next()})}class Pc{constructor(t,e,n){this.query=t,this.ia=e,this.ra=!1,this.oa=null,this.onlineState="Unknown",this.options=n||{}}na(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Oi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}let e=!1;return this.ra?this.ca(t)&&(this.ia.next(t),e=!0):this.ua(t,this.onlineState)&&(this.aa(t),e=!0),this.oa=t,e}onError(t){this.ia.error(t)}ea(t){this.onlineState=t;let e=!1;return this.oa&&!this.ra&&this.ua(this.oa,t)&&(this.aa(this.oa),e=!0),e}ua(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options.ha&&n||t.docs.q()&&"Offline"!==e)}ca(t){if(t.docChanges.length>0)return!0;const e=this.oa&&this.oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges}aa(t){t=Oi.ie(t.query,t.docs,t.ee,t.fromCache),this.ra=!0,this.ia.next(t)}}class Cc{constructor(){this.la=new gi(Lc._a),this.fa=new gi(Lc.da)}q(){return this.la.q()}ko(t,e){const n=new Lc(t,e);this.la=this.la.add(n),this.fa=this.fa.add(n)}wa(t,e){t.forEach(t=>this.ko(t,e))}Fo(t,e){this.Ea(new Lc(t,e))}Ta(t,e){t.forEach(t=>this.Fo(t,e))}Ia(t){const e=new Kr(new Hr([])),n=new Lc(e,t),r=new Lc(e,t+1),i=[];return this.fa.Qt([n,r],t=>{this.Ea(t),i.push(t.key)}),i}ma(){this.la.forEach(t=>this.Ea(t))}Ea(t){this.la=this.la.delete(t),this.fa=this.fa.delete(t)}Aa(t){const e=new Kr(new Hr([])),n=new Lc(e,t),r=new Lc(e,t+1);let i=Ti();return this.fa.Qt([n,r],t=>{i=i.add(t.key)}),i}zr(t){const e=new Lc(t,0),n=this.la.jt(e);return null!==n&&t.isEqual(n.key)}}class Lc{constructor(t,e){this.key=t,this.Ra=e}static _a(t,e){return Kr.k(t.key,e.key)||Fr(t.Ra,e.Ra)}static da(t,e){return Fr(t.Ra,e.Ra)||Kr.k(t.key,e.key)}}function xc(t,e){return`firestore_clients_${t}_${e}`}function Mc(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.t()&&(r+="_"+e.uid),r}function Uc(t,e){return`firestore_targets_${t}_${e}`}class Vc{constructor(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}static Pa(t,e,n){const r=JSON.parse(n);let i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),s=void 0;return i&&r.error&&((i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(s=new Dr(r.error.code,r.error.message))),i?new Vc(t,e,r.state,s):(Tr("SharedClientState",`Failed to parse mutation state for ID '${e}': ${n}`),null)}Va(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Fc{constructor(t,e,n){this.targetId=t,this.state=e,this.error=n}static Pa(t,e){const n=JSON.parse(e);let r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&((r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Dr(n.error.code,n.error.message))),r?new Fc(t,n.state,i):(Tr("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}Va(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class jc{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Pa(t,e){const n=JSON.parse(e);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ai();for(let t=0;r&&t<n.activeTargetIds.length;++t)r=Zr(n.activeTargetIds[t]),i=i.add(n.activeTargetIds[t]);return r?new jc(t,i):(Tr("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class qc{constructor(t,e){this.clientId=t,this.onlineState=e}static Pa(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new qc(e.clientId,e.onlineState):(Tr("SharedClientState","Failed to parse online state: "+t),null)}}class Bc{constructor(){this.activeTargetIds=Ai()}ga(t){this.activeTargetIds=this.activeTargetIds.add(t)}ya(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Va(){const t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class zc{constructor(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.pa=r,this.ba=null,this.pu=null,this.ps=null,this.va=this.Sa.bind(this),this.Da=new fi(Fr),this.lr=!1,this.Ca=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Na=xc(this.persistenceKey,this.pa),this.xa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Da=this.Da.Tt(this.pa,new Bc),this.Ma=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.ka=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Oa=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Fa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.$a=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.va)}static Gs(t){return!(!t||!t.localStorage)}async start(){const t=await this.ba.Vc();for(const e of t){if(e===this.pa)continue;const t=this.getItem(xc(this.persistenceKey,e));if(t){const n=jc.Pa(e,t);n&&(this.Da=this.Da.Tt(n.clientId,n))}}this.La();const e=this.storage.getItem(this.Fa);if(e){const t=this.Ba(e);t&&this.qa(t)}for(const t of this.Ca)this.Sa(t);this.Ca=[],this.window.addEventListener("unload",()=>this.Ic()),this.lr=!0}Ss(t){this.setItem(this.xa,JSON.stringify(t))}Ua(){return this.Ka(this.Da)}Qa(t){let e=!1;return this.Da.forEach((n,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}Wa(t){this.ja(t,"pending")}Ga(t,e,n){this.ja(t,e,n),this.za(t)}Ha(t){let e="not-current";if(this.Qa(t)){const n=this.storage.getItem(Uc(this.persistenceKey,t));if(n){const r=Fc.Pa(t,n);r&&(e=r.state)}}return this.Ja.ga(t),this.La(),e}Ya(t){this.Ja.ya(t),this.La()}Xa(t){return this.Ja.activeTargetIds.has(t)}Za(t){this.removeItem(Uc(this.persistenceKey,t))}th(t,e,n){this.eh(t,e,n)}nh(t,e,n){e.forEach(t=>{this.za(t)}),this.currentUser=t,n.forEach(t=>{this.Wa(t)})}sh(t){this.ih(t)}rh(){this.oh()}Ic(){this.lr&&(this.window.removeEventListener("storage",this.va),this.removeItem(this.Na),this.lr=!1)}getItem(t){const e=this.storage.getItem(t);return Er("SharedClientState","READ",t,e),e}setItem(t,e){Er("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){Er("SharedClientState","REMOVE",t),this.storage.removeItem(t)}Sa(t){const e=t;if(e.storageArea===this.storage){if(Er("SharedClientState","EVENT",e.key,e.newValue),e.key===this.Na)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Oi(async()=>{if(this.lr){if(null!==e.key)if(this.Ma.test(e.key)){if(null==e.newValue){const t=this.uh(e.key);return this.ah(t,null)}{const t=this.hh(e.key,e.newValue);if(t)return this.ah(t.clientId,t)}}else if(this.ka.test(e.key)){if(null!==e.newValue){const t=this.lh(e.key,e.newValue);if(t)return this._h(t)}}else if(this.Oa.test(e.key)){if(null!==e.newValue){const t=this.fh(e.key,e.newValue);if(t)return this.dh(t)}}else if(e.key===this.Fa){if(null!==e.newValue){const t=this.Ba(e.newValue);if(t)return this.qa(t)}}else if(e.key===this.xa){const t=function(t){let e=ca.Ds;if(null!=t)try{const n=JSON.parse(t);Nr("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(e.newValue);t!==ca.Ds&&this.ps(t)}else if(e.key===this.$a)return this.ba.wh()}else this.Ca.push(e)})}}get Ja(){return this.Da.get(this.pa)}La(){this.setItem(this.Na,this.Ja.Va())}ja(t,e,n){const r=new Vc(this.currentUser,t,e,n),i=Mc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Va())}za(t){const e=Mc(this.persistenceKey,this.currentUser,t);this.removeItem(e)}ih(t){const e={clientId:this.pa,onlineState:t};this.storage.setItem(this.Fa,JSON.stringify(e))}eh(t,e,n){const r=Uc(this.persistenceKey,t),i=new Fc(t,e,n);this.setItem(r,i.Va())}oh(){this.setItem(this.$a,"value-not-used")}uh(t){const e=this.Ma.exec(t);return e?e[1]:null}hh(t,e){const n=this.uh(t);return jc.Pa(n,e)}lh(t,e){const n=this.ka.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Vc.Pa(new br(i),r,e)}fh(t,e){const n=this.Oa.exec(t),r=Number(n[1]);return Fc.Pa(r,e)}Ba(t){return qc.Pa(t)}async _h(t){if(t.user.uid===this.currentUser.uid)return this.ba.Eh(t.batchId,t.state,t.error);Er("SharedClientState","Ignoring mutation for non-active user "+t.user.uid)}dh(t){return this.ba.Th(t.targetId,t.state,t.error)}ah(t,e){const n=e?this.Da.Tt(t,e):this.Da.remove(t),r=this.Ka(this.Da),i=this.Ka(n),s=[],o=[];return i.forEach(t=>{r.has(t)||s.push(t)}),r.forEach(t=>{i.has(t)||o.push(t)}),this.ba.Ih(s,o).then(()=>{this.Da=n})}qa(t){this.Da.get(t.clientId)&&this.pu(t.onlineState)}Ka(t){let e=Ai();return t.forEach((t,n)=>{e=e.Gt(n.activeTargetIds)}),e}}class Gc{constructor(){this.mh=new Bc,this.Ah={},this.pu=null,this.ps=null}Wa(t){}Ga(t,e,n){}Ha(t){return this.mh.ga(t),this.Ah[t]||"not-current"}th(t,e,n){this.Ah[t]=e}Ya(t){this.mh.ya(t)}Xa(t){return this.mh.activeTargetIds.has(t)}Za(t){delete this.Ah[t]}Ua(){return this.mh.activeTargetIds}Qa(t){return this.mh.activeTargetIds.has(t)}start(){return this.mh=new Bc,Promise.resolve()}nh(t,e,n){}sh(t){}Ic(){}Ss(t){}rh(){}}class Hc{constructor(t){this.key=t}}class $c{constructor(t){this.key=t}}class Wc{constructor(t,e){this.query=t,this.Rh=e,this.Ph=null,this.le=!1,this.Vh=Ti(),this.ee=Ti(),this.gh=Lo(t),this.yh=new ki(this.gh)}get ph(){return this.Rh}bh(t,e){const n=e?e.Sh:new Ni,r=e?e.yh:this.yh;let i=e?e.ee:this.ee,s=r,o=!1;const a=Io(this.query)&&r.size===this.query.limit?r.last():null,u=Eo(this.query)&&r.size===this.query.limit?r.first():null;if(t.Pt((t,e)=>{const c=r.get(t);let h=e instanceof mo?e:null;h&&(h=Co(this.query,h)?h:null);const l=!!c&&this.ee.has(c.key),f=!!h&&(h.an||this.ee.has(h.key)&&h.hasCommittedMutations);let d=!1;c&&h?c.data().isEqual(h.data())?l!==f&&(n.track({type:3,doc:h}),d=!0):this.Dh(c,h)||(n.track({type:2,doc:h}),d=!0,(a&&this.gh(h,a)>0||u&&this.gh(h,u)<0)&&(o=!0)):!c&&h?(n.track({type:0,doc:h}),d=!0):c&&!h&&(n.track({type:1,doc:c}),d=!0,(a||u)&&(o=!0)),d&&(h?(s=s.add(h),i=f?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))}),Io(this.query)||Eo(this.query))for(;s.size>this.query.limit;){const t=Io(this.query)?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{yh:s,Sh:n,vr:o,ee:i}}Dh(t,e){return t.an&&e.hasCommittedMutations&&!e.an}Zn(t,e,n){const r=this.yh;this.yh=t.yh,this.ee=t.ee;const i=t.Sh.Zt();i.sort((t,e)=>(function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}};return n(t)-n(e)})(t.type,e.type)||this.gh(t.doc,e.doc)),this.Ch(n);const s=e?this.Nh():[],o=0===this.Vh.size&&this.le?1:0,a=o!==this.Ph;return this.Ph=o,0!==i.length||a?{snapshot:new Oi(this.query,t.yh,r,i,t.ee,0===o,a,!1),xh:s}:{xh:s}}ea(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({yh:this.yh,Sh:new Ni,ee:this.ee,vr:!1},!1)):{xh:[]}}Mh(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).an}Ch(t){t&&(t._e.forEach(t=>this.Rh=this.Rh.add(t)),t.fe.forEach(t=>{}),t.de.forEach(t=>this.Rh=this.Rh.delete(t)),this.le=t.le)}Nh(){if(!this.le)return[];const t=this.Vh;this.Vh=Ti(),this.yh.forEach(t=>{this.Mh(t.key)&&(this.Vh=this.Vh.add(t.key))});const e=[];return t.forEach(t=>{this.Vh.has(t)||e.push(new $c(t))}),this.Vh.forEach(n=>{t.has(n)||e.push(new Hc(n))}),e}kh(t){this.Rh=t.Qc,this.Vh=Ti();const e=this.bh(t.documents);return this.Zn(e,!0)}Oh(){return Oi.ie(this.query,this.yh,this.ee,0===this.Ph)}}class Kc{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Yc{constructor(t){this.key=t,this.Fh=!1}}class Xc{constructor(t,e,n,r,i,s){this.ku=t,this.$h=e,this.Lh=n,this.Bh=r,this.currentUser=i,this.qh=s,this.Uh={},this.Kh=new Zo(t=>Do(t),Ro),this.Qh=new Map,this.Wh=[],this.jh=new fi(Kr.k),this.Gh=new Map,this.zh=new Cc,this.Hh={},this.Jh=new Map,this.Yh=Du.Io(),this.onlineState="Unknown",this.Xh=void 0}get Zh(){return!0===this.Xh}}async function Jc(t,e,n,r){t.tl=((e,n,r)=>(async function(t,e,n,r){let i=e.view.bh(n);i.vr&&(i=await Ju(t.ku,e.query,!1).then(({documents:t})=>e.view.bh(t,i)));const s=r&&r.re.get(e.targetId),o=e.view.Zn(i,t.Zh,s);return sh(t,e.targetId,o.xh),o.snapshot})(t,e,n,r));const i=await Ju(t.ku,e,!0),s=new Wc(e,i.Qc),o=s.bh(i.documents),a=Di.he(n,r&&"Offline"!==t.onlineState),u=s.Zn(o,t.Zh,a);sh(t,n,u.xh);const c=new Kc(e,n,s);return t.Kh.set(e,c),t.Qh.has(n)?t.Qh.get(n).push(e):t.Qh.set(n,[e]),u.snapshot}async function Qc(t,e){const n=Or(t);try{const r=await function(t,e){const n=Or(t),r=e.ft;let i=n.Oc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const s=n.Lc.io({ro:!0});i=n.Oc;const o=[];e.re.forEach((e,s)=>{const a=i.get(s);if(!a)return;o.push(n.Yo.Oo(t,e.de,s).next(()=>n.Yo.Mo(t,e._e,s)));const u=e.resumeToken;if(u.ht()>0){const c=a.wt(u,r).dt(t.Lo);i=i.Tt(s,c),function(t,e,n){return Nr(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.C()-t.ft.C()>=3e8||n._e.size+n.fe.size+n.de.size>0}(a,c,e)&&o.push(n.Yo.So(t,c))}});let a=yi();if(e.ce.forEach((r,i)=>{e.ue.has(r)&&o.push(n.persistence.Dr.Mc(t,r))}),o.push(function(t,e,n,r,i){let s=Ti();return n.forEach(t=>s=s.add(t)),e.getEntries(t,s).next(t=>{let i=yi();return n.forEach((n,s)=>{const o=t.get(n),a=r;s instanceof vo&&s.version.isEqual(zr.min())?(e.Hn(n,a),i=i.Tt(n,s)):null==o||s.version.D(o.version)>0||0===s.version.D(o.version)&&o.hasPendingWrites?(e.jn(s,a),i=i.Tt(n,s)):Er("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),i})}(t,s,e.ce,r).next(t=>{a=t})),!r.isEqual(zr.min())){const e=n.Yo.Po(t).next(e=>n.Yo.yo(t,t.Lo,r));o.push(e)}return ta.qn(o).next(()=>s.apply(t)).next(()=>n.Bc.fs(t,a))}).then(t=>(n.Oc=i,t))}(n.ku,e);e.re.forEach((t,e)=>{const r=n.Gh.get(e);r&&(Nr(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?Nr(r.Fh):t.de.size>0&&(Nr(r.Fh),r.Fh=!1))}),await uh(n,r,e)}catch(t){await tc(t)}}function Zc(t,e,n){const r=Or(t);if(r.Zh&&0===n||!r.Zh&&1===n){const t=[];r.Kh.forEach((n,r)=>{const i=r.view.ea(e);i.snapshot&&t.push(i.snapshot)}),function(t,e){const n=Or(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const t of n.listeners)t.ea(e)&&(r=!0)}),r&&Dc(n)}(r.Lh,e),t.length&&r.Uh.fu(t),r.onlineState=e,r.Zh&&r.Bh.sh(e)}}async function th(t,e){const n=Or(t),r=e.batch.batchId;try{const i=await function(t,e){const n=Or(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const r=e.batch.keys(),i=n.Lc.io({ro:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=ta.resolve();return s.forEach(t=>{o=o.next(()=>r.Jn(e,t)).next(e=>{let s=e;const o=n.Sn.get(t);Nr(null!==o),(!s||s.version.D(o)<0)&&(s=i.gn(t,s,n))&&r.jn(s,n.vn)})}),o.next(()=>t.rs.Kr(e,i))}(n,t,e,i).next(()=>i.apply(t)).next(()=>n.rs.Gr(t)).next(()=>n.Bc._s(t,r))})}(n.ku,e);nh(n,r,null),eh(n,r),n.Bh.Ga(r,"acknowledged"),await uh(n,i)}catch(t){await tc(t)}}function eh(t,e){(t.Jh.get(e)||[]).forEach(t=>{t.resolve()}),t.Jh.delete(e)}function nh(t,e,n){const r=Or(t);let i=r.Hh[r.currentUser.i()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Hh[r.currentUser.i()]=i}}function rh(t,e,n=null){t.Bh.Ya(e);for(const r of t.Qh.get(e))t.Kh.delete(r),n&&t.Uh.el(r,n);t.Qh.delete(e),t.Zh&&t.zh.Ia(e).forEach(e=>{t.zh.zr(e)||ih(t,e)})}function ih(t,e){const n=t.jh.get(e);null!==n&&(hc(t.$h,n),t.jh=t.jh.remove(e),t.Gh.delete(n),ah(t))}function sh(t,e,n){for(const r of n)r instanceof Hc?(t.zh.ko(r.key,e),oh(t,r)):r instanceof $c?(Er("SyncEngine","Document no longer in limbo: "+r.key),t.zh.Fo(r.key,e),t.zh.zr(r.key)||ih(t,r.key)):kr()}function oh(t,e){const n=e.key;t.jh.get(n)||(Er("SyncEngine","New document in limbo: "+n),t.Wh.push(n),ah(t))}function ah(t){for(;t.Wh.length>0&&t.jh.size<t.qh;){const e=t.Wh.shift(),n=t.Yh.next();t.Gh.set(n,new Yc(e)),t.jh=t.jh.Tt(e,n),cc(t.$h,new oi(No(_o(e.path)),n,2,ca.Ds))}}async function uh(t,e,n){const r=Or(t),i=[],s=[],o=[];r.Kh.q()||(r.Kh.forEach((t,a)=>{o.push(r.tl(a,e,n).then(t=>{if(t){r.Zh&&r.Bh.th(a.targetId,t.fromCache?"not-current":"current"),i.push(t);const e=ua.ys(a.targetId,t);s.push(e)}}))}),await Promise.all(o),r.Uh.fu(i),await async function(t,e){const n=Or(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>ta.forEach(e,e=>ta.forEach(e.Vs,r=>n.persistence.Dr.ko(t,e.targetId,r)).next(()=>ta.forEach(e.gs,r=>n.persistence.Dr.Fo(t,e.targetId,r)))))}catch(t){if(!pa(t))throw t;Er("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Oc.get(e),r=t.ft,i=t.Et(r);n.Oc=n.Oc.Tt(e,i)}}}(r.ku,s))}async function ch(t,e){const n=Or(t),r=await Ju(n.ku,e.query,!0),i=e.view.kh(r);return n.Zh&&sh(n,e.targetId,i.xh),i}async function hh(t,e,n){const r=Or(t),i=[],s=[];for(const t of e){let e;const n=r.Qh.get(t);if(n&&0!==n.length){e=await Yu(r.ku,No(n[0]));for(const t of n){const e=r.Kh.get(t),n=await ch(r,e);n.snapshot&&s.push(n.snapshot)}}else{const n=await Qu(r.ku,t);e=await Yu(r.ku,n),await Jc(r,lh(n),t,!1)}i.push(e)}return r.Uh.fu(s),i}function lh(t){return bo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function fh(t){const e=Or(t);return e.$h.Fu.Gu=Qc.bind(null,e),e.$h.Fu.Xe=function(t,e){const n=Or(t),r=n.Gh.get(e);if(r&&r.Fh)return Ti().add(r.key);{let t=Ti();const r=n.Qh.get(e);if(!r)return t;for(const e of r){const r=n.Kh.get(e);t=t.Gt(r.view.ph)}return t}}.bind(null,e),e.$h.Fu.ju=async function(t,e,n){const r=Or(t);r.Bh.th(e,"rejected",n);const i=r.Gh.get(e),s=i&&i.key;if(s){let t=new fi(Kr.k);t=t.Tt(s,new vo(s,zr.min()));const n=Ti().add(s),i=new Ri(zr.min(),new Map,new gi(Fr),t,n);await Qc(r,i),r.jh=r.jh.remove(s),r.Gh.delete(e),ah(r)}else await Xu(r.ku,e,!1).then(()=>rh(r,e,n)).catch(tc)}.bind(null,e),e.Uh.fu=function(t,e){const n=Or(t);let r=!1;for(const t of e){const e=t.query,i=n.queries.get(e);if(i){for(const e of i.listeners)e.na(t)&&(r=!0);i.Xu=t}}r&&Dc(n)}.bind(null,e.Lh),e.Uh.el=function(t,e,n){const r=Or(t),i=r.queries.get(e);if(i)for(const t of i.listeners)t.onError(n);r.queries.delete(e)}.bind(null,e.Lh),e}function dh(t){const e=Or(t);return e.$h.Fu.zu=th.bind(null,e),e.$h.Fu.Hu=async function(t,e,n){const r=Or(t);try{const t=await function(t,e){const n=Or(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let r;return n.rs.Fr(t,e).next(e=>(Nr(null!==e),r=e.keys(),n.rs.Kr(t,e))).next(()=>n.rs.Gr(t)).next(()=>n.Bc._s(t,r))})}(r.ku,e);nh(r,e,n),eh(r,e),r.Bh.Ga(e,"rejected",n),await uh(r,t)}catch(n){await tc(n)}}.bind(null,e),e}class ph{constructor(t,e){this.os=t,this.Dr=e,this.rs=[],this.nl=1,this.sl=new gi(Lc._a)}Mr(t){return ta.resolve(0===this.rs.length)}kr(t,e,n,r){const i=this.nl;this.nl++,this.rs.length>0&&this.rs[this.rs.length-1];const s=new Jo(i,e,n,r);this.rs.push(s);for(const e of r)this.sl=this.sl.add(new Lc(e.key,i)),this.os.Or(t,e.key.path.$());return ta.resolve(s)}Fr(t,e){return ta.resolve(this.il(e))}Lr(t,e){const n=e+1,r=this.rl(n),i=r<0?0:r;return ta.resolve(this.rs.length>i?this.rs[i]:null)}Br(){return ta.resolve(0===this.rs.length?-1:this.nl-1)}qr(t){return ta.resolve(this.rs.slice())}us(t,e){const n=new Lc(e,0),r=new Lc(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Qt([n,r],t=>{const e=this.il(t.Ra);i.push(e)}),ta.resolve(i)}ds(t,e){let n=new gi(Fr);return e.forEach(t=>{const e=new Lc(t,0),r=new Lc(t,Number.POSITIVE_INFINITY);this.sl.Qt([e,r],t=>{n=n.add(t.Ra)})}),ta.resolve(this.ol(n))}Rs(t,e){const n=e.path,r=n.length+1;let i=n;Kr.st(i)||(i=i.child(""));const s=new Lc(new Kr(i),0);let o=new gi(Fr);return this.sl.Wt(t=>{const e=t.key.path;return!!n.U(e)&&(e.length===r&&(o=o.add(t.Ra)),!0)},s),ta.resolve(this.ol(o))}ol(t){const e=[];return t.forEach(t=>{const n=this.il(t);null!==n&&e.push(n)}),e}Kr(t,e){Nr(0===this.cl(e.batchId,"removed")),this.rs.shift();let n=this.sl;return ta.forEach(e.mutations,r=>{const i=new Lc(r.key,e.batchId);return n=n.delete(i),this.Dr.jr(t,r.key)}).next(()=>{this.sl=n})}Wr(t){}zr(t,e){const n=new Lc(e,0),r=this.sl.jt(n);return ta.resolve(e.isEqual(r&&r.key))}Gr(t){return this.rs.length,ta.resolve()}cl(t,e){return this.rl(t)}rl(t){return 0===this.rs.length?0:t-this.rs[0].batchId}il(t){const e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]}}class gh{constructor(t,e){this.os=t,this.ul=e,this.docs=new fi(Kr.k),this.size=0}jn(t,e,n){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:o,readTime:n}),this.size+=o-s,this.os.Or(t,r.path.$())}Hn(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}Jn(t,e){const n=this.docs.get(e);return ta.resolve(n?n.zn:null)}getEntries(t,e){let n=wi();return e.forEach(t=>{const e=this.docs.get(t);n=n.Tt(t,e?e.zn:null)}),ta.resolve(n)}ws(t,e,n){let r=_i();const i=new Kr(e.path.child("")),s=this.docs.yt(i);for(;s.Nt();){const{key:t,value:{zn:i,readTime:o}}=s.Ct();if(!e.path.U(t.path))break;o.D(n)<=0||i instanceof mo&&Co(e,i)&&(r=r.Tt(i.key,i))}return ta.resolve(r)}al(t,e){return ta.forEach(this.docs,t=>e(t))}io(t){return new mh(this)}oo(t){return ta.resolve(this.size)}}class mh extends ea{constructor(t){super(),this.co=t}Zn(t){const e=[];return this.Kn.forEach((n,r)=>{r&&r.zn?e.push(this.co.jn(t,r.zn,this.Wn(n))):this.co.Hn(n)}),ta.qn(e)}Yn(t,e){return this.co.Jn(t,e)}Xn(t,e){return this.co.getEntries(t,e)}}class vh{constructor(t){this.persistence=t,this.hl=new Zo(t=>ni(t),ri),this.lastRemoteSnapshotVersion=zr.min(),this.highestTargetId=0,this.ll=0,this._l=new Cc,this.targetCount=0,this.fl=Du.To()}Ue(t,e){return this.hl.forEach((t,n)=>e(n)),ta.resolve()}Po(t){return ta.resolve(this.lastRemoteSnapshotVersion)}Vo(t){return ta.resolve(this.ll)}mo(t){return this.highestTargetId=this.fl.next(),ta.resolve(this.highestTargetId)}yo(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),ta.resolve()}bo(t){this.hl.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.fl=new Du(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)}po(t,e){return this.bo(e),this.targetCount+=1,ta.resolve()}So(t,e){return this.bo(e),ta.resolve()}Do(t,e){return this.hl.delete(e.target),this._l.Ia(e.targetId),this.targetCount-=1,ta.resolve()}mr(t,e,n){let r=0;const i=[];return this.hl.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.hl.delete(s),i.push(this.Co(t,o.targetId)),r++)}),ta.qn(i).next(()=>r)}No(t){return ta.resolve(this.targetCount)}xo(t,e){const n=this.hl.get(e)||null;return ta.resolve(n)}Mo(t,e,n){return this._l.wa(e,n),ta.resolve()}Oo(t,e,n){this._l.Ta(e,n);const r=this.persistence.Dr,i=[];return r&&e.forEach(e=>{i.push(r.jr(t,e))}),ta.qn(i)}Co(t,e){return this._l.Ia(e),ta.resolve()}$o(t,e){const n=this._l.Aa(e);return ta.resolve(n)}zr(t,e){return ta.resolve(this._l.zr(e))}}class yh{constructor(t){this.serializer=t,this.dl=new Map,this.wl=new Map}ho(t,e){return ta.resolve(this.dl.get(e))}lo(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:ps(n.createTime)}),ta.resolve()}_o(t,e){return ta.resolve(this.wl.get(e))}fo(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:$a(n.bundledQuery),readTime:ps(n.readTime)}),ta.resolve()}}class wh{constructor(t,e){this.El={},this.Uo=new ca(0),this.Ko=!1,this.Ko=!0,this.Dr=t(this),this.Yo=new vh(this),this.os=new su,this.ss=function(t,e){return new gh(t,e)}(this.os,t=>this.Dr.Tl(t)),this.serializer=new Ma(e),this.Xo=new yh(this.serializer)}start(){return Promise.resolve()}Ic(){return this.Ko=!1,Promise.resolve()}get lr(){return this.Ko}rc(){}oc(){}vc(){return this.os}gc(t){let e=this.El[t.i()];return e||(e=new ph(this.os,this.Dr),this.El[t.i()]=e),e}yc(){return this.Yo}bc(){return this.ss}Sc(){return this.Xo}runTransaction(t,e,n){Er("MemoryPersistence","Starting transaction:",t);const r=new bh(this.Uo.next());return this.Dr.Il(),n(r).next(t=>this.Dr.ml(r).next(()=>t)).Ln().then(t=>(r.ns(),t))}Al(t,e){return ta.Un(Object.values(this.El).map(n=>()=>n.zr(t,e)))}}class bh extends oa{constructor(t){super(),this.Lo=t}}class _h{constructor(t){this.persistence=t,this.Rl=new Cc,this.Pl=null}static Vl(t){return new _h(t)}get gl(){if(this.Pl)return this.Pl;throw kr()}ko(t,e,n){return this.Rl.ko(n,e),this.gl.delete(n.toString()),ta.resolve()}Fo(t,e,n){return this.Rl.Fo(n,e),this.gl.add(n.toString()),ta.resolve()}jr(t,e){return this.gl.add(e.toString()),ta.resolve()}removeTarget(t,e){this.Rl.Ia(e.targetId).forEach(t=>this.gl.add(t.toString()));const n=this.persistence.yc();return n.$o(t,e.targetId).next(t=>{t.forEach(t=>this.gl.add(t.toString()))}).next(()=>n.Do(t,e))}Il(){this.Pl=new Set}ml(t){const e=this.persistence.bc().io();return ta.forEach(this.gl,n=>{const r=Kr.tt(n);return this.yl(t,r).next(t=>{t||e.Hn(r)})}).next(()=>(this.Pl=null,e.apply(t)))}Mc(t,e){return this.yl(t,e).next(t=>{t?this.gl.delete(e.toString()):this.gl.add(e.toString())})}Tl(t){return 0}yl(t,e){return ta.Un([()=>ta.resolve(this.Rl.zr(e)),()=>this.persistence.yc().zr(t,e),()=>this.persistence.Al(t,e)])}}class Ih{constructor(t){this.pl=t.pl,this.bl=t.bl}lu(t){this.vl=t}ou(t){this.Sl=t}onMessage(t){this.Dl=t}close(){this.bl()}send(t){this.pl(t)}Cl(){this.vl()}Nl(t){this.Sl(t)}xl(t){this.Dl(t)}}const Eh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Th extends class{constructor(t){this.Ml=t,this.rt=t.rt;const e=t.ssl?"https":"http";this.kl=e+"://"+t.host,this.Ol="projects/"+this.rt.projectId+"/databases/"+this.rt.database+"/documents"}gu(t,e,n,r){const i=this.Fl(t,e);Er("RestConnection","Sending: ",i,n);const s={};return this.$l(s,r),this.Ll(t,i,s,n).then(t=>(Er("RestConnection","Received: ",t),t),e=>{throw Sr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})}yu(t,e,n,r){return this.gu(t,e,n,r)}$l(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(const n in e.h)e.h.hasOwnProperty(n)&&(t[n]=e.h[n])}Fl(t,e){const n=Eh[t];return`${this.kl}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.ot=t.ot}Ll(t,e,n,r){return new Promise((i,s)=>{const o=new wr;o.listenOnce(gr.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case pr.NO_ERROR:const e=o.getResponseJson();Er("Connection","XHR received:",JSON.stringify(e)),i(e);break;case pr.TIMEOUT:Er("Connection",'RPC "'+t+'" timed out'),s(new Dr(Rr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:const n=o.getStatus();if(Er("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Rr).indexOf(e)>=0?e:Rr.UNKNOWN}(t.status);s(new Dr(e,t.message))}else s(new Dr(Rr.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Dr(Rr.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Er("Connection",'RPC "'+t+'" completed.')}});const a=JSON.stringify(r);o.send(e,"POST",a,n,15)})}_u(t,e){const n=[this.kl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=fr(),s=dr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.rt.projectId}/databases/${this.rt.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.ot};var a,u;this.$l(o.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(r())||"object"==typeof navigator&&"ReactNative"===navigator.product||r().indexOf("Electron/")>=0||((u=r()).indexOf("MSIE ")>=0||u.indexOf("Trident/")>=0)||r().indexOf("MSAppHost/")>=0||"object"==typeof(a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==a.id||(o.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");Er("Connection","Creating WebChannel: "+c,o);const h=i.createWebChannel(c,o);let l=!1,f=!1;const d=new Ih({pl:t=>{f?Er("Connection","Not sending because WebChannel is closed:",t):(l||(Er("Connection","Opening WebChannel transport."),h.open(),l=!0),Er("Connection","WebChannel sending:",t),h.send(t))},bl:()=>h.close()}),p=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return p(h,yr.EventType.OPEN,()=>{f||Er("Connection","WebChannel transport opened.")}),p(h,yr.EventType.CLOSE,()=>{f||(f=!0,Er("Connection","WebChannel transport closed"),d.Nl())}),p(h,yr.EventType.ERROR,t=>{f||(f=!0,Sr("Connection","WebChannel transport errored:",t),d.Nl(new Dr(Rr.UNAVAILABLE,"The operation could not be completed")))}),p(h,yr.EventType.MESSAGE,t=>{var e;if(!f){const n=t.data[0];Nr(!!n);const r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Er("Connection","WebChannel received error:",i);const t=i.status;let e=function(t){const e=ui[t];if(void 0!==e)return li(e)}(t),n=i.message;void 0===e&&(e=Rr.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),f=!0,d.Nl(new Dr(e,n)),h.close()}else Er("Connection","WebChannel received:",n),d.xl(n)}}),p(s,mr.STAT_EVENT,t=>{t.stat===vr.PROXY?Er("Connection","Detected buffering proxy"):t.stat===vr.NOPROXY&&Er("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Cl()},0),d}}class Sh{constructor(){this.Bl=(()=>this.ql()),this.Ul=(()=>this.Kl()),this.Ql=[],this.Wl()}Ku(t){this.Ql.push(t)}Ic(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)}Wl(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)}ql(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Ql)t(0)}Kl(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Ql)t(1)}static Gs(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}class Ah{Ku(t){}Ic(){}}class kh{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=ra(t.Ml.rt),this.Bh=this.jl(t),this.persistence=this.Gl(t),await this.persistence.start(),this.zl=this.Hl(t),this.ku=this.Jl(t)}Hl(t){return null}Jl(t){return Hu(this.persistence,new Da,t.Yl,this.serializer)}Gl(t){return new wh(_h.Vl,this.serializer)}jl(t){return new Gc}async terminate(){this.zl&&this.zl.stop(),await this.Bh.Ic(),await this.persistence.Ic()}}class Nh extends kh{constructor(t,e,n){super(),this.Xl=t,this.cacheSizeBytes=e,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await async function(t){const e=Or(t);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>(function(t){const e=nu(t);let n=zr.min();return e._i({index:gu.readTimeIndex,reverse:!0},(t,e,r)=>{e.readTime&&(n=ja(e.readTime)),r.done()}).next(()=>n)})(t)).then(t=>{e.$c=t})}(this.ku),await this.Xl.initialize(this,t),await dh(this.Xl.ba),await wc(this.Xl.$h)}Jl(t){return Hu(this.persistence,new Da,t.Yl,this.serializer)}Hl(t){const e=this.persistence.Dr.cr;return new Oa(e,t.di)}Gl(t){const e=zu(t.Ml.rt,t.Ml.persistenceKey),n=void 0!==this.cacheSizeBytes?Na.er(this.cacheSizeBytes):Na.ir;return new Vu(this.synchronizeTabs,e,t.clientId,n,t.di,ba(),_a(),this.serializer,this.Bh,!!this.forceOwnership)}jl(t){return new Gc}}class Oh extends Nh{constructor(t,e){super(t,e,!1),this.Xl=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}async initialize(t){await super.initialize(t);const e=this.Xl.ba;this.Bh instanceof zc&&(this.Bh.ba={Eh:async function(t,e,n,r){const i=Or(t),s=await function(t,e){const n=Or(t),r=Or(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",t=>r.$r(t,e).next(e=>e?n.Bc._s(t,e):ta.resolve(null)))}(i.ku,e);null!==s?("pending"===n?await wc(i.$h):"acknowledged"===n||"rejected"===n?(nh(i,e,r||null),eh(i,e),function(t,e){Or(Or(t).rs).Wr(e)}(i.ku,e)):kr(),await uh(i,s)):Er("SyncEngine","Cannot apply mutation batch with id: "+e)}.bind(null,e),Th:async function(t,e,n,r){const i=Or(t);if(i.Xh)Er("SyncEngine","Ignoring unexpected query state notification.");else if(i.Qh.has(e))switch(n){case"current":case"not-current":{const t=await Zu(i.ku),r=Ri.ae(e,"current"===n);await uh(i,t,r);break}case"rejected":await Xu(i.ku,e,!0),rh(i,e,r);break;default:kr()}}.bind(null,e),Ih:async function(t,e,n){const r=fh(t);if(r.Xh){for(const t of e){if(r.Qh.has(t)){Er("SyncEngine","Adding an already active target "+t);continue}const e=await Qu(r.ku,t),n=await Yu(r.ku,e);await Jc(r,lh(e),n.targetId,!1),cc(r.$h,n)}for(const t of n)r.Qh.has(t)&&await Xu(r.ku,t,!1).then(()=>{hc(r.$h,t),rh(r,t)}).catch(tc)}}.bind(null,e),Vc:function(t){return Or(Or(Or(t).ku).persistence).Vc()}.bind(null,e),wh:async function(t){const e=Or(t);return Zu(e.ku).then(t=>uh(e,t))}.bind(null,e)},await this.Bh.start()),await this.persistence.ic(async t=>{await async function(t,e){const n=Or(t);if(fh(n),dh(n),!0===e&&!0!==n.Xh){const t=n.Bh.Ua(),e=await hh(n,t.W());n.Xh=!0,await Tc(n.$h,!0);for(const t of e)cc(n.$h,t)}else if(!1===e&&!1!==n.Xh){const t=[];let e=Promise.resolve();n.Qh.forEach((r,i)=>{n.Bh.Xa(i)?t.push(i):e=e.then(()=>(rh(n,i),Xu(n.ku,i,!0))),hc(n.$h,i)}),await e,await hh(n,t),function(t){const e=Or(n);e.Gh.forEach((t,n)=>{hc(e.$h,n)}),e.zh.ma(),e.Gh=new Map,e.jh=new fi(Kr.k)}(),n.Xh=!1,await Tc(n.$h,!1)}}(this.Xl.ba,t),this.zl&&(t&&!this.zl.lr?this.zl.start(this.ku):t||this.zl.stop())})}jl(t){const e=ba();if(!zc.Gs(e))throw new Dr(Rr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=zu(t.Ml.rt,t.Ml.persistenceKey);return new zc(e,t.di,n,t.clientId,t.Yl)}}class Rh{async initialize(t,e){this.ku||(this.ku=t.ku,this.Bh=t.Bh,this.Ou=this.Zl(e),this.$h=this.t_(e),this.Lh=this.e_(e),this.ba=this.n_(e,!t.synchronizeTabs),this.Bh.pu=(t=>Zc(this.ba,t,1)),this.$h.Fu.s_=async function(t,e){const n=Or(t);if(!n.currentUser.isEqual(e)){Er("SyncEngine","User change. New user:",e.i());const t=await $u(n.ku,e);n.currentUser=e,function(t,e){t.Jh.forEach(t=>{t.forEach(t=>{t.reject(new Dr(Rr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Jh.clear()}(n),n.Bh.nh(e,t.Uc,t.Kc),await uh(n,t.qc)}}.bind(null,this.ba),await Tc(this.$h,this.ba.Zh))}e_(t){return new Nc}Zl(t){const e=ra(t.Ml.rt),n=(r=t.Ml,new Th(r));var r;return function(t,e,n){return new ic(t,e,n)}(t.credentials,n,e)}t_(t){return e=this.ku,n=this.Ou,r=t.di,i=(t=>Zc(this.ba,t,0)),s=Sh.Gs()?new Sh:new Ah,new oc(e,n,r,i,s);var e,n,r,i,s}n_(t,e){return function(t,e,n,r,i,s,o){const a=new Xc(t,e,n,r,i,s);return o&&(a.Xh=!0),a}(this.ku,this.$h,this.Lh,this.Bh,t.Yl,t.qh,e)}terminate(){return async function(t){const e=Or(t);Er("RemoteStore","RemoteStore shutting down."),e.Bu.add(5),await uc(e),e.Uu.Ic(),e.Qu.set("Unknown")}(this.$h)}}class Dh{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.i_(this.observer.next,t)}error(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}r_(){this.muted=!0}i_(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}function Ph(t,e,n){if(!n)throw new Dr(Rr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ch(t){if(!Kr.st(t))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Lh(t){if(Kr.st(t))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function xh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":kr()}function Mh(t,e){if("_delegate"in t&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Dr(Rr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xh(t);throw new Dr(Rr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Uh(t,e){if(e<=0)throw new Dr(Rr.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Vh{constructor(t){this._methodName=t}}class Fh extends Vh{c_(t){if(2!==t.u_)throw 1===t.u_?t.a_(this._methodName+"() can only appear at the top level of your update data"):t.a_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null}isEqual(t){return t instanceof Fh}}function jh(t,e,n){return new Ul({u_:3,h_:e.settings.h_,methodName:t._methodName,l_:n},e.rt,e.serializer,e.ignoreUndefinedProperties)}class qh extends Vh{c_(t){return new Ws(t.path,new Vs)}isEqual(t){return t instanceof qh}}class Bh extends Vh{constructor(t,e){super(t),this.__=e}c_(t){const e=jh(this,t,!0),n=this.__.map(t=>zl(t,e)),r=new Fs(n);return new Ws(t.path,r)}isEqual(t){return this===t}}class zh extends Vh{constructor(t,e){super(t),this.__=e}c_(t){const e=jh(this,t,!0),n=this.__.map(t=>zl(t,e)),r=new qs(n);return new Ws(t.path,r)}isEqual(t){return this===t}}class Gh extends Vh{constructor(t,e){super(t),this.f_=e}c_(t){const e=new zs(t.serializer,ls(t.serializer,this.f_));return new Ws(t.path,e)}isEqual(t){return this===t}}class Hh{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Dr(Rr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Dr(Rr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.d_=t,this.w_=e}get latitude(){return this.d_}get longitude(){return this.w_}isEqual(t){return this.d_===t.d_&&this.w_===t.w_}toJSON(){return{latitude:this.d_,longitude:this.w_}}v(t){return Fr(this.d_,t.d_)||Fr(this.w_,t.w_)}}class $h{constructor(t){this.E_=t}static fromBase64String(t){try{return new $h(si.fromBase64String(t))}catch(t){throw new Dr(Rr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new $h(si.fromUint8Array(t))}toBase64(){return this.E_.toBase64()}toUint8Array(){return this.E_.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.E_.isEqual(t.E_)}}class Wh{constructor(t){this.o_=t}}const Kh=new Map;class Yh{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Dr(Rr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Dr(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,function(t,e,n,r){if(!0===e&&!0===r)throw new Dr(Rr.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties}}class Xh{constructor(t,e){this.T_="(lite)",this.I_=new Yh({}),this.m_=!1,t instanceof Xr?(this.A_=t,this.R_=new Cr):(this.P_=t,this.A_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Dr(Rr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xr(t.options.projectId)}(t),this.R_=new Lr(e))}get app(){if(!this.P_)throw new Dr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.P_}get V_(){return this.m_}get g_(){return void 0!==this.y_}p_(t){if(this.m_)throw new Dr(Rr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.I_=new Yh(t),void 0!==t.credentials&&(this.R_=function(t){if(!t)return new Cr;switch(t.type){case"gapi":const e=t.client;return Nr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Dr(Rr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}b_(){return this.I_}v_(){return this.m_=!0,this.I_}_delete(){return this.y_||(this.y_=this.S_()),this.y_}S_(){return function(t){const e=Kh.get(t);e&&(Er("ComponentProvider","Removing Datastore"),Kh.delete(t),e.terminate())}(this),Promise.resolve()}}class Jh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Dr(Rr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.D_=new Wr(t)}isEqual(t){return this.D_.isEqual(t.D_)}}class Qh extends fl{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this.C_=t,this.N_=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this.x_){if(this.M_){const e=new Zh(this.C_,this.k_,this.O_,this.x_,this.metadata,null);return this.M_.fromFirestore(e,t)}return this.k_.F_(this.x_.En(),t.serverTimestamps)}}get(t,e={}){if(this.x_){const n=this.x_.data().field(pl("DocumentSnapshot.get",t));if(null!==n)return this.k_.F_(n,e.serverTimestamps)}}}class Zh extends Qh{data(t={}){return super.data(t)}}class tl{constructor(t,e,n,r){this.C_=t,this.k_=e,this.L_=r,this.metadata=new cl(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this.L_.docs.size}get empty(){return 0===this.size}forEach(t,e){this.L_.docs.forEach(n=>{t.call(e,new Zh(this.C_,this.k_,n.key,n,new cl(this.L_.ee.has(n.key),this.L_.fromCache),this.query.M_))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this.L_.se)throw new Dr(Rr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.B_&&this.q_===e||(this.B_=function(t,e){if(t.L_.te.q()){let e,n=0;return t.L_.docChanges.map(r=>{const i=new Zh(t.C_,t.k_,r.doc.key,r.doc,new cl(t.L_.ee.has(r.doc.key),t.L_.fromCache),t.query.M_);return e=r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:n++}})}{let n=t.L_.te;return t.L_.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new Zh(t.C_,t.k_,e.doc.key,e.doc,new cl(t.L_.ee.has(e.doc.key),t.L_.fromCache),t.query.M_);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(s=(n=n.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(e.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this.q_=e),this.B_}}class el extends ll{constructor(t){super(),this.firestore=t}U_(t){return new $h(t)}K_(t){const e=this.Q_(t,this.firestore.A_);return new gl(this.firestore,null,e)}}function nl(t,e){return function(t,e){const n=new na;return t.di.Ri(async()=>(async function(t,e,n){const r=dh(t);try{const i=await function(t,e){const n=Or(t),r=Br.now(),i=e.reduce((t,e)=>t.add(e.key),Ti());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>n.Bc._s(t,i).next(i=>{s=i;const o=[];for(const t of e){const e=to(t,s.get(t.key));null!=e&&o.push(new io(t.key,e,po(e.proto.mapValue),Ys.exists(!0)))}return n.rs.kr(t,r,o,e)})).then(t=>{const e=t.bn(s);return{batchId:t.batchId,Kn:e}})}(r.ku,e);r.Bh.Wa(i.batchId),function(t,e,n){let r=t.Hh[t.currentUser.i()];r||(r=new fi(Fr)),r=r.Tt(e,n),t.Hh[t.currentUser.i()]=r}(r,i.batchId,n),await uh(r,i.Kn),await wc(r.$h)}catch(t){const e=Ta(t,"Failed to persist write");n.reject(e)}})(await cf(t),e,n)),n.promise}(al(t),e)}function rl(t,e,n){const r=n.docs.get(e.O_),i=new el(t);return new Qh(t,i,e.O_,r,new cl(n.hasPendingWrites,n.fromCache),e.M_)}class il{constructor(t,e){this.C_=t,this.G_=e,this.z_=[],this.H_=!1,this.J_=Pl(t)}set(t,e,n){this.Y_();const r=sl(t,this.C_),i=hl(r.M_,e,n),s=Fl(this.J_,"WriteBatch.set",r.O_,i,null!==r.M_,n);return this.z_=this.z_.concat(s.j_(r.O_,Ys.on())),this}update(t,e,n,...r){this.Y_();const i=sl(t,this.C_);let s;return e instanceof Wh&&(e=e.o_),s="string"==typeof e||e instanceof Jh?ql(this.J_,"WriteBatch.update",i.O_,e,n,r):jl(this.J_,"WriteBatch.update",i.O_,e),this.z_=this.z_.concat(s.j_(i.O_,Ys.exists(!0))),this}delete(t){this.Y_();const e=sl(t,this.C_);return this.z_=this.z_.concat(new co(e.O_,Ys.on())),this}commit(){return this.Y_(),this.H_=!0,this.z_.length>0?this.G_(this.z_):Promise.resolve()}Y_(){if(this.H_)throw new Dr(Rr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function sl(t,e){if(t instanceof Wh&&(t=t.o_),t.firestore!==e)throw new Dr(Rr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class ol extends class{constructor(t,e){this.C_=t,this.X_=e,this.J_=Pl(t)}get(t){const e=sl(t,this.C_),n=new Rl(this.C_);return this.X_.Z_([e.O_]).then(t=>{if(!t||1!==t.length)return kr();const r=t[0];if(r instanceof vo)return new fl(this.C_,n,e.O_,null,e.M_);if(r instanceof mo)return new fl(this.C_,n,r.key,r,e.M_);throw kr()})}set(t,e,n){const r=sl(t,this.C_),i=hl(r.M_,e,n),s=Fl(this.J_,"Transaction.set",r.O_,i,null!==r.M_,n);return this.X_.set(r.O_,s),this}update(t,e,n,...r){const i=sl(t,this.C_);let s;return e instanceof Wh&&(e=e.o_),s="string"==typeof e||e instanceof Jh?ql(this.J_,"Transaction.update",i.O_,e,n,r):jl(this.J_,"Transaction.update",i.O_,e),this.X_.update(i.O_,s),this}delete(t){const e=sl(t,this.C_);return this.X_.delete(e.O_),this}}{constructor(t,e){super(t,e),this.C_=t}get(t){const e=sl(t,this.C_),n=new el(this.C_);return super.get(t).then(t=>new Qh(this.C_,n,e.O_,t.x_,new cl(!1,!1),e.M_))}}function al(t){return t.tf||ul(t),t.tf.ef(),t.tf}function ul(t){const e=t.v_(),n=function(t,e,n){return new Yr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.A_,t.T_,e);t.tf=new tf(t.R_,t.nf,n)}class cl{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}function hl(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class ll{F_(t,e="none"){switch(Hi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Qi(t.integerValue||t.doubleValue);case 3:return this.sf(t.timestampValue);case 4:return this.rf(t,e);case 5:return t.stringValue;case 6:return this.U_(Zi(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.cf(t.geoPointValue);case 9:return this.uf(t.arrayValue,e);case 10:return this.af(t.mapValue,e);default:throw kr()}}af(t,e){const n={};return ji(t.fields||{},(t,r)=>{n[t]=this.F_(r,e)}),n}cf(t){return new Hh(Qi(t.latitude),Qi(t.longitude))}uf(t,e){return(t.values||[]).map(t=>this.F_(t,e))}rf(t,e){switch(e){case"previous":const n=function t(e){const n=e.mapValue.fields.__previous_value__;return Bi(n)?t(n):n}(t);return null==n?null:this.F_(n,e);case"estimate":return this.sf(zi(t));default:return null}}sf(t){const e=Ji(t);return new Br(e.seconds,e.nanos)}Q_(t,e){const n=Hr.G(t);Nr(Cs(n));const r=new Xr(n.get(1),n.get(3)),i=new Kr(n.F(5));return r.isEqual(e)||Tr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}class fl{constructor(t,e,n,r,i){this.C_=t,this.k_=e,this.O_=n,this.x_=r,this.M_=i}get id(){return this.O_.path.B()}get ref(){return new gl(this.C_,this.M_,this.O_)}exists(){return null!==this.x_}data(){if(this.x_){if(this.M_){const t=new dl(this.C_,this.k_,this.O_,this.x_,null);return this.M_.fromFirestore(t)}return this.k_.F_(this.x_.En())}}get(t){if(this.x_){const e=this.x_.data().field(pl("DocumentSnapshot.get",t));if(null!==e)return this.k_.F_(e)}}}class dl extends fl{data(){return super.data()}}function pl(t,e){return"string"==typeof e?Yl(t,e):e instanceof Wh?e.o_.D_:e.D_}class gl{constructor(t,e,n){this.M_=e,this.O_=n,this.type="document",this.firestore=t}get hf(){return this.O_.path}get id(){return this.O_.path.B()}get path(){return this.O_.path.j()}get parent(){return new Nl(this.firestore,this.M_,this.O_.path.$())}withConverter(t){return new gl(this.firestore,t,this.O_)}}class ml{constructor(t,e,n){this.M_=e,this.W_=n,this.type="query",this.firestore=t}withConverter(t){return new ml(this.firestore,t,this.W_)}}class vl{}class yl extends vl{constructor(t,e,n){super(),this._f=t,this.ff=e,this.df=n,this.type="where"}lf(t){const e=Pl(t.firestore),n=function(t,e,n,r,i,s,o){let a;if(i.Y()){if("array-contains"===s||"array-contains-any"===s)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){Sl(o,s);const e=[];for(const n of o)e.push(Tl(r,t,n));a={arrayValue:{values:e}}}else a=Tl(r,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Sl(o,s),a=Bl(n,"where",o,"in"===s||"not-in"===s);const u=xo.create(i,s,a);return function(t,e){if(e.An()){const n=So(t);if(null!==n&&!n.isEqual(e.field))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=To(t);null!==r&&Al(t,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new Dr(Rr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Dr(Rr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.W_,0,e,t.firestore.A_,this._f,this.ff,this.df);return new ml(t.firestore,t.M_,function(t,e){const n=t.filters.concat([e]);return new wo(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.W_,n))}}class wl extends vl{constructor(t,e){super(),this._f=t,this.wf=e,this.type="orderBy"}lf(t){const e=function(t,e,n){if(null!==t.startAt)throw new Dr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Dr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ko(e,n);return function(t,e){if(null===To(t)){const n=So(t);null!==n&&Al(t,n,e.field)}}(t,r),r}(t.W_,this._f,this.wf);return new ml(t.firestore,t.M_,function(t,e){const n=t.Tn.concat([e]);return new wo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.W_,e))}}class bl extends vl{constructor(t,e,n){super(),this.type=t,this.Ef=e,this.Tf=n}lf(t){return new ml(t.firestore,t.M_,Oo(t.W_,this.Ef,this.Tf))}}class _l extends vl{constructor(t,e,n){super(),this.type=t,this.If=e,this.mf=n}lf(t){const e=El(t,this.type,this.If,this.mf);return new ml(t.firestore,t.M_,function(t,e){return new wo(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.W_,e))}}class Il extends vl{constructor(t,e,n){super(),this.type=t,this.If=e,this.mf=n}lf(t){const e=El(t,this.type,this.If,this.mf);return new ml(t.firestore,t.M_,function(t,e){return new wo(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.W_,e))}}function El(t,e,n,r){if(n[0]instanceof Wh&&(n[0]=n[0].o_),n[0]instanceof fl)return function(t,e,n,r,i){if(!r)throw new Dr(Rr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const s=[];for(const n of ko(t))if(n.field.Y())s.push(ts(e,r.key));else{const t=r.field(n.field);if(Bi(t))throw new Dr(Rr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.j();throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new Go(s,i)}(t.W_,t.firestore.A_,e,n[0].x_,r);{const i=Pl(t.firestore);return function(t,e,n,r,i,s){const o=t.Tn;if(i.length>o.length)throw new Dr(Rr.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const u=i[s];if(o[s].field.Y()){if("string"!=typeof u)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof u}`);if(!Ao(t)&&-1!==u.indexOf("/"))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(Hr.G(u));if(!Kr.st(n))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Kr(n);a.push(ts(e,i))}else{const t=Bl(n,r,u);a.push(t)}}return new Go(a,s)}(t.W_,t.firestore.A_,i,e,n,r)}}function Tl(t,e,n){if(n instanceof Wh&&(n=n.o_),"string"==typeof n){if(""===n)throw new Dr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ao(e)&&-1!==n.indexOf("/"))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Hr.G(n));if(!Kr.st(r))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ts(t,new Kr(r))}if(n instanceof gl)return ts(t,n.O_);throw new Dr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+xh(n)+".")}function Sl(t,e){if(!Array.isArray(t)||0===t.length)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Al(t,e,n){if(!n.isEqual(e))throw new Dr(Rr.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function kl(t){if(Eo(t)&&0===t.Tn.length)throw new Dr(Rr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Nl extends ml{constructor(t,e,n){super(t,e,_o(n)),this.firestore=t,this.hf=n,this.type="collection"}get id(){return this.W_.path.B()}get path(){return this.W_.path.j()}get parent(){const t=this.hf.$();return t.q()?null:new gl(this.firestore,null,new Kr(t))}withConverter(t){return new Nl(this.firestore,t,this.hf)}}function Ol(t,e,...n){if(t instanceof Wh&&(t=t.o_),1===arguments.length&&(e=Vr.p()),Ph("doc","path",e),t instanceof Xh){const r=Hr.G(e,...n);return Ch(r),new gl(t,null,new Kr(r))}{if(!(t instanceof gl||t instanceof Nl))throw new Dr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t.hf.child(Hr.G(e,...n));return Ch(r),new gl(t.firestore,t instanceof Nl?t.M_:null,new Kr(r))}}class Rl extends ll{constructor(t){super(),this.firestore=t}U_(t){return new $h(t)}K_(t){const e=this.Q_(t,this.firestore.A_);return new gl(this.firestore,null,e)}}function Dl(t,e){return t instanceof Wh&&(t=t.o_),e instanceof Wh&&(e=e.o_),t instanceof ml&&e instanceof ml&&t.firestore===e.firestore&&Ro(t.W_,e.W_)&&t.M_===e.M_}function Pl(t){const e=t.v_(),n=ra(t.A_);return new Vl(t.A_,!!e.ignoreUndefinedProperties,n)}const Cl=/^__.*__$/;class Ll{constructor(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}j_(t,e){const n=[];return null!==this.en?n.push(new io(t,this.data,this.en,e)):n.push(new ro(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new oo(t,this.fieldTransforms)),n}}class xl{constructor(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}j_(t,e){const n=[new io(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new oo(t,this.fieldTransforms)),n}}function Ml(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kr()}}class Ul{constructor(t,e,n,r,i,s){this.settings=t,this.rt=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Af(),this.fieldTransforms=i||[],this.en=s||[]}get path(){return this.settings.path}get u_(){return this.settings.u_}Rf(t){return new Ul(Object.assign(Object.assign({},this.settings),t),this.rt,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)}Pf(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,l_:!1});return r.Vf(t),r}gf(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,l_:!1});return r.Af(),r}yf(t){return this.Rf({path:void 0,l_:!0})}a_(t){return Xl(t,this.settings.methodName,this.settings.pf||!1,this.path,this.settings.h_)}contains(t){return void 0!==this.en.find(e=>t.U(e))||void 0!==this.fieldTransforms.find(e=>t.U(e.field))}Af(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vf(this.path.get(t))}Vf(t){if(0===t.length)throw this.a_("Document fields must not be empty");if(Ml(this.u_)&&Cl.test(t))throw this.a_('Document fields cannot begin and end with "__"')}}class Vl{constructor(t,e,n){this.rt=t,this.ignoreUndefinedProperties=e,this.serializer=n||ra(t)}bf(t,e,n,r=!1){return new Ul({u_:t,methodName:e,h_:n,path:Wr.H(),l_:!1,pf:r},this.rt,this.serializer,this.ignoreUndefinedProperties)}}function Fl(t,e,n,r,i,s={}){const o=t.bf(s.merge||s.mergeFields?2:0,e,n,i);$l("Data must be an object, but it was:",o,r);const a=Gl(r,o);let u,c;if(s.merge)u=new $s(o.en),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=Wl(e,r,n);if(!o.contains(i))throw new Dr(Rr.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Jl(t,i)||t.push(i)}u=new $s(t),c=o.fieldTransforms.filter(t=>u.un(t.field))}else u=null,c=o.fieldTransforms;return new Ll(new lo(a),u,c)}function jl(t,e,n,r){const i=t.bf(1,e,n);$l("Data must be an object, but it was:",i,r);const s=[],o=new fo;ji(r,(t,r)=>{const a=Yl(e,t,n);r instanceof Wh&&(r=r.o_);const u=i.gf(a);if(r instanceof Fh)s.push(a);else{const t=zl(r,u);null!=t&&(s.push(a),o.set(a,t))}});const a=new $s(s);return new xl(o.hn(),a,i.fieldTransforms)}function ql(t,e,n,r,i,s){const o=t.bf(1,e,n),a=[Wl(e,r,n)],u=[i];if(s.length%2!=0)throw new Dr(Rr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(Wl(e,s[t])),u.push(s[t+1]);const c=[],h=new fo;for(let t=a.length-1;t>=0;--t)if(!Jl(c,a[t])){const e=a[t];let n=u[t];n instanceof Wh&&(n=n.o_);const r=o.gf(e);if(n instanceof Fh)c.push(e);else{const t=zl(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new $s(c);return new xl(h.hn(),l,o.fieldTransforms)}function Bl(t,e,n,r=!1){return zl(n,t.bf(r?4:3,e))}function zl(t,e){if(t instanceof Wh&&(t=t.o_),Hl(t))return $l("Unsupported field value:",e,t),Gl(t,e);if(t instanceof Vh)return function(t,e){if(!Ml(e.u_))throw e.a_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.a_(t._methodName+"() is not currently supported inside arrays");const n=t.c_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.l_&&4!==e.u_)throw e.a_("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=zl(i,e.yf(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Wh&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ls(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Br.fromDate(t);return{timestampValue:fs(e.serializer,n)}}if(t instanceof Br){const n=new Br(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:fs(e.serializer,n)}}if(t instanceof Hh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof $h)return{bytesValue:ds(e.serializer,t.E_)};if(t instanceof gl){const n=e.rt,r=t.firestore.A_;if(!r.isEqual(n))throw e.a_(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:gs(t.firestore.A_||e.rt,t.O_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.a_("Unsupported field value: "+xh(t))}(t,e)}function Gl(t,e){const n={};return qi(t)?e.path&&e.path.length>0&&e.en.push(e.path):ji(t,(t,r)=>{const i=zl(r,e.Pf(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Hl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Br||t instanceof Hh||t instanceof $h||t instanceof gl||t instanceof Vh)}function $l(t,e,n){if(!Hl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=xh(n);throw"an object"===r?e.a_(t+" a custom object"):e.a_(t+" "+r)}}function Wl(t,e,n){if(e instanceof Wh&&(e=e.o_),e instanceof Jh)return e.D_;if("string"==typeof e)return Yl(t,e);throw Xl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const Kl=new RegExp("[~\\*/\\[\\]]");function Yl(t,e,n){if(e.search(Kl)>=0)throw Xl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Jh(...e.split(".")).D_}catch(r){throw Xl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Xl(t,e,n,r,i){const s=r&&!r.q(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=" in field "+r),o&&(u+=" in document "+i),u+=")"),new Dr(Rr.INVALID_ARGUMENT,a+t+u)}function Jl(t,e){return t.some(t=>t.isEqual(e))}class Ql{constructor(t){this.Ou=t,this.vf=new Map,this.mutations=[],this.Sf=!1,this.Df=null,this.Cf=new Set}async Z_(t){if(this.Nf(),this.mutations.length>0)throw new Dr(Rr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const e=await async function(t,e){const n=Or(t),r=_s(n.serializer)+"/documents",i={documents:e.map(t=>vs(n.serializer,t))},s=await n.yu("BatchGetDocuments",r,i),o=new Map;s.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){Nr(!!e.found),e.found.name,e.found.updateTime;const n=ys(t,e.found.name),r=ps(e.found.updateTime),i=new lo({mapValue:{fields:e.found.fields}});return new mo(n,r,i,{})}(t,e):"missing"in e?function(t,e){Nr(!!e.missing),Nr(!!e.readTime);const n=ys(t,e.missing),r=ps(e.readTime);return new vo(n,r)}(t,e):kr()}(n.serializer,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());Nr(!!e),a.push(e)}),a}(this.Ou,t);return e.forEach(t=>{t instanceof vo||t instanceof mo?this.xf(t):kr()}),e}set(t,e){this.write(e.j_(t,this.rn(t))),this.Cf.add(t.toString())}update(t,e){try{this.write(e.j_(t,this.Mf(t)))}catch(t){this.Df=t}this.Cf.add(t.toString())}delete(t){this.write([new co(t,this.rn(t))]),this.Cf.add(t.toString())}async commit(){if(this.Nf(),this.Df)throw this.Df;const t=this.vf;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=Kr.tt(e);this.mutations.push(new ho(n,this.rn(n)))}),await async function(t,e){const n=Or(t),r=_s(n.serializer)+"/documents",i={writes:e.map(t=>Ts(n.serializer,t))};await n.gu("Commit",r,i)}(this.Ou,this.mutations),this.Sf=!0}xf(t){let e;if(t instanceof mo)e=t.version;else{if(!(t instanceof vo))throw kr();e=zr.min()}const n=this.vf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Dr(Rr.ABORTED,"Document version changed between two reads.")}else this.vf.set(t.key.toString(),e)}rn(t){const e=this.vf.get(t.toString());return!this.Cf.has(t.toString())&&e?Ys.updateTime(e):Ys.on()}Mf(t){const e=this.vf.get(t.toString());if(!this.Cf.has(t.toString())&&e){if(e.isEqual(zr.min()))throw new Dr(Rr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ys.updateTime(e)}return Ys.exists(!0)}write(t){this.Nf(),this.mutations=this.mutations.concat(t)}Nf(){}}class Zl{constructor(t,e,n,r){this.di=t,this.Ou=e,this.updateFunction=n,this.Ti=r,this.kf=5,this.Si=new ha(this.di,"transaction_retry")}run(){this.Of()}Of(){this.Si.Bs(async()=>{const t=new Ql(this.Ou),e=this.Ff(t);e&&e.then(e=>{this.di.Ri(()=>t.commit().then(()=>{this.Ti.resolve(e)}).catch(t=>{this.$f(t)}))}).catch(t=>{this.$f(t)})})}Ff(t){try{const e=this.updateFunction(t);return!Jr(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}}$f(t){this.kf>0&&this.Lf(t)?(this.kf-=1,this.di.Ri(()=>(this.Of(),Promise.resolve()))):this.Ti.reject(t)}Lf(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!hi(e)}return!1}}class tf{constructor(t,e,n){this.credentials=t,this.di=e,this.Ml=n,this.user=br.UNAUTHENTICATED,this.clientId=Vr.p(),this.Bf=(()=>{}),this.A=new na,this.credentials.T(t=>{Er("FirestoreClient","Received user=",t.uid),this.user.isEqual(t)||(this.user=t,this.Bf(t)),this.A.resolve()})}async getConfiguration(){return await this.A.promise,{di:this.di,Ml:this.Ml,clientId:this.clientId,credentials:this.credentials,Yl:this.user,qh:100}}qf(t){this.Bf=t,this.A.promise.then(()=>this.Bf(this.user))}ef(){if(this.di.Ci)throw new Dr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.di.ki();const t=new na;return this.di.Ni(async()=>{try{this.Uf&&await this.Uf.terminate(),this.Kf&&await this.Kf.terminate(),this.credentials.I(),t.resolve()}catch(e){const n=Ta(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function ef(t,e){t.di.Li(),Er("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n),t.qf(n=>t.di.Oi(async()=>{await $u(e.ku,n)})),e.persistence.rc(()=>t.terminate()),t.Kf=e}async function nf(t,e){t.di.Li();const n=await rf(t);Er("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.qf(n=>t.di.Oi(()=>(async function(t,e){const n=Or(t);n.di.Li(),Er("RemoteStore","RemoteStore received new credentials");const r=gc(n);n.Bu.add(3),await uc(n),r&&n.Qu.set("Unknown"),await n.Fu.s_(e),n.Bu.delete(3),await ac(n)})(e.$h,n))),t.Uf=e}async function rf(t){return t.Kf||(Er("FirestoreClient","Using default OfflineComponentProvider"),await ef(t,new kh)),t.Kf}async function sf(t){return t.Uf||(Er("FirestoreClient","Using default OnlineComponentProvider"),await nf(t,new Rh)),t.Uf}function of(t){return rf(t).then(t=>t.persistence)}function af(t){return rf(t).then(t=>t.ku)}function uf(t){return sf(t).then(t=>t.$h)}function cf(t){return sf(t).then(t=>t.ba)}async function hf(t){const e=await sf(t),n=e.Lh;return n.ta=async function(t,e){const n=fh(t);let r,i;const s=n.Kh.get(e);if(s)r=s.targetId,n.Bh.Ha(r),i=s.view.Oh();else{const t=await Yu(n.ku,No(e)),s=n.Bh.Ha(t.targetId);r=t.targetId,i=await Jc(n,e,r,"current"===s),n.Zh&&cc(n.$h,t)}return i}.bind(null,e.ba),n.sa=async function(t,e){const n=Or(t),r=n.Kh.get(e),i=n.Qh.get(r.targetId);if(i.length>1)return n.Qh.set(r.targetId,i.filter(t=>!Ro(t,e))),void n.Kh.delete(e);n.Zh?(n.Bh.Ya(r.targetId),n.Bh.Qa(r.targetId)||await Xu(n.ku,r.targetId,!1).then(()=>{n.Bh.Za(r.targetId),hc(n.$h,r.targetId),rh(n,r.targetId)}).catch(tc)):(rh(n,r.targetId),await Xu(n.ku,r.targetId,!0))}.bind(null,e.ba),n}function lf(t,e,n={}){const r=new na;return t.di.Ri(async()=>(function(t,e,n,r,i){const s=new Dh({next:s=>{e.Ri(()=>Rc(t,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Dr(Rr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Dr(Rr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:t=>i.reject(t)}),o=new Pc(_o(n.path),s,{includeMetadataChanges:!0,ha:!0});return Oc(t,o)})(await hf(t),t.di,e,n,r)),r.promise}function ff(t,e,n={}){const r=new na;return t.di.Ri(async()=>(function(t,e,n,r,i){const s=new Dh({next:n=>{e.Ri(()=>Rc(t,o)),n.fromCache&&"server"===r.source?i.reject(new Dr(Rr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:t=>i.reject(t)}),o=new Pc(n,s,{includeMetadataChanges:!0,ha:!0});return Oc(t,o)})(await hf(t),t.di,e,n,r)),r.promise}class df extends Xh{constructor(t,e){super(t,e),this.nf=new Ea,this.T_="name"in t?t.name:"[DEFAULT]"}S_(){return this.tf||ul(this),this.tf.terminate()}}function pf(t,e,n){const r=new na;return t.di.enqueue(async()=>{try{await ef(t,n),await nf(t,e),r.resolve()}catch(t){if(!function(t){return"FirebaseError"===t.name?t.code===Rr.FAILED_PRECONDITION||t.code===Rr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)}(t))throw t;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.reject(t)}}).then(()=>r.promise)}function gf(t){if(t.V_||t.g_)throw new Dr(Rr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}e._registerComponent(new h("firestore-exp",t=>((t,e)=>new df(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-exp","0.0.900","node"),t.Bytes=$h,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=Nl,t.DocumentReference=gl,t.DocumentSnapshot=Qh,t.FieldPath=Jh,t.FieldValue=Vh,t.FirebaseFirestore=df,t.FirestoreError=Dr,t.GeoPoint=Hh,t.Query=ml,t.QueryConstraint=vl,t.QueryDocumentSnapshot=Zh,t.QuerySnapshot=tl,t.SnapshotMetadata=cl,t.Timestamp=Br,t.Transaction=ol,t.WriteBatch=il,t.addDoc=function(t,e){const n=Mh(t.firestore,df),r=Ol(t),i=hl(t.M_,e);return nl(n,Fl(Pl(t.firestore),"addDoc",r.O_,i,null!==t.M_,{}).j_(r.O_,Ys.exists(!1))).then(()=>r)},t.arrayRemove=function(...t){return new zh("arrayRemove",t)},t.arrayUnion=function(...t){return new Bh("arrayUnion",t)},t.clearIndexedDbPersistence=function(t){if(t.V_&&!t.g_)throw new Dr(Rr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new na;return t.nf.Ni(async()=>{try{await async function(t){if(!la.Gs())return Promise.resolve();const e=t+"main";await la.delete(e)}(zu(t.A_,t.T_)),e.resolve()}catch(t){e.reject(t)}}),e.promise},t.collection=function(t,e,...n){if(t instanceof Wh&&(t=t.o_),Ph("collection","path",e),t instanceof Xh){const r=Hr.G(e,...n);return Lh(r),new Nl(t,null,r)}{if(!(t instanceof gl||t instanceof Nl))throw new Dr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=Hr.G(t.path,...n).child(Hr.G(e));return Lh(r),new Nl(t.firestore,null,r)}},t.collectionGroup=function(t,e){if(t=Mh(t,Xh),Ph("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Dr(Rr.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ml(t,null,function(t){return new wo(Hr.H(),t)}(e))},t.deleteDoc=function(t){return nl(Mh(t.firestore,df),[new co(t.O_,Ys.on())])},t.deleteField=function(){return new Fh("deleteField")},t.disableNetwork=function(t){return function(t){return t.di.enqueue(async()=>{const e=await of(t),n=await uf(t);return e.oc(!1),async function(t){const e=Or(n);e.Bu.add(0),await uc(e),e.Qu.set("Offline")}()})}(al(t=Mh(t,df)))},t.doc=Ol,t.documentId=function(){return new Jh("__name__")},t.enableIndexedDbPersistence=function(t,e){gf(t=Mh(t,df));const n=al(t),r=t.v_(),i=new Rh;return pf(n,i,new Nh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(t){gf(t=Mh(t,df));const e=al(t),n=t.v_(),r=new Rh;return pf(e,r,new Oh(r,n.cacheSizeBytes))},t.enableNetwork=function(t){return function(t){return t.di.enqueue(async()=>{const e=await of(t),n=await uf(t);return e.oc(!0),function(t){const e=Or(n);return e.Bu.delete(0),ac(e)}()})}(al(t=Mh(t,df)))},t.endAt=function(...t){return new Il("endAt",t,!1)},t.endBefore=function(...t){return new Il("endBefore",t,!0)},t.getDoc=function(t){const e=Mh((t=Mh(t,gl)).firestore,df);return lf(al(e),t.O_).then(n=>rl(e,t,n))},t.getDocFromCache=function(t){const e=Mh((t=Mh(t,gl)).firestore,df),n=al(e),r=new el(e);return function(t,e){const n=new na;return t.di.Ri(async()=>(async function(t,e,n){try{const r=await function(t,e){const n=Or(t);return n.persistence.runTransaction("read document","readonly",t=>n.Bc.cs(t,e))}(t,e);r instanceof mo?n.resolve(r):r instanceof vo?n.resolve(null):n.reject(new Dr(Rr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(t){const r=Ta(t,`Failed to get document '${e} from cache`);n.reject(r)}})(await af(t),e,n)),n.promise}(n,t.O_).then(n=>new Qh(e,r,t.O_,n,new cl(n instanceof mo&&n.an,!0),t.M_))},t.getDocFromServer=function(t){const e=Mh((t=Mh(t,gl)).firestore,df);return lf(al(e),t.O_,{source:"server"}).then(n=>rl(e,t,n))},t.getDocs=function(t){const e=Mh((t=Mh(t,ml)).firestore,df),n=al(e),r=new el(e);return kl(t.W_),ff(n,t.W_).then(n=>new tl(e,r,t,n))},t.getDocsFromCache=function(t){const e=Mh((t=Mh(t,ml)).firestore,df),n=al(e),r=new el(e);return function(t,e){const n=new na;return t.di.Ri(async()=>(async function(t,e,n){try{const r=await Ju(t,e,!0),i=new Wc(e,r.Qc),s=i.bh(r.documents),o=i.Zn(s,!1);n.resolve(o.snapshot)}catch(t){const r=Ta(t,`Failed to execute query '${e} against cache`);n.reject(r)}})(await af(t),e,n)),n.promise}(n,t.W_).then(n=>new tl(e,r,t,n))},t.getDocsFromServer=function(t){const e=Mh((t=Mh(t,ml)).firestore,df),n=al(e),r=new el(e);return ff(n,t.W_,{source:"server"}).then(n=>new tl(e,r,t,n))},t.getFirestore=function(t){return e._getProvider(t,"firestore-exp").getImmediate()},t.increment=function(t){return new Gh("increment",t)},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore-exp").getImmediate();if(void 0!==n.cacheSizeBytes&&-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new Dr(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.p_(n),r},t.limit=function(t){return Uh("limit",t),new bl("limit",t,"F")},t.limitToLast=function(t){return Uh("limitToLast",t),new bl("limitToLast",t,"L")},t.onSnapshot=function(t,...e){var n,r,i;t instanceof Wh&&(t=t.o_);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||ia(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(ia(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(r=t.error)||void 0===r?void 0:r.bind(t),e[o+2]=null===(i=t.complete)||void 0===i?void 0:i.bind(t)}let u,c,h;if(t instanceof gl)c=Mh(t.firestore,df),h=_o(t.O_.path),u={next:n=>{e[o]&&e[o](rl(c,t,n))},error:e[o+1],complete:e[o+2]};else{const n=Mh(t,ml);c=Mh(n.firestore,df),h=n.W_;const r=new el(c);u={next:t=>{e[o]&&e[o](new tl(c,r,n,t))},error:e[o+1],complete:e[o+2]},kl(t.W_)}return function(t,e,n,r){const i=new Dh(u),s=new Pc(e,i,n);return t.di.Ri(async()=>Oc(await hf(t),s)),()=>{i.r_(),t.di.Ri(async()=>Rc(await hf(t),s))}}(al(c),h,a)},t.onSnapshotsInSync=function(t,e){return function(t,e){const n=new Dh(e);return t.di.Ri(async()=>(function(t,e){Or(t).Zu.add(e),e.next()})(await hf(t),n)),()=>{n.r_(),t.di.Ri(async()=>(function(t,e){Or(t).Zu.delete(e)})(await hf(t),n))}}(al(t=Mh(t,df)),ia(e)?e:{next:e})},t.orderBy=function(t,e="asc"){const n=e,r=pl("orderBy",t);return new wl(r,n)},t.query=function(t,...e){for(const n of e)t=n.lf(t);return t},t.queryEqual=Dl,t.refEqual=function(t,e){return t instanceof Wh&&(t=t.o_),e instanceof Wh&&(e=e.o_),(t instanceof gl||t instanceof Nl)&&(e instanceof gl||e instanceof Nl)&&t.firestore===e.firestore&&t.path===e.path&&t.M_===e.M_},t.runTransaction=function(t,e){return function(t,e){const n=new na;return t.di.Ri(async()=>{const r=await function(t){return sf(t).then(t=>t.Ou)}(t);new Zl(t.di,r,e,n).run()}),n.promise}(al(t),n=>e(new ol(t,n)))},t.serverTimestamp=function(){return new qh("serverTimestamp")},t.setDoc=function(t,e,n){const r=Mh((t=Mh(t,gl)).firestore,df),i=hl(t.M_,e,n);return nl(r,Fl(Pl(r),"setDoc",t.O_,i,null!==t.M_,n).j_(t.O_,Ys.on()))},t.setLogLevel=function(t){_r.setLogLevel(t)},t.snapshotEqual=function(t,e){return t instanceof Qh&&e instanceof Qh?t.C_===e.C_&&t.O_.isEqual(e.O_)&&(null===t.x_?null===e.x_:t.x_.isEqual(e.x_))&&t.M_===e.M_:t instanceof tl&&e instanceof tl&&t.C_===e.C_&&Dl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.L_.isEqual(e.L_)},t.startAfter=function(...t){return new _l("startAfter",t,!1)},t.startAt=function(...t){return new _l("startAt",t,!0)},t.terminate=function(t){return e._removeServiceInstance(t.app,"firestore-exp"),t._delete()},t.updateDoc=function(t,e,n,...r){const i=Mh((t=Mh(t,gl)).firestore,df),s=Pl(i);let o;return e instanceof Wh&&(e=e.o_),nl(i,(o="string"==typeof e||e instanceof Jh?ql(s,"updateDoc",t.O_,e,n,r):jl(s,"updateDoc",t.O_,e)).j_(t.O_,Ys.exists(!0)))},t.waitForPendingWrites=function(t){return function(t){const e=new na;return t.di.Ri(async()=>(async function(t,e){const n=Or(t);gc(n.$h)||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(t){const e=Or(n.ku);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.rs.Br(t))}();if(-1===r)return void e.resolve();const i=n.Jh.get(r)||[];i.push(e),n.Jh.set(r,i)}catch(t){const n=Ta(t,"Initialization of waitForPendingWrites() operation failed");e.reject(n)}})(await cf(t),e)),e.promise}(al(t=Mh(t,df)))},t.where=function(t,e,n){const r=e,i=pl("where",t);return new yl(i,r,n)},t.writeBatch=function(t){return al(t=Mh(t,df)),new il(t,e=>nl(t,e))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r="FirebaseError",i=function(t){function e(n,i,o){var a=t.call(this,i)||this;return a.code=n,a.customData=o,a.name=r,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,s.prototype.create),a}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),s=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},s=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(u,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",c=this.serviceName+": "+a+" ("+s+").";return new i(s,c,r)},t}();var o,a,u=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(a||(a={}));var l={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},f=a.INFO,d=((o={})[a.DEBUG]="log",o[a.VERBOSE]="log",o[a.INFO]="info",o[a.WARN]="warn",o[a.ERROR]="error",o),p=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=d[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,h(["["+i+"]  "+t.name+":"],n))}},g=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=p,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.DEBUG],t)),this._logHandler.apply(this,h([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.VERBOSE],t)),this._logHandler.apply(this,h([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.INFO],t)),this._logHandler.apply(this,h([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.WARN],t)),this._logHandler.apply(this,h([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,a.ERROR],t)),this._logHandler.apply(this,h([this,a.ERROR],t))},t}();const m="ok",v="cancelled",y="unknown",w="invalid-argument",b="deadline-exceeded",_="not-found",I="already-exists",E="permission-denied",T="unauthenticated",S="resource-exhausted",A="failed-precondition",k="aborted",N="out-of-range",O="unimplemented",R="internal",D="unavailable",P="data-loss";class C extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}class L{constructor(t,e,n,r,i,s){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=s}}class x{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get o(){return"(default)"===this.database}isEqual(t){return t instanceof x&&t.projectId===this.projectId&&t.database===this.database}}class M{constructor(t){this.uid=t}u(){return null!=this.uid}h(){return this.u()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}M.UNAUTHENTICATED=new M(null),M.l=new M("google-credentials-uid"),M._=new M("first-party-uid");const U=new g("@firebase/firestore");function V(t,...e){if(U.logLevel<=a.DEBUG){const n=e.map(j);U.debug("Firestore (8.1.1): "+t,...n)}}function F(t,...e){if(U.logLevel<=a.ERROR){const n=e.map(j);U.error("Firestore (8.1.1): "+t,...n)}}function j(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function q(t="Unexpected state"){const e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw F(e),new Error(e)}function B(t,e){t||q()}function z(t,e){return t}class G{constructor(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}}class H{constructor(){this.p=null}getToken(){return Promise.resolve(null)}I(){}T(t){this.p=t,t(M.UNAUTHENTICATED)}A(){this.p=null}}class ${constructor(t){this.P=null,this.currentUser=M.UNAUTHENTICATED,this.R=!1,this.V=0,this.p=null,this.forceRefresh=!1,this.P=(()=>{this.V++,this.currentUser=this.g(),this.R=!0,this.p&&this.p(this.currentUser)}),this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(t=>{this.auth=t,this.P&&this.auth.addAuthTokenListener(this.P)},()=>{}))}getToken(){const t=this.V,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.V!==t?(V("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(B("string"==typeof e.accessToken),new G(e.accessToken,this.currentUser)):null):Promise.resolve(null)}I(){this.forceRefresh=!0}T(t){this.p=t,this.R&&t(this.currentUser)}A(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.p=null}g(){const t=this.auth&&this.auth.getUid();return B(null===t||"string"==typeof t),new M(t)}}class W{constructor(t,e){this.v=t,this.N=e,this.type="FirstParty",this.user=M._}get m(){const t={"X-Goog-AuthUser":this.N},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t}}class K{constructor(t,e){this.v=t,this.N=e}getToken(){return Promise.resolve(new W(this.v,this.N))}T(t){t(M._)}A(){}I(){}}function Y(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class X{static D(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=Y(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function J(t,e){return t<e?-1:t>e?1:0}function Q(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}class Z{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new C(w,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new C(w,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new C(w,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new C(w,"Timestamp seconds out of range: "+t)}static now(){return Z.fromMillis(Date.now())}static fromDate(t){return Z.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new Z(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}F(t){return this.seconds===t.seconds?J(this.nanoseconds,t.nanoseconds):J(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tt{constructor(t){this.timestamp=t}static $(t){return new tt(t)}static min(){return new tt(new Z(0,0))}S(t){return this.timestamp.F(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}q(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}O(){return this.timestamp}}class et{constructor(t,e,n){void 0===e?e=0:e>t.length&&q(),void 0===n?n=t.length-e:n>t.length-e&&q(),this.segments=t,this.offset=e,this.C=n}get length(){return this.C}isEqual(t){return 0===et.L(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof et?t.forEach(t=>{e.push(t)}):e.push(t),this.U(e)}limit(){return this.offset+this.length}M(t){return t=void 0===t?1:t,this.U(this.segments,this.offset+t,this.length-t)}j(){return this.U(this.segments,this.offset,this.length-1)}B(){return this.segments[this.offset]}k(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}W(){return 0===this.length}G(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}Y(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}H(){return this.segments.slice(this.offset,this.limit())}static L(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class nt extends et{U(t,e,n){return new nt(t,e,n)}K(){return this.H().join("/")}toString(){return this.K()}static J(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new C(w,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new nt(e)}static Z(){return new nt([])}}const rt=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends et{U(t,e,n){return new it(t,e,n)}static X(t){return rt.test(t)}K(){return this.H().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.X(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.K()}tt(){return 1===this.length&&"__name__"===this.get(0)}static nt(){return new it(["__name__"])}static et(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new C(w,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new C(w,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new C(w,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new C(w,"Unterminated ` in path: "+t);return new it(e)}static Z(){return new it([])}}class st{constructor(t){this.path=t}static st(t){return new st(nt.J(t))}static rt(t){return new st(nt.J(t).M(5))}it(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===nt.L(this.path,t.path)}toString(){return this.path.toString()}static L(t,e){return nt.L(t.path,e.path)}static ot(t){return t.length%2==0}static ut(t){return new st(new nt(t.slice()))}}function ot(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function at(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class ut{constructor(t){this.ct=t}static fromBase64String(t){const e=atob(t);return new ut(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ut(e)}toBase64(){return t=this.ct,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.ct)}at(){return 2*this.ct.length}S(t){return J(this.ct,t.ct)}isEqual(t){return this.ct===t.ct}}function ct(t){return null==t}function ht(t){return 0===t&&1/t==-1/0}function lt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ft(t){const e=wt(t.mapValue.fields.__local_write_time__.timestampValue);return new Z(e.seconds,e.nanos)}ut.ht=new ut("");const dt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lt(t)?4:10:q()}function gt(t,e){const n=pt(t);if(n!==pt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ft(t).isEqual(ft(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=wt(t.timestampValue),r=wt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return _t(t.bytesValue).isEqual(_t(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return bt(t.geoPointValue.latitude)===bt(e.geoPointValue.latitude)&&bt(t.geoPointValue.longitude)===bt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bt(t.integerValue)===bt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=bt(t.doubleValue),r=bt(e.doubleValue);return n===r?ht(n)===ht(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Q(t.arrayValue.values||[],e.arrayValue.values||[],gt);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ot(n)!==ot(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!gt(n[t],r[t])))return!1;return!0}(t,e);default:return q()}}function mt(t,e){return void 0!==(t.values||[]).find(t=>gt(t,e))}function vt(t,e){const n=pt(t),r=pt(e);if(n!==r)return J(n,r);switch(n){case 0:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=bt(t.integerValue||t.doubleValue),r=bt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return yt(t.timestampValue,e.timestampValue);case 4:return yt(ft(t),ft(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(t,e){const n=_t(t),r=_t(e);return n.S(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=J(n[t],r[t]);if(0!==e)return e}return J(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=J(bt(t.latitude),bt(e.latitude));return 0!==n?n:J(bt(t.longitude),bt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=vt(n[t],r[t]);if(e)return e}return J(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=J(r[t],s[t]);if(0!==e)return e;const o=vt(n[r[t]],i[s[t]]);if(0!==o)return o}return J(r.length,s.length)}(t.mapValue,e.mapValue);default:throw q()}}function yt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return J(t,e);const n=wt(t),r=wt(e),i=J(n.seconds,r.seconds);return 0!==i?i:J(n.nanos,r.nanos)}function wt(t){if(B(!!t),"string"==typeof t){let e=0;const n=dt.exec(t);if(B(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:bt(t.seconds),nanos:bt(t.nanos)}}function bt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _t(t){return"string"==typeof t?ut.fromBase64String(t):ut.fromUint8Array(t)}function It(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.K()}`}}function Et(t){return!!t&&"arrayValue"in t}function Tt(t){return!!t&&"nullValue"in t}function St(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function At(t){return!!t&&"mapValue"in t}class kt{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.lt=null}}function Nt(t,e=null,n=[],r=[],i=null,s=null,o=null){return new kt(t,e,n,r,i,s,o)}class Ot{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.ft=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function Rt(t){return!ct(t.limit)&&"L"===t.limitType}function Dt(t){return t.ft.length>0?t.ft[0].field:null}function Pt(t){for(const e of t.filters)if(e.wt())return e.field;return null}function Ct(t){return null!==t.collectionGroup}function Lt(t){const e=z(t);if(null===e.dt){e.dt=[];const t=Pt(e),n=Dt(e);if(null!==t&&null===n)t.tt()||e.dt.push(new Wt(t)),e.dt.push(new Wt(it.nt(),"asc"));else{let t=!1;for(const n of e.ft)e.dt.push(n),n.field.tt()&&(t=!0);if(!t){const t=e.ft.length>0?e.ft[e.ft.length-1].dir:"asc";e.dt.push(new Wt(it.nt(),t))}}}return e.dt}function xt(t){const e=z(t);if(!e._t)if("F"===e.limitType)e._t=Nt(e.path,e.collectionGroup,Lt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Lt(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Wt(n.field,e))}const n=e.endAt?new Ht(e.endAt.position,!e.endAt.before):null,r=e.startAt?new Ht(e.startAt.position,!e.startAt.before):null;e._t=Nt(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e._t}class Mt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.yt(t,e,n):new Ut(t,e,n):"array-contains"===e?new qt(t,n):"in"===e?new Bt(t,n):"not-in"===e?new zt(t,n):"array-contains-any"===e?new Gt(t,n):new Mt(t,e,n)}static yt(t,e,n){return"in"===e?new Vt(t,n):new Ft(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.Et(vt(e,this.value)):null!==e&&pt(this.value)===pt(e)&&this.Et(vt(e,this.value))}Et(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return q()}}wt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ut extends Mt{constructor(t,e,n){super(t,e,n),this.key=st.rt(n.referenceValue)}matches(t){const e=st.L(t.key,this.key);return this.Et(e)}}class Vt extends Mt{constructor(t,e){super(t,"in",e),this.keys=jt("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Ft extends Mt{constructor(t,e){super(t,"not-in",e),this.keys=jt("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function jt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>st.rt(t.referenceValue))}class qt extends Mt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Et(e)&&mt(e.arrayValue,this.value)}}class Bt extends Mt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&mt(this.value.arrayValue,e)}}class zt extends Mt{constructor(t,e){super(t,"not-in",e)}matches(t){if(mt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!mt(this.value.arrayValue,e)}}class Gt extends Mt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Et(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>mt(this.value.arrayValue,t))}}class Ht{constructor(t,e){this.position=t,this.before=e}}function $t(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gt(t.position[n],e.position[n]))return!1;return!0}class Wt{constructor(t,e="asc"){this.field=t,this.dir=e}}function Kt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Yt,Xt;function Jt(t){if(void 0===t)return F("RPC_ERROR","HTTP error has no status"),y;switch(t){case 200:return m;case 400:return A;case 401:return T;case 403:return E;case 404:return _;case 409:return k;case 416:return N;case 429:return S;case 499:return v;case 500:return y;case 501:return O;case 503:return D;case 504:return b;default:return t>=200&&t<300?m:t>=400&&t<500?A:t>=500&&t<600?R:y}}(Xt=Yt||(Yt={}))[Xt.OK=0]="OK",Xt[Xt.CANCELLED=1]="CANCELLED",Xt[Xt.UNKNOWN=2]="UNKNOWN",Xt[Xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xt[Xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xt[Xt.NOT_FOUND=5]="NOT_FOUND",Xt[Xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xt[Xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xt[Xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xt[Xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xt[Xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xt[Xt.ABORTED=10]="ABORTED",Xt[Xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xt[Xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xt[Xt.INTERNAL=13]="INTERNAL",Xt[Xt.UNAVAILABLE=14]="UNAVAILABLE",Xt[Xt.DATA_LOSS=15]="DATA_LOSS";const Qt={asc:"ASCENDING",desc:"DESCENDING"},Zt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class te{constructor(t,e){this.t=t,this.It=e}}function ee(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ht(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.It){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ht(e)?"-0":e}}(t,e)}function ne(t,e){return t.It?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function re(t){return B(!!t),tt.$(function(t){const e=wt(t);return new Z(e.seconds,e.nanos)}(t))}function ie(t,e){return function(t){return new nt(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).K()}function se(t,e){return ie(t.t,e.path)}function oe(t,e){const n=function(t){const e=nt.J(t);return B(pe(e)),e}(e);if(n.get(1)!==t.t.projectId)throw new C(w,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new C(w,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new st((B((r=n).length>4&&"documents"===r.get(4)),r.M(5)));var r}function ae(t,e){return ie(t.t,e)}function ue(t){return new nt(["projects",t.t.projectId,"databases",t.t.database]).K()}function ce(t,e,n){return{name:se(t,e),fields:n.proto.mapValue.fields}}function he(t,e){let n;if(e instanceof Te)n={update:ce(t,e.key,e.value)};else if(e instanceof ke)n={delete:se(t,e.key)};else if(e instanceof Se)n={update:ce(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.K())),{fieldPaths:e}}(e.Tt)};else if(e instanceof Ae)n={transform:{document:se(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof me)return{fieldPath:e.field.K(),setToServerValue:"REQUEST_TIME"};if(n instanceof ve)return{fieldPath:e.field.K(),appendMissingElements:{values:n.elements}};if(n instanceof ye)return{fieldPath:e.field.K(),removeAllFromArray:{values:n.elements}};if(n instanceof we)return{fieldPath:e.field.K(),increment:n.At};throw q()})(0,t))}};else{if(!(e instanceof Ne))return q();n={verify:se(t,e.key)}}return e.Rt.Pt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return ne(t,e.O())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:q()}(t,e.Rt)),n}function le(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ae(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ae(t,r.j()),n.structuredQuery.from=[{collectionId:r.k()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(St(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NAN"}};if(Tt(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(St(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NOT_NAN"}};if(Tt(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:de(t.field),op:function(t){return Zt[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:de(t.field),direction:function(t){return Qt[t]}(t.dir)}})(t))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.It||ct(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=fe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=fe(e.endAt)),n}function fe(t){return{before:t.before,values:t.position}}function de(t){return{fieldPath:t.K()}}function pe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class ge{constructor(){this.Vt=void 0}}class me extends ge{}class ve extends ge{constructor(t){super(),this.elements=t}}class ye extends ge{constructor(t){super(),this.elements=t}}class we extends ge{constructor(t,e){super(),this.serializer=t,this.At=e}}class be{constructor(t){this.fields=t,t.sort(it.L)}gt(t){for(const e of this.fields)if(e.G(t))return!0;return!1}isEqual(t){return Q(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class _e{constructor(t,e){this.field=t,this.transform=e}}class Ie{constructor(t,e){this.updateTime=t,this.exists=e}static vt(){return new Ie}static exists(t){return new Ie(void 0,t)}static updateTime(t){return new Ie(t)}get Pt(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Ee{}class Te extends Ee{constructor(t,e,n){super(),this.key=t,this.value=e,this.Rt=n,this.type=0}}class Se extends Ee{constructor(t,e,n,r){super(),this.key=t,this.data=e,this.Tt=n,this.Rt=r,this.type=1}}class Ae extends Ee{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.Rt=Ie.exists(!0)}}class ke extends Ee{constructor(t,e){super(),this.key=t,this.Rt=e,this.type=3}}class Ne extends Ee{constructor(t,e){super(),this.key=t,this.Rt=e,this.type=4}}class Oe{constructor(t){this.proto=t}static empty(){return new Oe({mapValue:{}})}field(t){if(t.W())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!At(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null}}isEqual(t){return gt(this.proto,t.proto)}}class Re{constructor(t=Oe.empty()){this.bt=t,this.Nt=new Map}set(t,e){return this.Dt(t,e),this}delete(t){return this.Dt(t,null),this}Dt(t,e){let n=this.Nt;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===pt(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.k(),e)}Ft(){const t=this.$t(it.Z(),this.Nt);return null!=t?new Oe(t):this.bt}$t(t,e){let n=!1;const r=this.bt.field(t),i=At(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const s=this.$t(t.child(r),e);null!=s&&(i[r]=s,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}class De{constructor(t,e){this.key=t,this.version=e}}class Pe extends De{constructor(t,e,n,r){super(t,e),this.St=n,this.xt=!!r.xt,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.St.field(t)}data(){return this.St}qt(){return this.St.proto}isEqual(t){return t instanceof Pe&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.xt===t.xt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.St.isEqual(t.St)}toString(){return`Document(${this.key}, ${this.version}, ${this.St.toString()}, {hasLocalMutations: ${this.xt}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.xt||this.hasCommittedMutations}}class Ce extends De{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Ce&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Le{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class xe{constructor(t,e,n=1e3,r=1.5,i=6e4){this.Ot=t,this.Ct=e,this.Lt=n,this.Ut=r,this.Mt=i,this.jt=0,this.Bt=null,this.kt=Date.now(),this.reset()}reset(){this.jt=0}Qt(){this.jt=this.Mt}Wt(t){this.cancel();const e=Math.floor(this.jt+this.zt()),n=Math.max(0,Date.now()-this.kt),r=Math.max(0,e-n);r>0&&V("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.jt} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bt=this.Ot.Gt(this.Ct,r,()=>(this.kt=Date.now(),t())),this.jt*=this.Ut,this.jt<this.Lt&&(this.jt=this.Lt),this.jt>this.Mt&&(this.jt=this.Mt)}Yt(){null!==this.Bt&&(this.Bt.Ht(),this.Bt=null)}cancel(){null!==this.Bt&&(this.Bt.cancel(),this.Bt=null)}zt(){return(Math.random()-.5)*this.jt}}function Me(){return"undefined"!=typeof document?document:null}class Ue{constructor(t,e,n,r,i){this.Kt=t,this.Ct=e,this.Jt=n,this.op=r,this.Zt=i,this.Xt=new Le,this.then=this.Xt.promise.then.bind(this.Xt.promise),this.Xt.promise.catch(t=>{})}static tn(t,e,n,r,i){const s=Date.now()+n,o=new Ue(t,e,s,r,i);return o.start(n),o}start(t){this.nn=setTimeout(()=>this.en(),t)}Ht(){return this.en()}cancel(t){null!==this.nn&&(this.clearTimeout(),this.Xt.reject(new C(v,"Operation cancelled"+(t?": "+t:""))))}en(){this.Kt.sn(()=>null!==this.nn?(this.clearTimeout(),this.op().then(t=>this.Xt.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.nn&&(this.Zt(this),clearTimeout(this.nn),this.nn=null)}}class Ve{constructor(){this.rn=Promise.resolve(),this.on=[],this.un=!1,this.cn=[],this.an=null,this.hn=!1,this.ln=[],this.fn=new xe(this,"async_queue_retry"),this.dn=(()=>{const t=Me();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.fn.Yt()});const t=Me();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.dn)}get _n(){return this.un}sn(t){this.enqueue(t)}wn(t){this.mn(),this.pn(t)}yn(){if(!this.un){this.un=!0;const t=Me();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.dn)}}enqueue(t){return this.mn(),this.un?new Promise(t=>{}):this.pn(t)}En(t){this.sn(()=>(this.on.push(t),this.In()))}async In(){if(0!==this.on.length){try{await this.on[0](),this.on.shift(),this.fn.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;V("AsyncQueue","Operation failed with retryable error: "+t)}this.on.length>0&&this.fn.Wt(()=>this.In())}}pn(t){const e=this.rn.then(()=>(this.hn=!0,t().catch(t=>{throw this.an=t,this.hn=!1,F("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.hn=!1,t))));return this.rn=e,e}Gt(t,e,n){this.mn(),this.ln.indexOf(t)>-1&&(e=0);const r=Ue.tn(this,t,e,n,t=>this.Tn(t));return this.cn.push(r),r}mn(){this.an&&q()}An(){}async Pn(){let t;do{t=this.rn,await t}while(t!==this.rn)}Rn(t){for(const e of this.cn)if(e.Ct===t)return!0;return!1}Vn(t){return this.Pn().then(()=>{this.cn.sort((t,e)=>t.Jt-e.Jt);for(const e of this.cn)if(e.Ht(),"all"!==t&&e.Ct===t)break;return this.Pn()})}gn(t){this.ln.push(t)}Tn(t){const e=this.cn.indexOf(t);this.cn.splice(e,1)}}class Fe extends class{}{constructor(t,e,n){super(),this.credentials=t,this.vn=e,this.serializer=n,this.bn=!1}Nn(){if(this.bn)throw new C(A,"The client has already been terminated.")}Dn(t,e,n){return this.Nn(),this.credentials.getToken().then(r=>this.vn.Dn(t,e,n,r)).catch(t=>{throw t.code===T&&this.credentials.I(),t})}Fn(t,e,n){return this.Nn(),this.credentials.getToken().then(r=>this.vn.Fn(t,e,n,r)).catch(t=>{throw t.code===T&&this.credentials.I(),t})}terminate(){this.bn=!1}}async function je(t,e){const n=z(t),r=ue(n.serializer)+"/documents",i={writes:e.map(t=>he(n.serializer,t))};await n.Dn("Commit",r,i)}async function qe(t,e){const n=z(t),r=ue(n.serializer)+"/documents",i={documents:e.map(t=>se(n.serializer,t))},s=await n.Fn("BatchGetDocuments",r,i),o=new Map;s.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){B(!!e.found),e.found.name,e.found.updateTime;const n=oe(t,e.found.name),r=re(e.found.updateTime),i=new Oe({mapValue:{fields:e.found.fields}});return new Pe(n,r,i,{})}(t,e):"missing"in e?function(t,e){B(!!e.missing),B(!!e.readTime);const n=oe(t,e.missing),r=re(e.readTime);return new Ce(n,r)}(t,e):q()}(n.serializer,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());B(!!e),a.push(e)}),a}const Be={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class ze extends class{constructor(t){this.$n=t,this.t=t.t;const e=t.ssl?"https":"http";this.Sn=e+"://"+t.host,this.xn="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}Dn(t,e,n,r){const i=this.qn(t,e);V("RestConnection","Sending: ",i,n);const s={};return this.On(s,r),this.Cn(t,i,s,n).then(t=>(V("RestConnection","Received: ",t),t),e=>{throw function(t,...e){if(U.logLevel<=a.WARN){const t=e.map(j);U.warn("Firestore (8.1.1): RestConnection",...t)}}(0,t+" failed with error: ",e,"url: ",i,"request:",n),e})}Fn(t,e,n,r){return this.Dn(t,e,n,r)}On(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(const n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])}qn(t,e){const n=Be[t];return`${this.Sn}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.Ln=e}Un(t,e){throw new Error("Not supported by FetchConnection")}async Cn(t,e,n,r){const i=JSON.stringify(r);let s;try{s=await this.Ln(e,{method:"POST",headers:n,body:i})}catch(t){throw new C(Jt(t.status),"Request failed with error: "+t.statusText)}if(!s.ok)throw new C(Jt(s.status),"Request failed with error: "+s.statusText);return s.json()}}function Ge(t){return new te(t,!0)}const He=new Map;function $e(t){if(t.Mn)throw new C(A,"The client has already been terminated.");if(!He.has(t)){V("ComponentProvider","Initializing Datastore");const i=function(t){return new ze(t,fetch.bind(null))}((e=t.jn,n=t.Bn,r=t.kn(),new L(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling))),s=Ge(t.jn),o=function(t,e,n){return new Fe(t,i,s)}(t.Qn);He.set(t,o)}var e,n,r;return He.get(t)}function We(t,e,n){if(!n)throw new C(w,`Function ${t}() cannot be called with an empty ${e}.`)}function Ke(t){if(!st.ot(t))throw new C(w,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ye(t){if(st.ot(t))throw new C(w,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Xe(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":q()}function Je(t,e){if("_delegate"in t&&(t=t.Wn),!(t instanceof e)){if(e.name===t.constructor.name)throw new C(w,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xe(t);throw new C(w,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Qe(t,e){if(e<=0)throw new C(w,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Ze{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new C(w,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new C(w,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,function(t,e,n,r){if(!0===e&&!0===r)throw new C(w,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties}}class tn{constructor(t,e){this.Bn="(lite)",this.zn=new Ze({}),this.Gn=!1,t instanceof x?(this.jn=t,this.Qn=new H):(this.Yn=t,this.jn=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new C(w,'"projectId" not provided in firebase.initializeApp.');return new x(t.options.projectId)}(t),this.Qn=new $(e))}get app(){if(!this.Yn)throw new C(A,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yn}get Hn(){return this.Gn}get Mn(){return void 0!==this.Kn}Jn(t){if(this.Gn)throw new C(A,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.zn=new Ze(t),void 0!==t.credentials&&(this.Qn=function(t){if(!t)return new H;switch(t.type){case"gapi":const e=t.client;return B(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new K(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new C(w,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}Zn(){return this.zn}kn(){return this.Gn=!0,this.zn}_delete(){return this.Kn||(this.Kn=this.Xn()),this.Kn}Xn(){return function(t){const e=He.get(t);e&&(V("ComponentProvider","Removing Datastore"),He.delete(t),e.terminate())}(this),Promise.resolve()}}class en{constructor(t){this._methodName=t}}class nn extends en{te(t){if(2!==t.ne)throw 1===t.ne?t.ee(this._methodName+"() can only appear at the top level of your update data"):t.ee(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Tt.push(t.path),null}isEqual(t){return t instanceof nn}}function rn(t,e,n){return new vn({ne:3,se:e.settings.se,methodName:t._methodName,re:n},e.t,e.serializer,e.ignoreUndefinedProperties)}class sn extends en{te(t){return new _e(t.path,new me)}isEqual(t){return t instanceof sn}}class on extends en{constructor(t,e){super(t),this.ie=e}te(t){const e=rn(this,t,!0),n=this.ie.map(t=>En(t,e)),r=new ve(n);return new _e(t.path,r)}isEqual(t){return this===t}}class an extends en{constructor(t,e){super(t),this.ie=e}te(t){const e=rn(this,t,!0),n=this.ie.map(t=>En(t,e)),r=new ye(n);return new _e(t.path,r)}isEqual(t){return this===t}}class un extends en{constructor(t,e){super(t),this.oe=e}te(t){const e=new we(t.serializer,ee(t.serializer,this.oe));return new _e(t.path,e)}isEqual(t){return this===t}}class cn{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new C(w,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new C(w,"Longitude must be a number between -180 and 180, but was: "+e);this.ue=t,this.ce=e}get latitude(){return this.ue}get longitude(){return this.ce}isEqual(t){return this.ue===t.ue&&this.ce===t.ce}toJSON(){return{latitude:this.ue,longitude:this.ce}}F(t){return J(this.ue,t.ue)||J(this.ce,t.ce)}}class hn{constructor(t){this.ae=t}static fromBase64String(t){try{return new hn(ut.fromBase64String(t))}catch(t){throw new C(w,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new hn(ut.fromUint8Array(t))}toBase64(){return this.ae.toBase64()}toUint8Array(){return this.ae.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.ae.isEqual(t.ae)}}class ln{constructor(t){this.Wn=t}}class fn{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new C(w,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.he=new it(t)}isEqual(t){return this.he.isEqual(t.he)}}const dn=/^__.*__$/;class pn{constructor(t,e,n){this.data=t,this.Tt=e,this.fieldTransforms=n}le(t,e){const n=[];return null!==this.Tt?n.push(new Se(t,this.data,this.Tt,e)):n.push(new Te(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ae(t,this.fieldTransforms)),n}}class gn{constructor(t,e,n){this.data=t,this.Tt=e,this.fieldTransforms=n}le(t,e){const n=[new Se(t,this.data,this.Tt,e)];return this.fieldTransforms.length>0&&n.push(new Ae(t,this.fieldTransforms)),n}}function mn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class vn{constructor(t,e,n,r,i,s){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.fe(),this.fieldTransforms=i||[],this.Tt=s||[]}get path(){return this.settings.path}get ne(){return this.settings.ne}de(t){return new vn(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Tt)}_e(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.de({path:n,re:!1});return r.we(t),r}me(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.de({path:n,re:!1});return r.fe(),r}pe(t){return this.de({path:void 0,re:!0})}ee(t){return Rn(t,this.settings.methodName,this.settings.ye||!1,this.path,this.settings.se)}contains(t){return void 0!==this.Tt.find(e=>t.G(e))||void 0!==this.fieldTransforms.find(e=>t.G(e.field))}fe(){if(this.path)for(let t=0;t<this.path.length;t++)this.we(this.path.get(t))}we(t){if(0===t.length)throw this.ee("Document fields must not be empty");if(mn(this.ne)&&dn.test(t))throw this.ee('Document fields cannot begin and end with "__"')}}class yn{constructor(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ge(t)}Ee(t,e,n,r=!1){return new vn({ne:t,methodName:e,se:n,path:it.Z(),re:!1,ye:r},this.t,this.serializer,this.ignoreUndefinedProperties)}}function wn(t,e,n,r,i,s={}){const o=t.Ee(s.merge||s.mergeFields?2:0,e,n,i);An("Data must be an object, but it was:",o,r);const a=Tn(r,o);let u,c;if(s.merge)u=new be(o.Tt),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=kn(e,r,n);if(!o.contains(i))throw new C(w,`Field '${i}' is specified in your field mask but missing from your input data.`);Dn(t,i)||t.push(i)}u=new be(t),c=o.fieldTransforms.filter(t=>u.gt(t.field))}else u=null,c=o.fieldTransforms;return new pn(new Oe(a),u,c)}function bn(t,e,n,r){const i=t.Ee(1,e,n);An("Data must be an object, but it was:",i,r);const s=[],o=new Re;at(r,(t,r)=>{const a=On(e,t,n);r instanceof ln&&(r=r.Wn);const u=i.me(a);if(r instanceof nn)s.push(a);else{const t=En(r,u);null!=t&&(s.push(a),o.set(a,t))}});const a=new be(s);return new gn(o.Ft(),a,i.fieldTransforms)}function _n(t,e,n,r,i,s){const o=t.Ee(1,e,n),a=[kn(e,r,n)],u=[i];if(s.length%2!=0)throw new C(w,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(kn(e,s[t])),u.push(s[t+1]);const c=[],h=new Re;for(let t=a.length-1;t>=0;--t)if(!Dn(c,a[t])){const e=a[t];let n=u[t];n instanceof ln&&(n=n.Wn);const r=o.me(e);if(n instanceof nn)c.push(e);else{const t=En(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new be(c);return new gn(h.Ft(),l,o.fieldTransforms)}function In(t,e,n,r=!1){return En(n,t.Ee(r?4:3,e))}function En(t,e){if(t instanceof ln&&(t=t.Wn),Sn(t))return An("Unsupported field value:",e,t),Tn(t,e);if(t instanceof en)return function(t,e){if(!mn(e.ne))throw e.ee(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.ee(t._methodName+"() is not currently supported inside arrays");const n=t.te(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Tt.push(e.path),t instanceof Array){if(e.settings.re&&4!==e.ne)throw e.ee("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=En(i,e.pe(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof ln&&(t=t.Wn),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ee(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Z.fromDate(t);return{timestampValue:ne(e.serializer,n)}}if(t instanceof Z){const n=new Z(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ne(e.serializer,n)}}if(t instanceof cn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof hn)return{bytesValue:function(t,e){return t.It?e.toBase64():e.toUint8Array()}(e.serializer,t.ae)};if(t instanceof Bn){const n=e.t,r=t.firestore.jn;if(!r.isEqual(n))throw e.ee(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ie(t.firestore.jn||e.t,t.Ie.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ee("Unsupported field value: "+Xe(t))}(t,e)}function Tn(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.Tt.push(e.path):at(t,(t,r)=>{const i=En(r,e._e(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Sn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Z||t instanceof cn||t instanceof hn||t instanceof Bn||t instanceof en)}function An(t,e,n){if(!Sn(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=Xe(n);throw"an object"===r?e.ee(t+" a custom object"):e.ee(t+" "+r)}}function kn(t,e,n){if(e instanceof ln&&(e=e.Wn),e instanceof fn)return e.he;if("string"==typeof e)return On(t,e);throw Rn("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const Nn=new RegExp("[~\\*/\\[\\]]");function On(t,e,n){if(e.search(Nn)>=0)throw Rn(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fn(...e.split(".")).he}catch(r){throw Rn(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Rn(t,e,n,r,i){const s=r&&!r.W(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)");let u="";return(s||o)&&(u+=" (found",s&&(u+=" in field "+r),o&&(u+=" in document "+i),u+=")"),new C(w,(a+=". ")+t+u)}function Dn(t,e){return t.some(t=>t.isEqual(e))}class Pn{constructor(t){this.Te=t,this.Ae=new Map,this.mutations=[],this.Pe=!1,this.Re=null,this.Ve=new Set}async ge(t){if(this.ve(),this.mutations.length>0)throw new C(w,"Firestore transactions require all reads to be executed before all writes.");const e=await qe(this.Te,t);return e.forEach(t=>{t instanceof Ce||t instanceof Pe?this.be(t):q()}),e}set(t,e){this.write(e.le(t,this.Rt(t))),this.Ve.add(t.toString())}update(t,e){try{this.write(e.le(t,this.Ne(t)))}catch(t){this.Re=t}this.Ve.add(t.toString())}delete(t){this.write([new ke(t,this.Rt(t))]),this.Ve.add(t.toString())}async commit(){if(this.ve(),this.Re)throw this.Re;const t=this.Ae;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=st.st(e);this.mutations.push(new Ne(n,this.Rt(n)))}),await je(this.Te,this.mutations),this.Pe=!0}be(t){let e;if(t instanceof Pe)e=t.version;else{if(!(t instanceof Ce))throw q();e=tt.min()}const n=this.Ae.get(t.key.toString());if(n){if(!e.isEqual(n))throw new C(k,"Document version changed between two reads.")}else this.Ae.set(t.key.toString(),e)}Rt(t){const e=this.Ae.get(t.toString());return!this.Ve.has(t.toString())&&e?Ie.updateTime(e):Ie.vt()}Ne(t){const e=this.Ae.get(t.toString());if(!this.Ve.has(t.toString())&&e){if(e.isEqual(tt.min()))throw new C(w,"Can't update a document that doesn't exist.");return Ie.updateTime(e)}return Ie.exists(!0)}write(t){this.ve(),this.mutations=this.mutations.concat(t)}ve(){}}class Cn{constructor(t,e,n,r){this.Kt=t,this.Te=e,this.updateFunction=n,this.Xt=r,this.De=5,this.fn=new xe(this.Kt,"transaction_retry")}run(){this.Fe()}Fe(){this.fn.Wt(async()=>{const t=new Pn(this.Te),e=this.$e(t);e&&e.then(e=>{this.Kt.sn(()=>t.commit().then(()=>{this.Xt.resolve(e)}).catch(t=>{this.Se(t)}))}).catch(t=>{this.Se(t)})})}$e(t){try{const e=this.updateFunction(t);return!ct(e)&&e.catch&&e.then?e:(this.Xt.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Xt.reject(t),null}}Se(t){this.De>0&&this.xe(t)?(this.De-=1,this.Kt.sn(()=>(this.Fe(),Promise.resolve()))):this.Xt.reject(t)}xe(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case m:return q();case v:case y:case b:case S:case R:case D:case T:return!1;case w:case _:case I:case E:case A:case k:case N:case O:case P:return!0;default:return q()}}()}return!1}}class Ln{constructor(t,e){this.qe=t,this.Oe=e,this.Ce=[],this.Le=!1,this.Ue=ir(t)}set(t,e,n){this.Me();const r=xn(t,this.qe),i=Un(r.je,e,n),s=wn(this.Ue,"WriteBatch.set",r.Ie,i,null!==r.je,n);return this.Ce=this.Ce.concat(s.le(r.Ie,Ie.vt())),this}update(t,e,n,...r){this.Me();const i=xn(t,this.qe);let s;return e instanceof ln&&(e=e.Wn),s="string"==typeof e||e instanceof fn?_n(this.Ue,"WriteBatch.update",i.Ie,e,n,r):bn(this.Ue,"WriteBatch.update",i.Ie,e),this.Ce=this.Ce.concat(s.le(i.Ie,Ie.exists(!0))),this}delete(t){this.Me();const e=xn(t,this.qe);return this.Ce=this.Ce.concat(new ke(e.Ie,Ie.vt())),this}commit(){return this.Me(),this.Le=!0,this.Ce.length>0?this.Oe(this.Ce):Promise.resolve()}Me(){if(this.Le)throw new C(A,"A write batch can no longer be used after commit() has been called.")}}function xn(t,e){if(t instanceof ln&&(t=t.Wn),t.firestore!==e)throw new C(w,"Provided document reference is from a different Firestore instance.");return t}class Mn{constructor(t,e){this.qe=t,this.Be=e,this.Ue=ir(t)}get(t){const e=xn(t,this.qe),n=new nr(this.qe);return this.Be.ge([e.Ie]).then(t=>{if(!t||1!==t.length)return q();const r=t[0];if(r instanceof Ce)return new Vn(this.qe,n,e.Ie,null,e.je);if(r instanceof Pe)return new Vn(this.qe,n,r.key,r,e.je);throw q()})}set(t,e,n){const r=xn(t,this.qe),i=Un(r.je,e,n),s=wn(this.Ue,"Transaction.set",r.Ie,i,null!==r.je,n);return this.Be.set(r.Ie,s),this}update(t,e,n,...r){const i=xn(t,this.qe);let s;return e instanceof ln&&(e=e.Wn),s="string"==typeof e||e instanceof fn?_n(this.Ue,"Transaction.update",i.Ie,e,n,r):bn(this.Ue,"Transaction.update",i.Ie,e),this.Be.update(i.Ie,s),this}delete(t){const e=xn(t,this.qe);return this.Be.delete(e.Ie),this}}function Un(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Vn{constructor(t,e,n,r,i){this.qe=t,this.ke=e,this.Ie=n,this.Qe=r,this.je=i}get id(){return this.Ie.path.k()}get ref(){return new Bn(this.qe,this.je,this.Ie)}exists(){return null!==this.Qe}data(){if(this.Qe){if(this.je){const t=new Fn(this.qe,this.ke,this.Ie,this.Qe,null);return this.je.fromFirestore(t)}return this.ke.We(this.Qe.qt())}}get(t){if(this.Qe){const e=this.Qe.data().field(qn("DocumentSnapshot.get",t));if(null!==e)return this.ke.We(e)}}}class Fn extends Vn{data(){return super.data()}}class jn{constructor(t,e){this.ze=e,this.query=t}get docs(){return[...this.ze]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.ze.forEach(t,e)}}function qn(t,e){return"string"==typeof e?On(t,e):e instanceof ln?e.Wn.he:e.he}class Bn{constructor(t,e,n){this.je=e,this.Ie=n,this.type="document",this.firestore=t}get Ge(){return this.Ie.path}get id(){return this.Ie.path.k()}get path(){return this.Ie.path.K()}get parent(){return new tr(this.firestore,this.je,this.Ie.path.j())}withConverter(t){return new Bn(this.firestore,t,this.Ie)}}class zn{constructor(t,e,n){this.je=e,this.Ye=n,this.type="query",this.firestore=t}withConverter(t){return new zn(this.firestore,t,this.Ye)}}class Gn{}class Hn extends Gn{constructor(t,e,n){super(),this.Ke=t,this.Je=e,this.Ze=n,this.type="where"}He(t){const e=ir(t.firestore),n=function(t,e,n,r,i,s,o){let a;if(i.tt()){if("array-contains"===s||"array-contains-any"===s)throw new C(w,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){Qn(o,s);const e=[];for(const n of o)e.push(Jn(r,t,n));a={arrayValue:{values:e}}}else a=Jn(r,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Qn(o,s),a=In(n,"where",o,"in"===s||"not-in"===s);const u=Mt.create(i,s,a);return function(t,e){if(e.wt()){const n=Pt(t);if(null!==n&&!n.isEqual(e.field))throw new C(w,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=Dt(t);null!==r&&Zn(t,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new C(w,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new C(w,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.Ye,0,e,t.firestore.jn,this.Ke,this.Je,this.Ze);return new zn(t.firestore,t.je,function(t,e){const n=t.filters.concat([e]);return new Ot(t.path,t.collectionGroup,t.ft.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.Ye,n))}}class $n extends Gn{constructor(t,e){super(),this.Ke=t,this.Xe=e,this.type="orderBy"}He(t){const e=function(t,e,n){if(null!==t.startAt)throw new C(w,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new C(w,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Wt(e,n);return function(t,e){if(null===Dt(t)){const n=Pt(t);null!==n&&Zn(t,n,e.field)}}(t,r),r}(t.Ye,this.Ke,this.Xe);return new zn(t.firestore,t.je,function(t,e){const n=t.ft.concat([e]);return new Ot(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.Ye,e))}}class Wn extends Gn{constructor(t,e,n){super(),this.type=t,this.ts=e,this.ns=n}He(t){return new zn(t.firestore,t.je,function(t,e,n){return new Ot(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.Ye,this.ts,this.ns))}}class Kn extends Gn{constructor(t,e,n){super(),this.type=t,this.es=e,this.ss=n}He(t){const e=Xn(t,this.type,this.es,this.ss);return new zn(t.firestore,t.je,function(t,e){return new Ot(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.Ye,e))}}class Yn extends Gn{constructor(t,e,n){super(),this.type=t,this.es=e,this.ss=n}He(t){const e=Xn(t,this.type,this.es,this.ss);return new zn(t.firestore,t.je,function(t,e){return new Ot(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.Ye,e))}}function Xn(t,e,n,r){if(n[0]instanceof ln&&(n[0]=n[0].Wn),n[0]instanceof Vn)return function(t,e,n,r,i){if(!r)throw new C(_,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const s=[];for(const n of Lt(t))if(n.field.tt())s.push(It(e,r.key));else{const t=r.field(n.field);if(lt(t))throw new C(w,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.K();throw new C(w,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new Ht(s,i)}(t.Ye,t.firestore.jn,e,n[0].Qe,r);{const i=ir(t.firestore);return function(t,e,n,r,i,s){const o=t.ft;if(i.length>o.length)throw new C(w,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const u=i[s];if(o[s].field.tt()){if("string"!=typeof u)throw new C(w,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof u}`);if(!Ct(t)&&-1!==u.indexOf("/"))throw new C(w,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(nt.J(u));if(!st.ot(n))throw new C(w,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new st(n);a.push(It(e,i))}else{const t=In(n,r,u);a.push(t)}}return new Ht(a,s)}(t.Ye,t.firestore.jn,i,e,n,r)}}function Jn(t,e,n){if(n instanceof ln&&(n=n.Wn),"string"==typeof n){if(""===n)throw new C(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ct(e)&&-1!==n.indexOf("/"))throw new C(w,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(nt.J(n));if(!st.ot(r))throw new C(w,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return It(t,new st(r))}if(n instanceof Bn)return It(t,n.Ie);throw new C(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Xe(n)+".")}function Qn(t,e){if(!Array.isArray(t)||0===t.length)throw new C(w,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new C(w,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Zn(t,e,n){if(!n.isEqual(e))throw new C(w,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class tr extends zn{constructor(t,e,n){super(t,e,new Ot(n)),this.firestore=t,this.Ge=n,this.type="collection"}get id(){return this.Ye.path.k()}get path(){return this.Ye.path.K()}get parent(){const t=this.Ge.j();return t.W()?null:new Bn(this.firestore,null,new st(t))}withConverter(t){return new tr(this.firestore,t,this.Ge)}}function er(t,e,...n){if(t instanceof ln&&(t=t.Wn),1===arguments.length&&(e=X.D()),We("doc","path",e),t instanceof tn){const r=nt.J(e,...n);return Ke(r),new Bn(t,null,new st(r))}{if(!(t instanceof Bn||t instanceof tr))throw new C(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t.Ge.child(nt.J(e,...n));return Ke(r),new Bn(t.firestore,t instanceof tr?t.je:null,new st(r))}}class nr extends class{We(t,e="none"){switch(pt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.rs(t.timestampValue);case 4:return this.os(t,e);case 5:return t.stringValue;case 6:return this.us(_t(t.bytesValue));case 7:return this.cs(t.referenceValue);case 8:return this.hs(t.geoPointValue);case 9:return this.ls(t.arrayValue,e);case 10:return this.fs(t.mapValue,e);default:throw q()}}fs(t,e){const n={};return at(t.fields||{},(t,r)=>{n[t]=this.We(r,e)}),n}hs(t){return new cn(bt(t.latitude),bt(t.longitude))}ls(t,e){return(t.values||[]).map(t=>this.We(t,e))}os(t,e){switch(e){case"previous":const n=function t(e){const n=e.mapValue.fields.__previous_value__;return lt(n)?t(n):n}(t);return null==n?null:this.We(n,e);case"estimate":return this.rs(ft(t));default:return null}}rs(t){const e=wt(t);return new Z(e.seconds,e.nanos)}ds(t,e){const n=nt.J(t);B(pe(n));const r=new x(n.get(1),n.get(3)),i=new st(n.M(5));return r.isEqual(e)||F(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}us(t){return new hn(t)}cs(t){const e=this.ds(t,this.firestore.jn);return new Bn(this.firestore,null,e)}}function rr(t,e){return t instanceof ln&&(t=t.Wn),e instanceof ln&&(e=e.Wn),t instanceof zn&&e instanceof zn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Kt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!gt(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$t(t.startAt,e.startAt)&&$t(t.endAt,e.endAt)}(xt(t),xt(e))&&t.limitType===e.limitType}(t.Ye,e.Ye)&&t.je===e.je}function ir(t){const e=t.kn(),n=Ge(t.jn);return new yn(t.jn,!!e.ignoreUndefinedProperties,n)}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new tn(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.900","node"),t.Bytes=hn,t.CollectionReference=tr,t.DocumentReference=Bn,t.DocumentSnapshot=Vn,t.FieldPath=fn,t.FieldValue=en,t.FirebaseFirestore=tn,t.FirestoreError=C,t.GeoPoint=cn,t.Query=zn,t.QueryConstraint=Gn,t.QueryDocumentSnapshot=Fn,t.QuerySnapshot=jn,t.Timestamp=Z,t.Transaction=Mn,t.WriteBatch=Ln,t.addDoc=function(t,e){const n=er(t=Je(t,tr)),r=Un(t.je,e),i=wn(ir(t.firestore),"addDoc",n.Ie,r,null!==n.je,{});return je($e(t.firestore),i.le(n.Ie,Ie.exists(!1))).then(()=>n)},t.arrayRemove=function(...t){return new an("arrayRemove",t)},t.arrayUnion=function(...t){return new on("arrayUnion",t)},t.collection=function(t,e,...n){if(t instanceof ln&&(t=t.Wn),We("collection","path",e),t instanceof tn){const r=nt.J(e,...n);return Ye(r),new tr(t,null,r)}{if(!(t instanceof Bn||t instanceof tr))throw new C(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=nt.J(t.path,...n).child(nt.J(e));return Ye(r),new tr(t.firestore,null,r)}},t.collectionGroup=function(t,e){if(t=Je(t,tn),We("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new C(w,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new zn(t,null,function(t){return new Ot(nt.Z(),t)}(e))},t.deleteDoc=function(t){return je($e((t=Je(t,Bn)).firestore),[new ke(t.Ie,Ie.vt())])},t.deleteField=function(){return new nn("deleteField")},t.doc=er,t.documentId=function(){return new fn("__name__")},t.endAt=function(...t){return new Yn("endAt",t,!1)},t.endBefore=function(...t){return new Yn("endBefore",t,!0)},t.getDoc=function(t){const e=$e((t=Je(t,Bn)).firestore),n=new nr(t.firestore);return qe(e,[t.Ie]).then(e=>{B(1===e.length);const r=e[0];return new Vn(t.firestore,n,t.Ie,r instanceof Pe?r:null,t.je)})},t.getDocs=function(t){!function(t){if(Rt(t)&&0===t.ft.length)throw new C(O,"limitToLast() queries require specifying at least one orderBy() clause")}((t=Je(t,zn)).Ye);const e=$e(t.firestore),n=new nr(t.firestore);return async function(t,e){const n=z(t),r=le(n.serializer,xt(e));return(await n.Fn("RunQuery",r.parent,{structuredQuery:r.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const r=oe(t,e.name),i=re(e.updateTime),s=new Oe({mapValue:{fields:e.fields}});return new Pe(r,i,s,{hasCommittedMutations:!1})})(n.serializer,t.document))}(e,t.Ye).then(e=>{const r=e.map(e=>new Fn(t.firestore,n,e.key,e,t.je));return Rt(t.Ye)&&r.reverse(),new jn(t,r)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new un("increment",t)},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore/lite").getImmediate();return r.Jn(n),r},t.limit=function(t){return Qe("limit",t),new Wn("limit",t,"F")},t.limitToLast=function(t){return Qe("limitToLast",t),new Wn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,r=qn("orderBy",t);return new $n(r,n)},t.query=function(t,...e){for(const n of e)t=n.He(t);return t},t.queryEqual=rr,t.refEqual=function(t,e){return t instanceof ln&&(t=t.Wn),e instanceof ln&&(e=e.Wn),(t instanceof Bn||t instanceof tr)&&(e instanceof Bn||e instanceof tr)&&t.firestore===e.firestore&&t.path===e.path&&t.je===e.je},t.runTransaction=function(t,e){const n=$e(t=Je(t,tn)),r=new Le;return new Cn(new Ve,n,n=>e(new Mn(t,n)),r).run(),r.promise},t.serverTimestamp=function(){return new sn("serverTimestamp")},t.setDoc=function(t,e,n){const r=Un((t=Je(t,Bn)).je,e,n),i=wn(ir(t.firestore),"setDoc",t.Ie,r,null!==t.je,n);return je($e(t.firestore),i.le(t.Ie,Ie.vt()))},t.setLogLevel=function(t){U.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof ln&&(e=e.Wn),n instanceof ln&&(n=n.Wn),e instanceof Vn&&n instanceof Vn?e.qe===n.qe&&e.Ie.isEqual(n.Ie)&&(null===e.Qe?null===n.Qe:e.Qe.isEqual(n.Qe))&&e.je===n.je:e instanceof jn&&n instanceof jn&&rr(e.query,n.query)&&Q(e.docs,n.docs,t)},t.startAfter=function(...t){return new Kn("startAfter",t,!1)},t.startAt=function(...t){return new Kn("startAt",t,!0)},t.terminate=function(t){return t=Je(t,tn),e._removeServiceInstance(t.app,"firestore/lite"),t._delete()},t.updateDoc=function(t,e,n,...r){const i=ir((t=Je(t,Bn)).firestore);let s;return e instanceof ln&&(e=e.Wn),s="string"==typeof e||e instanceof fn?_n(i,"updateDoc",t.Ie,e,n,r):bn(i,"updateDoc",t.Ie,e),je($e(t.firestore),s.le(t.Ie,Ie.exists(!0)))},t.where=function(t,e,n){const r=e,i=qn("where",t);return new Hn(i,r,n)},t.writeBatch=function(t){const e=$e(t=Je(t,tn));return new Ln(t,t=>je(e,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.performance=t.firebase.performance||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function o(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function c(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var h="FirebaseError",l=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=h,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,f.prototype.create),s}return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),f=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(g,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").";return new l(i,a,r)},t}();var d,p,g=/\{\$([^}]+)}/g;function m(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(p||(p={}));var v={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},y=p.INFO,w=((d={})[p.DEBUG]="log",d[p.VERBOSE]="log",d[p.INFO]="info",d[p.WARN]="warn",d[p.ERROR]="error",d),b=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=w[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,m(["["+i+"]  "+t.name+":"],n))}},_=function(){function t(t){this.name=t,this._logLevel=y,this._logHandler=b,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?v[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.DEBUG],t)),this._logHandler.apply(this,m([this,p.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.VERBOSE],t)),this._logHandler.apply(this,m([this,p.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.INFO],t)),this._logHandler.apply(this,m([this,p.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.WARN],t)),this._logHandler.apply(this,m([this,p.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,m([this,p.ERROR],t)),this._logHandler.apply(this,m([this,p.ERROR],t))},t}(),I=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function E(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function T(t,e,n){var r,i=new Promise(function(i,s){E(r=t[e].apply(t,n)).then(i,s)});return i.request=r,i}function S(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function A(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return T(this[e],r,arguments)})})}function k(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function N(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return t=this[e],(n=T(t,r,arguments)).then(function(t){if(t)return new R(t,n.request)});var t,n})})}function O(t){this._index=t}function R(t,e){this._cursor=t,this._request=e}function D(t){this._store=t}function P(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function C(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new P(n)}function L(t){this._db=t}S(O,"_index",["name","keyPath","multiEntry","unique"]),A(O,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),N(O,"_index",IDBIndex,["openCursor","openKeyCursor"]),S(R,"_cursor",["direction","key","primaryKey","value"]),A(R,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(R.prototype[t]=function(){var e=this,n=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,n),E(e._request).then(function(t){if(t)return new R(t,e._request)})})})}),D.prototype.createIndex=function(){return new O(this._store.createIndex.apply(this._store,arguments))},D.prototype.index=function(){return new O(this._store.index.apply(this._store,arguments))},S(D,"_store",["name","keyPath","indexNames","autoIncrement"]),A(D,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),N(D,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),k(D,"_store",IDBObjectStore,["deleteIndex"]),P.prototype.objectStore=function(){return new D(this._tx.objectStore.apply(this._tx,arguments))},S(P,"_tx",["objectStoreNames","mode"]),k(P,"_tx",IDBTransaction,["abort"]),C.prototype.createObjectStore=function(){return new D(this._db.createObjectStore.apply(this._db,arguments))},S(C,"_db",["name","version","objectStoreNames"]),k(C,"_db",IDBDatabase,["deleteObjectStore","close"]),L.prototype.transaction=function(){return new P(this._db.transaction.apply(this._db,arguments))},S(L,"_db",["name","version","objectStoreNames"]),k(L,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[D,O].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,n=(e=arguments,Array.prototype.slice.call(e)),r=n[n.length-1],i=this._store||this._index,s=i[t].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})})}),[O,D].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)})})})});var x,M="@firebase/installations",U="0.4.19",V=1e4,F="w:"+U,j="FIS_v2",q="https://firebaseinstallations.googleapis.com/v1",B=36e5,z=((x={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',x["not-registered"]="Firebase Installation is not registered.",x["installation-not-found"]="Firebase Installation not found.",x["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',x["app-offline"]="Could not process request. Application offline.",x["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",x),G=new f("installations","Installations",z);function H(t){return t instanceof l&&t.code.includes("request-failed")}function $(t){var e=t.projectId;return q+"/projects/"+e+"/installations"}function W(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function K(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,G.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}})})}function Y(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function X(t,e){var n=e.refreshToken,r=Y(t);return r.append("Authorization",function(t){return j+" "+t}(n)),r}function J(t){return s(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}})})}function Q(t){return new Promise(function(e){setTimeout(e,t)})}function Z(t){return btoa(String.fromCharCode.apply(String,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t}(t))).replace(/\+/g,"-").replace(/\//g,"_")}var tt=/^[cdef][\w-]{21}$/,et="";function nt(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return Z(t).substr(0,22)}(t);return tt.test(e)?e:et}catch(t){return et}}function rt(t){return t.appName+"!"+t.appId}var it=new Map;function st(t,e){var n=rt(t);ot(n,e),function(t,e){var n=ut();n&&n.postMessage({key:t,fid:e});ct()}(n,e)}function ot(t,e){var n,r,i=it.get(t);if(i)try{for(var s=a(i),o=s.next();!o.done;o=s.next()){(0,o.value)(e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}var at=null;function ut(){return!at&&"BroadcastChannel"in self&&((at=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){ot(t.data.key,t.data.fid)}),at}function ct(){0===it.size&&at&&(at.close(),at=null)}var ht,lt="firebase-installations-database",ft=1,dt="firebase-installations-store",pt=null;function gt(){var t,e,n;return pt||(t=function(t){switch(t.oldVersion){case 0:t.createObjectStore(dt)}},e=T(indexedDB,"open",[lt,ft]),(n=e.request)&&(n.onupgradeneeded=function(e){t&&t(new C(n.result,e.oldVersion,n.transaction))}),pt=e.then(function(t){return new L(t)})),pt}function mt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s,a;return o(this,function(o){switch(o.label){case 0:return n=rt(t),[4,gt()];case 1:return r=o.sent(),i=r.transaction(dt,"readwrite"),[4,(s=i.objectStore(dt)).get(n)];case 2:return a=o.sent(),[4,s.put(e,n)];case 3:return o.sent(),[4,i.complete];case 4:return o.sent(),a&&a.fid===e.fid||st(t,e.fid),[2,e]}})})}function vt(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return e=rt(t),[4,gt()];case 1:return n=i.sent(),[4,(r=n.transaction(dt,"readwrite")).objectStore(dt).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}})})}function yt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s,a,u;return o(this,function(o){switch(o.label){case 0:return n=rt(t),[4,gt()];case 1:return r=o.sent(),i=r.transaction(dt,"readwrite"),[4,(s=i.objectStore(dt)).get(n)];case 2:return a=o.sent(),void 0!==(u=e(a))?[3,4]:[4,s.delete(n)];case 3:return o.sent(),[3,6];case 4:return[4,s.put(u,n)];case 5:o.sent(),o.label=6;case 6:return[4,i.complete];case 7:return o.sent(),!u||a&&a.fid===u.fid||st(t,u.fid),[2,u]}})})}function wt(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return[4,yt(t,function(n){var r=function(t){return _t(t||{fid:nt(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){var n=Promise.reject(G.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,function(t,e){var n=e.fid;return s(this,void 0,void 0,function(){var e,r,i,s,a,u;return o(this,function(o){switch(o.label){case 0:return e=$(t),r=Y(t),i={fid:n,authVersion:j,appId:t.appId,sdkVersion:F},s={method:"POST",headers:r,body:JSON.stringify(i)},[4,J(function(){return fetch(e,s)})];case 1:return(a=o.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(u=o.sent()).fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:W(u.authToken)}];case 3:return[4,K("Create Installation",a)];case 4:throw o.sent()}})})}(t,e)];case 1:return n=i.sent(),[2,mt(t,n)];case 2:return H(r=i.sent())&&409===r.customData.serverCode?[4,vt(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,mt(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}})})}(t,r);return{installationEntry:r,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:function(t){return s(this,void 0,void 0,function(){var e,n,r,i;return o(this,function(s){switch(s.label){case 0:return[4,bt(t)];case 1:e=s.sent(),s.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Q(100)];case 3:return s.sent(),[4,bt(t)];case 4:return e=s.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,wt(t)];case 6:return n=s.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}})})}(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry})];case 1:return(n=i.sent()).fid!==et?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function bt(t){return yt(t,function(t){if(!t)throw G.create("installation-not-found");return _t(t)})}function _t(t){return 1===(e=t).registrationStatus&&e.registrationTime+V<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function It(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return s(this,void 0,void 0,function(){var t,i,s,a,u,c,h;return o(this,function(o){switch(o.label){case 0:return t=function(t,e){var n=e.fid;return $(t)+"/"+n+"/authTokens:generate"}(n,e),i=X(n,e),(s=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",s.getPlatformInfoString()),a={installation:{sdkVersion:F}},u={method:"POST",headers:i,body:JSON.stringify(a)},[4,J(function(){return fetch(t,u)})];case 1:return(c=o.sent()).ok?[4,c.json()]:[3,3];case 2:return h=o.sent(),[2,W(h)];case 3:return[4,K("Generate Auth Token",c)];case 4:throw o.sent()}})})}function Et(t,e){return void 0===e&&(e=!1),s(this,void 0,void 0,function(){var n,r,a;return o(this,function(u){switch(u.label){case 0:return[4,yt(t.appConfig,function(r){if(!St(r))throw G.create("not-registered");var a,u=r.authToken;if(e||2!==(a=u).requestStatus||function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+B}(a)){if(1===u.requestStatus)return n=function(t,e){return s(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return[4,Tt(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Q(100)];case 3:return i.sent(),[4,Tt(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,Et(t,e)]:[2,r]}})})}(t,e),r;if(!navigator.onLine)throw G.create("app-offline");var c=function(t){var e={requestStatus:1,requestTime:Date.now()};return i(i({},t),{authToken:e})}(r);return n=function(t,e){return s(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,It(t,e)];case 1:return n=o.sent(),s=i(i({},e),{authToken:n}),[4,mt(t.appConfig,s)];case 2:return o.sent(),[2,n];case 3:return!H(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,vt(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return s=i(i({},e),{authToken:{requestStatus:0}}),[4,mt(t.appConfig,s)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}})})}(t,c),c}return r})];case 1:return r=u.sent(),n?[4,n]:[3,3];case 2:return a=u.sent(),[3,4];case 3:a=r.authToken,u.label=4;case 4:return[2,a]}})})}function Tt(t){return yt(t,function(t){if(!St(t))throw G.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+V<Date.now()?i(i({},t),{authToken:{requestStatus:0}}):t})}function St(t){return void 0!==t&&2===t.registrationStatus}function At(t,e){return void 0===e&&(e=!1),s(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,function(t){return s(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return[4,wt(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return n.sent(),[4,Et(t,e)];case 2:return[2,n.sent().token]}})})}function kt(t,e){return s(this,void 0,void 0,function(){var n,r,i,s;return o(this,function(o){switch(o.label){case 0:return n=function(t,e){var n=e.fid;return $(t)+"/"+n}(t,e),r=X(t,e),i={method:"DELETE",headers:r},[4,J(function(){return fetch(n,i)})];case 1:return(s=o.sent()).ok?[3,3]:[4,K("Delete Installation",s)];case 2:throw o.sent();case 3:return[2]}})})}function Nt(t,e){var n=t.appConfig;return function(t,e){ut();var n=rt(t),r=it.get(n);r||(r=new Set,it.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=rt(t),r=it.get(n);r&&(r.delete(e),0===r.size&&it.delete(n),ct())}(n,e)}}function Ot(t){return G.create("missing-app-config-values",{valueName:t})}(ht=n.default).INTERNAL.registerComponent(new I("installations",function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Ot("App Configuration");if(!t.name)throw Ot("App Name");try{for(var r=a(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var s=i.value;if(!t.options[s])throw Ot(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return[4,wt(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Et(t).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(t){return At(n,t)},delete:function(){return function(t){return s(this,void 0,void 0,function(){var e,n;return o(this,function(r){switch(r.label){case 0:return[4,yt(e=t.appConfig,function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw G.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw G.create("app-offline");case 3:return[4,kt(e,n)];case 4:return r.sent(),[4,vt(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}(n)},onIdChange:function(t){return Nt(n,t)}}},"PUBLIC")),ht.registerVersion(M,U);var Rt,Dt,Pt,Ct="0.0.900",Lt="FB-PERF-TRACE-START",xt="FB-PERF-TRACE-STOP",Mt="FB-PERF-TRACE-MEASURE",Ut="_wt_",Vt="@firebase/performance/config",Ft="@firebase/performance/configexpire",jt=((Rt={})["trace started"]="Trace {$traceName} was started before.",Rt["trace stopped"]="Trace {$traceName} is not running.",Rt["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Rt["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Rt["no window"]="Window is not available.",Rt["no app id"]="App id is not available.",Rt["no project id"]="Project id is not available.",Rt["no api key"]="Api key is not available.",Rt["invalid cc log"]="Attempted to queue invalid cc event",Rt["FB not default"]="Performance can only start when Firebase app instance is the default one.",Rt["RC response not ok"]="RC response is not ok",Rt["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Rt["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Rt["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Rt["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Rt),qt=new f("performance","Performance",jt),Bt=new _("Performance");Bt.logLevel=p.INFO;var zt,Gt,Ht=function(){function t(t){if(this.window=t,!t)throw qt.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?"indexedDB"in self&&null!=indexedDB||(Bt.info("IndexedDB is not supported by current browswer"),!1):(Bt.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Dt&&(Dt=new t(Pt)),Dt},t}();function $t(){return zt}function Wt(t,e){var n=t.length-e.length;if(n<0||n>1)throw qt.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Kt,Yt=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Wt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Wt("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Gt&&(Gt=new t),Gt},t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Kt||(Kt={}));var Xt=["firebase_","google_","ga_"],Jt=new RegExp("^[a-zA-Z]\\w*$"),Qt=40,Zt=100;function te(){switch(Ht.getInstance().document.visibilityState){case"visible":return Kt.VISIBLE;case"hidden":return Kt.HIDDEN;default:return Kt.UNKNOWN}}function ee(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.appId;if(!n)throw qt.create("no app id");return n}var ne="0.0.1",re={loggingEnabled:!0},ie="FIREBASE_INSTALLATIONS_AUTH";function se(t,e){var n=function(){var t=Ht.getInstance().localStorage;if(!t)return;var e=t.getItem(Ft);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(Vt);if(!r)return;try{var i=JSON.parse(r);return i}catch(t){return}}();return n?(ae(n),Promise.resolve()):function(t,e){return(n=t.installations,r=n.getToken(),r.then(function(t){}),r).then(function(n){var r=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.projectId;if(!n)throw qt.create("no project id");return n}(t.app),i=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.apiKey;if(!n)throw qt.create("no api key");return n}(t.app),s="https://firebaseremoteconfig.googleapis.com/v1/projects/"+r+"/namespaces/fireperf:fetch?key="+i,o=new Request(s,{method:"POST",headers:{Authorization:ie+" "+n},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:ee(t.app),app_version:Ct,sdk_version:ne})});return fetch(o).then(function(t){if(t.ok)return t.json();throw qt.create("RC response not ok")})}).catch(function(){Bt.info(oe)});var n,r}(t,e).then(ae).then(function(t){return function(t){var e=Ht.getInstance().localStorage;if(!t||!e)return;e.setItem(Vt,JSON.stringify(t)),e.setItem(Ft,String(Date.now()+60*Yt.getInstance().configTimeToLive*60*1e3))}(t)},function(){})}var oe="Could not fetch config, will use default configs";function ae(t){if(!t)return t;var e=Yt.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=re.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=ue(e.tracesSamplingRate),e.logNetworkAfterSampling=ue(e.networkRequestsSamplingRate),t}function ue(t){return Math.random()<=t}var ce,he=1;function le(t){return he=2,ce=ce||function(t){return(e=Ht.getInstance().document,new Promise(function(t){if(e&&"complete"!==e.readyState){var n=function(){"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()})).then(function(){return e=t.installations,(n=e.getId()).then(function(t){zt=t}),n;var e,n}).then(function(e){return se(t,e)}).then(function(){return fe()},function(){return fe()});var e}(t)}function fe(){he=3}var de,pe=1e4,ge=5500,me=3,ve=me,ye=[],we=!1;function be(t){setTimeout(function(){if(0!==ve)return ye.length?void function(){var t=c(ye);ye=[];var e=t.map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}});(function(t,e){return function(t){var e=Yt.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(function(t){return t.ok||Bt.info("Call to Firebase backend failed."),t.json()}).then(function(t){var n=Number(t.nextRequestWaitMillis),r=pe;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(ye=c(e,ye),Bt.info("Retry transport request later.")),ve=me,be(r)})})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Yt.getInstance().logSource,log_event:e},t).catch(function(){ye=c(t,ye),ve--,Bt.info("Tries left: "+ve+"."),be(pe)})}():be(pe)},t)}function _e(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];!function(t){if(!t.eventTime||!t.message)throw qt.create("invalid cc log");ye=c(ye,[t])}({message:t.apply(void 0,e),eventTime:Date.now()})}}function Ie(t,e){de||(de=_e(Se)),de(t,e)}function Ee(t){var e=Yt.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Ht.getInstance().requiredApisAvailable()&&(t.isAuto&&te()!==Kt.VISIBLE||(3===he?Te(t):le(t.performanceController).then(function(){return Te(t)},function(){return Te(t)})))}function Te(t){if($t()){var e=Yt.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout(function(){return Ie(t,1)},0)}}function Se(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Ae(n.performanceController.app),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Ae(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Ae(t){return{google_app_id:ee(t),app_instance_id:$t(),web_app_info:{sdk_version:Ct,page_url:Ht.getInstance().getUrl(),service_worker_status:(e=Ht.getInstance().navigator,"serviceWorker"in e?e.serviceWorker.controller?2:3:1),visibility_state:te(),effective_connection_type:function(){var t=Ht.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}var ke=100,Ne="_",Oe=["_fp","_fcp","_fid"];var Re=function(){function t(t,e,n,r){void 0===n&&(n=!1),this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=Ht.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=Lt+"-"+this.randomId+"-"+this.name,this.traceStopMark=xt+"-"+this.randomId+"-"+this.name,this.traceMeasure=r||Mt+"-"+this.randomId+"-"+this.name,r&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw qt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw qt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Ee(this)},t.prototype.record=function(t,e,n){if(t<=0)throw qt.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw qt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=i({},n.attributes)),n&&n.metrics)for(var r=0,s=Object.keys(n.metrics);r<s.length;r++){var o=s[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Ee(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,s=this.name,0===i.length||i.length>ke||!(s&&s.startsWith(Ut)&&Oe.indexOf(i)>-1)&&i.startsWith(Ne))throw qt.create("invalid custom metric name",{customMetricName:t});var n,r,i,s;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Bt.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>Qt||Xt.some(function(t){return n.startsWith(t)})||!n.match(Jt)),i=function(t){return 0!==t.length&&t.length<=Zt}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw qt.create("invalid attribute name",{attributeName:t});if(!i)throw qt.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return i({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r,i){var s=Ht.getInstance().getUrl();if(s){var o=new t(e,Ut+s,!0),a=Math.floor(1e3*Ht.getInstance().getTimeOrigin());o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(1e3*n[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*n[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*n[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*n[0].loadEventEnd)));if(r){var u=r.find(function(t){return"first-paint"===t.name});u&&u.startTime&&o.putMetric("_fp",Math.floor(1e3*u.startTime));var c=r.find(function(t){return"first-contentful-paint"===t.name});c&&c.startTime&&o.putMetric("_fcp",Math.floor(1e3*c.startTime)),i&&o.putMetric("_fid",Math.floor(1e3*i))}Ee(o)}},t.createUserTimingTrace=function(e,n){Ee(new t(e,n,!1,n))},t}();function De(t,e){var n=e;if(n&&void 0!==n.responseStart){var r=Ht.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(t){var e=Yt.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return Ie(t,0)},0)}}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}}var Pe=5e3;function Ce(t){$t()&&(setTimeout(function(){return function(t){var e=Ht.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){var i=setTimeout(function(){Re.createOobTrace(t,n,r),i=void 0},Pe);e.onFirstInputDelay(function(e){i&&(clearTimeout(i),Re.createOobTrace(t,n,r,e))})}else Re.createOobTrace(t,n,r)}(t)},0),setTimeout(function(){return function(t){for(var e=Ht.getInstance(),n=e.getEntriesByType("resource"),r=0,i=n;r<i.length;r++){var s=i[r];De(t,s)}e.setupObserver("resource",function(e){return De(t,e)})}(t)},0),setTimeout(function(){return function(t){for(var e=Ht.getInstance(),n=e.getEntriesByType("measure"),r=0,i=n;r<i.length;r++){var s=i[r];Le(t,s)}e.setupObserver("measure",function(e){return Le(t,e)})}(t)},0))}function Le(t,e){var n=e.name;n.substring(0,Mt.length)!==Mt&&Re.createUserTimingTrace(t,n)}var xe=function(){function t(t,e){this.app=t,this.installations=e,this.initialized=!1}return t.prototype._init=function(t){var e=this;this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),Ht.getInstance().requiredApisAvailable()?new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}).then(function(t){t&&(we||(be(ge),we=!0),le(e).then(function(){return Ce(e)},function(){return Ce(e)}),e.initialized=!0)}).catch(function(t){Bt.info("Environment doesn't support IndexedDB: "+t)}):Bt.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Yt.getInstance().instrumentationEnabled},set:function(t){Yt.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Yt.getInstance().dataCollectionEnabled},set:function(t){Yt.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();var Me=function(t){var e=t.getProvider("app-exp").getImmediate(),n=t.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==e.name)throw qt.create("FB not default");if("undefined"==typeof window)throw qt.create("no window");return function(t){Pt=t}(window),new xe(e,n)};e._registerComponent(new I("performance-exp",Me,"PUBLIC")),e.registerVersion("@firebase/performance-exp","0.0.900"),t.getPerformance=function(t,n){var r=e._getProvider(t,"performance-exp").getImmediate();return r._init(n),r},t.trace=function(t,e){return new Re(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-performance.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["remote-config"]=t.firebase["remote-config"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function s(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var o="FirebaseError",a=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name=o,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,u.prototype.create),s}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),u=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",u=this.serviceName+": "+o+" ("+i+").";return new a(i,u,r)},t}();var c=/\{\$([^}]+)}/g,h=1e3,l=2,f=144e5,d=.5;var p,g,m=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(g||(g={}));var y,w={debug:g.DEBUG,verbose:g.VERBOSE,info:g.INFO,warn:g.WARN,error:g.ERROR,silent:g.SILENT},b=g.INFO,_=((p={})[g.DEBUG]="log",p[g.VERBOSE]="log",p[g.INFO]="info",p[g.WARN]="warn",p[g.ERROR]="error",p),I=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=_[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,v(["["+i+"]  "+t.name+":"],n))}},E=function(){function t(t){this.name=t,this._logLevel=b,this._logHandler=I,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in g))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?w[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.DEBUG],t)),this._logHandler.apply(this,v([this,g.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.VERBOSE],t)),this._logHandler.apply(this,v([this,g.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.INFO],t)),this._logHandler.apply(this,v([this,g.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.WARN],t)),this._logHandler.apply(this,v([this,g.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,v([this,g.ERROR],t)),this._logHandler.apply(this,v([this,g.ERROR],t))},t}(),T="@firebase/remote-config-exp",S="0.0.900",A=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),k="remote-config-exp",N=((y={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",y["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",y["registration-api-key"]="Undefined API key. Check Firebase app initialization.",y["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",y["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",y["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",y["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",y["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",y["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",y["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',y["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',y["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",y["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",y),O=new u("remoteconfig","Remote Config",N);var R="",D=["1","true","t","yes","y","on"],P=function(){function t(t,e){void 0===e&&(e=R),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&D.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}();function C(t){return i(this,void 0,void 0,function(){var e,n,r,i;return s(this,function(s){switch(s.label){case 0:return e=t,[4,Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()])];case 1:return n=s.sent(),r=n[0],i=n[1],r&&r.config&&r.eTag&&r.eTag!==i?[4,Promise.all([e._storageCache.setActiveConfig(r.config),e._storage.setActiveConfigEtag(r.eTag)])]:[2,!1];case 2:return s.sent(),[2,!0]}})})}function L(t){var e=t;return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(function(){e._isInitializationComplete=!0})),e._initializePromise}function x(t){return i(this,void 0,void 0,function(){var e,n,r,o,u=this;return s(this,function(c){switch(c.label){case 0:e=t,n=new A,setTimeout(function(){return i(u,void 0,void 0,function(){return s(this,function(t){return n.abort(),[2]})})},e.settings.fetchTimeoutMillis),c.label=1;case 1:return c.trys.push([1,4,,6]),[4,e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n})];case 2:return c.sent(),[4,e._storageCache.setLastFetchStatus("success")];case 3:return c.sent(),[3,6];case 4:return r=c.sent(),l="fetch-throttle",o=(h=r)instanceof a&&-1!==h.code.indexOf(l)?"throttle":"failure",[4,e._storageCache.setLastFetchStatus(o)];case 5:throw c.sent(),r;case 6:return[2]}var h,l})})}function M(t,e){var n=t;n._isInitializationComplete||n._logger.debug('A value was requested for key "'+e+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var r=n._storageCache.getActiveConfig();return r&&void 0!==r[e]?new P("remote",r[e]):n.defaultConfig&&void 0!==n.defaultConfig[e]?new P("default",String(n.defaultConfig[e])):(n._logger.debug('Returning static value for key "'+e+'". Define a default or remote value if this is unintentional.'),new P("static"))}var U=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e,n,r,i,o;return s(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}})})},t}();var V=function(){function t(t,e,n,r,i,s){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}return t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c,h,l,f,d,p,g,m,v,y,w,b;return s(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=s.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===_&&(_=navigator),_.languages&&_.languages[0]||_.language)},c={method:"POST",headers:a,body:JSON.stringify(u)},h=fetch(o,c),l=new Promise(function(e,n){t.signal.addEventListener(function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)})}),s.label=2;case 2:return s.trys.push([2,5,,6]),[4,Promise.race([h,l])];case 3:return s.sent(),[4,h];case 4:return f=s.sent(),[3,6];case 5:throw d=s.sent(),p="fetch-client-network","AbortError"===d.name&&(p="fetch-timeout"),O.create(p,{originalErrorMessage:d.message});case 6:if(g=f.status,m=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];w=void 0,s.label=7;case 7:return s.trys.push([7,9,,10]),[4,f.json()];case 8:return w=s.sent(),[3,10];case 9:throw b=s.sent(),O.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:v=w.entries,y=w.state,s.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?g=500:"NO_CHANGE"===y?g=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(v={}),304!==g&&200!==g)throw O.create("fetch-status",{httpStatus:g});return[2,{status:g,eTag:m,config:v}]}var _})})},t}();var F=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return i(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}})})},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return i(this,void 0,void 0,function(){var e,i,o;return s(this,function(s){switch(s.label){case 0:return[4,function(t,e){return new Promise(function(n,r){var i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(function(){clearTimeout(s),r(O.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof a&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+function(t,e,n){void 0===e&&(e=h),void 0===n&&(n=l);var r=e*Math.pow(n,t),i=Math.round(d*r*(Math.random()-.5)*2);return Math.min(f,r+i)}(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}})})},t}(),j=6e4,q=432e5,B=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:j,minimumFetchIntervalMillis:q},this.defaultConfig={}}return Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t}();function z(t,e){var n=t.target.error||void 0;return O.create(e,{originalErrorMessage:n&&n.message})}var G="app_namespace_store",H="firebase_remote_config",$=1;var W=function(){function t(t,e,n,r){void 0===r&&(r=new Promise(function(t,e){var n=indexedDB.open(H,$);n.onerror=function(t){e(z(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(G,{keyPath:"compositeKey"})}}})),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return i(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var s=e.transaction([G],"readonly").objectStore(G),o=n.createCompositeKey(t);try{var a=s.get(o);a.onerror=function(t){i(z(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(O.create("storage-get",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.set=function(t,e){return i(this,void 0,void 0,function(){var n,r=this;return s(this,function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise(function(i,s){var o=n.transaction([G],"readwrite").objectStore(G),a=r.createCompositeKey(t);try{var u=o.put({compositeKey:a,value:e});u.onerror=function(t){s(z(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){s(O.create("storage-set",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.delete=function(t){return i(this,void 0,void 0,function(){var e,n=this;return s(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var s=e.transaction([G],"readwrite").objectStore(G),o=n.createCompositeKey(t);try{var a=s.delete(o);a.onerror=function(t){i(z(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(t){i(O.create("storage-delete",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),K=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return i(this,void 0,void 0,function(){var t,e,n,r,i,o;return s(this,function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}})})},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();e._registerComponent(new m(k,function(t,n){var r=t.getProvider("app-exp").getImmediate(),i=t.getProvider("installations-exp-internal").getImmediate();if("undefined"==typeof window)throw O.create("registration-window");var s=r.options,o=s.projectId,a=s.apiKey,u=s.appId;if(!o)throw O.create("registration-project-id");if(!a)throw O.create("registration-api-key");if(!u)throw O.create("registration-app-id");n=n||"firebase";var c=new W(u,r.name,n),h=new K(c),l=new E(T);l.logLevel=g.ERROR;var f=new V(i,e.SDK_VERSION,n,o,a,u),d=new F(f,c),p=new U(d,c,h,l),m=new B(r,p,h,c,l);return L(m),m},"PUBLIC").setMultipleInstances(!0)),e.registerVersion(T,S),t.activate=C,t.ensureInitialized=L,t.fetchAndActivate=function(t){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,x(t)];case 1:return e.sent(),[2,C(t)]}})})},t.fetchConfig=x,t.getAll=function(t){var e=t;return(n=e._storageCache.getActiveConfig(),i=e.defaultConfig,void 0===n&&(n={}),void 0===i&&(i={}),Object.keys(r(r({},n),i))).reduce(function(e,n){return e[n]=M(t,n),e},{});var n,i},t.getBoolean=function(t,e){return M(t,e).asBoolean()},t.getNumber=function(t,e){return M(t,e).asNumber()},t.getRemoteConfig=function(t){return e._getProvider(t,k).getImmediate()},t.getString=function(t,e){return M(t,e).asString()},t.getValue=M,t.setLogLevel=function(t,e){var n=t;switch(e){case"debug":n._logger.logLevel=g.DEBUG;break;case"silent":n._logger.logLevel=g.SILENT;break;default:n._logger.logLevel=g.ERROR}},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-remote-config.js - be sure to load firebase-app.js first.")}});