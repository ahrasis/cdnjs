!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var s="FirebaseError",r=function(t){function e(n,r,o){var a=t.call(this,r)||this;return a.code=n,a.customData=o,a.name=s,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,i.prototype.create),a}return function(t,e){function s(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}(e,t),e}(Error),i=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var s=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(u,function(t,n){var s=e[n];return null!=s?String(s):"<"+n+"?>"})}(o,s):"Error",c=this.serviceName+": "+a+" ("+i+").";return new r(i,c,s)},t}();var o,a,u=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,r++)s[r]=i[o];return s}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(a||(a={}));var h={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},f=a.INFO,d=((o={})[a.DEBUG]="log",o[a.VERBOSE]="log",o[a.INFO]="info",o[a.WARN]="warn",o[a.ERROR]="error",o),p=function(t,e){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];if(!(e<t.logLevel)){var r=(new Date).toISOString(),i=d[e];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[i].apply(console,l(["["+r+"]  "+t.name+":"],n))}},m=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=p,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?h[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.DEBUG],t)),this._logHandler.apply(this,l([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.VERBOSE],t)),this._logHandler.apply(this,l([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.INFO],t)),this._logHandler.apply(this,l([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.WARN],t)),this._logHandler.apply(this,l([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.ERROR],t)),this._logHandler.apply(this,l([this,a.ERROR],t))},t}();const g="ok",w="cancelled",y="unknown",v="invalid-argument",b="deadline-exceeded",E="not-found",I="already-exists",T="permission-denied",A="unauthenticated",V="resource-exhausted",N="failed-precondition",_="aborted",S="out-of-range",D="unimplemented",L="internal",P="unavailable",j="data-loss";class R extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}class q{constructor(t,e,n,s,r,i){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=s,this.forceLongPolling=r,this.i=i}}class O{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get o(){return"(default)"===this.database}isEqual(t){return t instanceof O&&t.projectId===this.projectId&&t.database===this.database}}class x{constructor(t){this.uid=t}u(){return null!=this.uid}h(){return this.u()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}x.UNAUTHENTICATED=new x(null),x.l=new x("google-credentials-uid"),x._=new x("first-party-uid");const F=new m("@firebase/firestore");function U(t,...e){if(F.logLevel<=a.DEBUG){const n=e.map(k);F.debug("Firestore (8.1.1): "+t,...n)}}function B(t,...e){if(F.logLevel<=a.ERROR){const n=e.map(k);F.error("Firestore (8.1.1): "+t,...n)}}function k(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function $(t="Unexpected state"){const e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw B(e),new Error(e)}function C(t,e){t||$()}function M(t,e){return t}class W{constructor(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}}class G{constructor(){this.p=null}getToken(){return Promise.resolve(null)}I(){}T(t){this.p=t,t(x.UNAUTHENTICATED)}A(){this.p=null}}class H{constructor(t){this.P=null,this.currentUser=x.UNAUTHENTICATED,this.R=!1,this.V=0,this.p=null,this.forceRefresh=!1,this.P=(()=>{this.V++,this.currentUser=this.g(),this.R=!0,this.p&&this.p(this.currentUser)}),this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(t=>{this.auth=t,this.P&&this.auth.addAuthTokenListener(this.P)},()=>{}))}getToken(){const t=this.V,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.V!==t?(U("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(C("string"==typeof e.accessToken),new W(e.accessToken,this.currentUser)):null):Promise.resolve(null)}I(){this.forceRefresh=!0}T(t){this.p=t,this.R&&t(this.currentUser)}A(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.p=null}g(){const t=this.auth&&this.auth.getUid();return C(null===t||"string"==typeof t),new x(t)}}class z{constructor(t,e){this.v=t,this.N=e,this.type="FirstParty",this.user=x._}get m(){const t={"X-Goog-AuthUser":this.N},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t}}class Q{constructor(t,e){this.v=t,this.N=e}getToken(){return Promise.resolve(new z(this.v,this.N))}T(t){t(x._)}A(){}I(){}}function Y(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class K{static D(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=Y(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<e&&(n+=t.charAt(s[r]%t.length))}return n}}function X(t,e){return t<e?-1:t>e?1:0}function J(t,e,n){return t.length===e.length&&t.every((t,s)=>n(t,e[s]))}class Z{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new R(v,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new R(v,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new R(v,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new R(v,"Timestamp seconds out of range: "+t)}static now(){return Z.fromMillis(Date.now())}static fromDate(t){return Z.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new Z(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}F(t){return this.seconds===t.seconds?X(this.nanoseconds,t.nanoseconds):X(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tt{constructor(t){this.timestamp=t}static $(t){return new tt(t)}static min(){return new tt(new Z(0,0))}S(t){return this.timestamp.F(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}q(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}O(){return this.timestamp}}class et{constructor(t,e,n){void 0===e?e=0:e>t.length&&$(),void 0===n?n=t.length-e:n>t.length-e&&$(),this.segments=t,this.offset=e,this.C=n}get length(){return this.C}isEqual(t){return 0===et.L(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof et?t.forEach(t=>{e.push(t)}):e.push(t),this.U(e)}limit(){return this.offset+this.length}M(t){return t=void 0===t?1:t,this.U(this.segments,this.offset+t,this.length-t)}j(){return this.U(this.segments,this.offset,this.length-1)}B(){return this.segments[this.offset]}k(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}W(){return 0===this.length}G(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}Y(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}H(){return this.segments.slice(this.offset,this.limit())}static L(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),r=e.get(s);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class nt extends et{U(t,e,n){return new nt(t,e,n)}K(){return this.H().join("/")}toString(){return this.K()}static J(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new R(v,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new nt(e)}static Z(){return new nt([])}}const st=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rt extends et{U(t,e,n){return new rt(t,e,n)}static X(t){return st.test(t)}K(){return this.H().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rt.X(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.K()}tt(){return 1===this.length&&"__name__"===this.get(0)}static nt(){return new rt(["__name__"])}static et(t){const e=[];let n="",s=0;const r=()=>{if(0===n.length)throw new R(v,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let i=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new R(v,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new R(v,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(i=!i,s++):"."!==e||i?(n+=e,s++):(r(),s++)}if(r(),i)throw new R(v,"Unterminated ` in path: "+t);return new rt(e)}static Z(){return new rt([])}}class it{constructor(t){this.path=t}static st(t){return new it(nt.J(t))}static rt(t){return new it(nt.J(t).M(5))}it(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===nt.L(this.path,t.path)}toString(){return this.path.toString()}static L(t,e){return nt.L(t.path,e.path)}static ot(t){return t.length%2==0}static ut(t){return new it(new nt(t.slice()))}}function ot(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function at(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class ut{constructor(t){this.ct=t}static fromBase64String(t){const e=atob(t);return new ut(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ut(e)}toBase64(){return t=this.ct,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.ct)}at(){return 2*this.ct.length}S(t){return X(this.ct,t.ct)}isEqual(t){return this.ct===t.ct}}function ct(t){return null==t}function lt(t){return 0===t&&1/t==-1/0}function ht(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ft(t){const e=vt(t.mapValue.fields.__local_write_time__.timestampValue);return new Z(e.seconds,e.nanos)}ut.ht=new ut("");const dt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ht(t)?4:10:$()}function mt(t,e){const n=pt(t);if(n!==pt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ft(t).isEqual(ft(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=vt(t.timestampValue),s=vt(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Et(t.bytesValue).isEqual(Et(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return bt(t.geoPointValue.latitude)===bt(e.geoPointValue.latitude)&&bt(t.geoPointValue.longitude)===bt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bt(t.integerValue)===bt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=bt(t.doubleValue),s=bt(e.doubleValue);return n===s?lt(n)===lt(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return J(t.arrayValue.values||[],e.arrayValue.values||[],mt);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(ot(n)!==ot(s))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===s[t]||!mt(n[t],s[t])))return!1;return!0}(t,e);default:return $()}}function gt(t,e){return void 0!==(t.values||[]).find(t=>mt(t,e))}function wt(t,e){const n=pt(t),s=pt(e);if(n!==s)return X(n,s);switch(n){case 0:return 0;case 1:return X(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=bt(t.integerValue||t.doubleValue),s=bt(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return yt(t.timestampValue,e.timestampValue);case 4:return yt(ft(t),ft(e));case 5:return X(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Et(t),s=Et(e);return n.S(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let t=0;t<n.length&&t<s.length;t++){const e=X(n[t],s[t]);if(0!==e)return e}return X(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=X(bt(t.latitude),bt(e.latitude));return 0!==n?n:X(bt(t.longitude),bt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let t=0;t<n.length&&t<s.length;++t){const e=wt(n[t],s[t]);if(e)return e}return X(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},s=Object.keys(n),r=e.fields||{},i=Object.keys(r);s.sort(),i.sort();for(let t=0;t<s.length&&t<i.length;++t){const e=X(s[t],i[t]);if(0!==e)return e;const o=wt(n[s[t]],r[i[t]]);if(0!==o)return o}return X(s.length,i.length)}(t.mapValue,e.mapValue);default:throw $()}}function yt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return X(t,e);const n=vt(t),s=vt(e),r=X(n.seconds,s.seconds);return 0!==r?r:X(n.nanos,s.nanos)}function vt(t){if(C(!!t),"string"==typeof t){let e=0;const n=dt.exec(t);if(C(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:bt(t.seconds),nanos:bt(t.nanos)}}function bt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Et(t){return"string"==typeof t?ut.fromBase64String(t):ut.fromUint8Array(t)}function It(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.K()}`}}function Tt(t){return!!t&&"arrayValue"in t}function At(t){return!!t&&"nullValue"in t}function Vt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nt(t){return!!t&&"mapValue"in t}class _t{constructor(t,e=null,n=[],s=[],r=null,i=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=i,this.endAt=o,this.lt=null}}function St(t,e=null,n=[],s=[],r=null,i=null,o=null){return new _t(t,e,n,s,r,i,o)}class Dt{constructor(t,e=null,n=[],s=[],r=null,i="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.ft=n,this.filters=s,this.limit=r,this.limitType=i,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function Lt(t){return!ct(t.limit)&&"L"===t.limitType}function Pt(t){return t.ft.length>0?t.ft[0].field:null}function jt(t){for(const e of t.filters)if(e.wt())return e.field;return null}function Rt(t){return null!==t.collectionGroup}function qt(t){const e=M(t);if(null===e.dt){e.dt=[];const t=jt(e),n=Pt(e);if(null!==t&&null===n)t.tt()||e.dt.push(new zt(t)),e.dt.push(new zt(rt.nt(),"asc"));else{let t=!1;for(const n of e.ft)e.dt.push(n),n.field.tt()&&(t=!0);if(!t){const t=e.ft.length>0?e.ft[e.ft.length-1].dir:"asc";e.dt.push(new zt(rt.nt(),t))}}}return e.dt}function Ot(t){const e=M(t);if(!e._t)if("F"===e.limitType)e._t=St(e.path,e.collectionGroup,qt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of qt(e)){const e="desc"===n.dir?"asc":"desc";t.push(new zt(n.field,e))}const n=e.endAt?new Gt(e.endAt.position,!e.endAt.before):null,s=e.startAt?new Gt(e.startAt.position,!e.startAt.before):null;e._t=St(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e._t}class xt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.yt(t,e,n):new Ft(t,e,n):"array-contains"===e?new $t(t,n):"in"===e?new Ct(t,n):"not-in"===e?new Mt(t,n):"array-contains-any"===e?new Wt(t,n):new xt(t,e,n)}static yt(t,e,n){return"in"===e?new Ut(t,n):new Bt(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.Et(wt(e,this.value)):null!==e&&pt(this.value)===pt(e)&&this.Et(wt(e,this.value))}Et(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return $()}}wt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ft extends xt{constructor(t,e,n){super(t,e,n),this.key=it.rt(n.referenceValue)}matches(t){const e=it.L(t.key,this.key);return this.Et(e)}}class Ut extends xt{constructor(t,e){super(t,"in",e),this.keys=kt("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Bt extends xt{constructor(t,e){super(t,"not-in",e),this.keys=kt("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function kt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>it.rt(t.referenceValue))}class $t extends xt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Tt(e)&&gt(e.arrayValue,this.value)}}class Ct extends xt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&gt(this.value.arrayValue,e)}}class Mt extends xt{constructor(t,e){super(t,"not-in",e)}matches(t){if(gt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!gt(this.value.arrayValue,e)}}class Wt extends xt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Tt(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>gt(this.value.arrayValue,t))}}class Gt{constructor(t,e){this.position=t,this.before=e}}function Ht(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mt(t.position[n],e.position[n]))return!1;return!0}class zt{constructor(t,e="asc"){this.field=t,this.dir=e}}function Qt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Yt,Kt;function Xt(t){if(void 0===t)return B("RPC_ERROR","HTTP error has no status"),y;switch(t){case 200:return g;case 400:return N;case 401:return A;case 403:return T;case 404:return E;case 409:return _;case 416:return S;case 429:return V;case 499:return w;case 500:return y;case 501:return D;case 503:return P;case 504:return b;default:return t>=200&&t<300?g:t>=400&&t<500?N:t>=500&&t<600?L:y}}(Kt=Yt||(Yt={}))[Kt.OK=0]="OK",Kt[Kt.CANCELLED=1]="CANCELLED",Kt[Kt.UNKNOWN=2]="UNKNOWN",Kt[Kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kt[Kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kt[Kt.NOT_FOUND=5]="NOT_FOUND",Kt[Kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kt[Kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kt[Kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kt[Kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kt[Kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kt[Kt.ABORTED=10]="ABORTED",Kt[Kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kt[Kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kt[Kt.INTERNAL=13]="INTERNAL",Kt[Kt.UNAVAILABLE=14]="UNAVAILABLE",Kt[Kt.DATA_LOSS=15]="DATA_LOSS";const Jt={asc:"ASCENDING",desc:"DESCENDING"},Zt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class te{constructor(t,e){this.t=t,this.It=e}}function ee(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!lt(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.It){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lt(e)?"-0":e}}(t,e)}function ne(t,e){return t.It?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function se(t){return C(!!t),tt.$(function(t){const e=vt(t);return new Z(e.seconds,e.nanos)}(t))}function re(t,e){return function(t){return new nt(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).K()}function ie(t,e){return re(t.t,e.path)}function oe(t,e){const n=function(t){const e=nt.J(t);return C(pe(e)),e}(e);if(n.get(1)!==t.t.projectId)throw new R(v,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new R(v,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new it((C((s=n).length>4&&"documents"===s.get(4)),s.M(5)));var s}function ae(t,e){return re(t.t,e)}function ue(t){return new nt(["projects",t.t.projectId,"databases",t.t.database]).K()}function ce(t,e,n){return{name:ie(t,e),fields:n.proto.mapValue.fields}}function le(t,e){let n;if(e instanceof Ae)n={update:ce(t,e.key,e.value)};else if(e instanceof _e)n={delete:ie(t,e.key)};else if(e instanceof Ve)n={update:ce(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.K())),{fieldPaths:e}}(e.Tt)};else if(e instanceof Ne)n={transform:{document:ie(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof ge)return{fieldPath:e.field.K(),setToServerValue:"REQUEST_TIME"};if(n instanceof we)return{fieldPath:e.field.K(),appendMissingElements:{values:n.elements}};if(n instanceof ye)return{fieldPath:e.field.K(),removeAllFromArray:{values:n.elements}};if(n instanceof ve)return{fieldPath:e.field.K(),increment:n.At};throw $()})(0,t))}};else{if(!(e instanceof Se))return $();n={verify:ie(t,e.key)}}return e.Rt.Pt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return ne(t,e.O())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:$()}(t,e.Rt)),n}function he(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=ae(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ae(t,s.j()),n.structuredQuery.from=[{collectionId:s.k()}]);const r=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(Vt(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NAN"}};if(At(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vt(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NOT_NAN"}};if(At(t.value))return{unaryFilter:{field:de(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:de(t.field),op:function(t){return Zt[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:de(t.field),direction:function(t){return Jt[t]}(t.dir)}})(t))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(t,e){return t.It||ct(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=fe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=fe(e.endAt)),n}function fe(t){return{before:t.before,values:t.position}}function de(t){return{fieldPath:t.K()}}function pe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class me{constructor(){this.Vt=void 0}}class ge extends me{}class we extends me{constructor(t){super(),this.elements=t}}class ye extends me{constructor(t){super(),this.elements=t}}class ve extends me{constructor(t,e){super(),this.serializer=t,this.At=e}}class be{constructor(t){this.fields=t,t.sort(rt.L)}gt(t){for(const e of this.fields)if(e.G(t))return!0;return!1}isEqual(t){return J(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class Ee{constructor(t,e){this.field=t,this.transform=e}}class Ie{constructor(t,e){this.updateTime=t,this.exists=e}static vt(){return new Ie}static exists(t){return new Ie(void 0,t)}static updateTime(t){return new Ie(t)}get Pt(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Te{}class Ae extends Te{constructor(t,e,n){super(),this.key=t,this.value=e,this.Rt=n,this.type=0}}class Ve extends Te{constructor(t,e,n,s){super(),this.key=t,this.data=e,this.Tt=n,this.Rt=s,this.type=1}}class Ne extends Te{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.Rt=Ie.exists(!0)}}class _e extends Te{constructor(t,e){super(),this.key=t,this.Rt=e,this.type=3}}class Se extends Te{constructor(t,e){super(),this.key=t,this.Rt=e,this.type=4}}class De{constructor(t){this.proto=t}static empty(){return new De({mapValue:{}})}field(t){if(t.W())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Nt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null}}isEqual(t){return mt(this.proto,t.proto)}}class Le{constructor(t=De.empty()){this.bt=t,this.Nt=new Map}set(t,e){return this.Dt(t,e),this}delete(t){return this.Dt(t,null),this}Dt(t,e){let n=this.Nt;for(let e=0;e<t.length-1;++e){const s=t.get(e);let r=n.get(s);r instanceof Map?n=r:r&&10===pt(r)?(r=new Map(Object.entries(r.mapValue.fields||{})),n.set(s,r),n=r):(r=new Map,n.set(s,r),n=r)}n.set(t.k(),e)}Ft(){const t=this.$t(rt.Z(),this.Nt);return null!=t?new De(t):this.bt}$t(t,e){let n=!1;const s=this.bt.field(t),r=Nt(s)?Object.assign({},s.mapValue.fields):{};return e.forEach((e,s)=>{if(e instanceof Map){const i=this.$t(t.child(s),e);null!=i&&(r[s]=i,n=!0)}else null!==e?(r[s]=e,n=!0):r.hasOwnProperty(s)&&(delete r[s],n=!0)}),n?{mapValue:{fields:r}}:null}}class Pe{constructor(t,e){this.key=t,this.version=e}}class je extends Pe{constructor(t,e,n,s){super(t,e),this.St=n,this.xt=!!s.xt,this.hasCommittedMutations=!!s.hasCommittedMutations}field(t){return this.St.field(t)}data(){return this.St}qt(){return this.St.proto}isEqual(t){return t instanceof je&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.xt===t.xt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.St.isEqual(t.St)}toString(){return`Document(${this.key}, ${this.version}, ${this.St.toString()}, {hasLocalMutations: ${this.xt}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.xt||this.hasCommittedMutations}}class Re extends Pe{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Re&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class qe{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class Oe{constructor(t,e,n=1e3,s=1.5,r=6e4){this.Ot=t,this.Ct=e,this.Lt=n,this.Ut=s,this.Mt=r,this.jt=0,this.Bt=null,this.kt=Date.now(),this.reset()}reset(){this.jt=0}Qt(){this.jt=this.Mt}Wt(t){this.cancel();const e=Math.floor(this.jt+this.zt()),n=Math.max(0,Date.now()-this.kt),s=Math.max(0,e-n);s>0&&U("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.jt} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bt=this.Ot.Gt(this.Ct,s,()=>(this.kt=Date.now(),t())),this.jt*=this.Ut,this.jt<this.Lt&&(this.jt=this.Lt),this.jt>this.Mt&&(this.jt=this.Mt)}Yt(){null!==this.Bt&&(this.Bt.Ht(),this.Bt=null)}cancel(){null!==this.Bt&&(this.Bt.cancel(),this.Bt=null)}zt(){return(Math.random()-.5)*this.jt}}function xe(){return"undefined"!=typeof document?document:null}class Fe{constructor(t,e,n,s,r){this.Kt=t,this.Ct=e,this.Jt=n,this.op=s,this.Zt=r,this.Xt=new qe,this.then=this.Xt.promise.then.bind(this.Xt.promise),this.Xt.promise.catch(t=>{})}static tn(t,e,n,s,r){const i=Date.now()+n,o=new Fe(t,e,i,s,r);return o.start(n),o}start(t){this.nn=setTimeout(()=>this.en(),t)}Ht(){return this.en()}cancel(t){null!==this.nn&&(this.clearTimeout(),this.Xt.reject(new R(w,"Operation cancelled"+(t?": "+t:""))))}en(){this.Kt.sn(()=>null!==this.nn?(this.clearTimeout(),this.op().then(t=>this.Xt.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.nn&&(this.Zt(this),clearTimeout(this.nn),this.nn=null)}}class Ue{constructor(){this.rn=Promise.resolve(),this.on=[],this.un=!1,this.cn=[],this.an=null,this.hn=!1,this.ln=[],this.fn=new Oe(this,"async_queue_retry"),this.dn=(()=>{const t=xe();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.fn.Yt()});const t=xe();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.dn)}get _n(){return this.un}sn(t){this.enqueue(t)}wn(t){this.mn(),this.pn(t)}yn(){if(!this.un){this.un=!0;const t=xe();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.dn)}}enqueue(t){return this.mn(),this.un?new Promise(t=>{}):this.pn(t)}En(t){this.sn(()=>(this.on.push(t),this.In()))}async In(){if(0!==this.on.length){try{await this.on[0](),this.on.shift(),this.fn.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;U("AsyncQueue","Operation failed with retryable error: "+t)}this.on.length>0&&this.fn.Wt(()=>this.In())}}pn(t){const e=this.rn.then(()=>(this.hn=!0,t().catch(t=>{throw this.an=t,this.hn=!1,B("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.hn=!1,t))));return this.rn=e,e}Gt(t,e,n){this.mn(),this.ln.indexOf(t)>-1&&(e=0);const s=Fe.tn(this,t,e,n,t=>this.Tn(t));return this.cn.push(s),s}mn(){this.an&&$()}An(){}async Pn(){let t;do{t=this.rn,await t}while(t!==this.rn)}Rn(t){for(const e of this.cn)if(e.Ct===t)return!0;return!1}Vn(t){return this.Pn().then(()=>{this.cn.sort((t,e)=>t.Jt-e.Jt);for(const e of this.cn)if(e.Ht(),"all"!==t&&e.Ct===t)break;return this.Pn()})}gn(t){this.ln.push(t)}Tn(t){const e=this.cn.indexOf(t);this.cn.splice(e,1)}}class Be extends class{}{constructor(t,e,n){super(),this.credentials=t,this.vn=e,this.serializer=n,this.bn=!1}Nn(){if(this.bn)throw new R(N,"The client has already been terminated.")}Dn(t,e,n){return this.Nn(),this.credentials.getToken().then(s=>this.vn.Dn(t,e,n,s)).catch(t=>{throw t.code===A&&this.credentials.I(),t})}Fn(t,e,n){return this.Nn(),this.credentials.getToken().then(s=>this.vn.Fn(t,e,n,s)).catch(t=>{throw t.code===A&&this.credentials.I(),t})}terminate(){this.bn=!1}}async function ke(t,e){const n=M(t),s=ue(n.serializer)+"/documents",r={writes:e.map(t=>le(n.serializer,t))};await n.Dn("Commit",s,r)}async function $e(t,e){const n=M(t),s=ue(n.serializer)+"/documents",r={documents:e.map(t=>ie(n.serializer,t))},i=await n.Fn("BatchGetDocuments",s,r),o=new Map;i.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){C(!!e.found),e.found.name,e.found.updateTime;const n=oe(t,e.found.name),s=se(e.found.updateTime),r=new De({mapValue:{fields:e.found.fields}});return new je(n,s,r,{})}(t,e):"missing"in e?function(t,e){C(!!e.missing),C(!!e.readTime);const n=oe(t,e.missing),s=se(e.readTime);return new Re(n,s)}(t,e):$()}(n.serializer,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());C(!!e),a.push(e)}),a}const Ce={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Me extends class{constructor(t){this.$n=t,this.t=t.t;const e=t.ssl?"https":"http";this.Sn=e+"://"+t.host,this.xn="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}Dn(t,e,n,s){const r=this.qn(t,e);U("RestConnection","Sending: ",r,n);const i={};return this.On(i,s),this.Cn(t,r,i,n).then(t=>(U("RestConnection","Received: ",t),t),e=>{throw function(t,...e){if(F.logLevel<=a.WARN){const t=e.map(k);F.warn("Firestore (8.1.1): RestConnection",...t)}}(0,t+" failed with error: ",e,"url: ",r,"request:",n),e})}Fn(t,e,n,s){return this.Dn(t,e,n,s)}On(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(const n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])}qn(t,e){const n=Ce[t];return`${this.Sn}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.Ln=e}Un(t,e){throw new Error("Not supported by FetchConnection")}async Cn(t,e,n,s){const r=JSON.stringify(s);let i;try{i=await this.Ln(e,{method:"POST",headers:n,body:r})}catch(t){throw new R(Xt(t.status),"Request failed with error: "+t.statusText)}if(!i.ok)throw new R(Xt(i.status),"Request failed with error: "+i.statusText);return i.json()}}function We(t){return new te(t,!0)}const Ge=new Map;function He(t){if(t.Mn)throw new R(N,"The client has already been terminated.");if(!Ge.has(t)){U("ComponentProvider","Initializing Datastore");const r=function(t){return new Me(t,fetch.bind(null))}((e=t.jn,n=t.Bn,s=t.kn(),new q(e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling))),i=We(t.jn),o=function(t,e,n){return new Be(t,r,i)}(t.Qn);Ge.set(t,o)}var e,n,s;return Ge.get(t)}function ze(t,e,n){if(!n)throw new R(v,`Function ${t}() cannot be called with an empty ${e}.`)}function Qe(t){if(!it.ot(t))throw new R(v,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ye(t){if(it.ot(t))throw new R(v,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ke(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":$()}function Xe(t,e){if("_delegate"in t&&(t=t.Wn),!(t instanceof e)){if(e.name===t.constructor.name)throw new R(v,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ke(t);throw new R(v,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Je(t,e){if(e<=0)throw new R(v,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Ze{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new R(v,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new R(v,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,function(t,e,n,s){if(!0===e&&!0===s)throw new R(v,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties}}class tn{constructor(t,e){this.Bn="(lite)",this.zn=new Ze({}),this.Gn=!1,t instanceof O?(this.jn=t,this.Qn=new G):(this.Yn=t,this.jn=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new R(v,'"projectId" not provided in firebase.initializeApp.');return new O(t.options.projectId)}(t),this.Qn=new H(e))}get app(){if(!this.Yn)throw new R(N,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yn}get Hn(){return this.Gn}get Mn(){return void 0!==this.Kn}Jn(t){if(this.Gn)throw new R(N,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.zn=new Ze(t),void 0!==t.credentials&&(this.Qn=function(t){if(!t)return new G;switch(t.type){case"gapi":const e=t.client;return C(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Q(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new R(v,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}Zn(){return this.zn}kn(){return this.Gn=!0,this.zn}_delete(){return this.Kn||(this.Kn=this.Xn()),this.Kn}Xn(){return function(t){const e=Ge.get(t);e&&(U("ComponentProvider","Removing Datastore"),Ge.delete(t),e.terminate())}(this),Promise.resolve()}}class en{constructor(t){this._methodName=t}}class nn extends en{te(t){if(2!==t.ne)throw 1===t.ne?t.ee(this._methodName+"() can only appear at the top level of your update data"):t.ee(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Tt.push(t.path),null}isEqual(t){return t instanceof nn}}function sn(t,e,n){return new wn({ne:3,se:e.settings.se,methodName:t._methodName,re:n},e.t,e.serializer,e.ignoreUndefinedProperties)}class rn extends en{te(t){return new Ee(t.path,new ge)}isEqual(t){return t instanceof rn}}class on extends en{constructor(t,e){super(t),this.ie=e}te(t){const e=sn(this,t,!0),n=this.ie.map(t=>Tn(t,e)),s=new we(n);return new Ee(t.path,s)}isEqual(t){return this===t}}class an extends en{constructor(t,e){super(t),this.ie=e}te(t){const e=sn(this,t,!0),n=this.ie.map(t=>Tn(t,e)),s=new ye(n);return new Ee(t.path,s)}isEqual(t){return this===t}}class un extends en{constructor(t,e){super(t),this.oe=e}te(t){const e=new ve(t.serializer,ee(t.serializer,this.oe));return new Ee(t.path,e)}isEqual(t){return this===t}}class cn{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new R(v,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new R(v,"Longitude must be a number between -180 and 180, but was: "+e);this.ue=t,this.ce=e}get latitude(){return this.ue}get longitude(){return this.ce}isEqual(t){return this.ue===t.ue&&this.ce===t.ce}toJSON(){return{latitude:this.ue,longitude:this.ce}}F(t){return X(this.ue,t.ue)||X(this.ce,t.ce)}}class ln{constructor(t){this.ae=t}static fromBase64String(t){try{return new ln(ut.fromBase64String(t))}catch(t){throw new R(v,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new ln(ut.fromUint8Array(t))}toBase64(){return this.ae.toBase64()}toUint8Array(){return this.ae.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.ae.isEqual(t.ae)}}class hn{constructor(t){this.Wn=t}}class fn{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new R(v,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.he=new rt(t)}isEqual(t){return this.he.isEqual(t.he)}}const dn=/^__.*__$/;class pn{constructor(t,e,n){this.data=t,this.Tt=e,this.fieldTransforms=n}le(t,e){const n=[];return null!==this.Tt?n.push(new Ve(t,this.data,this.Tt,e)):n.push(new Ae(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ne(t,this.fieldTransforms)),n}}class mn{constructor(t,e,n){this.data=t,this.Tt=e,this.fieldTransforms=n}le(t,e){const n=[new Ve(t,this.data,this.Tt,e)];return this.fieldTransforms.length>0&&n.push(new Ne(t,this.fieldTransforms)),n}}function gn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class wn{constructor(t,e,n,s,r,i){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=s,void 0===r&&this.fe(),this.fieldTransforms=r||[],this.Tt=i||[]}get path(){return this.settings.path}get ne(){return this.settings.ne}de(t){return new wn(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Tt)}_e(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.de({path:n,re:!1});return s.we(t),s}me(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.de({path:n,re:!1});return s.fe(),s}pe(t){return this.de({path:void 0,re:!0})}ee(t){return Ln(t,this.settings.methodName,this.settings.ye||!1,this.path,this.settings.se)}contains(t){return void 0!==this.Tt.find(e=>t.G(e))||void 0!==this.fieldTransforms.find(e=>t.G(e.field))}fe(){if(this.path)for(let t=0;t<this.path.length;t++)this.we(this.path.get(t))}we(t){if(0===t.length)throw this.ee("Document fields must not be empty");if(gn(this.ne)&&dn.test(t))throw this.ee('Document fields cannot begin and end with "__"')}}class yn{constructor(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||We(t)}Ee(t,e,n,s=!1){return new wn({ne:t,methodName:e,se:n,path:rt.Z(),re:!1,ye:s},this.t,this.serializer,this.ignoreUndefinedProperties)}}function vn(t,e,n,s,r,i={}){const o=t.Ee(i.merge||i.mergeFields?2:0,e,n,r);Nn("Data must be an object, but it was:",o,s);const a=An(s,o);let u,c;if(i.merge)u=new be(o.Tt),c=o.fieldTransforms;else if(i.mergeFields){const t=[];for(const s of i.mergeFields){const r=_n(e,s,n);if(!o.contains(r))throw new R(v,`Field '${r}' is specified in your field mask but missing from your input data.`);Pn(t,r)||t.push(r)}u=new be(t),c=o.fieldTransforms.filter(t=>u.gt(t.field))}else u=null,c=o.fieldTransforms;return new pn(new De(a),u,c)}function bn(t,e,n,s){const r=t.Ee(1,e,n);Nn("Data must be an object, but it was:",r,s);const i=[],o=new Le;at(s,(t,s)=>{const a=Dn(e,t,n);s instanceof hn&&(s=s.Wn);const u=r.me(a);if(s instanceof nn)i.push(a);else{const t=Tn(s,u);null!=t&&(i.push(a),o.set(a,t))}});const a=new be(i);return new mn(o.Ft(),a,r.fieldTransforms)}function En(t,e,n,s,r,i){const o=t.Ee(1,e,n),a=[_n(e,s,n)],u=[r];if(i.length%2!=0)throw new R(v,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<i.length;t+=2)a.push(_n(e,i[t])),u.push(i[t+1]);const c=[],l=new Le;for(let t=a.length-1;t>=0;--t)if(!Pn(c,a[t])){const e=a[t];let n=u[t];n instanceof hn&&(n=n.Wn);const s=o.me(e);if(n instanceof nn)c.push(e);else{const t=Tn(n,s);null!=t&&(c.push(e),l.set(e,t))}}const h=new be(c);return new mn(l.Ft(),h,o.fieldTransforms)}function In(t,e,n,s=!1){return Tn(n,t.Ee(s?4:3,e))}function Tn(t,e){if(t instanceof hn&&(t=t.Wn),Vn(t))return Nn("Unsupported field value:",e,t),An(t,e);if(t instanceof en)return function(t,e){if(!gn(e.ne))throw e.ee(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.ee(t._methodName+"() is not currently supported inside arrays");const n=t.te(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Tt.push(e.path),t instanceof Array){if(e.settings.re&&4!==e.ne)throw e.ee("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const r of t){let t=Tn(r,e.pe(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof hn&&(t=t.Wn),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ee(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Z.fromDate(t);return{timestampValue:ne(e.serializer,n)}}if(t instanceof Z){const n=new Z(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ne(e.serializer,n)}}if(t instanceof cn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ln)return{bytesValue:function(t,e){return t.It?e.toBase64():e.toUint8Array()}(e.serializer,t.ae)};if(t instanceof Cn){const n=e.t,s=t.firestore.jn;if(!s.isEqual(n))throw e.ee(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:re(t.firestore.jn||e.t,t.Ie.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ee("Unsupported field value: "+Ke(t))}(t,e)}function An(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.Tt.push(e.path):at(t,(t,s)=>{const r=Tn(s,e._e(t));null!=r&&(n[t]=r)}),{mapValue:{fields:n}}}function Vn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Z||t instanceof cn||t instanceof ln||t instanceof Cn||t instanceof en)}function Nn(t,e,n){if(!Vn(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const s=Ke(n);throw"an object"===s?e.ee(t+" a custom object"):e.ee(t+" "+s)}}function _n(t,e,n){if(e instanceof hn&&(e=e.Wn),e instanceof fn)return e.he;if("string"==typeof e)return Dn(t,e);throw Ln("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const Sn=new RegExp("[~\\*/\\[\\]]");function Dn(t,e,n){if(e.search(Sn)>=0)throw Ln(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fn(...e.split(".")).he}catch(s){throw Ln(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ln(t,e,n,s,r){const i=s&&!s.W(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)");let u="";return(i||o)&&(u+=" (found",i&&(u+=" in field "+s),o&&(u+=" in document "+r),u+=")"),new R(v,(a+=". ")+t+u)}function Pn(t,e){return t.some(t=>t.isEqual(e))}class jn{constructor(t){this.Te=t,this.Ae=new Map,this.mutations=[],this.Pe=!1,this.Re=null,this.Ve=new Set}async ge(t){if(this.ve(),this.mutations.length>0)throw new R(v,"Firestore transactions require all reads to be executed before all writes.");const e=await $e(this.Te,t);return e.forEach(t=>{t instanceof Re||t instanceof je?this.be(t):$()}),e}set(t,e){this.write(e.le(t,this.Rt(t))),this.Ve.add(t.toString())}update(t,e){try{this.write(e.le(t,this.Ne(t)))}catch(t){this.Re=t}this.Ve.add(t.toString())}delete(t){this.write([new _e(t,this.Rt(t))]),this.Ve.add(t.toString())}async commit(){if(this.ve(),this.Re)throw this.Re;const t=this.Ae;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=it.st(e);this.mutations.push(new Se(n,this.Rt(n)))}),await ke(this.Te,this.mutations),this.Pe=!0}be(t){let e;if(t instanceof je)e=t.version;else{if(!(t instanceof Re))throw $();e=tt.min()}const n=this.Ae.get(t.key.toString());if(n){if(!e.isEqual(n))throw new R(_,"Document version changed between two reads.")}else this.Ae.set(t.key.toString(),e)}Rt(t){const e=this.Ae.get(t.toString());return!this.Ve.has(t.toString())&&e?Ie.updateTime(e):Ie.vt()}Ne(t){const e=this.Ae.get(t.toString());if(!this.Ve.has(t.toString())&&e){if(e.isEqual(tt.min()))throw new R(v,"Can't update a document that doesn't exist.");return Ie.updateTime(e)}return Ie.exists(!0)}write(t){this.ve(),this.mutations=this.mutations.concat(t)}ve(){}}class Rn{constructor(t,e,n,s){this.Kt=t,this.Te=e,this.updateFunction=n,this.Xt=s,this.De=5,this.fn=new Oe(this.Kt,"transaction_retry")}run(){this.Fe()}Fe(){this.fn.Wt(async()=>{const t=new jn(this.Te),e=this.$e(t);e&&e.then(e=>{this.Kt.sn(()=>t.commit().then(()=>{this.Xt.resolve(e)}).catch(t=>{this.Se(t)}))}).catch(t=>{this.Se(t)})})}$e(t){try{const e=this.updateFunction(t);return!ct(e)&&e.catch&&e.then?e:(this.Xt.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Xt.reject(t),null}}Se(t){this.De>0&&this.xe(t)?(this.De-=1,this.Kt.sn(()=>(this.Fe(),Promise.resolve()))):this.Xt.reject(t)}xe(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case g:return $();case w:case y:case b:case V:case L:case P:case A:return!1;case v:case E:case I:case T:case N:case _:case S:case D:case j:return!0;default:return $()}}()}return!1}}class qn{constructor(t,e){this.qe=t,this.Oe=e,this.Ce=[],this.Le=!1,this.Ue=rs(t)}set(t,e,n){this.Me();const s=On(t,this.qe),r=Fn(s.je,e,n),i=vn(this.Ue,"WriteBatch.set",s.Ie,r,null!==s.je,n);return this.Ce=this.Ce.concat(i.le(s.Ie,Ie.vt())),this}update(t,e,n,...s){this.Me();const r=On(t,this.qe);let i;return e instanceof hn&&(e=e.Wn),i="string"==typeof e||e instanceof fn?En(this.Ue,"WriteBatch.update",r.Ie,e,n,s):bn(this.Ue,"WriteBatch.update",r.Ie,e),this.Ce=this.Ce.concat(i.le(r.Ie,Ie.exists(!0))),this}delete(t){this.Me();const e=On(t,this.qe);return this.Ce=this.Ce.concat(new _e(e.Ie,Ie.vt())),this}commit(){return this.Me(),this.Le=!0,this.Ce.length>0?this.Oe(this.Ce):Promise.resolve()}Me(){if(this.Le)throw new R(N,"A write batch can no longer be used after commit() has been called.")}}function On(t,e){if(t instanceof hn&&(t=t.Wn),t.firestore!==e)throw new R(v,"Provided document reference is from a different Firestore instance.");return t}class xn{constructor(t,e){this.qe=t,this.Be=e,this.Ue=rs(t)}get(t){const e=On(t,this.qe),n=new ns(this.qe);return this.Be.ge([e.Ie]).then(t=>{if(!t||1!==t.length)return $();const s=t[0];if(s instanceof Re)return new Un(this.qe,n,e.Ie,null,e.je);if(s instanceof je)return new Un(this.qe,n,s.key,s,e.je);throw $()})}set(t,e,n){const s=On(t,this.qe),r=Fn(s.je,e,n),i=vn(this.Ue,"Transaction.set",s.Ie,r,null!==s.je,n);return this.Be.set(s.Ie,i),this}update(t,e,n,...s){const r=On(t,this.qe);let i;return e instanceof hn&&(e=e.Wn),i="string"==typeof e||e instanceof fn?En(this.Ue,"Transaction.update",r.Ie,e,n,s):bn(this.Ue,"Transaction.update",r.Ie,e),this.Be.update(r.Ie,i),this}delete(t){const e=On(t,this.qe);return this.Be.delete(e.Ie),this}}function Fn(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Un{constructor(t,e,n,s,r){this.qe=t,this.ke=e,this.Ie=n,this.Qe=s,this.je=r}get id(){return this.Ie.path.k()}get ref(){return new Cn(this.qe,this.je,this.Ie)}exists(){return null!==this.Qe}data(){if(this.Qe){if(this.je){const t=new Bn(this.qe,this.ke,this.Ie,this.Qe,null);return this.je.fromFirestore(t)}return this.ke.We(this.Qe.qt())}}get(t){if(this.Qe){const e=this.Qe.data().field($n("DocumentSnapshot.get",t));if(null!==e)return this.ke.We(e)}}}class Bn extends Un{data(){return super.data()}}class kn{constructor(t,e){this.ze=e,this.query=t}get docs(){return[...this.ze]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.ze.forEach(t,e)}}function $n(t,e){return"string"==typeof e?Dn(t,e):e instanceof hn?e.Wn.he:e.he}class Cn{constructor(t,e,n){this.je=e,this.Ie=n,this.type="document",this.firestore=t}get Ge(){return this.Ie.path}get id(){return this.Ie.path.k()}get path(){return this.Ie.path.K()}get parent(){return new ts(this.firestore,this.je,this.Ie.path.j())}withConverter(t){return new Cn(this.firestore,t,this.Ie)}}class Mn{constructor(t,e,n){this.je=e,this.Ye=n,this.type="query",this.firestore=t}withConverter(t){return new Mn(this.firestore,t,this.Ye)}}class Wn{}class Gn extends Wn{constructor(t,e,n){super(),this.Ke=t,this.Je=e,this.Ze=n,this.type="where"}He(t){const e=rs(t.firestore),n=function(t,e,n,s,r,i,o){let a;if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new R(v,`Invalid Query. You can't perform '${i}' queries on FieldPath.documentId().`);if("in"===i||"not-in"===i){Jn(o,i);const e=[];for(const n of o)e.push(Xn(s,t,n));a={arrayValue:{values:e}}}else a=Xn(s,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Jn(o,i),a=In(n,"where",o,"in"===i||"not-in"===i);const u=xt.create(r,i,a);return function(t,e){if(e.wt()){const n=jt(t);if(null!==n&&!n.isEqual(e.field))throw new R(v,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const s=Pt(t);null!==s&&Zn(t,e.field,s)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new R(v,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new R(v,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.Ye,0,e,t.firestore.jn,this.Ke,this.Je,this.Ze);return new Mn(t.firestore,t.je,function(t,e){const n=t.filters.concat([e]);return new Dt(t.path,t.collectionGroup,t.ft.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.Ye,n))}}class Hn extends Wn{constructor(t,e){super(),this.Ke=t,this.Xe=e,this.type="orderBy"}He(t){const e=function(t,e,n){if(null!==t.startAt)throw new R(v,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new R(v,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new zt(e,n);return function(t,e){if(null===Pt(t)){const n=jt(t);null!==n&&Zn(t,n,e.field)}}(t,s),s}(t.Ye,this.Ke,this.Xe);return new Mn(t.firestore,t.je,function(t,e){const n=t.ft.concat([e]);return new Dt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.Ye,e))}}class zn extends Wn{constructor(t,e,n){super(),this.type=t,this.ts=e,this.ns=n}He(t){return new Mn(t.firestore,t.je,function(t,e,n){return new Dt(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.Ye,this.ts,this.ns))}}class Qn extends Wn{constructor(t,e,n){super(),this.type=t,this.es=e,this.ss=n}He(t){const e=Kn(t,this.type,this.es,this.ss);return new Mn(t.firestore,t.je,function(t,e){return new Dt(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.Ye,e))}}class Yn extends Wn{constructor(t,e,n){super(),this.type=t,this.es=e,this.ss=n}He(t){const e=Kn(t,this.type,this.es,this.ss);return new Mn(t.firestore,t.je,function(t,e){return new Dt(t.path,t.collectionGroup,t.ft.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.Ye,e))}}function Kn(t,e,n,s){if(n[0]instanceof hn&&(n[0]=n[0].Wn),n[0]instanceof Un)return function(t,e,n,s,r){if(!s)throw new R(E,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const i=[];for(const n of qt(t))if(n.field.tt())i.push(It(e,s.key));else{const t=s.field(n.field);if(ht(t))throw new R(v,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.K();throw new R(v,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}i.push(t)}return new Gt(i,r)}(t.Ye,t.firestore.jn,e,n[0].Qe,s);{const r=rs(t.firestore);return function(t,e,n,s,r,i){const o=t.ft;if(r.length>o.length)throw new R(v,`Too many arguments provided to ${s}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let i=0;i<r.length;i++){const u=r[i];if(o[i].field.tt()){if("string"!=typeof u)throw new R(v,`Invalid query. Expected a string for document ID in ${s}(), but got a ${typeof u}`);if(!Rt(t)&&-1!==u.indexOf("/"))throw new R(v,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${s}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(nt.J(u));if(!it.ot(n))throw new R(v,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${s}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new it(n);a.push(It(e,r))}else{const t=In(n,s,u);a.push(t)}}return new Gt(a,i)}(t.Ye,t.firestore.jn,r,e,n,s)}}function Xn(t,e,n){if(n instanceof hn&&(n=n.Wn),"string"==typeof n){if(""===n)throw new R(v,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rt(e)&&-1!==n.indexOf("/"))throw new R(v,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(nt.J(n));if(!it.ot(s))throw new R(v,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return It(t,new it(s))}if(n instanceof Cn)return It(t,n.Ie);throw new R(v,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ke(n)+".")}function Jn(t,e){if(!Array.isArray(t)||0===t.length)throw new R(v,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new R(v,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Zn(t,e,n){if(!n.isEqual(e))throw new R(v,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class ts extends Mn{constructor(t,e,n){super(t,e,new Dt(n)),this.firestore=t,this.Ge=n,this.type="collection"}get id(){return this.Ye.path.k()}get path(){return this.Ye.path.K()}get parent(){const t=this.Ge.j();return t.W()?null:new Cn(this.firestore,null,new it(t))}withConverter(t){return new ts(this.firestore,t,this.Ge)}}function es(t,e,...n){if(t instanceof hn&&(t=t.Wn),1===arguments.length&&(e=K.D()),ze("doc","path",e),t instanceof tn){const s=nt.J(e,...n);return Qe(s),new Cn(t,null,new it(s))}{if(!(t instanceof Cn||t instanceof ts))throw new R(v,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t.Ge.child(nt.J(e,...n));return Qe(s),new Cn(t.firestore,t instanceof ts?t.je:null,new it(s))}}class ns extends class{We(t,e="none"){switch(pt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.rs(t.timestampValue);case 4:return this.os(t,e);case 5:return t.stringValue;case 6:return this.us(Et(t.bytesValue));case 7:return this.cs(t.referenceValue);case 8:return this.hs(t.geoPointValue);case 9:return this.ls(t.arrayValue,e);case 10:return this.fs(t.mapValue,e);default:throw $()}}fs(t,e){const n={};return at(t.fields||{},(t,s)=>{n[t]=this.We(s,e)}),n}hs(t){return new cn(bt(t.latitude),bt(t.longitude))}ls(t,e){return(t.values||[]).map(t=>this.We(t,e))}os(t,e){switch(e){case"previous":const n=function t(e){const n=e.mapValue.fields.__previous_value__;return ht(n)?t(n):n}(t);return null==n?null:this.We(n,e);case"estimate":return this.rs(ft(t));default:return null}}rs(t){const e=vt(t);return new Z(e.seconds,e.nanos)}ds(t,e){const n=nt.J(t);C(pe(n));const s=new O(n.get(1),n.get(3)),r=new it(n.M(5));return s.isEqual(e)||B(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}{constructor(t){super(),this.firestore=t}us(t){return new ln(t)}cs(t){const e=this.ds(t,this.firestore.jn);return new Cn(this.firestore,null,e)}}function ss(t,e){return t instanceof hn&&(t=t.Wn),e instanceof hn&&(e=e.Wn),t instanceof Mn&&e instanceof Mn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Qt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!mt(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ht(t.startAt,e.startAt)&&Ht(t.endAt,e.endAt)}(Ot(t),Ot(e))&&t.limitType===e.limitType}(t.Ye,e.Ye)&&t.je===e.je}function rs(t){const e=t.kn(),n=We(t.jn);return new yn(t.jn,!!e.ignoreUndefinedProperties,n)}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new tn(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.900","node"),t.Bytes=ln,t.CollectionReference=ts,t.DocumentReference=Cn,t.DocumentSnapshot=Un,t.FieldPath=fn,t.FieldValue=en,t.FirebaseFirestore=tn,t.FirestoreError=R,t.GeoPoint=cn,t.Query=Mn,t.QueryConstraint=Wn,t.QueryDocumentSnapshot=Bn,t.QuerySnapshot=kn,t.Timestamp=Z,t.Transaction=xn,t.WriteBatch=qn,t.addDoc=function(t,e){const n=es(t=Xe(t,ts)),s=Fn(t.je,e),r=vn(rs(t.firestore),"addDoc",n.Ie,s,null!==n.je,{});return ke(He(t.firestore),r.le(n.Ie,Ie.exists(!1))).then(()=>n)},t.arrayRemove=function(...t){return new an("arrayRemove",t)},t.arrayUnion=function(...t){return new on("arrayUnion",t)},t.collection=function(t,e,...n){if(t instanceof hn&&(t=t.Wn),ze("collection","path",e),t instanceof tn){const s=nt.J(e,...n);return Ye(s),new ts(t,null,s)}{if(!(t instanceof Cn||t instanceof ts))throw new R(v,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=nt.J(t.path,...n).child(nt.J(e));return Ye(s),new ts(t.firestore,null,s)}},t.collectionGroup=function(t,e){if(t=Xe(t,tn),ze("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new R(v,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Mn(t,null,function(t){return new Dt(nt.Z(),t)}(e))},t.deleteDoc=function(t){return ke(He((t=Xe(t,Cn)).firestore),[new _e(t.Ie,Ie.vt())])},t.deleteField=function(){return new nn("deleteField")},t.doc=es,t.documentId=function(){return new fn("__name__")},t.endAt=function(...t){return new Yn("endAt",t,!1)},t.endBefore=function(...t){return new Yn("endBefore",t,!0)},t.getDoc=function(t){const e=He((t=Xe(t,Cn)).firestore),n=new ns(t.firestore);return $e(e,[t.Ie]).then(e=>{C(1===e.length);const s=e[0];return new Un(t.firestore,n,t.Ie,s instanceof je?s:null,t.je)})},t.getDocs=function(t){!function(t){if(Lt(t)&&0===t.ft.length)throw new R(D,"limitToLast() queries require specifying at least one orderBy() clause")}((t=Xe(t,Mn)).Ye);const e=He(t.firestore),n=new ns(t.firestore);return async function(t,e){const n=M(t),s=he(n.serializer,Ot(e));return(await n.Fn("RunQuery",s.parent,{structuredQuery:s.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const s=oe(t,e.name),r=se(e.updateTime),i=new De({mapValue:{fields:e.fields}});return new je(s,r,i,{hasCommittedMutations:!1})})(n.serializer,t.document))}(e,t.Ye).then(e=>{const s=e.map(e=>new Bn(t.firestore,n,e.key,e,t.je));return Lt(t.Ye)&&s.reverse(),new kn(t,s)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new un("increment",t)},t.initializeFirestore=function(t,n){const s=e._getProvider(t,"firestore/lite").getImmediate();return s.Jn(n),s},t.limit=function(t){return Je("limit",t),new zn("limit",t,"F")},t.limitToLast=function(t){return Je("limitToLast",t),new zn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,s=$n("orderBy",t);return new Hn(s,n)},t.query=function(t,...e){for(const n of e)t=n.He(t);return t},t.queryEqual=ss,t.refEqual=function(t,e){return t instanceof hn&&(t=t.Wn),e instanceof hn&&(e=e.Wn),(t instanceof Cn||t instanceof ts)&&(e instanceof Cn||e instanceof ts)&&t.firestore===e.firestore&&t.path===e.path&&t.je===e.je},t.runTransaction=function(t,e){const n=He(t=Xe(t,tn)),s=new qe;return new Rn(new Ue,n,n=>e(new xn(t,n)),s).run(),s.promise},t.serverTimestamp=function(){return new rn("serverTimestamp")},t.setDoc=function(t,e,n){const s=Fn((t=Xe(t,Cn)).je,e,n),r=vn(rs(t.firestore),"setDoc",t.Ie,s,null!==t.je,n);return ke(He(t.firestore),r.le(t.Ie,Ie.vt()))},t.setLogLevel=function(t){F.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof hn&&(e=e.Wn),n instanceof hn&&(n=n.Wn),e instanceof Un&&n instanceof Un?e.qe===n.qe&&e.Ie.isEqual(n.Ie)&&(null===e.Qe?null===n.Qe:e.Qe.isEqual(n.Qe))&&e.je===n.je:e instanceof kn&&n instanceof kn&&ss(e.query,n.query)&&J(e.docs,n.docs,t)},t.startAfter=function(...t){return new Qn("startAfter",t,!1)},t.startAt=function(...t){return new Qn("startAt",t,!0)},t.terminate=function(t){return t=Xe(t,tn),e._removeServiceInstance(t.app,"firestore/lite"),t._delete()},t.updateDoc=function(t,e,n,...s){const r=rs((t=Xe(t,Cn)).firestore);let i;return e instanceof hn&&(e=e.Wn),i="string"==typeof e||e instanceof fn?En(r,"updateDoc",t.Ie,e,n,s):bn(r,"updateDoc",t.Ie,e),ke(He(t.firestore),i.le(t.Ie,Ie.exists(!0)))},t.where=function(t,e,n){const s=e,r=$n("where",t);return new Gn(r,s,n)},t.writeBatch=function(t){const e=He(t=Xe(t,tn));return new qn(t,t=>ke(e,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}});