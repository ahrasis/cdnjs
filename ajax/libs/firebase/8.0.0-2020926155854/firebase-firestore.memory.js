!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(_f){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(_f),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},L=O||self;function D(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function R(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),U=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++U))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Y=L.navigator;if(Y){Y=Y.userAgent;if(Y){K=Y;break t}}K=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it=Q(K,"Opera"),ot=Q(K,"Trident")||Q(K,"MSIE"),st=Q(K,"Edge"),ut=st||ot,at=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),ht=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ct(){var t=L.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=K,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=L.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!L.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{L.addEventListener("test",D,e),L.removeEventListener("test",D,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),kt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[It]?e.wa(n,r,_(i)?!!i.capture:!!i,o):_t(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[It]?t.va(e,n,_(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Mt(t);if(h||(t[Dt]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function Ut(t){return t in kt?kt[t]:kt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Vt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=L,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new bt(e,this))}function Mt(t){return(t=t[Dt])instanceof Ot?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==k(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function qt(){F.call(this),this.c=new Ot(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[It]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=xt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Lt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=L.JSON.stringify;function Wt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Kt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Xt(t,e){var n;Bt||(n=L.Promise.resolve(void 0),Bt=function(){n.then(Yt)}),Qt||(Bt(),Qt=!0),Jt.add(t,e)}Wt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Wt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){L.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function $t(t,e){qt.call(this),this.b=t||1,this.a=e||L,this.f=M(this.Ya,this),this.g=x()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==k(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:L.setTimeout(t,e||0)}q($t,qt),(N=$t.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(L.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){F.call(this),this.b=t,this.a={}}q(ue,F);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return L.setTimeout(function(){t()},e)}q(ye,wt),q(ge,wt),q(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Oe,O={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function Le(){wt.call(this,"c")}function De(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=Re,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Se,wt),q(Le,wt),q(De,Te),Oe=new De;var Re=45e3,_e={},Pe={};function Ue(t,e,n){t.H=1,t.i=en(Qe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=x(),Me(t),t.l=Qe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),qe(t))}function Me(t){t.U=x()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function xe(t){t.o&&(L.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||rr(t.g,t)}function Fe(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),zn(u)}Zn(u),me(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(xe(o),Me(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=h[0]&&"close"!=h[0]||or(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?or(u,7):Bn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ve(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)W(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=ke.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),xe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Fe(this),qe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Ge(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Fe(this),qe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(xe(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,Fe(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Fe(this),this.h=2,qe(this)):je(this,this.U-n)},(N=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,Ye(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=nn(n[2]||""),Ye(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Qe(t){return new Xe(t)}function Je(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new Be,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function dn(t,e){return fn(t),e=vn(t,e),He(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),z(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=L.PerformanceNavigationTiming?0<(t=L.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(L.ia&&L.ia.ya&&L.ia.ya()&&L.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){W(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=B(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return L.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return L.JSON.parse(t,void 0)};var Dn=L.JSON.parse;function kn(t){qt.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}q(kn,qt);var Rn="",_n=/^https?$/i,Pn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),jn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.X()))if(t.l&&4==qn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&L.self&&L.self.location&&(i=(r=L.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(L.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,tn(n=Qe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=en(Qe(n)),n=!1,L.navigator&&L.navigator.sendBeacon&&(n=L.navigator.sendBeacon(e.i.toString(),"")),!n&&L.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=x(),Me(e)),sr(t)}function zn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(L.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&L.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Ue(n,r,e)}function Jn(t,n){t.f&&We({},function(t,e){tn(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;_(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(L.clearTimeout(t.s),t.s=null)}function er(t){t.a=new ke(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Jn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Qe(e)),n.j=null,n.I=!0,Ve(n,t)}function nr(t){null!=t.m&&(L.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),L.location&&"http"==L.location.protocol||Je(r,"https"),en(r)),n=r.toString(),r=o,o=new le,L.Image?((i=new Image).onload=j(Ln,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(Ln,o,i,"TestLoadImage: error",!1,r),i.onabort=j(Ln,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(Ln,o,i,"TestLoadImage: timeout",!1,r),L.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Hn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Qe(s):new Xe(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),$e(a,a.h)):(u=L.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Je(u,r),i&&Ye(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Jn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Ka)).F=t.C,e}function hr(){}function cr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){qt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){Le.call(this),this.status=1}function dr(t){this.a=t}(N=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Oe),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=L.FormData&&t instanceof L.FormData,0<=G(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},N.Ta=function(){Mn(this)},N.X=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),tn(i=Qe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Fn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||bn(this.b)||Qn(this))},N.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),er(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),Zn(this),me(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new lr(t,e)},q(lr,qt),(N=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Xn(t)},N.close=function(){Bn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Gt(t),Kn(this.a,e)):Kn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,lr.S.G.call(this)},q(fr,Se),q(pr,Le),q(dr,hr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",qt.prototype.listen=qt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.X,kn.prototype.getResponseJson=kn.prototype.Na,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var yr=Ee,vr=Ie,gr=Ne,mr=kn,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Or,Er=Error),Or),Ar="8.0.0-2020926155854",Nr=new l("@firebase/firestore");function Or(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Nr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.DEBUG&&(e=n.map(Rr),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.ERROR&&(e=n.map(Rr),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.WARN&&(e=n.map(Rr),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Pr(t){t||_r()}var Ur=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Cr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var jr=(xr.fromBase64String=function(t){return new xr(atob(t))},xr.fromUint8Array=function(t){return new xr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},xr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},xr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},xr.prototype.o=function(){return 2*this.i.length},xr.prototype.h=function(t){return Cr(this.i,t.i)},xr.prototype.isEqual=function(t){return this.i===t.i},xr);function xr(t){this.i=t}jr.u=new jr("");var qr=(Fr.fromBase64String=function(t){try{return new Fr(jr.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Fr.fromUint8Array=function(t){return new Fr(jr.fromUint8Array(t))},Fr.prototype.toBase64=function(){return this.l.toBase64()},Fr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Fr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Fr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Fr);function Fr(t){this.l=t}function Gr(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wr(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Br(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var zr,Hr=(n(Qr,zr=qr),Qr.fromBase64String=function(t){Wr();try{return new Qr(jr.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Qr.fromUint8Array=function(t){return Gr(),new Qr(jr.fromUint8Array(t))},Qr.prototype.toBase64=function(){return Wr(),zr.prototype.toBase64.call(this)},Qr.prototype.toUint8Array=function(){return Gr(),zr.prototype.toUint8Array.call(this)},Qr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Qr),Kr=(Object.defineProperty(Xr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Xr.prototype.isEqual=function(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database},Xr.prototype.h=function(t){return Cr(this.projectId,t.projectId)||Cr(this.database,t.database)},Xr);function Xr(t,e){this.projectId=t,this.database=e||"(default)"}function Qr(){return null!==zr&&zr.apply(this,arguments)||this}function Jr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Yr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Zr,ti,ei=(di.prototype.get=function(t){var e=this.I(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},di.prototype.has=function(t){return void 0!==this.get(t)},di.prototype.set=function(t,e){var n=this.I(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},di.prototype.delete=function(t){var e=this.I(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},di.prototype.forEach=function(s){Yr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},di.prototype.P=function(){return $r(this.R)},di),ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.V=function(t){return this.seconds===t.seconds?Cr(this.nanoseconds,t.nanoseconds):Cr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(fi.p=function(t){return new fi(t)},fi.min=function(){return new fi(new ni(0,0))},fi.prototype.h=function(t){return this.timestamp.V(t.timestamp)},fi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},fi.prototype.g=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},fi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},fi.prototype.v=function(){return this.timestamp},fi),l=(Object.defineProperty(li.prototype,"length",{get:function(){return this.C},enumerable:!1,configurable:!0}),li.prototype.isEqual=function(t){return 0===li.S(this,t)},li.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof li?t.forEach(function(t){e.push(t)}):e.push(t),this.D(e)},li.prototype.limit=function(){return this.offset+this.length},li.prototype.F=function(t){return t=void 0===t?1:t,this.D(this.segments,this.offset+t,this.length-t)},li.prototype.N=function(){return this.D(this.segments,this.offset,this.length-1)},li.prototype.$=function(){return this.segments[this.offset]},li.prototype.k=function(){return this.get(this.length-1)},li.prototype.get=function(t){return this.segments[this.offset+t]},li.prototype.P=function(){return 0===this.length},li.prototype.O=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.M=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},li.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},li.S=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},li),ii=(n(ci,ti=l),ci.prototype.D=function(t,e,n){return new ci(t,e,n)},ci.prototype.q=function(){return this.L().join("/")},ci.prototype.toString=function(){return this.q()},ci.U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ci(n)},ci.B=function(){return new ci([])},ci),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(n(hi,Zr=l),hi.prototype.D=function(t,e,n){return new hi(t,e,n)},hi.j=function(t){return oi.test(t)},hi.prototype.q=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),hi.j(t)||(t="`"+t+"`"),t}).join(".")},hi.prototype.toString=function(){return this.q()},hi.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},hi.K=function(){return new hi(["__name__"])},hi.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new hi(e)},hi.B=function(){return new hi([])},hi),ui=(ai.H=function(t){return new ai(ii.U(t))},ai.Y=function(t){return new ai(ii.U(t).F(5))},ai.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.S(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.S=function(t,e){return ii.S(t.path,e.path)},ai.X=function(t){return t.length%2==0},ai.Z=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function hi(){return null!==Zr&&Zr.apply(this,arguments)||this}function ci(){return null!==ti&&ti.apply(this,arguments)||this}function li(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.C=n}function fi(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t,e){this.I=t,this.A=e,this.R={}}function yi(t){return null==t}function vi(t){return 0===t&&1/t==-1/0}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e=t;return null===e.tt&&(t=e.path.q(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.q()+t.op.toString()+wo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.q()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Gu(e.startAt)),e.endAt&&(t+="|ub:",t+=Gu(e.endAt)),e.tt=t),e.tt}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!yo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function Ei(t){return ui.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ii(t){this.count=t}var Ti,Ai=(Ni.prototype.st=function(t){return new Ni(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ni.prototype.it=function(t,e){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ni.prototype.rt=function(t){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ni);function Ni(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=jr.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Oi(t){switch(t){case Ir.OK:return _r(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return _r(),0}}function Si(t){if(void 0===t)return Dr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Ti.OK:return Ir.OK;case Ti.CANCELLED:return Ir.CANCELLED;case Ti.UNKNOWN:return Ir.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Ir.INTERNAL;case Ti.UNAVAILABLE:return Ir.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Ir.NOT_FOUND;case Ti.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Ti.ABORTED:return Ir.ABORTED;case Ti.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Ti.DATA_LOSS:return Ir.DATA_LOSS;default:return _r()}}(l=Ti=Ti||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Li=(Pi.prototype.ot=function(t,e){return new Pi(this.S,this.root.ot(t,e,this.S).copy(null,null,ki.ht,null,null))},Pi.prototype.remove=function(t){return new Pi(this.S,this.root.remove(t,this.S).copy(null,null,ki.ht,null,null))},Pi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.S(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.S(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pi.prototype.P=function(){return this.root.P()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pi.prototype.ct=function(){return this.root.ct()},Pi.prototype.ut=function(){return this.root.ut()},Pi.prototype.at=function(t){return this.root.at(t)},Pi.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Pi.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pi.prototype.lt=function(t){return this.root.lt(t)},Pi.prototype._t=function(){return new Di(this.root,null,this.S,!1)},Pi.prototype.ft=function(t){return new Di(this.root,t,this.S,!1)},Pi.prototype.dt=function(){return new Di(this.root,null,this.S,!0)},Pi.prototype.wt=function(t){return new Di(this.root,t,this.S,!0)},Pi),Di=(_i.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},_i.prototype.At=function(){return 0<this.Tt.length},_i.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},_i),ki=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype.P=function(){return!1},Ri.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Ri.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ri.prototype.min=function(){return this.left.P()?this:this.left.min()},Ri.prototype.ct=function(){return this.min().key},Ri.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},Ri.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Ri.prototype.Vt=function(){if(this.left.P())return Ri.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Vt(),null)).Pt()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.vt()),r.right.P()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.P())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Vt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Ri.prototype.yt=function(){return this.color},Ri.prototype.Pt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.Ct()),t.left.yt()&&t.left.left.yt()&&(t=t.vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},Ri.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).Ct()).St()),t},Ri.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.vt()).St()),t},Ri.prototype.Ct=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.vt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.Dt=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Ri.prototype.Ft=function(){if(this.yt()&&this.left.yt())throw _r();if(this.right.yt())throw _r();var t=this.left.Ft();if(t!==this.right.Ft())throw _r();return t+(this.yt()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function _i(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Pi(t,e){this.S=t,this.root=e||ki.EMPTY}function Ui(){this.size=0}ki.EMPTY=null,ki.RED=!0,ki.ht=!1,ki.EMPTY=(Object.defineProperty(Ui.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Ui.prototype.copy=function(t,e,n,r,i){return this},Ui.prototype.ot=function(t,e,n){return new ki(t,e)},Ui.prototype.remove=function(t,e){return this},Ui.prototype.P=function(){return!0},Ui.prototype.at=function(t){return!1},Ui.prototype.lt=function(t){return!1},Ui.prototype.ct=function(){return null},Ui.prototype.ut=function(){return null},Ui.prototype.yt=function(){return!1},Ui.prototype.Dt=function(){return!0},Ui.prototype.Ft=function(){return 0},new Ui);var Vi=(xi.prototype.has=function(t){return null!==this.data.get(t)},xi.prototype.first=function(){return this.data.ct()},xi.prototype.last=function(){return this.data.ut()},Object.defineProperty(xi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xi.prototype.indexOf=function(t){return this.data.indexOf(t)},xi.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},xi.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.S(r.key,t[1]))return;e(r.key)}},xi.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},xi.prototype.$t=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},xi.prototype._t=function(){return new Ci(this.data._t())},xi.prototype.ft=function(t){return new Ci(this.data.ft(t))},xi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},xi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xi.prototype.P=function(){return this.data.P()},xi.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xi.prototype.isEqual=function(t){if(!(t instanceof xi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.S(r,i))return!1}return!0},xi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xi.prototype.copy=function(t){var e=new xi(this.S);return e.data=t,e},xi),Ci=(ji.prototype.It=function(){return this.Ot.It().key},ji.prototype.At=function(){return this.Ot.At()},ji),Mi=new Li(ui.S);function ji(t){this.Ot=t}function xi(t){this.S=t,this.data=new Li(this.S)}var qi=new Li(ui.S);var Fi=new Li(ui.S),Gi=new Vi(ui.S);function Wi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Bi=new Vi(Cr);var zi=(uo.qt=function(t){return new uo(t.S)},uo.prototype.has=function(t){return null!=this.Mt.get(t)},uo.prototype.get=function(t){return this.Mt.get(t)},uo.prototype.first=function(){return this.Lt.ct()},uo.prototype.last=function(){return this.Lt.ut()},uo.prototype.P=function(){return this.Lt.P()},uo.prototype.indexOf=function(t){t=this.Mt.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.Lt.at(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.ot(t.key,t),e.Lt.ot(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Lt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.S=this.S,n.Mt=t,n.Lt=e,n},uo),Hi=(so.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):_r()},so.prototype.Bt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},so),Ki=(oo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new oo(t,e,zi.qt(e),i,n,r,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.Wt.P()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Qt===t.Qt&&this.Wt.isEqual(t.Wt)&&lu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.jt.isEqual(t.jt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},oo),Xi=(io.Xt=function(t,e){var n=new Map;return n.set(t,Qi.Zt(t,e)),new io(ri.min(),n,Bi,Mi,Wi())},io),Qi=(ro.Zt=function(t,e){return new ro(jr.u,e,Wi(),Wi(),Wi())},ro),Ji=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Yi=function(t,e){this.targetId=t,this.oe=e},$i=function(t,e,n,r){void 0===n&&(n=jr.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Zi=(Object.defineProperty(no.prototype,"te",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"_e",{get:function(){return 0!==this.he},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),no.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ue=t)},no.prototype.we=function(){var n=Wi(),r=Wi(),i=Wi();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new Qi(this.ue,this.ae,n,r,i)},no.prototype.Ee=function(){this.le=!1,this.ce=ho()},no.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},no.prototype.me=function(t){this.le=!0,this.ce=this.ce.remove(t)},no.prototype.Ie=function(){this.he+=1},no.prototype.Ae=function(){--this.he},no.prototype.Re=function(){this.le=!0,this.ae=!0},no),to=(eo.prototype.ve=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Ks?this.be(r,t.re):t.re instanceof Xs&&this.Ce(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ce(s,t.key,t.re)}},eo.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Fe(t);switch(n.state){case 0:r.Ne(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Ne(t)&&(r.xe(t),e.de(n.resumeToken));break;default:_r()}})},eo.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ve.forEach(function(t,e){r.Ne(e)&&n(e)})},eo.prototype.$e=function(t){var e=t.targetId,n=t.oe.count,t=this.ke(e);t&&(Ei(t=t.target)?0===n?(t=new ui(t.path),this.Ce(e,t,new Xs(t,ri.min()))):Pr(1===n):this.Oe(e)!==n&&(this.xe(e),this.ge=this.ge.add(e)))},eo.prototype.Me=function(r){var i=this,o=new Map;this.Ve.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&Ei(n.target)&&(n=new ui(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Ce(e,n,new Xs(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Wi();this.pe.forEach(function(t,e){var n=!0;e.xt(function(t){t=i.ke(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Xi(r,o,this.ge,this.ye,s);return this.ye=Mi,this.pe=ao(),this.ge=new Vi(Cr),t},eo.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Le(t,e.key)?2:0,this.Fe(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.pe=this.pe.ot(e.key,this.qe(e.key).add(t)))},eo.prototype.Ce=function(t,e,n){var r;this.Ne(t)&&(r=this.Fe(t),this.Le(t,e)?r.Te(e,1):r.me(e),this.pe=this.pe.ot(e,this.qe(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},eo.prototype.removeTarget=function(t){this.Ve.delete(t)},eo.prototype.Oe=function(t){var e=this.Fe(t).we();return this.Pe.Ue(t).size+e.ee.size-e.se.size},eo.prototype.Ie=function(t){this.Fe(t).Ie()},eo.prototype.Fe=function(t){var e=this.Ve.get(t);return e||(e=new Zi,this.Ve.set(t,e)),e},eo.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new Vi(Cr),this.pe=this.pe.ot(t,e)),e},eo.prototype.Ne=function(t){var e=null!==this.ke(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.ke=function(t){var e=this.Ve.get(t);return e&&e._e?null:this.Pe.Be(t)},eo.prototype.xe=function(e){var n=this;this.Ve.set(e,new Zi),this.Pe.Ue(e).forEach(function(t){n.Ce(e,t,null)})},eo.prototype.Le=function(t,e){return this.Pe.Ue(t).has(e)},eo);function eo(t){this.Pe=t,this.Ve=new Map,this.ye=Mi,this.pe=ao(),this.ge=new Vi(Cr)}function no(){this.he=0,this.ce=ho(),this.ue=jr.u,this.ae=!1,this.le=!0}function ro(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function io(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function oo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.jt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.Qt=s,this.Kt=u}function so(){this.Ut=new Li(ui.S)}function uo(n){this.S=n?function(t,e){return n(t,e)||ui.S(t.key,e.key)}:function(t,e){return ui.S(t.key,e.key)},this.Mt=qi,this.Lt=new Li(this.S)}function ao(){return new Li(ui.S)}function ho(){return new Li(ui.S)}function co(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function lo(t){t=bo(t.mapValue.fields.__local_write_time__.timestampValue);return new ni(t.seconds,t.nanos)}var fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?co(t)?4:10:_r()}function yo(r,i){var t,e=po(r);if(e!==po(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=bo(r.timestampValue),t=bo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Io(r.bytesValue).isEqual(Io(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Eo((t=r).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Eo(t.doubleValue),e=Eo(e.doubleValue);return t===e?vi(t)===vi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],yo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Jr(e)!==Jr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!yo(e[t],n[t])))return!1;return!0}();default:return _r()}}function vo(t,e){return void 0!==(t.values||[]).find(function(t){return yo(t,e)})}function go(t,e){var n,r,i=po(t),o=po(e);if(i!==o)return Cr(i,o);switch(i){case 0:return 0;case 1:return Cr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Eo(t.integerValue||t.doubleValue),n=Eo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return mo(t.timestampValue,e.timestampValue);case 4:return mo(lo(t),lo(e));case 5:return Cr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Io(t),e=Io(e);return t.h(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Cr(n[i],r[i]);if(0!==o)return o}return Cr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Cr(Eo(i.latitude),Eo(r.latitude)))?n:Cr(Eo(i.longitude),Eo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=go(n[i],r[i]);if(o)return o}return Cr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Cr(r[s],o[s]);if(0!==u)return u;u=go(n[r[s]],i[o[s]]);if(0!==u)return u}return Cr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Cr(t,e);var n=bo(t),t=bo(e),e=Cr(n.seconds,t.seconds);return 0!==e?e:Cr(n.nanos,t.nanos)}function wo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=bo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Io(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ui.Y(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):_r();var e}(t)}function bo(t){if(Pr(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e=0,n=fo.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Io(t){return"string"==typeof t?jr.fromBase64String(t):jr.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.q()}}function Ao(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function Oo(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lo(t){return t&&"mapValue"in t}var Do={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this._=t,this.je=e};function _o(t){return{integerValue:""+t}}function Po(t,e){if(t.je){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Uo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!vi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?_o(e):Po(t,e);var n}function Vo(t,e){return t.je?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Co(t,e){return t.je?e.toBase64():e.toUint8Array()}function Mo(t){return Pr(!!t),ri.p((t=bo(t),new ni(t.seconds,t.nanos)))}function jo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).q()}function xo(t,e){return jo(t._,e.path)}function qo(t,e){Pr(Xo(e=ii.U(e)));return Pr(e.get(1)===t._.projectId),Pr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ui((Pr(4<(e=e).length&&"documents"===e.get(4)),e.F(5)))}function Fo(t,e){return jo(t._,e)}function Go(t){return new ii(["projects",t._.projectId,"databases",t._.database]).q()}function Wo(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,r,i;if(e instanceof Ns)n={update:Wo(t,e.key,e.value)};else if(e instanceof Cs)n={delete:xo(t,e.key)};else if(e instanceof Os)n={update:Wo(t,e.key,e.data),updateMask:(i=e.We,r=[],i.fields.forEach(function(t){return r.push(t.q())}),{fieldPaths:r})};else if(e instanceof Rs)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof $o)return{fieldPath:t.field.q(),setToServerValue:"REQUEST_TIME"};if(e instanceof Zo)return{fieldPath:t.field.q(),appendMissingElements:{values:e.elements}};if(e instanceof is)return{fieldPath:t.field.q(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.q(),increment:e.Qe};throw _r()})}};else{if(!(e instanceof Ms))return _r();n={verify:xo(t,e.key)}}return e.Ge.Ke||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,Vo(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:_r()),n}function zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Fo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fo(t,r.N()),n.structuredQuery.from=[{collectionId:r.k()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NAN"}};if(Oo(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NAN"}};if(Oo(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(t.field),op:(e=t.op,ko[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ko((t=t).field),direction:(t=t.dir,Do[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.je||yi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Ho(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ho(e.endAt)),n}function Ho(t){return{before:t.before,values:t.position}}function Ko(t){return{fieldPath:t.q()}}function Xo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.ze=void 0};function Qo(t,e){return t instanceof as?Ao(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Jo,Yo,$o=(n(es,Yo=l),es),Zo=(n(ts,Jo=l),ts);function ts(t){var e=this;return(e=Jo.call(this)||this).elements=t,e}function es(){return null!==Yo&&Yo.apply(this,arguments)||this}function ns(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return yo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var rs,is=(n(os,rs=l),os);function os(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function ss(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!yo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var us,as=(n(hs,us=l),hs);function hs(t,e){var n=this;return(n=us.call(this)||this).serializer=t,n.Qe=e,n}function cs(t){return Eo(t.integerValue||t.doubleValue)}function ls(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fs(t,e){this.field=t,this.transform=e}var ps=(ds.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].O(t))return!0;return!1},ds.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ds);function ds(t){(this.fields=t).sort(si.S)}function ys(t,e){this.version=t,this.transformResults=e}var vs=(gs.Ye=function(){return new gs},gs.exists=function(t){return new gs(void 0,t)},gs.updateTime=function(t){return new gs(t)},Object.defineProperty(gs.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},gs);function gs(t,e){this.updateTime=t,this.exists=e}function ms(t,e){return void 0!==t.updateTime?e instanceof Ks&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ks}l=function(){};function ws(t,e,n){return t instanceof Ns?new Ks(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Os?function(t,e,n){if(!ms(t.Ge,e))return new Qs(t.key,n.version);e=Ds(t,e);return new Ks(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Rs?function(t,e,n){if(Pr(null!=n.transformResults),!ms(t.Ge,e))return new Qs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ks&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Zo?ns(o,s):o instanceof is?ss(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ps(t,r.data(),e);return new Ks(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Xs(t.key,n.version,{hasCommittedMutations:!0})}function bs(t,e,n,r){return t instanceof Ns?function(t,e){if(!ms(t.Ge,e))return e;e=Is(e);return new Ks(t.key,e,t.value,{Je:!0})}(t,e):t instanceof Os?function(t,e){if(!ms(t.Ge,e))return e;var n=Is(e),e=Ds(t,e);return new Ks(t.key,n,e,{Je:!0})}(t,e):t instanceof Rs?function(t,e,n,r){if(!ms(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Ks&&(c=n.field(a.field)),null===c&&r instanceof Ks&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof $o?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Zo?ns(h,i):h instanceof is?ss(h,i):(h=Qo(c=h,i),i=cs(h)+cs(c.Qe),Ao(h)&&Ao(c.Qe)?_o(i):Po(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ps(t,i.data(),r);return new Ks(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,ms((t=t).Ge,e)?new Xs(t.key,ri.min()):e)}function Es(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Zo&&e instanceof Zo||t instanceof is&&e instanceof is?Mr(t.elements,e.elements,yo):t instanceof as&&e instanceof as?yo(t.Qe,e.Qe):t instanceof $o&&e instanceof $o)}))}function Is(t){return t instanceof Ks?t.version:ri.min()}var Ts,As,Ns=(n(Ls,As=l),Ls),Os=(n(Ss,Ts=l),Ss);function Ss(t,e,n,r){var i=this;return(i=Ts.call(this)||this).key=t,i.data=e,i.We=n,i.Ge=r,i.type=1,i}function Ls(t,e,n){var r=this;return(r=As.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ds(t,e){return n=t,e=e instanceof Ks?e.data():js.empty(),r=new xs(e),n.We.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var ks,Rs=(n(_s,ks=l),_s);function _s(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=vs.exists(!0),n}function Ps(t,e,n){for(var r=new xs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Us,Vs,Cs=(n(Ws,Vs=l),Ws),Ms=(n(Gs,Us=l),Gs),js=(Fs.empty=function(){return new Fs({mapValue:{}})},Fs.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Lo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},Fs.prototype.isEqual=function(t){return yo(this.proto,t.proto)},Fs),xs=(qs.prototype.set=function(t,e){return this.en(t,e),this},qs.prototype.delete=function(t){return this.en(t,null),this},qs.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},qs.prototype.Xe=function(){var t=this.nn(si.B(),this.tn);return null!=t?new js(t):this.Ze},qs.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Lo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},qs);function qs(t){void 0===t&&(t=js.empty()),this.Ze=t,this.tn=new Map}function Fs(t){this.proto=t}function Gs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.Ge=e,n.type=4,n}function Ws(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var Bs,zs,Hs,l=function(t,e){this.key=t,this.version=e},Ks=(n(Zs,Hs=l),Zs.prototype.field=function(t){return this.sn.field(t)},Zs.prototype.data=function(){return this.sn},Zs.prototype.rn=function(){return this.sn.proto},Zs.prototype.isEqual=function(t){return t instanceof Zs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},Zs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs),Xs=(n($s,zs=l),$s.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s),Qs=(n(Ys,Bs=l),Ys.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ys.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ys.prototype.isEqual=function(t){return t instanceof Ys&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ys),Js=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.hn=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function Ys(){return null!==Bs&&Bs.apply(this,arguments)||this}function $s(t,e,n){var r=this;return(r=zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Zs(t,e,n,r){var i=this;return(i=Hs.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function tu(t){return new Js(t)}function eu(t){return!yi(t.limit)&&"F"===t.hn}function nu(t){return!yi(t.limit)&&"L"===t.hn}function ru(t){return 0<t.on.length?t.on[0].field:null}function iu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function ou(t){return null!==t.collectionGroup}function su(t){var e=t;if(null===e.cn){e.cn=[];var n=iu(e),t=ru(e);if(null!==n&&null===t)n.W()||e.cn.push(new zu(n)),e.cn.push(new zu(si.K(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new zu(si.K(),n)))}}return e.cn}function uu(t){var e=t;if(!e.un)if("F"===e.hn)e.un=mi(e.path,e.collectionGroup,su(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=su(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new Mu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Mu(e.startAt.position,!e.startAt.before):null;e.un=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function au(t,e,n){return new Js(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hu(t,e){return new Js(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.hn,e,t.endAt)}function cu(t,e){return new Js(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.hn,t.startAt,e)}function lu(t,e){return bi(uu(t),uu(e))&&t.hn===e.hn}function fu(t){return wi(uu(t))+"|lt:"+t.hn}function pu(t){return"Query(target="+(e=uu(t),n=e.path.q(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.q()+" "+t.op+" "+wo(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.q()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Gu(e.startAt)),e.endAt&&(n+=", endAt: "+Gu(e.endAt)),"Target("+n+")")+"; limitType="+t.hn+")";var e,n}function du(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.O(n):ui.X(e.path)?e.path.isEqual(n):e.path.M(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Wu(t.startAt,su(t),n))&&(!t.endAt||!Wu(t.endAt,su(t),n)));var e,n}function yu(u){return function(t,e){for(var n=!1,r=0,i=su(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?ui.S(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?go(n,t):_r()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var vu,gu=(n(mu,vu=function(){}),mu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Iu(t,e,n):"array-contains"===e?new Pu(t,n):"in"===e?new Uu(t,n):"not-in"===e?new Vu(t,n):"array-contains-any"===e?new Cu(t,n):new mu(t,e,n)},mu.ln=function(t,e,n){return new("in"===e?Tu:Au)(t,n)},mu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(go(t,this.value)):null!==t&&po(this.value)===po(t)&&this._n(go(t,this.value))},mu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},mu.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},mu);function mu(t,e,n){var r=this;return(r=vu.call(this)||this).field=t,r.op=e,r.value=n,r}var wu,bu,Eu,Iu=(n(Su,Eu=gu),Su.prototype.matches=function(t){t=ui.S(t.key,this.key);return this._n(t)},Su),Tu=(n(Ou,bu=gu),Ou.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ou),Au=(n(Nu,wu=gu),Nu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Nu);function Nu(t,e){var n=this;return(n=wu.call(this,t,"not-in",e)||this).keys=Lu(0,e),n}function Ou(t,e){var n=this;return(n=bu.call(this,t,"in",e)||this).keys=Lu(0,e),n}function Su(t,e,n){var r=this;return(r=Eu.call(this,t,e,n)||this).key=ui.Y(n.referenceValue),r}function Lu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.Y(t.referenceValue)})}var Du,ku,Ru,_u,Pu=(n(Fu,_u=gu),Fu.prototype.matches=function(t){t=t.field(this.field);return No(t)&&vo(t.arrayValue,this.value)},Fu),Uu=(n(qu,Ru=gu),qu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&vo(this.value.arrayValue,t)},qu),Vu=(n(xu,ku=gu),xu.prototype.matches=function(t){if(vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!vo(this.value.arrayValue,t)},xu),Cu=(n(ju,Du=gu),ju.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!No(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return vo(e.value.arrayValue,t)})},ju),Mu=function(t,e){this.position=t,this.before=e};function ju(t,e){return Du.call(this,t,"array-contains-any",e)||this}function xu(t,e){return ku.call(this,t,"not-in",e)||this}function qu(t,e){return Ru.call(this,t,"in",e)||this}function Fu(t,e){return _u.call(this,t,"array-contains",e)||this}function Gu(t){return(t.before?"b":"a")+":"+t.position.map(wo).join(",")}function Wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ui.S(ui.Y(s.referenceValue),n.key):go(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yo(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Hu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ku=(Ju.prototype.reset=function(){this.mn=0},Ju.prototype.Rn=function(){this.mn=this.Tn},Ju.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Vn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.mn*=this.En,this.mn<this.wn&&(this.mn=this.wn),this.mn>this.Tn&&(this.mn=this.Tn)},Ju.prototype.pn=function(){null!==this.In&&(this.In.gn(),this.In=null)},Ju.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},Ju.prototype.Vn=function(){return(Math.random()-.5)*this.mn},Ju),Xu=(Qu.prototype.catch=function(t){return this.next(void 0,t)},Qu.prototype.next=function(r,i){var o=this;return this.Sn&&_r(),this.Sn=!0,this.Cn?this.error?this.Dn(i,this.error):this.Fn(r,this.result):new Qu(function(e,n){o.vn=function(t){o.Fn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},Qu.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Qu.prototype.xn=function(t){try{var e=t();return e instanceof Qu?e:Qu.resolve(e)}catch(t){return Qu.reject(t)}},Qu.prototype.Fn=function(t,e){return t?this.xn(function(){return t(e)}):Qu.resolve(e)},Qu.prototype.Dn=function(t,e){return t?this.xn(function(){return t(e)}):Qu.reject(e)},Qu.resolve=function(n){return new Qu(function(t,e){t(n)})},Qu.reject=function(n){return new Qu(function(t,e){e(n)})},Qu.$n=function(t){return new Qu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Qu.kn=function(t){for(var n=Qu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Qu.resolve(t):e()})}(r[e]);return n},Qu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Qu);function Qu(t){var e=this;this.vn=null,this.bn=null,this.result=void 0,this.error=void 0,this.Cn=!1,this.Sn=!1,t(function(t){e.Cn=!0,e.result=t,e.vn&&e.vn(t)},function(t){e.Cn=!0,e.error=t,e.bn&&e.bn(t)})}function Ju(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.mn=0,this.In=null,this.An=Date.now(),this.reset()}function Yu(t){return"IndexedDbTransactionError"===t.name}function $u(){return"undefined"!=typeof document?document:null}var Zu=(na.Un=function(t,e,n,r,i){i=new na(t,e,Date.now()+n,r,i);return i.start(n),i},na.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.jn()},t)},na.prototype.gn=function(){return this.jn()},na.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},na.prototype.jn=function(){var e=this;this.On.Wn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},na.prototype.clearTimeout=function(){null!==this.Bn&&(this.Ln(this),clearTimeout(this.Bn),this.Bn=null)},na),ta=(Object.defineProperty(ea.prototype,"ts",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),ea.prototype.Wn=function(t){this.enqueue(t)},ea.prototype.es=function(t){this.ns(),this.ss(t)},ea.prototype.rs=function(){var t;this.Gn||(this.Gn=!0,(t=$u())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Zn))},ea.prototype.enqueue=function(t){return this.ns(),this.Gn?new Promise(function(t){}):this.ss(t)},ea.prototype.os=function(t){var e=this;this.Wn(function(){return e.Kn.push(t),e.hs()})},ea.prototype.hs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Kn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Kn[0]()];case 2:return t.sent(),this.Kn.shift(),this.Xn.reset(),[3,4];case 3:if(!Yu(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Kn.length&&this.Xn.Pn(function(){return n.hs()}),t.label=5;case 5:return[2]}})})},ea.prototype.ss=function(t){var r=this,e=this.Qn.then(function(){return r.Yn=!0,t().catch(function(t){throw r.Hn=t,r.Yn=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Yn=!1,t})});return this.Qn=e},ea.prototype.yn=function(t,e,n){var r=this;this.ns(),-1<this.Jn.indexOf(t)&&(e=0);n=Zu.Un(this,t,e,n,function(t){return r.cs(t)});return this.zn.push(n),n},ea.prototype.ns=function(){this.Hn&&_r()},ea.prototype.us=function(){},ea.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qn)return[3,0];t.label=3;case 3:return[2]}})})},ea.prototype._s=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].dn===t)return!0;return!1},ea.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.zn.sort(function(t,e){return t.Mn-e.Mn});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.dn===r)break}return i.ls()})},ea.prototype.ds=function(t){this.Jn.push(t)},ea.prototype.cs=function(t){t=this.zn.indexOf(t);this.zn.splice(t,1)},ea);function ea(){var e=this;this.Qn=Promise.resolve(),this.Kn=[],this.Gn=!1,this.zn=[],this.Hn=null,this.Yn=!1,this.Jn=[],this.Xn=new Ku(this,"async_queue_retry"),this.Zn=function(){var t=$u();t&&Lr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Xn.pn()};var t=$u();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Zn)}function na(t,e,n,r,i){this.On=t,this.dn=e,this.Mn=n,this.op=r,this.Ln=i,this.qn=new Hu,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function ra(t,e){if(Dr("AsyncQueue",e+": "+t),Yu(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function ia(){this.ws=void 0,this.listeners=[]}function oa(){this.Es=new ei(fu,lu),this.onlineState="Unknown",this.Ts=new Set}function sa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Es.get(n))||(r=!0,i=new ia),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=t.sent(),o=ra(o,"Initialization of query '"+pu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Es.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&aa(e),[2]}})})}function ua(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Es.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Es.delete(n),e.Ps(n))]:[2]})})}function aa(t){t.Ts.forEach(function(t){t.next()})}var ha=(fa.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ki(t.query,t.docs,t.jt,e,t.Wt,t.fromCache,t.Qt,!0)}var o=!1;return this.ys?this.gs(t)&&(this.Vs.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.ps=t,o},fa.prototype.onError=function(t){this.Vs.error(t)},fa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.ys&&this.vs(this.ps,t)&&(this.bs(this.ps),e=!0),e},fa.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Cs&&n||t.docs.P()&&"Offline"!==e)},fa.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.Qt&&!e)&&!0===this.options.includeMetadataChanges},fa.prototype.bs=function(t){t=Ki.Gt(t.query,t.docs,t.Wt,t.fromCache),this.ys=!0,this.Vs.next(t)},fa),ca=(la.prototype.Ss=function(){return null!=this.uid},la.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},la.prototype.isEqual=function(t){return t.uid===this.uid},la);function la(t){this.uid=t}function fa(t,e,n){this.query=t,this.Vs=e,this.ys=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}ca.UNAUTHENTICATED=new ca(null),ca.Fs=new ca("google-credentials-uid"),ca.Ns=new ca("first-party-uid");var pa=(da.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},da.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},da);function da(t,e){var n=this;this.previousValue=t,e&&(e.xs=function(t){return n.$s(t)},this.ks=function(t){return e.Os(t)})}pa.Ms=-1;var ya=(La.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},La.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},La.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},La),va=(Sa.prototype.Qs=function(t){},Sa.prototype.Ks=function(t,e,n){},Sa.prototype.Gs=function(t){return this.Bs.Ls(t),this.js[t]||"not-current"},Sa.prototype.zs=function(t,e,n){this.js[t]=e},Sa.prototype.Hs=function(t){this.Bs.qs(t)},Sa.prototype.Ys=function(t){return this.Bs.activeTargetIds.has(t)},Sa.prototype.Js=function(t){delete this.js[t]},Sa.prototype.Xs=function(){return this.Bs.activeTargetIds},Sa.prototype.Zs=function(t){return this.Bs.activeTargetIds.has(t)},Sa.prototype.start=function(){return this.Bs=new ya,Promise.resolve()},Sa.prototype.ti=function(t,e,n){},Sa.prototype.ei=function(t){},Sa.prototype.ni=function(){},Sa.prototype.Os=function(t){},Sa),ga=(Oa.prototype.ii=function(t,e,n){for(var r=n.ri,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ws(o,e,r[i]))}return e},Oa.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=bs(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=bs(a,e,o,this.si))}return e},Oa.prototype.hi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Oa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wi())},Oa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Es)&&Mr(this.baseMutations,t.baseMutations,Es)},Oa),ma=(Na.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Fi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Na(t,e,n,r)},Na),wa=(Aa.prototype.fi=function(e,n){var r=this;return this.li.di(e,n).next(function(t){return r.wi(e,n,t)})},Aa.prototype.wi=function(t,r,i){return this.ai.Ei(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},Aa.prototype.Ti=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.ot(t,e)}),o},Aa.prototype.mi=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ii(e,t)})},Aa.prototype.Ii=function(e,r){var i=this;return this.li.Ai(e,r).next(function(t){var t=i.Ti(e,r,t),n=Mi;return t.forEach(function(t,e){e=e||new Xs(t,ri.min()),n=n.ot(t,e)}),n})},Aa.prototype.Ri=function(t,e,n){return r=e,ui.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Pi(t,e.path):ou(e)?this.Vi(t,e,n):this.yi(t,e,n);var r},Aa.prototype.Pi=function(t,e){return this.fi(t,new ui(e)).next(function(t){var e=qi;return t instanceof Ks&&(e=e.ot(t.key,t)),e})},Aa.prototype.Vi=function(n,r,i){var o=this,s=r.collectionGroup,u=qi;return this._i.pi(n,s).next(function(t){return Xu.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Js(t,null,e.on.slice(),e.filters.slice(),e.limit,e.hn,e.startAt,e.endAt));return o.yi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Aa.prototype.yi=function(e,n,t){var h,c,r=this;return this.ai.Ri(e,n,t).next(function(t){return h=t,r.li.gi(e,n)}).next(function(t){return c=t,r.vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=bs(s,a,a,r.si);h=a instanceof Ks?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){du(n,e)||(h=h.remove(t))}),h})},Aa.prototype.vi=function(t,e,n){for(var r=Wi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ks&&(h=h.ot(t,e))}),h})},Aa),ba=(Ta.Si=function(t,e){for(var n=Wi(),r=Wi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ta(t,e.fromCache,n,r)},Ta),Ea=(Ia.xi=function(t){return new Ia(t,Ia.$i,Ia.ki)},Ia);function Ia(t,e,n){this.Di=t,this.Fi=e,this.Ni=n}function Ta(t,e,n,r){this.targetId=t,this.fromCache=e,this.bi=n,this.Ci=r}function Aa(t,e,n){this.ai=t,this.li=e,this._i=n}function Na(t,e,n,r){this.batch=t,this.ci=e,this.ri=n,this.ui=r}function Oa(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Sa(){this.Bs=new ya,this.js={},this.Ws=null,this.xs=null}function La(){this.activeTargetIds=Bi}Ea.Oi=-1,Ea.Mi=1048576,Ea.Li=41943040,Ea.$i=10,Ea.ki=1e3,Ea.qi=new Ea(Ea.Li,Ea.$i,Ea.ki),Ea.Ui=new Ea(Ea.Oi,0,0);var Da=(Ca.prototype.ji=function(t,e){return this.Bi.add(e),Xu.resolve()},Ca.prototype.pi=function(t,e){return Xu.resolve(this.Bi.getEntries(e))},Ca),ka=(Va.prototype.add=function(t){var e=t.k(),n=t.N(),r=this.index[e]||new Vi(ii.S),t=!r.has(n);return this.index[e]=r.add(n),t},Va.prototype.has=function(t){var e=t.k(),t=t.N(),e=this.index[e];return e&&e.has(t)},Va.prototype.getEntries=function(t){return(this.index[t]||new Vi(ii.S)).L()},Va),Ra=(Ua.prototype.next=function(){return this.Wi+=2,this.Wi},Ua.Qi=function(){return new Ua(0)},Ua.Ki=function(){return new Ua(-1)},Ua),_a=(Pa.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.hr(t,n.zi)})},Pa);function Pa(t,e,n){this.persistence=t,this.Gi=e,this.zi=new Li(Cr),this.Hi=new ei(wi,bi),this.Yi=ri.min(),this.li=t.Ji(n),this.Xi=t.Zi(),this.tr=t.er(),this.nr=new wa(this.Xi,this.li,this.persistence.sr()),this.Gi.ir(this.nr)}function Ua(t){this.Wi=t}function Va(){this.index={}}function Ca(){this.Bi=new ka}function Ma(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Xi.cr({ur:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=Xu.resolve(),n.forEach(function(n){u=u.next(function(){return o.Ei(r,n)}).next(function(t){var e=t,t=i.ui.get(n);Pr(null!==t),(!e||e.version.h(t)<0)&&(e=s.ii(n,e,i))&&o.ar(e,i.ci)})}),u.next(function(){return e.li.lr(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.li._r(t)}).next(function(){return l.nr.mi(t,a)})})}function ja(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.tr.dr(t)})}function xa(t,a){var h=t,c=a.nt,l=h.zi;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Xi.cr({ur:!0});l=h.zi;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.tr.wr(s,t.se,e).next(function(){return h.tr.Er(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,c).st(s.Tr),l=l.ot(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.g()-r.nt.g()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(h.tr.mr(s,n))))});var t,o=Mi,n=Wi();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof Xs&&e.version.isEqual(ri.min())?(i.Ir(t,c),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.ar(e,c),o=o.ot(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.Rr.Ar(s,t))})})),c.isEqual(ri.min())||(t=h.tr.dr(s).next(function(t){return h.tr.Pr(s,s.Tr,c)}),u.push(t)),Xu.$n(u).next(function(){return i.apply(s)}).next(function(){return h.nr.Ii(s,o)})}).then(function(t){return h.zi=l,t})}function qa(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).zi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Yu(r=t.sent()))throw r;return Lr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.zi=e.zi.remove(o),e.Hi.delete(n.target),[2]}})})}function Fa(t,o,s){var u=t,a=ri.min(),h=Wi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=uu(o),(void 0!==(t=(i=t).Hi.get(r))?Xu.resolve(i.zi.get(t)):i.tr.yr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.tr.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Gi.Ri(e,o,s?a:ri.min(),s?h:Wi())}).next(function(t){return{documents:t,gr:h}});var t,n,r,i})}function Ga(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Wa(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}function Ba(t,e,n,r,i){var o=this;this.jo=t,this.Wo=e,this.On=n,this.Qo={},this.Ko=[],this.Go=new Map,this.zo=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.Wn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ah(this)?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,vh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.zo.delete(4),[4,yh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new rh(n,r)}var za,Ha,Ka,Xa=(dh.prototype.P=function(){return this.vr.P()},dh.prototype.Dr=function(t,e){e=new Qa(t,e);this.vr=this.vr.add(e),this.Cr=this.Cr.add(e)},dh.prototype.Fr=function(t,e){var n=this;t.forEach(function(t){return n.Dr(t,e)})},dh.prototype.Nr=function(t,e){this.$r(new Qa(t,e))},dh.prototype.kr=function(t,e){var n=this;t.forEach(function(t){return n.Nr(t,e)})},dh.prototype.Or=function(t){var e=this,n=new ui(new ii([])),r=new Qa(n,t),t=new Qa(n,t+1),i=[];return this.Cr.Nt([r,t],function(t){e.$r(t),i.push(t.key)}),i},dh.prototype.Mr=function(){var e=this;this.vr.forEach(function(t){return e.$r(t)})},dh.prototype.$r=function(t){this.vr=this.vr.delete(t),this.Cr=this.Cr.delete(t)},dh.prototype.Lr=function(t){var e=new ui(new ii([])),n=new Qa(e,t),t=new Qa(e,t+1),r=Wi();return this.Cr.Nt([n,t],function(t){r=r.add(t.key)}),r},dh.prototype.qr=function(t){var e=new Qa(t,0),e=this.vr.$t(e);return null!==e&&t.isEqual(e.key)},dh),Qa=(ph.br=function(t,e){return ui.S(t.key,e.key)||Cr(t.Ur,e.Ur)},ph.Sr=function(t,e){return Cr(t.Ur,e.Ur)||ui.S(t.key,e.key)},ph),Ja=(fh.prototype.getToken=function(){return Promise.resolve(null)},fh.prototype.Wr=function(){},fh.prototype.Qr=function(t){(this.jr=t)(ca.UNAUTHENTICATED)},fh.prototype.Kr=function(){this.jr=null},fh),Ya=(lh.prototype.getToken=function(){var e=this,n=this.Hr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Hr!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new Wa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},lh.prototype.Wr=function(){this.forceRefresh=!0},lh.prototype.Qr=function(t){this.jr=t,this.zr&&t(this.currentUser)},lh.prototype.Kr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.jr=null},lh.prototype.Yr=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new ca(t)},lh),$a=(Object.defineProperty(ch.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Xr},e=this.Jr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ch),Za=(hh.prototype.getToken=function(){return Promise.resolve(new $a(this.Jr,this.Xr))},hh.prototype.Qr=function(t){t(ca.Ns)},hh.prototype.Kr=function(){},hh.prototype.Wr=function(){},hh),l=(ah.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},ah.prototype.oo=function(){return 2===this.state},ah.prototype.start=function(){3!==this.state?this.auth():this.ho()},ah.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ah.prototype.co=function(){this.state=0,this.Xn.reset()},ah.prototype.uo=function(){var t=this;this.oo()&&null===this.io&&(this.io=this.fn.yn(this.Zr,6e4,function(){return t.ao()}))},ah.prototype.lo=function(t){this._o(),this.stream.send(t)},ah.prototype.ao=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},ah.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},ah.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._o(),this.Xn.cancel(),this.so++,3!==e?this.Xn.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Xn.Rn()):n&&n.code===Ir.UNAUTHENTICATED&&this.no.Wr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},ah.prototype.fo=function(){},ah.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.Eo(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},ah.prototype.Eo=function(t){var e=this,n=this.wo(this.so);this.stream=this.mo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ah.prototype.ho=function(){var t=this;this.state=4,this.Xn.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ah.prototype.To=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ah.prototype.wo=function(e){var n=this;return function(t){n.fn.Wn(function(){return n.so===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ah),th=(n(uh,Ka=l),uh.prototype.mo=function(t){return this.eo.Ao("Listen",t)},uh.prototype.onMessage=function(t){this.Xn.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.je?(Pr(void 0===o||"string"==typeof o),jr.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),jr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Si(s.code),new Tr(o,s.message||"")),r=new $i(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=qo(t,u.document.name),a=Mo(u.document.updateTime),s=new js({mapValue:{fields:u.document.fields}}),a=new Ks(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ji(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=qo(t,u.document),h=u.readTime?Mo(u.readTime):ri.min(),h=new Xs(a,h),u=u.removedTargetIds||[];r=new Ji([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=qo(t,h.document),h=h.removedTargetIds||[];r=new Ji([],h,c,null)}else{if(!("filter"in e))return _r();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ii(e),c=c.targetId;r=new Yi(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ri.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Mo(t.readTime):ri.min()}(t);return this.listener.Ro(e,t)},uh.prototype.Po=function(t){var e,n,r,i={};i.database=Go(this.serializer),i.addTarget=(e=this.serializer,(r=Ei(r=(n=t).target)?{documents:{documents:[Fo(e,r.path)]}}:{query:zo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Co(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.lo(i)},uh.prototype.Vo=function(t){var e={};e.database=Go(this.serializer),e.removeTarget=t,this.lo(e)},uh),eh=(n(sh,Ha=l),Object.defineProperty(sh.prototype,"po",{get:function(){return this.yo},enumerable:!1,configurable:!0}),sh.prototype.start=function(){this.yo=!1,this.lastStreamToken=void 0,Ha.prototype.start.call(this)},sh.prototype.fo=function(){this.yo&&this.vo([])},sh.prototype.mo=function(t){return this.eo.Ao("Write",t)},sh.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.yo){this.Xn.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(ri.min())&&(n=Mo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new ys(n,e)}(t,r)})):[]),n=Mo(t.commitTime);return this.listener.bo(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.yo=!0,this.listener.Co()},sh.prototype.So=function(){var t={};t.database=Go(this.serializer),this.lo(t)},sh.prototype.vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.lo(t)},sh),nh=(n(oh,za=function(){}),oh.prototype.Fo=function(){if(this.Do)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},oh.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Wr(),t})},oh.prototype.xo=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.xo(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Wr(),t})},oh.prototype.terminate=function(){this.Do=!1},oh),rh=(ih.prototype.Mo=function(){var t=this;0===this.$o&&(this.Lo("Unknown"),this.ko=this.On.yn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Lo("Offline"),Promise.resolve()}))},ih.prototype.Uo=function(t){"Online"===this.state?this.Lo("Unknown"):(this.$o++,1<=this.$o&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Lo("Offline")))},ih.prototype.set=function(t){this.Bo(),this.$o=0,"Online"===t&&(this.Oo=!1),this.Lo(t)},ih.prototype.Lo=function(t){t!==this.state&&(this.state=t,this.Ws(t))},ih.prototype.qo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Oo?(Dr(t),this.Oo=!1):Lr("OnlineStateTracker",t)},ih.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},ih);function ih(t,e){this.On=t,this.Ws=e,this.state="Unknown",this.$o=0,this.ko=null,this.Oo=!0}function oh(t,e,n){var r=this;return(r=za.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Do=!1,r}function sh(t,e,n,r,i){var o=this;return(o=Ha.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.yo=!1,o}function uh(t,e,n,r,i){var o=this;return(o=Ka.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function ah(t,e,n,r,i,o){this.fn=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Xn=new Ku(t,e)}function hh(t,e){this.Jr=t,this.Xr=e}function ch(t,e){this.Jr=t,this.Xr=e,this.type="FirstParty",this.user=ca.Ns}function lh(t){var e=this;this.Gr=null,this.currentUser=ca.UNAUTHENTICATED,this.zr=!1,this.Hr=0,this.jr=null,this.forceRefresh=!1,this.Gr=function(){e.Hr++,e.currentUser=e.Yr(),e.zr=!0,e.jr&&e.jr(e.currentUser)},this.Hr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function fh(){this.jr=null}function ph(t,e){this.key=t,this.Ur=e}function dh(){this.vr=new Vi(Qa.br),this.Cr=new Vi(Qa.Sr)}function yh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Ah(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function gh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Lr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,vh(e)];case 1:return t.sent(),e.Yo.ni(),e.Xo.set("Unknown"),[2]}})})}function mh(t,e){t.Go.has(e.targetId)||(t.Go.set(e.targetId,e),Th(t)?Ih(t):_h(t).oo()&&bh(t,e))}function wh(t,e){var n=t,t=_h(n);n.Go.delete(e),t.oo()&&Eh(n,e),0===n.Go.size&&(t.oo()?t.uo():Ah(n)&&n.Xo.set("Unknown"))}function bh(t,e){t.Zo.Ie(e.targetId),_h(t).Po(e)}function Eh(t,e){t.Zo.Ie(e),_h(t).Vo(e)}function Ih(e){e.Zo=new to({Ue:function(t){return e.Qo.Ue(t)},Be:function(t){return e.Go.get(t)||null}}),_h(e).start(),e.Xo.Mo()}function Th(t){return Ah(t)&&!_h(t).ro()&&0<t.Go.size}function Ah(t){return 0===t.zo.size}function Nh(t){t.Zo=void 0}function Oh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Xo.set("Online"),!(u instanceof $i&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.Qo.th(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Sh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ji?s.Zo.ve(u):u instanceof Yi?s.Zo.$e(u):s.Zo.Se(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ja(s.jo)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).Zo.Me(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Go.get(e))&&r.Go.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.Go.get(t);e&&(r.Go.set(t,e.it(jr.u,e.nt)),Eh(r,t),e=new Ai(e.target,t,1,e.sequenceNumber),bh(r,e))}),r.Qo.eh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Sh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Sh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Yu(r))throw r;return n.zo.add(1),[4,vh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return ja(n.jo)},n.On.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,yh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Lh(e,n){return n().catch(function(t){return Sh(e,t,n)})}function Dh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ph(i=a),s=0<i.Ko.length?i.Ko[i.Ko.length-1].batchId:-1,t.label=1;case 1:if(!(Ah(i)&&i.Ko.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.jo,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.li.Vr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Ko.length&&o.uo(),[3,7]):(s=u.batchId,function(t,e){t.Ko.push(e);t=Ph(t);t.oo()&&t.po&&t.vo(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Sh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return kh(i)&&Rh(i),[2]}var e,n,r})})}function kh(t){return Ah(t)&&!Ph(t).ro()&&0<t.Ko.length}function Rh(t){Ph(t).start()}function _h(n){var t,e,r,i=this;return n.ih||(n.ih=(t=n.Wo,e=n.On,r={Io:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Go.forEach(function(t,e){bh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Nh(e),Th(e)?(e.Xo.Uo(n),Ih(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:Oh.bind(null,n)},t.Fo(),new th(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ih.co(),Th(n)?Ih(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ih.stop()];case 2:t.sent(),Nh(n),t.label=3;case 3:return[2]}})})})),n.ih}function Ph(n){var t,e,r,i=this;return n.rh||(n.rh=(t=n.Wo,e=n.On,r={Io:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ph(e).So(),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ph(e).po?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Oi(n=i.code)&&n!==Ir.ABORTED?(e=r.Ko.shift(),Ph(r).co(),[4,Lh(r,function(){return r.Qo.sh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Dh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return kh(e)&&Rh(e),[2]}})})}.bind(null,n),Co:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ph(o),n=0,r=o.Ko;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ko.shift(),n=ma.from(e,i,o),[4,Lh(r,function(){return r.Qo.nh(n)})];case 1:return t.sent(),[4,Dh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fo(),new eh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.rh.co(),[4,Dh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.rh.stop()];case 3:t.sent(),0<n.Ko.length&&(Lr("RemoteStore","Stopping write stream with "+n.Ko.length+" pending writes"),n.Ko=[]),t.label=4;case 4:return[2]}})})})),n.rh}function Uh(t,e,n){this.query=t,this.targetId=e,this.view=n}var Vh=function(t){this.key=t},Ch=function(t){this.key=t},Mh=(Object.defineProperty(Fh.prototype,"_h",{get:function(){return this.oh},enumerable:!1,configurable:!0}),Fh.prototype.fh=function(t,e){var s=this,u=e?e.dh:new Hi,a=(e||this).lh,h=(e||this).Wt,c=a,l=!1,f=eu(this.query)&&a.size===this.query.limit?a.last():null,p=nu(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof Ks?e:null)&&(du(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Je||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.ah(r,f)||p&&s.ah(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),eu(this.query)||nu(this.query))for(;c.size>this.query.limit;){var n=eu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{lh:c,dh:u,Eh:l,Wt:h}},Fh.prototype.wh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Fh.prototype.Th=function(t,e,n){var o=this,r=this.lh;this.lh=t.lh,this.Wt=t.Wt;var i=t.dh.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.mh(n);var s=e?this.Ih():[],n=0===this.uh.size&&this.te?1:0,e=n!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new Ki(this.query,t.lh,r,i,t.Wt,0==n,e,!1),Ah:s}:{Ah:s}},Fh.prototype.As=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Th({lh:this.lh,dh:new Hi,Wt:this.Wt,Eh:!1},!1)):{Ah:[]}},Fh.prototype.Rh=function(t){return!this.oh.has(t)&&!!this.lh.has(t)&&!this.lh.get(t).Je},Fh.prototype.mh=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.oh=e.oh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.oh=e.oh.delete(t)}),this.te=t.te)},Fh.prototype.Ih=function(){var e=this;if(!this.te)return[];var n=this.uh;this.uh=Wi(),this.lh.forEach(function(t){e.Rh(t.key)&&(e.uh=e.uh.add(t.key))});var r=[];return n.forEach(function(t){e.uh.has(t)||r.push(new Ch(t))}),this.uh.forEach(function(t){n.has(t)||r.push(new Vh(t))}),r},Fh.prototype.Ph=function(t){this.oh=t.gr,this.uh=Wi();t=this.fh(t.documents);return this.Th(t,!0)},Fh.prototype.Vh=function(){return Ki.Gt(this.query,this.lh,this.Wt,0===this.hh)},Fh),jh=function(t){this.key=t,this.yh=!1},xh=(Object.defineProperty(qh.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),qh);function qh(t,e,n,r,i,o){this.jo=t,this.ph=e,this.gh=n,this.bh=r,this.currentUser=i,this.Ch=o,this.Sh={},this.Dh=new ei(fu,lu),this.Fh=new Map,this.Nh=[],this.xh=new Li(ui.S),this.$h=new Map,this.kh=new Xa,this.Oh={},this.Mh=new Map,this.Lh=Ra.Ki(),this.onlineState="Unknown",this.qh=void 0}function Fh(t,e){this.query=t,this.oh=e,this.hh=null,this.te=!1,this.uh=Wi(),this.Wt=Wi(),this.ah=yu(t),this.lh=new zi(this.ah)}function Gh(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).ph.Qo.eh=Bh.bind(null,e),e.ph.Qo.Ue=function(t,e){var n=t,t=n.$h.get(e);if(t&&t.yh)return Wi().add(t.key);var r=Wi(),e=n.Fh.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Dh.get(s);r=r.kt(s.view._h)}return r}.bind(null,e),e.ph.Qo.th=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).bh.zs(s,"rejected",u),i=e.$h.get(s),(n=i&&i.key)?(r=(r=new Li(ui.S)).ot(n,new Xs(n,ri.min())),i=Wi().add(n),i=new Xi(ri.min(),new Map,new Vi(Cr),r,i),[4,Bh(e,i)]):[3,2];case 1:return t.sent(),e.xh=e.xh.remove(n),e.$h.delete(s),Yh(e),[3,4];case 2:return[4,qa(e.jo,s,!1).then(function(){return Xh(e,s,u)}).catch(Ga)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Sh.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Es.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&aa(n)}.bind(null,e.gh),e.Sh.Bh=function(t,e,n){var r=t;if(t=r.Es.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Es.delete(e)}.bind(null,e.gh),(a=(n=e).Dh.get(c))?(o=a.targetId,n.bh.Gs(o),s=a.view.Vh(),[3,4]):[3,1];case 1:return[4,(e=n.jo,r=uu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.tr.yr(e,r).next(function(t){return t?(n=t,Xu.resolve(n)):i.tr.jh(e).next(function(t){return n=new Ai(r,t,0,e.Tr),i.tr.Wh(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.zi=i.zi.ot(t.targetId,t),i.Hi.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.bh.Gs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fh(o)).Eh?[4,Fa(r.jo,i.query,!1).then(function(t){t=t.documents;return i.view.fh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Th(e,r.Uh,n),[2,(Jh(r,i.targetId,n.Ah),n.snapshot)]}})})}(i,t,e,n)},[4,Fa(i.jo,o,!0)];case 1:return n=t.sent(),r=new Mh(o,n.gr),e=r.fh(n.documents),n=Qi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Th(e,i.Uh,n),Jh(i,s,n.Ah),r=new Uh(o,s,r),i.Dh.set(o,r),i.Fh.has(s)?i.Fh.get(s).push(o):i.Fh.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Uh&&mh(n.ph,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Wh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).ph.Qo.nh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ma(e.jo,o)];case 2:return r=t.sent(),Kh(e,n,null),Hh(e,n),e.bh.Ks(n,"acknowledged"),[4,$h(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ga(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.ph.Qo.sh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.li.zh(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.li.lr(e,t)}).next(function(){return i.li._r(e)}).next(function(){return i.nr.mi(e,n)})}))];case 2:return o=t.sent(),Kh(n,u,a),Hh(n,u),n.bh.Ks(u,"rejected",a),[4,$h(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ga(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jo,a=p,c=r,l=ni.now(),i=a.reduce(function(t,e){return t.add(e.key)},Wi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.nr.mi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Rs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ks?t.field(i.field):void 0,o=Qo(i.transform,o||null);null!=o&&(e=(null==e?new xs:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Os(i.key,o,function s(t){var u=[];return Yr(t.fields||{},function(t,e){var n=new si([t]);if(Lo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ps(u)}(o.proto.mapValue),vs.exists(!0)))}return c.li.Kh(u,l,e,a)})}).then(function(t){var e=t.hi(h);return{batchId:t.batchId,Gh:e}}))];case 2:return s=t.sent(),u.bh.Qs(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Oh[e.currentUser.Ds()])||new Li(Cr)).ot(n,o),e.Oh[e.currentUser.Ds()]=r,[4,$h(u,s.Gh)];case 3:return t.sent(),[4,Dh(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ra(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Bh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,xa(n.jo,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.$h.get(e);e&&(Pr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.yh=!0:0<t.ne.size?Pr(e.yh):0<t.se.size&&(Pr(e.yh),e.yh=!1))}),[4,$h(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ga(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function zh(t,n,e){var r,t=t;(t.Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Dh.forEach(function(t,e){e=e.view.As(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Es.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&aa(t)}(t.gh,n),r.length&&t.Sh.Ro(r),t.onlineState=n,t.Uh&&t.bh.ei(n))}function Hh(t,e){(t.Mh.get(e)||[]).forEach(function(t){t.resolve()}),t.Mh.delete(e)}function Kh(t,e,n){var r=t,i=r.Oh[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Oh[r.currentUser.Ds()]=i)}function Xh(e,t,n){void 0===n&&(n=null),e.bh.Hs(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Dh.delete(o),n&&e.Sh.Bh(o,n)}e.Fh.delete(t),e.Uh&&e.kh.Or(t).forEach(function(t){e.kh.qr(t)||Qh(e,t)})}function Qh(t,e){var n=t.xh.get(e);null!==n&&(wh(t.ph,n),t.xh=t.xh.remove(e),t.$h.delete(n),Yh(t))}function Jh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Vh?(t.kh.Dr(o.key,e),function(t,e){e=e.key;t.xh.get(e)||(Lr("SyncEngine","New document in limbo: "+e),t.Nh.push(e),Yh(t))}(t,o)):o instanceof Ch?(Lr("SyncEngine","Document no longer in limbo: "+o.key),t.kh.Nr(o.key,e),t.kh.qr(o.key)||Qh(t,o.key)):_r()}}function Yh(t){for(;0<t.Nh.length&&t.xh.size<t.Ch;){var e=t.Nh.shift(),n=t.Lh.next();t.$h.set(n,new jh(e)),t.xh=t.xh.ot(e,n),mh(t.ph,new Ai(uu(tu(e.path)),n,2,pa.Ms))}}function $h(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Dh.P()?[3,3]:(n.Dh.forEach(function(t,e){o.push(n.Qh(e,s,u).then(function(t){t&&(n.Uh&&n.bh.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ba.Si(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Sh.Ro(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Xu.forEach(h,function(e){return Xu.forEach(e.bi,function(t){return r.persistence.Rr.Dr(n,e.targetId,t)}).next(function(){return Xu.forEach(e.Ci,function(t){return r.persistence.Rr.Nr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Yu(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.zi.get(o),u=s.nt,u=s.rt(u),r.zi=r.zi.ot(o,u));return[2]}})})}(n.jo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Zh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Lr("SyncEngine","User change. New user:",o.Ds()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).li,m=e.nr,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.li.Yh(v).next(function(t){return g=t,n=e.persistence.Ji(o),m=new wa(e.Xi,n,e.persistence.sr()),n.Yh(v)}).next(function(t){for(var e=[],n=[],r=Wi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.mi(v,r).next(function(t){return{Jh:t,Xh:e,Zh:n}})})})];case 1:return r=t.sent(),[2,(e.li=n,e.nr=m,e.Gi.ir(e.nr),r)]}})})}(n.jo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Mh.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Mh.clear(),n.bh.ti(o,r.Xh,r.Zh),[4,$h(n,r.Jh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var tc,ec,nc,rc=(kc.prototype.ir=function(t){this.tc=t},kc.prototype.Ri=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ri.min())?this.ec(e,r):this.tc.mi(e,o).next(function(t){var n=s.nc(r,t);return(eu(r)||nu(r))&&s.Eh(r.hn,n,o,i)?s.ec(e,r):(Sr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pu(r)),s.tc.Ri(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},kc.prototype.nc=function(n,t){var r=new Vi(yu(n));return t.forEach(function(t,e){e instanceof Ks&&du(n,e)&&(r=r.add(e))}),r},kc.prototype.Eh=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.h(r))},kc.prototype.ec=function(t,e){return Sr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Using full collection scan to execute query:",pu(e)),this.tc.Ri(t,e,ri.min())},kc),ic=(Dc.prototype.rc=function(t){return Xu.resolve(0===this.li.length)},Dc.prototype.Kh=function(t,e,n,r){var i=this.sc;this.sc++,0<this.li.length&&this.li[this.li.length-1];n=new ga(i,e,n,r);this.li.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.ic=this.ic.add(new Qa(u.key,i)),this._i.ji(t,u.key.path.N())}return Xu.resolve(n)},Dc.prototype.zh=function(t,e){return Xu.resolve(this.oc(e))},Dc.prototype.Vr=function(t,e){e+=1,e=this.hc(e),e=e<0?0:e;return Xu.resolve(this.li.length>e?this.li[e]:null)},Dc.prototype.Hh=function(){return Xu.resolve(0===this.li.length?-1:this.sc-1)},Dc.prototype.Yh=function(t){return Xu.resolve(this.li.slice())},Dc.prototype.di=function(t,e){var n=this,r=new Qa(e,0),e=new Qa(e,Number.POSITIVE_INFINITY),i=[];return this.ic.Nt([r,e],function(t){t=n.oc(t.Ur);i.push(t)}),Xu.resolve(i)},Dc.prototype.Ai=function(t,e){var n=this,r=new Vi(Cr);return e.forEach(function(t){var e=new Qa(t,0),t=new Qa(t,Number.POSITIVE_INFINITY);n.ic.Nt([e,t],function(t){r=r.add(t.Ur)})}),Xu.resolve(this.cc(r))},Dc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,e=n;ui.X(e)||(e=e.child(""));var e=new Qa(new ui(e),0),i=new Vi(Cr);return this.ic.xt(function(t){var e=t.key.path;return!!n.O(e)&&(e.length===r&&(i=i.add(t.Ur)),!0)},e),Xu.resolve(this.cc(i))},Dc.prototype.cc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.oc(t);null!==t&&n.push(t)}),n},Dc.prototype.lr=function(n,r){var i=this;Pr(0===this.uc(r.batchId,"removed")),this.li.shift();var o=this.ic;return Xu.forEach(r.mutations,function(t){var e=new Qa(t.key,r.batchId);return o=o.delete(e),i.Rr.ac(n,t.key)}).next(function(){i.ic=o})},Dc.prototype.lc=function(t){},Dc.prototype.qr=function(t,e){var n=new Qa(e,0),n=this.ic.$t(n);return Xu.resolve(e.isEqual(n&&n.key))},Dc.prototype._r=function(t){return this.li.length,Xu.resolve()},Dc.prototype.uc=function(t,e){return this.hc(t)},Dc.prototype.hc=function(t){return 0===this.li.length?0:t-this.li[0].batchId},Dc.prototype.oc=function(t){t=this.hc(t);return t<0||t>=this.li.length?null:this.li[t]},Dc),oc=(Lc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this._c(e);return this.docs=this.docs.ot(r,{fc:e,size:i,readTime:n}),this.size+=i-o,this._i.ji(t,r.path.N())},Lc.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Lc.prototype.Ei=function(t,e){e=this.docs.get(e);return Xu.resolve(e?e.fc:null)},Lc.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.fc:null)}),Xu.resolve(r)},Lc.prototype.Ri=function(t,e,n){for(var r=qi,i=new ui(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.fc,a=a.readTime;if(!e.path.O(u.path))break;a.h(n)<=0||s instanceof Ks&&du(e,s)&&(r=r.ot(s.key,s))}return Xu.resolve(r)},Lc.prototype.dc=function(t,e){return Xu.forEach(this.docs,function(t){return e(t)})},Lc.prototype.cr=function(t){return new sc(this)},Lc.prototype.wc=function(t){return Xu.resolve(this.size)},Lc),sc=(Object.defineProperty(Sc.prototype,"readTime",{get:function(){return this.Tc},set:function(t){this.Tc=t},enumerable:!1,configurable:!0}),Sc.prototype.ar=function(t,e){this.mc(),this.readTime=e,this.Gh.set(t.key,t)},Sc.prototype.Ir=function(t,e){this.mc(),e&&(this.readTime=e),this.Gh.set(t,null)},Sc.prototype.Ei=function(t,e){this.mc();var n=this.Gh.get(e);return void 0!==n?Xu.resolve(n):this.Ic(t,e)},Sc.prototype.getEntries=function(t,e){return this.Ac(t,e)},Sc.prototype.apply=function(t){return this.mc(),this.Ec=!0,this.Th(t)},Sc.prototype.mc=function(){},n(Oc,nc=Sc),Oc.prototype.Th=function(n){var r=this,i=[];return this.Gh.forEach(function(t,e){e?i.push(r.Rc.ar(n,e,r.readTime)):r.Rc.Ir(t)}),Xu.$n(i)},Oc.prototype.Ic=function(t,e){return this.Rc.Ei(t,e)},Oc.prototype.Ac=function(t,e){return this.Rc.getEntries(t,e)},Oc),uc=(Nc.prototype.De=function(t,n){return this.Pc.forEach(function(t,e){return n(e)}),Xu.resolve()},Nc.prototype.dr=function(t){return Xu.resolve(this.lastRemoteSnapshotVersion)},Nc.prototype.vc=function(t){return Xu.resolve(this.Vc)},Nc.prototype.jh=function(t){return this.highestTargetId=this.gc.next(),Xu.resolve(this.highestTargetId)},Nc.prototype.Pr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Vc&&(this.Vc=e),Xu.resolve()},Nc.prototype.bc=function(t){this.Pc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.gc=new Ra(e),this.highestTargetId=e),t.sequenceNumber>this.Vc&&(this.Vc=t.sequenceNumber)},Nc.prototype.Wh=function(t,e){return this.bc(e),this.targetCount+=1,Xu.resolve()},Nc.prototype.mr=function(t,e){return this.bc(e),Xu.resolve()},Nc.prototype.Cc=function(t,e){return this.Pc.delete(e.target),this.yc.Or(e.targetId),--this.targetCount,Xu.resolve()},Nc.prototype.Sc=function(n,r,i){var o=this,s=0,u=[];return this.Pc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Pc.delete(t),u.push(o.Dc(n,e.targetId)),s++)}),Xu.$n(u).next(function(){return s})},Nc.prototype.Fc=function(t){return Xu.resolve(this.targetCount)},Nc.prototype.yr=function(t,e){e=this.Pc.get(e)||null;return Xu.resolve(e)},Nc.prototype.Er=function(t,e,n){return this.yc.Fr(e,n),Xu.resolve()},Nc.prototype.wr=function(e,t,n){this.yc.kr(t,n);var r=this.persistence.Rr,i=[];return r&&t.forEach(function(t){i.push(r.ac(e,t))}),Xu.$n(i)},Nc.prototype.Dc=function(t,e){return this.yc.Or(e),Xu.resolve()},Nc.prototype.pr=function(t,e){e=this.yc.Lr(e);return Xu.resolve(e)},Nc.prototype.qr=function(t,e){return Xu.resolve(this.yc.qr(e))},Nc),ac=(Ac.prototype.start=function(){return Promise.resolve()},Ac.prototype.ni=function(){return this.$c=!1,Promise.resolve()},Object.defineProperty(Ac.prototype,"Oc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),Ac.prototype.Mc=function(){},Ac.prototype.Lc=function(){},Ac.prototype.sr=function(){return this._i},Ac.prototype.Ji=function(t){var e=this.Nc[t.Ds()];return e||(e=new ic(this._i,this.Rr),this.Nc[t.Ds()]=e),e},Ac.prototype.er=function(){return this.tr},Ac.prototype.Zi=function(){return this.ai},Ac.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new hc(this.xc.next());return this.Rr.qc(),n(i).next(function(t){return r.Rr.Uc(i).next(function(){return t})}).Nn().then(function(t){return i.Bc(),t})},Ac.prototype.jc=function(e,n){return Xu.kn(Object.values(this.Nc).map(function(t){return function(){return t.qr(e,n)}}))},Ac),hc=(Tc.prototype.Qc=function(t){this.Wc.push(t)},Tc.prototype.Bc=function(){this.Wc.forEach(function(t){return t()})},n(Ic,ec=Tc),Ic),cc=(Ec.zc=function(t){return new Ec(t)},Object.defineProperty(Ec.prototype,"Hc",{get:function(){if(this.Gc)return this.Gc;throw _r()},enumerable:!1,configurable:!0}),Ec.prototype.Dr=function(t,e,n){return this.Kc.Dr(n,e),this.Hc.delete(n.toString()),Xu.resolve()},Ec.prototype.Nr=function(t,e,n){return this.Kc.Nr(n,e),this.Hc.add(n.toString()),Xu.resolve()},Ec.prototype.ac=function(t,e){return this.Hc.add(e.toString()),Xu.resolve()},Ec.prototype.removeTarget=function(t,e){var n=this;this.Kc.Or(e.targetId).forEach(function(t){return n.Hc.add(t.toString())});var r=this.persistence.er();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Hc.add(t.toString())})}).next(function(){return r.Cc(t,e)})},Ec.prototype.qc=function(){this.Gc=new Set},Ec.prototype.Uc=function(n){var r=this,i=this.persistence.Zi().cr();return Xu.forEach(this.Hc,function(t){var e=ui.H(t);return r.Yc(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Gc=null,i.apply(n)})},Ec.prototype.Ar=function(t,e){var n=this;return this.Yc(t,e).next(function(t){t?n.Hc.delete(e.toString()):n.Hc.add(e.toString())})},Ec.prototype.kc=function(t){return 0},Ec.prototype.Yc=function(t,e){var n=this;return Xu.kn([function(){return Xu.resolve(n.Kc.qr(e))},function(){return n.persistence.er().qr(t,e)},function(){return n.persistence.jc(t,e)}])},Ec),lc=(bc.prototype.Io=function(t){this.Zc=t},bc.prototype.do=function(t){this.tu=t},bc.prototype.onMessage=function(t){this.eu=t},bc.prototype.close=function(){this.Xc()},bc.prototype.send=function(t){this.Jc(t)},bc.prototype.nu=function(){this.Zc()},bc.prototype.su=function(t){this.tu(t)},bc.prototype.iu=function(t){this.eu(t)},bc),fc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pc=(wc.prototype.No=function(e,t,n,r){var i=this.cu(e,t);Lr("RestConnection","Sending: ",i,n);t={};return this.uu(t,r),this.au(e,i,t,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},wc.prototype.xo=function(t,e,n,r){return this.No(t,e,n,r)},wc.prototype.uu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0-2020926155854",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},wc.prototype.cu=function(t,e){t=fc[t];return this.ou+"/v1/"+e+":"+t},n(mc,tc=wc),mc.prototype.au=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Lr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Lr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Lr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},mc.prototype.Ao=function(t,e){var n,r=[this.ou,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.uu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Lr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new lc({Jc:function(t){u?Lr("Connection","Not sending because WebChannel is closed:",t):(s||(Lr("Connection","Opening WebChannel transport."),o.open(),s=!0),Lr("Connection","WebChannel sending:",t),o.send(t))},Xc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(gr.EventType.OPEN,function(){u||Lr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Lr("Connection","WebChannel transport closed"),a.su())}),t(gr.EventType.ERROR,function(t){u||(u=!0,kr("Connection","WebChannel transport errored:",t),a.su(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Lr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ti[r];if(void 0!==t)return Si(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.su(new Tr(t,i)),o.close()):(Lr("Connection","WebChannel received:",e),a.iu(e)))}),setTimeout(function(){a.nu()},0),a},mc),dc=(gc.prototype.Jo=function(t){this.wu.push(t)},gc.prototype.ni=function(){window.removeEventListener("online",this.lu),window.removeEventListener("offline",this.fu)},gc.prototype.Eu=function(){window.addEventListener("online",this.lu),window.addEventListener("offline",this.fu)},gc.prototype._u=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.wu;t<e.length;t++)(0,e[t])(0)},gc.prototype.du=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.wu;t<e.length;t++)(0,e[t])(1)},gc.Tu=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},gc),yc=(vc.prototype.Jo=function(t){},vc.prototype.ni=function(){},vc);function vc(){}function gc(){var t=this;this.lu=function(){return t._u()},this.fu=function(){return t.du()},this.wu=[],this.Eu()}function mc(t){var e=this;return(e=tc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function wc(t){this.ru=t,this._=t._;var e=t.ssl?"https":"http";this.ou=e+"://"+t.host,this.hu="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function bc(t){this.Jc=t.Jc,this.Xc=t.Xc}function Ec(t){this.persistence=t,this.Kc=new Xa,this.Gc=null}function Ic(t){var e=this;return(e=ec.call(this)||this).Tr=t,e}function Tc(){this.Wc=[]}function Ac(t){var e=this;this.Nc={},this.xc=new pa(0),this.$c=!1,this.$c=!0,this.Rr=t(this),this.tr=new uc(this),this._i=new Da,this.ai=(t=this._i,new oc(t,function(t){return e.Rr.kc(t)}))}function Nc(t){this.persistence=t,this.Pc=new ei(wi,bi),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.Vc=0,this.yc=new Xa,this.targetCount=0,this.gc=Ra.Qi()}function Oc(t){var e=this;return(e=nc.call(this)||this).Rc=t,e}function Sc(){this.Gh=new ei(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Ec=!1}function Lc(t,e){this._i=t,this._c=e,this.docs=new Li(ui.S),this.size=0}function Dc(t,e){this._i=t,this.Rr=e,this.li=[],this.sc=1,this.ic=new Vi(Qa.br)}function kc(){}function Rc(t){return new Ro(t,!0)}var _c=(Mc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.bh=this.mu(e),this.persistence=this.Iu(e),[4,this.persistence.start()];case 1:return t.sent(),this.Au=this.Ru(e),this.jo=this.Pu(e),[2]}})})},Mc.prototype.Ru=function(t){return null},Mc.prototype.Pu=function(t){return e=this.persistence,n=new rc,t=t.Vu,new _a(e,n,t);var e,n},Mc.prototype.Iu=function(t){return new ac(cc.zc)},Mc.prototype.mu=function(t){return new va},Mc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Au&&this.Au.stop(),[4,this.bh.ni()];case 1:return t.sent(),[4,this.persistence.ni()];case 2:return t.sent(),[2]}})})},Mc),Pc=(Cc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jo?[3,2]:(this.jo=n.jo,this.bh=n.bh,this.Wo=this.yu(r),this.ph=this.pu(r),this.gh=this.gu(r),this.vu=this.bu(r,!n.synchronizeTabs),this.bh.Ws=function(t){return zh(e.vu,t,1)},this.ph.Qo.Cu=Zh.bind(null,this.vu),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,yh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,vh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.ph,this.vu.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cc.prototype.gu=function(t){return new oa},Cc.prototype.yu=function(t){var e=Rc(t.ru._),n=(n=t.ru,new pc(n));return t=t.credentials,new nh(t,n,e)},Cc.prototype.pu=function(t){var e=this,n=this.jo,r=this.Wo,i=t.On,o=function(t){return zh(e.vu,t,0)},t=new(dc.Tu()?dc:yc);return new Ba(n,r,i,o,t)},Cc.prototype.bu=function(t,e){return function(t,e,n,r,i,o,s){o=new xh(t,e,n,r,i,o);return s&&(o.qh=!0),o}(this.jo,this.ph,this.gh,this.bh,t.Vu,t.Ch,e)},Cc.prototype.terminate=function(){return gh(this.ph)},Cc),Uc=(Vc.prototype.next=function(t){this.observer.next&&this.Su(this.observer.next,t)},Vc.prototype.error=function(t){this.observer.error?this.Su(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Vc.prototype.Du=function(){this.muted=!0},Vc.prototype.Su=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Vc);function Vc(t){this.observer=t,this.muted=!1}function Cc(){}function Mc(){this.synchronizeTabs=!1}function jc(t,e,n){if(!n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function xc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function qc(t,e,n,r){if(!0===e&&!0===r)throw new Tr(Ir.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Fc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Gc(t,e){if(e<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Wc,Bc,zc=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fu=new si(t)},Hc=(n(Yc,Bc=zc),Yc.documentId=function(){return new Yc(si.K().q())},Yc.prototype.isEqual=function(t){return t instanceof Yc&&this.Fu.isEqual(t.Fu)},Yc),Kc=new RegExp("[~\\*/\\[\\]]"),Xc=function(t){this.Nu=t},Qc=(n(Jc,Wc=Xc),Jc.prototype.xu=function(t){if(2!==t.$u)throw 1===t.$u?t.ku(this.Nu+"() can only appear at the top level of your update data"):t.ku(this.Nu+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},Jc.prototype.isEqual=function(t){return t instanceof Jc},Jc);function Jc(){return null!==Wc&&Wc.apply(this,arguments)||this}function Yc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bc.call(this,t)||this}function $c(t,e,n){return new El({$u:3,Ou:e.settings.Ou,methodName:t.Nu,Mu:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Zc,tl,el,nl,rl=(n(wl,nl=Xc),wl.prototype.xu=function(t){return new fs(t.path,new $o)},wl.prototype.isEqual=function(t){return t instanceof wl},wl),il=(n(ml,el=Xc),ml.prototype.xu=function(t){var e=$c(this,t,!0),n=this.Lu.map(function(t){return Dl(t,e)}),n=new Zo(n);return new fs(t.path,n)},ml.prototype.isEqual=function(t){return this===t},ml),ol=(n(gl,tl=Xc),gl.prototype.xu=function(t){var e=$c(this,t,!0),n=this.Lu.map(function(t){return Dl(t,e)}),n=new is(n);return new fs(t.path,n)},gl.prototype.isEqual=function(t){return this===t},gl),sl=(n(vl,Zc=Xc),vl.prototype.xu=function(t){var e=new as(t.serializer,Uo(t.serializer,this.qu));return new fs(t.path,e)},vl.prototype.isEqual=function(t){return this===t},vl),ul=(Object.defineProperty(yl.prototype,"latitude",{get:function(){return this.Uu},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"longitude",{get:function(){return this.Bu},enumerable:!1,configurable:!0}),yl.prototype.isEqual=function(t){return this.Uu===t.Uu&&this.Bu===t.Bu},yl.prototype.toJSON=function(){return{latitude:this.Uu,longitude:this.Bu}},yl.prototype.V=function(t){return Cr(this.Uu,t.Uu)||Cr(this.Bu,t.Bu)},yl),al=function(t){this.ju=t},hl=/^__.*__$/,cl=function(t,e,n){this.Wu=t,this.Qu=e,this.Ku=n},ll=(dl.prototype.Gu=function(t,e){var n=[];return null!==this.We?n.push(new Os(t,this.data,this.We,e)):n.push(new Ns(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},dl),fl=(pl.prototype.Gu=function(t,e){e=[new Os(t,this.data,this.We,e)];return 0<this.fieldTransforms.length&&e.push(new Rs(t,this.fieldTransforms)),e},pl);function pl(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function dl(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function yl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Uu=t,this.Bu=e}function vl(t,e){var n=this;return(n=Zc.call(this,t)||this).qu=e,n}function gl(t,e){var n=this;return(n=tl.call(this,t)||this).Lu=e,n}function ml(t,e){var n=this;return(n=el.call(this,t)||this).Lu=e,n}function wl(){return null!==nl&&nl.apply(this,arguments)||this}function bl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var El=(Object.defineProperty(Al.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"$u",{get:function(){return this.settings.$u},enumerable:!1,configurable:!0}),Al.prototype.Hu=function(t){return new Al(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},Al.prototype.Yu=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Hu({path:e,Mu:!1});return e.Ju(t),e},Al.prototype.Xu=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Hu({path:t,Mu:!1});return t.zu(),t},Al.prototype.Zu=function(t){return this.Hu({path:void 0,Mu:!0})},Al.prototype.ku=function(t){return Vl(t,this.settings.methodName,this.settings.ta||!1,this.path,this.settings.Ou)},Al.prototype.contains=function(e){return void 0!==this.We.find(function(t){return e.O(t)})||void 0!==this.fieldTransforms.find(function(t){return e.O(t.field)})},Al.prototype.zu=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ju(this.path.get(t))},Al.prototype.Ju=function(t){if(0===t.length)throw this.ku("Document fields must not be empty");if(bl(this.$u)&&hl.test(t))throw this.ku('Document fields cannot begin and end with "__"')},Al),Il=(Tl.prototype.ea=function(t,e,n,r){return void 0===r&&(r=!1),new El({$u:t,methodName:e,Ou:n,path:si.B(),Mu:!1,ta:r},this._,this.serializer,this.ignoreUndefinedProperties)},Tl);function Tl(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Rc(t)}function Al(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.zu(),this.fieldTransforms=i||[],this.We=o||[]}function Nl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ea(o.merge||o.mergeFields?2:0,e,n,i);_l("Data must be an object, but it was:",s,r);var u,a,r=kl(r,s);if(o.merge)u=new ps(s.We),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof zc)p=f.Fu;else{if("string"!=typeof f)throw _r();p=Ul(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Cl(h,p)||h.push(p)}u=new ps(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new ll(new js(r),u,a)}function Ol(t,r,i,e){var o=t.ea(1,r,i);_l("Data must be an object, but it was:",o,e);var s=[],u=new xs;Yr(e,function(t,e){var n=Ul(r,t,i),t=o.Xu(n);e instanceof Qc||e instanceof al&&e.ju instanceof Qc?s.push(n):null!=(t=Dl(e,t))&&(s.push(n),u.set(n,t))});e=new ps(s);return new fl(u.Xe(),e,o.fieldTransforms)}function Sl(t,e,n,r,i,o){var s=t.ea(1,e,n),u=[Pl(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Pl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new xs,y=u.length-1;0<=y;--y){Cl(p,u[y])||(c=u[y],l=a[y],f=s.Xu(c),l instanceof Qc||l instanceof al&&l.ju instanceof Qc?p.push(c):null!=(f=Dl(l,f))&&(p.push(c),d.set(c,f)))}i=new ps(p);return new fl(d.Xe(),i,s.fieldTransforms)}function Ll(t,e,n,r){return void 0===r&&(r=!1),Dl(n,t.ea(r?4:3,e))}function Dl(s,t){if(s instanceof al&&(s=s.ju),Rl(s))return _l("Unsupported field value:",t,s),kl(s,t);if(s instanceof Xc)return function(t,e){if(!bl(e.$u))throw e.ku(t.Nu+"() can only be used with update() and set()");if(!e.path)throw e.ku(t.Nu+"() is not currently supported inside arrays");t=t.xu(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.We.push(t.path),s instanceof Array){if(t.settings.Mu&&4!==t.$u)throw t.ku("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Dl(i[r],t.Zu(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof ni){var r=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof ul)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qr)return{bytesValue:Co(e.serializer,t.l)};if(t instanceof cl){n=e._,r=t.Wu;if(!r.isEqual(n))throw e.ku("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.Wu||e._,t.Qu.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ku("Unsupported field value: "+Fc(t))}(s,t)}function kl(t,n){var r={};return $r(t)?n.path&&0<n.path.length&&n.We.push(n.path):Yr(t,function(t,e){e=Dl(e,n.Yu(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Rl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof ul||t instanceof qr||t instanceof cl||t instanceof Xc)}function _l(t,e,n){if(!Rl(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Fc(n);throw"an object"===n?e.ku(t+" a custom object"):e.ku(t+" "+n)}var r}function Pl(t,e,n){if(e instanceof zc)return e.Fu;if("string"==typeof e)return Ul(t,e);throw Vl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ul(t,e,n){try{return function(e){if(0<=e.search(Kc))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Hc.bind.apply(Hc,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Fu}catch(e){throw Vl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Vl(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Cl(t,e){return t.some(function(t){return t.isEqual(e)})}var Ml=(Gl.prototype.oa=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.ha(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Go((n=s).serializer)+"/documents",r={documents:u.map(function(t){return xo(n.serializer,t)})},[4,n.xo("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=qo(t,e.found.name),t=Mo(e.found.updateTime),e=new js({mapValue:{fields:e.found.fields}});return new Ks(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=qo(t,e.missing),e=Mo(e.readTime);return new Xs(t,e)}(e,t):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.Wo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Xs||t instanceof Ks?n.ca(t):_r()}),e)]}})})},Gl.prototype.set=function(t,e){this.write(e.Gu(t,this.Ge(t))),this.ra.add(t.toString())},Gl.prototype.update=function(t,e){try{this.write(e.Gu(t,this.ua(t)))}catch(t){this.ia=t}this.ra.add(t.toString())},Gl.prototype.delete=function(t){this.write([new Cs(t,this.Ge(t))]),this.ra.add(t.toString())},Gl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.ha(),this.ia)throw this.ia;return e=this.na,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui.H(e);n.mutations.push(new Ms(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Go((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Bo(e.serializer,t)})},[4,e.No("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wo,this.mutations)];case 1:return t.sent(),this.sa=!0,[2]}})})},Gl.prototype.ca=function(t){var e;if(t instanceof Ks)e=t.version;else{if(!(t instanceof Xs))throw _r();e=ri.min()}var n=this.na.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.na.set(t.key.toString(),e)},Gl.prototype.Ge=function(t){var e=this.na.get(t.toString());return!this.ra.has(t.toString())&&e?vs.updateTime(e):vs.Ye()},Gl.prototype.ua=function(t){var e=this.na.get(t.toString());if(this.ra.has(t.toString())||!e)return vs.exists(!0);if(e.isEqual(ri.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},Gl.prototype.write=function(t){this.ha(),this.mutations=this.mutations.concat(t)},Gl.prototype.ha=function(){},Gl),jl=(Fl.prototype.run=function(){this.la()},Fl.prototype.la=function(){var t=this;this.Xn.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ml(this.Wo),(n=this._a(e))&&n.then(function(t){r.On.Wn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.fa(t)})})}).catch(function(t){r.fa(t)}),[2]})})})},Fl.prototype._a=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},Fl.prototype.fa=function(t){var e=this;0<this.aa&&this.da(t)?(--this.aa,this.On.Wn(function(){return e.la(),Promise.resolve()})):this.qn.reject(t)},Fl.prototype.da=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Oi(t)},Fl),xl=(ql.prototype.start=function(t,e,n){var r=this;this.Ea(),this.ru=t;var i=new Hu,o=!1;return this.credentials.Qr(function(t){return o?void r.On.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.us(),Lr("RemoteStore","RemoteStore received new credentials"),n=Ah(e),e.zo.add(3),[4,vh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Qo.Cu(i)];case 2:return t.sent(),e.zo.delete(3),[4,yh(e)];case 3:return t.sent(),[2]}})})}(r.ph,t)}):(o=!0,Lr("FirestoreClient","Initializing. user=",t.uid),r.Ta(e,n,t,i).then(r.wa.resolve,r.wa.reject))}),this.On.Wn(function(){return r.wa.promise}),i.promise},ql.prototype.enableNetwork=function(){var e=this;return this.Ea(),this.On.enqueue(function(){return e.persistence.Lc(!0),(t=e.ph).zo.delete(0),yh(t);var t})},ql.prototype.Ta=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,ru:this.ru,clientId:this.clientId,credentials:this.credentials,Vu:o,Ch:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.bh=r.bh,this.jo=r.jo,this.Au=r.Au,this.Wo=i.Wo,this.ph=i.ph,this.vu=i.vu,this.ma=i.gh,this.ma.Is=Gh.bind(null,this.vu),this.ma.Ps=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Dh.get(o),1<(r=e.Fh.get(n.targetId)).length?[2,(e.Fh.set(n.targetId,r.filter(function(t){return!lu(t,o)})),void e.Dh.delete(o))]:e.Uh?(e.bh.Hs(n.targetId),e.bh.Zs(n.targetId)?[3,2]:[4,qa(e.jo,n.targetId,!1).then(function(){e.bh.Js(n.targetId),wh(e.ph,n.targetId),Xh(e,n.targetId)}).catch(Ga)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Xh(e,n.targetId),[4,qa(e.jo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.vu),this.persistence.Mc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Ir.FAILED_PRECONDITION||e.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Ta(new _c,new Pc,o,s))];case 4:return[2]}})})},ql.prototype.Ea=function(){if(this.On.ts)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},ql.prototype.disableNetwork=function(){var t=this;return this.Ea(),this.On.enqueue(function(){return t.persistence.Lc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,vh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.ph)})},ql.prototype.terminate=function(){var t=this;this.On.rs();var n=new Hu;return this.On.es(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Au&&this.Au.stop(),[4,gh(this.ph)];case 1:return t.sent(),[4,this.bh.ni()];case 2:return t.sent(),[4,this.persistence.ni()];case 3:return t.sent(),this.credentials.Kr(),n.resolve(),[3,5];case 4:return e=t.sent(),e=ra(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},ql.prototype.waitForPendingWrites=function(){var t=this;this.Ea();var e=new Hu;return this.On.Wn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Ah((n=o).ph)||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.li.Hh(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Mh.get(r)||[]).push(s),n.Mh.set(r,i),[3,4]);case 3:return i=t.sent(),i=ra(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.vu,e)}),e.promise},ql.prototype.listen=function(t,e,n){var r=this;this.Ea();var i=new Uc(n),o=new ha(t,i,e);return this.On.Wn(function(){return sa(r.ma,o)}),function(){i.Du(),r.On.Wn(function(){return ua(r.ma,o)})}},ql.prototype.Ia=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Hu,[2,(this.On.Wn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.nr.fi(t,e)}))];case 1:return(r=t.sent())instanceof Ks?s.resolve(r):r instanceof Xs?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=ra(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.jo,r,e)}),e.promise)]}})})},ql.prototype.Aa=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Hu,[2,(this.On.Wn(function(){return n=a.ma,r=a.On,i=h,o=c,s=e,t=new Uc({next:function(t){r.Wn(function(){return ua(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ha(tu(i.path),t,{includeMetadataChanges:!0,Cs:!0}),sa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},ql.prototype.Ra=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Hu,[2,(this.On.Wn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Fa(r,i,!0)];case 1:return n=t.sent(),e=new Mh(i,n.gr),n=e.fh(n.documents),n=e.Th(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=ra(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.jo,r,e)}),e.promise)]}})})},ql.prototype.Pa=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),u=new Hu,[2,(this.On.Wn(function(){return e=a.ma,n=a.On,t=h,r=c,i=u,o=new Uc({next:function(t){n.Wn(function(){return ua(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ha(t,o,{includeMetadataChanges:!0,Cs:!0}),sa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},ql.prototype.write=function(t){var e=this;this.Ea();var n=new Hu;return this.On.Wn(function(){return Wh(e.vu,t,n)}),n.promise},ql.prototype._=function(){return this.ru._},ql.prototype.Va=function(t){var e=this;this.Ea();var r=new Uc(t);return this.On.Wn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.ma,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Du(),e.On.Wn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.ma.Ts.delete(r)]})})})}},Object.defineProperty(ql.prototype,"ya",{get:function(){return this.On.ts},enumerable:!1,configurable:!0}),ql.prototype.transaction=function(t){var e=this;this.Ea();var n=new Hu;return this.On.Wn(function(){return new jl(e.On,e.Wo,t,n).run(),Promise.resolve()}),n.promise},ql);function ql(t,e){this.credentials=t,this.On=e,this.clientId=Ur.t(),this.wa=new Hu}function Fl(t,e,n,r){this.On=t,this.Wo=e,this.updateFunction=n,this.qn=r,this.aa=5,this.Xn=new Ku(this.On,"transaction_retry")}function Gl(t){this.Wo=t,this.na=new Map,this.mutations=[],this.sa=!1,this.ia=null,this.ra=new Set}function Wl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Bl,zl,Hl=(df.prototype.ba=function(t){switch(po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Ca(t.timestampValue);case 4:return this.Sa(t);case 5:return t.stringValue;case 6:return this.va(Io(t.bytesValue));case 7:return this.Da(t.referenceValue);case 8:return this.Fa(t.geoPointValue);case 9:return this.Na(t.arrayValue);case 10:return this.xa(t.mapValue);default:throw _r()}},df.prototype.xa=function(t){var n=this,r={};return Yr(t.fields||{},function(t,e){r[t]=n.ba(e)}),r},df.prototype.Fa=function(t){return new ul(Eo(t.latitude),Eo(t.longitude))},df.prototype.Na=function(t){var e=this;return(t.values||[]).map(function(t){return e.ba(t)})},df.prototype.Sa=function(t){switch(this.pa){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return co(e)?t(e):e}(t);return null==e?null:this.ba(e);case"estimate":return this.Ca(lo(t));default:return null}},df.prototype.Ca=function(t){t=bo(t);return new ni(t.seconds,t.nanos)},df.prototype.Da=function(t){var e=ii.U(t);Pr(Xo(e));t=new Kr(e.get(1),e.get(3)),e=new ui(e.F(5));return t.isEqual(this._)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.ga(e)},df),Kl=Ea.Oi,Xl=(pf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},pf),Ql="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Jl=(ff.prototype.enableIndexedDbPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,Ql)},ff.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Tr(Ir.FAILED_PRECONDITION,Ql)},ff.prototype.clearIndexedDbPersistence=function(t){throw new Tr(Ir.FAILED_PRECONDITION,Ql)},ff),Yl=(Object.defineProperty(lf.prototype,"Wa",{get:function(){return this.Qa||(this.Qa=new Il(this.Wu,this.ja.ignoreUndefinedProperties)),this.Qa},enumerable:!1,configurable:!0}),lf.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.ja),t)).merge;t=new Xl(t);if(this.La&&!this.ja.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.ja=t).credentials&&(this.Ba=function(t){if(!t)return new Ja;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Za(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},lf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.ja.host&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},lf.prototype.enableNetwork=function(){return this.Ma(),this.La.enableNetwork()},lf.prototype.disableNetwork=function(){return this.Ma(),this.La.disableNetwork()},lf.prototype.enablePersistence=function(t){if(this.La)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&qc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.$a.enableMultiTabIndexedDbPersistence(this):this.$a.enableIndexedDbPersistence(this,n)},lf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.La&&!this.La.ya)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.$a.clearIndexedDbPersistence(this)]})})},lf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(lf.prototype,"Ka",{get:function(){return this.Ma(),this.La.ya},enumerable:!1,configurable:!0}),lf.prototype.waitForPendingWrites=function(){return this.Ma(),this.La.waitForPendingWrites()},lf.prototype.onSnapshotsInSync=function(t){if(this.Ma(),Wl(t))return this.La.Va(t);t={next:t};return this.La.Va(t)},lf.prototype.Ma=function(){return this.La||this.Ga(new _c,new Pc),this.La},lf.prototype.za=function(){return new Br(this.Wu,this.Ua,this.ja.host,this.ja.ssl,this.ja.experimentalForceLongPolling,this.ja.experimentalAutoDetectLongPolling)},lf.prototype.Ga=function(t,e){var n=this.za();return this.La=new xl(this.Ba,this.Oa),this.La.start(n,t,e)},lf.qa=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Kr(t)},Object.defineProperty(lf.prototype,"app",{get:function(){if(!this.ka)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ka},enumerable:!1,configurable:!0}),lf.prototype.collection=function(t){return jc("Firestore.collection","path",t),this.Ma(),new If(ii.U(t),this,null)},lf.prototype.doc=function(t){return jc("Firestore.doc","path",t),this.Ma(),tf.Ha(ii.U(t),this,null)},lf.prototype.collectionGroup=function(t){if(jc("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ma(),new bf((t=t,new Js(ii.B(),t)),this,null)},lf.prototype.runTransaction=function(e){var n=this;return this.Ma().transaction(function(t){return e(new $l(n,t))})},lf.prototype.batch=function(){return this.Ma(),new Zl(this)},lf.prototype.Ya=function(){return this.ja},lf),$l=(cf.prototype.get=function(t){var e=this,n=Of(0,t,this.Ja);return this.Xa.oa([n.Qu]).then(function(t){if(!t||1!==t.length)return _r();t=t[0];if(t instanceof Xs)return new nf(e.Ja,n.Qu,null,!1,!1,n.Ku);if(t instanceof Ks)return new nf(e.Ja,n.Qu,t,!1,!1,n.Ku);throw _r()})},cf.prototype.set=function(t,e,n){t=Of(0,t,this.Ja);n=xc("Transaction.set",n);e=Sf(t.Ku,e,n),n=Nl(this.Ja.Wa,"Transaction.set",t.Qu,e,null!==t.Ku,n);return this.Xa.set(t.Qu,n),this},cf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Hc?(r=Of(0,t,this.Ja),Sl(this.Ja.Wa,"Transaction.update",r.Qu,e,n,i)):(r=Of(0,t,this.Ja),Ol(this.Ja.Wa,"Transaction.update",r.Qu,e)),this.Xa.update(r.Qu,e),this},cf.prototype.delete=function(t){t=Of(0,t,this.Ja);return this.Xa.delete(t.Qu),this},cf),Zl=(hf.prototype.set=function(t,e,n){this.el();t=Of(0,t,this.Ja);n=xc("WriteBatch.set",n);e=Sf(t.Ku,e,n),n=Nl(this.Ja.Wa,"WriteBatch.set",t.Qu,e,null!==t.Ku,n);return this.Za=this.Za.concat(n.Gu(t.Qu,vs.Ye())),this},hf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.el(),e="string"==typeof e||e instanceof Hc?(r=Of(0,t,this.Ja),Sl(this.Ja.Wa,"WriteBatch.update",r.Qu,e,n,i)):(r=Of(0,t,this.Ja),Ol(this.Ja.Wa,"WriteBatch.update",r.Qu,e)),this.Za=this.Za.concat(e.Gu(r.Qu,vs.exists(!0))),this},hf.prototype.delete=function(t){this.el();t=Of(0,t,this.Ja);return this.Za=this.Za.concat(new Cs(t.Qu,vs.Ye())),this},hf.prototype.commit=function(){return this.el(),this.tl=!0,0<this.Za.length?this.Ja.Ma().write(this.Za):Promise.resolve()},hf.prototype.el=function(){if(this.tl)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},hf),tf=(n(af,zl=cl),af.Ha=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.q()+" has "+t.length);return new af(new ui(t),e,n)},Object.defineProperty(af.prototype,"id",{get:function(){return this.Qu.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(af.prototype,"parent",{get:function(){return new If(this.Qu.path.N(),this.firestore,this.Ku)},enumerable:!1,configurable:!0}),Object.defineProperty(af.prototype,"path",{get:function(){return this.Qu.path.q()},enumerable:!1,configurable:!0}),af.prototype.collection=function(t){if(jc("DocumentReference.collection","path",t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=ii.U(t);return new If(this.Qu.path.child(t),this.firestore,null)},af.prototype.isEqual=function(t){return t instanceof af&&this.firestore===t.firestore&&this.Qu.isEqual(t.Qu)&&this.Ku===t.Ku},af.prototype.set=function(t,e){e=xc("DocumentReference.set",e);t=Sf(this.Ku,t,e),e=Nl(this.firestore.Wa,"DocumentReference.set",this.Qu,t,null!==this.Ku,e);return this.La.write(e.Gu(this.Qu,vs.Ye()))},af.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Hc?Sl(this.firestore.Wa,"DocumentReference.update",this.Qu,t,e,n):Ol(this.firestore.Wa,"DocumentReference.update",this.Qu,t),this.La.write(t.Gu(this.Qu,vs.exists(!0)))},af.prototype.delete=function(){return this.La.write([new Cs(this.Qu,vs.Ye())])},af.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Wl(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};Wl(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.nl(t))},error:n[i+1],complete:n[i+2]};return this.La.listen(tu(this.Qu.path),o,s)},af.prototype.get=function(t){var e=this,n=this.firestore.Ma();return t&&"cache"===t.source?n.Ia(this.Qu).then(function(t){return new nf(e.firestore,e.Qu,t,!0,t instanceof Ks&&t.Je,e.Ku)}):n.Aa(this.Qu,t).then(function(t){return e.nl(t)})},af.prototype.withConverter=function(t){return new af(this.Qu,this.firestore,t)},af.prototype.nl=function(t){var e=t.docs.get(this.Qu);return new nf(this.firestore,this.Qu,e,t.fromCache,t.hasPendingWrites,this.Ku)},af),ef=(uf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},uf),nf=(sf.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.sl){if(this.Ku){var n=new rf(this.Ja,this.Qu,this.sl,this.il,this.rl,null);return this.Ku.fromFirestore(n,t)}return new Hl(this.Ja.Wu,t.serverTimestamps||"none",function(t){return new tf(t,e.Ja,null)},function(t){return new Hr(t)}).ba(this.sl.rn())}},sf.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.sl){t=this.sl.data().field(Pl("DocumentSnapshot.get",t,this.Qu));if(null!==t)return new Hl(this.Ja.Wu,e.serverTimestamps||"none",function(t){return new tf(t,n.Ja,n.Ku)},function(t){return new Hr(t)}).ba(t)}},Object.defineProperty(sf.prototype,"id",{get:function(){return this.Qu.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"ref",{get:function(){return new tf(this.Qu,this.Ja,this.Ku)},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"exists",{get:function(){return null!==this.sl},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"metadata",{get:function(){return new ef(this.rl,this.il)},enumerable:!1,configurable:!0}),sf.prototype.isEqual=function(t){return t instanceof sf&&this.Ja===t.Ja&&this.il===t.il&&this.Qu.isEqual(t.Qu)&&(null===this.sl?null===t.sl:this.sl.isEqual(t.sl))&&this.Ku===t.Ku},sf),rf=(n(of,Bl=nf),of.prototype.data=function(t){return Bl.prototype.data.call(this,t)},of);function of(){return null!==Bl&&Bl.apply(this,arguments)||this}function sf(t,e,n,r,i,o){this.Ja=t,this.Qu=e,this.sl=n,this.il=r,this.rl=i,this.Ku=o}function uf(t,e){this.hasPendingWrites=t,this.fromCache=e}function af(t,e,n){var r=this;return(r=zl.call(this,e.Wu,t,n)||this).Qu=t,r.firestore=e,r.Ku=n,r.La=r.firestore.Ma(),r}function hf(t){this.Ja=t,this.Za=[],this.tl=!1}function cf(t,e){this.Ja=t,this.Xa=e}function lf(t,e,n){var r=this;if(void 0===n&&(n=new Jl),this.$a=n,this.ka=null,this.Oa=new ta,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ma(),[4,this.La.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){n=t;this.ka=n,this.Wu=lf.qa(n),this.Ua=n.name,this.Ba=new Ya(e)}else{t=t;if(!t.projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.Wu=new Kr(t.projectId,t.database),this.Ua="[DEFAULT]",this.Ba=new Ja}this.ja=new Xl({})}function ff(){}function pf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ea.Li;else{if(t.cacheSizeBytes!==Kl&&t.cacheSizeBytes<Ea.Mi)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ea.Mi);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function df(t,e,n,r){this._=t,this.pa=e,this.ga=n,this.va=r}function yf(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ou(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ii.U(n));if(!ui.X(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return To(t,new ui(e))}if(n instanceof cl)return To(t,n.Qu);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Fc(n)+".")}function vf(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function gf(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function mf(t){if(nu(t)&&0===t.on.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var wf,bf=(Nf.prototype.where=function(t,e,n){t=Pl("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){vf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(yf(n,t,h))}c={arrayValue:{values:s}}}else c=yf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||vf(o,i),c=Ll(e,"Query.where",o,"in"===i||"not-in"===i);var c=gu.create(r,i,c);return function(t,e){if(e.an()){var n=iu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=ru(t);null!==n&&gf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.ol,this.firestore.Wa,this.firestore.Wu,t,e,n);return new Nf((n=this.ol,e=n.filters.concat([e]),new Js(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.hn,n.startAt,n.endAt)),this.firestore,this.Ku)},Nf.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Pl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new zu(e,n);return n=e,null!==ru(t)||null!==(t=iu(t))&&gf(0,t,n.field),e}(this.ol,t,n);return new Nf((n=this.ol,t=n.on.concat([t]),new Js(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.hn,n.startAt,n.endAt)),this.firestore,this.Ku)},Nf.prototype.limit=function(t){return Gc("Query.limit",t),new Nf(au(this.ol,t,"F"),this.firestore,this.Ku)},Nf.prototype.limitToLast=function(t){return Gc("Query.limitToLast",t),new Nf(au(this.ol,t,"L"),this.firestore,this.Ku)},Nf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.hl("Query.startAt",t,e,!0);return new Nf(hu(this.ol,t),this.firestore,this.Ku)},Nf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.hl("Query.startAfter",t,e,!1);return new Nf(hu(this.ol,t),this.firestore,this.Ku)},Nf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.hl("Query.endBefore",t,e,!0);return new Nf(cu(this.ol,t),this.firestore,this.Ku)},Nf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.hl("Query.endAt",t,e,!1);return new Nf(cu(this.ol,t),this.firestore,this.Ku)},Nf.prototype.isEqual=function(t){return t instanceof Nf&&this.firestore===t.firestore&&lu(this.ol,t.ol)&&this.Ku===t.Ku},Nf.prototype.withConverter=function(t){return new Nf(this.ol,this.firestore,t)},Nf.prototype.hl=function(h,t,e,n){if(t instanceof nf)return function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=su(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(To(e,n.key));else{var a=n.field(u.field);if(co(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.q();throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Mu(i,r)}(this.ol,this.firestore.Wu,t.sl,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.W()){if("string"!=typeof h)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ou(t)&&-1!==h.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ii.U(h));if(!ui.X(c))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ui(c);u.push(To(e,c))}else{h=Ll(n,r,h);u.push(h)}}return new Mu(u,o)}(this.ol,this.firestore.Wu,this.firestore.Wa,h,e,n)},Nf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||Wl(n[o])||(i=n[o],o++),Wl(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Ef(e.firestore,e.ol,t,e.Ku))},error:n[o+1],complete:n[o+2]};return mf(this.ol),this.firestore.Ma().listen(this.ol,i,s)},Nf.prototype.get=function(t){var e=this;mf(this.ol);var n=this.firestore.Ma();return(t&&"cache"===t.source?n.Ra(this.ol):n.Pa(this.ol,t)).then(function(t){return new Ef(e.firestore,e.ol,t,e.Ku)})},Nf),Ef=(Object.defineProperty(Af.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"empty",{get:function(){return this.ul.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"size",{get:function(){return this.ul.docs.size},enumerable:!1,configurable:!0}),Af.prototype.forEach=function(e,n){var r=this;this.ul.docs.forEach(function(t){e.call(n,r._l(t,r.metadata.fromCache,r.ul.Wt.has(t.key)))})},Object.defineProperty(Af.prototype,"query",{get:function(){return new bf(this.cl,this.Ja,this.Ku)},enumerable:!1,configurable:!0}),Af.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.ul.Kt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.al&&this.ll===t||(this.al=function(i,e,o){if(i.jt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.jt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.ul,t,this._l.bind(this)),this.ll=t),this.al},Af.prototype.isEqual=function(t){return t instanceof Af&&this.Ja===t.Ja&&lu(this.cl,t.cl)&&this.ul.isEqual(t.ul)&&this.Ku===t.Ku},Af.prototype._l=function(t,e,n){return new rf(this.Ja,t.key,t,e,n,this.Ku)},Af),If=(n(Tf,wf=bf),Object.defineProperty(Tf.prototype,"id",{get:function(){return this.ol.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"parent",{get:function(){var t=this.ol.path.N();return t.P()?null:new tf(new ui(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"path",{get:function(){return this.ol.path.q()},enumerable:!1,configurable:!0}),Tf.prototype.doc=function(t){0===arguments.length&&(t=Ur.t()),jc("CollectionReference.doc","path",t);t=ii.U(t);return tf.Ha(this.ol.path.child(t),this.firestore,this.Ku)},Tf.prototype.add=function(t){var t=this.Ku?this.Ku.toFirestore(t):t,e=this.doc();return new tf(e.Qu,this.firestore,null).set(t).then(function(){return e})},Tf.prototype.withConverter=function(t){return new Tf(this.fl,this.firestore,t)},Tf);function Tf(t,e,n){var r=this;if(((r=wf.call(this,tu(t),e,n)||this).fl=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.q()+" has "+t.length);return r}function Af(t,e,n,r){this.Ja=t,this.cl=e,this.ul=n,this.Ku=r,this.al=null,this.ll=null,this.metadata=new ef(n.hasPendingWrites,n.fromCache)}function Nf(t,e,n){this.ol=t,this.firestore=e,this.Ku=n}function Of(t,e,n){e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new Tr(Ir.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Fc(t);throw new Tr(Ir.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,tf);if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Sf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Lf,Df,l=(n(Rf,Lf=al),Rf.serverTimestamp=function(){var t=new rl("serverTimestamp");return t.Nu="FieldValue.serverTimestamp",new Rf(t)},Rf.delete=function(){var t=new Qc("deleteField");return t.Nu="FieldValue.delete",new Rf(t)},Rf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new il("arrayUnion",t)}.apply(void 0,t);return n.Nu="FieldValue.arrayUnion",new Rf(n)},Rf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ol("arrayRemove",t)}.apply(void 0,t);return n.Nu="FieldValue.arrayRemove",new Rf(n)},Rf.increment=function(t){t=new sl("increment",t);return t.Nu="FieldValue.increment",new Rf(t)},Rf.prototype.isEqual=function(t){return this.ju.isEqual(t.ju)},Rf),kf={Firestore:Yl,GeoPoint:ul,Timestamp:ni,Blob:Hr,Transaction:$l,WriteBatch:Zl,DocumentReference:tf,DocumentSnapshot:nf,Query:bf,QueryDocumentSnapshot:rf,QuerySnapshot:Ef,CollectionReference:If,FieldPath:Hc,FieldValue:l,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:Kl};function Rf(){return null!==Lf&&Lf.apply(this,arguments)||this}(Df=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Yl(e,t,new Jl);var e},"PUBLIC").setServiceProps(Object.assign({},kf))),Df.registerVersion("@firebase/firestore","2.0.0-2020926155854")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
