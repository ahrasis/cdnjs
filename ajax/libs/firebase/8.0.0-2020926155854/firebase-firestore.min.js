!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Xd){"use strict";try{(function(){var l,t,e=(t=Xd)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=l=l||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++L))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}var Q=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}K=(Q=Q&&Q.userAgent)?Q:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=X(K,"Opera"),it=X(K,"Trident")||X(K,"MSIE"),ot=X(K,"Edge"),st=ot||it,ut=X(K,"Gecko")&&!(X(K.toLowerCase(),"webkit")&&!X(K,"Edge"))&&!(X(K,"Trident")||X(K,"MSIE"))&&!X(K,"Edge"),at=X(K.toLowerCase(),"webkit")&&!X(K,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);ft&&(ht=ft?ft[1]:""),nt=it&&null!=(ft=ct())&&ft>parseFloat(ht)?String(ft):ht;var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),xt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ut(r),e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ct(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Tt(t)))}function Lt(t){return t in xt?xt[t]:xt[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Rt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new wt(e,this))}function Ct(t){return(t=t[Dt])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==x(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Kt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Wt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Qt)}),Xt||(Bt(),Xt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=U()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==x(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(_(ee=oe,ne=te=q),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){q.call(this),this.b=t,this.a={}}j(se,q);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le=null;function pe(){return le=le||new jt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(de,mt),j(ve,mt),j(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ee(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Oe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Ne,mt),j(Se,mt),j(De,Ee),Ae=new De;var Oe=45e3,ke={},Pe={};function Le(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,Re(t,null)}function Re(t,e){t.u=U(),Ce(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,ge(),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,ge(),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Fe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),je(t))}function Ce(t){t.U=U()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function Ue(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){Ue(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}$n(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(En(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ue(o),Ce(o)),n.a=i):Jn(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=xe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Ue(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),qe(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Fe(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),qe(this),je(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Ue(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},A.cancel=function(){this.A=!0,qe(this)},A.Ua=function(){this.o=null;var t,e,n=U();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),qe(this),this.h=2,je(this)):Me(this,this.U-n)},(A=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Qe(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=en(n[2]||""),Qe(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Xe(t){return new We(t)}function Ye(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Qe(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function xn(t){jt.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}j(xn,jt);var On="",kn=/^https?$/i,Pn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Rn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Mn(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Fn("baseRetryDelayMs",5e3,t),this.Ma=Fn("retryDelaySeedMs",1e4,t),this.Ja=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ze(n=Xe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Yn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=U(),Ce(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),En(t.b,n),Le(n,r,e)}function Yn(t,n){t.f&&Ge({},function(t,e){Ze(n,e,t)})}function Qn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Ft(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new xe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Yn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,Re(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Wn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ye(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Tn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Xe(s):new We(s,void 0);return""!=a.c?(e&&Qe(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Ye(u,r),i&&Qe(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Yn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){jt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=xn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ae),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Rn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Rn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),xn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},A.Ta=function(){Cn(this)},A.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),Ze(i=Xe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),En(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},j(hr,jt),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},A.close=function(){Bn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Ft(t),Kn(this.a,e)):Kn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},j(fr,Ne),j(lr,Se),j(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new lr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ie.COMPLETE="complete",(Te.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,xn.prototype.listenOnce=xn.prototype.wa,xn.prototype.getLastError=xn.prototype.Qa,xn.prototype.getLastErrorCode=xn.prototype.ua,xn.prototype.getStatus=xn.prototype.X,xn.prototype.getResponseJson=xn.prototype.Na,xn.prototype.getResponseText=xn.prototype.$,xn.prototype.send=xn.prototype.ba;var dr=be,yr=Ie,vr=Te,gr=xn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Er=(n(Ar,br=Error),Ar),_r="8.0.0-2020926155854",Tr=new h("@firebase/firestore");function Ar(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Nr(){return Tr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.DEBUG&&(e=n.map(Or),Tr.debug.apply(Tr,i(["Firestore ("+_r+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.ERROR&&(e=n.map(Or),Tr.error.apply(Tr,i(["Firestore ("+_r+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.WARN&&(e=n.map(Or),Tr.warn.apply(Tr,i(["Firestore ("+_r+"): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){throw void 0===t&&(t="Unexpected state"),Dr(t="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Pr(t){t||kr()}var Lr=(Rr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Rr);function Rr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Cr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}var Ur=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.h=function(t){return Vr(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}Ur.u=new Ur("");var qr=(Fr.fromBase64String=function(t){try{return new Fr(Ur.fromBase64String(t))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Fr.fromUint8Array=function(t){return new Fr(Ur.fromUint8Array(t))},Fr.prototype.toBase64=function(){return this.l.toBase64()},Fr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Fr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Fr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Fr);function Fr(t){this.l=t}function Gr(){if("undefined"==typeof Uint8Array)throw new Er(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Br(){if("undefined"==typeof atob)throw new Er(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function zr(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var Hr,Kr=(n(Yr,Hr=qr),Yr.fromBase64String=function(t){Br();try{return new Yr(Ur.fromBase64String(t))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Yr.fromUint8Array=function(t){return Gr(),new Yr(Ur.fromUint8Array(t))},Yr.prototype.toBase64=function(){return Br(),Hr.prototype.toBase64.call(this)},Yr.prototype.toUint8Array=function(){return Gr(),Hr.prototype.toUint8Array.call(this)},Yr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yr),Wr=(Object.defineProperty(Xr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Xr.prototype.isEqual=function(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database},Xr.prototype.h=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Xr);function Xr(t,e){this.projectId=t,this.database=e||"(default)"}function Yr(){return null!==Hr&&Hr.apply(this,arguments)||this}function Qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Zr,ti,ei=(di.prototype.get=function(t){var e=this.m(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},di.prototype.has=function(t){return void 0!==this.get(t)},di.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},di.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},di.prototype.forEach=function(s){Jr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},di.prototype.P=function(){return $r(this.R)},di),ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.g=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(li.V=function(t){return new li(t)},li.min=function(){return new li(new ni(0,0))},li.prototype.h=function(t){return this.timestamp.g(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.v=function(){return this.timestamp},li),be=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.D(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},fi.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},fi.prototype.k=function(){return this.segments[this.offset]},fi.prototype.O=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.P=function(){return 0===this.length},fi.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},fi.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(n(hi,ti=be),hi.prototype.C=function(t,e,n){return new hi(t,e,n)},hi.prototype.B=function(){return this.L().join("/")},hi.prototype.toString=function(){return this.B()},hi.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.U=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(n(ci,Zr=be),ci.prototype.C=function(t,e,n){return new ci(t,e,n)},ci.K=function(t){return oi.test(t)},ci.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ci.K(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.B()},ci.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ci.j=function(){return new ci(["__name__"])},ci.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Er(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Er(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Er(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.U=function(){return new ci([])},ci),ui=(ai.H=function(t){return new ai(ii.q(t))},ai.J=function(t){return new ai(ii.q(t).N(5))},ai.prototype.Y=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.D(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.D=function(t,e){return ii.D(t.path,e.path)},ai.X=function(t){return t.length%2==0},ai.Z=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==Zr&&Zr.apply(this,arguments)||this}function hi(){return null!==ti&&ti.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.S=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Er(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t,e){this.m=t,this.A=e,this.R={}}function yi(t){return null==t}function vi(t){return 0===t&&1/t==-1/0}function gi(t){return"number"==typeof t&&Number.isInteger(t)&&!vi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.B()+t.op.toString()+bo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.B()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ju(e.startAt)),e.endAt&&(t+="|ub:",t+=Ju(e.endAt)),e.tt=t),e.tt}function Ii(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zu(t.startAt,e.startAt)&&Zu(t.endAt,e.endAt)}function Ei(t){return ui.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function _i(t){this.count=t}var Ti,Ai=(Ni.prototype.st=function(t){return new Ni(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ni.prototype.it=function(t,e){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ni.prototype.rt=function(t){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ni);function Ni(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=Ur.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Ir.OK:return kr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return kr(),0}}function Di(t){if(void 0===t)return Dr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Ti.OK:return Ir.OK;case Ti.CANCELLED:return Ir.CANCELLED;case Ti.UNKNOWN:return Ir.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Ir.INTERNAL;case Ti.UNAVAILABLE:return Ir.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Ir.NOT_FOUND;case Ti.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Ti.ABORTED:return Ir.ABORTED;case Ti.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Ti.DATA_LOSS:return Ir.DATA_LOSS;default:return kr()}}(Ie=Ti=Ti||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var xi=(Ri.prototype.ot=function(t,e){return new Ri(this.D,this.root.ot(t,e,this.D).copy(null,null,ki.at,null,null))},Ri.prototype.remove=function(t){return new Ri(this.D,this.root.remove(t,this.D).copy(null,null,ki.at,null,null))},Ri.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ri.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ri.prototype.P=function(){return this.root.P()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ri.prototype.ht=function(){return this.root.ht()},Ri.prototype.ct=function(){return this.root.ct()},Ri.prototype.ut=function(t){return this.root.ut(t)},Ri.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Ri.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ri.prototype.lt=function(t){return this.root.lt(t)},Ri.prototype._t=function(){return new Oi(this.root,null,this.D,!1)},Ri.prototype.ft=function(t){return new Oi(this.root,t,this.D,!1)},Ri.prototype.dt=function(){return new Oi(this.root,null,this.D,!0)},Ri.prototype.wt=function(t){return new Oi(this.root,t,this.D,!0)},Ri),Oi=(Li.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Li.prototype.At=function(){return 0<this.Tt.length},Li.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Li),ki=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype.P=function(){return!1},Pi.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},Pi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Pi.prototype.min=function(){return this.left.P()?this:this.left.min()},Pi.prototype.ht=function(){return this.min().key},Pi.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},Pi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Pi.prototype.gt=function(){if(this.left.P())return Pi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.bt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Pi.prototype.Vt=function(){return this.color},Pi.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},Pi.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Pi.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},Pi.prototype.St=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.bt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Pi.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw kr();if(this.right.Vt())throw kr();var t=this.left.Nt();if(t!==this.right.Nt())throw kr();return t+(this.Vt()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Ri(t,e){this.D=t,this.root=e||ki.EMPTY}function Vi(){this.size=0}ki.EMPTY=null,ki.RED=!0,ki.at=!1,ki.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.ot=function(t,e,n){return new ki(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype.P=function(){return!0},Vi.prototype.ut=function(t){return!1},Vi.prototype.lt=function(t){return!1},Vi.prototype.ht=function(){return null},Vi.prototype.ct=function(){return null},Vi.prototype.Vt=function(){return!1},Vi.prototype.Ct=function(){return!0},Vi.prototype.Nt=function(){return 0},new Vi);var Ci=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.ht()},qi.prototype.last=function(){return this.data.ct()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},qi.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},qi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},qi.prototype.kt=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},qi.prototype._t=function(){return new Mi(this.data._t())},qi.prototype.ft=function(t){return new Mi(this.data.ft(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype.P=function(){return this.data.P()},qi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},qi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.D);return e.data=t,e},qi),Mi=(ji.prototype.It=function(){return this.Mt.It().key},ji.prototype.At=function(){return this.Mt.At()},ji),Ui=new xi(ui.D);function ji(t){this.Mt=t}function qi(t){this.D=t,this.data=new xi(this.D)}var Fi=new xi(ui.D),Gi=new xi(ui.D),Bi=new Ci(ui.D);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new Ci(Vr),Ki=(ao.Bt=function(t){return new ao(t.D)},ao.prototype.has=function(t){return null!=this.$t.get(t)},ao.prototype.get=function(t){return this.$t.get(t)},ao.prototype.first=function(){return this.Lt.ht()},ao.prototype.last=function(){return this.Lt.ct()},ao.prototype.P=function(){return this.Lt.P()},ao.prototype.indexOf=function(t){return(t=this.$t.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Lt.ut(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.D=this.D,n.$t=t,n.Lt=e,n},ao),Wi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):kr()},uo.prototype.Ut=function(){var n=[];return this.qt.ut(function(t,e){n.push(e)}),n},uo),Xi=(so.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Ki.Bt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Yi=(oo.Xt=function(t,e){var n=new Map;return n.set(t,Qi.Zt(t,e)),new oo(ri.min(),n,Hi,Ui,zi())},oo),Qi=(io.Zt=function(t,e){return new io(Ur.u,e,zi(),zi(),zi())},io),Ji=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},$i=function(t,e){this.targetId=t,this.oe=e},Zi=function(t,e,n,r){void 0===n&&(n=Ur.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},to=(Object.defineProperty(ro.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),ro.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ce=t)},ro.prototype.we=function(){var n=zi(),r=zi(),i=zi();return this.he.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Qi(this.ce,this.ue,n,r,i)},ro.prototype.Ee=function(){this.le=!1,this.he=ho()},ro.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},ro.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},ro.prototype.me=function(){this.ae+=1},ro.prototype.Ae=function(){--this.ae},ro.prototype.Re=function(){this.le=!0,this.ue=!0},ro),eo=(no.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof eu?this.ve(r,t.re):t.re instanceof nu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},no.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:kr()}})},no.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},no.prototype.ke=function(t){var e=t.targetId,n=t.oe.count;(t=this.Oe(e))&&(Ei(t=t.target)?0===n?(t=new ui(t.path),this.Se(e,t,new nu(t,ri.min()))):Pr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},no.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.Oe(e);n&&(t.te&&Ei(n.target)&&(n=new ui(n.target.path),null!==i.Ve.get(n)||i.Le(e,n)||i.Se(e,n,new nu(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=zi();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.Oe(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Yi(r,o,this.pe,this.Ve,s);return this.Ve=Ui,this.ye=co(),this.pe=new Ci(Vr),t},no.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t)))},no.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n)))},no.prototype.removeTarget=function(t){this.ge.delete(t)},no.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},no.prototype.me=function(t){this.Ne(t).me()},no.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new to,this.ge.set(t,e)),e},no.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Ci(Vr),this.ye=this.ye.ot(t,e)),e},no.prototype.xe=function(t){var e=null!==this.Oe(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},no.prototype.Fe=function(e){var n=this;this.ge.set(e,new to),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},no.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},no);function no(t){this.Pe=t,this.ge=new Map,this.Ve=Ui,this.ye=co(),this.pe=new Ci(Vr)}function ro(){this.ae=0,this.he=ho(),this.ce=Ur.u,this.ue=!1,this.le=!0}function io(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function oo(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function uo(){this.qt=new xi(ui.D)}function ao(n){this.D=n?function(t,e){return n(t,e)||ui.D(t.key,e.key)}:function(t,e){return ui.D(t.key,e.key)},this.$t=Fi,this.Lt=new xi(this.D)}function co(){return new xi(ui.D)}function ho(){return new xi(ui.D)}function fo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function lo(t){return t=Io(t.mapValue.fields.__local_write_time__.timestampValue),new ni(t.seconds,t.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:kr()}function vo(r,i){var t,e,n,o=yo(r);if(o!==yo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),t=Io(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,_o(r.bytesValue).isEqual(_o(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Eo((t=r).geoPointValue.latitude)===Eo(o.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?Eo(e.integerValue)===Eo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=Eo(e.doubleValue))===(n=Eo(n.doubleValue))?vi(e)===vi(n):isNaN(e)&&isNaN(n));case 9:return Cr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Qr(e)!==Qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!vo(e[t],n[t])))return!1;return!0}();default:return kr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s=yo(t),u=yo(e);if(s!==u)return Vr(s,u);switch(s){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Eo(t.integerValue||t.doubleValue))<(n=Eo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=_o(i),o=_o(o),i.h(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=Vr(Eo(s.latitude),Eo(r.latitude)))?n:Vr(Eo(s.longitude),Eo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;if(0!==(u=mo(n[r[s]],i[o[s]])))return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Io(t),t=Io(e);return 0!==(e=Vr(n.seconds,t.seconds))?e:Vr(n.nanos,t.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Io(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?_o(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ui.J(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e}(t)}function Io(t){if(Pr(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e=0,n=po.exec(t);return Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Ao(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Do(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this._=t,this.Ke=e};function Lo(t){return{integerValue:""+t}}function Ro(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Vo(t,e){return gi(e)?Lo(e):Ro(t,e)}function Co(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Uo(t){return Pr(!!t),ri.V((t=Io(t),new ni(t.seconds,t.nanos)))}function jo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function qo(t){return Pr(rs(t=ii.q(t))),t}function Fo(t,e){return jo(t._,e.path)}function Go(t,e){return Pr((e=qo(e)).get(1)===t._.projectId),Pr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ui(Ko(e))}function Bo(t,e){return jo(t._,e)}function zo(t){return 4===(t=qo(t)).length?ii.U():Ko(t)}function Ho(t){return new ii(["projects",t._.projectId,"databases",t._.database]).B()}function Ko(t){return Pr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Wo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Xo(t,e){var n,r,i;if(e instanceof Ls)n={update:Wo(t,e.key,e.value)};else if(e instanceof zs)n={delete:Fo(t,e.key)};else if(e instanceof Rs)n={update:Wo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof js)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.B(),increment:e.We};throw kr()})}};else{if(!(e instanceof Hs))return kr();n={verify:Fo(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:Co(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:kr()),n}function Yo(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?As.updateTime(Uo(i.updateTime)):void 0!==i.exists?As.exists(i.exists):As.ze():As.ze();if(t.update){t.update.name;var n=Go(o,t.update.name),r=new Ks({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new Is(i.map(function(t){return si.G(t)})));return new Rs(n,r,i,e)}return new Ls(n,r,e)}if(t.delete){var s=Go(o,t.delete);return new zs(s,e)}return t.transform?(r=Go(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(Pr("REQUEST_TIME"===n.setToServerValue),i=new us):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new as(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new ps(r)):"increment"in n?i=new gs(e,n.increment):kr(),n=si.G(n.fieldPath),new Es(n,i);var e,n,r,i}),Pr(!0===e.exists),new js(r,s)):t.verify?(t=Go(o,t.verify),new Hs(t,e)):kr()}function Qo(t,e){return{documents:[Bo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,ko[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:es((t=t).field),direction:(t=t.dir,Oo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ke||yi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function $o(t){var e=zo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return Nu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return Nu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=ns(t.unaryFilter.field),Nu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=ns(t.unaryFilter.field),Nu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Nu.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new ta(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=yi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ts(n.startAt));var u=null;return n.endAt&&(u=ts(n.endAt)),vu(au(e,i,t,o,r,"F",s,u))}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,t=t.values||[];return new Ku(t,e)}function es(t){return{fieldPath:t.B()}}function ns(t){return si.G(t.fieldPath)}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function is(t,e){return t instanceof gs?Ao(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var os,ss,us=(n(hs,ss=h=function(){this.He=void 0}),hs),as=(n(cs,os=h),cs);function cs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function hs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=h),ds);function ds(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=h),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.We=e,n}function ws(t){return Eo(t.integerValue||t.doubleValue)}function bs(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Is=(_s.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},_s.prototype.isEqual=function(t){return Cr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},_s),Es=function(t,e){this.field=t,this.transform=e};function _s(t){(this.fields=t).sort(si.D)}function Ts(t,e){this.version=t,this.transformResults=e}var As=(Ns.ze=function(){return new Ns},Ns.exists=function(t){return new Ns(void 0,t)},Ns.updateTime=function(t){return new Ns(t)},Object.defineProperty(Ns.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ns.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ns);function Ns(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof eu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof eu}function Ds(t,e,n,r){return t instanceof Ls?(o=e,Ss((i=t).Ge,o)?(o=Os(o),new eu(i.key,o,i.value,{Ye:!0})):o):t instanceof Rs?function(t,e){if(!Ss(t.Ge,e))return e;var n=Os(e),e=Ms(t,e);return new eu(t.key,n,e,{Ye:!0})}(t,e):t instanceof js?function(t,e,n,r){if(!Ss(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof eu&&(h=n.field(a.field)),null===h&&r instanceof eu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof as?fs(c,i):c instanceof ps?ys(c,i):(i=ws(c=is(h=c,i))+ws(h.We),Ao(c)&&Ao(h.We)?Lo(i):Ro(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Fs(t,i.data(),r);return new eu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Ss((t=t).Ge,e)?new nu(t.key,ri.min()):e);var i,o}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Cr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof as&&e instanceof as||t instanceof ps&&e instanceof ps?Cr(t.elements,e.elements,vo):t instanceof gs&&e instanceof gs?vo(t.We,e.We):t instanceof us&&e instanceof us)}))}function Os(t){return t instanceof eu?t.version:ri.min()}var ks,Ps,Ls=(n(Cs,Ps=be=function(){}),Cs),Rs=(n(Vs,ks=be),Vs);function Vs(t,e,n,r){var i=this;return(i=ks.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Cs(t,e,n){var r=this;return(r=Ps.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ms(t,e){return n=t,e=e instanceof eu?e.data():Ks.empty(),r=new Ws(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Us,js=(n(qs,Us=be),qs);function qs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=As.exists(!0),n}function Fs(t,e,n){for(var r=new Ws(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Gs,Bs,zs=(n(Js,Bs=be),Js),Hs=(n(Qs,Gs=be),Qs),Ks=(Ys.empty=function(){return new Ys({mapValue:{}})},Ys.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Ys.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Ys),Ws=(Xs.prototype.set=function(t,e){return this.en(t,e),this},Xs.prototype.delete=function(t){return this.en(t,null),this},Xs.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},Xs.prototype.Xe=function(){var t=this.nn(si.U(),this.tn);return null!=t?new Ks(t):this.Ze},Xs.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xs);function Xs(t){void 0===t&&(t=Ks.empty()),this.Ze=t,this.tn=new Map}function Ys(t){this.proto=t}function Qs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function Js(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var $s,Zs,tu,eu=(n(uu,tu=Ie=function(t,e){this.key=t,this.version=e}),uu.prototype.field=function(t){return this.sn.field(t)},uu.prototype.data=function(){return this.sn},uu.prototype.rn=function(){return this.sn.proto},uu.prototype.isEqual=function(t){return t instanceof uu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},uu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu),nu=(n(su,Zs=Ie),su.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su),ru=(n(ou,$s=Ie),ou.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ou.prototype.isEqual=function(t){return t instanceof ou&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ou),iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.hn=null,this.cn=null,this.startAt,this.endAt};function ou(){return null!==$s&&$s.apply(this,arguments)||this}function su(t,e,n){var r=this;return(r=Zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function uu(t,e,n,r){var i=this;return(i=tu.call(this,t,e)||this).sn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function au(t,e,n,r,i,o,s,u){return new iu(t,e,n,r,i,o,s,u)}function cu(t){return new iu(t)}function hu(t){return!yi(t.limit)&&"F"===t.an}function fu(t){return!yi(t.limit)&&"L"===t.an}function lu(t){return 0<t.on.length?t.on[0].field:null}function pu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function du(t){return null!==t.collectionGroup}function yu(t){var e=t;if(null===e.hn){e.hn=[];var n=pu(e),t=lu(e);if(null!==n&&null===t)n.W()||e.hn.push(new ta(n)),e.hn.push(new ta(si.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.hn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.hn.push(new ta(si.j(),n)))}}return e.hn}function vu(t){var e=t;if(!e.cn)if("F"===e.an)e.cn=wi(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ta(o.field,s))}var u=e.endAt?new Ku(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Ku(e.startAt.position,!e.startAt.before):null;e.cn=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function gu(t,e,n){return new iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return new iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function wu(t,e){return new iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function bu(t,e){return Ii(vu(t),vu(e))&&t.an===e.an}function Iu(t){return bi(vu(t))+"|lt:"+t.an}function Eu(t){return"Query(target="+(n=(e=vu(t)).path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.B()+" "+t.op+" "+bo(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ju(e.startAt)),e.endAt&&(n+=", endAt: "+Ju(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function _u(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Y(e.collectionGroup)&&e.path.M(n):ui.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||$u(t.startAt,yu(t),n))&&(!t.endAt||!$u(t.endAt,yu(t),n)));var e,n}function Tu(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.W()?ui.D(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?mo(o,r):kr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Au,Nu=(n(Su,Au=function(){}),Su.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new ku(t,e,n):"array-contains"===e?new Gu(t,n):"in"===e?new Bu(t,n):"not-in"===e?new zu(t,n):"array-contains-any"===e?new Hu(t,n):new Su(t,e,n)},Su.ln=function(t,e,n){return new("in"===e?Pu:Lu)(t,n)},Su.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(mo(t,this.value)):null!==t&&yo(this.value)===yo(t)&&this._n(mo(t,this.value))},Su.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},Su.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Su);function Su(t,e,n){var r=this;return(r=Au.call(this)||this).field=t,r.op=e,r.value=n,r}var Du,xu,Ou,ku=(n(Cu,Ou=Nu),Cu.prototype.matches=function(t){return t=ui.D(t.key,this.key),this._n(t)},Cu),Pu=(n(Vu,xu=Nu),Vu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Vu),Lu=(n(Ru,Du=Nu),Ru.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ru);function Ru(t,e){var n=this;return(n=Du.call(this,t,"not-in",e)||this).keys=Mu(0,e),n}function Vu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=Mu(0,e),n}function Cu(t,e,n){var r=this;return(r=Ou.call(this,t,e,n)||this).key=ui.J(n.referenceValue),r}function Mu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.J(t.referenceValue)})}var Uu,ju,qu,Fu,Gu=(n(Qu,Fu=Nu),Qu.prototype.matches=function(t){return No(t=t.field(this.field))&&go(t.arrayValue,this.value)},Qu),Bu=(n(Yu,qu=Nu),Yu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&go(this.value.arrayValue,t)},Yu),zu=(n(Xu,ju=Nu),Xu.prototype.matches=function(t){return!go(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!go(this.value.arrayValue,t))},Xu),Hu=(n(Wu,Uu=Nu),Wu.prototype.matches=function(t){var e=this;return!(!No(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Wu),Ku=function(t,e){this.position=t,this.before=e};function Wu(t,e){return Uu.call(this,t,"array-contains-any",e)||this}function Xu(t,e){return ju.call(this,t,"not-in",e)||this}function Yu(t,e){return qu.call(this,t,"in",e)||this}function Qu(t,e){return Fu.call(this,t,"array-contains",e)||this}function Ju(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function $u(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ui.D(ui.J(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Zu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var ta=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ea(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var na,ra=(la.prototype.reset=function(){this.In=0},la.prototype.Rn=function(){this.In=this.Tn},la.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},la.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},la.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},la.prototype.gn=function(){return(Math.random()-.5)*this.In},la),ia=(fa.prototype.catch=function(t){return this.next(void 0,t)},fa.prototype.next=function(r,i){var o=this;return this.Dn&&kr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new fa(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},fa.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},fa.prototype.Fn=function(t){try{var e=t();return e instanceof fa?e:fa.resolve(e)}catch(t){return fa.reject(t)}},fa.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):fa.resolve(e)},fa.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):fa.reject(e)},fa.resolve=function(n){return new fa(function(t,e){t(n)})},fa.reject=function(n){return new fa(function(t,e){e(n)})},fa.kn=function(t){return new fa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},fa.On=function(t){for(var n=fa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?fa.resolve(t):e()})}(r[e]);return n},fa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.kn(i)},fa),oa=(ha.delete=function(t){return Sr("SimpleDb","Removing database:",t),ma(window.indexedDB.deleteDatabase(t)).xn()},ha.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(ha.Bn())return!0;var t=p(),e=0<(n=ha.$n(t))&&n<10,n=0<(n=ha.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ha.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},ha.Kn=function(t,e){return t.store(e)},ha.$n=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ha.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ha.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new ua(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Er(Ir.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ua(o,t))},r.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Sr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},ha.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ha.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=da.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ia.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Sr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ha.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ha),sa=(Object.defineProperty(ca.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),ca.prototype.done=function(){this.Hn=!0},ca.prototype.Xn=function(t){this.Jn=t},ca.prototype.delete=function(){return ma(this.zn.delete())},ca),ua=(n(aa,na=Er),aa);function aa(t,e){var n=this;return(n=na.call(this,Ir.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ca(t){this.zn=t,this.Hn=!1,this.Jn=null}function ha(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===ha.$n(p())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function fa(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function la(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function pa(t){return"IndexedDbTransactionError"===t.name}var da=(ga.open=function(t,e,n,r){try{return new ga(e,t.transaction(r,n))}catch(t){throw new ua(e,t)}},Object.defineProperty(ga.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),ga.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ga.prototype.store=function(t){return t=this.transaction.objectStore(t),new ya(t)},ga),ya=(va.prototype.put=function(t,e){return ma(t=void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},va.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),ma(this.store.add(t))},va.prototype.get=function(e){var n=this;return ma(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},va.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),ma(this.store.delete(t))},va.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),ma(this.store.count())},va.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},va.prototype.ns=function(t,e){return Sr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},va.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},va.prototype.os=function(r){var t=this.cursor({});return new ia(function(n,e){t.onerror=function(t){t=ba(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},va.prototype.es=function(t,i){var o=[];return new ia(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new sa(n),(t=i(n.primaryKey,n.value,e))instanceof ia&&(t=t.catch(function(t){return e.done(),ia.reject(t)}),o.push(t)),e.Sn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return ia.kn(o)})},va.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},va.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},va);function va(t){this.store=t}function ga(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ea,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new ua(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=ba(t.target.error),n.Zn.reject(new ua(e,t))}}function ma(t){return new ia(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=ba(t.target.error),n(t)}})}var wa=!1;function ba(t){var e=oa.$n(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Er("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return wa||(wa=!0,setTimeout(function(){throw n},0)),n}return t}function Ia(){return"undefined"!=typeof window?window:null}function Ea(){return"undefined"!=typeof document?document:null}var _a=(Na._s=function(t,e,n,r,i){return(i=new Na(t,e,Date.now()+n,r,i)).start(n),i},Na.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Na.prototype.pn=function(){return this.ds()},Na.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Er(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Na.prototype.ds=function(){var e=this;this.hs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Na.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},Na),Ta=(Object.defineProperty(Aa.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Aa.prototype.ws=function(t){this.enqueue(t)},Aa.prototype.bs=function(t){this.vs(),this.Ss(t)},Aa.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=Ea())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Aa.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Aa.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Aa.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.Vs.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Aa.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Aa.prototype.Vn=function(t,e,n){var r=this;return this.vs(),-1<this.gs.indexOf(t)&&(e=0),n=_a._s(this,t,e,n,function(t){return r.xs(t)}),this.As.push(n),n},Aa.prototype.vs=function(){this.Rs&&kr()},Aa.prototype.Fs=function(){},Aa.prototype.ks=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Aa.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Aa.prototype.Ms=function(r){var i=this;return this.ks().then(function(){i.As.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.ks()})},Aa.prototype.$s=function(t){this.gs.push(t)},Aa.prototype.xs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},Aa);function Aa(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new ra(this,"async_queue_retry"),this.ys=function(){var t=Ea();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Vs.yn()};var t=Ea();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Na(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new ea,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Sa(t,e){if(Dr("AsyncQueue",e+": "+t),pa(t))return new Er(Ir.UNAVAILABLE,e+": "+t);throw t}function Da(){this.Ls=void 0,this.listeners=[]}function xa(){this.Bs=new ei(Iu,bu),this.onlineState="Unknown",this.qs=new Set}function Oa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Da),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Sa(o=t.sent(),"Initialization of query '"+Eu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Pa(e),[2]}})})}function ka(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Pa(t){t.qs.forEach(function(t){t.next()})}var La=(Ca.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},Ca.prototype.onError=function(t){this.js.error(t)},Ca.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},Ca.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},Ca.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Ca.prototype.Ys=function(t){t=Xi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},Ca),Ra=(Va.prototype.Zs=function(){return null!=this.uid},Va.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Va.prototype.isEqual=function(t){return t.uid===this.uid},Va);function Va(t){this.uid=t}function Ca(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}Ra.UNAUTHENTICATED=new Ra(null),Ra.ei=new Ra("google-credentials-uid"),Ra.ni=new Ra("first-party-uid");var Ma=(Ua.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ua.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},Ua);function Ua(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function ja(t,e){return"firestore_clients_"+t+"_"+e}function qa(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function Fa(t,e){return"firestore_targets_"+t+"_"+e}Ma.ai=-1;var Ga=(lc.hi=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Er(r.error.code,r.error.message)),i?new lc(t,e,r.state,o):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},lc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},lc),Ba=(fc.hi=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Er(n.error.code,n.error.message)),r?new fc(t,n.state,i):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},fc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},fc),za=(hc.hi=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Hi,o=0;r&&o<n.activeTargetIds.length;++o)r=gi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new hc(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},hc),Ha=(cc.hi=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new cc(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},cc),Ka=(ac.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},ac.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},ac.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},ac),Wa=(uc.Ln=function(t){return!(!t||!t.localStorage)},uc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(ja(this.persistenceKey,r)))&&(o=za.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.yi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.Ei(h);return this.mi=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ii=!0,[2]}})})},uc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},uc.prototype.Ci=function(){return this.Ni(this.Ti)},uc.prototype.xi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},uc.prototype.Fi=function(t){this.ki(t,"pending")},uc.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},uc.prototype.$i=function(t){var e,n="not-current";return this.xi(t)&&(!(e=this.storage.getItem(Fa(this.persistenceKey,t)))||(e=Ba.hi(t,e))&&(n=e.state)),this.Li.ui(t),this.bi(),n},uc.prototype.Bi=function(t){this.Li.li(t),this.bi()},uc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},uc.prototype.Ui=function(t){this.removeItem(Fa(this.persistenceKey,t))},uc.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},uc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},uc.prototype.ji=function(t){this.Gi(t)},uc.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},uc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},uc.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},uc.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},uc.prototype.Ei=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Sr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ii){if(null!==s.key)if(this.Pi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Ji(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(s.key)){if(null!==s.newValue&&(n=this.Yi(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.Vi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.yi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=Ma.ai;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==Ma.ai&&this.si(o)}else this.mi.push(s);return[2]})})})}},Object.defineProperty(uc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),uc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},uc.prototype.ki=function(t,e,n){n=new Ga(this.currentUser,t,e,n),t=qa(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ci())},uc.prototype.Mi=function(t){t=qa(this.persistenceKey,this.currentUser,t),this.removeItem(t)},uc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t},this.storage.setItem(this.yi,JSON.stringify(t))},uc.prototype.Qi=function(t,e,n){var r=Fa(this.persistenceKey,t),n=new Ba(t,e,n);this.setItem(r,n.ci())},uc.prototype.zi=function(t){return(t=this.Pi.exec(t))?t[1]:null},uc.prototype.Ji=function(t,e){return t=this.zi(t),za.hi(t,e)},uc.prototype.Yi=function(t,e){var n=this.gi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Ga.hi(new Ra(n),t,e)},uc.prototype.Zi=function(t,e){return t=this.Vi.exec(t),t=Number(t[1]),Ba.hi(t,e)},uc.prototype.vi=function(t){return Ha.hi(t)},uc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},uc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},uc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},uc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},uc.prototype.Ni=function(t){var n=Hi;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},uc),Xa=(sc.prototype.Fi=function(t){},sc.prototype.Oi=function(t,e,n){},sc.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},sc.prototype.Ki=function(t,e,n){this.rr[t]=e},sc.prototype.Bi=function(t){this.ir.li(t)},sc.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},sc.prototype.Ui=function(t){delete this.rr[t]},sc.prototype.Ci=function(){return this.ir.activeTargetIds},sc.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},sc.prototype.start=function(){return this.ir=new Ka,Promise.resolve()},sc.prototype.Wi=function(t,e,n){},sc.prototype.ji=function(t){},sc.prototype.Di=function(){},sc.prototype.oi=function(t){},sc),Ya=(oc.prototype.hr=function(t,e,n){for(var r,i,o,s,u,a,c=n.cr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],a=u=s=void 0,e=r instanceof Ls?new eu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Rs?(u=i,a=o,Ss((s=r).Ge,u)?(u=Ms(s,u),new eu(s.key,a.version,u,{hasCommittedMutations:!0})):new ru(s.key,a.version)):r instanceof js?function(t,e,n){if(Pr(null!=n.transformResults),!Ss(t.Ge,e))return new ru(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof eu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof as?fs(o,s):o instanceof ps?ys(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Fs(t,r.data(),e);return new eu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new nu(r.key,o.version,{hasCommittedMutations:!0}))}return e},oc.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ds(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ds(a,e,o,this.ar))}return e},oc.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},oc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},oc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,xs)&&Cr(this.baseMutations,t.baseMutations,xs)},oc),Qa=(ic.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new ic(t,e,n,r)},ic),h=(Object.defineProperty(rc.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),rc.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},rc.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},rc.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?ia.resolve(n):this.Pr(t,e)},rc.prototype.getEntries=function(t,e){return this.gr(t,e)},rc.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},rc.prototype.mr=function(){},rc),Ja="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",be=(nc.prototype.pr=function(t){this.yr.push(t)},nc.prototype.br=function(){this.yr.forEach(function(t){return t()})},nc),$a=(ec.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},ec.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},ec.prototype.kr=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.ot(t,e)}),o},ec.prototype.Or=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},ec.prototype.Mr=function(e,r){var i=this;return this.Sr.$r(e,r).next(function(t){var t=i.kr(e,r,t),n=Ui;return t.forEach(function(t,e){e=e||new nu(t,ri.min()),n=n.ot(t,e)}),n})},ec.prototype.Lr=function(t,e,n){return r=e,ui.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):du(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},ec.prototype.Br=function(t,e){return this.Cr(t,new ui(e)).next(function(t){var e=Fi;return t instanceof eu&&(e=e.ot(t.key,t)),e})},ec.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.Dr.Kr(n,s).next(function(t){return ia.forEach(t,function(t){var e=(e=r,t=t.child(s),new iu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},ec.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Qr(e,n)}).next(function(t){return h=t,r.Wr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Ds(s,a=c.get(u),a,r.ar);c=a instanceof eu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){_u(n,e)||(c=c.remove(t))}),c})},ec.prototype.Wr=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Rs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof eu&&(c=c.ot(t,e))}),c})},ec),Za=(tc.zr=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new tc(t,e.fromCache,n,r)},tc);function tc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}function ec(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function nc(){this.yr=[]}function rc(){this.wr=new ei(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Er=!1}function ic(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}function oc(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function sc(){this.ir=new Ka,this.rr={},this.di=null,this.si=null}function uc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new xi(Vr),this.Ii=!1,this.mi=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ai=ja(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new Ka),this.Pi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function ac(){this.activeTargetIds=Hi}function cc(t,e){this.clientId=t,this.onlineState=e}function hc(t,e){this.clientId=t,this.activeTargetIds=e}function fc(t,e,n){this.targetId=t,this.state=e,this.error=n}function lc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function pc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Vr(n,t))?Vr(r,e):t}var dc=(mc.prototype.Yr=function(){return++this.Jr},mc.prototype.Xr=function(t){var e=[t,this.Yr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):pc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(mc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),mc),yc={Zr:!1,eo:0,no:0,so:0},vc=(gc.ao=function(t){return new gc(t,gc.ho,gc.co)},gc);function gc(t,e,n){this.io=t,this.ro=e,this.oo=n}function mc(t){this.Hr=t,this.buffer=new Ci(pc),this.Jr=0}vc.uo=-1,vc.lo=1048576,vc._o=41943040,vc.ho=10,vc.co=1e3,vc.fo=new vc(vc._o,vc.ho,vc.co),vc.do=new vc(vc.uo,0,0);var wc=(Ec.prototype.start=function(t){this.wo.params.io!==vc.uo&&this.Io(t)},Ec.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(Ec.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),Ec.prototype.Io=function(n){var t=this,e=this.Eo?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.hs.Vn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.Eo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mo(this.wo)];case 2:return t.sent(),[3,7];case 3:return pa(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Qh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Io(n)];case 8:return t.sent(),[2]}})})})},Ec),bc=(Ic.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},Ic.prototype.Vo=function(t,e){var n=this;if(0===e)return ia.resolve(Ma.ai);var r=new dc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.yo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},Ic.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},Ic.prototype.bo=function(t,e){return this.Ao.bo(t,e)},Ic.prototype.vo=function(e,n){var r=this;return this.params.io===vc.uo?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),ia.resolve(yc)):this.So(e).next(function(t){return t<r.params.io?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),yc):r.Do(e,n)})},Ic.prototype.So=function(t){return this.Ao.So(t)},Ic.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.Vo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Nr()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ia.resolve({Zr:!0,eo:i,no:o,so:t})})},Ic);function Ic(t,e){this.Ao=t,this.params=e}function Ec(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}function _c(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Tc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Tc(o)}function Tc(t){return t+""}function Ac(t){var e=t.length;if(Pr(2<=e),2===e)return Pr(""===t.charAt(0)&&""===t.charAt(1)),ii.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&kr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:kr()}o=s+2}return new ii(r)}var Nc=function(t){this.Co=t};function Sc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=Go(n,r.name),n=Uo(r.updateTime),r=new Ks({mapValue:{fields:r.fields}}),new eu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ui.Z(e.noDocument.path),o=Pc(e.noDocument.readTime);return new nu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=ui.Z(e.unknownDocument.path),e=Pc(e.unknownDocument.version),new ru(o,e)):kr()}function Dc(t,e,n){var r=xc(n),n=e.key.path.F().L();if(e instanceof eu){var i={name:Fo(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Co(i,o.version.v())},o=e.hasCommittedMutations;return new lh(null,null,i,o,r,n)}if(e instanceof nu){var i=e.key.path.L(),o=kc(e.version),s=e.hasCommittedMutations;return new lh(null,new hh(i,o),null,s,r,n)}return e instanceof ru?(s=e.key.path.L(),e=kc(e.version),new lh(new fh(s,e),null,null,!0,r,n)):kr()}function xc(t){return[(t=t.v()).seconds,t.nanoseconds]}function Oc(t){return t=new ni(t[0],t[1]),ri.V(t)}function kc(t){return t=t.v(),new eh(t.seconds,t.nanoseconds)}function Pc(t){return t=new ni(t.seconds,t.nanoseconds),ri.V(t)}function Lc(e,t){var n=(t.baseMutations||[]).map(function(t){return Yo(e.Co,t)}),r=t.mutations.map(function(t){return Yo(e.Co,t)}),i=ni.fromMillis(t.localWriteTimeMs);return new Ya(t.batchId,i,n,r)}function Rc(t){var e=Pc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Pc(t.lastLimboFreeSnapshotVersion):ri.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),vu(cu(zo(r.documents[0])))):$o(t.query);return new Ai(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ur.fromBase64String(t.resumeToken))}function Vc(t,e){var n=kc(e.nt),r=kc(e.lastLimboFreeSnapshotVersion),i=(Ei(e.target)?Qo:Jo)(t.Co,e.target),t=e.resumeToken.toBase64();return new dh(e.targetId,bi(e.target),n,t,e.sequenceNumber,r,i)}var Cc=(Mc.Fo=function(t,e,n,r){return Pr(""!==t.uid),new Mc(t.Zs()?t.uid:"",e,n,r)},Mc.prototype.ko=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qc(t).rs({index:uh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Mc.prototype.Oo=function(d,y,v,g){var m=this,w=Fc(d),b=qc(d);return b.add({}).next(function(t){Pr("number"==typeof t);for(var e,n,r,i,o,s=new Ya(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Xo(e.Co,t)}),o=r.mutations.map(function(t){return Xo(e.Co,t)}),new uh(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new Ci(function(t,e){return Vr(t.B(),e.B())}),h=0,f=g;h<f.length;h++){var l=f[h],p=ah.key(m.userId,l.key.path,t),c=c.add(l.key.path.F());a.push(b.put(u)),a.push(w.put(p,ah.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.xo[t]=s.keys()}),ia.kn(a).next(function(){return s})})},Mc.prototype.$o=function(t,e){var n=this;return qc(t).get(e).next(function(t){return t?(Pr(t.userId===n.userId),Lc(n.serializer,t)):null})},Mc.prototype.Lo=function(t,e){var n=this;return this.xo[e]?ia.resolve(this.xo[e]):this.$o(t,e).next(function(t){return t?(t=t.keys(),n.xo[e]=t):null})},Mc.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return qc(t).rs({index:uh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Pr(e.batchId>=i),o=Lc(r.serializer,e)),n.done()}).next(function(){return o})},Mc.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return qc(t).rs({index:uh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Mc.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qc(t).ts(uh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Lc(e.serializer,t)})})},Mc.prototype.Nr=function(o,s){var u=this,t=ah.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Fc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);if(r===u.userId&&s.path.isEqual(i))return qc(o).get(t).next(function(t){if(!t)throw kr();Pr(t.userId===u.userId),a.push(Lc(u.serializer,t))});n.done()}).next(function(){return a})},Mc.prototype.$r=function(e,t){var s=this,u=new Ci(Vr),n=[];return t.forEach(function(o){var t=ah.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Fc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ia.kn(n).next(function(){return s.Ko(e,u)})},Mc.prototype.Qr=function(t,e){var o=this,s=e.path,u=s.length+1,e=ah.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Ci(Vr);return Fc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ko(t,a)})},Mc.prototype.Ko=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(qc(e).get(t).next(function(t){if(null===t)throw kr();Pr(t.userId===n.userId),r.push(Lc(n.serializer,t))}))}),ia.kn(i).next(function(){return r})},Mc.prototype.Qo=function(e,n){var r=this;return jc(e.Wo,this.userId,n).next(function(t){return e.pr(function(){r.jo(n.batchId)}),ia.forEach(t,function(t){return r.No.Go(e,t)})})},Mc.prototype.jo=function(t){delete this.xo[t]},Mc.prototype.zo=function(e){var i=this;return this.ko(e).next(function(t){if(!t)return ia.resolve();var t=IDBKeyRange.lowerBound(ah.prefixForUser(i.userId)),r=[];return Fc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Ac(t[1]),r.push(t)):n.done()}).next(function(){Pr(0===r.length)})})},Mc.prototype.Ho=function(t,e){return Uc(t,this.userId,e)},Mc.prototype.Jo=function(t){var e=this;return Gc(t).get(this.userId).next(function(t){return t||new sh(e.userId,-1,"")})},Mc);function Mc(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}function Uc(t,o,e){var s=(e=ah.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Fc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function jc(t,e,n){var r=t.store(uh.store),i=t.store(ah.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Pr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=ah.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ia.kn(o).next(function(){return u})}function qc(t){return Rh.Kn(t,uh.store)}function Fc(t){return Rh.Kn(t,ah.store)}function Gc(t){return Rh.Kn(t,sh.store)}var Bc,zc=(Wc.prototype.Ir=function(t,e,n){return Yc(t).put(Qc(e),n)},Wc.prototype.Ar=function(t,e){return t=Yc(t),e=Qc(e),t.delete(e)},Wc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Wc.prototype.Rr=function(t,e){var n=this;return Yc(t).get(Qc(e)).next(function(t){return n.Xo(t)})},Wc.prototype.Zo=function(t,e){var n=this;return Yc(t).get(Qc(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:Jc(t)}:null})},Wc.prototype.getEntries=function(t,e){var n=this,r=Ui;return this.ea(t,e,function(t,e){e=n.Xo(e),r=r.ot(t,e)}).next(function(){return r})},Wc.prototype.na=function(t,e){var r=this,i=Ui,o=new xi(ui.D);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,Jc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},Wc.prototype.ea=function(t,e,i){if(e.P())return ia.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Yc(t).rs({range:n},function(t,e,n){for(var r=ui.Z(t);s&&ui.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Wc.prototype.Lr=function(t,r,e){var n,i=this,o=Fi,s=r.path.length+1,u={};return e.isEqual(ri.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=xc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=lh.collectionReadTimeIndex),Yc(t).rs(u,function(t,e,n){t.length===s&&(e=Sc(i.serializer,e),r.path.M(e.key.path)?e instanceof eu&&_u(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Wc.prototype.ra=function(t){return new Hc(this,!!t&&t.oa)},Wc.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Wc.prototype.getMetadata=function(t){return Xc(t).get(ph.key).next(function(t){return Pr(!!t),t})},Wc.prototype.Yo=function(t,e){return Xc(t).put(ph.key,e)},Wc.prototype.Xo=function(t){return!t||(t=Sc(this.serializer,t))instanceof nu&&t.version.isEqual(ri.min())?null:t},Wc),Hc=(n(Kc,Bc=h),Kc.prototype.Vr=function(i){var o=this,s=[],u=0,a=new Ci(function(t,e){return Vr(t.B(),e.B())});return this.wr.forEach(function(t,e){var n,r=o.ca.get(t);e?(n=Dc(o.ha.serializer,e,o.readTime),a=a.add(t.path.F()),e=Jc(n),u+=e-r,s.push(o.ha.Ir(i,t,n))):(u-=r,o.oa?(r=Dc(o.ha.serializer,new nu(t,ri.min()),o.readTime),s.push(o.ha.Ir(i,t,r))):s.push(o.ha.Ar(i,t)))}),a.forEach(function(t){s.push(o.ha.Dr.Mo(i,t))}),s.push(this.ha.updateMetadata(i,u)),ia.kn(s)},Kc.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)})},Kc.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ca.set(t,e)}),e})},Kc);function Kc(t,e){var n=this;return(n=Bc.call(this)||this).ha=t,n.oa=e,n.ca=new ei(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Wc(t,e){this.serializer=t,this.Dr=e}function Xc(t){return Rh.Kn(t,ph.store)}function Yc(t){return Rh.Kn(t,lh.store)}function Qc(t){return t.path.L()}function Jc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}var $c=(oh.prototype.Mo=function(t,e){return this.ua.add(e),ia.resolve()},oh.prototype.Kr=function(t,e){return ia.resolve(this.ua.getEntries(e))},oh),Zc=(ih.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Ci(ii.D),t=!r.has(n);return this.index[e]=r.add(n),t},ih.prototype.has=function(t){var e=t.O(),t=t.F();return(e=this.index[e])&&e.has(t)},ih.prototype.getEntries=function(t){return(this.index[t]||new Ci(ii.D)).L()},ih),th=(rh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Pr(t<r&&0<=t&&r<=10);var o=new da("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(nh.store),(s=e).createObjectStore(sh.store,{keyPath:sh.keyPath}),s.createObjectStore(uh.store,{keyPath:uh.keyPath,autoIncrement:!0}).createIndex(uh.userMutationsIndex,uh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ah.store),mh(e),e.createObjectStore(lh.store));var s,u=ia.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(yh.store),s.deleteObjectStore(dh.store),s.deleteObjectStore(vh.store),mh(e)),u=u.next(function(){return t=o.store(vh.store),e=new vh(0,0,ri.min().v(),0),t.put(vh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(uh.store).ts().next(function(t){n.deleteObjectStore(uh.store),n.createObjectStore(uh.store,{keyPath:uh.keyPath,autoIncrement:!0}).createIndex(uh.userMutationsIndex,uh.userMutationsKeyPath,{unique:!0});var e=r.store(uh.store),t=t.map(function(t){return e.put(t)});return ia.kn(t)});var n,r})),u=u.next(function(){e.createObjectStore(wh.store,{keyPath:wh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(ph.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(lh.store)).createIndex(lh.readTimeIndex,lh.readTimeIndexPath,{unique:!1}),t.createIndex(lh.collectionReadTimeIndex,lh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},rh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(lh.store).rs(function(t,e){n+=Jc(e)}).next(function(){var t=new ph(n);return e.store(ph.store).put(ph.key,t)})},rh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(sh.store),i=n.store(uh.store);return t.ts().next(function(t){return ia.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(uh.userMutationsIndex,t).next(function(t){return ia.forEach(t,function(t){return Pr(t.userId===e.userId),t=Lc(r.serializer,t),jc(n,e.userId,t).next(function(){})})})})})},rh.prototype.ensureSequenceNumbers=function(t){var o=t.store(yh.store),e=t.store(lh.store);return t.store(vh.store).get(vh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new ii(t),t=[0,_c(n)];i.push(o.get(t).next(function(t){return t?ia.resolve():o.put(new yh(0,_c(n),r.highestListenSequenceNumber))}))}).next(function(){return ia.kn(i)})})},rh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.O(),t=t.F();return n.put({collectionId:e,parent:_c(t)})}}t.createObjectStore(gh.store,{keyPath:gh.keyPath});var n=e.store(gh.store),i=new Zc;return e.store(lh.store).rs({ss:!0},function(t,e){return r((t=new ii(t)).F())}).next(function(){return e.store(ah.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Ac(n))).F())})})},rh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(dh.store);return r.rs(function(t,e){return e=Rc(e),e=Vc(n.serializer,e),r.put(e)})},rh),eh=function(t,e){this.seconds=t,this.nanoseconds=e},nh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function rh(t){this.serializer=t}function ih(){this.index={}}function oh(){this.ua=new Zc}nh.store="owner",nh.key="owner";var sh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};sh.store="mutationQueues",sh.keyPath="userId";var uh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};uh.store="mutations",uh.keyPath="batchId",uh.userMutationsIndex="userMutationsIndex",uh.userMutationsKeyPath=["userId","batchId"];var ah=(ch.prefixForUser=function(t){return[t]},ch.prefixForPath=function(t,e){return[t,_c(e)]},ch.key=function(t,e,n){return[t,_c(e),n]},ch);function ch(){}ah.store="documentMutations",ah.PLACEHOLDER=new ah;var hh=function(t,e){this.path=t,this.readTime=e},fh=function(t,e){this.path=t,this.version=e},lh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};lh.store="remoteDocuments",lh.readTimeIndex="readTimeIndex",lh.readTimeIndexPath="readTime",lh.collectionReadTimeIndex="collectionReadTimeIndex",lh.collectionReadTimeIndexPath=["parentPath","readTime"];var ph=function(t){this.byteSize=t};ph.store="remoteDocumentGlobal",ph.key="remoteDocumentGlobalKey";var dh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};dh.store="targets",dh.keyPath="targetId",dh.queryTargetsIndexName="queryTargetsIndex",dh.queryTargetsKeyPath=["canonicalId","targetId"];var yh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};yh.store="targetDocuments",yh.keyPath=["targetId","path"],yh.documentTargetsIndex="documentTargetsIndex",yh.documentTargetsKeyPath=["path","targetId"];var vh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};vh.key="targetGlobalKey",vh.store="targetGlobal";var gh=function(t,e){this.collectionId=t,this.parent=e};function mh(t){t.createObjectStore(yh.store,{keyPath:yh.keyPath}).createIndex(yh.documentTargetsIndex,yh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(dh.store,{keyPath:dh.keyPath}).createIndex(dh.queryTargetsIndexName,dh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(vh.store)}gh.store="collectionParents",gh.keyPath=["collectionId","parent"];var wh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};wh.store="clientMetadata",wh.keyPath="clientId";var bh=i(i(i([sh.store,uh.store,ah.store,lh.store,dh.store,nh.store,vh.store,yh.store],[wh.store]),[ph.store]),[gh.store]),Ih=(Eh.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return ia.resolve();var r=e.O(),i=e.F();return t.pr(function(){n.la.add(e)}),i={collectionId:r,parent:_c(i)},_h(t).put(i)},Eh.prototype.Kr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return _h(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Ac(r.parent))}return o})},Eh);function Eh(){this.la=new Zc}function _h(t){return Rh.Kn(t,gh.store)}var Th=(Sh.prototype.next=function(){return this._a+=2,this._a},Sh.fa=function(){return new Sh(0)},Sh.da=function(){return new Sh(-1)},Sh),Ah=(Nh.prototype.wa=function(n){var r=this;return this.Ea(n).next(function(t){var e=new Th(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},Nh.prototype.Ia=function(t){return this.Ea(t).next(function(t){return ri.V(new ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Nh.prototype.ma=function(t){return this.Ea(t).next(function(t){return t.highestListenSequenceNumber})},Nh.prototype.Aa=function(e,n,r){var i=this;return this.Ea(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},Nh.prototype.Ra=function(e,n){var r=this;return this.Pa(e,n).next(function(){return r.Ea(e).next(function(t){return t.targetCount+=1,r.ga(n,t),r.Ta(e,t)})})},Nh.prototype.Va=function(t,e){return this.Pa(t,e)},Nh.prototype.ya=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Dh(e).delete(t.targetId)}).next(function(){return n.Ea(e)}).next(function(t){return Pr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},Nh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Dh(n).rs(function(t,e){(e=Rc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ya(n,e)))}).next(function(){return ia.kn(u)}).next(function(){return s})},Nh.prototype.Ce=function(t,n){return Dh(t).rs(function(t,e){e=Rc(e),n(e)})},Nh.prototype.Ea=function(t){return xh(t).get(vh.key).next(function(t){return Pr(null!==t),t})},Nh.prototype.Ta=function(t,e){return xh(t).put(vh.key,e)},Nh.prototype.Pa=function(t,e){return Dh(t).put(Vc(this.serializer,e))},Nh.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Nh.prototype.ba=function(t){return this.Ea(t).next(function(t){return t.targetCount})},Nh.prototype.va=function(t,r){var e=bi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Dh(t).rs({range:e,index:dh.queryTargetsIndexName},function(t,e,n){e=Rc(e),Ii(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Nh.prototype.Sa=function(n,t,r){var i=this,o=[],s=Oh(n);return t.forEach(function(t){var e=_c(t.path);o.push(s.put(new yh(r,e))),o.push(i.No.Da(n,r,t))}),ia.kn(o)},Nh.prototype.Ca=function(n,t,r){var i=this,o=Oh(n);return ia.forEach(t,function(t){var e=_c(t.path);return ia.kn([o.delete([r,e]),i.No.Na(n,r,t)])})},Nh.prototype.pa=function(t,e){return t=Oh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Nh.prototype.xa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Oh(t),r=zi();return t.rs({range:e,ss:!0},function(t,e,n){t=Ac(t[1]),t=new ui(t),r=r.add(t)}).next(function(){return r})},Nh.prototype.Ho=function(t,e){var e=_c(e.path),e=IDBKeyRange.bound([e],[Mr(e)],!1,!0),i=0;return Oh(t).rs({index:yh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Nh.prototype.Ue=function(t,e){return Dh(t).get(e).next(function(t){return t?Rc(t):null})},Nh);function Nh(t,e){this.No=t,this.serializer=e}function Sh(t){this._a=t}function Dh(t){return Rh.Kn(t,dh.store)}function xh(t){return Rh.Kn(t,vh.store)}function Oh(t){return Rh.Kn(t,yh.store)}var kh,Ph="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lh=(n(Ch,kh=be),Ch),Rh=(Vh.Kn=function(t,e){if(t instanceof Lh)return oa.Kn(t.Wo,e);throw kr()},Vh.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Er(Ir.FAILED_PRECONDITION,Ph);return e.Ha(),e.Ja(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.ma(t)})}).then(function(t){e.Ma=new Ma(t,e.ka)}).then(function(){e.$a=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},Vh.prototype.Xa=function(n){var t=this;return this.Ka=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ii?[2,n(e)]:[2]})})},n(this.isPrimary)},Vh.prototype.Za=function(n){var t=this;this.Wa.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Vh.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Vh.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Uh(e).put(new wh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.eh(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Ka(!1)}))})}).next(function(){return n.nh(e)}).next(function(t){return n.isPrimary&&!t?n.sh(e).next(function(){return!1}):!!t&&n.ih(e).next(function(){return!0})})}).catch(function(t){if(pa(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Ka(t)}),n.isPrimary=t})},Vh.prototype.eh=function(t){var e=this;return Mh(t).get(nh.key).next(function(t){return ia.resolve(e.rh(t))})},Vh.prototype.oh=function(t){return Uh(t).delete(this.clientId)},Vh.prototype.ah=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Vh.Kn(t,wh.store);return r.ts().next(function(t){var e=o.uh(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ia.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.lh(i.clientId));t.label=2;case 2:return[2]}})})},Vh.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ah()}).then(function(){return t.Ya()})})},Vh.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},Vh.prototype.nh=function(e){var r=this;return this.Oa?ia.resolve(!0):Mh(e).get(nh.key).next(function(t){if(null!==t&&r.hh(t.leaseTimestampMs,5e3)&&!r._h(t.ownerId)){if(r.rh(t)&&r.networkEnabled)return!0;if(!r.rh(t)){if(!t.allowTabSynchronization)throw new Er(Ir.FAILED_PRECONDITION,Ph);return!1}}return!(!r.networkEnabled||!r.inForeground)||Uh(e).ts().next(function(t){return void 0===r.uh(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Vh.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[nh.store,wh.store],function(t){var e=new Lh(t,Ma.ai);return n.sh(e).next(function(){return n.oh(e)})})];case 1:return t.sent(),this.Wa.close(),this.Eh(),[2]}})})},Vh.prototype.uh=function(t,e){var n=this;return t.filter(function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)})},Vh.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Uh(t).ts().next(function(t){return e.uh(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Vh.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Vh.prototype.Th=function(t){return Cc.Fo(t,this.serializer,this.Dr,this.No)},Vh.prototype.Ih=function(){return this.ja},Vh.prototype.mh=function(){return this.vr},Vh.prototype.Ah=function(){return this.Dr},Vh.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,bh,function(t){return o=new Lh(t,i.Ma?i.Ma.next():Ma.ai),"readwrite-primary"===n?i.eh(o).next(function(t){return!!t||i.nh(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Ka(!1)}),new Er(Ir.FAILED_PRECONDITION,Ja);return r(o)}).next(function(t){return i.ih(o).next(function(){return t})}):i.Rh(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},Vh.prototype.Rh=function(t){var e=this;return Mh(t).get(nh.key).next(function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Er(Ir.FAILED_PRECONDITION,Ph)})},Vh.prototype.ih=function(t){var e=new nh(this.clientId,this.allowTabSynchronization,Date.now());return Mh(t).put(nh.key,e)},Vh.Ln=function(){return oa.Ln()},Vh.prototype.sh=function(t){var e=this,n=Mh(t);return n.get(nh.key).next(function(t){return e.rh(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(nh.key)):ia.resolve()})},Vh.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},Vh.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},Vh.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},Vh.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},Vh.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},Vh.prototype._h=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Vh.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},Vh.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},Vh.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Vh);function Vh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.ka=a,this.Oa=c,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!Vh.Ln())throw new Er(Ir.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new jh(this,r),this.Qa=e+"main",this.serializer=new Nc(u),this.Wa=new oa(this.Qa,10,new th(this.serializer)),this.ja=new Ah(this.No,this.serializer),this.Dr=new Ih,this.vr=(e=this.serializer,u=this.Dr,new zc(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ch(t,e){var n=this;return(n=kh.call(this)||this).Wo=t,n.Fa=e,n}function Mh(t){return Rh.Kn(t,nh.store)}function Uh(t){return Rh.Kn(t,wh.store)}var jh=(qh.prototype.Po=function(t){var n=this.Ph(t);return this.db.Ih().ba(t).next(function(e){return n.next(function(t){return e+t})})},qh.prototype.Ph=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},qh.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},qh.prototype.yo=function(t,n){return this.gh(t,function(t,e){return n(e)})},qh.prototype.Da=function(t,e,n){return Fh(t,n)},qh.prototype.Na=function(t,e,n){return Fh(t,n)},qh.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},qh.prototype.Go=Fh,qh.prototype.Vh=function(t,e){return r=e,i=!1,Gc(n=t).os(function(t){return Uc(n,t,r).next(function(t){return t&&(i=!0),ia.resolve(!t)})}).next(function(){return i});var n,r,i},qh.prototype.bo=function(n,r){var i=this,o=this.db.mh().ra(),s=[],u=0;return this.gh(n,function(e,t){t<=r&&(t=i.Vh(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),Oh(n).delete([0,_c(e.path)])})}),s.push(t))}).next(function(){return ia.kn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},qh.prototype.removeTarget=function(t,e){return e=e.st(t.Fa),this.db.Ih().Va(t,e)},qh.prototype.yh=Fh,qh.prototype.gh=function(t,r){var i,t=Oh(t),o=Ma.ai;return t.rs({index:yh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ma.ai&&r(new ui(Ac(i)),o),o=e,i=t):o=Ma.ai}).next(function(){o!==Ma.ai&&r(new ui(Ac(i)),o)})},qh.prototype.So=function(t){return this.db.mh().aa(t)},qh);function qh(t,e){this.db=t,this.wo=new bc(this,e)}function Fh(t,e){return Oh(t).put((t=t.Fa,new yh(0,_c(e.path),t)))}function Gh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Bh=(zh.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bh)})},zh);function zh(t,e,n){this.persistence=t,this.ph=e,this.bh=new xi(Vr),this.Sh=new ei(bi,Ii),this.Dh=ri.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new $a(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}function Hh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ia(t)})}function Kh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.va(e,r).next(function(t){return t?(n=t,ia.resolve(n)):i.ja.wa(e).next(function(t){return n=new Ai(r,t,0,e.Fa),i.ja.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bh.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.bh=i.bh.ot(t.targetId,t),i.Sh.set(r,t.targetId)),t})}function Wh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bh.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!pa(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bh=e.bh.remove(o),e.Sh.delete(n.target),[2]}})})}function Xh(t,o,s){var u=t,a=ri.min(),c=zi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=vu(o),(void 0!==(t=(i=t).Sh.get(r))?ia.resolve(i.bh.get(t)):i.ja.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ja.xa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ph.Lr(e,o,s?a:ri.min(),s?c:zi())}).next(function(t){return{documents:t,Fh:c}});var t,n,r,i})}function Yh(t,e){var n=t,r=n.ja;return(t=n.bh.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function Qh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==Ja)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Jh(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t}function $h(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lf(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(4),[4,Af(e)];case 1:return t.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,Tf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nu=new lf(n,r)}var Zh,tf,ef,nf=(_f.prototype.P=function(){return this.Oh.P()},_f.prototype.Da=function(t,e){e=new rf(t,e),this.Oh=this.Oh.add(e),this.$h=this.$h.add(e)},_f.prototype.Bh=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},_f.prototype.Na=function(t,e){this.qh(new rf(t,e))},_f.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},_f.prototype.Kh=function(t){var e=this,n=new ui(new ii([])),r=new rf(n,t),t=new rf(n,t+1),i=[];return this.$h.xt([r,t],function(t){e.qh(t),i.push(t.key)}),i},_f.prototype.Qh=function(){var e=this;this.Oh.forEach(function(t){return e.qh(t)})},_f.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},_f.prototype.Wh=function(t){var e=new ui(new ii([])),n=new rf(e,t),t=new rf(e,t+1),r=zi();return this.$h.xt([n,t],function(t){r=r.add(t.key)}),r},_f.prototype.Ho=function(t){var e=new rf(t,0);return null!==(e=this.Oh.kt(e))&&t.isEqual(e.key)},_f),rf=(Ef.Mh=function(t,e){return ui.D(t.key,e.key)||Vr(t.jh,e.jh)},Ef.Lh=function(t,e){return Vr(t.jh,e.jh)||ui.D(t.key,e.key)},Ef),of=(If.prototype.getToken=function(){return Promise.resolve(null)},If.prototype.Hh=function(){},If.prototype.Jh=function(t){(this.zh=t)(Ra.UNAUTHENTICATED)},If.prototype.Yh=function(){this.zh=null},If),sf=(bf.prototype.getToken=function(){var e=this,n=this.tc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.tc!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new Jh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},bf.prototype.Hh=function(){this.forceRefresh=!0},bf.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},bf.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},bf.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new Ra(t)},bf),uf=(Object.defineProperty(wf.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),wf),af=(mf.prototype.getToken=function(){return Promise.resolve(new uf(this.nc,this.sc))},mf.prototype.Jh=function(t){t(Ra.ni)},mf.prototype.Yh=function(){},mf.prototype.Hh=function(){},mf),Ie=(gf.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},gf.prototype.uc=function(){return 2===this.state},gf.prototype.start=function(){3!==this.state?this.auth():this.lc()},gf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},gf.prototype._c=function(){this.state=0,this.Vs.reset()},gf.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,function(){return t.dc()}))},gf.prototype.wc=function(t){this.Ec(),this.stream.send(t)},gf.prototype.dc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uc()?[2,this.close(0)]:[2]})})},gf.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},gf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==e?this.Vs.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):n&&n.code===Ir.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ic(n)];case 1:return t.sent(),[2]}})})},gf.prototype.Tc=function(){},gf.prototype.auth=function(){var n=this;this.state=1;var t=this.mc(this.ac),e=this.ac;this.oc.getToken().then(function(t){n.ac===e&&n.Ac(t)},function(e){t(function(){var t=new Er(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rc(t)})})},gf.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc(function(){n(function(){return e.state=2,e.listener.gc()})}),this.stream.Ic(function(t){n(function(){return e.Rc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},gf.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},gf.prototype.Rc=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},gf.prototype.mc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ac===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},gf),cf=(n(vf,ef=Ie),vf.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},vf.prototype.onMessage=function(t){this.Vs.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Pr(void 0===o||"string"==typeof o),Ur.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),Ur.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Di(s.code),new Er(o,s.message||"")),r=new Zi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Go(t,a.document.name),u=Uo(a.document.updateTime),s=new Ks({mapValue:{fields:a.document.fields}}),u=new eu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Ji(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Go(t,a.document),c=a.readTime?Uo(a.readTime):ri.min(),c=new nu(u,c),a=a.removedTargetIds||[];r=new Ji([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Go(t,c.document),c=c.removedTargetIds||[];r=new Ji([],c,h,null)}else{if(!("filter"in e))return kr();e.filter,(h=e.filter).targetId,e=new _i(e=h.count||0),h=h.targetId,r=new $i(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ri.min():Uo(e.readTime);return this.listener.yc(n,t)},vf.prototype.bc=function(t){var e,n,r,i,o={};o.database=Ho(this.serializer),o.addTarget=(e=this.serializer,(r=Ei(r=(n=t).target)?{documents:Qo(e,r)}:{query:Jo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Mo(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.wc(o)},vf.prototype.vc=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.wc(e)},vf),hf=(n(yf,tf=Ie),Object.defineProperty(yf.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),yf.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,tf.prototype.start.call(this)},yf.prototype.Tc=function(){this.Sc&&this.Cc([])},yf.prototype.Pc=function(t){return this.rc.Vc("Write",t)},yf.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(Pr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?Uo(e.updateTime):Uo(n)).isEqual(ri.min())&&(r=Uo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ts(r,n);var e,n,r})):[]),n=Uo(t.commitTime);return this.listener.Nc(n,e)}var i;return Pr(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},yf.prototype.Fc=function(){var t={};t.database=Ho(this.serializer),this.wc(t)},yf.prototype.Cc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xo(e.serializer,t)})};this.wc(t)},yf),ff=(n(df,Zh=function(){}),df.prototype.Oc=function(){if(this.kc)throw new Er(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},df.prototype.Mc=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.Mc(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Hh(),t})},df.prototype.$c=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.$c(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Hh(),t})},df.prototype.terminate=function(){this.kc=!1},df),lf=(pf.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()}))},pf.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,1<=this.Lc&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},pf.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},pf.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},pf.prototype.Qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.qc?(Dr(t),this.qc=!1):Sr("OnlineStateTracker",t)},pf.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},pf);function pf(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}function df(t,e,n){var r=this;return(r=Zh.call(this)||this).credentials=t,r.rc=e,r.serializer=n,r.kc=!1,r}function yf(t,e,n,r,i){var o=this;return(o=tf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Sc=!1,o}function vf(t,e,n,r,i){var o=this;return(o=ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function gf(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new ra(t,e)}function mf(t,e){this.nc=t,this.sc=e}function wf(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=Ra.ni}function bf(t){var e=this;this.Xh=null,this.currentUser=Ra.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then(function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)},function(){}))}function If(){this.zh=null}function Ef(t,e){this.key=t,this.jh=e}function _f(){this.Oh=new Ci(rf.Mh),this.$h=new Ci(rf.Lh)}function Tf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Lf(r))return[3,4];e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Af(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Nf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,Af(e)];case 1:return t.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}})})}function Sf(t,e){t.Yc.has(e.targetId)||(t.Yc.set(e.targetId,e),Pf(t)?kf(t):Ff(t).uc()&&xf(t,e))}function Df(t,e){var n=t,t=Ff(n);n.Yc.delete(e),t.uc()&&Of(n,e),0===n.Yc.size&&(t.uc()?t.fc():Lf(n)&&n.nu.set("Unknown"))}function xf(t,e){t.su.me(e.targetId),Ff(t).bc(e)}function Of(t,e){t.su.me(e),Ff(t).vc(e)}function kf(e){e.su=new eo({qe:function(t){return e.Hc.qe(t)},Ue:function(t){return e.Yc.get(t)||null}}),Ff(e).start(),e.nu.Uc()}function Pf(t){return Lf(t)&&!Ff(t).cc()&&0<t.Yc.size}function Lf(t){return 0===t.Xc.size}function Rf(t){t.su=void 0}function Vf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!pa(r))throw r;return n.Xc.add(1),[4,Af(n)];case 1:return t.sent(),n.nu.set("Offline"),i=i||function(){return Hh(n.Gc)},n.hs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Xc.delete(1),[4,Tf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Cf(e,n){return n().catch(function(t){return Vf(e,t,n)})}function Mf(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=Gf(s=h),a=0<s.Jc.length?s.Jc[s.Jc.length-1].batchId:-1,t.label=1;case 1:if(!(Lf(s)&&s.Jc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Gc,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Sr.Bo(t,i)}))];case 3:return null===(c=t.sent())?(0===s.Jc.length&&u.fc(),[3,7]):(a=c.batchId,n=c,(e=s).Jc.push(n),(e=Gf(e)).uc()&&e.Dc&&e.Cc(n.mutations),[3,6]);case 4:return c=t.sent(),[4,Vf(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Uf(s)&&jf(s),[2]}var e,n,r,i,o})})}function Uf(t){return Lf(t)&&!Gf(t).cc()&&0<t.Jc.length}function jf(t){Gf(t).start()}function qf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Xc.delete(2),[4,Tf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Xc.add(2),[4,Af(e)]);case 3:t.sent(),e.nu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Ff(n){var t,e,r,i=this;return n.hu||(n.hu=(t=n.zc,e=n.hs,r={gc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Yc.forEach(function(t,e){xf(n,t)}),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Rf(e),Pf(e)?(e.nu.Wc(n),kf(e)):e.nu.set("Unknown"),[2]})})}.bind(null,n),yc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.nu.set("Online"),!(u instanceof Zi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Yc.has(i)?[4,o.Hc.iu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Yc.delete(i),o.su.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Vf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ji?s.su.be(u):u instanceof $i?s.su.ke(u):s.su.De(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Hh(s.Gc)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).su.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Yc.get(e))&&r.Yc.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Yc.get(t);e&&(r.Yc.set(t,e.it(Ur.u,e.nt)),Of(r,t),e=new Ai(e.target,t,1,e.sequenceNumber),xf(r,e))}),r.Hc.ru(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Vf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Oc(),new cf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.hu._c(),Pf(n)?kf(n):n.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.hu.stop()];case 2:t.sent(),Rf(n),t.label=3;case 3:return[2]}})})})),n.hu}function Gf(n){var t,e,r,i=this;return n.cu||(n.cu=(t=n.zc,e=n.hs,r={gc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Gf(e).Fc(),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Gf(e).Dc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Ir.ABORTED?(e=r.Jc.shift(),Gf(r)._c(),[4,Cf(r,function(){return r.Hc.au(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Mf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Uf(e)&&jf(e),[2]}})})}.bind(null,n),xc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Gf(o),n=0,r=o.Jc;n<r.length;n++)i=r[n],e.Cc(i.mutations);return[2]})})}.bind(null,n),Nc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jc.shift(),n=Qa.from(e,i,o),[4,Cf(r,function(){return r.Hc.ou(n)})];case 1:return t.sent(),[4,Mf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Oc(),new hf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.cu._c(),[4,Mf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.cu.stop()];case 3:t.sent(),0<n.Jc.length&&(Sr("RemoteStore","Stopping write stream with "+n.Jc.length+" pending writes"),n.Jc=[]),t.label=4;case 4:return[2]}})})})),n.cu}var Bf=function(t){this.key=t},zf=function(t){this.key=t},Hf=(Object.defineProperty(Qf.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),Qf.prototype.Eu=function(t,e){var s=this,u=e?e.Tu:new Wi,a=(e||this).du,c=(e||this).Qt,h=a,f=!1,l=hu(this.query)&&a.size===this.query.limit?a.last():null,p=fu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof eu?e:null)&&(_u(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Iu(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.fu(r,l)||p&&s.fu(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),hu(this.query)||fu(this.query))for(;h.size>this.query.limit;){var n=hu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{du:h,Tu:u,mu:f,Qt:c}},Qf.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Qf.prototype.Vr=function(t,e,n){var o=this,r=this.du;this.du=t.du,this.Qt=t.Qt;var i=t.Tu.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Au(n);var s=e?this.Ru():[],e=(n=0===this._u.size&&this.te?1:0)!==this.lu;return this.lu=n,0!==i.length||e?{snapshot:new Xi(this.query,t.du,r,i,t.Qt,0==n,e,!1),Pu:s}:{Pu:s}},Qf.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new Wi,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},Qf.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},Qf.prototype.Au=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uu=e.uu.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uu=e.uu.delete(t)}),this.te=t.te)},Qf.prototype.Ru=function(){var e=this;if(!this.te)return[];var n=this._u;this._u=zi(),this.du.forEach(function(t){e.gu(t.key)&&(e._u=e._u.add(t.key))});var r=[];return n.forEach(function(t){e._u.has(t)||r.push(new zf(t))}),this._u.forEach(function(t){n.has(t)||r.push(new Bf(t))}),r},Qf.prototype.Vu=function(t){return this.uu=t.Fh,this._u=zi(),t=this.Eu(t.documents),this.Vr(t,!0)},Qf.prototype.yu=function(){return Xi.Gt(this.query,this.du,this.Qt,0===this.lu)},Qf),Kf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wf=function(t){this.key=t,this.pu=!1},Xf=(Object.defineProperty(Yf.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),Yf);function Yf(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new ei(Iu,bu),this.xu=new Map,this.Fu=[],this.ku=new xi(ui.D),this.Ou=new Map,this.Mu=new nf,this.$u={},this.Lu=new Map,this.Bu=Th.da(),this.onlineState="Unknown",this.qu=void 0}function Qf(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=zi(),this.Qt=zi(),this.fu=Tu(t),this.du=new Ki(this.fu)}function Jf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Eu(o)).mu?[4,Xh(r.Gc,i.query,!1).then(function(t){return t=t.documents,i.view.Eu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Vr(e,r.Uu,n),[2,(il(r,i.targetId,n.Pu),n.snapshot)]}})})}(i,t,e,n)},[4,Xh(i.Gc,o,!0)];case 1:return n=t.sent(),r=new Hf(o,n.Fh),e=r.Eu(n.documents),n=Qi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Vr(e,i.Uu,n),il(i,s,n.Pu),r=new Kf(o,s,r),[2,(i.Nu.set(o,r),i.xu.has(s)?i.xu.get(s).push(o):i.xu.set(s,[o]),n.snapshot)]}})})}function $f(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,c=e,h=(a=o).nt,f=c.bh,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ch.ra({oa:!0});f=c.bh;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.ja.Ca(s,t.se,e).next(function(){return c.ja.Sa(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Fa),f=f.ot(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.ja.Va(s,n))))});var t,o=Ui,n=zi();return a.Jt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Jt.forEach(function(t,e){var n=r.get(t);e instanceof nu&&e.version.isEqual(ri.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.Ir(e,h),o=o.ot(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.No.yh(s,t))})})),h.isEqual(ri.min())||(t=c.ja.Ia(s).next(function(t){return c.ja.Aa(s,s.Fa,h)}),u.push(t)),ia.kn(u).next(function(){return i.apply(s)}).next(function(){return c.Nh.Mr(s,o)})}).then(function(t){return c.bh=f,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.Ou.get(e))&&(Pr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.pu=!0:0<t.ne.size?Pr(e.pu):0<t.se.size&&(Pr(e.pu),e.pu=!1))}),[4,sl(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,f})})}function Zf(t,n,e){var r;((t=t).Uu&&0===e||!t.Uu&&1===e)&&(r=[],t.Nu.forEach(function(t,e){(e=e.view.Ks(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Pa(t)}(t.vu,n),r.length&&t.Cu.yc(r),t.onlineState=n,t.Uu&&t.Su.ji(n))}function tl(t,e){(t.Lu.get(e)||[]).forEach(function(t){t.resolve()}),t.Lu.delete(e)}function el(t,e,n){var r=t,i=r.$u[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i)}function nl(e,t,n){void 0===n&&(n=null),e.Su.Bi(t);for(var r=0,i=e.xu.get(t);r<i.length;r++){var o=i[r];e.Nu.delete(o),n&&e.Cu.Qu(o,n)}e.xu.delete(t),e.Uu&&e.Mu.Kh(t).forEach(function(t){e.Mu.Ho(t)||rl(e,t)})}function rl(t,e){var n=t.ku.get(e);null!==n&&(Df(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),ol(t))}function il(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Bf?(t.Mu.Da(u.key,e),r=t,i=(i=u).key,r.ku.get(i)||(Sr("SyncEngine","New document in limbo: "+i),r.Fu.push(i),ol(r))):u instanceof zf?(Sr("SyncEngine","Document no longer in limbo: "+u.key),t.Mu.Na(u.key,e),t.Mu.Ho(u.key)||rl(t,u.key)):kr()}}function ol(t){for(;0<t.Fu.length&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new Wf(e)),t.ku=t.ku.ot(e,n),Sf(t.bu,new Ai(vu(cu(e.path)),n,2,Ma.ai))}}function sl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nu.P()?[3,3]:(n.Nu.forEach(function(t,e){o.push(n.Ku(e,s,u).then(function(t){t&&(n.Uu&&n.Su.Ki(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Za.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Cu.yc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ia.forEach(c,function(e){return ia.forEach(e.jr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return ia.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bh.get(o),u=s.nt,u=s.rt(u),r.bh=r.bh.ot(o,u));return[2]}})})}(n.Gc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function ul(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xu.get(s))&&0!==a.length?[4,Kh(e.Gc,vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nu.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xh((e=r).Gc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Vu(n),[2,(e.Uu&&il(e,i.targetId,n.Pu),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Yh(e.Gc,s)];case 8:return l=t.sent(),[4,Kh(e.Gc,l)];case 9:return u=t.sent(),[4,Jf(e,al(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Cu.yc(r),n)]}})})}function al(t){return au(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function cl(t){return t.bu.Hc.ru=$f.bind(null,t),t.bu.Hc.qe=function(t,e){var n=t;if((t=n.Ou.get(e))&&t.pu)return zi().add(t.key);var r=zi();if(!(e=n.xu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nu.get(s),r=r.Ot(s.view.wu);return r}.bind(null,t),t.bu.Hc.iu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Su.Ki(s,"rejected",u),i=e.Ou.get(s),(n=i&&i.key)?(r=(r=new xi(ui.D)).ot(n,new nu(n,ri.min())),i=zi().add(n),i=new Yi(ri.min(),new Map,new Ci(Vr),r,i),[4,$f(e,i)]):[3,2];case 1:return t.sent(),e.ku=e.ku.remove(n),e.Ou.delete(s),ol(e),[3,4];case 2:return[4,Wh(e.Gc,s,!1).then(function(){return nl(e,s,u)}).catch(Qh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Cu.yc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Pa(n)}.bind(null,t.vu),t.Cu.Qu=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.vu),t}function hl(t){return t.bu.Hc.ou=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Ch.ra({oa:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ia.resolve();return a.forEach(function(n){c=c.next(function(){return s.Rr(o,n)}).next(function(t){var e=t;Pr(null!==(t=r.dr.get(n))),(!e||e.version.h(t)<0)&&(e=u.hr(n,e,r))&&s.Ir(e,r._r)})}),c.next(function(){return i.Sr.Qo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Nh.Or(t,e)})}))];case 2:return i=t.sent(),el(n,r,null),tl(n,r),n.Su.Oi(r,"acknowledged"),[4,sl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.bu.Hc.au=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.$o(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.Sr.Qo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Nh.Or(e,n)})}))];case 2:return o=t.sent(),el(n,u,a),tl(n,u),n.Su.Oi(u,"rejected",a),[4,sl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var fl,ll,pl,dl=(jl.prototype.xh=function(t){this.zu=t},jl.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ri.min())?this.Hu(e,r):this.zu.Or(e,o).next(function(t){var n=s.Ju(r,t);return(hu(r)||fu(r))&&s.mu(r.an,n,o,i)?s.Hu(e,r):(Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Eu(r)),s.zu.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},jl.prototype.Ju=function(n,t){var r=new Ci(Tu(n));return t.forEach(function(t,e){e instanceof eu&&_u(n,e)&&(r=r.add(e))}),r},jl.prototype.mu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.h(r))},jl.prototype.Hu=function(t,e){return Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Eu(e)),this.zu.Lr(t,e,ri.min())},jl),yl=(Ul.prototype.ko=function(t){return ia.resolve(0===this.Sr.length)},Ul.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Sr.length&&this.Sr[this.Sr.length-1],n=new Ya(i,e,n,r),this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xu=this.Xu.add(new rf(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return ia.resolve(n)},Ul.prototype.$o=function(t,e){return ia.resolve(this.Zu(e))},Ul.prototype.Bo=function(t,e){return e+=1,e=(e=this.tl(e))<0?0:e,ia.resolve(this.Sr.length>e?this.Sr[e]:null)},Ul.prototype.qo=function(){return ia.resolve(0===this.Sr.length?-1:this.Yu-1)},Ul.prototype.Uo=function(t){return ia.resolve(this.Sr.slice())},Ul.prototype.Nr=function(t,e){var n=this,r=new rf(e,0),e=new rf(e,Number.POSITIVE_INFINITY),i=[];return this.Xu.xt([r,e],function(t){t=n.Zu(t.jh),i.push(t)}),ia.resolve(i)},Ul.prototype.$r=function(t,e){var n=this,r=new Ci(Vr);return e.forEach(function(t){var e=new rf(t,0),t=new rf(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,t],function(t){r=r.add(t.jh)})}),ia.resolve(this.el(r))},Ul.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,e=n;ui.X(e)||(e=e.child(""));var e=new rf(new ui(e),0),i=new Ci(Vr);return this.Xu.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.jh)),!0)},e),ia.resolve(this.el(i))},Ul.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Zu(t))&&n.push(t)}),n},Ul.prototype.Qo=function(n,r){var i=this;Pr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xu;return ia.forEach(r.mutations,function(t){var e=new rf(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xu=o})},Ul.prototype.jo=function(t){},Ul.prototype.Ho=function(t,e){var n=new rf(e,0),n=this.Xu.kt(n);return ia.resolve(e.isEqual(n&&n.key))},Ul.prototype.zo=function(t){return this.Sr.length,ia.resolve()},Ul.prototype.nl=function(t,e){return this.tl(t)},Ul.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},Ul.prototype.Zu=function(t){return(t=this.tl(t))<0||t>=this.Sr.length?null:this.Sr[t]},Ul),vl=(Ml.prototype.Ir=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:o,readTime:n}),this.size+=o-i,this.Dr.Mo(t,r.path.F())},Ml.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ml.prototype.Rr=function(t,e){return e=this.docs.get(e),ia.resolve(e?e.ta:null)},Ml.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),ia.resolve(r)},Ml.prototype.Lr=function(t,e,n){for(var r=Fi,i=new ui(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ta,a=a.readTime;if(!e.path.M(s.path))break;a.h(n)<=0||u instanceof eu&&_u(e,u)&&(r=r.ot(u.key,u))}return ia.resolve(r)},Ml.prototype.il=function(t,e){return ia.forEach(this.docs,function(t){return e(t)})},Ml.prototype.ra=function(t){return new gl(this)},Ml.prototype.aa=function(t){return ia.resolve(this.size)},Ml),gl=(n(Cl,pl=h),Cl.prototype.Vr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ha.Ir(n,e,r.readTime)):r.ha.Ar(t)}),ia.kn(i)},Cl.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},Cl.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},Cl),ml=(Vl.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),ia.resolve()},Vl.prototype.Ia=function(t){return ia.resolve(this.lastRemoteSnapshotVersion)},Vl.prototype.ma=function(t){return ia.resolve(this.ol)},Vl.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),ia.resolve(this.highestTargetId)},Vl.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),ia.resolve()},Vl.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Th(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},Vl.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,ia.resolve()},Vl.prototype.Va=function(t,e){return this.Pa(e),ia.resolve()},Vl.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),--this.targetCount,ia.resolve()},Vl.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),ia.kn(u).next(function(){return s})},Vl.prototype.ba=function(t){return ia.resolve(this.targetCount)},Vl.prototype.va=function(t,e){return e=this.rl.get(e)||null,ia.resolve(e)},Vl.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),ia.resolve()},Vl.prototype.Ca=function(e,t,n){this.al.Uh(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),ia.kn(i)},Vl.prototype.pa=function(t,e){return this.al.Kh(e),ia.resolve()},Vl.prototype.xa=function(t,e){return e=this.al.Wh(e),ia.resolve(e)},Vl.prototype.Ho=function(t,e){return ia.resolve(this.al.Ho(e))},Vl),wl=(Rl.prototype.start=function(){return Promise.resolve()},Rl.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(Rl.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Rl.prototype.Za=function(){},Rl.prototype.th=function(){},Rl.prototype.Ah=function(){return this.Dr},Rl.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new yl(this.Dr,this.No),this.cl[t.ti()]=e),e},Rl.prototype.Ih=function(){return this.ja},Rl.prototype.mh=function(){return this.vr},Rl.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new bl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).xn().then(function(t){return i.br(),t})},Rl.prototype.fl=function(e,n){return ia.On(Object.values(this.cl).map(function(t){return function(){return t.Ho(e,n)}}))},Rl),bl=(n(Ll,ll=be),Ll),Il=(Pl.El=function(t){return new Pl(t)},Object.defineProperty(Pl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw kr()},enumerable:!1,configurable:!0}),Pl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),ia.resolve()},Pl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),ia.resolve()},Pl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),ia.resolve()},Pl.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Ih();return r.xa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.ya(t,e)})},Pl.prototype.ll=function(){this.wl=new Set},Pl.prototype._l=function(n){var r=this,i=this.persistence.mh().ra();return ia.forEach(this.Tl,function(t){var e=ui.H(t);return r.Il(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},Pl.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},Pl.prototype.ul=function(t){return 0},Pl.prototype.Il=function(t,e){var n=this;return ia.On([function(){return ia.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},Pl),El=(kl.prototype.gc=function(t){this.Rl=t},kl.prototype.Ic=function(t){this.Pl=t},kl.prototype.onMessage=function(t){this.gl=t},kl.prototype.close=function(){this.Al()},kl.prototype.send=function(t){this.ml(t)},kl.prototype.Vl=function(){this.Rl()},kl.prototype.yl=function(t){this.Pl(t)},kl.prototype.pl=function(t){this.gl(t)},kl),_l={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Tl=(Ol.prototype.Mc=function(e,t,n,r){var i=this.Dl(e,t);return Sr("RestConnection","Sending: ",i,n),t={},this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Ol.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},Ol.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0-2020926155854",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},Ol.prototype.Dl=function(t,e){return t=_l[t],this.vl+"/v1/"+e+":"+t},n(xl,fl=Ol),xl.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Er(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Er(e,t.message))):r(new Er(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Er(Ir.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},xl.prototype.Vc=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Sr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new El({ml:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.yl())}),t(vr.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),a.yl(new Er(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ti[r];if(void 0!==t)return Di(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.yl(new Er(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.Vl()},0),a},xl),Al=(Dl.prototype.eu=function(t){this.Ml.push(t)},Dl.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},Dl.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},Dl.prototype.Fl=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},Dl.prototype.Ol=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},Dl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Dl),Nl=(Sl.prototype.eu=function(t){},Sl.prototype.Di=function(){},Sl);function Sl(){}function Dl(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}function xl(t){var e=this;return(e=fl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Ol(t){this.bl=t,this._=t._;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function kl(t){this.ml=t.ml,this.Al=t.Al}function Pl(t){this.persistence=t,this.dl=new nf,this.wl=null}function Ll(t){var e=this;return(e=ll.call(this)||this).Fa=t,e}function Rl(t){var e=this;this.cl={},this.Ma=new Ma(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new ml(this),this.Dr=new $c,this.vr=(t=this.Dr,new vl(t,function(t){return e.No.ul(t)}))}function Vl(t){this.persistence=t,this.rl=new ei(bi,Ii),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.ol=0,this.al=new nf,this.targetCount=0,this.hl=Th.fa()}function Cl(t){var e=this;return(e=pl.call(this)||this).ha=t,e}function Ml(t,e){this.Dr=t,this.sl=e,this.docs=new xi(ui.D),this.size=0}function Ul(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Ci(rf.Mh)}function jl(){}function ql(t){return new Po(t,!0)}var Fl,Gl,Bl=($l.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Su=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.Gc=this.Kl(e),[2]}})})},$l.prototype.Ul=function(t){return null},$l.prototype.Kl=function(t){return e=this.persistence,n=new dl,t=t.Ql,new Bh(e,n,t);var e,n},$l.prototype.Bl=function(t){return new wl(Il.El)},$l.prototype.Ll=function(t){return new Xa},$l.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},$l),zl=(n(Jl,Gl=Bl),Jl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Gl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Yc(t),r=ri.min(),t.rs({index:lh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Oc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Dh=t})]})})}(this.Gc)];case 2:return t.sent(),[4,this.Wl.initialize(this,e)];case 3:return t.sent(),[4,hl(this.Wl.fi)];case 4:return t.sent(),[4,Mf(this.Wl.bu)];case 5:return t.sent(),[2]}})})},Jl.prototype.Ul=function(t){var e=this.persistence.No.wo;return new wc(e,t.hs)},Jl.prototype.Bl=function(t){var e=Gh(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?vc.ao(this.cacheSizeBytes):vc.fo,r=ql(t.bl._);return new Rh(this.synchronizeTabs,e,t.clientId,n,t.hs,Ia(),Ea(),r,this.Su,!!this.forceOwnership)},Jl.prototype.Ll=function(t){return new Xa},Jl),Hl=(n(Ql,Fl=zl),Ql.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Fl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Wl.fi,this.Su instanceof Wa?(this.Su.fi={er:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Gc,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Nh.Or(e,t):ia.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Mf(o.bu)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(el(o,a,h||null),tl(o,a),o.Gc.Sr.jo(a)):kr(),t.label=4;case 4:return[4,sl(o,s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),nr:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qu?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.xu.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Gc,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ch,n=t,t=s.Dh,r=e,i=Ui,o=xc(t),t=Yc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:lh.readTimeIndex,range:n},function(t,e){var n=Sc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{kh:i,readTime:Oc(o)}});var e,n,r,i,o}).then(function(t){var e=t.kh,t=t.readTime;return s.Dh=t,e}))];case 3:return r=t.sent(),i=Yi.Xt(u,"current"===a),[4,sl(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,Wh(n.Gc,u,!0)];case 6:return t.sent(),nl(n,u,c),[3,8];case 7:kr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=cl(c)).qu)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xu.has(r)?(Sr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Yh(n.Gc,r)]):[3,6];case 2:return i=t.sent(),[4,Kh(n.Gc,i)];case 3:return o=t.sent(),[4,Jf(n,al(i),o.targetId,!1)];case 4:t.sent(),Sf(n.bu,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xu.has(e)?[4,Wh(n.Gc,e,!1).then(function(){Df(n.bu,e),nl(n,e)}).catch(Qh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Gc.persistence.pi()}.bind(null,e)},[4,this.Su.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return cl(r=h),hl(r),!0!==f||!0===r.qu?[3,3]:(e=r.Su.Ci(),[4,ul(r,e.L())]);case 1:return i=t.sent(),r.qu=!0,[4,qf(r.bu,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Sf(r.bu,u);return[3,7];case 3:return!1!==f||!1===r.qu?[3,7]:(a=[],c=Promise.resolve(),r.xu.forEach(function(t,e){r.Su.qi(e)?a.push(e):c=c.then(function(){return nl(r,e),Wh(r.Gc,e,!0)}),Df(r.bu,e)}),[4,c]);case 4:return t.sent(),[4,ul(r,a)];case 5:return t.sent(),(n=r).Ou.forEach(function(t,e){Df(n.bu,e)}),n.Mu.Qh(),n.Ou=new Map,n.ku=new xi(ui.D),r.qu=!1,[4,qf(r.bu,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Wl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ii?this.ql.start(this.Gc):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Ql.prototype.Ll=function(t){var e=Ia();if(!Wa.Ln(e))throw new Er(Ir.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Gh(t.bl._,t.bl.persistenceKey);return new Wa(e,t.hs,n,t.clientId,t.Ql)},Ql),Kl=(Yl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Gc?[3,2]:(this.Gc=n.Gc,this.Su=n.Su,this.zc=this.jl(r),this.bu=this.Gl(r),this.vu=this.zl(r),this.fi=this.Hl(r,!n.synchronizeTabs),this.Su.di=function(t){return Zf(e.fi,t,1)},this.bu.Hc.Jl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Nh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.Th(o),m=new $a(e.Ch,n,e.persistence.Ah()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Or(v,r).next(function(t){return{Wu:t,ju:e,Gu:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Nh=m,e.ph.xh(e.Nh),r)]}})})}(n.Gc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lu.forEach(function(t){t.forEach(function(t){t.reject(new Er(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lu.clear(),n.Su.Wi(o,r.ju,r.Gu),[4,sl(n,r.Wu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fi),[4,qf(this.bu,this.fi.Uu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yl.prototype.zl=function(t){return new xa},Yl.prototype.jl=function(t){var e=ql(t.bl._),n=(n=t.bl,new Tl(n));return t=t.credentials,new ff(t,n,e)},Yl.prototype.Gl=function(t){var e=this;return new $h(this.Gc,this.zc,t.hs,function(t){return Zf(e.fi,t,0)},t=new(Al.Ln()?Al:Nl))},Yl.prototype.Hl=function(t,e){return n=this.Gc,r=this.bu,i=this.vu,o=this.Su,s=t.Ql,u=t.Du,a=e,u=new Xf(n,r,i,o,s,u),a&&(u.qu=!0),u;var n,r,i,o,s,u,a},Yl.prototype.terminate=function(){return Nf(this.bu)},Yl),Wl=(Xl.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},Xl.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Xl.prototype.Xl=function(){this.muted=!0},Xl.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Xl);function Xl(t){this.observer=t,this.muted=!1}function Yl(){}function Ql(t,e){var n=this;return(n=Fl.call(this,t,e,!1)||this).Wl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Jl(t,e,n){var r=this;return(r=Gl.call(this)||this).Wl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function $l(){this.synchronizeTabs=!1}function Zl(t,e,n){if(!n)throw new Er(Ir.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function tp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Er(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ep(t,e,n,r){if(!0===e&&!0===r)throw new Er(Ir.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function np(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function rp(t,e){if(e<=0)throw new Er(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ip,op,sp=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new si(t)},up=(n(lp,op=sp),lp.documentId=function(){return new lp(si.j().B())},lp.prototype.isEqual=function(t){return t instanceof lp&&this.Zl.isEqual(t.Zl)},lp),ap=new RegExp("[~\\*/\\[\\]]"),cp=function(t){this.t_=t},hp=(n(fp,ip=cp),fp.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},fp.prototype.isEqual=function(t){return t instanceof fp},fp);function fp(){return null!==ip&&ip.apply(this,arguments)||this}function lp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return op.call(this,t)||this}function pp(t,e,n){return new Cp({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var dp,yp,vp,gp,mp=(n(Rp,gp=cp),Rp.prototype.e_=function(t){return new Es(t.path,new us)},Rp.prototype.isEqual=function(t){return t instanceof Rp},Rp),wp=(n(Lp,vp=cp),Lp.prototype.e_=function(t){var e=pp(this,t,!0),n=this.o_.map(function(t){return zp(t,e)}),n=new as(n);return new Es(t.path,n)},Lp.prototype.isEqual=function(t){return this===t},Lp),bp=(n(Pp,yp=cp),Pp.prototype.e_=function(t){var e=pp(this,t,!0),n=this.o_.map(function(t){return zp(t,e)}),n=new ps(n);return new Es(t.path,n)},Pp.prototype.isEqual=function(t){return this===t},Pp),Ip=(n(kp,dp=cp),kp.prototype.e_=function(t){var e=new gs(t.serializer,Vo(t.serializer,this.a_));return new Es(t.path,e)},kp.prototype.isEqual=function(t){return this===t},kp),Ep=(Object.defineProperty(Op.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(Op.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Op.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},Op.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},Op.prototype.g=function(t){return Vr(this.h_,t.h_)||Vr(this.c_,t.c_)},Op),_p=function(t){this.u_=t},Tp=/^__.*__$/,Ap=function(t,e,n){this.l_=t,this.__=e,this.f_=n},Np=(xp.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new Rs(t,this.data,this.Qe,e)):n.push(new Ls(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new js(t,this.fieldTransforms)),n},xp),Sp=(Dp.prototype.d_=function(t,e){return e=[new Rs(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new js(t,this.fieldTransforms)),e},Dp);function Dp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function xp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Op(t,e){if(!isFinite(t)||t<-90||90<t)throw new Er(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Er(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}function kp(t,e){var n=this;return(n=dp.call(this,t)||this).a_=e,n}function Pp(t,e){var n=this;return(n=yp.call(this,t)||this).o_=e,n}function Lp(t,e){var n=this;return(n=vp.call(this,t)||this).o_=e,n}function Rp(){return null!==gp&&gp.apply(this,arguments)||this}function Vp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Cp=(Object.defineProperty(jp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),jp.prototype.E_=function(t){return new jp(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},jp.prototype.T_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.E_({path:e,r_:!1})).I_(t),e},jp.prototype.m_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.E_({path:t,r_:!1})).w_(),t},jp.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},jp.prototype.s_=function(t){return Qp(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},jp.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},jp.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},jp.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Vp(this.n_)&&Tp.test(t))throw this.s_('Document fields cannot begin and end with "__"')},jp),Mp=(Up.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Cp({n_:t,methodName:e,i_:n,path:si.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Up);function Up(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||ql(t)}function jp(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function qp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);Wp("Data must be an object, but it was:",s,r);var u,a,r=Hp(r,s);if(o.merge)u=new Is(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof sp)p=l.Zl;else{if("string"!=typeof l)throw kr();p=Yp(e,l,n)}if(!s.contains(p))throw new Er(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Jp(c,p)||c.push(p)}u=new Is(c),a=s.fieldTransforms.filter(function(t){return u.Je(t.field)})}else u=null,a=s.fieldTransforms;return new Np(new Ks(r),u,a)}function Fp(t,r,i,e){var o=t.P_(1,r,i);Wp("Data must be an object, but it was:",o,e);var s=[],u=new Ws;return Jr(e,function(t,e){var n=Yp(r,t,i),t=o.m_(n);e instanceof hp||e instanceof _p&&e.u_ instanceof hp?s.push(n):null!=(t=zp(e,t))&&(s.push(n),u.set(n,t))}),e=new Is(s),new Sp(u.Xe(),e,o.fieldTransforms)}function Gp(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[Xp(e,r,n)],a=[i];if(o.length%2!=0)throw new Er(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Xp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Ws,y=u.length-1;0<=y;--y)Jp(p,u[y])||(h=u[y],f=a[y],l=s.m_(h),f instanceof hp||f instanceof _p&&f.u_ instanceof hp?p.push(h):null!=(l=zp(f,l))&&(p.push(h),d.set(h,l)));return i=new Is(p),new Sp(d.Xe(),i,s.fieldTransforms)}function Bp(t,e,n,r){return void 0===r&&(r=!1),zp(n,t.P_(r?4:3,e))}function zp(s,t){if(s instanceof _p&&(s=s.u_),Kp(s))return Wp("Unsupported field value:",t,s),Hp(s,t);if(s instanceof cp)return function(t,e){if(!Vp(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");(t=t.e_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=zp(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:Co(e.serializer,n)}}if(t instanceof ni){var r=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Co(e.serializer,r)}}if(t instanceof Ep)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qr)return{bytesValue:Mo(e.serializer,t.l)};if(t instanceof Ap){if(n=e._,!(r=t.l_).isEqual(n))throw e.s_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+np(t))}(s,t)}function Hp(t,n){var r={};return $r(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Jr(t,function(t,e){null!=(e=zp(e,n.T_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Kp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof Ep||t instanceof qr||t instanceof Ap||t instanceof cp)}function Wp(t,e,n){if(!Kp(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=np(n))?e.s_(t+" a custom object"):e.s_(t+" "+n);var r}function Xp(t,e,n){if(e instanceof sp)return e.Zl;if("string"==typeof e)return Yp(t,e);throw Qp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Yp(t,e,n){try{return function(e){if(0<=e.search(ap))throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(up.bind.apply(up,i([void 0],e.split("."))))}catch(t){throw new Er(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw Qp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Qp(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Er(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Jp(t,e){return t.some(function(t){return t.isEqual(e)})}var $p=(rd.prototype.b_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new Er(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=Ho((i=s).serializer)+"/documents",n={documents:u.map(function(t){return Fo(i.serializer,t)})},[4,i.$c("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),t=Uo(e.found.updateTime),e=new Ks({mapValue:{fields:e.found.fields}});return new eu(n,t,e,{})}(e,t):"missing"in t?(n=e,Pr(!!(r=t).missing),Pr(!!r.readTime),n=Go(n,r.missing),r=Uo(r.readTime),new nu(n,r)):kr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){Pr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.zc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof nu||t instanceof eu?n.S_(t):kr()}),e)]}})})},rd.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},rd.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},rd.prototype.delete=function(t){this.write([new zs(t,this.Ge(t))]),this.p_.add(t.toString())},rd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),this.y_)throw this.y_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui.H(e),n.mutations.push(new Hs(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Xo(e.serializer,t)})},[4,e.Mc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.zc,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},rd.prototype.S_=function(t){var e;if(t instanceof eu)e=t.version;else{if(!(t instanceof nu))throw kr();e=ri.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Er(Ir.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},rd.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?As.updateTime(e):As.ze()},rd.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return As.exists(!0);if(e.isEqual(ri.min()))throw new Er(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},rd.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},rd.prototype.v_=function(){},rd),Zp=(nd.prototype.run=function(){this.N_()},nd.prototype.N_=function(){var t=this;this.Vs.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new $p(this.zc),(n=this.x_(e))&&n.then(function(t){r.hs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.F_(t)})})}).catch(function(t){r.F_(t)}),[2]})})})},nd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},nd.prototype.F_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.hs.ws(function(){return e.N_(),Promise.resolve()})):this.ls.reject(t)},nd.prototype.k_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Si(t))},nd),td=(ed.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new ea,o=!1;return this.credentials.Jh(function(t){return o?void r.hs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).hs.Fs(),Sr("RemoteStore","RemoteStore received new credentials"),n=Lf(e),e.Xc.add(3),[4,Af(e)];case 1:return t.sent(),n&&e.nu.set("Unknown"),[4,e.Hc.Jl(i)];case 2:return t.sent(),e.Xc.delete(3),[4,Tf(e)];case 3:return t.sent(),[2]}})})}(r.bu,t)}):(o=!0,Sr("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject))}),this.hs.ws(function(){return r.O_.promise}),i.promise},ed.prototype.enableNetwork=function(){var e=this;return this.M_(),this.hs.enqueue(function(){return e.persistence.th(!0),(t=e.bu).Xc.delete(0),Tf(t);var t})},ed.prototype.L_=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:o,Du:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Su=r.Su,this.Gc=r.Gc,this.ql=r.ql,this.zc=i.zc,this.bu=i.bu,this.fi=i.fi,this.B_=i.vu,this.B_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=cl(s),(o=e.Nu.get(u))?(n=o.targetId,e.Su.$i(n),r=o.view.yu(),[3,4]):[3,1];case 1:return[4,Kh(e.Gc,vu(u))];case 2:return i=t.sent(),o=e.Su.$i(i.targetId),n=i.targetId,[4,Jf(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uu&&Sf(e.bu,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.B_.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nu.get(o),1<(r=e.xu.get(n.targetId)).length?[2,(e.xu.set(n.targetId,r.filter(function(t){return!bu(t,o)})),void e.Nu.delete(o))]:e.Uu?(e.Su.Bi(n.targetId),e.Su.xi(n.targetId)?[3,2]:[4,Wh(e.Gc,n.targetId,!1).then(function(){e.Su.Ui(n.targetId),Df(e.bu,n.targetId),nl(e,n.targetId)}).catch(Qh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return nl(e,n.targetId),[4,Wh(e.Gc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Ir.FAILED_PRECONDITION||e.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.L_(new Bl,new Kl,o,s))];case 4:return[2]}})})},ed.prototype.M_=function(){if(this.hs.ps)throw new Er(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},ed.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue(function(){return t.persistence.th(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(0),[4,Af(e)];case 1:return t.sent(),e.nu.set("Offline"),[2]}})})}(t.bu)})},ed.prototype.terminate=function(){var t=this;this.hs.Ds();var n=new ea;return this.hs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Nf(this.bu)];case 1:return t.sent(),[4,this.Su.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yh(),n.resolve(),[3,5];case 4:return e=Sa(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},ed.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new ea;return this.hs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Lf((n=o).bu)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Gc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lu.get(r)||[]).push(s),n.Lu.set(r,i),[3,4]);case 3:return i=Sa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},ed.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new Wl(n),o=new La(t,i,e);return this.hs.ws(function(){return Oa(r.B_,o)}),function(){i.Xl(),r.hs.ws(function(){return ka(r.B_,o)})}},ed.prototype.q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ea,[2,(this.hs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Nh.Cr(t,e)}))];case 1:return(r=t.sent())instanceof eu?s.resolve(r):r instanceof nu?s.resolve(null):s.reject(new Er(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Sa(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Gc,r,e)}),e.promise)]}})})},ed.prototype.U_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ea,[2,(this.hs.ws(function(){return n=a.B_,r=a.hs,i=c,o=h,s=e,t=new Wl({next:function(t){r.ws(function(){return ka(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Er(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Er(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new La(cu(i.path),t,{includeMetadataChanges:!0,Xs:!0}),Oa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},ed.prototype.K_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ea,[2,(this.hs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Xh(r,i,!0)];case 1:return n=t.sent(),e=new Hf(i,n.Fh),n=e.Eu(n.documents),n=e.Vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Sa(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Gc,r,e)}),e.promise)]}})})},ed.prototype.Q_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),u=new ea,[2,(this.hs.ws(function(){return e=a.B_,n=a.hs,t=c,r=h,i=u,o=new Wl({next:function(t){n.ws(function(){return ka(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Er(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new La(t,o,{includeMetadataChanges:!0,Xs:!0}),Oa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},ed.prototype.write=function(t){var e=this;this.M_();var n=new ea;return this.hs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=hl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Gc,a=p,h=i,f=ni.now(),o=a.reduce(function(t,e){return t.add(e.key)},zi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Nh.Or(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof js?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof eu?t.field(i.field):void 0;null!=(o=is(i.transform,o||null))&&(e=(null==e?new Ws:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Rs(i.key,o,function s(t){var u=[];return Jr(t.fields||{},function(t,e){var n=new si([t]);if(xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Is(u)}(o.proto.mapValue),As.exists(!0)))}return h.Sr.Oo(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Su.Fi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$u[e.currentUser.ti()])||new xi(Vr)).ot(n,r),e.$u[e.currentUser.ti()]=i,[4,sl(u,s.wr)];case 3:return t.sent(),[4,Mf(u.bu)];case 4:return t.sent(),[3,6];case 5:return u=Sa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},ed.prototype._=function(){return this.bl._},ed.prototype.W_=function(t){var e=this;this.M_();var r=new Wl(t);return this.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.B_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.B_.qs.delete(r)]})})})}},Object.defineProperty(ed.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),ed.prototype.transaction=function(t){var e=this;this.M_();var n=new ea;return this.hs.ws(function(){return new Zp(e.hs,e.zc,t,n).run(),Promise.resolve()}),n.promise},ed);function ed(t,e){this.credentials=t,this.hs=e,this.clientId=Lr.t(),this.O_=new ea}function nd(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new ra(this.hs,"transaction_retry")}function rd(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}function id(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var od,sd,ud=(Od.prototype.J_=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(_o(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw kr()}},Od.prototype.nf=function(t){var n=this,r={};return Jr(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},Od.prototype.tf=function(t){return new Ep(Eo(t.latitude),Eo(t.longitude))},Od.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},Od.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){return fo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(lo(t));default:return null}},Od.prototype.Y_=function(t){return t=Io(t),new ni(t.seconds,t.nanos)},Od.prototype.Z_=function(t){var e=ii.q(t);return Pr(rs(e)),t=new Wr(e.get(1),e.get(3)),e=new ui(e.N(5)),t.isEqual(this._)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(e)},Od),ad=vc.uo,cd=(xd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},xd),hd="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",fd=(Dd.prototype.enableIndexedDbPersistence=function(t,e){throw new Er(Ir.FAILED_PRECONDITION,hd)},Dd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Er(Ir.FAILED_PRECONDITION,hd)},Dd.prototype.clearIndexedDbPersistence=function(t){throw new Er(Ir.FAILED_PRECONDITION,hd)},Dd),ld=(Sd.prototype.enableIndexedDbPersistence=function(t,e){var n=new Kl,e=new zl(n,t.sf().cacheSizeBytes,e);return t.if(e,n)},Sd.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new Kl,n=new Hl(e,t.sf().cacheSizeBytes);return t.if(n,e)},Sd.prototype.clearIndexedDbPersistence=function(n){var t=this,r=new ea;return n.rf.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return oa.Ln()?(e=n+"main",[4,oa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Gh(n.l_,n.af))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},Sd),pd=(Object.defineProperty(Nd.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new Mp(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),Nd.prototype.settings=function(t){if(t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge,t=new cd(t),this.lf&&!this.df.isEqual(t))throw new Er(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.df=t).credentials&&(this.ff=function(t){if(!t)return new of;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new af(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Er(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Nd.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&xr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Nd.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},Nd.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},Nd.prototype.enablePersistence=function(t){if(this.lf)throw new Er(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&ep("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},Nd.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.lf&&!this.lf.j_)throw new Er(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]})})},Nd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Nd.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),Nd.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},Nd.prototype.onSnapshotsInSync=function(t){return this.uf(),id(t)||(t={next:t}),this.lf.W_(t)},Nd.prototype.uf=function(){return this.lf||this.if(new Bl,new Kl),this.lf},Nd.prototype.If=function(){return new zr(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},Nd.prototype.if=function(t,e){var n=this.If();return this.lf=new td(this.ff,this.rf),this.lf.start(n,t,e)},Nd._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Er(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Er(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Wr(t)},Object.defineProperty(Nd.prototype,"app",{get:function(){if(!this.cf)throw new Er(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Nd.prototype.collection=function(t){return Zl("Firestore.collection","path",t),this.uf(),new Ud(ii.q(t),this,null)},Nd.prototype.doc=function(t){return Zl("Firestore.doc","path",t),this.uf(),vd.mf(ii.q(t),this,null)},Nd.prototype.collectionGroup=function(t){if(Zl("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Cd((t=t,new iu(ii.U(),t)),this,null)},Nd.prototype.runTransaction=function(e){var n=this;return this.uf().transaction(function(t){return e(new dd(n,t))})},Nd.prototype.batch=function(){return this.uf(),new yd(this)},Nd.prototype.sf=function(){return this.df},Nd),dd=(Ad.prototype.get=function(t){var e=this,n=Gd(0,t,this.Af);return this.Rf.b_([n.__]).then(function(t){if(!t||1!==t.length)return kr();if((t=t[0])instanceof nu)return new md(e.Af,n.__,null,!1,!1,n.f_);if(t instanceof eu)return new md(e.Af,n.__,t,!1,!1,n.f_);throw kr()})},Ad.prototype.set=function(t,e,n){return t=Gd(0,t,this.Af),n=tp("Transaction.set",n),e=Bd(t.f_,e,n),n=qp(this.Af.wf,"Transaction.set",t.__,e,null!==t.f_,n),this.Rf.set(t.__,n),this},Ad.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof up?(r=Gd(0,t,this.Af),Gp(this.Af.wf,"Transaction.update",r.__,e,n,i)):(r=Gd(0,t,this.Af),Fp(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,e),this},Ad.prototype.delete=function(t){return t=Gd(0,t,this.Af),this.Rf.delete(t.__),this},Ad),yd=(Td.prototype.set=function(t,e,n){return this.Vf(),t=Gd(0,t,this.Af),n=tp("WriteBatch.set",n),e=Bd(t.f_,e,n),n=qp(this.Af.wf,"WriteBatch.set",t.__,e,null!==t.f_,n),this.Pf=this.Pf.concat(n.d_(t.__,As.ze())),this},Td.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.Vf(),e="string"==typeof e||e instanceof up?(r=Gd(0,t,this.Af),Gp(this.Af.wf,"WriteBatch.update",r.__,e,n,i)):(r=Gd(0,t,this.Af),Fp(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(e.d_(r.__,As.exists(!0))),this},Td.prototype.delete=function(t){return this.Vf(),t=Gd(0,t,this.Af),this.Pf=this.Pf.concat(new zs(t.__,As.ze())),this},Td.prototype.commit=function(){return this.Vf(),this.gf=!0,0<this.Pf.length?this.Af.uf().write(this.Pf):Promise.resolve()},Td.prototype.Vf=function(){if(this.gf)throw new Er(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Td),vd=(n(_d,sd=Ap),_d.mf=function(t,e,n){if(t.length%2!=0)throw new Er(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new _d(new ui(t),e,n)},Object.defineProperty(_d.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"parent",{get:function(){return new Ud(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),_d.prototype.collection=function(t){if(Zl("DocumentReference.collection","path",t),!t)throw new Er(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=ii.q(t),new Ud(this.__.path.child(t),this.firestore,null)},_d.prototype.isEqual=function(t){return t instanceof _d&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},_d.prototype.set=function(t,e){return e=tp("DocumentReference.set",e),t=Bd(this.f_,t,e),e=qp(this.firestore.wf,"DocumentReference.set",this.__,t,null!==this.f_,e),this.lf.write(e.d_(this.__,As.ze()))},_d.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof up?Gp(this.firestore.wf,"DocumentReference.update",this.__,t,e,n):Fp(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(t.d_(this.__,As.exists(!0)))},_d.prototype.delete=function(){return this.lf.write([new zs(this.__,As.ze())])},_d.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||id(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};id(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.yf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(cu(this.__.path),o,s)},_d.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then(function(t){return new md(e.firestore,e.__,t,!0,t instanceof eu&&t.Ye,e.f_)}):n.U_(this.__,t).then(function(t){return e.yf(t)})},_d.prototype.withConverter=function(t){return new _d(this.__,this.firestore,t)},_d.prototype.yf=function(t){var e=t.docs.get(this.__);return new md(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},_d),gd=(Ed.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ed),md=(Id.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new wd(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new ud(this.Af.l_,t.serverTimestamps||"none",function(t){return new vd(t,e.Af,null)},function(t){return new Kr(t)}).J_(this.pf.rn())}},Id.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf&&null!==(t=this.pf.data().field(Xp("DocumentSnapshot.get",t,this.__))))return new ud(this.Af.l_,e.serverTimestamps||"none",function(t){return new vd(t,n.Af,n.f_)},function(t){return new Kr(t)}).J_(t)},Object.defineProperty(Id.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"ref",{get:function(){return new vd(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"metadata",{get:function(){return new gd(this.vf,this.bf)},enumerable:!1,configurable:!0}),Id.prototype.isEqual=function(t){return t instanceof Id&&this.Af===t.Af&&this.bf===t.bf&&this.__.isEqual(t.__)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.f_===t.f_},Id),wd=(n(bd,od=md),bd.prototype.data=function(t){return od.prototype.data.call(this,t)},bd);function bd(){return null!==od&&od.apply(this,arguments)||this}function Id(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}function Ed(t,e){this.hasPendingWrites=t,this.fromCache=e}function _d(t,e,n){var r=this;return(r=sd.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.lf=r.firestore.uf(),r}function Td(t){this.Af=t,this.Pf=[],this.gf=!1}function Ad(t,e){this.Af=t,this.Rf=e}function Nd(t,e,n){var r=this;if(void 0===n&&(n=new fd),this.hf=n,this.cf=null,this.rf=new Ta,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)n=t,this.cf=n,this.l_=Nd._f(n),this.af=n.name,this.ff=new sf(e);else{if(!(t=t).projectId)throw new Er(Ir.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Wr(t.projectId,t.database),this.af="[DEFAULT]",this.ff=new of}this.df=new cd({})}function Sd(){}function Dd(){}function xd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Er(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=vc._o;else{if(t.cacheSizeBytes!==ad&&t.cacheSizeBytes<vc.lo)throw new Er(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+vc.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,ep("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Od(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}function kd(t,e,n){if("string"==typeof n){if(""===n)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ii.q(n)),!ui.X(e))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return To(t,new ui(e))}if(n instanceof Ap)return To(t,n.__);throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+np(n)+".")}function Pd(t,e){if(!Array.isArray(t)||0===t.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ld(t,e,n){if(!n.isEqual(e))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Rd(t){if(fu(t)&&0===t.on.length)throw new Er(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Vd,Cd=(Fd.prototype.where=function(t,e,n){return t=Xp("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new Er(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Pd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(kd(n,t,c))}h={arrayValue:{values:s}}}else h=kd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Pd(o,i),h=Bp(e,"Query.where",o,"in"===i||"not-in"===i);var h=Nu.create(r,i,h);return function(t,e){if(e.un()){var n=pu(t);if(null!==n&&!n.isEqual(e.field))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=lu(t))&&Ld(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Er(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Er(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Sf,this.firestore.wf,this.firestore.l_,t,e,n),new Fd((e=(n=this.Sf).filters.concat([e]),new iu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},Fd.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Er(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Xp("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new ta(e,n),null!==lu(t)||null!==(t=pu(t))&&Ld(0,t,n.field),e}(this.Sf,t,n);return new Fd((t=(n=this.Sf).on.concat([t]),new iu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},Fd.prototype.limit=function(t){return rp("Query.limit",t),new Fd(gu(this.Sf,t,"F"),this.firestore,this.f_)},Fd.prototype.limitToLast=function(t){return rp("Query.limitToLast",t),new Fd(gu(this.Sf,t,"L"),this.firestore,this.f_)},Fd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAt",t,e,!0),new Fd(mu(this.Sf,t),this.firestore,this.f_)},Fd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAfter",t,e,!1),new Fd(mu(this.Sf,t),this.firestore,this.f_)},Fd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endBefore",t,e,!0),new Fd(wu(this.Sf,t),this.firestore,this.f_)},Fd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endAt",t,e,!1),new Fd(wu(this.Sf,t),this.firestore,this.f_)},Fd.prototype.isEqual=function(t){return t instanceof Fd&&this.firestore===t.firestore&&bu(this.Sf,t.Sf)&&this.f_===t.f_},Fd.prototype.withConverter=function(t){return new Fd(this.Sf,this.firestore,t)},Fd.prototype.Df=function(c,t,e,n){return t instanceof md?function(t,e,n,r){if(!n)throw new Er(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(To(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Er(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.B(),new Er(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Ku(i,r)}(this.Sf,this.firestore.l_,t.pf,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Er(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!du(t)&&-1!==c.indexOf("/"))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.q(c));if(!ui.X(h))throw new Er(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ui(h),u.push(To(e,h))}else c=Bp(n,r,c),u.push(c)}return new Ku(u,o)}(this.Sf,this.firestore.l_,this.firestore.wf,c,e,n))},Fd.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||id(n[o])||(i=n[o],o++),id(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Md(e.firestore,e.Sf,t,e.f_))},error:n[o+1],complete:n[o+2]};return Rd(this.Sf),this.firestore.uf().listen(this.Sf,i,s)},Fd.prototype.get=function(t){var e=this;Rd(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then(function(t){return new Md(e.firestore,e.Sf,t,e.f_)})},Fd),Md=(Object.defineProperty(qd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),qd.prototype.forEach=function(e,n){var r=this;this.Nf.docs.forEach(function(t){e.call(n,r.kf(t,r.metadata.fromCache,r.Nf.Qt.has(t.key)))})},Object.defineProperty(qd.prototype,"query",{get:function(){return new Cd(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),qd.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.Nf.jt)throw new Er(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===t||(this.xf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Nf,t,this.kf.bind(this)),this.Ff=t),this.xf},qd.prototype.isEqual=function(t){return t instanceof qd&&this.Af===t.Af&&bu(this.Cf,t.Cf)&&this.Nf.isEqual(t.Nf)&&this.f_===t.f_},qd.prototype.kf=function(t,e,n){return new wd(this.Af,t.key,t,e,n,this.f_)},qd),Ud=(n(jd,Vd=Cd),Object.defineProperty(jd.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new vd(new ui(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),jd.prototype.doc=function(t){return 0===arguments.length&&(t=Lr.t()),Zl("CollectionReference.doc","path",t),t=ii.q(t),vd.mf(this.Sf.path.child(t),this.firestore,this.f_)},jd.prototype.add=function(t){var t=this.f_?this.f_.toFirestore(t):t,e=this.doc();return new vd(e.__,this.firestore,null).set(t).then(function(){return e})},jd.prototype.withConverter=function(t){return new jd(this.Of,this.firestore,t)},jd);function jd(t,e,n){var r=this;if(((r=Vd.call(this,cu(t),e,n)||this).Of=t).length%2!=1)throw new Er(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function qd(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new gd(n.hasPendingWrites,n.fromCache)}function Fd(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}function Gd(t,e,n){if((e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new Er(Ir.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=np(t),new Er(Ir.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,vd)).firestore!==n)throw new Er(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var zd,Hd,be=(n(Wd,zd=_p),Wd.serverTimestamp=function(){var t=new mp("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new Wd(t)},Wd.delete=function(){var t=new hp("deleteField");return t.t_="FieldValue.delete",new Wd(t)},Wd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new Wd(n)},Wd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new Wd(n)},Wd.increment=function(t){return(t=new Ip("increment",t)).t_="FieldValue.increment",new Wd(t)},Wd.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},Wd),Kd={Firestore:pd,GeoPoint:Ep,Timestamp:ni,Blob:Kr,Transaction:dd,WriteBatch:yd,DocumentReference:vd,DocumentSnapshot:md,Query:Cd,QueryDocumentSnapshot:wd,QuerySnapshot:Md,CollectionReference:Ud,FieldPath:up,FieldValue:be,setLogLevel:function(t){Tr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:ad};function Wd(){return null!==zd&&zd.apply(this,arguments)||this}(Hd=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new pd(e,t,new ld);var e},"PUBLIC").setServiceProps(Object.assign({},Kd))),Hd.registerVersion("@firebase/firestore","2.0.0-2020926155854")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});