!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(sy){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(sy),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},D=N||self;function x(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),R=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++R))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){J=J.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=x;var rt,it=Y(W,"Opera"),ot=Y(W,"Trident")||Y(W,"MSIE"),st=Y(W,"Edge"),ut=st||ot,at=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=W,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=D.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",x,e),D.removeEventListener("test",x,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var It={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Ot={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[xt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[xt]=null)):At(t)))}function Rt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Vt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new bt(e,this))}function Mt(t){return(t=t[xt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==O(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function qt(){F.call(this),this.c=new Nt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[Et]=!0,(A=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=D.JSON.stringify;function Bt(){this.b=this.a=null}var zt,Ht=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Wt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Xt(t,e){var n;zt||(n=D.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Yt||(zt(),Yt=!0),Qt.add(t,e)}Bt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function $t(t,e){qt.call(this),this.b=t||1,this.a=e||D,this.f=M(this.Ya,this),this.g=j()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==O(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}q($t,qt),(A=$t.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},A.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(_(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){F.call(this),this.b=t,this.a={}}q(ue,F);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe=null;function de(){return pe=pe||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}q(ye,wt),q(ge,wt),q(we,wt);var Ie={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}_e.prototype.a=null;var Ne,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function xe(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=ke,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Se,wt),q(De,wt),q(xe,_e),Ne=new xe;var ke=45e3,Pe={},Le={};function Re(t,e,n){t.H=1,t.i=en(Ye(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Me(t),t.l=Ye(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,me(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,me(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),qe(t))}function Me(t){t.U=j()+t.P,Ue(t,t.P)}function Ue(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function je(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||rr(t.g,t)}function Fe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Hn(u)}Zn(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(_n(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ke(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Oe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Fe(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Fe(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Fe(this)},A.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Fe(this),this.h=2,qe(this)):Ue(this,this.U-n)},(A=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},A.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Xe(t)}function Qe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Ke(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),H(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var xn=D.JSON.parse;function On(t){qt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}q(On,qt);var kn="",Pn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Un(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.X()))if(t.l&&4==qn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,tn(n=Ye(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Qn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Ye(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=j(),Me(e)),sr(t)}function Hn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Kn(t){Hn(t),t.j&&(D.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Re(n,r,e)}function Qn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;P(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Qn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ye(e)),n.j=null,n.I=!0,Ve(n,t)}function nr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Qe(r,"https"),en(r)),n=r.toString(),r=o,o=new fe,D.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Kn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Qn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function cr(){}function hr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function fr(t,e){qt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(A=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=G(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),On.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},A.Ta=function(){Mn(this)},A.X=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Ye(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Fn(i,this.i,r),_n(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||bn(this.b)||Yn(this))},A.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Hn(this),er(this))},A.Ra=function(){null!=this.m&&(this.m=null,Hn(this),Zn(this),me(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new fr(t,e)},q(fr,qt),(A=fr.prototype).addEventListener=function(t,e,n,r){fr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){fr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Xn(t)},A.close=function(){zn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.S.G.call(this)},q(lr,Se),q(pr,De),q(dr,cr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,fr.prototype.send=fr.prototype.Pa,fr.prototype.open=fr.prototype.Oa,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",qt.prototype.listen=qt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var yr=Ie,vr=Ee,gr=Ae,mr=On,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Nr,Ir=Error),Nr),Tr="8.0.0-2020926155854",Ar=new h("@firebase/firestore");function Nr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Ar.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.DEBUG&&(e=n.map(kr),Ar.debug.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.ERROR&&(e=n.map(kr),Ar.error.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.WARN&&(e=n.map(kr),Ar.warn.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t;throw xr(t),new Error(t)}function Lr(t){t||Pr()}var Rr=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Cr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t){return t+"\0"}var jr=(qr.fromBase64String=function(t){return new qr(atob(t))},qr.fromUint8Array=function(t){return new qr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},qr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},qr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},qr.prototype.o=function(){return 2*this.i.length},qr.prototype.h=function(t){return Cr(this.i,t.i)},qr.prototype.isEqual=function(t){return this.i===t.i},qr);function qr(t){this.i=t}jr.u=new jr("");var Fr=(Gr.fromBase64String=function(t){try{return new Gr(jr.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Gr.fromUint8Array=function(t){return new Gr(jr.fromUint8Array(t))},Gr.prototype.toBase64=function(){return this.l.toBase64()},Gr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Gr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Gr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Gr);function Gr(t){this.l=t}function Br(){if("undefined"==typeof Uint8Array)throw new _r(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function zr(){if("undefined"==typeof atob)throw new _r(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Hr(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var Kr,Wr=(n(Qr,Kr=Fr),Qr.fromBase64String=function(t){zr();try{return new Qr(jr.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Qr.fromUint8Array=function(t){return Br(),new Qr(jr.fromUint8Array(t))},Qr.prototype.toBase64=function(){return zr(),Kr.prototype.toBase64.call(this)},Qr.prototype.toUint8Array=function(){return Br(),Kr.prototype.toUint8Array.call(this)},Qr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Qr),Xr=(Object.defineProperty(Yr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Yr.prototype.isEqual=function(t){return t instanceof Yr&&t.projectId===this.projectId&&t.database===this.database},Yr.prototype.h=function(t){return Cr(this.projectId,t.projectId)||Cr(this.database,t.database)},Yr);function Yr(t,e){this.projectId=t,this.database=e||"(default)"}function Qr(){return null!==Kr&&Kr.apply(this,arguments)||this}function Jr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function $r(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ti,ei,ni=(yi.prototype.get=function(t){var e=this.m(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},yi.prototype.has=function(t){return void 0!==this.get(t)},yi.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},yi.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},yi.prototype.forEach=function(s){$r(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},yi.prototype.P=function(){return Zr(this.R)},yi),ri=(di.now=function(){return di.fromMillis(Date.now())},di.fromDate=function(t){return di.fromMillis(t.getTime())},di.fromMillis=function(t){var e=Math.floor(t/1e3);return new di(e,1e6*(t-1e3*e))},di.prototype.toDate=function(){return new Date(this.toMillis())},di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},di.prototype.g=function(t){return this.seconds===t.seconds?Cr(this.nanoseconds,t.nanoseconds):Cr(this.seconds,t.seconds)},di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},di),ii=(pi.V=function(t){return new pi(t)},pi.min=function(){return new pi(new ri(0,0))},pi.prototype.h=function(t){return this.timestamp.g(t.timestamp)},pi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},pi.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},pi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},pi.prototype.v=function(){return this.timestamp},pi),Ie=(Object.defineProperty(li.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),li.prototype.isEqual=function(t){return 0===li.D(this,t)},li.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof li?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},li.prototype.limit=function(){return this.offset+this.length},li.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},li.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},li.prototype.k=function(){return this.segments[this.offset]},li.prototype.O=function(){return this.get(this.length-1)},li.prototype.get=function(t){return this.segments[this.offset+t]},li.prototype.P=function(){return 0===this.length},li.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},li.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},li.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},li),oi=(n(fi,ei=Ie),fi.prototype.C=function(t,e,n){return new fi(t,e,n)},fi.prototype.B=function(){return this.L().join("/")},fi.prototype.toString=function(){return this.B()},fi.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new fi(n)},fi.U=function(){return new fi([])},fi),si=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ui=(n(hi,ti=Ie),hi.prototype.C=function(t,e,n){return new hi(t,e,n)},hi.K=function(t){return si.test(t)},hi.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),hi.K(t)||(t="`"+t+"`"),t}).join(".")},hi.prototype.toString=function(){return this.B()},hi.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},hi.j=function(){return new hi(["__name__"])},hi.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new hi(e)},hi.U=function(){return new hi([])},hi),ai=(ci.H=function(t){return new ci(oi.q(t))},ci.J=function(t){return new ci(oi.q(t).N(5))},ci.prototype.Y=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ci.prototype.isEqual=function(t){return null!==t&&0===oi.D(this.path,t.path)},ci.prototype.toString=function(){return this.path.toString()},ci.D=function(t,e){return oi.D(t.path,e.path)},ci.X=function(t){return t.length%2==0},ci.Z=function(t){return new ci(new oi(t.slice()))},ci);function ci(t){this.path=t}function hi(){return null!==ti&&ti.apply(this,arguments)||this}function fi(){return null!==ei&&ei.apply(this,arguments)||this}function li(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.S=n}function pi(t){this.timestamp=t}function di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function yi(t,e){this.m=t,this.A=e,this.R={}}function vi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}function mi(t){return"number"==typeof t&&Number.isInteger(t)&&!gi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var wi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function bi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new wi(t,e,n,r,i,o,s)}function Ii(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.B()+t.op.toString()+Io(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.B()+t.dir}).join(","),vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ta(e.startAt)),e.endAt&&(t+="|ub:",t+=ta(e.endAt)),e.tt=t),e.tt}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!na(t.startAt,e.startAt)&&na(t.endAt,e.endAt)}function _i(t){return ai.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ti(t){this.count=t}var Ai,Ni=(Si.prototype.st=function(t){return new Si(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Si.prototype.it=function(t,e){return new Si(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Si.prototype.rt=function(t){return new Si(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Si);function Si(t,e,n,r,i,o,s){void 0===i&&(i=ii.min()),void 0===o&&(o=ii.min()),void 0===s&&(s=jr.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Di(t){switch(t){case Er.OK:return Pr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return Pr(),0}}function xi(t){if(void 0===t)return xr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Ai.OK:return Er.OK;case Ai.CANCELLED:return Er.CANCELLED;case Ai.UNKNOWN:return Er.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return Er.INTERNAL;case Ai.UNAVAILABLE:return Er.UNAVAILABLE;case Ai.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Ai.NOT_FOUND:return Er.NOT_FOUND;case Ai.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Ai.ABORTED:return Er.ABORTED;case Ai.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Ai.DATA_LOSS:return Er.DATA_LOSS;default:return Pr()}}(Ee=Ai=Ai||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Oi=(Vi.prototype.ot=function(t,e){return new Vi(this.D,this.root.ot(t,e,this.D).copy(null,null,Pi.at,null,null))},Vi.prototype.remove=function(t){return new Vi(this.D,this.root.remove(t,this.D).copy(null,null,Pi.at,null,null))},Vi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vi.prototype.P=function(){return this.root.P()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vi.prototype.ht=function(){return this.root.ht()},Vi.prototype.ct=function(){return this.root.ct()},Vi.prototype.ut=function(t){return this.root.ut(t)},Vi.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Vi.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vi.prototype.lt=function(t){return this.root.lt(t)},Vi.prototype._t=function(){return new ki(this.root,null,this.D,!1)},Vi.prototype.ft=function(t){return new ki(this.root,t,this.D,!1)},Vi.prototype.dt=function(){return new ki(this.root,null,this.D,!0)},Vi.prototype.wt=function(t){return new ki(this.root,t,this.D,!0)},Vi),ki=(Ri.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Ri.prototype.At=function(){return 0<this.Tt.length},Ri.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ri),Pi=(Li.prototype.copy=function(t,e,n,r,i){return new Li(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Li.prototype.P=function(){return!1},Li.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},Li.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Li.prototype.min=function(){return this.left.P()?this:this.left.min()},Li.prototype.ht=function(){return this.min().key},Li.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},Li.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Li.prototype.gt=function(){if(this.left.P())return Li.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Li.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.bt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Li.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Li.prototype.Vt=function(){return this.color},Li.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},Li.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Li.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},Li.prototype.St=function(){var t=this.copy(null,null,Li.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Li.prototype.bt=function(){var t=this.copy(null,null,Li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Li.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Li.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Li.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw Pr();if(this.right.Vt())throw Pr();var t=this.left.Nt();if(t!==this.right.Nt())throw Pr();return t+(this.Vt()?0:1)},Li);function Li(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Li.RED,this.left=null!=r?r:Li.EMPTY,this.right=null!=i?i:Li.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Vi(t,e){this.D=t,this.root=e||Pi.EMPTY}function Ci(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.at=!1,Pi.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.ot=function(t,e,n){return new Pi(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype.P=function(){return!0},Ci.prototype.ut=function(t){return!1},Ci.prototype.lt=function(t){return!1},Ci.prototype.ht=function(){return null},Ci.prototype.ct=function(){return null},Ci.prototype.Vt=function(){return!1},Ci.prototype.Ct=function(){return!0},Ci.prototype.Nt=function(){return 0},new Ci);var Mi=(Fi.prototype.has=function(t){return null!==this.data.get(t)},Fi.prototype.first=function(){return this.data.ht()},Fi.prototype.last=function(){return this.data.ct()},Object.defineProperty(Fi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fi.prototype.indexOf=function(t){return this.data.indexOf(t)},Fi.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},Fi.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},Fi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},Fi.prototype.kt=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},Fi.prototype._t=function(){return new Ui(this.data._t())},Fi.prototype.ft=function(t){return new Ui(this.data.ft(t))},Fi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},Fi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fi.prototype.P=function(){return this.data.P()},Fi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fi.prototype.isEqual=function(t){if(!(t instanceof Fi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},Fi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fi.prototype.copy=function(t){var e=new Fi(this.D);return e.data=t,e},Fi),Ui=(qi.prototype.It=function(){return this.Mt.It().key},qi.prototype.At=function(){return this.Mt.At()},qi),ji=new Oi(ai.D);function qi(t){this.Mt=t}function Fi(t){this.D=t,this.data=new Oi(this.D)}var Gi=new Oi(ai.D);var Bi=new Oi(ai.D),zi=new Mi(ai.D);function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ki=new Mi(Cr);var Wi=(co.Bt=function(t){return new co(t.D)},co.prototype.has=function(t){return null!=this.$t.get(t)},co.prototype.get=function(t){return this.$t.get(t)},co.prototype.first=function(){return this.Lt.ht()},co.prototype.last=function(){return this.Lt.ct()},co.prototype.P=function(){return this.Lt.P()},co.prototype.indexOf=function(t){t=this.$t.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.Lt.ut(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.D=this.D,n.$t=t,n.Lt=e,n},co),Xi=(ao.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Pr()},ao.prototype.Ut=function(){var n=[];return this.qt.ut(function(t,e){n.push(e)}),n},ao),Yi=(uo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new uo(t,e,Wi.Bt(e),i,n,r,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&_u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},uo),Qi=(so.Xt=function(t,e){var n=new Map;return n.set(t,Ji.Zt(t,e)),new so(ii.min(),n,Ki,ji,Hi())},so),Ji=(oo.Zt=function(t,e){return new oo(jr.u,e,Hi(),Hi(),Hi())},oo),$i=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Zi=function(t,e){this.targetId=t,this.oe=e},to=function(t,e,n,r){void 0===n&&(n=jr.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},eo=(Object.defineProperty(io.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),io.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ce=t)},io.prototype.we=function(){var n=Hi(),r=Hi(),i=Hi();return this.he.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new Ji(this.ce,this.ue,n,r,i)},io.prototype.Ee=function(){this.le=!1,this.he=fo()},io.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},io.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},io.prototype.me=function(){this.ae+=1},io.prototype.Ae=function(){--this.ae},io.prototype.Re=function(){this.le=!0,this.ue=!0},io),no=(ro.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof iu?this.ve(r,t.re):t.re instanceof ou&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},ro.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:Pr()}})},ro.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},ro.prototype.ke=function(t){var e=t.targetId,n=t.oe.count,t=this.Oe(e);t&&(_i(t=t.target)?0===n?(t=new ai(t.path),this.Se(e,t,new ou(t,ii.min()))):Lr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},ro.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.Oe(e);n&&(t.te&&_i(n.target)&&(n=new ai(n.target.path),null!==i.Ve.get(n)||i.Le(e,n)||i.Se(e,n,new ou(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Hi();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.Oe(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Qi(r,o,this.pe,this.Ve,s);return this.Ve=ji,this.ye=ho(),this.pe=new Mi(Cr),t},ro.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t)))},ro.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n)))},ro.prototype.removeTarget=function(t){this.ge.delete(t)},ro.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},ro.prototype.me=function(t){this.Ne(t).me()},ro.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new eo,this.ge.set(t,e)),e},ro.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Mi(Cr),this.ye=this.ye.ot(t,e)),e},ro.prototype.xe=function(t){var e=null!==this.Oe(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},ro.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},ro.prototype.Fe=function(e){var n=this;this.ge.set(e,new eo),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},ro.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},ro);function ro(t){this.Pe=t,this.ge=new Map,this.Ve=ji,this.ye=ho(),this.pe=new Mi(Cr)}function io(){this.ae=0,this.he=fo(),this.ce=jr.u,this.ue=!1,this.le=!0}function oo(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function so(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}function uo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function ao(){this.qt=new Oi(ai.D)}function co(n){this.D=n?function(t,e){return n(t,e)||ai.D(t.key,e.key)}:function(t,e){return ai.D(t.key,e.key)},this.$t=Gi,this.Lt=new Oi(this.D)}function ho(){return new Oi(ai.D)}function fo(){return new Oi(ai.D)}function lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function po(t){t=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new ri(t.seconds,t.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Pr()}function go(r,i){var t,e=vo(r);if(e!==vo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return po(r).isEqual(po(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Eo(r.timestampValue),t=Eo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,To(r.bytesValue).isEqual(To(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,_o((t=r).geoPointValue.latitude)===_o(e.geoPointValue.latitude)&&_o(t.geoPointValue.longitude)===_o(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return _o(t.integerValue)===_o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=_o(t.doubleValue),e=_o(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],go);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Jr(e)!==Jr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!go(e[t],n[t])))return!1;return!0}();default:return Pr()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,r,i=vo(t),o=vo(e);if(i!==o)return Cr(i,o);switch(i){case 0:return 0;case 1:return Cr(t.booleanValue,e.booleanValue);case 2:return n=e,r=_o(t.integerValue||t.doubleValue),n=_o(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return Cr(t.stringValue,e.stringValue);case 6:return function(t,e){t=To(t),e=To(e);return t.h(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Cr(n[i],r[i]);if(0!==o)return o}return Cr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Cr(_o(i.latitude),_o(r.latitude)))?n:Cr(_o(i.longitude),_o(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wo(n[i],r[i]);if(o)return o}return Cr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Cr(r[s],o[s]);if(0!==u)return u;u=wo(n[r[s]],i[o[s]]);if(0!==u)return u}return Cr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Cr(t,e);var n=Eo(t),t=Eo(e),e=Cr(n.seconds,t.seconds);return 0!==e?e:Cr(n.nanos,t.nanos)}function Io(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Eo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?To(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ai.J(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function Eo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:_o(t.seconds),nanos:_o(t.nanos)};var e=0,n=yo.exec(t);Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function _o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?jr.fromBase64String(t):jr.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function No(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var ko={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this._=t,this.Ke=e};function Ro(t){return{integerValue:""+t}}function Vo(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Co(t,e){return mi(e)?Ro(e):Vo(t,e)}function Mo(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function jo(t){return Lr(!!t),ii.V((t=Eo(t),new ri(t.seconds,t.nanos)))}function qo(t,e){return new oi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function Fo(t){t=oi.q(t);return Lr(os(t)),t}function Go(t,e){return qo(t._,e.path)}function Bo(t,e){e=Fo(e);return Lr(e.get(1)===t._.projectId),Lr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ai(Wo(e))}function zo(t,e){return qo(t._,e)}function Ho(t){t=Fo(t);return 4===t.length?oi.U():Wo(t)}function Ko(t){return new oi(["projects",t._.projectId,"databases",t._.database]).B()}function Wo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Xo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i;if(e instanceof Cs)n={update:Xo(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Go(t,e.key)};else if(e instanceof Ms)n={update:Xo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof cs)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof hs)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.B(),increment:e.We};throw Pr()})}};else{if(!(e instanceof Xs))return Pr();n={verify:Go(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,Mo(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function Qo(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ss.updateTime(jo(o.updateTime)):void 0!==o.exists?Ss.exists(o.exists):Ss.ze():Ss.ze();if(t.update){t.update.name;var r=Bo(e,t.update.name),i=new Ys({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new _s(o.map(function(t){return ui.G(t)})));return new Ms(r,i,o,n)}return new Cs(r,i,n)}if(t.delete){var s=Bo(e,t.delete);return new Ws(s,n)}if(t.transform){i=Bo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),r=new cs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new hs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new ys(n)):"increment"in e?r=new ws(t,e.increment):Pr();e=ui.G(e.fieldPath);return new Ts(e,r)}(e,t)});return Lr(!0===n.exists),new Gs(i,s)}if(t.verify){t=Bo(e,t.verify);return new Xs(t,n)}return Pr()}function Jo(t,e){return{documents:[zo(t,e.path)]}}function $o(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(xo(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NAN"}};if(Do(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,Po[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ns((t=t).field),direction:(t=t.dir,ko[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ke||vi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ts(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ts(e.endAt)),n}function Zo(t){var e=Ho(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[is(t)]:void 0!==t.fieldFilter?[(n=t,xu.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ra(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=vi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=es(n.startAt));var u=null;return n.endAt&&(u=es(n.endAt)),wu(fu(e,i,t,o,r,"F",s,u))}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,t=t.values||[];return new Yu(t,e)}function ns(t){return{fieldPath:t.B()}}function rs(t){return ui.G(t.fieldPath)}function is(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return xu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return xu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=rs(t.unaryFilter.field);return xu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=rs(t.unaryFilter.field);return xu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function os(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.He=void 0};function ss(t,e){return t instanceof ws?No(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var us,as,cs=(n(ls,as=h),ls),hs=(n(fs,us=h),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(n(vs,ds=h),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!go(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(n(bs,ms=h),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).serializer=t,n.We=e,n}function Is(t){return _o(t.integerValue||t.doubleValue)}function Es(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=(As.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},As.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As),Ts=function(t,e){this.field=t,this.transform=e};function As(t){(this.fields=t).sort(ui.D)}function Ns(t,e){this.version=t,this.transformResults=e}var Ss=(Ds.ze=function(){return new Ds},Ds.exists=function(t){return new Ds(void 0,t)},Ds.updateTime=function(t){return new Ds(t)},Object.defineProperty(Ds.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ds.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ds);function Ds(t,e){this.updateTime=t,this.exists=e}function xs(t,e){return void 0!==t.updateTime?e instanceof iu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof iu}Ie=function(){};function Os(t,e,n){return t instanceof Cs?new iu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ms?function(t,e,n){if(!xs(t.Ge,e))return new su(t.key,n.version);e=qs(t,e);return new iu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Lr(null!=n.transformResults),!xs(t.Ge,e))return new su(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof iu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof hs?ps(o,s):o instanceof ys?gs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=zs(t,r.data(),e);return new iu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new ou(t.key,n.version,{hasCommittedMutations:!0})}function ks(t,e,n,r){return t instanceof Cs?function(t,e){if(!xs(t.Ge,e))return e;e=Ls(e);return new iu(t.key,e,t.value,{Ye:!0})}(t,e):t instanceof Ms?function(t,e){if(!xs(t.Ge,e))return e;var n=Ls(e),e=qs(t,e);return new iu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!xs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof iu&&(h=n.field(a.field)),null===h&&r instanceof iu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof cs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof hs?ps(c,i):c instanceof ys?gs(c,i):(c=ss(h=c,i),i=Is(c)+Is(h.We),No(c)&&No(h.We)?Ro(i):Vo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=zs(t,i.data(),r);return new iu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,xs((t=t).Ge,e)?new ou(t.key,ii.min()):e)}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof hs&&e instanceof hs||t instanceof ys&&e instanceof ys?Mr(t.elements,e.elements,go):t instanceof ws&&e instanceof ws?go(t.We,e.We):t instanceof cs&&e instanceof cs)}))}function Ls(t){return t instanceof iu?t.version:ii.min()}var Rs,Vs,Cs=(n(js,Vs=Ie),js),Ms=(n(Us,Rs=Ie),Us);function Us(t,e,n,r){var i=this;return(i=Rs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Vs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function qs(t,e){return n=t,e=e instanceof iu?e.data():Ys.empty(),r=new Qs(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Fs,Gs=(n(Bs,Fs=Ie),Bs);function Bs(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ss.exists(!0),n}function zs(t,e,n){for(var r=new Qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Hs,Ks,Ws=(n(tu,Ks=Ie),tu),Xs=(n(Zs,Hs=Ie),Zs),Ys=($s.empty=function(){return new $s({mapValue:{}})},$s.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},$s.prototype.isEqual=function(t){return go(this.proto,t.proto)},$s),Qs=(Js.prototype.set=function(t,e){return this.en(t,e),this},Js.prototype.delete=function(t){return this.en(t,null),this},Js.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},Js.prototype.Xe=function(){var t=this.nn(ui.U(),this.tn);return null!=t?new Ys(t):this.Ze},Js.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Js);function Js(t){void 0===t&&(t=Ys.empty()),this.Ze=t,this.tn=new Map}function $s(t){this.proto=t}function Zs(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function tu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ge=e,n.type=3,n}var eu,nu,ru,Ee=function(t,e){this.key=t,this.version=e},iu=(n(hu,ru=Ee),hu.prototype.field=function(t){return this.sn.field(t)},hu.prototype.data=function(){return this.sn},hu.prototype.rn=function(){return this.sn.proto},hu.prototype.isEqual=function(t){return t instanceof hu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},hu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu),ou=(n(cu,nu=Ee),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),su=(n(au,eu=Ee),au.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),au.prototype.isEqual=function(t){return t instanceof au&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},au),uu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.hn=null,this.cn=null,this.startAt,this.endAt};function au(){return null!==eu&&eu.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=nu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function hu(t,e,n,r){var i=this;return(i=ru.call(this,t,e)||this).sn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fu(t,e,n,r,i,o,s,u){return new uu(t,e,n,r,i,o,s,u)}function lu(t){return new uu(t)}function pu(t){return!vi(t.limit)&&"F"===t.an}function du(t){return!vi(t.limit)&&"L"===t.an}function yu(t){return 0<t.on.length?t.on[0].field:null}function vu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function gu(t){return null!==t.collectionGroup}function mu(t){var e=t;if(null===e.hn){e.hn=[];var n=vu(e),t=yu(e);if(null!==n&&null===t)n.W()||e.hn.push(new ra(n)),e.hn.push(new ra(ui.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.hn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.hn.push(new ra(ui.j(),n)))}}return e.hn}function wu(t){var e=t;if(!e.cn)if("F"===e.an)e.cn=bi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ra(o.field,s))}var u=e.endAt?new Yu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Yu(e.startAt.position,!e.startAt.before):null;e.cn=bi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function bu(t,e,n){return new uu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Iu(t,e){return new uu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Eu(t,e){return new uu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function _u(t,e){return Ei(wu(t),wu(e))&&t.an===e.an}function Tu(t){return Ii(wu(t))+"|lt:"+t.an}function Au(t){return"Query(target="+(e=wu(t),n=e.path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.B()+" "+t.op+" "+Io(t.value)}).join(", ")+"]"),vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ta(e.startAt)),e.endAt&&(n+=", endAt: "+ta(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Nu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Y(e.collectionGroup)&&e.path.M(n):ai.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ea(t.startAt,mu(t),n))&&(!t.endAt||!ea(t.endAt,mu(t),n)));var e,n}function Su(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?ai.D(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?wo(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Du,xu=(n(Ou,Du=function(){}),Ou.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Ru(t,e,n):"array-contains"===e?new Hu(t,n):"in"===e?new Ku(t,n):"not-in"===e?new Wu(t,n):"array-contains-any"===e?new Xu(t,n):new Ou(t,e,n)},Ou.ln=function(t,e,n){return new("in"===e?Vu:Cu)(t,n)},Ou.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(wo(t,this.value)):null!==t&&vo(this.value)===vo(t)&&this._n(wo(t,this.value))},Ou.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Ou.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ou);function Ou(t,e,n){var r=this;return(r=Du.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,Pu,Lu,Ru=(n(ju,Lu=xu),ju.prototype.matches=function(t){t=ai.D(t.key,this.key);return this._n(t)},ju),Vu=(n(Uu,Pu=xu),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Cu=(n(Mu,ku=xu),Mu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Mu);function Mu(t,e){var n=this;return(n=ku.call(this,t,"not-in",e)||this).keys=qu(0,e),n}function Uu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=qu(0,e),n}function ju(t,e,n){var r=this;return(r=Lu.call(this,t,e,n)||this).key=ai.J(n.referenceValue),r}function qu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ai.J(t.referenceValue)})}var Fu,Gu,Bu,zu,Hu=(n(Zu,zu=xu),Zu.prototype.matches=function(t){t=t.field(this.field);return So(t)&&mo(t.arrayValue,this.value)},Zu),Ku=(n($u,Bu=xu),$u.prototype.matches=function(t){t=t.field(this.field);return null!==t&&mo(this.value.arrayValue,t)},$u),Wu=(n(Ju,Gu=xu),Ju.prototype.matches=function(t){if(mo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!mo(this.value.arrayValue,t)},Ju),Xu=(n(Qu,Fu=xu),Qu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!So(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Qu),Yu=function(t,e){this.position=t,this.before=e};function Qu(t,e){return Fu.call(this,t,"array-contains-any",e)||this}function Ju(t,e){return Gu.call(this,t,"not-in",e)||this}function $u(t,e){return Bu.call(this,t,"in",e)||this}function Zu(t,e){return zu.call(this,t,"array-contains",e)||this}function ta(t){return(t.before?"b":"a")+":"+t.position.map(Io).join(",")}function ea(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ai.D(ai.J(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function na(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ia(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var oa,sa=(ya.prototype.reset=function(){this.In=0},ya.prototype.Rn=function(){this.In=this.Tn},ya.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},ya.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},ya.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},ya.prototype.gn=function(){return(Math.random()-.5)*this.In},ya),ua=(da.prototype.catch=function(t){return this.next(void 0,t)},da.prototype.next=function(r,i){var o=this;return this.Dn&&Pr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new da(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},da.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},da.prototype.Fn=function(t){try{var e=t();return e instanceof da?e:da.resolve(e)}catch(t){return da.reject(t)}},da.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):da.resolve(e)},da.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):da.reject(e)},da.resolve=function(n){return new da(function(t,e){t(n)})},da.reject=function(n){return new da(function(t,e){e(n)})},da.kn=function(t){return new da(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},da.On=function(t){for(var n=da.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?da.resolve(t):e()})}(r[e]);return n},da.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.kn(i)},da),aa=(pa.delete=function(t){return Dr("SimpleDb","Removing database:",t),Ia(window.indexedDB.deleteDatabase(t)).xn()},pa.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(pa.Bn())return!0;var t=p(),e=pa.$n(t),n=0<e&&e<10,e=pa.qn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},pa.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},pa.Kn=function(t,e){return t.store(e)},pa.$n=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},pa.qn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},pa.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ha(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new _r(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ha(o,t))},r.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Dr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},pa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},pa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=ga.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ua.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Dr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},pa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},pa),ca=(Object.defineProperty(la.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(la.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(la.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),la.prototype.done=function(){this.Hn=!0},la.prototype.Xn=function(t){this.Jn=t},la.prototype.delete=function(){return Ia(this.zn.delete())},la),ha=(n(fa,oa=_r),fa);function fa(t,e){var n=this;return(n=oa.call(this,Er.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function la(t){this.zn=t,this.Hn=!1,this.Jn=null}function pa(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===pa.$n(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function da(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function ya(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function va(t){return"IndexedDbTransactionError"===t.name}var ga=(ba.open=function(t,e,n,r){try{return new ba(e,t.transaction(r,n))}catch(t){throw new ha(e,t)}},Object.defineProperty(ba.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),ba.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ba.prototype.store=function(t){t=this.transaction.objectStore(t);return new ma(t)},ba),ma=(wa.prototype.put=function(t,e){t=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ia(t)},wa.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Ia(this.store.add(t))},wa.prototype.get=function(e){var n=this;return Ia(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},wa.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Ia(this.store.delete(t))},wa.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Ia(this.store.count())},wa.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},wa.prototype.ns=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.ss=!1;e=this.cursor(e);return this.es(e,function(t,e,n){return n.delete()})},wa.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},wa.prototype.os=function(r){var t=this.cursor({});return new ua(function(n,e){t.onerror=function(t){t=_a(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},wa.prototype.es=function(t,i){var o=[];return new ua(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new ca(n),(t=i(n.primaryKey,n.value,e))instanceof ua&&(t=t.catch(function(t){return e.done(),ua.reject(t)}),o.push(t)),e.Sn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return ua.kn(o)})},wa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},wa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},wa);function wa(t){this.store=t}function ba(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ia,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new ha(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=_a(t.target.error);n.Zn.reject(new ha(e,t))}}function Ia(t){return new ua(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=_a(t.target.error);n(t)}})}var Ea=!1;function _a(t){var e=aa.$n(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ea||(Ea=!0,setTimeout(function(){throw n},0)),n}}return t}function Ta(){return"undefined"!=typeof window?window:null}function Aa(){return"undefined"!=typeof document?document:null}var Na=(xa._s=function(t,e,n,r,i){i=new xa(t,e,Date.now()+n,r,i);return i.start(n),i},xa.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},xa.prototype.pn=function(){return this.ds()},xa.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new _r(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},xa.prototype.ds=function(){var e=this;this.hs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},xa.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},xa),Sa=(Object.defineProperty(Da.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Da.prototype.ws=function(t){this.enqueue(t)},Da.prototype.bs=function(t){this.vs(),this.Ss(t)},Da.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=Aa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Da.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Da.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Da.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!va(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.Vs.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Da.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Da.prototype.Vn=function(t,e,n){var r=this;this.vs(),-1<this.gs.indexOf(t)&&(e=0);n=Na._s(this,t,e,n,function(t){return r.xs(t)});return this.As.push(n),n},Da.prototype.vs=function(){this.Rs&&Pr()},Da.prototype.Fs=function(){},Da.prototype.ks=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Da.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Da.prototype.Ms=function(r){var i=this;return this.ks().then(function(){i.As.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.ks()})},Da.prototype.$s=function(t){this.gs.push(t)},Da.prototype.xs=function(t){t=this.As.indexOf(t);this.As.splice(t,1)},Da);function Da(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new sa(this,"async_queue_retry"),this.ys=function(){var t=Aa();t&&Dr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Vs.yn()};var t=Aa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function xa(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new ia,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Oa(t,e){if(xr("AsyncQueue",e+": "+t),va(t))return new _r(Er.UNAVAILABLE,e+": "+t);throw t}function ka(){this.Ls=void 0,this.listeners=[]}function Pa(){this.Bs=new ni(Tu,_u),this.onlineState="Unknown",this.qs=new Set}function La(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new ka),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=t.sent(),o=Oa(o,"Initialization of query '"+Au(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Va(e),[2]}})})}function Ra(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Va(t){t.qs.forEach(function(t){t.next()})}var Ca=(ja.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Yi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},ja.prototype.onError=function(t){this.js.error(t)},ja.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},ja.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},ja.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},ja.prototype.Ys=function(t){t=Yi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},ja),Ma=(Ua.prototype.Zs=function(){return null!=this.uid},Ua.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Ua.prototype.isEqual=function(t){return t.uid===this.uid},Ua);function Ua(t){this.uid=t}function ja(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}Ma.UNAUTHENTICATED=new Ma(null),Ma.ei=new Ma("google-credentials-uid"),Ma.ni=new Ma("first-party-uid");var qa=(Fa.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Fa.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},Fa);function Fa(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function Ga(t,e){return"firestore_clients_"+t+"_"+e}function Ba(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Zs()&&(n+="_"+e.uid),n}function za(t,e){return"firestore_targets_"+t+"_"+e}qa.ai=-1;var Ha=(yc.hi=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new yc(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},yc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},yc),Ka=(dc.hi=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new dc(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},dc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},dc),Wa=(pc.hi=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki,o=0;r&&o<n.activeTargetIds.length;++o)r=mi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new pc(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},pc),Xa=(lc.hi=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new lc(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},lc),Ya=(fc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},fc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},fc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},fc),Qa=(hc.Ln=function(t){return!(!t||!t.localStorage)},hc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(Ga(this.persistenceKey,r)))&&(o=Wa.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.yi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.Ei(h);return this.mi=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ii=!0,[2]}})})},hc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},hc.prototype.Ci=function(){return this.Ni(this.Ti)},hc.prototype.xi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},hc.prototype.Fi=function(t){this.ki(t,"pending")},hc.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},hc.prototype.$i=function(t){var e,n="not-current";return this.xi(t)&&(!(e=this.storage.getItem(za(this.persistenceKey,t)))||(e=Ka.hi(t,e))&&(n=e.state)),this.Li.ui(t),this.bi(),n},hc.prototype.Bi=function(t){this.Li.li(t),this.bi()},hc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},hc.prototype.Ui=function(t){this.removeItem(za(this.persistenceKey,t))},hc.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},hc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},hc.prototype.ji=function(t){this.Gi(t)},hc.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},hc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},hc.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},hc.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},hc.prototype.Ei=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Dr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ii){if(null!==s.key)if(this.Pi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Ji(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(s.key)){if(null!==s.newValue&&(n=this.Yi(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.Vi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.yi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=qa.ai;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==qa.ai&&this.si(o)}else this.mi.push(s);return[2]})})})}},Object.defineProperty(hc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),hc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},hc.prototype.ki=function(t,e,n){n=new Ha(this.currentUser,t,e,n),t=Ba(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ci())},hc.prototype.Mi=function(t){t=Ba(this.persistenceKey,this.currentUser,t);this.removeItem(t)},hc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(t))},hc.prototype.Qi=function(t,e,n){var r=za(this.persistenceKey,t),n=new Ka(t,e,n);this.setItem(r,n.ci())},hc.prototype.zi=function(t){t=this.Pi.exec(t);return t?t[1]:null},hc.prototype.Ji=function(t,e){t=this.zi(t);return Wa.hi(t,e)},hc.prototype.Yi=function(t,e){var n=this.gi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Ha.hi(new Ma(n),t,e)},hc.prototype.Zi=function(t,e){t=this.Vi.exec(t),t=Number(t[1]);return Ka.hi(t,e)},hc.prototype.vi=function(t){return Xa.hi(t)},hc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},hc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},hc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},hc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},hc.prototype.Ni=function(t){var n=Ki;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},hc),Ja=(cc.prototype.Fi=function(t){},cc.prototype.Oi=function(t,e,n){},cc.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},cc.prototype.Ki=function(t,e,n){this.rr[t]=e},cc.prototype.Bi=function(t){this.ir.li(t)},cc.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},cc.prototype.Ui=function(t){delete this.rr[t]},cc.prototype.Ci=function(){return this.ir.activeTargetIds},cc.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},cc.prototype.start=function(){return this.ir=new Ya,Promise.resolve()},cc.prototype.Wi=function(t,e,n){},cc.prototype.ji=function(t){},cc.prototype.Di=function(){},cc.prototype.oi=function(t){},cc),$a=(ac.prototype.hr=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Os(o,e,r[i]))}return e},ac.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ks(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ks(a,e,o,this.ar))}return e},ac.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},ac.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Hi())},ac.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Ps)&&Mr(this.baseMutations,t.baseMutations,Ps)},ac),Za=(uc.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new uc(t,e,n,r)},uc),h=(Object.defineProperty(sc.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),sc.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},sc.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},sc.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?ua.resolve(n):this.Pr(t,e)},sc.prototype.getEntries=function(t,e){return this.gr(t,e)},sc.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},sc.prototype.mr=function(){},sc),tc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(oc.prototype.pr=function(t){this.yr.push(t)},oc.prototype.br=function(){this.yr.forEach(function(t){return t()})},oc),ec=(ic.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},ic.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},ic.prototype.kr=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.ot(t,e)}),o},ic.prototype.Or=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},ic.prototype.Mr=function(e,r){var i=this;return this.Sr.$r(e,r).next(function(t){var t=i.kr(e,r,t),n=ji;return t.forEach(function(t,e){e=e||new ou(t,ii.min()),n=n.ot(t,e)}),n})},ic.prototype.Lr=function(t,e,n){return r=e,ai.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):gu(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},ic.prototype.Br=function(t,e){return this.Cr(t,new ai(e)).next(function(t){var e=Gi;return t instanceof iu&&(e=e.ot(t.key,t)),e})},ic.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=Gi;return this.Dr.Kr(n,s).next(function(t){return ua.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new uu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},ic.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Qr(e,n)}).next(function(t){return h=t,r.Wr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=ks(s,a,a,r.ar);c=a instanceof iu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Nu(n,e)||(c=c.remove(t))}),c})},ic.prototype.Wr=function(t,e,n){for(var r=Hi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof iu&&(c=c.ot(t,e))}),c})},ic),nc=(rc.zr=function(t,e){for(var n=Hi(),r=Hi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new rc(t,e.fromCache,n,r)},rc);function rc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}function ic(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function oc(){this.yr=[]}function sc(){this.wr=new ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Er=!1}function uc(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}function ac(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function cc(){this.ir=new Ya,this.rr={},this.di=null,this.si=null}function hc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new Oi(Cr),this.Ii=!1,this.mi=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=Ga(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new Ya),this.Pi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function fc(){this.activeTargetIds=Ki}function lc(t,e){this.clientId=t,this.onlineState=e}function pc(t,e){this.clientId=t,this.activeTargetIds=e}function dc(t,e,n){this.targetId=t,this.state=e,this.error=n}function yc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function vc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Cr(n,t);return 0===t?Cr(r,e):t}var gc=(Ic.prototype.Yr=function(){return++this.Jr},Ic.prototype.Xr=function(t){var e=[t,this.Yr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):vc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Ic.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Ic),mc={Zr:!1,eo:0,no:0,so:0},wc=(bc.ao=function(t){return new bc(t,bc.ho,bc.co)},bc);function bc(t,e,n){this.io=t,this.ro=e,this.oo=n}function Ic(t){this.Hr=t,this.buffer=new Mi(vc),this.Jr=0}wc.uo=-1,wc.lo=1048576,wc._o=41943040,wc.ho=10,wc.co=1e3,wc.fo=new wc(wc._o,wc.ho,wc.co),wc.do=new wc(wc.uo,0,0);var Ec=(Ac.prototype.start=function(t){this.wo.params.io!==wc.uo&&this.Io(t)},Ac.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(Ac.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),Ac.prototype.Io=function(n){var t=this,e=this.Eo?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.hs.Vn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.Eo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mo(this.wo)];case 2:return t.sent(),[3,7];case 3:return va(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,rf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Io(n)];case 8:return t.sent(),[2]}})})})},Ac),_c=(Tc.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},Tc.prototype.Vo=function(t,e){var n=this;if(0===e)return ua.resolve(qa.ai);var r=new gc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.yo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},Tc.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},Tc.prototype.bo=function(t,e){return this.Ao.bo(t,e)},Tc.prototype.vo=function(e,n){var r=this;return this.params.io===wc.uo?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),ua.resolve(mc)):this.So(e).next(function(t){return t<r.params.io?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),mc):r.Do(e,n)})},Tc.prototype.So=function(t){return this.Ao.So(t)},Tc.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.Vo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ua.resolve({Zr:!0,eo:i,no:o,so:t})})},Tc);function Tc(t,e){this.Ao=t,this.params=e}function Ac(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}function Nc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Sc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Sc(e)}function Sc(t){return t+"\x01\x01"}function Dc(t){var e=t.length;if(Lr(2<=e),2===e)return Lr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),oi.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new oi(r)}var xc=function(t){this.Co=t};function Oc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=Bo(n,r.name),n=jo(r.updateTime),r=new Ys({mapValue:{fields:r.fields}}),new iu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ai.Z(e.noDocument.path),o=Vc(e.noDocument.readTime);return new ou(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=ai.Z(e.unknownDocument.path),e=Vc(e.unknownDocument.version);return new su(o,e)}return Pr()}function kc(t,e,n){var r=Pc(n),n=e.key.path.F().L();if(e instanceof iu){var i={name:Go(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Mo(i,o.version.v())},o=e.hasCommittedMutations;return new yh(null,null,i,o,r,n)}if(e instanceof ou){var i=e.key.path.L(),o=Rc(e.version),s=e.hasCommittedMutations;return new yh(null,new ph(i,o),null,s,r,n)}if(e instanceof su){s=e.key.path.L(),e=Rc(e.version);return new yh(new dh(s,e),null,null,!0,r,n)}return Pr()}function Pc(t){t=t.v();return[t.seconds,t.nanoseconds]}function Lc(t){t=new ri(t[0],t[1]);return ii.V(t)}function Rc(t){t=t.v();return new ih(t.seconds,t.nanoseconds)}function Vc(t){t=new ri(t.seconds,t.nanoseconds);return ii.V(t)}function Cc(e,t){var n=(t.baseMutations||[]).map(function(t){return Qo(e.Co,t)}),r=t.mutations.map(function(t){return Qo(e.Co,t)}),i=ri.fromMillis(t.localWriteTimeMs);return new $a(t.batchId,i,n,r)}function Mc(t){var e=Vc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Vc(t.lastLimboFreeSnapshotVersion):ii.min(),r=void 0!==t.query.documents?(Lr(1===(r=t.query).documents.length),wu(lu(Ho(r.documents[0])))):Zo(t.query);return new Ni(r,t.targetId,0,t.lastListenSequenceNumber,e,n,jr.fromBase64String(t.resumeToken))}function Uc(t,e){var n=Rc(e.nt),r=Rc(e.lastLimboFreeSnapshotVersion),i=(_i(e.target)?Jo:$o)(t.Co,e.target),t=e.resumeToken.toBase64();return new gh(e.targetId,Ii(e.target),n,t,e.sequenceNumber,r,i)}var jc=(qc.Fo=function(t,e,n,r){return Lr(""!==t.uid),new qc(t.Zs()?t.uid:"",e,n,r)},qc.prototype.ko=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Bc(t).rs({index:hh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},qc.prototype.Oo=function(d,y,v,g){var m=this,w=zc(d),b=Bc(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new $a(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Yo(e.Co,t)}),o=r.mutations.map(function(t){return Yo(e.Co,t)}),new hh(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new Mi(function(t,e){return Cr(t.B(),e.B())}),h=0,f=g;h<f.length;h++){var l=f[h],p=fh.key(m.userId,l.key.path,t),c=c.add(l.key.path.F());a.push(b.put(u)),a.push(w.put(p,fh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.xo[t]=s.keys()}),ua.kn(a).next(function(){return s})})},qc.prototype.$o=function(t,e){var n=this;return Bc(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),Cc(n.serializer,t)):null})},qc.prototype.Lo=function(t,e){var n=this;return this.xo[e]?ua.resolve(this.xo[e]):this.$o(t,e).next(function(t){if(t){t=t.keys();return n.xo[e]=t}return null})},qc.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Bc(t).rs({index:hh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=Cc(r.serializer,e)),n.done()}).next(function(){return o})},qc.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Bc(t).rs({index:hh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},qc.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Bc(t).ts(hh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Cc(e.serializer,t)})})},qc.prototype.Nr=function(o,s){var u=this,t=fh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return zc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Dc(i);if(r===u.userId&&s.path.isEqual(i))return Bc(o).get(t).next(function(t){if(!t)throw Pr();Lr(t.userId===u.userId),a.push(Cc(u.serializer,t))});n.done()}).next(function(){return a})},qc.prototype.$r=function(e,t){var s=this,u=new Mi(Cr),n=[];return t.forEach(function(o){var t=fh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=zc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Dc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ua.kn(n).next(function(){return s.Ko(e,u)})},qc.prototype.Qr=function(t,e){var o=this,s=e.path,u=s.length+1,e=fh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Mi(Cr);return zc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Dc(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ko(t,a)})},qc.prototype.Ko=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Bc(e).get(t).next(function(t){if(null===t)throw Pr();Lr(t.userId===n.userId),r.push(Cc(n.serializer,t))}))}),ua.kn(i).next(function(){return r})},qc.prototype.Qo=function(e,n){var r=this;return Gc(e.Wo,this.userId,n).next(function(t){return e.pr(function(){r.jo(n.batchId)}),ua.forEach(t,function(t){return r.No.Go(e,t)})})},qc.prototype.jo=function(t){delete this.xo[t]},qc.prototype.zo=function(e){var i=this;return this.ko(e).next(function(t){if(!t)return ua.resolve();var t=IDBKeyRange.lowerBound(fh.prefixForUser(i.userId)),r=[];return zc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Dc(t[1]),r.push(t)):n.done()}).next(function(){Lr(0===r.length)})})},qc.prototype.Ho=function(t,e){return Fc(t,this.userId,e)},qc.prototype.Jo=function(t){var e=this;return Hc(t).get(this.userId).next(function(t){return t||new ch(e.userId,-1,"")})},qc);function qc(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}function Fc(t,o,e){var e=fh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return zc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Gc(t,e,n){var r=t.store(hh.store),i=t.store(fh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Lr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=fh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ua.kn(o).next(function(){return u})}function Bc(t){return Mh.Kn(t,hh.store)}function zc(t){return Mh.Kn(t,fh.store)}function Hc(t){return Mh.Kn(t,ch.store)}var Kc,Wc=(Qc.prototype.Ir=function(t,e,n){return $c(t).put(Zc(e),n)},Qc.prototype.Ar=function(t,e){t=$c(t),e=Zc(e);return t.delete(e)},Qc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Qc.prototype.Rr=function(t,e){var n=this;return $c(t).get(Zc(e)).next(function(t){return n.Xo(t)})},Qc.prototype.Zo=function(t,e){var n=this;return $c(t).get(Zc(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:th(t)}:null})},Qc.prototype.getEntries=function(t,e){var n=this,r=ji;return this.ea(t,e,function(t,e){e=n.Xo(e);r=r.ot(t,e)}).next(function(){return r})},Qc.prototype.na=function(t,e){var r=this,i=ji,o=new Oi(ai.D);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,th(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},Qc.prototype.ea=function(t,e,i){if(e.P())return ua.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return $c(t).rs({range:n},function(t,e,n){for(var r=ai.Z(t);s&&ai.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Qc.prototype.Lr=function(t,r,e){var n,i=this,o=Gi,s=r.path.length+1,u={};return e.isEqual(ii.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=Pc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=yh.collectionReadTimeIndex),$c(t).rs(u,function(t,e,n){t.length===s&&(e=Oc(i.serializer,e),r.path.M(e.key.path)?e instanceof iu&&Nu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Qc.prototype.ra=function(t){return new Xc(this,!!t&&t.oa)},Qc.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Qc.prototype.getMetadata=function(t){return Jc(t).get(vh.key).next(function(t){return Lr(!!t),t})},Qc.prototype.Yo=function(t,e){return Jc(t).put(vh.key,e)},Qc.prototype.Xo=function(t){if(t){t=Oc(this.serializer,t);return t instanceof ou&&t.version.isEqual(ii.min())?null:t}return null},Qc),Xc=(n(Yc,Kc=h),Yc.prototype.Vr=function(i){var o=this,s=[],u=0,a=new Mi(function(t,e){return Cr(t.B(),e.B())});return this.wr.forEach(function(t,e){var n,r=o.ca.get(t);e?(n=kc(o.ha.serializer,e,o.readTime),a=a.add(t.path.F()),e=th(n),u+=e-r,s.push(o.ha.Ir(i,t,n))):(u-=r,o.oa?(r=kc(o.ha.serializer,new ou(t,ii.min()),o.readTime),s.push(o.ha.Ir(i,t,r))):s.push(o.ha.Ar(i,t)))}),a.forEach(function(t){s.push(o.ha.Dr.Mo(i,t))}),s.push(this.ha.updateMetadata(i,u)),ua.kn(s)},Yc.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)})},Yc.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ca.set(t,e)}),e})},Yc);function Yc(t,e){var n=this;return(n=Kc.call(this)||this).ha=t,n.oa=e,n.ca=new ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Qc(t,e){this.serializer=t,this.Dr=e}function Jc(t){return Mh.Kn(t,vh.store)}function $c(t){return Mh.Kn(t,yh.store)}function Zc(t){return t.path.L()}function th(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}var eh=(ah.prototype.Mo=function(t,e){return this.ua.add(e),ua.resolve()},ah.prototype.Kr=function(t,e){return ua.resolve(this.ua.getEntries(e))},ah),nh=(uh.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Mi(oi.D),t=!r.has(n);return this.index[e]=r.add(n),t},uh.prototype.has=function(t){var e=t.O(),t=t.F(),e=this.index[e];return e&&e.has(t)},uh.prototype.getEntries=function(t){return(this.index[t]||new Mi(oi.D)).L()},uh),rh=(sh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Lr(t<r&&0<=t&&r<=10);var o=new ga("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(oh.store),(s=e).createObjectStore(ch.store,{keyPath:ch.keyPath}),s.createObjectStore(hh.store,{keyPath:hh.keyPath,autoIncrement:!0}).createIndex(hh.userMutationsIndex,hh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(fh.store),Ih(e),e.createObjectStore(yh.store));var s,u=ua.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(mh.store),s.deleteObjectStore(gh.store),s.deleteObjectStore(wh.store),Ih(e)),u=u.next(function(){return t=o.store(wh.store),e=new wh(0,0,ii.min().v(),0),t.put(wh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(hh.store).ts().next(function(t){n.deleteObjectStore(hh.store),n.createObjectStore(hh.store,{keyPath:hh.keyPath,autoIncrement:!0}).createIndex(hh.userMutationsIndex,hh.userMutationsKeyPath,{unique:!0});var e=r.store(hh.store),t=t.map(function(t){return e.put(t)});return ua.kn(t)});var n,r})),u=u.next(function(){e.createObjectStore(Eh.store,{keyPath:Eh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(vh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(yh.store)).createIndex(yh.readTimeIndex,yh.readTimeIndexPath,{unique:!1}),t.createIndex(yh.collectionReadTimeIndex,yh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},sh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(yh.store).rs(function(t,e){n+=th(e)}).next(function(){var t=new vh(n);return e.store(vh.store).put(vh.key,t)})},sh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(ch.store),i=n.store(hh.store);return t.ts().next(function(t){return ua.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(hh.userMutationsIndex,t).next(function(t){return ua.forEach(t,function(t){Lr(t.userId===e.userId);t=Cc(r.serializer,t);return Gc(n,e.userId,t).next(function(){})})})})})},sh.prototype.ensureSequenceNumbers=function(t){var o=t.store(mh.store),e=t.store(yh.store);return t.store(wh.store).get(wh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new oi(t),t=[0,Nc(n)];i.push(o.get(t).next(function(t){return t?ua.resolve():o.put(new mh(0,Nc(n),r.highestListenSequenceNumber))}))}).next(function(){return ua.kn(i)})})},sh.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(bh.store,{keyPath:bh.keyPath});function r(t){if(i.add(t)){var e=t.O(),t=t.F();return n.put({collectionId:e,parent:Nc(t)})}}var n=e.store(bh.store),i=new nh;return e.store(yh.store).rs({ss:!0},function(t,e){t=new oi(t);return r(t.F())}).next(function(){return e.store(fh.store).rs({ss:!0},function(t,e){t[0];var n=t[1],n=(t[2],Dc(n));return r(n.F())})})},sh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(gh.store);return r.rs(function(t,e){e=Mc(e),e=Uc(n.serializer,e);return r.put(e)})},sh),ih=function(t,e){this.seconds=t,this.nanoseconds=e},oh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function sh(t){this.serializer=t}function uh(){this.index={}}function ah(){this.ua=new nh}oh.store="owner",oh.key="owner";var ch=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ch.store="mutationQueues",ch.keyPath="userId";var hh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};hh.store="mutations",hh.keyPath="batchId",hh.userMutationsIndex="userMutationsIndex",hh.userMutationsKeyPath=["userId","batchId"];var fh=(lh.prefixForUser=function(t){return[t]},lh.prefixForPath=function(t,e){return[t,Nc(e)]},lh.key=function(t,e,n){return[t,Nc(e),n]},lh);function lh(){}fh.store="documentMutations",fh.PLACEHOLDER=new fh;var ph=function(t,e){this.path=t,this.readTime=e},dh=function(t,e){this.path=t,this.version=e},yh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};yh.store="remoteDocuments",yh.readTimeIndex="readTimeIndex",yh.readTimeIndexPath="readTime",yh.collectionReadTimeIndex="collectionReadTimeIndex",yh.collectionReadTimeIndexPath=["parentPath","readTime"];var vh=function(t){this.byteSize=t};vh.store="remoteDocumentGlobal",vh.key="remoteDocumentGlobalKey";var gh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};gh.store="targets",gh.keyPath="targetId",gh.queryTargetsIndexName="queryTargetsIndex",gh.queryTargetsKeyPath=["canonicalId","targetId"];var mh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};mh.store="targetDocuments",mh.keyPath=["targetId","path"],mh.documentTargetsIndex="documentTargetsIndex",mh.documentTargetsKeyPath=["path","targetId"];var wh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};wh.key="targetGlobalKey",wh.store="targetGlobal";var bh=function(t,e){this.collectionId=t,this.parent=e};function Ih(t){t.createObjectStore(mh.store,{keyPath:mh.keyPath}).createIndex(mh.documentTargetsIndex,mh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(gh.store,{keyPath:gh.keyPath}).createIndex(gh.queryTargetsIndexName,gh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(wh.store)}bh.store="collectionParents",bh.keyPath=["collectionId","parent"];var Eh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Eh.store="clientMetadata",Eh.keyPath="clientId";var _h=i(i(i([ch.store,hh.store,fh.store,yh.store,gh.store,oh.store,wh.store,mh.store],[Eh.store]),[vh.store]),[bh.store]),Th=(Ah.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return ua.resolve();var r=e.O(),i=e.F();t.pr(function(){n.la.add(e)});i={collectionId:r,parent:Nc(i)};return Nh(t).put(i)},Ah.prototype.Kr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ur(i),""],!1,!0);return Nh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Dc(r.parent))}return o})},Ah);function Ah(){this.la=new nh}function Nh(t){return Mh.Kn(t,bh.store)}var Sh=(Oh.prototype.next=function(){return this._a+=2,this._a},Oh.fa=function(){return new Oh(0)},Oh.da=function(){return new Oh(-1)},Oh),Dh=(xh.prototype.wa=function(n){var r=this;return this.Ea(n).next(function(t){var e=new Sh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},xh.prototype.Ia=function(t){return this.Ea(t).next(function(t){return ii.V(new ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},xh.prototype.ma=function(t){return this.Ea(t).next(function(t){return t.highestListenSequenceNumber})},xh.prototype.Aa=function(e,n,r){var i=this;return this.Ea(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},xh.prototype.Ra=function(e,n){var r=this;return this.Pa(e,n).next(function(){return r.Ea(e).next(function(t){return t.targetCount+=1,r.ga(n,t),r.Ta(e,t)})})},xh.prototype.Va=function(t,e){return this.Pa(t,e)},xh.prototype.ya=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return kh(e).delete(t.targetId)}).next(function(){return n.Ea(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},xh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return kh(n).rs(function(t,e){e=Mc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ya(n,e)))}).next(function(){return ua.kn(u)}).next(function(){return s})},xh.prototype.Ce=function(t,n){return kh(t).rs(function(t,e){e=Mc(e);n(e)})},xh.prototype.Ea=function(t){return Ph(t).get(wh.key).next(function(t){return Lr(null!==t),t})},xh.prototype.Ta=function(t,e){return Ph(t).put(wh.key,e)},xh.prototype.Pa=function(t,e){return kh(t).put(Uc(this.serializer,e))},xh.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},xh.prototype.ba=function(t){return this.Ea(t).next(function(t){return t.targetCount})},xh.prototype.va=function(t,r){var e=Ii(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return kh(t).rs({range:e,index:gh.queryTargetsIndexName},function(t,e,n){e=Mc(e);Ei(r,e.target)&&(i=e,n.done())}).next(function(){return i})},xh.prototype.Sa=function(n,t,r){var i=this,o=[],s=Lh(n);return t.forEach(function(t){var e=Nc(t.path);o.push(s.put(new mh(r,e))),o.push(i.No.Da(n,r,t))}),ua.kn(o)},xh.prototype.Ca=function(n,t,r){var i=this,o=Lh(n);return ua.forEach(t,function(t){var e=Nc(t.path);return ua.kn([o.delete([r,e]),i.No.Na(n,r,t)])})},xh.prototype.pa=function(t,e){t=Lh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},xh.prototype.xa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Lh(t),r=Hi();return t.rs({range:e,ss:!0},function(t,e,n){t=Dc(t[1]),t=new ai(t);r=r.add(t)}).next(function(){return r})},xh.prototype.Ho=function(t,e){var e=Nc(e.path),e=IDBKeyRange.bound([e],[Ur(e)],!1,!0),i=0;return Lh(t).rs({index:mh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},xh.prototype.Ue=function(t,e){return kh(t).get(e).next(function(t){return t?Mc(t):null})},xh);function xh(t,e){this.No=t,this.serializer=e}function Oh(t){this._a=t}function kh(t){return Mh.Kn(t,gh.store)}function Ph(t){return Mh.Kn(t,wh.store)}function Lh(t){return Mh.Kn(t,mh.store)}var Rh,Vh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ch=(n(jh,Rh=Ie),jh),Mh=(Uh.Kn=function(t,e){if(t instanceof Ch)return aa.Kn(t.Wo,e);throw Pr()},Uh.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Vh);return e.Ha(),e.Ja(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.ma(t)})}).then(function(t){e.Ma=new qa(t,e.ka)}).then(function(){e.$a=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},Uh.prototype.Xa=function(n){var t=this;return this.Ka=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ii?[2,n(e)]:[2]})})},n(this.isPrimary)},Uh.prototype.Za=function(n){var t=this;this.Wa.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Uh.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Uh.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Fh(e).put(new Eh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.eh(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Ka(!1)}))})}).next(function(){return n.nh(e)}).next(function(t){return n.isPrimary&&!t?n.sh(e).next(function(){return!1}):!!t&&n.ih(e).next(function(){return!0})})}).catch(function(t){if(va(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Ka(t)}),n.isPrimary=t})},Uh.prototype.eh=function(t){var e=this;return qh(t).get(oh.key).next(function(t){return ua.resolve(e.rh(t))})},Uh.prototype.oh=function(t){return Fh(t).delete(this.clientId)},Uh.prototype.ah=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Uh.Kn(t,Eh.store);return r.ts().next(function(t){var e=o.uh(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ua.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.lh(i.clientId));t.label=2;case 2:return[2]}})})},Uh.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ah()}).then(function(){return t.Ya()})})},Uh.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},Uh.prototype.nh=function(e){var r=this;return this.Oa?ua.resolve(!0):qh(e).get(oh.key).next(function(t){if(null!==t&&r.hh(t.leaseTimestampMs,5e3)&&!r._h(t.ownerId)){if(r.rh(t)&&r.networkEnabled)return!0;if(!r.rh(t)){if(!t.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Vh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Fh(e).ts().next(function(t){return void 0===r.uh(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Uh.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[oh.store,Eh.store],function(t){var e=new Ch(t,qa.ai);return n.sh(e).next(function(){return n.oh(e)})})];case 1:return t.sent(),this.Wa.close(),this.Eh(),[2]}})})},Uh.prototype.uh=function(t,e){var n=this;return t.filter(function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)})},Uh.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Fh(t).ts().next(function(t){return e.uh(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Uh.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Uh.prototype.Th=function(t){return jc.Fo(t,this.serializer,this.Dr,this.No)},Uh.prototype.Ih=function(){return this.ja},Uh.prototype.mh=function(){return this.vr},Uh.prototype.Ah=function(){return this.Dr},Uh.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,_h,function(t){return o=new Ch(t,i.Ma?i.Ma.next():qa.ai),"readwrite-primary"===n?i.eh(o).next(function(t){return!!t||i.nh(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Ka(!1)}),new _r(Er.FAILED_PRECONDITION,tc);return r(o)}).next(function(t){return i.ih(o).next(function(){return t})}):i.Rh(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},Uh.prototype.Rh=function(t){var e=this;return qh(t).get(oh.key).next(function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Er.FAILED_PRECONDITION,Vh)})},Uh.prototype.ih=function(t){var e=new oh(this.clientId,this.allowTabSynchronization,Date.now());return qh(t).put(oh.key,e)},Uh.Ln=function(){return aa.Ln()},Uh.prototype.sh=function(t){var e=this,n=qh(t);return n.get(oh.key).next(function(t){return e.rh(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(oh.key)):ua.resolve()})},Uh.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},Uh.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},Uh.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},Uh.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},Uh.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},Uh.prototype._h=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Uh.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},Uh.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},Uh.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Uh);function Uh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.ka=a,this.Oa=c,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!Uh.Ln())throw new _r(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new Gh(this,r),this.Qa=e+"main",this.serializer=new xc(u),this.Wa=new aa(this.Qa,10,new rh(this.serializer)),this.ja=new Dh(this.No,this.serializer),this.Dr=new Th,this.vr=(e=this.serializer,u=this.Dr,new Wc(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function jh(t,e){var n=this;return(n=Rh.call(this)||this).Wo=t,n.Fa=e,n}function qh(t){return Mh.Kn(t,oh.store)}function Fh(t){return Mh.Kn(t,Eh.store)}var Gh=(Bh.prototype.Po=function(t){var n=this.Ph(t);return this.db.Ih().ba(t).next(function(e){return n.next(function(t){return e+t})})},Bh.prototype.Ph=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},Bh.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},Bh.prototype.yo=function(t,n){return this.gh(t,function(t,e){return n(e)})},Bh.prototype.Da=function(t,e,n){return zh(t,n)},Bh.prototype.Na=function(t,e,n){return zh(t,n)},Bh.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},Bh.prototype.Go=zh,Bh.prototype.Vh=function(t,e){return r=e,i=!1,Hc(n=t).os(function(t){return Fc(n,t,r).next(function(t){return t&&(i=!0),ua.resolve(!t)})}).next(function(){return i});var n,r,i},Bh.prototype.bo=function(n,r){var i=this,o=this.db.mh().ra(),s=[],u=0;return this.gh(n,function(e,t){t<=r&&(t=i.Vh(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),Lh(n).delete([0,Nc(e.path)])})}),s.push(t))}).next(function(){return ua.kn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Bh.prototype.removeTarget=function(t,e){e=e.st(t.Fa);return this.db.Ih().Va(t,e)},Bh.prototype.yh=zh,Bh.prototype.gh=function(t,r){var i,t=Lh(t),o=qa.ai;return t.rs({index:mh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==qa.ai&&r(new ai(Dc(i)),o),o=e,i=t):o=qa.ai}).next(function(){o!==qa.ai&&r(new ai(Dc(i)),o)})},Bh.prototype.So=function(t){return this.db.mh().aa(t)},Bh);function Bh(t,e){this.db=t,this.wo=new _c(this,e)}function zh(t,e){return Lh(t).put((t=t.Fa,new mh(0,Nc(e.path),t)))}function Hh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Kh=(Wh.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bh)})},Wh);function Wh(t,e,n){this.persistence=t,this.ph=e,this.bh=new Oi(Cr),this.Sh=new ni(Ii,Ei),this.Dh=ii.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new ec(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}function Xh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ch.ra({oa:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ua.resolve(),n.forEach(function(n){u=u.next(function(){return o.Rr(r,n)}).next(function(t){var e=t,t=i.dr.get(n);Lr(null!==t),(!e||e.version.h(t)<0)&&(e=s.hr(n,e,i))&&o.Ir(e,i._r)})}),u.next(function(){return e.Sr.Qo(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Nh.Or(t,a)})})}function Yh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ia(t)})}function Qh(t,a){var c=t,h=a.nt,f=c.bh;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ch.ra({oa:!0});f=c.bh;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.ja.Ca(s,t.se,e).next(function(){return c.ja.Sa(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Fa),f=f.ot(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.ja.Va(s,n))))});var t,o=ji,n=Hi();return a.Jt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Jt.forEach(function(t,e){var n=r.get(t);e instanceof ou&&e.version.isEqual(ii.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.Ir(e,h),o=o.ot(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.No.yh(s,t))})})),h.isEqual(ii.min())||(t=c.ja.Ia(s).next(function(t){return c.ja.Aa(s,s.Fa,h)}),u.push(t)),ua.kn(u).next(function(){return i.apply(s)}).next(function(){return c.Nh.Mr(s,o)})}).then(function(t){return c.bh=f,t})}function Jh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.va(e,r).next(function(t){return t?(n=t,ua.resolve(n)):i.ja.wa(e).next(function(t){return n=new Ni(r,t,0,e.Fa),i.ja.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bh.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.bh=i.bh.ot(t.targetId,t),i.Sh.set(r,t.targetId)),t})}function $h(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bh.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!va(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bh=e.bh.remove(o),e.Sh.delete(n.target),[2]}})})}function Zh(t,o,s){var u=t,a=ii.min(),c=Hi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=wu(o),(void 0!==(t=(i=t).Sh.get(r))?ua.resolve(i.bh.get(t)):i.ja.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ja.xa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ph.Lr(e,o,s?a:ii.min(),s?c:Hi())}).next(function(t){return{documents:t,Fh:c}});var t,n,r,i})}function tf(t,e){var n=t,r=n.ja,t=n.bh.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function ef(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ch,n=t,t=s.Dh,r=e,i=ji,o=Pc(t),t=$c(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:yh.readTimeIndex,range:n},function(t,e){var n=Oc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{kh:i,readTime:Lc(o)}});var e,n,r,i,o}).then(function(t){var e=t.kh,t=t.readTime;return s.Dh=t,e})}function nf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=$c(t),r=ii.min(),t.rs({index:yh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Lc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Dh=t})]})})}function rf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||e.message!==tc)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function of(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t}function sf(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return qf(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(4),[4,Pf(e)];case 1:return t.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,kf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nu=new wf(n,r)}var uf,af,cf,hf=(Of.prototype.P=function(){return this.Oh.P()},Of.prototype.Da=function(t,e){e=new ff(t,e);this.Oh=this.Oh.add(e),this.$h=this.$h.add(e)},Of.prototype.Bh=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},Of.prototype.Na=function(t,e){this.qh(new ff(t,e))},Of.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},Of.prototype.Kh=function(t){var e=this,n=new ai(new oi([])),r=new ff(n,t),t=new ff(n,t+1),i=[];return this.$h.xt([r,t],function(t){e.qh(t),i.push(t.key)}),i},Of.prototype.Qh=function(){var e=this;this.Oh.forEach(function(t){return e.qh(t)})},Of.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},Of.prototype.Wh=function(t){var e=new ai(new oi([])),n=new ff(e,t),t=new ff(e,t+1),r=Hi();return this.$h.xt([n,t],function(t){r=r.add(t.key)}),r},Of.prototype.Ho=function(t){var e=new ff(t,0),e=this.Oh.kt(e);return null!==e&&t.isEqual(e.key)},Of),ff=(xf.Mh=function(t,e){return ai.D(t.key,e.key)||Cr(t.jh,e.jh)},xf.Lh=function(t,e){return Cr(t.jh,e.jh)||ai.D(t.key,e.key)},xf),lf=(Df.prototype.getToken=function(){return Promise.resolve(null)},Df.prototype.Hh=function(){},Df.prototype.Jh=function(t){(this.zh=t)(Ma.UNAUTHENTICATED)},Df.prototype.Yh=function(){this.zh=null},Df),pf=(Sf.prototype.getToken=function(){var e=this,n=this.tc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.tc!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new of(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Sf.prototype.Hh=function(){this.forceRefresh=!0},Sf.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},Sf.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},Sf.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Ma(t)},Sf),df=(Object.defineProperty(Nf.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Nf),yf=(Af.prototype.getToken=function(){return Promise.resolve(new df(this.nc,this.sc))},Af.prototype.Jh=function(t){t(Ma.ni)},Af.prototype.Yh=function(){},Af.prototype.Hh=function(){},Af),Ee=(Tf.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},Tf.prototype.uc=function(){return 2===this.state},Tf.prototype.start=function(){3!==this.state?this.auth():this.lc()},Tf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tf.prototype._c=function(){this.state=0,this.Vs.reset()},Tf.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,function(){return t.dc()}))},Tf.prototype.wc=function(t){this.Ec(),this.stream.send(t)},Tf.prototype.dc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uc()?[2,this.close(0)]:[2]})})},Tf.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},Tf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==e?this.Vs.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ic(n)];case 1:return t.sent(),[2]}})})},Tf.prototype.Tc=function(){},Tf.prototype.auth=function(){var n=this;this.state=1;var t=this.mc(this.ac),e=this.ac;this.oc.getToken().then(function(t){n.ac===e&&n.Ac(t)},function(e){t(function(){var t=new _r(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rc(t)})})},Tf.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc(function(){n(function(){return e.state=2,e.listener.gc()})}),this.stream.Ic(function(t){n(function(){return e.Rc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Tf.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Tf.prototype.Rc=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Tf.prototype.mc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ac===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Tf),vf=(n(_f,cf=Ee),_f.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},_f.prototype.onMessage=function(t){this.Vs.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Pr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Lr(void 0===o||"string"==typeof o),jr.fromBase64String(o||"")):(Lr(void 0===o||o instanceof Uint8Array),jr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:xi(s.code),new _r(o,s.message||"")),r=new to(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Bo(t,u.document.name),a=jo(u.document.updateTime),s=new Ys({mapValue:{fields:u.document.fields}}),a=new iu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new $i(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Bo(t,u.document),c=u.readTime?jo(u.readTime):ii.min(),c=new ou(a,c),u=u.removedTargetIds||[];r=new $i([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Bo(t,c.document),c=c.removedTargetIds||[];r=new $i([],c,h,null)}else{if(!("filter"in e))return Pr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Ti(e),h=h.targetId;r=new Zi(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ii.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?jo(t.readTime):ii.min()}(t);return this.listener.yc(e,t)},_f.prototype.bc=function(t){var e,n,r,i={};i.database=Ko(this.serializer),i.addTarget=(e=this.serializer,(r=_i(r=(n=t).target)?{documents:Jo(e,r)}:{query:$o(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Uo(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.wc(i)},_f.prototype.vc=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.wc(e)},_f),gf=(n(Ef,af=Ee),Object.defineProperty(Ef.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),Ef.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,af.prototype.start.call(this)},Ef.prototype.Tc=function(){this.Sc&&this.Cc([])},Ef.prototype.Pc=function(t){return this.rc.Vc("Write",t)},Ef.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(ii.min())&&(n=jo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ns(n,e)}(t,r)})):[]),n=jo(t.commitTime);return this.listener.Nc(n,e)}var n,r;return Lr(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},Ef.prototype.Fc=function(){var t={};t.database=Ko(this.serializer),this.wc(t)},Ef.prototype.Cc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.wc(t)},Ef),mf=(n(If,uf=function(){}),If.prototype.Oc=function(){if(this.kc)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},If.prototype.Mc=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.Mc(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Hh(),t})},If.prototype.$c=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.$c(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Hh(),t})},If.prototype.terminate=function(){this.kc=!1},If),wf=(bf.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()}))},bf.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,1<=this.Lc&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},bf.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},bf.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},bf.prototype.Qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qc?(xr(t),this.qc=!1):Dr("OnlineStateTracker",t)},bf.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},bf);function bf(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}function If(t,e,n){var r=this;return(r=uf.call(this)||this).credentials=t,r.rc=e,r.serializer=n,r.kc=!1,r}function Ef(t,e,n,r,i){var o=this;return(o=af.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Sc=!1,o}function _f(t,e,n,r,i){var o=this;return(o=cf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Tf(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new sa(t,e)}function Af(t,e){this.nc=t,this.sc=e}function Nf(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=Ma.ni}function Sf(t){var e=this;this.Xh=null,this.currentUser=Ma.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then(function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)},function(){}))}function Df(){this.zh=null}function xf(t,e){this.key=t,this.jh=e}function Of(){this.Oh=new Mi(ff.Mh),this.$h=new Mi(ff.Lh)}function kf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!qf(r))return[3,4];e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Pf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Lf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,Pf(e)];case 1:return t.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}})})}function Rf(t,e){t.Yc.has(e.targetId)||(t.Yc.set(e.targetId,e),jf(t)?Uf(t):Yf(t).uc()&&Cf(t,e))}function Vf(t,e){var n=t,t=Yf(n);n.Yc.delete(e),t.uc()&&Mf(n,e),0===n.Yc.size&&(t.uc()?t.fc():qf(n)&&n.nu.set("Unknown"))}function Cf(t,e){t.su.me(e.targetId),Yf(t).bc(e)}function Mf(t,e){t.su.me(e),Yf(t).vc(e)}function Uf(e){e.su=new no({qe:function(t){return e.Hc.qe(t)},Ue:function(t){return e.Yc.get(t)||null}}),Yf(e).start(),e.nu.Uc()}function jf(t){return qf(t)&&!Yf(t).cc()&&0<t.Yc.size}function qf(t){return 0===t.Xc.size}function Ff(t){t.su=void 0}function Gf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.nu.set("Online"),!(u instanceof to&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Yc.has(i)?[4,o.Hc.iu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Yc.delete(i),o.su.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Bf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof $i?s.su.be(u):u instanceof Zi?s.su.ke(u):s.su.De(u),a.isEqual(ii.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Yh(s.Gc)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).su.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Yc.get(e))&&r.Yc.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.Yc.get(t);e&&(r.Yc.set(t,e.it(jr.u,e.nt)),Mf(r,t),e=new Ni(e.target,t,1,e.sequenceNumber),Cf(r,e))}),r.Hc.ru(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Bf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Bf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!va(r))throw r;return n.Xc.add(1),[4,Pf(n)];case 1:return t.sent(),n.nu.set("Offline"),i=i||function(){return Yh(n.Gc)},n.hs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Xc.delete(1),[4,kf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function zf(e,n){return n().catch(function(t){return Bf(e,t,n)})}function Hf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Qf(i=a),s=0<i.Jc.length?i.Jc[i.Jc.length-1].batchId:-1,t.label=1;case 1:if(!(qf(i)&&i.Jc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Gc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Sr.Bo(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Jc.length&&o.fc(),[3,7]):(s=u.batchId,function(t,e){t.Jc.push(e);t=Qf(t);t.uc()&&t.Dc&&t.Cc(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Bf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Kf(i)&&Wf(i),[2]}var e,n,r})})}function Kf(t){return qf(t)&&!Qf(t).cc()&&0<t.Jc.length}function Wf(t){Qf(t).start()}function Xf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Xc.delete(2),[4,kf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Xc.add(2),[4,Pf(e)]);case 3:t.sent(),e.nu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Yf(n){var t,e,r,i=this;return n.hu||(n.hu=(t=n.zc,e=n.hs,r={gc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Yc.forEach(function(t,e){Cf(n,t)}),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Ff(e),jf(e)?(e.nu.Wc(n),Uf(e)):e.nu.set("Unknown"),[2]})})}.bind(null,n),yc:Gf.bind(null,n)},t.Oc(),new vf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.hu._c(),jf(n)?Uf(n):n.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.hu.stop()];case 2:t.sent(),Ff(n),t.label=3;case 3:return[2]}})})})),n.hu}function Qf(n){var t,e,r,i=this;return n.cu||(n.cu=(t=n.zc,e=n.hs,r={gc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Qf(e).Fc(),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Qf(e).Dc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Di(n=i.code)&&n!==Er.ABORTED?(e=r.Jc.shift(),Qf(r)._c(),[4,zf(r,function(){return r.Hc.au(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Hf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Kf(e)&&Wf(e),[2]}})})}.bind(null,n),xc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Qf(o),n=0,r=o.Jc;n<r.length;n++)i=r[n],e.Cc(i.mutations);return[2]})})}.bind(null,n),Nc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jc.shift(),n=Za.from(e,i,o),[4,zf(r,function(){return r.Hc.ou(n)})];case 1:return t.sent(),[4,Hf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Oc(),new gf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.cu._c(),[4,Hf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.cu.stop()];case 3:t.sent(),0<n.Jc.length&&(Dr("RemoteStore","Stopping write stream with "+n.Jc.length+" pending writes"),n.Jc=[]),t.label=4;case 4:return[2]}})})})),n.cu}var Jf=function(t){this.key=t},$f=function(t){this.key=t},Zf=(Object.defineProperty(il.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),il.prototype.Eu=function(t,e){var s=this,u=e?e.Tu:new Xi,a=(e||this).du,c=(e||this).Qt,h=a,f=!1,l=pu(this.query)&&a.size===this.query.limit?a.last():null,p=du(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof iu?e:null)&&(Nu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Iu(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.fu(r,l)||p&&s.fu(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),pu(this.query)||du(this.query))for(;h.size>this.query.limit;){var n=pu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{du:h,Tu:u,mu:f,Qt:c}},il.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},il.prototype.Vr=function(t,e,n){var o=this,r=this.du;this.du=t.du,this.Qt=t.Qt;var i=t.Tu.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.Au(n);var s=e?this.Ru():[],n=0===this._u.size&&this.te?1:0,e=n!==this.lu;return this.lu=n,0!==i.length||e?{snapshot:new Yi(this.query,t.du,r,i,t.Qt,0==n,e,!1),Pu:s}:{Pu:s}},il.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new Xi,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},il.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},il.prototype.Au=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uu=e.uu.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uu=e.uu.delete(t)}),this.te=t.te)},il.prototype.Ru=function(){var e=this;if(!this.te)return[];var n=this._u;this._u=Hi(),this.du.forEach(function(t){e.gu(t.key)&&(e._u=e._u.add(t.key))});var r=[];return n.forEach(function(t){e._u.has(t)||r.push(new $f(t))}),this._u.forEach(function(t){n.has(t)||r.push(new Jf(t))}),r},il.prototype.Vu=function(t){this.uu=t.Fh,this._u=Hi();t=this.Eu(t.documents);return this.Vr(t,!0)},il.prototype.yu=function(){return Yi.Gt(this.query,this.du,this.Qt,0===this.lu)},il),tl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},el=function(t){this.key=t,this.pu=!1},nl=(Object.defineProperty(rl.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),rl);function rl(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new ni(Tu,_u),this.xu=new Map,this.Fu=[],this.ku=new Oi(ai.D),this.Ou=new Map,this.Mu=new hf,this.$u={},this.Lu=new Map,this.Bu=Sh.da(),this.onlineState="Unknown",this.qu=void 0}function il(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=Hi(),this.Qt=Hi(),this.fu=Su(t),this.du=new Wi(this.fu)}function ol(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Eu(o)).mu?[4,Zh(r.Gc,i.query,!1).then(function(t){t=t.documents;return i.view.Eu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Vr(e,r.Uu,n),[2,(pl(r,i.targetId,n.Pu),n.snapshot)]}})})}(i,t,e,n)},[4,Zh(i.Gc,o,!0)];case 1:return n=t.sent(),r=new Zf(o,n.Fh),e=r.Eu(n.documents),n=Ji.Zt(s,u&&"Offline"!==i.onlineState),n=r.Vr(e,i.Uu,n),pl(i,s,n.Pu),r=new tl(o,s,r),[2,(i.Nu.set(o,r),i.xu.has(s)?i.xu.get(s).push(o):i.xu.set(s,[o]),n.snapshot)]}})})}function sl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Qh(n.Gc,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.Ou.get(e);e&&(Lr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.pu=!0:0<t.ne.size?Lr(e.pu):0<t.se.size&&(Lr(e.pu),e.pu=!1))}),[4,yl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,rf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function ul(t,n,e){var r,t=t;(t.Uu&&0===e||!t.Uu&&1===e)&&(r=[],t.Nu.forEach(function(t,e){e=e.view.Ks(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Va(t)}(t.vu,n),r.length&&t.Cu.yc(r),t.onlineState=n,t.Uu&&t.Su.ji(n))}function al(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.$o(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.Sr.Qo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Nh.Or(e,n)})}))];case 2:return o=t.sent(),hl(n,u,a),cl(n,u),n.Su.Oi(u,"rejected",a),[4,yl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,rf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function cl(t,e){(t.Lu.get(e)||[]).forEach(function(t){t.resolve()}),t.Lu.delete(e)}function hl(t,e,n){var r=t,i=r.$u[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i)}function fl(e,t,n){void 0===n&&(n=null),e.Su.Bi(t);for(var r=0,i=e.xu.get(t);r<i.length;r++){var o=i[r];e.Nu.delete(o),n&&e.Cu.Qu(o,n)}e.xu.delete(t),e.Uu&&e.Mu.Kh(t).forEach(function(t){e.Mu.Ho(t)||ll(e,t)})}function ll(t,e){var n=t.ku.get(e);null!==n&&(Vf(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),dl(t))}function pl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Jf?(t.Mu.Da(o.key,e),function(t,e){e=e.key;t.ku.get(e)||(Dr("SyncEngine","New document in limbo: "+e),t.Fu.push(e),dl(t))}(t,o)):o instanceof $f?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Mu.Na(o.key,e),t.Mu.Ho(o.key)||ll(t,o.key)):Pr()}}function dl(t){for(;0<t.Fu.length&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new el(e)),t.ku=t.ku.ot(e,n),Rf(t.bu,new Ni(wu(lu(e.path)),n,2,qa.ai))}}function yl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nu.P()?[3,3]:(n.Nu.forEach(function(t,e){o.push(n.Ku(e,s,u).then(function(t){t&&(n.Uu&&n.Su.Ki(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=nc.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Cu.yc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ua.forEach(c,function(e){return ua.forEach(e.jr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return ua.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!va(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bh.get(o),u=s.nt,u=s.rt(u),r.bh=r.bh.ot(o,u));return[2]}})})}(n.Gc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function vl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Nh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.Th(o),m=new ec(e.Ch,n,e.persistence.Ah()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=Hi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Or(v,r).next(function(t){return{Wu:t,ju:e,Gu:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Nh=m,e.ph.xh(e.Nh),r)]}})})}(n.Gc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lu.forEach(function(t){t.forEach(function(t){t.reject(new _r(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lu.clear(),n.Su.Wi(o,r.ju,r.Gu),[4,yl(n,r.Wu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function gl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Gc,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Nh.Or(e,t):ua.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Hf(o.bu)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(hl(o,a,h||null),cl(o,a),o.Gc.Sr.jo(a)):Pr(),t.label=4;case 4:return[4,yl(o,s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function ml(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Il(r=h),El(r),!0!==f||!0===r.qu?[3,3]:(e=r.Su.Ci(),[4,wl(r,e.L())]);case 1:return i=t.sent(),r.qu=!0,[4,Xf(r.bu,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Rf(r.bu,u);return[3,7];case 3:return!1!==f||!1===r.qu?[3,7]:(a=[],c=Promise.resolve(),r.xu.forEach(function(t,e){r.Su.qi(e)?a.push(e):c=c.then(function(){return fl(r,e),$h(r.Gc,e,!0)}),Vf(r.bu,e)}),[4,c]);case 4:return t.sent(),[4,wl(r,a)];case 5:return t.sent(),(n=r).Ou.forEach(function(t,e){Vf(n.bu,e)}),n.Mu.Qh(),n.Ou=new Map,n.ku=new Oi(ai.D),r.qu=!1,[4,Xf(r.bu,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function wl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xu.get(s))&&0!==a.length?[4,Jh(e.Gc,wu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nu.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zh((e=r).Gc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Vu(n),[2,(e.Uu&&pl(e,i.targetId,n.Pu),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,tf(e.Gc,s)];case 8:return l=t.sent(),[4,Jh(e.Gc,l)];case 9:return u=t.sent(),[4,ol(e,bl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Cu.yc(r),n)]}})})}function bl(t){return fu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Il(t){return t.bu.Hc.ru=sl.bind(null,t),t.bu.Hc.qe=function(t,e){var n=t;if((t=n.Ou.get(e))&&t.pu)return Hi().add(t.key);var r=Hi();if(!(e=n.xu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nu.get(s),r=r.Ot(s.view.wu);return r}.bind(null,t),t.bu.Hc.iu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Su.Ki(s,"rejected",u),i=e.Ou.get(s),(n=i&&i.key)?(r=(r=new Oi(ai.D)).ot(n,new ou(n,ii.min())),i=Hi().add(n),i=new Qi(ii.min(),new Map,new Mi(Cr),r,i),[4,sl(e,i)]):[3,2];case 1:return t.sent(),e.ku=e.ku.remove(n),e.Ou.delete(s),dl(e),[3,4];case 2:return[4,$h(e.Gc,s,!1).then(function(){return fl(e,s,u)}).catch(rf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Cu.yc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Bs.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Va(n)}.bind(null,t.vu),t.Cu.Qu=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.vu),t}function El(t){return t.bu.Hc.ou=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Xh(e.Gc,o)];case 2:return r=t.sent(),hl(e,n,null),cl(e,n),e.Su.Oi(n,"acknowledged"),[4,yl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,rf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.bu.Hc.au=al.bind(null,t),t}var _l,Tl,Al,Nl=(Jl.prototype.xh=function(t){this.zu=t},Jl.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ii.min())?this.Hu(e,r):this.zu.Or(e,o).next(function(t){var n=s.Ju(r,t);return(pu(r)||du(r))&&s.mu(r.an,n,o,i)?s.Hu(e,r):(Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(r)),s.zu.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Jl.prototype.Ju=function(n,t){var r=new Mi(Su(n));return t.forEach(function(t,e){e instanceof iu&&Nu(n,e)&&(r=r.add(e))}),r},Jl.prototype.mu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.h(r))},Jl.prototype.Hu=function(t,e){return Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Au(e)),this.zu.Lr(t,e,ii.min())},Jl),Sl=(Ql.prototype.ko=function(t){return ua.resolve(0===this.Sr.length)},Ql.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Sr.length&&this.Sr[this.Sr.length-1];n=new $a(i,e,n,r);this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xu=this.Xu.add(new ff(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return ua.resolve(n)},Ql.prototype.$o=function(t,e){return ua.resolve(this.Zu(e))},Ql.prototype.Bo=function(t,e){e+=1,e=this.tl(e),e=e<0?0:e;return ua.resolve(this.Sr.length>e?this.Sr[e]:null)},Ql.prototype.qo=function(){return ua.resolve(0===this.Sr.length?-1:this.Yu-1)},Ql.prototype.Uo=function(t){return ua.resolve(this.Sr.slice())},Ql.prototype.Nr=function(t,e){var n=this,r=new ff(e,0),e=new ff(e,Number.POSITIVE_INFINITY),i=[];return this.Xu.xt([r,e],function(t){t=n.Zu(t.jh);i.push(t)}),ua.resolve(i)},Ql.prototype.$r=function(t,e){var n=this,r=new Mi(Cr);return e.forEach(function(t){var e=new ff(t,0),t=new ff(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,t],function(t){r=r.add(t.jh)})}),ua.resolve(this.el(r))},Ql.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,e=n;ai.X(e)||(e=e.child(""));var e=new ff(new ai(e),0),i=new Mi(Cr);return this.Xu.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.jh)),!0)},e),ua.resolve(this.el(i))},Ql.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Zu(t);null!==t&&n.push(t)}),n},Ql.prototype.Qo=function(n,r){var i=this;Lr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xu;return ua.forEach(r.mutations,function(t){var e=new ff(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xu=o})},Ql.prototype.jo=function(t){},Ql.prototype.Ho=function(t,e){var n=new ff(e,0),n=this.Xu.kt(n);return ua.resolve(e.isEqual(n&&n.key))},Ql.prototype.zo=function(t){return this.Sr.length,ua.resolve()},Ql.prototype.nl=function(t,e){return this.tl(t)},Ql.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},Ql.prototype.Zu=function(t){t=this.tl(t);return t<0||t>=this.Sr.length?null:this.Sr[t]},Ql),Dl=(Yl.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:i,readTime:n}),this.size+=i-o,this.Dr.Mo(t,r.path.F())},Yl.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Yl.prototype.Rr=function(t,e){e=this.docs.get(e);return ua.resolve(e?e.ta:null)},Yl.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),ua.resolve(r)},Yl.prototype.Lr=function(t,e,n){for(var r=Gi,i=new ai(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.ta,a=a.readTime;if(!e.path.M(u.path))break;a.h(n)<=0||s instanceof iu&&Nu(e,s)&&(r=r.ot(s.key,s))}return ua.resolve(r)},Yl.prototype.il=function(t,e){return ua.forEach(this.docs,function(t){return e(t)})},Yl.prototype.ra=function(t){return new xl(this)},Yl.prototype.aa=function(t){return ua.resolve(this.size)},Yl),xl=(n(Xl,Al=h),Xl.prototype.Vr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ha.Ir(n,e,r.readTime)):r.ha.Ar(t)}),ua.kn(i)},Xl.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},Xl.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},Xl),Ol=(Wl.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),ua.resolve()},Wl.prototype.Ia=function(t){return ua.resolve(this.lastRemoteSnapshotVersion)},Wl.prototype.ma=function(t){return ua.resolve(this.ol)},Wl.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),ua.resolve(this.highestTargetId)},Wl.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),ua.resolve()},Wl.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Sh(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},Wl.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,ua.resolve()},Wl.prototype.Va=function(t,e){return this.Pa(e),ua.resolve()},Wl.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),--this.targetCount,ua.resolve()},Wl.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),ua.kn(u).next(function(){return s})},Wl.prototype.ba=function(t){return ua.resolve(this.targetCount)},Wl.prototype.va=function(t,e){e=this.rl.get(e)||null;return ua.resolve(e)},Wl.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),ua.resolve()},Wl.prototype.Ca=function(e,t,n){this.al.Uh(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),ua.kn(i)},Wl.prototype.pa=function(t,e){return this.al.Kh(e),ua.resolve()},Wl.prototype.xa=function(t,e){e=this.al.Wh(e);return ua.resolve(e)},Wl.prototype.Ho=function(t,e){return ua.resolve(this.al.Ho(e))},Wl),kl=(Kl.prototype.start=function(){return Promise.resolve()},Kl.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(Kl.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Kl.prototype.Za=function(){},Kl.prototype.th=function(){},Kl.prototype.Ah=function(){return this.Dr},Kl.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new Sl(this.Dr,this.No),this.cl[t.ti()]=e),e},Kl.prototype.Ih=function(){return this.ja},Kl.prototype.mh=function(){return this.vr},Kl.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Pl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).xn().then(function(t){return i.br(),t})},Kl.prototype.fl=function(e,n){return ua.On(Object.values(this.cl).map(function(t){return function(){return t.Ho(e,n)}}))},Kl),Pl=(n(Hl,Tl=Ie),Hl),Ll=(zl.El=function(t){return new zl(t)},Object.defineProperty(zl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw Pr()},enumerable:!1,configurable:!0}),zl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),ua.resolve()},zl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),ua.resolve()},zl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),ua.resolve()},zl.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Ih();return r.xa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.ya(t,e)})},zl.prototype.ll=function(){this.wl=new Set},zl.prototype._l=function(n){var r=this,i=this.persistence.mh().ra();return ua.forEach(this.Tl,function(t){var e=ai.H(t);return r.Il(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},zl.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},zl.prototype.ul=function(t){return 0},zl.prototype.Il=function(t,e){var n=this;return ua.On([function(){return ua.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},zl),Rl=(Bl.prototype.gc=function(t){this.Rl=t},Bl.prototype.Ic=function(t){this.Pl=t},Bl.prototype.onMessage=function(t){this.gl=t},Bl.prototype.close=function(){this.Al()},Bl.prototype.send=function(t){this.ml(t)},Bl.prototype.Vl=function(){this.Rl()},Bl.prototype.yl=function(t){this.Pl(t)},Bl.prototype.pl=function(t){this.gl(t)},Bl),Vl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Cl=(Gl.prototype.Mc=function(e,t,n,r){var i=this.Dl(e,t);Dr("RestConnection","Sending: ",i,n);t={};return this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Gl.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},Gl.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0-2020926155854",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},Gl.prototype.Dl=function(t,e){t=Vl[t];return this.vl+"/v1/"+e+":"+t},n(Fl,_l=Gl),Fl.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new _r(Er.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new _r(e,t.message))):r(new _r(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Er.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Fl.prototype.Vc=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Dr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Rl({ml:function(t){u?Dr("Connection","Not sending because WebChannel is closed:",t):(s||(Dr("Connection","Opening WebChannel transport."),o.open(),s=!0),Dr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(gr.EventType.OPEN,function(){u||Dr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Dr("Connection","WebChannel transport closed"),a.yl())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Or("Connection","WebChannel transport errored:",t),a.yl(new _r(Er.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ai[r];if(void 0!==t)return xi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.yl(new _r(t,i)),o.close()):(Dr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.Vl()},0),a},Fl),Ml=(ql.prototype.eu=function(t){this.Ml.push(t)},ql.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},ql.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},ql.prototype.Fl=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},ql.prototype.Ol=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},ql.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ql),Ul=(jl.prototype.eu=function(t){},jl.prototype.Di=function(){},jl);function jl(){}function ql(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}function Fl(t){var e=this;return(e=_l.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Gl(t){this.bl=t,this._=t._;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Bl(t){this.ml=t.ml,this.Al=t.Al}function zl(t){this.persistence=t,this.dl=new hf,this.wl=null}function Hl(t){var e=this;return(e=Tl.call(this)||this).Fa=t,e}function Kl(t){var e=this;this.cl={},this.Ma=new qa(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new Ol(this),this.Dr=new eh,this.vr=(t=this.Dr,new Dl(t,function(t){return e.No.ul(t)}))}function Wl(t){this.persistence=t,this.rl=new ni(Ii,Ei),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.ol=0,this.al=new hf,this.targetCount=0,this.hl=Sh.fa()}function Xl(t){var e=this;return(e=Al.call(this)||this).ha=t,e}function Yl(t,e){this.Dr=t,this.sl=e,this.docs=new Oi(ai.D),this.size=0}function Ql(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Mi(ff.Mh)}function Jl(){}function $l(t){return new Lo(t,!0)}var Zl,tp,ep=(hp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Su=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.Gc=this.Kl(e),[2]}})})},hp.prototype.Ul=function(t){return null},hp.prototype.Kl=function(t){return e=this.persistence,n=new Nl,t=t.Ql,new Kh(e,n,t);var e,n},hp.prototype.Bl=function(t){return new kl(Ll.El)},hp.prototype.Ll=function(t){return new Ja},hp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},hp),np=(n(cp,tp=ep),cp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,nf(this.Gc)];case 2:return t.sent(),[4,this.Wl.initialize(this,e)];case 3:return t.sent(),[4,El(this.Wl.fi)];case 4:return t.sent(),[4,Hf(this.Wl.bu)];case 5:return t.sent(),[2]}})})},cp.prototype.Ul=function(t){var e=this.persistence.No.wo;return new Ec(e,t.hs)},cp.prototype.Bl=function(t){var e=Hh(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?wc.ao(this.cacheSizeBytes):wc.fo,r=$l(t.bl._);return new Mh(this.synchronizeTabs,e,t.clientId,n,t.hs,Ta(),Aa(),r,this.Su,!!this.forceOwnership)},cp.prototype.Ll=function(t){return new Ja},cp),rp=(n(ap,Zl=np),ap.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Zl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Wl.fi,this.Su instanceof Qa?(this.Su.fi={er:gl.bind(null,e),nr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).qu?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.xu.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,ef(e.Gc)];case 3:return n=t.sent(),r=Qi.Xt(o,"current"===s),[4,yl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,$h(e.Gc,o,!0)];case 6:return t.sent(),fl(e,o,u),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Il(c)).qu)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xu.has(r)?(Dr("SyncEngine","Adding an already active target "+r),[3,5]):[4,tf(n.Gc,r)]):[3,6];case 2:return i=t.sent(),[4,Jh(n.Gc,i)];case 3:return o=t.sent(),[4,ol(n,bl(i),o.targetId,!1)];case 4:t.sent(),Rf(n.bu,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xu.has(e)?[4,$h(n.Gc,e,!1).then(function(){Vf(n.bu,e),fl(n,e)}).catch(rf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Gc.persistence.pi()}.bind(null,e)},[4,this.Su.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ml(this.Wl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ii?this.ql.start(this.Gc):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},ap.prototype.Ll=function(t){var e=Ta();if(!Qa.Ln(e))throw new _r(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Hh(t.bl._,t.bl.persistenceKey);return new Qa(e,t.hs,n,t.clientId,t.Ql)},ap),ip=(up.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Gc?[3,2]:(this.Gc=n.Gc,this.Su=n.Su,this.zc=this.jl(r),this.bu=this.Gl(r),this.vu=this.zl(r),this.fi=this.Hl(r,!n.synchronizeTabs),this.Su.di=function(t){return ul(e.fi,t,1)},this.bu.Hc.Jl=vl.bind(null,this.fi),[4,Xf(this.bu,this.fi.Uu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},up.prototype.zl=function(t){return new Pa},up.prototype.jl=function(t){var e=$l(t.bl._),n=(n=t.bl,new Cl(n));return t=t.credentials,new mf(t,n,e)},up.prototype.Gl=function(t){var e=this,n=this.Gc,r=this.zc,i=t.hs,o=function(t){return ul(e.fi,t,0)},t=new(Ml.Ln()?Ml:Ul);return new sf(n,r,i,o,t)},up.prototype.Hl=function(t,e){return function(t,e,n,r,i,o,s){o=new nl(t,e,n,r,i,o);return s&&(o.qu=!0),o}(this.Gc,this.bu,this.vu,this.Su,t.Ql,t.Du,e)},up.prototype.terminate=function(){return Lf(this.bu)},up),op=(sp.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},sp.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},sp.prototype.Xl=function(){this.muted=!0},sp.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},sp);function sp(t){this.observer=t,this.muted=!1}function up(){}function ap(t,e){var n=this;return(n=Zl.call(this,t,e,!1)||this).Wl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function cp(t,e,n){var r=this;return(r=tp.call(this)||this).Wl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function hp(){this.synchronizeTabs=!1}function fp(t,e,n){if(!n)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function lp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function pp(t,e,n,r){if(!0===e&&!0===r)throw new _r(Er.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function dp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function yp(t,e){if(e<=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var vp,gp,mp=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new ui(t)},wp=(n(Tp,gp=mp),Tp.documentId=function(){return new Tp(ui.j().B())},Tp.prototype.isEqual=function(t){return t instanceof Tp&&this.Zl.isEqual(t.Zl)},Tp),bp=new RegExp("[~\\*/\\[\\]]"),Ip=function(t){this.t_=t},Ep=(n(_p,vp=Ip),_p.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},_p.prototype.isEqual=function(t){return t instanceof _p},_p);function _p(){return null!==vp&&vp.apply(this,arguments)||this}function Tp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return gp.call(this,t)||this}function Ap(t,e,n){return new Xp({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Np,Sp,Dp,xp,Op=(n(Kp,xp=Ip),Kp.prototype.e_=function(t){return new Ts(t.path,new cs)},Kp.prototype.isEqual=function(t){return t instanceof Kp},Kp),kp=(n(Hp,Dp=Ip),Hp.prototype.e_=function(t){var e=Ap(this,t,!0),n=this.o_.map(function(t){return nd(t,e)}),n=new hs(n);return new Ts(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Pp=(n(zp,Sp=Ip),zp.prototype.e_=function(t){var e=Ap(this,t,!0),n=this.o_.map(function(t){return nd(t,e)}),n=new ys(n);return new Ts(t.path,n)},zp.prototype.isEqual=function(t){return this===t},zp),Lp=(n(Bp,Np=Ip),Bp.prototype.e_=function(t){var e=new ws(t.serializer,Co(t.serializer,this.a_));return new Ts(t.path,e)},Bp.prototype.isEqual=function(t){return this===t},Bp),Rp=(Object.defineProperty(Gp.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(Gp.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Gp.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},Gp.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},Gp.prototype.g=function(t){return Cr(this.h_,t.h_)||Cr(this.c_,t.c_)},Gp),Vp=function(t){this.u_=t},Cp=/^__.*__$/,Mp=function(t,e,n){this.l_=t,this.__=e,this.f_=n},Up=(Fp.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new Ms(t,this.data,this.Qe,e)):n.push(new Cs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Fp),jp=(qp.prototype.d_=function(t,e){e=[new Ms(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Gs(t,this.fieldTransforms)),e},qp);function qp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Fp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Gp(t,e){if(!isFinite(t)||t<-90||90<t)throw new _r(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}function Bp(t,e){var n=this;return(n=Np.call(this,t)||this).a_=e,n}function zp(t,e){var n=this;return(n=Sp.call(this,t)||this).o_=e,n}function Hp(t,e){var n=this;return(n=Dp.call(this,t)||this).o_=e,n}function Kp(){return null!==xp&&xp.apply(this,arguments)||this}function Wp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Xp=(Object.defineProperty(Jp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),Jp.prototype.E_=function(t){return new Jp(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Jp.prototype.T_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.E_({path:e,r_:!1});return e.I_(t),e},Jp.prototype.m_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.E_({path:t,r_:!1});return t.w_(),t},Jp.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},Jp.prototype.s_=function(t){return ad(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},Jp.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},Jp.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},Jp.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Wp(this.n_)&&Cp.test(t))throw this.s_('Document fields cannot begin and end with "__"')},Jp),Yp=(Qp.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Xp({n_:t,methodName:e,i_:n,path:ui.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Qp);function Qp(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||$l(t)}function Jp(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function $p(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);od("Data must be an object, but it was:",s,r);var u,a,r=rd(r,s);if(o.merge)u=new _s(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof mp)p=l.Zl;else{if("string"!=typeof l)throw Pr();p=ud(e,l,n)}if(!s.contains(p))throw new _r(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");cd(c,p)||c.push(p)}u=new _s(c),a=s.fieldTransforms.filter(function(t){return u.Je(t.field)})}else u=null,a=s.fieldTransforms;return new Up(new Ys(r),u,a)}function Zp(t,r,i,e){var o=t.P_(1,r,i);od("Data must be an object, but it was:",o,e);var s=[],u=new Qs;$r(e,function(t,e){var n=ud(r,t,i),t=o.m_(n);e instanceof Ep||e instanceof Vp&&e.u_ instanceof Ep?s.push(n):null!=(t=nd(e,t))&&(s.push(n),u.set(n,t))});e=new _s(s);return new jp(u.Xe(),e,o.fieldTransforms)}function td(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[sd(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(sd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Qs,y=u.length-1;0<=y;--y){cd(p,u[y])||(h=u[y],f=a[y],l=s.m_(h),f instanceof Ep||f instanceof Vp&&f.u_ instanceof Ep?p.push(h):null!=(l=nd(f,l))&&(p.push(h),d.set(h,l)))}i=new _s(p);return new jp(d.Xe(),i,s.fieldTransforms)}function ed(t,e,n,r){return void 0===r&&(r=!1),nd(n,t.P_(r?4:3,e))}function nd(s,t){if(s instanceof Vp&&(s=s.u_),id(s))return od("Unsupported field value:",t,s),rd(s,t);if(s instanceof Ip)return function(t,e){if(!Wp(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");t=t.e_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=nd(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ri.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof ri){var r=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof Rp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fr)return{bytesValue:Uo(e.serializer,t.l)};if(t instanceof Mp){n=e._,r=t.l_;if(!r.isEqual(n))throw e.s_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qo(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+dp(t))}(s,t)}function rd(t,n){var r={};return Zr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):$r(t,function(t,e){e=nd(e,n.T_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function id(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof Rp||t instanceof Fr||t instanceof Mp||t instanceof Ip)}function od(t,e,n){if(!id(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=dp(n);throw"an object"===n?e.s_(t+" a custom object"):e.s_(t+" "+n)}var r}function sd(t,e,n){if(e instanceof mp)return e.Zl;if("string"==typeof e)return ud(t,e);throw ad("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ud(t,e,n){try{return function(e){if(0<=e.search(bp))throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(wp.bind.apply(wp,i([void 0],e.split("."))))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw ad(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function ad(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function cd(t,e){return t.some(function(t){return t.isEqual(e)})}var hd=(yd.prototype.b_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new _r(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ko((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Go(n.serializer,t)})},[4,n.$c("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),t=jo(e.found.updateTime),e=new Ys({mapValue:{fields:e.found.fields}});return new iu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);t=Bo(t,e.missing),e=jo(e.readTime);return new ou(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Lr(!!t),o.push(t)}),o)]}})})}(this.zc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ou||t instanceof iu?n.S_(t):Pr()}),e)]}})})},yd.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},yd.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},yd.prototype.delete=function(t){this.write([new Ws(t,this.Ge(t))]),this.p_.add(t.toString())},yd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),this.y_)throw this.y_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ai.H(e);n.mutations.push(new Xs(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.Mc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.zc,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},yd.prototype.S_=function(t){var e;if(t instanceof iu)e=t.version;else{if(!(t instanceof ou))throw Pr();e=ii.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Er.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},yd.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?Ss.updateTime(e):Ss.ze()},yd.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return Ss.exists(!0);if(e.isEqual(ii.min()))throw new _r(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ss.updateTime(e)},yd.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},yd.prototype.v_=function(){},yd),fd=(dd.prototype.run=function(){this.N_()},dd.prototype.N_=function(){var t=this;this.Vs.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new hd(this.zc),(n=this.x_(e))&&n.then(function(t){r.hs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.F_(t)})})}).catch(function(t){r.F_(t)}),[2]})})})},dd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!vi(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},dd.prototype.F_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.hs.ws(function(){return e.N_(),Promise.resolve()})):this.ls.reject(t)},dd.prototype.k_=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Di(t)},dd),ld=(pd.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new ia,o=!1;return this.credentials.Jh(function(t){return o?void r.hs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).hs.Fs(),Dr("RemoteStore","RemoteStore received new credentials"),n=qf(e),e.Xc.add(3),[4,Pf(e)];case 1:return t.sent(),n&&e.nu.set("Unknown"),[4,e.Hc.Jl(i)];case 2:return t.sent(),e.Xc.delete(3),[4,kf(e)];case 3:return t.sent(),[2]}})})}(r.bu,t)}):(o=!0,Dr("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject))}),this.hs.ws(function(){return r.O_.promise}),i.promise},pd.prototype.enableNetwork=function(){var e=this;return this.M_(),this.hs.enqueue(function(){return e.persistence.th(!0),(t=e.bu).Xc.delete(0),kf(t);var t})},pd.prototype.L_=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:o,Du:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Su=r.Su,this.Gc=r.Gc,this.ql=r.ql,this.zc=i.zc,this.bu=i.bu,this.fi=i.fi,this.B_=i.vu,this.B_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Il(s),(o=e.Nu.get(u))?(n=o.targetId,e.Su.$i(n),r=o.view.yu(),[3,4]):[3,1];case 1:return[4,Jh(e.Gc,wu(u))];case 2:return i=t.sent(),o=e.Su.$i(i.targetId),n=i.targetId,[4,ol(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uu&&Rf(e.bu,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.B_.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nu.get(o),1<(r=e.xu.get(n.targetId)).length?[2,(e.xu.set(n.targetId,r.filter(function(t){return!_u(t,o)})),void e.Nu.delete(o))]:e.Uu?(e.Su.Bi(n.targetId),e.Su.xi(n.targetId)?[3,2]:[4,$h(e.Gc,n.targetId,!1).then(function(){e.Su.Ui(n.targetId),Vf(e.bu,n.targetId),fl(e,n.targetId)}).catch(rf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return fl(e,n.targetId),[4,$h(e.Gc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Er.FAILED_PRECONDITION||e.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.L_(new ep,new ip,o,s))];case 4:return[2]}})})},pd.prototype.M_=function(){if(this.hs.ps)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},pd.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue(function(){return t.persistence.th(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(0),[4,Pf(e)];case 1:return t.sent(),e.nu.set("Offline"),[2]}})})}(t.bu)})},pd.prototype.terminate=function(){var t=this;this.hs.Ds();var n=new ia;return this.hs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Lf(this.bu)];case 1:return t.sent(),[4,this.Su.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yh(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Oa(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},pd.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new ia;return this.hs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:qf((n=o).bu)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Gc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lu.get(r)||[]).push(s),n.Lu.set(r,i),[3,4]);case 3:return i=t.sent(),i=Oa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},pd.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new op(n),o=new Ca(t,i,e);return this.hs.ws(function(){return La(r.B_,o)}),function(){i.Xl(),r.hs.ws(function(){return Ra(r.B_,o)})}},pd.prototype.q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ia,[2,(this.hs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Nh.Cr(t,e)}))];case 1:return(r=t.sent())instanceof iu?s.resolve(r):r instanceof ou?s.resolve(null):s.reject(new _r(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Oa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Gc,r,e)}),e.promise)]}})})},pd.prototype.U_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ia,[2,(this.hs.ws(function(){return n=a.B_,r=a.hs,i=c,o=h,s=e,t=new op({next:function(t){r.ws(function(){return Ra(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ca(lu(i.path),t,{includeMetadataChanges:!0,Xs:!0}),La(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},pd.prototype.K_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ia,[2,(this.hs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Zh(r,i,!0)];case 1:return n=t.sent(),e=new Zf(i,n.Fh),n=e.Eu(n.documents),n=e.Vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Oa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Gc,r,e)}),e.promise)]}})})},pd.prototype.Q_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),u=new ia,[2,(this.hs.ws(function(){return e=a.B_,n=a.hs,t=c,r=h,i=u,o=new op({next:function(t){n.ws(function(){return Ra(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ca(t,o,{includeMetadataChanges:!0,Xs:!0}),La(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},pd.prototype.write=function(t){var e=this;this.M_();var n=new ia;return this.hs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=El(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Gc,a=p,h=i,f=ri.now(),o=a.reduce(function(t,e){return t.add(e.key)},Hi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Nh.Or(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Gs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof iu?t.field(i.field):void 0,o=ss(i.transform,o||null);null!=o&&(e=(null==e?new Qs:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Ms(i.key,o,function s(t){var u=[];return $r(t.fields||{},function(t,e){var n=new ui([t]);if(Oo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new _s(u)}(o.proto.mapValue),Ss.exists(!0)))}return h.Sr.Oo(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Su.Fi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$u[e.currentUser.ti()])||new Oi(Cr)).ot(n,r),e.$u[e.currentUser.ti()]=i,[4,yl(u,s.wr)];case 3:return t.sent(),[4,Hf(u.bu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Oa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},pd.prototype._=function(){return this.bl._},pd.prototype.W_=function(t){var e=this;this.M_();var r=new op(t);return this.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.B_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.B_.qs.delete(r)]})})})}},Object.defineProperty(pd.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),pd.prototype.transaction=function(t){var e=this;this.M_();var n=new ia;return this.hs.ws(function(){return new fd(e.hs,e.zc,t,n).run(),Promise.resolve()}),n.promise},pd);function pd(t,e){this.credentials=t,this.hs=e,this.clientId=Rr.t(),this.O_=new ia}function dd(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new sa(this.hs,"transaction_retry")}function yd(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}function vd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var gd,md,wd=(Gd.prototype.J_=function(t){switch(vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _o(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(To(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw Pr()}},Gd.prototype.nf=function(t){var n=this,r={};return $r(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},Gd.prototype.tf=function(t){return new Rp(_o(t.latitude),_o(t.longitude))},Gd.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},Gd.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return lo(e)?t(e):e}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(po(t));default:return null}},Gd.prototype.Y_=function(t){t=Eo(t);return new ri(t.seconds,t.nanos)},Gd.prototype.Z_=function(t){var e=oi.q(t);Lr(os(e));t=new Xr(e.get(1),e.get(3)),e=new ai(e.N(5));return t.isEqual(this._)||xr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(e)},Gd),bd=wc.uo,Id=(Fd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fd),Ed="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",_d=(qd.prototype.enableIndexedDbPersistence=function(t,e){throw new _r(Er.FAILED_PRECONDITION,Ed)},qd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new _r(Er.FAILED_PRECONDITION,Ed)},qd.prototype.clearIndexedDbPersistence=function(t){throw new _r(Er.FAILED_PRECONDITION,Ed)},qd),Td=(jd.prototype.enableIndexedDbPersistence=function(t,e){var n=new ip,e=new np(n,t.sf().cacheSizeBytes,e);return t.if(e,n)},jd.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new ip,n=new rp(e,t.sf().cacheSizeBytes);return t.if(n,e)},jd.prototype.clearIndexedDbPersistence=function(n){var t=this,r=new ia;return n.rf.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return aa.Ln()?(e=n+"main",[4,aa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Hh(n.l_,n.af))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},jd),Ad=(Object.defineProperty(Ud.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new Yp(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),Ud.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;t=new Id(t);if(this.lf&&!this.df.isEqual(t))throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.df=t).credentials&&(this.ff=function(t){if(!t)return new lf;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new yf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Ud.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Ud.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},Ud.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},Ud.prototype.enablePersistence=function(t){if(this.lf)throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&pp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},Ud.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.lf&&!this.lf.j_)throw new _r(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]})})},Ud.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ud.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),Ud.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},Ud.prototype.onSnapshotsInSync=function(t){if(this.uf(),vd(t))return this.lf.W_(t);t={next:t};return this.lf.W_(t)},Ud.prototype.uf=function(){return this.lf||this.if(new ep,new ip),this.lf},Ud.prototype.If=function(){return new Hr(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},Ud.prototype.if=function(t,e){var n=this.If();return this.lf=new ld(this.ff,this.rf),this.lf.start(n,t,e)},Ud._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new _r(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Xr(t)},Object.defineProperty(Ud.prototype,"app",{get:function(){if(!this.cf)throw new _r(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Ud.prototype.collection=function(t){return fp("Firestore.collection","path",t),this.uf(),new Qd(oi.q(t),this,null)},Ud.prototype.doc=function(t){return fp("Firestore.doc","path",t),this.uf(),Dd.mf(oi.q(t),this,null)},Ud.prototype.collectionGroup=function(t){if(fp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Xd((t=t,new uu(oi.U(),t)),this,null)},Ud.prototype.runTransaction=function(e){var n=this;return this.uf().transaction(function(t){return e(new Nd(n,t))})},Ud.prototype.batch=function(){return this.uf(),new Sd(this)},Ud.prototype.sf=function(){return this.df},Ud),Nd=(Md.prototype.get=function(t){var e=this,n=ty(0,t,this.Af);return this.Rf.b_([n.__]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof ou)return new Od(e.Af,n.__,null,!1,!1,n.f_);if(t instanceof iu)return new Od(e.Af,n.__,t,!1,!1,n.f_);throw Pr()})},Md.prototype.set=function(t,e,n){t=ty(0,t,this.Af);n=lp("Transaction.set",n);e=ey(t.f_,e,n),n=$p(this.Af.wf,"Transaction.set",t.__,e,null!==t.f_,n);return this.Rf.set(t.__,n),this},Md.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof wp?(r=ty(0,t,this.Af),td(this.Af.wf,"Transaction.update",r.__,e,n,i)):(r=ty(0,t,this.Af),Zp(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,e),this},Md.prototype.delete=function(t){t=ty(0,t,this.Af);return this.Rf.delete(t.__),this},Md),Sd=(Cd.prototype.set=function(t,e,n){this.Vf();t=ty(0,t,this.Af);n=lp("WriteBatch.set",n);e=ey(t.f_,e,n),n=$p(this.Af.wf,"WriteBatch.set",t.__,e,null!==t.f_,n);return this.Pf=this.Pf.concat(n.d_(t.__,Ss.ze())),this},Cd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.Vf(),e="string"==typeof e||e instanceof wp?(r=ty(0,t,this.Af),td(this.Af.wf,"WriteBatch.update",r.__,e,n,i)):(r=ty(0,t,this.Af),Zp(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(e.d_(r.__,Ss.exists(!0))),this},Cd.prototype.delete=function(t){this.Vf();t=ty(0,t,this.Af);return this.Pf=this.Pf.concat(new Ws(t.__,Ss.ze())),this},Cd.prototype.commit=function(){return this.Vf(),this.gf=!0,0<this.Pf.length?this.Af.uf().write(this.Pf):Promise.resolve()},Cd.prototype.Vf=function(){if(this.gf)throw new _r(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Cd),Dd=(n(Vd,md=Mp),Vd.mf=function(t,e,n){if(t.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new Vd(new ai(t),e,n)},Object.defineProperty(Vd.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"parent",{get:function(){return new Qd(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),Vd.prototype.collection=function(t){if(fp("DocumentReference.collection","path",t),!t)throw new _r(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=oi.q(t);return new Qd(this.__.path.child(t),this.firestore,null)},Vd.prototype.isEqual=function(t){return t instanceof Vd&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},Vd.prototype.set=function(t,e){e=lp("DocumentReference.set",e);t=ey(this.f_,t,e),e=$p(this.firestore.wf,"DocumentReference.set",this.__,t,null!==this.f_,e);return this.lf.write(e.d_(this.__,Ss.ze()))},Vd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof wp?td(this.firestore.wf,"DocumentReference.update",this.__,t,e,n):Zp(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(t.d_(this.__,Ss.exists(!0)))},Vd.prototype.delete=function(){return this.lf.write([new Ws(this.__,Ss.ze())])},Vd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||vd(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};vd(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.yf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(lu(this.__.path),o,s)},Vd.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then(function(t){return new Od(e.firestore,e.__,t,!0,t instanceof iu&&t.Ye,e.f_)}):n.U_(this.__,t).then(function(t){return e.yf(t)})},Vd.prototype.withConverter=function(t){return new Vd(this.__,this.firestore,t)},Vd.prototype.yf=function(t){var e=t.docs.get(this.__);return new Od(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},Vd),xd=(Rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Rd),Od=(Ld.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new kd(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new wd(this.Af.l_,t.serverTimestamps||"none",function(t){return new Dd(t,e.Af,null)},function(t){return new Wr(t)}).J_(this.pf.rn())}},Ld.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf){t=this.pf.data().field(sd("DocumentSnapshot.get",t,this.__));if(null!==t)return new wd(this.Af.l_,e.serverTimestamps||"none",function(t){return new Dd(t,n.Af,n.f_)},function(t){return new Wr(t)}).J_(t)}},Object.defineProperty(Ld.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"ref",{get:function(){return new Dd(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"metadata",{get:function(){return new xd(this.vf,this.bf)},enumerable:!1,configurable:!0}),Ld.prototype.isEqual=function(t){return t instanceof Ld&&this.Af===t.Af&&this.bf===t.bf&&this.__.isEqual(t.__)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.f_===t.f_},Ld),kd=(n(Pd,gd=Od),Pd.prototype.data=function(t){return gd.prototype.data.call(this,t)},Pd);function Pd(){return null!==gd&&gd.apply(this,arguments)||this}function Ld(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}function Rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Vd(t,e,n){var r=this;return(r=md.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.lf=r.firestore.uf(),r}function Cd(t){this.Af=t,this.Pf=[],this.gf=!1}function Md(t,e){this.Af=t,this.Rf=e}function Ud(t,e,n){var r=this;if(void 0===n&&(n=new _d),this.hf=n,this.cf=null,this.rf=new Sa,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){n=t;this.cf=n,this.l_=Ud._f(n),this.af=n.name,this.ff=new pf(e)}else{t=t;if(!t.projectId)throw new _r(Er.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Xr(t.projectId,t.database),this.af="[DEFAULT]",this.ff=new lf}this.df=new Id({})}function jd(){}function qd(){}function Fd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=wc._o;else{if(t.cacheSizeBytes!==bd&&t.cacheSizeBytes<wc.lo)throw new _r(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+wc.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,pp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Gd(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}function Bd(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(oi.q(n));if(!ai.X(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ao(t,new ai(e))}if(n instanceof Mp)return Ao(t,n.__);throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+dp(n)+".")}function zd(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Hd(t,e,n){if(!n.isEqual(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Kd(t){if(du(t)&&0===t.on.length)throw new _r(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd,Xd=(Zd.prototype.where=function(t,e,n){t=sd("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){zd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Bd(n,t,c))}h={arrayValue:{values:s}}}else h=Bd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||zd(o,i),h=ed(e,"Query.where",o,"in"===i||"not-in"===i);var h=xu.create(r,i,h);return function(t,e){if(e.un()){var n=vu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=yu(t);null!==n&&Hd(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Sf,this.firestore.wf,this.firestore.l_,t,e,n);return new Zd((n=this.Sf,e=n.filters.concat([e]),new uu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},Zd.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=sd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new ra(e,n);return n=e,null!==yu(t)||null!==(t=vu(t))&&Hd(0,t,n.field),e}(this.Sf,t,n);return new Zd((n=this.Sf,t=n.on.concat([t]),new uu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},Zd.prototype.limit=function(t){return yp("Query.limit",t),new Zd(bu(this.Sf,t,"F"),this.firestore,this.f_)},Zd.prototype.limitToLast=function(t){return yp("Query.limitToLast",t),new Zd(bu(this.Sf,t,"L"),this.firestore,this.f_)},Zd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.startAt",t,e,!0);return new Zd(Iu(this.Sf,t),this.firestore,this.f_)},Zd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.startAfter",t,e,!1);return new Zd(Iu(this.Sf,t),this.firestore,this.f_)},Zd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.endBefore",t,e,!0);return new Zd(Eu(this.Sf,t),this.firestore,this.f_)},Zd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.endAt",t,e,!1);return new Zd(Eu(this.Sf,t),this.firestore,this.f_)},Zd.prototype.isEqual=function(t){return t instanceof Zd&&this.firestore===t.firestore&&_u(this.Sf,t.Sf)&&this.f_===t.f_},Zd.prototype.withConverter=function(t){return new Zd(this.Sf,this.firestore,t)},Zd.prototype.Df=function(c,t,e,n){if(t instanceof Od)return function(t,e,n,r){if(!n)throw new _r(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new _r(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.B();throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Yu(i,r)}(this.Sf,this.firestore.l_,t.pf,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new _r(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!gu(t)&&-1!==c.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(oi.q(c));if(!ai.X(h))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ai(h);u.push(Ao(e,h))}else{c=ed(n,r,c);u.push(c)}}return new Yu(u,o)}(this.Sf,this.firestore.l_,this.firestore.wf,c,e,n)},Zd.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||vd(n[o])||(i=n[o],o++),vd(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Yd(e.firestore,e.Sf,t,e.f_))},error:n[o+1],complete:n[o+2]};return Kd(this.Sf),this.firestore.uf().listen(this.Sf,i,s)},Zd.prototype.get=function(t){var e=this;Kd(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then(function(t){return new Yd(e.firestore,e.Sf,t,e.f_)})},Zd),Yd=(Object.defineProperty($d.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),$d.prototype.forEach=function(e,n){var r=this;this.Nf.docs.forEach(function(t){e.call(n,r.kf(t,r.metadata.fromCache,r.Nf.Qt.has(t.key)))})},Object.defineProperty($d.prototype,"query",{get:function(){return new Xd(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),$d.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.Nf.jt)throw new _r(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===t||(this.xf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Nf,t,this.kf.bind(this)),this.Ff=t),this.xf},$d.prototype.isEqual=function(t){return t instanceof $d&&this.Af===t.Af&&_u(this.Cf,t.Cf)&&this.Nf.isEqual(t.Nf)&&this.f_===t.f_},$d.prototype.kf=function(t,e,n){return new kd(this.Af,t.key,t,e,n,this.f_)},$d),Qd=(n(Jd,Wd=Xd),Object.defineProperty(Jd.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Jd.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new Dd(new ai(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Jd.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),Jd.prototype.doc=function(t){0===arguments.length&&(t=Rr.t()),fp("CollectionReference.doc","path",t);t=oi.q(t);return Dd.mf(this.Sf.path.child(t),this.firestore,this.f_)},Jd.prototype.add=function(t){var t=this.f_?this.f_.toFirestore(t):t,e=this.doc();return new Dd(e.__,this.firestore,null).set(t).then(function(){return e})},Jd.prototype.withConverter=function(t){return new Jd(this.Of,this.firestore,t)},Jd);function Jd(t,e,n){var r=this;if(((r=Wd.call(this,lu(t),e,n)||this).Of=t).length%2!=1)throw new _r(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function $d(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new xd(n.hasPendingWrites,n.fromCache)}function Zd(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}function ty(t,e,n){e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new _r(Er.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=dp(t);throw new _r(Er.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,Dd);if(e.firestore!==n)throw new _r(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function ey(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ny,ry,Ie=(n(oy,ny=Vp),oy.serverTimestamp=function(){var t=new Op("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new oy(t)},oy.delete=function(){var t=new Ep("deleteField");return t.t_="FieldValue.delete",new oy(t)},oy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new oy(n)},oy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new oy(n)},oy.increment=function(t){t=new Lp("increment",t);return t.t_="FieldValue.increment",new oy(t)},oy.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},oy),iy={Firestore:Ad,GeoPoint:Rp,Timestamp:ri,Blob:Wr,Transaction:Nd,WriteBatch:Sd,DocumentReference:Dd,DocumentSnapshot:Od,Query:Xd,QueryDocumentSnapshot:kd,QuerySnapshot:Yd,CollectionReference:Qd,FieldPath:wp,FieldValue:Ie,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:bd};function oy(){return null!==ny&&ny.apply(this,arguments)||this}(ry=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Ad(e,t,new Td);var e},"PUBLIC").setServiceProps(Object.assign({},iy))),ry.registerVersion("@firebase/firestore","2.0.0-2020926155854")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
