!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(hd){"use strict";try{(function(){var u,t,e=(t=hd)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function R(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),S=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function _(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:_).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function x(){this.j=this.j,this.i=this.i}x.prototype.j=!1,x.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++S))},x.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var M=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function H(t,e){return t<e?-1:e<t?1:0}var X=O.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function K(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(X=X&&X.userAgent)?X:"";var Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Q.length;i++)e=Q[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=R;var Z,tt=z(ut,"Opera"),et=z(ut,"Trident")||z(ut,"MSIE"),nt=z(ut,"Edge"),rt=nt||et,it=z(ut,"Gecko")&&!(z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge"))&&!(z(ut,"Trident")||z(ut,"MSIE"))&&!z(ut,"Edge"),ot=z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge");function st(){var t=O.document;return t?t.documentMode:void 0}var X="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(X=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(X)?String(ut):X;var at={};function ht(u){return t=u,e=function(){for(var t=0,e=W(String(Z)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=H(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||H(0==o[2].length,0==s[2].length)||H(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ct=O.document&&et&&(st()||parseInt(Z,10))||void 0,lt=!et||9<=Number(ct),ft=et&&!ht("9"),pt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",R,e),O.removeEventListener("test",R,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},j(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ft)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=M(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function It(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=It(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),Nt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Vt(r),e&&e[gt]?e.wa(n,r,k(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Vt(n),t&&t[gt]?t.va(e,n,k(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!lt)return null;var u,a,h=Pt(t);if(h||(t[At]=h=new Et(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=St,r=a=lt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):bt(t)))}function kt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function Dt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function St(t,e){if(t.Y)return!0;if(lt)return Dt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Dt(t,e=new yt(e,this))}function Pt(t){return(t=t[At])instanceof Et?t:null}var _t="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vt(e){return"function"==typeof e?e:(e[_t]||(e[_t]=function(t){return e.handleEvent(t)}),e[_t])}function Ct(){x.call(this),this.c=new Et(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,J(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=jt(o,r,!0,e)&&s;if(s=jt(o=e.a=t,r,!0,e)&&s,s=jt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=jt(o=e.a=n[i],r,!1,e)&&s}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Ct,x),Ct.prototype[gt]=!0,(ut=Ct.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Vt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=It(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=It(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},ut.G=function(){if(Ct.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=O.JSON.stringify;function Mt(){this.b=this.a=null}var qt,Ft=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new Bt},function(t){t.reset()}));function Gt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Bt(){this.next=this.b=this.a=null}function Wt(t,e){var n;qt||(n=O.Promise.resolve(void 0),qt=function(){n.then(Xt)}),zt||(qt(),zt=!0),Ht.add(t,e)}Mt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Bt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var zt=!(Bt.prototype.reset=function(){this.next=this.b=this.a=null}),Ht=new Mt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Ht).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}zt=!1}function Yt(t,e){Ct.call(this),this.b=t||1,this.a=e||O,this.f=V(this.Za,this),this.g=U()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Qt(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j(Yt,Ct),(ut=Yt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Kt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},ut.G=function(){Yt.X.G.call(this),Kt(this),delete this.a};var Jt,$t,Zt=(I($t=ee,X=Jt=x),$t.prototype=null===X?Object.create(X):(te.prototype=X.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Qt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Jt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){x.call(this),this.b=t,this.a={}}j(ne,x);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return xt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},he=null;function ce(){return he=he||new Ct}function le(t){dt.call(this,ae.Fa,t)}function fe(){var t=ce();Ut(t,new le(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=ce();Ut(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}ae.Fa="serverreachability",j(le,dt),ae.STAT_EVENT="statevent",j(pe,dt),ae.Ga="timingevent",j(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ie(){dt.call(this,"d")}function Ae(){dt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Re,t=rt?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Ie,dt),j(Ae,dt),j(Ne,we),Te=new Ne;var Re=45e3,Le={},ke={};function De(t,e,n){t.H=1,t.i=Je(ze(e)),t.j=n,t.I=!0,Se(t,null)}function Se(t,e){t.u=U(),_e(t),t.l=ze(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(V(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?K(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?ke:(i=Number(u.substring(i,o)),isNaN(i)?Le:(o+=1)+i>u.length?ke:(u=u.substr(o,i),r.D=o+i,u)));if(u==ke){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Le){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),xe(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Ue(t))}function _e(t){t.T=U()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(V(t.Va,t),e)}function Ce(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function je(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function xe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Kn(u),de(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(V(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(z(r,"spdy")||z(r,"quic")||z(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Qe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),_e(o)),n.a=i):Yn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Oe.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),je(this),Ue(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,xe(this,s)}this.I?(Pe(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),xe(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,_e(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),je(this),Ue(this)}}}catch(t){}var u,a,h,c,l,f},ut.Wa=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Pe(this,t,e),this.b&&4!=t&&_e(this)))},ut.cancel=function(){this.A=!0,je(this)},ut.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de(17)),je(this),this.h=2,Ue(this)):Ve(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},ut.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,He(this,n[1]||"",!0),this.j=$e(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=$e(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new We(t)}function He(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?$e(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Qe(t,e,n){t.b.set(e,n)}function Je(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=F(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){Ct.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}j(On,Ct);var Rn="",Ln=/^https?$/i,kn=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Vn(t)}function Pn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function _n(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Qt(t.za,0,t);else if(Ut(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Ln.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Qe(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=xn("baseRetryDelayMs",5e3,t),this.Ra=xn("retryDelaySeedMs",1e4,t),this.Ma=xn("forwardChannelMaxRetries",2,t),this.ma=xn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,Qe(n=ze(t.B),"SID",t.J),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Hn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Je(ze(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),_e(e)),nr(t)}function Fn(t){t.a&&(Qn(t),t.a.cancel(),t.a=null)}function Gn(t){Fn(t),t.j&&(O.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Wn(t)}function Wn(t){vn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);Qe(r,"SID",t.J),Qe(r,"RID",n),Qe(r,"AID",t.P),Hn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),De(n,r,e)}function Hn(t,n){t.f&&Me({},function(t,e){Qe(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Me(t,function(t,e){var n=t;k(t)&&(n=xt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(V(t.Aa,t),tr(t,t.o)),t.o++,1)}function Qn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);Qe(e,"RID","rpc"),Qe(e,"SID",t.J),Qe(e,"CI",t.H?"0":"1"),Qe(e,"AID",t.P),Hn(t,e),Qe(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(ze(e)),n.j=null,n.I=!0,Se(n,t)}function $n(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Qn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=ce(),new ye(s)),Wn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(V(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Kn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||He(r,"https"),Je(r)),n=r.toString(),r=o,o=new se,O.Image?((i=new Image).onload=C(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(An,o,i,"TestLoadImage: error",!1,r),i.onabort=C(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?ze(s):new We(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),Ye(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&He(u,r),i&&Xe(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Qe(a,e,t)}),e=t.A,n=t.na,e&&n&&Qe(a,e,n),Qe(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ct)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ct.call(this),this.a=new Mn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(ut=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&Me(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Dn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=M(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,et&&ht(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Vn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?_n(this):this.Ua())},ut.Ua=function(){_n(this)},ut.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=Mn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=K(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Qe(i=ze(this.B),"RID",t),Qe(i,"CVER",22),this.A&&Qe(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&jn(i,this.i,r),wn(this.b,n),this.Ia&&Qe(i,"TYPE","init"),this.da?(Qe(i,"$req",e),Qe(i,"SID","null"),n.U=!0,De(n,i,null)):De(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},ut.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(V(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Jn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Kn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},j(ur,Ct),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Wn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=xt(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},j(ar,Ie),j(hr,Ae),j(cr,or),cr.prototype.ta=function(){Ut(this.a,"a")},cr.prototype.sa=function(t){Ut(this.a,new ar(t))},cr.prototype.ra=function(t){Ut(this.a,new hr)},cr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ct.prototype.listen=Ct.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Pa,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ce,fr=ge,pr=me,dr=ae,yr=Ee,vr=On,ge=(gr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gr);function gr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},wr=(Object.defineProperty(Tr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Tr.prototype.isEqual=function(t){return t instanceof Tr&&t.projectId===this.projectId&&t.database===this.database},Tr),br=(Er.prototype.u=function(){return null!=this.uid},Er.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Er.prototype.isEqual=function(t){return t.uid===this.uid},Er);function Er(t){this.uid=t}function Tr(t,e){this.projectId=t,this.database=e||"(default)"}br.UNAUTHENTICATED=new br(null),br.l=new br("google-credentials-uid"),br._=new br("first-party-uid");var Ir=new l("@firebase/firestore");function Ar(){return Ir.logLevel}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.DEBUG&&(e=n.map(Lr),Ir.debug.apply(Ir,s(["Firestore (8.1.1): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.ERROR&&(e=n.map(Lr),Ir.error.apply(Ir,s(["Firestore (8.1.1): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.WARN&&(e=n.map(Lr),Ir.warn.apply(Ir,s(["Firestore (8.1.1): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){throw void 0===t&&(t="Unexpected state"),Or(t="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Dr(t){t||kr()}function Sr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Pr,_r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Vr=(n(Br,Pr=Error),Br),Cr=(Gr.prototype.getToken=function(){return Promise.resolve(null)},Gr.prototype.A=function(){},Gr.prototype.I=function(t){(this.T=t)(br.UNAUTHENTICATED)},Gr.prototype.R=function(){this.T=null},Gr),Ur=(Fr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new Sr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fr.prototype.A=function(){this.forceRefresh=!0},Fr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Fr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Fr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new br(t)},Fr),jr=(Object.defineProperty(qr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),qr),xr=(Mr.prototype.getToken=function(){return Promise.resolve(new jr(this.v,this.C))},Mr.prototype.I=function(t){t(br._)},Mr.prototype.R=function(){},Mr.prototype.A=function(){},Mr);function Mr(t,e){this.v=t,this.C=e}function qr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=br._}function Fr(t){var e=this;this.P=null,this.currentUser=br.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Gr(){this.T=null}function Br(t,e){var n=this;return(n=Pr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Wr=(zr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},zr);function zr(){}function Hr(t,e){return t<e?-1:e<t?1:0}function Xr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Yr,Kr,Qr=(ui.now=function(){return ui.fromMillis(Date.now())},ui.fromDate=function(t){return ui.fromMillis(t.getTime())},ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new ui(e,1e6*(t-1e3*e))},ui.prototype.toDate=function(){return new Date(this.toMillis())},ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ui.prototype.D=function(t){return this.seconds===t.seconds?Hr(this.nanoseconds,t.nanoseconds):Hr(this.seconds,t.seconds)},ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ui.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ui),Jr=(si.N=function(t){return new si(t)},si.min=function(){return new si(new Qr(0,0))},si.prototype.F=function(t){return this.timestamp.D(t.timestamp)},si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},si.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},si.prototype.L=function(){return this.timestamp},si),me=(Object.defineProperty(oi.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),oi.prototype.isEqual=function(t){return 0===oi.k(this,t)},oi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof oi?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},oi.prototype.limit=function(){return this.offset+this.length},oi.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},oi.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},oi.prototype.B=function(){return this.segments[this.offset]},oi.prototype.j=function(){return this.get(this.length-1)},oi.prototype.get=function(t){return this.segments[this.offset+t]},oi.prototype.W=function(){return 0===this.length},oi.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},oi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},oi.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},oi),$r=(n(ii,Kr=me),ii.prototype.M=function(t,e,n){return new ii(t,e,n)},ii.prototype.Y=function(){return this.H().join("/")},ii.prototype.toString=function(){return this.Y()},ii.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Vr(_r.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ii(n)},ii.X=function(){return new ii([])},ii),Zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=(n(ri,Yr=me),ri.prototype.M=function(t,e,n){return new ri(t,e,n)},ri.Z=function(t){return Zr.test(t)},ri.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ri.Z(t)||(t="`"+t+"`"),t}).join(".")},ri.prototype.toString=function(){return this.Y()},ri.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ri.nt=function(){return new ri(["__name__"])},ri.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Vr(_r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Vr(_r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Vr(_r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Vr(_r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ri(e)},ri.X=function(){return new ri([])},ri),ei=(ni.st=function(t){return new ni($r.J(t))},ni.it=function(t){return new ni($r.J(t).U(5))},ni.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ni.prototype.isEqual=function(t){return null!==t&&0===$r.k(this.path,t.path)},ni.prototype.toString=function(){return this.path.toString()},ni.k=function(t,e){return $r.k(t.path,e.path)},ni.ot=function(t){return t.length%2==0},ni.ut=function(t){return new ni(new $r(t.slice()))},ni);function ni(t){this.path=t}function ri(){return null!==Yr&&Yr.apply(this,arguments)||this}function ii(){return null!==Kr&&Kr.apply(this,arguments)||this}function oi(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.$=n}function si(t){this.timestamp=t}function ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Vr(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Vr(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Vr(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Vr(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ai(t){return null==t}function hi(t){return 0===t&&1/t==-1/0}var ci=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function li(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ci(t,e,n,r,i,o,s)}function fi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Y()+t.op.toString()+go(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Y()+t.dir}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Fu(e.startAt)),e.endAt&&(t+="|ub:",t+=Fu(e.endAt)),e.ct=t),e.ct}function pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!fo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function di(t){return ei.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},vi.prototype.ht=function(){return 2*this.at.length},vi.prototype.F=function(t){return Hr(this.at,t.at)},vi.prototype.isEqual=function(t){return this.at===t.at},vi);function vi(t){this.at=t}function gi(t){this.count=t}yi.lt=new yi("");var mi,wi=(bi.prototype.dt=function(t){return new bi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bi.prototype.wt=function(t,e){return new bi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bi.prototype.Et=function(t){return new bi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},bi);function bi(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=yi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ei(t){switch(t){case _r.OK:return kr(),0;case _r.CANCELLED:case _r.UNKNOWN:case _r.DEADLINE_EXCEEDED:case _r.RESOURCE_EXHAUSTED:case _r.INTERNAL:case _r.UNAVAILABLE:case _r.UNAUTHENTICATED:return;case _r.INVALID_ARGUMENT:case _r.NOT_FOUND:case _r.ALREADY_EXISTS:case _r.PERMISSION_DENIED:case _r.FAILED_PRECONDITION:case _r.ABORTED:case _r.OUT_OF_RANGE:case _r.UNIMPLEMENTED:case _r.DATA_LOSS:return 1;default:return kr(),0}}function Ti(t){if(void 0===t)return Or("GRPC error has no .code"),_r.UNKNOWN;switch(t){case mi.OK:return _r.OK;case mi.CANCELLED:return _r.CANCELLED;case mi.UNKNOWN:return _r.UNKNOWN;case mi.DEADLINE_EXCEEDED:return _r.DEADLINE_EXCEEDED;case mi.RESOURCE_EXHAUSTED:return _r.RESOURCE_EXHAUSTED;case mi.INTERNAL:return _r.INTERNAL;case mi.UNAVAILABLE:return _r.UNAVAILABLE;case mi.UNAUTHENTICATED:return _r.UNAUTHENTICATED;case mi.INVALID_ARGUMENT:return _r.INVALID_ARGUMENT;case mi.NOT_FOUND:return _r.NOT_FOUND;case mi.ALREADY_EXISTS:return _r.ALREADY_EXISTS;case mi.PERMISSION_DENIED:return _r.PERMISSION_DENIED;case mi.FAILED_PRECONDITION:return _r.FAILED_PRECONDITION;case mi.ABORTED:return _r.ABORTED;case mi.OUT_OF_RANGE:return _r.OUT_OF_RANGE;case mi.UNIMPLEMENTED:return _r.UNIMPLEMENTED;case mi.DATA_LOSS:return _r.DATA_LOSS;default:return kr()}}(l=mi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ii=(Li.prototype.Tt=function(t,e){return new Li(this.k,this.root.Tt(t,e,this.k).copy(null,null,Ni.At,null,null))},Li.prototype.remove=function(t){return new Li(this.k,this.root.remove(t,this.k).copy(null,null,Ni.At,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype.W=function(){return this.root.W()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.It=function(){return this.root.It()},Li.prototype.Rt=function(){return this.root.Rt()},Li.prototype.Pt=function(t){return this.root.Pt(t)},Li.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.yt=function(t){return this.root.yt(t)},Li.prototype.Vt=function(){return new Ai(this.root,null,this.k,!1)},Li.prototype.gt=function(t){return new Ai(this.root,t,this.k,!1)},Li.prototype.vt=function(){return new Ai(this.root,null,this.k,!0)},Li.prototype.bt=function(t){return new Ai(this.root,t,this.k,!0)},Li),Ai=(Ri.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Ri.prototype.Nt=function(){return 0<this.St.length},Ri.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Ri),Ni=(Oi.prototype.copy=function(t,e,n,r,i){return new Oi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Oi.prototype.W=function(){return!1},Oi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Oi.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Oi.prototype.min=function(){return this.left.W()?this:this.left.min()},Oi.prototype.It=function(){return this.min().key},Oi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Oi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Oi.prototype.Ot=function(){if(this.left.W())return Oi.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Oi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Oi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Oi.prototype.Lt=function(){return this.color},Oi.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Oi.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Oi.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Oi.prototype.Ut=function(){var t=this.copy(null,null,Oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Oi.prototype.kt=function(){var t=this.copy(null,null,Oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Oi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Oi.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Oi.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw kr();if(this.right.Lt())throw kr();var t=this.left.Qt();if(t!==this.right.Qt())throw kr();return t+(this.Lt()?0:1)},Oi);function Oi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Oi.RED,this.left=null!=r?r:Oi.EMPTY,this.right=null!=i?i:Oi.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Li(t,e){this.k=t,this.root=e||Ni.EMPTY}function ki(){this.size=0}Ni.EMPTY=null,Ni.RED=!0,Ni.At=!1,Ni.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.Tt=function(t,e,n){return new Ni(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype.W=function(){return!0},ki.prototype.Pt=function(t){return!1},ki.prototype.yt=function(t){return!1},ki.prototype.It=function(){return null},ki.prototype.Rt=function(){return null},ki.prototype.Lt=function(){return!1},ki.prototype.Bt=function(){return!0},ki.prototype.Qt=function(){return 0},new ki);var Di=(Vi.prototype.has=function(t){return null!==this.data.get(t)},Vi.prototype.first=function(){return this.data.It()},Vi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Vi.prototype.indexOf=function(t){return this.data.indexOf(t)},Vi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Vi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Vi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Vi.prototype.Gt=function(t){return(t=this.data.gt(t)).Nt()?t.Dt().key:null},Vi.prototype.Vt=function(){return new Si(this.data.Vt())},Vi.prototype.gt=function(t){return new Si(this.data.gt(t))},Vi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Vi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Vi.prototype.W=function(){return this.data.W()},Vi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Vi.prototype.isEqual=function(t){if(!(t instanceof Vi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Vi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Vi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Vi.prototype.copy=function(t){var e=new Vi(this.k);return e.data=t,e},Vi),Si=(_i.prototype.Dt=function(){return this.zt.Dt().key},_i.prototype.Nt=function(){return this.zt.Nt()},_i),Pi=new Ii(ei.k);function _i(t){this.zt=t}function Vi(t){this.k=t,this.data=new Ii(this.k)}var Ci=new Ii(ei.k),Ui=new Ii(ei.k),ji=new Di(ei.k);function xi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ji,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mi=new Di(Hr),qi=(no.Jt=function(t){return new no(t.k)},no.prototype.has=function(t){return null!=this.Ht.get(t)},no.prototype.get=function(t){return this.Ht.get(t)},no.prototype.first=function(){return this.Yt.It()},no.prototype.last=function(){return this.Yt.Rt()},no.prototype.W=function(){return this.Yt.W()},no.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Yt.indexOf(t):-1},Object.defineProperty(no.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),no.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},no.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},no.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},no.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},no.prototype.copy=function(t,e){var n=new no;return n.k=this.k,n.Ht=t,n.Yt=e,n},no),Fi=(eo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):kr()},eo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},eo),Gi=(to.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new to(t,e,qi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&cu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},to),Bi=(Zi.hn=function(t,e){var n=new Map;return n.set(t,Wi.ln(t,e)),new Zi(Jr.min(),n,Mi,Pi,xi())},Zi),Wi=($i.ln=function(t,e){return new $i(yi.lt,e,xi(),xi(),xi())},$i),zi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Hi=function(t,e){this.targetId=t,this.Tn=e},Xi=function(t,e,n,r){void 0===n&&(n=yi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Yi=(Object.defineProperty(Ji.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),Ji.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},Ji.prototype.vn=function(){var n=xi(),r=xi(),i=xi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Wi(this.Rn,this.Pn,n,r,i)},Ji.prototype.bn=function(){this.yn=!1,this.In=io()},Ji.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},Ji.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},Ji.prototype.Dn=function(){this.An+=1},Ji.prototype.Nn=function(){--this.An},Ji.prototype.xn=function(){this.yn=!0,this.Pn=!0},Ji),Ki=(Qi.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof Ys?this.Un(r,t.mn):t.mn instanceof Ks&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},Qi.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:kr()}})},Qi.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},Qi.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.zn(e))&&(di(t=t.target)?0===n?(t=new ei(t.path),this.qn(e,t,new Ks(t,Jr.min()))):Dr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},Qi.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&di(n.target)&&(n=new ei(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new Ks(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=xi();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.zn(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Bi(r,o,this.kn,this.Ln,s);return this.Ln=Pi,this.$n=ro(),this.kn=new Di(Hr),t},Qi.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},Qi.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},Qi.prototype.removeTarget=function(t){this.On.delete(t)},Qi.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},Qi.prototype.Dn=function(t){this.jn(t).Dn()},Qi.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Yi,this.On.set(t,e)),e},Qi.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new Di(Hr),this.$n=this.$n.Tt(t,e)),e},Qi.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},Qi.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},Qi.prototype.Gn=function(e){var n=this;this.On.set(e,new Yi),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},Qi.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},Qi);function Qi(t){this.Fn=t,this.On=new Map,this.Ln=Pi,this.$n=ro(),this.kn=new Di(Hr)}function Ji(){this.An=0,this.In=io(),this.Rn=yi.lt,this.Pn=!1,this.yn=!0}function $i(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function Zi(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function to(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function eo(){this.Xt=new Ii(ei.k)}function no(n){this.k=n?function(t,e){return n(t,e)||ei.k(t.key,e.key)}:function(t,e){return ei.k(t.key,e.key)},this.Ht=Ci,this.Yt=new Ii(this.k)}function ro(){return new Ii(ei.k)}function io(){return new Ii(ei.k)}function oo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function so(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ao(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ho(t){return t=mo(t.mapValue.fields.__local_write_time__.timestampValue),new Qr(t.seconds,t.nanos)}var co=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ao(t)?4:10:kr()}function fo(r,i){var t,e=lo(r);if(e!==lo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ho(r).isEqual(ho(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=mo(r.timestampValue),t=mo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,bo(r.bytesValue).isEqual(bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,wo((t=r).geoPointValue.latitude)===wo(e.geoPointValue.latitude)&&wo(t.geoPointValue.longitude)===wo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?wo(e.integerValue)===wo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=wo(e.doubleValue))===(t=wo(t.doubleValue))?hi(e)===hi(t):isNaN(e)&&isNaN(t));case 9:return Xr(r.arrayValue.values||[],i.arrayValue.values||[],fo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(oo(e)!==oo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!fo(e[t],n[t])))return!1;return!0}();default:return kr()}}function po(t,e){return void 0!==(t.values||[]).find(function(t){return fo(t,e)})}function yo(t,e){var n,r,i,o=lo(t),s=lo(e);if(o!==s)return Hr(o,s);switch(o){case 0:return 0;case 1:return Hr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=wo(t.integerValue||t.doubleValue))<(n=wo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return vo(t.timestampValue,e.timestampValue);case 4:return vo(ho(t),ho(e));case 5:return Hr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=bo(i),s=bo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Hr(n[i],r[i]);if(0!==o)return o}return Hr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Hr(wo(o.latitude),wo(r.latitude)))?n:Hr(wo(o.longitude),wo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=yo(n[i],r[i]);if(o)return o}return Hr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Hr(r[s],o[s]);if(0!==u)return u;if(0!==(u=yo(n[r[s]],i[o[s]])))return u}return Hr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function vo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Hr(t,e);var n=mo(t),t=mo(e);return 0!==(e=Hr(n.seconds,t.seconds))?e:Hr(n.nanos,t.nanos)}function go(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=mo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?bo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ei.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e}(t)}function mo(t){if(Dr(!!t),"string"!=typeof t)return{seconds:wo(t.seconds),nanos:wo(t.nanos)};var e=0,n=co.exec(t);return Dr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function wo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function bo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function Eo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function To(t){return t&&"integerValue"in t}function Io(t){return!!t&&"arrayValue"in t}function Ao(t){return t&&"nullValue"in t}function No(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var Ro={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ko=function(t,e){this.t=t,this.ne=e};function Do(t){return{integerValue:""+t}}function So(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hi(e)?"-0":e}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!hi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Do(e):So(t,e);var n}function _o(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.ne?e.toBase64():e.toUint8Array()}function Co(t){return Dr(!!t),Jr.N((t=mo(t),new Qr(t.seconds,t.nanos)))}function Uo(t,e){return new $r(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function jo(t){return Dr(Qo(t=$r.J(t))),t}function xo(t,e){return Uo(t.t,e.path)}function Mo(t,e){if((e=jo(e)).get(1)!==t.t.projectId)throw new Vr(_r.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Vr(_r.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ei(Go(e))}function qo(t,e){return Uo(t.t,e)}function Fo(t){return new $r(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Go(t){return Dr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Bo(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Wo(t,e){var n,r,i;if(e instanceof Os)n={update:Bo(t,e.key,e.value)};else if(e instanceof js)n={delete:xo(t,e.key)};else if(e instanceof Rs)n={update:Bo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Ps)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ts)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof es)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof cs)return{fieldPath:t.field.Y(),increment:e.se};throw kr()})}};else{if(!(e instanceof xs))return kr();n={verify:xo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:_o(e=t,(t=i.updateTime).L())}:void 0!==i.exists?{exists:i.exists}:kr()),n}function zo(t){var e=4===(o=jo(t.parent)).length?$r.X():Go(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Dr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ko(t.unaryFilter.field);return vu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ko(t.unaryFilter.field);return vu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Ko(t.unaryFilter.field),vu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Ko(t.unaryFilter.field),vu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[(n=e,vu.create(Ko(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Wu(Ko((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ai(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Xo(n.startAt));var u=null;return n.endAt&&(u=Xo(n.endAt)),new Js(e,i,t,o,r,"F",s,u)}function Ho(t){return{before:t.before,values:t.position}}function Xo(t){var e=!!t.before,t=t.values||[];return new Uu(t,e)}function Yo(t){return{fieldPath:t.Y()}}function Ko(t){return ti.et(t.fieldPath)}function Qo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Jo(t,e){return t instanceof cs?To(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var $o,Zo,ts=(n(rs,Zo=me=function(){this.oe=void 0}),rs),es=(n(ns,$o=me),ns);function ns(t){var e=this;return(e=$o.call(this)||this).elements=t,e}function rs(){return null!==Zo&&Zo.apply(this,arguments)||this}function is(t,e){for(var n=ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return fo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var os,ss=(n(us,os=me),us);function us(t){var e=this;return(e=os.call(this)||this).elements=t,e}function as(t,e){for(var n=ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!fo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var hs,cs=(n(ls,hs=me),ls);function ls(t,e){var n=this;return(n=hs.call(this)||this).serializer=t,n.se=e,n}function fs(t){return wo(t.integerValue||t.doubleValue)}function ps(t){return Io(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ds(t,e){this.field=t,this.transform=e}var ys=(vs.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},vs.prototype.isEqual=function(t){return Xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},vs);function vs(t){(this.fields=t).sort(ti.k)}function gs(t,e){this.version=t,this.transformResults=e}var ms=(ws.ce=function(){return new ws},ws.exists=function(t){return new ws(void 0,t)},ws.updateTime=function(t){return new ws(t)},Object.defineProperty(ws.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ws.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ws);function ws(t,e){this.updateTime=t,this.exists=e}function bs(t,e){return void 0!==t.updateTime?e instanceof Ys&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ys}function Es(t,e,n,r){return t instanceof Os?(o=e,bs((i=t).re,o)?(o=Is(o),new Ys(i.key,o,i.value,{ae:!0})):o):t instanceof Rs?function(t,e){if(!bs(t.re,e))return e;var n=Is(e),e=Ds(t,e);return new Ys(t.key,n,e,{ae:!0})}(t,e):t instanceof Ps?function(t,e,n,r){if(!bs(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Ys&&(c=n.field(a.field)),null===c&&r instanceof Ys&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof ts?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof es?is(h,i):h instanceof ss?as(h,i):(i=fs(h=Jo(c=h,i))+fs(c.se),To(h)&&To(c.se)?Do(i):So(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Vs(t,i.data(),r);return new Ys(t.key,i.version,r,{ae:!0})}(t,e,r,n):bs(t.re,e)?new Ks(t.key,Jr.min()):e;var i,o}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Xr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof es&&e instanceof es||t instanceof ss&&e instanceof ss?Xr(t.elements,e.elements,fo):t instanceof cs&&e instanceof cs?fo(t.se,e.se):t instanceof ts&&e instanceof ts)}))}function Is(t){return t instanceof Ys?t.version:Jr.min()}var As,Ns,Os=(n(ks,Ns=l=function(){}),ks),Rs=(n(Ls,As=l),Ls);function Ls(t,e,n,r){var i=this;return(i=As.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function ks(t,e,n){var r=this;return(r=Ns.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Ds(t,e){return n=t,e=e instanceof Ys?e.data():Ms.empty(),r=new qs(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var Ss,Ps=(n(_s,Ss=l),_s);function _s(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=ms.exists(!0),n}function Vs(t,e,n){for(var r=new qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Cs,Us,js=(n(Ws,Us=l),Ws),xs=(n(Bs,Cs=l),Bs),Ms=(Gs.empty=function(){return new Gs({mapValue:{}})},Gs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Gs.prototype.isEqual=function(t){return fo(this.proto,t.proto)},Gs),qs=(Fs.prototype.set=function(t,e){return this.fe(t,e),this},Fs.prototype.delete=function(t){return this.fe(t,null),this},Fs.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===lo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},Fs.prototype.he=function(){var t=this.de(ti.X(),this._e);return null!=t?new Ms(t):this.le},Fs.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=Ms.empty()),this.le=t,this._e=new Map}function Gs(t){this.proto=t}function Bs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.re=e,n.type=4,n}function Ws(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.re=e,n.type=3,n}var zs,Hs,Xs,Ys=(n(tu,Xs=me=function(t,e){this.key=t,this.version=e}),tu.prototype.field=function(t){return this.we.field(t)},tu.prototype.data=function(){return this.we},tu.prototype.Ee=function(){return this.we.proto},tu.prototype.isEqual=function(t){return t instanceof tu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},tu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu),Ks=(n(Zs,Hs=me),Zs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Qs=(n($s,zs=me),$s.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s),Js=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function $s(){return null!==zs&&zs.apply(this,arguments)||this}function Zs(t,e,n){var r=this;return(r=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function tu(t,e,n,r){var i=this;return(i=Xs.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function eu(t){return new Js(t)}function nu(t){return!ai(t.limit)&&"F"===t.limitType}function ru(t){return!ai(t.limit)&&"L"===t.limitType}function iu(t){return 0<t.me.length?t.me[0].field:null}function ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function su(t){return null!==t.collectionGroup}function uu(t){var e=t;if(null===e.Te){e.Te=[];var n=ou(e),t=iu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Wu(n)),e.Te.push(new Wu(ti.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Wu(ti.nt(),n)))}}return e.Te}function au(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=li(e.path,e.collectionGroup,uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=uu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Wu(o.field,s))}var u=e.endAt?new Uu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Uu(e.startAt.position,!e.startAt.before):null;e.Ae=li(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function hu(t,e,n){return new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cu(t,e){return pi(au(t),au(e))&&t.limitType===e.limitType}function lu(t){return fi(au(t))+"|lt:"+t.limitType}function fu(t){return"Query(target="+(n=(e=au(t)).path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Y()+" "+t.op+" "+go(t.value)}).join(", ")+"]"),ai(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Fu(e.startAt)),e.endAt&&(n+=", endAt: "+Fu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function pu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):ei.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Gu(t.startAt,uu(t),n))&&(!t.endAt||!Gu(t.endAt,uu(t),n)));var e,n}function du(u){return function(t,e){for(var n=!1,r=0,i=uu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?ei.k(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?yo(e,r):kr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var yu,vu=(n(gu,yu=function(){}),gu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Eu(t,e,n):"array-contains"===e?new Pu(t,n):"in"===e?new _u(t,n):"not-in"===e?new Vu(t,n):"array-contains-any"===e?new Cu(t,n):new gu(t,e,n)},gu.Re=function(t,e,n){return new("in"===e?Tu:Iu)(t,n)},gu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pe(yo(t,this.value)):null!==t&&lo(this.value)===lo(t)&&this.Pe(yo(t,this.value))},gu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},gu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},gu);function gu(t,e,n){var r=this;return(r=yu.call(this)||this).field=t,r.op=e,r.value=n,r}var mu,wu,bu,Eu=(n(Ou,bu=vu),Ou.prototype.matches=function(t){return t=ei.k(t.key,this.key),this.Pe(t)},Ou),Tu=(n(Nu,wu=vu),Nu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Nu),Iu=(n(Au,mu=vu),Au.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Au);function Au(t,e){var n=this;return(n=mu.call(this,t,"not-in",e)||this).keys=Ru(0,e),n}function Nu(t,e){var n=this;return(n=wu.call(this,t,"in",e)||this).keys=Ru(0,e),n}function Ou(t,e,n){var r=this;return(r=bu.call(this,t,e,n)||this).key=ei.it(n.referenceValue),r}function Ru(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ei.it(t.referenceValue)})}var Lu,ku,Du,Su,Pu=(n(qu,Su=vu),qu.prototype.matches=function(t){return Io(t=t.field(this.field))&&po(t.arrayValue,this.value)},qu),_u=(n(Mu,Du=vu),Mu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&po(this.value.arrayValue,t)},Mu),Vu=(n(xu,ku=vu),xu.prototype.matches=function(t){return!po(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!po(this.value.arrayValue,t))},xu),Cu=(n(ju,Lu=vu),ju.prototype.matches=function(t){var e=this;return!(!Io(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return po(e.value.arrayValue,t)})},ju),Uu=function(t,e){this.position=t,this.before=e};function ju(t,e){return Lu.call(this,t,"array-contains-any",e)||this}function xu(t,e){return ku.call(this,t,"not-in",e)||this}function Mu(t,e){return Du.call(this,t,"in",e)||this}function qu(t,e){return Su.call(this,t,"array-contains",e)||this}function Fu(t){return(t.before?"b":"a")+":"+t.position.map(go).join(",")}function Gu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ei.k(ei.it(s.referenceValue),n.key):yo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!fo(t.position[n],e.position[n]))return!1;return!0}var Wu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},zu=(Zu.prototype.Ve=function(t,e,n){for(var r,i,o,s,u,a=n.pe,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof Os?new Ys(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Rs?(u=i,c=o,bs((s=r).re,u)?(u=Ds(s,u),new Ys(s.key,c.version,u,{hasCommittedMutations:!0})):new Qs(s.key,c.version)):r instanceof Ps?function(t,e,n){if(Dr(null!=n.transformResults),!bs(t.re,e))return new Qs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ys&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof es?is(o,s):o instanceof ss?as(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Vs(t,r.data(),e);return new Ys(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Ks(r.key,o.version,{hasCommittedMutations:!0}))}return e},Zu.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Es(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Es(a,e,o,this.ye))}return e},Zu.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},Zu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},xi())},Zu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Xr(this.mutations,t.mutations,Ts)&&Xr(this.baseMutations,t.baseMutations,Ts)},Zu),Hu=($u.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Ui,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new $u(t,e,n,r)},$u),Xu=(Ju.prototype.get=function(t){var e=this.Se(t);if(void 0!==(e=this.Ne[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.De(i,t))return o}},Ju.prototype.has=function(t){return void 0!==this.get(t)},Ju.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},Ju.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},Ju.prototype.forEach=function(s){so(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ju.prototype.W=function(){return uo(this.Ne)},Ju),Yu=(Qu.prototype.catch=function(t){return this.next(void 0,t)},Qu.prototype.next=function(r,i){var o=this;return this.Le&&kr(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new Qu(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},Qu.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Qu.prototype.Ue=function(t){try{var e=t();return e instanceof Qu?e:Qu.resolve(e)}catch(t){return Qu.reject(t)}},Qu.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):Qu.resolve(e)},Qu.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):Qu.reject(e)},Qu.resolve=function(n){return new Qu(function(t,e){t(n)})},Qu.reject=function(n){return new Qu(function(t,e){e(n)})},Qu.qe=function(t){return new Qu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Qu.Be=function(t){for(var n=Qu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Qu.resolve(t):e()})}(r[e]);return n},Qu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},Qu),Ku=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function Qu(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function Ju(t,e){this.Se=t,this.De=e,this.Ne={}}function $u(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function Zu(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function ta(t){return new ko(t,!0)}function ea(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var na=(ua.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},ua.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},ua.prototype.Ye=function(t,e,i){var o=Pi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},ua.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},ua.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Pi;return t.forEach(function(t,e){e=e||new Ks(t,Jr.min()),n=n.Tt(t,e)}),n})},ua.prototype.ts=function(t,e,n){return r=e,ei.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):su(e)?this.es(t,e,n):this.ss(t,e,n);var r},ua.prototype.ns=function(t,e){return this.Ge(t,new ei(e)).next(function(t){var e=Ci;return t instanceof Ys&&(e=e.Tt(t.key,t)),e})},ua.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=Ci;return this.We.rs(n,s).next(function(t){return Yu.forEach(t,function(t){var e=(e=r,t=t.child(s),new Js(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},ua.prototype.ss=function(e,n,t){var a,h,r=this;return this.Qe.ts(e,n,t).next(function(t){return a=t,r.je.os(e,n)}).next(function(t){return h=t,r.us(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Es(s,s=a.get(u),s,r.ye);a=s instanceof Ys?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){pu(n,e)||(a=a.remove(t))}),a})},ua.prototype.us=function(t,e,n){for(var r=xi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Rs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ys&&(h=h.Tt(t,e))}),h})},ua),ra=(sa.ls=function(t,e){for(var n=xi(),r=xi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new sa(t,e.fromCache,n,r)},sa),ia=(oa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},oa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},oa);function oa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function sa(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function ua(t,e,n){this.Qe=t,this.je=e,this.We=n}ia.Es=-1;var aa=(ha.prototype.reset=function(){this.ys=0},ha.prototype.gs=function(){this.ys=this.Ps},ha.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ha.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ha.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ha.prototype.bs=function(){return(Math.random()-.5)*this.ys},ha);function ha(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function ca(t){return"IndexedDbTransactionError"===t.name}function la(){return"undefined"!=typeof document?document:null}var fa=(ya.Ls=function(t,e,n,r,i){return(i=new ya(t,e,Date.now()+n,r,i)).start(n),i},ya.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},ya.prototype.Ds=function(){return this.ks()},ya.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Vr(_r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ya.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},ya.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},ya),pa=(Object.defineProperty(da.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),da.prototype.Ms=function(t){this.enqueue(t)},da.prototype.Ys=function(t){this.Js(),this.Xs(t)},da.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=la())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},da.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},da.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},da.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},da.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},da.prototype.Cs=function(t,e,n){var r=this;return this.Js(),-1<this.Gs.indexOf(t)&&(e=0),n=fa.Ls(this,t,e,n,function(t){return r.ei(t)}),this.Qs.push(n),n},da.prototype.Js=function(){this.js&&kr()},da.prototype.si=function(){},da.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},da.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},da.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},da.prototype.ui=function(t){this.Gs.push(t)},da.prototype.ei=function(t){t=this.Qs.indexOf(t),this.Qs.splice(t,1)},da);function da(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new aa(this,"async_queue_retry"),this.zs=function(){var t=la();t&&Nr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=la();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function ya(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new Ku,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function va(t,e){if(Or("AsyncQueue",e+": "+t),ca(t))return new Vr(_r.UNAVAILABLE,e+": "+t);throw t}function ga(t){this.ci=t}var ma=(Na.prototype.hi=function(t,e){return this.ai.add(e),Yu.resolve()},Na.prototype.rs=function(t,e){return Yu.resolve(this.ai.getEntries(e))},Na),wa=(Aa.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Di($r.k),t=!r.has(n);return this.index[e]=r.add(n),t},Aa.prototype.has=function(t){var e=t.j(),t=t.q();return(e=this.index[e])&&e.has(t)},Aa.prototype.getEntries=function(t){return(this.index[t]||new Di($r.k)).H()},Aa),ba=(Ia.prototype.next=function(){return this.li+=2,this.li},Ia._i=function(){return new Ia(0)},Ia.fi=function(){return new Ia(-1)},Ia),Ea=(Ta.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},Ta);function Ta(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Ii(Hr),this.Ei=new Xu(fi,pi),this.mi=Jr.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new na(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Ia(t){this.li=t}function Aa(){this.index={}}function Na(){this.ai=new wa}function Oa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Si(v).next(function(t){return g=t,n=e.persistence.Ti(o),m=new na(e.Ai,n,e.persistence.Vi()),n.Si(v)}).next(function(t){for(var e=[],n=[],r=xi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function Ra(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function La(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ca(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function ka(t,o,s){var u=t,a=Jr.min(),h=xi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=au(o),(void 0!==(t=(i=t).Ei.get(r))?Yu.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:Jr.min(),s?h:xi())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function Da(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==_r.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Sa(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return $a(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,za(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,Wa(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new xa(n,r)}var Pa,_a,Va,l=(Ba.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},Ba.prototype.ir=function(){return 2===this.state},Ba.prototype.start=function(){3!==this.state?this.auth():this.rr()},Ba.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ba.prototype.ur=function(){this.state=0,this.Ks.reset()},Ba.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},Ba.prototype.hr=function(t){this.lr(),this.stream.send(t)},Ba.prototype.ar=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},Ba.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},Ba.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===_r.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===_r.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},Ba.prototype._r=function(){},Ba.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Vr(_r.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},Ba.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ba.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Ba.prototype.mr=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ba.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ba),Ca=(n(Ga,Va=l),Ga.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},Ga.prototype.onMessage=function(t){this.Ks.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Dr(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(Dr(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?_r.UNKNOWN:Ti(s.code),new Vr(o,s.message||"")),r=new Xi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Mo(t,a.document.name),u=Co(a.document.updateTime),s=new Ms({mapValue:{fields:a.document.fields}}),u=new Ys(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new zi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Mo(t,a.document),h=a.readTime?Co(a.readTime):Jr.min(),h=new Ks(u,h),a=a.removedTargetIds||[];r=new zi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=Mo(t,h.document),h=h.removedTargetIds||[];r=new zi([],h,c,null)}else{if(!("filter"in e))return kr();e.filter,(c=e.filter).targetId,e=new gi(e=c.count||0),c=c.targetId,r=new Hi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Jr.min():Co(e.readTime);return this.listener.Rr(n,t)},Ga.prototype.Pr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=Fo(this.serializer),h.addTarget=(e=this.serializer,(r=di(r=(n=t).target)?{documents:{documents:[qo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=qo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=qo(i,u.q()),s.structuredQuery.from=[{collectionId:u.j()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(No(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NAN"}};if(Ao(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(No(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NOT_NAN"}};if(Ao(t.value))return{unaryFilter:{field:Yo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yo(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Yo(t.field),direction:(t=t.dir,Ro[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.ne||ai(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Ho(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Ho(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Vo(e,n.resumeToken):0<n.ft.F(Jr.min())&&(r.readTime=_o(e,n.ft.L())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.hr(h)},Ga.prototype.yr=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.hr(e)},Ga),Ua=(n(Fa,_a=l),Object.defineProperty(Fa.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),Fa.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,_a.prototype.start.call(this)},Fa.prototype._r=function(){this.Vr&&this.gr([])},Fa.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},Fa.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Dr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Co(e.updateTime):Co(n)).isEqual(Jr.min())&&(t=Co(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new gs(t,n);var e,n})):[]),n=Co(t.commitTime);return this.listener.vr(n,e)}var r;return Dr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},Fa.prototype.Cr=function(){var t={};t.database=Fo(this.serializer),this.hr(t)},Fa.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Wo(e.serializer,t)})};this.hr(t)},Fa),ja=(n(qa,Pa=function(){}),qa.prototype.Dr=function(){if(this.Sr)throw new Vr(_r.FAILED_PRECONDITION,"The client has already been terminated.")},qa.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&i.credentials.A(),t})},qa.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&i.credentials.A(),t})},qa.prototype.terminate=function(){this.Sr=!1},qa),xa=(Ma.prototype.Mr=function(){var t=this;0===this.Lr&&(this.Ur("Unknown"),this.$r=this.Ns.Cs("online_state_timeout",1e4,function(){return t.$r=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},Ma.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.Lr++,1<=this.Lr&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},Ma.prototype.set=function(t){this.Qr(),this.Lr=0,"Online"===t&&(this.kr=!1),this.Ur(t)},Ma.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},Ma.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kr?(Or(t),this.kr=!1):Nr("OnlineStateTracker",t)},Ma.prototype.Qr=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},Ma);function Ma(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.Lr=0,this.$r=null,this.kr=!0}function qa(t,e,n){var r=this;return(r=Pa.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function Fa(t,e,n,r,i){var o=this;return(o=_a.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function Ga(t,e,n,r,i){var o=this;return(o=Va.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ba(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new aa(t,e)}function Wa(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!$a(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function za(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ha(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),Ja(t)?Qa(t):oh(t).ir()&&Ya(t,e))}function Xa(t,e){var n=t,t=oh(n);n.zr.delete(e),t.ir()&&Ka(n,e),0===n.zr.size&&(t.ir()?t.cr():$a(n)&&n.Zr.set("Unknown"))}function Ya(t,e){t.no.Dn(e.targetId),oh(t).Pr(e)}function Ka(t,e){t.no.Dn(e),oh(t).yr(e)}function Qa(e){e.no=new Ki({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),oh(e).start(),e.Zr.Mr()}function Ja(t){return $a(t)&&!oh(t).sr()&&0<t.zr.size}function $a(t){return 0===t.Hr.size}function Za(t){t.no=void 0}function th(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ca(r))throw r;return n.Hr.add(1),[4,za(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Ra(n.jr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,Wa(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function eh(e,n){return n().catch(function(t){return th(e,t,n)})}function nh(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=sh(o=h),u=0<o.Kr.length?o.Kr[o.Kr.length-1].batchId:-1,t.label=1;case 1:if(!($a(o)&&o.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.jr,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.je.zi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kr.length&&s.cr(),[3,7]):(u=a.batchId,e=a,(n=o).Kr.push(e),(n=sh(n)).ir()&&n.pr&&n.gr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,th(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return rh(o)&&ih(o),[2]}var e,n,r,i})})}function rh(t){return $a(t)&&!sh(t).sr()&&0<t.Kr.length}function ih(t){sh(t).start()}function oh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zr.forEach(function(t,e){Ya(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Za(e),Ja(e)?(e.Zr.Br(n),Qa(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof Xi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,th(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof zi?s.no.Mn(u):u instanceof Hi?s.no.Kn(u):s.no.Bn(u),a.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ra(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&(n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(yi.lt,e.ft)),Ka(r,t),e=new wi(e.target,t,1,e.sequenceNumber),Ya(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,th(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Dr(),new Ca(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),Ja(n)?Qa(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),Za(n),t.label=3;case 3:return[2]}})})})),n.oo}function sh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return sh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&sh(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ei(n=i.code)&&n!==_r.ABORTED?(e=r.Kr.shift(),sh(r).ur(),[4,eh(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,nh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return rh(e)&&ih(e),[2]}})})}.bind(null,n),br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=sh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=Hu.from(e,i,o),[4,eh(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,nh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new Ua(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,nh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Nr("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function uh(){this.queries=new Xu(lu,cu),this.onlineState="Unknown",this.ao=new Set}var ah=function(){this.co=void 0,this.listeners=[]};function hh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ah),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=va(o=t.sent(),"Initialization of query '"+fu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&lh(e),[2]}})})}function ch(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function lh(t){t.ao.forEach(function(t){t.next()})}var fh=(kh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Gi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},kh.prototype.onError=function(t){this.wo.error(t)},kh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},kh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},kh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},kh.prototype.Io=function(t){t=Gi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},kh),ph=(Lh.prototype.W=function(){return this.Po.W()},Lh.prototype.vo=function(t,e){e=new dh(t,e),this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Lh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Lh.prototype.Co=function(t,e){this.So(new dh(t,e))},Lh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Lh.prototype.No=function(t){var e=this,n=new ei(new $r([])),r=new dh(n,t),t=new dh(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Lh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Lh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Lh.prototype.Fo=function(t){var e=new ei(new $r([])),n=new dh(e,t),t=new dh(e,t+1),r=xi();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Lh.prototype.Oo=function(t){var e=new dh(t,0);return null!==(e=this.Po.Gt(e))&&t.isEqual(e.key)},Lh),dh=(Rh.yo=function(t,e){return ei.k(t.key,e.key)||Hr(t.Lo,e.Lo)},Rh.po=function(t,e){return Hr(t.Lo,e.Lo)||ei.k(t.key,e.key)},Rh),yh=(Oh.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Oh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Oh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Oh),vh=(Nh.prototype.Bo=function(t){},Nh.prototype.Qo=function(t,e,n){},Nh.prototype.jo=function(t){return this.Uo.$o(t),this.qo[t]||"not-current"},Nh.prototype.Wo=function(t,e,n){this.qo[t]=e},Nh.prototype.Go=function(t){this.Uo.ko(t)},Nh.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Nh.prototype.zo=function(t){delete this.qo[t]},Nh.prototype.Ho=function(){return this.Uo.activeTargetIds},Nh.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Nh.prototype.start=function(){return this.Uo=new yh,Promise.resolve()},Nh.prototype.Jo=function(t,e,n){},Nh.prototype.Xo=function(t){},Nh.prototype.Zo=function(){},Nh.prototype.ws=function(t){},Nh.prototype.tu=function(){},Nh),gh=function(t){this.key=t},mh=function(t){this.key=t},wh=(Object.defineProperty(Ah.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Ah.prototype.uu=function(t,e){var s=this,u=e?e.cu:new Fi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=nu(this.query)&&a.size===this.query.limit?a.last():null,p=ru(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof Ys?e:null)&&(pu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),nu(this.query)||ru(this.query))for(;c.size>this.query.limit;){var n=nu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Ah.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Ah.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this._u(n);var s=e?this.fu():[],e=(n=0===this.su.size&&this._n?1:0)!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Gi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Ah.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new Fi,nn:this.nn,hu:!1},!1)):{du:[]}},Ah.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Ah.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Ah.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=xi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new mh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new gh(t))}),r},Ah.prototype.Eu=function(t){return this.nu=t.Ji,this.su=xi(),t=this.uu(t.documents),this.lu(t,!0)},Ah.prototype.mu=function(){return Gi.rn(this.query,this.ru,this.nn,0===this.eu)},Ah),bh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Eh=function(t){this.key=t,this.Tu=!1},Th=(Object.defineProperty(Ih.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),Ih);function Ih(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new Xu(lu,cu),this.pu=new Map,this.gu=[],this.vu=new Ii(ei.k),this.bu=new Map,this.Cu=new ph,this.Su={},this.Du=new Map,this.Nu=ba.fi(),this.onlineState="Unknown",this.xu=void 0}function Ah(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=xi(),this.nn=xi(),this.iu=du(t),this.ru=new qi(this.iu)}function Nh(){this.Uo=new yh,this.qo={},this.Or=null,this._s=null}function Oh(){this.activeTargetIds=Mi}function Rh(t,e){this.key=t,this.Lo=e}function Lh(){this.Po=new Di(dh.yo),this.Vo=new Di(dh.po)}function kh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Dh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ai.Fi({Oi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Yu.resolve();return a.forEach(function(n){h=h.next(function(){return s.He(o,n)}).next(function(t){var e=t;Dr(null!==(t=r.Ce.get(n))),(!e||e.version.F(t)<0)&&(e=u.Ve(n,e,r))&&s.Li(e,r.be)})}),h.next(function(){return i.je.$i(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,e)})}))];case 2:return i=t.sent(),Ch(n,r,null),Vh(n,r),n.Ru.Qo(r,"acknowledged"),[4,qh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Dr(null!==t),n=t.keys(),i.je.$i(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Ch(n,u,a),Vh(n,u),n.Ru.Qo(u,"rejected",a),[4,qh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=Qr.now(),i=a.reduce(function(t,e){return t.add(e.key)},xi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ps?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ys?t.field(i.field):void 0;null!=(o=Jo(i.transform,o||null))&&(e=(null==e?new qs:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new Rs(i.key,o,function s(t){var u=[];return so(t.fields||{},function(t,e){var n=new ti([t]);if(Oo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ys(u)}(o.proto.mapValue),ms.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Ii(Hr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,qh(u,s.Uu)];case 3:return t.sent(),[4,nh(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Sh(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=e,l=(o=s).ft,f=c.wi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Dr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=Pi;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=xi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Pi;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof Ks&&e.version.isEqual(Jr.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Li(e,r),o=o.Tt(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Jr.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),Yu.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t}))];case 2:return r=t.sent(),s.on.forEach(function(t,e){(e=n.bu.get(e))&&(Dr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Dr(e.Tu):0<t.wn.size&&(Dr(e.Tu),e.Tu=!1))}),[4,qh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Ph(t,n,e){var r;((t=t).Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){(e=e.view.lo(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&lh(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function _h(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:$a((n=o).Au)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Vh(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Ch(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Uh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||jh(e,t)})}function jh(t,e){var n=t.vu.get(e);null!==n&&(Xa(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),Mh(t))}function xh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof gh?(t.Cu.vo(u.key,e),r=t,i=(i=u).key,r.vu.get(i)||(Nr("SyncEngine","New document in limbo: "+i),r.gu.push(i),Mh(r))):u instanceof mh?(Nr("SyncEngine","Document no longer in limbo: "+u.key),t.Cu.Co(u.key,e),t.Cu.Oo(u.key)||jh(t,u.key)):kr()}}function Mh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new Eh(e)),t.vu=t.vu.Tt(e,n),Ha(t.Au,new wi(au(eu(e.path)),n,2,ia.Es))}}function qh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ra.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Yu.forEach(h,function(e){return Yu.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return Yu.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var Fh,Gh,Bh,Wh=(Oc.prototype.vi=function(t){this.Qu=t},Oc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(Jr.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(nu(r)||ru(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Ar()<=u.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Oc.prototype.Wu=function(n,t){var r=new Di(du(n));return t.forEach(function(t,e){e instanceof Ys&&pu(n,e)&&(r=r.add(e))}),r},Oc.prototype.hu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},Oc.prototype.ju=function(t,e){return Ar()<=u.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",fu(e)),this.Qu.ts(t,e,Jr.min())},Oc),zh=(Nc.prototype.zu=function(t){return Yu.resolve(0===this.je.length)},Nc.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1],n=new zu(i,e,n,r),this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new dh(u.key,i)),this.We.hi(t,u.key.path.q())}return Yu.resolve(n)},Nc.prototype.qu=function(t,e){return Yu.resolve(this.Hu(e))},Nc.prototype.zi=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,Yu.resolve(this.je.length>e?this.je[e]:null)},Nc.prototype.Bu=function(){return Yu.resolve(0===this.je.length?-1:this.Gu-1)},Nc.prototype.Si=function(t){return Yu.resolve(this.je.slice())},Nc.prototype.Ke=function(t,e){var n=this,r=new dh(e,0),e=new dh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Lo),i.push(t)}),Yu.resolve(i)},Nc.prototype.Ze=function(t,e){var n=this,r=new Di(Hr);return e.forEach(function(t){var e=new dh(t,0),t=new dh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Lo)})}),Yu.resolve(this.Ju(r))},Nc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;ei.ot(e)||(e=e.child(""));var e=new dh(new ei(e),0),i=new Di(Hr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Lo)),!0)},e),Yu.resolve(this.Ju(i))},Nc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Nc.prototype.$i=function(n,r){var i=this;Dr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return Yu.forEach(r.mutations,function(t){var e=new dh(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Nc.prototype.tc=function(t){},Nc.prototype.Oo=function(t,e){var n=new dh(e,0),n=this.Ku.Gt(n);return Yu.resolve(e.isEqual(n&&n.key))},Nc.prototype.ki=function(t){return this.je.length,Yu.resolve()},Nc.prototype.Xu=function(t,e){return this.Yu(t)},Nc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Nc.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.je.length?null:this.je[t]},Nc),Hh=(Ac.prototype.Li=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.We.hi(t,r.path.q())},Ac.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ac.prototype.He=function(t,e){return e=this.docs.get(e),Yu.resolve(e?e.ec:null)},Ac.prototype.getEntries=function(t,e){var n=this,r=Pi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),Yu.resolve(r)},Ac.prototype.ts=function(t,e,n){for(var r=Ci,i=new ei(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=(u=o.Dt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.G(s.path))break;a.F(n)<=0||u instanceof Ys&&pu(e,u)&&(r=r.Tt(u.key,u))}return Yu.resolve(r)},Ac.prototype.sc=function(t,e){return Yu.forEach(this.docs,function(t){return e(t)})},Ac.prototype.Fi=function(t){return new Xh(this)},Ac.prototype.ic=function(t){return Yu.resolve(this.size)},Ac),Xh=(Ic.prototype.oc=function(t){return(t=this.Uu.get(t))?t.readTime:Jr.min()},Ic.prototype.Li=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Ic.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Ic.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?Yu.resolve(n.ec):this.cc(t,e)},Ic.prototype.getEntries=function(t,e){return this.ac(t,e)},Ic.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Ic.prototype.uc=function(){},n(Tc,Bh=Ic),Tc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Li(n,e.ec,r.oc(t))):r.hc.Gi(t)}),Yu.qe(i)},Tc.prototype.cc=function(t,e){return this.hc.He(t,e)},Tc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Tc),Yh=(Ec.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Yu.resolve()},Ec.prototype.Mi=function(t){return Yu.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.wc=function(t){return Yu.resolve(this._c)},Ec.prototype.Lu=function(t){return this.highestTargetId=this.dc.next(),Yu.resolve(this.highestTargetId)},Ec.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Yu.resolve()},Ec.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new ba(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Ec.prototype.$u=function(t,e){return this.Ec(e),this.targetCount+=1,Yu.resolve()},Ec.prototype.Qi=function(t,e){return this.Ec(e),Yu.resolve()},Ec.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,Yu.resolve()},Ec.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),Yu.qe(u).next(function(){return s})},Ec.prototype.Ic=function(t){return Yu.resolve(this.targetCount)},Ec.prototype.Hi=function(t,e){return e=this.lc.get(e)||null,Yu.resolve(e)},Ec.prototype.qi=function(t,e,n){return this.fc.bo(e,n),Yu.resolve()},Ec.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Yu.qe(i)},Ec.prototype.Ac=function(t,e){return this.fc.No(e),Yu.resolve()},Ec.prototype.Yi=function(t,e){return e=this.fc.Fo(e),Yu.resolve(e)},Ec.prototype.Oo=function(t,e){return Yu.resolve(this.fc.Oo(e))},Ec),Kh=(bc.prototype.yc=function(t,e){return Yu.resolve(this.Rc.get(e))},bc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Co(e.createTime)}),Yu.resolve()},bc.prototype.gc=function(t,e){return Yu.resolve(this.Pc.get(e))},bc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=zo({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?hu(e,e.limit,"L"):e),readTime:Co(n.readTime)}),Yu.resolve()},bc),Qh=(wc.prototype.start=function(){return Promise.resolve()},wc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(wc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),wc.prototype.xc=function(){},wc.prototype.Fc=function(){},wc.prototype.Vi=function(){return this.We},wc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new zh(this.We,this.Wi),this.bc[t.h()]=e),e},wc.prototype.Pi=function(){return this.Ri},wc.prototype.Ii=function(){return this.Qe},wc.prototype.gi=function(){return this.pi},wc.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new Jh(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},wc.prototype.kc=function(e,n){return Yu.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},wc),Jh=(mc.prototype.Uc=function(t){this.Mc.push(t)},mc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(gc,Gh=mc),gc),$h=(vc.Qc=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw kr()},enumerable:!1,configurable:!0}),vc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),Yu.resolve()},vc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),Yu.resolve()},vc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Yu.resolve()},vc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},vc.prototype.Oc=function(){this.Bc=new Set},vc.prototype.Lc=function(n){var r=this,i=this.persistence.Ii().Fi();return Yu.forEach(this.jc,function(t){var e=ei.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},vc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},vc.prototype.Dc=function(t){return 0},vc.prototype.Wc=function(t,e){var n=this;return Yu.Be([function(){return Yu.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},vc),Zh=(yc.prototype.Ar=function(t){this.zc=t},yc.prototype.dr=function(t){this.Hc=t},yc.prototype.onMessage=function(t){this.Yc=t},yc.prototype.close=function(){this.Kc()},yc.prototype.send=function(t){this.Gc(t)},yc.prototype.Jc=function(){this.zc()},yc.prototype.Xc=function(t){this.Hc(t)},yc.prototype.Zc=function(t){this.Yc(t)},yc),tc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ec=(dc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);return Nr("RestConnection","Sending: ",i,n),t={},this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},dc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},dc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},dc.prototype.sa=function(t,e){return t=tc[t],this.na+"/v1/"+e+":"+t},n(pc,Fh=dc),pc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case fr.NO_ERROR:var t=i.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case fr.TIMEOUT:Nr("Connection",'RPC "'+o+'" timed out'),r(new Vr(_r.DEADLINE_EXCEEDED,"Request time out"));break;case fr.HTTP_ERROR:var e=i.getStatus();Nr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(_r).indexOf(e)?e:_r.UNKNOWN,r(new Vr(e,t.message))):r(new Vr(_r.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Vr(_r.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Nr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},pc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=lr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,h=new Zh({Gc:function(t){a?Nr("Connection","Not sending because WebChannel is closed:",t):(u||(Nr("Connection","Opening WebChannel transport."),s.open(),u=!0),Nr("Connection","WebChannel sending:",t),s.send(t))},Kc:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||Nr("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,Nr("Connection","WebChannel transport closed"),h.Xc())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Rr("Connection","WebChannel transport errored:",t),h.Xc(new Vr(_r.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Dr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=mi[r];if(void 0!==t)return Ti(t)}(),i=n.message,void 0===t&&(t=_r.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.Xc(new Vr(t,i)),s.close()):(Nr("Connection","WebChannel received:",e),h.Zc(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?Nr("Connection","Detected buffering proxy"):11===t.stat&&Nr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Jc()},0),h},pc),nc=(fc.prototype.Xr=function(t){this.ha.push(t)},fc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},fc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},fc.prototype.ua=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},fc.prototype.aa=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},fc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fc),rc=(lc.prototype.Xr=function(t){},lc.prototype.Zo=function(){},lc),ic=(cc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ta(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},cc.prototype.Ea=function(t){return null},cc.prototype.ma=function(t){return e=this.persistence,n=new Wh,r=t.Ta,t=this.serializer,new Ea(e,n,r,t);var e,n,r},cc.prototype.da=function(t){return new Qh($h.Qc,this.serializer)},cc.prototype.fa=function(t){return new vh},cc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},cc),oc=(hc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Ph(e.Pa,t,1)},this.Au.Gr.Va=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Nr("SyncEngine","User change. New user:",o.h()),[4,Oa(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Vr(_r.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,qh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Pa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,Wa(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,za(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hc.prototype.Ra=function(t){return new uh},hc.prototype.Aa=function(t){var e=ta(t.ta.t),n=(n=t.ta,new ec(n));return t=t.credentials,new ja(t,n,e)},hc.prototype.Ia=function(t){var e=this;return new Sa(this.jr,this.Wr,t.Ns,function(t){return Ph(e.Pa,t,0)},t=new(nc._a()?nc:rc))},hc.prototype.ya=function(t,e){return n=this.jr,r=this.Au,i=this.Iu,o=this.Ru,s=t.Ta,t=t.Pu,e=e,t=new Th(n,r,i,o,s,t),e&&(t.xu=!0),t;var n,r,i,o,s},hc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Nr("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,za(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},hc),sc=(ac.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},ac.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ac.prototype.ga=function(){this.muted=!0},ac.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ac),uc=function(t){this.va=t};function ac(t){this.observer=t,this.muted=!1}function hc(){}function cc(){this.synchronizeTabs=!1}function lc(){}function fc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function pc(t){var e=this;return(e=Fh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function dc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function yc(t){this.Gc=t.Gc,this.Kc=t.Kc}function vc(t){this.persistence=t,this.qc=new ph,this.Bc=null}function gc(t){var e=this;return(e=Gh.call(this)||this).Bi=t,e}function mc(){this.Mc=[]}function wc(t,e){var n=this;this.bc={},this.Cc=new ia(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new Yh(this),this.We=new ma,this.Qe=(t=this.We,new Hh(t,function(t){return n.Wi.Dc(t)})),this.serializer=new ga(e),this.pi=new Kh(this.serializer)}function bc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Ec(t){this.persistence=t,this.lc=new Xu(fi,pi),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this._c=0,this.fc=new ph,this.targetCount=0,this.dc=ba._i()}function Tc(t){var e=this;return(e=Bh.call(this)||this).hc=t,e}function Ic(){this.Uu=new Xu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Ac(t,e){this.We=t,this.nc=e,this.docs=new Ii(ei.k),this.size=0}function Nc(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Di(dh.yo)}function Oc(){}function Rc(t,e,n){if(!n)throw new Vr(_r.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Lc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Vr(_r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function kc(t,e,n,r){if(!0===e&&!0===r)throw new Vr(_r.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Dc(t){if(!ei.ot(t))throw new Vr(_r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Sc(t){if(ei.ot(t))throw new Vr(_r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Pc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function _c(t,e){if(t instanceof uc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Vr(_r.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Pc(t),new Vr(_r.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Vc(t,e){if(e<=0)throw new Vr(_r.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Cc,Uc=function(t){this.ba=t},jc=(n(xc,Cc=Uc),xc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},xc.prototype.isEqual=function(t){return t instanceof xc},xc);function xc(){return null!==Cc&&Cc.apply(this,arguments)||this}function Mc(t,e,n){return new Pf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var qc,Fc,Gc,Bc,Wc=(n(sl,Bc=Uc),sl.prototype.Ca=function(t){return new ds(t.path,new ts)},sl.prototype.isEqual=function(t){return t instanceof sl},sl),zc=(n(ol,Gc=Uc),ol.prototype.Ca=function(t){var e=Mc(this,t,!0),n=this.Fa.map(function(t){return qf(t,e)}),n=new es(n);return new ds(t.path,n)},ol.prototype.isEqual=function(t){return this===t},ol),Hc=(n(il,Fc=Uc),il.prototype.Ca=function(t){var e=Mc(this,t,!0),n=this.Fa.map(function(t){return qf(t,e)}),n=new ss(n);return new ds(t.path,n)},il.prototype.isEqual=function(t){return this===t},il),Xc=(n(rl,qc=Uc),rl.prototype.Ca=function(t){var e=new cs(t.serializer,Po(t.serializer,this.Oa));return new ds(t.path,e)},rl.prototype.isEqual=function(t){return this===t},rl),Yc=(Object.defineProperty(nl.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(nl.prototype,"longitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),nl.prototype.isEqual=function(t){return this.La===t.La&&this.$a===t.$a},nl.prototype.toJSON=function(){return{latitude:this.La,longitude:this.$a}},nl.prototype.D=function(t){return Hr(this.La,t.La)||Hr(this.$a,t.$a)},nl),Kc=(el.fromBase64String=function(t){try{return new el(yi.fromBase64String(t))}catch(t){throw new Vr(_r.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},el.fromUint8Array=function(t){return new el(yi.fromUint8Array(t))},el.prototype.toBase64=function(){return this.ka.toBase64()},el.prototype.toUint8Array=function(){return this.ka.toUint8Array()},el.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},el.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},el),Qc=new Map,Jc=(tl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},tl),$c=(Object.defineProperty(Zc.prototype,"app",{get:function(){if(!this.ja)throw new Vr(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(Zc.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(Zc.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),Zc.prototype.za=function(t){if(this.qa)throw new Vr(_r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new Jc(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new Cr;switch(t.type){case"gapi":var e=t.client;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new xr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Vr(_r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Zc.prototype.Ha=function(){return this.Ua},Zc.prototype.Ya=function(){return this.qa=!0,this.Ua},Zc.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},Zc.prototype.Ja=function(){return(t=Qc.get(this))&&(Nr("ComponentProvider","Removing Datastore"),Qc.delete(this),t.terminate()),Promise.resolve();var t},Zc);function Zc(t,e){this.Ma="(lite)",this.Ua=new Jc({}),this.qa=!1,t instanceof wr?(this.Ba=t,this.Qa=new Cr):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Vr(_r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wr(t.options.projectId)}(t),this.Qa=new Ur(e))}function tl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Vr(_r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Vr(_r.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,kc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function el(t){this.ka=t}function nl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Vr(_r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Vr(_r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.$a=e}function rl(t,e){var n=this;return(n=qc.call(this,t)||this).Oa=e,n}function il(t,e){var n=this;return(n=Fc.call(this,t)||this).Fa=e,n}function ol(t,e){var n=this;return(n=Gc.call(this,t)||this).Fa=e,n}function sl(){return null!==Bc&&Bc.apply(this,arguments)||this}function ul(){if("undefined"==typeof Uint8Array)throw new Vr(_r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function al(){if("undefined"==typeof atob)throw new Vr(_r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var hl,cl,ll,fl=(n(bl,ll=uc),bl.fromBase64String=function(t){return al(),new bl(Kc.fromBase64String(t))},bl.fromUint8Array=function(t){return ul(),new bl(Kc.fromUint8Array(t))},bl.prototype.toBase64=function(){return al(),this.va.toBase64()},bl.prototype.toUint8Array=function(){return ul(),this.va.toUint8Array()},bl.prototype.isEqual=function(t){return this.va.isEqual(t.va)},bl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},bl),me=(wl.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),lo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return wo(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(bo(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw kr()}},wl.prototype.rh=function(t,n){var r=this,i={};return so(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},wl.prototype.sh=function(t){return new Yc(wo(t.latitude),wo(t.longitude))},wl.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},wl.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){return ao(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(ho(t));default:return null}},wl.prototype.Za=function(t){return t=mo(t),new Qr(t.seconds,t.nanos)},wl.prototype.oh=function(t,e){var n=$r.J(t);return Dr(Qo(n)),t=new wr(n.get(1),n.get(3)),n=new ei(n.U(5)),t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},wl),pl=(n(ml,cl=me),ml.prototype.nh=function(t){return new fl(new Kc(t))},ml.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),Dp.uh(t,this.firestore,null)},ml),dl=(Object.defineProperty(gl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(gl.prototype,"ref",{get:function(){return new Bl(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),gl.prototype.exists=function(){return null!==this._h},gl.prototype.data=function(){if(this._h){if(this.fh){var t=new yl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},gl.prototype.get=function(t){if(this._h&&null!==(t=this._h.data().field(El("DocumentSnapshot.get",t))))return this.hh.Xa(t)},gl),yl=(n(vl,hl=dl),vl.prototype.data=function(){return hl.prototype.data.call(this)},vl);function vl(){return null!==hl&&hl.apply(this,arguments)||this}function gl(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function ml(t){var e=this;return(e=cl.call(this)||this).firestore=t,e}function wl(){}function bl(){return null!==ll&&ll.apply(this,arguments)||this}function El(t,e){return"string"==typeof e?Hf(t,e):(e instanceof uc?e.va:e).dh}var Tl,Il=(Ol.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Ol),Al=(n(Nl,Tl=$c),Nl.prototype.Ja=function(){return this.Eh||Ap(this),this.Eh.terminate()},Nl);function Nl(t,e){var n=this;return(n=Tl.call(this,t,e)||this).wh=new pa,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Ol(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Vr(_r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new ti(t)}var Rl,Ll,kl=(n(Vl,Ll=dl),Vl.prototype.exists=function(){return Ll.prototype.exists.call(this)},Vl.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Dl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Vl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h&&null!==(t=this._h.data().field(El("DocumentSnapshot.get",t))))return this.hh.Xa(t,e.serverTimestamps)},Vl),Dl=(n(_l,Rl=kl),_l.prototype.data=function(t){return void 0===t&&(t={}),Rl.prototype.data.call(this,t)},_l),Sl=(Object.defineProperty(Pl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Pl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Dl(r.ah,r.hh,t.key,t,new Bp(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Pl.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Th.sn)throw new Vr(_r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Dl(i.ah,i.hh,t.doc.key,t.doc,new Bp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Dl(i.ah,i.hh,t.doc.key,t.doc,new Bp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Pl);function Pl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new Bp(r.hasPendingWrites,r.fromCache),this.query=n}function _l(){return null!==Rl&&Rl.apply(this,arguments)||this}function Vl(t,e,n,r,i,o){var s=this;return(s=Ll.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Cl(t,e){return t instanceof kl&&e instanceof kl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof Sl&&e instanceof Sl&&t.ah===e.ah&&Af(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var Ul,jl=(n(xl,Ul=me),xl.prototype.nh=function(t){return new Kc(t)},xl.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Bl(this.firestore,null,t)},xl);function xl(t){var e=this;return(e=Ul.call(this)||this).firestore=t,e}function Ml(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=_c(t.firestore,Al),s=Nf(o);return e instanceof uc&&(e=e.va),Fl(o,("string"==typeof e||e instanceof Il?xf(s,"updateDoc",t.lh,e,n,r):jf(s,"updateDoc",t.lh,e)).Ph(t.lh,ms.exists(!0)))}function ql(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ea(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};ea(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Bl?(s=_c(e.firestore,Al),u=eu(e.lh.path),c={next:function(t){n[o]&&n[o](Gl(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=_c(e.firestore,Al),u=e.Rh,h=new jl(s),c={next:function(t){n[o]&&n[o](new Sl(s,h,e,t))},error:n[o+1],complete:n[o+2]},df(e.Rh));var f=Ip(s),p=new sc(c),d=new fh(u,p,l);return s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hh,[4,up(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ch,[4,up(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Fl(t,e){return function(n,r){var t=this,i=new Ku;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Dh,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ip(t),e)}function Gl(t,e,n){var r=n.docs.get(e.lh),i=new jl(t);return new kl(t,i,e.lh,r,new Bp(n.hasPendingWrites,n.fromCache),e.fh)}var Bl=(Object.defineProperty(Hl.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"parent",{get:function(){return new vf(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),Hl.prototype.withConverter=function(t){return new Hl(this.firestore,t,this.lh)},Hl),Wl=(zl.prototype.withConverter=function(t){return new zl(this.firestore,t,this.Rh)},zl);function zl(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function Hl(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function Xl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Vh(t);return t}var Yl,Kl,Ql,Jl,$l,Zl=(n(hf,$l=l=function(){}),hf.prototype.Vh=function(t){var e=Nf(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Vr(_r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ff(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(lf(n,t,h))}c={arrayValue:{values:s}}}else c=lf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ff(o,i),c=Mf(e,"where",o,"in"===i||"not-in"===i);var c=vu.create(r,i,c);return function(t,e){if(e.Ie()){var n=ou(t);if(null!==n&&!n.isEqual(e.field))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=iu(t))&&pf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Vr(_r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Vr(_r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new Wl(t.firestore,t.fh,(e=(t=t.Rh).filters.concat([e]),new Js(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},hf),tf=(n(af,Jl=l),af.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Wu(e,n);return e=r,null!==iu(n=t)||null!==(t=ou(n))&&pf(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new Wl(t.firestore,t.fh,(e=(t=t.Rh).me.concat([e]),new Js(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},af),ef=(n(uf,Ql=l),uf.prototype.Vh=function(t){return new Wl(t.firestore,t.fh,hu(t.Rh,this.Sh,this.Dh))},uf),nf=(n(sf,Kl=l),sf.prototype.Vh=function(t){var e=cf(t,this.type,this.Nh,this.xh);return new Wl(t.firestore,t.fh,(t=t.Rh,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},sf),rf=(n(of,Yl=l),of.prototype.Vh=function(t){var e=cf(t,this.type,this.Nh,this.xh);return new Wl(t.firestore,t.fh,(t=t.Rh,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},of);function of(t,e,n){var r=this;return(r=Yl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function sf(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function uf(t,e,n){var r=this;return(r=Ql.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function af(t,e){var n=this;return(n=Jl.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function hf(t,e,n){var r=this;return(r=$l.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function cf(t,h,e,n){if(e[0]instanceof uc&&(e[0]=e[0].va),e[0]instanceof dl)return function(t,e,n,r){if(!n)throw new Vr(_r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=uu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Eo(e,n.key));else{var a=n.field(u.field);if(ao(a))throw new Vr(_r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Y(),new Vr(_r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Uu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=Nf(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Vr(_r.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!su(t)&&-1!==h.indexOf("/"))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child($r.J(h));if(!ei.ot(c))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ei(c),u.push(Eo(e,c))}else h=Mf(n,r,h),u.push(h)}return new Uu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function lf(t,e,n){if(n instanceof uc&&(n=n.va),"string"==typeof n){if(""===n)throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!su(e)&&-1!==n.indexOf("/"))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child($r.J(n)),!ei.ot(e))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Eo(t,new ei(e))}if(n instanceof Bl)return Eo(t,n.lh);throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pc(n)+".")}function ff(t,e){if(!Array.isArray(t)||0===t.length)throw new Vr(_r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Vr(_r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pf(t,e,n){if(!n.isEqual(e))throw new Vr(_r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function df(t){if(ru(t)&&0===t.me.length)throw new Vr(_r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var yf,vf=(n(gf,yf=Wl),Object.defineProperty(gf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new Bl(this.firestore,null,new ei(t))},enumerable:!1,configurable:!0}),gf.prototype.withConverter=function(t){return new gf(this.firestore,t,this.yh)},gf);function gf(t,e,n){var r=this;return(r=yf.call(this,t,e,eu(n))||this).firestore=t,r.yh=n,r.type="collection",r}function mf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Rc("collection","path",e),t instanceof $c){var i=$r.J.apply($r,s([e],n));return Sc(i),new vf(t,null,i)}if(!(t instanceof Bl||t instanceof vf))throw new Vr(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Sc(e=$r.J.apply($r,s([t.path],n)).child($r.J(e))),new vf(t.firestore,null,e)}function wf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Wr.S()),Rc("doc","path",e),t instanceof $c){var i=$r.J.apply($r,s([e],n));return Dc(i),new Bl(t,null,new ei(i))}if(!(t instanceof Bl||t instanceof vf))throw new Vr(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Dc(e=t.yh.child($r.J.apply($r,s([e],n)))),new Bl(t.firestore,t instanceof vf?t.fh:null,new ei(e))}var bf,Ef=(n(Tf,bf=me),Tf.prototype.nh=function(t){return new Kc(t)},Tf.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Bl(this.firestore,null,t)},Tf);function Tf(t){var e=this;return(e=bf.call(this)||this).firestore=t,e}function If(t,e){return(t instanceof Bl||t instanceof vf)&&(e instanceof Bl||e instanceof vf)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function Af(t,e){return t instanceof Wl&&e instanceof Wl&&t.firestore===e.firestore&&cu(t.Rh,e.Rh)&&t.fh===e.fh}function Nf(t){var e=t.Ya(),n=ta(t.Ba);return new _f(t.Ba,!!e.ignoreUndefinedProperties,n)}var Of=/^__.*__$/,Rf=(Df.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new Rs(t,this.data,this.ee,e)):n.push(new Os(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},Df),Lf=(kf.prototype.Ph=function(t,e){return e=[new Rs(t,this.data,this.ee,e)],0<this.fieldTransforms.length&&e.push(new Ps(t,this.fieldTransforms)),e},kf);function kf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Df(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Sf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Pf=(Object.defineProperty(Cf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Cf.prototype.Oh=function(t){return new Cf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Cf.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Oh({path:e,xa:!1})).$h(t),e},Cf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Oh({path:t,xa:!1})).Fh(),t},Cf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Cf.prototype.Da=function(t){return Xf(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Cf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Cf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$h(this.path.get(t))},Cf.prototype.$h=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Sf(this.Sa)&&Of.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Cf),_f=(Vf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Pf({Sa:t,methodName:e,Na:n,path:ti.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Vf);function Vf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ta(t)}function Cf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function Uf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);Bf("Data must be an object, but it was:",s,r);var u,a,r=Ff(r,s);if(o.merge)u=new ys(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=Wf(e,l[c],n);if(!s.contains(f))throw new Vr(_r.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Yf(h,f)||h.push(f)}u=new ys(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new Rf(new Ms(r),u,a)}function jf(t,r,i,e){var o=t.qh(1,r,i);Bf("Data must be an object, but it was:",o,e);var s=[],u=new qs;return so(e,function(t,e){var n=Hf(r,t,i);e instanceof uc&&(e=e.va),t=o.kh(n),e instanceof jc?s.push(n):null!=(t=qf(e,t))&&(s.push(n),u.set(n,t))}),e=new ys(s),new Lf(u.he(),e,o.fieldTransforms)}function xf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[Wf(e,r,n)],a=[i];if(o.length%2!=0)throw new Vr(_r.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Wf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new qs,y=u.length-1;0<=y;--y)Yf(p,u[y])||(c=u[y],(l=a[y])instanceof uc&&(l=l.va),f=s.kh(c),l instanceof jc?p.push(c):null!=(f=qf(l,f))&&(p.push(c),d.set(c,f)));return i=new ys(p),new Lf(d.he(),i,s.fieldTransforms)}function Mf(t,e,n,r){return void 0===r&&(r=!1),qf(n,t.qh(r?4:3,e))}function qf(s,t){if(s instanceof uc&&(s=s.va),Gf(s))return Bf("Unsupported field value:",t,s),Ff(s,t);if(s instanceof Uc)return function(t,e){if(!Sf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");(t=t.Ca(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=qf(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof uc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Qr.fromDate(t);return{timestampValue:_o(e.serializer,n)}}if(t instanceof Qr){var r=new Qr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_o(e.serializer,r)}}if(t instanceof Yc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Kc)return{bytesValue:Vo(e.serializer,t.ka)};if(t instanceof Bl){if(n=e.t,!(r=t.firestore.Ba).isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Uo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Pc(t))}(s,t)}function Ff(t,n){var r={};return uo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):so(t,function(t,e){null!=(e=qf(e,n.Lh(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Gf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof Yc||t instanceof Kc||t instanceof Bl||t instanceof Uc)}function Bf(t,e,n){if(!Gf(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Pc(n))?e.Da(t+" a custom object"):e.Da(t+" "+n);var r}function Wf(t,e,n){if(e instanceof uc&&(e=e.va),e instanceof Il)return e.dh;if("string"==typeof e)return Hf(t,e);throw Xf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var zf=new RegExp("[~\\*/\\[\\]]");function Hf(e,n,r){if(0<=n.search(zf))throw Xf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Il.bind.apply(Il,s([void 0],n.split("."))))).dh}catch(t){throw Xf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Xf(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Vr(_r.INVALID_ARGUMENT,(e+=". ")+t+n)}function Yf(t,e){return t.some(function(t){return t.isEqual(e)})}var Kf=(tp.prototype.Gh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Vr(_r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Fo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return xo(r.serializer,t)})},[4,r.Fr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=Mo(t,e.found.name),t=Co(e.found.updateTime),e=new Ms({mapValue:{fields:e.found.fields}});return new Ys(n,t,e,{})}(n,t):"missing"in t?(e=n,Dr(!!(n=t).missing),Dr(!!n.readTime),e=Mo(e,n.missing),n=Co(n.readTime),new Ks(e,n)):kr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Dr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ks||t instanceof Ys?n.zh(t):kr()}),e)]}})})},tp.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},tp.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},tp.prototype.delete=function(t){this.write([new js(t,this.re(t))]),this.Wh.add(t.toString())},tp.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ei.st(e),n.mutations.push(new xs(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Fo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Wo(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},tp.prototype.zh=function(t){var e;if(t instanceof Ys)e=t.version;else{if(!(t instanceof Ks))throw kr();e=Jr.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Vr(_r.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},tp.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?ms.updateTime(e):ms.ce()},tp.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return ms.exists(!0);if(e.isEqual(Jr.min()))throw new Vr(_r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ms.updateTime(e)},tp.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},tp.prototype.Kh=function(){},tp),Qf=(Zf.prototype.run=function(){this.Jh()},Zf.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Kf(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},Zf.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!ai(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},Zf.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},Zf.prototype.tl=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ei(t))},Zf),Jf=($f.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},$f.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},$f.prototype.sl=function(){if(this.Ns.Hs)throw new Vr(_r.FAILED_PRECONDITION,"The client has already been terminated.")},$f.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new Ku;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},$f);function $f(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=br.UNAUTHENTICATED,this.clientId=Wr.S(),this.nl=function(){},this.V=new Ku,this.credentials.I(function(t){Nr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function Zf(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new aa(this.Ns,"transaction_retry")}function tp(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function ep(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Nr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Nr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Oa(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new ic)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function np(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Nr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,ep(r)];case 1:return e=t.sent(),Nr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Nr("RemoteStore","RemoteStore received new credentials"),n=$a(e),e.Hr.add(3),[4,za(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,Wa(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new oc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function rp(t){return ep(t).then(function(t){return t.persistence})}function ip(t){return ep(t).then(function(t){return t.jr})}function op(t){return np(t).then(function(t){return t.Au})}function sp(t){return np(t).then(function(t){return t.Pa})}function up(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=Sh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t;if((t=n.bu.get(e))&&t.Tu)return xi().add(t.key);var r=xi();if(!(e=n.pu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Vu.get(s),r=r.Kt(s.view.ou);return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ii(ei.k)).Tt(n,new Ks(n,Jr.min())),i=xi().add(n),i=new Bi(Jr.min(),new Map,new Di(Hr),r,i),[4,Sh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),Mh(e),[3,4];case 2:return[4,La(e.jr,s,!1).then(function(){return Uh(e,s,u)}).catch(Da)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&lh(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=au(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,Yu.resolve(n)):i.Ri.Lu(e).next(function(t){return n=new wi(r,t,0,e.Bi),i.Ri.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,ka(r.jr,i.query,!1).then(function(t){return t=t.documents,i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(xh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,ka(i.jr,o,!0)];case 1:return n=t.sent(),r=new wh(o,n.Ji),e=r.uu(n.documents),n=Wi.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),xh(i,s,n.du),r=new bh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&Ha(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.Pa),n.fo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!cu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,La(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),Xa(e.Au,n.targetId),Uh(e,n.targetId)}).catch(Da)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Uh(e,n.targetId),[4,La(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function ap(n,r,i,o,s){var t=new sc({next:function(t){r.Ms(function(){return ch(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Vr(_r.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Vr(_r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new fh(eu(i.path),t,{includeMetadataChanges:!0,Ro:!0});return hh(n,u)}function hp(e,n,t,r,i){var o=new sc({next:function(t){n.Ms(function(){return ch(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Vr(_r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new fh(t,o,{includeMetadataChanges:!0,Ro:!0});return hh(e,s)}var cp=(lp.prototype.set=function(t,e,n){return this.hl(),e=id((t=fp(t,this.ah)).fh,e,n),n=Uf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n),this.ul=this.ul.concat(n.Ph(t.lh,ms.ce())),this},lp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.hl(),t=fp(t,this.ah),e instanceof uc&&(e=e.va),e="string"==typeof e||e instanceof Il?xf(this.al,"WriteBatch.update",t.lh,e,n,r):jf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,ms.exists(!0))),this},lp.prototype.delete=function(t){return this.hl(),t=fp(t,this.ah),this.ul=this.ul.concat(new js(t.lh,ms.ce())),this},lp.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},lp.prototype.hl=function(){if(this.cl)throw new Vr(_r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},lp);function lp(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=Nf(t)}function fp(t,e){if(t instanceof uc&&(t=t.va),t.firestore!==e)throw new Vr(_r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var pp,dp,yp=(Tp.prototype.get=function(t){var e=this,n=fp(t,this.ah),r=new Ef(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return kr();if((t=t[0])instanceof Ks)return new dl(e.ah,r,n.lh,null,n.fh);if(t instanceof Ys)return new dl(e.ah,r,t.key,t,n.fh);throw kr()})},Tp.prototype.set=function(t,e,n){return e=id((t=fp(t,this.ah)).fh,e,n),n=Uf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n),this.ll.set(t.lh,n),this},Tp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=fp(t,this.ah),e instanceof uc&&(e=e.va),e="string"==typeof e||e instanceof Il?xf(this.al,"Transaction.update",t.lh,e,n,r):jf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},Tp.prototype.delete=function(t){return t=fp(t,this.ah),this.ll.delete(t.lh),this},n(Ep,dp=Tp),Ep.prototype.get=function(t){var e=this,n=fp(t,this.ah),r=new jl(this.ah);return dp.prototype.get.call(this,t).then(function(t){return new kl(e.ah,r,n.lh,t._h,new Bp(!1,!1),n.fh)})},Ep),vp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",gp=(bp.prototype.enableIndexedDbPersistence=function(t,e){throw new Vr(_r.FAILED_PRECONDITION,vp)},bp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Vr(_r.FAILED_PRECONDITION,vp)},bp.prototype.clearIndexedDbPersistence=function(t){throw new Vr(_r.FAILED_PRECONDITION,vp)},bp),mp=(n(wp,pp=uc),Object.defineProperty(wp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),wp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},wp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},wp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return e=t.sent(),[4,op(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),Wa(t))]}})})})}(Ip(this.va))},wp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return e=t.sent(),[4,op(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,za(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Ip(this.va))},wp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&kc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},wp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},wp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},wp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Ku;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=_h,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ip(this.va))},wp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Ip(t),e=ea(e)?e:{next:e},i=new sc(e);return t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,up(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,up(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(wp.prototype,"app",{get:function(){if(!this.fl)throw new Vr(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),wp.prototype.collection=function(t){try{return new Kp(this,mf(this.va,t))}catch(t){throw Vp(t,"collection()","Firestore.collection()")}},wp.prototype.doc=function(t){try{return new Dp(this,wf(this.va,t))}catch(t){throw Vp(t,"doc()","Firestore.doc()")}},wp.prototype.collectionGroup=function(t){try{return new Hp(this,function(t,e){if(Rc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Vr(_r.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Wl(t,null,new Js($r.X(),e))}(this.va,t))}catch(t){throw Vp(t,"collectionGroup()","Firestore.collectionGroup()")}},wp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Ku;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,np(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new Qf(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Ip(n=this.va),function(t){return t=new yp(n,t),e(new Lp(r,t))})},wp.prototype.batch=function(){var e=this;return Ip(this.va),new kp(new cp(this.va,function(t){return Fl(e.va,t)}))},wp);function wp(t,e,n){var r=this;return(r=pp.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof wr||(r.fl=t),r}function bp(){}function Ep(t,e){var n=this;return(n=dp.call(this,t,e)||this).ah=t,n}function Tp(t,e){this.ah=t,this.ll=e,this.al=Nf(t)}function Ip(t){return t.Eh||Ap(t),t.Eh.sl(),t.Eh}function Ap(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new mr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new Jf(t.Qa,t.wh,r)}var Np,Op,Rp,Lp=(n(_p,Rp=uc),_p.prototype.get=function(t){var e=this,t=rd(t);return this.va.get(t).then(function(t){return new Wp(e.ah,t)})},_p.prototype.set=function(t,e,n){return t=rd(t),n?(Lc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},_p.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=rd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},_p.prototype.delete=function(t){return t=rd(t),this.va.delete(t),this},_p),kp=(n(Pp,Op=uc),Pp.prototype.set=function(t,e,n){return t=rd(t),n?(Lc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Pp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=rd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Pp.prototype.delete=function(t){return t=rd(t),this.va.delete(t),this},Pp.prototype.commit=function(){return this.va.commit()},Pp),Dp=(n(Sp,Np=uc),Sp.dl=function(t,e,n){if(t.length%2!=0)throw new Vr(_r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Sp(e,new Bl(e.va,n,new ei(t)))},Sp.uh=function(t,e,n){return new Sp(e,new Bl(e.va,n,t))},Object.defineProperty(Sp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"parent",{get:function(){return new Kp(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Sp.prototype.collection=function(t){try{return new Kp(this.firestore,mf(this.va,t))}catch(t){throw Vp(t,"collection()","DocumentReference.collection()")}},Sp.prototype.isEqual=function(t){return t instanceof uc&&(t=t.va),t instanceof Bl&&If(this.va,t)},Sp.prototype.set=function(t,e){e=Lc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=_c(n.firestore,Al),r=id(n.fh,r,i),Fl(o,Uf(Nf(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,ms.ce()))}catch(t){throw Vp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Sp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ml(this.va,t):Ml.apply(void 0,s([this.va,t,e],n))}catch(t){throw Vp(t,"updateDoc()","DocumentReference.update()")}},Sp.prototype.delete=function(){return Fl(_c((t=this.va).firestore,Al),[new js(t.lh,ms.ce())]);var t},Sp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Cp(t),i=Up(t,function(t){return new Wp(e.firestore,new kl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return ql(this.va,r,i)},Sp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new jl(n),o=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ip(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof Ys?s.resolve(r):r instanceof Ks?s.resolve(null):s.reject(new Vr(_r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=va(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new kl(n,i,e.lh,t,new Bp(t instanceof Ys&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(r)];case 1:return[4,ap(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Gl(n,e,t)})}:function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(r)];case 1:return[4,ap(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Gl(n,e,t)})})(this.va).then(function(t){return new Wp(e.firestore,new kl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},Sp.prototype.withConverter=function(t){return new Sp(this.firestore,this.va.withConverter(t))},Sp);function Sp(t,e){var n=this;return(n=Np.call(this,e)||this).firestore=t,n.hh=new pl(t),n}function Pp(){return null!==Op&&Op.apply(this,arguments)||this}function _p(t,e){var n=this;return(n=Rp.call(this,e)||this).ah=t,n}function Vp(t,e,n){return t.message=t.message.replace(e,n),t}function Cp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ea(r))return r}return{}}function Up(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ea(t[0])?t[0]:ea(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var jp,xp,Mp,qp,Fp,Gp,Bp=(nd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},nd),Wp=(n(ed,Gp=uc),Object.defineProperty(ed.prototype,"ref",{get:function(){return new Dp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),ed.prototype.data=function(t){return this.va.data(t)},ed.prototype.get=function(t,e){return this.va.get(t,e)},ed.prototype.isEqual=function(t){return Cl(this.va,t.va)},ed),zp=(n(td,Fp=Wp),td.prototype.data=function(t){return this.va.data(t)},td),Hp=(n(Zp,qp=uc),Zp.prototype.where=function(t,e,n){try{return new Zp(this.firestore,Xl(this.va,(r=n,i=e,o=El("where",t),new Zl(o,i,r))))}catch(t){throw Vp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Zp.prototype.orderBy=function(n,t){try{return new Zp(this.firestore,Xl(this.va,function(t){void 0===t&&(t="asc");var e=t,t=El("orderBy",n);return new tf(t,e)}(t)))}catch(n){throw Vp(n,/(orderBy|where)\(\)/,"Query.$1()")}},Zp.prototype.limit=function(t){try{return new Zp(this.firestore,Xl(this.va,(Vc("limit",e=t),new ef("limit",e,"F"))))}catch(t){throw Vp(t,"limit()","Query.limit()")}var e},Zp.prototype.limitToLast=function(t){try{return new Zp(this.firestore,Xl(this.va,(Vc("limitToLast",e=t),new ef("limitToLast",e,"L"))))}catch(t){throw Vp(t,"limitToLast()","Query.limitToLast()")}var e},Zp.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Xl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Vp(t,"startAt()","Query.startAt()")}},Zp.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Xl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Vp(t,"startAfter()","Query.startAfter()")}},Zp.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Xl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Vp(t,"endBefore()","Query.endBefore()")}},Zp.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Xl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Vp(t,"endAt()","Query.endAt()")}},Zp.prototype.isEqual=function(t){return Af(this.va,t.va)},Zp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new jl(n),o=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ip(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ka(r,i,!0)];case 1:return n=t.sent(),e=new wh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=va(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new jl(n),o=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(r)];case 1:return[4,hp(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})}:function(e){var t=this,n=_c(e.firestore,Al),r=Ip(n),i=new jl(n);df(e.Rh);var o=new Ku;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(r)];case 1:return[4,hp(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})})(this.va).then(function(t){return new Yp(e.firestore,t)})},Zp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Cp(t),i=Up(t,function(t){return new Yp(e.firestore,t)});return ql(this.va,r,i)},Zp.prototype.withConverter=function(t){return new Zp(this.firestore,this.va.withConverter(t))},Zp),Xp=(n($p,Mp=uc),Object.defineProperty($p.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"doc",{get:function(){return new zp(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),$p),Yp=(n(Jp,xp=uc),Object.defineProperty(Jp.prototype,"query",{get:function(){return new Hp(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new zp(e.ah,t)})},enumerable:!1,configurable:!0}),Jp.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new Xp(e.ah,t)})},Jp.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new zp(r.ah,t))})},Jp.prototype.isEqual=function(t){return Cl(this.va,t.va)},Jp),Kp=(n(Qp,jp=Hp),Object.defineProperty(Qp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Dp(this.firestore,t):null},enumerable:!1,configurable:!0}),Qp.prototype.doc=function(t){try{return new Dp(this.firestore,void 0===t?wf(this.va):wf(this.va,t))}catch(t){throw Vp(t,"doc()","CollectionReference.doc()")}},Qp.prototype.add=function(t){var e,n=this,r=this.va,i=t;return t=_c(r.firestore,Al),e=wf(r),i=id(r.fh,i),Fl(t,Uf(Nf(r.firestore),"addDoc",e.lh,i,null!==r.fh,{}).Ph(e.lh,ms.exists(!1))).then(function(){return e}).then(function(t){return new Dp(n.firestore,t)})},Qp.prototype.isEqual=function(t){return If(this.va,t.va)},Qp.prototype.withConverter=function(t){return new Qp(this.firestore,this.va.withConverter(t))},Qp);function Qp(t,e){var n=this;return(n=jp.call(this,t,e)||this).firestore=t,n.va=e,n}function Jp(t,e){var n=this;return(n=xp.call(this,e)||this).ah=t,n}function $p(t,e){var n=this;return(n=Mp.call(this,e)||this).ah=t,n}function Zp(t,e){var n=this;return(n=qp.call(this,e)||this).firestore=t,n}function td(){return null!==Fp&&Fp.apply(this,arguments)||this}function ed(t,e){var n=this;return(n=Gp.call(this,e)||this).ah=t,n}function nd(t,e){this.hasPendingWrites=t,this.fromCache=e}function rd(t){return t instanceof uc&&(t=t.va),_c(t,Bl)}function id(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var od,sd,l=(n(ad,sd=uc),ad.documentId=function(){return new ad(ti.nt().Y())},ad.prototype.isEqual=function(t){return t instanceof uc&&(t=t.va),t instanceof Il&&this.va.dh.isEqual(t.dh)},ad),me=(n(ud,od=uc),ud.serverTimestamp=function(){var t=new Wc("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new ud(t)},ud.delete=function(){var t=new jc("deleteField");return t.ba="FieldValue.delete",new ud(t)},ud.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zc("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new ud(n)},ud.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hc("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new ud(n)},ud.increment=function(t){return(t=new Xc("increment",t)).ba="FieldValue.increment",new ud(t)},ud.prototype.isEqual=function(t){return this.va.isEqual(t.va)},ud),me={Firestore:mp,GeoPoint:Yc,Timestamp:Qr,Blob:fl,Transaction:Lp,WriteBatch:kp,DocumentReference:Dp,DocumentSnapshot:Wp,Query:Hp,QueryDocumentSnapshot:zp,QuerySnapshot:Yp,CollectionReference:Kp,FieldPath:l,FieldValue:me,setLogLevel:function(t){Ir.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function ud(){return null!==od&&od.apply(this,arguments)||this}function ad(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sd.call(this,new(Il.bind.apply(Il,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new mp(e,new Al(e,t),new gp);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.4")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});