!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(my){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(my);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ke=u=u||{})[Ke.DEBUG=0]="DEBUG",Ke[Ke.VERBOSE=1]="VERBOSE",Ke[Ke.INFO=2]="INFO",Ke[Ke.WARN=3]="WARN",Ke[Ke.ERROR=4]="ERROR",Ke[Ke.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((We={})[u.DEBUG]="log",We[u.VERBOSE]="log",We[u.INFO]="info",We[u.WARN]="warn",We[u.ERROR]="error",We),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function l(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(l(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=N||self;function D(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function x(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:x).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function F(t,o){function e(){}e.prototype=o.prototype,t.Y=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var z,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}t:{var X=S.navigator;if(X){X=X.userAgent;if(X){z=X;break t}}z=""}function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function tt(t){return tt[" "](t),t}tt[" "]=D;var et,nt=K(z,"Opera"),rt=K(z,"Trident")||K(z,"MSIE"),it=K(z,"Edge"),ot=it||rt,st=K(z,"Gecko")&&!(K(z.toLowerCase(),"webkit")&&!K(z,"Edge"))&&!(K(z,"Trident")||K(z,"MSIE"))&&!K(z,"Edge"),ut=K(z.toLowerCase(),"webkit")&&!K(z,"Edge");function at(){var t=S.document;return t?t.documentMode:void 0}t:{var ct="",ht=(ht=z,st?/rv:([^\);]+)(\)|;)/.exec(ht):it?/Edge\/([\d\.]+)/.exec(ht):rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ht):ut?/WebKit\/(\S+)/.exec(ht):nt?/(?:Version)[ \/]?(\S+)/.exec(ht):void 0);if(ht&&(ct=ht?ht[1]:""),rt){ht=at();if(null!=ht&&ht>parseFloat(ct)){et=String(ht);break t}}et=ct}var lt={};function ft(u){return t=u,e=function(){for(var t=0,e=J(String(et)).split("."),n=J(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var pt=S.document&&rt?at()||(parseInt(et,10)||void 0):void 0;function dt(t,e,n){this.reset(t,e,n,void 0,void 0)}function yt(t){this.g=t,this.a=this.f=this.b=this.c=null}function vt(t,e){this.name=t,this.value=e}dt.prototype.a=null,dt.prototype.reset=function(t,e,n,r,i){this.c=r||M(),this.f=t,this.g=e,this.b=n,delete this.a},vt.prototype.toString=function(){return this.name};var gt=new vt("SEVERE",1e3),mt=new vt("WARNING",900),wt=new vt("INFO",800),bt=new vt("CONFIG",700),_t=new vt("FINE",500);yt.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.b?e.b:e.c?t(e.c):null}(this).value)for("function"==typeof e&&(e=e()),t=new dt(t,String(e),this.g),n&&(t.a=n),n=this;n;){var r=n,i=t;if(r.a)for(var o=0;e=r.a[o];o++)e(i);n=n.c}},yt.prototype.info=function(t,e){this.log(wt,t,e)};var Et={},Tt=null;function It(t){var e,n,r;return Tt||(Tt=new yt(""),(Et[""]=Tt).b=bt),(e=Et[t])||(e=new yt(t),r=t.lastIndexOf("."),n=t.substr(r+1),(r=It(t.substr(0,r))).f||(r.f={}),(r.f[n]=e).c=r,Et[t]=e),e}function At(){this.a=M()}var Nt=null;function Ot(t){this.f=t||"",Nt=Nt||new At,this.g=Nt}function St(t){return t<10?"0"+t:String(t)}function Dt(t){Ot.call(this,t)}function Lt(t,e){var n,r=[];return r.push(t.f," "),t.b&&(n=new Date(e.c),r.push("[",St(n.getFullYear()-2e3)+St(n.getMonth()+1)+St(n.getDate())+" "+St(n.getHours())+":"+St(n.getMinutes())+":"+St(n.getSeconds())+"."+St(Math.floor(n.getMilliseconds()/10)),"] ")),r.push("[",function(t,e){e=(t=(t.c-e)/1e3).toFixed(3);var n=0;if(t<1)n=2;else for(;t<100;)n++,t*=10;for(;0<n--;)e=" "+e;return e}(e,t.g.get()),"s] "),r.push("[",e.b,"] "),r.push(e.g),t.c&&(e=e.a)&&r.push("\n",e instanceof Error?e.message:e.toString()),t.a&&r.push("\n"),r.join("")}function Rt(t,e){t&&t.log(mt,e,void 0)}function Ct(t,e){t&&t.info(e,void 0)}function kt(t,e){t&&t.log(_t,e,void 0)}function Pt(){this.g=V(this.c,this),this.a=new Dt,this.a.b=!1,this.a.c=!1,this.b=this.a.a=!1,this.f={}}At.prototype.set=function(t){this.a=t},At.prototype.reset=function(){this.set(M())},At.prototype.get=function(){return this.a},Ot.prototype.a=!0,Ot.prototype.b=!0,Ot.prototype.c=!1,F(Dt,Ot),Pt.prototype.c=function(t){var e,n,r;this.f[t.b]||(r=Lt(this.a,t),xt&&(n=function(t){if(t){if(t.value>=gt.value)return"error";if(t.value>=mt.value)return"warn";if(t.value>=bt.value)return"log"}return"debug"}(t.f),e=xt,n=n,r=r,t=t.a,e[n]?e[n](r,t||""):e.log(r,t||"")))};var xt=S.console;function Vt(){this.m=this.m,this.j=this.j}Vt.prototype.m=!1,Vt.prototype.ja=function(){var t;!this.m&&(this.m=!0,this.H(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++k))},Vt.prototype.H=function(){if(this.j)for(;this.j.length;)this.j.shift()()};var Ut=!rt||9<=Number(pt),Mt=rt&&!ft("9"),Ft=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function qt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function jt(t,e){if(qt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(st){t:{try{tt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ht[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}qt.prototype.b=function(){this.defaultPrevented=!0},F(jt,qt);var Ht={2:"touch",3:"pen",4:"mouse"};jt.prototype.b=function(){jt.Y.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Bt="closure_listenable_"+(1e6*Math.random()|0),Gt=0;function zt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Gt,this.Z=this.$=!1}function Jt(t){t.Z=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Kt(t){this.src=t,this.a={},this.b=0}function Wt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Jt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Z&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Xt(t,e,r,i);return-1<s?(e=t[s],n||(e.$=!1)):((e=new zt(e,this.src,o,!!r,i)).$=n,t.push(e)),e};var Yt="closure_lm_"+(1e6*Math.random()|0),Qt={};function $t(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=se(r);return e&&e[Bt]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Zt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)$t(t,e[o],n,r,i);return null}return n=se(n),t&&t[Bt]?t.va(e,n,R(r)?!!r.capture:!!r,i):Zt(t,e,n,!1,r,i)}function Zt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!Ut)return null;var u,a,c=ie(t);if(c||(t[Yt]=c=new Kt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=re,r=a=Ut?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Ft||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ee(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function te(t){var e,n,r;"number"!=typeof t&&t&&!t.Z&&((e=t.src)&&e[Bt]?Wt(e.f,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ee(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ie(e))?(Wt(n,t),0==n.b&&(n.src=null,e[Yt]=null)):Jt(t)))}function ee(t){return t in Qt?Qt[t]:Qt[t]="on"+t}function ne(t,e){var n=t.listener,r=t.ca||t.src;return t.$&&te(t),n.call(r,e)}function re(t,e){if(t.Z)return!0;if(Ut)return ne(t,new jt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ne(t,e=new jt(e,this))}function ie(t){return(t=t[Yt])instanceof Kt?t:null}var oe="__closure_events_fn_"+(1e9*Math.random()>>>0);function se(e){return"function"==typeof e?e:(e[oe]||(e[oe]=function(t){return e.handleEvent(t)}),e[oe])}function ue(){Vt.call(this),this.f=new Kt(this),(this.L=this).F=null}function ae(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.L,r=e.type||e,"string"==typeof e?e=new qt(e,t):e instanceof qt?e.target=e.target||t:(s=e,Z(e=new qt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=ce(o,r,!0,e)&&s;if(s=ce(o=e.a=t,r,!0,e)&&s,s=ce(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=ce(o=e.a=n[i],r,!1,e)&&s}function ce(t,e,n,r){if(!(e=t.f.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Z&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.$&&Wt(t.f,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(ue,Vt),ue.prototype[Bt]=!0,(A=ue.prototype).addEventListener=function(t,e,n,r){$t(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=se(r),e&&e[Bt]?(e=e.f,(n=String(n).toString())in e.a&&-1<(r=Xt(s=e.a[n],r,i,o))&&(Jt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&ie(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Xt(n,r,i,o)),(r=-1<e?n[e]:null)&&te(r))}(this,t,e,n,r)},A.H=function(){if(ue.Y.H.call(this),this.f){var t,e=this.f;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Jt(n[r]);delete e.a[t],e.b--}}this.F=null},A.va=function(t,e,n,r){return this.f.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.f.add(String(t),e,!0,n,r)};var he=S.JSON.stringify;function le(){this.b=this.a=null}var fe,pe=(de.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new de(function(){return new ye},function(t){t.reset()}));function de(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function ye(){this.next=this.b=this.a=null}function ve(t,e){var n;fe||(n=S.Promise.resolve(void 0),fe=function(){n.then(we)}),ge||(fe(),ge=!0),me.add(t,e)}le.prototype.add=function(t,e){var n=pe.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},ye.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ge=!(ye.prototype.reset=function(){this.next=this.b=this.a=null}),me=new le;function we(){for(var t,e;n=e=void 0,n=null,(e=me).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=pe;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}ge=!1}function be(t,e){ue.call(this),this.b=t||1,this.a=e||S,this.c=V(this.Za,this),this.g=M()}function _e(t){t.aa=!1,t.O&&(t.a.clearTimeout(t.O),t.O=null)}function Ee(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(be,ue),(A=be.prototype).aa=!1,A.O=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.O=this.a.setTimeout(this.c,this.b-t):(this.O&&(this.a.clearTimeout(this.O),this.O=null),ae(this,"tick"),this.aa&&(_e(this),this.start())))},A.start=function(){this.aa=!0,this.O||(this.O=this.a.setTimeout(this.c,this.b),this.g=M())},A.H=function(){be.Y.H.call(this),_e(this),delete this.a};var Te,Ie,Ae,Ne=(T(Ie=Se,Ae=Te=Vt),Ie.prototype=null===Ae?Object.create(Ae):(Oe.prototype=Ae.prototype,new Oe),Se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},Se.prototype.H=function(){Te.prototype.H.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},Se);function Oe(){this.constructor=Ie}function Se(t,e){var n=Te.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function De(t){Vt.call(this),this.b=t,this.a={}}F(De,Vt);var Le=[];function Re(t,e,n,r){Array.isArray(n)||(n&&(Le[0]=n.toString()),n=Le);for(var i=0;i<n.length;i++){var o=$t(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ce(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&te(t)},t),t.a={}}function ke(){this.a=It("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function Pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(e,n){if(!e.b)return n;if(!n)return null;try{var t=JSON.parse(n);if(t)for(var r=0;r<t.length;r++)if(Array.isArray(t[r])){var i=t[r];if(!(i.length<2)){var o=i[1];if(Array.isArray(o)&&!(o.length<1)){i=o[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var s=1;s<o.length;s++)o[s]=""}}}return he(t)}catch(t){return xe(e,"Exception parsing expected JS array - probably was not JS"),n}}(t,n)+(r?" "+r:"")})}function xe(t,e){kt(t.a,e)}function Ve(t,e,n){(t=t.a)&&t.log(gt,n||"Exception",e)}function Ue(t,e){(t=t.a)&&t.log(gt,e,void 0)}De.prototype.H=function(){De.Y.H.call(this),Ce(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ke.prototype.info=function(t){Ct(this.a,t)};var Me={},Fe=null;function qe(){return Fe=Fe||new ue}function je(t){qt.call(this,Me.Fa,t)}function He(t){var e=qe();ae(e,new je(e))}function Be(t,e){qt.call(this,Me.STAT_EVENT,t),this.stat=e}function Ge(t){var e=qe();ae(e,new Be(e,t))}function ze(t){qt.call(this,Me.Ga,t)}function Je(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}Me.Fa="serverreachability",F(je,qt),Me.STAT_EVENT="statevent",F(Be,qt),Me.Ga="timingevent",F(ze,qt);var Ke={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},We={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Xe(){}function Ye(t){var e;return(e=t.a)||(e=t.a={}),e}function Qe(){}Xe.prototype.a=null;var $e,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ze(){qt.call(this,"d")}function tn(){qt.call(this,"c")}function en(){}function nn(t,e,n,r){this.g=t,this.b=e,this.c=n,this.S=r||1,this.J=new De(this),this.P=rn,t=ot?125:void 0,this.R=new be(t),this.A=null,this.f=!1,this.m=this.i=this.j=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.l=null,this.K=-1,this.v=!1,this.L=0,this.F=null,this.X=this.C=this.W=this.I=!1}F(Ze,qt),F(tn,qt),F(en,Xe),$e=new en;var rn=45e3;var on={},sn={};function un(t,e,n){t.G=1,t.j=Sn(En(e)),t.m=n,t.I=!0,an(t,null)}function an(t,e){t.u=M(),hn(t),t.i=En(t.j);var s,u,a,c,h,l,n=t.i,r=t.S;Array.isArray(r)||(r=[String(r)]),jn(n.b,"t",r),t.D=0,t.a=xr(t.g,t.g.F?e:null),0<t.L&&(t.F=new Ne(V(t.Ca,t,t.a),t.L)),Re(t.J,t.a,"readystatechange",t.Xa),e=t.A?Q(t.A):{},t.m?(t.l||(t.l="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.i,t.l,t.m,e)):(t.l="GET",t.a.ba(t.i,t.l,null,e)),He(1),s=t.b,u=t.l,a=t.i,c=t.c,h=t.S,l=t.m,s.info(function(){if(s.b)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function cn(t,e,n){for(var r,i,o,s=!0;!t.v&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?sn:(i=Number(u.substring(i,o)),isNaN(i)?on:(o+=1)+i>u.length?sn:(u=u.substr(o,i),r.D=o+i,u)));if(u==sn){4==e&&(t.h=4,Ge(14),s=!1),Pe(t.b,t.c,null,"[Incomplete Response]");break}if(u==on){t.h=4,Ge(15),Pe(t.b,t.c,n,"[Invalid Chunk]"),s=!1;break}Pe(t.b,t.c,u,null),yn(t,u)}4==e&&0==n.length&&(t.h=1,Ge(16),s=!1),t.f=t.f&&s,s?0<n.length&&!t.X&&(t.X=!0,(e=t.g).b==t&&e.W&&!e.I&&(e.a.info("Great, no buffering proxy detected. Bytes received: "+n.length),Or(e),e.I=!0,Ge(11))):(Pe(t.b,t.c,n,"[Invalid Chunked Response]"),dn(t),pn(t))}function hn(t){t.T=M()+t.P,ln(t,t.P)}function ln(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Je(V(t.Va,t),e)}function fn(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function pn(t){0==t.g.B||t.v||Lr(t.g,t)}function dn(t){fn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,_e(t.R),Ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function yn(e,t){try{var n,r,i,o,s=e.g;if(0!=s.B&&(s.b==e||Wn(s.f,e)))if(s.C=e.K,!e.C&&Wn(s.f,e)&&3==s.B){try{var u=s.ka.a.parse(t)}catch(t){u=null}if(Array.isArray(u)&&3==u.length){var a=u;if(0==a[0])t:if(xe(s.a,"Server claims our backchannel is missing."),s.j)xe(s.a,"But we are currently starting the request.");else{if(s.b){if(!(s.b.u+3e3<e.u))break t;Dr(s),mr(s)}else Rt(s.a.a,"We do not have a BackChannel established");Nr(s),Ge(18)}else{s.oa=a[1];var c,h=s.oa-s.P;0<h&&(c=a[2],xe(s.a,c+" bytes (in "+h+" arrays) are outstanding on the BackChannel"),c<37500&&s.J&&0==s.o&&!s.l&&(s.l=Je(V(s.Sa,s),6e3)))}if(Kn(s.f)<=1&&s.ea){try{s.ea()}catch(t){Ve(s.a,t,"Exception from forwardChannelFlushedCallback_ ")}s.ea=void 0}}else xe(s.a,"Bad POST response data returned"),Cr(s,11)}else if(!e.C&&s.b!=e||Dr(s),!G(t))for(h=u=s.ka.a.parse(t),c=0;c<h.length;c++){a=h[c],s.P=a[0],a=a[1],2==s.B?"c"==a[0]?(s.K=a[1],s.ga=a[2],null!=(n=a[3])&&(s.ha=n,s.a.info("VER="+s.ha)),null!=(i=a[4])&&(s.pa=i,s.a.info("SVER="+s.pa)),null!=(n=a[5])&&"number"==typeof n&&0<n&&(t=1.5*n,s.G=t,s.a.info("backChannelRequestTimeoutMs_="+t)),t=s,(i=e.a)&&(!(n=i.a?i.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(r=t.f).a&&(K(n,"spdy")||K(n,"quic")||K(n,"h2"))&&(r.f=r.g,r.a=new Set,r.b&&(Xn(r,r.b),r.b=null)),t.v&&((o=i.a?i.a.getResponseHeader("X-HTTP-Session-Id"):null)?(t.na=o,On(t.A,t.v,o)):Rt(t.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),s.B=3,s.g&&s.g.ta(),s.W&&(s.D=M()-e.u,s.a.info("Handshake RTT: "+s.D+"ms")),u=e,r=t=s,o=Pr(i=t,i.F?t.ga:null,t.fa),xe(i.a,"GetBackChannelUri: "+o),r.la=o,u.C?(xe(t.a,"Upgrade the handshake request to a backchannel."),Yn(t.f,u),r=u,(o=t.G)&&r.setTimeout(o),r.o&&(fn(r),hn(r)),t.b=u):Ar(t),0<s.c.length&&_r(s)):"stop"!=a[0]&&"close"!=a[0]||Cr(s,7):3==s.B&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Cr(s,7):gr(s):"noop"!=a[0]&&s.g&&s.g.sa(a),s.o=0)}He(4)}catch(t){Ve(e.b,t,"Error in httprequest callback")}}function vn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)j(t,e,void 0);else{if(t.N&&"function"==typeof t.N)var n=t.N();else if(t.M&&"function"==typeof t.M)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.M&&"function"==typeof t.M)return t.M();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function gn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof gn)for(n=t.N(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function mn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];wn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)wn(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function wn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=nn.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==fr(t)?(xe(this.b,"Throttling readystatechange."),e.f()):this.Ca(t)},A.Ca=function(t){try{t==this.a?function(t){var e=fr(t.a),n=t.a.ua(),r=t.a.V();if(!(e<3||3==e&&!ot&&!t.a.U())){t.v||4!=e||7==n||He(8==n||r<=0?3:2),fn(t);var i=t.a.V();if(t.K=i,(n=t.a.U())||xe(t.b,function(){return"No response text for uri "+t.i+" status "+i}),t.f=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(t.b,t.l,t.i,t.c,t.S,e,i),t.f){if(t.W&&!t.C){if(!(r=function(t){return t.a&&(t=(t=t.a).a?t.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(t)?t:null}(t)))return t.f=!1,t.h=3,Ge(12),Rt(t.b.a,"XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ("+t.c+")"),dn(t),pn(t);Pe(t.b,t.c,r,"Initial handshake response via X-HTTP-Initial-Response"),t.C=!0,yn(t,r)}t.I?(cn(t,e,n),ot&&t.f&&3==e&&function(t){Re(t.J,t.R,"tick",t.Wa),t.R.start()}(t)):(Pe(t.b,t.c,n,null),yn(t,n)),4==e&&dn(t),t.f&&!t.v&&(4==e?Lr(t.g,t):(t.f=!1,hn(t)))}else 400==i&&0<n.indexOf("Unknown SID")?(t.h=3,Ge(12),Rt(t.b.a,"XMLHTTP Unknown SID ("+t.c+")")):(t.h=0,Ge(13),Rt(t.b.a,"XMLHTTP Bad status "+i+" ("+t.c+")")),dn(t),pn(t)}}(this):Rt(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){var e;xe(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.U()?Ve((e=this).b,t,function(){return"ResponseText: "+e.a.U()}):Ve(this.b,t,"No response text")}},A.Wa=function(){var t,e;this.a&&(t=fr(this.a),e=this.a.U(),this.D<e.length&&(fn(this),cn(this,t,e),this.f&&4!=t&&hn(this)))},A.cancel=function(){this.v=!0,dn(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(this.f&&Ue(this.b,"Received watchdog timeout even though request loaded successfully"),t=this.b,e=this.i,t.info(function(){return"TIMEOUT: "+e}),2!=this.G&&(He(3),Ge(17)),dn(this),this.h=2,pn(this)):(Rt(this.b.a,"WatchDog timer called too early"),ln(this,this.T-n))},(A=gn.prototype).M=function(){mn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.N=function(){return mn(this),this.a.concat()},A.get=function(t,e){return wn(this.b,t)?this.b[t]:e},A.set=function(t,e){wn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.N(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var bn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function _n(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof _n?(this.a=void 0!==e?e:t.a,Tn(this,t.f),this.j=t.j,In(this,t.c),An(this,t.h),this.g=t.g,e=t.b,(n=new Un).c=e.c,e.a&&(n.a=new gn(e.a),n.b=e.b),Nn(this,n),this.i=t.i):t&&(n=String(t).match(bn))?(this.a=!!e,Tn(this,n[1]||"",!0),this.j=Dn(n[2]||""),In(this,n[3]||"",!0),An(this,n[4]),this.g=Dn(n[5]||"",!0),Nn(this,n[6]||"",!0),this.i=Dn(n[7]||"")):(this.a=!!e,this.b=new Un(null,this.a))}function En(t){return new _n(t)}function Tn(t,e,n){t.f=n?Dn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function In(t,e,n){t.c=n?Dn(e,!0):e}function An(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Nn(t,e,n){var r,i;e instanceof Un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(Mn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Fn(this,e),jn(this,n,t))},r)),r.f=i):(n||(e=Ln(e,xn)),t.b=new Un(e,t.a))}function On(t,e,n){t.b.set(e,n)}function Sn(t){return On(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function Dn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ln(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_n.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ln(e,Cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ln(e,Cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ln(n,"/"==n.charAt(0)?Pn:kn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ln(n,Vn)),t.join("")};var Cn=/[#\/\?@]/g,kn=/[#\?:]/g,Pn=/[#\?]/g,xn=/[#\?@]/g,Vn=/#/g;function Un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Mn(n){n.a||(n.a=new gn,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function Fn(t,e){Mn(t),e=Hn(t,e),wn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,wn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&mn(t)))}function qn(t,e){return Mn(t),e=Hn(t,e),wn(t.a.b,e)}function jn(t,e,n){Fn(t,e),0<n.length&&(t.c=null,t.a.set(Hn(t,e),B(n)),t.b+=n.length)}function Hn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=Un.prototype).add=function(t,e){Mn(this),this.c=null,t=Hn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){Mn(this),this.a.forEach(function(t,e){j(t,function(t){n.call(r,t,e,this)},this)},this)},A.N=function(){Mn(this);for(var t=this.a.M(),e=this.a.N(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.M=function(t){Mn(this);var e=[];if("string"==typeof t)qn(this,t)&&(e=H(e,this.a.get(Hn(this,t))));else{t=this.a.M();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},A.set=function(t,e){return Mn(this),this.c=null,qn(this,t=Hn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.M(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.N(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.M(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Bn=function(t,e){this.b=t,this.a=e};function Gn(t){this.g=t||zn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var zn=10;function Jn(t){return t.b||t.a&&t.a.size>=t.f}function Kn(t){return t.b?1:t.a?t.a.size:0}function Wn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Xn(t,e){t.a?t.a.add(e):t.b=e}function Yn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Qn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function $n(){}function Zn(){this.a=new $n}function tr(e,t,n,r,i){try{xe(e,n),t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(t){Ve(e,t)}}Gn.prototype.cancel=function(){var e,t;if(this.c=Qn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},$n.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},$n.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var er=S.JSON.parse;function nr(t){ue.call(this),this.headers=new gn,this.I=t||null,this.c=!1,this.A=this.a=null,this.J=this.s="",this.i=0,this.g="",this.h=this.D=this.o=this.C=!1,this.l=0,this.u=null,this.K=rr,this.v=this.G=!1}F(nr,ue);var rr="";nr.prototype.b=It("goog.net.XhrIo");var ir=/^https?$/i,or=["POST","PUT"];function sr(t){return"content-type"==t.toLowerCase()}function ur(t,e){t.c=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.i=5,ar(t),hr(t)}function ar(t){t.C||(t.C=!0,ae(t,"complete"),ae(t,"error"))}function cr(t){if(t.c&&void 0!==O)if(t.A[1]&&4==fr(t)&&2==t.V())kt(t.b,pr(t,"Local request error detected and ignored"));else if(t.o&&4==fr(t))Ee(t.za,0,t);else if(ae(t,"readystatechange"),4==fr(t)){kt(t.b,pr(t,"Request complete")),t.c=!1;try{var e,n,r,i,o=t.V();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.s).match(bn)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!ir.test(i?i.toLowerCase():"")),e=n);if(e)ae(t,"complete"),ae(t,"success");else{t.i=6;try{var u=2<fr(t)?t.a.statusText:""}catch(o){kt(t.b,"Can not get status: "+o.message),u=""}t.g=u+" ["+t.V()+"]",ar(t)}}finally{hr(t)}}}function hr(e,t){if(e.a){lr(e);var n=e.a,r=e.A[0]?D:null;e.a=null,e.A=null,t||ae(e,"ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(gt,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function lr(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(S.clearTimeout(t.u),t.u=null)}function fr(t){return t.a?t.a.readyState:0}function pr(t,e){return e+" ["+t.J+" "+t.s+" "+t.V()+"]"}function dr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):On(t,e,n))}function yr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function vr(t){this.pa=0,this.c=[],this.a=new ke,this.ga=this.la=this.A=this.fa=this.b=this.na=this.v=this.X=this.i=this.L=this.m=null,this.Oa=this.R=0,this.La=yr("failFast",!1,t),this.J=this.l=this.j=this.h=this.g=null,this.S=!0,this.C=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=yr("baseRetryDelayMs",5e3,t),this.Ra=yr("retryDelaySeedMs",1e4,t),this.Ma=yr("forwardChannelMaxRetries",2,t),this.ma=yr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.G=void 0,this.F=t&&t.supportsCrossDomainXhr||!1,this.K="",this.f=new Gn(t&&t.concurrentRequestLimit),this.ka=new Zn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.a.b=!1),t&&t.forceLongPolling&&(this.S=!1),this.W=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.D=0,this.I=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.a.info("Opt-in to enable Chrome Origin Trials.")}function gr(t){var e,n;xe(t.a,"disconnect()"),wr(t),3==t.B&&(e=t.R++,On(n=En(t.A),"SID",t.K),On(n,"RID",e),On(n,"TYPE","terminate"),Tr(t,n),(e=new nn(t,t.a,e,void 0)).G=2,e.j=Sn(En(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.j.toString(),"")),!n&&S.Image&&((new Image).src=e.j,n=!0),n||(e.a=xr(e.g,null),e.a.ba(e.j)),e.u=M(),hn(e)),kr(t)}function mr(t){t.b&&(Or(t),t.b.cancel(),t.b=null)}function wr(t){mr(t),t.j&&(S.clearTimeout(t.j),t.j=null),Dr(t),t.f.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function br(t,e){1e3==t.c.length&&Ue(t.a,function(){return"Already have 1000 queued maps upon queueing "+he(e)}),t.c.push(new Bn(t.Oa++,e)),3==t.B&&_r(t)}function _r(t){Jn(t.f)||t.h||(t.h=!0,ve(t.Ba,t),t.u=0)}function Er(t,e){var n=e?e.c:t.R++,r=En(t.A);On(r,"SID",t.K),On(r,"RID",n),On(r,"AID",t.P),Tr(t,r),t.i&&t.m&&dr(r,t.i,t.m),n=new nn(t,t.a,n,t.u+1),null===t.i&&(n.A=t.m),e&&(t.c=e.s.concat(t.c)),e=Ir(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Xn(t.f,n),un(n,r,e)}function Tr(t,n){t.g&&vn({},function(t,e){On(n,e,t)})}function Ir(t,e,n){n=Math.min(t.c.length,n);var r=t.g?V(t.g.Ja,t.g,t):null;t:for(var i=t.c,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{vn(t,function(t,e){var n=t;R(t)&&(n=he(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.c.splice(0,n),e.s=t,r}function Ar(t){t.b||t.j||(t.T=1,ve(t.Aa,t),t.o=0)}function Nr(t){return t.b||t.j?(Ue(t.a,"Request already in progress"),0):!(3<=t.o)&&(xe(t.a,"Going to retry GET"),t.T++,t.j=Je(V(t.Aa,t),Rr(t,t.o)),t.o++,1)}function Or(t){null!=t.s&&(xe(t.a,"Cancel the BP detection timer."),S.clearTimeout(t.s),t.s=null)}function Sr(t){xe(t.a,"Creating new HttpRequest"),t.b=new nn(t,t.a,"rpc",t.T),null===t.i&&(t.b.A=t.m),t.b.L=0;var e=En(t.la);On(e,"RID","rpc"),On(e,"SID",t.K),On(e,"CI",t.J?"0":"1"),On(e,"AID",t.P),Tr(t,e),On(e,"TYPE","xmlhttp"),t.i&&t.m&&dr(e,t.i,t.m),t.G&&t.b.setTimeout(t.G);var n=t.b,r=t.ga;n.G=1,n.j=Sn(En(e)),n.m=null,n.I=!0,an(n,r),xe(t.a,"New Request created")}function Dr(t){null!=t.l&&(S.clearTimeout(t.l),t.l=null)}function Lr(t,e){xe(t.a,"Request complete");var n,r,i,o,s=null;if(t.b==e){Dr(t),Or(t),t.b=null;var u=2}else{if(!Wn(t.f,e))return;s=e.s,Yn(t.f,e),u=1}if(t.C=e.K,0!=t.B)if(e.f)1==u?(n=e.m?e.m.length:0,r=M()-e.u,i=t.u,ae(o=qe(),new ze(o)),_r(t)):Ar(t);else{var a=e.h;if(3==a||0==a&&0<t.C)xe(t.a,"Not retrying due to error type");else{if(xe(t.a,function(){return"Maybe retrying, last error: "+function(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}(a,t.C)}),1==u&&(i=e,Kn((e=t).f)>=e.f.f-(e.h?1:0)?(Ue(e.a,"Unexpected retry request is scheduled."),0):e.h?(xe(e.a,"Use the retry request that is already scheduled."),e.c=i.s.concat(e.c),1):!(1==e.B||2==e.B||e.u>=(e.La?0:e.Ma))&&(xe(e.a,"Going to retry POST"),e.h=Je(V(e.Ba,e,i),Rr(e,e.u)),e.u++,1))||2==u&&Nr(t))return;xe(t.a,"Exceeded max number of retries")}switch(s&&0<s.length&&(u=t.f,s=s,u.c=u.c.concat(s)),xe(t.a,"Error: HTTP request failed"),a){case 1:Cr(t,5);break;case 4:Cr(t,10);break;case 3:Cr(t,6);break;default:Cr(t,2)}}}function Rr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.g||(xe(t.a,"Inactive channel"),n*=2),n*e}function Cr(t,e){var n,r,i,o;t.a.info("Error code "+e),2==e?(r=null,t.g&&(r=null),o=V(t.Ya,t),r||(r=new _n("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Tn(r,"https"),Sn(r)),n=r.toString(),r=o,xe(o=new ke,"TestLoadImage: loading "+n),S.Image?((i=new Image).onload=U(tr,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(tr,o,i,"TestLoadImage: error",!1,r),i.onabort=U(tr,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(tr,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):Ge(2),xe(t.a,"HttpChannel: error - "+e),t.B=0,t.g&&t.g.ra(e),kr(t),wr(t)}function kr(t){var e;t.B=0,t.C=-1,t.g&&(0==(e=Qn(t.f)).length&&0==t.c.length||(xe(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.c.length}),t.f.c.length=0,B(t.c),t.c.length=0),t.g.qa())}function Pr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof _n?En(s):new _n(s,void 0);return""!=a.c?(e&&In(a,e+"."+a.c),An(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new _n(null,void 0),r&&Tn(u,r),i&&In(u,i),o&&An(u,o),s&&(u.g=s),a=u),t.X&&Y(t.X,function(t,e){On(a,e,t)}),e=t.v,n=t.na,e&&n&&On(a,e,n),On(a,"VER",t.ha),Tr(t,a),a}function xr(t,e){if(e&&!t.F)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new nr(t.Na)).G=t.F,e}function Vr(){}function Ur(){if(rt&&!(10<=Number(pt)))throw Error("Environmental error: no available transport.")}function Mr(t,e){ue.call(this),this.a=new vr(e),this.c=t,this.b=It("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.m=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.L=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.s=e&&e.supportsCrossDomainXhr||!1,this.o=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.v=e,null!==(t=this.g)&&e in t&&(e in(t=this.g)&&delete t[e],Rt(this.b,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new jr(this)}function Fr(t){Ze.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function qr(){tn.call(this),this.status=1}function jr(t){this.a=t}(A=nr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+t);e=e?e.toUpperCase():"GET",this.s=t,this.g="",this.i=0,this.J=e,this.C=!1,this.c=!0,this.a=new XMLHttpRequest,this.A=this.I?Ye(this.I):Ye($e),this.a.onreadystatechange=V(this.za,this);try{kt(this.b,pr(this,"Opening Xhr")),this.D=!0,this.a.open(e,String(t),!0),this.D=!1}catch(t){return kt(this.b,pr(this,"Error opening Xhr: "+t.message)),void ur(this,t)}t=n||"";var i,o=new gn(this.headers);r&&vn(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=sr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.N()),n=S.FormData&&t instanceof S.FormData,0<=q(or,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.K&&(this.a.responseType=this.K),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{lr(this),0<this.l&&(this.v=(i=this.a,rt&&ft(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout),kt(this.b,pr(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.l,this.a.ontimeout=V(this.xa,this)):this.u=Ee(this.xa,this.l,this)),kt(this.b,pr(this,"Sending request")),this.o=!0,this.a.send(t),this.o=!1}catch(t){kt(this.b,pr(this,"Send error: "+t.message)),ur(this,t)}},A.xa=function(){void 0!==O&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.i=8,kt(this.b,pr(this,this.g)),ae(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.c&&(kt(this.b,pr(this,"Aborting")),this.c=!1,this.h=!0,this.a.abort(),this.h=!1,this.i=t||7,ae(this,"complete"),ae(this,"abort"),hr(this))},A.H=function(){this.a&&(this.c&&(this.c=!1,this.h=!0,this.a.abort(),this.h=!1),hr(this,!0)),nr.Y.H.call(this)},A.za=function(){this.m||(this.D||this.o||this.h?cr(this):this.Ua())},A.Ua=function(){cr(this)},A.V=function(){try{return 2<fr(this)?this.a.status:-1}catch(t){return-1}},A.U=function(){try{return this.a?this.a.responseText:""}catch(t){return kt(this.b,"Can not get responseText: "+t.message),""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),er(e)}},A.ua=function(){return this.i},A.Qa=function(){return"string"==typeof this.g?this.g:String(this.g)},(A=vr.prototype).ha=8,A.B=1,A.Ba=function(t){if(this.h)if(this.h=null,xe(this.a,"startForwardChannel_"),1==this.B)if(t)Ue(this.a,"Not supposed to retry the open");else{xe(this.a,"open_()"),this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new nn(this,this.a,t,void 0),r=this.m;if(this.L&&(r?Z(r=Q(r),this.L):r=this.L),null===this.i&&(n.A=r),this.da)t:{for(var i=e=0;i<this.c.length;i++){var o=this.c[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.c.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Ir(this,n,e),On(i=En(this.A),"RID",t),On(i,"CVER",22),this.v&&On(i,"X-HTTP-Session-Id",this.v),Tr(this,i),this.i&&r&&dr(i,this.i,r),Xn(this.f,n),this.Ia&&On(i,"TYPE","init"),this.da?(On(i,"$req",e),On(i,"SID","null"),n.W=!0,un(n,i,null)):un(n,i,e),this.B=2}else 3==this.B&&(t?Er(this,t):0==this.c.length?xe(this.a,"startForwardChannel_ returned: nothing to send"):Jn(this.f)?Ue(this.a,"startForwardChannel_ returned: connection already in progress"):(Er(this),xe(this.a,"startForwardChannel_ finished, sent request")))},A.Aa=function(){var t;this.j=null,Sr(this),this.W&&!this.I&&(null==this.b||this.D<=0?Rt(this.a.a,"Skip bpDetectionTimerId_ "+this.b+" "+this.D):(t=2*this.D,this.a.info("BP detection timer enabled: "+t),this.s=Je(V(this.Ta,this),t)))},A.Ta=function(){var t;this.s?(this.s=null,this.a.info("BP detection timeout reached."),null==this.b.a||(t=this.b.a.U())&&Rt(this.a.a,"Timer should have been cancelled : "+t),this.a.info("Buffering proxy detected and switch to long-polling!"),this.J=!1,this.I=!0,Ge(10),mr(this),Sr(this)):Rt(this.a.a,"Invalid operation.")},A.Sa=function(){null!=this.l&&(this.l=null,mr(this),Nr(this),Ge(19))},A.Ya=function(t){t?(this.a.info("Successfully pinged google.com"),Ge(2)):(this.a.info("Failed to ping google.com"),Ge(1))},(A=Vr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},Ur.prototype.a=function(t,e){return new Mr(t,e)},F(Mr,ue),Mr.prototype.i=function(){this.a.g=this.h,this.s&&(this.a.F=!0);var t=this.a,e=this.c,n=this.g||void 0;xe(t.a,"connect()"),Ge(0),t.fa=e,t.X=n||{},t.J=t.S,xe(t.a,"connectChannel_()"),e=Pr(t,null,t.fa),xe(t.a,"GetForwardChannelUri: "+e),t.A=e,_r(t)},Mr.prototype.close=function(){gr(this.a)},Mr.prototype.l=function(t){var e;"string"==typeof t?((e={}).__data__=t,br(this.a,e)):this.o?((e={}).__data__=he(t),br(this.a,e)):br(this.a,t)},Mr.prototype.H=function(){this.a.g=null,delete this.h,gr(this.a),delete this.a,Mr.Y.H.call(this)},F(Fr,Ze),F(qr,tn),F(jr,Vr),jr.prototype.ta=function(){Ct(this.a.b,"WebChannel opened on "+this.a.c),ae(this.a,"a")},jr.prototype.sa=function(t){ae(this.a,new Fr(t))},jr.prototype.ra=function(t){Ct(this.a.b,"WebChannel aborted on "+this.a.c+" due to channel error: "+t),ae(this.a,new qr)},jr.prototype.qa=function(){Ct(this.a.b,"WebChannel closed on "+this.a.c),ae(this.a,"b")},Ur.prototype.createWebChannel=Ur.prototype.a,Mr.prototype.send=Mr.prototype.l,Mr.prototype.open=Mr.prototype.i,Ke.NO_ERROR=0,Ke.TIMEOUT=8,Ke.HTTP_ERROR=6,We.COMPLETE="complete",(Qe.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",ue.prototype.listen=ue.prototype.va,nr.prototype.listenOnce=nr.prototype.wa,nr.prototype.getLastError=nr.prototype.Qa,nr.prototype.getLastErrorCode=nr.prototype.ua,nr.prototype.getStatus=nr.prototype.V,nr.prototype.getResponseJson=nr.prototype.Pa,nr.prototype.getResponseText=nr.prototype.U,nr.prototype.send=nr.prototype.ba;var Hr=qe,Br=Ke,Gr=We,zr=Me,Jr=10,Kr=11,Wr=Qe,Xr=nr,N=It("goog.labs.net.webChannel.WebChannelDebug");N&&(N.b=_t);Ke=new Pt;1!=Ke.b&&(We=It(""),N=Ke.g,We&&(We.a||(We.a=[]),We.a.push(N)),Ke.b=!0);var Yr="8.2.2-longpoll.66863f547",Qr=new o("@firebase/firestore");function $r(){return Qr.logLevel}function Zr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Qr.logLevel<=u.DEBUG&&(e=n.map(ni),Qr.debug.apply(Qr,f(["Firestore ("+Yr+"): "+t],e)))}function ti(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Qr.logLevel<=u.ERROR&&(e=n.map(ni),Qr.error.apply(Qr,f(["Firestore ("+Yr+"): "+t],e)))}function ei(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Qr.logLevel<=u.WARN&&(e=n.map(ni),Qr.warn.apply(Qr,f(["Firestore ("+Yr+"): "+t],e)))}function ni(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function ri(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Yr+") INTERNAL ASSERTION FAILED: "+t;throw ti(t),new Error(t)}function ii(t){t||ri()}var oi=(si.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},si);function si(){}function ui(t,e){return t<e?-1:e<t?1:0}function ai(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var ci=(hi.fromBase64String=function(t){return new hi(atob(t))},hi.fromUint8Array=function(t){return new hi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},hi.prototype.toBase64=function(){return t=this.i,btoa(t);var t},hi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},hi.prototype.o=function(){return 2*this.i.length},hi.prototype.u=function(t){return ui(this.i,t.i)},hi.prototype.isEqual=function(t){return this.i===t.i},hi);function hi(t){this.i=t}ci.h=new ci("");var li,fi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},pi=(l(gi,li=Error),gi),di=(vi.fromBase64String=function(t){try{return new vi(ci.fromBase64String(t))}catch(t){throw new pi(fi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},vi.fromUint8Array=function(t){return new vi(ci.fromUint8Array(t))},vi.prototype.toBase64=function(){return this.l.toBase64()},vi.prototype.toUint8Array=function(){return this.l.toUint8Array()},vi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},vi.prototype.isEqual=function(t){return this.l.isEqual(t.l)},vi),yi=function(t){this._=t};function vi(t){this.l=t}function gi(t,e){var n=this;return(n=li.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function mi(){if("undefined"==typeof Uint8Array)throw new pi(fi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wi(){if("undefined"==typeof atob)throw new pi(fi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var bi,_i=(l(Oi,bi=yi),Oi.fromBase64String=function(t){return wi(),new Oi(di.fromBase64String(t))},Oi.fromUint8Array=function(t){return mi(),new Oi(di.fromUint8Array(t))},Oi.prototype.toBase64=function(){return wi(),this._.toBase64()},Oi.prototype.toUint8Array=function(){return mi(),this._.toUint8Array()},Oi.prototype.isEqual=function(t){return this._.isEqual(t._)},Oi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Oi),Ei=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Ti=(Object.defineProperty(Ni.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ni.prototype.isEqual=function(t){return t instanceof Ni&&t.projectId===this.projectId&&t.database===this.database},Ni),Ii=(Ai.prototype.A=function(){return null!=this.uid},Ai.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Ai.prototype.isEqual=function(t){return t.uid===this.uid},Ai);function Ai(t){this.uid=t}function Ni(t,e){this.projectId=t,this.database=e||"(default)"}function Oi(){return null!==bi&&bi.apply(this,arguments)||this}Ii.UNAUTHENTICATED=new Ii(null),Ii.P=new Ii("google-credentials-uid"),Ii.g=new Ii("first-party-uid");function Si(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var Di=(Mi.prototype.getToken=function(){return Promise.resolve(null)},Mi.prototype.v=function(){},Mi.prototype.S=function(t){(this.p=t)(Ii.UNAUTHENTICATED)},Mi.prototype.D=function(){this.p=null},Mi),Li=(Ui.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Zr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(ii("string"==typeof t.accessToken),new Si(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ui.prototype.v=function(){this.forceRefresh=!0},Ui.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},Ui.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},Ui.prototype.O=function(){var t=this.auth&&this.auth.getUid();return ii(null===t||"string"==typeof t),new Ii(t)},Ui),Ri=(Object.defineProperty(Vi.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Vi),Ci=(xi.prototype.getToken=function(){return Promise.resolve(new Ri(this.k,this.M))},xi.prototype.S=function(t){t(Ii.g)},xi.prototype.D=function(){},xi.prototype.v=function(){},xi),ki=(Pi.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Pi.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},Pi);function Pi(t,e){var n=this;this.previousValue=t,e&&(e.$=function(t){return n.L(t)},this.B=function(t){return e.q(t)})}function xi(t,e){this.k=t,this.M=e}function Vi(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Ii.g}function Ui(t){var e=this;this.C=null,this.currentUser=Ii.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function Mi(){this.p=null}ki.U=-1;var Fi,qi,ji=($i.now=function(){return $i.fromMillis(Date.now())},$i.fromDate=function(t){return $i.fromMillis(t.getTime())},$i.fromMillis=function(t){var e=Math.floor(t/1e3);return new $i(e,1e6*(t-1e3*e))},$i.prototype.toDate=function(){return new Date(this.toMillis())},$i.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},$i.prototype.K=function(t){return this.seconds===t.seconds?ui(this.nanoseconds,t.nanoseconds):ui(this.seconds,t.seconds)},$i.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},$i.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},$i.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},$i.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},$i),Hi=(Qi.j=function(t){return new Qi(t)},Qi.min=function(){return new Qi(new ji(0,0))},Qi.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Qi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Qi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Qi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Qi.prototype.G=function(){return this.timestamp},Qi),Ke=(Object.defineProperty(Yi.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Yi.prototype.isEqual=function(t){return 0===Yi.J(this,t)},Yi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Yi?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},Yi.prototype.limit=function(){return this.offset+this.length},Yi.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Yi.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Yi.prototype.tt=function(){return this.segments[this.offset]},Yi.prototype.et=function(){return this.get(this.length-1)},Yi.prototype.get=function(t){return this.segments[this.offset+t]},Yi.prototype.nt=function(){return 0===this.length},Yi.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Yi.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Yi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Yi.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Yi.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Yi),Bi=(l(Xi,qi=Ke),Xi.prototype.Y=function(t,e,n){return new Xi(t,e,n)},Xi.prototype.ot=function(){return this.rt().join("/")},Xi.prototype.toString=function(){return this.ot()},Xi.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new pi(fi.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Xi(n)},Xi.at=function(){return new Xi([])},Xi),Gi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zi=(l(Wi,Fi=Ke),Wi.prototype.Y=function(t,e,n){return new Wi(t,e,n)},Wi.ut=function(t){return Gi.test(t)},Wi.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wi.ut(t)||(t="`"+t+"`"),t}).join(".")},Wi.prototype.toString=function(){return this.ot()},Wi.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},Wi.lt=function(){return new Wi(["__name__"])},Wi._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new pi(fi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new pi(fi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new pi(fi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wi(e)},Wi.at=function(){return new Wi([])},Wi),Ji=(Ki.ft=function(t){return new Ki(Bi.ct(t))},Ki.dt=function(t){return new Ki(Bi.ct(t).X(5))},Ki.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ki.prototype.isEqual=function(t){return null!==t&&0===Bi.J(this.path,t.path)},Ki.prototype.toString=function(){return this.path.toString()},Ki.J=function(t,e){return Bi.J(t.path,e.path)},Ki.Tt=function(t){return t.length%2==0},Ki.Et=function(t){return new Ki(new Bi(t.slice()))},Ki);function Ki(t){this.path=t}function Wi(){return null!==Fi&&Fi.apply(this,arguments)||this}function Xi(){return null!==qi&&qi.apply(this,arguments)||this}function Yi(t,e,n){void 0===e?e=0:e>t.length&&ri(),void 0===n?n=t.length-e:n>t.length-e&&ri(),this.segments=t,this.offset=e,this.H=n}function Qi(t){this.timestamp=t}function $i(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Zi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function to(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function eo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var no=(io.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},io.prototype.isEqual=function(t){return ai(this.fields,t.fields,function(t,e){return t.isEqual(e)})},io),ro=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function io(t){(this.fields=t).sort(zi.J)}function oo(t){if(ii(!!t),"string"!=typeof t)return{seconds:so(t.seconds),nanos:so(t.nanos)};var e=0,n=ro.exec(t);ii(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function so(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function uo(t){return"string"==typeof t?ci.fromBase64String(t):ci.fromUint8Array(t)}function ao(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function co(t){t=oo(t.mapValue.fields.__local_write_time__.timestampValue);return new ji(t.seconds,t.nanos)}function ho(t){return null==t}function lo(t){return 0===t&&1/t==-1/0}function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ao(t)?4:10:ri()}function po(r,i){var t,e=fo(r);if(e!==fo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return co(r).isEqual(co(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=oo(r.timestampValue),t=oo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,uo(r.bytesValue).isEqual(uo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,so((t=r).geoPointValue.latitude)===so(e.geoPointValue.latitude)&&so(t.geoPointValue.longitude)===so(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return so(t.integerValue)===so(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=so(t.doubleValue),e=so(e.doubleValue);return t===e?lo(t)===lo(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return ai(r.arrayValue.values||[],i.arrayValue.values||[],po);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Zi(e)!==Zi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!po(e[t],n[t])))return!1;return!0}();default:return ri()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,r,i=fo(t),o=fo(e);if(i!==o)return ui(i,o);switch(i){case 0:return 0;case 1:return ui(t.booleanValue,e.booleanValue);case 2:return n=e,r=so(t.integerValue||t.doubleValue),n=so(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return ui(t.stringValue,e.stringValue);case 6:return function(t,e){t=uo(t),e=uo(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ui(n[i],r[i]);if(0!==o)return o}return ui(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=ui(so(i.latitude),so(r.latitude)))?n:ui(so(i.longitude),so(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vo(n[i],r[i]);if(o)return o}return ui(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ui(r[s],o[s]);if(0!==u)return u;u=vo(n[r[s]],i[o[s]]);if(0!==u)return u}return ui(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ri()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ui(t,e);var n=oo(t),t=oo(e),e=ui(n.seconds,t.seconds);return 0!==e?e:ui(n.nanos,t.nanos)}function mo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=oo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?uo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Ji.dt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):ri();var e}(t)}function wo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function bo(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function Eo(t){return t&&"nullValue"in t}function To(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Io(t){return t&&"mapValue"in t}var Ao=(So.empty=function(){return new So({mapValue:{}})},So.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Io(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},So.prototype.isEqual=function(t){return po(this.proto,t.proto)},So),No=(Oo.prototype.set=function(t,e){return this.Pt(t,e),this},Oo.prototype.delete=function(t){return this.Pt(t,null),this},Oo.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},Oo.prototype.yt=function(){var t=this.gt(zi.at(),this.Rt);return null!=t?new Ao(t):this.At},Oo.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=Io(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Oo);function Oo(t){void 0===t&&(t=Ao.empty()),this.At=t,this.Rt=new Map}function So(t){this.proto=t}var Do,Lo,Ro,o=function(t,e){this.key=t,this.version=e},Co=(l(Mo,Ro=o),Mo.prototype.field=function(t){return this.Vt.field(t)},Mo.prototype.data=function(){return this.Vt},Mo.prototype.vt=function(){return this.Vt.proto},Mo.prototype.isEqual=function(t){return t instanceof Mo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},Mo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Mo.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Mo),ko=(l(Uo,Lo=o),Uo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Uo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Uo.prototype.isEqual=function(t){return t instanceof Uo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Uo),Po=(l(Vo,Do=o),Vo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Vo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Vo.prototype.isEqual=function(t){return t instanceof Vo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Vo),xo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Vo(){return null!==Do&&Do.apply(this,arguments)||this}function Uo(t,e,n){var r=this;return(r=Lo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Mo(t,e,n,r){var i=this;return(i=Ro.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Fo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new xo(t,e,n,r,i,o,s)}function qo(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.ot()+t.op.toString()+mo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.ot()+t.dir}).join(","),ho(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ys(e.startAt)),e.endAt&&(t+="|ub:",t+=ys(e.endAt)),e.St=t),e.St}function jo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ms(t.startAt,e.startAt)&&ms(t.endAt,e.endAt)}function Ho(t){return Ji.Tt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Bo,Go=(l(zo,Bo=function(){}),zo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new Xo(t,e,n):"array-contains"===e?new ss(t,n):"in"===e?new us(t,n):"not-in"===e?new as(t,n):"array-contains-any"===e?new cs(t,n):new zo(t,e,n)},zo.Dt=function(t,e,n){return new("in"===e?Yo:Qo)(t,n)},zo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Ct(vo(t,this.value)):null!==t&&fo(this.value)===fo(t)&&this.Ct(vo(t,this.value))},zo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return ri()}},zo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},zo);function zo(t,e,n){var r=this;return(r=Bo.call(this)||this).field=t,r.op=e,r.value=n,r}var Jo,Ko,Wo,Xo=(l(ts,Wo=Go),ts.prototype.matches=function(t){t=Ji.J(t.key,this.key);return this.Ct(t)},ts),Yo=(l(Zo,Ko=Go),Zo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Zo),Qo=(l($o,Jo=Go),$o.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},$o);function $o(t,e){var n=this;return(n=Jo.call(this,t,"not-in",e)||this).keys=es(0,e),n}function Zo(t,e){var n=this;return(n=Ko.call(this,t,"in",e)||this).keys=es(0,e),n}function ts(t,e,n){var r=this;return(r=Wo.call(this,t,e,n)||this).key=Ji.dt(n.referenceValue),r}function es(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ji.dt(t.referenceValue)})}var ns,rs,is,os,ss=(l(ds,os=Go),ds.prototype.matches=function(t){t=t.field(this.field);return _o(t)&&yo(t.arrayValue,this.value)},ds),us=(l(ps,is=Go),ps.prototype.matches=function(t){t=t.field(this.field);return null!==t&&yo(this.value.arrayValue,t)},ps),as=(l(fs,rs=Go),fs.prototype.matches=function(t){if(yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!yo(this.value.arrayValue,t)},fs),cs=(l(ls,ns=Go),ls.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!_o(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},ls),hs=function(t,e){this.position=t,this.before=e};function ls(t,e){return ns.call(this,t,"array-contains-any",e)||this}function fs(t,e){return rs.call(this,t,"not-in",e)||this}function ps(t,e){return is.call(this,t,"in",e)||this}function ds(t,e){return os.call(this,t,"array-contains",e)||this}function ys(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}var vs=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function gs(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?Ji.J(Ji.dt(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ms(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var ws=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function bs(t){return new ws(t)}function _s(t){return!ho(t.limit)&&"F"===t.limitType}function Es(t){return!ho(t.limit)&&"L"===t.limitType}function Ts(t){return 0<t.Nt.length?t.Nt[0].field:null}function Is(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function As(t){return null!==t.collectionGroup}function Ns(t){var e=t;if(null===e.Ft){e.Ft=[];var n=Is(e),t=Ts(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new vs(n)),e.Ft.push(new vs(zi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new vs(zi.lt(),n)))}}return e.Ft}function Os(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=Fo(e.path,e.collectionGroup,Ns(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ns(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new vs(o.field,s))}var u=e.endAt?new hs(e.endAt.position,!e.endAt.before):null,t=e.startAt?new hs(e.startAt.position,!e.startAt.before):null;e.Ot=Fo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function Ss(t,e,n){return new ws(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ds(t,e){return jo(Os(t),Os(e))&&t.limitType===e.limitType}function Ls(t){return qo(Os(t))+"|lt:"+t.limitType}function Rs(t){return"Query(target="+(e=Os(t),n=e.path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.ot()+" "+t.op+" "+mo(t.value)}).join(", ")+"]"),ho(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ys(e.startAt)),e.endAt&&(n+=", endAt: "+ys(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Cs(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):Ji.Tt(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||gs(t.startAt,Ns(t),n))&&(!t.endAt||!gs(t.endAt,Ns(t),n)));var e,n}function ks(u){return function(t,e){for(var n=!1,r=0,i=Ns(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.ht()?Ji.J(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?vo(n,t):ri()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return ri()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var Ps=(xs.prototype.$t=function(t){return new xs(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},xs.prototype.Lt=function(t,e){return new xs(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},xs.prototype.Bt=function(t){return new xs(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},xs);function xs(t,e,n,r,i,o,s){void 0===i&&(i=Hi.min()),void 0===o&&(o=Hi.min()),void 0===s&&(s=ci.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vs(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lo(e)?"-0":e}}function Us(t){return{integerValue:""+t}}function Ms(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!lo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Us(e):Vs(t,e);var n}Ke=function(){this.Ut=void 0};function Fs(t,e){return t instanceof $s?bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var qs,js,Hs=(l(zs,js=Ke),zs),Bs=(l(Gs,qs=Ke),Gs);function Gs(t){var e=this;return(e=qs.call(this)||this).elements=t,e}function zs(){return null!==js&&js.apply(this,arguments)||this}function Js(t,e){for(var n=eu(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ks,Ws=(l(Xs,Ks=Ke),Xs);function Xs(t){var e=this;return(e=Ks.call(this)||this).elements=t,e}function Ys(t,e){for(var n=eu(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Qs,$s=(l(Zs,Qs=Ke),Zs);function Zs(t,e){var n=this;return(n=Qs.call(this)||this).Kt=t,n.Qt=e,n}function tu(t){return so(t.integerValue||t.doubleValue)}function eu(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function nu(t,e){this.field=t,this.transform=e}function ru(t,e){this.version=t,this.transformResults=e}var iu=(ou.jt=function(){return new ou},ou.exists=function(t){return new ou(void 0,t)},ou.updateTime=function(t){return new ou(t)},Object.defineProperty(ou.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ou.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ou);function ou(t,e){this.updateTime=t,this.exists=e}function su(t,e){return void 0!==t.updateTime?e instanceof Co&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Co}o=function(){};function uu(t,e,n,r){return t instanceof fu?function(t,e,n){if(!su(t.Gt,e))return e;var r=t.value,n=mu(t.fieldTransforms,n,e),r=wu(t.fieldTransforms,r,n),e=cu(e);return new Co(t.key,e,r,{bt:!0})}(t,e,r):t instanceof pu?function(t,e,n){if(!su(t.Gt,e))return e;var r=cu(e),e=vu(t,e,mu(t.fieldTransforms,n,e));return new Co(t.key,r,e,{bt:!0})}(t,e,r):(e=e,su((t=t).Gt,e)?new ko(t.key,Hi.min()):e)}function au(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&ai(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Bs&&e instanceof Bs||t instanceof Ws&&e instanceof Ws?ai(t.elements,e.elements,po):t instanceof $s&&e instanceof $s?po(t.Qt,e.Qt):t instanceof Hs&&e instanceof Hs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function cu(t){return t instanceof Co?t.version:Hi.min()}var hu,lu,fu=(l(yu,lu=o),yu),pu=(l(du,hu=o),du);function du(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=hu.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function yu(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=lu.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function vu(t,e,n){var r,i,o;return i=t,e=r=e instanceof Co?e.data():Ao.empty(),o=new No(e),i.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.yt(),wu(t.fieldTransforms,r,n)}function gu(t,e,n){var r=[];ii(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Co&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Bs?Js(o,s):o instanceof Ws?Ys(o,s):u))}return r}function mu(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Co&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof Hs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof Bs?Js(a,r):a instanceof Ws?Ys(a,r):(a=Fs(c=a,r),r=tu(a)+tu(c.Qt),bo(a)&&bo(c.Qt)?Us(r):Vs(c.Kt,r))))}return i}function wu(t,e,n){for(var r=new No(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function bu(t){this.count=t}var _u,Eu,Tu,Iu=(l(Ou,Tu=o),Ou),Au=(l(Nu,Eu=o),Nu);function Nu(t,e){var n=this;return(n=Eu.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function Ou(t,e){var n=this;return(n=Tu.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function Su(t){switch(t){case fi.OK:return ri(),0;case fi.CANCELLED:case fi.UNKNOWN:case fi.DEADLINE_EXCEEDED:case fi.RESOURCE_EXHAUSTED:case fi.INTERNAL:case fi.UNAVAILABLE:case fi.UNAUTHENTICATED:return;case fi.INVALID_ARGUMENT:case fi.NOT_FOUND:case fi.ALREADY_EXISTS:case fi.PERMISSION_DENIED:case fi.FAILED_PRECONDITION:case fi.ABORTED:case fi.OUT_OF_RANGE:case fi.UNIMPLEMENTED:case fi.DATA_LOSS:return 1;default:return ri(),0}}function Du(t){if(void 0===t)return ti("GRPC error has no .code"),fi.UNKNOWN;switch(t){case _u.OK:return fi.OK;case _u.CANCELLED:return fi.CANCELLED;case _u.UNKNOWN:return fi.UNKNOWN;case _u.DEADLINE_EXCEEDED:return fi.DEADLINE_EXCEEDED;case _u.RESOURCE_EXHAUSTED:return fi.RESOURCE_EXHAUSTED;case _u.INTERNAL:return fi.INTERNAL;case _u.UNAVAILABLE:return fi.UNAVAILABLE;case _u.UNAUTHENTICATED:return fi.UNAUTHENTICATED;case _u.INVALID_ARGUMENT:return fi.INVALID_ARGUMENT;case _u.NOT_FOUND:return fi.NOT_FOUND;case _u.ALREADY_EXISTS:return fi.ALREADY_EXISTS;case _u.PERMISSION_DENIED:return fi.PERMISSION_DENIED;case _u.FAILED_PRECONDITION:return fi.FAILED_PRECONDITION;case _u.ABORTED:return fi.ABORTED;case _u.OUT_OF_RANGE:return fi.OUT_OF_RANGE;case _u.UNIMPLEMENTED:return fi.UNIMPLEMENTED;case _u.DATA_LOSS:return fi.DATA_LOSS;default:return ri()}}(Ke=_u=_u||{})[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";var Lu=(xu.prototype.Ht=function(t,e){return new xu(this.J,this.root.Ht(t,e,this.J).copy(null,null,Cu.Jt,null,null))},xu.prototype.remove=function(t){return new xu(this.J,this.root.remove(t,this.J).copy(null,null,Cu.Jt,null,null))},xu.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},xu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},xu.prototype.nt=function(){return this.root.nt()},Object.defineProperty(xu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),xu.prototype.Yt=function(){return this.root.Yt()},xu.prototype.Xt=function(){return this.root.Xt()},xu.prototype.Zt=function(t){return this.root.Zt(t)},xu.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},xu.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},xu.prototype.te=function(t){return this.root.te(t)},xu.prototype.ee=function(){return new Ru(this.root,null,this.J,!1)},xu.prototype.ne=function(t){return new Ru(this.root,t,this.J,!1)},xu.prototype.se=function(){return new Ru(this.root,null,this.J,!0)},xu.prototype.ie=function(t){return new Ru(this.root,t,this.J,!0)},xu),Ru=(Pu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},Pu.prototype.ae=function(){return 0<this.oe.length},Pu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},Pu),Cu=(ku.prototype.copy=function(t,e,n,r,i){return new ku(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},ku.prototype.nt=function(){return!1},ku.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},ku.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},ku.prototype.min=function(){return this.left.nt()?this:this.left.min()},ku.prototype.Yt=function(){return this.min().key},ku.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},ku.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},ku.prototype.le=function(){if(this.left.nt())return ku.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},ku.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return ku.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},ku.prototype._e=function(){return this.color},ku.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Te()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Ee()),t},ku.prototype.fe=function(){var t=this.Ee();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Te()).Ee()),t},ku.prototype.we=function(){var t=this.Ee();return t.left.left._e()&&(t=(t=t.de()).Ee()),t},ku.prototype.Te=function(){var t=this.copy(null,null,ku.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},ku.prototype.de=function(){var t=this.copy(null,null,ku.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},ku.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},ku.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},ku.prototype.me=function(){if(this._e()&&this.left._e())throw ri();if(this.right._e())throw ri();var t=this.left.me();if(t!==this.right.me())throw ri();return t+(this._e()?0:1)},ku);function ku(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ku.RED,this.left=null!=r?r:ku.EMPTY,this.right=null!=i?i:ku.EMPTY,this.size=this.left.size+1+this.right.size}function Pu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function xu(t,e){this.J=t,this.root=e||Cu.EMPTY}function Vu(){this.size=0}Cu.EMPTY=null,Cu.RED=!0,Cu.Jt=!1,Cu.EMPTY=(Object.defineProperty(Vu.prototype,"key",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"value",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"color",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"left",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"right",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Vu.prototype.copy=function(t,e,n,r,i){return this},Vu.prototype.Ht=function(t,e,n){return new Cu(t,e)},Vu.prototype.remove=function(t,e){return this},Vu.prototype.nt=function(){return!0},Vu.prototype.Zt=function(t){return!1},Vu.prototype.te=function(t){return!1},Vu.prototype.Yt=function(){return null},Vu.prototype.Xt=function(){return null},Vu.prototype._e=function(){return!1},Vu.prototype.Ie=function(){return!0},Vu.prototype.me=function(){return 0},new Vu);var Uu=(ju.prototype.has=function(t){return null!==this.data.get(t)},ju.prototype.first=function(){return this.data.Yt()},ju.prototype.last=function(){return this.data.Xt()},Object.defineProperty(ju.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ju.prototype.indexOf=function(t){return this.data.indexOf(t)},ju.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},ju.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},ju.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},ju.prototype.Pe=function(t){t=this.data.ne(t);return t.ae()?t.ce().key:null},ju.prototype.ee=function(){return new Mu(this.data.ee())},ju.prototype.ne=function(t){return new Mu(this.data.ne(t))},ju.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},ju.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ju.prototype.nt=function(){return this.data.nt()},ju.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ju.prototype.isEqual=function(t){if(!(t instanceof ju))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},ju.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ju.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ju.prototype.copy=function(t){var e=new ju(this.J);return e.data=t,e},ju),Mu=(qu.prototype.ce=function(){return this.ge.ce().key},qu.prototype.ae=function(){return this.ge.ae()},qu),Fu=new Lu(Ji.J);function qu(t){this.ge=t}function ju(t){this.J=t,this.data=new Lu(this.J)}var Hu=new Lu(Ji.J);var Bu=new Lu(Ji.J);var Gu=new Uu(Ji.J);function zu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ju=new Uu(ui);var Ku=(ca.be=function(t){return new ca(t.J)},ca.prototype.has=function(t){return null!=this.Ve.get(t)},ca.prototype.get=function(t){return this.Ve.get(t)},ca.prototype.first=function(){return this.pe.Yt()},ca.prototype.last=function(){return this.pe.Xt()},ca.prototype.nt=function(){return this.pe.nt()},ca.prototype.indexOf=function(t){t=this.Ve.get(t);return t?this.pe.indexOf(t):-1},Object.defineProperty(ca.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),ca.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},ca.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},ca.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},ca.prototype.isEqual=function(t){if(!(t instanceof ca))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},ca.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ca.prototype.copy=function(t,e){var n=new ca;return n.J=this.J,n.Ve=t,n.pe=e,n},ca),Wu=(aa.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):ri()},aa.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},aa),Xu=(ua.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ua(t,e,Ku.be(e),i,n,r,!0,!1)},Object.defineProperty(ua.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),ua.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Ds(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ua),Yu=(sa.Le=function(t,e){var n=new Map;return n.set(t,Qu.Be(t,e)),new sa(Hi.min(),n,Ju,Fu,zu())},sa),Qu=(oa.Be=function(t,e){return new oa(ci.h,e,zu(),zu(),zu())},oa),$u=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},Zu=function(t,e){this.targetId=t,this.Ge=e},ta=function(t,e,n,r){void 0===n&&(n=ci.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ea=(Object.defineProperty(ia.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(ia.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(ia.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(ia.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),ia.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},ia.prototype.nn=function(){var n=zu(),r=zu(),i=zu();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:ri()}}),new Qu(this.Je,this.Ye,n,r,i)},ia.prototype.sn=function(){this.Xe=!1,this.He=la()},ia.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},ia.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},ia.prototype.cn=function(){this.ze+=1},ia.prototype.an=function(){--this.ze},ia.prototype.un=function(){this.Xe=!0,this.Ye=!0},ia),na=(ra.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Co?this.Tn(r,t.We):t.We instanceof ko&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},ra.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:ri()}})},ra.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},ra.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,t=this.gn(e);t&&(Ho(t=t.target)?0===n?(t=new Ji(t.path),this.En(e,t,new ko(t,Hi.min()))):ii(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},ra.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&Ho(n.target)&&(n=new Ji(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.En(e,n,new ko(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=zu();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){t=i.gn(t);return!t||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new Yu(r,o,this.dn,this._n,s);return this._n=Fu,this.fn=ha(),this.dn=new Uu(ui),t},ra.prototype.Tn=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},ra.prototype.En=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},ra.prototype.removeTarget=function(t){this.ln.delete(t)},ra.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},ra.prototype.cn=function(t){this.An(t).cn()},ra.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new ea,this.ln.set(t,e)),e},ra.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Uu(ui),this.fn=this.fn.Ht(t,e)),e},ra.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Zr("WatchChangeAggregator","Detected inactive target",t),e},ra.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},ra.prototype.Pn=function(e){var n=this;this.ln.set(e,new ea),this.hn.Sn(e).forEach(function(t){n.En(e,t,null)})},ra.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},ra);function ra(t){this.hn=t,this.ln=new Map,this._n=Fu,this.fn=ha(),this.dn=new Uu(ui)}function ia(){this.ze=0,this.He=la(),this.Je=ci.h,this.Ye=!1,this.Xe=!0}function oa(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function sa(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.$e=i}function ua(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function aa(){this.ve=new Lu(Ji.J)}function ca(n){this.J=n?function(t,e){return n(t,e)||Ji.J(t.key,e.key)}:function(t,e){return Ji.J(t.key,e.key)},this.Ve=Hu,this.pe=new Lu(this.J)}function ha(){return new Lu(Ji.J)}function la(){return new Lu(Ji.J)}var fa={asc:"ASCENDING",desc:"DESCENDING"},pa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},da=function(t,e){this.T=t,this.qt=e};function ya(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function va(t,e){return t.qt?e.toBase64():e.toUint8Array()}function ga(t){return ii(!!t),Hi.j((t=oo(t),new ji(t.seconds,t.nanos)))}function ma(t,e){return new Bi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function wa(t){t=Bi.ct(t);return ii(Pa(t)),t}function ba(t,e){return ma(t.T,e.path)}function _a(t,e){e=wa(e);if(e.get(1)!==t.T.projectId)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new Ji(Ia(e))}function Ea(t,e){return ma(t.T,e)}function Ta(t){return new Bi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Ia(t){return ii(4<t.length&&"documents"===t.get(4)),t.X(5)}function Aa(t,e,n){return{name:ba(t,e),fields:n.proto.mapValue.fields}}function Na(t,e){var n,r,i;if(e instanceof fu)n={update:Aa(t,e.key,e.value)};else if(e instanceof Iu)n={delete:ba(t,e.key)};else if(e instanceof pu)n={update:Aa(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof Au))return ri();n={verify:ba(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Hs)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof Bs)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof Ws)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof $s)return{fieldPath:t.field.ot(),increment:e.Qt};throw ri()})),e.Gt.Wt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:(e=t,t=i.updateTime,ya(e,t.G()))}:void 0!==i.exists?{exists:i.exists}:ri()),n}function Oa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ea(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ea(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(To(t.value))return{unaryFilter:{field:Ra(t.field),op:"IS_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Ra(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(To(t.value))return{unaryFilter:{field:Ra(t.field),op:"IS_NOT_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Ra(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ra(t.field),op:(e=t.op,pa[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ra((t=t).field),direction:(t=t.dir,fa[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.qt||ho(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Da(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Da(e.endAt)),n}function Sa(t){var e=4===(o=wa(t.parent)).length?Bi.at():Ia(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(ii(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ka(t)]:void 0!==t.fieldFilter?[(n=t,Go.create(Ca(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ri()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):ri():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new vs(Ca((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=ho(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=La(n.startAt));var u=null;return n.endAt&&(u=La(n.endAt)),new ws(e,i,t,o,r,"F",s,u)}function Da(t){return{before:t.before,values:t.position}}function La(t){var e=!!t.before,t=t.values||[];return new hs(t,e)}function Ra(t){return{fieldPath:t.ot()}}function Ca(t){return zi._t(t.fieldPath)}function ka(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ca(t.unaryFilter.field);return Go.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ca(t.unaryFilter.field);return Go.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Ca(t.unaryFilter.field);return Go.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=Ca(t.unaryFilter.field);return Go.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ri()}}function Pa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var xa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Va=(Ua.prototype.catch=function(t){return this.next(void 0,t)},Ua.prototype.next=function(r,i){var o=this;return this.Fn&&ri(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new Ua(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},Ua.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ua.prototype.$n=function(t){try{var e=t();return e instanceof Ua?e:Ua.resolve(e)}catch(t){return Ua.reject(t)}},Ua.prototype.kn=function(t,e){return t?this.$n(function(){return t(e)}):Ua.resolve(e)},Ua.prototype.On=function(t,e){return t?this.$n(function(){return t(e)}):Ua.reject(e)},Ua.resolve=function(n){return new Ua(function(t,e){t(n)})},Ua.reject=function(n){return new Ua(function(t,e){e(n)})},Ua.Ln=function(t){return new Ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ua.Bn=function(t){for(var n=Ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ua.resolve(t):e()})}(r[e]);return n},Ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},Ua);function Ua(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function Ma(t){return"IndexedDbTransactionError"===t.name}var Fa=(qa.Is=function(t,e,n,r,i){i=new qa(t,e,Date.now()+n,r,i);return i.start(n),i},qa.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},qa.prototype.Ps=function(){return this.Rs()},qa.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Es.reject(new pi(fi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},qa.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},qa.prototype.clearTimeout=function(){null!==this.As&&(this.Ts(this),clearTimeout(this.As),this.As=null)},qa);function qa(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Ts=i,this.Es=new xa,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function ja(t,e){if(ti("AsyncQueue",e+": "+t),Ma(t))return new pi(fi.UNAVAILABLE,e+": "+t);throw t}function Ha(t){this.ks=t}var o=(Ka.prototype.Vs=function(t){this.gs.push(t)},Ka.prototype.ps=function(){this.gs.forEach(function(t){return t()})},Ka),Ba=(Ja.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var l=this.mutations[h];l.key.isEqual(t)&&(r=l,i=e,o=c[h],l=a=u=s=void 0,e=r instanceof fu?(u=o,l=(s=r).value,u.transformResults&&(a=gu(s.fieldTransforms,i,u.transformResults),l=wu(s.fieldTransforms,l,a)),new Co(s.key,u.version,l,{hasCommittedMutations:!0})):r instanceof pu?function(t,e,n){if(!su(t.Gt,e))return new Po(t.key,n.version);e=vu(t,e,n.transformResults?gu(t.fieldTransforms,e,n.transformResults):[]);return new Co(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new ko(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ja.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=uu(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++){(i=s[o]).key.isEqual(t)&&(e=uu(i,e,0,this.Ss))}return e},Ja.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},Ja.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zu())},Ja.prototype.isEqual=function(t){return this.batchId===t.batchId&&ai(this.mutations,t.mutations,au)&&ai(this.baseMutations,t.baseMutations,au)},Ja),Ga=(za.from=function(t,e,n){ii(t.mutations.length===n.length);for(var r=Bu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new za(t,e,n,r)},za);function za(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}function Ja(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function Ka(){this.gs=[]}function Wa(t){var e=Sa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ss(e,e.limit,"L"):e}var Xa=($a.prototype.Us=function(t,e){return this.qs.add(e),Va.resolve()},$a.prototype.Qs=function(t,e){return Va.resolve(this.qs.getEntries(e))},$a),Ya=(Qa.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Uu(Bi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Qa.prototype.has=function(t){var e=t.et(),t=t.Z(),e=this.index[e];return e&&e.has(t)},Qa.prototype.getEntries=function(t){return(this.index[t]||new Uu(Bi.J)).rt()},Qa);function Qa(){this.index={}}function $a(){this.qs=new Ya}function Za(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==fi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Zr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function tc(t,e){this.progress=t,this.zo=e}var ec=(pc.prototype.get=function(t){var e=this.si(t),e=this.ri[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.ii(o,t))return i}},pc.prototype.has=function(t){return void 0!==this.get(t)},pc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},pc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},pc.prototype.forEach=function(s){to(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},pc.prototype.nt=function(){return eo(this.ri)},pc),Ke=(fc.prototype.ai=function(t){t=this.oi.get(t);return t?t.readTime:Hi.min()},fc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},fc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},fc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?Va.resolve(n.li):this.di(t,e)},fc.prototype.getEntries=function(t,e){return this.wi(t,e)},fc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ti(t)},fc.prototype.hi=function(){},fc),nc=(lc.prototype.next=function(){return this.$i+=2,this.$i},lc.Li=function(){return new lc(0)},lc.Bi=function(){return new lc(-1)},lc),rc=(hc.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},hc.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},hc.prototype.Xo=function(t,e,i){var o=Fu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},hc.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},hc.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=Fu;return t.forEach(function(t,e){e=e||new ko(t,Hi.min()),n=n.Ht(t,e)}),n})},hc.prototype.jr=function(t,e,n){return r=e,Ji.Tt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):As(e)?this.nc(t,e,n):this.sc(t,e,n);var r},hc.prototype.ec=function(t,e){return this.Jo(t,new Ji(e)).next(function(t){var e=Hu;return t instanceof Co&&(e=e.Ht(t.key,t)),e})},hc.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=Hu;return this.Ei.Qs(n,s).next(function(t){return Va.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new ws(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},hc.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.jr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=uu(s,a.get(u),0,r.Ss);a=s instanceof Co?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Cs(n,e)||(a=a.remove(t))}),a})},hc.prototype.ic=function(t,e,n){for(var r=zu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof pu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Co&&(c=c.Ht(t,e))}),c})},hc),ic=(cc.cc=function(t,e){for(var n=zu(),r=zu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new cc(t,e.fromCache,n,r)},cc),oc=(ac.prototype.ac=function(t){this.uc=t},ac.prototype.jr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(Hi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(_s(r)||Es(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):($r()<=u.DEBUG&&Zr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rs(r)),s.uc.jr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},ac.prototype.lc=function(n,t){var r=new Uu(ks(n));return t.forEach(function(t,e){e instanceof Co&&Cs(n,e)&&(r=r.add(e))}),r},ac.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},ac.prototype.hc=function(t,e){return $r()<=u.DEBUG&&Zr("QueryEngine","Using full collection scan to execute query:",Rs(e)),this.uc.jr(t,e,Hi.min())},ac),sc=(uc.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},uc);function uc(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Lu(ui),this.wc=new ec(qo,jo),this.Tc=Hi.min(),this.Ho=t.Ko(n),this.Ec=t.Or(),this.fo=t.Dr(),this.Ic=new rc(this.Ec,this.Ho,this.persistence.jo()),this.To=t.Wo(),this.fc.ac(this.Ic)}function ac(){}function cc(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function hc(t,e,n){this.wo=t,this.Ho=e,this.Ei=n}function lc(t){this.$i=t}function fc(){this.oi=new ec(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function pc(t,e){this.si=t,this.ii=e,this.ri={}}function dc(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new rc(e.Ec,n,e.persistence.jo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=zu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function yc(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=l.Ec.Fr({Wr:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),u=Va.resolve(),n.forEach(function(n){u=u.next(function(){return o.fi(r,n)}).next(function(t){var e=t,t=i.Os.get(n);ii(null!==t),(!e||e.version.u(t)<0)&&(e=s.Ds(n,e,i))&&o.ui(e,i.Fs)})}),u.next(function(){return e.Ho.xi(r,s)}).next(function(){return c.apply(t)}).next(function(){return l.Ho.Oi(t)}).next(function(){return l.Ic.Zo(t,a)})})}function vc(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function gc(t,r){var a=t,c=r.Mt,h=a.dc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Fr({Wr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.Lt(i,c).$t(s.vs),h=h.Ht(e,n),r=o,i=t,ii(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.W()-r.Mt.W()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=Fu;return r.Me.forEach(function(t,e){r.$e.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(mc(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(Hi.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.Wi(s,s.vs,c)}),u.push(e)),Va.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t})}function mc(t,s,e,u,a){var n=zu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Fu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof ko&&e.version.isEqual(Hi.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):Zr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function wc(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,Va.resolve(n)):i.fo.qi(e).next(function(t){return n=new Ps(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function bc(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ma(r=t.sent()))throw r;return Zr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function _c(t,o,s){var u=t,a=Hi.min(),c=zu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Os(o),(void 0!==(t=(i=t).wc.get(r))?Va.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.jr(e,o,s?a:Hi.min(),s?c:zu())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}var Ec,Tc,Ic,Ac=(ih.prototype.Ms=function(t,e){return Va.resolve(this.bc.get(e))},ih.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:ga(e.createTime)}),Va.resolve()},ih.prototype.Ls=function(t,e){return Va.resolve(this.vc.get(e))},ih.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:(e=e).name,query:Wa(e.bundledQuery),readTime:ga(e.readTime)}),Va.resolve()},ih),Nc=(rh.prototype.nt=function(){return this.Sc.nt()},rh.prototype.sr=function(t,e){e=new Oc(t,e);this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},rh.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},rh.prototype.rr=function(t,e){this.Fc(new Oc(t,e))},rh.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},rh.prototype.kc=function(t){var e=this,n=new Ji(new Bi([])),r=new Oc(n,t),t=new Oc(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},rh.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},rh.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},rh.prototype.$c=function(t){var e=new Ji(new Bi([])),n=new Oc(e,t),t=new Oc(e,t+1),r=zu();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},rh.prototype.ki=function(t){var e=new Oc(t,0),e=this.Sc.Pe(e);return null!==e&&t.isEqual(e.key)},rh),Oc=(nh.Dc=function(t,e){return Ji.J(t.key,e.key)||ui(t.Lc,e.Lc)},nh.xc=function(t,e){return ui(t.Lc,e.Lc)||Ji.J(t.key,e.key)},nh),Sc=(eh.prototype.Ri=function(t){return Va.resolve(0===this.Ho.length)},eh.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1];n=new Ba(i,e,n,r);this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new Oc(u.key,i)),this.Ei.Us(t,u.key.path.Z())}return Va.resolve(n)},eh.prototype.yi=function(t,e){return Va.resolve(this.Uc(e))},eh.prototype.Vi=function(t,e){e+=1,e=this.Qc(e),e=e<0?0:e;return Va.resolve(this.Ho.length>e?this.Ho[e]:null)},eh.prototype.pi=function(){return Va.resolve(0===this.Ho.length?-1:this.Bc-1)},eh.prototype.bi=function(t){return Va.resolve(this.Ho.slice())},eh.prototype.vi=function(t,e){var n=this,r=new Oc(e,0),e=new Oc(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.Lc);i.push(t)}),Va.resolve(i)},eh.prototype.Si=function(t,e){var n=this,r=new Uu(ui);return e.forEach(function(t){var e=new Oc(t,0),t=new Oc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.Lc)})}),Va.resolve(this.Kc(r))},eh.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;Ji.Tt(e)||(e=e.child(""));var e=new Oc(new Ji(e),0),i=new Uu(ui);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),Va.resolve(this.Kc(i))},eh.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Uc(t);null!==t&&n.push(t)}),n},eh.prototype.xi=function(n,r){var i=this;ii(0===this.jc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return Va.forEach(r.mutations,function(t){var e=new Oc(t.key,r.batchId);return o=o.delete(e),i.Ii.Fi(n,t.key)}).next(function(){i.qc=o})},eh.prototype.Ni=function(t){},eh.prototype.ki=function(t,e){var n=new Oc(e,0),n=this.qc.Pe(n);return Va.resolve(e.isEqual(n&&n.key))},eh.prototype.Oi=function(t){return this.Ho.length,Va.resolve()},eh.prototype.jc=function(t,e){return this.Qc(t)},eh.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},eh.prototype.Uc=function(t){t=this.Qc(t);return t<0||t>=this.Ho.length?null:this.Ho[t]},eh),Dc=(th.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:i,readTime:n}),this.size+=i-o,this.Ei.Us(t,r.path.Z())},th.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},th.prototype.fi=function(t,e){e=this.docs.get(e);return Va.resolve(e?e.li:null)},th.prototype.getEntries=function(t,e){var n=this,r=Fu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),Va.resolve(r)},th.prototype.jr=function(t,e,n){for(var r=Hu,i=new Ji(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.key,a=s.value,s=a.li,a=a.readTime;if(!e.path.st(u.path))break;a.u(n)<=0||s instanceof Co&&Cs(e,s)&&(r=r.Ht(s.key,s))}return Va.resolve(r)},th.prototype.Gc=function(t,e){return Va.forEach(this.docs,function(t){return e(t)})},th.prototype.Fr=function(t){return new Lc(this)},th.prototype.Mr=function(t){return Va.resolve(this.size)},th),Lc=(l(Zc,Ic=Ke),Zc.prototype.Ti=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),Va.Ln(i)},Zc.prototype.di=function(t,e){return this.Gr.fi(t,e)},Zc.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},Zc),Rc=($c.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),Va.resolve()},$c.prototype.Ki=function(t){return Va.resolve(this.lastRemoteSnapshotVersion)},$c.prototype.ji=function(t){return Va.resolve(this.Hc)},$c.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),Va.resolve(this.highestTargetId)},$c.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),Va.resolve()},$c.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new nc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},$c.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,Va.resolve()},$c.prototype.Ji=function(t,e){return this.zi(e),Va.resolve()},$c.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,Va.resolve()},$c.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),Va.Ln(u).next(function(){return s})},$c.prototype.tr=function(t){return Va.resolve(this.targetCount)},$c.prototype.er=function(t,e){e=this.zc.get(e)||null;return Va.resolve(e)},$c.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),Va.resolve()},$c.prototype.ir=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Fi(e,t))}),Va.Ln(i)},$c.prototype.Xi=function(t,e){return this.Jc.kc(e),Va.resolve()},$c.prototype.cr=function(t,e){e=this.Jc.$c(e);return Va.resolve(e)},$c.prototype.ki=function(t,e){return Va.resolve(this.Jc.ki(e))},$c),Cc=(Qc.prototype.start=function(){return Promise.resolve()},Qc.prototype.$o=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(Qc.prototype,"Er",{get:function(){return this.ro},enumerable:!1,configurable:!0}),Qc.prototype.yo=function(){},Qc.prototype.Vo=function(){},Qc.prototype.jo=function(){return this.Ei},Qc.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new Sc(this.Ei,this.Ii),this.Xc[t.R()]=e),e},Qc.prototype.Dr=function(){return this.fo},Qc.prototype.Or=function(){return this.wo},Qc.prototype.Wo=function(){return this.To},Qc.prototype.runTransaction=function(t,e,n){var r=this;Zr("MemoryPersistence","Starting transaction:",t);var i=new kc(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},Qc.prototype.na=function(e,n){return Va.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},Qc),kc=(l(Yc,Tc=o),Yc),Pc=(Xc.ra=function(t){return new Xc(t)},Object.defineProperty(Xc.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw ri()},enumerable:!1,configurable:!0}),Xc.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),Va.resolve()},Xc.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),Va.resolve()},Xc.prototype.Fi=function(t,e){return this.oa.add(e.toString()),Va.resolve()},Xc.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},Xc.prototype.ta=function(){this.ia=new Set},Xc.prototype.ea=function(n){var r=this,i=this.persistence.Or().Fr();return Va.forEach(this.oa,function(t){var e=Ji.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},Xc.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},Xc.prototype.Zc=function(t){return 0},Xc.prototype.ca=function(t,e){var n=this;return Va.Bn([function(){return Va.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},Xc),xc=(Wc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Wc.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Wc.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Wc),Vc=(Kc.prototype.xa=function(t){},Kc.prototype.Fa=function(t,e,n){},Kc.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},Kc.prototype.qa=function(t,e,n){this.ou[t]=e},Kc.prototype.$a=function(t){this.ru.la(t)},Kc.prototype.La=function(t){return this.ru.activeTargetIds.has(t)},Kc.prototype.Ba=function(t){delete this.ou[t]},Kc.prototype.Sa=function(){return this.ru.activeTargetIds},Kc.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},Kc.prototype.start=function(){return this.ru=new xc,Promise.resolve()},Kc.prototype.Qa=function(t,e,n){},Kc.prototype.Ka=function(t){},Kc.prototype.$o=function(){},Kc.prototype.q=function(t){},Kc.prototype.Wa=function(){},Kc),Uc=(Jc.prototype.cu=function(t){},Jc.prototype.$o=function(){},Jc),Mc=(zc.prototype.cu=function(t){this._u.push(t)},zc.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},zc.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},zc.prototype.uu=function(){Zr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},zc.prototype.lu=function(){Zr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},zc.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},zc),Fc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},qc=(Gc.prototype.Tu=function(t){this.Eu=t},Gc.prototype.Iu=function(t){this.mu=t},Gc.prototype.onMessage=function(t){this.Au=t},Gc.prototype.Ru=function(t){this.Pu=t},Gc.prototype.close=function(){this.wu()},Gc.prototype.send=function(t){this.du(t)},Gc.prototype.yu=function(){this.Eu()},Gc.prototype.gu=function(t){this.mu(t)},Gc.prototype.Vu=function(t){this.Au(t)},Gc.prototype.pu=function(t,e){this.Pu(t,e)},Gc),jc=(Bc.prototype.Du=function(e,t,n,r){var i=this.Cu(e,t);Zr("RestConnection","Sending: ",i,n);t={};return this.xu(t,r),this.Nu(e,i,t,n).then(function(t){return Zr("RestConnection","Received: ",t),t},function(t){throw ei("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Bc.prototype.Fu=function(t,e,n,r){return this.Du(t,e,n,r)},Bc.prototype.xu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2-longpoll.66863f547",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Bc.prototype.Cu=function(t,e){t=Fc[t];return this.vu+"/v1/"+e+":"+t},l(Hc,Ec=Bc),Hc.prototype.Nu=function(o,e,s,u){return new Promise(function(n,r){var i=new Xr;i.listenOnce(Gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case Br.NO_ERROR:var t=i.getResponseJson();Zr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case Br.TIMEOUT:Zr("Connection",'RPC "'+o+'" timed out'),r(new pi(fi.DEADLINE_EXCEEDED,"Request time out"));break;case Br.HTTP_ERROR:var e=i.getStatus();Zr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(fi).indexOf(e)?e:fi.UNKNOWN,r(new pi(e,t.message))):r(new pi(fi.UNKNOWN,"Server responded with status "+i.getStatus())):r(new pi(fi.UNAVAILABLE,"Connection failed."));break;default:ri()}}finally{Zr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Hc.prototype.Ou=function(t,e){var n,r=[this.vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Ur,o=Hr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.xu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Zr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=(new Date).getTime(),h=new qc({du:function(t){a?Zr("Connection","Not sending because WebChannel is closed:",t):(u||(Zr("Connection","Opening WebChannel transport."),s.open(),u=!0),Zr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Wr.EventType.OPEN,function(){a||Zr("Connection","WebChannel transport opened.")}),t(s,Wr.EventType.CLOSE,function(){a||(a=!0,Zr("Connection","WebChannel transport closed"),h.gu())}),t(s,Wr.EventType.ERROR,function(t){a||(a=!0,ei("Connection","WebChannel transport errored:",t),h.gu(new pi(fi.UNAVAILABLE,"The operation could not be completed")))}),t(s,Wr.EventType.MESSAGE,function(t){var e,n,r,i;a||(ii(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Zr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=_u[r];if(void 0!==t)return Du(t)}(),i=n.message,void 0===t&&(t=fi.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.gu(new pi(t,i)),s.close()):(Zr("Connection","WebChannel received:",e),h.Vu(e)))}),t(o,zr.STAT_EVENT,function(t){var e=(new Date).getTime()-c;t.stat===Jr?(Zr("Connection","Detected buffering proxy"),h.pu(!0,e)):t.stat===Kr&&(Zr("Connection","Detected no buffering proxy"),h.pu(!1,e))}),setTimeout(function(){h.yu()},0),h},Hc);function Hc(t){var e=this;return(e=Ec.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Bc(t){this.bu=t,this.T=t.T;var e=t.ssl?"https":"http";this.vu=e+"://"+t.host,this.Su="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Gc(t){this.du=t.du,this.wu=t.wu}function zc(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function Jc(){}function Kc(){this.ru=new xc,this.ou={},this.da=null,this.$=null}function Wc(){this.activeTargetIds=Ju}function Xc(t){this.persistence=t,this.sa=new Nc,this.ia=null}function Yc(t){var e=this;return(e=Tc.call(this)||this).vs=t,e}function Qc(t,e){var n=this;this.Xc={},this.io=new ki(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Rc(this),this.Ei=new Xa,this.wo=(t=this.Ei,new Dc(t,function(t){return n.Ii.Zc(t)})),this.Kt=new Ha(e),this.To=new Ac(this.Kt)}function $c(t){this.persistence=t,this.zc=new ec(qo,jo),this.lastRemoteSnapshotVersion=Hi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Nc,this.targetCount=0,this.Yc=nc.Li()}function Zc(t){var e=this;return(e=Ic.call(this)||this).Gr=t,e}function th(t,e){this.Ei=t,this.Wc=e,this.docs=new Lu(Ji.J),this.size=0}function eh(t,e){this.Ei=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new Uu(Oc.Dc)}function nh(t,e){this.key=t,this.Lc=e}function rh(){this.Sc=new Uu(Oc.Dc),this.Cc=new Uu(Oc.xc)}function ih(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function oh(){return"undefined"!=typeof document?document:null}function sh(t){return new da(t,!0)}function uh(t,e,n,r,i){var o=this;this.xh=t,this.Nh=e,this.fs=n,this.Fh={},this.Oh=[],this.kh=new Map,this.Mh=new Set,this.$h=[],this.Lh=i,this.Lh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lh(this)?(Zr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mh.add(4),[4,Th(e)];case 1:return t.sent(),e.Bh.set("Unknown"),e.Mh.delete(4),[4,Eh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bh=new yh(n,r)}var ah,ch,hh,lh=(_h.prototype.reset=function(){this.Lu=0},_h.prototype.Uu=function(){this.Lu=this.$u},_h.prototype.Qu=function(t){var e=this;this.cancel();var n=Math.floor(this.Lu+this.Ku()),r=Math.max(0,Date.now()-this.qu),i=Math.max(0,n-r);0<i&&Zr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Lu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Bu=this.eo.Ir(this.ds,i,function(){return e.qu=Date.now(),t()}),this.Lu*=this.Mu,this.Lu<this.ku&&(this.Lu=this.ku),this.Lu>this.$u&&(this.Lu=this.$u)},_h.prototype.ju=function(){null!==this.Bu&&(this.Bu.Ps(),this.Bu=null)},_h.prototype.cancel=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},_h.prototype.Ku=function(){return(Math.random()-.5)*this.Lu},_h),Ke=(bh.prototype.Xu=function(){return 1===this.state||2===this.state||4===this.state},bh.prototype.Zu=function(){return 2===this.state},bh.prototype.start=function(){3!==this.state?this.auth():this.th()},bh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Xu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},bh.prototype.eh=function(){this.state=0,this.Yu.reset()},bh.prototype.nh=function(){var t=this;this.Zu()&&null===this.Ju&&(this.Ju=this.eo.Ir(this.Wu,6e4,function(){return t.sh()}))},bh.prototype.ih=function(t){this.rh(),this.stream.send(t)},bh.prototype.sh=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Zu()?[2,this.close(0)]:[2]})})},bh.prototype.rh=function(){this.Ju&&(this.Ju.cancel(),this.Ju=null)},bh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.rh(),this.Yu.cancel(),this.Hu++,3!==e?this.Yu.reset():n&&n.code===fi.RESOURCE_EXHAUSTED?(ti(n.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.Yu.Uu()):n&&n.code===fi.UNAUTHENTICATED&&this.zu.v(),null!==this.stream&&(this.oh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},bh.prototype.oh=function(){},bh.prototype.Ru=function(t,e){this.listener.Ru(t,e)},bh.prototype.auth=function(){var n=this;this.state=1;var t=this.ah(this.Hu),e=this.Hu;this.zu.getToken().then(function(t){n.Hu===e&&n.uh(t)},function(e){t(function(){var t=new pi(fi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.hh(t)})})},bh.prototype.uh=function(t){var r=this,i=this.ah(this.Hu);this.stream=this.lh(t),this.stream.Tu(function(){i(function(){return r.state=2,r.listener.Tu()})}),this.stream.Iu(function(t){i(function(){return r.hh(t)})}),this.stream.onMessage(function(t){i(function(){return r.onMessage(t)})}),this.stream.Ru(function(e,n){i(function(){return y(r,void 0,void 0,function(){return v(this,function(t){return[2,this.Ru(e,n)]})})})})},bh.prototype.th=function(){var t=this;this.state=4,this.Yu.Qu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},bh.prototype.hh=function(t){return Zr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},bh.prototype.ah=function(e){var n=this;return function(t){n.eo.ys(function(){return n.Hu===e?t():(Zr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},bh),fh=(l(wh,hh=Ke),wh.prototype.lh=function(t){return this.Gu.Ou("Listen",t)},wh.prototype.onMessage=function(t){this.Yu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:ri(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(ii(void 0===s||"string"==typeof s),ci.fromBase64String(s||"")):(ii(void 0===s||s instanceof Uint8Array),ci.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?fi.UNKNOWN:Du(c.code),new pi(a,c.message||"")),s=new ta(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=_a(t,n.document.name),i=ga(n.document.updateTime);var u=new Ao({mapValue:{fields:n.document.fields}}),a=(o=new Co(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new $u(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=_a(t,n.document),i=n.readTime?ga(n.readTime):Hi.min(),u=new ko(r,i),o=n.removedTargetIds||[],s=new $u([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=_a(t,n.document),i=n.removedTargetIds||[],s=new $u([],i,r,null);else{if(!("filter"in e))return ri();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new bu(n),i=e.targetId,s=new Zu(i,r)}return s}(this.Kt,t),t=function(t){if(!("targetChange"in t))return Hi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?ga(t.readTime):Hi.min()}(t);return this.listener._h(e,t)},wh.prototype.fh=function(t){var e,n,r,i={};i.database=Ta(this.Kt),i.addTarget=(e=this.Kt,(r=Ho(r=(n=t).target)?{documents:{documents:[Ea(e,r.path)]}}:{query:Oa(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=va(e,n.resumeToken):0<n.Mt.u(Hi.min())&&(r.readTime=ya(e,n.Mt.G())),r);var o,t=(this.Kt,o=t,null==(t=function(){switch(o.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ri()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ih(i)},wh.prototype.dh=function(t){var e={};e.database=Ta(this.Kt),e.removeTarget=t,this.ih(e)},wh),ph=(l(mh,ch=Ke),Object.defineProperty(mh.prototype,"Th",{get:function(){return this.wh},enumerable:!1,configurable:!0}),mh.prototype.start=function(){this.wh=!1,this.lastStreamToken=void 0,ch.prototype.start.call(this)},mh.prototype.oh=function(){this.wh&&this.Eh([])},mh.prototype.lh=function(t){return this.Gu.Ou("Write",t)},mh.prototype.onMessage=function(t){if(ii(!!t.streamToken),this.lastStreamToken=t.streamToken,this.wh){this.Yu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(ii(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?ga(t.updateTime):ga(e);n.isEqual(Hi.min())&&(n=ga(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new ru(n,e)}(t,r)})):[]),n=ga(t.commitTime);return this.listener.Ih(n,e)}var n,r;return ii(!t.writeResults||0===t.writeResults.length),this.wh=!0,this.listener.mh()},mh.prototype.Ah=function(){var t={};t.database=Ta(this.Kt),this.ih(t)},mh.prototype.Eh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Na(e.Kt,t)})};this.ih(t)},mh),dh=(l(gh,ah=function(){}),gh.prototype.Ph=function(){if(this.Rh)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.")},gh.prototype.Du=function(e,n,r){var i=this;return this.Ph(),this.credentials.getToken().then(function(t){return i.Gu.Du(e,n,r,t)}).catch(function(t){throw t.code===fi.UNAUTHENTICATED&&i.credentials.v(),t})},gh.prototype.Fu=function(e,n,r){var i=this;return this.Ph(),this.credentials.getToken().then(function(t){return i.Gu.Fu(e,n,r,t)}).catch(function(t){throw t.code===fi.UNAUTHENTICATED&&i.credentials.v(),t})},gh.prototype.terminate=function(){this.Rh=!1},gh),yh=(vh.prototype.ph=function(){var t=this;0===this.yh&&(this.bh("Unknown"),this.gh=this.fs.Ir("online_state_timeout",1e4,function(){return t.gh=null,t.Sh("Backend didn't respond within 10 seconds."),t.bh("Offline"),Promise.resolve()}))},vh.prototype.Dh=function(t){"Online"===this.state?this.bh("Unknown"):(this.yh++,1<=this.yh&&(this.Ch(),this.Sh("Connection failed 1 times. Most recent error: "+t.toString()),this.bh("Offline")))},vh.prototype.set=function(t){this.Ch(),this.yh=0,"Online"===t&&(this.Vh=!1),this.bh(t)},vh.prototype.bh=function(t){t!==this.state&&(this.state=t,this.da(t))},vh.prototype.Sh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vh?(ti(t),this.Vh=!1):Zr("OnlineStateTracker",t)},vh.prototype.Ch=function(){null!==this.gh&&(this.gh.cancel(),this.gh=null)},vh);function vh(t,e){this.fs=t,this.da=e,this.state="Unknown",this.yh=0,this.gh=null,this.Vh=!0}function gh(t,e,n){var r=this;return(r=ah.call(this)||this).credentials=t,r.Gu=e,r.Kt=n,r.Rh=!1,r}function mh(t,e,n,r,i){var o=this;return(o=ch.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o.wh=!1,o}function wh(t,e,n,r,i){var o=this;return(o=hh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function bh(t,e,n,r,i,o){this.eo=t,this.Wu=n,this.Gu=r,this.zu=i,this.listener=o,this.state=0,this.Hu=0,this.Ju=null,this.stream=null,this.Yu=new lh(t,e)}function _h(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.ku=n,this.Mu=r,this.$u=i,this.Lu=0,this.Bu=null,this.qu=Date.now(),this.reset()}function Eh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Lh(r))return[3,4];e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Th(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ih(t,e){t.kh.has(e.targetId)||(t.kh.set(e.targetId,e),Dh(t)?Sh(t):Fh(t).Zu()&&Nh(t,e))}function Ah(t,e){var n=t,t=Fh(n);n.kh.delete(e),t.Zu()&&Oh(n,e),0===n.kh.size&&(t.Zu()?t.nh():Lh(n)&&n.Bh.set("Unknown"))}function Nh(t,e){t.qh.cn(e.targetId),Fh(t).fh(e)}function Oh(t,e){t.qh.cn(e),Fh(t).dh(e)}function Sh(e){e.qh=new na({Sn:function(t){return e.Fh.Sn(t)},Dn:function(t){return e.kh.get(t)||null}}),Fh(e).start(),e.Bh.ph()}function Dh(t){return Lh(t)&&!Fh(t).Xu()&&0<t.kh.size}function Lh(t){return 0===t.Mh.size}function Rh(t){t.qh=void 0}function Ch(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bh.set("Online"),!(u instanceof ta&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.kh.has(i)?[4,o.Fh.Uh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.kh.delete(i),o.qh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Zr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,kh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof $u?s.qh.wn(u):u instanceof Zu?s.qh.yn(u):s.qh.In(u),a.isEqual(Hi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,vc(s.xh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).qh.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.kh.get(e))&&r.kh.set(e,n.Lt(t.resumeToken,i)))}),e.ke.forEach(function(t){var e=r.kh.get(t);e&&(r.kh.set(t,e.Lt(ci.h,e.Mt)),Oh(r,t),e=new Ps(e.target,t,1,e.sequenceNumber),Nh(r,e))}),r.Fh.Qh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Zr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,kh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function kh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ma(r))throw r;return n.Mh.add(1),[4,Th(n)];case 1:return t.sent(),n.Bh.set("Offline"),i=i||function(){return vc(n.xh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Zr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mh.delete(1),[4,Eh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Ph(e,n){return n().catch(function(t){return kh(e,t,n)})}function xh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=qh(i=a),s=0<i.Oh.length?i.Oh[i.Oh.length-1].batchId:-1,t.label=1;case 1:if(!(Lh(i)&&i.Oh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.xh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ho.Vi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Oh.length&&o.nh(),[3,7]):(s=u.batchId,function(t,e){t.Oh.push(e);t=qh(t);t.Zu()&&t.Th&&t.Eh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,kh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Vh(i)&&Uh(i),[2]}var e,n,r})})}function Vh(t){return Lh(t)&&!qh(t).Xu()&&0<t.Oh.length}function Uh(t){qh(t).start()}function Mh(t,e,n){t.Fh.Kh&&t.Fh.Kh(e,n)}function Fh(n){var t,e,r,i=this;return n.Gh||(n.Gh=(t=n.Nh,e=n.fs,r={Tu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.kh.forEach(function(t,e){Nh(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Rh(e),Dh(e)?(e.Bh.Dh(n),Sh(e)):e.Bh.set("Unknown"),[2]})})}.bind(null,n),_h:Ch.bind(null,n),Ru:Mh.bind(null,n)},t.Ph(),new fh(e,t.Gu,t.credentials,t.Kt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gh.eh(),Dh(n)?Sh(n):n.Bh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Gh.stop()];case 2:t.sent(),Rh(n),t.label=3;case 3:return[2]}})})})),n.Gh}function qh(n){var t,e,r,i=this;return n.zh||(n.zh=(t=n.Nh,e=n.fs,r={Tu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return qh(e).Ah(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&qh(e).Th?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Su(n=i.code)&&n!==fi.ABORTED?(e=r.Oh.shift(),qh(r).eh(),[4,Ph(r,function(){return r.Fh.Wh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,xh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Vh(e)&&Uh(e),[2]}})})}.bind(null,n),mh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=qh(o),n=0,r=o.Oh;n<r.length;n++)i=r[n],e.Eh(i.mutations);return[2]})})}.bind(null,n),Ih:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Oh.shift(),n=Ga.from(e,i,o),[4,Ph(r,function(){return r.Fh.jh(n)})];case 1:return t.sent(),[4,xh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n),Ru:Mh.bind(null,n)},t.Ph(),new ph(e,t.Gu,t.credentials,t.Kt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.zh.eh(),[4,xh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.zh.stop()];case 3:t.sent(),0<n.Oh.length&&(Zr("RemoteStore","Stopping write stream with "+n.Oh.length+" pending writes"),n.Oh=[]),t.label=4;case 4:return[2]}})})})),n.zh}function jh(){this.queries=new ec(Ls,Ds),this.onlineState="Unknown",this.Jh=new Set}var Hh=function(){this.Hh=void 0,this.listeners=[]};function Bh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Hh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Yh(n)];case 2:return o.Hh=t.sent(),[3,4];case 3:return o=t.sent(),o=ja(o,"Initialization of query '"+Rs(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Xh(e.onlineState),i.Hh&&u.Zh(i.Hh)&&zh(e),[2]}})})}function Gh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.tl(n))]:[2]})})}function zh(t){t.Jh.forEach(function(t){t.next()})}var Jh=(Zh.prototype.Zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.nl?this.il(t)&&(this.el.next(t),o=!0):this.rl(t,this.onlineState)&&(this.ol(t),o=!0),this.sl=t,o},Zh.prototype.onError=function(t){this.el.error(t)},Zh.prototype.Xh=function(t){this.onlineState=t;var e=!1;return this.sl&&!this.nl&&this.rl(this.sl,t)&&(this.ol(this.sl),e=!0),e},Zh.prototype.rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.cl&&n||t.docs.nt()&&"Offline"!==e)},Zh.prototype.il=function(t){if(0<t.docChanges.length)return!0;var e=this.sl&&this.sl.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Zh.prototype.ol=function(t){t=Xu.Fe(t.query,t.docs,t.Ce,t.fromCache),this.nl=!0,this.el.next(t)},Zh),Kh=($h.prototype.al=function(){return"metadata"in this.payload},$h),Wh=(Qh.prototype.yc=function(t){return _a(this.Kt,t)},Qh.prototype.gc=function(t){return t.metadata.exists?(e=this.Kt,n=t.document,r=_a(e,n.name),e=ga(n.updateTime),n=new Ao({mapValue:{fields:n.fields}}),new Co(r,e,n,{hasCommittedMutations:!1})):new ko(this.yc(t.metadata.name),this.Vc(t.metadata.readTime));var e,n,r},Qh.prototype.Vc=ga,Qh),Xh=(Yh.prototype.hl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Yh.prototype.ll=function(t){for(var e=new Map,n=new Wh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||zu()).add(s);e.set(c,h)}}return e},Yh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,f,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=l,r=zu(),i=Fu,o=Bu,e=0,s=p;e<s.length;e++)u=s[e],a=f.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,f.gc(u)),o=o.Ht(a,f.Vc(u.metadata.readTime));return c=n.Ec.Fr({Wr:!0}),[4,wc(n,Os(bs(Bi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return mc(e,c,i,Hi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.xh,new Wh(this.Kt),this.documents,this.ul.id)];case 1:e=t.sent(),n=this.ll(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=zu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,wc(e,Os(Wa(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ga(i.readTime);if(0<=n.Mt.u(e))return r.To.Bs(t,i);e=n.Lt(ci.h,e);return r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.To.Bs(t,i)})})]}})})}(this.xh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new tc(Object.assign({},this.progress),e))]}})})},Yh);function Yh(t,e,n){this.ul=t,this.xh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=tl(t)}function Qh(t){this.Kt=t}function $h(t,e){this.payload=t,this.byteLength=e}function Zh(t,e,n){this.query=t,this.el=e,this.nl=!1,this.sl=null,this.onlineState="Unknown",this.options=n||{}}function tl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var el=function(t){this.key=t},nl=function(t){this.key=t},rl=(Object.defineProperty(al.prototype,"El",{get:function(){return this._l},enumerable:!1,configurable:!0}),al.prototype.Il=function(t,e){var s=this,u=e?e.ml:new Wu,a=(e||this).Tl,c=(e||this).Ce,h=a,l=!1,f=_s(this.query)&&a.size===this.query.limit?a.last():null,p=Es(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof Co?e:null)&&(Cs(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Al(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.wl(r,f)||p&&s.wl(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),_s(this.query)||Es(this.query))for(;h.size>this.query.limit;){var n=_s(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Tl:h,ml:u,_c:l,Ce:c}},al.prototype.Al=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},al.prototype.Ti=function(t,e,n){var o=this,r=this.Tl;this.Tl=t.Tl,this.Ce=t.Ce;var i=t.ml.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.wl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ri()}}var r,i}),this.Rl(n);var s=e?this.Pl():[],n=0===this.dl.size&&this.qe?1:0,e=n!==this.fl;return this.fl=n,0!==i.length||e?{snapshot:new Xu(this.query,t.Tl,r,i,t.Ce,0==n,e,!1),yl:s}:{yl:s}},al.prototype.Xh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({Tl:this.Tl,ml:new Wu,Ce:this.Ce,_c:!1},!1)):{yl:[]}},al.prototype.gl=function(t){return!this._l.has(t)&&!!this.Tl.has(t)&&!this.Tl.get(t).bt},al.prototype.Rl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e._l=e._l.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e._l=e._l.delete(t)}),this.qe=t.qe)},al.prototype.Pl=function(){var e=this;if(!this.qe)return[];var n=this.dl;this.dl=zu(),this.Tl.forEach(function(t){e.gl(t.key)&&(e.dl=e.dl.add(t.key))});var r=[];return n.forEach(function(t){e.dl.has(t)||r.push(new nl(t))}),this.dl.forEach(function(t){n.has(t)||r.push(new el(t))}),r},al.prototype.Vl=function(t){this._l=t.Pc,this.dl=zu();t=this.Il(t.documents);return this.Ti(t,!0)},al.prototype.pl=function(){return Xu.Fe(this.query,this.Tl,this.Ce,0===this.fl)},al),il=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ol=function(t){this.key=t,this.bl=!1},sl=(Object.defineProperty(ul.prototype,"jl",{get:function(){return!0===this.Kl},enumerable:!1,configurable:!0}),ul);function ul(t,e,n,r,i,o,s){this.xh=t,this.vl=e,this.Sl=n,this.Dl=r,this.currentUser=i,this.Cl=o,this.xl=s,this.Nl={},this.Fl=!1,this.Ol=new ec(Ls,Ds),this.kl=new Map,this.Ml=[],this.$l=new Lu(Ji.J),this.Ll=new Map,this.Bl=new Nc,this.ql={},this.Ul=new Map,this.Ql=nc.Bi(),this.onlineState="Unknown",this.Kl=void 0}function al(t,e){this.query=t,this._l=e,this.fl=null,this.qe=!1,this.dl=zu(),this.Ce=zu(),this.wl=ks(t),this.Tl=new Ku(this.wl)}function cl(u,a){return y(this,void 0,void 0,function(){var e,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(n=u).vl.Fh.Qh=ll.bind(null,n),n.vl.Fh.Sn=function(t,e){var n=t,t=n.Ll.get(e);if(t&&t.bl)return zu().add(t.key);var r=zu(),e=n.kl.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Ol.get(s);r=r.ye(s.view.El)}return r}.bind(null,n),n.vl.Fh.Uh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Dl.qa(s,"rejected",u),i=e.Ll.get(s),(n=i&&i.key)?(r=(r=new Lu(Ji.J)).Ht(n,new ko(n,Hi.min())),i=zu().add(n),i=new Yu(Hi.min(),new Map,new Uu(ui),r,i),[4,ll(e,i)]):[3,2];case 1:return t.sent(),e.$l=e.$l.remove(n),e.Ll.delete(s),wl(e),[3,4];case 2:return[4,bc(e.xh,s,!1).then(function(){return vl(e,s,u)}).catch(Za)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),n.vl.Fh.Kh=function(t,e){!n.Fl&&n.xl&&(n.Fl=!0,n.xl(t,e))},n.Nl._h=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Zh(s)&&(r=!0);u.Hh=s}}r&&zh(n)}.bind(null,n.Sl),n.Nl.Gl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,n.Sl),(s=(e=n).Ol.get(a))?(r=s.targetId,e.Dl.ka(r),i=s.view.pl(),[3,4]):[3,1];case 1:return[4,wc(e.xh,Os(a))];case 2:return o=t.sent(),s=e.Dl.ka(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Wl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Il(o))._c?[4,_c(r.xh,i.query,!1).then(function(t){t=t.documents;return i.view.Il(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ti(e,r.jl,n),[2,(ml(r,i.targetId,n.yl),n.snapshot)]}})})}(i,t,e,n)},[4,_c(i.xh,o,!0)];case 1:return n=t.sent(),r=new rl(o,n.Pc),e=r.Il(n.documents),n=Qu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ti(e,i.jl,n),ml(i,s,n.yl),r=new il(o,s,r),[2,(i.Ol.set(o,r),i.kl.has(s)?i.kl.get(s).push(o):i.kl.set(s,[o]),n.snapshot)]}})})}(e,a,r,"current"===s)];case 3:i=t.sent(),e.jl&&Ih(e.vl,o),t.label=4;case 4:return[2,i]}var n})})}function hl(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).vl.Fh.jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,yc(e.xh,o)];case 2:return r=t.sent(),yl(e,n,null),dl(e,n),e.Dl.Fa(n,"acknowledged"),[4,bl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.vl.Fh.Wh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.xh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return ii(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Oi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),yl(n,u,a),dl(n,u),n.Dl.Fa(u,"rejected",a),[4,bl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.xh,a=p,h=r,l=ji.now(),i=a.reduce(function(t,e){return t.add(e.key)},zu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Co?e.field(o.field):void 0,s=Fs(o.transform,s||null);null!=s&&(n=(null==n?new No:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new pu(o.key,s,function s(t){var u=[];return to(t.fields||{},function(t,e){var n=new zi([t]);if(Io(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new no(u)}(s.proto.mapValue),iu.exists(!0)))}return h.Ho.Pi(u,l,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.Dl.xa(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.ql[e.currentUser.R()])||new Lu(ui)).Ht(n,o),e.ql[e.currentUser.R()]=r,[4,bl(u,s.oi)];case 3:return t.sent(),[4,xh(u.vl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ja(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,l,i,o})})}function ll(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,gc(n.xh,i)];case 2:return e=t.sent(),i.Oe.forEach(function(t,e){e=n.Ll.get(e);e&&(ii(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.bl=!0:0<t.Qe.size?ii(e.bl):0<t.Ke.size&&(ii(e.bl),e.bl=!1))}),[4,bl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function fl(t,n,e){var r,t=t;(t.jl&&0===e||!t.jl&&1===e)&&(r=[],t.Ol.forEach(function(t,e){e=e.view.Xh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Xh(i)&&(o=!0)}),o&&zh(t)}(t.Sl,n),r.length&&t.Nl._h(r),t.onlineState=n,t.jl&&t.Dl.Ka(n))}function pl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Lh((n=o).vl)||Zr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.xh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Ul.get(r)||[]).push(s),n.Ul.set(r,i),[3,4]);case 3:return i=t.sent(),i=ja(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function dl(t,e){(t.Ul.get(e)||[]).forEach(function(t){t.resolve()}),t.Ul.delete(e)}function yl(t,e,n){var r=t,i=r.ql[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.ql[r.currentUser.R()]=i)}function vl(e,t,n){void 0===n&&(n=null),e.Dl.$a(t);for(var r=0,i=e.kl.get(t);r<i.length;r++){var o=i[r];e.Ol.delete(o),n&&e.Nl.Gl(o,n)}e.kl.delete(t),e.jl&&e.Bl.kc(t).forEach(function(t){e.Bl.ki(t)||gl(e,t)})}function gl(t,e){var n=t.$l.get(e);null!==n&&(Ah(t.vl,n),t.$l=t.$l.remove(e),t.Ll.delete(n),wl(t))}function ml(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof el?(t.Bl.sr(o.key,e),function(t,e){e=e.key;t.$l.get(e)||(Zr("SyncEngine","New document in limbo: "+e),t.Ml.push(e),wl(t))}(t,o)):o instanceof nl?(Zr("SyncEngine","Document no longer in limbo: "+o.key),t.Bl.rr(o.key,e),t.Bl.ki(o.key)||gl(t,o.key)):ri()}}function wl(t){for(;0<t.Ml.length&&t.$l.size<t.Cl;){var e=t.Ml.shift(),n=t.Ql.next();t.Ll.set(n,new ol(e)),t.$l=t.$l.Ht(e,n),Ih(t.vl,new Ps(Os(bs(e.path)),n,2,ki.U))}}function bl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ol.nt()?[3,3]:(n.Ol.forEach(function(t,e){o.push(n.Wl(e,s,u).then(function(t){t&&(n.jl&&n.Dl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ic.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Nl._h(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Va.forEach(c,function(e){return Va.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return Va.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Zr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.xh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function _l(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Zr("SyncEngine","User change. New user:",o.R()),[4,dc(n.xh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Ul.forEach(function(t){t.forEach(function(t){t.reject(new pi(fi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ul.clear(),n.Dl.Qa(o,r.Ac,r.Rc),[4,bl(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function El(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.xh,o=r,s=ga((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.To.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.zl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Hl(tl(u)),a=new Xh(u,f.xh,p.Kt),[4,p.Jl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.hl(c)]:[3,10];case 7:return(h=t.sent())&&d.Hl(h),[4,p.Jl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,bl(f,l.zo,void 0)];case 12:return t.sent(),[4,(r=f.xh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.To.$s(t,e)}))];case 13:return t.sent(),d.zl(l.progress),[3,15];case 14:return ei("SyncEngine","Loading bundle failed with "+(l=t.sent())),d.Yl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Dl.Wa()})}var Tl=(Nl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=sh(e.bu.T),this.Dl=this.Xl(e),this.persistence=this.Zl(e),[4,this.persistence.start()];case 1:return t.sent(),this.t_=this.e_(e),this.xh=this.n_(e),[2]}})})},Nl.prototype.e_=function(t){return null},Nl.prototype.n_=function(t){return e=this.persistence,n=new oc,r=t.s_,t=this.Kt,new sc(e,n,r,t);var e,n,r},Nl.prototype.Zl=function(t){return new Cc(Pc.ra,this.Kt)},Nl.prototype.Xl=function(t){return new Vc},Nl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.t_&&this.t_.stop(),[4,this.Dl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},Nl),Il=(Al.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.xh?[3,2]:(this.xh=n.xh,this.Dl=n.Dl,this.Nh=this.r_(r),this.vl=this.o_(r),this.Sl=this.c_(r),this.fa=this.a_(r,!n.synchronizeTabs),this.Dl.da=function(t){return fl(e.fa,t,1)},this.vl.Fh.u_=_l.bind(null,this.fa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mh.delete(2),[4,Eh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mh.add(2),[4,Th(e)]);case 3:t.sent(),e.Bh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.vl,this.fa.jl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Al.prototype.c_=function(t){return new jh},Al.prototype.r_=function(t){var e=sh(t.bu.T),n=(n=t.bu,new jc(n));return t=t.credentials,new dh(t,n,e)},Al.prototype.o_=function(t){var e=this,n=this.xh,r=this.Nh,i=t.fs,o=function(t){return fl(e.fa,t,0)},t=new(Mc.jn()?Mc:Uc);return new uh(n,r,i,o,t)},Al.prototype.a_=function(t,e){return function(t,e,n,r,i,o,s,u){u=new sl(t,e,n,r,i,o,u);return s&&(u.Kl=!0),u}(this.xh,this.vl,this.Sl,this.Dl,t.s_,t.Cl,e,t.xl)},Al.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Zr("RemoteStore","RemoteStore shutting down."),e.Mh.add(5),[4,Th(e)];case 1:return t.sent(),e.Lh.$o(),e.Bh.set("Unknown"),[2]}})})}(this.vl)},Al);function Al(){}function Nl(){this.synchronizeTabs=!1}function Ol(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var Sl=(Pl.prototype.next=function(t){this.observer.next&&this.h_(this.observer.next,t)},Pl.prototype.error=function(t){this.observer.error?this.h_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Pl.prototype.l_=function(){this.muted=!0},Pl.prototype.h_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Pl),Dl=(kl.prototype.close=function(){return this.__.cancel()},kl.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},kl.prototype.Jl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.d_())]}})})},kl.prototype.d_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.w_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.f_.decode(e),n=Number(r),isNaN(n)&&this.T_("length string ("+r+") is not valid number"),[4,this.E_(n)]);case 2:return r=t.sent(),[2,new Kh(JSON.parse(r),e.length+n)]}})})},kl.prototype.I_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},kl.prototype.w_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.I_()<0?[4,this.m_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.I_())<0&&this.T_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},kl.prototype.E_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.m_()]:[3,3];case 1:t.sent()&&this.T_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.f_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},kl.prototype.T_=function(t){throw this.__.cancel(),new Error("Invalid bundle format: "+t)},kl.prototype.m_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.__.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},kl),Ll=(Cl.prototype.isEqual=function(t){return this.A_.isEqual(t.A_)},Cl),Rl=function(t){this._methodName=t};function Cl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.A_=new zi(t)}function kl(t,e){var n=this;this.__=t,this.Kt=e,this.metadata=new xa,this.buffer=new Uint8Array,this.f_=new TextDecoder("utf-8"),this.d_().then(function(t){t&&t.al()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Pl(t){this.observer=t,this.muted=!1}function xl(t,e,n){if(!n)throw new pi(fi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Vl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new pi(fi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ul(t,e,n,r){if(!0===e&&!0===r)throw new pi(fi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ml(t){if(!Ji.Tt(t))throw new pi(fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Fl(t){if(Ji.Tt(t))throw new pi(fi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ql(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":ri();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function jl(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new pi(fi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=ql(t);throw new pi(fi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Hl(t,e){if(e<=0)throw new pi(fi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Bl,Gl=(tf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},tf),zl=new Map,Jl=(Object.defineProperty(Zl.prototype,"app",{get:function(){if(!this.p_)throw new pi(fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.p_},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"b_",{get:function(){return this.y_},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"v_",{get:function(){return void 0!==this.S_},enumerable:!1,configurable:!0}),Zl.prototype.D_=function(t){if(this.y_)throw new pi(fi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.P_=new Gl(t),void 0!==t.credentials&&(this.V_=function(t){if(!t)return new Di;switch(t.type){case"gapi":var e=t.client;return ii(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ci(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new pi(fi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Zl.prototype.C_=function(){return this.P_},Zl.prototype.x_=function(){return this.y_=!0,this.P_},Zl.prototype._delete=function(){return this.S_||(this.S_=this.N_()),this.S_},Zl.prototype.N_=function(){return(t=zl.get(this))&&(Zr("ComponentProvider","Removing Datastore"),zl.delete(this),t.terminate()),Promise.resolve();var t},Zl),Kl=(Object.defineProperty($l.prototype,"k_",{get:function(){return this.O_.path},enumerable:!1,configurable:!0}),Object.defineProperty($l.prototype,"id",{get:function(){return this.O_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty($l.prototype,"path",{get:function(){return this.O_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty($l.prototype,"parent",{get:function(){return new Xl(this.firestore,this.F_,this.O_.path.Z())},enumerable:!1,configurable:!0}),$l.prototype.withConverter=function(t){return new $l(this.firestore,t,this.O_)},$l),Wl=(Ql.prototype.withConverter=function(t){return new Ql(this.firestore,t,this.M_)},Ql),Xl=(l(Yl,Bl=Wl),Object.defineProperty(Yl.prototype,"id",{get:function(){return this.M_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"path",{get:function(){return this.M_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"parent",{get:function(){var t=this.k_.Z();return t.nt()?null:new Kl(this.firestore,null,new Ji(t))},enumerable:!1,configurable:!0}),Yl.prototype.withConverter=function(t){return new Yl(this.firestore,t,this.k_)},Yl);function Yl(t,e,n){var r=this;return(r=Bl.call(this,t,e,bs(n))||this).firestore=t,r.k_=n,r.type="collection",r}function Ql(t,e,n){this.F_=e,this.M_=n,this.type="query",this.firestore=t}function $l(t,e,n){this.F_=e,this.O_=n,this.type="document",this.firestore=t}function Zl(t,e){this.R_="(lite)",this.P_=new Gl({}),this.y_=!1,t instanceof Ti?(this.g_=t,this.V_=new Di):(this.p_=t,this.g_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new pi(fi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ti(t.options.projectId)}(t),this.V_=new Li(e))}function tf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new pi(fi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new pi(fi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ul("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function ef(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof yi&&(t=t._),xl("collection","path",e),t instanceof Jl)return Fl(n=Bi.ct.apply(Bi,f([e],r))),new Xl(t,null,n);if(!(t instanceof Kl||t instanceof Xl))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Fl(n=Bi.ct.apply(Bi,f([t.path],r)).child(Bi.ct(e))),new Xl(t.firestore,null,n)}function nf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof yi&&(t=t._),1===arguments.length&&(e=oi.t()),xl("doc","path",e),t instanceof Jl)return Ml(n=Bi.ct.apply(Bi,f([e],r))),new Kl(t,null,new Ji(n));if(!(t instanceof Kl||t instanceof Xl))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ml(n=t.k_.child(Bi.ct.apply(Bi,f([e],r)))),new Kl(t.firestore,t instanceof Xl?t.F_:null,new Ji(n))}function rf(t,e){return t instanceof yi&&(t=t._),e instanceof yi&&(e=e._),(t instanceof Kl||t instanceof Xl)&&(e instanceof Kl||e instanceof Xl)&&t.firestore===e.firestore&&t.path===e.path&&t.F_===e.F_}function of(t,e){return t instanceof yi&&(t=t._),e instanceof yi&&(e=e._),t instanceof Wl&&e instanceof Wl&&t.firestore===e.firestore&&Ds(t.M_,e.M_)&&t.F_===e.F_}var sf=(Object.defineProperty(ff.prototype,"latitude",{get:function(){return this.L_},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"longitude",{get:function(){return this.B_},enumerable:!1,configurable:!0}),ff.prototype.isEqual=function(t){return this.L_===t.L_&&this.B_===t.B_},ff.prototype.toJSON=function(){return{latitude:this.L_,longitude:this.B_}},ff.prototype.K=function(t){return ui(this.L_,t.L_)||ui(this.B_,t.B_)},ff),uf=/^__.*__$/,af=(lf.prototype.q_=function(t,e){return null!==this.zt?new pu(t,this.data,this.zt,e,this.fieldTransforms):new fu(t,this.data,e,this.fieldTransforms)},lf),cf=(hf.prototype.q_=function(t,e){return new pu(t,this.data,this.zt,e,this.fieldTransforms)},hf);function hf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function lf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function ff(t,e){if(!isFinite(t)||t<-90||90<t)throw new pi(fi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new pi(fi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.L_=t,this.B_=e}function pf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw ri()}}var df=(Object.defineProperty(gf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"Q_",{get:function(){return this.settings.Q_},enumerable:!1,configurable:!0}),gf.prototype.K_=function(t){return new gf(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},gf.prototype.j_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.K_({path:e,W_:!1});return e.G_(t),e},gf.prototype.z_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.K_({path:t,W_:!1});return t.U_(),t},gf.prototype.H_=function(t){return this.K_({path:void 0,W_:!0})},gf.prototype.J_=function(t){return Jf(t,this.settings.methodName,this.settings.Y_||!1,this.path,this.settings.X_)},gf.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},gf.prototype.U_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.G_(this.path.get(t))},gf.prototype.G_=function(t){if(0===t.length)throw this.J_("Document fields must not be empty");if(pf(this.Q_)&&uf.test(t))throw this.J_('Document fields cannot begin and end with "__"')},gf),yf=(vf.prototype.Z_=function(t,e,n,r){return void 0===r&&(r=!1),new df({Q_:t,methodName:e,X_:n,path:zi.at(),W_:!1,Y_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},vf);function vf(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||sh(t)}function gf(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.U_(),this.fieldTransforms=i||[],this.zt=o||[]}function mf(t){var e=t.x_(),n=sh(t.g_);return new yf(t.g_,!!e.ignoreUndefinedProperties,n)}function wf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Z_(o.merge||o.mergeFields?2:0,e,n,i);Hf("Data must be an object, but it was:",s,r);var u,a,r=qf(r,s);if(o.merge)u=new no(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=Bf(e,l[h],n);if(!s.contains(f))throw new pi(fi.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Kf(c,f)||c.push(f)}u=new no(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new af(new Ao(r),u,a)}var bf,_f=(l(Ef,bf=Rl),Ef.prototype.tf=function(t){if(2!==t.Q_)throw 1===t.Q_?t.J_(this._methodName+"() can only appear at the top level of your update data"):t.J_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},Ef.prototype.isEqual=function(t){return t instanceof Ef},Ef);function Ef(){return null!==bf&&bf.apply(this,arguments)||this}function Tf(t,e,n){return new df({Q_:3,X_:e.settings.X_,methodName:t._methodName,W_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var If,Af,Nf,Of,Sf=(l(xf,Of=Rl),xf.prototype.tf=function(t){return new nu(t.path,new Hs)},xf.prototype.isEqual=function(t){return t instanceof xf},xf),Df=(l(Pf,Nf=Rl),Pf.prototype.tf=function(t){var e=Tf(this,t,!0),n=this.ef.map(function(t){return Ff(t,e)}),n=new Bs(n);return new nu(t.path,n)},Pf.prototype.isEqual=function(t){return this===t},Pf),Lf=(l(kf,Af=Rl),kf.prototype.tf=function(t){var e=Tf(this,t,!0),n=this.ef.map(function(t){return Ff(t,e)}),n=new Ws(n);return new nu(t.path,n)},kf.prototype.isEqual=function(t){return this===t},kf),Rf=(l(Cf,If=Rl),Cf.prototype.tf=function(t){var e=new $s(t.Kt,Ms(t.Kt,this.nf));return new nu(t.path,e)},Cf.prototype.isEqual=function(t){return this===t},Cf);function Cf(t,e){var n=this;return(n=If.call(this,t)||this).nf=e,n}function kf(t,e){var n=this;return(n=Af.call(this,t)||this).ef=e,n}function Pf(t,e){var n=this;return(n=Nf.call(this,t)||this).ef=e,n}function xf(){return null!==Of&&Of.apply(this,arguments)||this}function Vf(t,r,i,e){var o=t.Z_(1,r,i);Hf("Data must be an object, but it was:",o,e);var s=[],u=new No;to(e,function(t,e){var n=zf(r,t,i);e instanceof yi&&(e=e._);t=o.z_(n);e instanceof _f?s.push(n):null!=(t=Ff(e,t))&&(s.push(n),u.set(n,t))});e=new no(s);return new cf(u.yt(),e,o.fieldTransforms)}function Uf(t,e,n,r,i,o){var s=t.Z_(1,e,n),u=[Bf(e,r,n)],a=[i];if(o.length%2!=0)throw new pi(fi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Bf(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new No,y=u.length-1;0<=y;--y){Kf(p,u[y])||(h=u[y],(l=a[y])instanceof yi&&(l=l._),f=s.z_(h),l instanceof _f?p.push(h):null!=(f=Ff(l,f))&&(p.push(h),d.set(h,f)))}i=new no(p);return new cf(d.yt(),i,s.fieldTransforms)}function Mf(t,e,n,r){return void 0===r&&(r=!1),Ff(n,t.Z_(r?4:3,e))}function Ff(s,t){if(s instanceof yi&&(s=s._),jf(s))return Hf("Unsupported field value:",t,s),qf(s,t);if(s instanceof Rl)return function(t,e){if(!pf(e.Q_))throw e.J_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.J_(t._methodName+"() is not currently supported inside arrays");t=t.tf(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.W_&&4!==t.Q_)throw t.J_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ff(i[r],t.H_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof yi&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ms(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ji.fromDate(t);return{timestampValue:ya(e.Kt,n)}}if(t instanceof ji)return n=new ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ya(e.Kt,n)};if(t instanceof sf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof di)return{bytesValue:va(e.Kt,t.l)};if(t instanceof Kl){n=e.T;var r=t.firestore.g_;if(!r.isEqual(n))throw e.J_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ma(t.firestore.g_||e.T,t.O_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.J_("Unsupported field value: "+ql(t))}(s,t)}function qf(t,n){var r={};return eo(t)?n.path&&0<n.path.length&&n.zt.push(n.path):to(t,function(t,e){e=Ff(e,n.j_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function jf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ji||t instanceof sf||t instanceof di||t instanceof Kl||t instanceof Rl)}function Hf(t,e,n){if(!jf(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=ql(n);throw"an object"===n?e.J_(t+" a custom object"):e.J_(t+" "+n)}var r}function Bf(t,e,n){if(e instanceof yi&&(e=e._),e instanceof Ll)return e.A_;if("string"==typeof e)return zf(t,e);throw Jf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Gf=new RegExp("[~\\*/\\[\\]]");function zf(e,n,r){if(0<=n.search(Gf))throw Jf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Ll.bind.apply(Ll,f([void 0],n.split("."))))).A_}catch(t){throw Jf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Jf(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new pi(fi.INVALID_ARGUMENT,(e+=". ")+t+n)}function Kf(t,e){return t.some(function(t){return t.isEqual(e)})}var Wf=(Zf.prototype.uf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),0<this.mutations.length)throw new pi(fi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ta((n=s).Kt)+"/documents",r={documents:u.map(function(t){return ba(n.Kt,t)})},[4,n.Fu("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Kt,"found"in(t=t)?function(t,e){ii(!!e.found),e.found.name,e.found.updateTime;var n=_a(t,e.found.name),t=ga(e.found.updateTime),e=new Ao({mapValue:{fields:e.found.fields}});return new Co(n,t,e,{})}(e,t):"missing"in t?function(t,e){ii(!!e.missing),ii(!!e.readTime);t=_a(t,e.missing),e=ga(e.readTime);return new ko(t,e)}(e,t):ri());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());ii(!!t),o.push(t)}),o)]}})})}(this.Nh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ko||t instanceof Co?n.lf(t):ri()}),e)]}})})},Zf.prototype.set=function(t,e){this.write(e.q_(t,this.Gt(t))),this.af.add(t.toString())},Zf.prototype.update=function(t,e){try{this.write(e.q_(t,this._f(t)))}catch(t){this.cf=t}this.af.add(t.toString())},Zf.prototype.delete=function(t){this.write(new Iu(t,this.Gt(t))),this.af.add(t.toString())},Zf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),this.cf)throw this.cf;return e=this.sf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ji.ft(e);n.mutations.push(new Au(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ta((e=i).Kt)+"/documents",r={writes:o.map(function(t){return Na(e.Kt,t)})},[4,e.Du("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nh,this.mutations)];case 1:return t.sent(),this.rf=!0,[2]}})})},Zf.prototype.lf=function(t){var e;if(t instanceof Co)e=t.version;else{if(!(t instanceof ko))throw ri();e=Hi.min()}var n=this.sf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new pi(fi.ABORTED,"Document version changed between two reads.")}else this.sf.set(t.key.toString(),e)},Zf.prototype.Gt=function(t){var e=this.sf.get(t.toString());return!this.af.has(t.toString())&&e?iu.updateTime(e):iu.jt()},Zf.prototype._f=function(t){var e=this.sf.get(t.toString());if(this.af.has(t.toString())||!e)return iu.exists(!0);if(e.isEqual(Hi.min()))throw new pi(fi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return iu.updateTime(e)},Zf.prototype.write=function(t){this.hf(),this.mutations.push(t)},Zf.prototype.hf=function(){},Zf),Xf=($f.prototype.run=function(){this.df()},$f.prototype.df=function(){var t=this;this.Yu.Qu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Wf(this.Nh),(n=this.wf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.Tf(t)})})}).catch(function(t){r.Tf(t)}),[2]})})})},$f.prototype.wf=function(t){try{var e=this.updateFunction(t);return!ho(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},$f.prototype.Tf=function(t){var e=this;0<this.ff&&this.Ef(t)?(--this.ff,this.fs.ys(function(){return e.df(),Promise.resolve()})):this.Es.reject(t)},$f.prototype.Ef=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Su(t)},$f),Yf=(Qf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,bu:this.bu,clientId:this.clientId,credentials:this.credentials,s_:this.user,Cl:100,xl:this.xl})]}})})},Qf.prototype.mf=function(t){var e=this;this.If=t,this.N.promise.then(function(){return e.If(e.user)})},Qf.prototype.Af=function(){if(this.fs.Rf)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.terminate=function(){var t=this;this.fs.Pf();var n=new xa;return this.fs.yf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.gf?[4,this.gf.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Vf?[4,this.Vf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ja(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Qf);function Qf(t,e,n,r){var i=this;this.credentials=t,this.fs=e,this.bu=n,this.xl=r,this.user=Ii.UNAUTHENTICATED,this.clientId=oi.t(),this.If=function(){},this.N=new xa,this.credentials.S(function(t){Zr("FirestoreClient","Received user=",t.uid),i.user=t,i.If(t),i.N.resolve()})}function $f(t,e,n,r){this.fs=t,this.Nh=e,this.updateFunction=n,this.Es=r,this.ff=5,this.Yu=new lh(this.fs,"transaction_retry")}function Zf(t){this.Nh=t,this.sf=new Map,this.mutations=[],this.rf=!1,this.cf=null,this.af=new Set}function tp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Vf?[3,2]:(Zr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.pf(),Zr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.s_,i.mf(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,dc(o.xh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.Vf=o,[2]}})})}(e,new Tl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Vf]}})})}function ep(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.gf?[3,2]:(Zr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.pf(),[4,tp(r)];case 1:return e=t.sent(),Zr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.mf(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.pf(),Zr("RemoteStore","RemoteStore received new credentials"),n=Lh(e),e.Mh.add(3),[4,Th(e)];case 1:return t.sent(),n&&e.Bh.set("Unknown"),[4,e.Fh.u_(i)];case 2:return t.sent(),e.Mh.delete(3),[4,Eh(e)];case 3:return t.sent(),[2]}})})}(i.vl,t)})}),r.gf=i,[2]}})})}(e,new Il)]);case 1:t.sent(),t.label=2;case 2:return[2,e.gf]}})})}function np(t){return tp(t).then(function(t){return t.persistence})}function rp(t){return tp(t).then(function(t){return t.xh})}function ip(t){return ep(t).then(function(t){return t.vl})}function op(t){return ep(t).then(function(t){return t.fa})}function sp(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ep(r)];case 1:return e=t.sent(),[2,((n=e.Sl).Yh=cl.bind(null,e.fa),n.tl=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ol.get(o),1<(r=e.kl.get(n.targetId)).length?[2,(e.kl.set(n.targetId,r.filter(function(t){return!Ds(t,o)})),void e.Ol.delete(o))]:e.jl?(e.Dl.$a(n.targetId),e.Dl.Ca(n.targetId)?[3,2]:[4,bc(e.xh,n.targetId,!1).then(function(){e.Dl.Ba(n.targetId),Ah(e.vl,n.targetId),vl(e,n.targetId)}).catch(Za)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return vl(e,n.targetId),[4,bc(e.xh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function up(n,r,i){var t=this;void 0===i&&(i={});var o=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Sl({next:function(t){r.ys(function(){return Gh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new pi(fi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new pi(fi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Jh(bs(i.path),t,{includeMetadataChanges:!0,cl:!0});return Bh(n,u)},[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function ap(n,r,i){var t=this;void 0===i&&(i={});var o=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Sl({next:function(t){n.ys(function(){return Gh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new pi(fi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Jh(t,o,{includeMetadataChanges:!0,cl:!0});return Bh(e,s)},[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var cp,hp=(Object.defineProperty(pp.prototype,"Rf",{get:function(){return this.Sf},enumerable:!1,configurable:!0}),pp.prototype.ys=function(t){this.enqueue(t)},pp.prototype.yf=function(t){this.Of(),this.kf(t)},pp.prototype.Pf=function(){var t;this.Sf||(this.Sf=!0,(t=oh())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ff))},pp.prototype.enqueue=function(t){return this.Of(),this.Sf?new Promise(function(t){}):this.kf(t)},pp.prototype.bo=function(t){var e=this;this.ys(function(){return e.vf.push(t),e.Mf()})},pp.prototype.Mf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.vf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.vf[0]()];case 2:return t.sent(),this.vf.shift(),this.Yu.reset(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Zr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.vf.length&&this.Yu.Qu(function(){return n.Mf()}),t.label=5;case 5:return[2]}})})},pp.prototype.kf=function(t){var r=this,e=this.bf.then(function(){return r.xf=!0,t().catch(function(t){throw r.Cf=t,r.xf=!1,ti("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xf=!1,t})});return this.bf=e},pp.prototype.Ir=function(t,e,n){var r=this;this.Of(),-1<this.Nf.indexOf(t)&&(e=0);n=Fa.Is(this,t,e,n,function(t){return r.$f(t)});return this.Df.push(n),n},pp.prototype.Of=function(){this.Cf&&ri()},pp.prototype.pf=function(){},pp.prototype.Lf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.bf];case 1:t.sent(),t.label=2;case 2:if(e!==this.bf)return[3,0];t.label=3;case 3:return[2]}})})},pp.prototype.Bf=function(t){for(var e=0,n=this.Df;e<n.length;e++)if(n[e].ds===t)return!0;return!1},pp.prototype.qf=function(r){var i=this;return this.Lf().then(function(){i.Df.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.Df;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Lf()})},pp.prototype.Uf=function(t){this.Nf.push(t)},pp.prototype.$f=function(t){t=this.Df.indexOf(t);this.Df.splice(t,1)},pp),lp=(l(fp,cp=Jl),fp.prototype.N_=function(){return this.jf||yp(this),this.jf.terminate()},fp);function fp(t,e,n){var r=this;return(r=cp.call(this,t,e)||this).Qf=n,r.Kf=new hp,r.R_="name"in t?t.name:"[DEFAULT]",r}function pp(){var e=this;this.bf=Promise.resolve(),this.vf=[],this.Sf=!1,this.Df=[],this.Cf=null,this.xf=!1,this.Nf=[],this.Yu=new lh(this,"async_queue_retry"),this.Ff=function(){var t=oh();t&&Zr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Yu.ju()};var t=oh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ff)}function dp(t){return t.jf||yp(t),t.jf.Af(),t.jf}function yp(t){var e,n,r=t.x_(),r=(e=t.g_,n=t.R_,new Ei(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.jf=new Yf(t.V_,t.Kf,r,t.Qf)}var vp,o=(_p.prototype.Wf=function(t,e){switch(void 0===e&&(e="none"),fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return so(t.integerValue||t.doubleValue);case 3:return this.Gf(t.timestampValue);case 4:return this.zf(t,e);case 5:return t.stringValue;case 6:return this.Hf(uo(t.bytesValue));case 7:return this.Jf(t.referenceValue);case 8:return this.Yf(t.geoPointValue);case 9:return this.Xf(t.arrayValue,e);case 10:return this.Zf(t.mapValue,e);default:throw ri()}},_p.prototype.Zf=function(t,n){var r=this,i={};return to(t.fields||{},function(t,e){i[t]=r.Wf(e,n)}),i},_p.prototype.Yf=function(t){return new sf(so(t.latitude),so(t.longitude))},_p.prototype.Xf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Wf(t,e)})},_p.prototype.zf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return ao(e)?t(e):e}(t);return null==n?null:this.Wf(n,e);case"estimate":return this.Gf(co(t));default:return null}},_p.prototype.Gf=function(t){t=oo(t);return new ji(t.seconds,t.nanos)},_p.prototype.td=function(t,e){var n=Bi.ct(t);ii(Pa(n));t=new Ti(n.get(1),n.get(3)),n=new Ji(n.X(5));return t.isEqual(e)||ti("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},_p),gp=(Object.defineProperty(bp.prototype,"id",{get:function(){return this.O_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(bp.prototype,"ref",{get:function(){return new Kl(this.ed,this.F_,this.O_)},enumerable:!1,configurable:!0}),bp.prototype.exists=function(){return null!==this.sd},bp.prototype.data=function(){if(this.sd){if(this.F_){var t=new mp(this.ed,this.nd,this.O_,this.sd,null);return this.F_.fromFirestore(t)}return this.nd.Wf(this.sd.vt())}},bp.prototype.get=function(t){if(this.sd){t=this.sd.data().field(Ep("DocumentSnapshot.get",t));if(null!==t)return this.nd.Wf(t)}},bp),mp=(l(wp,vp=gp),wp.prototype.data=function(){return vp.prototype.data.call(this)},wp);function wp(){return null!==vp&&vp.apply(this,arguments)||this}function bp(t,e,n,r,i){this.ed=t,this.nd=e,this.O_=n,this.sd=r,this.F_=i}function _p(){}function Ep(t,e){return"string"==typeof e?zf(t,e):(e instanceof yi?e._:e).A_}function Tp(t){if(Es(t)&&0===t.Nt.length)throw new pi(fi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Ke=function(){};function Ip(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].rd(t)}return t}var Ap,Np,Op,Sp,Dp,Lp=(l(Fp,Dp=Ke),Fp.prototype.rd=function(t){var e=mf(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Hp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(jp(n,t,c))}h={arrayValue:{values:s}}}else h=jp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Hp(o,i),h=Mf(e,"where",o,"in"===i||"not-in"===i);var h=Go.create(r,i,h);return function(t,e){if(e.xt()){var n=Is(t);if(null!==n&&!n.isEqual(e.field))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Ts(t);null!==n&&Bp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.M_,e,t.firestore.g_,this.od,this.ad,this.ud);return new Wl(t.firestore,t.F_,(t=t.M_,e=t.filters.concat([e]),new ws(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Fp),Rp=(l(Mp,Sp=Ke),Mp.prototype.rd=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new vs(e,n);return e=r,null!==Ts(n=t)||null!==(t=Is(n))&&Bp(0,t,e.field),r}(t.M_,this.od,this.hd);return new Wl(t.firestore,t.F_,(t=t.M_,e=t.Nt.concat([e]),new ws(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Mp),Cp=(l(Up,Op=Ke),Up.prototype.rd=function(t){return new Wl(t.firestore,t.F_,Ss(t.M_,this.ld,this._d))},Up),kp=(l(Vp,Np=Ke),Vp.prototype.rd=function(t){var e=qp(t,this.type,this.fd,this.dd);return new Wl(t.firestore,t.F_,(t=t.M_,e=e,new ws(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Vp),Pp=(l(xp,Ap=Ke),xp.prototype.rd=function(t){var e=qp(t,this.type,this.fd,this.dd);return new Wl(t.firestore,t.F_,(t=t.M_,e=e,new ws(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},xp);function xp(t,e,n){var r=this;return(r=Ap.call(this)||this).type=t,r.fd=e,r.dd=n,r}function Vp(t,e,n){var r=this;return(r=Np.call(this)||this).type=t,r.fd=e,r.dd=n,r}function Up(t,e,n){var r=this;return(r=Op.call(this)||this).type=t,r.ld=e,r._d=n,r}function Mp(t,e){var n=this;return(n=Sp.call(this)||this).od=t,n.hd=e,n.type="orderBy",n}function Fp(t,e,n){var r=this;return(r=Dp.call(this)||this).od=t,r.ad=e,r.ud=n,r.type="where",r}function qp(t,c,e,n){if(e[0]instanceof yi&&(e[0]=e[0]._),e[0]instanceof gp)return function(t,e,n,r){if(!n)throw new pi(fi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Ns(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(wo(e,n.key));else{var a=n.field(u.field);if(ao(a))throw new pi(fi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.ot();throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new hs(i,r)}(t.M_,t.firestore.g_,e[0].sd,n);var r=mf(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new pi(fi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!As(t)&&-1!==c.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Bi.ct(c));if(!Ji.Tt(h))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Ji(h);u.push(wo(e,h))}else{c=Mf(n,r,c);u.push(c)}}return new hs(u,o)}(t.M_,t.firestore.g_,r,c,e,n)}function jp(t,e,n){if(n instanceof yi&&(n=n._),"string"==typeof n){if(""===n)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!As(e)&&-1!==n.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Bi.ct(n));if(!Ji.Tt(e))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return wo(t,new Ji(e))}if(n instanceof Kl)return wo(t,n.O_);throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ql(n)+".")}function Hp(t,e){if(!Array.isArray(t)||0===t.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Bp(t,e,n){if(!n.isEqual(e))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Gp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function zp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Jp,Kp,Wp,Xp=(l(id,Wp=o),id.prototype.Hf=function(t){return new di(t)},id.prototype.Jf=function(t){t=this.td(t,this.firestore.g_);return new Kl(this.firestore,null,t)},id),Yp=(rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},rd),Qp=(l(nd,Kp=gp),nd.prototype.exists=function(){return Kp.prototype.exists.call(this)},nd.prototype.data=function(t){if(void 0===t&&(t={}),this.sd){if(this.F_){var e=new $p(this.ed,this.nd,this.O_,this.sd,this.metadata,null);return this.F_.fromFirestore(e,t)}return this.nd.Wf(this.sd.vt(),t.serverTimestamps)}},nd.prototype.get=function(t,e){if(void 0===e&&(e={}),this.sd){t=this.sd.data().field(Ep("DocumentSnapshot.get",t));if(null!==t)return this.nd.Wf(t,e.serverTimestamps)}},nd),$p=(l(ed,Jp=Qp),ed.prototype.data=function(t){return void 0===t&&(t={}),Jp.prototype.data.call(this,t)},ed),Zp=(Object.defineProperty(td.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"size",{get:function(){return this.Td.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),td.prototype.forEach=function(e,n){var r=this;this.Td.docs.forEach(function(t){e.call(n,new $p(r.ed,r.nd,t.key,t,new Yp(r.Td.Ce.has(t.key),r.Td.fromCache),r.query.F_))})},td.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Td.Ne)throw new pi(fi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ed&&this.Id===t||(this.Ed=function(i,e){if(i.Td.De.nt()){var n=0;return i.Td.docChanges.map(function(t){var e=new $p(i.ed,i.nd,t.doc.key,t.doc,new Yp(i.Td.Ce.has(t.doc.key),i.Td.fromCache),i.query.F_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Td.De;return i.Td.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new $p(i.ed,i.nd,t.doc.key,t.doc,new Yp(i.Td.Ce.has(t.doc.key),i.Td.fromCache),i.query.F_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ri()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Id=t),this.Ed},td);function td(t,e,n,r){this.ed=t,this.nd=e,this.Td=r,this.metadata=new Yp(r.hasPendingWrites,r.fromCache),this.query=n}function ed(){return null!==Jp&&Jp.apply(this,arguments)||this}function nd(t,e,n,r,i,o){var s=this;return(s=Kp.call(this,t,e,n,r,o)||this).ed=t,s.wd=t,s.metadata=i,s}function rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function id(t){var e=this;return(e=Wp.call(this)||this).firestore=t,e}function od(t,e){return t instanceof Qp&&e instanceof Qp?t.ed===e.ed&&t.O_.isEqual(e.O_)&&(null===t.sd?null===e.sd:t.sd.isEqual(e.sd))&&t.F_===e.F_:t instanceof Zp&&e instanceof Zp&&t.ed===e.ed&&of(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Td.isEqual(e.Td)}var sd,ud=(l(ad,sd=o),ad.prototype.Hf=function(t){return new di(t)},ad.prototype.Jf=function(t){t=this.td(t,this.firestore.g_);return new Kl(this.firestore,null,t)},ad);function ad(t){var e=this;return(e=sd.call(this)||this).firestore=t,e}function cd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=jl(t,Kl);var o=jl(t.firestore,lp),s=mf(o);return e instanceof yi&&(e=e._),ld(o,[("string"==typeof e||e instanceof Ll?Uf(s,"updateDoc",t.O_,e,n,r):Vf(s,"updateDoc",t.O_,e)).q_(t.O_,iu.exists(!0))])}function hd(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof yi&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Gp(n[i])||(r=n[i],i++);var o,s,u,a,c,h,l={includeMetadataChanges:r.includeMetadataChanges};return Gp(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Kl?(u=jl(e.firestore,lp),a=bs(e.O_.path),h={next:function(t){n[i]&&n[i](fd(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=jl(e,Wl),u=jl(s.firestore,lp),a=s.M_,c=new ud(u),h={next:function(t){n[i]&&n[i](new Zp(u,c,s,t))},error:n[i+1],complete:n[i+2]},Tp(e.M_)),function(n,t,e){var r=this,i=new Sl(h),o=new Jh(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Bh,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.l_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Gh,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(dp(u),a,l)}function ld(t,e){return function(n,r){var t=this,i=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hl,[4,op(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(dp(t),e)}function fd(t,e,n){var r=n.docs.get(e.O_),i=new ud(t);return new Qp(t,i,e.O_,r,new Yp(n.hasPendingWrites,n.fromCache),e.F_)}var pd=(dd.prototype.set=function(t,e,n){this.yd();t=yd(t,this.ed),e=zp(t.F_,e,n),n=wf(this.Pd,"WriteBatch.set",t.O_,e,null!==t.F_,n);return this.Ad.push(n.q_(t.O_,iu.jt())),this},dd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.yd();t=yd(t,this.ed);return e instanceof yi&&(e=e._),e="string"==typeof e||e instanceof Ll?Uf(this.Pd,"WriteBatch.update",t.O_,e,n,r):Vf(this.Pd,"WriteBatch.update",t.O_,e),this.Ad.push(e.q_(t.O_,iu.exists(!0))),this},dd.prototype.delete=function(t){this.yd();t=yd(t,this.ed);return this.Ad=this.Ad.concat(new Iu(t.O_,iu.jt())),this},dd.prototype.commit=function(){return this.yd(),this.Rd=!0,0<this.Ad.length?this.md(this.Ad):Promise.resolve()},dd.prototype.yd=function(){if(this.Rd)throw new pi(fi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},dd);function dd(t,e){this.ed=t,this.md=e,this.Ad=[],this.Rd=!1,this.Pd=mf(t)}function yd(t,e){if(t instanceof yi&&(t=t._),t.firestore!==e)throw new pi(fi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var vd,gd,md,wd=(Sd.prototype.get=function(t){var e=this,n=yd(t,this.ed),r=new Xp(this.ed);return this.gd.uf([n.O_]).then(function(t){if(!t||1!==t.length)return ri();t=t[0];if(t instanceof ko)return new gp(e.ed,r,n.O_,null,n.F_);if(t instanceof Co)return new gp(e.ed,r,t.key,t,n.F_);throw ri()})},Sd.prototype.set=function(t,e,n){t=yd(t,this.ed),e=zp(t.F_,e,n),n=wf(this.Pd,"Transaction.set",t.O_,e,null!==t.F_,n);return this.gd.set(t.O_,n),this},Sd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=yd(t,this.ed);return e instanceof yi&&(e=e._),e="string"==typeof e||e instanceof Ll?Uf(this.Pd,"Transaction.update",t.O_,e,n,r):Vf(this.Pd,"Transaction.update",t.O_,e),this.gd.update(t.O_,e),this},Sd.prototype.delete=function(t){t=yd(t,this.ed);return this.gd.delete(t.O_),this},l(Od,md=Sd),Od.prototype.get=function(t){var e=this,n=yd(t,this.ed),r=new ud(this.ed);return md.prototype.get.call(this,t).then(function(t){return new Qp(e.ed,r,n.O_,t.sd,new Yp(!1,!1),n.F_)})},Od),bd="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",_d=(Nd.prototype.enableIndexedDbPersistence=function(t,e){throw new pi(fi.FAILED_PRECONDITION,bd)},Nd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new pi(fi.FAILED_PRECONDITION,bd)},Nd.prototype.clearIndexedDbPersistence=function(t){throw new pi(fi.FAILED_PRECONDITION,bd)},Nd),Ed=(l(Ad,gd=yi),Object.defineProperty(Ad.prototype,"g_",{get:function(){return this._.g_},enumerable:!1,configurable:!0}),Ad.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.C_()),t)).merge,this._.D_(t)},Ad.prototype.useEmulator=function(t,e){var n,r;n=this._,r=t,t=e,"firestore.googleapis.com"!==(e=(n=jl(n,Jl)).C_()).host&&e.host!==r&&ei("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.D_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},Ad.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[4,ip(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Mh.delete(0),Eh(t))]}})})})}(dp(jl(this._,lp)))},Ad.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[4,ip(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mh.add(0),[4,Th(e)];case 1:return t.sent(),e.Bh.set("Offline"),[2]}})})}(n))]}})})})}(dp(jl(this._,lp)))},Ad.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ul("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Vd.enableMultiTabIndexedDbPersistence(this):this.Vd.enableIndexedDbPersistence(this,n)},Ad.prototype.clearPersistence=function(){return this.Vd.clearIndexedDbPersistence(this)},Ad.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Ad.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=pl,[4,op(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(dp(jl(this._,lp)))},Ad.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new Sl(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Jh.add(e),e.next()},[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.l_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Jh.delete(e)},[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(dp(jl(e,lp)),Gp(t)?t:{next:t});var e},Object.defineProperty(Ad.prototype,"app",{get:function(){if(!this.pd)throw new pi(fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pd},enumerable:!1,configurable:!0}),Ad.prototype.collection=function(t){try{return new $d(this,ef(this._,t))}catch(t){throw Md(t,"collection()","Firestore.collection()")}},Ad.prototype.doc=function(t){try{return new Pd(this,nf(this._,t))}catch(t){throw Md(t,"doc()","Firestore.doc()")}},Ad.prototype.collectionGroup=function(t){try{return new Xd(this,function(t,e){if(t=jl(t,Jl),xl("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Wl(t,null,(e=e,new ws(Bi.at(),e)))}(this._,t))}catch(t){throw Md(t,"collectionGroup()","Firestore.collectionGroup()")}},Ad.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,ep(n).then(function(t){return t.Nh})];case 1:return e=t.sent(),new Xf(n.fs,e,r,i).run(),[2]}})})}),i.promise}(dp(n=this._),function(t){return t=new wd(n,t),e(new Cd(r,t))})},Ad.prototype.batch=function(){var e=this;return dp(this._),new kd(new pd(this._,function(t){return ld(e._,t)}))},Ad.prototype.loadBundle=function(t){throw new pi(fi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Ad.prototype.namedQuery=function(t){throw new pi(fi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Ad),Td=(l(Id,vd=o),Id.prototype.Hf=function(t){return new _i(new di(t))},Id.prototype.Jf=function(t){t=this.td(t,this.firestore.g_);return Pd.bd(t,this.firestore,null)},Id);function Id(t){var e=this;return(e=vd.call(this)||this).firestore=t,e}function Ad(t,e,n){var r=this;return(r=gd.call(this,e)||this).Vd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ti||(r.pd=t),r}function Nd(){}function Od(t,e){var n=this;return(n=md.call(this,t,e)||this).ed=t,n}function Sd(t,e){this.ed=t,this.gd=e,this.Pd=mf(t)}var Dd,Ld,Rd,Cd=(l(Ud,Rd=yi),Ud.prototype.get=function(t){var e=this,n=oy(t);return this._.get(n).then(function(t){return new Kd(e.ed,new Qp(e.ed._,e.nd,t.O_,t.sd,t.metadata,n.F_))})},Ud.prototype.set=function(t,e,n){t=oy(t);return n?(Vl("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Ud.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=oy(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Ud.prototype.delete=function(t){t=oy(t);return this._.delete(t),this},Ud),kd=(l(Vd,Ld=yi),Vd.prototype.set=function(t,e,n){t=oy(t);return n?(Vl("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Vd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=oy(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Vd.prototype.delete=function(t){t=oy(t);return this._.delete(t),this},Vd.prototype.commit=function(){return this._.commit()},Vd),Pd=(l(xd,Dd=yi),xd.vd=function(t,e,n){if(t.length%2!=0)throw new pi(fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new xd(e,new Kl(e._,n,new Ji(t)))},xd.bd=function(t,e,n){return new xd(e,new Kl(e._,n,t))},Object.defineProperty(xd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(xd.prototype,"parent",{get:function(){return new $d(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(xd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),xd.prototype.collection=function(t){try{return new $d(this.firestore,ef(this._,t))}catch(t){throw Md(t,"collection()","DocumentReference.collection()")}},xd.prototype.isEqual=function(t){return t instanceof yi&&(t=t._),t instanceof Kl&&rf(this._,t)},xd.prototype.set=function(t,e){e=Vl("DocumentReference.set",e);try{return function(t,e,n){t=jl(t,Kl);var r=jl(t.firestore,lp),e=zp(t.F_,e,n);return ld(r,[wf(mf(r),"setDoc",t.O_,e,null!==t.F_,n).q_(t.O_,iu.jt())])}(this._,t,e)}catch(t){throw Md(t,"setDoc()","DocumentReference.set()")}},xd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?cd(this._,t):cd.apply(void 0,f([this._,t,e],n))}catch(t){throw Md(t,"updateDoc()","DocumentReference.update()")}},xd.prototype.delete=function(){return ld(jl((t=this._).firestore,lp),[new Iu(t.O_,iu.jt())]);var t},xd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Fd(t),i=qd(t,function(t){return new Kd(e.firestore,new Qp(e.firestore._,e.nd,t.O_,t.sd,t.metadata,e._.F_))});return hd(this._,r,i)},xd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=jl(e,Kl);var n=jl(e.firestore,lp),t=dp(n),r=new ud(n);return function(n,r){var t=this,i=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof Co?u.resolve(i):i instanceof ko?u.resolve(null):u.reject(new pi(fi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=ja(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,rp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.O_).then(function(t){return new Qp(n,r,e.O_,t,new Yp(t instanceof Co&&t.bt,!0),e.F_)})}:"server"===(null==t?void 0:t.source)?function(e){e=jl(e,Kl);var n=jl(e.firestore,lp);return up(dp(n),e.O_,{source:"server"}).then(function(t){return fd(n,e,t)})}:function(e){e=jl(e,Kl);var n=jl(e.firestore,lp);return up(dp(n),e.O_).then(function(t){return fd(n,e,t)})})(this._).then(function(t){return new Kd(e.firestore,new Qp(e.firestore._,e.nd,t.O_,t.sd,t.metadata,e._.F_))})},xd.prototype.withConverter=function(t){return new xd(this.firestore,this._.withConverter(t))},xd);function xd(t,e){var n=this;return(n=Dd.call(this,e)||this).firestore=t,n.nd=new Td(t),n}function Vd(){return null!==Ld&&Ld.apply(this,arguments)||this}function Ud(t,e){var n=this;return(n=Rd.call(this,e)||this).ed=t,n.nd=new Td(t),n}function Md(t,e,n){return t.message=t.message.replace(e,n),t}function Fd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Gp(r))return r}return{}}function qd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Gp(t[0])?t[0]:Gp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var jd,Hd,Bd,Gd,zd,Jd,Kd=(l(iy,Jd=yi),Object.defineProperty(iy.prototype,"ref",{get:function(){return new Pd(this.ed,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(iy.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(iy.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(iy.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),iy.prototype.data=function(t){return this._.data(t)},iy.prototype.get=function(t,e){return this._.get(t,e)},iy.prototype.isEqual=function(t){return od(this._,t._)},iy),Wd=(l(ry,zd=Kd),ry.prototype.data=function(t){return this._.data(t)},ry),Xd=(l(ny,Gd=yi),ny.prototype.where=function(t,e,n){try{return new ny(this.firestore,Ip(this._,(r=n,i=e,o=Ep("where",t),new Lp(o,i,r))))}catch(t){throw Md(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},ny.prototype.orderBy=function(n,t){try{return new ny(this.firestore,Ip(this._,function(t){void 0===t&&(t="asc");var e=t,t=Ep("orderBy",n);return new Rp(t,e)}(t)))}catch(n){throw Md(n,/(orderBy|where)\(\)/,"Query.$1()")}},ny.prototype.limit=function(t){try{return new ny(this.firestore,Ip(this._,(Hl("limit",e=t),new Cp("limit",e,"F"))))}catch(t){throw Md(t,"limit()","Query.limit()")}var e},ny.prototype.limitToLast=function(t){try{return new ny(this.firestore,Ip(this._,(Hl("limitToLast",e=t),new Cp("limitToLast",e,"L"))))}catch(t){throw Md(t,"limitToLast()","Query.limitToLast()")}var e},ny.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ny(this.firestore,Ip(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Md(t,"startAt()","Query.startAt()")}},ny.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ny(this.firestore,Ip(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Md(t,"startAfter()","Query.startAfter()")}},ny.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ny(this.firestore,Ip(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Md(t,"endBefore()","Query.endBefore()")}},ny.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ny(this.firestore,Ip(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Md(t,"endAt()","Query.endAt()")}},ny.prototype.isEqual=function(t){return of(this._,t._)},ny.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=jl(e,Wl);var n=jl(e.firestore,lp),t=dp(n),r=new ud(n);return function(n,r){var t=this,i=new xa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,_c(i,o,!0)];case 1:return r=t.sent(),e=new rl(o,r.Pc),n=e.Il(r.documents),n=e.Ti(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=ja(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,rp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.M_).then(function(t){return new Zp(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=jl(e,Wl);var n=jl(e.firestore,lp),t=dp(n),r=new ud(n);return ap(t,e.M_,{source:"server"}).then(function(t){return new Zp(n,r,e,t)})}:function(e){e=jl(e,Wl);var n=jl(e.firestore,lp),t=dp(n),r=new ud(n);return Tp(e.M_),ap(t,e.M_).then(function(t){return new Zp(n,r,e,t)})})(this._).then(function(t){return new Qd(e.firestore,new Zp(e.firestore._,e.nd,e._,t.Td))})},ny.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Fd(t),i=qd(t,function(t){return new Qd(e.firestore,new Zp(e.firestore._,e.nd,e._,t.Td))});return hd(this._,r,i)},ny.prototype.withConverter=function(t){return new ny(this.firestore,this._.withConverter(t))},ny),Yd=(l(ey,Bd=yi),Object.defineProperty(ey.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"doc",{get:function(){return new Wd(this.ed,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),ey),Qd=(l(ty,Hd=yi),Object.defineProperty(ty.prototype,"query",{get:function(){return new Xd(this.ed,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(ty.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Wd(e.ed,t)})},enumerable:!1,configurable:!0}),ty.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Yd(e.ed,t)})},ty.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Wd(r.ed,t))})},ty.prototype.isEqual=function(t){return od(this._,t._)},ty),$d=(l(Zd,jd=Xd),Object.defineProperty(Zd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Zd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Zd.prototype,"parent",{get:function(){var t=this._.parent;return t?new Pd(this.firestore,t):null},enumerable:!1,configurable:!0}),Zd.prototype.doc=function(t){try{return new Pd(this.firestore,void 0===t?nf(this._):nf(this._,t))}catch(t){throw Md(t,"doc()","CollectionReference.doc()")}},Zd.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=jl(e.firestore,lp),r=nf(e),n=zp(e.F_,n),ld(t,[wf(mf(e.firestore),"addDoc",r.O_,n,null!==e.F_,{}).q_(r.O_,iu.exists(!1))]).then(function(){return r}).then(function(t){return new Pd(i.firestore,t)})},Zd.prototype.isEqual=function(t){return rf(this._,t._)},Zd.prototype.withConverter=function(t){return new Zd(this.firestore,this._.withConverter(t))},Zd);function Zd(t,e){var n=this;return(n=jd.call(this,t,e)||this).firestore=t,n._=e,n}function ty(t,e){var n=this;return(n=Hd.call(this,e)||this).ed=t,n}function ey(t,e){var n=this;return(n=Bd.call(this,e)||this).ed=t,n}function ny(t,e){var n=this;return(n=Gd.call(this,e)||this).firestore=t,n.nd=new Td(t),n}function ry(){return null!==zd&&zd.apply(this,arguments)||this}function iy(t,e){var n=this;return(n=Jd.call(this,e)||this).ed=t,n}function oy(t){return t instanceof yi&&(t=t._),jl(t,Kl)}var sy,uy,Ke=(l(ly,uy=yi),ly.documentId=function(){return new ly(zi.lt().ot())},ly.prototype.isEqual=function(t){return t instanceof yi&&(t=t._),t instanceof Ll&&this._.A_.isEqual(t.A_)},ly),o=(l(hy,sy=yi),hy.serverTimestamp=function(){var t=new Sf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new hy(t)},hy.delete=function(){var t=new _f("deleteField");return t._methodName="FieldValue.delete",new hy(t)},hy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Df("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new hy(n)},hy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new hy(n)},hy.increment=function(t){t=new Rf("increment",t);return t._methodName="FieldValue.increment",new hy(t)},hy.prototype.isEqual=function(t){return this._.isEqual(t._)},hy),ay=(cy.prototype.onProgress=function(t,e,n){this.Sd={next:t,error:e,complete:n}},cy.prototype.catch=function(t){return this.Dd.promise.catch(t)},cy.prototype.then=function(t,e){return this.Dd.promise.then(t,e)},cy.prototype.zl=function(t){this.Hl(t),this.Sd.complete&&this.Sd.complete(),this.Dd.resolve(t)},cy.prototype.Yl=function(t){this.Cd.taskState="Error",this.Sd.next&&this.Sd.next(this.Cd),this.Sd.error&&this.Sd.error(t),this.Dd.reject(t)},cy.prototype.Hl=function(t){this.Cd=t,this.Sd.next&&this.Sd.next(t)},cy);function cy(){this.Sd={},this.Dd=new xa,this.Cd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function hy(){return null!==sy&&sy.apply(this,arguments)||this}function ly(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return uy.call(this,new(Ll.bind.apply(Ll,f([void 0],t))))||this}function fy(t,s){var e=new ay;return function(n,t,r){var e,i=this,o=(e=s,t=sh(t),e=function(t){if(t instanceof Uint8Array)return Ol(t,void 0);if(t instanceof ArrayBuffer)return Ol(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Dl(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=El,[4,op(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(dp(t._),t.g_,e),e}var py=(dy.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},dy.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},dy.prototype.setServiceProps=function(t){return this.serviceProps=t,this},dy);function dy(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var yy,vy,gy={Firestore:Ed,GeoPoint:sf,Timestamp:ji,Blob:_i,Transaction:Cd,WriteBatch:kd,DocumentReference:Pd,DocumentSnapshot:Kd,Query:Xd,QueryDocumentSnapshot:Wd,QuerySnapshot:Qd,CollectionReference:$d,FieldPath:Ke,FieldValue:o,setLogLevel:function(t){Qr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(yy=e.default).INTERNAL.registerComponent(new py("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Ed(e,new lp(e,t),new _d)},"PUBLIC").setServiceProps(Object.assign({},gy))),yy.registerVersion("@firebase/firestore","2.1.2-longpoll.66863f547"),(vy=Ed).prototype.loadBundle=function(t){return fy(this,t)},vy.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.To.Ls(t,e)})},[4,rp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(dp((e=this)._),t).then(function(t){return t?new Xd(e,new Wl(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
