!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function($d){"use strict";try{(function(){var u,t,e=(t=$d)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(je=u=u||{})[je.DEBUG=0]="DEBUG",je[je.VERBOSE=1]="VERBOSE",je[je.INFO=2]="INFO",je[je.WARN=3]="WARN",je[je.ERROR=4]="ERROR",je[je.SILENT=5]="SILENT";var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((He={})[u.DEBUG]="log",He[u.VERBOSE]="log",He[u.INFO]="info",He[u.WARN]="warn",He[u.ERROR]="error",He),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function l(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(l(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function O(){}function S(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),R=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function k(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function P(t,e,n){return(P=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:k).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function U(t,o){function e(){}e.prototype=o.prototype,t.Y=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}var M=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function q(){return Array.prototype.concat.apply([],arguments)}function j(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var B=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function G(t,e){return-1!=t.indexOf(e)}function z(t,e){return t<e?-1:e<t?1:0}var J=N.navigator;function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function W(t){var e,n={};for(e in t)n[e]=t[e];return n}st=(J=J&&J.userAgent)?J:"";var X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<X.length;i++)e=X[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Q(t){return Q[" "](t),t}Q[" "]=O;var $,Z=G(st,"Opera"),tt=G(st,"Trident")||G(st,"MSIE"),et=G(st,"Edge"),nt=et||tt,rt=G(st,"Gecko")&&!(G(st.toLowerCase(),"webkit")&&!G(st,"Edge"))&&!(G(st,"Trident")||G(st,"MSIE"))&&!G(st,"Edge"),it=G(st.toLowerCase(),"webkit")&&!G(st,"Edge");function ot(){var t=N.document;return t?t.documentMode:void 0}var J="",st=(st=st,rt?/rv:([^\);]+)(\)|;)/.exec(st):et?/Edge\/([\d\.]+)/.exec(st):tt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):it?/WebKit\/(\S+)/.exec(st):Z?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);st&&(J=st?st[1]:""),$=tt&&null!=(st=ot())&&st>parseFloat(J)?String(st):J;var ut={};function at(u){return t=u,e=function(){for(var t=0,e=B(String($)).split("."),n=B(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||z(0==o[2].length,0==s[2].length)||z(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ut,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ct=N.document&&tt&&(ot()||parseInt($,10))||void 0;function ht(t,e,n){this.reset(t,e,n,void 0,void 0)}function lt(t){this.g=t,this.a=this.f=this.b=this.c=null}function ft(t,e){this.name=t,this.value=e}ht.prototype.a=null,ht.prototype.reset=function(t,e,n,r,i){this.c=r||V(),this.f=t,this.g=e,this.b=n,delete this.a},ft.prototype.toString=function(){return this.name};var pt=new ft("SEVERE",1e3),dt=new ft("WARNING",900),yt=new ft("INFO",800),vt=new ft("CONFIG",700),gt=new ft("FINE",500);lt.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.b||(e.c?t(e.c):null)}(this).value)for("function"==typeof e&&(e=e()),t=new ht(t,String(e),this.g),n&&(t.a=n),n=this;n;){var r=n,i=t;if(r.a)for(var o=0;e=r.a[o];o++)e(i);n=n.c}},lt.prototype.info=function(t,e){this.log(yt,t,e)};var mt={},wt=null;function bt(t){var e,n,r;return wt||(wt=new lt(""),(mt[""]=wt).b=vt),(e=mt[t])||(e=new lt(t),r=t.lastIndexOf("."),n=t.substr(r+1),(r=bt(t.substr(0,r))).f||(r.f={}),(r.f[n]=e).c=r,mt[t]=e),e}function _t(){this.a=V()}var Et=null;function Tt(t){this.f=t||"",Et=Et||new _t,this.g=Et}function It(t){return t<10?"0"+t:String(t)}function At(t){Tt.call(this,t)}function Nt(t,e){t&&t.log(dt,e,void 0)}function Ot(t,e){t&&t.info(e,void 0)}function St(t,e){t&&t.log(gt,e,void 0)}function Dt(){this.g=P(this.c,this),this.a=new At,this.a.b=!1,this.a.c=!1,this.b=this.a.a=!1,this.f={}}_t.prototype.set=function(t){this.a=t},_t.prototype.reset=function(){this.set(V())},_t.prototype.get=function(){return this.a},Tt.prototype.a=!0,Tt.prototype.b=!0,Tt.prototype.c=!1,U(At,Tt),Dt.prototype.c=function(t){var e,n,r,i;this.f[t.b]||(e=this.a,n=t,(i=[]).push(e.f," "),e.b&&(r=new Date(n.c),i.push("[",It(r.getFullYear()-2e3)+It(r.getMonth()+1)+It(r.getDate())+" "+It(r.getHours())+":"+It(r.getMinutes())+":"+It(r.getSeconds())+"."+It(Math.floor(r.getMilliseconds()/10)),"] ")),i.push("[",function(t,e){e=(t=(t.c-e)/1e3).toFixed(3);var n=0;if(t<1)n=2;else for(;t<100;)n++,t*=10;for(;0<n--;)e=" "+e;return e}(n,e.g.get()),"s] "),i.push("[",n.b,"] "),i.push(n.g),e.c&&(n=n.a)&&i.push("\n",n instanceof Error?n.message:n.toString()),e.a&&i.push("\n"),n=i.join(""),Lt&&(e=function(t){if(t){if(t.value>=pt.value)return"error";if(t.value>=dt.value)return"warn";if(t.value>=vt.value)return"log"}return"debug"}(t.f),i=Lt,t=t.a,i[e]?i[e](n,t||""):i.log(n,t||"")))};var Lt=N.console;function Rt(){this.m=this.m,this.j=this.j}Rt.prototype.m=!1,Rt.prototype.ja=function(){!this.m&&(this.m=!0,this.H(),0)&&(Object.prototype.hasOwnProperty.call(this,L)&&this[L]||(this[L]=++R))},Rt.prototype.H=function(){if(this.j)for(;this.j.length;)this.j.shift()()};var Ct=!tt||9<=Number(ct),kt=tt&&!at("9"),Pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",O,e),N.removeEventListener("test",O,e)}catch(t){}return t}();function xt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Vt(t,e){if(xt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(rt){t:{try{Q(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ut[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}xt.prototype.b=function(){this.defaultPrevented=!0},U(Vt,xt);var Ut={2:"touch",3:"pen",4:"mouse"};Vt.prototype.b=function(){Vt.Y.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,kt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Mt="closure_listenable_"+(1e6*Math.random()|0),Ft=0;function qt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Ft,this.Z=this.$=!1}function jt(t){t.Z=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ht(t){this.src=t,this.a={},this.b=0}function Bt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=M(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(jt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Gt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Z&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Gt(t,e,r,i);return-1<s?(e=t[s],n||(e.$=!1)):((e=new qt(e,this.src,o,!!r,i)).$=n,t.push(e)),e};var zt="closure_lm_"+(1e6*Math.random()|0),Jt={};function Kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=ee(r),e&&e[Mt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Wt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kt(t,e[o],n,r,i);return null}return n=ee(n),t&&t[Mt]?t.va(e,n,D(r)?!!r.capture:!!r,i):Wt(t,e,n,!1,r,i)}function Wt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!Ct)return null;var u,a,c=Zt(t);if(c||(t[zt]=c=new Ht(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=$t,r=a=Ct?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Yt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Xt(t){var e,n,r;"number"!=typeof t&&t&&!t.Z&&((e=t.src)&&e[Mt]?Bt(e.f,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Yt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Zt(e))?(Bt(n,t),0==n.b&&(n.src=null,e[zt]=null)):jt(t)))}function Yt(t){return t in Jt?Jt[t]:Jt[t]="on"+t}function Qt(t,e){var n=t.listener,r=t.ca||t.src;return t.$&&Xt(t),n.call(r,e)}function $t(t,e){if(t.Z)return!0;if(Ct)return Qt(t,new Vt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Qt(t,e=new Vt(e,this))}function Zt(t){return(t=t[zt])instanceof Ht?t:null}var te="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(e){return"function"==typeof e?e:(e[te]||(e[te]=function(t){return e.handleEvent(t)}),e[te])}function ne(){Rt.call(this),this.f=new Ht(this),(this.L=this).F=null}function re(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.L,r=e.type||e,"string"==typeof e?e=new xt(e,t):e instanceof xt?e.target=e.target||t:(s=e,Y(e=new xt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=ie(o,r,!0,e)&&s;if(s=ie(o=e.a=t,r,!0,e)&&s,s=ie(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=ie(o=e.a=n[i],r,!1,e)&&s}function ie(t,e,n,r){if(!(e=t.f.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Z&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.$&&Bt(t.f,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(ne,Rt),ne.prototype[Mt]=!0,(st=ne.prototype).addEventListener=function(t,e,n,r){Kt(this,t,e,n,r)},st.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=ee(r),e&&e[Mt]?(e=e.f,(n=String(n).toString())in e.a&&-1<(r=Gt(s=e.a[n],r,i,o))&&(jt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Zt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Gt(n,r,i,o)),(r=-1<e?n[e]:null)&&Xt(r))}(this,t,e,n,r)},st.H=function(){if(ne.Y.H.call(this),this.f){var t,e=this.f;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)jt(n[r]);delete e.a[t],e.b--}}this.F=null},st.va=function(t,e,n,r){return this.f.add(String(t),e,!1,n,r)},st.wa=function(t,e,n,r){return this.f.add(String(t),e,!0,n,r)};var oe=N.JSON.stringify;function se(){this.b=this.a=null}var ue,ae=(ce.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new ce(function(){return new he},function(t){t.reset()}));function ce(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function he(){this.next=this.b=this.a=null}function le(t,e){var n;ue||(n=N.Promise.resolve(void 0),ue=function(){n.then(de)}),fe||(ue(),fe=!0),pe.add(t,e)}se.prototype.add=function(t,e){var n=ae.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},he.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var fe=!(he.prototype.reset=function(){this.next=this.b=this.a=null}),pe=new se;function de(){for(var t,e;n=e=void 0,n=null,(e=pe).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=ae;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}fe=!1}function ye(t,e){ne.call(this),this.b=t||1,this.a=e||N,this.c=P(this.Za,this),this.g=V()}function ve(t){t.aa=!1,t.O&&(t.a.clearTimeout(t.O),t.O=null)}function ge(t,e,n){if("function"==typeof t)n&&(t=P(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=P(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}U(ye,ne),(st=ye.prototype).aa=!1,st.O=null,st.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.O=this.a.setTimeout(this.c,this.b-t):(this.O&&(this.a.clearTimeout(this.O),this.O=null),re(this,"tick"),this.aa&&(ve(this),this.start())))},st.start=function(){this.aa=!0,this.O||(this.O=this.a.setTimeout(this.c,this.b),this.g=V())},st.H=function(){ye.Y.H.call(this),ve(this),delete this.a};var me,we,be=(T(we=Ee,J=me=Rt),we.prototype=null===J?Object.create(J):(_e.prototype=J.prototype,new _e),Ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ge(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},Ee.prototype.H=function(){me.prototype.H.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},Ee);function _e(){this.constructor=we}function Ee(t,e){var n=me.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function Te(t){Rt.call(this),this.b=t,this.a={}}U(Te,Rt);var Ie=[];function Ae(t,e,n,r){Array.isArray(n)||(n&&(Ie[0]=n.toString()),n=Ie);for(var i=0;i<n.length;i++){var o=Kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ne(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Xt(t)},t),t.a={}}function Oe(){this.a=bt("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function Se(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.b)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(var r=0;r<n.length;r++)if(Array.isArray(n[r])){var i=n[r];if(!(i.length<2)){var o=i[1];if(Array.isArray(o)&&!(o.length<1)&&"noop"!=(i=o[0])&&"stop"!=i&&"close"!=i)for(var s=1;s<o.length;s++)o[s]=""}}return oe(n)}catch(n){return De(t,"Exception parsing expected JS array - probably was not JS"),e}}(t,n)+(r?" "+r:"")})}function De(t,e){St(t.a,e)}function Le(t,e,n){(t=t.a)&&t.log(pt,n||"Exception",e)}function Re(t,e){(t=t.a)&&t.log(pt,e,void 0)}Te.prototype.H=function(){Te.Y.H.call(this),Ne(this)},Te.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Oe.prototype.info=function(t){Ot(this.a,t)};var Ce={},ke=null;function Pe(){return ke=ke||new ne}function xe(t){xt.call(this,Ce.Fa,t)}function Ve(){var t=Pe();re(t,new xe(t))}function Ue(t,e){xt.call(this,Ce.STAT_EVENT,t),this.stat=e}function Me(t){var e=Pe();re(e,new Ue(e,t))}function Fe(t){xt.call(this,Ce.Ga,t)}function qe(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}Ce.Fa="serverreachability",U(xe,xt),Ce.STAT_EVENT="statevent",U(Ue,xt),Ce.Ga="timingevent",U(Fe,xt);var je={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},He={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Be(){}function Ge(t){var e;return(e=t.a)||(e=t.a={}),e}function ze(){}Be.prototype.a=null;var Je,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ke(){xt.call(this,"d")}function We(){xt.call(this,"c")}function Xe(){}function Ye(t,e,n,r){this.g=t,this.b=e,this.c=n,this.S=r||1,this.J=new Te(this),this.P=Qe,t=nt?125:void 0,this.R=new ye(t),this.A=null,this.f=!1,this.m=this.i=this.j=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.l=null,this.K=-1,this.v=!1,this.L=0,this.F=null,this.X=this.C=this.W=this.I=!1}U(Ke,xt),U(We,xt),U(Xe,Be),Je=new Xe;var Qe=45e3,$e={},Ze={};function tn(t,e,n){t.G=1,t.j=En(vn(e)),t.m=n,t.I=!0,en(t,null)}function en(t,e){t.u=V(),rn(t),t.i=vn(t.j);var s,u,a,c,h,l,n=t.i,r=t.S;Array.isArray(r)||(r=[String(r)]),xn(n.b,"t",r),t.D=0,t.a=Dr(t.g,t.g.F?e:null),0<t.L&&(t.F=new be(P(t.Ca,t,t.a),t.L)),Ae(t.J,t.a,"readystatechange",t.Xa),e=t.A?W(t.A):{},t.m?(t.l||(t.l="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.i,t.l,t.m,e)):(t.l="GET",t.a.ba(t.i,t.l,null,e)),Ve(),s=t.b,u=t.l,a=t.i,c=t.c,h=t.S,l=t.m,s.info(function(){if(s.b)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function nn(t,e,n){for(var r,i,o,s=!0;!t.v&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ze:(i=Number(u.substring(i,o)),isNaN(i)?$e:(o+=1)+i>u.length?Ze:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ze){4==e&&(t.h=4,Me(14),s=!1),Se(t.b,t.c,null,"[Incomplete Response]");break}if(u==$e){t.h=4,Me(15),Se(t.b,t.c,n,"[Invalid Chunk]"),s=!1;break}Se(t.b,t.c,u,null),cn(t,u)}4==e&&0==n.length&&(t.h=1,Me(16),s=!1),t.f=t.f&&s,s?0<n.length&&!t.X&&(t.X=!0,(e=t.g).b==t&&e.W&&!e.I&&(e.a.info("Great, no buffering proxy detected. Bytes received: "+n.length),_r(e),e.I=!0,Me(11))):(Se(t.b,t.c,n,"[Invalid Chunked Response]"),an(t),un(t))}function rn(t){t.T=V()+t.P,on(t,t.P)}function on(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=qe(P(t.Va,t),e)}function sn(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function un(t){0==t.g.B||t.v||Ir(t.g,t)}function an(t){sn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ve(t.R),Ne(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function cn(t,e){try{var n,r,i,o,s=t.g;if(0!=s.B&&(s.b==t||Hn(s.f,t)))if(s.C=t.K,!t.C&&Hn(s.f,t)&&3==s.B){try{var u=s.ka.a.parse(e)}catch(e){u=null}if(Array.isArray(u)&&3==u.length){var a=u;if(0==a[0])t:if(De(s.a,"Server claims our backchannel is missing."),s.j)De(s.a,"But we are currently starting the request.");else{if(s.b){if(!(s.b.u+3e3<t.u))break t;Tr(s),fr(s)}else Nt(s.a.a,"We do not have a BackChannel established");br(s),Me(18)}else{s.oa=a[1];var c,h=s.oa-s.P;0<h&&(c=a[2],De(s.a,c+" bytes (in "+h+" arrays) are outstanding on the BackChannel"),c<37500&&s.J&&0==s.o&&!s.l&&(s.l=qe(P(s.Sa,s),6e3)))}if(jn(s.f)<=1&&s.ea){try{s.ea()}catch(e){Le(s.a,e,"Exception from forwardChannelFlushedCallback_ ")}s.ea=void 0}}else De(s.a,"Bad POST response data returned"),Nr(s,11)}else if(!t.C&&s.b!=t||Tr(s),!H(e))for(h=u=s.ka.a.parse(e),c=0;c<h.length;c++)a=h[c],s.P=a[0],a=a[1],2==s.B?"c"==a[0]?(s.K=a[1],s.ga=a[2],null!=(n=a[3])&&(s.ha=n,s.a.info("VER="+s.ha)),null!=(i=a[4])&&(s.pa=i,s.a.info("SVER="+s.pa)),null!=(n=a[5])&&"number"==typeof n&&0<n&&(e=1.5*n,s.G=e,s.a.info("backChannelRequestTimeoutMs_="+e)),e=s,(i=t.a)&&(!(n=i.a?i.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(r=e.f).a&&(G(n,"spdy")||G(n,"quic")||G(n,"h2"))&&(r.f=r.g,r.a=new Set,r.b&&(Bn(r,r.b),r.b=null)),e.v&&((o=i.a?i.a.getResponseHeader("X-HTTP-Session-Id"):null)?(e.na=o,_n(e.A,e.v,o)):Nt(e.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),s.B=3,s.g&&s.g.ta(),s.W&&(s.D=V()-t.u,s.a.info("Handshake RTT: "+s.D+"ms")),u=t,r=e=s,o=Sr(i=e,i.F?e.ga:null,e.fa),De(i.a,"GetBackChannelUri: "+o),r.la=o,u.C?(De(e.a,"Upgrade the handshake request to a backchannel."),Gn(e.f,u),r=u,(o=e.G)&&r.setTimeout(o),r.o&&(sn(r),rn(r)),e.b=u):wr(e),0<s.c.length&&yr(s)):"stop"!=a[0]&&"close"!=a[0]||Nr(s,7):3==s.B&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Nr(s,7):lr(s):"noop"!=a[0]&&s.g&&s.g.sa(a),s.o=0);Ve()}catch(e){Le(t.b,e,"Error in httprequest callback")}}function hn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)F(t,e,void 0);else{if(t.N&&"function"==typeof t.N)var n=t.N();else if(t.M&&"function"==typeof t.M)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.M&&"function"==typeof t.M)return t.M();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ln(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ln)for(n=t.N(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function fn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];pn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)pn(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(st=Ye.prototype).setTimeout=function(t){this.P=t},st.Xa=function(t){t=t.target;var e=this.F;e&&3==sr(t)?(De(this.b,"Throttling readystatechange."),e.f()):this.Ca(t)},st.Ca=function(t){try{t==this.a?function(t){var e,n,r,i,o,s,u,a=sr(t.a),c=t.a.ua(),h=t.a.V();if(!(a<3||3==a&&!nt&&!t.a.U())){t.v||4!=a||7==c||Ve(),sn(t);var l=t.a.V();if(t.K=l,(c=t.a.U())||De(t.b,function(){return"No response text for uri "+t.i+" status "+l}),t.f=200==l,e=t.b,n=t.l,r=t.i,i=t.c,o=t.S,s=a,u=l,e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+o+"]: "+n+"\n"+r+"\n"+s+" "+u}),t.f){if(t.W&&!t.C){if(!(h=(e=t).a&&(e=(e=e.a).a?e.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(e)?e:null))return t.f=!1,t.h=3,Me(12),Nt(t.b.a,"XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ("+t.c+")"),an(t),un(t);Se(t.b,t.c,h,"Initial handshake response via X-HTTP-Initial-Response"),t.C=!0,cn(t,h)}t.I?(nn(t,a,c),nt&&t.f&&3==a&&(Ae((h=t).J,h.R,"tick",h.Wa),h.R.start())):(Se(t.b,t.c,c,null),cn(t,c)),4==a&&an(t),t.f&&!t.v&&(4==a?Ir(t.g,t):(t.f=!1,rn(t)))}else 400==l&&0<c.indexOf("Unknown SID")?(t.h=3,Me(12),Nt(t.b.a,"XMLHTTP Unknown SID ("+t.c+")")):(t.h=0,Me(13),Nt(t.b.a,"XMLHTTP Bad status "+l+" ("+t.c+")")),an(t),un(t)}}(this):Nt(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){var e;De(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.U()?Le((e=this).b,t,function(){return"ResponseText: "+e.a.U()}):Le(this.b,t,"No response text")}},st.Wa=function(){var t,e;this.a&&(t=sr(this.a),e=this.a.U(),this.D<e.length&&(sn(this),nn(this,t,e),this.f&&4!=t&&rn(this)))},st.cancel=function(){this.v=!0,an(this)},st.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(this.f&&Re(this.b,"Received watchdog timeout even though request loaded successfully"),t=this.b,e=this.i,t.info(function(){return"TIMEOUT: "+e}),2!=this.G&&(Ve(),Me(17)),an(this),this.h=2,un(this)):(Nt(this.b.a,"WatchDog timer called too early"),on(this,this.T-n))},(st=ln.prototype).M=function(){fn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},st.N=function(){return fn(this),this.a.concat()},st.get=function(t,e){return pn(this.b,t)?this.b[t]:e},st.set=function(t,e){pn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},st.forEach=function(t,e){for(var n=this.N(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var dn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function yn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof yn?(this.a=void 0!==e?e:t.a,gn(this,t.f),this.j=t.j,mn(this,t.c),wn(this,t.h),this.g=t.g,e=t.b,(n=new Rn).c=e.c,e.a&&(n.a=new ln(e.a),n.b=e.b),bn(this,n),this.i=t.i):t&&(n=String(t).match(dn))?(this.a=!!e,gn(this,n[1]||"",!0),this.j=Tn(n[2]||""),mn(this,n[3]||"",!0),wn(this,n[4]),this.g=Tn(n[5]||"",!0),bn(this,n[6]||"",!0),this.i=Tn(n[7]||"")):(this.a=!!e,this.b=new Rn(null,this.a))}function vn(t){return new yn(t)}function gn(t,e,n){t.f=n?Tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function mn(t,e,n){t.c=n?Tn(e,!0):e}function wn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function bn(t,e,n){var r,i;e instanceof Rn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(Cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(kn(this,e),xn(this,n,t))},r)),r.f=i):(n||(e=In(e,Dn)),t.b=new Rn(e,t.a))}function _n(t,e,n){t.b.set(e,n)}function En(t){return _n(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function Tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function In(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,An),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function An(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}yn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(In(e,Nn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(In(e,Nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(In(n,"/"==n.charAt(0)?Sn:On,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",In(n,Ln)),t.join("")};var Nn=/[#\/\?@]/g,On=/[#\?:]/g,Sn=/[#\?]/g,Dn=/[#\?@]/g,Ln=/#/g;function Rn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Cn(o){o.a||(o.a=new ln,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function kn(t,e){Cn(t),e=Vn(t,e),pn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,pn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&fn(t)))}function Pn(t,e){return Cn(t),e=Vn(t,e),pn(t.a.b,e)}function xn(t,e,n){kn(t,e),0<n.length&&(t.c=null,t.a.set(Vn(t,e),j(n)),t.b+=n.length)}function Vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(st=Rn.prototype).add=function(t,e){Cn(this),this.c=null,t=Vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},st.forEach=function(n,r){Cn(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},st.N=function(){Cn(this);for(var t=this.a.M(),e=this.a.N(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},st.M=function(t){Cn(this);var e=[];if("string"==typeof t)Pn(this,t)&&(e=q(e,this.a.get(Vn(this,t))));else{t=this.a.M();for(var n=0;n<t.length;n++)e=q(e,t[n])}return e},st.set=function(t,e){return Cn(this),this.c=null,Pn(this,t=Vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},st.get=function(t,e){return t&&0<(t=this.M(t)).length?String(t[0]):e},st.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.N(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.M(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function Un(t,e){this.b=t,this.a=e}function Mn(t){this.g=t||Fn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Fn=10;function qn(t){return t.b||t.a&&t.a.size>=t.f}function jn(t){return t.b?1:t.a?t.a.size:0}function Hn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Bn(t,e){t.a?t.a.add(e):t.b=e}function Gn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function zn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return j(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Jn(){}function Kn(){this.a=new Jn}function Wn(t,e,n,r,i){try{De(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){Le(t,e)}}Mn.prototype.cancel=function(){var t,e;if(this.c=zn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Jn.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},Jn.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var Xn=N.JSON.parse;function Yn(t){ne.call(this),this.headers=new ln,this.I=t||null,this.c=!1,this.A=this.a=null,this.J=this.s="",this.i=0,this.g="",this.h=this.D=this.o=this.C=!1,this.l=0,this.u=null,this.K=Qn,this.v=this.G=!1}U(Yn,ne);var Qn="";Yn.prototype.b=bt("goog.net.XhrIo");var $n=/^https?$/i,Zn=["POST","PUT"];function tr(t){return"content-type"==t.toLowerCase()}function er(t,e){t.c=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.i=5,nr(t),ir(t)}function nr(t){t.C||(t.C=!0,re(t,"complete"),re(t,"error"))}function rr(t){if(t.c)if(t.A[1]&&4==sr(t)&&2==t.V())St(t.b,ur(t,"Local request error detected and ignored"));else if(t.o&&4==sr(t))ge(t.za,0,t);else if(re(t,"readystatechange"),4==sr(t)){St(t.b,ur(t,"Request complete")),t.c=!1;try{var e,n,r,i,o=t.V();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.s).match(dn)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!$n.test(i?i.toLowerCase():"")),e=n),e)re(t,"complete"),re(t,"success");else{t.i=6;try{var u=2<sr(t)?t.a.statusText:""}catch(o){St(t.b,"Can not get status: "+o.message),u=""}t.g=u+" ["+t.V()+"]",nr(t)}}finally{ir(t)}}}function ir(t,e){if(t.a){or(t);var n=t.a,r=t.A[0]?O:null;t.a=null,t.A=null,e||re(t,"ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(pt,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function or(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(N.clearTimeout(t.u),t.u=null)}function sr(t){return t.a?t.a.readyState:0}function ur(t,e){return e+" ["+t.J+" "+t.s+" "+t.V()+"]"}function ar(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):_n(t,e,n))}function cr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function hr(t){this.pa=0,this.c=[],this.a=new Oe,this.ga=this.la=this.A=this.fa=this.b=this.na=this.v=this.X=this.i=this.L=this.m=null,this.Oa=this.R=0,this.La=cr("failFast",!1,t),this.J=this.l=this.j=this.h=this.g=null,this.S=!0,this.C=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=cr("baseRetryDelayMs",5e3,t),this.Ra=cr("retryDelaySeedMs",1e4,t),this.Ma=cr("forwardChannelMaxRetries",2,t),this.ma=cr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.G=void 0,this.F=t&&t.supportsCrossDomainXhr||!1,this.K="",this.f=new Mn(t&&t.concurrentRequestLimit),this.ka=new Kn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.a.b=!1),t&&t.forceLongPolling&&(this.S=!1),this.W=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.D=0,this.I=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.a.info("Opt-in to enable Chrome Origin Trials.")}function lr(t){var e,n;De(t.a,"disconnect()"),pr(t),3==t.B&&(e=t.R++,_n(n=vn(t.A),"SID",t.K),_n(n,"RID",e),_n(n,"TYPE","terminate"),gr(t,n),(e=new Ye(t,t.a,e,void 0)).G=2,e.j=En(vn(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.j.toString(),"")),!n&&N.Image&&((new Image).src=e.j,n=!0),n||(e.a=Dr(e.g,null),e.a.ba(e.j)),e.u=V(),rn(e)),Or(t)}function fr(t){t.b&&(_r(t),t.b.cancel(),t.b=null)}function pr(t){fr(t),t.j&&(N.clearTimeout(t.j),t.j=null),Tr(t),t.f.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function dr(t,e){1e3==t.c.length&&Re(t.a,function(){return"Already have 1000 queued maps upon queueing "+oe(e)}),t.c.push(new Un(t.Oa++,e)),3==t.B&&yr(t)}function yr(t){qn(t.f)||t.h||(t.h=!0,le(t.Ba,t),t.u=0)}function vr(t,e){var n=e?e.c:t.R++,r=vn(t.A);_n(r,"SID",t.K),_n(r,"RID",n),_n(r,"AID",t.P),gr(t,r),t.i&&t.m&&ar(r,t.i,t.m),n=new Ye(t,t.a,n,t.u+1),null===t.i&&(n.A=t.m),e&&(t.c=e.s.concat(t.c)),e=mr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Bn(t.f,n),tn(n,r,e)}function gr(t,n){t.g&&hn({},function(t,e){_n(n,e,t)})}function mr(t,e,n){n=Math.min(t.c.length,n);var r=t.g?P(t.g.Ja,t.g,t):null;t:for(var i=t.c,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{hn(t,function(t,e){var n=t;D(t)&&(n=oe(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.c.splice(0,n),e.s=t,r}function wr(t){t.b||t.j||(t.T=1,le(t.Aa,t),t.o=0)}function br(t){return t.b||t.j?(Re(t.a,"Request already in progress"),0):!(3<=t.o)&&(De(t.a,"Going to retry GET"),t.T++,t.j=qe(P(t.Aa,t),Ar(t,t.o)),t.o++,1)}function _r(t){null!=t.s&&(De(t.a,"Cancel the BP detection timer."),N.clearTimeout(t.s),t.s=null)}function Er(t){De(t.a,"Creating new HttpRequest"),t.b=new Ye(t,t.a,"rpc",t.T),null===t.i&&(t.b.A=t.m),t.b.L=0;var e=vn(t.la);_n(e,"RID","rpc"),_n(e,"SID",t.K),_n(e,"CI",t.J?"0":"1"),_n(e,"AID",t.P),gr(t,e),_n(e,"TYPE","xmlhttp"),t.i&&t.m&&ar(e,t.i,t.m),t.G&&t.b.setTimeout(t.G);var n=t.b,r=t.ga;n.G=1,n.j=En(vn(e)),n.m=null,n.I=!0,en(n,r),De(t.a,"New Request created")}function Tr(t){null!=t.l&&(N.clearTimeout(t.l),t.l=null)}function Ir(t,e){De(t.a,"Request complete");var n,r,i=null;if(t.b==e){Tr(t),_r(t),t.b=null;var o=2}else{if(!Hn(t.f,e))return;i=e.s,Gn(t.f,e),o=1}if(t.C=e.K,0!=t.B)if(e.f)1==o?(e.m&&e.m.length,V(),e.u,n=t.u,re(r=Pe(),new Fe(r)),yr(t)):wr(t);else{var s=e.h;if(3==s||0==s&&0<t.C)De(t.a,"Not retrying due to error type");else{if(De(t.a,function(){return"Maybe retrying, last error: "+function(t){switch(s){case 0:return"Non-200 return code ("+t+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}(t.C)}),1==o&&(n=e,jn((e=t).f)>=e.f.f-(e.h?1:0)?(Re(e.a,"Unexpected retry request is scheduled."),0):e.h?(De(e.a,"Use the retry request that is already scheduled."),e.c=n.s.concat(e.c),1):!(1==e.B||2==e.B||e.u>=(e.La?0:e.Ma))&&(De(e.a,"Going to retry POST"),e.h=qe(P(e.Ba,e,n),Ar(e,e.u)),e.u++,1))||2==o&&br(t))return;De(t.a,"Exceeded max number of retries")}switch(i&&0<i.length&&((o=t.f).c=o.c.concat(i)),De(t.a,"Error: HTTP request failed"),s){case 1:Nr(t,5);break;case 4:Nr(t,10);break;case 3:Nr(t,6);break;default:Nr(t,2)}}}function Ar(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.g||(De(t.a,"Inactive channel"),n*=2),n*e}function Nr(t,e){var n,r,i,o;t.a.info("Error code "+e),2==e?(r=null,t.g&&(r=null),o=P(t.Ya,t),r||(r=new yn("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||gn(r,"https"),En(r)),n=r.toString(),r=o,De(o=new Oe,"TestLoadImage: loading "+n),N.Image?((i=new Image).onload=x(Wn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(Wn,o,i,"TestLoadImage: error",!1,r),i.onabort=x(Wn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(Wn,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):Me(2),De(t.a,"HttpChannel: error - "+e),t.B=0,t.g&&t.g.ra(e),Or(t),pr(t)}function Or(t){var e;t.B=0,t.C=-1,t.g&&(0==(e=zn(t.f)).length&&0==t.c.length||(De(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.c.length}),t.f.c.length=0,j(t.c),t.c.length=0),t.g.qa())}function Sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof yn?vn(s):new yn(s,void 0);return""!=a.c?(e&&mn(a,e+"."+a.c),wn(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new yn(null,void 0),r&&gn(u,r),i&&mn(u,i),o&&wn(u,o),s&&(u.g=s),a=u),t.X&&K(t.X,function(t,e){_n(a,e,t)}),e=t.v,n=t.na,e&&n&&_n(a,e,n),_n(a,"VER",t.ha),gr(t,a),a}function Dr(t,e){if(e&&!t.F)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Yn(t.Na)).G=t.F,e}function Lr(){}function Rr(){if(tt&&!(10<=Number(ct)))throw Error("Environmental error: no available transport.")}function Cr(t,e){ne.call(this),this.a=new hr(e),this.c=t,this.b=bt("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.m=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.L=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.s=e&&e.supportsCrossDomainXhr||!1,this.o=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.v=e,null!==(t=this.g)&&e in t&&(e in(t=this.g)&&delete t[e],Nt(this.b,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new xr(this)}function kr(t){Ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Pr(){We.call(this),this.status=1}function xr(t){this.a=t}(st=Yn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+t);e=e?e.toUpperCase():"GET",this.s=t,this.g="",this.i=0,this.J=e,this.C=!1,this.c=!0,this.a=new XMLHttpRequest,this.A=this.I?Ge(this.I):Ge(Je),this.a.onreadystatechange=P(this.za,this);try{St(this.b,ur(this,"Opening Xhr")),this.D=!0,this.a.open(e,String(t),!0),this.D=!1}catch(t){return St(this.b,ur(this,"Error opening Xhr: "+t.message)),void er(this,t)}t=n||"";var i,o=new ln(this.headers);r&&hn(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=tr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.N()),n=N.FormData&&t instanceof N.FormData,0<=M(Zn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.K&&(this.a.responseType=this.K),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{or(this),0<this.l&&(this.v=(i=this.a,tt&&at(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout),St(this.b,ur(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.l,this.a.ontimeout=P(this.xa,this)):this.u=ge(this.xa,this.l,this)),St(this.b,ur(this,"Sending request")),this.o=!0,this.a.send(t),this.o=!1}catch(t){St(this.b,ur(this,"Send error: "+t.message)),er(this,t)}},st.xa=function(){this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.i=8,St(this.b,ur(this,this.g)),re(this,"timeout"),this.abort(8))},st.abort=function(t){this.a&&this.c&&(St(this.b,ur(this,"Aborting")),this.c=!1,this.h=!0,this.a.abort(),this.h=!1,this.i=t||7,re(this,"complete"),re(this,"abort"),ir(this))},st.H=function(){this.a&&(this.c&&(this.c=!1,this.h=!0,this.a.abort(),this.h=!1),ir(this,!0)),Yn.Y.H.call(this)},st.za=function(){this.m||(this.D||this.o||this.h?rr(this):this.Ua())},st.Ua=function(){rr(this)},st.V=function(){try{return 2<sr(this)?this.a.status:-1}catch(t){return-1}},st.U=function(){try{return this.a?this.a.responseText:""}catch(t){return St(this.b,"Can not get responseText: "+t.message),""}},st.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Xn(e)}},st.ua=function(){return this.i},st.Qa=function(){return"string"==typeof this.g?this.g:String(this.g)},(st=hr.prototype).ha=8,st.B=1,st.Ba=function(t){if(this.h)if(this.h=null,De(this.a,"startForwardChannel_"),1==this.B)if(t)Re(this.a,"Not supposed to retry the open");else{De(this.a,"open_()"),this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ye(this,this.a,t,void 0),r=this.m;if(this.L&&(r?Y(r=W(r),this.L):r=this.L),null===this.i&&(n.A=r),this.da)t:{for(var i=e=0;i<this.c.length;i++){var o=this.c[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.c.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=mr(this,n,e),_n(i=vn(this.A),"RID",t),_n(i,"CVER",22),this.v&&_n(i,"X-HTTP-Session-Id",this.v),gr(this,i),this.i&&r&&ar(i,this.i,r),Bn(this.f,n),this.Ia&&_n(i,"TYPE","init"),this.da?(_n(i,"$req",e),_n(i,"SID","null"),n.W=!0,tn(n,i,null)):tn(n,i,e),this.B=2}else 3==this.B&&(t?vr(this,t):0==this.c.length?De(this.a,"startForwardChannel_ returned: nothing to send"):qn(this.f)?Re(this.a,"startForwardChannel_ returned: connection already in progress"):(vr(this),De(this.a,"startForwardChannel_ finished, sent request")))},st.Aa=function(){var t;this.j=null,Er(this),this.W&&!this.I&&(null==this.b||this.D<=0?Nt(this.a.a,"Skip bpDetectionTimerId_ "+this.b+" "+this.D):(t=2*this.D,this.a.info("BP detection timer enabled: "+t),this.s=qe(P(this.Ta,this),t)))},st.Ta=function(){var t;this.s?(this.s=null,this.a.info("BP detection timeout reached."),null==this.b.a||(t=this.b.a.U())&&Nt(this.a.a,"Timer should have been cancelled : "+t),this.a.info("Buffering proxy detected and switch to long-polling!"),this.J=!1,this.I=!0,Me(10),fr(this),Er(this)):Nt(this.a.a,"Invalid operation.")},st.Sa=function(){null!=this.l&&(this.l=null,fr(this),br(this),Me(19))},st.Ya=function(t){t?(this.a.info("Successfully pinged google.com"),Me(2)):(this.a.info("Failed to ping google.com"),Me(1))},(st=Lr.prototype).ta=function(){},st.sa=function(){},st.ra=function(){},st.qa=function(){},st.Ja=function(){},Rr.prototype.a=function(t,e){return new Cr(t,e)},U(Cr,ne),Cr.prototype.i=function(){this.a.g=this.h,this.s&&(this.a.F=!0);var t=this.a,e=this.c,n=this.g||void 0;De(t.a,"connect()"),Me(0),t.fa=e,t.X=n||{},t.J=t.S,De(t.a,"connectChannel_()"),e=Sr(t,null,t.fa),De(t.a,"GetForwardChannelUri: "+e),t.A=e,yr(t)},Cr.prototype.close=function(){lr(this.a)},Cr.prototype.l=function(t){var e;"string"==typeof t?((e={}).__data__=t,dr(this.a,e)):this.o?((e={}).__data__=oe(t),dr(this.a,e)):dr(this.a,t)},Cr.prototype.H=function(){this.a.g=null,delete this.h,lr(this.a),delete this.a,Cr.Y.H.call(this)},U(kr,Ke),U(Pr,We),U(xr,Lr),xr.prototype.ta=function(){Ot(this.a.b,"WebChannel opened on "+this.a.c),re(this.a,"a")},xr.prototype.sa=function(t){re(this.a,new kr(t))},xr.prototype.ra=function(t){Ot(this.a.b,"WebChannel aborted on "+this.a.c+" due to channel error: "+t),re(this.a,new Pr)},xr.prototype.qa=function(){Ot(this.a.b,"WebChannel closed on "+this.a.c),re(this.a,"b")},Rr.prototype.createWebChannel=Rr.prototype.a,Cr.prototype.send=Cr.prototype.l,Cr.prototype.open=Cr.prototype.i,je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,He.COMPLETE="complete",(ze.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",ne.prototype.listen=ne.prototype.va,Yn.prototype.listenOnce=Yn.prototype.wa,Yn.prototype.getLastError=Yn.prototype.Qa,Yn.prototype.getLastErrorCode=Yn.prototype.ua,Yn.prototype.getStatus=Yn.prototype.V,Yn.prototype.getResponseJson=Yn.prototype.Pa,Yn.prototype.getResponseText=Yn.prototype.U,Yn.prototype.send=Yn.prototype.ba;var Vr=Pe,Ur=je,Mr=He,Fr=Ce,qr=ze,jr=Yn;(A=bt("goog.labs.net.webChannel.WebChannelDebug"))&&(A.b=gt),1!=(je=new Dt).b&&(He=bt(""),A=je.g,He&&(He.a||(He.a=[]),He.a.push(A)),je.b=!0);var Hr="8.2.2-longpoll.66863f547",Br=new o("@firebase/firestore");function Gr(){return Br.logLevel}function zr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br.logLevel<=u.DEBUG&&(e=n.map(Wr),Br.debug.apply(Br,f(["Firestore ("+Hr+"): "+t],e)))}function Jr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br.logLevel<=u.ERROR&&(e=n.map(Wr),Br.error.apply(Br,f(["Firestore ("+Hr+"): "+t],e)))}function Kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br.logLevel<=u.WARN&&(e=n.map(Wr),Br.warn.apply(Br,f(["Firestore ("+Hr+"): "+t],e)))}function Wr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Xr(t){throw void 0===t&&(t="Unexpected state"),Jr(t="FIRESTORE ("+Hr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Yr(t){t||Xr()}var Qr=($r.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},$r);function $r(){}function Zr(t,e){return t<e?-1:e<t?1:0}function ti(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var ei=(ni.fromBase64String=function(t){return new ni(atob(t))},ni.fromUint8Array=function(t){return new ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ni.prototype.toBase64=function(){return t=this.i,btoa(t);var t},ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},ni.prototype.o=function(){return 2*this.i.length},ni.prototype.u=function(t){return Zr(this.i,t.i)},ni.prototype.isEqual=function(t){return this.i===t.i},ni);function ni(t){this.i=t}ei.h=new ei("");var ri,ii={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},oi=(l(ci,ri=Error),ci),si=(ai.fromBase64String=function(t){try{return new ai(ei.fromBase64String(t))}catch(t){throw new oi(ii.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},ai.fromUint8Array=function(t){return new ai(ei.fromUint8Array(t))},ai.prototype.toBase64=function(){return this.l.toBase64()},ai.prototype.toUint8Array=function(){return this.l.toUint8Array()},ai.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},ai.prototype.isEqual=function(t){return this.l.isEqual(t.l)},ai),ui=function(t){this._=t};function ai(t){this.l=t}function ci(t,e){var n=this;return(n=ri.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function hi(){if("undefined"==typeof Uint8Array)throw new oi(ii.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function li(){if("undefined"==typeof atob)throw new oi(ii.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var fi,pi=(l(wi,fi=ui),wi.fromBase64String=function(t){return li(),new wi(si.fromBase64String(t))},wi.fromUint8Array=function(t){return hi(),new wi(si.fromUint8Array(t))},wi.prototype.toBase64=function(){return li(),this._.toBase64()},wi.prototype.toUint8Array=function(){return hi(),this._.toUint8Array()},wi.prototype.isEqual=function(t){return this._.isEqual(t._)},wi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},wi),di=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},yi=(Object.defineProperty(mi.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),mi.prototype.isEqual=function(t){return t instanceof mi&&t.projectId===this.projectId&&t.database===this.database},mi),vi=(gi.prototype.A=function(){return null!=this.uid},gi.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},gi.prototype.isEqual=function(t){return t.uid===this.uid},gi);function gi(t){this.uid=t}function mi(t,e){this.projectId=t,this.database=e||"(default)"}function wi(){return null!==fi&&fi.apply(this,arguments)||this}function bi(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}vi.UNAUTHENTICATED=new vi(null),vi.P=new vi("google-credentials-uid"),vi.g=new vi("first-party-uid");var _i=(Li.prototype.getToken=function(){return Promise.resolve(null)},Li.prototype.v=function(){},Li.prototype.S=function(t){(this.p=t)(vi.UNAUTHENTICATED)},Li.prototype.D=function(){this.p=null},Li),Ei=(Di.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(zr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Yr("string"==typeof t.accessToken),new bi(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Di.prototype.v=function(){this.forceRefresh=!0},Di.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},Di.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},Di.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Yr(null===t||"string"==typeof t),new vi(t)},Di),Ti=(Object.defineProperty(Si.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Si),Ii=(Oi.prototype.getToken=function(){return Promise.resolve(new Ti(this.k,this.M))},Oi.prototype.S=function(t){t(vi.g)},Oi.prototype.D=function(){},Oi.prototype.v=function(){},Oi),Ai=(Ni.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ni.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},Ni);function Ni(t,e){var n=this;this.previousValue=t,e&&(e.$=function(t){return n.L(t)},this.B=function(t){return e.q(t)})}function Oi(t,e){this.k=t,this.M=e}function Si(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=vi.g}function Di(t){var e=this;this.C=null,this.currentUser=vi.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function Li(){this.p=null}Ai.U=-1;var Ri,Ci,ki=(Gi.now=function(){return Gi.fromMillis(Date.now())},Gi.fromDate=function(t){return Gi.fromMillis(t.getTime())},Gi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Gi(e,1e6*(t-1e3*e))},Gi.prototype.toDate=function(){return new Date(this.toMillis())},Gi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Gi.prototype.K=function(t){return this.seconds===t.seconds?Zr(this.nanoseconds,t.nanoseconds):Zr(this.seconds,t.seconds)},Gi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Gi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Gi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Gi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Gi),Pi=(Bi.j=function(t){return new Bi(t)},Bi.min=function(){return new Bi(new ki(0,0))},Bi.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Bi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Bi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Bi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Bi.prototype.G=function(){return this.timestamp},Bi),je=(Object.defineProperty(Hi.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Hi.prototype.isEqual=function(t){return 0===Hi.J(this,t)},Hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hi?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},Hi.prototype.limit=function(){return this.offset+this.length},Hi.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Hi.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Hi.prototype.tt=function(){return this.segments[this.offset]},Hi.prototype.et=function(){return this.get(this.length-1)},Hi.prototype.get=function(t){return this.segments[this.offset+t]},Hi.prototype.nt=function(){return 0===this.length},Hi.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hi.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hi.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Hi.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hi),xi=(l(ji,Ci=je),ji.prototype.Y=function(t,e,n){return new ji(t,e,n)},ji.prototype.ot=function(){return this.rt().join("/")},ji.prototype.toString=function(){return this.ot()},ji.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new oi(ii.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ji(n)},ji.at=function(){return new ji([])},ji),Vi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ui=(l(qi,Ri=je),qi.prototype.Y=function(t,e,n){return new qi(t,e,n)},qi.ut=function(t){return Vi.test(t)},qi.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qi.ut(t)||(t="`"+t+"`"),t}).join(".")},qi.prototype.toString=function(){return this.ot()},qi.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},qi.lt=function(){return new qi(["__name__"])},qi._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new oi(ii.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new oi(ii.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new oi(ii.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new oi(ii.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new qi(e)},qi.at=function(){return new qi([])},qi),Mi=(Fi.ft=function(t){return new Fi(xi.ct(t))},Fi.dt=function(t){return new Fi(xi.ct(t).X(5))},Fi.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Fi.prototype.isEqual=function(t){return null!==t&&0===xi.J(this.path,t.path)},Fi.prototype.toString=function(){return this.path.toString()},Fi.J=function(t,e){return xi.J(t.path,e.path)},Fi.Tt=function(t){return t.length%2==0},Fi.Et=function(t){return new Fi(new xi(t.slice()))},Fi);function Fi(t){this.path=t}function qi(){return null!==Ri&&Ri.apply(this,arguments)||this}function ji(){return null!==Ci&&Ci.apply(this,arguments)||this}function Hi(t,e,n){void 0===e?e=0:e>t.length&&Xr(),void 0===n?n=t.length-e:n>t.length-e&&Xr(),this.segments=t,this.offset=e,this.H=n}function Bi(t){this.timestamp=t}function Gi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new oi(ii.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new oi(ii.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new oi(ii.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new oi(ii.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function zi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ji(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ki(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wi=(Yi.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Yi.prototype.isEqual=function(t){return ti(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Yi),Xi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(t){(this.fields=t).sort(Ui.J)}function Qi(t){if(Yr(!!t),"string"!=typeof t)return{seconds:$i(t.seconds),nanos:$i(t.nanos)};var e=0,n=Xi.exec(t);return Yr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function $i(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Zi(t){return"string"==typeof t?ei.fromBase64String(t):ei.fromUint8Array(t)}function to(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function eo(t){return t=Qi(t.mapValue.fields.__local_write_time__.timestampValue),new ki(t.seconds,t.nanos)}function no(t){return null==t}function ro(t){return 0===t&&1/t==-1/0}function io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?to(t)?4:10:Xr()}function oo(r,i){var t,e=io(r);if(e!==io(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return eo(r).isEqual(eo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Qi(r.timestampValue),t=Qi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Zi(r.bytesValue).isEqual(Zi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,$i((t=r).geoPointValue.latitude)===$i(e.geoPointValue.latitude)&&$i(t.geoPointValue.longitude)===$i(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?$i(e.integerValue)===$i(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=$i(e.doubleValue))===(t=$i(t.doubleValue))?ro(e)===ro(t):isNaN(e)&&isNaN(t));case 9:return ti(r.arrayValue.values||[],i.arrayValue.values||[],oo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(zi(e)!==zi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!oo(e[t],n[t])))return!1;return!0}();default:return Xr()}}function so(t,e){return void 0!==(t.values||[]).find(function(t){return oo(t,e)})}function uo(t,e){var n,r,i,o=io(t),s=io(e);if(o!==s)return Zr(o,s);switch(o){case 0:return 0;case 1:return Zr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=$i(t.integerValue||t.doubleValue))<(n=$i(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return ao(t.timestampValue,e.timestampValue);case 4:return ao(eo(t),eo(e));case 5:return Zr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Zi(i),s=Zi(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Zr(n[i],r[i]);if(0!==o)return o}return Zr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Zr($i(o.latitude),$i(r.latitude)))?n:Zr($i(o.longitude),$i(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=uo(n[i],r[i]);if(o)return o}return Zr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Zr(r[s],o[s]);if(0!==u)return u;if(0!==(u=uo(n[r[s]],i[o[s]])))return u}return Zr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Xr()}}function ao(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Zr(t,e);var n=Qi(t),t=Qi(e);return 0!==(e=Zr(n.seconds,t.seconds))?e:Zr(n.nanos,t.nanos)}function co(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Qi(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Zi(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Mi.dt(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Xr();var t,e}(t)}function ho(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function lo(t){return t&&"integerValue"in t}function fo(t){return!!t&&"arrayValue"in t}function po(t){return t&&"nullValue"in t}function yo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vo(t){return t&&"mapValue"in t}var go=(bo.empty=function(){return new bo({mapValue:{}})},bo.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!vo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},bo.prototype.isEqual=function(t){return oo(this.proto,t.proto)},bo),mo=(wo.prototype.set=function(t,e){return this.Pt(t,e),this},wo.prototype.delete=function(t){return this.Pt(t,null),this},wo.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===io(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},wo.prototype.yt=function(){var t=this.gt(Ui.at(),this.Rt);return null!=t?new go(t):this.At},wo.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=vo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},wo);function wo(t){void 0===t&&(t=go.empty()),this.At=t,this.Rt=new Map}function bo(t){this.proto=t}var _o,Eo,To,Io=(l(Lo,To=o=function(t,e){this.key=t,this.version=e}),Lo.prototype.field=function(t){return this.Vt.field(t)},Lo.prototype.data=function(){return this.Vt},Lo.prototype.vt=function(){return this.Vt.proto},Lo.prototype.isEqual=function(t){return t instanceof Lo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},Lo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Lo.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Lo),Ao=(l(Do,Eo=o),Do.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Do.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Do.prototype.isEqual=function(t){return t instanceof Do&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Do),No=(l(So,_o=o),So.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),So.prototype.isEqual=function(t){return t instanceof So&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},So),Oo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function So(){return null!==_o&&_o.apply(this,arguments)||this}function Do(t,e,n){var r=this;return(r=Eo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Lo(t,e,n,r){var i=this;return(i=To.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ro(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Oo(t,e,n,r,i,o,s)}function Co(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.ot()+t.op.toString()+co(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.ot()+t.dir}).join(","),no(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=us(e.startAt)),e.endAt&&(t+="|ub:",t+=us(e.endAt)),e.St=t),e.St}function ko(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!oo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hs(t.startAt,e.startAt)&&hs(t.endAt,e.endAt)}function Po(t){return Mi.Tt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var xo,Vo=(l(Uo,xo=function(){}),Uo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new jo(t,e,n):"array-contains"===e?new $o(t,n):"in"===e?new Zo(t,n):"not-in"===e?new ts(t,n):"array-contains-any"===e?new es(t,n):new Uo(t,e,n)},Uo.Dt=function(t,e,n){return new("in"===e?Ho:Bo)(t,n)},Uo.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Ct(uo(t,this.value)):null!==t&&io(this.value)===io(t)&&this.Ct(uo(t,this.value))},Uo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Xr()}},Uo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Uo);function Uo(t,e,n){var r=this;return(r=xo.call(this)||this).field=t,r.op=e,r.value=n,r}var Mo,Fo,qo,jo=(l(Jo,qo=Vo),Jo.prototype.matches=function(t){return t=Mi.J(t.key,this.key),this.Ct(t)},Jo),Ho=(l(zo,Fo=Vo),zo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},zo),Bo=(l(Go,Mo=Vo),Go.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Go);function Go(t,e){var n=this;return(n=Mo.call(this,t,"not-in",e)||this).keys=Ko(0,e),n}function zo(t,e){var n=this;return(n=Fo.call(this,t,"in",e)||this).keys=Ko(0,e),n}function Jo(t,e,n){var r=this;return(r=qo.call(this,t,e,n)||this).key=Mi.dt(n.referenceValue),r}function Ko(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Mi.dt(t.referenceValue)})}var Wo,Xo,Yo,Qo,$o=(l(ss,Qo=Vo),ss.prototype.matches=function(t){return fo(t=t.field(this.field))&&so(t.arrayValue,this.value)},ss),Zo=(l(os,Yo=Vo),os.prototype.matches=function(t){return null!==(t=t.field(this.field))&&so(this.value.arrayValue,t)},os),ts=(l(is,Xo=Vo),is.prototype.matches=function(t){return!so(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!so(this.value.arrayValue,t))},is),es=(l(rs,Wo=Vo),rs.prototype.matches=function(t){var e=this;return!(!fo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return so(e.value.arrayValue,t)})},rs),ns=function(t,e){this.position=t,this.before=e};function rs(t,e){return Wo.call(this,t,"array-contains-any",e)||this}function is(t,e){return Xo.call(this,t,"not-in",e)||this}function os(t,e){return Yo.call(this,t,"in",e)||this}function ss(t,e){return Qo.call(this,t,"array-contains",e)||this}function us(t){return(t.before?"b":"a")+":"+t.position.map(co).join(",")}var as=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function cs(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?Mi.J(Mi.dt(s.referenceValue),n.key):uo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function hs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!oo(t.position[n],e.position[n]))return!1;return!0}var ls=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function fs(t){return new ls(t)}function ps(t){return!no(t.limit)&&"F"===t.limitType}function ds(t){return!no(t.limit)&&"L"===t.limitType}function ys(t){return 0<t.Nt.length?t.Nt[0].field:null}function vs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function gs(t){return null!==t.collectionGroup}function ms(t){var e=t;if(null===e.Ft){e.Ft=[];var n=vs(e),t=ys(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new as(n)),e.Ft.push(new as(Ui.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new as(Ui.lt(),n)))}}return e.Ft}function ws(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=Ro(e.path,e.collectionGroup,ms(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ms(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new as(o.field,s))}var u=e.endAt?new ns(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ns(e.startAt.position,!e.startAt.before):null;e.Ot=Ro(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function bs(t,e,n){return new ls(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _s(t,e){return ko(ws(t),ws(e))&&t.limitType===e.limitType}function Es(t){return Co(ws(t))+"|lt:"+t.limitType}function Ts(t){return"Query(target="+(n=(e=ws(t)).path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.ot()+" "+t.op+" "+co(t.value)}).join(", ")+"]"),no(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+us(e.startAt)),e.endAt&&(n+=", endAt: "+us(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Is(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):Mi.Tt(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||cs(t.startAt,ms(t),n))&&(!t.endAt||!cs(t.endAt,ms(t),n)));var e,n}function As(u){return function(t,e){for(var n=!1,r=0,i=ms(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.ht()?Mi.J(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?uo(e,r):Xr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var Ns=(Os.prototype.$t=function(t){return new Os(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Os.prototype.Lt=function(t,e){return new Os(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Os.prototype.Bt=function(t){return new Os(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},Os);function Os(t,e,n,r,i,o,s){void 0===i&&(i=Pi.min()),void 0===o&&(o=Pi.min()),void 0===s&&(s=ei.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ss(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ro(e)?"-0":e}}function Ds(t){return{integerValue:""+t}}function Ls(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ro(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ds(e):Ss(t,e);var n}function Rs(t,e){return t instanceof Gs?lo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Cs,ks,Ps=(l(Us,ks=je=function(){this.Ut=void 0}),Us),xs=(l(Vs,Cs=je),Vs);function Vs(t){var e=this;return(e=Cs.call(this)||this).elements=t,e}function Us(){return null!==ks&&ks.apply(this,arguments)||this}function Ms(t,e){for(var n=Ks(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return oo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Fs,qs=(l(js,Fs=je),js);function js(t){var e=this;return(e=Fs.call(this)||this).elements=t,e}function Hs(t,e){for(var n=Ks(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!oo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Bs,Gs=(l(zs,Bs=je),zs);function zs(t,e){var n=this;return(n=Bs.call(this)||this).Kt=t,n.Qt=e,n}function Js(t){return $i(t.integerValue||t.doubleValue)}function Ks(t){return fo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ws(t,e){this.field=t,this.transform=e}function Xs(t,e){this.version=t,this.transformResults=e}var Ys=(Qs.jt=function(){return new Qs},Qs.exists=function(t){return new Qs(void 0,t)},Qs.updateTime=function(t){return new Qs(t)},Object.defineProperty(Qs.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Qs);function Qs(t,e){this.updateTime=t,this.exists=e}function $s(t,e){return void 0!==t.updateTime?e instanceof Io&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Io}function Zs(t,e,n,r){return t instanceof iu?function(t,e,n){if(!$s(t.Gt,e))return e;var r=t.value,n=hu(t.fieldTransforms,n,e),r=lu(t.fieldTransforms,r,n),e=eu(e);return new Io(t.key,e,r,{bt:!0})}(t,e,r):t instanceof ou?function(t,e,n){if(!$s(t.Gt,e))return e;var r=eu(e),e=au(t,e,hu(t.fieldTransforms,n,e));return new Io(t.key,r,e,{bt:!0})}(t,e,r):$s(t.Gt,e)?new Ao(t.key,Pi.min()):e}function tu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&ti(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof xs&&e instanceof xs||t instanceof qs&&e instanceof qs?ti(t.elements,e.elements,oo):t instanceof Gs&&e instanceof Gs?oo(t.Qt,e.Qt):t instanceof Ps&&e instanceof Ps)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function eu(t){return t instanceof Io?t.version:Pi.min()}var nu,ru,iu=(l(uu,ru=o=function(){}),uu),ou=(l(su,nu=o),su);function su(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=nu.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function uu(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=ru.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function au(t,e,n){var r,i,o=t;return e=e instanceof Io?e.data():go.empty(),i=new mo(e),o.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.yt(),lu(t.fieldTransforms,r,n)}function cu(t,e,n){var r=[];Yr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Io&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof xs?Ms(o,s):o instanceof qs?Hs(o,s):u))}return r}function hu(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Io&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,a instanceof Ps?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof xs?Ms(a,r):a instanceof qs?Hs(a,r):(r=Js(a=Rs(c=a,r))+Js(c.Qt),lo(a)&&lo(c.Qt)?Ds(r):Ss(c.Kt,r))))}return i}function lu(t,e,n){for(var r=new mo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function fu(t){this.count=t}var pu,du,yu,vu=(l(wu,yu=o),wu),gu=(l(mu,du=o),mu);function mu(t,e){var n=this;return(n=du.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function wu(t,e){var n=this;return(n=yu.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function bu(t){switch(t){case ii.OK:return Xr(),0;case ii.CANCELLED:case ii.UNKNOWN:case ii.DEADLINE_EXCEEDED:case ii.RESOURCE_EXHAUSTED:case ii.INTERNAL:case ii.UNAVAILABLE:case ii.UNAUTHENTICATED:return;case ii.INVALID_ARGUMENT:case ii.NOT_FOUND:case ii.ALREADY_EXISTS:case ii.PERMISSION_DENIED:case ii.FAILED_PRECONDITION:case ii.ABORTED:case ii.OUT_OF_RANGE:case ii.UNIMPLEMENTED:case ii.DATA_LOSS:return 1;default:return Xr(),0}}function _u(t){if(void 0===t)return Jr("GRPC error has no .code"),ii.UNKNOWN;switch(t){case pu.OK:return ii.OK;case pu.CANCELLED:return ii.CANCELLED;case pu.UNKNOWN:return ii.UNKNOWN;case pu.DEADLINE_EXCEEDED:return ii.DEADLINE_EXCEEDED;case pu.RESOURCE_EXHAUSTED:return ii.RESOURCE_EXHAUSTED;case pu.INTERNAL:return ii.INTERNAL;case pu.UNAVAILABLE:return ii.UNAVAILABLE;case pu.UNAUTHENTICATED:return ii.UNAUTHENTICATED;case pu.INVALID_ARGUMENT:return ii.INVALID_ARGUMENT;case pu.NOT_FOUND:return ii.NOT_FOUND;case pu.ALREADY_EXISTS:return ii.ALREADY_EXISTS;case pu.PERMISSION_DENIED:return ii.PERMISSION_DENIED;case pu.FAILED_PRECONDITION:return ii.FAILED_PRECONDITION;case pu.ABORTED:return ii.ABORTED;case pu.OUT_OF_RANGE:return ii.OUT_OF_RANGE;case pu.UNIMPLEMENTED:return ii.UNIMPLEMENTED;case pu.DATA_LOSS:return ii.DATA_LOSS;default:return Xr()}}(je=pu={})[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";var Eu=(Ou.prototype.Ht=function(t,e){return new Ou(this.J,this.root.Ht(t,e,this.J).copy(null,null,Iu.Jt,null,null))},Ou.prototype.remove=function(t){return new Ou(this.J,this.root.remove(t,this.J).copy(null,null,Iu.Jt,null,null))},Ou.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ou.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ou.prototype.nt=function(){return this.root.nt()},Object.defineProperty(Ou.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ou.prototype.Yt=function(){return this.root.Yt()},Ou.prototype.Xt=function(){return this.root.Xt()},Ou.prototype.Zt=function(t){return this.root.Zt(t)},Ou.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},Ou.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ou.prototype.te=function(t){return this.root.te(t)},Ou.prototype.ee=function(){return new Tu(this.root,null,this.J,!1)},Ou.prototype.ne=function(t){return new Tu(this.root,t,this.J,!1)},Ou.prototype.se=function(){return new Tu(this.root,null,this.J,!0)},Ou.prototype.ie=function(t){return new Tu(this.root,t,this.J,!0)},Ou),Tu=(Nu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},Nu.prototype.ae=function(){return 0<this.oe.length},Nu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},Nu),Iu=(Au.prototype.copy=function(t,e,n,r,i){return new Au(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Au.prototype.nt=function(){return!1},Au.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},Au.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},Au.prototype.min=function(){return this.left.nt()?this:this.left.min()},Au.prototype.Yt=function(){return this.min().key},Au.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},Au.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},Au.prototype.le=function(){if(this.left.nt())return Au.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},Au.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return Au.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},Au.prototype._e=function(){return this.color},Au.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Te()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Ee()),t},Au.prototype.fe=function(){var t=this.Ee();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Te()).Ee()),t},Au.prototype.we=function(){var t=this.Ee();return t.left.left._e()&&(t=(t=t.de()).Ee()),t},Au.prototype.Te=function(){var t=this.copy(null,null,Au.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Au.prototype.de=function(){var t=this.copy(null,null,Au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Au.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Au.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},Au.prototype.me=function(){if(this._e()&&this.left._e())throw Xr();if(this.right._e())throw Xr();var t=this.left.me();if(t!==this.right.me())throw Xr();return t+(this._e()?0:1)},Au);function Au(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Au.RED,this.left=null!=r?r:Au.EMPTY,this.right=null!=i?i:Au.EMPTY,this.size=this.left.size+1+this.right.size}function Nu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function Ou(t,e){this.J=t,this.root=e||Iu.EMPTY}function Su(){this.size=0}Iu.EMPTY=null,Iu.RED=!0,Iu.Jt=!1,Iu.EMPTY=(Object.defineProperty(Su.prototype,"key",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"value",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"color",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"left",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"right",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Su.prototype.copy=function(t,e,n,r,i){return this},Su.prototype.Ht=function(t,e,n){return new Iu(t,e)},Su.prototype.remove=function(t,e){return this},Su.prototype.nt=function(){return!0},Su.prototype.Zt=function(t){return!1},Su.prototype.te=function(t){return!1},Su.prototype.Yt=function(){return null},Su.prototype.Xt=function(){return null},Su.prototype._e=function(){return!1},Su.prototype.Ie=function(){return!0},Su.prototype.me=function(){return 0},new Su);var Du=(ku.prototype.has=function(t){return null!==this.data.get(t)},ku.prototype.first=function(){return this.data.Yt()},ku.prototype.last=function(){return this.data.Xt()},Object.defineProperty(ku.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ku.prototype.indexOf=function(t){return this.data.indexOf(t)},ku.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},ku.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},ku.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},ku.prototype.Pe=function(t){return(t=this.data.ne(t)).ae()?t.ce().key:null},ku.prototype.ee=function(){return new Lu(this.data.ee())},ku.prototype.ne=function(t){return new Lu(this.data.ne(t))},ku.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},ku.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ku.prototype.nt=function(){return this.data.nt()},ku.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ku.prototype.isEqual=function(t){if(!(t instanceof ku))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},ku.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ku.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ku.prototype.copy=function(t){var e=new ku(this.J);return e.data=t,e},ku),Lu=(Cu.prototype.ce=function(){return this.ge.ce().key},Cu.prototype.ae=function(){return this.ge.ae()},Cu),Ru=new Eu(Mi.J);function Cu(t){this.ge=t}function ku(t){this.J=t,this.data=new Eu(this.J)}var Pu=new Eu(Mi.J),xu=new Eu(Mi.J),Vu=new Du(Mi.J);function Uu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Vu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mu=new Du(Zr),Fu=(ea.be=function(t){return new ea(t.J)},ea.prototype.has=function(t){return null!=this.Ve.get(t)},ea.prototype.get=function(t){return this.Ve.get(t)},ea.prototype.first=function(){return this.pe.Yt()},ea.prototype.last=function(){return this.pe.Xt()},ea.prototype.nt=function(){return this.pe.nt()},ea.prototype.indexOf=function(t){return(t=this.Ve.get(t))?this.pe.indexOf(t):-1},Object.defineProperty(ea.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),ea.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},ea.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},ea.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},ea.prototype.isEqual=function(t){if(!(t instanceof ea))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},ea.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ea.prototype.copy=function(t,e){var n=new ea;return n.J=this.J,n.Ve=t,n.pe=e,n},ea),qu=(ta.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Xr()},ta.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},ta),ju=(Zu.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Zu(t,e,Fu.be(e),i,n,r,!0,!1)},Object.defineProperty(Zu.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Zu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&_s(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Zu),Hu=($u.Le=function(t,e){var n=new Map;return n.set(t,Bu.Be(t,e)),new $u(Pi.min(),n,Mu,Ru,Uu())},$u),Bu=(Qu.Be=function(t,e){return new Qu(ei.h,e,Uu(),Uu(),Uu())},Qu),Gu=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},zu=function(t,e){this.targetId=t,this.Ge=e},Ju=function(t,e,n,r){void 0===n&&(n=ei.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ku=(Object.defineProperty(Yu.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Yu.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Yu.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Yu.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Yu.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Yu.prototype.nn=function(){var n=Uu(),r=Uu(),i=Uu();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Xr()}}),new Bu(this.Je,this.Ye,n,r,i)},Yu.prototype.sn=function(){this.Xe=!1,this.He=ra()},Yu.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Yu.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Yu.prototype.cn=function(){this.ze+=1},Yu.prototype.an=function(){--this.ze},Yu.prototype.un=function(){this.Xe=!0,this.Ye=!0},Yu),Wu=(Xu.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Io?this.Tn(r,t.We):t.We instanceof Ao&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},Xu.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Xr()}})},Xu.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Xu.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count;(t=this.gn(e))&&(Po(t=t.target)?0===n?(t=new Mi(t.path),this.En(e,t,new Ao(t,Pi.min()))):Yr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Xu.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&Po(n.target)&&(n=new Mi(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.En(e,n,new Ao(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=Uu();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){return!(t=i.gn(t))||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new Hu(r,o,this.dn,this._n,s);return this._n=Ru,this.fn=na(),this.dn=new Du(Zr),t},Xu.prototype.Tn=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Xu.prototype.En=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Xu.prototype.removeTarget=function(t){this.ln.delete(t)},Xu.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Xu.prototype.cn=function(t){this.An(t).cn()},Xu.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ku,this.ln.set(t,e)),e},Xu.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Du(Zr),this.fn=this.fn.Ht(t,e)),e},Xu.prototype.Rn=function(t){var e=null!==this.gn(t);return e||zr("WatchChangeAggregator","Detected inactive target",t),e},Xu.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Xu.prototype.Pn=function(e){var n=this;this.ln.set(e,new Ku),this.hn.Sn(e).forEach(function(t){n.En(e,t,null)})},Xu.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Xu);function Xu(t){this.hn=t,this.ln=new Map,this._n=Ru,this.fn=na(),this.dn=new Du(Zr)}function Yu(){this.ze=0,this.He=ra(),this.Je=ei.h,this.Ye=!1,this.Xe=!0}function Qu(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function $u(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.$e=i}function Zu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function ta(){this.ve=new Eu(Mi.J)}function ea(n){this.J=n?function(t,e){return n(t,e)||Mi.J(t.key,e.key)}:function(t,e){return Mi.J(t.key,e.key)},this.Ve=Pu,this.pe=new Eu(this.J)}function na(){return new Eu(Mi.J)}function ra(){return new Eu(Mi.J)}var ia={asc:"ASCENDING",desc:"DESCENDING"},oa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sa=function(t,e){this.T=t,this.qt=e};function ua(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function aa(t,e){return t.qt?e.toBase64():e.toUint8Array()}function ca(t){return Yr(!!t),Pi.j((t=Qi(t),new ki(t.seconds,t.nanos)))}function ha(t,e){return new xi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function la(t){return Yr(Ia(t=xi.ct(t))),t}function fa(t,e){return ha(t.T,e.path)}function pa(t,e){if((e=la(e)).get(1)!==t.T.projectId)throw new oi(ii.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new oi(ii.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new Mi(va(e))}function da(t,e){return ha(t.T,e)}function ya(t){return new xi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function va(t){return Yr(4<t.length&&"documents"===t.get(4)),t.X(5)}function ga(t,e,n){return{name:fa(t,e),fields:n.proto.mapValue.fields}}function ma(t,e){var n,r,i;if(e instanceof iu)n={update:ga(t,e.key,e.value)};else if(e instanceof vu)n={delete:fa(t,e.key)};else if(e instanceof ou)n={update:ga(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof gu))return Xr();n={verify:fa(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ps)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof xs)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof qs)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof Gs)return{fieldPath:t.field.ot(),increment:e.Qt};throw Xr()})),e.Gt.Wt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:ua(e=t,(t=i.updateTime).G())}:void 0!==i.exists?{exists:i.exists}:Xr()),n}function wa(t){var e=4===(o=la(t.parent)).length?xi.at():va(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Yr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ta(t.unaryFilter.field);return Vo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ta(t.unaryFilter.field);return Vo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Ta(t.unaryFilter.field),Vo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Ta(t.unaryFilter.field),Vo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Xr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Vo.create(Ta(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Xr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Xr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new as(Ta((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=no(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=_a(n.startAt));var u=null;return n.endAt&&(u=_a(n.endAt)),new ls(e,i,t,o,r,"F",s,u)}function ba(t){return{before:t.before,values:t.position}}function _a(t){var e=!!t.before,t=t.values||[];return new ns(t,e)}function Ea(t){return{fieldPath:t.ot()}}function Ta(t){return Ui._t(t.fieldPath)}function Ia(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Na=(Oa.prototype.catch=function(t){return this.next(void 0,t)},Oa.prototype.next=function(r,i){var o=this;return this.Fn&&Xr(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new Oa(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},Oa.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Oa.prototype.$n=function(t){try{var e=t();return e instanceof Oa?e:Oa.resolve(e)}catch(t){return Oa.reject(t)}},Oa.prototype.kn=function(t,e){return t?this.$n(function(){return t(e)}):Oa.resolve(e)},Oa.prototype.On=function(t,e){return t?this.$n(function(){return t(e)}):Oa.reject(e)},Oa.resolve=function(n){return new Oa(function(t,e){t(n)})},Oa.reject=function(n){return new Oa(function(t,e){e(n)})},Oa.Ln=function(t){return new Oa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Oa.Bn=function(t){for(var n=Oa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Oa.resolve(t):e()})}(r[e]);return n},Oa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},Oa);function Oa(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function Sa(t){return"IndexedDbTransactionError"===t.name}var Da=(La.Is=function(t,e,n,r,i){return(i=new La(t,e,Date.now()+n,r,i)).start(n),i},La.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},La.prototype.Ps=function(){return this.Rs()},La.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Es.reject(new oi(ii.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},La.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},La.prototype.clearTimeout=function(){null!==this.As&&(this.Ts(this),clearTimeout(this.As),this.As=null)},La);function La(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Ts=i,this.Es=new Aa,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function Ra(t,e){if(Jr("AsyncQueue",e+": "+t),Sa(t))return new oi(ii.UNAVAILABLE,e+": "+t);throw t}function Ca(t){this.ks=t}var o=(Ua.prototype.Vs=function(t){this.gs.push(t)},Ua.prototype.ps=function(){this.gs.forEach(function(t){return t()})},Ua),ka=(Va.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var l=this.mutations[h];l.key.isEqual(t)&&(r=l,u=e,i=c[h],l=a=void 0,e=r instanceof iu?(a=i,l=(o=r).value,a.transformResults&&(s=cu(o.fieldTransforms,u,a.transformResults),l=lu(o.fieldTransforms,l,s)),new Io(o.key,a.version,l,{hasCommittedMutations:!0})):r instanceof ou?(a=u,l=i,$s((u=r).Gt,a)?(a=au(u,a,l.transformResults?cu(u.fieldTransforms,a,l.transformResults):[]),new Io(u.key,l.version,a,{hasCommittedMutations:!0})):new No(u.key,l.version)):new Ao(r.key,i.version,{hasCommittedMutations:!0}))}return e},Va.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Zs(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Zs(i,e,0,this.Ss));return e},Va.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},Va.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Uu())},Va.prototype.isEqual=function(t){return this.batchId===t.batchId&&ti(this.mutations,t.mutations,tu)&&ti(this.baseMutations,t.baseMutations,tu)},Va),Pa=(xa.from=function(t,e,n){Yr(t.mutations.length===n.length);for(var r=xu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new xa(t,e,n,r)},xa);function xa(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}function Va(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function Ua(){this.gs=[]}function Ma(t){var e=wa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?bs(e,e.limit,"L"):e}var Fa=(Ha.prototype.Us=function(t,e){return this.qs.add(e),Na.resolve()},Ha.prototype.Qs=function(t,e){return Na.resolve(this.qs.getEntries(e))},Ha),qa=(ja.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Du(xi.J),t=!r.has(n);return this.index[e]=r.add(n),t},ja.prototype.has=function(t){var e=t.et(),t=t.Z();return(e=this.index[e])&&e.has(t)},ja.prototype.getEntries=function(t){return(this.index[t]||new Du(xi.J)).rt()},ja);function ja(){this.index={}}function Ha(){this.qs=new qa}function Ba(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==ii.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return zr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ga(t,e){this.progress=t,this.zo=e}var za=(rc.prototype.get=function(t){var e=this.si(t);if(void 0!==(e=this.ri[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.ii(i,t))return o}},rc.prototype.has=function(t){return void 0!==this.get(t)},rc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},rc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},rc.prototype.forEach=function(s){Ji(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},rc.prototype.nt=function(){return Ki(this.ri)},rc),je=(nc.prototype.ai=function(t){return(t=this.oi.get(t))?t.readTime:Pi.min()},nc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},nc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},nc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?Na.resolve(n.li):this.di(t,e)},nc.prototype.getEntries=function(t,e){return this.wi(t,e)},nc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ti(t)},nc.prototype.hi=function(){},nc),Ja=(ec.prototype.next=function(){return this.$i+=2,this.$i},ec.Li=function(){return new ec(0)},ec.Bi=function(){return new ec(-1)},ec),Ka=(tc.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},tc.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},tc.prototype.Xo=function(t,e,i){var o=Ru;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},tc.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},tc.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=Ru;return t.forEach(function(t,e){e=e||new Ao(t,Pi.min()),n=n.Ht(t,e)}),n})},tc.prototype.jr=function(t,e,n){return r=e,Mi.Tt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):gs(e)?this.nc(t,e,n):this.sc(t,e,n);var r},tc.prototype.ec=function(t,e){return this.Jo(t,new Mi(e)).next(function(t){var e=Pu;return t instanceof Io&&(e=e.Ht(t.key,t)),e})},tc.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=Pu;return this.Ei.Qs(n,s).next(function(t){return Na.forEach(t,function(t){var e=(e=r,t=t.child(s),new ls(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},tc.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.jr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key;a=(s=Zs(s,a.get(u),0,r.Ss))instanceof Io?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Is(n,e)||(a=a.remove(t))}),a})},tc.prototype.ic=function(t,e,n){for(var r=Uu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ou&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Io&&(c=c.Ht(t,e))}),c})},tc),Wa=(Za.cc=function(t,e){for(var n=Uu(),r=Uu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Za(t,e.fromCache,n,r)},Za),Xa=($a.prototype.ac=function(t){this.uc=t},$a.prototype.jr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(Pi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(ps(r)||ds(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(Gr()<=u.DEBUG&&zr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ts(r)),s.uc.jr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},$a.prototype.lc=function(n,t){var r=new Du(As(n));return t.forEach(function(t,e){e instanceof Io&&Is(n,e)&&(r=r.add(e))}),r},$a.prototype._c=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},$a.prototype.hc=function(t,e){return Gr()<=u.DEBUG&&zr("QueryEngine","Using full collection scan to execute query:",Ts(e)),this.uc.jr(t,e,Pi.min())},$a),Ya=(Qa.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},Qa);function Qa(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Eu(Zr),this.wc=new za(Co,ko),this.Tc=Pi.min(),this.Ho=t.Ko(n),this.Ec=t.Or(),this.fo=t.Dr(),this.Ic=new Ka(this.Ec,this.Ho,this.persistence.jo()),this.To=t.Wo(),this.fc.ac(this.Ic)}function $a(){}function Za(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function tc(t,e,n){this.wo=t,this.Ho=e,this.Ei=n}function ec(t){this.$i=t}function nc(){this.oi=new za(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function rc(t,e){this.si=t,this.ii=e,this.ri={}}function ic(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new Ka(e.Ec,n,e.persistence.jo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=Uu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function oc(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function sc(t,s,e,u,a){var n=Uu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Ru;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Ao&&e.version.isEqual(Pi.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):zr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function uc(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,Na.resolve(n)):i.fo.qi(e).next(function(t){return n=new Ns(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function ac(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Sa(r=t.sent()))throw r;return zr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function cc(t,o,s){var u=t,a=Pi.min(),c=Uu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ws(o),(void 0!==(t=(i=t).wc.get(r))?Na.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.jr(e,o,s?a:Pi.min(),s?c:Uu())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}var hc,lc,fc,pc=(Jc.prototype.Ms=function(t,e){return Na.resolve(this.bc.get(e))},Jc.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:ca(e.createTime)}),Na.resolve()},Jc.prototype.Ls=function(t,e){return Na.resolve(this.vc.get(e))},Jc.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:e.name,query:Ma(e.bundledQuery),readTime:ca(e.readTime)}),Na.resolve()},Jc),dc=(zc.prototype.nt=function(){return this.Sc.nt()},zc.prototype.sr=function(t,e){e=new yc(t,e),this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},zc.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},zc.prototype.rr=function(t,e){this.Fc(new yc(t,e))},zc.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},zc.prototype.kc=function(t){var e=this,n=new Mi(new xi([])),r=new yc(n,t),t=new yc(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},zc.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},zc.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},zc.prototype.$c=function(t){var e=new Mi(new xi([])),n=new yc(e,t),t=new yc(e,t+1),r=Uu();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},zc.prototype.ki=function(t){var e=new yc(t,0);return null!==(e=this.Sc.Pe(e))&&t.isEqual(e.key)},zc),yc=(Gc.Dc=function(t,e){return Mi.J(t.key,e.key)||Zr(t.Lc,e.Lc)},Gc.xc=function(t,e){return Zr(t.Lc,e.Lc)||Mi.J(t.key,e.key)},Gc),vc=(Bc.prototype.Ri=function(t){return Na.resolve(0===this.Ho.length)},Bc.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1],n=new ka(i,e,n,r),this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new yc(u.key,i)),this.Ei.Us(t,u.key.path.Z())}return Na.resolve(n)},Bc.prototype.yi=function(t,e){return Na.resolve(this.Uc(e))},Bc.prototype.Vi=function(t,e){return e+=1,e=(e=this.Qc(e))<0?0:e,Na.resolve(this.Ho.length>e?this.Ho[e]:null)},Bc.prototype.pi=function(){return Na.resolve(0===this.Ho.length?-1:this.Bc-1)},Bc.prototype.bi=function(t){return Na.resolve(this.Ho.slice())},Bc.prototype.vi=function(t,e){var n=this,r=new yc(e,0),e=new yc(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.Lc),i.push(t)}),Na.resolve(i)},Bc.prototype.Si=function(t,e){var n=this,r=new Du(Zr);return e.forEach(function(t){var e=new yc(t,0),t=new yc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.Lc)})}),Na.resolve(this.Kc(r))},Bc.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;Mi.Tt(e)||(e=e.child(""));var e=new yc(new Mi(e),0),i=new Du(Zr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),Na.resolve(this.Kc(i))},Bc.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Uc(t))&&n.push(t)}),n},Bc.prototype.xi=function(n,r){var i=this;Yr(0===this.jc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return Na.forEach(r.mutations,function(t){var e=new yc(t.key,r.batchId);return o=o.delete(e),i.Ii.Fi(n,t.key)}).next(function(){i.qc=o})},Bc.prototype.Ni=function(t){},Bc.prototype.ki=function(t,e){var n=new yc(e,0),n=this.qc.Pe(n);return Na.resolve(e.isEqual(n&&n.key))},Bc.prototype.Oi=function(t){return this.Ho.length,Na.resolve()},Bc.prototype.jc=function(t,e){return this.Qc(t)},Bc.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},Bc.prototype.Uc=function(t){return(t=this.Qc(t))<0||t>=this.Ho.length?null:this.Ho[t]},Bc),gc=(Hc.prototype.ui=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:o,readTime:n}),this.size+=o-i,this.Ei.Us(t,r.path.Z())},Hc.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Hc.prototype.fi=function(t,e){return e=this.docs.get(e),Na.resolve(e?e.li:null)},Hc.prototype.getEntries=function(t,e){var n=this,r=Ru;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),Na.resolve(r)},Hc.prototype.jr=function(t,e,n){for(var r=Pu,i=new Mi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=(u=o.ce()).key,u=(a=u.value).li,a=a.readTime;if(!e.path.st(s.path))break;a.u(n)<=0||u instanceof Io&&Is(e,u)&&(r=r.Ht(u.key,u))}return Na.resolve(r)},Hc.prototype.Gc=function(t,e){return Na.forEach(this.docs,function(t){return e(t)})},Hc.prototype.Fr=function(t){return new mc(this)},Hc.prototype.Mr=function(t){return Na.resolve(this.size)},Hc),mc=(l(jc,fc=je),jc.prototype.Ti=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),Na.Ln(i)},jc.prototype.di=function(t,e){return this.Gr.fi(t,e)},jc.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},jc),wc=(qc.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),Na.resolve()},qc.prototype.Ki=function(t){return Na.resolve(this.lastRemoteSnapshotVersion)},qc.prototype.ji=function(t){return Na.resolve(this.Hc)},qc.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),Na.resolve(this.highestTargetId)},qc.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),Na.resolve()},qc.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Ja(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},qc.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,Na.resolve()},qc.prototype.Ji=function(t,e){return this.zi(e),Na.resolve()},qc.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,Na.resolve()},qc.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),Na.Ln(u).next(function(){return s})},qc.prototype.tr=function(t){return Na.resolve(this.targetCount)},qc.prototype.er=function(t,e){return e=this.zc.get(e)||null,Na.resolve(e)},qc.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),Na.resolve()},qc.prototype.ir=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Fi(e,t))}),Na.Ln(i)},qc.prototype.Xi=function(t,e){return this.Jc.kc(e),Na.resolve()},qc.prototype.cr=function(t,e){return e=this.Jc.$c(e),Na.resolve(e)},qc.prototype.ki=function(t,e){return Na.resolve(this.Jc.ki(e))},qc),bc=(Fc.prototype.start=function(){return Promise.resolve()},Fc.prototype.$o=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(Fc.prototype,"Er",{get:function(){return this.ro},enumerable:!1,configurable:!0}),Fc.prototype.yo=function(){},Fc.prototype.Vo=function(){},Fc.prototype.jo=function(){return this.Ei},Fc.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new vc(this.Ei,this.Ii),this.Xc[t.R()]=e),e},Fc.prototype.Dr=function(){return this.fo},Fc.prototype.Or=function(){return this.wo},Fc.prototype.Wo=function(){return this.To},Fc.prototype.runTransaction=function(t,e,n){var r=this;zr("MemoryPersistence","Starting transaction:",t);var i=new _c(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},Fc.prototype.na=function(e,n){return Na.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},Fc),_c=(l(Mc,lc=o),Mc),Ec=(Uc.ra=function(t){return new Uc(t)},Object.defineProperty(Uc.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Xr()},enumerable:!1,configurable:!0}),Uc.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),Na.resolve()},Uc.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),Na.resolve()},Uc.prototype.Fi=function(t,e){return this.oa.add(e.toString()),Na.resolve()},Uc.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},Uc.prototype.ta=function(){this.ia=new Set},Uc.prototype.ea=function(n){var r=this,i=this.persistence.Or().Fr();return Na.forEach(this.oa,function(t){var e=Mi.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},Uc.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},Uc.prototype.Zc=function(t){return 0},Uc.prototype.ca=function(t,e){var n=this;return Na.Bn([function(){return Na.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},Uc),Tc=(Vc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Vc.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Vc.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Vc),Ic=(xc.prototype.xa=function(t){},xc.prototype.Fa=function(t,e,n){},xc.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},xc.prototype.qa=function(t,e,n){this.ou[t]=e},xc.prototype.$a=function(t){this.ru.la(t)},xc.prototype.La=function(t){return this.ru.activeTargetIds.has(t)},xc.prototype.Ba=function(t){delete this.ou[t]},xc.prototype.Sa=function(){return this.ru.activeTargetIds},xc.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},xc.prototype.start=function(){return this.ru=new Tc,Promise.resolve()},xc.prototype.Qa=function(t,e,n){},xc.prototype.Ka=function(t){},xc.prototype.$o=function(){},xc.prototype.q=function(t){},xc.prototype.Wa=function(){},xc),Ac=(Pc.prototype.cu=function(t){},Pc.prototype.$o=function(){},Pc),Nc=(kc.prototype.cu=function(t){this._u.push(t)},kc.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},kc.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},kc.prototype.uu=function(){zr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},kc.prototype.lu=function(){zr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},kc.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},kc),Oc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Sc=(Cc.prototype.Tu=function(t){this.Eu=t},Cc.prototype.Iu=function(t){this.mu=t},Cc.prototype.onMessage=function(t){this.Au=t},Cc.prototype.Ru=function(t){this.Pu=t},Cc.prototype.close=function(){this.wu()},Cc.prototype.send=function(t){this.du(t)},Cc.prototype.yu=function(){this.Eu()},Cc.prototype.gu=function(t){this.mu(t)},Cc.prototype.Vu=function(t){this.Au(t)},Cc.prototype.pu=function(t,e){this.Pu(t,e)},Cc),Dc=(Rc.prototype.Du=function(e,t,n,r){var i=this.Cu(e,t);return zr("RestConnection","Sending: ",i,n),t={},this.xu(t,r),this.Nu(e,i,t,n).then(function(t){return zr("RestConnection","Received: ",t),t},function(t){throw Kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Rc.prototype.Fu=function(t,e,n,r){return this.Du(t,e,n,r)},Rc.prototype.xu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2-longpoll.66863f547",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Rc.prototype.Cu=function(t,e){return t=Oc[t],this.vu+"/v1/"+e+":"+t},l(Lc,hc=Rc),Lc.prototype.Nu=function(o,e,s,u){return new Promise(function(n,r){var i=new jr;i.listenOnce(Mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case Ur.NO_ERROR:var t=i.getResponseJson();zr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case Ur.TIMEOUT:zr("Connection",'RPC "'+o+'" timed out'),r(new oi(ii.DEADLINE_EXCEEDED,"Request time out"));break;case Ur.HTTP_ERROR:var e=i.getStatus();zr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(ii).indexOf(e)?e:ii.UNKNOWN,r(new oi(e,t.message))):r(new oi(ii.UNKNOWN,"Server responded with status "+i.getStatus())):r(new oi(ii.UNAVAILABLE,"Connection failed."));break;default:Xr()}}finally{zr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Lc.prototype.Ou=function(t,e){var n,r=[this.vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Rr,o=Vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.xu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),zr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=(new Date).getTime(),h=new Sc({du:function(t){a?zr("Connection","Not sending because WebChannel is closed:",t):(u||(zr("Connection","Opening WebChannel transport."),s.open(),u=!0),zr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,qr.EventType.OPEN,function(){a||zr("Connection","WebChannel transport opened.")}),t(s,qr.EventType.CLOSE,function(){a||(a=!0,zr("Connection","WebChannel transport closed"),h.gu())}),t(s,qr.EventType.ERROR,function(t){a||(a=!0,Kr("Connection","WebChannel transport errored:",t),h.gu(new oi(ii.UNAVAILABLE,"The operation could not be completed")))}),t(s,qr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Yr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(zr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=pu[r];if(void 0!==t)return _u(t)}(),i=n.message,void 0===t&&(t=ii.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.gu(new oi(t,i)),s.close()):(zr("Connection","WebChannel received:",e),h.Vu(e)))}),t(o,Fr.STAT_EVENT,function(t){var e=(new Date).getTime()-c;10===t.stat?(zr("Connection","Detected buffering proxy"),h.pu(!0,e)):11===t.stat&&(zr("Connection","Detected no buffering proxy"),h.pu(!1,e))}),setTimeout(function(){h.yu()},0),h},Lc);function Lc(t){var e=this;return(e=hc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Rc(t){this.bu=t,this.T=t.T;var e=t.ssl?"https":"http";this.vu=e+"://"+t.host,this.Su="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Cc(t){this.du=t.du,this.wu=t.wu}function kc(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function Pc(){}function xc(){this.ru=new Tc,this.ou={},this.da=null,this.$=null}function Vc(){this.activeTargetIds=Mu}function Uc(t){this.persistence=t,this.sa=new dc,this.ia=null}function Mc(t){var e=this;return(e=lc.call(this)||this).vs=t,e}function Fc(t,e){var n=this;this.Xc={},this.io=new Ai(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new wc(this),this.Ei=new Fa,this.wo=(t=this.Ei,new gc(t,function(t){return n.Ii.Zc(t)})),this.Kt=new Ca(e),this.To=new pc(this.Kt)}function qc(t){this.persistence=t,this.zc=new za(Co,ko),this.lastRemoteSnapshotVersion=Pi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new dc,this.targetCount=0,this.Yc=Ja.Li()}function jc(t){var e=this;return(e=fc.call(this)||this).Gr=t,e}function Hc(t,e){this.Ei=t,this.Wc=e,this.docs=new Eu(Mi.J),this.size=0}function Bc(t,e){this.Ei=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new Du(yc.Dc)}function Gc(t,e){this.key=t,this.Lc=e}function zc(){this.Sc=new Du(yc.Dc),this.Cc=new Du(yc.xc)}function Jc(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function Kc(){return"undefined"!=typeof document?document:null}function Wc(t){return new sa(t,!0)}function Xc(t,e,n,r,i){var o=this;this.xh=t,this.Nh=e,this.fs=n,this.Fh={},this.Oh=[],this.kh=new Map,this.Mh=new Set,this.$h=[],this.Lh=i,this.Lh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return mh(this)?(zr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mh.add(4),[4,lh(e)];case 1:return t.sent(),e.Bh.set("Unknown"),e.Mh.delete(4),[4,hh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bh=new rh(n,r)}var Yc,Qc,$c,Zc=(ch.prototype.reset=function(){this.Lu=0},ch.prototype.Uu=function(){this.Lu=this.$u},ch.prototype.Qu=function(t){var e=this;this.cancel();var n=Math.floor(this.Lu+this.Ku()),r=Math.max(0,Date.now()-this.qu),i=Math.max(0,n-r);0<i&&zr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Lu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Bu=this.eo.Ir(this.ds,i,function(){return e.qu=Date.now(),t()}),this.Lu*=this.Mu,this.Lu<this.ku&&(this.Lu=this.ku),this.Lu>this.$u&&(this.Lu=this.$u)},ch.prototype.ju=function(){null!==this.Bu&&(this.Bu.Ps(),this.Bu=null)},ch.prototype.cancel=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},ch.prototype.Ku=function(){return(Math.random()-.5)*this.Lu},ch),je=(ah.prototype.Xu=function(){return 1===this.state||2===this.state||4===this.state},ah.prototype.Zu=function(){return 2===this.state},ah.prototype.start=function(){3!==this.state?this.auth():this.th()},ah.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Xu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ah.prototype.eh=function(){this.state=0,this.Yu.reset()},ah.prototype.nh=function(){var t=this;this.Zu()&&null===this.Ju&&(this.Ju=this.eo.Ir(this.Wu,6e4,function(){return t.sh()}))},ah.prototype.ih=function(t){this.rh(),this.stream.send(t)},ah.prototype.sh=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Zu()?[2,this.close(0)]:[2]})})},ah.prototype.rh=function(){this.Ju&&(this.Ju.cancel(),this.Ju=null)},ah.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.rh(),this.Yu.cancel(),this.Hu++,3!==e?this.Yu.reset():n&&n.code===ii.RESOURCE_EXHAUSTED?(Jr(n.toString()),Jr("Using maximum backoff delay to prevent overloading the backend."),this.Yu.Uu()):n&&n.code===ii.UNAUTHENTICATED&&this.zu.v(),null!==this.stream&&(this.oh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},ah.prototype.oh=function(){},ah.prototype.Ru=function(t,e){this.listener.Ru(t,e)},ah.prototype.auth=function(){var n=this;this.state=1;var t=this.ah(this.Hu),e=this.Hu;this.zu.getToken().then(function(t){n.Hu===e&&n.uh(t)},function(e){t(function(){var t=new oi(ii.UNKNOWN,"Fetching auth token failed: "+e.message);return n.hh(t)})})},ah.prototype.uh=function(t){var r=this,i=this.ah(this.Hu);this.stream=this.lh(t),this.stream.Tu(function(){i(function(){return r.state=2,r.listener.Tu()})}),this.stream.Iu(function(t){i(function(){return r.hh(t)})}),this.stream.onMessage(function(t){i(function(){return r.onMessage(t)})}),this.stream.Ru(function(e,n){i(function(){return y(r,void 0,void 0,function(){return v(this,function(t){return[2,this.Ru(e,n)]})})})})},ah.prototype.th=function(){var t=this;this.state=4,this.Yu.Qu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ah.prototype.hh=function(t){return zr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ah.prototype.ah=function(e){var n=this;return function(t){n.eo.ys(function(){return n.Hu===e?t():(zr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ah),th=(l(uh,$c=je),uh.prototype.lh=function(t){return this.Gu.Ou("Listen",t)},uh.prototype.onMessage=function(t){this.Yu.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Xr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Yr(void 0===s||"string"==typeof s),ei.fromBase64String(s||"")):(Yr(void 0===s||s instanceof Uint8Array),ei.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?ii.UNKNOWN:_u(c.code),new oi(a,c.message||"")),s=new Ju(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=pa(t,n.document.name),i=ca(n.document.updateTime);var u=new go({mapValue:{fields:n.document.fields}}),a=(o=new Io(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new Gu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=pa(t,n.document),i=n.readTime?ca(n.readTime):Pi.min(),u=new Ao(r,i),o=n.removedTargetIds||[],s=new Gu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=pa(t,n.document),i=n.removedTargetIds||[],s=new Gu([],i,r,null);else{if(!("filter"in e))return Xr();e.filter,(e=e.filter).targetId,r=new fu(n=e.count||0),i=e.targetId,s=new zu(i,r)}return s}(this.Kt,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Pi.min():ca(e.readTime);return this.listener._h(n,t)},uh.prototype.fh=function(t){var e,n,r,i,o,s,u,a,c={};c.database=ya(this.Kt),c.addTarget=(e=this.Kt,(r=Po(r=(n=t).target)?{documents:{documents:[da(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=da(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=da(i,u.Z()),s.structuredQuery.from=[{collectionId:u.et()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(yo(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NAN"}};if(po(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(yo(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NAN"}};if(po(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ea(t.field),op:(e=t.op,oa[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Ea(t.field),direction:(t=t.dir,ia[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.qt||no(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=ba(o.startAt)),o.endAt&&(s.structuredQuery.endAt=ba(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=aa(e,n.resumeToken):0<n.Mt.u(Pi.min())&&(r.readTime=ua(e,n.Mt.G())),r),(t=(this.Kt,a=t,null==(t=function(){switch(a.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xr()}}())?null:{"goog-listen-tags":t}))&&(c.labels=t),this.ih(c)},uh.prototype.dh=function(t){var e={};e.database=ya(this.Kt),e.removeTarget=t,this.ih(e)},uh),eh=(l(sh,Qc=je),Object.defineProperty(sh.prototype,"Th",{get:function(){return this.wh},enumerable:!1,configurable:!0}),sh.prototype.start=function(){this.wh=!1,this.lastStreamToken=void 0,Qc.prototype.start.call(this)},sh.prototype.oh=function(){this.wh&&this.Eh([])},sh.prototype.lh=function(t){return this.Gu.Ou("Write",t)},sh.prototype.onMessage=function(t){if(Yr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.wh){this.Yu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Yr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?ca(e.updateTime):ca(n)).isEqual(Pi.min())&&(t=ca(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Xs(t,n);var e,n})):[]),n=ca(t.commitTime);return this.listener.Ih(n,e)}var r;return Yr(!t.writeResults||0===t.writeResults.length),this.wh=!0,this.listener.mh()},sh.prototype.Ah=function(){var t={};t.database=ya(this.Kt),this.ih(t)},sh.prototype.Eh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ma(e.Kt,t)})};this.ih(t)},sh),nh=(l(oh,Yc=function(){}),oh.prototype.Ph=function(){if(this.Rh)throw new oi(ii.FAILED_PRECONDITION,"The client has already been terminated.")},oh.prototype.Du=function(e,n,r){var i=this;return this.Ph(),this.credentials.getToken().then(function(t){return i.Gu.Du(e,n,r,t)}).catch(function(t){throw t.code===ii.UNAUTHENTICATED&&i.credentials.v(),t})},oh.prototype.Fu=function(e,n,r){var i=this;return this.Ph(),this.credentials.getToken().then(function(t){return i.Gu.Fu(e,n,r,t)}).catch(function(t){throw t.code===ii.UNAUTHENTICATED&&i.credentials.v(),t})},oh.prototype.terminate=function(){this.Rh=!1},oh),rh=(ih.prototype.ph=function(){var t=this;0===this.yh&&(this.bh("Unknown"),this.gh=this.fs.Ir("online_state_timeout",1e4,function(){return t.gh=null,t.Sh("Backend didn't respond within 10 seconds."),t.bh("Offline"),Promise.resolve()}))},ih.prototype.Dh=function(t){"Online"===this.state?this.bh("Unknown"):(this.yh++,1<=this.yh&&(this.Ch(),this.Sh("Connection failed 1 times. Most recent error: "+t.toString()),this.bh("Offline")))},ih.prototype.set=function(t){this.Ch(),this.yh=0,"Online"===t&&(this.Vh=!1),this.bh(t)},ih.prototype.bh=function(t){t!==this.state&&(this.state=t,this.da(t))},ih.prototype.Sh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Vh?(Jr(t),this.Vh=!1):zr("OnlineStateTracker",t)},ih.prototype.Ch=function(){null!==this.gh&&(this.gh.cancel(),this.gh=null)},ih);function ih(t,e){this.fs=t,this.da=e,this.state="Unknown",this.yh=0,this.gh=null,this.Vh=!0}function oh(t,e,n){var r=this;return(r=Yc.call(this)||this).credentials=t,r.Gu=e,r.Kt=n,r.Rh=!1,r}function sh(t,e,n,r,i){var o=this;return(o=Qc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o.wh=!1,o}function uh(t,e,n,r,i){var o=this;return(o=$c.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function ah(t,e,n,r,i,o){this.eo=t,this.Wu=n,this.Gu=r,this.zu=i,this.listener=o,this.state=0,this.Hu=0,this.Ju=null,this.stream=null,this.Yu=new Zc(t,e)}function ch(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.ku=n,this.Mu=r,this.$u=i,this.Lu=0,this.Bu=null,this.qu=Date.now(),this.reset()}function hh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!mh(r))return[3,4];e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function lh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function fh(t,e){t.kh.has(e.targetId)||(t.kh.set(e.targetId,e),gh(t)?vh(t):Nh(t).Zu()&&dh(t,e))}function ph(t,e){var n=t,t=Nh(n);n.kh.delete(e),t.Zu()&&yh(n,e),0===n.kh.size&&(t.Zu()?t.nh():mh(n)&&n.Bh.set("Unknown"))}function dh(t,e){t.qh.cn(e.targetId),Nh(t).fh(e)}function yh(t,e){t.qh.cn(e),Nh(t).dh(e)}function vh(e){e.qh=new Wu({Sn:function(t){return e.Fh.Sn(t)},Dn:function(t){return e.kh.get(t)||null}}),Nh(e).start(),e.Bh.ph()}function gh(t){return mh(t)&&!Nh(t).Xu()&&0<t.kh.size}function mh(t){return 0===t.Mh.size}function wh(t){t.qh=void 0}function bh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Sa(r))throw r;return n.Mh.add(1),[4,lh(n)];case 1:return t.sent(),n.Bh.set("Offline"),i=i||function(){return oc(n.xh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return zr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mh.delete(1),[4,hh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function _h(e,n){return n().catch(function(t){return bh(e,t,n)})}function Eh(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=Oh(o=c),u=0<o.Oh.length?o.Oh[o.Oh.length-1].batchId:-1,t.label=1;case 1:if(!(mh(o)&&o.Oh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.xh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ho.Vi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Oh.length&&s.nh(),[3,7]):(u=a.batchId,e=a,(n=o).Oh.push(e),(n=Oh(n)).Zu()&&n.Th&&n.Eh(e.mutations),[3,6]);case 4:return a=t.sent(),[4,bh(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Th(o)&&Ih(o),[2]}var e,n,r,i})})}function Th(t){return mh(t)&&!Oh(t).Xu()&&0<t.Oh.length}function Ih(t){Oh(t).start()}function Ah(t,e,n){t.Fh.Kh&&t.Fh.Kh(e,n)}function Nh(n){var t,e,r,i=this;return n.Gh||(n.Gh=(t=n.Nh,e=n.fs,r={Tu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.kh.forEach(function(t,e){dh(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return wh(e),gh(e)?(e.Bh.Dh(n),vh(e)):e.Bh.set("Unknown"),[2]})})}.bind(null,n),_h:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bh.set("Online"),!(u instanceof Ju&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.kh.has(i)?[4,o.Fh.Uh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.kh.delete(i),o.qh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),zr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,bh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Gu?s.qh.wn(u):u instanceof zu?s.qh.yn(u):s.qh.In(u),a.isEqual(Pi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,oc(s.xh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).qh.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.kh.get(e))&&r.kh.set(e,n.Lt(t.resumeToken,i))}),e.ke.forEach(function(t){var e=r.kh.get(t);e&&(r.kh.set(t,e.Lt(ei.h,e.Mt)),yh(r,t),e=new Ns(e.target,t,1,e.sequenceNumber),dh(r,e))}),r.Fh.Qh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return zr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,bh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n),Ru:Ah.bind(null,n)},t.Ph(),new th(e,t.Gu,t.credentials,t.Kt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gh.eh(),gh(n)?vh(n):n.Bh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Gh.stop()];case 2:t.sent(),wh(n),t.label=3;case 3:return[2]}})})})),n.Gh}function Oh(n){var t,e,r,i=this;return n.zh||(n.zh=(t=n.Nh,e=n.fs,r={Tu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Oh(e).Ah(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Oh(e).Th?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return bu(n=i.code)&&n!==ii.ABORTED?(e=r.Oh.shift(),Oh(r).eh(),[4,_h(r,function(){return r.Fh.Wh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Eh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Th(e)&&Ih(e),[2]}})})}.bind(null,n),mh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Oh(o),n=0,r=o.Oh;n<r.length;n++)i=r[n],e.Eh(i.mutations);return[2]})})}.bind(null,n),Ih:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Oh.shift(),n=Pa.from(e,i,o),[4,_h(r,function(){return r.Fh.jh(n)})];case 1:return t.sent(),[4,Eh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n),Ru:Ah.bind(null,n)},t.Ph(),new eh(e,t.Gu,t.credentials,t.Kt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.zh.eh(),[4,Eh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.zh.stop()];case 3:t.sent(),0<n.Oh.length&&(zr("RemoteStore","Stopping write stream with "+n.Oh.length+" pending writes"),n.Oh=[]),t.label=4;case 4:return[2]}})})})),n.zh}function Sh(){this.queries=new za(Es,_s),this.onlineState="Unknown",this.Jh=new Set}var Dh=function(){this.Hh=void 0,this.listeners=[]};function Lh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Dh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Yh(n)];case 2:return o.Hh=t.sent(),[3,4];case 3:return o=Ra(o=t.sent(),"Initialization of query '"+Ts(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Xh(e.onlineState),i.Hh&&u.Zh(i.Hh)&&Ch(e),[2]}})})}function Rh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.tl(n))]:[2]})})}function Ch(t){t.Jh.forEach(function(t){t.next()})}var kh=(qh.prototype.Zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ju(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.nl?this.il(t)&&(this.el.next(t),o=!0):this.rl(t,this.onlineState)&&(this.ol(t),o=!0),this.sl=t,o},qh.prototype.onError=function(t){this.el.error(t)},qh.prototype.Xh=function(t){this.onlineState=t;var e=!1;return this.sl&&!this.nl&&this.rl(this.sl,t)&&(this.ol(this.sl),e=!0),e},qh.prototype.rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.cl&&n||t.docs.nt()&&"Offline"!==e)},qh.prototype.il=function(t){if(0<t.docChanges.length)return!0;var e=this.sl&&this.sl.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},qh.prototype.ol=function(t){t=ju.Fe(t.query,t.docs,t.Ce,t.fromCache),this.nl=!0,this.el.next(t)},qh),Ph=(Fh.prototype.al=function(){return"metadata"in this.payload},Fh),xh=(Mh.prototype.yc=function(t){return pa(this.Kt,t)},Mh.prototype.gc=function(t){return t.metadata.exists?(r=pa(this.Kt,(n=t.document).name),e=ca(n.updateTime),n=new go({mapValue:{fields:n.fields}}),new Io(r,e,n,{hasCommittedMutations:!1})):new Ao(this.yc(t.metadata.name),this.Vc(t.metadata.readTime));var e,n,r},Mh.prototype.Vc=ca,Mh),Vh=(Uh.prototype.hl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Uh.prototype.ll=function(t){for(var e=new Map,n=new xh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Uu()).add(s);e.set(c,h)}}return e},Uh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,f,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=l,r=Uu(),i=Ru,o=xu,e=0,s=p;e<s.length;e++)u=s[e],a=f.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,f.gc(u)),o=o.Ht(a,f.Vc(u.metadata.readTime));return c=n.Ec.Fr({Wr:!0}),[4,uc(n,ws(fs(xi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return sc(e,c,i,Pi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.xh,new xh(this.Kt),this.documents,this.ul.id)];case 1:e=t.sent(),n=this.ll(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Uu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,uc(e,ws(Ma(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ca(i.readTime);return 0<=n.Mt.u(e)?r.To.Bs(t,i):(e=n.Lt(ei.h,e),r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.To.Bs(t,i)}))})]}})})}(this.xh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ga(Object.assign({},this.progress),e))]}})})},Uh);function Uh(t,e,n){this.ul=t,this.xh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=jh(t)}function Mh(t){this.Kt=t}function Fh(t,e){this.payload=t,this.byteLength=e}function qh(t,e,n){this.query=t,this.el=e,this.nl=!1,this.sl=null,this.onlineState="Unknown",this.options=n||{}}function jh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Hh=function(t){this.key=t},Bh=function(t){this.key=t},Gh=(Object.defineProperty(Xh.prototype,"El",{get:function(){return this._l},enumerable:!1,configurable:!0}),Xh.prototype.Il=function(t,e){var s=this,u=e?e.ml:new qu,a=(e||this).Tl,c=(e||this).Ce,h=a,l=!1,f=ps(this.query)&&a.size===this.query.limit?a.last():null,p=ds(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof Io?e:null)&&(Is(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Al(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.wl(r,f)||p&&s.wl(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),ps(this.query)||ds(this.query))for(;h.size>this.query.limit;){var n=ps(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Tl:h,ml:u,_c:l,Ce:c}},Xh.prototype.Al=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},Xh.prototype.Ti=function(t,e,n){var o=this,r=this.Tl;this.Tl=t.Tl,this.Ce=t.Ce;var i=t.ml.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.wl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xr()}}var r,i}),this.Rl(n);var s=e?this.Pl():[],e=(n=0===this.dl.size&&this.qe?1:0)!==this.fl;return this.fl=n,0!==i.length||e?{snapshot:new ju(this.query,t.Tl,r,i,t.Ce,0==n,e,!1),yl:s}:{yl:s}},Xh.prototype.Xh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({Tl:this.Tl,ml:new qu,Ce:this.Ce,_c:!1},!1)):{yl:[]}},Xh.prototype.gl=function(t){return!this._l.has(t)&&!!this.Tl.has(t)&&!this.Tl.get(t).bt},Xh.prototype.Rl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e._l=e._l.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e._l=e._l.delete(t)}),this.qe=t.qe)},Xh.prototype.Pl=function(){var e=this;if(!this.qe)return[];var n=this.dl;this.dl=Uu(),this.Tl.forEach(function(t){e.gl(t.key)&&(e.dl=e.dl.add(t.key))});var r=[];return n.forEach(function(t){e.dl.has(t)||r.push(new Bh(t))}),this.dl.forEach(function(t){n.has(t)||r.push(new Hh(t))}),r},Xh.prototype.Vl=function(t){return this._l=t.Pc,this.dl=Uu(),t=this.Il(t.documents),this.Ti(t,!0)},Xh.prototype.pl=function(){return ju.Fe(this.query,this.Tl,this.Ce,0===this.fl)},Xh),zh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Jh=function(t){this.key=t,this.bl=!1},Kh=(Object.defineProperty(Wh.prototype,"jl",{get:function(){return!0===this.Kl},enumerable:!1,configurable:!0}),Wh);function Wh(t,e,n,r,i,o,s){this.xh=t,this.vl=e,this.Sl=n,this.Dl=r,this.currentUser=i,this.Cl=o,this.xl=s,this.Nl={},this.Fl=!1,this.Ol=new za(Es,_s),this.kl=new Map,this.Ml=[],this.$l=new Eu(Mi.J),this.Ll=new Map,this.Bl=new dc,this.ql={},this.Ul=new Map,this.Ql=Ja.Bi(),this.onlineState="Unknown",this.Kl=void 0}function Xh(t,e){this.query=t,this._l=e,this.fl=null,this.qe=!1,this.dl=Uu(),this.Ce=Uu(),this.wl=As(t),this.Tl=new Fu(this.wl)}function Yh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).vl.Fh.jh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.xh,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.Ec.Fr({Wr:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Na.resolve();return a.forEach(function(n){c=c.next(function(){return s.fi(o,n)}).next(function(t){var e=t;Yr(null!==(t=r.Os.get(n))),(!e||e.version.u(t)<0)&&(e=u.Ds(n,e,r))&&s.ui(e,r.Fs)})}),c.next(function(){return i.Ho.xi(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Ho.Oi(t)}).next(function(){return l.Ic.Zo(t,e)})}))];case 2:return i=t.sent(),el(n,r,null),tl(n,r),n.Dl.Fa(r,"acknowledged"),[4,sl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,o),o.vl.Fh.Wh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.xh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return Yr(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Oi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),el(n,u,a),tl(n,u),n.Dl.Fa(u,"rejected",a),[4,sl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.xh,a=p,h=r,l=ki.now(),i=a.reduce(function(t,e){return t.add(e.key)},Uu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Io?e.field(o.field):void 0;null!=(s=Rs(o.transform,s||null))&&(n=(null==n?new mo:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new ou(o.key,s,function s(t){var u=[];return Ji(t.fields||{},function(t,e){var n=new Ui([t]);if(vo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Wi(u)}(s.proto.mapValue),Ys.exists(!0)))}return h.Ho.Pi(u,l,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.Dl.xa(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.ql[e.currentUser.R()])||new Eu(Zr)).Ht(n,o),e.ql[e.currentUser.R()]=r,[4,sl(u,s.oi)];case 3:return t.sent(),[4,Eh(u.vl)];case 4:return t.sent(),[3,6];case 5:return u=Ra(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,l,i,o})})}function Qh(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.xh,a=e,c=(r=s).Mt,h=a.dc,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Fr({Wr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.Lt(i,c).$t(s.vs),h=h.Ht(e,n),r=o,i=t,Yr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.W()-r.Mt.W()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=Ru;return r.Me.forEach(function(t,e){r.$e.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(sc(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(Pi.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.Wi(s,s.vs,c)}),u.push(e)),Na.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t}))];case 2:return i=t.sent(),s.Oe.forEach(function(t,e){(e=n.Ll.get(e))&&(Yr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.bl=!0:0<t.Qe.size?Yr(e.bl):0<t.Ke.size&&(Yr(e.bl),e.bl=!1))}),[4,sl(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function $h(t,n,e){var r;((t=t).jl&&0===e||!t.jl&&1===e)&&(r=[],t.Ol.forEach(function(t,e){(e=e.view.Xh(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Xh(i)&&(o=!0)}),o&&Ch(t)}(t.Sl,n),r.length&&t.Nl._h(r),t.onlineState=n,t.jl&&t.Dl.Ka(n))}function Zh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:mh((n=o).vl)||zr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.xh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Ul.get(r)||[]).push(s),n.Ul.set(r,i),[3,4]);case 3:return i=Ra(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function tl(t,e){(t.Ul.get(e)||[]).forEach(function(t){t.resolve()}),t.Ul.delete(e)}function el(t,e,n){var r=t,i=r.ql[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.ql[r.currentUser.R()]=i)}function nl(e,t,n){void 0===n&&(n=null),e.Dl.$a(t);for(var r=0,i=e.kl.get(t);r<i.length;r++){var o=i[r];e.Ol.delete(o),n&&e.Nl.Gl(o,n)}e.kl.delete(t),e.jl&&e.Bl.kc(t).forEach(function(t){e.Bl.ki(t)||rl(e,t)})}function rl(t,e){var n=t.$l.get(e);null!==n&&(ph(t.vl,n),t.$l=t.$l.remove(e),t.Ll.delete(n),ol(t))}function il(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Hh?(t.Bl.sr(u.key,e),r=t,i=(i=u).key,r.$l.get(i)||(zr("SyncEngine","New document in limbo: "+i),r.Ml.push(i),ol(r))):u instanceof Bh?(zr("SyncEngine","Document no longer in limbo: "+u.key),t.Bl.rr(u.key,e),t.Bl.ki(u.key)||rl(t,u.key)):Xr()}}function ol(t){for(;0<t.Ml.length&&t.$l.size<t.Cl;){var e=t.Ml.shift(),n=t.Ql.next();t.Ll.set(n,new Jh(e)),t.$l=t.$l.Ht(e,n),fh(t.vl,new Ns(ws(fs(e.path)),n,2,Ai.U))}}function sl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ol.nt()?[3,3]:(n.Ol.forEach(function(t,e){o.push(n.Wl(e,s,u).then(function(t){t&&(n.jl&&n.Dl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Wa.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Nl._h(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Na.forEach(c,function(e){return Na.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return Na.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Sa(e=t.sent()))throw e;return zr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.xh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function ul(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.xh,o=r,s=ca((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.To.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.zl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Hl(jh(u)),a=new Vh(u,f.xh,p.Kt),[4,p.Jl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.hl(c)]:[3,10];case 7:return(h=t.sent())&&d.Hl(h),[4,p.Jl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,sl(f,l.zo,void 0)];case 12:return t.sent(),[4,(r=f.xh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.To.$s(t,e)}))];case 13:return t.sent(),d.zl(l.progress),[3,15];case 14:return Kr("SyncEngine","Loading bundle failed with "+(l=t.sent())),d.Yl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Dl.Wa()})}var al=(ll.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=Wc(e.bu.T),this.Dl=this.Xl(e),this.persistence=this.Zl(e),[4,this.persistence.start()];case 1:return t.sent(),this.t_=this.e_(e),this.xh=this.n_(e),[2]}})})},ll.prototype.e_=function(t){return null},ll.prototype.n_=function(t){return e=this.persistence,n=new Xa,r=t.s_,t=this.Kt,new Ya(e,n,r,t);var e,n,r},ll.prototype.Zl=function(t){return new bc(Ec.ra,this.Kt)},ll.prototype.Xl=function(t){return new Ic},ll.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.t_&&this.t_.stop(),[4,this.Dl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},ll),cl=(hl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.xh?[3,2]:(this.xh=n.xh,this.Dl=n.Dl,this.Nh=this.r_(r),this.vl=this.o_(r),this.Sl=this.c_(r),this.fa=this.a_(r,!n.synchronizeTabs),this.Dl.da=function(t){return $h(e.fa,t,1)},this.vl.Fh.u_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(zr("SyncEngine","User change. New user:",o.R()),[4,ic(n.xh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Ul.forEach(function(t){t.forEach(function(t){t.reject(new oi(ii.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ul.clear(),n.Dl.Qa(o,r.Ac,r.Rc),[4,sl(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mh.delete(2),[4,hh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mh.add(2),[4,lh(e)]);case 3:t.sent(),e.Bh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.vl,this.fa.jl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hl.prototype.c_=function(t){return new Sh},hl.prototype.r_=function(t){var e=Wc(t.bu.T),n=(n=t.bu,new Dc(n));return t=t.credentials,new nh(t,n,e)},hl.prototype.o_=function(t){var e=this;return new Xc(this.xh,this.Nh,t.fs,function(t){return $h(e.fa,t,0)},t=new(Nc.jn()?Nc:Ac))},hl.prototype.a_=function(t,e){return n=this.xh,r=this.vl,i=this.Sl,o=this.Dl,s=t.s_,u=t.Cl,e=e,t=t.xl,t=new Kh(n,r,i,o,s,u,t),e&&(t.Kl=!0),t;var n,r,i,o,s,u},hl.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,zr("RemoteStore","RemoteStore shutting down."),e.Mh.add(5),[4,lh(e)];case 1:return t.sent(),e.Lh.$o(),e.Bh.set("Unknown"),[2]}})})}(this.vl)},hl);function hl(){}function ll(){this.synchronizeTabs=!1}function fl(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var pl=(wl.prototype.next=function(t){this.observer.next&&this.h_(this.observer.next,t)},wl.prototype.error=function(t){this.observer.error?this.h_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},wl.prototype.l_=function(){this.muted=!0},wl.prototype.h_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},wl),dl=(ml.prototype.close=function(){return this.__.cancel()},ml.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},ml.prototype.Jl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.d_())]}})})},ml.prototype.d_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.w_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.f_.decode(e),n=Number(r),isNaN(n)&&this.T_("length string ("+r+") is not valid number"),[4,this.E_(n)]);case 2:return r=t.sent(),[2,new Ph(JSON.parse(r),e.length+n)]}})})},ml.prototype.I_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},ml.prototype.w_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.I_()<0?[4,this.m_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.I_())<0&&this.T_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},ml.prototype.E_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.m_()]:[3,3];case 1:t.sent()&&this.T_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.f_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},ml.prototype.T_=function(t){throw this.__.cancel(),new Error("Invalid bundle format: "+t)},ml.prototype.m_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.__.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},ml),yl=(gl.prototype.isEqual=function(t){return this.A_.isEqual(t.A_)},gl),vl=function(t){this._methodName=t};function gl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new oi(ii.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.A_=new Ui(t)}function ml(t,e){var n=this;this.__=t,this.Kt=e,this.metadata=new Aa,this.buffer=new Uint8Array,this.f_=new TextDecoder("utf-8"),this.d_().then(function(t){t&&t.al()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function wl(t){this.observer=t,this.muted=!1}function bl(t,e,n){if(!n)throw new oi(ii.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function _l(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new oi(ii.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function El(t,e,n,r){if(!0===e&&!0===r)throw new oi(ii.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Tl(t){if(!Mi.Tt(t))throw new oi(ii.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Il(t){if(Mi.Tt(t))throw new oi(ii.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Al(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Nl(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new oi(ii.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Al(t),new oi(ii.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Ol(t,e){if(e<=0)throw new oi(ii.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Sl,Dl=(Fl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fl),Ll=new Map,Rl=(Object.defineProperty(Ml.prototype,"app",{get:function(){if(!this.p_)throw new oi(ii.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.p_},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"b_",{get:function(){return this.y_},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"v_",{get:function(){return void 0!==this.S_},enumerable:!1,configurable:!0}),Ml.prototype.D_=function(t){if(this.y_)throw new oi(ii.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.P_=new Dl(t),void 0!==t.credentials&&(this.V_=function(t){if(!t)return new _i;switch(t.type){case"gapi":var e=t.client;return Yr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ii(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new oi(ii.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Ml.prototype.C_=function(){return this.P_},Ml.prototype.x_=function(){return this.y_=!0,this.P_},Ml.prototype._delete=function(){return this.S_||(this.S_=this.N_()),this.S_},Ml.prototype.N_=function(){return(t=Ll.get(this))&&(zr("ComponentProvider","Removing Datastore"),Ll.delete(this),t.terminate()),Promise.resolve();var t},Ml),Cl=(Object.defineProperty(Ul.prototype,"k_",{get:function(){return this.O_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"id",{get:function(){return this.O_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"path",{get:function(){return this.O_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"parent",{get:function(){return new Pl(this.firestore,this.F_,this.O_.path.Z())},enumerable:!1,configurable:!0}),Ul.prototype.withConverter=function(t){return new Ul(this.firestore,t,this.O_)},Ul),kl=(Vl.prototype.withConverter=function(t){return new Vl(this.firestore,t,this.M_)},Vl),Pl=(l(xl,Sl=kl),Object.defineProperty(xl.prototype,"id",{get:function(){return this.M_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"path",{get:function(){return this.M_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"parent",{get:function(){var t=this.k_.Z();return t.nt()?null:new Cl(this.firestore,null,new Mi(t))},enumerable:!1,configurable:!0}),xl.prototype.withConverter=function(t){return new xl(this.firestore,t,this.k_)},xl);function xl(t,e,n){var r=this;return(r=Sl.call(this,t,e,fs(n))||this).firestore=t,r.k_=n,r.type="collection",r}function Vl(t,e,n){this.F_=e,this.M_=n,this.type="query",this.firestore=t}function Ul(t,e,n){this.F_=e,this.O_=n,this.type="document",this.firestore=t}function Ml(t,e){this.R_="(lite)",this.P_=new Dl({}),this.y_=!1,t instanceof yi?(this.g_=t,this.V_=new _i):(this.p_=t,this.g_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new oi(ii.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yi(t.options.projectId)}(t),this.V_=new Ei(e))}function Fl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new oi(ii.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new oi(ii.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,El("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function ql(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof ui&&(t=t._),bl("collection","path",e),t instanceof Rl)return Il(n=xi.ct.apply(xi,f([e],r))),new Pl(t,null,n);if(!(t instanceof Cl||t instanceof Pl))throw new oi(ii.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Il(n=xi.ct.apply(xi,f([t.path],r)).child(xi.ct(e))),new Pl(t.firestore,null,n)}function jl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof ui&&(t=t._),1===arguments.length&&(e=Qr.t()),bl("doc","path",e),t instanceof Rl)return Tl(n=xi.ct.apply(xi,f([e],r))),new Cl(t,null,new Mi(n));if(!(t instanceof Cl||t instanceof Pl))throw new oi(ii.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Tl(n=t.k_.child(xi.ct.apply(xi,f([e],r)))),new Cl(t.firestore,t instanceof Pl?t.F_:null,new Mi(n))}function Hl(t,e){return t instanceof ui&&(t=t._),e instanceof ui&&(e=e._),(t instanceof Cl||t instanceof Pl)&&(e instanceof Cl||e instanceof Pl)&&t.firestore===e.firestore&&t.path===e.path&&t.F_===e.F_}function Bl(t,e){return t instanceof ui&&(t=t._),e instanceof ui&&(e=e._),t instanceof kl&&e instanceof kl&&t.firestore===e.firestore&&_s(t.M_,e.M_)&&t.F_===e.F_}var Gl=(Object.defineProperty(Yl.prototype,"latitude",{get:function(){return this.L_},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"longitude",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Yl.prototype.isEqual=function(t){return this.L_===t.L_&&this.B_===t.B_},Yl.prototype.toJSON=function(){return{latitude:this.L_,longitude:this.B_}},Yl.prototype.K=function(t){return Zr(this.L_,t.L_)||Zr(this.B_,t.B_)},Yl),zl=/^__.*__$/,Jl=(Xl.prototype.q_=function(t,e){return null!==this.zt?new ou(t,this.data,this.zt,e,this.fieldTransforms):new iu(t,this.data,e,this.fieldTransforms)},Xl),Kl=(Wl.prototype.q_=function(t,e){return new ou(t,this.data,this.zt,e,this.fieldTransforms)},Wl);function Wl(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Xl(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Yl(t,e){if(!isFinite(t)||t<-90||90<t)throw new oi(ii.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new oi(ii.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.L_=t,this.B_=e}function Ql(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Xr()}}var $l=(Object.defineProperty(ef.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"Q_",{get:function(){return this.settings.Q_},enumerable:!1,configurable:!0}),ef.prototype.K_=function(t){return new ef(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},ef.prototype.j_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.K_({path:e,W_:!1})).G_(t),e},ef.prototype.z_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.K_({path:t,W_:!1})).U_(),t},ef.prototype.H_=function(t){return this.K_({path:void 0,W_:!0})},ef.prototype.J_=function(t){return Rf(t,this.settings.methodName,this.settings.Y_||!1,this.path,this.settings.X_)},ef.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},ef.prototype.U_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.G_(this.path.get(t))},ef.prototype.G_=function(t){if(0===t.length)throw this.J_("Document fields must not be empty");if(Ql(this.Q_)&&zl.test(t))throw this.J_('Document fields cannot begin and end with "__"')},ef),Zl=(tf.prototype.Z_=function(t,e,n,r){return void 0===r&&(r=!1),new $l({Q_:t,methodName:e,X_:n,path:Ui.at(),W_:!1,Y_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},tf);function tf(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Wc(t)}function ef(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.U_(),this.fieldTransforms=i||[],this.zt=o||[]}function nf(t){var e=t.x_(),n=Wc(t.g_);return new Zl(t.g_,!!e.ignoreUndefinedProperties,n)}function rf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Z_(o.merge||o.mergeFields?2:0,e,n,i);Of("Data must be an object, but it was:",s,r);var u,a,r=Af(r,s);if(o.merge)u=new Wi(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=Sf(e,l[h],n);if(!s.contains(f))throw new oi(ii.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Cf(c,f)||c.push(f)}u=new Wi(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Jl(new go(r),u,a)}var of,sf=(l(uf,of=vl),uf.prototype.tf=function(t){if(2!==t.Q_)throw 1===t.Q_?t.J_(this._methodName+"() can only appear at the top level of your update data"):t.J_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},uf.prototype.isEqual=function(t){return t instanceof uf},uf);function uf(){return null!==of&&of.apply(this,arguments)||this}function af(t,e,n){return new $l({Q_:3,X_:e.settings.X_,methodName:t._methodName,W_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var cf,hf,lf,ff,pf=(l(bf,ff=vl),bf.prototype.tf=function(t){return new Ws(t.path,new Ps)},bf.prototype.isEqual=function(t){return t instanceof bf},bf),df=(l(wf,lf=vl),wf.prototype.tf=function(t){var e=af(this,t,!0),n=this.ef.map(function(t){return If(t,e)}),n=new xs(n);return new Ws(t.path,n)},wf.prototype.isEqual=function(t){return this===t},wf),yf=(l(mf,hf=vl),mf.prototype.tf=function(t){var e=af(this,t,!0),n=this.ef.map(function(t){return If(t,e)}),n=new qs(n);return new Ws(t.path,n)},mf.prototype.isEqual=function(t){return this===t},mf),vf=(l(gf,cf=vl),gf.prototype.tf=function(t){var e=new Gs(t.Kt,Ls(t.Kt,this.nf));return new Ws(t.path,e)},gf.prototype.isEqual=function(t){return this===t},gf);function gf(t,e){var n=this;return(n=cf.call(this,t)||this).nf=e,n}function mf(t,e){var n=this;return(n=hf.call(this,t)||this).ef=e,n}function wf(t,e){var n=this;return(n=lf.call(this,t)||this).ef=e,n}function bf(){return null!==ff&&ff.apply(this,arguments)||this}function _f(t,r,i,e){var o=t.Z_(1,r,i);Of("Data must be an object, but it was:",o,e);var s=[],u=new mo;return Ji(e,function(t,e){var n=Lf(r,t,i);e instanceof ui&&(e=e._),t=o.z_(n),e instanceof sf?s.push(n):null!=(t=If(e,t))&&(s.push(n),u.set(n,t))}),e=new Wi(s),new Kl(u.yt(),e,o.fieldTransforms)}function Ef(t,e,n,r,i,o){var s=t.Z_(1,e,n),u=[Sf(e,r,n)],a=[i];if(o.length%2!=0)throw new oi(ii.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Sf(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new mo,y=u.length-1;0<=y;--y)Cf(p,u[y])||(h=u[y],(l=a[y])instanceof ui&&(l=l._),f=s.z_(h),l instanceof sf?p.push(h):null!=(f=If(l,f))&&(p.push(h),d.set(h,f)));return i=new Wi(p),new Kl(d.yt(),i,s.fieldTransforms)}function Tf(t,e,n,r){return void 0===r&&(r=!1),If(n,t.Z_(r?4:3,e))}function If(s,t){if(s instanceof ui&&(s=s._),Nf(s))return Of("Unsupported field value:",t,s),Af(s,t);if(s instanceof vl)return function(t,e){if(!Ql(e.Q_))throw e.J_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.J_(t._methodName+"() is not currently supported inside arrays");(t=t.tf(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.W_&&4!==t.Q_)throw t.J_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=If(i[r],t.H_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof ui&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ls(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ki.fromDate(t);return{timestampValue:ua(e.Kt,n)}}if(t instanceof ki)return n=new ki(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ua(e.Kt,n)};if(t instanceof Gl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof si)return{bytesValue:aa(e.Kt,t.l)};if(t instanceof Cl){n=e.T;var r=t.firestore.g_;if(!r.isEqual(n))throw e.J_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ha(t.firestore.g_||e.T,t.O_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.J_("Unsupported field value: "+Al(t))}(s,t)}function Af(t,n){var r={};return Ki(t)?n.path&&0<n.path.length&&n.zt.push(n.path):Ji(t,function(t,e){null!=(e=If(e,n.j_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Nf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ki||t instanceof Gl||t instanceof si||t instanceof Cl||t instanceof vl)}function Of(t,e,n){if(!Nf(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Al(n))?e.J_(t+" a custom object"):e.J_(t+" "+n);var r}function Sf(t,e,n){if(e instanceof ui&&(e=e._),e instanceof yl)return e.A_;if("string"==typeof e)return Lf(t,e);throw Rf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Df=new RegExp("[~\\*/\\[\\]]");function Lf(e,n,r){if(0<=n.search(Df))throw Rf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(yl.bind.apply(yl,f([void 0],n.split("."))))).A_}catch(t){throw Rf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Rf(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new oi(ii.INVALID_ARGUMENT,(e+=". ")+t+n)}function Cf(t,e){return t.some(function(t){return t.isEqual(e)})}var kf=(Mf.prototype.uf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),0<this.mutations.length)throw new oi(ii.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=ya((r=s).Kt)+"/documents",n={documents:u.map(function(t){return fa(r.Kt,t)})},[4,r.Fu("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.Kt,"found"in t?function(t,e){Yr(!!e.found),e.found.name,e.found.updateTime;var n=pa(t,e.found.name),t=ca(e.found.updateTime),e=new go({mapValue:{fields:e.found.fields}});return new Io(n,t,e,{})}(n,t):"missing"in t?(e=n,Yr(!!(n=t).missing),Yr(!!n.readTime),e=pa(e,n.missing),n=ca(n.readTime),new Ao(e,n)):Xr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Yr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Nh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ao||t instanceof Io?n.lf(t):Xr()}),e)]}})})},Mf.prototype.set=function(t,e){this.write(e.q_(t,this.Gt(t))),this.af.add(t.toString())},Mf.prototype.update=function(t,e){try{this.write(e.q_(t,this._f(t)))}catch(t){this.cf=t}this.af.add(t.toString())},Mf.prototype.delete=function(t){this.write(new vu(t,this.Gt(t))),this.af.add(t.toString())},Mf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),this.cf)throw this.cf;return e=this.sf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Mi.ft(e),n.mutations.push(new gu(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ya((e=i).Kt)+"/documents",r={writes:o.map(function(t){return ma(e.Kt,t)})},[4,e.Du("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nh,this.mutations)];case 1:return t.sent(),this.rf=!0,[2]}})})},Mf.prototype.lf=function(t){var e;if(t instanceof Io)e=t.version;else{if(!(t instanceof Ao))throw Xr();e=Pi.min()}var n=this.sf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new oi(ii.ABORTED,"Document version changed between two reads.")}else this.sf.set(t.key.toString(),e)},Mf.prototype.Gt=function(t){var e=this.sf.get(t.toString());return!this.af.has(t.toString())&&e?Ys.updateTime(e):Ys.jt()},Mf.prototype._f=function(t){var e=this.sf.get(t.toString());if(this.af.has(t.toString())||!e)return Ys.exists(!0);if(e.isEqual(Pi.min()))throw new oi(ii.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ys.updateTime(e)},Mf.prototype.write=function(t){this.hf(),this.mutations.push(t)},Mf.prototype.hf=function(){},Mf),Pf=(Uf.prototype.run=function(){this.df()},Uf.prototype.df=function(){var t=this;this.Yu.Qu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new kf(this.Nh),(n=this.wf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.Tf(t)})})}).catch(function(t){r.Tf(t)}),[2]})})})},Uf.prototype.wf=function(t){try{var e=this.updateFunction(t);return!no(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},Uf.prototype.Tf=function(t){var e=this;0<this.ff&&this.Ef(t)?(--this.ff,this.fs.ys(function(){return e.df(),Promise.resolve()})):this.Es.reject(t)},Uf.prototype.Ef=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!bu(t))},Uf),xf=(Vf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,bu:this.bu,clientId:this.clientId,credentials:this.credentials,s_:this.user,Cl:100,xl:this.xl})]}})})},Vf.prototype.mf=function(t){var e=this;this.If=t,this.N.promise.then(function(){return e.If(e.user)})},Vf.prototype.Af=function(){if(this.fs.Rf)throw new oi(ii.FAILED_PRECONDITION,"The client has already been terminated.")},Vf.prototype.terminate=function(){var t=this;this.fs.Pf();var n=new Aa;return this.fs.yf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.gf?[4,this.gf.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Vf?[4,this.Vf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=Ra(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Vf);function Vf(t,e,n,r){var i=this;this.credentials=t,this.fs=e,this.bu=n,this.xl=r,this.user=vi.UNAUTHENTICATED,this.clientId=Qr.t(),this.If=function(){},this.N=new Aa,this.credentials.S(function(t){zr("FirestoreClient","Received user=",t.uid),i.user=t,i.If(t),i.N.resolve()})}function Uf(t,e,n,r){this.fs=t,this.Nh=e,this.updateFunction=n,this.Es=r,this.ff=5,this.Yu=new Zc(this.fs,"transaction_retry")}function Mf(t){this.Nh=t,this.sf=new Map,this.mutations=[],this.rf=!1,this.cf=null,this.af=new Set}function Ff(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Vf?[3,2]:(zr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.pf(),zr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.s_,i.mf(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ic(o.xh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.Vf=o,[2]}})})}(e,new al)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Vf]}})})}function qf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.gf?[3,2]:(zr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.pf(),[4,Ff(r)];case 1:return e=t.sent(),zr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.mf(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.pf(),zr("RemoteStore","RemoteStore received new credentials"),n=mh(e),e.Mh.add(3),[4,lh(e)];case 1:return t.sent(),n&&e.Bh.set("Unknown"),[4,e.Fh.u_(i)];case 2:return t.sent(),e.Mh.delete(3),[4,hh(e)];case 3:return t.sent(),[2]}})})}(i.vl,t)})}),r.gf=i,[2]}})})}(e,new cl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.gf]}})})}function jf(t){return Ff(t).then(function(t){return t.persistence})}function Hf(t){return Ff(t).then(function(t){return t.xh})}function Bf(t){return qf(t).then(function(t){return t.vl})}function Gf(t){return qf(t).then(function(t){return t.fa})}function zf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,qf(r)];case 1:return e=t.sent(),[2,((n=e.Sl).Yh=function(u,a){return y(this,void 0,void 0,function(){var e,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(n=u).vl.Fh.Qh=Qh.bind(null,n),n.vl.Fh.Sn=function(t,e){var n=t;if((t=n.Ll.get(e))&&t.bl)return Uu().add(t.key);var r=Uu();if(!(e=n.kl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Ol.get(s),r=r.ye(s.view.El);return r}.bind(null,n),n.vl.Fh.Uh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Dl.qa(s,"rejected",u),i=e.Ll.get(s),(n=i&&i.key)?(r=(r=new Eu(Mi.J)).Ht(n,new Ao(n,Pi.min())),i=Uu().add(n),i=new Hu(Pi.min(),new Map,new Du(Zr),r,i),[4,Qh(e,i)]):[3,2];case 1:return t.sent(),e.$l=e.$l.remove(n),e.Ll.delete(s),ol(e),[3,4];case 2:return[4,ac(e.xh,s,!1).then(function(){return nl(e,s,u)}).catch(Ba)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),n.vl.Fh.Kh=function(t,e){!n.Fl&&n.xl&&(n.Fl=!0,n.xl(t,e))},n.Nl._h=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Zh(s)&&(r=!0);u.Hh=s}}r&&Ch(n)}.bind(null,n.Sl),n.Nl.Gl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,n.Sl),(s=(e=n).Ol.get(a))?(r=s.targetId,e.Dl.ka(r),i=s.view.pl(),[3,4]):[3,1];case 1:return[4,uc(e.xh,ws(a))];case 2:return o=t.sent(),s=e.Dl.ka(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Wl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Il(o))._c?[4,cc(r.xh,i.query,!1).then(function(t){return t=t.documents,i.view.Il(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ti(e,r.jl,n),[2,(il(r,i.targetId,n.yl),n.snapshot)]}})})}(i,t,e,n)},[4,cc(i.xh,o,!0)];case 1:return n=t.sent(),r=new Gh(o,n.Pc),e=r.Il(n.documents),n=Bu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ti(e,i.jl,n),il(i,s,n.yl),r=new zh(o,s,r),[2,(i.Ol.set(o,r),i.kl.has(s)?i.kl.get(s).push(o):i.kl.set(s,[o]),n.snapshot)]}})})}(e,a,r,"current"===s)];case 3:i=t.sent(),e.jl&&fh(e.vl,o),t.label=4;case 4:return[2,i]}var n})})}.bind(null,e.fa),n.tl=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ol.get(o),1<(r=e.kl.get(n.targetId)).length?[2,(e.kl.set(n.targetId,r.filter(function(t){return!_s(t,o)})),void e.Ol.delete(o))]:e.jl?(e.Dl.$a(n.targetId),e.Dl.Ca(n.targetId)?[3,2]:[4,ac(e.xh,n.targetId,!1).then(function(){e.Dl.Ba(n.targetId),ph(e.vl,n.targetId),nl(e,n.targetId)}).catch(Ba)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return nl(e,n.targetId),[4,ac(e.xh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function Jf(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new pl({next:function(t){r.ys(function(){return Rh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new oi(ii.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new oi(ii.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new kh(fs(i.path),t,{includeMetadataChanges:!0,cl:!0});return Lh(n,u)},[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function Kf(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new pl({next:function(t){n.ys(function(){return Rh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new oi(ii.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new kh(t,o,{includeMetadataChanges:!0,cl:!0});return Lh(e,s)},[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var Wf,Xf=(Object.defineProperty($f.prototype,"Rf",{get:function(){return this.Sf},enumerable:!1,configurable:!0}),$f.prototype.ys=function(t){this.enqueue(t)},$f.prototype.yf=function(t){this.Of(),this.kf(t)},$f.prototype.Pf=function(){var t;this.Sf||(this.Sf=!0,(t=Kc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ff))},$f.prototype.enqueue=function(t){return this.Of(),this.Sf?new Promise(function(t){}):this.kf(t)},$f.prototype.bo=function(t){var e=this;this.ys(function(){return e.vf.push(t),e.Mf()})},$f.prototype.Mf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.vf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.vf[0]()];case 2:return t.sent(),this.vf.shift(),this.Yu.reset(),[3,4];case 3:if(!Sa(e=t.sent()))throw e;return zr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.vf.length&&this.Yu.Qu(function(){return n.Mf()}),t.label=5;case 5:return[2]}})})},$f.prototype.kf=function(t){var r=this,e=this.bf.then(function(){return r.xf=!0,t().catch(function(t){throw r.Cf=t,r.xf=!1,Jr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xf=!1,t})});return this.bf=e},$f.prototype.Ir=function(t,e,n){var r=this;return this.Of(),-1<this.Nf.indexOf(t)&&(e=0),n=Da.Is(this,t,e,n,function(t){return r.$f(t)}),this.Df.push(n),n},$f.prototype.Of=function(){this.Cf&&Xr()},$f.prototype.pf=function(){},$f.prototype.Lf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.bf];case 1:t.sent(),t.label=2;case 2:if(e!==this.bf)return[3,0];t.label=3;case 3:return[2]}})})},$f.prototype.Bf=function(t){for(var e=0,n=this.Df;e<n.length;e++)if(n[e].ds===t)return!0;return!1},$f.prototype.qf=function(r){var i=this;return this.Lf().then(function(){i.Df.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.Df;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Lf()})},$f.prototype.Uf=function(t){this.Nf.push(t)},$f.prototype.$f=function(t){t=this.Df.indexOf(t),this.Df.splice(t,1)},$f),Yf=(l(Qf,Wf=Rl),Qf.prototype.N_=function(){return this.jf||tp(this),this.jf.terminate()},Qf);function Qf(t,e,n){var r=this;return(r=Wf.call(this,t,e)||this).Qf=n,r.Kf=new Xf,r.R_="name"in t?t.name:"[DEFAULT]",r}function $f(){var e=this;this.bf=Promise.resolve(),this.vf=[],this.Sf=!1,this.Df=[],this.Cf=null,this.xf=!1,this.Nf=[],this.Yu=new Zc(this,"async_queue_retry"),this.Ff=function(){var t=Kc();t&&zr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Yu.ju()};var t=Kc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ff)}function Zf(t){return t.jf||tp(t),t.jf.Af(),t.jf}function tp(t){var e,n,r=t.x_(),r=(e=t.g_,n=t.R_,new di(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.jf=new xf(t.V_,t.Kf,r,t.Qf)}var ep,o=(sp.prototype.Wf=function(t,e){switch(void 0===e&&(e="none"),io(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $i(t.integerValue||t.doubleValue);case 3:return this.Gf(t.timestampValue);case 4:return this.zf(t,e);case 5:return t.stringValue;case 6:return this.Hf(Zi(t.bytesValue));case 7:return this.Jf(t.referenceValue);case 8:return this.Yf(t.geoPointValue);case 9:return this.Xf(t.arrayValue,e);case 10:return this.Zf(t.mapValue,e);default:throw Xr()}},sp.prototype.Zf=function(t,n){var r=this,i={};return Ji(t.fields||{},function(t,e){i[t]=r.Wf(e,n)}),i},sp.prototype.Yf=function(t){return new Gl($i(t.latitude),$i(t.longitude))},sp.prototype.Xf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Wf(t,e)})},sp.prototype.zf=function(t,e){switch(e){case"previous":var n=function t(e){return to(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Wf(n,e);case"estimate":return this.Gf(eo(t));default:return null}},sp.prototype.Gf=function(t){return t=Qi(t),new ki(t.seconds,t.nanos)},sp.prototype.td=function(t,e){var n=xi.ct(t);return Yr(Ia(n)),t=new yi(n.get(1),n.get(3)),n=new Mi(n.X(5)),t.isEqual(e)||Jr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},sp),np=(Object.defineProperty(op.prototype,"id",{get:function(){return this.O_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(op.prototype,"ref",{get:function(){return new Cl(this.ed,this.F_,this.O_)},enumerable:!1,configurable:!0}),op.prototype.exists=function(){return null!==this.sd},op.prototype.data=function(){if(this.sd){if(this.F_){var t=new rp(this.ed,this.nd,this.O_,this.sd,null);return this.F_.fromFirestore(t)}return this.nd.Wf(this.sd.vt())}},op.prototype.get=function(t){if(this.sd&&null!==(t=this.sd.data().field(up("DocumentSnapshot.get",t))))return this.nd.Wf(t)},op),rp=(l(ip,ep=np),ip.prototype.data=function(){return ep.prototype.data.call(this)},ip);function ip(){return null!==ep&&ep.apply(this,arguments)||this}function op(t,e,n,r,i){this.ed=t,this.nd=e,this.O_=n,this.sd=r,this.F_=i}function sp(){}function up(t,e){return"string"==typeof e?Lf(t,e):(e instanceof ui?e._:e).A_}function ap(t){if(ds(t)&&0===t.Nt.length)throw new oi(ii.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function cp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].rd(t);return t}var hp,lp,fp,pp,dp,yp=(l(Ip,dp=je=function(){}),Ip.prototype.rd=function(t){var e=nf(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new oi(ii.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Op(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Np(n,t,c))}h={arrayValue:{values:s}}}else h=Np(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Op(o,i),h=Tf(e,"where",o,"in"===i||"not-in"===i);var h=Vo.create(r,i,h);return function(t,e){if(e.xt()){var n=vs(t);if(null!==n&&!n.isEqual(e.field))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ys(t))&&Sp(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new oi(ii.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new oi(ii.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.M_,e,t.firestore.g_,this.od,this.ad,this.ud);return new kl(t.firestore,t.F_,(e=(t=t.M_).filters.concat([e]),new ls(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Ip),vp=(l(Tp,pp=je),Tp.prototype.rd=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new oi(ii.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new oi(ii.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new as(e,n);return e=r,null!==ys(n=t)||null!==(t=vs(n))&&Sp(0,t,e.field),r}(t.M_,this.od,this.hd);return new kl(t.firestore,t.F_,(e=(t=t.M_).Nt.concat([e]),new ls(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Tp),gp=(l(Ep,fp=je),Ep.prototype.rd=function(t){return new kl(t.firestore,t.F_,bs(t.M_,this.ld,this._d))},Ep),mp=(l(_p,lp=je),_p.prototype.rd=function(t){var e=Ap(t,this.type,this.fd,this.dd);return new kl(t.firestore,t.F_,(t=t.M_,new ls(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},_p),wp=(l(bp,hp=je),bp.prototype.rd=function(t){var e=Ap(t,this.type,this.fd,this.dd);return new kl(t.firestore,t.F_,(t=t.M_,new ls(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},bp);function bp(t,e,n){var r=this;return(r=hp.call(this)||this).type=t,r.fd=e,r.dd=n,r}function _p(t,e,n){var r=this;return(r=lp.call(this)||this).type=t,r.fd=e,r.dd=n,r}function Ep(t,e,n){var r=this;return(r=fp.call(this)||this).type=t,r.ld=e,r._d=n,r}function Tp(t,e){var n=this;return(n=pp.call(this)||this).od=t,n.hd=e,n.type="orderBy",n}function Ip(t,e,n){var r=this;return(r=dp.call(this)||this).od=t,r.ad=e,r.ud=n,r.type="where",r}function Ap(t,c,e,n){if(e[0]instanceof ui&&(e[0]=e[0]._),e[0]instanceof np)return function(t,e,n,r){if(!n)throw new oi(ii.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ms(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(ho(e,n.key));else{var a=n.field(u.field);if(to(a))throw new oi(ii.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.ot(),new oi(ii.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new ns(i,r)}(t.M_,t.firestore.g_,e[0].sd,n);var r=nf(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new oi(ii.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new oi(ii.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!gs(t)&&-1!==c.indexOf("/"))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(xi.ct(c));if(!Mi.Tt(h))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Mi(h),u.push(ho(e,h))}else c=Tf(n,r,c),u.push(c)}return new ns(u,o)}(t.M_,t.firestore.g_,r,c,e,n)}function Np(t,e,n){if(n instanceof ui&&(n=n._),"string"==typeof n){if(""===n)throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gs(e)&&-1!==n.indexOf("/"))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(xi.ct(n)),!Mi.Tt(e))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ho(t,new Mi(e))}if(n instanceof Cl)return ho(t,n.O_);throw new oi(ii.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Al(n)+".")}function Op(t,e){if(!Array.isArray(t)||0===t.length)throw new oi(ii.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new oi(ii.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Sp(t,e,n){if(!n.isEqual(e))throw new oi(ii.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Dp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function Lp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Rp,Cp,kp,Pp=(l(Bp,kp=o),Bp.prototype.Hf=function(t){return new si(t)},Bp.prototype.Jf=function(t){return t=this.td(t,this.firestore.g_),new Cl(this.firestore,null,t)},Bp),xp=(Hp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hp),Vp=(l(jp,Cp=np),jp.prototype.exists=function(){return Cp.prototype.exists.call(this)},jp.prototype.data=function(t){if(void 0===t&&(t={}),this.sd){if(this.F_){var e=new Up(this.ed,this.nd,this.O_,this.sd,this.metadata,null);return this.F_.fromFirestore(e,t)}return this.nd.Wf(this.sd.vt(),t.serverTimestamps)}},jp.prototype.get=function(t,e){if(void 0===e&&(e={}),this.sd&&null!==(t=this.sd.data().field(up("DocumentSnapshot.get",t))))return this.nd.Wf(t,e.serverTimestamps)},jp),Up=(l(qp,Rp=Vp),qp.prototype.data=function(t){return void 0===t&&(t={}),Rp.prototype.data.call(this,t)},qp),Mp=(Object.defineProperty(Fp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Fp.prototype,"size",{get:function(){return this.Td.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Fp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Fp.prototype.forEach=function(e,n){var r=this;this.Td.docs.forEach(function(t){e.call(n,new Up(r.ed,r.nd,t.key,t,new xp(r.Td.Ce.has(t.key),r.Td.fromCache),r.query.F_))})},Fp.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Td.Ne)throw new oi(ii.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ed&&this.Id===t||(this.Ed=function(i,e){if(i.Td.De.nt()){var n=0;return i.Td.docChanges.map(function(t){var e=new Up(i.ed,i.nd,t.doc.key,t.doc,new xp(i.Td.Ce.has(t.doc.key),i.Td.fromCache),i.query.F_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Td.De;return i.Td.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Up(i.ed,i.nd,t.doc.key,t.doc,new xp(i.Td.Ce.has(t.doc.key),i.Td.fromCache),i.query.F_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Id=t),this.Ed},Fp);function Fp(t,e,n,r){this.ed=t,this.nd=e,this.Td=r,this.metadata=new xp(r.hasPendingWrites,r.fromCache),this.query=n}function qp(){return null!==Rp&&Rp.apply(this,arguments)||this}function jp(t,e,n,r,i,o){var s=this;return(s=Cp.call(this,t,e,n,r,o)||this).ed=t,s.wd=t,s.metadata=i,s}function Hp(t,e){this.hasPendingWrites=t,this.fromCache=e}function Bp(t){var e=this;return(e=kp.call(this)||this).firestore=t,e}function Gp(t,e){return t instanceof Vp&&e instanceof Vp?t.ed===e.ed&&t.O_.isEqual(e.O_)&&(null===t.sd?null===e.sd:t.sd.isEqual(e.sd))&&t.F_===e.F_:t instanceof Mp&&e instanceof Mp&&t.ed===e.ed&&Bl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Td.isEqual(e.Td)}var zp,Jp=(l(Kp,zp=o),Kp.prototype.Hf=function(t){return new si(t)},Kp.prototype.Jf=function(t){return t=this.td(t,this.firestore.g_),new Cl(this.firestore,null,t)},Kp);function Kp(t){var e=this;return(e=zp.call(this)||this).firestore=t,e}function Wp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Nl(t,Cl);var o=Nl(t.firestore,Yf),s=nf(o);return e instanceof ui&&(e=e._),Yp(o,[("string"==typeof e||e instanceof yl?Ef(s,"updateDoc",t.O_,e,n,r):_f(s,"updateDoc",t.O_,e)).q_(t.O_,Ys.exists(!0))])}function Xp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof ui&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Dp(n[i])||(r=n[i],i++);var o,s,u,a,c,h,l={includeMetadataChanges:r.includeMetadataChanges};return Dp(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Cl?(u=Nl(e.firestore,Yf),a=fs(e.O_.path),h={next:function(t){n[i]&&n[i](Qp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Nl(e,kl),u=Nl(s.firestore,Yf),a=s.M_,c=new Jp(u),h={next:function(t){n[i]&&n[i](new Mp(u,c,s,t))},error:n[i+1],complete:n[i+2]},ap(e.M_)),function(n,t,e){var r=this,i=new pl(h),o=new kh(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.l_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rh,[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Zf(u),a,l)}function Yp(t,e){return function(n,r){var t=this,i=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Yh,[4,Gf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Zf(t),e)}function Qp(t,e,n){var r=n.docs.get(e.O_),i=new Jp(t);return new Vp(t,i,e.O_,r,new xp(n.hasPendingWrites,n.fromCache),e.F_)}var $p=(Zp.prototype.set=function(t,e,n){return this.yd(),e=Lp((t=td(t,this.ed)).F_,e,n),n=rf(this.Pd,"WriteBatch.set",t.O_,e,null!==t.F_,n),this.Ad.push(n.q_(t.O_,Ys.jt())),this},Zp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.yd(),t=td(t,this.ed),e instanceof ui&&(e=e._),e="string"==typeof e||e instanceof yl?Ef(this.Pd,"WriteBatch.update",t.O_,e,n,r):_f(this.Pd,"WriteBatch.update",t.O_,e),this.Ad.push(e.q_(t.O_,Ys.exists(!0))),this},Zp.prototype.delete=function(t){return this.yd(),t=td(t,this.ed),this.Ad=this.Ad.concat(new vu(t.O_,Ys.jt())),this},Zp.prototype.commit=function(){return this.yd(),this.Rd=!0,0<this.Ad.length?this.md(this.Ad):Promise.resolve()},Zp.prototype.yd=function(){if(this.Rd)throw new oi(ii.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Zp);function Zp(t,e){this.ed=t,this.md=e,this.Ad=[],this.Rd=!1,this.Pd=nf(t)}function td(t,e){if(t instanceof ui&&(t=t._),t.firestore!==e)throw new oi(ii.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ed,nd,rd,id=(pd.prototype.get=function(t){var e=this,n=td(t,this.ed),r=new Pp(this.ed);return this.gd.uf([n.O_]).then(function(t){if(!t||1!==t.length)return Xr();if((t=t[0])instanceof Ao)return new np(e.ed,r,n.O_,null,n.F_);if(t instanceof Io)return new np(e.ed,r,t.key,t,n.F_);throw Xr()})},pd.prototype.set=function(t,e,n){return e=Lp((t=td(t,this.ed)).F_,e,n),n=rf(this.Pd,"Transaction.set",t.O_,e,null!==t.F_,n),this.gd.set(t.O_,n),this},pd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=td(t,this.ed),e instanceof ui&&(e=e._),e="string"==typeof e||e instanceof yl?Ef(this.Pd,"Transaction.update",t.O_,e,n,r):_f(this.Pd,"Transaction.update",t.O_,e),this.gd.update(t.O_,e),this},pd.prototype.delete=function(t){return t=td(t,this.ed),this.gd.delete(t.O_),this},l(fd,rd=pd),fd.prototype.get=function(t){var e=this,n=td(t,this.ed),r=new Jp(this.ed);return rd.prototype.get.call(this,t).then(function(t){return new Vp(e.ed,r,n.O_,t.sd,new xp(!1,!1),n.F_)})},fd),od="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",sd=(ld.prototype.enableIndexedDbPersistence=function(t,e){throw new oi(ii.FAILED_PRECONDITION,od)},ld.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new oi(ii.FAILED_PRECONDITION,od)},ld.prototype.clearIndexedDbPersistence=function(t){throw new oi(ii.FAILED_PRECONDITION,od)},ld),ud=(l(hd,nd=ui),Object.defineProperty(hd.prototype,"g_",{get:function(){return this._.g_},enumerable:!1,configurable:!0}),hd.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.C_()),t)).merge,this._.D_(t)},hd.prototype.useEmulator=function(t,e){var n=this._,r=t;t=e,"firestore.googleapis.com"!==(e=(n=Nl(n,Rl)).C_()).host&&e.host!==r&&Kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.D_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},hd.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,jf(r)];case 1:return e=t.sent(),[4,Bf(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Mh.delete(0),hh(t))]}})})})}(Zf(Nl(this._,Yf)))},hd.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,jf(r)];case 1:return e=t.sent(),[4,Bf(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mh.add(0),[4,lh(e)];case 1:return t.sent(),e.Bh.set("Offline"),[2]}})})}(n))]}})})})}(Zf(Nl(this._,Yf)))},hd.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&El("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Vd.enableMultiTabIndexedDbPersistence(this):this.Vd.enableIndexedDbPersistence(this,n)},hd.prototype.clearPersistence=function(){return this.Vd.clearIndexedDbPersistence(this)},hd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},hd.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zh,[4,Gf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Zf(Nl(this._,Yf)))},hd.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new pl(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Jh.add(e),e.next()},[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.l_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Jh.delete(e)},[4,zf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Zf(Nl(this._,Yf)),Dp(t)?t:{next:t})},Object.defineProperty(hd.prototype,"app",{get:function(){if(!this.pd)throw new oi(ii.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pd},enumerable:!1,configurable:!0}),hd.prototype.collection=function(t){try{return new Ud(this,ql(this._,t))}catch(t){throw Td(t,"collection()","Firestore.collection()")}},hd.prototype.doc=function(t){try{return new wd(this,jl(this._,t))}catch(t){throw Td(t,"doc()","Firestore.doc()")}},hd.prototype.collectionGroup=function(t){try{return new Pd(this,function(t,e){if(t=Nl(t,Rl),bl("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new oi(ii.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new kl(t,null,new ls(xi.at(),e))}(this._,t))}catch(t){throw Td(t,"collectionGroup()","Firestore.collectionGroup()")}},hd.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,qf(n).then(function(t){return t.Nh})];case 1:return e=t.sent(),new Pf(n.fs,e,r,i).run(),[2]}})})}),i.promise}(Zf(n=this._),function(t){return t=new id(n,t),e(new gd(r,t))})},hd.prototype.batch=function(){var e=this;return Zf(this._),new md(new $p(this._,function(t){return Yp(e._,t)}))},hd.prototype.loadBundle=function(t){throw new oi(ii.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},hd.prototype.namedQuery=function(t){throw new oi(ii.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},hd),ad=(l(cd,ed=o),cd.prototype.Hf=function(t){return new pi(new si(t))},cd.prototype.Jf=function(t){return t=this.td(t,this.firestore.g_),wd.bd(t,this.firestore,null)},cd);function cd(t){var e=this;return(e=ed.call(this)||this).firestore=t,e}function hd(t,e,n){var r=this;return(r=nd.call(this,e)||this).Vd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof yi||(r.pd=t),r}function ld(){}function fd(t,e){var n=this;return(n=rd.call(this,t,e)||this).ed=t,n}function pd(t,e){this.ed=t,this.gd=e,this.Pd=nf(t)}var dd,yd,vd,gd=(l(Ed,vd=ui),Ed.prototype.get=function(t){var e=this,n=Gd(t);return this._.get(n).then(function(t){return new Cd(e.ed,new Vp(e.ed._,e.nd,t.O_,t.sd,t.metadata,n.F_))})},Ed.prototype.set=function(t,e,n){return t=Gd(t),n?(_l("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Ed.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Gd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Ed.prototype.delete=function(t){return t=Gd(t),this._.delete(t),this},Ed),md=(l(_d,yd=ui),_d.prototype.set=function(t,e,n){return t=Gd(t),n?(_l("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},_d.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Gd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},_d.prototype.delete=function(t){return t=Gd(t),this._.delete(t),this},_d.prototype.commit=function(){return this._.commit()},_d),wd=(l(bd,dd=ui),bd.vd=function(t,e,n){if(t.length%2!=0)throw new oi(ii.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new bd(e,new Cl(e._,n,new Mi(t)))},bd.bd=function(t,e,n){return new bd(e,new Cl(e._,n,t))},Object.defineProperty(bd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"parent",{get:function(){return new Ud(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),bd.prototype.collection=function(t){try{return new Ud(this.firestore,ql(this._,t))}catch(t){throw Td(t,"collection()","DocumentReference.collection()")}},bd.prototype.isEqual=function(t){return t instanceof ui&&(t=t._),t instanceof Cl&&Hl(this._,t)},bd.prototype.set=function(t,e){e=_l("DocumentReference.set",e);try{return function(t,e,n){t=Nl(t,Cl);var r=Nl(t.firestore,Yf),e=Lp(t.F_,e,n);return Yp(r,[rf(nf(r),"setDoc",t.O_,e,null!==t.F_,n).q_(t.O_,Ys.jt())])}(this._,t,e)}catch(t){throw Td(t,"setDoc()","DocumentReference.set()")}},bd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Wp(this._,t):Wp.apply(void 0,f([this._,t,e],n))}catch(t){throw Td(t,"updateDoc()","DocumentReference.update()")}},bd.prototype.delete=function(){return Yp(Nl((t=this._).firestore,Yf),[new vu(t.O_,Ys.jt())]);var t},bd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Id(t),i=Ad(t,function(t){return new Cd(e.firestore,new Vp(e.firestore._,e.nd,t.O_,t.sd,t.metadata,e._.F_))});return Xp(this._,r,i)},bd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Nl(e,Cl);var n=Nl(e.firestore,Yf),t=Zf(n),r=new Jp(n);return function(n,r){var t=this,i=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof Io?u.resolve(i):i instanceof Ao?u.resolve(null):u.reject(new oi(ii.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Ra(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.O_).then(function(t){return new Vp(n,r,e.O_,t,new xp(t instanceof Io&&t.bt,!0),e.F_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Nl(e,Cl);var n=Nl(e.firestore,Yf);return Jf(Zf(n),e.O_,{source:"server"}).then(function(t){return Qp(n,e,t)})}:function(e){e=Nl(e,Cl);var n=Nl(e.firestore,Yf);return Jf(Zf(n),e.O_).then(function(t){return Qp(n,e,t)})})(this._).then(function(t){return new Cd(e.firestore,new Vp(e.firestore._,e.nd,t.O_,t.sd,t.metadata,e._.F_))})},bd.prototype.withConverter=function(t){return new bd(this.firestore,this._.withConverter(t))},bd);function bd(t,e){var n=this;return(n=dd.call(this,e)||this).firestore=t,n.nd=new ad(t),n}function _d(){return null!==yd&&yd.apply(this,arguments)||this}function Ed(t,e){var n=this;return(n=vd.call(this,e)||this).ed=t,n.nd=new ad(t),n}function Td(t,e,n){return t.message=t.message.replace(e,n),t}function Id(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Dp(r))return r}return{}}function Ad(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Dp(t[0])?t[0]:Dp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Nd,Od,Sd,Dd,Ld,Rd,Cd=(l(Bd,Rd=ui),Object.defineProperty(Bd.prototype,"ref",{get:function(){return new wd(this.ed,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Bd.prototype.data=function(t){return this._.data(t)},Bd.prototype.get=function(t,e){return this._.get(t,e)},Bd.prototype.isEqual=function(t){return Gp(this._,t._)},Bd),kd=(l(Hd,Ld=Cd),Hd.prototype.data=function(t){return this._.data(t)},Hd),Pd=(l(jd,Dd=ui),jd.prototype.where=function(t,e,n){try{return new jd(this.firestore,cp(this._,(r=n,i=e,o=up("where",t),new yp(o,i,r))))}catch(t){throw Td(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},jd.prototype.orderBy=function(n,t){try{return new jd(this.firestore,cp(this._,function(t){void 0===t&&(t="asc");var e=t,t=up("orderBy",n);return new vp(t,e)}(t)))}catch(n){throw Td(n,/(orderBy|where)\(\)/,"Query.$1()")}},jd.prototype.limit=function(t){try{return new jd(this.firestore,cp(this._,(Ol("limit",e=t),new gp("limit",e,"F"))))}catch(t){throw Td(t,"limit()","Query.limit()")}var e},jd.prototype.limitToLast=function(t){try{return new jd(this.firestore,cp(this._,(Ol("limitToLast",e=t),new gp("limitToLast",e,"L"))))}catch(t){throw Td(t,"limitToLast()","Query.limitToLast()")}var e},jd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new jd(this.firestore,cp(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Td(t,"startAt()","Query.startAt()")}},jd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new jd(this.firestore,cp(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Td(t,"startAfter()","Query.startAfter()")}},jd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new jd(this.firestore,cp(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Td(t,"endBefore()","Query.endBefore()")}},jd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new jd(this.firestore,cp(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Td(t,"endAt()","Query.endAt()")}},jd.prototype.isEqual=function(t){return Bl(this._,t._)},jd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Nl(e,kl);var n=Nl(e.firestore,Yf),t=Zf(n),r=new Jp(n);return function(n,r){var t=this,i=new Aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,cc(i,o,!0)];case 1:return r=t.sent(),e=new Gh(o,r.Pc),n=e.Il(r.documents),n=e.Ti(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Ra(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.M_).then(function(t){return new Mp(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Nl(e,kl);var n=Nl(e.firestore,Yf),t=Zf(n),r=new Jp(n);return Kf(t,e.M_,{source:"server"}).then(function(t){return new Mp(n,r,e,t)})}:function(e){e=Nl(e,kl);var n=Nl(e.firestore,Yf),t=Zf(n),r=new Jp(n);return ap(e.M_),Kf(t,e.M_).then(function(t){return new Mp(n,r,e,t)})})(this._).then(function(t){return new Vd(e.firestore,new Mp(e.firestore._,e.nd,e._,t.Td))})},jd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Id(t),i=Ad(t,function(t){return new Vd(e.firestore,new Mp(e.firestore._,e.nd,e._,t.Td))});return Xp(this._,r,i)},jd.prototype.withConverter=function(t){return new jd(this.firestore,this._.withConverter(t))},jd),xd=(l(qd,Sd=ui),Object.defineProperty(qd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"doc",{get:function(){return new kd(this.ed,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),qd),Vd=(l(Fd,Od=ui),Object.defineProperty(Fd.prototype,"query",{get:function(){return new Pd(this.ed,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new kd(e.ed,t)})},enumerable:!1,configurable:!0}),Fd.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new xd(e.ed,t)})},Fd.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new kd(r.ed,t))})},Fd.prototype.isEqual=function(t){return Gp(this._,t._)},Fd),Ud=(l(Md,Nd=Pd),Object.defineProperty(Md.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"parent",{get:function(){var t=this._.parent;return t?new wd(this.firestore,t):null},enumerable:!1,configurable:!0}),Md.prototype.doc=function(t){try{return new wd(this.firestore,void 0===t?jl(this._):jl(this._,t))}catch(t){throw Td(t,"doc()","CollectionReference.doc()")}},Md.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=Nl(r.firestore,Yf),e=jl(r),i=Lp(r.F_,i),Yp(t,[rf(nf(r.firestore),"addDoc",e.O_,i,null!==r.F_,{}).q_(e.O_,Ys.exists(!1))]).then(function(){return e}).then(function(t){return new wd(n.firestore,t)})},Md.prototype.isEqual=function(t){return Hl(this._,t._)},Md.prototype.withConverter=function(t){return new Md(this.firestore,this._.withConverter(t))},Md);function Md(t,e){var n=this;return(n=Nd.call(this,t,e)||this).firestore=t,n._=e,n}function Fd(t,e){var n=this;return(n=Od.call(this,e)||this).ed=t,n}function qd(t,e){var n=this;return(n=Sd.call(this,e)||this).ed=t,n}function jd(t,e){var n=this;return(n=Dd.call(this,e)||this).firestore=t,n.nd=new ad(t),n}function Hd(){return null!==Ld&&Ld.apply(this,arguments)||this}function Bd(t,e){var n=this;return(n=Rd.call(this,e)||this).ed=t,n}function Gd(t){return t instanceof ui&&(t=t._),Nl(t,Cl)}var zd,Jd,je=(l(Yd,Jd=ui),Yd.documentId=function(){return new Yd(Ui.lt().ot())},Yd.prototype.isEqual=function(t){return t instanceof ui&&(t=t._),t instanceof yl&&this._.A_.isEqual(t.A_)},Yd),o=(l(Xd,zd=ui),Xd.serverTimestamp=function(){var t=new pf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Xd(t)},Xd.delete=function(){var t=new sf("deleteField");return t._methodName="FieldValue.delete",new Xd(t)},Xd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new df("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Xd(n)},Xd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Xd(n)},Xd.increment=function(t){return(t=new vf("increment",t))._methodName="FieldValue.increment",new Xd(t)},Xd.prototype.isEqual=function(t){return this._.isEqual(t._)},Xd),Kd=(Wd.prototype.onProgress=function(t,e,n){this.Sd={next:t,error:e,complete:n}},Wd.prototype.catch=function(t){return this.Dd.promise.catch(t)},Wd.prototype.then=function(t,e){return this.Dd.promise.then(t,e)},Wd.prototype.zl=function(t){this.Hl(t),this.Sd.complete&&this.Sd.complete(),this.Dd.resolve(t)},Wd.prototype.Yl=function(t){this.Cd.taskState="Error",this.Sd.next&&this.Sd.next(this.Cd),this.Sd.error&&this.Sd.error(t),this.Dd.reject(t)},Wd.prototype.Hl=function(t){this.Cd=t,this.Sd.next&&this.Sd.next(t)},Wd);function Wd(){this.Sd={},this.Dd=new Aa,this.Cd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Xd(){return null!==zd&&zd.apply(this,arguments)||this}function Yd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jd.call(this,new(yl.bind.apply(yl,f([void 0],t))))||this}Qd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Qd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Qd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A=Qd;function Qd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:ud,GeoPoint:Gl,Timestamp:ki,Blob:pi,Transaction:gd,WriteBatch:md,DocumentReference:wd,DocumentSnapshot:Cd,Query:Pd,QueryDocumentSnapshot:kd,QuerySnapshot:Vd,CollectionReference:Ud,FieldPath:je,FieldValue:o,setLogLevel:function(t){Br.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new A("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new ud(e,new Yf(e,t),new sd)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.2-longpoll.66863f547"),ud.prototype.loadBundle=function(t){return e=this,s=t,t=new Kd,function(n,t,r){var e,i=this,o=(e=s,t=Wc(t),e=function(t){if(t instanceof Uint8Array)return fl(t,void 0);if(t instanceof ArrayBuffer)return fl(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new dl(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ul,[4,Gf(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(Zf(e._),e.g_,t),t;var e,s},ud.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.To.Ls(t,e)})},[4,Hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Zf((e=this)._),t).then(function(t){return t?new Pd(e,new kl(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});