!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Af){"use strict";try{(function(){var u,t,e=(t=Af)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=O||self;function L(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),P=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:V).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function x(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,_)&&this[_]||(this[_]=++P))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}var J=S.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}H=(J=J&&J.userAgent)?J:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=L;var nt,rt=X(H,"Opera"),it=X(H,"Trident")||X(H,"MSIE"),ot=X(H,"Edge"),st=ot||it,ut=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),at=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}var ct="",lt=(lt=H,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=K(String(nt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",L,e),S.removeEventListener("test",L,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},x(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Dt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[Et]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Et]?t.va(e,n,R(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Ct(t);if(h||(t[Lt]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Lt]=null)):At(t)))}function Pt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Ut(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new wt(e,this))}function Ct(t){return(t=t[Lt])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==D(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function xt(){q.call(this),this.c=new Nt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(xt,q),xt.prototype[Et]=!0,(N=xt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=jt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(xt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=S.JSON.stringify;function Gt(){this.b=this.a=null}var Wt,Bt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Ht},function(t){t.reset()},100));function zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Kt(t,e){var n;Wt||(n=S.Promise.resolve(void 0),Wt=function(){n.then(Jt)}),Xt||(Wt(),Xt=!0),Qt.add(t,e)}Gt.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Yt(t,e){xt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=j()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}x(Yt,xt),(N=Yt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},N.G=function(){Yt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=q),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){q.call(this),this.b=t,this.a={}}x(se,q);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new xt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}x(de,mt),x(ve,mt),x(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,O={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function Le(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=ke,t=st?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}x(Oe,mt),x(Se,mt),x(Le,Ie),Ne=new Le;var ke=45e3,Re={},_e={};function Pe(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=j(),Ce(t),t.l=Xe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Fe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),xe(t))}function Ce(t){t.U=j()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function je(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),Bn(u)}$n(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Ce(o)),n.a=i):Yn(n),0<u.g.length&&Kn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Wn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),je(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),qe(this),xe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Fe(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),qe(this),xe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,qe(this)},N.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),qe(this),this.h=2,xe(this)):Me(this,this.U-n)},(N=We.prototype).K=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Be(this),this.a.concat()},N.get=function(t,e){return ze(this.b,t)?this.b[t]:e},N.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=en(n[2]||""),Je(this,n[3]||"",!0),Ye(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Xe(t){return new Ke(t)}function Qe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?en(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new We,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function pn(t,e){return ln(t),e=yn(t,e),ze(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),B(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=W(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function On(){this.a=new Nn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Ln=S.JSON.parse;function Dn(t){xt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}x(Dn,xt);var kn="",Rn=/^https?$/i,_n=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Mn(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.X()))if(t.l&&4==xn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Fn("baseRetryDelayMs",5e3,t),this.Ma=Fn("retryDelaySeedMs",1e4,t),this.Ja=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Wn(t){var e,n;zn(t),3==t.v&&(e=t.R++,Ze(n=Xe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Qn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=j(),Ce(e)),or(t)}function Bn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function zn(t){Bn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Kn(t)}function Kn(t){wn(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Qn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Pe(n,r,e)}function Qn(t,n){t.f&&Ge({},function(t,e){Ze(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ge(t,function(t,e){var n=t;R(t)&&(n=Ft(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.U=1,Kt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Qn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,Ue(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Kn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Qe(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),zn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Xe(s):new Ke(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ye(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.W&&Y(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Qn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){xt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new We(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Dn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),Ze(i=Xe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&qn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Pe(n,i,null)):Pe(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Bn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,Bn(this),$n(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,xt),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Kn(t)},N.close=function(){Wn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Ft(t),Hn(this.a,e)):Hn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,cr.S.G.call(this)},x(lr,Oe),x(fr,Se),x(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",xt.prototype.listen=xt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var dr=be,yr=Ee,vr=Ae,gr=Dn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=(n(Nr,br=Error),Nr),Tr="8.0.0-2020922203858",Ar=new l("@firebase/firestore");function Nr(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Or(){return Ar.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(kr),Ar.debug.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(kr),Ar.error.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(kr),Ar.warn.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){throw void 0===t&&(t="Unexpected state"),Lr(t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function _r(t){t||Rr()}var Pr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Cr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Mr=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.h=function(t){return Vr(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}Mr.u=new Mr("");var xr=(qr.fromBase64String=function(t){try{return new qr(Mr.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},qr.fromUint8Array=function(t){return new qr(Mr.fromUint8Array(t))},qr.prototype.toBase64=function(){return this.l.toBase64()},qr.prototype.toUint8Array=function(){return this.l.toUint8Array()},qr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},qr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},qr);function qr(t){this.l=t}function Fr(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gr(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Wr(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var Br,zr=(n(Xr,Br=xr),Xr.fromBase64String=function(t){Gr();try{return new Xr(Mr.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Xr.fromUint8Array=function(t){return Fr(),new Xr(Mr.fromUint8Array(t))},Xr.prototype.toBase64=function(){return Gr(),Br.prototype.toBase64.call(this)},Xr.prototype.toUint8Array=function(){return Fr(),Br.prototype.toUint8Array.call(this)},Xr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xr),Hr=(Object.defineProperty(Kr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Kr.prototype.isEqual=function(t){return t instanceof Kr&&t.projectId===this.projectId&&t.database===this.database},Kr.prototype.h=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Kr);function Kr(t,e){this.projectId=t,this.database=e||"(default)"}function Xr(){return null!==Br&&Br.apply(this,arguments)||this}function Qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Yr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $r,Zr,ti=(pi.prototype.get=function(t){var e=this.I(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},pi.prototype.has=function(t){return void 0!==this.get(t)},pi.prototype.set=function(t,e){var n=this.I(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},pi.prototype.delete=function(t){var e=this.I(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},pi.prototype.forEach=function(s){Jr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},pi.prototype.P=function(){return Yr(this.R)},pi),ei=(fi.now=function(){return fi.fromMillis(Date.now())},fi.fromDate=function(t){return fi.fromMillis(t.getTime())},fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new fi(e,1e6*(t-1e3*e))},fi.prototype.toDate=function(){return new Date(this.toMillis())},fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},fi.prototype.V=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},fi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},fi),ni=(li.p=function(t){return new li(t)},li.min=function(){return new li(new ei(0,0))},li.prototype.h=function(t){return this.timestamp.V(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.g=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.v=function(){return this.timestamp},li),l=(Object.defineProperty(ci.prototype,"length",{get:function(){return this.C},enumerable:!1,configurable:!0}),ci.prototype.isEqual=function(t){return 0===ci.S(this,t)},ci.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ci?t.forEach(function(t){e.push(t)}):e.push(t),this.D(e)},ci.prototype.limit=function(){return this.offset+this.length},ci.prototype.F=function(t){return t=void 0===t?1:t,this.D(this.segments,this.offset+t,this.length-t)},ci.prototype.N=function(){return this.D(this.segments,this.offset,this.length-1)},ci.prototype.$=function(){return this.segments[this.offset]},ci.prototype.k=function(){return this.get(this.length-1)},ci.prototype.get=function(t){return this.segments[this.offset+t]},ci.prototype.P=function(){return 0===this.length},ci.prototype.O=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.M=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ci.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},ci.S=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ci),ri=(n(hi,Zr=l),hi.prototype.D=function(t,e,n){return new hi(t,e,n)},hi.prototype.q=function(){return this.L().join("/")},hi.prototype.toString=function(){return this.q()},hi.U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.B=function(){return new hi([])},hi),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(n(ai,$r=l),ai.prototype.D=function(t,e,n){return new ai(t,e,n)},ai.j=function(t){return ii.test(t)},ai.prototype.q=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.j(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.q()},ai.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ai.K=function(){return new ai(["__name__"])},ai.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.B=function(){return new ai([])},ai),si=(ui.H=function(t){return new ui(ri.U(t))},ui.Y=function(t){return new ui(ri.U(t).F(5))},ui.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.S(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.S=function(t,e){return ri.S(t.path,e.path)},ui.X=function(t){return t.length%2==0},ui.Z=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==$r&&$r.apply(this,arguments)||this}function hi(){return null!==Zr&&Zr.apply(this,arguments)||this}function ci(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.C=n}function li(t){this.timestamp=t}function fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t,e){this.I=t,this.A=e,this.R={}}function di(t){return null==t}function yi(t){return 0===t&&1/t==-1/0}var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function mi(t){var e=t;return null===e.tt&&(t=e.path.q(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.q()+t.op.toString()+mo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.q()+t.dir}).join(","),di(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=xu(e.startAt)),e.endAt&&(t+="|ub:",t+=xu(e.endAt)),e.tt=t),e.tt}function wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fu(t.startAt,e.startAt)&&Fu(t.endAt,e.endAt)}function bi(t){return si.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ei(t){this.count=t}var Ii,Ti=(Ai.prototype.st=function(t){return new Ai(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.it=function(t,e){return new Ai(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.rt=function(t){return new Ai(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=Mr.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case Er.OK:return Rr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return Rr(),0}}function Oi(t){if(void 0===t)return Lr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Ii.OK:return Er.OK;case Ii.CANCELLED:return Er.CANCELLED;case Ii.UNKNOWN:return Er.UNKNOWN;case Ii.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Ii.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Ii.INTERNAL:return Er.INTERNAL;case Ii.UNAVAILABLE:return Er.UNAVAILABLE;case Ii.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Ii.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Ii.NOT_FOUND:return Er.NOT_FOUND;case Ii.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Ii.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Ii.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Ii.ABORTED:return Er.ABORTED;case Ii.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Ii.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Ii.DATA_LOSS:return Er.DATA_LOSS;default:return Rr()}}(l=Ii=Ii||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Si=(_i.prototype.ot=function(t,e){return new _i(this.S,this.root.ot(t,e,this.S).copy(null,null,Di.ht,null,null))},_i.prototype.remove=function(t){return new _i(this.S,this.root.remove(t,this.S).copy(null,null,Di.ht,null,null))},_i.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.S(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},_i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.S(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},_i.prototype.P=function(){return this.root.P()},Object.defineProperty(_i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),_i.prototype.ct=function(){return this.root.ct()},_i.prototype.ut=function(){return this.root.ut()},_i.prototype.at=function(t){return this.root.at(t)},_i.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},_i.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},_i.prototype.lt=function(t){return this.root.lt(t)},_i.prototype._t=function(){return new Li(this.root,null,this.S,!1)},_i.prototype.ft=function(t){return new Li(this.root,t,this.S,!1)},_i.prototype.dt=function(){return new Li(this.root,null,this.S,!0)},_i.prototype.wt=function(t){return new Li(this.root,t,this.S,!0)},_i),Li=(Ri.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Ri.prototype.At=function(){return 0<this.Tt.length},Ri.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ri),Di=(ki.prototype.copy=function(t,e,n,r,i){return new ki(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},ki.prototype.P=function(){return!1},ki.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},ki.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},ki.prototype.min=function(){return this.left.P()?this:this.left.min()},ki.prototype.ct=function(){return this.min().key},ki.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},ki.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},ki.prototype.Vt=function(){if(this.left.P())return ki.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Vt(),null)).Pt()},ki.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.vt()),r.right.P()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.P())return ki.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Vt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},ki.prototype.yt=function(){return this.color},ki.prototype.Pt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.Ct()),t.left.yt()&&t.left.left.yt()&&(t=t.vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},ki.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).Ct()).St()),t},ki.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.vt()).St()),t},ki.prototype.Ct=function(){var t=this.copy(null,null,ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},ki.prototype.vt=function(){var t=this.copy(null,null,ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},ki.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},ki.prototype.Dt=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},ki.prototype.Ft=function(){if(this.yt()&&this.left.yt())throw Rr();if(this.right.yt())throw Rr();var t=this.left.Ft();if(t!==this.right.Ft())throw Rr();return t+(this.yt()?0:1)},ki);function ki(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ki.RED,this.left=null!=r?r:ki.EMPTY,this.right=null!=i?i:ki.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function _i(t,e){this.S=t,this.root=e||Di.EMPTY}function Pi(){this.size=0}Di.EMPTY=null,Di.RED=!0,Di.ht=!1,Di.EMPTY=(Object.defineProperty(Pi.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Pi.prototype.copy=function(t,e,n,r,i){return this},Pi.prototype.ot=function(t,e,n){return new Di(t,e)},Pi.prototype.remove=function(t,e){return this},Pi.prototype.P=function(){return!0},Pi.prototype.at=function(t){return!1},Pi.prototype.lt=function(t){return!1},Pi.prototype.ct=function(){return null},Pi.prototype.ut=function(){return null},Pi.prototype.yt=function(){return!1},Pi.prototype.Dt=function(){return!0},Pi.prototype.Ft=function(){return 0},new Pi);var Ui=(ji.prototype.has=function(t){return null!==this.data.get(t)},ji.prototype.first=function(){return this.data.ct()},ji.prototype.last=function(){return this.data.ut()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ji.prototype.indexOf=function(t){return this.data.indexOf(t)},ji.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},ji.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.S(r.key,t[1]))return;e(r.key)}},ji.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},ji.prototype.$t=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},ji.prototype._t=function(){return new Vi(this.data._t())},ji.prototype.ft=function(t){return new Vi(this.data.ft(t))},ji.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ji.prototype.P=function(){return this.data.P()},ji.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ji.prototype.isEqual=function(t){if(!(t instanceof ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.S(r,i))return!1}return!0},ji.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ji.prototype.copy=function(t){var e=new ji(this.S);return e.data=t,e},ji),Vi=(Mi.prototype.It=function(){return this.Ot.It().key},Mi.prototype.At=function(){return this.Ot.At()},Mi),Ci=new Si(si.S);function Mi(t){this.Ot=t}function ji(t){this.S=t,this.data=new Si(this.S)}var xi=new Si(si.S),qi=new Si(si.S),Fi=new Ui(si.S);function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Ui(Vr),Bi=(so.qt=function(t){return new so(t.S)},so.prototype.has=function(t){return null!=this.Mt.get(t)},so.prototype.get=function(t){return this.Mt.get(t)},so.prototype.first=function(){return this.Lt.ct()},so.prototype.last=function(){return this.Lt.ut()},so.prototype.P=function(){return this.Lt.P()},so.prototype.indexOf=function(t){return(t=this.Mt.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(so.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),so.prototype.forEach=function(n){this.Lt.at(function(t,e){return n(t),!1})},so.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.ot(t.key,t),e.Lt.ot(t,null))},so.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Lt.remove(e)):this},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},so.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},so.prototype.copy=function(t,e){var n=new so;return n.S=this.S,n.Mt=t,n.Lt=e,n},so),zi=(oo.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Rr()},oo.prototype.Bt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},oo),Hi=(io.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new io(t,e,Bi.qt(e),i,n,r,!0,!1)},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return!this.Wt.P()},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Qt===t.Qt&&this.Wt.isEqual(t.Wt)&&au(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.jt.isEqual(t.jt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},io),Ki=(ro.Xt=function(t,e){var n=new Map;return n.set(t,Xi.Zt(t,e)),new ro(ni.min(),n,Wi,Ci,Gi())},ro),Xi=(no.Zt=function(t,e){return new no(Mr.u,e,Gi(),Gi(),Gi())},no),Qi=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Ji=function(t,e){this.targetId=t,this.oe=e},Yi=function(t,e,n,r){void 0===n&&(n=Mr.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},$i=(Object.defineProperty(eo.prototype,"te",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"_e",{get:function(){return 0!==this.he},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),eo.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ue=t)},eo.prototype.we=function(){var n=Gi(),r=Gi(),i=Gi();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Xi(this.ue,this.ae,n,r,i)},eo.prototype.Ee=function(){this.le=!1,this.ce=ao()},eo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},eo.prototype.me=function(t){this.le=!0,this.ce=this.ce.remove(t)},eo.prototype.Ie=function(){this.he+=1},eo.prototype.Ae=function(){--this.he},eo.prototype.Re=function(){this.le=!0,this.ae=!0},eo),Zi=(to.prototype.ve=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Bs?this.be(r,t.re):t.re instanceof zs&&this.Ce(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ce(s,t.key,t.re)}},to.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Fe(t);switch(n.state){case 0:r.Ne(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Ne(t)&&(r.xe(t),e.de(n.resumeToken));break;default:Rr()}})},to.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ve.forEach(function(t,e){r.Ne(e)&&n(e)})},to.prototype.$e=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(bi(t=t.target)?0===n?(t=new si(t.path),this.Ce(e,t,new zs(t,ni.min()))):_r(1===n):this.Oe(e)!==n&&(this.xe(e),this.ge=this.ge.add(e)))},to.prototype.Me=function(r){var i=this,o=new Map;this.Ve.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&bi(n.target)&&(n=new si(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Ce(e,n,new zs(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Gi();this.pe.forEach(function(t,e){var n=!0;e.xt(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Ki(r,o,this.ge,this.ye,s);return this.ye=Ci,this.pe=uo(),this.ge=new Ui(Vr),t},to.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Le(t,e.key)?2:0,this.Fe(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.pe=this.pe.ot(e.key,this.qe(e.key).add(t)))},to.prototype.Ce=function(t,e,n){var r;this.Ne(t)&&(r=this.Fe(t),this.Le(t,e)?r.Te(e,1):r.me(e),this.pe=this.pe.ot(e,this.qe(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},to.prototype.removeTarget=function(t){this.Ve.delete(t)},to.prototype.Oe=function(t){var e=this.Fe(t).we();return this.Pe.Ue(t).size+e.ee.size-e.se.size},to.prototype.Ie=function(t){this.Fe(t).Ie()},to.prototype.Fe=function(t){var e=this.Ve.get(t);return e||(e=new $i,this.Ve.set(t,e)),e},to.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new Ui(Vr),this.pe=this.pe.ot(t,e)),e},to.prototype.Ne=function(t){var e=null!==this.ke(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},to.prototype.ke=function(t){var e=this.Ve.get(t);return e&&e._e?null:this.Pe.Be(t)},to.prototype.xe=function(e){var n=this;this.Ve.set(e,new $i),this.Pe.Ue(e).forEach(function(t){n.Ce(e,t,null)})},to.prototype.Le=function(t,e){return this.Pe.Ue(t).has(e)},to);function to(t){this.Pe=t,this.Ve=new Map,this.ye=Ci,this.pe=uo(),this.ge=new Ui(Vr)}function eo(){this.he=0,this.ce=ao(),this.ue=Mr.u,this.ae=!1,this.le=!0}function no(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function ro(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function io(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.jt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.Qt=s,this.Kt=u}function oo(){this.Ut=new Si(si.S)}function so(n){this.S=n?function(t,e){return n(t,e)||si.S(t.key,e.key)}:function(t,e){return si.S(t.key,e.key)},this.Mt=xi,this.Lt=new Si(this.S)}function uo(){return new Si(si.S)}function ao(){return new Si(si.S)}function ho(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function co(t){return t=wo(t.mapValue.fields.__local_write_time__.timestampValue),new ei(t.seconds,t.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Rr()}function po(r,i){var t,e,n,o=fo(r);if(o!==fo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return co(r).isEqual(co(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=wo(r.timestampValue),t=wo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Eo(r.bytesValue).isEqual(Eo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,bo((t=r).geoPointValue.latitude)===bo(o.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?bo(e.integerValue)===bo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=bo(e.doubleValue))===(n=bo(n.doubleValue))?yi(e)===yi(n):isNaN(e)&&isNaN(n));case 9:return Cr(r.arrayValue.values||[],i.arrayValue.values||[],po);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Qr(e)!==Qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!po(e[t],n[t])))return!1;return!0}();default:return Rr()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,r,i,o,s=fo(t),u=fo(e);if(s!==u)return Vr(s,u);switch(s){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=bo(t.integerValue||t.doubleValue))<(n=bo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Eo(i),o=Eo(o),i.h(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=Vr(bo(s.latitude),bo(r.latitude)))?n:Vr(bo(s.longitude),bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;if(0!==(u=vo(n[r[s]],i[o[s]])))return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=wo(t),t=wo(e);return 0!==(e=Vr(n.seconds,t.seconds))?e:Vr(n.nanos,t.nanos)}function mo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=wo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Eo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,si.Y(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e}(t)}function wo(t){if(_r(!!t),"string"!=typeof t)return{seconds:bo(t.seconds),nanos:bo(t.nanos)};var e=0,n=lo.exec(t);return _r(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?Mr.fromBase64String(t):Mr.fromUint8Array(t)}function Io(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.q()}}function To(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function Oo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function So(t){return t&&"mapValue"in t}var Lo={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ko=function(t,e){this._=t,this.je=e};function Ro(t){return{integerValue:""+t}}function _o(t,e){if(t.je){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!yi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ro(e):_o(t,e);var n}function Uo(t,e){return t.je?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.je?e.toBase64():e.toUint8Array()}function Co(t){return _r(!!t),ni.p((t=wo(t),new ei(t.seconds,t.nanos)))}function Mo(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).q()}function jo(t,e){return Mo(t._,e.path)}function xo(t,e){return _r(Ho(e=ri.U(e))),_r(e.get(1)===t._.projectId),_r(!e.get(3)&&!t._.database||e.get(3)===t._.database),new si((_r(4<(e=e).length&&"documents"===e.get(4)),e.F(5)))}function qo(t,e){return Mo(t._,e)}function Fo(t){return new ri(["projects",t._.projectId,"databases",t._.database]).q()}function Go(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function Wo(t,e){var n,r,i;if(e instanceof Is)n={update:Go(t,e.key,e.value)};else if(e instanceof Ps)n={delete:jo(t,e.key)};else if(e instanceof Ts)n={update:Go(t,e.key,e.data),updateMask:(i=e.We,r=[],i.fields.forEach(function(t){return r.push(t.q())}),{fieldPaths:r})};else if(e instanceof Ls)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.q(),setToServerValue:"REQUEST_TIME"};if(e instanceof Yo)return{fieldPath:t.field.q(),appendMissingElements:{values:e.elements}};if(e instanceof ns)return{fieldPath:t.field.q(),removeAllFromArray:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.q(),increment:e.Qe};throw Rr()})}};else{if(!(e instanceof Us))return Rr();n={verify:jo(t,e.key)}}return e.Ge.Ke||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:Uo(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:Rr()),n}function Bo(t){return{before:t.before,values:t.position}}function zo(t){return{fieldPath:t.q()}}function Ho(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ko(t,e){return t instanceof ss?To(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Xo,Qo,Jo=(n(Zo,Qo=l=function(){this.ze=void 0}),Zo),Yo=(n($o,Xo=l),$o);function $o(t){var e=this;return(e=Xo.call(this)||this).elements=t,e}function Zo(){return null!==Qo&&Qo.apply(this,arguments)||this}function ts(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var es,ns=(n(rs,es=l),rs);function rs(t){var e=this;return(e=es.call(this)||this).elements=t,e}function is(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var os,ss=(n(us,os=l),us);function us(t,e){var n=this;return(n=os.call(this)||this).serializer=t,n.Qe=e,n}function as(t){return bo(t.integerValue||t.doubleValue)}function hs(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function cs(t,e){this.field=t,this.transform=e}var ls=(fs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].O(t))return!0;return!1},fs.prototype.isEqual=function(t){return Cr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},fs);function fs(t){(this.fields=t).sort(oi.S)}function ps(t,e){this.version=t,this.transformResults=e}var ds=(ys.Ye=function(){return new ys},ys.exists=function(t){return new ys(void 0,t)},ys.updateTime=function(t){return new ys(t)},Object.defineProperty(ys.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ys.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ys);function ys(t,e){this.updateTime=t,this.exists=e}function vs(t,e){return void 0!==t.updateTime?e instanceof Bs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Bs}function gs(t,e,n,r){return t instanceof Is?(o=e,vs((i=t).Ge,o)?(o=ws(o),new Bs(i.key,o,i.value,{Je:!0})):o):t instanceof Ts?function(t,e){if(!vs(t.Ge,e))return e;var n=ws(e),e=Os(t,e);return new Bs(t.key,n,e,{Je:!0})}(t,e):t instanceof Ls?function(t,e,n,r){if(!vs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Bs&&(c=n.field(a.field)),null===c&&r instanceof Bs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof Jo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Yo?ts(h,i):h instanceof ns?is(h,i):(i=as(h=Ko(c=h,i))+as(c.Qe),To(h)&&To(c.Qe)?Ro(i):_o(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=ks(t,i.data(),r);return new Bs(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,vs((t=t).Ge,e)?new zs(t.key,ni.min()):e);var i,o}function ms(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||Cr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Yo&&e instanceof Yo||t instanceof ns&&e instanceof ns?Cr(t.elements,e.elements,po):t instanceof ss&&e instanceof ss?po(t.Qe,e.Qe):t instanceof Jo&&e instanceof Jo)}))}function ws(t){return t instanceof Bs?t.version:ni.min()}var bs,Es,Is=(n(Ns,Es=l=function(){}),Ns),Ts=(n(As,bs=l),As);function As(t,e,n,r){var i=this;return(i=bs.call(this)||this).key=t,i.data=e,i.We=n,i.Ge=r,i.type=1,i}function Ns(t,e,n){var r=this;return(r=Es.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Os(t,e){return n=t,e=e instanceof Bs?e.data():Vs.empty(),r=new Cs(e),n.We.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Ss,Ls=(n(Ds,Ss=l),Ds);function Ds(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=ds.exists(!0),n}function ks(t,e,n){for(var r=new Cs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Rs,_s,Ps=(n(qs,_s=l),qs),Us=(n(xs,Rs=l),xs),Vs=(js.empty=function(){return new js({mapValue:{}})},js.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!So(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},js.prototype.isEqual=function(t){return po(this.proto,t.proto)},js),Cs=(Ms.prototype.set=function(t,e){return this.en(t,e),this},Ms.prototype.delete=function(t){return this.en(t,null),this},Ms.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},Ms.prototype.Xe=function(){var t=this.nn(oi.B(),this.tn);return null!=t?new Vs(t):this.Ze},Ms.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=So(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ms);function Ms(t){void 0===t&&(t=Vs.empty()),this.Ze=t,this.tn=new Map}function js(t){this.proto=t}function xs(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function qs(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.Ge=e,n.type=3,n}var Fs,Gs,Ws,Bs=(n(Js,Ws=l=function(t,e){this.key=t,this.version=e}),Js.prototype.field=function(t){return this.sn.field(t)},Js.prototype.data=function(){return this.sn},Js.prototype.rn=function(){return this.sn.proto},Js.prototype.isEqual=function(t){return t instanceof Js&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},Js.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js),zs=(n(Qs,Gs=l),Qs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs),Hs=(n(Xs,Fs=l),Xs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Xs.prototype.isEqual=function(t){return t instanceof Xs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Xs),Ks=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.hn=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function Xs(){return null!==Fs&&Fs.apply(this,arguments)||this}function Qs(t,e,n){var r=this;return(r=Gs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Js(t,e,n,r){var i=this;return(i=Ws.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ys(t){return new Ks(t)}function $s(t){return!di(t.limit)&&"F"===t.hn}function Zs(t){return!di(t.limit)&&"L"===t.hn}function tu(t){return 0<t.on.length?t.on[0].field:null}function eu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function nu(t){return null!==t.collectionGroup}function ru(t){var e=t;if(null===e.cn){e.cn=[];var n=eu(e),t=tu(e);if(null!==n&&null===t)n.W()||e.cn.push(new Gu(n)),e.cn.push(new Gu(oi.K(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new Gu(oi.K(),n)))}}return e.cn}function iu(t){var e=t;if(!e.un)if("F"===e.hn)e.un=gi(e.path,e.collectionGroup,ru(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ru(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Gu(o.field,s))}var u=e.endAt?new Uu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Uu(e.startAt.position,!e.startAt.before):null;e.un=gi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function ou(t,e,n){return new Ks(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function su(t,e){return new Ks(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.hn,e,t.endAt)}function uu(t,e){return new Ks(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.hn,t.startAt,e)}function au(t,e){return wi(iu(t),iu(e))&&t.hn===e.hn}function hu(t){return mi(iu(t))+"|lt:"+t.hn}function cu(t){return"Query(target="+(n=(e=iu(t)).path.q(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.q()+" "+t.op+" "+mo(t.value)}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.q()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+xu(e.startAt)),e.endAt&&(n+=", endAt: "+xu(e.endAt)),"Target("+n+")")+"; limitType="+t.hn+")";var e,n}function lu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.O(n):si.X(e.path)?e.path.isEqual(n):e.path.M(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||qu(t.startAt,ru(t),n))&&(!t.endAt||!qu(t.endAt,ru(t),n)));var e,n}function fu(u){return function(t,e){for(var n=!1,r=0,i=ru(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.W()?si.S(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?vo(o,r):Rr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var pu,du=(n(yu,pu=function(){}),yu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new wu(t,e,n):"array-contains"===e?new ku(t,n):"in"===e?new Ru(t,n):"not-in"===e?new _u(t,n):"array-contains-any"===e?new Pu(t,n):new yu(t,e,n)},yu.ln=function(t,e,n){return new("in"===e?bu:Eu)(t,n)},yu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(vo(t,this.value)):null!==t&&fo(this.value)===fo(t)&&this._n(vo(t,this.value))},yu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},yu.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},yu);function yu(t,e,n){var r=this;return(r=pu.call(this)||this).field=t,r.op=e,r.value=n,r}var vu,gu,mu,wu=(n(Au,mu=du),Au.prototype.matches=function(t){return t=si.S(t.key,this.key),this._n(t)},Au),bu=(n(Tu,gu=du),Tu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Tu),Eu=(n(Iu,vu=du),Iu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Iu);function Iu(t,e){var n=this;return(n=vu.call(this,t,"not-in",e)||this).keys=Nu(0,e),n}function Tu(t,e){var n=this;return(n=gu.call(this,t,"in",e)||this).keys=Nu(0,e),n}function Au(t,e,n){var r=this;return(r=mu.call(this,t,e,n)||this).key=si.Y(n.referenceValue),r}function Nu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return si.Y(t.referenceValue)})}var Ou,Su,Lu,Du,ku=(n(ju,Du=du),ju.prototype.matches=function(t){return Ao(t=t.field(this.field))&&yo(t.arrayValue,this.value)},ju),Ru=(n(Mu,Lu=du),Mu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&yo(this.value.arrayValue,t)},Mu),_u=(n(Cu,Su=du),Cu.prototype.matches=function(t){return!yo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!yo(this.value.arrayValue,t))},Cu),Pu=(n(Vu,Ou=du),Vu.prototype.matches=function(t){var e=this;return!(!Ao(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},Vu),Uu=function(t,e){this.position=t,this.before=e};function Vu(t,e){return Ou.call(this,t,"array-contains-any",e)||this}function Cu(t,e){return Su.call(this,t,"not-in",e)||this}function Mu(t,e){return Lu.call(this,t,"in",e)||this}function ju(t,e){return Du.call(this,t,"array-contains",e)||this}function xu(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}function qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?si.S(si.Y(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Fu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var Gu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Wu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Bu=(Ku.prototype.reset=function(){this.mn=0},Ku.prototype.Rn=function(){this.mn=this.Tn},Ku.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Vn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.mn*=this.En,this.mn<this.wn&&(this.mn=this.wn),this.mn>this.Tn&&(this.mn=this.Tn)},Ku.prototype.pn=function(){null!==this.In&&(this.In.gn(),this.In=null)},Ku.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},Ku.prototype.Vn=function(){return(Math.random()-.5)*this.mn},Ku),zu=(Hu.prototype.catch=function(t){return this.next(void 0,t)},Hu.prototype.next=function(r,i){var o=this;return this.Sn&&Rr(),this.Sn=!0,this.Cn?this.error?this.Dn(i,this.error):this.Fn(r,this.result):new Hu(function(e,n){o.vn=function(t){o.Fn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},Hu.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Hu.prototype.xn=function(t){try{var e=t();return e instanceof Hu?e:Hu.resolve(e)}catch(t){return Hu.reject(t)}},Hu.prototype.Fn=function(t,e){return t?this.xn(function(){return t(e)}):Hu.resolve(e)},Hu.prototype.Dn=function(t,e){return t?this.xn(function(){return t(e)}):Hu.reject(e)},Hu.resolve=function(n){return new Hu(function(t,e){t(n)})},Hu.reject=function(n){return new Hu(function(t,e){e(n)})},Hu.$n=function(t){return new Hu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Hu.kn=function(t){for(var n=Hu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Hu.resolve(t):e()})}(r[e]);return n},Hu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Hu);function Hu(t){var e=this;this.vn=null,this.bn=null,this.result=void 0,this.error=void 0,this.Cn=!1,this.Sn=!1,t(function(t){e.Cn=!0,e.result=t,e.vn&&e.vn(t)},function(t){e.Cn=!0,e.error=t,e.bn&&e.bn(t)})}function Ku(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.mn=0,this.In=null,this.An=Date.now(),this.reset()}function Xu(t){return"IndexedDbTransactionError"===t.name}function Qu(){return"undefined"!=typeof document?document:null}var Ju=(Zu.Un=function(t,e,n,r,i){return(i=new Zu(t,e,Date.now()+n,r,i)).start(n),i},Zu.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.jn()},t)},Zu.prototype.gn=function(){return this.jn()},Zu.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Zu.prototype.jn=function(){var e=this;this.On.Wn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},Zu.prototype.clearTimeout=function(){null!==this.Bn&&(this.Ln(this),clearTimeout(this.Bn),this.Bn=null)},Zu),Yu=(Object.defineProperty($u.prototype,"ts",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),$u.prototype.Wn=function(t){this.enqueue(t)},$u.prototype.es=function(t){this.ns(),this.ss(t)},$u.prototype.rs=function(){var t;this.Gn||(this.Gn=!0,(t=Qu())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Zn))},$u.prototype.enqueue=function(t){return this.ns(),this.Gn?new Promise(function(t){}):this.ss(t)},$u.prototype.os=function(t){var e=this;this.Wn(function(){return e.Kn.push(t),e.hs()})},$u.prototype.hs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Kn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Kn[0]()];case 2:return t.sent(),this.Kn.shift(),this.Xn.reset(),[3,4];case 3:if(!Xu(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Kn.length&&this.Xn.Pn(function(){return n.hs()}),t.label=5;case 5:return[2]}})})},$u.prototype.ss=function(t){var r=this,e=this.Qn.then(function(){return r.Yn=!0,t().catch(function(t){throw r.Hn=t,r.Yn=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Yn=!1,t})});return this.Qn=e},$u.prototype.yn=function(t,e,n){var r=this;return this.ns(),-1<this.Jn.indexOf(t)&&(e=0),n=Ju.Un(this,t,e,n,function(t){return r.cs(t)}),this.zn.push(n),n},$u.prototype.ns=function(){this.Hn&&Rr()},$u.prototype.us=function(){},$u.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qn)return[3,0];t.label=3;case 3:return[2]}})})},$u.prototype._s=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].dn===t)return!0;return!1},$u.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.zn.sort(function(t,e){return t.Mn-e.Mn});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.dn===r)break}return i.ls()})},$u.prototype.ds=function(t){this.Jn.push(t)},$u.prototype.cs=function(t){t=this.zn.indexOf(t),this.zn.splice(t,1)},$u);function $u(){var e=this;this.Qn=Promise.resolve(),this.Kn=[],this.Gn=!1,this.zn=[],this.Hn=null,this.Yn=!1,this.Jn=[],this.Xn=new Bu(this,"async_queue_retry"),this.Zn=function(){var t=Qu();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Xn.pn()};var t=Qu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Zn)}function Zu(t,e,n,r,i){this.On=t,this.dn=e,this.Mn=n,this.op=r,this.Ln=i,this.qn=new Wu,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function ta(t,e){if(Lr("AsyncQueue",e+": "+t),Xu(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}function ea(){this.ws=void 0,this.listeners=[]}function na(){this.Es=new ti(hu,au),this.onlineState="Unknown",this.Ts=new Set}function ra(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Es.get(n))||(r=!0,i=new ea),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=ta(o=t.sent(),"Initialization of query '"+cu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Es.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&oa(e),[2]}})})}function ia(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Es.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Es.delete(n),e.Ps(n))]:[2]})})}function oa(t){t.Ts.forEach(function(t){t.next()})}var sa=(ha.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Hi(t.query,t.docs,t.jt,e,t.Wt,t.fromCache,t.Qt,!0)}var o=!1;return this.ys?this.gs(t)&&(this.Vs.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.ps=t,o},ha.prototype.onError=function(t){this.Vs.error(t)},ha.prototype.As=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.ys&&this.vs(this.ps,t)&&(this.bs(this.ps),e=!0),e},ha.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Cs&&n||t.docs.P()&&"Offline"!==e)},ha.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.Qt&&!e)&&!0===this.options.includeMetadataChanges},ha.prototype.bs=function(t){t=Hi.Gt(t.query,t.docs,t.Wt,t.fromCache),this.ys=!0,this.Vs.next(t)},ha),ua=(aa.prototype.Ss=function(){return null!=this.uid},aa.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},aa.prototype.isEqual=function(t){return t.uid===this.uid},aa);function aa(t){this.uid=t}function ha(t,e,n){this.query=t,this.Vs=e,this.ys=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}ua.UNAUTHENTICATED=new ua(null),ua.Fs=new ua("google-credentials-uid"),ua.Ns=new ua("first-party-uid");var ca=(la.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},la.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},la);function la(t,e){var n=this;this.previousValue=t,e&&(e.xs=function(t){return n.$s(t)},this.ks=function(t){return e.Os(t)})}ca.Ms=-1;var fa=(Na.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Na.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Na.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},Na),pa=(Aa.prototype.Qs=function(t){},Aa.prototype.Ks=function(t,e,n){},Aa.prototype.Gs=function(t){return this.Bs.Ls(t),this.js[t]||"not-current"},Aa.prototype.zs=function(t,e,n){this.js[t]=e},Aa.prototype.Hs=function(t){this.Bs.qs(t)},Aa.prototype.Ys=function(t){return this.Bs.activeTargetIds.has(t)},Aa.prototype.Js=function(t){delete this.js[t]},Aa.prototype.Xs=function(){return this.Bs.activeTargetIds},Aa.prototype.Zs=function(t){return this.Bs.activeTargetIds.has(t)},Aa.prototype.start=function(){return this.Bs=new fa,Promise.resolve()},Aa.prototype.ti=function(t,e,n){},Aa.prototype.ei=function(t){},Aa.prototype.ni=function(){},Aa.prototype.Os=function(t){},Aa),da=(Ta.prototype.ii=function(t,e,n){for(var r,i,o,s,u,a,h=n.ri,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof Is?new Bs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ts?(u=i,a=o,vs((s=r).Ge,u)?(u=Os(s,u),new Bs(s.key,a.version,u,{hasCommittedMutations:!0})):new Hs(s.key,a.version)):r instanceof Ls?function(t,e,n){if(_r(null!=n.transformResults),!vs(t.Ge,e))return new Hs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Bs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Yo?ts(o,s):o instanceof ns?is(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=ks(t,r.data(),e);return new Bs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new zs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ta.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=gs(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=gs(a,e,o,this.si))}return e},Ta.prototype.hi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Ta.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gi())},Ta.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,ms)&&Cr(this.baseMutations,t.baseMutations,ms)},Ta),ya=(Ia.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=qi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Ia(t,e,n,r)},Ia),va=(Ea.prototype.fi=function(e,n){var r=this;return this.li.di(e,n).next(function(t){return r.wi(e,n,t)})},Ea.prototype.wi=function(t,r,i){return this.ai.Ei(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},Ea.prototype.Ti=function(t,e,i){var o=Ci;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.ot(t,e)}),o},Ea.prototype.mi=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ii(e,t)})},Ea.prototype.Ii=function(e,r){var i=this;return this.li.Ai(e,r).next(function(t){var t=i.Ti(e,r,t),n=Ci;return t.forEach(function(t,e){e=e||new zs(t,ni.min()),n=n.ot(t,e)}),n})},Ea.prototype.Ri=function(t,e,n){return r=e,si.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Pi(t,e.path):nu(e)?this.Vi(t,e,n):this.yi(t,e,n);var r},Ea.prototype.Pi=function(t,e){return this.fi(t,new si(e)).next(function(t){var e=xi;return t instanceof Bs&&(e=e.ot(t.key,t)),e})},Ea.prototype.Vi=function(n,r,i){var o=this,s=r.collectionGroup,u=xi;return this._i.pi(n,s).next(function(t){return zu.forEach(t,function(t){var e=(e=r,t=t.child(s),new Ks(t,null,e.on.slice(),e.filters.slice(),e.limit,e.hn,e.startAt,e.endAt));return o.yi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Ea.prototype.yi=function(e,n,t){var h,c,r=this;return this.ai.Ri(e,n,t).next(function(t){return h=t,r.li.gi(e,n)}).next(function(t){return c=t,r.vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=gs(s,a=h.get(u),a,r.si);h=a instanceof Bs?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){lu(n,e)||(h=h.remove(t))}),h})},Ea.prototype.vi=function(t,e,n){for(var r=Gi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ts&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Bs&&(h=h.ot(t,e))}),h})},Ea),ga=(ba.Si=function(t,e){for(var n=Gi(),r=Gi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ba(t,e.fromCache,n,r)},ba),ma=(wa.xi=function(t){return new wa(t,wa.$i,wa.ki)},wa);function wa(t,e,n){this.Di=t,this.Fi=e,this.Ni=n}function ba(t,e,n,r){this.targetId=t,this.fromCache=e,this.bi=n,this.Ci=r}function Ea(t,e,n){this.ai=t,this.li=e,this._i=n}function Ia(t,e,n,r){this.batch=t,this.ci=e,this.ri=n,this.ui=r}function Ta(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Aa(){this.Bs=new fa,this.js={},this.Ws=null,this.xs=null}function Na(){this.activeTargetIds=Wi}ma.Oi=-1,ma.Mi=1048576,ma.Li=41943040,ma.$i=10,ma.ki=1e3,ma.qi=new ma(ma.Li,ma.$i,ma.ki),ma.Ui=new ma(ma.Oi,0,0);var Oa=(Pa.prototype.ji=function(t,e){return this.Bi.add(e),zu.resolve()},Pa.prototype.pi=function(t,e){return zu.resolve(this.Bi.getEntries(e))},Pa),Sa=(_a.prototype.add=function(t){var e=t.k(),n=t.N(),r=this.index[e]||new Ui(ri.S),t=!r.has(n);return this.index[e]=r.add(n),t},_a.prototype.has=function(t){var e=t.k(),t=t.N();return(e=this.index[e])&&e.has(t)},_a.prototype.getEntries=function(t){return(this.index[t]||new Ui(ri.S)).L()},_a),La=(Ra.prototype.next=function(){return this.Wi+=2,this.Wi},Ra.Qi=function(){return new Ra(0)},Ra.Ki=function(){return new Ra(-1)},Ra),Da=(ka.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.hr(t,n.zi)})},ka);function ka(t,e,n){this.persistence=t,this.Gi=e,this.zi=new Si(Vr),this.Hi=new ti(mi,wi),this.Yi=ni.min(),this.li=t.Ji(n),this.Xi=t.Zi(),this.tr=t.er(),this.nr=new va(this.Xi,this.li,this.persistence.sr()),this.Gi.ir(this.nr)}function Ra(t){this.Wi=t}function _a(){this.index={}}function Pa(){this.Bi=new Sa}function Ua(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.tr.dr(t)})}function Va(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).zi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Xu(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.zi=e.zi.remove(o),e.Hi.delete(n.target),[2]}})})}function Ca(t,o,s){var u=t,a=ni.min(),h=Gi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=iu(o),(void 0!==(t=(i=t).Hi.get(r))?zu.resolve(i.zi.get(t)):i.tr.yr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.tr.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Gi.Ri(e,o,s?a:ni.min(),s?h:Gi())}).next(function(t){return{documents:t,gr:h}});var t,n,r,i})}function Ma(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ja(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}function xa(t,e,n,r,i){var o=this;this.jo=t,this.Wo=e,this.On=n,this.Qo={},this.Ko=[],this.Go=new Map,this.zo=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.Wn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return wh(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,lh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.zo.delete(4),[4,ch(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new $a(n,r)}var qa,Fa,Ga,Wa=(hh.prototype.P=function(){return this.vr.P()},hh.prototype.Dr=function(t,e){e=new Ba(t,e),this.vr=this.vr.add(e),this.Cr=this.Cr.add(e)},hh.prototype.Fr=function(t,e){var n=this;t.forEach(function(t){return n.Dr(t,e)})},hh.prototype.Nr=function(t,e){this.$r(new Ba(t,e))},hh.prototype.kr=function(t,e){var n=this;t.forEach(function(t){return n.Nr(t,e)})},hh.prototype.Or=function(t){var e=this,n=new si(new ri([])),r=new Ba(n,t),t=new Ba(n,t+1),i=[];return this.Cr.Nt([r,t],function(t){e.$r(t),i.push(t.key)}),i},hh.prototype.Mr=function(){var e=this;this.vr.forEach(function(t){return e.$r(t)})},hh.prototype.$r=function(t){this.vr=this.vr.delete(t),this.Cr=this.Cr.delete(t)},hh.prototype.Lr=function(t){var e=new si(new ri([])),n=new Ba(e,t),t=new Ba(e,t+1),r=Gi();return this.Cr.Nt([n,t],function(t){r=r.add(t.key)}),r},hh.prototype.qr=function(t){var e=new Ba(t,0);return null!==(e=this.vr.$t(e))&&t.isEqual(e.key)},hh),Ba=(ah.br=function(t,e){return si.S(t.key,e.key)||Vr(t.Ur,e.Ur)},ah.Sr=function(t,e){return Vr(t.Ur,e.Ur)||si.S(t.key,e.key)},ah),za=(uh.prototype.getToken=function(){return Promise.resolve(null)},uh.prototype.Wr=function(){},uh.prototype.Qr=function(t){(this.jr=t)(ua.UNAUTHENTICATED)},uh.prototype.Kr=function(){this.jr=null},uh),Ha=(sh.prototype.getToken=function(){var e=this,n=this.Hr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Hr!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new ja(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},sh.prototype.Wr=function(){this.forceRefresh=!0},sh.prototype.Qr=function(t){this.jr=t,this.zr&&t(this.currentUser)},sh.prototype.Kr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.jr=null},sh.prototype.Yr=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new ua(t)},sh),Ka=(Object.defineProperty(oh.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Xr},e=this.Jr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),oh),Xa=(ih.prototype.getToken=function(){return Promise.resolve(new Ka(this.Jr,this.Xr))},ih.prototype.Qr=function(t){t(ua.Ns)},ih.prototype.Kr=function(){},ih.prototype.Wr=function(){},ih),l=(rh.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},rh.prototype.oo=function(){return 2===this.state},rh.prototype.start=function(){3!==this.state?this.auth():this.ho()},rh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rh.prototype.co=function(){this.state=0,this.Xn.reset()},rh.prototype.uo=function(){var t=this;this.oo()&&null===this.io&&(this.io=this.fn.yn(this.Zr,6e4,function(){return t.ao()}))},rh.prototype.lo=function(t){this._o(),this.stream.send(t)},rh.prototype.ao=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},rh.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},rh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._o(),this.Xn.cancel(),this.so++,3!==e?this.Xn.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Xn.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.no.Wr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},rh.prototype.fo=function(){},rh.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.Eo(t)},function(e){t(function(){var t=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},rh.prototype.Eo=function(t){var e=this,n=this.wo(this.so);this.stream=this.mo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},rh.prototype.ho=function(){var t=this;this.state=4,this.Xn.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},rh.prototype.To=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},rh.prototype.wo=function(e){var n=this;return function(t){n.fn.Wn(function(){return n.so===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},rh),Qa=(n(nh,Ga=l),nh.prototype.mo=function(t){return this.eo.Ao("Listen",t)},nh.prototype.onMessage=function(t){this.Xn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Rr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.je?(_r(void 0===o||"string"==typeof o),Mr.fromBase64String(o||"")):(_r(void 0===o||o instanceof Uint8Array),Mr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Oi(s.code),new Ir(o,s.message||"")),r=new Yi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=xo(t,a.document.name),u=Co(a.document.updateTime),s=new Vs({mapValue:{fields:a.document.fields}}),u=new Bs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Qi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=xo(t,a.document),h=a.readTime?Co(a.readTime):ni.min(),h=new zs(u,h),a=a.removedTargetIds||[];r=new Qi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=xo(t,h.document),h=h.removedTargetIds||[];r=new Qi([],h,c,null)}else{if(!("filter"in e))return Rr();e.filter,(c=e.filter).targetId,e=new Ei(e=c.count||0),c=c.targetId,r=new Ji(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ni.min():Co(e.readTime);return this.listener.Ro(n,t)},nh.prototype.Po=function(t){var e,n,r,i,o,s,u,a,h={};h.database=Fo(this.serializer),h.addTarget=(e=this.serializer,(r=bi(r=(n=t).target)?{documents:{documents:[qo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=qo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=qo(i,u.N()),s.structuredQuery.from=[{collectionId:u.k()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Oo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Oo(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NAN"}};if(No(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(t.field),op:(e=t.op,Do[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:zo((t=t).field),direction:(t=t.dir,Lo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.je||di(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Bo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Bo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Vo(e,n.resumeToken)),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.lo(h)},nh.prototype.Vo=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.lo(e)},nh),Ja=(n(eh,Fa=l),Object.defineProperty(eh.prototype,"po",{get:function(){return this.yo},enumerable:!1,configurable:!0}),eh.prototype.start=function(){this.yo=!1,this.lastStreamToken=void 0,Fa.prototype.start.call(this)},eh.prototype.fo=function(){this.yo&&this.vo([])},eh.prototype.mo=function(t){return this.eo.Ao("Write",t)},eh.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.yo){this.Xn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(_r(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?Co(e.updateTime):Co(n)).isEqual(ni.min())&&(r=Co(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ps(r,n);var e,n,r})):[]),n=Co(t.commitTime);return this.listener.bo(n,e)}var i;return _r(!t.writeResults||0===t.writeResults.length),this.yo=!0,this.listener.Co()},eh.prototype.So=function(){var t={};t.database=Fo(this.serializer),this.lo(t)},eh.prototype.vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Wo(e.serializer,t)})};this.lo(t)},eh),Ya=(n(th,qa=function(){}),th.prototype.Fo=function(){if(this.Do)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},th.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Wr(),t})},th.prototype.xo=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.xo(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Wr(),t})},th.prototype.terminate=function(){this.Do=!1},th),$a=(Za.prototype.Mo=function(){var t=this;0===this.$o&&(this.Lo("Unknown"),this.ko=this.On.yn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Lo("Offline"),Promise.resolve()}))},Za.prototype.Uo=function(t){"Online"===this.state?this.Lo("Unknown"):(this.$o++,1<=this.$o&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Lo("Offline")))},Za.prototype.set=function(t){this.Bo(),this.$o=0,"Online"===t&&(this.Oo=!1),this.Lo(t)},Za.prototype.Lo=function(t){t!==this.state&&(this.state=t,this.Ws(t))},Za.prototype.qo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Oo?(Lr(t),this.Oo=!1):Sr("OnlineStateTracker",t)},Za.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},Za);function Za(t,e){this.On=t,this.Ws=e,this.state="Unknown",this.$o=0,this.ko=null,this.Oo=!0}function th(t,e,n){var r=this;return(r=qa.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Do=!1,r}function eh(t,e,n,r,i){var o=this;return(o=Fa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.yo=!1,o}function nh(t,e,n,r,i){var o=this;return(o=Ga.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function rh(t,e,n,r,i,o){this.fn=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Xn=new Bu(t,e)}function ih(t,e){this.Jr=t,this.Xr=e}function oh(t,e){this.Jr=t,this.Xr=e,this.type="FirstParty",this.user=ua.Ns}function sh(t){var e=this;this.Gr=null,this.currentUser=ua.UNAUTHENTICATED,this.zr=!1,this.Hr=0,this.jr=null,this.forceRefresh=!1,this.Gr=function(){e.Hr++,e.currentUser=e.Yr(),e.zr=!0,e.jr&&e.jr(e.currentUser)},this.Hr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function uh(){this.jr=null}function ah(t,e){this.key=t,this.Ur=e}function hh(){this.vr=new Ui(Ba.br),this.Cr=new Ui(Ba.Sr)}function ch(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!wh(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function lh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function fh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,lh(e)];case 1:return t.sent(),e.Yo.ni(),e.Xo.set("Unknown"),[2]}})})}function ph(t,e){t.Go.has(e.targetId)||(t.Go.set(e.targetId,e),mh(t)?gh(t):Oh(t).oo()&&yh(t,e))}function dh(t,e){var n=t,t=Oh(n);n.Go.delete(e),t.oo()&&vh(n,e),0===n.Go.size&&(t.oo()?t.uo():wh(n)&&n.Xo.set("Unknown"))}function yh(t,e){t.Zo.Ie(e.targetId),Oh(t).Po(e)}function vh(t,e){t.Zo.Ie(e),Oh(t).Vo(e)}function gh(e){e.Zo=new Zi({Ue:function(t){return e.Qo.Ue(t)},Be:function(t){return e.Go.get(t)||null}}),Oh(e).start(),e.Xo.Mo()}function mh(t){return wh(t)&&!Oh(t).ro()&&0<t.Go.size}function wh(t){return 0===t.zo.size}function bh(t){t.Zo=void 0}function Eh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Xu(r))throw r;return n.zo.add(1),[4,lh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return Ua(n.jo)},n.On.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,ch(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Ih(e,n){return n().catch(function(t){return Eh(e,t,n)})}function Th(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=Sh(s=c),a=0<s.Ko.length?s.Ko[s.Ko.length-1].batchId:-1,t.label=1;case 1:if(!(wh(s)&&s.Ko.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.jo,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.li.Vr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.Ko.length&&u.uo(),[3,7]):(a=h.batchId,n=h,(e=s).Ko.push(n),(e=Sh(e)).oo()&&e.po&&e.vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,Eh(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Ah(s)&&Nh(s),[2]}var e,n,r,i,o})})}function Ah(t){return wh(t)&&!Sh(t).ro()&&0<t.Ko.length}function Nh(t){Sh(t).start()}function Oh(n){var t,e,r,i=this;return n.ih||(n.ih=(t=n.Wo,e=n.On,r={Io:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Go.forEach(function(t,e){yh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return bh(e),mh(e)?(e.Xo.Uo(n),gh(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Xo.set("Online"),!(u instanceof Yi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.Qo.th(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Eh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Qi?s.Zo.ve(u):u instanceof Ji?s.Zo.$e(u):s.Zo.Se(u),a.isEqual(ni.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ua(s.jo)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).Zo.Me(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Go.get(e))&&r.Go.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Go.get(t);e&&(r.Go.set(t,e.it(Mr.u,e.nt)),vh(r,t),e=new Ti(e.target,t,1,e.sequenceNumber),yh(r,e))}),r.Qo.eh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Eh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Fo(),new Qa(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ih.co(),mh(n)?gh(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ih.stop()];case 2:t.sent(),bh(n),t.label=3;case 3:return[2]}})})})),n.ih}function Sh(n){var t,e,r,i=this;return n.rh||(n.rh=(t=n.Wo,e=n.On,r={Io:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Sh(e).So(),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Sh(e).po?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==Er.ABORTED?(e=r.Ko.shift(),Sh(r).co(),[4,Ih(r,function(){return r.Qo.sh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Th(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Ah(e)&&Nh(e),[2]}})})}.bind(null,n),Co:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Sh(o),n=0,r=o.Ko;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ko.shift(),n=ya.from(e,i,o),[4,Ih(r,function(){return r.Qo.nh(n)})];case 1:return t.sent(),[4,Th(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fo(),new Ja(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.rh.co(),[4,Th(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.rh.stop()];case 3:t.sent(),0<n.Ko.length&&(Sr("RemoteStore","Stopping write stream with "+n.Ko.length+" pending writes"),n.Ko=[]),t.label=4;case 4:return[2]}})})})),n.rh}function Lh(t,e,n){this.query=t,this.targetId=e,this.view=n}var Dh=function(t){this.key=t},kh=function(t){this.key=t},Rh=(Object.defineProperty(Vh.prototype,"_h",{get:function(){return this.oh},enumerable:!1,configurable:!0}),Vh.prototype.fh=function(t,e){var s=this,u=e?e.dh:new zi,a=(e||this).lh,h=(e||this).Wt,c=a,l=!1,f=$s(this.query)&&a.size===this.query.limit?a.last():null,p=Zs(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof Bs?e:null)&&(lu(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Je||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.ah(r,f)||p&&s.ah(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),$s(this.query)||Zs(this.query))for(;c.size>this.query.limit;){var n=$s(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{lh:c,dh:u,Eh:l,Wt:h}},Vh.prototype.wh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Vh.prototype.Th=function(t,e,n){var o=this,r=this.lh;this.lh=t.lh,this.Wt=t.Wt;var i=t.dh.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.mh(n);var s=e?this.Ih():[],e=(n=0===this.uh.size&&this.te?1:0)!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new Hi(this.query,t.lh,r,i,t.Wt,0==n,e,!1),Ah:s}:{Ah:s}},Vh.prototype.As=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Th({lh:this.lh,dh:new zi,Wt:this.Wt,Eh:!1},!1)):{Ah:[]}},Vh.prototype.Rh=function(t){return!this.oh.has(t)&&!!this.lh.has(t)&&!this.lh.get(t).Je},Vh.prototype.mh=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.oh=e.oh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.oh=e.oh.delete(t)}),this.te=t.te)},Vh.prototype.Ih=function(){var e=this;if(!this.te)return[];var n=this.uh;this.uh=Gi(),this.lh.forEach(function(t){e.Rh(t.key)&&(e.uh=e.uh.add(t.key))});var r=[];return n.forEach(function(t){e.uh.has(t)||r.push(new kh(t))}),this.uh.forEach(function(t){n.has(t)||r.push(new Dh(t))}),r},Vh.prototype.Ph=function(t){return this.oh=t.gr,this.uh=Gi(),t=this.fh(t.documents),this.Th(t,!0)},Vh.prototype.Vh=function(){return Hi.Gt(this.query,this.lh,this.Wt,0===this.hh)},Vh),_h=function(t){this.key=t,this.yh=!1},Ph=(Object.defineProperty(Uh.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),Uh);function Uh(t,e,n,r,i,o){this.jo=t,this.ph=e,this.gh=n,this.bh=r,this.currentUser=i,this.Ch=o,this.Sh={},this.Dh=new ti(hu,au),this.Fh=new Map,this.Nh=[],this.xh=new Si(si.S),this.$h=new Map,this.kh=new Wa,this.Oh={},this.Mh=new Map,this.Lh=La.Ki(),this.onlineState="Unknown",this.qh=void 0}function Vh(t,e){this.query=t,this.oh=e,this.hh=null,this.te=!1,this.uh=Gi(),this.Wt=Gi(),this.ah=fu(t),this.lh=new Bi(this.ah)}function Ch(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).ph.Qo.nh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Xi.cr({ur:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=zu.resolve();return a.forEach(function(n){h=h.next(function(){return s.Ei(o,n)}).next(function(t){var e=t;_r(null!==(t=r.ui.get(n))),(!e||e.version.h(t)<0)&&(e=u.ii(n,e,r))&&s.ar(e,r.ci)})}),h.next(function(){return i.li.lr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.li._r(t)}).next(function(){return l.nr.mi(t,e)})}))];case 2:return i=t.sent(),qh(n,r,null),xh(n,r),n.bh.Ks(r,"acknowledged"),[4,zh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ma(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.ph.Qo.sh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.li.zh(e,r).next(function(t){return _r(null!==t),n=t.keys(),i.li.lr(e,t)}).next(function(){return i.li._r(e)}).next(function(){return i.nr.mi(e,n)})}))];case 2:return o=t.sent(),qh(n,u,a),xh(n,u),n.bh.Ks(u,"rejected",a),[4,zh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ma(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jo,a=p,c=r,l=ei.now(),i=a.reduce(function(t,e){return t.add(e.key)},Gi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.nr.mi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ls?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Bs?t.field(i.field):void 0;null!=(o=Ko(i.transform,o||null))&&(e=(null==e?new Cs:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Ts(i.key,o,function s(t){var u=[];return Jr(t.fields||{},function(t,e){var n=new oi([t]);if(So(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ls(u)}(o.proto.mapValue),ds.exists(!0)))}return c.li.Kh(u,l,e,a)})}).then(function(t){var e=t.hi(h);return{batchId:t.batchId,Gh:e}}))];case 2:return s=t.sent(),u.bh.Qs(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Oh[e.currentUser.Ds()])||new Si(Vr)).ot(n,o),e.Oh[e.currentUser.Ds()]=r,[4,zh(u,s.Gh)];case 3:return t.sent(),[4,Th(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=ta(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Mh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jo,h=e,c=(a=o).nt,l=h.zi,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Xi.cr({ur:!0});l=h.zi;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.tr.wr(s,t.se,e).next(function(){return h.tr.Er(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,c).st(s.Tr),l=l.ot(e,n),r=o,i=t,_r(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.g()-r.nt.g()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(h.tr.mr(s,n))))});var t,o=Ci,n=Gi();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof zs&&e.version.isEqual(ni.min())?(i.Ir(t,c),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.ar(e,c),o=o.ot(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.Rr.Ar(s,t))})})),c.isEqual(ni.min())||(t=h.tr.dr(s).next(function(t){return h.tr.Pr(s,s.Tr,c)}),u.push(t)),zu.$n(u).next(function(){return i.apply(s)}).next(function(){return h.nr.Ii(s,o)})}).then(function(t){return h.zi=l,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.$h.get(e))&&(_r(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.yh=!0:0<t.ne.size?_r(e.yh):0<t.se.size&&(_r(e.yh),e.yh=!1))}),[4,zh(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ma(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,h,c,l})})}function jh(t,n,e){var r;((t=t).Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Dh.forEach(function(t,e){(e=e.view.As(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Es.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&oa(t)}(t.gh,n),r.length&&t.Sh.Ro(r),t.onlineState=n,t.Uh&&t.bh.ei(n))}function xh(t,e){(t.Mh.get(e)||[]).forEach(function(t){t.resolve()}),t.Mh.delete(e)}function qh(t,e,n){var r=t,i=r.Oh[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Oh[r.currentUser.Ds()]=i)}function Fh(e,t,n){void 0===n&&(n=null),e.bh.Hs(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Dh.delete(o),n&&e.Sh.Bh(o,n)}e.Fh.delete(t),e.Uh&&e.kh.Or(t).forEach(function(t){e.kh.qr(t)||Gh(e,t)})}function Gh(t,e){var n=t.xh.get(e);null!==n&&(dh(t.ph,n),t.xh=t.xh.remove(e),t.$h.delete(n),Bh(t))}function Wh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Dh?(t.kh.Dr(u.key,e),r=t,i=(i=u).key,r.xh.get(i)||(Sr("SyncEngine","New document in limbo: "+i),r.Nh.push(i),Bh(r))):u instanceof kh?(Sr("SyncEngine","Document no longer in limbo: "+u.key),t.kh.Nr(u.key,e),t.kh.qr(u.key)||Gh(t,u.key)):Rr()}}function Bh(t){for(;0<t.Nh.length&&t.xh.size<t.Ch;){var e=t.Nh.shift(),n=t.Lh.next();t.$h.set(n,new _h(e)),t.xh=t.xh.ot(e,n),ph(t.ph,new Ti(iu(Ys(e.path)),n,2,ca.Ms))}}function zh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Dh.P()?[3,3]:(n.Dh.forEach(function(t,e){o.push(n.Qh(e,s,u).then(function(t){t&&(n.Uh&&n.bh.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ga.Si(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Sh.Ro(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return zu.forEach(h,function(e){return zu.forEach(e.bi,function(t){return r.persistence.Rr.Dr(n,e.targetId,t)}).next(function(){return zu.forEach(e.Ci,function(t){return r.persistence.Rr.Nr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Xu(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.zi.get(o),u=s.nt,u=s.rt(u),r.zi=r.zi.ot(o,u));return[2]}})})}(n.jo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var Hh,Kh,Xh,Qh=(Ic.prototype.ir=function(t){this.tc=t},Ic.prototype.Ri=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ni.min())?this.ec(e,r):this.tc.mi(e,o).next(function(t){var n=s.nc(r,t);return($s(r)||Zs(r))&&s.Eh(r.hn,n,o,i)?s.ec(e,r):(Or()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cu(r)),s.tc.Ri(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Ic.prototype.nc=function(n,t){var r=new Ui(fu(n));return t.forEach(function(t,e){e instanceof Bs&&lu(n,e)&&(r=r.add(e))}),r},Ic.prototype.Eh=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.h(r))},Ic.prototype.ec=function(t,e){return Or()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",cu(e)),this.tc.Ri(t,e,ni.min())},Ic),Jh=(Ec.prototype.rc=function(t){return zu.resolve(0===this.li.length)},Ec.prototype.Kh=function(t,e,n,r){var i=this.sc;this.sc++,0<this.li.length&&this.li[this.li.length-1],n=new da(i,e,n,r),this.li.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.ic=this.ic.add(new Ba(u.key,i)),this._i.ji(t,u.key.path.N())}return zu.resolve(n)},Ec.prototype.zh=function(t,e){return zu.resolve(this.oc(e))},Ec.prototype.Vr=function(t,e){return e+=1,e=(e=this.hc(e))<0?0:e,zu.resolve(this.li.length>e?this.li[e]:null)},Ec.prototype.Hh=function(){return zu.resolve(0===this.li.length?-1:this.sc-1)},Ec.prototype.Yh=function(t){return zu.resolve(this.li.slice())},Ec.prototype.di=function(t,e){var n=this,r=new Ba(e,0),e=new Ba(e,Number.POSITIVE_INFINITY),i=[];return this.ic.Nt([r,e],function(t){t=n.oc(t.Ur),i.push(t)}),zu.resolve(i)},Ec.prototype.Ai=function(t,e){var n=this,r=new Ui(Vr);return e.forEach(function(t){var e=new Ba(t,0),t=new Ba(t,Number.POSITIVE_INFINITY);n.ic.Nt([e,t],function(t){r=r.add(t.Ur)})}),zu.resolve(this.cc(r))},Ec.prototype.gi=function(t,e){var n=e.path,r=n.length+1,e=n;si.X(e)||(e=e.child(""));var e=new Ba(new si(e),0),i=new Ui(Vr);return this.ic.xt(function(t){var e=t.key.path;return!!n.O(e)&&(e.length===r&&(i=i.add(t.Ur)),!0)},e),zu.resolve(this.cc(i))},Ec.prototype.cc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.oc(t))&&n.push(t)}),n},Ec.prototype.lr=function(n,r){var i=this;_r(0===this.uc(r.batchId,"removed")),this.li.shift();var o=this.ic;return zu.forEach(r.mutations,function(t){var e=new Ba(t.key,r.batchId);return o=o.delete(e),i.Rr.ac(n,t.key)}).next(function(){i.ic=o})},Ec.prototype.lc=function(t){},Ec.prototype.qr=function(t,e){var n=new Ba(e,0),n=this.ic.$t(n);return zu.resolve(e.isEqual(n&&n.key))},Ec.prototype._r=function(t){return this.li.length,zu.resolve()},Ec.prototype.uc=function(t,e){return this.hc(t)},Ec.prototype.hc=function(t){return 0===this.li.length?0:t-this.li[0].batchId},Ec.prototype.oc=function(t){return(t=this.hc(t))<0||t>=this.li.length?null:this.li[t]},Ec),Yh=(bc.prototype.ar=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this._c(e);return this.docs=this.docs.ot(r,{fc:e,size:o,readTime:n}),this.size+=o-i,this._i.ji(t,r.path.N())},bc.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},bc.prototype.Ei=function(t,e){return e=this.docs.get(e),zu.resolve(e?e.fc:null)},bc.prototype.getEntries=function(t,e){var n=this,r=Ci;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.fc:null)}),zu.resolve(r)},bc.prototype.Ri=function(t,e,n){for(var r=xi,i=new si(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).fc,a=a.readTime;if(!e.path.O(s.path))break;a.h(n)<=0||u instanceof Bs&&lu(e,u)&&(r=r.ot(u.key,u))}return zu.resolve(r)},bc.prototype.dc=function(t,e){return zu.forEach(this.docs,function(t){return e(t)})},bc.prototype.cr=function(t){return new $h(this)},bc.prototype.wc=function(t){return zu.resolve(this.size)},bc),$h=(Object.defineProperty(wc.prototype,"readTime",{get:function(){return this.Tc},set:function(t){this.Tc=t},enumerable:!1,configurable:!0}),wc.prototype.ar=function(t,e){this.mc(),this.readTime=e,this.Gh.set(t.key,t)},wc.prototype.Ir=function(t,e){this.mc(),e&&(this.readTime=e),this.Gh.set(t,null)},wc.prototype.Ei=function(t,e){this.mc();var n=this.Gh.get(e);return void 0!==n?zu.resolve(n):this.Ic(t,e)},wc.prototype.getEntries=function(t,e){return this.Ac(t,e)},wc.prototype.apply=function(t){return this.mc(),this.Ec=!0,this.Th(t)},wc.prototype.mc=function(){},n(mc,Xh=wc),mc.prototype.Th=function(n){var r=this,i=[];return this.Gh.forEach(function(t,e){e?i.push(r.Rc.ar(n,e,r.readTime)):r.Rc.Ir(t)}),zu.$n(i)},mc.prototype.Ic=function(t,e){return this.Rc.Ei(t,e)},mc.prototype.Ac=function(t,e){return this.Rc.getEntries(t,e)},mc),Zh=(gc.prototype.De=function(t,n){return this.Pc.forEach(function(t,e){return n(e)}),zu.resolve()},gc.prototype.dr=function(t){return zu.resolve(this.lastRemoteSnapshotVersion)},gc.prototype.vc=function(t){return zu.resolve(this.Vc)},gc.prototype.jh=function(t){return this.highestTargetId=this.gc.next(),zu.resolve(this.highestTargetId)},gc.prototype.Pr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Vc&&(this.Vc=e),zu.resolve()},gc.prototype.bc=function(t){this.Pc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.gc=new La(e),this.highestTargetId=e),t.sequenceNumber>this.Vc&&(this.Vc=t.sequenceNumber)},gc.prototype.Wh=function(t,e){return this.bc(e),this.targetCount+=1,zu.resolve()},gc.prototype.mr=function(t,e){return this.bc(e),zu.resolve()},gc.prototype.Cc=function(t,e){return this.Pc.delete(e.target),this.yc.Or(e.targetId),--this.targetCount,zu.resolve()},gc.prototype.Sc=function(n,r,i){var o=this,s=0,u=[];return this.Pc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Pc.delete(t),u.push(o.Dc(n,e.targetId)),s++)}),zu.$n(u).next(function(){return s})},gc.prototype.Fc=function(t){return zu.resolve(this.targetCount)},gc.prototype.yr=function(t,e){return e=this.Pc.get(e)||null,zu.resolve(e)},gc.prototype.Er=function(t,e,n){return this.yc.Fr(e,n),zu.resolve()},gc.prototype.wr=function(e,t,n){this.yc.kr(t,n);var r=this.persistence.Rr,i=[];return r&&t.forEach(function(t){i.push(r.ac(e,t))}),zu.$n(i)},gc.prototype.Dc=function(t,e){return this.yc.Or(e),zu.resolve()},gc.prototype.pr=function(t,e){return e=this.yc.Lr(e),zu.resolve(e)},gc.prototype.qr=function(t,e){return zu.resolve(this.yc.qr(e))},gc),tc=(vc.prototype.start=function(){return Promise.resolve()},vc.prototype.ni=function(){return this.$c=!1,Promise.resolve()},Object.defineProperty(vc.prototype,"Oc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),vc.prototype.Mc=function(){},vc.prototype.Lc=function(){},vc.prototype.sr=function(){return this._i},vc.prototype.Ji=function(t){var e=this.Nc[t.Ds()];return e||(e=new Jh(this._i,this.Rr),this.Nc[t.Ds()]=e),e},vc.prototype.er=function(){return this.tr},vc.prototype.Zi=function(){return this.ai},vc.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new ec(this.xc.next());return this.Rr.qc(),n(i).next(function(t){return r.Rr.Uc(i).next(function(){return t})}).Nn().then(function(t){return i.Bc(),t})},vc.prototype.jc=function(e,n){return zu.kn(Object.values(this.Nc).map(function(t){return function(){return t.qr(e,n)}}))},vc),ec=(yc.prototype.Qc=function(t){this.Wc.push(t)},yc.prototype.Bc=function(){this.Wc.forEach(function(t){return t()})},n(dc,Kh=yc),dc),nc=(pc.zc=function(t){return new pc(t)},Object.defineProperty(pc.prototype,"Hc",{get:function(){if(this.Gc)return this.Gc;throw Rr()},enumerable:!1,configurable:!0}),pc.prototype.Dr=function(t,e,n){return this.Kc.Dr(n,e),this.Hc.delete(n.toString()),zu.resolve()},pc.prototype.Nr=function(t,e,n){return this.Kc.Nr(n,e),this.Hc.add(n.toString()),zu.resolve()},pc.prototype.ac=function(t,e){return this.Hc.add(e.toString()),zu.resolve()},pc.prototype.removeTarget=function(t,e){var n=this;this.Kc.Or(e.targetId).forEach(function(t){return n.Hc.add(t.toString())});var r=this.persistence.er();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Hc.add(t.toString())})}).next(function(){return r.Cc(t,e)})},pc.prototype.qc=function(){this.Gc=new Set},pc.prototype.Uc=function(n){var r=this,i=this.persistence.Zi().cr();return zu.forEach(this.Hc,function(t){var e=si.H(t);return r.Yc(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Gc=null,i.apply(n)})},pc.prototype.Ar=function(t,e){var n=this;return this.Yc(t,e).next(function(t){t?n.Hc.delete(e.toString()):n.Hc.add(e.toString())})},pc.prototype.kc=function(t){return 0},pc.prototype.Yc=function(t,e){var n=this;return zu.kn([function(){return zu.resolve(n.Kc.qr(e))},function(){return n.persistence.er().qr(t,e)},function(){return n.persistence.jc(t,e)}])},pc),rc=(fc.prototype.Io=function(t){this.Zc=t},fc.prototype.do=function(t){this.tu=t},fc.prototype.onMessage=function(t){this.eu=t},fc.prototype.close=function(){this.Xc()},fc.prototype.send=function(t){this.Jc(t)},fc.prototype.nu=function(){this.Zc()},fc.prototype.su=function(t){this.tu(t)},fc.prototype.iu=function(t){this.eu(t)},fc),ic={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},oc=(lc.prototype.No=function(e,t,n,r){var i=this.cu(e,t);return Sr("RestConnection","Sending: ",i,n),t={},this.uu(t,r),this.au(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},lc.prototype.xo=function(t,e,n,r){return this.No(t,e,n,r)},lc.prototype.uu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0-2020922203858",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},lc.prototype.cu=function(t,e){return t=ic[t],this.ou+"/v1/"+e+":"+t},n(cc,Hh=lc),cc.prototype.au=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new Ir(e,t.message))):r(new Ir(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},cc.prototype.Ao=function(t,e){var n,r=[this.ou,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.uu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Sr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new rc({Jc:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Xc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.su())}),t(vr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.su(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(_r(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ii[r];if(void 0!==t)return Oi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.su(new Ir(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.iu(e)))}),setTimeout(function(){a.nu()},0),a},cc),sc=(hc.prototype.Jo=function(t){this.wu.push(t)},hc.prototype.ni=function(){window.removeEventListener("online",this.lu),window.removeEventListener("offline",this.fu)},hc.prototype.Eu=function(){window.addEventListener("online",this.lu),window.addEventListener("offline",this.fu)},hc.prototype._u=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.wu;t<e.length;t++)(0,e[t])(0)},hc.prototype.du=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.wu;t<e.length;t++)(0,e[t])(1)},hc.Tu=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},hc),uc=(ac.prototype.Jo=function(t){},ac.prototype.ni=function(){},ac);function ac(){}function hc(){var t=this;this.lu=function(){return t._u()},this.fu=function(){return t.du()},this.wu=[],this.Eu()}function cc(t){var e=this;return(e=Hh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function lc(t){this.ru=t,this._=t._;var e=t.ssl?"https":"http";this.ou=e+"://"+t.host,this.hu="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function fc(t){this.Jc=t.Jc,this.Xc=t.Xc}function pc(t){this.persistence=t,this.Kc=new Wa,this.Gc=null}function dc(t){var e=this;return(e=Kh.call(this)||this).Tr=t,e}function yc(){this.Wc=[]}function vc(t){var e=this;this.Nc={},this.xc=new ca(0),this.$c=!1,this.$c=!0,this.Rr=t(this),this.tr=new Zh(this),this._i=new Oa,this.ai=(t=this._i,new Yh(t,function(t){return e.Rr.kc(t)}))}function gc(t){this.persistence=t,this.Pc=new ti(mi,wi),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this.Vc=0,this.yc=new Wa,this.targetCount=0,this.gc=La.Qi()}function mc(t){var e=this;return(e=Xh.call(this)||this).Rc=t,e}function wc(){this.Gh=new ti(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Ec=!1}function bc(t,e){this._i=t,this._c=e,this.docs=new Si(si.S),this.size=0}function Ec(t,e){this._i=t,this.Rr=e,this.li=[],this.sc=1,this.ic=new Ui(Ba.br)}function Ic(){}function Tc(t){return new ko(t,!0)}var Ac=(Dc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.bh=this.mu(e),this.persistence=this.Iu(e),[4,this.persistence.start()];case 1:return t.sent(),this.Au=this.Ru(e),this.jo=this.Pu(e),[2]}})})},Dc.prototype.Ru=function(t){return null},Dc.prototype.Pu=function(t){return e=this.persistence,n=new Qh,t=t.Vu,new Da(e,n,t);var e,n},Dc.prototype.Iu=function(t){return new tc(nc.zc)},Dc.prototype.mu=function(t){return new pa},Dc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Au&&this.Au.stop(),[4,this.bh.ni()];case 1:return t.sent(),[4,this.persistence.ni()];case 2:return t.sent(),[2]}})})},Dc),Nc=(Lc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jo?[3,2]:(this.jo=n.jo,this.bh=n.bh,this.Wo=this.yu(r),this.ph=this.pu(r),this.gh=this.gu(r),this.vu=this.bu(r,!n.synchronizeTabs),this.bh.Ws=function(t){return jh(e.vu,t,1)},this.ph.Qo.Cu=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.Ds()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).li,m=e.nr,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.li.Yh(v).next(function(t){return g=t,n=e.persistence.Ji(o),m=new va(e.Xi,n,e.persistence.sr()),n.Yh(v)}).next(function(t){for(var e=[],n=[],r=Gi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.mi(v,r).next(function(t){return{Jh:t,Xh:e,Zh:n}})})})];case 1:return r=t.sent(),[2,(e.li=n,e.nr=m,e.Gi.ir(e.nr),r)]}})})}(n.jo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Mh.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Mh.clear(),n.bh.ti(o,r.Xh,r.Zh),[4,zh(n,r.Jh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.vu),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,ch(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,lh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.ph,this.vu.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Lc.prototype.gu=function(t){return new na},Lc.prototype.yu=function(t){var e=Tc(t.ru._),n=(n=t.ru,new oc(n));return t=t.credentials,new Ya(t,n,e)},Lc.prototype.pu=function(t){var e=this;return new xa(this.jo,this.Wo,t.On,function(t){return jh(e.vu,t,0)},t=new(sc.Tu()?sc:uc))},Lc.prototype.bu=function(t,e){return n=this.jo,r=this.ph,i=this.gh,o=this.bh,s=t.Vu,u=t.Ch,a=e,u=new Ph(n,r,i,o,s,u),a&&(u.qh=!0),u;var n,r,i,o,s,u,a},Lc.prototype.terminate=function(){return fh(this.ph)},Lc),Oc=(Sc.prototype.next=function(t){this.observer.next&&this.Su(this.observer.next,t)},Sc.prototype.error=function(t){this.observer.error?this.Su(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Sc.prototype.Du=function(){this.muted=!0},Sc.prototype.Su=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Sc);function Sc(t){this.observer=t,this.muted=!1}function Lc(){}function Dc(){this.synchronizeTabs=!1}function kc(t,e,n){if(!n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Rc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function _c(t,e,n,r){if(!0===e&&!0===r)throw new Ir(Er.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Pc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Uc(t,e){if(e<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Vc,Cc,Mc=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fu=new oi(t)},jc=(n(Wc,Cc=Mc),Wc.documentId=function(){return new Wc(oi.K().q())},Wc.prototype.isEqual=function(t){return t instanceof Wc&&this.Fu.isEqual(t.Fu)},Wc),xc=new RegExp("[~\\*/\\[\\]]"),qc=function(t){this.Nu=t},Fc=(n(Gc,Vc=qc),Gc.prototype.xu=function(t){if(2!==t.$u)throw 1===t.$u?t.ku(this.Nu+"() can only appear at the top level of your update data"):t.ku(this.Nu+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},Gc.prototype.isEqual=function(t){return t instanceof Gc},Gc);function Gc(){return null!==Vc&&Vc.apply(this,arguments)||this}function Wc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cc.call(this,t)||this}function Bc(t,e,n){return new pl({$u:3,Ou:e.settings.Ou,methodName:t.Nu,Mu:n},e._,e.serializer,e.ignoreUndefinedProperties)}var zc,Hc,Kc,Xc,Qc=(n(ll,Xc=qc),ll.prototype.xu=function(t){return new cs(t.path,new Jo)},ll.prototype.isEqual=function(t){return t instanceof ll},ll),Jc=(n(cl,Kc=qc),cl.prototype.xu=function(t){var e=Bc(this,t,!0),n=this.Lu.map(function(t){return El(t,e)}),n=new Yo(n);return new cs(t.path,n)},cl.prototype.isEqual=function(t){return this===t},cl),Yc=(n(hl,Hc=qc),hl.prototype.xu=function(t){var e=Bc(this,t,!0),n=this.Lu.map(function(t){return El(t,e)}),n=new ns(n);return new cs(t.path,n)},hl.prototype.isEqual=function(t){return this===t},hl),$c=(n(al,zc=qc),al.prototype.xu=function(t){var e=new ss(t.serializer,Po(t.serializer,this.qu));return new cs(t.path,e)},al.prototype.isEqual=function(t){return this===t},al),Zc=(Object.defineProperty(ul.prototype,"latitude",{get:function(){return this.Uu},enumerable:!1,configurable:!0}),Object.defineProperty(ul.prototype,"longitude",{get:function(){return this.Bu},enumerable:!1,configurable:!0}),ul.prototype.isEqual=function(t){return this.Uu===t.Uu&&this.Bu===t.Bu},ul.prototype.toJSON=function(){return{latitude:this.Uu,longitude:this.Bu}},ul.prototype.V=function(t){return Vr(this.Uu,t.Uu)||Vr(this.Bu,t.Bu)},ul),tl=function(t){this.ju=t},el=/^__.*__$/,nl=function(t,e,n){this.Wu=t,this.Qu=e,this.Ku=n},rl=(sl.prototype.Gu=function(t,e){var n=[];return null!==this.We?n.push(new Ts(t,this.data,this.We,e)):n.push(new Is(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ls(t,this.fieldTransforms)),n},sl),il=(ol.prototype.Gu=function(t,e){return e=[new Ts(t,this.data,this.We,e)],0<this.fieldTransforms.length&&e.push(new Ls(t,this.fieldTransforms)),e},ol);function ol(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function sl(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function ul(t,e){if(!isFinite(t)||t<-90||90<t)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Uu=t,this.Bu=e}function al(t,e){var n=this;return(n=zc.call(this,t)||this).qu=e,n}function hl(t,e){var n=this;return(n=Hc.call(this,t)||this).Lu=e,n}function cl(t,e){var n=this;return(n=Kc.call(this,t)||this).Lu=e,n}function ll(){return null!==Xc&&Xc.apply(this,arguments)||this}function fl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var pl=(Object.defineProperty(vl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"$u",{get:function(){return this.settings.$u},enumerable:!1,configurable:!0}),vl.prototype.Hu=function(t){return new vl(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},vl.prototype.Yu=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Hu({path:e,Mu:!1})).Ju(t),e},vl.prototype.Xu=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Hu({path:t,Mu:!1})).zu(),t},vl.prototype.Zu=function(t){return this.Hu({path:void 0,Mu:!0})},vl.prototype.ku=function(t){return Sl(t,this.settings.methodName,this.settings.ta||!1,this.path,this.settings.Ou)},vl.prototype.contains=function(e){return void 0!==this.We.find(function(t){return e.O(t)})||void 0!==this.fieldTransforms.find(function(t){return e.O(t.field)})},vl.prototype.zu=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ju(this.path.get(t))},vl.prototype.Ju=function(t){if(0===t.length)throw this.ku("Document fields must not be empty");if(fl(this.$u)&&el.test(t))throw this.ku('Document fields cannot begin and end with "__"')},vl),dl=(yl.prototype.ea=function(t,e,n,r){return void 0===r&&(r=!1),new pl({$u:t,methodName:e,Ou:n,path:oi.B(),Mu:!1,ta:r},this._,this.serializer,this.ignoreUndefinedProperties)},yl);function yl(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Tc(t)}function vl(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.zu(),this.fieldTransforms=i||[],this.We=o||[]}function gl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ea(o.merge||o.mergeFields?2:0,e,n,i);Al("Data must be an object, but it was:",s,r);var u,a,r=Il(r,s);if(o.merge)u=new ls(s.We),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof Mc)p=f.Fu;else{if("string"!=typeof f)throw Rr();p=Ol(e,f,n)}if(!s.contains(p))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Ll(h,p)||h.push(p)}u=new ls(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new rl(new Vs(r),u,a)}function ml(t,r,i,e){var o=t.ea(1,r,i);Al("Data must be an object, but it was:",o,e);var s=[],u=new Cs;return Jr(e,function(t,e){var n=Ol(r,t,i),t=o.Xu(n);e instanceof Fc||e instanceof tl&&e.ju instanceof Fc?s.push(n):null!=(t=El(e,t))&&(s.push(n),u.set(n,t))}),e=new ls(s),new il(u.Xe(),e,o.fieldTransforms)}function wl(t,e,n,r,i,o){var s=t.ea(1,e,n),u=[Nl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Nl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Cs,y=u.length-1;0<=y;--y)Ll(p,u[y])||(c=u[y],l=a[y],f=s.Xu(c),l instanceof Fc||l instanceof tl&&l.ju instanceof Fc?p.push(c):null!=(f=El(l,f))&&(p.push(c),d.set(c,f)));return i=new ls(p),new il(d.Xe(),i,s.fieldTransforms)}function bl(t,e,n,r){return void 0===r&&(r=!1),El(n,t.ea(r?4:3,e))}function El(s,t){if(s instanceof tl&&(s=s.ju),Tl(s))return Al("Unsupported field value:",t,s),Il(s,t);if(s instanceof qc)return function(t,e){if(!fl(e.$u))throw e.ku(t.Nu+"() can only be used with update() and set()");if(!e.path)throw e.ku(t.Nu+"() is not currently supported inside arrays");(t=t.xu(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.We.push(t.path),s instanceof Array){if(t.settings.Mu&&4!==t.$u)throw t.ku("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=El(i[r],t.Zu(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof ei){var r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof Zc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xr)return{bytesValue:Vo(e.serializer,t.l)};if(t instanceof nl){if(n=e._,!(r=t.Wu).isEqual(n))throw e.ku("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Mo(t.Wu||e._,t.Qu.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ku("Unsupported field value: "+Pc(t))}(s,t)}function Il(t,n){var r={};return Yr(t)?n.path&&0<n.path.length&&n.We.push(n.path):Jr(t,function(t,e){null!=(e=El(e,n.Yu(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Tl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Zc||t instanceof xr||t instanceof nl||t instanceof qc)}function Al(t,e,n){if(!Tl(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Pc(n))?e.ku(t+" a custom object"):e.ku(t+" "+n);var r}function Nl(t,e,n){if(e instanceof Mc)return e.Fu;if("string"==typeof e)return Ol(t,e);throw Sl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ol(t,e,n){try{return function(e){if(0<=e.search(xc))throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(jc.bind.apply(jc,i([void 0],e.split("."))))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Fu}catch(e){throw Sl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Sl(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ir(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function Ll(t,e){return t.some(function(t){return t.isEqual(e)})}var Dl=(Ul.prototype.oa=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.ha(),0<this.mutations.length)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=Fo((i=s).serializer)+"/documents",n={documents:u.map(function(t){return jo(i.serializer,t)})},[4,i.xo("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=xo(t,e.found.name),t=Co(e.found.updateTime),e=new Vs({mapValue:{fields:e.found.fields}});return new Bs(n,t,e,{})}(e,t):"missing"in t?(n=e,_r(!!(r=t).missing),_r(!!r.readTime),n=xo(n,r.missing),r=Co(r.readTime),new zs(n,r)):Rr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){_r(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Wo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof zs||t instanceof Bs?n.ca(t):Rr()}),e)]}})})},Ul.prototype.set=function(t,e){this.write(e.Gu(t,this.Ge(t))),this.ra.add(t.toString())},Ul.prototype.update=function(t,e){try{this.write(e.Gu(t,this.ua(t)))}catch(t){this.ia=t}this.ra.add(t.toString())},Ul.prototype.delete=function(t){this.write([new Ps(t,this.Ge(t))]),this.ra.add(t.toString())},Ul.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.ha(),this.ia)throw this.ia;return e=this.na,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=si.H(e),n.mutations.push(new Us(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Fo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Wo(e.serializer,t)})},[4,e.No("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wo,this.mutations)];case 1:return t.sent(),this.sa=!0,[2]}})})},Ul.prototype.ca=function(t){var e;if(t instanceof Bs)e=t.version;else{if(!(t instanceof zs))throw Rr();e=ni.min()}var n=this.na.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.na.set(t.key.toString(),e)},Ul.prototype.Ge=function(t){var e=this.na.get(t.toString());return!this.ra.has(t.toString())&&e?ds.updateTime(e):ds.Ye()},Ul.prototype.ua=function(t){var e=this.na.get(t.toString());if(this.ra.has(t.toString())||!e)return ds.exists(!0);if(e.isEqual(ni.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ds.updateTime(e)},Ul.prototype.write=function(t){this.ha(),this.mutations=this.mutations.concat(t)},Ul.prototype.ha=function(){},Ul),kl=(Pl.prototype.run=function(){this.la()},Pl.prototype.la=function(){var t=this;this.Xn.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Dl(this.Wo),(n=this._a(e))&&n.then(function(t){r.On.Wn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.fa(t)})})}).catch(function(t){r.fa(t)}),[2]})})})},Pl.prototype._a=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},Pl.prototype.fa=function(t){var e=this;0<this.aa&&this.da(t)?(--this.aa,this.On.Wn(function(){return e.la(),Promise.resolve()})):this.qn.reject(t)},Pl.prototype.da=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ni(t))},Pl),Rl=(_l.prototype.start=function(t,e,n){var r=this;this.Ea(),this.ru=t;var i=new Wu,o=!1;return this.credentials.Qr(function(t){return o?void r.On.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.us(),Sr("RemoteStore","RemoteStore received new credentials"),n=wh(e),e.zo.add(3),[4,lh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Qo.Cu(i)];case 2:return t.sent(),e.zo.delete(3),[4,ch(e)];case 3:return t.sent(),[2]}})})}(r.ph,t)}):(o=!0,Sr("FirestoreClient","Initializing. user=",t.uid),r.Ta(e,n,t,i).then(r.wa.resolve,r.wa.reject))}),this.On.Wn(function(){return r.wa.promise}),i.promise},_l.prototype.enableNetwork=function(){var e=this;return this.Ea(),this.On.enqueue(function(){return e.persistence.Lc(!0),(t=e.ph).zo.delete(0),ch(t);var t})},_l.prototype.Ta=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,ru:this.ru,clientId:this.clientId,credentials:this.credentials,Vu:o,Ch:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.bh=r.bh,this.jo=r.jo,this.Au=r.Au,this.Wo=i.Wo,this.ph=i.ph,this.vu=i.vu,this.ma=i.gh,this.ma.Is=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).ph.Qo.eh=Mh.bind(null,e),e.ph.Qo.Ue=function(t,e){var n=t;if((t=n.$h.get(e))&&t.yh)return Gi().add(t.key);var r=Gi();if(!(e=n.Fh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Dh.get(s),r=r.kt(s.view._h);return r}.bind(null,e),e.ph.Qo.th=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).bh.zs(s,"rejected",u),i=e.$h.get(s),(n=i&&i.key)?(r=(r=new Si(si.S)).ot(n,new zs(n,ni.min())),i=Gi().add(n),i=new Ki(ni.min(),new Map,new Ui(Vr),r,i),[4,Mh(e,i)]):[3,2];case 1:return t.sent(),e.xh=e.xh.remove(n),e.$h.delete(s),Bh(e),[3,4];case 2:return[4,Va(e.jo,s,!1).then(function(){return Fh(e,s,u)}).catch(Ma)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Sh.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Es.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&oa(n)}.bind(null,e.gh),e.Sh.Bh=function(t,e,n){var r=t;if(t=r.Es.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Es.delete(e)}.bind(null,e.gh),(a=(n=e).Dh.get(c))?(o=a.targetId,n.bh.Gs(o),s=a.view.Vh(),[3,4]):[3,1];case 1:return[4,(e=n.jo,r=iu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.tr.yr(e,r).next(function(t){return t?(n=t,zu.resolve(n)):i.tr.jh(e).next(function(t){return n=new Ti(r,t,0,e.Tr),i.tr.Wh(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.zi=i.zi.ot(t.targetId,t),i.Hi.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.bh.Gs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fh(o)).Eh?[4,Ca(r.jo,i.query,!1).then(function(t){return t=t.documents,i.view.fh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Th(e,r.Uh,n),[2,(Wh(r,i.targetId,n.Ah),n.snapshot)]}})})}(i,t,e,n)},[4,Ca(i.jo,o,!0)];case 1:return n=t.sent(),r=new Rh(o,n.gr),e=r.fh(n.documents),n=Xi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Th(e,i.Uh,n),Wh(i,s,n.Ah),r=new Lh(o,s,r),i.Dh.set(o,r),i.Fh.has(s)?i.Fh.get(s).push(o):i.Fh.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Uh&&ph(n.ph,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,this.vu),this.ma.Ps=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Dh.get(o),1<(r=e.Fh.get(n.targetId)).length?[2,(e.Fh.set(n.targetId,r.filter(function(t){return!au(t,o)})),void e.Dh.delete(o))]:e.Uh?(e.bh.Hs(n.targetId),e.bh.Zs(n.targetId)?[3,2]:[4,Va(e.jo,n.targetId,!1).then(function(){e.bh.Js(n.targetId),dh(e.ph,n.targetId),Fh(e,n.targetId)}).catch(Ma)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Fh(e,n.targetId),[4,Va(e.jo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.vu),this.persistence.Mc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Er.FAILED_PRECONDITION||e.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Ta(new Ac,new Nc,o,s))];case 4:return[2]}})})},_l.prototype.Ea=function(){if(this.On.ts)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},_l.prototype.disableNetwork=function(){var t=this;return this.Ea(),this.On.enqueue(function(){return t.persistence.Lc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,lh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.ph)})},_l.prototype.terminate=function(){var t=this;this.On.rs();var n=new Wu;return this.On.es(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Au&&this.Au.stop(),[4,fh(this.ph)];case 1:return t.sent(),[4,this.bh.ni()];case 2:return t.sent(),[4,this.persistence.ni()];case 3:return t.sent(),this.credentials.Kr(),n.resolve(),[3,5];case 4:return e=ta(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},_l.prototype.waitForPendingWrites=function(){var t=this;this.Ea();var e=new Wu;return this.On.Wn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:wh((n=o).ph)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.li.Hh(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Mh.get(r)||[]).push(s),n.Mh.set(r,i),[3,4]);case 3:return i=ta(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.vu,e)}),e.promise},_l.prototype.listen=function(t,e,n){var r=this;this.Ea();var i=new Oc(n),o=new sa(t,i,e);return this.On.Wn(function(){return ra(r.ma,o)}),function(){i.Du(),r.On.Wn(function(){return ia(r.ma,o)})}},_l.prototype.Ia=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Wu,[2,(this.On.Wn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.nr.fi(t,e)}))];case 1:return(r=t.sent())instanceof Bs?s.resolve(r):r instanceof zs?s.resolve(null):s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=ta(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.jo,r,e)}),e.promise)]}})})},_l.prototype.Aa=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Wu,[2,(this.On.Wn(function(){return n=a.ma,r=a.On,i=h,o=c,s=e,t=new Oc({next:function(t){r.Wn(function(){return ia(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new sa(Ys(i.path),t,{includeMetadataChanges:!0,Cs:!0}),ra(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},_l.prototype.Ra=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),e=new Wu,[2,(this.On.Wn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ca(r,i,!0)];case 1:return n=t.sent(),e=new Rh(i,n.gr),n=e.fh(n.documents),n=e.Th(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=ta(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.jo,r,e)}),e.promise)]}})})},_l.prototype.Pa=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Ea(),[4,this.wa.promise];case 1:return t.sent(),u=new Wu,[2,(this.On.Wn(function(){return e=a.ma,n=a.On,t=h,r=c,i=u,o=new Oc({next:function(t){n.Wn(function(){return ia(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new sa(t,o,{includeMetadataChanges:!0,Cs:!0}),ra(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},_l.prototype.write=function(t){var e=this;this.Ea();var n=new Wu;return this.On.Wn(function(){return Ch(e.vu,t,n)}),n.promise},_l.prototype._=function(){return this.ru._},_l.prototype.Va=function(t){var e=this;this.Ea();var r=new Oc(t);return this.On.Wn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.ma,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Du(),e.On.Wn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.ma.Ts.delete(r)]})})})}},Object.defineProperty(_l.prototype,"ya",{get:function(){return this.On.ts},enumerable:!1,configurable:!0}),_l.prototype.transaction=function(t){var e=this;this.Ea();var n=new Wu;return this.On.Wn(function(){return new kl(e.On,e.Wo,t,n).run(),Promise.resolve()}),n.promise},_l);function _l(t,e){this.credentials=t,this.On=e,this.clientId=Pr.t(),this.wa=new Wu}function Pl(t,e,n,r){this.On=t,this.Wo=e,this.updateFunction=n,this.qn=r,this.aa=5,this.Xn=new Bu(this.On,"transaction_retry")}function Ul(t){this.Wo=t,this.na=new Map,this.mutations=[],this.sa=!1,this.ia=null,this.ra=new Set}function Vl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Cl,Ml,jl=(sf.prototype.ba=function(t){switch(fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.Ca(t.timestampValue);case 4:return this.Sa(t);case 5:return t.stringValue;case 6:return this.va(Eo(t.bytesValue));case 7:return this.Da(t.referenceValue);case 8:return this.Fa(t.geoPointValue);case 9:return this.Na(t.arrayValue);case 10:return this.xa(t.mapValue);default:throw Rr()}},sf.prototype.xa=function(t){var n=this,r={};return Jr(t.fields||{},function(t,e){r[t]=n.ba(e)}),r},sf.prototype.Fa=function(t){return new Zc(bo(t.latitude),bo(t.longitude))},sf.prototype.Na=function(t){var e=this;return(t.values||[]).map(function(t){return e.ba(t)})},sf.prototype.Sa=function(t){switch(this.pa){case"previous":var e=function t(e){return ho(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.ba(e);case"estimate":return this.Ca(co(t));default:return null}},sf.prototype.Ca=function(t){return t=wo(t),new ei(t.seconds,t.nanos)},sf.prototype.Da=function(t){var e=ri.U(t);return _r(Ho(e)),t=new Hr(e.get(1),e.get(3)),e=new si(e.F(5)),t.isEqual(this._)||Lr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.ga(e)},sf),xl=ma.Oi,ql=(of.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},of),Fl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Gl=(rf.prototype.enableIndexedDbPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,Fl)},rf.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Ir(Er.FAILED_PRECONDITION,Fl)},rf.prototype.clearIndexedDbPersistence=function(t){throw new Ir(Er.FAILED_PRECONDITION,Fl)},rf),Wl=(Object.defineProperty(nf.prototype,"Wa",{get:function(){return this.Qa||(this.Qa=new dl(this.Wu,this.ja.ignoreUndefinedProperties)),this.Qa},enumerable:!1,configurable:!0}),nf.prototype.settings=function(t){if(t.merge&&delete(t=Object.assign(Object.assign({},this.ja),t)).merge,t=new ql(t),this.La&&!this.ja.isEqual(t))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.ja=t).credentials&&(this.Ba=function(t){if(!t)return new za;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xa(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},nf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.ja.host&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},nf.prototype.enableNetwork=function(){return this.Ma(),this.La.enableNetwork()},nf.prototype.disableNetwork=function(){return this.Ma(),this.La.disableNetwork()},nf.prototype.enablePersistence=function(t){if(this.La)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&_c("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.$a.enableMultiTabIndexedDbPersistence(this):this.$a.enableIndexedDbPersistence(this,n)},nf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.La&&!this.La.ya)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.$a.clearIndexedDbPersistence(this)]})})},nf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(nf.prototype,"Ka",{get:function(){return this.Ma(),this.La.ya},enumerable:!1,configurable:!0}),nf.prototype.waitForPendingWrites=function(){return this.Ma(),this.La.waitForPendingWrites()},nf.prototype.onSnapshotsInSync=function(t){return this.Ma(),Vl(t)||(t={next:t}),this.La.Va(t)},nf.prototype.Ma=function(){return this.La||this.Ga(new Ac,new Nc),this.La},nf.prototype.za=function(){return new Wr(this.Wu,this.Ua,this.ja.host,this.ja.ssl,this.ja.experimentalForceLongPolling,this.ja.experimentalAutoDetectLongPolling)},nf.prototype.Ga=function(t,e){var n=this.za();return this.La=new Rl(this.Ba,this.Oa),this.La.start(n,t,e)},nf.qa=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Hr(t)},Object.defineProperty(nf.prototype,"app",{get:function(){if(!this.ka)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ka},enumerable:!1,configurable:!0}),nf.prototype.collection=function(t){return kc("Firestore.collection","path",t),this.Ma(),new df(ri.U(t),this,null)},nf.prototype.doc=function(t){return kc("Firestore.doc","path",t),this.Ma(),Hl.Ha(ri.U(t),this,null)},nf.prototype.collectionGroup=function(t){if(kc("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ma(),new ff((t=t,new Ks(ri.B(),t)),this,null)},nf.prototype.runTransaction=function(e){var n=this;return this.Ma().transaction(function(t){return e(new Bl(n,t))})},nf.prototype.batch=function(){return this.Ma(),new zl(this)},nf.prototype.Ya=function(){return this.ja},nf),Bl=(ef.prototype.get=function(t){var e=this,n=mf(0,t,this.Ja);return this.Xa.oa([n.Qu]).then(function(t){if(!t||1!==t.length)return Rr();if((t=t[0])instanceof zs)return new Xl(e.Ja,n.Qu,null,!1,!1,n.Ku);if(t instanceof Bs)return new Xl(e.Ja,n.Qu,t,!1,!1,n.Ku);throw Rr()})},ef.prototype.set=function(t,e,n){return t=mf(0,t,this.Ja),n=Rc("Transaction.set",n),e=wf(t.Ku,e,n),n=gl(this.Ja.Wa,"Transaction.set",t.Qu,e,null!==t.Ku,n),this.Xa.set(t.Qu,n),this},ef.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof jc?(r=mf(0,t,this.Ja),wl(this.Ja.Wa,"Transaction.update",r.Qu,e,n,i)):(r=mf(0,t,this.Ja),ml(this.Ja.Wa,"Transaction.update",r.Qu,e)),this.Xa.update(r.Qu,e),this},ef.prototype.delete=function(t){return t=mf(0,t,this.Ja),this.Xa.delete(t.Qu),this},ef),zl=(tf.prototype.set=function(t,e,n){return this.el(),t=mf(0,t,this.Ja),n=Rc("WriteBatch.set",n),e=wf(t.Ku,e,n),n=gl(this.Ja.Wa,"WriteBatch.set",t.Qu,e,null!==t.Ku,n),this.Za=this.Za.concat(n.Gu(t.Qu,ds.Ye())),this},tf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.el(),e="string"==typeof e||e instanceof jc?(r=mf(0,t,this.Ja),wl(this.Ja.Wa,"WriteBatch.update",r.Qu,e,n,i)):(r=mf(0,t,this.Ja),ml(this.Ja.Wa,"WriteBatch.update",r.Qu,e)),this.Za=this.Za.concat(e.Gu(r.Qu,ds.exists(!0))),this},tf.prototype.delete=function(t){return this.el(),t=mf(0,t,this.Ja),this.Za=this.Za.concat(new Ps(t.Qu,ds.Ye())),this},tf.prototype.commit=function(){return this.el(),this.tl=!0,0<this.Za.length?this.Ja.Ma().write(this.Za):Promise.resolve()},tf.prototype.el=function(){if(this.tl)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},tf),Hl=(n(Zl,Ml=nl),Zl.Ha=function(t,e,n){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.q()+" has "+t.length);return new Zl(new si(t),e,n)},Object.defineProperty(Zl.prototype,"id",{get:function(){return this.Qu.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"parent",{get:function(){return new df(this.Qu.path.N(),this.firestore,this.Ku)},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"path",{get:function(){return this.Qu.path.q()},enumerable:!1,configurable:!0}),Zl.prototype.collection=function(t){if(kc("DocumentReference.collection","path",t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=ri.U(t),new df(this.Qu.path.child(t),this.firestore,null)},Zl.prototype.isEqual=function(t){return t instanceof Zl&&this.firestore===t.firestore&&this.Qu.isEqual(t.Qu)&&this.Ku===t.Ku},Zl.prototype.set=function(t,e){return e=Rc("DocumentReference.set",e),t=wf(this.Ku,t,e),e=gl(this.firestore.Wa,"DocumentReference.set",this.Qu,t,null!==this.Ku,e),this.La.write(e.Gu(this.Qu,ds.Ye()))},Zl.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof jc?wl(this.firestore.Wa,"DocumentReference.update",this.Qu,t,e,n):ml(this.firestore.Wa,"DocumentReference.update",this.Qu,t),this.La.write(t.Gu(this.Qu,ds.exists(!0)))},Zl.prototype.delete=function(){return this.La.write([new Ps(this.Qu,ds.Ye())])},Zl.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Vl(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};Vl(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.nl(t))},error:n[i+1],complete:n[i+2]};return this.La.listen(Ys(this.Qu.path),o,s)},Zl.prototype.get=function(t){var e=this,n=this.firestore.Ma();return t&&"cache"===t.source?n.Ia(this.Qu).then(function(t){return new Xl(e.firestore,e.Qu,t,!0,t instanceof Bs&&t.Je,e.Ku)}):n.Aa(this.Qu,t).then(function(t){return e.nl(t)})},Zl.prototype.withConverter=function(t){return new Zl(this.Qu,this.firestore,t)},Zl.prototype.nl=function(t){var e=t.docs.get(this.Qu);return new Xl(this.firestore,this.Qu,e,t.fromCache,t.hasPendingWrites,this.Ku)},Zl),Kl=($l.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},$l),Xl=(Yl.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.sl){if(this.Ku){var n=new Ql(this.Ja,this.Qu,this.sl,this.il,this.rl,null);return this.Ku.fromFirestore(n,t)}return new jl(this.Ja.Wu,t.serverTimestamps||"none",function(t){return new Hl(t,e.Ja,null)},function(t){return new zr(t)}).ba(this.sl.rn())}},Yl.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.sl&&null!==(t=this.sl.data().field(Nl("DocumentSnapshot.get",t,this.Qu))))return new jl(this.Ja.Wu,e.serverTimestamps||"none",function(t){return new Hl(t,n.Ja,n.Ku)},function(t){return new zr(t)}).ba(t)},Object.defineProperty(Yl.prototype,"id",{get:function(){return this.Qu.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"ref",{get:function(){return new Hl(this.Qu,this.Ja,this.Ku)},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"exists",{get:function(){return null!==this.sl},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"metadata",{get:function(){return new Kl(this.rl,this.il)},enumerable:!1,configurable:!0}),Yl.prototype.isEqual=function(t){return t instanceof Yl&&this.Ja===t.Ja&&this.il===t.il&&this.Qu.isEqual(t.Qu)&&(null===this.sl?null===t.sl:this.sl.isEqual(t.sl))&&this.Ku===t.Ku},Yl),Ql=(n(Jl,Cl=Xl),Jl.prototype.data=function(t){return Cl.prototype.data.call(this,t)},Jl);function Jl(){return null!==Cl&&Cl.apply(this,arguments)||this}function Yl(t,e,n,r,i,o){this.Ja=t,this.Qu=e,this.sl=n,this.il=r,this.rl=i,this.Ku=o}function $l(t,e){this.hasPendingWrites=t,this.fromCache=e}function Zl(t,e,n){var r=this;return(r=Ml.call(this,e.Wu,t,n)||this).Qu=t,r.firestore=e,r.Ku=n,r.La=r.firestore.Ma(),r}function tf(t){this.Ja=t,this.Za=[],this.tl=!1}function ef(t,e){this.Ja=t,this.Xa=e}function nf(t,e,n){var r=this;if(void 0===n&&(n=new Gl),this.$a=n,this.ka=null,this.Oa=new Yu,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ma(),[4,this.La.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)n=t,this.ka=n,this.Wu=nf.qa(n),this.Ua=n.name,this.Ba=new Ha(e);else{if(!(t=t).projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.Wu=new Hr(t.projectId,t.database),this.Ua="[DEFAULT]",this.Ba=new za}this.ja=new ql({})}function rf(){}function of(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=ma.Li;else{if(t.cacheSizeBytes!==xl&&t.cacheSizeBytes<ma.Mi)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ma.Mi);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,_c("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function sf(t,e,n,r){this._=t,this.pa=e,this.ga=n,this.va=r}function uf(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!nu(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ri.U(n)),!si.X(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Io(t,new si(e))}if(n instanceof nl)return Io(t,n.Qu);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pc(n)+".")}function af(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function hf(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function cf(t){if(Zs(t)&&0===t.on.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lf,ff=(gf.prototype.where=function(t,e,n){return t=Nl("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){af(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(uf(n,t,h))}c={arrayValue:{values:s}}}else c=uf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||af(o,i),c=bl(e,"Query.where",o,"in"===i||"not-in"===i);var c=du.create(r,i,c);return function(t,e){if(e.an()){var n=eu(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=tu(t))&&hf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.ol,this.firestore.Wa,this.firestore.Wu,t,e,n),new gf((e=(n=this.ol).filters.concat([e]),new Ks(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.hn,n.startAt,n.endAt)),this.firestore,this.Ku)},gf.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Nl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new Gu(e,n),null!==tu(t)||null!==(t=eu(t))&&hf(0,t,n.field),e}(this.ol,t,n);return new gf((t=(n=this.ol).on.concat([t]),new Ks(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.hn,n.startAt,n.endAt)),this.firestore,this.Ku)},gf.prototype.limit=function(t){return Uc("Query.limit",t),new gf(ou(this.ol,t,"F"),this.firestore,this.Ku)},gf.prototype.limitToLast=function(t){return Uc("Query.limitToLast",t),new gf(ou(this.ol,t,"L"),this.firestore,this.Ku)},gf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.hl("Query.startAt",t,e,!0),new gf(su(this.ol,t),this.firestore,this.Ku)},gf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.hl("Query.startAfter",t,e,!1),new gf(su(this.ol,t),this.firestore,this.Ku)},gf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.hl("Query.endBefore",t,e,!0),new gf(uu(this.ol,t),this.firestore,this.Ku)},gf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.hl("Query.endAt",t,e,!1),new gf(uu(this.ol,t),this.firestore,this.Ku)},gf.prototype.isEqual=function(t){return t instanceof gf&&this.firestore===t.firestore&&au(this.ol,t.ol)&&this.Ku===t.Ku},gf.prototype.withConverter=function(t){return new gf(this.ol,this.firestore,t)},gf.prototype.hl=function(h,t,e,n){return t instanceof Xl?function(t,e,n,r){if(!n)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=ru(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(Io(e,n.key));else{var a=n.field(u.field);if(ho(a))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.q(),new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Uu(i,r)}(this.ol,this.firestore.Wu,t.sl,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.W()){if("string"!=typeof h)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!nu(t)&&-1!==h.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ri.U(h));if(!si.X(c))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new si(c),u.push(Io(e,c))}else h=bl(n,r,h),u.push(h)}return new Uu(u,o)}(this.ol,this.firestore.Wu,this.firestore.Wa,h,e,n))},gf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||Vl(n[o])||(i=n[o],o++),Vl(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new pf(e.firestore,e.ol,t,e.Ku))},error:n[o+1],complete:n[o+2]};return cf(this.ol),this.firestore.Ma().listen(this.ol,i,s)},gf.prototype.get=function(t){var e=this;cf(this.ol);var n=this.firestore.Ma();return(t&&"cache"===t.source?n.Ra(this.ol):n.Pa(this.ol,t)).then(function(t){return new pf(e.firestore,e.ol,t,e.Ku)})},gf),pf=(Object.defineProperty(vf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"empty",{get:function(){return this.ul.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"size",{get:function(){return this.ul.docs.size},enumerable:!1,configurable:!0}),vf.prototype.forEach=function(e,n){var r=this;this.ul.docs.forEach(function(t){e.call(n,r._l(t,r.metadata.fromCache,r.ul.Wt.has(t.key)))})},Object.defineProperty(vf.prototype,"query",{get:function(){return new ff(this.cl,this.Ja,this.Ku)},enumerable:!1,configurable:!0}),vf.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.ul.Kt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.al&&this.ll===t||(this.al=function(i,e,o){if(i.jt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.jt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.ul,t,this._l.bind(this)),this.ll=t),this.al},vf.prototype.isEqual=function(t){return t instanceof vf&&this.Ja===t.Ja&&au(this.cl,t.cl)&&this.ul.isEqual(t.ul)&&this.Ku===t.Ku},vf.prototype._l=function(t,e,n){return new Ql(this.Ja,t.key,t,e,n,this.Ku)},vf),df=(n(yf,lf=ff),Object.defineProperty(yf.prototype,"id",{get:function(){return this.ol.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"parent",{get:function(){var t=this.ol.path.N();return t.P()?null:new Hl(new si(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"path",{get:function(){return this.ol.path.q()},enumerable:!1,configurable:!0}),yf.prototype.doc=function(t){return 0===arguments.length&&(t=Pr.t()),kc("CollectionReference.doc","path",t),t=ri.U(t),Hl.Ha(this.ol.path.child(t),this.firestore,this.Ku)},yf.prototype.add=function(t){var t=this.Ku?this.Ku.toFirestore(t):t,e=this.doc();return new Hl(e.Qu,this.firestore,null).set(t).then(function(){return e})},yf.prototype.withConverter=function(t){return new yf(this.fl,this.firestore,t)},yf);function yf(t,e,n){var r=this;if(((r=lf.call(this,Ys(t),e,n)||this).fl=t).length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.q()+" has "+t.length);return r}function vf(t,e,n,r){this.Ja=t,this.cl=e,this.ul=n,this.Ku=r,this.al=null,this.ll=null,this.metadata=new Kl(n.hasPendingWrites,n.fromCache)}function gf(t,e,n){this.ol=t,this.firestore=e,this.Ku=n}function mf(t,e,n){if((e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new Ir(Er.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Pc(t),new Ir(Er.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,Hl)).firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function wf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var bf,Ef,l=(n(Tf,bf=tl),Tf.serverTimestamp=function(){var t=new Qc("serverTimestamp");return t.Nu="FieldValue.serverTimestamp",new Tf(t)},Tf.delete=function(){var t=new Fc("deleteField");return t.Nu="FieldValue.delete",new Tf(t)},Tf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jc("arrayUnion",t)}.apply(void 0,t);return n.Nu="FieldValue.arrayUnion",new Tf(n)},Tf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yc("arrayRemove",t)}.apply(void 0,t);return n.Nu="FieldValue.arrayRemove",new Tf(n)},Tf.increment=function(t){return(t=new $c("increment",t)).Nu="FieldValue.increment",new Tf(t)},Tf.prototype.isEqual=function(t){return this.ju.isEqual(t.ju)},Tf),If={Firestore:Wl,GeoPoint:Zc,Timestamp:ei,Blob:zr,Transaction:Bl,WriteBatch:zl,DocumentReference:Hl,DocumentSnapshot:Xl,Query:ff,QueryDocumentSnapshot:Ql,QuerySnapshot:pf,CollectionReference:df,FieldPath:jc,FieldValue:l,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:xl};function Tf(){return null!==bf&&bf.apply(this,arguments)||this}(Ef=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Wl(e,t,new Gl);var e},"PUBLIC").setServiceProps(Object.assign({},If))),Ef.registerVersion("@firebase/firestore","2.0.0-2020922203858")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});