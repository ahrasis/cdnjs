!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Gf){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Gf),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=u=u||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},k=S||self;function P(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function R(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function x(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:x).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++V))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var X,$=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var K=k.navigator;if(K){K=K.userAgent;if(K){X=K;break t}}X=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=P;var rt,it=Q(X,"Opera"),ot=Q(X,"Trident")||Q(X,"MSIE"),st=Q(X,"Edge"),ut=st||ot,at=Q(X,"Gecko")&&!(Q(X.toLowerCase(),"webkit")&&!Q(X,"Edge"))&&!(Q(X,"Trident")||Q(X,"MSIE"))&&!Q(X,"Edge"),ht=Q(X.toLowerCase(),"webkit")&&!Q(X,"Edge");function ct(){var t=k.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=X,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=$(String(rt)).split("."),n=$(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=k.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",P,e),k.removeEventListener("test",P,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[It]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[It]?t.va(e,n,D(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Ut(t);if(h||(t[Pt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=xt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Nt(t)))}function Vt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function xt(t,e){if(t.Y)return!0;if(vt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function Ut(t){return(t=t[Pt])instanceof St?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==L(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){F.call(this),this.c=new St(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,F),jt.prototype[It]=!0,(N=jt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=qt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=k.JSON.stringify;function Wt(){this.b=this.a=null}var Ht,zt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new $t},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Qt(t,e){var n;Ht||(n=k.Promise.resolve(void 0),Ht=function(){n.then(Zt)}),Yt||(Ht(),Yt=!0),Kt.add(t,e)}Wt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Wt;function Zt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||k,this.f=U(this.Xa,this),this.g=q()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==L(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}j(Jt,jt),(N=Jt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},N.G=function(){Jt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(T(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){F.call(this),this.b=t,this.a={}}j(ae,F);var he=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function fe(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var de=null;function ye(){return de=de||new jt}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();Ft(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();Ft(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}j(ve,wt),j(me,wt),j(be,wt);var Ie={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Te={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}Ae.prototype.a=null;var Oe,S={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function ke(){wt.call(this,"d")}function Pe(){wt.call(this,"c")}function Le(){}function Re(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=De,t=ut?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(ke,wt),j(Pe,wt),j(Le,Ae),Oe=new Le;var De=45e3,_e={},Ve={};function Ce(t,e,n){t.H=1,t.i=nn(Ye(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=q(),Me(t),t.l=Ye(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(U(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Va),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ve:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Ve:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ve){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Me(t){t.T=q()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(U(t.Ta,t),e)}function je(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),zn(u)}tr(u),we(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(U(u.Qa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=q()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):Jn(n),0<u.g.length&&Qn(u)):"stop"!=h[0]&&"close"!=h[0]||sr(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?sr(u,7):Hn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ge(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Re.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Ua=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ta=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):qe(this,this.T-n)},(N=He.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Ze(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=rn(n[2]||""),Ze(this,n[3]||"",!0),Je(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Qe(t)}function Ke(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?rn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function yn(t,e){return pn(t),e=gn(t,e),Xe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),H(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=W(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function kn(){this.a=new On}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Ln=k.JSON.parse;function Rn(t){jt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Dn,this.D=this.F=!1}j(Rn,jt);var Dn="",_n=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),qn(t)}function Un(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Mn(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?P:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Pa=Gn("retryDelaySeedMs",1e4,t),this.Ka=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,en(n=Ye(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Kn(t,n),(e=new Re(t,t.c,e,void 0)).H=2,e.i=nn(Ye(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=q(),Me(e)),ur(t)}function zn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Xn(t){zn(t),t.j&&(k.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Qn(t)}function Qn(t){En(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new Re(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ce(n,r,e)}function Kn(t,n){t.f&&We({},function(t,e){en(n,e,t)})}function Zn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;D(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.T=1,Qt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(U(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Re(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Kn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ye(e)),n.j=null,n.I=!0,xe(n,t)}function rr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,Ft(i=ye(),new be(i)),Qn(t)):Jn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ee(U(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Wa,t),r||(r=new Qe("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Ke(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,k.Image?((i=new Image).onload=M(Pn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Pn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Pn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Pn,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Xn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Qe?Ye(s):new Qe(s,void 0);return""!=a.c?(e&&Ze(a,e+"."+a.c),Je(a,a.h)):(u=k.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Qe(null,void 0),r&&Ke(u,r),i&&Ze(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.V&&Z(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Kn(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.La)).F=t.C,e}function cr(){}function lr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function fr(t,e){jt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Pe.call(this),this.status=1}function yr(t){this.a=t}(N=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Oe),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new He(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},N.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),qn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Rn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Sa())},N.Sa=function(){Mn(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Re(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),en(i=Ye(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Bn(i,this.i,r),An(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||En(this.b)||Yn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(U(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),zn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,zn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=cr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},j(fr,jt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Qn(t)},fr.prototype.close=function(){Hn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.l?((e={}).__data__=Gt(t),$n(this.a,e)):$n(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,fr.X.G.call(this)},j(pr,ke),j(dr,Pe),j(yr,cr),yr.prototype.ta=function(){Ft(this.a,"a")},yr.prototype.sa=function(t){Ft(this.a,new pr(t))},yr.prototype.ra=function(t){Ft(this.a,new dr)},yr.prototype.qa=function(){Ft(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Te.COMPLETE="complete",(Se.EventType=S).OPEN="a",S.CLOSE="b",S.ERROR="c",S.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Oa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.W,Rn.prototype.getResponseJson=Rn.prototype.Na,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var vr=Ie,gr=Te,mr=Se,wr=Rn,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=(n(Or,Ir=Error),Or),Nr="8.0.1-2020103231751",Sr=new l("@firebase/firestore");function Or(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function kr(){return Sr.logLevel}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.DEBUG&&(e=n.map(Dr),Sr.debug.apply(Sr,i(["Firestore ("+Nr+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.ERROR&&(e=n.map(Dr),Sr.error.apply(Sr,i(["Firestore ("+Nr+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.WARN&&(e=n.map(Dr),Sr.warn.apply(Sr,i(["Firestore ("+Nr+"): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Nr+") INTERNAL ASSERTION FAILED: "+t;throw Lr(t),new Error(t)}function Vr(t){t||_r()}var Cr=(xr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},xr);function xr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var qr=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.u=function(t){return Ur(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}qr.h=new qr("");var Fr=(Br.fromBase64String=function(t){try{return new Br(qr.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Br.fromUint8Array=function(t){return new Br(qr.fromUint8Array(t))},Br.prototype.toBase64=function(){return this.l.toBase64()},Br.prototype.toUint8Array=function(){return this.l.toUint8Array()},Br.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Br.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Br);function Br(t){this.l=t}function Gr(){if("undefined"==typeof Uint8Array)throw new Ar(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wr(){if("undefined"==typeof atob)throw new Ar(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hr,zr=(n(Yr,Hr=Fr),Yr.fromBase64String=function(t){Wr();try{return new Yr(qr.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Yr.fromUint8Array=function(t){return Gr(),new Yr(qr.fromUint8Array(t))},Yr.prototype.toBase64=function(){return Wr(),Hr.prototype.toBase64.call(this)},Yr.prototype.toUint8Array=function(){return Gr(),Hr.prototype.toUint8Array.call(this)},Yr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yr),Xr=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},$r=(Object.defineProperty(Qr.prototype,"T",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Qr.prototype.isEqual=function(t){return t instanceof Qr&&t.projectId===this.projectId&&t.database===this.database},Qr.prototype.u=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},Qr);function Qr(t,e){this.projectId=t,this.database=e||"(default)"}function Yr(){return null!==Hr&&Hr.apply(this,arguments)||this}function Kr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ti,ei,ni=(yi.prototype.get=function(t){var e=this.I(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},yi.prototype.has=function(t){return void 0!==this.get(t)},yi.prototype.set=function(t,e){var n=this.I(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},yi.prototype.delete=function(t){var e=this.I(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},yi.prototype.forEach=function(s){Zr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},yi.prototype.P=function(){return Jr(this.R)},yi),ri=(di.now=function(){return di.fromMillis(Date.now())},di.fromDate=function(t){return di.fromMillis(t.getTime())},di.fromMillis=function(t){var e=Math.floor(t/1e3);return new di(e,1e6*(t-1e3*e))},di.prototype.toDate=function(){return new Date(this.toMillis())},di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},di.prototype.V=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},di),ii=(pi.g=function(t){return new pi(t)},pi.min=function(){return new pi(new ri(0,0))},pi.prototype.u=function(t){return this.timestamp.V(t.timestamp)},pi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},pi.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},pi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},pi.prototype.v=function(){return this.timestamp},pi),l=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.C},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.S(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.D(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.F=function(t){return t=void 0===t?1:t,this.D(this.segments,this.offset+t,this.length-t)},fi.prototype.N=function(){return this.D(this.segments,this.offset,this.length-1)},fi.prototype.$=function(){return this.segments[this.offset]},fi.prototype.O=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.P=function(){return 0===this.length},fi.prototype.k=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.M=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},fi.S=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),oi=(n(li,ei=l),li.prototype.D=function(t,e,n){return new li(t,e,n)},li.prototype.q=function(){return this.L().join("/")},li.prototype.toString=function(){return this.q()},li.U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new li(n)},li.B=function(){return new li([])},li),si=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ui=(n(ci,ti=l),ci.prototype.D=function(t,e,n){return new ci(t,e,n)},ci.j=function(t){return si.test(t)},ci.prototype.q=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ci.j(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.q()},ci.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ci.K=function(){return new ci(["__name__"])},ci.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ar(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.B=function(){return new ci([])},ci),ai=(hi.H=function(t){return new hi(oi.U(t))},hi.Y=function(t){return new hi(oi.U(t).F(5))},hi.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},hi.prototype.isEqual=function(t){return null!==t&&0===oi.S(this.path,t.path)},hi.prototype.toString=function(){return this.path.toString()},hi.S=function(t,e){return oi.S(t.path,e.path)},hi.X=function(t){return t.length%2==0},hi.Z=function(t){return new hi(new oi(t.slice()))},hi);function hi(t){this.path=t}function ci(){return null!==ti&&ti.apply(this,arguments)||this}function li(){return null!==ei&&ei.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.C=n}function pi(t){this.timestamp=t}function di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function yi(t,e){this.I=t,this.A=e,this.R={}}function vi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e=t;return null===e.tt&&(t=e.path.q(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.q()+t.op.toString()+bo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.q()+t.dir}).join(","),vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Gu(e.startAt)),e.endAt&&(t+="|ub:",t+=Gu(e.endAt)),e.tt=t),e.tt}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hu(t.startAt,e.startAt)&&Hu(t.endAt,e.endAt)}function Ii(t){return ai.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ti(t){this.count=t}var Ai,Ni=(Si.prototype.st=function(t){return new Si(this.target,this.targetId,this.nt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Si.prototype.it=function(t,e){return new Si(this.target,this.targetId,this.nt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Si.prototype.rt=function(t){return new Si(this.target,this.targetId,this.nt,this.sequenceNumber,this.et,t,this.resumeToken)},Si);function Si(t,e,n,r,i,o,s){void 0===i&&(i=ii.min()),void 0===o&&(o=ii.min()),void 0===s&&(s=qr.h),this.target=t,this.targetId=e,this.nt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Oi(t){switch(t){case Tr.OK:return _r(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return _r(),0}}function ki(t){if(void 0===t)return Lr("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Ai.OK:return Tr.OK;case Ai.CANCELLED:return Tr.CANCELLED;case Ai.UNKNOWN:return Tr.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return Tr.INTERNAL;case Ai.UNAVAILABLE:return Tr.UNAVAILABLE;case Ai.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Ai.NOT_FOUND:return Tr.NOT_FOUND;case Ai.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Ai.ABORTED:return Tr.ABORTED;case Ai.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Ai.DATA_LOSS:return Tr.DATA_LOSS;default:return _r()}}(l=Ai=Ai||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Pi=(Vi.prototype.ot=function(t,e){return new Vi(this.S,this.root.ot(t,e,this.S).copy(null,null,Ri.ut,null,null))},Vi.prototype.remove=function(t){return new Vi(this.S,this.root.remove(t,this.S).copy(null,null,Ri.ut,null,null))},Vi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.S(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.S(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vi.prototype.P=function(){return this.root.P()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vi.prototype.ct=function(){return this.root.ct()},Vi.prototype.ht=function(){return this.root.ht()},Vi.prototype.at=function(t){return this.root.at(t)},Vi.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Vi.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vi.prototype.lt=function(t){return this.root.lt(t)},Vi.prototype._t=function(){return new Li(this.root,null,this.S,!1)},Vi.prototype.ft=function(t){return new Li(this.root,t,this.S,!1)},Vi.prototype.dt=function(){return new Li(this.root,null,this.S,!0)},Vi.prototype.wt=function(t){return new Li(this.root,t,this.S,!0)},Vi),Li=(_i.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},_i.prototype.At=function(){return 0<this.Tt.length},_i.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},_i),Ri=(Di.prototype.copy=function(t,e,n,r,i){return new Di(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Di.prototype.P=function(){return!1},Di.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Di.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Di.prototype.min=function(){return this.left.P()?this:this.left.min()},Di.prototype.ct=function(){return this.min().key},Di.prototype.ht=function(){return this.right.P()?this.key:this.right.ht()},Di.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Di.prototype.yt=function(){if(this.left.P())return Di.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Pt()},Di.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.vt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.bt()),0===e(t,r.key)){if(r.right.P())return Di.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Di.prototype.Vt=function(){return this.color},Di.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.Ct()),t.left.Vt()&&t.left.left.Vt()&&(t=t.vt()),t.left.Vt()&&t.right.Vt()&&(t=t.St()),t},Di.prototype.gt=function(){var t=this.St();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).Ct()).St()),t},Di.prototype.bt=function(){var t=this.St();return t.left.left.Vt()&&(t=(t=t.vt()).St()),t},Di.prototype.Ct=function(){var t=this.copy(null,null,Di.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Di.prototype.vt=function(){var t=this.copy(null,null,Di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Di.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Di.prototype.Dt=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Di.prototype.Ft=function(){if(this.Vt()&&this.left.Vt())throw _r();if(this.right.Vt())throw _r();var t=this.left.Ft();if(t!==this.right.Ft())throw _r();return t+(this.Vt()?0:1)},Di);function Di(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Di.RED,this.left=null!=r?r:Di.EMPTY,this.right=null!=i?i:Di.EMPTY,this.size=this.left.size+1+this.right.size}function _i(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Vi(t,e){this.S=t,this.root=e||Ri.EMPTY}function Ci(){this.size=0}Ri.EMPTY=null,Ri.RED=!0,Ri.ut=!1,Ri.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.ot=function(t,e,n){return new Ri(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype.P=function(){return!0},Ci.prototype.at=function(t){return!1},Ci.prototype.lt=function(t){return!1},Ci.prototype.ct=function(){return null},Ci.prototype.ht=function(){return null},Ci.prototype.Vt=function(){return!1},Ci.prototype.Dt=function(){return!0},Ci.prototype.Ft=function(){return 0},new Ci);var xi=(ji.prototype.has=function(t){return null!==this.data.get(t)},ji.prototype.first=function(){return this.data.ct()},ji.prototype.last=function(){return this.data.ht()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ji.prototype.indexOf=function(t){return this.data.indexOf(t)},ji.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},ji.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.S(r.key,t[1]))return;e(r.key)}},ji.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},ji.prototype.$t=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},ji.prototype._t=function(){return new Ui(this.data._t())},ji.prototype.ft=function(t){return new Ui(this.data.ft(t))},ji.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ji.prototype.P=function(){return this.data.P()},ji.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ji.prototype.isEqual=function(t){if(!(t instanceof ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.S(r,i))return!1}return!0},ji.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ji.prototype.copy=function(t){var e=new ji(this.S);return e.data=t,e},ji),Ui=(qi.prototype.It=function(){return this.kt.It().key},qi.prototype.At=function(){return this.kt.At()},qi),Mi=new Pi(ai.S);function qi(t){this.kt=t}function ji(t){this.S=t,this.data=new Pi(this.S)}var Fi=new Pi(ai.S);var Bi=new Pi(ai.S),Gi=new xi(ai.S);function Wi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new xi(Ur);var zi=(ao.qt=function(t){return new ao(t.S)},ao.prototype.has=function(t){return null!=this.Mt.get(t)},ao.prototype.get=function(t){return this.Mt.get(t)},ao.prototype.first=function(){return this.Lt.ct()},ao.prototype.last=function(){return this.Lt.ht()},ao.prototype.P=function(){return this.Lt.P()},ao.prototype.indexOf=function(t){t=this.Mt.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Lt.at(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.ot(t.key,t),e.Lt.ot(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Lt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.S=this.S,n.Mt=t,n.Lt=e,n},ao),Xi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):_r()},uo.prototype.Bt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},uo),$i=(so.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,zi.qt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Wt.P()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Qt===t.Qt&&this.Wt.isEqual(t.Wt)&&fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.jt.isEqual(t.jt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Qi=(oo.Xt=function(t,e){var n=new Map;return n.set(t,Yi.Zt(t,e)),new oo(ii.min(),n,Hi,Mi,Wi())},oo),Yi=(io.Zt=function(t,e){return new io(qr.h,e,Wi(),Wi(),Wi())},io),Ki=function(t,e,n,r){this.rn=t,this.removedTargetIds=e,this.key=n,this.on=r},Zi=function(t,e){this.targetId=t,this.un=e},Ji=function(t,e,n,r){void 0===n&&(n=qr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},to=(Object.defineProperty(ro.prototype,"tn",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"fn",{get:function(){return 0!==this.cn},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"dn",{get:function(){return this._n},enumerable:!1,configurable:!0}),ro.prototype.wn=function(t){0<t.o()&&(this._n=!0,this.an=t)},ro.prototype.En=function(){var n=Wi(),r=Wi(),i=Wi();return this.hn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new Yi(this.an,this.ln,n,r,i)},ro.prototype.mn=function(){this._n=!1,this.hn=co()},ro.prototype.Tn=function(t,e){this._n=!0,this.hn=this.hn.ot(t,e)},ro.prototype.In=function(t){this._n=!0,this.hn=this.hn.remove(t)},ro.prototype.An=function(){this.cn+=1},ro.prototype.Rn=function(){--this.cn},ro.prototype.Pn=function(){this._n=!0,this.ln=!0},ro),eo=(no.prototype.bn=function(t){for(var e=0,n=t.rn;e<n.length;e++){var r=n[e];t.on instanceof $s?this.Cn(r,t.on):t.on instanceof Qs&&this.Sn(r,t.key,t.on)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Sn(s,t.key,t.on)}},no.prototype.Dn=function(n){var r=this;this.Fn(n,function(t){var e=r.Nn(t);switch(n.state){case 0:r.xn(t)&&e.wn(n.resumeToken);break;case 1:e.Rn(),e.fn||e.mn(),e.wn(n.resumeToken);break;case 2:e.Rn(),e.fn||r.removeTarget(t);break;case 3:r.xn(t)&&(e.Pn(),e.wn(n.resumeToken));break;case 4:r.xn(t)&&(r.$n(t),e.wn(n.resumeToken));break;default:_r()}})},no.prototype.Fn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Vn.forEach(function(t,e){r.xn(e)&&n(e)})},no.prototype.On=function(t){var e=t.targetId,n=t.un.count,t=this.kn(e);t&&(Ii(t=t.target)?0===n?(t=new ai(t.path),this.Sn(e,t,new Qs(t,ii.min()))):Vr(1===n):this.Mn(e)!==n&&(this.$n(e),this.vn=this.vn.add(e)))},no.prototype.Ln=function(r){var i=this,o=new Map;this.Vn.forEach(function(t,e){var n=i.kn(e);n&&(t.tn&&Ii(n.target)&&(n=new ai(n.target.path),null!==i.gn.get(n)||i.qn(e,n)||i.Sn(e,n,new Qs(n,r))),t.dn&&(o.set(e,t.En()),t.mn()))});var s=Wi();this.pn.forEach(function(t,e){var n=!0;e.xt(function(t){t=i.kn(t);return!t||2===t.nt||(n=!1)}),n&&(s=s.add(t))});var t=new Qi(r,o,this.vn,this.gn,s);return this.gn=Mi,this.pn=ho(),this.vn=new xi(Ur),t},no.prototype.Cn=function(t,e){var n;this.xn(t)&&(n=this.qn(t,e.key)?2:0,this.Nn(t).Tn(e.key,n),this.gn=this.gn.ot(e.key,e),this.pn=this.pn.ot(e.key,this.Un(e.key).add(t)))},no.prototype.Sn=function(t,e,n){var r;this.xn(t)&&(r=this.Nn(t),this.qn(t,e)?r.Tn(e,1):r.In(e),this.pn=this.pn.ot(e,this.Un(e).delete(t)),n&&(this.gn=this.gn.ot(e,n)))},no.prototype.removeTarget=function(t){this.Vn.delete(t)},no.prototype.Mn=function(t){var e=this.Nn(t).En();return this.yn.Bn(t).size+e.nn.size-e.sn.size},no.prototype.An=function(t){this.Nn(t).An()},no.prototype.Nn=function(t){var e=this.Vn.get(t);return e||(e=new to,this.Vn.set(t,e)),e},no.prototype.Un=function(t){var e=this.pn.get(t);return e||(e=new xi(Ur),this.pn=this.pn.ot(t,e)),e},no.prototype.xn=function(t){var e=null!==this.kn(t);return e||Pr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.kn=function(t){var e=this.Vn.get(t);return e&&e.fn?null:this.yn.jn(t)},no.prototype.$n=function(e){var n=this;this.Vn.set(e,new to),this.yn.Bn(e).forEach(function(t){n.Sn(e,t,null)})},no.prototype.qn=function(t,e){return this.yn.Bn(t).has(e)},no);function no(t){this.yn=t,this.Vn=new Map,this.gn=Mi,this.pn=ho(),this.vn=new xi(Ur)}function ro(){this.cn=0,this.hn=co(),this.an=qr.h,this.ln=!1,this._n=!0}function io(t,e,n,r,i){this.resumeToken=t,this.tn=e,this.nn=n,this.en=r,this.sn=i}function oo(t,e,n,r,i){this.et=t,this.Ht=e,this.zt=n,this.Yt=r,this.Jt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.jt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.Qt=s,this.Kt=u}function uo(){this.Ut=new Pi(ai.S)}function ao(n){this.S=n?function(t,e){return n(t,e)||ai.S(t.key,e.key)}:function(t,e){return ai.S(t.key,e.key)},this.Mt=Fi,this.Lt=new Pi(this.S)}function ho(){return new Pi(ai.S)}function co(){return new Pi(ai.S)}function lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function fo(t){t=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new ri(t.seconds,t.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:_r()}function vo(r,i){var t,e=yo(r);if(e!==yo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return fo(r).isEqual(fo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Eo(r.timestampValue),t=Eo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,To(r.bytesValue).isEqual(To(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Io(t.doubleValue),e=Io(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Kr(e)!==Kr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!vo(e[t],n[t])))return!1;return!0}();default:return _r()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i=yo(t),o=yo(e);if(i!==o)return Ur(i,o);switch(i){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return n=e,r=Io(t.integerValue||t.doubleValue),n=Io(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return function(t,e){t=To(t),e=To(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Ur(Io(i.latitude),Io(r.latitude)))?n:Ur(Io(i.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;u=mo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Eo(t),t=Eo(e),e=Ur(n.seconds,t.seconds);return 0!==e?e:Ur(n.nanos,t.nanos)}function bo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Eo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?To(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ai.Y(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):_r();var e}(t)}function Eo(t){if(Vr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=po.exec(t);Vr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?qr.fromBase64String(t):qr.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.q()}}function No(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Oo(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var Lo={asc:"ASCENDING",desc:"DESCENDING"},Ro={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Do=function(t,e){this._=t,this.Wn=e};function _o(t){return{integerValue:""+t}}function Vo(t,e){if(t.Wn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?_o(e):Vo(t,e);var n}function xo(t,e){return t.Wn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.Wn?e.toBase64():e.toUint8Array()}function Mo(t){return Vr(!!t),ii.g((t=Eo(t),new ri(t.seconds,t.nanos)))}function qo(t,e){return new oi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).q()}function jo(t,e){return qo(t._,e.path)}function Fo(t,e){Vr(Qo(e=oi.U(e)));return Vr(e.get(1)===t._.projectId),Vr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ai((Vr(4<(e=e).length&&"documents"===e.get(4)),e.F(5)))}function Bo(t,e){return qo(t._,e)}function Go(t){return new oi(["projects",t._.projectId,"databases",t._.database]).q()}function Wo(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function Ho(t,e){var n,r,i;if(e instanceof Ss)n={update:Wo(t,e.key,e.value)};else if(e instanceof Us)n={delete:jo(t,e.key)};else if(e instanceof Os)n={update:Wo(t,e.key,e.data),updateMask:(i=e.Qn,r=[],i.fields.forEach(function(t){return r.push(t.q())}),{fieldPaths:r})};else if(e instanceof Ds)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.q(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.q(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.q(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.q(),increment:e.Kn};throw _r()})}};else{if(!(e instanceof Ms))return _r();n={verify:jo(t,e.key)}}return e.Hn.Gn||(n.currentDocument=void 0!==(i=e.Hn).updateTime?{updateTime:(e=t,t=i.updateTime,xo(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:_r()),n}function zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.N()),n.structuredQuery.from=[{collectionId:r.O()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NAN"}};if(Oo(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ko(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NOT_NAN"}};if(Oo(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$o(t.field),op:(e=t.op,Ro[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:$o((t=t).field),direction:(t=t.dir,Lo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Wn||vi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Xo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Xo(e.endAt)),n}function Xo(t){return{before:t.before,values:t.position}}function $o(t){return{fieldPath:t.q()}}function Qo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.zn=void 0};function Yo(t,e){return t instanceof hs?No(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ko,Zo,Jo=(n(ns,Zo=l),ns),ts=(n(es,Ko=l),es);function es(t){var e=this;return(e=Ko.call(this)||this).elements=t,e}function ns(){return null!==Zo&&Zo.apply(this,arguments)||this}function rs(t,e){for(var n=fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var is,os=(n(ss,is=l),ss);function ss(t){var e=this;return(e=is.call(this)||this).elements=t,e}function us(t,e){for(var n=fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var as,hs=(n(cs,as=l),cs);function cs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.Kn=e,n}function ls(t){return Io(t.integerValue||t.doubleValue)}function fs(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.Yn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].k(t))return!0;return!1},ys.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort(ui.S)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.Jn=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"Gn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof $s&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof $s}l=function(){};function bs(t,e,n){return t instanceof Ss?new $s(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Os?function(t,e,n){if(!ws(t.Hn,e))return new Ys(t.key,n.version);e=Ls(t,e);return new $s(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ds?function(t,e,n){if(Vr(null!=n.transformResults),!ws(t.Hn,e))return new Ys(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof $s&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ts?rs(o,s):o instanceof os?us(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Vs(t,r.data(),e);return new $s(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Qs(t.key,n.version,{hasCommittedMutations:!0})}function Es(t,e,n,r){return t instanceof Ss?function(t,e){if(!ws(t.Hn,e))return e;e=Ts(e);return new $s(t.key,e,t.value,{Xn:!0})}(t,e):t instanceof Os?function(t,e){if(!ws(t.Hn,e))return e;var n=Ts(e),e=Ls(t,e);return new $s(t.key,n,e,{Xn:!0})}(t,e):t instanceof Ds?function(t,e,n,r){if(!ws(t.Hn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof $s&&(c=n.field(a.field)),null===c&&r instanceof $s&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof Jo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ts?rs(h,i):h instanceof os?us(h,i):(h=Yo(c=h,i),i=ls(h)+ls(c.Kn),No(h)&&No(c.Kn)?_o(i):Vo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Vs(t,i.data(),r);return new $s(t.key,i.version,r,{Xn:!0})}(t,e,r,n):(e=e,ws((t=t).Hn,e)?new Qs(t.key,ii.min()):e)}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Hn.isEqual(e.Hn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qn.isEqual(e.Qn):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ts&&e instanceof ts||t instanceof os&&e instanceof os?Mr(t.elements,e.elements,vo):t instanceof hs&&e instanceof hs?vo(t.Kn,e.Kn):t instanceof Jo&&e instanceof Jo)}))}function Ts(t){return t instanceof $s?t.version:ii.min()}var As,Ns,Ss=(n(Ps,Ns=l),Ps),Os=(n(ks,As=l),ks);function ks(t,e,n,r){var i=this;return(i=As.call(this)||this).key=t,i.data=e,i.Qn=n,i.Hn=r,i.type=1,i}function Ps(t,e,n){var r=this;return(r=Ns.call(this)||this).key=t,r.value=e,r.Hn=n,r.type=0,r}function Ls(t,e){return n=t,e=e instanceof $s?e.data():qs.empty(),r=new js(e),n.Qn.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Zn();var n,r}var Rs,Ds=(n(_s,Rs=l),_s);function _s(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Hn=gs.exists(!0),n}function Vs(t,e,n){for(var r=new js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Zn()}var Cs,xs,Us=(n(Ws,xs=l),Ws),Ms=(n(Gs,Cs=l),Gs),qs=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Bs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Bs),js=(Fs.prototype.set=function(t,e){return this.ee(t,e),this},Fs.prototype.delete=function(t){return this.ee(t,null),this},Fs.prototype.ee=function(t,e){for(var n=this.ne,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},Fs.prototype.Zn=function(){var t=this.se(ui.B(),this.ne);return null!=t?new qs(t):this.te},Fs.prototype.se=function(r,t){var i=this,o=!1,e=this.te.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.se(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=qs.empty()),this.te=t,this.ne=new Map}function Bs(t){this.proto=t}function Gs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.Hn=e,n.type=4,n}function Ws(t,e){var n=this;return(n=xs.call(this)||this).key=t,n.Hn=e,n.type=3,n}var Hs,zs,Xs,l=function(t,e){this.key=t,this.version=e},$s=(n(tu,Xs=l),tu.prototype.field=function(t){return this.ie.field(t)},tu.prototype.data=function(){return this.ie},tu.prototype.re=function(){return this.ie.proto},tu.prototype.isEqual=function(t){return t instanceof tu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Xn===t.Xn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.ie.isEqual(t.ie)},tu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.ie.toString()+", {hasLocalMutations: "+this.Xn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.Xn||this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu),Qs=(n(Js,zs=l),Js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js),Ys=(n(Zs,Hs=l),Zs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Ks=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.oe=n,this.filters=r,this.limit=i,this.ue=o,this.startAt=s,this.endAt=u,this.ce=null,this.he=null,this.startAt,this.endAt};function Zs(){return null!==Hs&&Hs.apply(this,arguments)||this}function Js(t,e,n){var r=this;return(r=zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function tu(t,e,n,r){var i=this;return(i=Xs.call(this,t,e)||this).ie=n,i.Xn=!!r.Xn,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function eu(t){return new Ks(t)}function nu(t){return!vi(t.limit)&&"F"===t.ue}function ru(t){return!vi(t.limit)&&"L"===t.ue}function iu(t){return 0<t.oe.length?t.oe[0].field:null}function ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ae())return r.field}return null}function su(t){return null!==t.collectionGroup}function uu(t){var e=t;if(null===e.ce){e.ce=[];var n=ou(e),t=iu(e);if(null!==n&&null===t)n.W()||e.ce.push(new zu(n)),e.ce.push(new zu(ui.K(),"asc"));else{for(var r=!1,i=0,o=e.oe;i<o.length;i++){var s=o[i];e.ce.push(s),s.field.W()&&(r=!0)}r||(n=0<e.oe.length?e.oe[e.oe.length-1].dir:"asc",e.ce.push(new zu(ui.K(),n)))}}return e.ce}function au(t){var e=t;if(!e.he)if("F"===e.ue)e.he=wi(e.path,e.collectionGroup,uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=uu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new Mu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Mu(e.startAt.position,!e.startAt.before):null;e.he=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.he}function hu(t,e,n){return new Ks(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cu(t,e){return new Ks(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,e,t.endAt)}function lu(t,e){return new Ks(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,t.startAt,e)}function fu(t,e){return Ei(au(t),au(e))&&t.ue===e.ue}function pu(t){return bi(au(t))+"|lt:"+t.ue}function du(t){return"Query(target="+(e=au(t),n=e.path.q(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.q()+" "+t.op+" "+bo(t.value)}).join(", ")+"]"),vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.q()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Gu(e.startAt)),e.endAt&&(n+=", endAt: "+Gu(e.endAt)),"Target("+n+")")+"; limitType="+t.ue+")";var e,n}function yu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.k(n):ai.X(e.path)?e.path.isEqual(n):e.path.M(n))&&function(t){for(var e=0,n=i.oe;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Wu(t.startAt,uu(t),n))&&(!t.endAt||!Wu(t.endAt,uu(t),n)));var e,n}function vu(u){return function(t,e){for(var n=!1,r=0,i=uu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?ai.S(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?mo(n,t):_r()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var gu,mu=(n(wu,gu=function(){}),wu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.le(t,e,n):new Tu(t,e,n):"array-contains"===e?new Vu(t,n):"in"===e?new Cu(t,n):"not-in"===e?new xu(t,n):"array-contains-any"===e?new Uu(t,n):new wu(t,e,n)},wu.le=function(t,e,n){return new("in"===e?Au:Nu)(t,n)},wu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._e(mo(t,this.value)):null!==t&&yo(this.value)===yo(t)&&this._e(mo(t,this.value))},wu.prototype._e=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},wu.prototype.ae=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},wu);function wu(t,e,n){var r=this;return(r=gu.call(this)||this).field=t,r.op=e,r.value=n,r}var bu,Eu,Iu,Tu=(n(ku,Iu=mu),ku.prototype.matches=function(t){t=ai.S(t.key,this.key);return this._e(t)},ku),Au=(n(Ou,Eu=mu),Ou.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ou),Nu=(n(Su,bu=mu),Su.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Su);function Su(t,e){var n=this;return(n=bu.call(this,t,"not-in",e)||this).keys=Pu(0,e),n}function Ou(t,e){var n=this;return(n=Eu.call(this,t,"in",e)||this).keys=Pu(0,e),n}function ku(t,e,n){var r=this;return(r=Iu.call(this,t,e,n)||this).key=ai.Y(n.referenceValue),r}function Pu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ai.Y(t.referenceValue)})}var Lu,Ru,Du,_u,Vu=(n(Bu,_u=mu),Bu.prototype.matches=function(t){t=t.field(this.field);return So(t)&&go(t.arrayValue,this.value)},Bu),Cu=(n(Fu,Du=mu),Fu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&go(this.value.arrayValue,t)},Fu),xu=(n(ju,Ru=mu),ju.prototype.matches=function(t){if(go(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!go(this.value.arrayValue,t)},ju),Uu=(n(qu,Lu=mu),qu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!So(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},qu),Mu=function(t,e){this.position=t,this.before=e};function qu(t,e){return Lu.call(this,t,"array-contains-any",e)||this}function ju(t,e){return Ru.call(this,t,"not-in",e)||this}function Fu(t,e){return Du.call(this,t,"in",e)||this}function Bu(t,e){return _u.call(this,t,"array-contains",e)||this}function Gu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ai.S(ai.Y(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Hu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Xu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var $u=(Ku.prototype.reset=function(){this.Te=0},Ku.prototype.Re=function(){this.Te=this.me},Ku.prototype.Pe=function(t){var e=this;this.cancel();var n=Math.floor(this.Te+this.ye()),r=Math.max(0,Date.now()-this.Ae),i=Math.max(0,n-r);0<i&&Pr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Te+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ie=this.fe.Ve(this.de,i,function(){return e.Ae=Date.now(),t()}),this.Te*=this.Ee,this.Te<this.we&&(this.Te=this.we),this.Te>this.me&&(this.Te=this.me)},Ku.prototype.ge=function(){null!==this.Ie&&(this.Ie.pe(),this.Ie=null)},Ku.prototype.cancel=function(){null!==this.Ie&&(this.Ie.cancel(),this.Ie=null)},Ku.prototype.ye=function(){return(Math.random()-.5)*this.Te},Ku),Qu=(Yu.prototype.catch=function(t){return this.next(void 0,t)},Yu.prototype.next=function(r,i){var o=this;return this.Se&&_r(),this.Se=!0,this.Ce?this.error?this.De(i,this.error):this.Fe(r,this.result):new Yu(function(e,n){o.ve=function(t){o.Fe(r,t).next(e,n)},o.be=function(t){o.De(i,t).next(e,n)}})},Yu.prototype.Ne=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Yu.prototype.xe=function(t){try{var e=t();return e instanceof Yu?e:Yu.resolve(e)}catch(t){return Yu.reject(t)}},Yu.prototype.Fe=function(t,e){return t?this.xe(function(){return t(e)}):Yu.resolve(e)},Yu.prototype.De=function(t,e){return t?this.xe(function(){return t(e)}):Yu.reject(e)},Yu.resolve=function(n){return new Yu(function(t,e){t(n)})},Yu.reject=function(n){return new Yu(function(t,e){e(n)})},Yu.$e=function(t){return new Yu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Yu.Oe=function(t){for(var n=Yu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Yu.resolve(t):e()})}(r[e]);return n},Yu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$e(i)},Yu);function Yu(t){var e=this;this.ve=null,this.be=null,this.result=void 0,this.error=void 0,this.Ce=!1,this.Se=!1,t(function(t){e.Ce=!0,e.result=t,e.ve&&e.ve(t)},function(t){e.Ce=!0,e.error=t,e.be&&e.be(t)})}function Ku(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fe=t,this.de=e,this.we=n,this.Ee=r,this.me=i,this.Te=0,this.Ie=null,this.Ae=Date.now(),this.reset()}function Zu(t){return"IndexedDbTransactionError"===t.name}function Ju(){return"undefined"!=typeof document?document:null}var ta=(ra.Ue=function(t,e,n,r,i){i=new ra(t,e,Date.now()+n,r,i);return i.start(n),i},ra.prototype.start=function(t){var e=this;this.Be=setTimeout(function(){return e.je()},t)},ra.prototype.pe=function(){return this.je()},ra.prototype.cancel=function(t){null!==this.Be&&(this.clearTimeout(),this.qe.reject(new Ar(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ra.prototype.je=function(){var e=this;this.ke.We(function(){return null!==e.Be?(e.clearTimeout(),e.op().then(function(t){return e.qe.resolve(t)})):Promise.resolve()})},ra.prototype.clearTimeout=function(){null!==this.Be&&(this.Le(this),clearTimeout(this.Be),this.Be=null)},ra),ea=(Object.defineProperty(na.prototype,"ts",{get:function(){return this.Ge},enumerable:!1,configurable:!0}),na.prototype.We=function(t){this.enqueue(t)},na.prototype.ns=function(t){this.es(),this.ss(t)},na.prototype.rs=function(){var t;this.Ge||(this.Ge=!0,(t=Ju())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ze))},na.prototype.enqueue=function(t){return this.es(),this.Ge?new Promise(function(t){}):this.ss(t)},na.prototype.os=function(t){var e=this;this.We(function(){return e.Ke.push(t),e.us()})},na.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ke.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ke[0]()];case 2:return t.sent(),this.Ke.shift(),this.Xe.reset(),[3,4];case 3:if(!Zu(e=t.sent()))throw e;return Pr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ke.length&&this.Xe.Pe(function(){return n.us()}),t.label=5;case 5:return[2]}})})},na.prototype.ss=function(t){var r=this,e=this.Qe.then(function(){return r.Ye=!0,t().catch(function(t){throw r.ze=t,r.Ye=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ye=!1,t})});return this.Qe=e},na.prototype.Ve=function(t,e,n){var r=this;this.es(),-1<this.Je.indexOf(t)&&(e=0);n=ta.Ue(this,t,e,n,function(t){return r.cs(t)});return this.He.push(n),n},na.prototype.es=function(){this.ze&&_r()},na.prototype.hs=function(){},na.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qe];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qe)return[3,0];t.label=3;case 3:return[2]}})})},na.prototype._s=function(t){for(var e=0,n=this.He;e<n.length;e++)if(n[e].de===t)return!0;return!1},na.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.He.sort(function(t,e){return t.Me-e.Me});for(var t=0,e=i.He;t<e.length;t++){var n=e[t];if(n.pe(),"all"!==r&&n.de===r)break}return i.ls()})},na.prototype.ds=function(t){this.Je.push(t)},na.prototype.cs=function(t){t=this.He.indexOf(t);this.He.splice(t,1)},na);function na(){var e=this;this.Qe=Promise.resolve(),this.Ke=[],this.Ge=!1,this.He=[],this.ze=null,this.Ye=!1,this.Je=[],this.Xe=new $u(this,"async_queue_retry"),this.Ze=function(){var t=Ju();t&&Pr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Xe.ge()};var t=Ju();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ze)}function ra(t,e,n,r,i){this.ke=t,this.de=e,this.Me=n,this.op=r,this.Le=i,this.qe=new Xu,this.then=this.qe.promise.then.bind(this.qe.promise),this.qe.promise.catch(function(t){})}function ia(t,e){if(Lr("AsyncQueue",e+": "+t),Zu(t))return new Ar(Tr.UNAVAILABLE,e+": "+t);throw t}function oa(){this.Es=new ni(pu,fu),this.onlineState="Unknown",this.Ts=new Set}var sa=function(){this.ws=void 0,this.listeners=[]};function ua(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Es.get(n))||(r=!0,i=new sa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=t.sent(),o=ia(o,"Initialization of query '"+du(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Es.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&ha(e),[2]}})})}function aa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Es.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Es.delete(n),e.Ps(n))]:[2]})})}function ha(t){t.Ts.forEach(function(t){t.next()})}var ca=(pa.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.jt,e,t.Wt,t.fromCache,t.Qt,!0)}var o=!1;return this.Vs?this.ps(t)&&(this.ys.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.gs=t,o},pa.prototype.onError=function(t){this.ys.error(t)},pa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.gs&&!this.Vs&&this.vs(this.gs,t)&&(this.bs(this.gs),e=!0),e},pa.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Cs&&n||t.docs.P()&&"Offline"!==e)},pa.prototype.ps=function(t){if(0<t.docChanges.length)return!0;var e=this.gs&&this.gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Qt&&!e)&&!0===this.options.includeMetadataChanges},pa.prototype.bs=function(t){t=$i.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Vs=!0,this.ys.next(t)},pa),la=(fa.prototype.Ss=function(){return null!=this.uid},fa.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},fa.prototype.isEqual=function(t){return t.uid===this.uid},fa);function fa(t){this.uid=t}function pa(t,e,n){this.query=t,this.ys=e,this.Vs=!1,this.gs=null,this.onlineState="Unknown",this.options=n||{}}la.UNAUTHENTICATED=new la(null),la.Fs=new la("google-credentials-uid"),la.Ns=new la("first-party-uid");function da(t,e){this.user=e,this.type="OAuth",this.xs={},this.xs.Authorization="Bearer "+t}var ya=(Da.prototype.getToken=function(){return Promise.resolve(null)},Da.prototype.Os=function(){},Da.prototype.ks=function(t){(this.$s=t)(la.UNAUTHENTICATED)},Da.prototype.Ms=function(){this.$s=null},Da),va=(Ra.prototype.getToken=function(){var e=this,n=this.Us,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Us!==n?(Pr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new da(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ra.prototype.Os=function(){this.forceRefresh=!0},Ra.prototype.ks=function(t){this.$s=t,this.qs&&t(this.currentUser)},Ra.prototype.Ms=function(){this.auth&&this.auth.removeAuthTokenListener(this.Ls),this.Ls=null,this.$s=null},Ra.prototype.Bs=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new la(t)},Ra),ga=(Object.defineProperty(La.prototype,"xs",{get:function(){var t={"X-Goog-AuthUser":this.Ws},e=this.js.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),La),ma=(Pa.prototype.getToken=function(){return Promise.resolve(new ga(this.js,this.Ws))},Pa.prototype.ks=function(t){t(la.Ns)},Pa.prototype.Ms=function(){},Pa.prototype.Os=function(){},Pa),wa=(ka.prototype.Ks=function(t,e,n){for(var r=n.Gs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=bs(o,e,r[i]))}return e},ka.prototype.Hs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Es(i,e,e,this.Qs))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Es(a,e,o,this.Qs))}return e},ka.prototype.zs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Hs(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},ka.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wi())},ka.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Is)&&Mr(this.baseMutations,t.baseMutations,Is)},ka),ba=(Oa.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Oa(t,e,n,r)},Oa),Ea=(Sa.prototype.ni=function(e,n){var r=this;return this.Zs.ei(e,n).next(function(t){return r.si(e,n,t)})},Sa.prototype.si=function(t,r,i){return this.Xs.ii(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Hs(r,t);return t})},Sa.prototype.ri=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Hs(t,e);o=o.ot(t,e)}),o},Sa.prototype.oi=function(e,t){var n=this;return this.Xs.getEntries(e,t).next(function(t){return n.ui(e,t)})},Sa.prototype.ui=function(e,r){var i=this;return this.Zs.ci(e,r).next(function(t){var t=i.ri(e,r,t),n=Mi;return t.forEach(function(t,e){e=e||new Qs(t,ii.min()),n=n.ot(t,e)}),n})},Sa.prototype.hi=function(t,e,n){return r=e,ai.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ai(t,e.path):su(e)?this.li(t,e,n):this._i(t,e,n);var r},Sa.prototype.ai=function(t,e){return this.ni(t,new ai(e)).next(function(t){var e=Fi;return t instanceof $s&&(e=e.ot(t.key,t)),e})},Sa.prototype.li=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.ti.fi(n,s).next(function(t){return Qu.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Ks(t,null,e.oe.slice(),e.filters.slice(),e.limit,e.ue,e.startAt,e.endAt));return o._i(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Sa.prototype._i=function(e,n,t){var h,c,r=this;return this.Xs.hi(e,n,t).next(function(t){return h=t,r.Zs.di(e,n)}).next(function(t){return c=t,r.wi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Es(s,a,a,r.Qs);h=a instanceof $s?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){yu(n,e)||(h=h.remove(t))}),h})},Sa.prototype.wi=function(t,e,n){for(var r=Wi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Xs.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof $s&&(h=h.ot(t,e))}),h})},Sa),Ia=(Na.Ti=function(t,e){for(var n=Wi(),r=Wi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Na(t,e.fromCache,n,r)},Na),Ta=(Aa.prototype.Ai=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Aa.prototype.next=function(){var t=++this.previousValue;return this.Ri&&this.Ri(t),t},Aa);function Aa(t,e){var n=this;this.previousValue=t,e&&(e.Ii=function(t){return n.Ai(t)},this.Ri=function(t){return e.Pi(t)})}function Na(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ei=n,this.mi=r}function Sa(t,e,n){this.Xs=t,this.Zs=e,this.ti=n}function Oa(t,e,n,r){this.batch=t,this.Ys=e,this.Gs=n,this.Js=r}function ka(t,e,n,r){this.batchId=t,this.Qs=e,this.baseMutations=n,this.mutations=r}function Pa(t,e){this.js=t,this.Ws=e}function La(t,e){this.js=t,this.Ws=e,this.type="FirstParty",this.user=la.Ns}function Ra(t){var e=this;this.Ls=null,this.currentUser=la.UNAUTHENTICATED,this.qs=!1,this.Us=0,this.$s=null,this.forceRefresh=!1,this.Ls=function(){e.Us++,e.currentUser=e.Bs(),e.qs=!0,e.$s&&e.$s(e.currentUser)},this.Us=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Ls):(this.Ls(null),t.get().then(function(t){e.auth=t,e.Ls&&e.auth.addAuthTokenListener(e.Ls)},function(){}))}function Da(){this.$s=null}Ta.yi=-1;var _a=(ja.prototype.gi=function(t,e){return this.Vi.add(e),Qu.resolve()},ja.prototype.fi=function(t,e){return Qu.resolve(this.Vi.getEntries(e))},ja),Va=(qa.prototype.add=function(t){var e=t.O(),n=t.N(),r=this.index[e]||new xi(oi.S),t=!r.has(n);return this.index[e]=r.add(n),t},qa.prototype.has=function(t){var e=t.O(),t=t.N(),e=this.index[e];return e&&e.has(t)},qa.prototype.getEntries=function(t){return(this.index[t]||new xi(oi.S)).L()},qa),Ca=(Ma.prototype.next=function(){return this.pi+=2,this.pi},Ma.vi=function(){return new Ma(0)},Ma.bi=function(){return new Ma(-1)},Ma),xa=(Ua.prototype.Ui=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bi(t,n.Si)})},Ua);function Ua(t,e,n){this.persistence=t,this.Ci=e,this.Si=new Pi(Ur),this.Di=new ni(bi,Ei),this.Fi=ii.min(),this.Zs=t.Ni(n),this.xi=t.$i(),this.Oi=t.ki(),this.Mi=new Ea(this.xi,this.Zs,this.persistence.Li()),this.Ci.qi(this.Mi)}function Ma(t){this.pi=t}function qa(){this.index={}}function ja(){this.Vi=new Va}function Fa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Zs,m=e.Mi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Zs.ji(v).next(function(t){return g=t,n=e.persistence.Ni(o),m=new Ea(e.xi,n,e.persistence.Li()),n.ji(v)}).next(function(t){for(var e=[],n=[],r=Wi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.oi(v,r).next(function(t){return{Wi:t,Qi:e,Ki:n}})})})];case 1:return r=t.sent(),[2,(e.Zs=n,e.Mi=m,e.Ci.qi(e.Mi),r)]}})})}function Ba(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.xi.Gi({Hi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=Qu.resolve(),n.forEach(function(n){u=u.next(function(){return o.ii(r,n)}).next(function(t){var e=t,t=i.Js.get(n);Vr(null!==t),(!e||e.version.u(t)<0)&&(e=s.Ks(n,e,i))&&o.zi(e,i.Ys)})}),u.next(function(){return e.Zs.Yi(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.Zs.Ji(t)}).next(function(){return l.Mi.oi(t,a)})})}function Ga(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Oi.Xi(t)})}function Wa(t,a){var h=t,c=a.et,l=h.Si;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.xi.Gi({Hi:!0});l=h.Si;var u=[];a.Ht.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.Oi.Zi(s,t.sn,e).next(function(){return h.Oi.tr(s,t.nn,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,c).st(s.nr),l=l.ot(e,n),r=o,i=t,Vr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.et.p()-r.et.p()||0<i.nn.size+i.en.size+i.sn.size)&&u.push(h.Oi.er(s,n))))});var t,o=Mi,n=Wi();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof Qs&&e.version.isEqual(ii.min())?(i.sr(t,c),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.zi(e,c),o=o.ot(t,e)):Pr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.rr.ir(s,t))})})),c.isEqual(ii.min())||(t=h.Oi.Xi(s).next(function(t){return h.Oi.ur(s,s.nr,c)}),u.push(t)),Qu.$e(u).next(function(){return i.apply(s)}).next(function(){return h.Mi.ui(s,o)})}).then(function(t){return h.Si=l,t})}function Ha(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Si.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Zu(r=t.sent()))throw r;return Pr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Si=e.Si.remove(o),e.Di.delete(n.target),[2]}})})}function za(t,o,s){var u=t,a=ii.min(),h=Wi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=au(o),(void 0!==(t=(i=t).Di.get(r))?Qu.resolve(i.Si.get(t)):i.Oi.hr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Oi.ar(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ci.hi(e,o,s?a:ii.min(),s?h:Wi())}).next(function(t){return{documents:t,lr:h}});var t,n,r,i})}function Xa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Pr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function $a(t,e,n,r,i){var o=this;this.io=t,this.ro=e,this.ke=n,this.oo={},this.uo=[],this.co=new Map,this.ho=new Set,this.ao=[],this.lo=i,this.lo._o(function(t){n.We(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return yh(this)?(Pr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(4),[4,ah(e)];case 1:return t.sent(),e.fo.set("Unknown"),e.ho.delete(4),[4,uh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.fo=new eh(n,r)}var Qa,Ya,Ka,l=(sh.prototype.Tr=function(){return 1===this.state||2===this.state||4===this.state},sh.prototype.Ir=function(){return 2===this.state},sh.prototype.start=function(){3!==this.state?this.auth():this.Ar()},sh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sh.prototype.Rr=function(){this.state=0,this.Xe.reset()},sh.prototype.Pr=function(){var t=this;this.Ir()&&null===this.mr&&(this.mr=this.fe.Ve(this._r,6e4,function(){return t.yr()}))},sh.prototype.Vr=function(t){this.gr(),this.stream.send(t)},sh.prototype.yr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ir()?[2,this.close(0)]:[2]})})},sh.prototype.gr=function(){this.mr&&(this.mr.cancel(),this.mr=null)},sh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gr(),this.Xe.cancel(),this.Er++,3!==e?this.Xe.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Xe.Re()):n&&n.code===Tr.UNAUTHENTICATED&&this.wr.Os(),null!==this.stream&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.vr(n)];case 1:return t.sent(),[2]}})})},sh.prototype.pr=function(){},sh.prototype.auth=function(){var n=this;this.state=1;var t=this.br(this.Er),e=this.Er;this.wr.getToken().then(function(t){n.Er===e&&n.Cr(t)},function(e){t(function(){var t=new Ar(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sr(t)})})},sh.prototype.Cr=function(t){var e=this,n=this.br(this.Er);this.stream=this.Dr(t),this.stream.Fr(function(){n(function(){return e.state=2,e.listener.Fr()})}),this.stream.vr(function(t){n(function(){return e.Sr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},sh.prototype.Ar=function(){var t=this;this.state=4,this.Xe.Pe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},sh.prototype.Sr=function(t){return Pr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},sh.prototype.br=function(e){var n=this;return function(t){n.fe.We(function(){return n.Er===e?t():(Pr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},sh),Za=(n(oh,Ka=l),oh.prototype.Dr=function(t){return this.dr.Nr("Listen",t)},oh.prototype.onMessage=function(t){this.Xe.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Wn?(Vr(void 0===o||"string"==typeof o),qr.fromBase64String(o||"")):(Vr(void 0===o||o instanceof Uint8Array),qr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:ki(s.code),new Ar(o,s.message||"")),r=new Ji(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Fo(t,u.document.name),a=Mo(u.document.updateTime),s=new qs({mapValue:{fields:u.document.fields}}),a=new $s(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ki(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Fo(t,u.document),h=u.readTime?Mo(u.readTime):ii.min(),h=new Qs(a,h),u=u.removedTargetIds||[];r=new Ki([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=Fo(t,h.document),h=h.removedTargetIds||[];r=new Ki([],h,c,null)}else{if(!("filter"in e))return _r();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ti(e),c=c.targetId;r=new Zi(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ii.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Mo(t.readTime):ii.min()}(t);return this.listener.$r(e,t)},oh.prototype.Or=function(t){var e,n,r,i={};i.database=Go(this.serializer),i.addTarget=(e=this.serializer,(r=Ii(r=(n=t).target)?{documents:{documents:[Bo(e,r.path)]}}:{query:zo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Uo(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.nt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Vr(i)},oh.prototype.kr=function(t){var e={};e.database=Go(this.serializer),e.removeTarget=t,this.Vr(e)},oh),Ja=(n(ih,Ya=l),Object.defineProperty(ih.prototype,"Lr",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),ih.prototype.start=function(){this.Mr=!1,this.lastStreamToken=void 0,Ya.prototype.start.call(this)},ih.prototype.pr=function(){this.Mr&&this.qr([])},ih.prototype.Dr=function(t){return this.dr.Nr("Write",t)},ih.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Mr){this.Xe.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Vr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(ii.min())&&(n=Mo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new vs(n,e)}(t,r)})):[]),n=Mo(t.commitTime);return this.listener.Ur(n,e)}var n,r;return Vr(!t.writeResults||0===t.writeResults.length),this.Mr=!0,this.listener.Br()},ih.prototype.jr=function(){var t={};t.database=Go(this.serializer),this.Vr(t)},ih.prototype.qr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ho(e.serializer,t)})};this.Vr(t)},ih),th=(n(rh,Qa=function(){}),rh.prototype.Qr=function(){if(this.Wr)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},rh.prototype.Kr=function(e,n,r){var i=this;return this.Qr(),this.credentials.getToken().then(function(t){return i.dr.Kr(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Os(),t})},rh.prototype.Gr=function(e,n,r){var i=this;return this.Qr(),this.credentials.getToken().then(function(t){return i.dr.Gr(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Os(),t})},rh.prototype.terminate=function(){this.Wr=!1},rh),eh=(nh.prototype.Xr=function(){var t=this;0===this.zr&&(this.Zr("Unknown"),this.Yr=this.ke.Ve("online_state_timeout",1e4,function(){return t.Yr=null,t.no("Backend didn't respond within 10 seconds."),t.Zr("Offline"),Promise.resolve()}))},nh.prototype.eo=function(t){"Online"===this.state?this.Zr("Unknown"):(this.zr++,1<=this.zr&&(this.so(),this.no("Connection failed 1 times. Most recent error: "+t.toString()),this.Zr("Offline")))},nh.prototype.set=function(t){this.so(),this.zr=0,"Online"===t&&(this.Jr=!1),this.Zr(t)},nh.prototype.Zr=function(t){t!==this.state&&(this.state=t,this.Hr(t))},nh.prototype.no=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Jr?(Lr(t),this.Jr=!1):Pr("OnlineStateTracker",t)},nh.prototype.so=function(){null!==this.Yr&&(this.Yr.cancel(),this.Yr=null)},nh);function nh(t,e){this.ke=t,this.Hr=e,this.state="Unknown",this.zr=0,this.Yr=null,this.Jr=!0}function rh(t,e,n){var r=this;return(r=Qa.call(this)||this).credentials=t,r.dr=e,r.serializer=n,r.Wr=!1,r}function ih(t,e,n,r,i){var o=this;return(o=Ya.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Mr=!1,o}function oh(t,e,n,r,i){var o=this;return(o=Ka.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function sh(t,e,n,r,i,o){this.fe=t,this._r=n,this.dr=r,this.wr=i,this.listener=o,this.state=0,this.Er=0,this.mr=null,this.stream=null,this.Xe=new $u(t,e)}function uh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!yh(r))return[3,4];e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ah(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function hh(t,e){t.co.has(e.targetId)||(t.co.set(e.targetId,e),dh(t)?ph(t):Th(t).Ir()&&lh(t,e))}function ch(t,e){var n=t,t=Th(n);n.co.delete(e),t.Ir()&&fh(n,e),0===n.co.size&&(t.Ir()?t.Pr():yh(n)&&n.fo.set("Unknown"))}function lh(t,e){t.do.An(e.targetId),Th(t).Or(e)}function fh(t,e){t.do.An(e),Th(t).kr(e)}function ph(e){e.do=new eo({Bn:function(t){return e.oo.Bn(t)},jn:function(t){return e.co.get(t)||null}}),Th(e).start(),e.fo.Xr()}function dh(t){return yh(t)&&!Th(t).Tr()&&0<t.co.size}function yh(t){return 0===t.ho.size}function vh(t){t.do=void 0}function gh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.fo.set("Online"),!(u instanceof Ji&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.co.has(i)?[4,o.oo.wo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.co.delete(i),o.do.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Pr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,mh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ki?s.do.bn(u):u instanceof Zi?s.do.On(u):s.do.Dn(u),a.isEqual(ii.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ga(s.io)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).do.Ln(i)).Ht.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.co.get(e))&&r.co.set(e,n.it(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.co.get(t);e&&(r.co.set(t,e.it(qr.h,e.et)),fh(r,t),e=new Ni(e.target,t,1,e.sequenceNumber),lh(r,e))}),r.oo.Eo(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Pr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,mh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function mh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Zu(r))throw r;return n.ho.add(1),[4,ah(n)];case 1:return t.sent(),n.fo.set("Offline"),i=i||function(){return Ga(n.io)},n.ke.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Pr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ho.delete(1),[4,uh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function wh(e,n){return n().catch(function(t){return mh(e,t,n)})}function bh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ah(i=a),s=0<i.uo.length?i.uo[i.uo.length-1].batchId:-1,t.label=1;case 1:if(!(yh(i)&&i.uo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.io,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Zs.cr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.uo.length&&o.Pr(),[3,7]):(s=u.batchId,function(t,e){t.uo.push(e);t=Ah(t);t.Ir()&&t.Lr&&t.qr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,mh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Eh(i)&&Ih(i),[2]}var e,n,r})})}function Eh(t){return yh(t)&&!Ah(t).Tr()&&0<t.uo.length}function Ih(t){Ah(t).start()}function Th(n){var t,e,r,i=this;return n.Io||(n.Io=(t=n.ro,e=n.ke,r={Fr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.co.forEach(function(t,e){lh(n,t)}),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return vh(e),dh(e)?(e.fo.eo(n),ph(e)):e.fo.set("Unknown"),[2]})})}.bind(null,n),$r:gh.bind(null,n)},t.Qr(),new Za(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Io.Rr(),dh(n)?ph(n):n.fo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Io.stop()];case 2:t.sent(),vh(n),t.label=3;case 3:return[2]}})})})),n.Io}function Ah(n){var t,e,r,i=this;return n.Ao||(n.Ao=(t=n.ro,e=n.ke,r={Fr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ah(e).jr(),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ah(e).Lr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Oi(n=i.code)&&n!==Tr.ABORTED?(e=r.uo.shift(),Ah(r).Rr(),[4,wh(r,function(){return r.oo.To(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,bh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Eh(e)&&Ih(e),[2]}})})}.bind(null,n),Br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ah(o),n=0,r=o.uo;n<r.length;n++)i=r[n],e.qr(i.mutations);return[2]})})}.bind(null,n),Ur:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.uo.shift(),n=ba.from(e,i,o),[4,wh(r,function(){return r.oo.mo(n)})];case 1:return t.sent(),[4,bh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qr(),new Ja(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Ao.Rr(),[4,bh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Ao.stop()];case 3:t.sent(),0<n.uo.length&&(Pr("RemoteStore","Stopping write stream with "+n.uo.length+" pending writes"),n.uo=[]),t.label=4;case 4:return[2]}})})})),n.Ao}var Nh=(jh.prototype.P=function(){return this.Ro.P()},jh.prototype.po=function(t,e){e=new Sh(t,e);this.Ro=this.Ro.add(e),this.yo=this.yo.add(e)},jh.prototype.vo=function(t,e){var n=this;t.forEach(function(t){return n.po(t,e)})},jh.prototype.bo=function(t,e){this.Co(new Sh(t,e))},jh.prototype.So=function(t,e){var n=this;t.forEach(function(t){return n.bo(t,e)})},jh.prototype.Do=function(t){var e=this,n=new ai(new oi([])),r=new Sh(n,t),t=new Sh(n,t+1),i=[];return this.yo.Nt([r,t],function(t){e.Co(t),i.push(t.key)}),i},jh.prototype.Fo=function(){var e=this;this.Ro.forEach(function(t){return e.Co(t)})},jh.prototype.Co=function(t){this.Ro=this.Ro.delete(t),this.yo=this.yo.delete(t)},jh.prototype.No=function(t){var e=new ai(new oi([])),n=new Sh(e,t),t=new Sh(e,t+1),r=Wi();return this.yo.Nt([n,t],function(t){r=r.add(t.key)}),r},jh.prototype.xo=function(t){var e=new Sh(t,0),e=this.Ro.$t(e);return null!==e&&t.isEqual(e.key)},jh),Sh=(qh.Po=function(t,e){return ai.S(t.key,e.key)||Ur(t.$o,e.$o)},qh.Vo=function(t,e){return Ur(t.$o,e.$o)||ai.S(t.key,e.key)},qh),Oh=(Mh.prototype.Oo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Mh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Mh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},Mh),kh=(Uh.prototype.Uo=function(t){},Uh.prototype.Bo=function(t,e,n){},Uh.prototype.jo=function(t){return this.Lo.Oo(t),this.qo[t]||"not-current"},Uh.prototype.Wo=function(t,e,n){this.qo[t]=e},Uh.prototype.Qo=function(t){this.Lo.ko(t)},Uh.prototype.Ko=function(t){return this.Lo.activeTargetIds.has(t)},Uh.prototype.Go=function(t){delete this.qo[t]},Uh.prototype.Ho=function(){return this.Lo.activeTargetIds},Uh.prototype.zo=function(t){return this.Lo.activeTargetIds.has(t)},Uh.prototype.start=function(){return this.Lo=new Oh,Promise.resolve()},Uh.prototype.Yo=function(t,e,n){},Uh.prototype.Jo=function(t){},Uh.prototype.Xo=function(){},Uh.prototype.Pi=function(t){},Uh),Ph=function(t){this.key=t},Lh=function(t){this.key=t},Rh=(Object.defineProperty(xh.prototype,"iu",{get:function(){return this.Zo},enumerable:!1,configurable:!0}),xh.prototype.ru=function(t,e){var s=this,u=e?e.ou:new Xi,a=(e||this).su,h=(e||this).Wt,c=a,l=!1,f=nu(this.query)&&a.size===this.query.limit?a.last():null,p=ru(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof $s?e:null)&&(yu(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Xn||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.uu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.eu(r,f)||p&&s.eu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),nu(this.query)||ru(this.query))for(;c.size>this.query.limit;){var n=nu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{su:c,ou:u,cu:l,Wt:h}},xh.prototype.uu=function(t,e){return t.Xn&&e.hasCommittedMutations&&!e.Xn},xh.prototype.hu=function(t,e,n){var o=this,r=this.su;this.su=t.su,this.Wt=t.Wt;var i=t.ou.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.eu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.au(n);var s=e?this.lu():[],n=0===this.nu.size&&this.tn?1:0,e=n!==this.tu;return this.tu=n,0!==i.length||e?{snapshot:new $i(this.query,t.su,r,i,t.Wt,0==n,e,!1),_u:s}:{_u:s}},xh.prototype.As=function(t){return this.tn&&"Offline"===t?(this.tn=!1,this.hu({su:this.su,ou:new Xi,Wt:this.Wt,cu:!1},!1)):{_u:[]}},xh.prototype.fu=function(t){return!this.Zo.has(t)&&!!this.su.has(t)&&!this.su.get(t).Xn},xh.prototype.au=function(t){var e=this;t&&(t.nn.forEach(function(t){return e.Zo=e.Zo.add(t)}),t.en.forEach(function(t){}),t.sn.forEach(function(t){return e.Zo=e.Zo.delete(t)}),this.tn=t.tn)},xh.prototype.lu=function(){var e=this;if(!this.tn)return[];var n=this.nu;this.nu=Wi(),this.su.forEach(function(t){e.fu(t.key)&&(e.nu=e.nu.add(t.key))});var r=[];return n.forEach(function(t){e.nu.has(t)||r.push(new Lh(t))}),this.nu.forEach(function(t){n.has(t)||r.push(new Ph(t))}),r},xh.prototype.du=function(t){this.Zo=t.lr,this.nu=Wi();t=this.ru(t.documents);return this.hu(t,!0)},xh.prototype.wu=function(){return $i.Gt(this.query,this.su,this.Wt,0===this.tu)},xh),Dh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},_h=function(t){this.key=t,this.Eu=!1},Vh=(Object.defineProperty(Ch.prototype,"Fu",{get:function(){return!0===this.Du},enumerable:!1,configurable:!0}),Ch);function Ch(t,e,n,r,i,o){this.io=t,this.mu=e,this.Tu=n,this.Iu=r,this.currentUser=i,this.Au=o,this.Ru={},this.Pu=new ni(pu,fu),this.yu=new Map,this.Vu=[],this.gu=new Pi(ai.S),this.pu=new Map,this.vu=new Nh,this.bu={},this.Cu=new Map,this.Su=Ca.bi(),this.onlineState="Unknown",this.Du=void 0}function xh(t,e){this.query=t,this.Zo=e,this.tu=null,this.tn=!1,this.nu=Wi(),this.Wt=Wi(),this.eu=vu(t),this.su=new zi(this.eu)}function Uh(){this.Lo=new Oh,this.qo={},this.Hr=null,this.Ii=null}function Mh(){this.activeTargetIds=Hi}function qh(t,e){this.key=t,this.$o=e}function jh(){this.Ro=new xi(Sh.Po),this.yo=new xi(Sh.Vo)}function Fh(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).mu.oo.Eo=Gh.bind(null,e),e.mu.oo.Bn=function(t,e){var n=t,t=n.pu.get(e);if(t&&t.Eu)return Wi().add(t.key);var r=Wi(),e=n.yu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Pu.get(s);r=r.Ot(s.view.iu)}return r}.bind(null,e),e.mu.oo.wo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Iu.Wo(s,"rejected",u),i=e.pu.get(s),(n=i&&i.key)?(r=(r=new Pi(ai.S)).ot(n,new Qs(n,ii.min())),i=Wi().add(n),i=new Qi(ii.min(),new Map,new xi(Ur),r,i),[4,Gh(e,i)]):[3,2];case 1:return t.sent(),e.gu=e.gu.remove(n),e.pu.delete(s),Kh(e),[3,4];case 2:return[4,Ha(e.io,s,!1).then(function(){return $h(e,s,u)}).catch(Xa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Ru.$r=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Es.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&ha(n)}.bind(null,e.Tu),e.Ru.Nu=function(t,e,n){var r=t;if(t=r.Es.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Es.delete(e)}.bind(null,e.Tu),(a=(n=e).Pu.get(c))?(o=a.targetId,n.Iu.jo(o),s=a.view.wu(),[3,4]):[3,1];case 1:return[4,(e=n.io,r=au(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Oi.hr(e,r).next(function(t){return t?(n=t,Qu.resolve(n)):i.Oi.xu(e).next(function(t){return n=new Ni(r,t,0,e.nr),i.Oi.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.Si.get(t.targetId);return(null===e||0<t.et.u(e.et))&&(i.Si=i.Si.ot(t.targetId,t),i.Di.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Iu.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ou=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.ru(o)).cu?[4,za(r.io,i.query,!1).then(function(t){t=t.documents;return i.view.ru(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Ht.get(i.targetId),n=i.view.hu(e,r.Fu,n),[2,(Yh(r,i.targetId,n._u),n.snapshot)]}})})}(i,t,e,n)},[4,za(i.io,o,!0)];case 1:return n=t.sent(),r=new Rh(o,n.lr),e=r.ru(n.documents),n=Yi.Zt(s,u&&"Offline"!==i.onlineState),n=r.hu(e,i.Fu,n),Yh(i,s,n._u),r=new Dh(o,s,r),i.Pu.set(o,r),i.yu.has(s)?i.yu.get(s).push(o):i.yu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&hh(n.mu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Bh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).mu.oo.mo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ba(e.io,o)];case 2:return r=t.sent(),Xh(e,n,null),zh(e,n),e.Iu.Bo(n,"acknowledged"),[4,Zh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.mu.oo.To=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Zs.Lu(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.Zs.Yi(e,t)}).next(function(){return i.Zs.Ji(e)}).next(function(){return i.Mi.oi(e,n)})}))];case 2:return o=t.sent(),Xh(n,u,a),zh(n,u),n.Iu.Bo(u,"rejected",a),[4,Zh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.io,a=p,c=r,l=ri.now(),i=a.reduce(function(t,e){return t.add(e.key)},Wi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.Mi.oi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ds?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof $s?t.field(i.field):void 0,o=Yo(i.transform,o||null);null!=o&&(e=(null==e?new js:e).set(i.field,o))}return e?e.Zn():null}(o):null);null!=o&&e.push(new Os(i.key,o,function s(t){var u=[];return Zr(t.fields||{},function(t,e){var n=new ui([t]);if(Po(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ds(u)}(o.proto.mapValue),gs.exists(!0)))}return c.Zs.ku(u,l,e,a)})}).then(function(t){var e=t.zs(h);return{batchId:t.batchId,Mu:e}}))];case 2:return s=t.sent(),u.Iu.Uo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.bu[e.currentUser.Ds()])||new Pi(Ur)).ot(n,o),e.bu[e.currentUser.Ds()]=r,[4,Zh(u,s.Mu)];case 3:return t.sent(),[4,bh(u.mu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ia(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Gh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Wa(n.io,i)];case 2:return e=t.sent(),i.Ht.forEach(function(t,e){e=n.pu.get(e);e&&(Vr(t.nn.size+t.en.size+t.sn.size<=1),0<t.nn.size?e.Eu=!0:0<t.en.size?Vr(e.Eu):0<t.sn.size&&(Vr(e.Eu),e.Eu=!1))}),[4,Zh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Wh(t,n,e){var r,t=t;(t.Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Pu.forEach(function(t,e){e=e.view.As(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Es.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&ha(t)}(t.Tu,n),r.length&&t.Ru.$r(r),t.onlineState=n,t.Fu&&t.Iu.Jo(n))}function Hh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:yh((n=o).mu)||Pr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.io).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Zs.qu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Cu.get(r)||[]).push(s),n.Cu.set(r,i),[3,4]);case 3:return i=t.sent(),i=ia(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function zh(t,e){(t.Cu.get(e)||[]).forEach(function(t){t.resolve()}),t.Cu.delete(e)}function Xh(t,e,n){var r=t,i=r.bu[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.bu[r.currentUser.Ds()]=i)}function $h(e,t,n){void 0===n&&(n=null),e.Iu.Qo(t);for(var r=0,i=e.yu.get(t);r<i.length;r++){var o=i[r];e.Pu.delete(o),n&&e.Ru.Nu(o,n)}e.yu.delete(t),e.Fu&&e.vu.Do(t).forEach(function(t){e.vu.xo(t)||Qh(e,t)})}function Qh(t,e){var n=t.gu.get(e);null!==n&&(ch(t.mu,n),t.gu=t.gu.remove(e),t.pu.delete(n),Kh(t))}function Yh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ph?(t.vu.po(o.key,e),function(t,e){e=e.key;t.gu.get(e)||(Pr("SyncEngine","New document in limbo: "+e),t.Vu.push(e),Kh(t))}(t,o)):o instanceof Lh?(Pr("SyncEngine","Document no longer in limbo: "+o.key),t.vu.bo(o.key,e),t.vu.xo(o.key)||Qh(t,o.key)):_r()}}function Kh(t){for(;0<t.Vu.length&&t.gu.size<t.Au;){var e=t.Vu.shift(),n=t.Su.next();t.pu.set(n,new _h(e)),t.gu=t.gu.ot(e,n),hh(t.mu,new Ni(au(eu(e.path)),n,2,Ta.yi))}}function Zh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Pu.P()?[3,3]:(n.Pu.forEach(function(t,e){o.push(n.Ou(e,s,u).then(function(t){t&&(n.Fu&&n.Iu.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ia.Ti(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ru.$r(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Qu.forEach(h,function(e){return Qu.forEach(e.Ei,function(t){return r.persistence.rr.po(n,e.targetId,t)}).next(function(){return Qu.forEach(e.mi,function(t){return r.persistence.rr.bo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Zu(e=t.sent()))throw e;return Pr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Si.get(o),u=s.et,u=s.rt(u),r.Si=r.Si.ot(o,u));return[2]}})})}(n.io,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Jh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Pr("SyncEngine","User change. New user:",o.Ds()),[4,Fa(n.io,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Cu.forEach(function(t){t.forEach(function(t){t.reject(new Ar(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Cu.clear(),n.Iu.Yo(o,r.Qi,r.Ki),[4,Zh(n,r.Wi)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var tc,ec,nc,rc=(Lc.prototype.qi=function(t){this.Uu=t},Lc.prototype.hi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.oe.length||1===r.oe.length&&r.oe[0].field.W())||i.isEqual(ii.min())?this.Bu(e,r):this.Uu.oi(e,o).next(function(t){var n=s.ju(r,t);return(nu(r)||ru(r))&&s.cu(r.ue,n,o,i)?s.Bu(e,r):(kr()<=u.DEBUG&&Pr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),du(r)),s.Uu.hi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Lc.prototype.ju=function(n,t){var r=new xi(vu(n));return t.forEach(function(t,e){e instanceof $s&&yu(n,e)&&(r=r.add(e))}),r},Lc.prototype.cu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},Lc.prototype.Bu=function(t,e){return kr()<=u.DEBUG&&Pr("IndexFreeQueryEngine","Using full collection scan to execute query:",du(e)),this.Uu.hi(t,e,ii.min())},Lc),ic=(Pc.prototype.Ku=function(t){return Qu.resolve(0===this.Zs.length)},Pc.prototype.ku=function(t,e,n,r){var i=this.Wu;this.Wu++,0<this.Zs.length&&this.Zs[this.Zs.length-1];n=new wa(i,e,n,r);this.Zs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Qu=this.Qu.add(new Sh(u.key,i)),this.ti.gi(t,u.key.path.N())}return Qu.resolve(n)},Pc.prototype.Lu=function(t,e){return Qu.resolve(this.Gu(e))},Pc.prototype.cr=function(t,e){e+=1,e=this.Hu(e),e=e<0?0:e;return Qu.resolve(this.Zs.length>e?this.Zs[e]:null)},Pc.prototype.qu=function(){return Qu.resolve(0===this.Zs.length?-1:this.Wu-1)},Pc.prototype.ji=function(t){return Qu.resolve(this.Zs.slice())},Pc.prototype.ei=function(t,e){var n=this,r=new Sh(e,0),e=new Sh(e,Number.POSITIVE_INFINITY),i=[];return this.Qu.Nt([r,e],function(t){t=n.Gu(t.$o);i.push(t)}),Qu.resolve(i)},Pc.prototype.ci=function(t,e){var n=this,r=new xi(Ur);return e.forEach(function(t){var e=new Sh(t,0),t=new Sh(t,Number.POSITIVE_INFINITY);n.Qu.Nt([e,t],function(t){r=r.add(t.$o)})}),Qu.resolve(this.zu(r))},Pc.prototype.di=function(t,e){var n=e.path,r=n.length+1,e=n;ai.X(e)||(e=e.child(""));var e=new Sh(new ai(e),0),i=new xi(Ur);return this.Qu.xt(function(t){var e=t.key.path;return!!n.k(e)&&(e.length===r&&(i=i.add(t.$o)),!0)},e),Qu.resolve(this.zu(i))},Pc.prototype.zu=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Gu(t);null!==t&&n.push(t)}),n},Pc.prototype.Yi=function(n,r){var i=this;Vr(0===this.Yu(r.batchId,"removed")),this.Zs.shift();var o=this.Qu;return Qu.forEach(r.mutations,function(t){var e=new Sh(t.key,r.batchId);return o=o.delete(e),i.rr.Ju(n,t.key)}).next(function(){i.Qu=o})},Pc.prototype.Xu=function(t){},Pc.prototype.xo=function(t,e){var n=new Sh(e,0),n=this.Qu.$t(n);return Qu.resolve(e.isEqual(n&&n.key))},Pc.prototype.Ji=function(t){return this.Zs.length,Qu.resolve()},Pc.prototype.Yu=function(t,e){return this.Hu(t)},Pc.prototype.Hu=function(t){return 0===this.Zs.length?0:t-this.Zs[0].batchId},Pc.prototype.Gu=function(t){t=this.Hu(t);return t<0||t>=this.Zs.length?null:this.Zs[t]},Pc),oc=(kc.prototype.zi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Zu(e);return this.docs=this.docs.ot(r,{tc:e,size:i,readTime:n}),this.size+=i-o,this.ti.gi(t,r.path.N())},kc.prototype.sr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},kc.prototype.ii=function(t,e){e=this.docs.get(e);return Qu.resolve(e?e.tc:null)},kc.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.tc:null)}),Qu.resolve(r)},kc.prototype.hi=function(t,e,n){for(var r=Fi,i=new ai(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.tc,a=a.readTime;if(!e.path.k(u.path))break;a.u(n)<=0||s instanceof $s&&yu(e,s)&&(r=r.ot(s.key,s))}return Qu.resolve(r)},kc.prototype.nc=function(t,e){return Qu.forEach(this.docs,function(t){return e(t)})},kc.prototype.Gi=function(t){return new sc(this)},kc.prototype.ec=function(t){return Qu.resolve(this.size)},kc),sc=(Object.defineProperty(Oc.prototype,"readTime",{get:function(){return this.ic},set:function(t){this.ic=t},enumerable:!1,configurable:!0}),Oc.prototype.zi=function(t,e){this.rc(),this.readTime=e,this.Mu.set(t.key,t)},Oc.prototype.sr=function(t,e){this.rc(),e&&(this.readTime=e),this.Mu.set(t,null)},Oc.prototype.ii=function(t,e){this.rc();var n=this.Mu.get(e);return void 0!==n?Qu.resolve(n):this.oc(t,e)},Oc.prototype.getEntries=function(t,e){return this.uc(t,e)},Oc.prototype.apply=function(t){return this.rc(),this.sc=!0,this.hu(t)},Oc.prototype.rc=function(){},n(Sc,nc=Oc),Sc.prototype.hu=function(n){var r=this,i=[];return this.Mu.forEach(function(t,e){e?i.push(r.cc.zi(n,e,r.readTime)):r.cc.sr(t)}),Qu.$e(i)},Sc.prototype.oc=function(t,e){return this.cc.ii(t,e)},Sc.prototype.uc=function(t,e){return this.cc.getEntries(t,e)},Sc),uc=(Nc.prototype.Fn=function(t,n){return this.hc.forEach(function(t,e){return n(e)}),Qu.resolve()},Nc.prototype.Xi=function(t){return Qu.resolve(this.lastRemoteSnapshotVersion)},Nc.prototype.fc=function(t){return Qu.resolve(this.ac)},Nc.prototype.xu=function(t){return this.highestTargetId=this._c.next(),Qu.resolve(this.highestTargetId)},Nc.prototype.ur=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ac&&(this.ac=e),Qu.resolve()},Nc.prototype.dc=function(t){this.hc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this._c=new Ca(e),this.highestTargetId=e),t.sequenceNumber>this.ac&&(this.ac=t.sequenceNumber)},Nc.prototype.$u=function(t,e){return this.dc(e),this.targetCount+=1,Qu.resolve()},Nc.prototype.er=function(t,e){return this.dc(e),Qu.resolve()},Nc.prototype.wc=function(t,e){return this.hc.delete(e.target),this.lc.Do(e.targetId),--this.targetCount,Qu.resolve()},Nc.prototype.Ec=function(n,r,i){var o=this,s=0,u=[];return this.hc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hc.delete(t),u.push(o.mc(n,e.targetId)),s++)}),Qu.$e(u).next(function(){return s})},Nc.prototype.Tc=function(t){return Qu.resolve(this.targetCount)},Nc.prototype.hr=function(t,e){e=this.hc.get(e)||null;return Qu.resolve(e)},Nc.prototype.tr=function(t,e,n){return this.lc.vo(e,n),Qu.resolve()},Nc.prototype.Zi=function(e,t,n){this.lc.So(t,n);var r=this.persistence.rr,i=[];return r&&t.forEach(function(t){i.push(r.Ju(e,t))}),Qu.$e(i)},Nc.prototype.mc=function(t,e){return this.lc.Do(e),Qu.resolve()},Nc.prototype.ar=function(t,e){e=this.lc.No(e);return Qu.resolve(e)},Nc.prototype.xo=function(t,e){return Qu.resolve(this.lc.xo(e))},Nc),ac=(Ac.prototype.start=function(){return Promise.resolve()},Ac.prototype.Xo=function(){return this.Rc=!1,Promise.resolve()},Object.defineProperty(Ac.prototype,"yc",{get:function(){return this.Rc},enumerable:!1,configurable:!0}),Ac.prototype.Vc=function(){},Ac.prototype.gc=function(){},Ac.prototype.Li=function(){return this.ti},Ac.prototype.Ni=function(t){var e=this.Ic[t.Ds()];return e||(e=new ic(this.ti,this.rr),this.Ic[t.Ds()]=e),e},Ac.prototype.ki=function(){return this.Oi},Ac.prototype.$i=function(){return this.Xs},Ac.prototype.runTransaction=function(t,e,n){var r=this;Pr("MemoryPersistence","Starting transaction:",t);var i=new hc(this.Ac.next());return this.rr.vc(),n(i).next(function(t){return r.rr.bc(i).next(function(){return t})}).Ne().then(function(t){return i.Cc(),t})},Ac.prototype.Sc=function(e,n){return Qu.Oe(Object.values(this.Ic).map(function(t){return function(){return t.xo(e,n)}}))},Ac),hc=(Tc.prototype.Fc=function(t){this.Dc.push(t)},Tc.prototype.Cc=function(){this.Dc.forEach(function(t){return t()})},n(Ic,ec=Tc),Ic),cc=(Ec.$c=function(t){return new Ec(t)},Object.defineProperty(Ec.prototype,"Oc",{get:function(){if(this.xc)return this.xc;throw _r()},enumerable:!1,configurable:!0}),Ec.prototype.po=function(t,e,n){return this.Nc.po(n,e),this.Oc.delete(n.toString()),Qu.resolve()},Ec.prototype.bo=function(t,e,n){return this.Nc.bo(n,e),this.Oc.add(n.toString()),Qu.resolve()},Ec.prototype.Ju=function(t,e){return this.Oc.add(e.toString()),Qu.resolve()},Ec.prototype.removeTarget=function(t,e){var n=this;this.Nc.Do(e.targetId).forEach(function(t){return n.Oc.add(t.toString())});var r=this.persistence.ki();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.Oc.add(t.toString())})}).next(function(){return r.wc(t,e)})},Ec.prototype.vc=function(){this.xc=new Set},Ec.prototype.bc=function(n){var r=this,i=this.persistence.$i().Gi();return Qu.forEach(this.Oc,function(t){var e=ai.H(t);return r.kc(n,e).next(function(t){t||i.sr(e)})}).next(function(){return r.xc=null,i.apply(n)})},Ec.prototype.ir=function(t,e){var n=this;return this.kc(t,e).next(function(t){t?n.Oc.delete(e.toString()):n.Oc.add(e.toString())})},Ec.prototype.Pc=function(t){return 0},Ec.prototype.kc=function(t,e){var n=this;return Qu.Oe([function(){return Qu.resolve(n.Nc.xo(e))},function(){return n.persistence.ki().xo(t,e)},function(){return n.persistence.Sc(t,e)}])},Ec),lc=(bc.prototype.Fr=function(t){this.qc=t},bc.prototype.vr=function(t){this.Uc=t},bc.prototype.onMessage=function(t){this.Bc=t},bc.prototype.close=function(){this.Lc()},bc.prototype.send=function(t){this.Mc(t)},bc.prototype.jc=function(){this.qc()},bc.prototype.Wc=function(t){this.Uc(t)},bc.prototype.Qc=function(t){this.Bc(t)},bc),fc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pc=(wc.prototype.Kr=function(e,t,n,r){var i=this.zc(e,t);Pr("RestConnection","Sending: ",i,n);t={};return this.Yc(t,r),this.Jc(e,i,t,n).then(function(t){return Pr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},wc.prototype.Gr=function(t,e,n,r){return this.Kr(t,e,n,r)},wc.prototype.Yc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.1-2020103231751",t["Content-Type"]="text/plain",e)for(var n in e.xs)e.xs.hasOwnProperty(n)&&(t[n]=e.xs[n])},wc.prototype.zc=function(t,e){t=fc[t];return this.Gc+"/v1/"+e+":"+t},n(mc,tc=wc),mc.prototype.Jc=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Pr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Pr("Connection",'RPC "'+o+'" timed out'),r(new Ar(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Pr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new Ar(e,t.message))):r(new Ar(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ar(Tr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Pr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},mc.prototype.Nr=function(t,e){var n,r=[this.Gc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.Yc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Pr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new lc({Mc:function(t){u?Pr("Connection","Not sending because WebChannel is closed:",t):(s||(Pr("Connection","Opening WebChannel transport."),o.open(),s=!0),Pr("Connection","WebChannel sending:",t),o.send(t))},Lc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Pr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Pr("Connection","WebChannel transport closed"),a.Wc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Rr("Connection","WebChannel transport errored:",t),a.Wc(new Ar(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Vr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Pr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ai[r];if(void 0!==t)return ki(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Wc(new Ar(t,i)),o.close()):(Pr("Connection","WebChannel received:",e),a.Qc(e)))}),setTimeout(function(){a.jc()},0),a},mc),dc=(gc.prototype._o=function(t){this.eh.push(t)},gc.prototype.Xo=function(){window.removeEventListener("online",this.Xc),window.removeEventListener("offline",this.th)},gc.prototype.sh=function(){window.addEventListener("online",this.Xc),window.addEventListener("offline",this.th)},gc.prototype.Zc=function(){Pr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(0)},gc.prototype.nh=function(){Pr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(1)},gc.ih=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},gc),yc=(vc.prototype._o=function(t){},vc.prototype.Xo=function(){},vc);function vc(){}function gc(){var t=this;this.Xc=function(){return t.Zc()},this.th=function(){return t.nh()},this.eh=[],this.sh()}function mc(t){var e=this;return(e=tc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function wc(t){this.Kc=t,this._=t._;var e=t.ssl?"https":"http";this.Gc=e+"://"+t.host,this.Hc="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function bc(t){this.Mc=t.Mc,this.Lc=t.Lc}function Ec(t){this.persistence=t,this.Nc=new Nh,this.xc=null}function Ic(t){var e=this;return(e=ec.call(this)||this).nr=t,e}function Tc(){this.Dc=[]}function Ac(t){var e=this;this.Ic={},this.Ac=new Ta(0),this.Rc=!1,this.Rc=!0,this.rr=t(this),this.Oi=new uc(this),this.ti=new _a,this.Xs=(t=this.ti,new oc(t,function(t){return e.rr.Pc(t)}))}function Nc(t){this.persistence=t,this.hc=new ni(bi,Ei),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.ac=0,this.lc=new Nh,this.targetCount=0,this._c=Ca.vi()}function Sc(t){var e=this;return(e=nc.call(this)||this).cc=t,e}function Oc(){this.Mu=new ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.sc=!1}function kc(t,e){this.ti=t,this.Zu=e,this.docs=new Pi(ai.S),this.size=0}function Pc(t,e){this.ti=t,this.rr=e,this.Zs=[],this.Wu=1,this.Qu=new xi(Sh.Po)}function Lc(){}function Rc(t){return new Do(t,!0)}var Dc=(Uc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Iu=this.rh(e),this.persistence=this.oh(e),[4,this.persistence.start()];case 1:return t.sent(),this.uh=this.hh(e),this.io=this.ah(e),[2]}})})},Uc.prototype.hh=function(t){return null},Uc.prototype.ah=function(t){return e=this.persistence,n=new rc,t=t.lh,new xa(e,n,t);var e,n},Uc.prototype.oh=function(t){return new ac(cc.$c)},Uc.prototype.rh=function(t){return new kh},Uc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uh&&this.uh.stop(),[4,this.Iu.Xo()];case 1:return t.sent(),[4,this.persistence.Xo()];case 2:return t.sent(),[2]}})})},Uc),_c=(xc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.io?[3,2]:(this.io=n.io,this.Iu=n.Iu,this.ro=this._h(r),this.mu=this.fh(r),this.Tu=this.dh(r),this.wh=this.Eh(r,!n.synchronizeTabs),this.Iu.Hr=function(t){return Wh(e.wh,t,1)},this.mu.oo.mh=Jh.bind(null,this.wh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ho.delete(2),[4,uh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ho.add(2),[4,ah(e)]);case 3:t.sent(),e.fo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.mu,this.wh.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},xc.prototype.dh=function(t){return new oa},xc.prototype._h=function(t){var e=Rc(t.Kc._),n=(n=t.Kc,new pc(n));return t=t.credentials,new th(t,n,e)},xc.prototype.fh=function(t){var e=this,n=this.io,r=this.ro,i=t.ke,o=function(t){return Wh(e.wh,t,0)},t=new(dc.ih()?dc:yc);return new $a(n,r,i,o,t)},xc.prototype.Eh=function(t,e){return function(t,e,n,r,i,o,s){o=new Vh(t,e,n,r,i,o);return s&&(o.Du=!0),o}(this.io,this.mu,this.Tu,this.Iu,t.lh,t.Au,e)},xc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Pr("RemoteStore","RemoteStore shutting down."),e.ho.add(5),[4,ah(e)];case 1:return t.sent(),e.lo.Xo(),e.fo.set("Unknown"),[2]}})})}(this.mu)},xc),Vc=(Cc.prototype.next=function(t){this.observer.next&&this.Th(this.observer.next,t)},Cc.prototype.error=function(t){this.observer.error?this.Th(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Cc.prototype.Ih=function(){this.muted=!0},Cc.prototype.Th=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Cc);function Cc(t){this.observer=t,this.muted=!1}function xc(){}function Uc(){this.synchronizeTabs=!1}function Mc(t,e,n){if(!n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function qc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function jc(t,e,n,r){if(!0===e&&!0===r)throw new Ar(Tr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Fc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Bc(t,e){if(e<=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Gc,Wc,Hc=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ah=new ui(t)},zc=(n(Kc,Wc=Hc),Kc.documentId=function(){return new Kc(ui.K().q())},Kc.prototype.isEqual=function(t){return t instanceof Kc&&this.Ah.isEqual(t.Ah)},Kc),Xc=new RegExp("[~\\*/\\[\\]]"),$c=function(t){this.Rh=t},Qc=(n(Yc,Gc=$c),Yc.prototype.Ph=function(t){if(2!==t.yh)throw 1===t.yh?t.Vh(this.Rh+"() can only appear at the top level of your update data"):t.Vh(this.Rh+"() cannot be used with set() unless you pass {merge:true}");return t.Qn.push(t.path),null},Yc.prototype.isEqual=function(t){return t instanceof Yc},Yc);function Yc(){return null!==Gc&&Gc.apply(this,arguments)||this}function Kc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wc.call(this,t)||this}function Zc(t,e,n){return new El({yh:3,gh:e.settings.gh,methodName:t.Rh,ph:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Jc,tl,el,nl,rl=(n(wl,nl=$c),wl.prototype.Ph=function(t){return new ps(t.path,new Jo)},wl.prototype.isEqual=function(t){return t instanceof wl},wl),il=(n(ml,el=$c),ml.prototype.Ph=function(t){var e=Zc(this,t,!0),n=this.bh.map(function(t){return Pl(t,e)}),n=new ts(n);return new ps(t.path,n)},ml.prototype.isEqual=function(t){return this===t},ml),ol=(n(gl,tl=$c),gl.prototype.Ph=function(t){var e=Zc(this,t,!0),n=this.bh.map(function(t){return Pl(t,e)}),n=new os(n);return new ps(t.path,n)},gl.prototype.isEqual=function(t){return this===t},gl),sl=(n(vl,Jc=$c),vl.prototype.Ph=function(t){var e=new hs(t.serializer,Co(t.serializer,this.Ch));return new ps(t.path,e)},vl.prototype.isEqual=function(t){return this===t},vl),ul=(Object.defineProperty(yl.prototype,"latitude",{get:function(){return this.Sh},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"longitude",{get:function(){return this.Dh},enumerable:!1,configurable:!0}),yl.prototype.isEqual=function(t){return this.Sh===t.Sh&&this.Dh===t.Dh},yl.prototype.toJSON=function(){return{latitude:this.Sh,longitude:this.Dh}},yl.prototype.V=function(t){return Ur(this.Sh,t.Sh)||Ur(this.Dh,t.Dh)},yl),al=function(t){this.Fh=t},hl=/^__.*__$/,cl=function(t,e,n){this.Nh=t,this.xh=e,this.$h=n},ll=(dl.prototype.Oh=function(t,e){var n=[];return null!==this.Qn?n.push(new Os(t,this.data,this.Qn,e)):n.push(new Ss(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},dl),fl=(pl.prototype.Oh=function(t,e){e=[new Os(t,this.data,this.Qn,e)];return 0<this.fieldTransforms.length&&e.push(new Ds(t,this.fieldTransforms)),e},pl);function pl(t,e,n){this.data=t,this.Qn=e,this.fieldTransforms=n}function dl(t,e,n){this.data=t,this.Qn=e,this.fieldTransforms=n}function yl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Ar(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ar(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Sh=t,this.Dh=e}function vl(t,e){var n=this;return(n=Jc.call(this,t)||this).Ch=e,n}function gl(t,e){var n=this;return(n=tl.call(this,t)||this).bh=e,n}function ml(t,e){var n=this;return(n=el.call(this,t)||this).bh=e,n}function wl(){return null!==nl&&nl.apply(this,arguments)||this}function bl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var El=(Object.defineProperty(Al.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"yh",{get:function(){return this.settings.yh},enumerable:!1,configurable:!0}),Al.prototype.Mh=function(t){return new Al(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qn)},Al.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Mh({path:e,ph:!1});return e.qh(t),e},Al.prototype.Uh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Mh({path:t,ph:!1});return t.kh(),t},Al.prototype.Bh=function(t){return this.Mh({path:void 0,ph:!0})},Al.prototype.Vh=function(t){return Cl(t,this.settings.methodName,this.settings.jh||!1,this.path,this.settings.gh)},Al.prototype.contains=function(e){return void 0!==this.Qn.find(function(t){return e.k(t)})||void 0!==this.fieldTransforms.find(function(t){return e.k(t.field)})},Al.prototype.kh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qh(this.path.get(t))},Al.prototype.qh=function(t){if(0===t.length)throw this.Vh("Document fields must not be empty");if(bl(this.yh)&&hl.test(t))throw this.Vh('Document fields cannot begin and end with "__"')},Al),Il=(Tl.prototype.Wh=function(t,e,n,r){return void 0===r&&(r=!1),new El({yh:t,methodName:e,gh:n,path:ui.B(),ph:!1,jh:r},this._,this.serializer,this.ignoreUndefinedProperties)},Tl);function Tl(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Rc(t)}function Al(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.kh(),this.fieldTransforms=i||[],this.Qn=o||[]}function Nl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Wh(o.merge||o.mergeFields?2:0,e,n,i);Dl("Data must be an object, but it was:",s,r);var u,a,r=Ll(r,s);if(o.merge)u=new ds(s.Qn),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof Hc)p=f.Ah;else{if("string"!=typeof f)throw _r();p=Vl(e,f,n)}if(!s.contains(p))throw new Ar(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");xl(h,p)||h.push(p)}u=new ds(h),a=s.fieldTransforms.filter(function(t){return u.Yn(t.field)})}else u=null,a=s.fieldTransforms;return new ll(new qs(r),u,a)}function Sl(t,r,i,e){var o=t.Wh(1,r,i);Dl("Data must be an object, but it was:",o,e);var s=[],u=new js;Zr(e,function(t,e){var n=Vl(r,t,i),t=o.Uh(n);e instanceof Qc||e instanceof al&&e.Fh instanceof Qc?s.push(n):null!=(t=Pl(e,t))&&(s.push(n),u.set(n,t))});e=new ds(s);return new fl(u.Zn(),e,o.fieldTransforms)}function Ol(t,e,n,r,i,o){var s=t.Wh(1,e,n),u=[_l(e,r,n)],a=[i];if(o.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(_l(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new js,y=u.length-1;0<=y;--y){xl(p,u[y])||(c=u[y],l=a[y],f=s.Uh(c),l instanceof Qc||l instanceof al&&l.Fh instanceof Qc?p.push(c):null!=(f=Pl(l,f))&&(p.push(c),d.set(c,f)))}i=new ds(p);return new fl(d.Zn(),i,s.fieldTransforms)}function kl(t,e,n,r){return void 0===r&&(r=!1),Pl(n,t.Wh(r?4:3,e))}function Pl(s,t){if(s instanceof al&&(s=s.Fh),Rl(s))return Dl("Unsupported field value:",t,s),Ll(s,t);if(s instanceof $c)return function(t,e){if(!bl(e.yh))throw e.Vh(t.Rh+"() can only be used with update() and set()");if(!e.path)throw e.Vh(t.Rh+"() is not currently supported inside arrays");t=t.Ph(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qn.push(t.path),s instanceof Array){if(t.settings.ph&&4!==t.yh)throw t.Vh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Pl(i[r],t.Bh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ri.fromDate(t);return{timestampValue:xo(e.serializer,n)}}if(t instanceof ri){var r=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:xo(e.serializer,r)}}if(t instanceof ul)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fr)return{bytesValue:Uo(e.serializer,t.l)};if(t instanceof cl){n=e._,r=t.Nh;if(!r.isEqual(n))throw e.Vh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qo(t.Nh||e._,t.xh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Vh("Unsupported field value: "+Fc(t))}(s,t)}function Ll(t,n){var r={};return Jr(t)?n.path&&0<n.path.length&&n.Qn.push(n.path):Zr(t,function(t,e){e=Pl(e,n.Lh(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Rl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof ul||t instanceof Fr||t instanceof cl||t instanceof $c)}function Dl(t,e,n){if(!Rl(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Fc(n);throw"an object"===n?e.Vh(t+" a custom object"):e.Vh(t+" "+n)}var r}function _l(t,e,n){if(e instanceof Hc)return e.Ah;if("string"==typeof e)return Vl(t,e);throw Cl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Vl(t,e,n){try{return function(e){if(0<=e.search(Xc))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(zc.bind.apply(zc,i([void 0],e.split("."))))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ah}catch(e){throw Cl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Cl(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ar(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function xl(t,e){return t.some(function(t){return t.isEqual(e)})}var Ul=(Bl.prototype.zh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Yh(),0<this.mutations.length)throw new Ar(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Go((n=s).serializer)+"/documents",r={documents:u.map(function(t){return jo(n.serializer,t)})},[4,n.Gr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=Fo(t,e.found.name),t=Mo(e.found.updateTime),e=new qs({mapValue:{fields:e.found.fields}});return new $s(n,t,e,{})}(e,t):"missing"in t?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);t=Fo(t,e.missing),e=Mo(e.readTime);return new Qs(t,e)}(e,t):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Vr(!!t),o.push(t)}),o)]}})})}(this.ro,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Qs||t instanceof $s?n.Jh(t):_r()}),e)]}})})},Bl.prototype.set=function(t,e){this.write(e.Oh(t,this.Hn(t))),this.Hh.add(t.toString())},Bl.prototype.update=function(t,e){try{this.write(e.Oh(t,this.Xh(t)))}catch(t){this.Gh=t}this.Hh.add(t.toString())},Bl.prototype.delete=function(t){this.write([new Us(t,this.Hn(t))]),this.Hh.add(t.toString())},Bl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Yh(),this.Gh)throw this.Gh;return e=this.Qh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ai.H(e);n.mutations.push(new Ms(e,n.Hn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Go((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Ho(e.serializer,t)})},[4,e.Kr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ro,this.mutations)];case 1:return t.sent(),this.Kh=!0,[2]}})})},Bl.prototype.Jh=function(t){var e;if(t instanceof $s)e=t.version;else{if(!(t instanceof Qs))throw _r();e=ii.min()}var n=this.Qh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(Tr.ABORTED,"Document version changed between two reads.")}else this.Qh.set(t.key.toString(),e)},Bl.prototype.Hn=function(t){var e=this.Qh.get(t.toString());return!this.Hh.has(t.toString())&&e?gs.updateTime(e):gs.Jn()},Bl.prototype.Xh=function(t){var e=this.Qh.get(t.toString());if(this.Hh.has(t.toString())||!e)return gs.exists(!0);if(e.isEqual(ii.min()))throw new Ar(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},Bl.prototype.write=function(t){this.Yh(),this.mutations=this.mutations.concat(t)},Bl.prototype.Yh=function(){},Bl),Ml=(Fl.prototype.run=function(){this.ta()},Fl.prototype.ta=function(){var t=this;this.Xe.Pe(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ul(this.ro),(n=this.na(e))&&n.then(function(t){r.ke.We(function(){return e.commit().then(function(){r.qe.resolve(t)}).catch(function(t){r.ea(t)})})}).catch(function(t){r.ea(t)}),[2]})})})},Fl.prototype.na=function(t){try{var e=this.updateFunction(t);return!vi(e)&&e.catch&&e.then?e:(this.qe.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qe.reject(t),null}},Fl.prototype.ea=function(t){var e=this;0<this.Zh&&this.sa(t)?(--this.Zh,this.ke.We(function(){return e.ta(),Promise.resolve()})):this.qe.reject(t)},Fl.prototype.sa=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Oi(t)},Fl),ql=(jl.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.qs.promise];case 1:return[2,(t.sent(),{ke:this.ke,Kc:this.Kc,clientId:this.clientId,credentials:this.credentials,lh:this.user,Au:100})]}})})},jl.prototype.ra=function(t){var e=this;this.ia=t,this.qs.promise.then(function(){return e.ia(e.user)})},jl.prototype.oa=function(){if(this.ke.ts)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},jl.prototype.terminate=function(){var t=this;this.ke.rs();var n=new Xu;return this.ke.ns(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.ua?[4,this.ua.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ca?[4,this.ca.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.Ms(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ia(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},jl);function jl(t,e,n){var r=this;this.credentials=t,this.ke=e,this.Kc=n,this.user=la.UNAUTHENTICATED,this.clientId=Cr.t(),this.ia=function(){},this.qs=new Xu,this.credentials.ks(function(t){Pr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.ia(t)),r.qs.resolve()})}function Fl(t,e,n,r){this.ke=t,this.ro=e,this.updateFunction=n,this.qe=r,this.Zh=5,this.Xe=new $u(this.ke,"transaction_retry")}function Bl(t){this.ro=t,this.Qh=new Map,this.mutations=[],this.Kh=!1,this.Gh=null,this.Hh=new Set}function Gl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ca?[3,2]:(Pr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ke.hs(),Pr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ra(function(e){return r.ke.os(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Fa(i.io,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Vc(function(){return r.terminate()}),r.ca=i,[2]}})})}(e,new Dc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ca]}})})}function Wl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ua?[3,2]:(Pr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ke.hs(),[4,Gl(r)];case 1:return e=t.sent(),Pr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ra(function(t){return r.ke.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ke.hs(),Pr("RemoteStore","RemoteStore received new credentials"),n=yh(e),e.ho.add(3),[4,ah(e)];case 1:return t.sent(),n&&e.fo.set("Unknown"),[4,e.oo.mh(i)];case 2:return t.sent(),e.ho.delete(3),[4,uh(e)];case 3:return t.sent(),[2]}})})}(i.mu,t)})}),r.ua=i,[2]}})})}(e,new _c)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ua]}})})}function Hl(t){return Gl(t).then(function(t){return t.persistence})}function zl(t){return Gl(t).then(function(t){return t.io})}function Xl(t){return Wl(t).then(function(t){return t.mu})}function $l(t){return Wl(t).then(function(t){return t.wh})}function Ql(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Wl(r)];case 1:return e=t.sent(),[2,((n=e.Tu).Is=Fh.bind(null,e.wh),n.Ps=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Pu.get(o),1<(r=e.yu.get(n.targetId)).length?[2,(e.yu.set(n.targetId,r.filter(function(t){return!fu(t,o)})),void e.Pu.delete(o))]:e.Fu?(e.Iu.Qo(n.targetId),e.Iu.zo(n.targetId)?[3,2]:[4,Ha(e.io,n.targetId,!1).then(function(){e.Iu.Go(n.targetId),ch(e.mu,n.targetId),$h(e,n.targetId)}).catch(Xa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return $h(e,n.targetId),[4,Ha(e.io,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.wh),n)]}})})}function Yl(n,t,e,r){var i=this,o=new Vc(r),s=new ca(t,o,e);return n.ke.We(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ua,[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})}),function(){o.Ih(),n.ke.We(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=aa,[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})})}}function Kl(n,r){var t=this,i=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Bh,[4,$l(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Zl(n,t){var e=this,r=new Vc(t);return n.ke.We(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.add(e),e.next()},[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Ih(),n.ke.We(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.delete(e)},[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}function Jl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var tf=(hf.prototype._a=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.fa(t.timestampValue);case 4:return this.da(t);case 5:return t.stringValue;case 6:return this.la(To(t.bytesValue));case 7:return this.wa(t.referenceValue);case 8:return this.Ea(t.geoPointValue);case 9:return this.ma(t.arrayValue);case 10:return this.Ta(t.mapValue);default:throw _r()}},hf.prototype.Ta=function(t){var n=this,r={};return Zr(t.fields||{},function(t,e){r[t]=n._a(e)}),r},hf.prototype.Ea=function(t){return new ul(Io(t.latitude),Io(t.longitude))},hf.prototype.ma=function(t){var e=this;return(t.values||[]).map(function(t){return e._a(t)})},hf.prototype.da=function(t){switch(this.ha){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return lo(e)?t(e):e}(t);return null==e?null:this._a(e);case"estimate":return this.fa(fo(t));default:return null}},hf.prototype.fa=function(t){t=Eo(t);return new ri(t.seconds,t.nanos)},hf.prototype.wa=function(t){var e=oi.U(t);Vr(Qo(e));t=new $r(e.get(1),e.get(3)),e=new ai(e.F(5));return t.isEqual(this._)||Lr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.aa(e)},hf),ef=(af.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},af),nf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",rf=(uf.prototype.enableIndexedDbPersistence=function(t,e){throw new Ar(Tr.FAILED_PRECONDITION,nf)},uf.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Ar(Tr.FAILED_PRECONDITION,nf)},uf.prototype.clearIndexedDbPersistence=function(t){throw new Ar(Tr.FAILED_PRECONDITION,nf)},uf),of=(Object.defineProperty(sf.prototype,"va",{get:function(){return!!this.Pa},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"ba",{get:function(){return this.Ra.ts},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"Ca",{get:function(){return this.Sa||(this.Sa=new Il(this.Nh,this.pa.ignoreUndefinedProperties)),this.Sa},enumerable:!1,configurable:!0}),sf.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.pa),t)).merge;t=new ef(t);if(this.Pa&&!this.pa.isEqual(t))throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.pa=t).credentials&&(this.ga=function(t){if(!t)return new ya;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ma(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ar(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},sf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.pa.host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},sf.prototype.enableNetwork=function(){return cf(this),function(r){var t=this;return r.ke.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Hl(r)];case 1:return e=t.sent(),[4,Xl(r)];case 2:return n=t.sent(),[2,(e.gc(!0),(t=n).ho.delete(0),uh(t))]}})})})}(this.Pa)},sf.prototype.disableNetwork=function(){return cf(this),function(r){var t=this;return r.ke.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Hl(r)];case 1:return e=t.sent(),[4,Xl(r)];case 2:return n=t.sent(),[2,(e.gc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(0),[4,ah(e)];case 1:return t.sent(),e.fo.set("Offline"),[2]}})})}(n))]}})})})}(this.Pa)},sf.prototype.enablePersistence=function(t){if(this.Pa)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&jc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Ia.enableMultiTabIndexedDbPersistence(this):this.Ia.enableIndexedDbPersistence(this,n)},sf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.Ia.clearIndexedDbPersistence(this)]})})},sf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},sf.prototype.waitForPendingWrites=function(){return cf(this),function(n){var t=this,r=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Hh,[4,$l(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(this.Pa)},sf.prototype.onSnapshotsInSync=function(t){if(cf(this),Jl(t))return Zl(this.Pa,t);t={next:t};return Zl(this.Pa,t)},sf.ya=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ar(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Ar(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new $r(t)},Object.defineProperty(sf.prototype,"app",{get:function(){if(!this.Aa)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Aa},enumerable:!1,configurable:!0}),sf.prototype.collection=function(t){return Mc("Firestore.collection","path",t),cf(this),new _f(oi.U(t),this,null)},sf.prototype.doc=function(t){return Mc("Firestore.doc","path",t),cf(this),vf.Da(oi.U(t),this,null)},sf.prototype.collectionGroup=function(t){if(Mc("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return cf(this),new Rf((t=t,new Ks(oi.B(),t)),this,null)},sf.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Wl(n).then(function(t){return t.ro})];case 1:return e=t.sent(),new Ml(n.ke,e,r,i).run(),[2]}})})}),i.promise}(cf(this),function(t){return e(new df(n,t))})},sf.prototype.batch=function(){return cf(this),new yf(this)},sf.prototype.Fa=function(){return this.pa},sf);function sf(t,e,n){var r=this;if(void 0===n&&(n=new rf),this.Ia=n,this.Aa=null,this.Ra=new ea,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Pa||lf(this),[4,this.Pa.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){n=t;this.Aa=n,this.Nh=sf.ya(n),this.Va=n.name,this.ga=new va(e)}else{t=t;if(!t.projectId)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide projectId");this.Nh=new $r(t.projectId,t.database),this.Va="[DEFAULT]",this.ga=new ya}this.pa=new ef({})}function uf(){}function af(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ar(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,jc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function hf(t,e,n,r){this._=t,this.ha=e,this.aa=n,this.la=r}function cf(t){return t.Pa||lf(t),t.Pa.oa(),t.Pa}function lf(t){var e,n,r=t.Fa(),r=(e=t.Nh,n=t.Va,new Xr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Pa=new ql(t.ga,t.Ra,r)}var ff,pf,df=(Nf.prototype.get=function(t){var e=this,n=Uf(0,t,this.Na);return this.xa.zh([n.xh]).then(function(t){if(!t||1!==t.length)return _r();t=t[0];if(t instanceof Qs)return new mf(e.Na,n.xh,null,!1,!1,n.$h);if(t instanceof $s)return new mf(e.Na,n.xh,t,!1,!1,n.$h);throw _r()})},Nf.prototype.set=function(t,e,n){t=Uf(0,t,this.Na);n=qc("Transaction.set",n);e=Mf(t.$h,e,n),n=Nl(this.Na.Ca,"Transaction.set",t.xh,e,null!==t.$h,n);return this.xa.set(t.xh,n),this},Nf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof zc?(r=Uf(0,t,this.Na),Ol(this.Na.Ca,"Transaction.update",r.xh,e,n,i)):(r=Uf(0,t,this.Na),Sl(this.Na.Ca,"Transaction.update",r.xh,e)),this.xa.update(r.xh,e),this},Nf.prototype.delete=function(t){t=Uf(0,t,this.Na);return this.xa.delete(t.xh),this},Nf),yf=(Af.prototype.set=function(t,e,n){this.ka();t=Uf(0,t,this.Na);n=qc("WriteBatch.set",n);e=Mf(t.$h,e,n),n=Nl(this.Na.Ca,"WriteBatch.set",t.xh,e,null!==t.$h,n);return this.$a=this.$a.concat(n.Oh(t.xh,gs.Jn())),this},Af.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ka(),e="string"==typeof e||e instanceof zc?(r=Uf(0,t,this.Na),Ol(this.Na.Ca,"WriteBatch.update",r.xh,e,n,i)):(r=Uf(0,t,this.Na),Sl(this.Na.Ca,"WriteBatch.update",r.xh,e)),this.$a=this.$a.concat(e.Oh(r.xh,gs.exists(!0))),this},Af.prototype.delete=function(t){this.ka();t=Uf(0,t,this.Na);return this.$a=this.$a.concat(new Us(t.xh,gs.Jn())),this},Af.prototype.commit=function(){return this.ka(),this.Oa=!0,0<this.$a.length?Kl(cf(this.Na),this.$a):Promise.resolve()},Af.prototype.ka=function(){if(this.Oa)throw new Ar(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Af),vf=(n(Tf,pf=cl),Tf.Da=function(t,e,n){if(t.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.q()+" has "+t.length);return new Tf(new ai(t),e,n)},Object.defineProperty(Tf.prototype,"id",{get:function(){return this.xh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"parent",{get:function(){return new _f(this.xh.path.N(),this.firestore,this.$h)},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"path",{get:function(){return this.xh.path.q()},enumerable:!1,configurable:!0}),Tf.prototype.collection=function(t){if(Mc("DocumentReference.collection","path",t),!t)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=oi.U(t);return new _f(this.xh.path.child(t),this.firestore,null)},Tf.prototype.isEqual=function(t){return t instanceof Tf&&this.firestore===t.firestore&&this.xh.isEqual(t.xh)&&this.$h===t.$h},Tf.prototype.set=function(t,e){e=qc("DocumentReference.set",e);t=Mf(this.$h,t,e),e=Nl(this.firestore.Ca,"DocumentReference.set",this.xh,t,null!==this.$h,e);return Kl(this.Pa,e.Oh(this.xh,gs.Jn()))},Tf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof zc?Ol(this.firestore.Ca,"DocumentReference.update",this.xh,t,e,n):Sl(this.firestore.Ca,"DocumentReference.update",this.xh,t),Kl(this.Pa,t.Oh(this.xh,gs.exists(!0)))},Tf.prototype.delete=function(){return Kl(this.Pa,[new Us(this.xh,gs.Jn())])},Tf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Jl(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};Jl(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.Ma(t))},error:n[i+1],complete:n[i+2]};return Yl(this.Pa,eu(this.xh.path),o,s)},Tf.prototype.get=function(t){var e=this;return t&&"cache"===t.source?function(n,r){var t=this,i=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Mi.ni(t,e)}))];case 1:return(r=t.sent())instanceof $s?s.resolve(r):r instanceof Qs?s.resolve(null):s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=ia(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,zl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(this.Pa,this.xh).then(function(t){return new mf(e.firestore,e.xh,t,!0,t instanceof $s&&t.Xn,e.$h)}):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Vc({next:function(t){r.We(function(){return aa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ar(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ca(eu(i.path),t,{includeMetadataChanges:!0,Cs:!0});return ua(n,u)},[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ke,r,i,o])]}})})}),o.promise}(this.Pa,this.xh,t).then(function(t){return e.Ma(t)})},Tf.prototype.withConverter=function(t){return new Tf(this.xh,this.firestore,t)},Tf.prototype.Ma=function(t){var e=t.docs.get(this.xh);return new mf(this.firestore,this.xh,e,t.fromCache,t.hasPendingWrites,this.$h)},Tf),gf=(If.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},If),mf=(Ef.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.La){if(this.$h){var n=new wf(this.Na,this.xh,this.La,this.qa,this.Ua,null);return this.$h.fromFirestore(n,t)}return new tf(this.Na.Nh,t.serverTimestamps||"none",function(t){return new vf(t,e.Na,null)},function(t){return new zr(t)})._a(this.La.re())}},Ef.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.La){t=this.La.data().field(_l("DocumentSnapshot.get",t,this.xh));if(null!==t)return new tf(this.Na.Nh,e.serverTimestamps||"none",function(t){return new vf(t,n.Na,n.$h)},function(t){return new zr(t)})._a(t)}},Object.defineProperty(Ef.prototype,"id",{get:function(){return this.xh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"ref",{get:function(){return new vf(this.xh,this.Na,this.$h)},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"exists",{get:function(){return null!==this.La},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"metadata",{get:function(){return new gf(this.Ua,this.qa)},enumerable:!1,configurable:!0}),Ef.prototype.isEqual=function(t){return t instanceof Ef&&this.Na===t.Na&&this.qa===t.qa&&this.xh.isEqual(t.xh)&&(null===this.La?null===t.La:this.La.isEqual(t.La))&&this.$h===t.$h},Ef),wf=(n(bf,ff=mf),bf.prototype.data=function(t){return ff.prototype.data.call(this,t)},bf);function bf(){return null!==ff&&ff.apply(this,arguments)||this}function Ef(t,e,n,r,i,o){this.Na=t,this.xh=e,this.La=n,this.qa=r,this.Ua=i,this.$h=o}function If(t,e){this.hasPendingWrites=t,this.fromCache=e}function Tf(t,e,n){var r=this;return(r=pf.call(this,e.Nh,t,n)||this).xh=t,r.firestore=e,r.$h=n,r.Pa=cf(e),r}function Af(t){this.Na=t,this.$a=[],this.Oa=!1}function Nf(t,e){this.Na=t,this.xa=e}function Sf(t,e,n){if("string"==typeof n){if(""===n)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!su(e)&&-1!==n.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(oi.U(n));if(!ai.X(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ao(t,new ai(e))}if(n instanceof cl)return Ao(t,n.xh);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Fc(n)+".")}function Of(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function kf(t,e,n){if(!n.isEqual(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Pf(t){if(ru(t)&&0===t.oe.length)throw new Ar(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Lf,Rf=(xf.prototype.where=function(t,e,n){t=_l("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Of(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(Sf(n,t,h))}c={arrayValue:{values:s}}}else c=Sf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Of(o,i),c=kl(e,"Query.where",o,"in"===i||"not-in"===i);var c=mu.create(r,i,c);return function(t,e){if(e.ae()){var n=ou(t);if(null!==n&&!n.isEqual(e.field))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=iu(t);null!==n&&kf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.Ba,this.firestore.Ca,this.firestore.Nh,t,e,n);return new xf((n=this.Ba,e=n.filters.concat([e]),new Ks(n.path,n.collectionGroup,n.oe.slice(),e,n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.$h)},xf.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=_l("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new zu(e,n);return n=e,null!==iu(t)||null!==(t=ou(t))&&kf(0,t,n.field),e}(this.Ba,t,n);return new xf((n=this.Ba,t=n.oe.concat([t]),new Ks(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.$h)},xf.prototype.limit=function(t){return Bc("Query.limit",t),new xf(hu(this.Ba,t,"F"),this.firestore,this.$h)},xf.prototype.limitToLast=function(t){return Bc("Query.limitToLast",t),new xf(hu(this.Ba,t,"L"),this.firestore,this.$h)},xf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ja("Query.startAt",t,e,!0);return new xf(cu(this.Ba,t),this.firestore,this.$h)},xf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ja("Query.startAfter",t,e,!1);return new xf(cu(this.Ba,t),this.firestore,this.$h)},xf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ja("Query.endBefore",t,e,!0);return new xf(lu(this.Ba,t),this.firestore,this.$h)},xf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.ja("Query.endAt",t,e,!1);return new xf(lu(this.Ba,t),this.firestore,this.$h)},xf.prototype.isEqual=function(t){return t instanceof xf&&this.firestore===t.firestore&&fu(this.Ba,t.Ba)&&this.$h===t.$h},xf.prototype.withConverter=function(t){return new xf(this.Ba,this.firestore,t)},xf.prototype.ja=function(h,t,e,n){if(t instanceof mf)return function(t,e,n,r){if(!n)throw new Ar(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=uu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new Ar(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.q();throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Mu(i,r)}(this.Ba,this.firestore.Nh,t.La,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.oe;if(i.length>s.length)throw new Ar(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.W()){if("string"!=typeof h)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!su(t)&&-1!==h.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(oi.U(h));if(!ai.X(c))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ai(c);u.push(Ao(e,c))}else{h=kl(n,r,h);u.push(h)}}return new Mu(u,o)}(this.Ba,this.firestore.Nh,this.firestore.Ca,h,e,n)},xf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||Jl(n[o])||(i=n[o],o++),Jl(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Df(e.firestore,e.Ba,t,e.$h))},error:n[o+1],complete:n[o+2]};return Pf(this.Ba),Yl(cf(this.firestore),this.Ba,i,s)},xf.prototype.get=function(t){var e=this;Pf(this.Ba);var n=cf(this.firestore);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,za(r,i,!0)];case 1:return n=t.sent(),e=new Rh(i,n.lr),n=e.ru(n.documents),n=e.hu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=ia(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,zl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.Ba):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Xu;return n.ke.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Vc({next:function(t){n.We(function(){return aa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ar(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ca(t,o,{includeMetadataChanges:!0,Cs:!0});return ua(e,s)},[4,Ql(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ke,r,i,o])]}})})}),o.promise}(n,this.Ba,t)).then(function(t){return new Df(e.firestore,e.Ba,t,e.$h)})},xf),Df=(Object.defineProperty(Cf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"empty",{get:function(){return this.Qa.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"size",{get:function(){return this.Qa.docs.size},enumerable:!1,configurable:!0}),Cf.prototype.forEach=function(e,n){var r=this;this.Qa.docs.forEach(function(t){e.call(n,r.Ha(t,r.metadata.fromCache,r.Qa.Wt.has(t.key)))})},Object.defineProperty(Cf.prototype,"query",{get:function(){return new Rf(this.Wa,this.Na,this.$h)},enumerable:!1,configurable:!0}),Cf.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.Qa.Kt)throw new Ar(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ka&&this.Ga===t||(this.Ka=function(i,e,o){if(i.jt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.jt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Qa,t,this.Ha.bind(this)),this.Ga=t),this.Ka},Cf.prototype.isEqual=function(t){return t instanceof Cf&&this.Na===t.Na&&fu(this.Wa,t.Wa)&&this.Qa.isEqual(t.Qa)&&this.$h===t.$h},Cf.prototype.Ha=function(t,e,n){return new wf(this.Na,t.key,t,e,n,this.$h)},Cf),_f=(n(Vf,Lf=Rf),Object.defineProperty(Vf.prototype,"id",{get:function(){return this.Ba.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"parent",{get:function(){var t=this.Ba.path.N();return t.P()?null:new vf(new ai(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"path",{get:function(){return this.Ba.path.q()},enumerable:!1,configurable:!0}),Vf.prototype.doc=function(t){0===arguments.length&&(t=Cr.t()),Mc("CollectionReference.doc","path",t);t=oi.U(t);return vf.Da(this.Ba.path.child(t),this.firestore,this.$h)},Vf.prototype.add=function(t){var t=this.$h?this.$h.toFirestore(t):t,e=this.doc();return new vf(e.xh,this.firestore,null).set(t).then(function(){return e})},Vf.prototype.withConverter=function(t){return new Vf(this.za,this.firestore,t)},Vf);function Vf(t,e,n){var r=this;if(((r=Lf.call(this,eu(t),e,n)||this).za=t).length%2!=1)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.q()+" has "+t.length);return r}function Cf(t,e,n,r){this.Na=t,this.Wa=e,this.Qa=n,this.$h=r,this.Ka=null,this.Ga=null,this.metadata=new gf(n.hasPendingWrites,n.fromCache)}function xf(t,e,n){this.Ba=t,this.firestore=e,this.$h=n}function Uf(t,e,n){e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new Ar(Tr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Fc(t);throw new Ar(Tr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,vf);if(e.firestore!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Mf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var qf,jf,l=(n(Bf,qf=al),Bf.serverTimestamp=function(){var t=new rl("serverTimestamp");return t.Rh="FieldValue.serverTimestamp",new Bf(t)},Bf.delete=function(){var t=new Qc("deleteField");return t.Rh="FieldValue.delete",new Bf(t)},Bf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new il("arrayUnion",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayUnion",new Bf(n)},Bf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ol("arrayRemove",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayRemove",new Bf(n)},Bf.increment=function(t){t=new sl("increment",t);return t.Rh="FieldValue.increment",new Bf(t)},Bf.prototype.isEqual=function(t){return this.Fh.isEqual(t.Fh)},Bf),Ff={Firestore:of,GeoPoint:ul,Timestamp:ri,Blob:zr,Transaction:df,WriteBatch:yf,DocumentReference:vf,DocumentSnapshot:mf,Query:Rf,QueryDocumentSnapshot:wf,QuerySnapshot:Df,CollectionReference:_f,FieldPath:zc,FieldValue:l,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Bf(){return null!==qf&&qf.apply(this,arguments)||this}(jf=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new of(e,t,new rf);var e},"PUBLIC").setServiceProps(Object.assign({},Ff))),jf.registerVersion("@firebase/firestore","2.0.1-2020103231751")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
