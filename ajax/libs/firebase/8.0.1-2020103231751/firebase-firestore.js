!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(_y){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(_y),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=l=l||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Te={})[l.DEBUG]="log",Te[l.VERBOSE]="log",Te[l.INFO]="info",Te[l.WARN]="warn",Te[l.ERROR]="error",Te),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D={},S=N||self;function O(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),R=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:V).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++R))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var rt,it=Y(W,"Opera"),ot=Y(W,"Trident")||Y(W,"MSIE"),st=Y(W,"Edge"),ut=st||ot,at=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=W,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var It={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),xt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Ut(t);if(c||(t[Ot]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):At(t)))}function Rt(t){return t in xt?xt[t]:xt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function Ut(t){return(t=t[Ot])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==x(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=qt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=S.JSON.stringify;function zt(){this.b=this.a=null}var Kt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Qt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then($t)}),Xt||(Kt(),Xt=!0),Jt.add(t,e)}zt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new zt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=U(this.Xa,this),this.g=q()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==x(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Zt,Ft),(A=Zt.prototype).aa=!1,A.M=null,A.Xa=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(te(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},A.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(T(re=ue,ie=ne=j),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){j.call(this),this.b=t,this.a={}}F(ae,j);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de=null;function ye(){return de=de||new Ft}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();jt(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();jt(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function Ie(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(ve,wt),F(me,wt),F(be,wt);var Ee={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Te={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function _e(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}_e.prototype.a=null;var De,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Se(){wt.call(this,"d")}function Oe(){wt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(Se,wt),F(Oe,wt),F(xe,_e),De=new xe;var Pe=45e3,Le={},Re={};function Ce(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=q(),Me(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(U(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?Le:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Le){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),je(t))}function Me(t){t.T=q()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ta,t),e)}function Fe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ie(U(u.Qa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(_n(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=q()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Va=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),je(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),je(this)}}}catch(t){}var u,a,c,h,f,l},A.Ua=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Ta=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,je(this)):qe(this,this.T-n)},(A=Ke.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return We(this.b,t)?this.b[t]:e},A.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),K(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(){}function Sn(){this.a=new Dn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function kn(t){Ft.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}F(kn,Ft);var Pn="",Ln=/^https?$/i,Rn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),qn(t)}function Un(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Mn(t){if(t.b&&void 0!==D&&(!t.s[1]||4!=jn(t)||2!=t.W()))if(t.l&&4==jn(t))ee(t.za,0,t);else if(jt(t,"readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Ln.test(i?i.toLowerCase():"")),e=n),e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Pa=Gn("retryDelaySeedMs",1e4,t),this.Ka=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=q(),Me(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Wn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){In(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ce(n,r,e)}function Jn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;P(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ie(U(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,jt(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ie(U(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=M(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(On,o,i,"TestLoadImage: error",!1,r),i.onabort=M(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(On,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Wn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.La)).F=t.C,e}function hr(){}function fr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Oe.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(De),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==D&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),qn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Sa())},A.Sa=function(){Mn(this)},A.W=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),_n(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||In(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Ra,this),t))},A.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},A.Qa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},A.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=Gt(t),Qn(this.a,e)):Qn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},F(pr,Se),F(dr,Oe),F(yr,hr),yr.prototype.ta=function(){jt(this.a,"a")},yr.prototype.sa=function(t){jt(this.a,new pr(t))},yr.prototype.ra=function(t){jt(this.a,new dr)},yr.prototype.qa=function(){jt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Oa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Na,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=Ee,gr=Te,mr=Ne,wr=kn,br=(Ir.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ir.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ir.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ir);function Ir(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Dr,Er=Error),Dr),Ar="8.0.1-2020103231751",Nr=new h("@firebase/firestore");function Dr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Nr.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.DEBUG&&(e=n.map(Pr),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.ERROR&&(e=n.map(Pr),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.WARN&&(e=n.map(Pr),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t;throw xr(t),new Error(t)}function Rr(t){t||Lr()}var Cr=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function qr(t){return t+"\0"}var Fr=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.u=function(t){return Ur(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}Fr.h=new Fr("");var Br=(Gr.fromBase64String=function(t){try{return new Gr(Fr.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Gr.fromUint8Array=function(t){return new Gr(Fr.fromUint8Array(t))},Gr.prototype.toBase64=function(){return this.l.toBase64()},Gr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Gr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Gr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Gr);function Gr(t){this.l=t}function zr(){if("undefined"==typeof Uint8Array)throw new _r(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kr(){if("undefined"==typeof atob)throw new _r(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hr,Wr=(n(Jr,Hr=Br),Jr.fromBase64String=function(t){Kr();try{return new Jr(Fr.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Jr.fromUint8Array=function(t){return zr(),new Jr(Fr.fromUint8Array(t))},Jr.prototype.toBase64=function(){return Kr(),Hr.prototype.toBase64.call(this)},Jr.prototype.toUint8Array=function(){return zr(),Hr.prototype.toUint8Array.call(this)},Jr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Jr),Qr=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},Yr=(Object.defineProperty(Xr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Xr.prototype.isEqual=function(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database},Xr.prototype.u=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},Xr);function Xr(t,e){this.projectId=t,this.database=e||"(default)"}function Jr(){return null!==Hr&&Hr.apply(this,arguments)||this}function $r(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ti(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ei,ni,ri=(vi.prototype.get=function(t){var e=this.m(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},vi.prototype.has=function(t){return void 0!==this.get(t)},vi.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},vi.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},vi.prototype.forEach=function(s){Zr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},vi.prototype.P=function(){return ti(this.R)},vi),ii=(yi.now=function(){return yi.fromMillis(Date.now())},yi.fromDate=function(t){return yi.fromMillis(t.getTime())},yi.fromMillis=function(t){var e=Math.floor(t/1e3);return new yi(e,1e6*(t-1e3*e))},yi.prototype.toDate=function(){return new Date(this.toMillis())},yi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},yi.prototype.g=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},yi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},yi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},yi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},yi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},yi),oi=(di.V=function(t){return new di(t)},di.min=function(){return new di(new ii(0,0))},di.prototype.u=function(t){return this.timestamp.g(t.timestamp)},di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},di.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},di.prototype.v=function(){return this.timestamp},di),Ee=(Object.defineProperty(pi.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),pi.prototype.isEqual=function(t){return 0===pi.D(this,t)},pi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof pi?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},pi.prototype.limit=function(){return this.offset+this.length},pi.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},pi.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},pi.prototype.O=function(){return this.segments[this.offset]},pi.prototype.k=function(){return this.get(this.length-1)},pi.prototype.get=function(t){return this.segments[this.offset+t]},pi.prototype.P=function(){return 0===this.length},pi.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},pi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},pi.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},pi),si=(n(li,ni=Ee),li.prototype.C=function(t,e,n){return new li(t,e,n)},li.prototype.B=function(){return this.L().join("/")},li.prototype.toString=function(){return this.B()},li.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new li(n)},li.U=function(){return new li([])},li),ui=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ai=(n(fi,ei=Ee),fi.prototype.C=function(t,e,n){return new fi(t,e,n)},fi.K=function(t){return ui.test(t)},fi.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),fi.K(t)||(t="`"+t+"`"),t}).join(".")},fi.prototype.toString=function(){return this.B()},fi.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},fi.j=function(){return new fi(["__name__"])},fi.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new fi(e)},fi.U=function(){return new fi([])},fi),ci=(hi.H=function(t){return new hi(si.q(t))},hi.Y=function(t){return new hi(si.q(t).N(5))},hi.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},hi.prototype.isEqual=function(t){return null!==t&&0===si.D(this.path,t.path)},hi.prototype.toString=function(){return this.path.toString()},hi.D=function(t,e){return si.D(t.path,e.path)},hi.X=function(t){return t.length%2==0},hi.Z=function(t){return new hi(new si(t.slice()))},hi);function hi(t){this.path=t}function fi(){return null!==ei&&ei.apply(this,arguments)||this}function li(){return null!==ni&&ni.apply(this,arguments)||this}function pi(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.S=n}function di(t){this.timestamp=t}function yi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function vi(t,e){this.m=t,this.A=e,this.R={}}function gi(t){return null==t}function mi(t){return 0===t&&1/t==-1/0}function wi(t){return"number"==typeof t&&Number.isInteger(t)&&!mi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Ii(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new bi(t,e,n,r,i,o,s)}function Ei(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.B()+t.op.toString()+Eo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.B()+t.dir}).join(","),gi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ea(e.startAt)),e.endAt&&(t+="|ub:",t+=ea(e.endAt)),e.tt=t),e.tt}function Ti(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ra(t.startAt,e.startAt)&&ra(t.endAt,e.endAt)}function _i(t){return ci.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ai(t){this.count=t}var Ni,Di=(Si.prototype.st=function(t){return new Si(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Si.prototype.it=function(t,e){return new Si(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Si.prototype.rt=function(t){return new Si(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Si);function Si(t,e,n,r,i,o,s){void 0===i&&(i=oi.min()),void 0===o&&(o=oi.min()),void 0===s&&(s=Fr.h),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Oi(t){switch(t){case Tr.OK:return Lr(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return Lr(),0}}function xi(t){if(void 0===t)return xr("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Ni.OK:return Tr.OK;case Ni.CANCELLED:return Tr.CANCELLED;case Ni.UNKNOWN:return Tr.UNKNOWN;case Ni.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Ni.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Ni.INTERNAL:return Tr.INTERNAL;case Ni.UNAVAILABLE:return Tr.UNAVAILABLE;case Ni.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Ni.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Ni.NOT_FOUND:return Tr.NOT_FOUND;case Ni.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Ni.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Ni.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Ni.ABORTED:return Tr.ABORTED;case Ni.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Ni.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Ni.DATA_LOSS:return Tr.DATA_LOSS;default:return Lr()}}(Te=Ni=Ni||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var ki=(Vi.prototype.ot=function(t,e){return new Vi(this.D,this.root.ot(t,e,this.D).copy(null,null,Li.at,null,null))},Vi.prototype.remove=function(t){return new Vi(this.D,this.root.remove(t,this.D).copy(null,null,Li.at,null,null))},Vi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vi.prototype.P=function(){return this.root.P()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vi.prototype.ct=function(){return this.root.ct()},Vi.prototype.ut=function(){return this.root.ut()},Vi.prototype.ht=function(t){return this.root.ht(t)},Vi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Vi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vi.prototype.lt=function(t){return this.root.lt(t)},Vi.prototype._t=function(){return new Pi(this.root,null,this.D,!1)},Vi.prototype.ft=function(t){return new Pi(this.root,t,this.D,!1)},Vi.prototype.dt=function(){return new Pi(this.root,null,this.D,!0)},Vi.prototype.wt=function(t){return new Pi(this.root,t,this.D,!0)},Vi),Pi=(Ci.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Ci.prototype.At=function(){return 0<this.Tt.length},Ci.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ci),Li=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype.P=function(){return!1},Ri.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ri.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ri.prototype.min=function(){return this.left.P()?this:this.left.min()},Ri.prototype.ct=function(){return this.min().key},Ri.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},Ri.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Ri.prototype.gt=function(){if(this.left.P())return Ri.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.yt()||r.left.left.yt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.bt()),r.right.P()||r.right.yt()||r.right.left.yt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Ri.prototype.yt=function(){return this.color},Ri.prototype.Pt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},Ri.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Ri.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},Ri.prototype.St=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.bt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Ri.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw Lr();if(this.right.yt())throw Lr();var t=this.left.Nt();if(t!==this.right.Nt())throw Lr();return t+(this.yt()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Vi(t,e){this.D=t,this.root=e||Li.EMPTY}function Ui(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.at=!1,Li.EMPTY=(Object.defineProperty(Ui.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Ui.prototype.copy=function(t,e,n,r,i){return this},Ui.prototype.ot=function(t,e,n){return new Li(t,e)},Ui.prototype.remove=function(t,e){return this},Ui.prototype.P=function(){return!0},Ui.prototype.ht=function(t){return!1},Ui.prototype.lt=function(t){return!1},Ui.prototype.ct=function(){return null},Ui.prototype.ut=function(){return null},Ui.prototype.yt=function(){return!1},Ui.prototype.Ct=function(){return!0},Ui.prototype.Nt=function(){return 0},new Ui);var Mi=(Bi.prototype.has=function(t){return null!==this.data.get(t)},Bi.prototype.first=function(){return this.data.ct()},Bi.prototype.last=function(){return this.data.ut()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Bi.prototype.indexOf=function(t){return this.data.indexOf(t)},Bi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Bi.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},Bi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},Bi.prototype.Ot=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},Bi.prototype._t=function(){return new qi(this.data._t())},Bi.prototype.ft=function(t){return new qi(this.data.ft(t))},Bi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},Bi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Bi.prototype.P=function(){return this.data.P()},Bi.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Bi.prototype.isEqual=function(t){if(!(t instanceof Bi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},Bi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Bi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Bi.prototype.copy=function(t){var e=new Bi(this.D);return e.data=t,e},Bi),qi=(ji.prototype.It=function(){return this.Mt.It().key},ji.prototype.At=function(){return this.Mt.At()},ji),Fi=new ki(ci.D);function ji(t){this.Mt=t}function Bi(t){this.D=t,this.data=new ki(this.D)}var Gi=new ki(ci.D);var zi=new ki(ci.D),Ki=new Mi(ci.D);function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ki,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Mi(Ur);var Qi=(ho.Bt=function(t){return new ho(t.D)},ho.prototype.has=function(t){return null!=this.$t.get(t)},ho.prototype.get=function(t){return this.$t.get(t)},ho.prototype.first=function(){return this.Lt.ct()},ho.prototype.last=function(){return this.Lt.ut()},ho.prototype.P=function(){return this.Lt.P()},ho.prototype.indexOf=function(t){t=this.$t.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.D=this.D,n.$t=t,n.Lt=e,n},ho),Yi=(co.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Lr()},co.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},co),Xi=(ao.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Qi.Bt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&_u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),Ji=(uo.Xt=function(t,e){var n=new Map;return n.set(t,$i.Zt(t,e)),new uo(oi.min(),n,Wi,Fi,Hi())},uo),$i=(so.Zt=function(t,e){return new so(Fr.h,e,Hi(),Hi(),Hi())},so),Zi=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},to=function(t,e){this.targetId=t,this.oe=e},eo=function(t,e,n,r){void 0===n&&(n=Fr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},no=(Object.defineProperty(oo.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),oo.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ue=t)},oo.prototype.we=function(){var n=Hi(),r=Hi(),i=Hi();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new $i(this.ue,this.he,n,r,i)},oo.prototype.Ee=function(){this.le=!1,this.ce=lo()},oo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},oo.prototype.Ie=function(t){this.le=!0,this.ce=this.ce.remove(t)},oo.prototype.me=function(){this.ae+=1},oo.prototype.Ae=function(){--this.ae},oo.prototype.Re=function(){this.le=!0,this.he=!0},oo),ro=(io.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof ou?this.ve(r,t.re):t.re instanceof su&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},io.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:Lr()}})},io.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},io.prototype.Oe=function(t){var e=t.targetId,n=t.oe.count,t=this.ke(e);t&&(_i(t=t.target)?0===n?(t=new ci(t.path),this.Se(e,t,new su(t,oi.min()))):Rr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},io.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&_i(n.target)&&(n=new ci(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Se(e,n,new su(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Hi();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.ke(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Ji(r,o,this.pe,this.ye,s);return this.ye=Fi,this.Ve=fo(),this.pe=new Mi(Ur),t},io.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t)))},io.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},io.prototype.removeTarget=function(t){this.ge.delete(t)},io.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},io.prototype.me=function(t){this.Ne(t).me()},io.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new no,this.ge.set(t,e)),e},io.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new Mi(Ur),this.Ve=this.Ve.ot(t,e)),e},io.prototype.xe=function(t){var e=null!==this.ke(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.ke=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},io.prototype.Fe=function(e){var n=this;this.ge.set(e,new no),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},io.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},io);function io(t){this.Pe=t,this.ge=new Map,this.ye=Fi,this.Ve=fo(),this.pe=new Mi(Ur)}function oo(){this.ae=0,this.ce=lo(),this.ue=Fr.h,this.he=!1,this.le=!0}function so(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function uo(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function co(){this.qt=new ki(ci.D)}function ho(n){this.D=n?function(t,e){return n(t,e)||ci.D(t.key,e.key)}:function(t,e){return ci.D(t.key,e.key)},this.$t=Gi,this.Lt=new ki(this.D)}function fo(){return new ki(ci.D)}function lo(){return new ki(ci.D)}function po(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function yo(t){t=To(t.mapValue.fields.__local_write_time__.timestampValue);return new ii(t.seconds,t.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Lr()}function mo(r,i){var t,e=go(r);if(e!==go(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yo(r).isEqual(yo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),t=To(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Ao(r.bytesValue).isEqual(Ao(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,_o((t=r).geoPointValue.latitude)===_o(e.geoPointValue.latitude)&&_o(t.geoPointValue.longitude)===_o(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return _o(t.integerValue)===_o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=_o(t.doubleValue),e=_o(e.doubleValue);return t===e?mi(t)===mi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],mo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if($r(e)!==$r(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!mo(e[t],n[t])))return!1;return!0}();default:return Lr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i=go(t),o=go(e);if(i!==o)return Ur(i,o);switch(i){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return n=e,r=_o(t.integerValue||t.doubleValue),n=_o(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(yo(t),yo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return function(t,e){t=Ao(t),e=Ao(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Ur(_o(i.latitude),_o(r.latitude)))?n:Ur(_o(i.longitude),_o(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;u=bo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=To(t),t=To(e),e=Ur(n.seconds,t.seconds);return 0!==e?e:Ur(n.nanos,t.nanos)}function Eo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=To(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ao(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ci.Y(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Lr();var e}(t)}function To(t){if(Rr(!!t),"string"!=typeof t)return{seconds:_o(t.seconds),nanos:_o(t.nanos)};var e=0,n=vo.exec(t);Rr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function _o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Fr.fromBase64String(t):Fr.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Do(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Oo(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ko(t){return t&&"mapValue"in t}var Po={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this._=t,this.Ke=e};function Co(t){return{integerValue:""+t}}function Vo(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mi(e)?"-0":e}}function Uo(t,e){return wi(e)?Co(e):Vo(t,e)}function Mo(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Fo(t){return Rr(!!t),oi.V((t=To(t),new ii(t.seconds,t.nanos)))}function jo(t,e){return new si(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function Bo(t){t=si.q(t);return Rr(ss(t)),t}function Go(t,e){return jo(t._,e.path)}function zo(t,e){e=Bo(e);return Rr(e.get(1)===t._.projectId),Rr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ci(Qo(e))}function Ko(t,e){return jo(t._,e)}function Ho(t){t=Bo(t);return 4===t.length?si.U():Qo(t)}function Wo(t){return new si(["projects",t._.projectId,"databases",t._.database]).B()}function Qo(t){return Rr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Yo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Xo(t,e){var n,r,i;if(e instanceof Us)n={update:Yo(t,e.key,e.value)};else if(e instanceof Qs)n={delete:Go(t,e.key)};else if(e instanceof Ms)n={update:Yo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof fs)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof vs)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.B(),increment:e.We};throw Lr()})}};else{if(!(e instanceof Ys))return Lr();n={verify:Go(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,Mo(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:Lr()),n}function Jo(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ss.updateTime(Fo(o.updateTime)):void 0!==o.exists?Ss.exists(o.exists):Ss.ze():Ss.ze();if(t.update){t.update.name;var r=zo(e,t.update.name),i=new Xs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new _s(o.map(function(t){return ai.G(t)})));return new Ms(r,i,o,n)}return new Us(r,i,n)}if(t.delete){var s=zo(e,t.delete);return new Qs(s,n)}if(t.transform){i=zo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Rr("REQUEST_TIME"===e.setToServerValue),r=new hs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new fs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new vs(n)):"increment"in e?r=new bs(t,e.increment):Lr();e=ai.G(e.fieldPath);return new As(e,r)}(e,t)});return Rr(!0===n.exists),new Gs(i,s)}if(t.verify){t=zo(e,t.verify);return new Ys(t,n)}return Lr()}function $o(t,e){return{documents:[Ko(t,e.path)]}}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ko(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ko(t,r.F()),n.structuredQuery.from=[{collectionId:r.k()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NAN"}};if(Oo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(xo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NAN"}};if(Oo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rs(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:rs((t=t).field),direction:(t=t.dir,Po[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ke||gi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=es(e.endAt)),n}function ts(t){var e=Ho(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Rr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[os(t)]:void 0!==t.fieldFilter?[(n=t,xu.create(is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Lr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ia(is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=gi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ns(n.startAt));var u=null;return n.endAt&&(u=ns(n.endAt)),bu(lu(e,i,t,o,r,"F",s,u))}function es(t){return{before:t.before,values:t.position}}function ns(t){var e=!!t.before,t=t.values||[];return new Xu(t,e)}function rs(t){return{fieldPath:t.B()}}function is(t){return ai.G(t.fieldPath)}function os(t){switch(t.unaryFilter.op){case"IS_NAN":var e=is(t.unaryFilter.field);return xu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=is(t.unaryFilter.field);return xu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=is(t.unaryFilter.field);return xu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=is(t.unaryFilter.field);return xu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}function ss(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.He=void 0};function us(t,e){return t instanceof bs?Do(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var as,cs,hs=(n(ps,cs=h),ps),fs=(n(ls,as=h),ls);function ls(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ps(){return null!==cs&&cs.apply(this,arguments)||this}function ds(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ys,vs=(n(gs,ys=h),gs);function gs(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function ms(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(n(Is,ws=h),Is);function Is(t,e){var n=this;return(n=ws.call(this)||this).serializer=t,n.We=e,n}function Es(t){return _o(t.integerValue||t.doubleValue)}function Ts(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=(Ns.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),As=function(t,e){this.field=t,this.transform=e};function Ns(t){(this.fields=t).sort(ai.D)}function Ds(t,e){this.version=t,this.transformResults=e}var Ss=(Os.ze=function(){return new Os},Os.exists=function(t){return new Os(void 0,t)},Os.updateTime=function(t){return new Os(t)},Object.defineProperty(Os.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Os.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Os);function Os(t,e){this.updateTime=t,this.exists=e}function xs(t,e){return void 0!==t.updateTime?e instanceof ou&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ou}Ee=function(){};function ks(t,e,n){return t instanceof Us?new ou(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ms?function(t,e,n){if(!xs(t.Ge,e))return new uu(t.key,n.version);e=js(t,e);return new ou(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Rr(null!=n.transformResults),!xs(t.Ge,e))return new uu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Rr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ou&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof fs?ds(o,s):o instanceof vs?ms(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ks(t,r.data(),e);return new ou(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new su(t.key,n.version,{hasCommittedMutations:!0})}function Ps(t,e,n,r){return t instanceof Us?function(t,e){if(!xs(t.Ge,e))return e;e=Rs(e);return new ou(t.key,e,t.value,{Je:!0})}(t,e):t instanceof Ms?function(t,e){if(!xs(t.Ge,e))return e;var n=Rs(e),e=js(t,e);return new ou(t.key,n,e,{Je:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!xs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof ou&&(h=n.field(a.field)),null===h&&r instanceof ou&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof hs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof fs?ds(c,i):c instanceof vs?ms(c,i):(c=us(h=c,i),i=Es(c)+Es(h.We),Do(c)&&Do(h.We)?Co(i):Vo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ks(t,i.data(),r);return new ou(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,xs((t=t).Ge,e)?new su(t.key,oi.min()):e)}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof fs&&e instanceof fs||t instanceof vs&&e instanceof vs?Mr(t.elements,e.elements,mo):t instanceof bs&&e instanceof bs?mo(t.We,e.We):t instanceof hs&&e instanceof hs)}))}function Rs(t){return t instanceof ou?t.version:oi.min()}var Cs,Vs,Us=(n(Fs,Vs=Ee),Fs),Ms=(n(qs,Cs=Ee),qs);function qs(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Fs(t,e,n){var r=this;return(r=Vs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function js(t,e){return n=t,e=e instanceof ou?e.data():Xs.empty(),r=new Js(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Bs,Gs=(n(zs,Bs=Ee),zs);function zs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ss.exists(!0),n}function Ks(t,e,n){for(var r=new Js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Hs,Ws,Qs=(n(eu,Ws=Ee),eu),Ys=(n(tu,Hs=Ee),tu),Xs=(Zs.empty=function(){return new Zs({mapValue:{}})},Zs.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ko(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},Zs.prototype.isEqual=function(t){return mo(this.proto,t.proto)},Zs),Js=($s.prototype.set=function(t,e){return this.en(t,e),this},$s.prototype.delete=function(t){return this.en(t,null),this},$s.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},$s.prototype.Xe=function(){var t=this.nn(ai.U(),this.tn);return null!=t?new Xs(t):this.Ze},$s.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=ko(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},$s);function $s(t){void 0===t&&(t=Xs.empty()),this.Ze=t,this.tn=new Map}function Zs(t){this.proto=t}function tu(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function eu(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.Ge=e,n.type=3,n}var nu,ru,iu,Te=function(t,e){this.key=t,this.version=e},ou=(n(fu,iu=Te),fu.prototype.field=function(t){return this.sn.field(t)},fu.prototype.data=function(){return this.sn},fu.prototype.rn=function(){return this.sn.proto},fu.prototype.isEqual=function(t){return t instanceof fu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},fu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu),su=(n(hu,ru=Te),hu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),uu=(n(cu,nu=Te),cu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),au=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function cu(){return null!==nu&&nu.apply(this,arguments)||this}function hu(t,e,n){var r=this;return(r=ru.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fu(t,e,n,r){var i=this;return(i=iu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lu(t,e,n,r,i,o,s,u){return new au(t,e,n,r,i,o,s,u)}function pu(t){return new au(t)}function du(t){return!gi(t.limit)&&"F"===t.an}function yu(t){return!gi(t.limit)&&"L"===t.an}function vu(t){return 0<t.on.length?t.on[0].field:null}function gu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function mu(t){return null!==t.collectionGroup}function wu(t){var e=t;if(null===e.cn){e.cn=[];var n=gu(e),t=vu(e);if(null!==n&&null===t)n.W()||e.cn.push(new ia(n)),e.cn.push(new ia(ai.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new ia(ai.j(),n)))}}return e.cn}function bu(t){var e=t;if(!e.un)if("F"===e.an)e.un=Ii(e.path,e.collectionGroup,wu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=wu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ia(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.un=Ii(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Iu(t,e,n){return new au(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return new au(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Tu(t,e){return new au(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function _u(t,e){return Ti(bu(t),bu(e))&&t.an===e.an}function Au(t){return Ei(bu(t))+"|lt:"+t.an}function Nu(t){return"Query(target="+(e=bu(t),n=e.path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.B()+" "+t.op+" "+Eo(t.value)}).join(", ")+"]"),gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ea(e.startAt)),e.endAt&&(n+=", endAt: "+ea(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Du(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.M(n):ci.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||na(t.startAt,wu(t),n))&&(!t.endAt||!na(t.endAt,wu(t),n)));var e,n}function Su(u){return function(t,e){for(var n=!1,r=0,i=wu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?ci.D(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?bo(n,t):Lr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Ou,xu=(n(ku,Ou=function(){}),ku.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Cu(t,e,n):"array-contains"===e?new Hu(t,n):"in"===e?new Wu(t,n):"not-in"===e?new Qu(t,n):"array-contains-any"===e?new Yu(t,n):new ku(t,e,n)},ku.ln=function(t,e,n){return new("in"===e?Vu:Uu)(t,n)},ku.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(bo(t,this.value)):null!==t&&go(this.value)===go(t)&&this._n(bo(t,this.value))},ku.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},ku.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ku);function ku(t,e,n){var r=this;return(r=Ou.call(this)||this).field=t,r.op=e,r.value=n,r}var Pu,Lu,Ru,Cu=(n(Fu,Ru=xu),Fu.prototype.matches=function(t){t=ci.D(t.key,this.key);return this._n(t)},Fu),Vu=(n(qu,Lu=xu),qu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qu),Uu=(n(Mu,Pu=xu),Mu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Mu);function Mu(t,e){var n=this;return(n=Pu.call(this,t,"not-in",e)||this).keys=ju(0,e),n}function qu(t,e){var n=this;return(n=Lu.call(this,t,"in",e)||this).keys=ju(0,e),n}function Fu(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=ci.Y(n.referenceValue),r}function ju(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ci.Y(t.referenceValue)})}var Bu,Gu,zu,Ku,Hu=(n(ta,Ku=xu),ta.prototype.matches=function(t){t=t.field(this.field);return So(t)&&wo(t.arrayValue,this.value)},ta),Wu=(n(Zu,zu=xu),Zu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&wo(this.value.arrayValue,t)},Zu),Qu=(n($u,Gu=xu),$u.prototype.matches=function(t){if(wo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!wo(this.value.arrayValue,t)},$u),Yu=(n(Ju,Bu=xu),Ju.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!So(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},Ju),Xu=function(t,e){this.position=t,this.before=e};function Ju(t,e){return Bu.call(this,t,"array-contains-any",e)||this}function $u(t,e){return Gu.call(this,t,"not-in",e)||this}function Zu(t,e){return zu.call(this,t,"in",e)||this}function ta(t,e){return Ku.call(this,t,"array-contains",e)||this}function ea(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function na(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ci.D(ci.Y(s.referenceValue),n.key):bo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ra(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var oa,sa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ua=(va.prototype.reset=function(){this.In=0},va.prototype.Rn=function(){this.In=this.Tn},va.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},va.prototype.Vn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},va.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},va.prototype.gn=function(){return(Math.random()-.5)*this.In},va),aa=(ya.prototype.catch=function(t){return this.next(void 0,t)},ya.prototype.next=function(r,i){var o=this;return this.Dn&&Lr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new ya(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},ya.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ya.prototype.Fn=function(t){try{var e=t();return e instanceof ya?e:ya.resolve(e)}catch(t){return ya.reject(t)}},ya.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):ya.resolve(e)},ya.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):ya.reject(e)},ya.resolve=function(n){return new ya(function(t,e){t(n)})},ya.reject=function(n){return new ya(function(t,e){e(n)})},ya.On=function(t){return new ya(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ya.kn=function(t){for(var n=ya.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ya.resolve(t):e()})}(r[e]);return n},ya.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.On(i)},ya),ca=(da.delete=function(t){return Or("SimpleDb","Removing database:",t),Ea(window.indexedDB.deleteDatabase(t)).xn()},da.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(da.Bn())return!0;var t=p(),e=da.$n(t),n=0<e&&e<10,e=da.qn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},da.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},da.Kn=function(t,e){return t.store(e)},da.$n=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},da.qn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},da.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Or("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new fa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new _r(Tr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new fa(o,t))},r.onupgradeneeded=function(t){Or("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Or("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},da.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},da.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=ma.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),aa.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Or("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},da.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},da),ha=(Object.defineProperty(pa.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(pa.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(pa.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),pa.prototype.done=function(){this.Hn=!0},pa.prototype.Xn=function(t){this.Yn=t},pa.prototype.delete=function(){return Ea(this.zn.delete())},pa),fa=(n(la,oa=_r),la);function la(t,e){var n=this;return(n=oa.call(this,Tr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function pa(t){this.zn=t,this.Hn=!1,this.Yn=null}function da(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===da.$n(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ya(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function va(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function ga(t){return"IndexedDbTransactionError"===t.name}var ma=(Ia.open=function(t,e,n,r){try{return new Ia(e,t.transaction(r,n))}catch(t){throw new fa(e,t)}},Object.defineProperty(Ia.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),Ia.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Or("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ia.prototype.store=function(t){t=this.transaction.objectStore(t);return new wa(t)},Ia),wa=(ba.prototype.put=function(t,e){t=void 0!==e?(Or("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Or("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ea(t)},ba.prototype.add=function(t){return Or("SimpleDb","ADD",this.store.name,t,t),Ea(this.store.add(t))},ba.prototype.get=function(e){var n=this;return Ea(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Or("SimpleDb","GET",n.store.name,e,t),t})},ba.prototype.delete=function(t){return Or("SimpleDb","DELETE",this.store.name,t),Ea(this.store.delete(t))},ba.prototype.count=function(){return Or("SimpleDb","COUNT",this.store.name),Ea(this.store.count())},ba.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},ba.prototype.ns=function(t,e){Or("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.ss=!1;e=this.cursor(e);return this.es(e,function(t,e,n){return n.delete()})},ba.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},ba.prototype.os=function(r){var t=this.cursor({});return new aa(function(n,e){t.onerror=function(t){t=_a(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ba.prototype.es=function(t,i){var o=[];return new aa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new ha(n),(t=i(n.primaryKey,n.value,e))instanceof aa&&(t=t.catch(function(t){return e.done(),aa.reject(t)}),o.push(t)),e.Sn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return aa.On(o)})},ba.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ba.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ba);function ba(t){this.store=t}function Ia(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new sa,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new fa(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=_a(t.target.error);n.Zn.reject(new fa(e,t))}}function Ea(t){return new aa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=_a(t.target.error);n(t)}})}var Ta=!1;function _a(t){var e=ca.$n(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ta||(Ta=!0,setTimeout(function(){throw n},0)),n}}return t}function Aa(){return"undefined"!=typeof window?window:null}function Na(){return"undefined"!=typeof document?document:null}var Da=(xa._s=function(t,e,n,r,i){i=new xa(t,e,Date.now()+n,r,i);return i.start(n),i},xa.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},xa.prototype.pn=function(){return this.ds()},xa.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new _r(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},xa.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},xa.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},xa),Sa=(Object.defineProperty(Oa.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Oa.prototype.ws=function(t){this.enqueue(t)},Oa.prototype.bs=function(t){this.vs(),this.Ss(t)},Oa.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=Na())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs))},Oa.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Oa.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Oa.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.ys.reset(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.ys.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Oa.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Oa.prototype.yn=function(t,e,n){var r=this;this.vs(),-1<this.gs.indexOf(t)&&(e=0);n=Da._s(this,t,e,n,function(t){return r.xs(t)});return this.As.push(n),n},Oa.prototype.vs=function(){this.Rs&&Lr()},Oa.prototype.Fs=function(){},Oa.prototype.Os=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Oa.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Oa.prototype.Ms=function(r){var i=this;return this.Os().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.Os()})},Oa.prototype.$s=function(t){this.gs.push(t)},Oa.prototype.xs=function(t){t=this.As.indexOf(t);this.As.splice(t,1)},Oa);function Oa(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.ys=new ua(this,"async_queue_retry"),this.Vs=function(){var t=Na();t&&Or("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ys.Vn()};var t=Na();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}function xa(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new sa,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function ka(t,e){if(xr("AsyncQueue",e+": "+t),ga(t))return new _r(Tr.UNAVAILABLE,e+": "+t);throw t}function Pa(){this.Bs=new ri(Au,_u),this.onlineState="Unknown",this.qs=new Set}var La=function(){this.Ls=void 0,this.listeners=[]};function Ra(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new La),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=t.sent(),o=ka(o,"Initialization of query '"+Nu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Va(e),[2]}})})}function Ca(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Va(t){t.qs.forEach(function(t){t.next()})}var Ua=(Fa.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},Fa.prototype.onError=function(t){this.js.error(t)},Fa.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},Fa.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},Fa.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Fa.prototype.Js=function(t){t=Xi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},Fa),Ma=(qa.prototype.Zs=function(){return null!=this.uid},qa.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},qa.prototype.isEqual=function(t){return t.uid===this.uid},qa);function qa(t){this.uid=t}function Fa(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}Ma.UNAUTHENTICATED=new Ma(null),Ma.ei=new Ma("google-credentials-uid"),Ma.ni=new Ma("first-party-uid");function ja(t,e){this.user=e,this.type="OAuth",this.si={},this.si.Authorization="Bearer "+t}var Ba=(ac.prototype.getToken=function(){return Promise.resolve(null)},ac.prototype.ri=function(){},ac.prototype.oi=function(t){(this.ii=t)(Ma.UNAUTHENTICATED)},ac.prototype.ai=function(){this.ii=null},ac),Ga=(uc.prototype.getToken=function(){var e=this,n=this.hi,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.hi!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new ja(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},uc.prototype.ri=function(){this.forceRefresh=!0},uc.prototype.oi=function(t){this.ii=t,this.ui&&t(this.currentUser)},uc.prototype.ai=function(){this.auth&&this.auth.removeAuthTokenListener(this.ci),this.ci=null,this.ii=null},uc.prototype.li=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new Ma(t)},uc),za=(Object.defineProperty(sc.prototype,"si",{get:function(){var t={"X-Goog-AuthUser":this.fi},e=this._i.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),sc),Ka=(oc.prototype.getToken=function(){return Promise.resolve(new za(this._i,this.fi))},oc.prototype.oi=function(t){t(Ma.ni)},oc.prototype.ai=function(){},oc.prototype.ri=function(){},oc),Ha=(ic.prototype.wi=function(t,e,n){for(var r=n.Ei,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ks(o,e,r[i]))}return e},ic.prototype.Ti=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.di))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.di))}return e},ic.prototype.Ii=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ti(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},ic.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Hi())},ic.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Ls)&&Mr(this.baseMutations,t.baseMutations,Ls)},ic),Wa=(rc.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new rc(t,e,n,r)},rc),h=(Object.defineProperty(nc.prototype,"readTime",{get:function(){return this.gi},set:function(t){this.gi=t},enumerable:!1,configurable:!0}),nc.prototype.yi=function(t,e){this.Vi(),this.readTime=e,this.Ri.set(t.key,t)},nc.prototype.pi=function(t,e){this.Vi(),e&&(this.readTime=e),this.Ri.set(t,null)},nc.prototype.bi=function(t,e){this.Vi();var n=this.Ri.get(e);return void 0!==n?aa.resolve(n):this.vi(t,e)},nc.prototype.getEntries=function(t,e){return this.Si(t,e)},nc.prototype.apply=function(t){return this.Vi(),this.Pi=!0,this.Di(t)},nc.prototype.Vi=function(){},nc),Qa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(ec.prototype.Ni=function(t){this.Ci.push(t)},ec.prototype.xi=function(){this.Ci.forEach(function(t){return t()})},ec),Ya=(tc.prototype.Mi=function(e,n){var r=this;return this.Oi.$i(e,n).next(function(t){return r.Li(e,n,t)})},tc.prototype.Li=function(t,r,i){return this.Fi.bi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ti(r,t);return t})},tc.prototype.Bi=function(t,e,i){var o=Fi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ti(t,e);o=o.ot(t,e)}),o},tc.prototype.qi=function(e,t){var n=this;return this.Fi.getEntries(e,t).next(function(t){return n.Ui(e,t)})},tc.prototype.Ui=function(e,r){var i=this;return this.Oi.Ki(e,r).next(function(t){var t=i.Bi(e,r,t),n=Fi;return t.forEach(function(t,e){e=e||new su(t,oi.min()),n=n.ot(t,e)}),n})},tc.prototype.Qi=function(t,e,n){return r=e,ci.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wi(t,e.path):mu(e)?this.ji(t,e,n):this.Gi(t,e,n);var r},tc.prototype.Wi=function(t,e){return this.Mi(t,new ci(e)).next(function(t){var e=Gi;return t instanceof ou&&(e=e.ot(t.key,t)),e})},tc.prototype.ji=function(n,r,i){var o=this,s=r.collectionGroup,u=Gi;return this.ki.zi(n,s).next(function(t){return aa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new au(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},tc.prototype.Gi=function(e,n,t){var c,h,r=this;return this.Fi.Qi(e,n,t).next(function(t){return c=t,r.Oi.Hi(e,n)}).next(function(t){return h=t,r.Yi(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ps(s,a,a,r.di);c=a instanceof ou?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Du(n,e)||(c=c.remove(t))}),c})},tc.prototype.Yi=function(t,e,n){for(var r=Hi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Fi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ou&&(c=c.ot(t,e))}),c})},tc),Xa=(Za.Zi=function(t,e){for(var n=Hi(),r=Hi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Za(t,e.fromCache,n,r)},Za),Ja=($a.prototype.er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},$a.prototype.next=function(){var t=++this.previousValue;return this.nr&&this.nr(t),t},$a);function $a(t,e){var n=this;this.previousValue=t,e&&(e.tr=function(t){return n.er(t)},this.nr=function(t){return e.sr(t)})}function Za(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ji=n,this.Xi=r}function tc(t,e,n){this.Fi=t,this.Oi=e,this.ki=n}function ec(){this.Ci=[]}function nc(){this.Ri=new ri(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Pi=!1}function rc(t,e,n,r){this.batch=t,this.mi=e,this.Ei=n,this.Ai=r}function ic(t,e,n,r){this.batchId=t,this.di=e,this.baseMutations=n,this.mutations=r}function oc(t,e){this._i=t,this.fi=e}function sc(t,e){this._i=t,this.fi=e,this.type="FirstParty",this.user=Ma.ni}function uc(t){var e=this;this.ci=null,this.currentUser=Ma.UNAUTHENTICATED,this.ui=!1,this.hi=0,this.ii=null,this.forceRefresh=!1,this.ci=function(){e.hi++,e.currentUser=e.li(),e.ui=!0,e.ii&&e.ii(e.currentUser)},this.hi=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ci):(this.ci(null),t.get().then(function(t){e.auth=t,e.ci&&e.auth.addAuthTokenListener(e.ci)},function(){}))}function ac(){this.ii=null}function cc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Ur(n,t);return 0===t?Ur(r,e):t}Ja.ir=-1;var hc=(dc.prototype.cr=function(){return++this.ar},dc.prototype.ur=function(t){var e=[t,this.cr()];this.buffer.size<this.rr?this.buffer=this.buffer.add(e):cc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(dc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),dc),fc={hr:!1,lr:0,_r:0,dr:0},lc=(pc.Ir=function(t){return new pc(t,pc.mr,pc.Ar)},pc);function pc(t,e,n){this.wr=t,this.Er=e,this.Tr=n}function dc(t){this.rr=t,this.buffer=new Mi(cc),this.ar=0}lc.mr=10,lc.Ar=1e3,lc.Rr=new lc(41943040,lc.mr,lc.Ar),lc.Pr=new lc(-1,0,0);var yc=(mc.prototype.start=function(t){-1!==this.gr.params.wr&&this.pr(t)},mc.prototype.stop=function(){this.Vr&&(this.Vr.cancel(),this.Vr=null)},Object.defineProperty(mc.prototype,"br",{get:function(){return null!==this.Vr},enumerable:!1,configurable:!0}),mc.prototype.pr=function(n){var t=this,e=this.yr?3e5:6e4;Or("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Vr=this.cs.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Vr=null,this.yr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.vr(this.gr)];case 2:return t.sent(),[3,7];case 3:return ga(e=t.sent())?(Or("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Jh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.pr(n)];case 8:return t.sent(),[2]}})})})},mc),vc=(gc.prototype.Dr=function(t,e){return this.Sr.Cr(t).next(function(t){return Math.floor(e/100*t)})},gc.prototype.Nr=function(t,e){var n=this;if(0===e)return aa.resolve(Ja.ir);var r=new hc(e);return this.Sr.Ce(t,function(t){return r.ur(t.sequenceNumber)}).next(function(){return n.Sr.Fr(t,function(t){return r.ur(t)})}).next(function(){return r.maxValue})},gc.prototype.Or=function(t,e,n){return this.Sr.Or(t,e,n)},gc.prototype.kr=function(t,e){return this.Sr.kr(t,e)},gc.prototype.Mr=function(e,n){var r=this;return-1===this.params.wr?(Or("LruGarbageCollector","Garbage collection skipped; disabled"),aa.resolve(fc)):this.$r(e).next(function(t){return t<r.params.wr?(Or("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.wr),fc):r.Lr(e,n)})},gc.prototype.$r=function(t){return this.Sr.$r(t)},gc.prototype.Lr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Dr(e,this.params.Er).next(function(t){return i=t>h.params.Tr?(Or("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Tr+" from "+t),h.params.Tr):t,s=Date.now(),h.Nr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Or(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.kr(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Or("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),aa.resolve({hr:!0,lr:i,_r:o,dr:t})})},gc);function gc(t,e){this.Sr=t,this.params=e}function mc(t,e){this.gr=t,this.cs=e,this.yr=!1,this.Vr=null}function wc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=bc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return bc(e)}function bc(t){return t+"\x01\x01"}function Ic(t){var e=t.length;if(Rr(2<=e),2===e)return Rr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),si.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new si(r)}var Ec=function(t){this.Br=t};function Tc(t,e){if(e.document)return n=t.Br,r=e.document,i=!!e.hasCommittedMutations,t=zo(n,r.name),n=Fo(r.updateTime),r=new Xs({mapValue:{fields:r.fields}}),new ou(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ci.Z(e.noDocument.path),o=Sc(e.noDocument.readTime);return new su(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=ci.Z(e.unknownDocument.path),e=Sc(e.unknownDocument.version);return new uu(o,e)}return Lr()}function _c(t,e,n){var r=Ac(n),n=e.key.path.F().L();if(e instanceof ou){var i={name:Go(i=t.Br,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Mo(i,o.version.v())},o=e.hasCommittedMutations;return new ah(null,null,i,o,r,n)}if(e instanceof su){var i=e.key.path.L(),o=Dc(e.version),s=e.hasCommittedMutations;return new ah(null,new sh(i,o),null,s,r,n)}if(e instanceof uu){s=e.key.path.L(),e=Dc(e.version);return new ah(new uh(s,e),null,null,!0,r,n)}return Lr()}function Ac(t){t=t.v();return[t.seconds,t.nanoseconds]}function Nc(t){t=new ii(t[0],t[1]);return oi.V(t)}function Dc(t){t=t.v();return new Jc(t.seconds,t.nanoseconds)}function Sc(t){t=new ii(t.seconds,t.nanoseconds);return oi.V(t)}function Oc(e,t){var n=(t.baseMutations||[]).map(function(t){return Jo(e.Br,t)}),r=t.mutations.map(function(t){return Jo(e.Br,t)}),i=ii.fromMillis(t.localWriteTimeMs);return new Ha(t.batchId,i,n,r)}function xc(t){var e=Sc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Sc(t.lastLimboFreeSnapshotVersion):oi.min(),r=void 0!==t.query.documents?(Rr(1===(r=t.query).documents.length),bu(pu(Ho(r.documents[0])))):ts(t.query);return new Di(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Fr.fromBase64String(t.resumeToken))}function kc(t,e){var n=Dc(e.nt),r=Dc(e.lastLimboFreeSnapshotVersion),i=(_i(e.target)?$o:Zo)(t.Br,e.target),t=e.resumeToken.toBase64();return new hh(e.targetId,Ei(e.target),n,t,e.sequenceNumber,r,i)}var Pc=(Lc.Kr=function(t,e,n,r){return Rr(""!==t.uid),new Lc(t.Zs()?t.uid:"",e,n,r)},Lc.prototype.Qr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vc(t).rs({index:rh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Lc.prototype.Wr=function(d,y,v,g){var m=this,w=Uc(d),b=Vc(d);return b.add({}).next(function(t){Rr("number"==typeof t);for(var e,n,r,i,o,s=new Ha(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Xo(e.Br,t)}),o=r.mutations.map(function(t){return Xo(e.Br,t)}),new rh(n,r.batchId,r.di.toMillis(),i,o)),a=[],c=new Mi(function(t,e){return Ur(t.B(),e.B())}),h=0,f=g;h<f.length;h++){var l=f[h],p=ih.key(m.userId,l.key.path,t),c=c.add(l.key.path.F());a.push(b.put(u)),a.push(w.put(p,ih.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ki.jr(d,t))}),d.Ni(function(){m.Ur[t]=s.keys()}),aa.On(a).next(function(){return s})})},Lc.prototype.Gr=function(t,e){var n=this;return Vc(t).get(e).next(function(t){return t?(Rr(t.userId===n.userId),Oc(n.serializer,t)):null})},Lc.prototype.zr=function(t,e){var n=this;return this.Ur[e]?aa.resolve(this.Ur[e]):this.Gr(t,e).next(function(t){if(t){t=t.keys();return n.Ur[e]=t}return null})},Lc.prototype.Hr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Vc(t).rs({index:rh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Rr(e.batchId>=i),o=Oc(r.serializer,e)),n.done()}).next(function(){return o})},Lc.prototype.Yr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Vc(t).rs({index:rh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Lc.prototype.Jr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vc(t).ts(rh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Oc(e.serializer,t)})})},Lc.prototype.$i=function(o,s){var u=this,t=ih.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Uc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ic(i);if(r===u.userId&&s.path.isEqual(i))return Vc(o).get(t).next(function(t){if(!t)throw Lr();Rr(t.userId===u.userId),a.push(Oc(u.serializer,t))});n.done()}).next(function(){return a})},Lc.prototype.Ki=function(e,t){var s=this,u=new Mi(Ur),n=[];return t.forEach(function(o){var t=ih.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Uc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ic(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),aa.On(n).next(function(){return s.Xr(e,u)})},Lc.prototype.Hi=function(t,e){var o=this,s=e.path,u=s.length+1,e=ih.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Mi(Ur);return Uc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ic(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Xr(t,a)})},Lc.prototype.Xr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Vc(e).get(t).next(function(t){if(null===t)throw Lr();Rr(t.userId===n.userId),r.push(Oc(n.serializer,t))}))}),aa.On(i).next(function(){return r})},Lc.prototype.Zr=function(e,n){var r=this;return Cc(e.eo,this.userId,n).next(function(t){return e.Ni(function(){r.no(n.batchId)}),aa.forEach(t,function(t){return r.qr.so(e,t)})})},Lc.prototype.no=function(t){delete this.Ur[t]},Lc.prototype.io=function(e){var i=this;return this.Qr(e).next(function(t){if(!t)return aa.resolve();var t=IDBKeyRange.lowerBound(ih.prefixForUser(i.userId)),r=[];return Uc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Ic(t[1]),r.push(t)):n.done()}).next(function(){Rr(0===r.length)})})},Lc.prototype.ro=function(t,e){return Rc(t,this.userId,e)},Lc.prototype.oo=function(t){var e=this;return Mc(t).get(this.userId).next(function(t){return t||new nh(e.userId,-1,"")})},Lc);function Lc(t,e,n,r){this.userId=t,this.serializer=e,this.ki=n,this.qr=r,this.Ur={}}function Rc(t,o,e){var e=ih.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Uc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Cc(t,e,n){var r=t.store(rh.store),i=t.store(ih.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Rr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=ih.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return aa.On(o).next(function(){return u})}function Vc(t){return xh.Kn(t,rh.store)}function Uc(t){return xh.Kn(t,ih.store)}function Mc(t){return xh.Kn(t,nh.store)}var qc,Fc=(Gc.prototype.yi=function(t,e,n){return Kc(t).put(Hc(e),n)},Gc.prototype.pi=function(t,e){t=Kc(t),e=Hc(e);return t.delete(e)},Gc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ao(e,t)})},Gc.prototype.bi=function(t,e){var n=this;return Kc(t).get(Hc(e)).next(function(t){return n.co(t)})},Gc.prototype.uo=function(t,e){var n=this;return Kc(t).get(Hc(e)).next(function(t){var e=n.co(t);return e?{ho:e,size:Wc(t)}:null})},Gc.prototype.getEntries=function(t,e){var n=this,r=Fi;return this.lo(t,e,function(t,e){e=n.co(e);r=r.ot(t,e)}).next(function(){return r})},Gc.prototype._o=function(t,e){var r=this,i=Fi,o=new ki(ci.D);return this.lo(t,e,function(t,e){var n=r.co(e);o=n?(i=i.ot(t,n),o.ot(t,Wc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{fo:i,do:o}})},Gc.prototype.lo=function(t,e,i){if(e.P())return aa.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Kc(t).rs({range:n},function(t,e,n){for(var r=ci.Z(t);s&&ci.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Gc.prototype.Qi=function(t,r,e){var n,i=this,o=Gi,s=r.path.length+1,u={};return e.isEqual(oi.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=Ac(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=ah.collectionReadTimeIndex),Kc(t).rs(u,function(t,e,n){t.length===s&&(e=Tc(i.serializer,e),r.path.M(e.key.path)?e instanceof ou&&Du(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Gc.prototype.wo=function(t){return new jc(this,!!t&&t.Eo)},Gc.prototype.To=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Gc.prototype.getMetadata=function(t){return zc(t).get(ch.key).next(function(t){return Rr(!!t),t})},Gc.prototype.ao=function(t,e){return zc(t).put(ch.key,e)},Gc.prototype.co=function(t){if(t){t=Tc(this.serializer,t);return t instanceof su&&t.version.isEqual(oi.min())?null:t}return null},Gc),jc=(n(Bc,qc=h),Bc.prototype.Di=function(i){var o=this,s=[],u=0,a=new Mi(function(t,e){return Ur(t.B(),e.B())});return this.Ri.forEach(function(t,e){var n,r=o.mo.get(t);e?(n=_c(o.Io.serializer,e,o.readTime),a=a.add(t.path.F()),e=Wc(n),u+=e-r,s.push(o.Io.yi(i,t,n))):(u-=r,o.Eo?(r=_c(o.Io.serializer,new su(t,oi.min()),o.readTime),s.push(o.Io.yi(i,t,r))):s.push(o.Io.pi(i,t)))}),a.forEach(function(t){s.push(o.Io.ki.jr(i,t))}),s.push(this.Io.updateMetadata(i,u)),aa.On(s)},Bc.prototype.vi=function(t,e){var n=this;return this.Io.uo(t,e).next(function(t){return null===t?(n.mo.set(e,0),null):(n.mo.set(e,t.size),t.ho)})},Bc.prototype.Si=function(t,e){var n=this;return this.Io._o(t,e).next(function(t){var e=t.fo;return t.do.forEach(function(t,e){n.mo.set(t,e)}),e})},Bc);function Bc(t,e){var n=this;return(n=qc.call(this)||this).Io=t,n.Eo=e,n.mo=new ri(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Gc(t,e){this.serializer=t,this.ki=e}function zc(t){return xh.Kn(t,ch.store)}function Kc(t){return xh.Kn(t,ah.store)}function Hc(t){return t.path.L()}function Wc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}var Qc=(eh.prototype.jr=function(t,e){return this.Ao.add(e),aa.resolve()},eh.prototype.zi=function(t,e){return aa.resolve(this.Ao.getEntries(e))},eh),Yc=(th.prototype.add=function(t){var e=t.k(),n=t.F(),r=this.index[e]||new Mi(si.D),t=!r.has(n);return this.index[e]=r.add(n),t},th.prototype.has=function(t){var e=t.k(),t=t.F(),e=this.index[e];return e&&e.has(t)},th.prototype.getEntries=function(t){return(this.index[t]||new Mi(si.D)).L()},th),Xc=(Zc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Rr(t<r&&0<=t&&r<=10);var o=new ma("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore($c.store),(s=e).createObjectStore(nh.store,{keyPath:nh.keyPath}),s.createObjectStore(rh.store,{keyPath:rh.keyPath,autoIncrement:!0}).createIndex(rh.userMutationsIndex,rh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ih.store),dh(e),e.createObjectStore(ah.store));var s,u=aa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(fh.store),s.deleteObjectStore(hh.store),s.deleteObjectStore(lh.store),dh(e)),u=u.next(function(){return t=o.store(lh.store),e=new lh(0,0,oi.min().v(),0),t.put(lh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(rh.store).ts().next(function(t){n.deleteObjectStore(rh.store),n.createObjectStore(rh.store,{keyPath:rh.keyPath,autoIncrement:!0}).createIndex(rh.userMutationsIndex,rh.userMutationsKeyPath,{unique:!0});var e=r.store(rh.store),t=t.map(function(t){return e.put(t)});return aa.On(t)});var n,r})),u=u.next(function(){e.createObjectStore(yh.store,{keyPath:yh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(ch.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(ah.store)).createIndex(ah.readTimeIndex,ah.readTimeIndexPath,{unique:!1}),t.createIndex(ah.collectionReadTimeIndex,ah.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},Zc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(ah.store).rs(function(t,e){n+=Wc(e)}).next(function(){var t=new ch(n);return e.store(ch.store).put(ch.key,t)})},Zc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(nh.store),i=n.store(rh.store);return t.ts().next(function(t){return aa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(rh.userMutationsIndex,t).next(function(t){return aa.forEach(t,function(t){Rr(t.userId===e.userId);t=Oc(r.serializer,t);return Cc(n,e.userId,t).next(function(){})})})})})},Zc.prototype.ensureSequenceNumbers=function(t){var o=t.store(fh.store),e=t.store(ah.store);return t.store(lh.store).get(lh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new si(t),t=[0,wc(n)];i.push(o.get(t).next(function(t){return t?aa.resolve():o.put(new fh(0,wc(n),r.highestListenSequenceNumber))}))}).next(function(){return aa.On(i)})})},Zc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ph.store,{keyPath:ph.keyPath});function r(t){if(i.add(t)){var e=t.k(),t=t.F();return n.put({collectionId:e,parent:wc(t)})}}var n=e.store(ph.store),i=new Yc;return e.store(ah.store).rs({ss:!0},function(t,e){t=new si(t);return r(t.F())}).next(function(){return e.store(ih.store).rs({ss:!0},function(t,e){t[0];var n=t[1],n=(t[2],Ic(n));return r(n.F())})})},Zc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(hh.store);return r.rs(function(t,e){e=xc(e),e=kc(n.serializer,e);return r.put(e)})},Zc),Jc=function(t,e){this.seconds=t,this.nanoseconds=e},$c=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Zc(t){this.serializer=t}function th(){this.index={}}function eh(){this.Ao=new Yc}$c.store="owner",$c.key="owner";var nh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};nh.store="mutationQueues",nh.keyPath="userId";var rh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};rh.store="mutations",rh.keyPath="batchId",rh.userMutationsIndex="userMutationsIndex",rh.userMutationsKeyPath=["userId","batchId"];var ih=(oh.prefixForUser=function(t){return[t]},oh.prefixForPath=function(t,e){return[t,wc(e)]},oh.key=function(t,e,n){return[t,wc(e),n]},oh);function oh(){}ih.store="documentMutations",ih.PLACEHOLDER=new ih;var sh=function(t,e){this.path=t,this.readTime=e},uh=function(t,e){this.path=t,this.version=e},ah=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ah.store="remoteDocuments",ah.readTimeIndex="readTimeIndex",ah.readTimeIndexPath="readTime",ah.collectionReadTimeIndex="collectionReadTimeIndex",ah.collectionReadTimeIndexPath=["parentPath","readTime"];var ch=function(t){this.byteSize=t};ch.store="remoteDocumentGlobal",ch.key="remoteDocumentGlobalKey";var hh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};hh.store="targets",hh.keyPath="targetId",hh.queryTargetsIndexName="queryTargetsIndex",hh.queryTargetsKeyPath=["canonicalId","targetId"];var fh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};fh.store="targetDocuments",fh.keyPath=["targetId","path"],fh.documentTargetsIndex="documentTargetsIndex",fh.documentTargetsKeyPath=["path","targetId"];var lh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};lh.key="targetGlobalKey",lh.store="targetGlobal";var ph=function(t,e){this.collectionId=t,this.parent=e};function dh(t){t.createObjectStore(fh.store,{keyPath:fh.keyPath}).createIndex(fh.documentTargetsIndex,fh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(hh.store,{keyPath:hh.keyPath}).createIndex(hh.queryTargetsIndexName,hh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(lh.store)}ph.store="collectionParents",ph.keyPath=["collectionId","parent"];var yh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};yh.store="clientMetadata",yh.keyPath="clientId";var vh=i(i(i([nh.store,rh.store,ih.store,ah.store,hh.store,$c.store,lh.store,fh.store],[yh.store]),[ch.store]),[ph.store]),gh=(mh.prototype.jr=function(t,e){var n=this;if(this.Ro.has(e))return aa.resolve();var r=e.k(),i=e.F();t.Ni(function(){n.Ro.add(e)});i={collectionId:r,parent:wc(i)};return wh(t).put(i)},mh.prototype.zi=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[qr(i),""],!1,!0);return wh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Ic(r.parent))}return o})},mh);function mh(){this.Ro=new Yc}function wh(t){return xh.Kn(t,ph.store)}var bh=(Th.prototype.next=function(){return this.Po+=2,this.Po},Th.yo=function(){return new Th(0)},Th.Vo=function(){return new Th(-1)},Th),Ih=(Eh.prototype.po=function(n){var r=this;return this.bo(n).next(function(t){var e=new bh(t.highestTargetId);return t.highestTargetId=e.next(),r.vo(n,t).next(function(){return t.highestTargetId})})},Eh.prototype.So=function(t){return this.bo(t).next(function(t){return oi.V(new ii(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Eh.prototype.Do=function(t){return this.bo(t).next(function(t){return t.highestListenSequenceNumber})},Eh.prototype.Co=function(e,n,r){var i=this;return this.bo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.vo(e,t)})},Eh.prototype.No=function(e,n){var r=this;return this.xo(e,n).next(function(){return r.bo(e).next(function(t){return t.targetCount+=1,r.Fo(n,t),r.vo(e,t)})})},Eh.prototype.Oo=function(t,e){return this.xo(t,e)},Eh.prototype.ko=function(e,t){var n=this;return this.Mo(e,t.targetId).next(function(){return _h(e).delete(t.targetId)}).next(function(){return n.bo(e)}).next(function(t){return Rr(0<t.targetCount),--t.targetCount,n.vo(e,t)})},Eh.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return _h(n).rs(function(t,e){e=xc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ko(n,e)))}).next(function(){return aa.On(u)}).next(function(){return s})},Eh.prototype.Ce=function(t,n){return _h(t).rs(function(t,e){e=xc(e);n(e)})},Eh.prototype.bo=function(t){return Ah(t).get(lh.key).next(function(t){return Rr(null!==t),t})},Eh.prototype.vo=function(t,e){return Ah(t).put(lh.key,e)},Eh.prototype.xo=function(t,e){return _h(t).put(kc(this.serializer,e))},Eh.prototype.Fo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Eh.prototype.$o=function(t){return this.bo(t).next(function(t){return t.targetCount})},Eh.prototype.Lo=function(t,r){var e=Ei(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return _h(t).rs({range:e,index:hh.queryTargetsIndexName},function(t,e,n){e=xc(e);Ti(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Eh.prototype.Bo=function(n,t,r){var i=this,o=[],s=Nh(n);return t.forEach(function(t){var e=wc(t.path);o.push(s.put(new fh(r,e))),o.push(i.qr.qo(n,r,t))}),aa.On(o)},Eh.prototype.Uo=function(n,t,r){var i=this,o=Nh(n);return aa.forEach(t,function(t){var e=wc(t.path);return aa.On([o.delete([r,e]),i.qr.Ko(n,r,t)])})},Eh.prototype.Mo=function(t,e){t=Nh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Eh.prototype.Qo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Nh(t),r=Hi();return t.rs({range:e,ss:!0},function(t,e,n){t=Ic(t[1]),t=new ci(t);r=r.add(t)}).next(function(){return r})},Eh.prototype.ro=function(t,e){var e=wc(e.path),e=IDBKeyRange.bound([e],[qr(e)],!1,!0),i=0;return Nh(t).rs({index:fh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Eh.prototype.Ue=function(t,e){return _h(t).get(e).next(function(t){return t?xc(t):null})},Eh);function Eh(t,e){this.qr=t,this.serializer=e}function Th(t){this.Po=t}function _h(t){return xh.Kn(t,hh.store)}function Ah(t){return xh.Kn(t,lh.store)}function Nh(t){return xh.Kn(t,fh.store)}var Dh,Sh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Oh=(n(Ph,Dh=Ee),Ph),xh=(kh.Kn=function(t,e){if(t instanceof Oh)return ca.Kn(t.eo,e);throw Lr()},kh.prototype.start=function(){var e=this;return this.ra().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Sh);return e.oa(),e.aa(),e.ca(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.sa.Do(t)})}).then(function(t){e.zo=new Ja(t,e.jo)}).then(function(){e.Ho=!0}).catch(function(t){return e.na&&e.na.close(),Promise.reject(t)})},kh.prototype.ua=function(n){var t=this;return this.ta=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.br?[2,n(e)]:[2]})})},n(this.isPrimary)},kh.prototype.ha=function(n){var t=this;this.na.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},kh.prototype.la=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.br?[4,this.ra()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},kh.prototype.ra=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Rh(e).put(new yh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._a(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.ta(!1)}))})}).next(function(){return n.fa(e)}).next(function(t){return n.isPrimary&&!t?n.da(e).next(function(){return!1}):!!t&&n.wa(e).next(function(){return!0})})}).catch(function(t){if(ga(t))return Or("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Or("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.ta(t)}),n.isPrimary=t})},kh.prototype._a=function(t){var e=this;return Lh(t).get($c.key).next(function(t){return aa.resolve(e.Ea(t))})},kh.prototype.Ta=function(t){return Rh(t).delete(this.clientId)},kh.prototype.Ia=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ma(this.Zo,18e5)?[3,2]:(this.Zo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=kh.Kn(t,yh.store);return r.ts().next(function(t){var e=o.Aa(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return aa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ia)for(n=0,r=e;n<r.length;n++)i=r[n],this.ia.removeItem(this.Ra(i.clientId));t.label=2;case 2:return[2]}})})},kh.prototype.ca=function(){var t=this;this.Xo=this.fn.yn("client_metadata_refresh",4e3,function(){return t.ra().then(function(){return t.Ia()}).then(function(){return t.ca()})})},kh.prototype.Ea=function(t){return!!t&&t.ownerId===this.clientId},kh.prototype.fa=function(e){var r=this;return this.Go?aa.resolve(!0):Lh(e).get($c.key).next(function(t){if(null!==t&&r.ma(t.leaseTimestampMs,5e3)&&!r.Pa(t.ownerId)){if(r.Ea(t)&&r.networkEnabled)return!0;if(!r.Ea(t)){if(!t.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Sh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Rh(e).ts().next(function(t){return void 0===r.Aa(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Or("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},kh.prototype.ga=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Ho=!1,this.ya(),this.Xo&&(this.Xo.cancel(),this.Xo=null),this.Va(),this.pa(),[4,this.na.runTransaction("shutdown","readwrite",[$c.store,yh.store],function(t){var e=new Oh(t,Ja.ir);return n.da(e).next(function(){return n.Ta(e)})})];case 1:return t.sent(),this.na.close(),this.ba(),[2]}})})},kh.prototype.Aa=function(t,e){var n=this;return t.filter(function(t){return n.ma(t.updateTimeMs,e)&&!n.Pa(t.clientId)})},kh.prototype.va=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Rh(t).ts().next(function(t){return e.Aa(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(kh.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),kh.prototype.Sa=function(t){return Pc.Kr(t,this.serializer,this.ki,this.qr)},kh.prototype.Da=function(){return this.sa},kh.prototype.Ca=function(){return this.Fi},kh.prototype.Na=function(){return this.ki},kh.prototype.runTransaction=function(e,n,r){var i=this;Or("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.na.runTransaction(e,t,vh,function(t){return o=new Oh(t,i.zo?i.zo.next():Ja.ir),"readwrite-primary"===n?i._a(o).next(function(t){return!!t||i.fa(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.ta(!1)}),new _r(Tr.FAILED_PRECONDITION,Qa);return r(o)}).next(function(t){return i.wa(o).next(function(){return t})}):i.xa(o).next(function(){return r(o)})}).then(function(t){return o.xi(),t})},kh.prototype.xa=function(t){var e=this;return Lh(t).get($c.key).next(function(t){if(null!==t&&e.ma(t.leaseTimestampMs,5e3)&&!e.Pa(t.ownerId)&&!e.Ea(t)&&!(e.Go||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Tr.FAILED_PRECONDITION,Sh)})},kh.prototype.wa=function(t){var e=new $c(this.clientId,this.allowTabSynchronization,Date.now());return Lh(t).put($c.key,e)},kh.Ln=function(){return ca.Ln()},kh.prototype.da=function(t){var e=this,n=Lh(t);return n.get($c.key).next(function(t){return e.Ea(t)?(Or("IndexedDbPersistence","Releasing primary lease."),n.delete($c.key)):aa.resolve()})},kh.prototype.ma=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},kh.prototype.oa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Jo=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.ra()})},this.document.addEventListener("visibilitychange",this.Jo),this.inForeground="visible"===this.document.visibilityState)},kh.prototype.Va=function(){this.Jo&&(this.document.removeEventListener("visibilitychange",this.Jo),this.Jo=null)},kh.prototype.aa=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Yo=function(){e.ya(),e.fn.ws(function(){return e.ga()})},this.window.addEventListener("unload",this.Yo))},kh.prototype.pa=function(){this.Yo&&(this.window.removeEventListener("unload",this.Yo),this.Yo=null)},kh.prototype.Pa=function(t){try{var e=null!==(null===(e=this.ia)||void 0===e?void 0:e.getItem(this.Ra(t)));return Or("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},kh.prototype.ya=function(){if(this.ia)try{this.ia.setItem(this.Ra(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},kh.prototype.ba=function(){if(this.ia)try{this.ia.removeItem(this.Ra(this.clientId))}catch(t){}},kh.prototype.Ra=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},kh);function kh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.jo=a,this.Go=c,this.zo=null,this.Ho=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Yo=null,this.inForeground=!1,this.Jo=null,this.Xo=null,this.Zo=Number.NEGATIVE_INFINITY,this.ta=function(t){return Promise.resolve()},!kh.Ln())throw new _r(Tr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.qr=new Ch(this,r),this.ea=e+"main",this.serializer=new Ec(u),this.na=new ca(this.ea,10,new Xc(this.serializer)),this.sa=new Ih(this.qr,this.serializer),this.ki=new gh,this.Fi=(e=this.serializer,u=this.ki,new Fc(e,u)),this.window&&this.window.localStorage?this.ia=this.window.localStorage:(this.ia=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ph(t,e){var n=this;return(n=Dh.call(this)||this).eo=t,n.Wo=e,n}function Lh(t){return xh.Kn(t,$c.store)}function Rh(t){return xh.Kn(t,yh.store)}var Ch=(Vh.prototype.Cr=function(t){var n=this.Fa(t);return this.db.Da().$o(t).next(function(e){return n.next(function(t){return e+t})})},Vh.prototype.Fa=function(t){var e=0;return this.Fr(t,function(t){e++}).next(function(){return e})},Vh.prototype.Ce=function(t,e){return this.db.Da().Ce(t,e)},Vh.prototype.Fr=function(t,n){return this.Oa(t,function(t,e){return n(e)})},Vh.prototype.qo=function(t,e,n){return Uh(t,n)},Vh.prototype.Ko=function(t,e,n){return Uh(t,n)},Vh.prototype.Or=function(t,e,n){return this.db.Da().Or(t,e,n)},Vh.prototype.so=Uh,Vh.prototype.ka=function(t,e){return r=e,i=!1,Mc(n=t).os(function(t){return Rc(n,t,r).next(function(t){return t&&(i=!0),aa.resolve(!t)})}).next(function(){return i});var n,r,i},Vh.prototype.kr=function(n,r){var i=this,o=this.db.Ca().wo(),s=[],u=0;return this.Oa(n,function(e,t){t<=r&&(t=i.ka(n,e).next(function(t){if(!t)return u++,o.bi(n,e).next(function(){return o.pi(e),Nh(n).delete([0,wc(e.path)])})}),s.push(t))}).next(function(){return aa.On(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Vh.prototype.removeTarget=function(t,e){e=e.st(t.Wo);return this.db.Da().Oo(t,e)},Vh.prototype.Ma=Uh,Vh.prototype.Oa=function(t,r){var i,t=Nh(t),o=Ja.ir;return t.rs({index:fh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ja.ir&&r(new ci(Ic(i)),o),o=e,i=t):o=Ja.ir}).next(function(){o!==Ja.ir&&r(new ci(Ic(i)),o)})},Vh.prototype.$r=function(t){return this.db.Ca().To(t)},Vh);function Vh(t,e){this.db=t,this.gr=new vc(this,e)}function Uh(t,e){return Nh(t).put((t=t.Wo,new fh(0,wc(e.path),t)))}function Mh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var qh=(Fh.prototype.vr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Mr(t,n.La)})},Fh);function Fh(t,e,n){this.persistence=t,this.$a=e,this.La=new ki(Ur),this.Ba=new ri(Ei,Ti),this.qa=oi.min(),this.Oi=t.Sa(n),this.Ua=t.Ca(),this.sa=t.Da(),this.Ka=new Ya(this.Ua,this.Oi,this.persistence.Na()),this.$a.Qa(this.Ka)}function jh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Oi,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Oi.Jr(v).next(function(t){return g=t,n=e.persistence.Sa(o),m=new Ya(e.Ua,n,e.persistence.Na()),n.Jr(v)}).next(function(t){for(var e=[],n=[],r=Hi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.qi(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Oi=n,e.Ka=m,e.$a.Qa(e.Ka),r)]}})})}function Bh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ua.wo({Eo:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=aa.resolve(),n.forEach(function(n){u=u.next(function(){return o.bi(r,n)}).next(function(t){var e=t,t=i.Ai.get(n);Rr(null!==t),(!e||e.version.u(t)<0)&&(e=s.wi(n,e,i))&&o.yi(e,i.mi)})}),u.next(function(){return e.Oi.Zr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Oi.io(t)}).next(function(){return f.Ka.qi(t,a)})})}function Gh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.sa.So(t)})}function zh(t,a){var c=t,h=a.nt,f=c.La;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ua.wo({Eo:!0});f=c.La;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.sa.Uo(s,t.se,e).next(function(){return c.sa.Bo(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Wo),f=f.ot(e,n),r=o,i=t,Rr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.sa.Oo(s,n))))});var t,o=Fi,n=Hi();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof su&&e.version.isEqual(oi.min())?(i.pi(t,h),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.yi(e,h),o=o.ot(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(c.persistence.qr.Ma(s,t))})})),h.isEqual(oi.min())||(t=c.sa.So(s).next(function(t){return c.sa.Co(s,s.Wo,h)}),u.push(t)),aa.On(u).next(function(){return i.apply(s)}).next(function(){return c.Ka.Ui(s,o)})}).then(function(t){return c.La=f,t})}function Kh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.sa.Lo(e,r).next(function(t){return t?(n=t,aa.resolve(n)):i.sa.po(e).next(function(t){return n=new Di(r,t,0,e.Wo),i.sa.No(e,n).next(function(){return n})})})}).then(function(t){var e=i.La.get(t.targetId);return(null===e||0<t.nt.u(e.nt))&&(i.La=i.La.ot(t.targetId,t),i.Ba.set(r,t.targetId)),t})}function Hh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).La.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.qr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ga(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.La=e.La.remove(o),e.Ba.delete(n.target),[2]}})})}function Wh(t,o,s){var u=t,a=oi.min(),c=Hi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=bu(o),(void 0!==(t=(i=t).Ba.get(r))?aa.resolve(i.La.get(t)):i.sa.Lo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.sa.Qo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.$a.Qi(e,o,s?a:oi.min(),s?c:Hi())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}function Qh(t,e){var n=t,r=n.sa,t=n.La.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function Yh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ua,n=t,t=s.qa,r=e,i=Fi,o=Ac(t),t=Kc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:ah.readTimeIndex,range:n},function(t,e){var n=Tc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{Ha:i,readTime:Nc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Ha,t=t.readTime;return s.qa=t,e})}function Xh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Kc(t),r=oi.min(),t.rs({index:ah.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Nc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.qa=t})]})})}function Jh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||e.message!==Qa)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function $h(t,e,n,r,i){var o=this;this.Bc=t,this.qc=e,this.cs=n,this.Uc={},this.Kc=[],this.Qc=new Map,this.Wc=new Set,this.jc=[],this.Gc=i,this.Gc.zc(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return bf(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(4),[4,pf(e)];case 1:return t.sent(),e.Hc.set("Unknown"),e.Wc.delete(4),[4,lf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Hc=new sf(n,r)}var Zh,tf,ef,Te=(ff.prototype.ec=function(){return 1===this.state||2===this.state||4===this.state},ff.prototype.nc=function(){return 2===this.state},ff.prototype.start=function(){3!==this.state?this.auth():this.sc()},ff.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ec()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ff.prototype.ic=function(){this.state=0,this.ys.reset()},ff.prototype.rc=function(){var t=this;this.nc()&&null===this.tc&&(this.tc=this.fn.yn(this.Ya,6e4,function(){return t.oc()}))},ff.prototype.ac=function(t){this.cc(),this.stream.send(t)},ff.prototype.oc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.nc()?[2,this.close(0)]:[2]})})},ff.prototype.cc=function(){this.tc&&(this.tc.cancel(),this.tc=null)},ff.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc(),this.ys.cancel(),this.Za++,3!==e?this.ys.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===Tr.UNAUTHENTICATED&&this.Xa.ri(),null!==this.stream&&(this.uc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.hc(n)];case 1:return t.sent(),[2]}})})},ff.prototype.uc=function(){},ff.prototype.auth=function(){var n=this;this.state=1;var t=this.lc(this.Za),e=this.Za;this.Xa.getToken().then(function(t){n.Za===e&&n._c(t)},function(e){t(function(){var t=new _r(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fc(t)})})},ff.prototype._c=function(t){var e=this,n=this.lc(this.Za);this.stream=this.dc(t),this.stream.wc(function(){n(function(){return e.state=2,e.listener.wc()})}),this.stream.hc(function(t){n(function(){return e.fc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ff.prototype.sc=function(){var t=this;this.state=4,this.ys.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},ff.prototype.fc=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ff.prototype.lc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.Za===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ff),nf=(n(hf,ef=Te),hf.prototype.dc=function(t){return this.Ja.Ec("Listen",t)},hf.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Lr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Rr(void 0===o||"string"==typeof o),Fr.fromBase64String(o||"")):(Rr(void 0===o||o instanceof Uint8Array),Fr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:xi(s.code),new _r(o,s.message||"")),r=new eo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=zo(t,u.document.name),a=Fo(u.document.updateTime),s=new Xs({mapValue:{fields:u.document.fields}}),a=new ou(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Zi(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=zo(t,u.document),c=u.readTime?Fo(u.readTime):oi.min(),c=new su(a,c),u=u.removedTargetIds||[];r=new Zi([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=zo(t,c.document),c=c.removedTargetIds||[];r=new Zi([],c,h,null)}else{if(!("filter"in e))return Lr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Ai(e),h=h.targetId;r=new to(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Fo(t.readTime):oi.min()}(t);return this.listener.Tc(e,t)},hf.prototype.Ic=function(t){var e,n,r,i={};i.database=Wo(this.serializer),i.addTarget=(e=this.serializer,(r=_i(r=(n=t).target)?{documents:$o(e,r)}:{query:Zo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=qo(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ac(i)},hf.prototype.mc=function(t){var e={};e.database=Wo(this.serializer),e.removeTarget=t,this.ac(e)},hf),rf=(n(cf,tf=Te),Object.defineProperty(cf.prototype,"Rc",{get:function(){return this.Ac},enumerable:!1,configurable:!0}),cf.prototype.start=function(){this.Ac=!1,this.lastStreamToken=void 0,tf.prototype.start.call(this)},cf.prototype.uc=function(){this.Ac&&this.Pc([])},cf.prototype.dc=function(t){return this.Ja.Ec("Write",t)},cf.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ac){this.ys.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Rr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Fo(t.updateTime):Fo(e);n.isEqual(oi.min())&&(n=Fo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ds(n,e)}(t,r)})):[]),n=Fo(t.commitTime);return this.listener.gc(n,e)}var n,r;return Rr(!t.writeResults||0===t.writeResults.length),this.Ac=!0,this.listener.yc()},cf.prototype.Vc=function(){var t={};t.database=Wo(this.serializer),this.ac(t)},cf.prototype.Pc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xo(e.serializer,t)})};this.ac(t)},cf),of=(n(af,Zh=function(){}),af.prototype.vc=function(){if(this.bc)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},af.prototype.Sc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ja.Sc(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.ri(),t})},af.prototype.Dc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ja.Dc(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.ri(),t})},af.prototype.terminate=function(){this.bc=!1},af),sf=(uf.prototype.Oc=function(){var t=this;0===this.Nc&&(this.kc("Unknown"),this.xc=this.cs.yn("online_state_timeout",1e4,function(){return t.xc=null,t.Mc("Backend didn't respond within 10 seconds."),t.kc("Offline"),Promise.resolve()}))},uf.prototype.$c=function(t){"Online"===this.state?this.kc("Unknown"):(this.Nc++,1<=this.Nc&&(this.Lc(),this.Mc("Connection failed 1 times. Most recent error: "+t.toString()),this.kc("Offline")))},uf.prototype.set=function(t){this.Lc(),this.Nc=0,"Online"===t&&(this.Fc=!1),this.kc(t)},uf.prototype.kc=function(t){t!==this.state&&(this.state=t,this.Cc(t))},uf.prototype.Mc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fc?(xr(t),this.Fc=!1):Or("OnlineStateTracker",t)},uf.prototype.Lc=function(){null!==this.xc&&(this.xc.cancel(),this.xc=null)},uf);function uf(t,e){this.cs=t,this.Cc=e,this.state="Unknown",this.Nc=0,this.xc=null,this.Fc=!0}function af(t,e,n){var r=this;return(r=Zh.call(this)||this).credentials=t,r.Ja=e,r.serializer=n,r.bc=!1,r}function cf(t,e,n,r,i){var o=this;return(o=tf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ac=!1,o}function hf(t,e,n,r,i){var o=this;return(o=ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function ff(t,e,n,r,i,o){this.fn=t,this.Ya=n,this.Ja=r,this.Xa=i,this.listener=o,this.state=0,this.Za=0,this.tc=null,this.stream=null,this.ys=new ua(t,e)}function lf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!bf(r))return[3,4];e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function pf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function df(t,e){t.Qc.has(e.targetId)||(t.Qc.set(e.targetId,e),wf(t)?mf(t):Of(t).nc()&&vf(t,e))}function yf(t,e){var n=t,t=Of(n);n.Qc.delete(e),t.nc()&&gf(n,e),0===n.Qc.size&&(t.nc()?t.rc():bf(n)&&n.Hc.set("Unknown"))}function vf(t,e){t.Yc.me(e.targetId),Of(t).Ic(e)}function gf(t,e){t.Yc.me(e),Of(t).mc(e)}function mf(e){e.Yc=new ro({qe:function(t){return e.Uc.qe(t)},Ue:function(t){return e.Qc.get(t)||null}}),Of(e).start(),e.Hc.Oc()}function wf(t){return bf(t)&&!Of(t).ec()&&0<t.Qc.size}function bf(t){return 0===t.Wc.size}function If(t){t.Yc=void 0}function Ef(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Hc.set("Online"),!(u instanceof eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Qc.has(i)?[4,o.Uc.Jc(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Qc.delete(i),o.Yc.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Tf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Zi?s.Yc.be(u):u instanceof to?s.Yc.Oe(u):s.Yc.De(u),a.isEqual(oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Gh(s.Bc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yc.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Qc.get(e))&&r.Qc.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.Qc.get(t);e&&(r.Qc.set(t,e.it(Fr.h,e.nt)),gf(r,t),e=new Di(e.target,t,1,e.sequenceNumber),vf(r,e))}),r.Uc.Xc(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Tf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Tf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ga(r))throw r;return n.Wc.add(1),[4,pf(n)];case 1:return t.sent(),n.Hc.set("Offline"),i=i||function(){return Gh(n.Bc)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Wc.delete(1),[4,lf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function _f(e,n){return n().catch(function(t){return Tf(e,t,n)})}function Af(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=xf(i=a),s=0<i.Kc.length?i.Kc[i.Kc.length-1].batchId:-1,t.label=1;case 1:if(!(bf(i)&&i.Kc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Bc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Oi.Hr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Kc.length&&o.rc(),[3,7]):(s=u.batchId,function(t,e){t.Kc.push(e);t=xf(t);t.nc()&&t.Rc&&t.Pc(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Tf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Nf(i)&&Df(i),[2]}var e,n,r})})}function Nf(t){return bf(t)&&!xf(t).ec()&&0<t.Kc.length}function Df(t){xf(t).start()}function Sf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Wc.delete(2),[4,lf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Wc.add(2),[4,pf(e)]);case 3:t.sent(),e.Hc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Of(n){var t,e,r,i=this;return n.eu||(n.eu=(t=n.qc,e=n.cs,r={wc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Qc.forEach(function(t,e){vf(n,t)}),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return If(e),wf(e)?(e.Hc.$c(n),mf(e)):e.Hc.set("Unknown"),[2]})})}.bind(null,n),Tc:Ef.bind(null,n)},t.vc(),new nf(e,t.Ja,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.eu.ic(),wf(n)?mf(n):n.Hc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.eu.stop()];case 2:t.sent(),If(n),t.label=3;case 3:return[2]}})})})),n.eu}function xf(n){var t,e,r,i=this;return n.nu||(n.nu=(t=n.qc,e=n.cs,r={wc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return xf(e).Vc(),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&xf(e).Rc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Oi(n=i.code)&&n!==Tr.ABORTED?(e=r.Kc.shift(),xf(r).ic(),[4,_f(r,function(){return r.Uc.tu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Af(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Nf(e)&&Df(e),[2]}})})}.bind(null,n),yc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=xf(o),n=0,r=o.Kc;n<r.length;n++)i=r[n],e.Pc(i.mutations);return[2]})})}.bind(null,n),gc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kc.shift(),n=Wa.from(e,i,o),[4,_f(r,function(){return r.Uc.Zc(n)})];case 1:return t.sent(),[4,Af(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.vc(),new rf(e,t.Ja,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nu.ic(),[4,Af(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.nu.stop()];case 3:t.sent(),0<n.Kc.length&&(Or("RemoteStore","Stopping write stream with "+n.Kc.length+" pending writes"),n.Kc=[]),t.label=4;case 4:return[2]}})})})),n.nu}var kf=(Rf.prototype.P=function(){return this.su.P()},Rf.prototype.qo=function(t,e){e=new Pf(t,e);this.su=this.su.add(e),this.ru=this.ru.add(e)},Rf.prototype.au=function(t,e){var n=this;t.forEach(function(t){return n.qo(t,e)})},Rf.prototype.Ko=function(t,e){this.cu(new Pf(t,e))},Rf.prototype.uu=function(t,e){var n=this;t.forEach(function(t){return n.Ko(t,e)})},Rf.prototype.hu=function(t){var e=this,n=new ci(new si([])),r=new Pf(n,t),t=new Pf(n,t+1),i=[];return this.ru.xt([r,t],function(t){e.cu(t),i.push(t.key)}),i},Rf.prototype.lu=function(){var e=this;this.su.forEach(function(t){return e.cu(t)})},Rf.prototype.cu=function(t){this.su=this.su.delete(t),this.ru=this.ru.delete(t)},Rf.prototype._u=function(t){var e=new ci(new si([])),n=new Pf(e,t),t=new Pf(e,t+1),r=Hi();return this.ru.xt([n,t],function(t){r=r.add(t.key)}),r},Rf.prototype.ro=function(t){var e=new Pf(t,0),e=this.su.Ot(e);return null!==e&&t.isEqual(e.key)},Rf),Pf=(Lf.iu=function(t,e){return ci.D(t.key,e.key)||Ur(t.fu,e.fu)},Lf.ou=function(t,e){return Ur(t.fu,e.fu)||ci.D(t.key,e.key)},Lf);function Lf(t,e){this.key=t,this.fu=e}function Rf(){this.su=new Mi(Pf.iu),this.ru=new Mi(Pf.ou)}function Cf(t,e){return"firestore_clients_"+t+"_"+e}function Vf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Zs()&&(n+="_"+e.uid),n}function Uf(t,e){return"firestore_targets_"+t+"_"+e}var Mf=(ol.du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new ol(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},ol.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ol),qf=(il.du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new il(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},il.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},il),Ff=(rl.du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wi,o=0;r&&o<n.activeTargetIds.length;++o)r=wi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new rl(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},rl),jf=(nl.du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new nl(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},nl),Bf=(el.prototype.Eu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},el.prototype.Tu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},el.prototype.wu=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},el),Gf=(tl.Ln=function(t){return!(!t||!t.localStorage)},tl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.mu.va()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Iu&&(i=this.getItem(Cf(this.persistenceKey,r)))&&(o=Ff.du(r,i))&&(this.Pu=this.Pu.ot(o.clientId,o));for(this.Du(),(s=this.storage.getItem(this.Su))&&(u=this.Cu(s))&&this.Nu(u),a=0,c=this.gu;a<c.length;a++)h=c[a],this.Ru(h);return this.gu=[],this.window.addEventListener("unload",function(){return f.ga()}),this.br=!0,[2]}})})},tl.prototype.sr=function(t){this.setItem(this.Vu,JSON.stringify(t))},tl.prototype.xu=function(){return this.Fu(this.Pu)},tl.prototype.Ou=function(n){var r=!1;return this.Pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},tl.prototype.ku=function(t){this.Mu(t,"pending")},tl.prototype.$u=function(t,e,n){this.Mu(t,e,n),this.Lu(t)},tl.prototype.Bu=function(t){var e,n="not-current";return this.Ou(t)&&(!(e=this.storage.getItem(Uf(this.persistenceKey,t)))||(e=qf.du(t,e))&&(n=e.state)),this.qu.Eu(t),this.Du(),n},tl.prototype.Uu=function(t){this.qu.Tu(t),this.Du()},tl.prototype.Ku=function(t){return this.qu.activeTargetIds.has(t)},tl.prototype.Qu=function(t){this.removeItem(Uf(this.persistenceKey,t))},tl.prototype.Wu=function(t,e,n){this.ju(t,e,n)},tl.prototype.Gu=function(t,e,n){var r=this;e.forEach(function(t){r.Lu(t)}),this.currentUser=t,n.forEach(function(t){r.ku(t)})},tl.prototype.zu=function(t){this.Hu(t)},tl.prototype.ga=function(){this.br&&(this.window.removeEventListener("storage",this.Au),this.removeItem(this.yu),this.br=!1)},tl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Or("SharedClientState","READ",t,e),e},tl.prototype.setItem=function(t,e){Or("SharedClientState","SET",t,e),this.storage.setItem(t,e)},tl.prototype.removeItem=function(t){Or("SharedClientState","REMOVE",t),this.storage.removeItem(t)},tl.prototype.Ru=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Or("SharedClientState","EVENT",s.key,s.newValue),s.key===this.yu)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.br){if(null!==s.key)if(this.pu.test(s.key)){if(null==s.newValue)return e=this.Yu(s.key),[2,this.Ju(e,null)];if(e=this.Xu(s.key,s.newValue))return[2,this.Ju(e.clientId,e)]}else if(this.bu.test(s.key)){if(null!==s.newValue&&(n=this.Zu(s.key,s.newValue)))return[2,this.th(n)]}else if(this.vu.test(s.key)){if(null!==s.newValue&&(r=this.eh(s.key,s.newValue)))return[2,this.nh(r)]}else if(s.key===this.Su){if(null!==s.newValue&&(i=this.Cu(s.newValue)))return[2,this.Nu(i)]}else s.key===this.Vu&&(o=function(t){var e=Ja.ir;if(null!=t)try{var n=JSON.parse(t);Rr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==Ja.ir&&this.tr(o)}else this.gu.push(s);return[2]})})})}},Object.defineProperty(tl.prototype,"qu",{get:function(){return this.Pu.get(this.Iu)},enumerable:!1,configurable:!0}),tl.prototype.Du=function(){this.setItem(this.yu,this.qu.wu())},tl.prototype.Mu=function(t,e,n){n=new Mf(this.currentUser,t,e,n),t=Vf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.wu())},tl.prototype.Lu=function(t){t=Vf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},tl.prototype.Hu=function(t){t={clientId:this.Iu,onlineState:t};this.storage.setItem(this.Su,JSON.stringify(t))},tl.prototype.ju=function(t,e,n){var r=Uf(this.persistenceKey,t),n=new qf(t,e,n);this.setItem(r,n.wu())},tl.prototype.Yu=function(t){t=this.pu.exec(t);return t?t[1]:null},tl.prototype.Xu=function(t,e){t=this.Yu(t);return Ff.du(t,e)},tl.prototype.Zu=function(t,e){var n=this.bu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Mf.du(new Ma(n),t,e)},tl.prototype.eh=function(t,e){t=this.vu.exec(t),t=Number(t[1]);return qf.du(t,e)},tl.prototype.Cu=function(t){return jf.du(t)},tl.prototype.th=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.mu.sh(e.batchId,e.state,e.error)]:(Or("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},tl.prototype.nh=function(t){return this.mu.ih(t.targetId,t.state,t.error)},tl.prototype.Ju=function(t,e){var n=this,r=e?this.Pu.ot(t,e):this.Pu.remove(t),i=this.Fu(this.Pu),o=this.Fu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.mu.rh(s,u).then(function(){n.Pu=r})},tl.prototype.Nu=function(t){this.Pu.get(t.clientId)&&this.Cc(t.onlineState)},tl.prototype.Fu=function(t){var n=Wi;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},tl),zf=(Zf.prototype.ku=function(t){},Zf.prototype.$u=function(t,e,n){},Zf.prototype.Bu=function(t){return this.oh.Eu(t),this.ah[t]||"not-current"},Zf.prototype.Wu=function(t,e,n){this.ah[t]=e},Zf.prototype.Uu=function(t){this.oh.Tu(t)},Zf.prototype.Ku=function(t){return this.oh.activeTargetIds.has(t)},Zf.prototype.Qu=function(t){delete this.ah[t]},Zf.prototype.xu=function(){return this.oh.activeTargetIds},Zf.prototype.Ou=function(t){return this.oh.activeTargetIds.has(t)},Zf.prototype.start=function(){return this.oh=new Bf,Promise.resolve()},Zf.prototype.Gu=function(t,e,n){},Zf.prototype.zu=function(t){},Zf.prototype.ga=function(){},Zf.prototype.sr=function(t){},Zf),Kf=function(t){this.key=t},Hf=function(t){this.key=t},Wf=(Object.defineProperty($f.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),$f.prototype.wh=function(t,e){var s=this,u=e?e.Eh:new Yi,a=(e||this).fh,c=(e||this).Qt,h=a,f=!1,l=du(this.query)&&a.size===this.query.limit?a.last():null,p=yu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof ou?e:null)&&(Du(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s._h(r,l)||p&&s._h(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),du(this.query)||yu(this.query))for(;h.size>this.query.limit;){var n=du(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,Eh:u,Ih:f,Qt:c}},$f.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},$f.prototype.Di=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Qt=t.Qt;var i=t.Eh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.mh(n);var s=e?this.Ah():[],n=0===this.lh.size&&this.te?1:0,e=n!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new Xi(this.query,t.fh,r,i,t.Qt,0==n,e,!1),Rh:s}:{Rh:s}},$f.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Di({fh:this.fh,Eh:new Yi,Qt:this.Qt,Ih:!1},!1)):{Rh:[]}},$f.prototype.Ph=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},$f.prototype.mh=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},$f.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=Hi(),this.fh.forEach(function(t){e.Ph(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new Hf(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new Kf(t))}),r},$f.prototype.gh=function(t){this.uh=t.za,this.lh=Hi();t=this.wh(t.documents);return this.Di(t,!0)},$f.prototype.yh=function(){return Xi.Gt(this.query,this.fh,this.Qt,0===this.hh)},$f),Qf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yf=function(t){this.key=t,this.Vh=!1},Xf=(Object.defineProperty(Jf.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),Jf);function Jf(t,e,n,r,i,o){this.Bc=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new ri(Au,_u),this.xh=new Map,this.Fh=[],this.Oh=new ki(ci.D),this.kh=new Map,this.Mh=new kf,this.$h={},this.Lh=new Map,this.Bh=bh.Vo(),this.onlineState="Unknown",this.qh=void 0}function $f(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=Hi(),this.Qt=Hi(),this._h=Su(t),this.fh=new Qi(this._h)}function Zf(){this.oh=new Bf,this.ah={},this.Cc=null,this.tr=null}function tl(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this.Iu=r,this.mu=null,this.Cc=null,this.tr=null,this.Au=this.Ru.bind(this),this.Pu=new ki(Ur),this.br=!1,this.gu=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.yu=Cf(this.persistenceKey,this.Iu),this.Vu="firestore_sequence_number_"+this.persistenceKey,this.Pu=this.Pu.ot(this.Iu,new Bf),this.pu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.bu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.vu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Su="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Au)}function el(){this.activeTargetIds=Wi}function nl(t,e){this.clientId=t,this.onlineState=e}function rl(t,e){this.clientId=t,this.activeTargetIds=e}function il(t,e,n){this.targetId=t,this.state=e,this.error=n}function ol(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function sl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Kh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Ih?[4,Wh(r.Bc,i.query,!1).then(function(t){t=t.documents;return i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Di(e,r.Uh,n),[2,(vl(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,Wh(i.Bc,o,!0)];case 1:return n=t.sent(),r=new Wf(o,n.za),e=r.wh(n.documents),n=$i.Zt(s,u&&"Offline"!==i.onlineState),n=r.Di(e,i.Uh,n),vl(i,s,n.Rh),r=new Qf(o,s,r),[2,(i.Nh.set(o,r),i.xh.has(s)?i.xh.get(s).push(o):i.xh.set(s,[o]),n.snapshot)]}})})}function ul(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Al(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Bc,a=p,h=i,f=ii.now(),o=a.reduce(function(t,e){return t.add(e.key)},Hi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.qi(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Gs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ou?t.field(i.field):void 0,o=us(i.transform,o||null);null!=o&&(e=(null==e?new Js:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Ms(i.key,o,function s(t){var u=[];return Zr(t.fields||{},function(t,e){var n=new ai([t]);if(ko(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new _s(u)}(o.proto.mapValue),Ss.exists(!0)))}return h.Oi.Wr(u,f,e,a)})}).then(function(t){var e=t.Ii(c);return{batchId:t.batchId,Ri:e}}))];case 2:return s=t.sent(),u.Sh.ku(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$h[e.currentUser.ti()])||new ki(Ur)).ot(n,r),e.$h[e.currentUser.ti()]=i,[4,ml(u,s.Ri)];case 3:return t.sent(),[4,Af(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ka(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function al(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,zh(n.Bc,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.kh.get(e);e&&(Rr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Vh=!0:0<t.ne.size?Rr(e.Vh):0<t.se.size&&(Rr(e.Vh),e.Vh=!1))}),[4,ml(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function cl(t,n,e){var r,t=t;(t.Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){e=e.view.Ks(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Va(t)}(t.bh,n),r.length&&t.Ch.Tc(r),t.onlineState=n,t.Uh&&t.Sh.zu(n))}function hl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Oi.Gr(e,r).next(function(t){return Rr(null!==t),n=t.keys(),i.Oi.Zr(e,t)}).next(function(){return i.Oi.io(e)}).next(function(){return i.Ka.qi(e,n)})}))];case 2:return o=t.sent(),pl(n,u,a),ll(n,u),n.Sh.$u(u,"rejected",a),[4,ml(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function fl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:bf((n=o).ph)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Oi.Yr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=t.sent(),i=ka(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function ll(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function pl(t,e,n){var r=t,i=r.$h[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$h[r.currentUser.ti()]=i)}function dl(e,t,n){void 0===n&&(n=null),e.Sh.Uu(t);for(var r=0,i=e.xh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Qh(o,n)}e.xh.delete(t),e.Uh&&e.Mh.hu(t).forEach(function(t){e.Mh.ro(t)||yl(e,t)})}function yl(t,e){var n=t.Oh.get(e);null!==n&&(yf(t.ph,n),t.Oh=t.Oh.remove(e),t.kh.delete(n),gl(t))}function vl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Kf?(t.Mh.qo(o.key,e),function(t,e){e=e.key;t.Oh.get(e)||(Or("SyncEngine","New document in limbo: "+e),t.Fh.push(e),gl(t))}(t,o)):o instanceof Hf?(Or("SyncEngine","Document no longer in limbo: "+o.key),t.Mh.Ko(o.key,e),t.Mh.ro(o.key)||yl(t,o.key)):Lr()}}function gl(t){for(;0<t.Fh.length&&t.Oh.size<t.Dh;){var e=t.Fh.shift(),n=t.Bh.next();t.kh.set(n,new Yf(e)),t.Oh=t.Oh.ot(e,n),df(t.ph,new Di(bu(pu(e.path)),n,2,Ja.ir))}}function ml(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.P()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Kh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Wu(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Xa.Zi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.Tc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return aa.forEach(c,function(e){return aa.forEach(e.Ji,function(t){return r.persistence.qr.qo(n,e.targetId,t)}).next(function(){return aa.forEach(e.Xi,function(t){return r.persistence.qr.Ko(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.La.get(o),u=s.nt,u=s.rt(u),r.La=r.La.ot(o,u));return[2]}})})}(n.Bc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function wl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.ti()),[4,jh(n.Bc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new _r(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.Gu(o,r.ja,r.Ga),[4,ml(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function bl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Bc,n=a,i=(r=e).Oi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.zr(e,n).next(function(t){return t?r.Ka.qi(e,t):aa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Af(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(pl(o,a,h||null),ll(o,a),o.Bc.Oi.no(a)):Lr(),t.label=4;case 4:return[4,ml(o,s)];case 5:return t.sent(),[3,7];case 6:Or("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Il(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return _l(r=h),Al(r),!0!==f||!0===r.qh?[3,3]:(e=r.Sh.xu(),[4,El(r,e.L())]);case 1:return i=t.sent(),r.qh=!0,[4,Sf(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],df(r.ph,u);return[3,7];case 3:return!1!==f||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.xh.forEach(function(t,e){r.Sh.Ku(e)?a.push(e):c=c.then(function(){return dl(r,e),Hh(r.Bc,e,!0)}),yf(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,El(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){yf(n.ph,e)}),n.Mh.lu(),n.kh=new Map,n.Oh=new ki(ci.D),r.qh=!1,[4,Sf(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function El(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xh.get(s))&&0!==a.length?[4,Kh(e.Bc,bu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Wh((e=r).Bc,i.query,!0)];case 1:return n=t.sent(),n=i.view.gh(n),[2,(e.Uh&&vl(e,i.targetId,n.Rh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Qh(e.Bc,s)];case 8:return l=t.sent(),[4,Kh(e.Bc,l)];case 9:return u=t.sent(),[4,sl(e,Tl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.Tc(r),n)]}})})}function Tl(t){return lu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function _l(t){return t.ph.Uc.Xc=al.bind(null,t),t.ph.Uc.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.Vh)return Hi().add(t.key);var r=Hi();if(!(e=n.xh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Uc.Jc=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Wu(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new ki(ci.D)).ot(n,new su(n,oi.min())),i=Hi().add(n),i=new Ji(oi.min(),new Map,new Mi(Ur),r,i),[4,al(e,i)]):[3,2];case 1:return t.sent(),e.Oh=e.Oh.remove(n),e.kh.delete(s),gl(e),[3,4];case 2:return[4,Hh(e.Bc,s,!1).then(function(){return dl(e,s,u)}).catch(Jh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.Tc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Bs.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Va(n)}.bind(null,t.bh),t.Ch.Qh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function Al(t){return t.ph.Uc.Zc=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Bh(e.Bc,o)];case 2:return r=t.sent(),pl(e,n,null),ll(e,n),e.Sh.$u(n,"acknowledged"),[4,ml(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.ph.Uc.tu=hl.bind(null,t),t}var Nl,Dl,Sl,Ol=(tp.prototype.Qa=function(t){this.Wh=t},tp.prototype.Qi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(oi.min())?this.jh(e,r):this.Wh.qi(e,o).next(function(t){var n=s.Gh(r,t);return(du(r)||yu(r))&&s.Ih(r.an,n,o,i)?s.jh(e,r):(Sr()<=l.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nu(r)),s.Wh.Qi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},tp.prototype.Gh=function(n,t){var r=new Mi(Su(n));return t.forEach(function(t,e){e instanceof ou&&Du(n,e)&&(r=r.add(e))}),r},tp.prototype.Ih=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},tp.prototype.jh=function(t,e){return Sr()<=l.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",Nu(e)),this.Wh.Qi(t,e,oi.min())},tp),xl=(Zl.prototype.Qr=function(t){return aa.resolve(0===this.Oi.length)},Zl.prototype.Wr=function(t,e,n,r){var i=this.zh;this.zh++,0<this.Oi.length&&this.Oi[this.Oi.length-1];n=new Ha(i,e,n,r);this.Oi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Hh=this.Hh.add(new Pf(u.key,i)),this.ki.jr(t,u.key.path.F())}return aa.resolve(n)},Zl.prototype.Gr=function(t,e){return aa.resolve(this.Yh(e))},Zl.prototype.Hr=function(t,e){e+=1,e=this.Jh(e),e=e<0?0:e;return aa.resolve(this.Oi.length>e?this.Oi[e]:null)},Zl.prototype.Yr=function(){return aa.resolve(0===this.Oi.length?-1:this.zh-1)},Zl.prototype.Jr=function(t){return aa.resolve(this.Oi.slice())},Zl.prototype.$i=function(t,e){var n=this,r=new Pf(e,0),e=new Pf(e,Number.POSITIVE_INFINITY),i=[];return this.Hh.xt([r,e],function(t){t=n.Yh(t.fu);i.push(t)}),aa.resolve(i)},Zl.prototype.Ki=function(t,e){var n=this,r=new Mi(Ur);return e.forEach(function(t){var e=new Pf(t,0),t=new Pf(t,Number.POSITIVE_INFINITY);n.Hh.xt([e,t],function(t){r=r.add(t.fu)})}),aa.resolve(this.Xh(r))},Zl.prototype.Hi=function(t,e){var n=e.path,r=n.length+1,e=n;ci.X(e)||(e=e.child(""));var e=new Pf(new ci(e),0),i=new Mi(Ur);return this.Hh.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.fu)),!0)},e),aa.resolve(this.Xh(i))},Zl.prototype.Xh=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Yh(t);null!==t&&n.push(t)}),n},Zl.prototype.Zr=function(n,r){var i=this;Rr(0===this.Zh(r.batchId,"removed")),this.Oi.shift();var o=this.Hh;return aa.forEach(r.mutations,function(t){var e=new Pf(t.key,r.batchId);return o=o.delete(e),i.qr.so(n,t.key)}).next(function(){i.Hh=o})},Zl.prototype.no=function(t){},Zl.prototype.ro=function(t,e){var n=new Pf(e,0),n=this.Hh.Ot(n);return aa.resolve(e.isEqual(n&&n.key))},Zl.prototype.io=function(t){return this.Oi.length,aa.resolve()},Zl.prototype.Zh=function(t,e){return this.Jh(t)},Zl.prototype.Jh=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},Zl.prototype.Yh=function(t){t=this.Jh(t);return t<0||t>=this.Oi.length?null:this.Oi[t]},Zl),kl=($l.prototype.yi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.tl(e);return this.docs=this.docs.ot(r,{ho:e,size:i,readTime:n}),this.size+=i-o,this.ki.jr(t,r.path.F())},$l.prototype.pi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},$l.prototype.bi=function(t,e){e=this.docs.get(e);return aa.resolve(e?e.ho:null)},$l.prototype.getEntries=function(t,e){var n=this,r=Fi;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ho:null)}),aa.resolve(r)},$l.prototype.Qi=function(t,e,n){for(var r=Gi,i=new ci(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.ho,a=a.readTime;if(!e.path.M(u.path))break;a.u(n)<=0||s instanceof ou&&Du(e,s)&&(r=r.ot(s.key,s))}return aa.resolve(r)},$l.prototype.el=function(t,e){return aa.forEach(this.docs,function(t){return e(t)})},$l.prototype.wo=function(t){return new Pl(this)},$l.prototype.To=function(t){return aa.resolve(this.size)},$l),Pl=(n(Jl,Sl=h),Jl.prototype.Di=function(n){var r=this,i=[];return this.Ri.forEach(function(t,e){e?i.push(r.Io.yi(n,e,r.readTime)):r.Io.pi(t)}),aa.On(i)},Jl.prototype.vi=function(t,e){return this.Io.bi(t,e)},Jl.prototype.Si=function(t,e){return this.Io.getEntries(t,e)},Jl),Ll=(Xl.prototype.Ce=function(t,n){return this.nl.forEach(function(t,e){return n(e)}),aa.resolve()},Xl.prototype.So=function(t){return aa.resolve(this.lastRemoteSnapshotVersion)},Xl.prototype.Do=function(t){return aa.resolve(this.sl)},Xl.prototype.po=function(t){return this.highestTargetId=this.rl.next(),aa.resolve(this.highestTargetId)},Xl.prototype.Co=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sl&&(this.sl=e),aa.resolve()},Xl.prototype.xo=function(t){this.nl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.rl=new bh(e),this.highestTargetId=e),t.sequenceNumber>this.sl&&(this.sl=t.sequenceNumber)},Xl.prototype.No=function(t,e){return this.xo(e),this.targetCount+=1,aa.resolve()},Xl.prototype.Oo=function(t,e){return this.xo(e),aa.resolve()},Xl.prototype.ko=function(t,e){return this.nl.delete(e.target),this.il.hu(e.targetId),--this.targetCount,aa.resolve()},Xl.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return this.nl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.nl.delete(t),u.push(o.Mo(n,e.targetId)),s++)}),aa.On(u).next(function(){return s})},Xl.prototype.$o=function(t){return aa.resolve(this.targetCount)},Xl.prototype.Lo=function(t,e){e=this.nl.get(e)||null;return aa.resolve(e)},Xl.prototype.Bo=function(t,e,n){return this.il.au(e,n),aa.resolve()},Xl.prototype.Uo=function(e,t,n){this.il.uu(t,n);var r=this.persistence.qr,i=[];return r&&t.forEach(function(t){i.push(r.so(e,t))}),aa.On(i)},Xl.prototype.Mo=function(t,e){return this.il.hu(e),aa.resolve()},Xl.prototype.Qo=function(t,e){e=this.il._u(e);return aa.resolve(e)},Xl.prototype.ro=function(t,e){return aa.resolve(this.il.ro(e))},Xl),Rl=(Yl.prototype.start=function(){return Promise.resolve()},Yl.prototype.ga=function(){return this.Ho=!1,Promise.resolve()},Object.defineProperty(Yl.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),Yl.prototype.ha=function(){},Yl.prototype.la=function(){},Yl.prototype.Na=function(){return this.ki},Yl.prototype.Sa=function(t){var e=this.ol[t.ti()];return e||(e=new xl(this.ki,this.qr),this.ol[t.ti()]=e),e},Yl.prototype.Da=function(){return this.sa},Yl.prototype.Ca=function(){return this.Fi},Yl.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Cl(this.zo.next());return this.qr.cl(),n(i).next(function(t){return r.qr.ul(i).next(function(){return t})}).xn().then(function(t){return i.xi(),t})},Yl.prototype.hl=function(e,n){return aa.kn(Object.values(this.ol).map(function(t){return function(){return t.ro(e,n)}}))},Yl),Cl=(n(Ql,Dl=Ee),Ql),Vl=(Wl.fl=function(t){return new Wl(t)},Object.defineProperty(Wl.prototype,"dl",{get:function(){if(this._l)return this._l;throw Lr()},enumerable:!1,configurable:!0}),Wl.prototype.qo=function(t,e,n){return this.ll.qo(n,e),this.dl.delete(n.toString()),aa.resolve()},Wl.prototype.Ko=function(t,e,n){return this.ll.Ko(n,e),this.dl.add(n.toString()),aa.resolve()},Wl.prototype.so=function(t,e){return this.dl.add(e.toString()),aa.resolve()},Wl.prototype.removeTarget=function(t,e){var n=this;this.ll.hu(e.targetId).forEach(function(t){return n.dl.add(t.toString())});var r=this.persistence.Da();return r.Qo(t,e.targetId).next(function(t){t.forEach(function(t){return n.dl.add(t.toString())})}).next(function(){return r.ko(t,e)})},Wl.prototype.cl=function(){this._l=new Set},Wl.prototype.ul=function(n){var r=this,i=this.persistence.Ca().wo();return aa.forEach(this.dl,function(t){var e=ci.H(t);return r.wl(n,e).next(function(t){t||i.pi(e)})}).next(function(){return r._l=null,i.apply(n)})},Wl.prototype.Ma=function(t,e){var n=this;return this.wl(t,e).next(function(t){t?n.dl.delete(e.toString()):n.dl.add(e.toString())})},Wl.prototype.al=function(t){return 0},Wl.prototype.wl=function(t,e){var n=this;return aa.kn([function(){return aa.resolve(n.ll.ro(e))},function(){return n.persistence.Da().ro(t,e)},function(){return n.persistence.hl(t,e)}])},Wl),Ul=(Hl.prototype.wc=function(t){this.Il=t},Hl.prototype.hc=function(t){this.ml=t},Hl.prototype.onMessage=function(t){this.Al=t},Hl.prototype.close=function(){this.Tl()},Hl.prototype.send=function(t){this.El(t)},Hl.prototype.Rl=function(){this.Il()},Hl.prototype.Pl=function(t){this.ml(t)},Hl.prototype.gl=function(t){this.Al(t)},Hl),Ml={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ql=(Kl.prototype.Sc=function(e,t,n,r){var i=this.bl(e,t);Or("RestConnection","Sending: ",i,n);t={};return this.vl(t,r),this.Sl(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Kl.prototype.Dc=function(t,e,n,r){return this.Sc(t,e,n,r)},Kl.prototype.vl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.1-2020103231751",t["Content-Type"]="text/plain",e)for(var n in e.si)e.si.hasOwnProperty(n)&&(t[n]=e.si[n])},Kl.prototype.bl=function(t,e){t=Ml[t];return this.Vl+"/v1/"+e+":"+t},n(zl,Nl=Kl),zl.prototype.Sl=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new _r(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new _r(e,t.message))):r(new _r(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Tr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},zl.prototype.Ec=function(t,e){var n,r=[this.Vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.vl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Or("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Ul({El:function(t){u?Or("Connection","Not sending because WebChannel is closed:",t):(s||(Or("Connection","Opening WebChannel transport."),o.open(),s=!0),Or("Connection","WebChannel sending:",t),o.send(t))},Tl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Or("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Or("Connection","WebChannel transport closed"),a.Pl())}),t(mr.EventType.ERROR,function(t){u||(u=!0,kr("Connection","WebChannel transport errored:",t),a.Pl(new _r(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Rr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ni[r];if(void 0!==t)return xi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Pl(new _r(t,i)),o.close()):(Or("Connection","WebChannel received:",e),a.gl(e)))}),setTimeout(function(){a.Rl()},0),a},zl),Fl=(Gl.prototype.zc=function(t){this.Fl.push(t)},Gl.prototype.ga=function(){window.removeEventListener("online",this.Dl),window.removeEventListener("offline",this.Nl)},Gl.prototype.Ol=function(){window.addEventListener("online",this.Dl),window.addEventListener("offline",this.Nl)},Gl.prototype.Cl=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(0)},Gl.prototype.xl=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(1)},Gl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Gl),jl=(Bl.prototype.zc=function(t){},Bl.prototype.ga=function(){},Bl);function Bl(){}function Gl(){var t=this;this.Dl=function(){return t.Cl()},this.Nl=function(){return t.xl()},this.Fl=[],this.Ol()}function zl(t){var e=this;return(e=Nl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Kl(t){this.yl=t,this._=t._;var e=t.ssl?"https":"http";this.Vl=e+"://"+t.host,this.pl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Hl(t){this.El=t.El,this.Tl=t.Tl}function Wl(t){this.persistence=t,this.ll=new kf,this._l=null}function Ql(t){var e=this;return(e=Dl.call(this)||this).Wo=t,e}function Yl(t){var e=this;this.ol={},this.zo=new Ja(0),this.Ho=!1,this.Ho=!0,this.qr=t(this),this.sa=new Ll(this),this.ki=new Qc,this.Fi=(t=this.ki,new kl(t,function(t){return e.qr.al(t)}))}function Xl(t){this.persistence=t,this.nl=new ri(Ei,Ti),this.lastRemoteSnapshotVersion=oi.min(),this.highestTargetId=0,this.sl=0,this.il=new kf,this.targetCount=0,this.rl=bh.yo()}function Jl(t){var e=this;return(e=Sl.call(this)||this).Io=t,e}function $l(t,e){this.ki=t,this.tl=e,this.docs=new ki(ci.D),this.size=0}function Zl(t,e){this.ki=t,this.qr=e,this.Oi=[],this.zh=1,this.Hh=new Mi(Pf.iu)}function tp(){}function ep(t){return new Ro(t,!0)}var np,rp,ip=(pp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.kl(e),this.persistence=this.Ml(e),[4,this.persistence.start()];case 1:return t.sent(),this.$l=this.Ll(e),this.Bc=this.Bl(e),[2]}})})},pp.prototype.Ll=function(t){return null},pp.prototype.Bl=function(t){return e=this.persistence,n=new Ol,t=t.ql,new qh(e,n,t);var e,n},pp.prototype.Ml=function(t){return new Rl(Vl.fl)},pp.prototype.kl=function(t){return new zf},pp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$l&&this.$l.stop(),[4,this.Sh.ga()];case 1:return t.sent(),[4,this.persistence.ga()];case 2:return t.sent(),[2]}})})},pp),op=(n(lp,rp=ip),lp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Xh(this.Bc)];case 2:return t.sent(),[4,this.Ul.initialize(this,e)];case 3:return t.sent(),[4,Al(this.Ul.mu)];case 4:return t.sent(),[4,Af(this.Ul.ph)];case 5:return t.sent(),[2]}})})},lp.prototype.Ll=function(t){var e=this.persistence.qr.gr;return new yc(e,t.cs)},lp.prototype.Ml=function(t){var e=Mh(t.yl._,t.yl.persistenceKey),n=void 0!==this.cacheSizeBytes?lc.Ir(this.cacheSizeBytes):lc.Rr,r=ep(t.yl._);return new xh(this.synchronizeTabs,e,t.clientId,n,t.cs,Aa(),Na(),r,this.Sh,!!this.forceOwnership)},lp.prototype.kl=function(t){return new zf},lp),sp=(n(fp,np=op),fp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,np.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Ul.mu,this.Sh instanceof Gf?(this.Sh.mu={sh:bl.bind(null,e),ih:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).qh?(Or("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.xh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Yh(e.Bc)];case 3:return n=t.sent(),r=Ji.Xt(o,"current"===s),[4,ml(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Hh(e.Bc,o,!0)];case 6:return t.sent(),dl(e,o,u),[3,8];case 7:Lr(),t.label=8;case 8:return[2]}})})}.bind(null,e),rh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=_l(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xh.has(r)?(Or("SyncEngine","Adding an already active target "+r),[3,5]):[4,Qh(n.Bc,r)]):[3,6];case 2:return i=t.sent(),[4,Kh(n.Bc,i)];case 3:return o=t.sent(),[4,sl(n,Tl(i),o.targetId,!1)];case 4:t.sent(),df(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xh.has(e)?[4,Hh(n.Bc,e,!1).then(function(){yf(n.ph,e),dl(n,e)}).catch(Jh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),va:function(t){return t.Bc.persistence.va()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.ua(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Il(this.Ul.mu,e)];case 1:return t.sent(),this.$l&&(e&&!this.$l.br?this.$l.start(this.Bc):e||this.$l.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},fp.prototype.kl=function(t){var e=Aa();if(!Gf.Ln(e))throw new _r(Tr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Mh(t.yl._,t.yl.persistenceKey);return new Gf(e,t.cs,n,t.clientId,t.ql)},fp),up=(hp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Bc?[3,2]:(this.Bc=n.Bc,this.Sh=n.Sh,this.qc=this.Kl(r),this.ph=this.Ql(r),this.bh=this.Wl(r),this.mu=this.jl(r,!n.synchronizeTabs),this.Sh.Cc=function(t){return cl(e.mu,t,1)},this.ph.Uc.Gl=wl.bind(null,this.mu),[4,Sf(this.ph,this.mu.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hp.prototype.Wl=function(t){return new Pa},hp.prototype.Kl=function(t){var e=ep(t.yl._),n=(n=t.yl,new ql(n));return t=t.credentials,new of(t,n,e)},hp.prototype.Ql=function(t){var e=this,n=this.Bc,r=this.qc,i=t.cs,o=function(t){return cl(e.mu,t,0)},t=new(Fl.Ln()?Fl:jl);return new $h(n,r,i,o,t)},hp.prototype.jl=function(t,e){return function(t,e,n,r,i,o,s){o=new Xf(t,e,n,r,i,o);return s&&(o.qh=!0),o}(this.Bc,this.ph,this.bh,this.Sh,t.ql,t.Dh,e)},hp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Wc.add(5),[4,pf(e)];case 1:return t.sent(),e.Gc.ga(),e.Hc.set("Unknown"),[2]}})})}(this.ph)},hp),ap=(cp.prototype.next=function(t){this.observer.next&&this.zl(this.observer.next,t)},cp.prototype.error=function(t){this.observer.error?this.zl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},cp.prototype.Hl=function(){this.muted=!0},cp.prototype.zl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},cp);function cp(t){this.observer=t,this.muted=!1}function hp(){}function fp(t,e){var n=this;return(n=np.call(this,t,e,!1)||this).Ul=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function lp(t,e,n){var r=this;return(r=rp.call(this)||this).Ul=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function pp(){this.synchronizeTabs=!1}function dp(t,e,n){if(!n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function yp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function vp(t,e,n,r){if(!0===e&&!0===r)throw new _r(Tr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function gp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function mp(t,e){if(e<=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var wp,bp,Ip=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yl=new ai(t)},Ep=(n(Dp,bp=Ip),Dp.documentId=function(){return new Dp(ai.j().B())},Dp.prototype.isEqual=function(t){return t instanceof Dp&&this.Yl.isEqual(t.Yl)},Dp),Tp=new RegExp("[~\\*/\\[\\]]"),_p=function(t){this.Jl=t},Ap=(n(Np,wp=_p),Np.prototype.Xl=function(t){if(2!==t.Zl)throw 1===t.Zl?t.t_(this.Jl+"() can only appear at the top level of your update data"):t.t_(this.Jl+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Np.prototype.isEqual=function(t){return t instanceof Np},Np);function Np(){return null!==wp&&wp.apply(this,arguments)||this}function Dp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bp.call(this,t)||this}function Sp(t,e,n){return new Jp({Zl:3,e_:e.settings.e_,methodName:t.Jl,n_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Op,xp,kp,Pp,Lp=(n(Yp,Pp=_p),Yp.prototype.Xl=function(t){return new As(t.path,new hs)},Yp.prototype.isEqual=function(t){return t instanceof Yp},Yp),Rp=(n(Qp,kp=_p),Qp.prototype.Xl=function(t){var e=Sp(this,t,!0),n=this.s_.map(function(t){return od(t,e)}),n=new fs(n);return new As(t.path,n)},Qp.prototype.isEqual=function(t){return this===t},Qp),Cp=(n(Wp,xp=_p),Wp.prototype.Xl=function(t){var e=Sp(this,t,!0),n=this.s_.map(function(t){return od(t,e)}),n=new vs(n);return new As(t.path,n)},Wp.prototype.isEqual=function(t){return this===t},Wp),Vp=(n(Hp,Op=_p),Hp.prototype.Xl=function(t){var e=new bs(t.serializer,Uo(t.serializer,this.i_));return new As(t.path,e)},Hp.prototype.isEqual=function(t){return this===t},Hp),Up=(Object.defineProperty(Kp.prototype,"latitude",{get:function(){return this.r_},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"longitude",{get:function(){return this.o_},enumerable:!1,configurable:!0}),Kp.prototype.isEqual=function(t){return this.r_===t.r_&&this.o_===t.o_},Kp.prototype.toJSON=function(){return{latitude:this.r_,longitude:this.o_}},Kp.prototype.g=function(t){return Ur(this.r_,t.r_)||Ur(this.o_,t.o_)},Kp),Mp=function(t){this.a_=t},qp=/^__.*__$/,Fp=function(t,e,n){this.c_=t,this.u_=e,this.h_=n},jp=(zp.prototype.l_=function(t,e){var n=[];return null!==this.Qe?n.push(new Ms(t,this.data,this.Qe,e)):n.push(new Us(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},zp),Bp=(Gp.prototype.l_=function(t,e){e=[new Ms(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Gs(t,this.fieldTransforms)),e},Gp);function Gp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function zp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Kp(t,e){if(!isFinite(t)||t<-90||90<t)throw new _r(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.r_=t,this.o_=e}function Hp(t,e){var n=this;return(n=Op.call(this,t)||this).i_=e,n}function Wp(t,e){var n=this;return(n=xp.call(this,t)||this).s_=e,n}function Qp(t,e){var n=this;return(n=kp.call(this,t)||this).s_=e,n}function Yp(){return null!==Pp&&Pp.apply(this,arguments)||this}function Xp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Jp=(Object.defineProperty(td.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"Zl",{get:function(){return this.settings.Zl},enumerable:!1,configurable:!0}),td.prototype.f_=function(t){return new td(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},td.prototype.d_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.f_({path:e,n_:!1});return e.w_(t),e},td.prototype.E_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.f_({path:t,n_:!1});return t.__(),t},td.prototype.T_=function(t){return this.f_({path:void 0,n_:!0})},td.prototype.t_=function(t){return fd(t,this.settings.methodName,this.settings.I_||!1,this.path,this.settings.e_)},td.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},td.prototype.__=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.w_(this.path.get(t))},td.prototype.w_=function(t){if(0===t.length)throw this.t_("Document fields must not be empty");if(Xp(this.Zl)&&qp.test(t))throw this.t_('Document fields cannot begin and end with "__"')},td),$p=(Zp.prototype.m_=function(t,e,n,r){return void 0===r&&(r=!1),new Jp({Zl:t,methodName:e,e_:n,path:ai.U(),n_:!1,I_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Zp);function Zp(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||ep(t)}function td(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.__(),this.fieldTransforms=i||[],this.Qe=o||[]}function ed(t,e,n,r,i,o){void 0===o&&(o={});var s=t.m_(o.merge||o.mergeFields?2:0,e,n,i);ad("Data must be an object, but it was:",s,r);var u,a,r=sd(r,s);if(o.merge)u=new _s(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof Ip)p=l.Yl;else{if("string"!=typeof l)throw Lr();p=hd(e,l,n)}if(!s.contains(p))throw new _r(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ld(c,p)||c.push(p)}u=new _s(c),a=s.fieldTransforms.filter(function(t){return u.Ye(t.field)})}else u=null,a=s.fieldTransforms;return new jp(new Xs(r),u,a)}function nd(t,r,i,e){var o=t.m_(1,r,i);ad("Data must be an object, but it was:",o,e);var s=[],u=new Js;Zr(e,function(t,e){var n=hd(r,t,i),t=o.E_(n);e instanceof Ap||e instanceof Mp&&e.a_ instanceof Ap?s.push(n):null!=(t=od(e,t))&&(s.push(n),u.set(n,t))});e=new _s(s);return new Bp(u.Xe(),e,o.fieldTransforms)}function rd(t,e,n,r,i,o){var s=t.m_(1,e,n),u=[cd(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(cd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Js,y=u.length-1;0<=y;--y){ld(p,u[y])||(h=u[y],f=a[y],l=s.E_(h),f instanceof Ap||f instanceof Mp&&f.a_ instanceof Ap?p.push(h):null!=(l=od(f,l))&&(p.push(h),d.set(h,l)))}i=new _s(p);return new Bp(d.Xe(),i,s.fieldTransforms)}function id(t,e,n,r){return void 0===r&&(r=!1),od(n,t.m_(r?4:3,e))}function od(s,t){if(s instanceof Mp&&(s=s.a_),ud(s))return ad("Unsupported field value:",t,s),sd(s,t);if(s instanceof _p)return function(t,e){if(!Xp(e.Zl))throw e.t_(t.Jl+"() can only be used with update() and set()");if(!e.path)throw e.t_(t.Jl+"() is not currently supported inside arrays");t=t.Xl(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.n_&&4!==t.Zl)throw t.t_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=od(i[r],t.T_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ii.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof ii){var r=new ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof Up)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Br)return{bytesValue:qo(e.serializer,t.l)};if(t instanceof Fp){n=e._,r=t.c_;if(!r.isEqual(n))throw e.t_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.c_||e._,t.u_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.t_("Unsupported field value: "+gp(t))}(s,t)}function sd(t,n){var r={};return ti(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Zr(t,function(t,e){e=od(e,n.d_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function ud(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ii||t instanceof Up||t instanceof Br||t instanceof Fp||t instanceof _p)}function ad(t,e,n){if(!ud(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=gp(n);throw"an object"===n?e.t_(t+" a custom object"):e.t_(t+" "+n)}var r}function cd(t,e,n){if(e instanceof Ip)return e.Yl;if("string"==typeof e)return hd(t,e);throw fd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function hd(t,e,n){try{return function(e){if(0<=e.search(Tp))throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ep.bind.apply(Ep,i([void 0],e.split("."))))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yl}catch(e){throw fd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function fd(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function ld(t,e){return t.some(function(t){return t.isEqual(e)})}var pd=(md.prototype.y_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),0<this.mutations.length)throw new _r(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Wo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Go(n.serializer,t)})},[4,n.Dc("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=zo(t,e.found.name),t=Fo(e.found.updateTime),e=new Xs({mapValue:{fields:e.found.fields}});return new ou(n,t,e,{})}(e,t):"missing"in t?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);t=zo(t,e.missing),e=Fo(e.readTime);return new su(t,e)}(e,t):Lr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Rr(!!t),o.push(t)}),o)]}})})}(this.qc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof su||t instanceof ou?n.p_(t):Lr()}),e)]}})})},md.prototype.set=function(t,e){this.write(e.l_(t,this.Ge(t))),this.g_.add(t.toString())},md.prototype.update=function(t,e){try{this.write(e.l_(t,this.b_(t)))}catch(t){this.P_=t}this.g_.add(t.toString())},md.prototype.delete=function(t){this.write([new Qs(t,this.Ge(t))]),this.g_.add(t.toString())},md.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),this.P_)throw this.P_;return e=this.A_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ci.H(e);n.mutations.push(new Ys(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Wo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Xo(e.serializer,t)})},[4,e.Sc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qc,this.mutations)];case 1:return t.sent(),this.R_=!0,[2]}})})},md.prototype.p_=function(t){var e;if(t instanceof ou)e=t.version;else{if(!(t instanceof su))throw Lr();e=oi.min()}var n=this.A_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Tr.ABORTED,"Document version changed between two reads.")}else this.A_.set(t.key.toString(),e)},md.prototype.Ge=function(t){var e=this.A_.get(t.toString());return!this.g_.has(t.toString())&&e?Ss.updateTime(e):Ss.ze()},md.prototype.b_=function(t){var e=this.A_.get(t.toString());if(this.g_.has(t.toString())||!e)return Ss.exists(!0);if(e.isEqual(oi.min()))throw new _r(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ss.updateTime(e)},md.prototype.write=function(t){this.V_(),this.mutations=this.mutations.concat(t)},md.prototype.V_=function(){},md),dd=(gd.prototype.run=function(){this.S_()},gd.prototype.S_=function(){var t=this;this.ys.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new pd(this.qc),(n=this.D_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.C_(t)})})}).catch(function(t){r.C_(t)}),[2]})})})},gd.prototype.D_=function(t){try{var e=this.updateFunction(t);return!gi(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},gd.prototype.C_=function(t){var e=this;0<this.v_&&this.N_(t)?(--this.v_,this.cs.ws(function(){return e.S_(),Promise.resolve()})):this.ls.reject(t)},gd.prototype.N_=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Oi(t)},gd),yd=(vd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.ui.promise];case 1:return[2,(t.sent(),{cs:this.cs,yl:this.yl,clientId:this.clientId,credentials:this.credentials,ql:this.user,Dh:100})]}})})},vd.prototype.F_=function(t){var e=this;this.x_=t,this.ui.promise.then(function(){return e.x_(e.user)})},vd.prototype.O_=function(){if(this.cs.ps)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},vd.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new sa;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.k_?[4,this.k_.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.M_?[4,this.M_.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ai(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ka(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},vd);function vd(t,e,n){var r=this;this.credentials=t,this.cs=e,this.yl=n,this.user=Ma.UNAUTHENTICATED,this.clientId=Cr.t(),this.x_=function(){},this.ui=new sa,this.credentials.oi(function(t){Or("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.x_(t)),r.ui.resolve()})}function gd(t,e,n,r){this.cs=t,this.qc=e,this.updateFunction=n,this.ls=r,this.v_=5,this.ys=new ua(this.cs,"transaction_retry")}function md(t){this.qc=t,this.A_=new Map,this.mutations=[],this.R_=!1,this.P_=null,this.g_=new Set}function wd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),Or("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.F_(function(e){return r.cs.Cs(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,jh(i.Bc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.ha(function(){return r.terminate()}),r.M_=i,[2]}})})}function bd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),[4,Id(r)];case 1:return e=t.sent(),Or("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.F_(function(t){return r.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.Fs(),Or("RemoteStore","RemoteStore received new credentials"),n=bf(e),e.Wc.add(3),[4,pf(e)];case 1:return t.sent(),n&&e.Hc.set("Unknown"),[4,e.Uc.Gl(i)];case 2:return t.sent(),e.Wc.delete(3),[4,lf(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)})}),r.k_=i,[2]}})})}function Id(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.M_?[3,2]:(Or("FirestoreClient","Using default OfflineComponentProvider"),[4,wd(e,new ip)]);case 1:t.sent(),t.label=2;case 2:return[2,e.M_]}})})}function Ed(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.k_?[3,2]:(Or("FirestoreClient","Using default OnlineComponentProvider"),[4,bd(e,new up)]);case 1:t.sent(),t.label=2;case 2:return[2,e.k_]}})})}function Td(t){return Id(t).then(function(t){return t.persistence})}function _d(t){return Id(t).then(function(t){return t.Bc})}function Ad(t){return Ed(t).then(function(t){return t.ph})}function Nd(t){return Ed(t).then(function(t){return t.mu})}function Dd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ed(r)];case 1:return e=t.sent(),[2,((n=e.bh).Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=_l(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Bu(n),r=o.view.yh(),[3,4]):[3,1];case 1:return[4,Kh(e.Bc,bu(u))];case 2:return i=t.sent(),o=e.Sh.Bu(i.targetId),n=i.targetId,[4,sl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&df(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.mu),n.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.xh.get(n.targetId)).length?[2,(e.xh.set(n.targetId,r.filter(function(t){return!_u(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Uu(n.targetId),e.Sh.Ou(n.targetId)?[3,2]:[4,Hh(e.Bc,n.targetId,!1).then(function(){e.Sh.Qu(n.targetId),yf(e.ph,n.targetId),dl(e,n.targetId)}).catch(Jh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return dl(e,n.targetId),[4,Hh(e.Bc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.mu),n)]}})})}function Sd(n,t,e,r){var i=this,o=new ap(r),s=new Ua(t,o,e);return n.cs.ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ra,[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})}),function(){o.Hl(),n.cs.ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ca,[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})})}}function Od(n,r){var t=this,i=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ul,[4,Nd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function xd(n,t){var e=this,r=new ap(t);return n.cs.ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.add(e),e.next()},[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Hl(),n.cs.ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.delete(e)},[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}function kd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Pd=(Cd.prototype.U_=function(t){switch(go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _o(t.integerValue||t.doubleValue);case 3:return this.K_(t.timestampValue);case 4:return this.Q_(t);case 5:return t.stringValue;case 6:return this.q_(Ao(t.bytesValue));case 7:return this.W_(t.referenceValue);case 8:return this.j_(t.geoPointValue);case 9:return this.G_(t.arrayValue);case 10:return this.z_(t.mapValue);default:throw Lr()}},Cd.prototype.z_=function(t){var n=this,r={};return Zr(t.fields||{},function(t,e){r[t]=n.U_(e)}),r},Cd.prototype.j_=function(t){return new Up(_o(t.latitude),_o(t.longitude))},Cd.prototype.G_=function(t){var e=this;return(t.values||[]).map(function(t){return e.U_(t)})},Cd.prototype.Q_=function(t){switch(this.L_){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return po(e)?t(e):e}(t);return null==e?null:this.U_(e);case"estimate":return this.K_(yo(t));default:return null}},Cd.prototype.K_=function(t){t=To(t);return new ii(t.seconds,t.nanos)},Cd.prototype.W_=function(t){var e=si.q(t);Rr(ss(e));t=new Yr(e.get(1),e.get(3)),e=new ci(e.N(5));return t.isEqual(this._)||xr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.B_(e)},Cd),Ld=(Rd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Rd);function Rd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new _r(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,vp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Cd(t,e,n,r){this._=t,this.L_=e,this.B_=n,this.q_=r}function Vd(n,r,i){var t=this,o=new sa;return n.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,wd(n,i)];case 1:return t.sent(),[4,bd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Ud(t){if(t.Y_||t.J_)throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Md="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",qd=(zd.prototype.enableIndexedDbPersistence=function(t,e){throw new _r(Tr.FAILED_PRECONDITION,Md)},zd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new _r(Tr.FAILED_PRECONDITION,Md)},zd.prototype.clearIndexedDbPersistence=function(t){throw new _r(Tr.FAILED_PRECONDITION,Md)},zd),Fd=(Gd.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Ud(t);var n=Kd(t),r=t.H_(),t=new up;return Vd(n,t,new op(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t,{forceOwnership:e})},Gd),jd=(Object.defineProperty(Bd.prototype,"Y_",{get:function(){return!!this.nf},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"J_",{get:function(){return this.X_.ps},enumerable:!1,configurable:!0}),Object.defineProperty(Bd.prototype,"af",{get:function(){return this.cf||(this.cf=new $p(this.c_,this.rf.ignoreUndefinedProperties)),this.cf},enumerable:!1,configurable:!0}),Bd.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.rf),t)).merge;t=new Ld(t);if(this.nf&&!this.rf.isEqual(t))throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.rf=t).credentials&&(this.if=function(t){if(!t)return new Ba;switch(t.type){case"gapi":var e=t.client;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ka(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Bd.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.rf.host&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Bd.prototype.enableNetwork=function(){return Kd(this),function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Td(r)];case 1:return e=t.sent(),[4,Ad(r)];case 2:return n=t.sent(),[2,(e.la(!0),(t=n).Wc.delete(0),lf(t))]}})})})}(this.nf)},Bd.prototype.disableNetwork=function(){return Kd(this),function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Td(r)];case 1:return e=t.sent(),[4,Ad(r)];case 2:return n=t.sent(),[2,(e.la(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(0),[4,pf(e)];case 1:return t.sent(),e.Hc.set("Offline"),[2]}})})}(n))]}})})})}(this.nf)},Bd.prototype.enablePersistence=function(t){if(this.nf)throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&vp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.tf.enableMultiTabIndexedDbPersistence(this):this.tf.enableIndexedDbPersistence(this,n)},Bd.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.tf.clearIndexedDbPersistence(this)]})})},Bd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Bd.prototype.waitForPendingWrites=function(){return Kd(this),function(n){var t=this,r=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=fl,[4,Nd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(this.nf)},Bd.prototype.onSnapshotsInSync=function(t){if(Kd(this),kd(t))return xd(this.nf,t);t={next:t};return xd(this.nf,t)},Bd.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new _r(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Yr(t)},Object.defineProperty(Bd.prototype,"app",{get:function(){if(!this.ef)throw new _r(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ef},enumerable:!1,configurable:!0}),Bd.prototype.collection=function(t){return dp("Firestore.collection","path",t),Kd(this),new dy(si.q(t),this,null)},Bd.prototype.doc=function(t){return dp("Firestore.doc","path",t),Kd(this),Jd.uf(si.q(t),this,null)},Bd.prototype.collectionGroup=function(t){if(dp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Kd(this),new ly((t=t,new au(si.U(),t)),this,null)},Bd.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Ed(n).then(function(t){return t.qc})];case 1:return e=t.sent(),new dd(n.cs,e,r,i).run(),[2]}})})}),i.promise}(Kd(this),function(t){return e(new Yd(n,t))})},Bd.prototype.batch=function(){return Kd(this),new Xd(this)},Bd.prototype.H_=function(){return this.rf},Bd);function Bd(t,e,n){var r=this;if(void 0===n&&(n=new qd),this.tf=n,this.ef=null,this.X_=new Sa,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nf||Hd(this),[4,this.nf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){n=t;this.ef=n,this.c_=Bd.sf(n),this.Z_=n.name,this.if=new Ga(e)}else{t=t;if(!t.projectId)throw new _r(Tr.INVALID_ARGUMENT,"Must provide projectId");this.c_=new Yr(t.projectId,t.database),this.Z_="[DEFAULT]",this.if=new Ba}this.rf=new Ld({})}function Gd(){this.enableMultiTabIndexedDbPersistence=function(t){Ud(t);var e=Kd(t),n=t.H_(),t=new up;return Vd(e,t,new sp(t,n.cacheSizeBytes))}.bind(null),this.clearIndexedDbPersistence=function(n){var t=this;if(n.Y_&&!n.J_)throw new _r(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new sa;return n.X_.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ca.Ln()?(e=n+"main",[4,ca.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Mh(n.c_,n.Z_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}.bind(null)}function zd(){}function Kd(t){return t.nf||Hd(t),t.nf.O_(),t.nf}function Hd(t){var e,n,r=t.H_(),r=(e=t.c_,n=t.Z_,new Qr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.nf=new yd(t.if,t.X_,r)}var Wd,Qd,Yd=(sy.prototype.get=function(t){var e=this,n=my(0,t,this.hf);return this.lf.y_([n.u_]).then(function(t){if(!t||1!==t.length)return Lr();t=t[0];if(t instanceof su)return new Zd(e.hf,n.u_,null,!1,!1,n.h_);if(t instanceof ou)return new Zd(e.hf,n.u_,t,!1,!1,n.h_);throw Lr()})},sy.prototype.set=function(t,e,n){t=my(0,t,this.hf);n=yp("Transaction.set",n);e=wy(t.h_,e,n),n=ed(this.hf.af,"Transaction.set",t.u_,e,null!==t.h_,n);return this.lf.set(t.u_,n),this},sy.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Ep?(r=my(0,t,this.hf),rd(this.hf.af,"Transaction.update",r.u_,e,n,i)):(r=my(0,t,this.hf),nd(this.hf.af,"Transaction.update",r.u_,e)),this.lf.update(r.u_,e),this},sy.prototype.delete=function(t){t=my(0,t,this.hf);return this.lf.delete(t.u_),this},sy),Xd=(oy.prototype.set=function(t,e,n){this.df();t=my(0,t,this.hf);n=yp("WriteBatch.set",n);e=wy(t.h_,e,n),n=ed(this.hf.af,"WriteBatch.set",t.u_,e,null!==t.h_,n);return this._f=this._f.concat(n.l_(t.u_,Ss.ze())),this},oy.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.df(),e="string"==typeof e||e instanceof Ep?(r=my(0,t,this.hf),rd(this.hf.af,"WriteBatch.update",r.u_,e,n,i)):(r=my(0,t,this.hf),nd(this.hf.af,"WriteBatch.update",r.u_,e)),this._f=this._f.concat(e.l_(r.u_,Ss.exists(!0))),this},oy.prototype.delete=function(t){this.df();t=my(0,t,this.hf);return this._f=this._f.concat(new Qs(t.u_,Ss.ze())),this},oy.prototype.commit=function(){return this.df(),this.ff=!0,0<this._f.length?Od(Kd(this.hf),this._f):Promise.resolve()},oy.prototype.df=function(){if(this.ff)throw new _r(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},oy),Jd=(n(iy,Qd=Fp),iy.uf=function(t,e,n){if(t.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new iy(new ci(t),e,n)},Object.defineProperty(iy.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(iy.prototype,"parent",{get:function(){return new dy(this.u_.path.F(),this.firestore,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(iy.prototype,"path",{get:function(){return this.u_.path.B()},enumerable:!1,configurable:!0}),iy.prototype.collection=function(t){if(dp("DocumentReference.collection","path",t),!t)throw new _r(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=si.q(t);return new dy(this.u_.path.child(t),this.firestore,null)},iy.prototype.isEqual=function(t){return t instanceof iy&&this.firestore===t.firestore&&this.u_.isEqual(t.u_)&&this.h_===t.h_},iy.prototype.set=function(t,e){e=yp("DocumentReference.set",e);t=wy(this.h_,t,e),e=ed(this.firestore.af,"DocumentReference.set",this.u_,t,null!==this.h_,e);return Od(this.nf,e.l_(this.u_,Ss.ze()))},iy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Ep?rd(this.firestore.af,"DocumentReference.update",this.u_,t,e,n):nd(this.firestore.af,"DocumentReference.update",this.u_,t),Od(this.nf,t.l_(this.u_,Ss.exists(!0)))},iy.prototype.delete=function(){return Od(this.nf,[new Qs(this.u_,Ss.ze())])},iy.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||kd(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};kd(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.wf(t))},error:n[i+1],complete:n[i+2]};return Sd(this.nf,pu(this.u_.path),o,s)},iy.prototype.get=function(t){var e=this;return t&&"cache"===t.source?function(n,r){var t=this,i=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Mi(t,e)}))];case 1:return(r=t.sent())instanceof ou?s.resolve(r):r instanceof su?s.resolve(null):s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=ka(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,_d(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(this.nf,this.u_).then(function(t){return new Zd(e.firestore,e.u_,t,!0,t instanceof ou&&t.Je,e.h_)}):function(n,r,i){var t=this;void 0===i&&(i={});var o=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new ap({next:function(t){r.ws(function(){return Ca(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ua(pu(i.path),t,{includeMetadataChanges:!0,Xs:!0});return Ra(n,u)},[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.cs,r,i,o])]}})})}),o.promise}(this.nf,this.u_,t).then(function(t){return e.wf(t)})},iy.prototype.withConverter=function(t){return new iy(this.u_,this.firestore,t)},iy.prototype.wf=function(t){var e=t.docs.get(this.u_);return new Zd(this.firestore,this.u_,e,t.fromCache,t.hasPendingWrites,this.h_)},iy),$d=(ry.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ry),Zd=(ny.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.Ef){if(this.h_){var n=new ty(this.hf,this.u_,this.Ef,this.Tf,this.If,null);return this.h_.fromFirestore(n,t)}return new Pd(this.hf.c_,t.serverTimestamps||"none",function(t){return new Jd(t,e.hf,null)},function(t){return new Wr(t)}).U_(this.Ef.rn())}},ny.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.Ef){t=this.Ef.data().field(cd("DocumentSnapshot.get",t,this.u_));if(null!==t)return new Pd(this.hf.c_,e.serverTimestamps||"none",function(t){return new Jd(t,n.hf,n.h_)},function(t){return new Wr(t)}).U_(t)}},Object.defineProperty(ny.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(ny.prototype,"ref",{get:function(){return new Jd(this.u_,this.hf,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(ny.prototype,"exists",{get:function(){return null!==this.Ef},enumerable:!1,configurable:!0}),Object.defineProperty(ny.prototype,"metadata",{get:function(){return new $d(this.If,this.Tf)},enumerable:!1,configurable:!0}),ny.prototype.isEqual=function(t){return t instanceof ny&&this.hf===t.hf&&this.Tf===t.Tf&&this.u_.isEqual(t.u_)&&(null===this.Ef?null===t.Ef:this.Ef.isEqual(t.Ef))&&this.h_===t.h_},ny),ty=(n(ey,Wd=Zd),ey.prototype.data=function(t){return Wd.prototype.data.call(this,t)},ey);function ey(){return null!==Wd&&Wd.apply(this,arguments)||this}function ny(t,e,n,r,i,o){this.hf=t,this.u_=e,this.Ef=n,this.Tf=r,this.If=i,this.h_=o}function ry(t,e){this.hasPendingWrites=t,this.fromCache=e}function iy(t,e,n){var r=this;return(r=Qd.call(this,e.c_,t,n)||this).u_=t,r.firestore=e,r.h_=n,r.nf=Kd(e),r}function oy(t){this.hf=t,this._f=[],this.ff=!1}function sy(t,e){this.hf=t,this.lf=e}function uy(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!mu(e)&&-1!==n.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(si.q(n));if(!ci.X(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return No(t,new ci(e))}if(n instanceof Fp)return No(t,n.u_);throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+gp(n)+".")}function ay(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cy(t,e,n){if(!n.isEqual(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function hy(t){if(yu(t)&&0===t.on.length)throw new _r(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var fy,ly=(gy.prototype.where=function(t,e,n){t=cd("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ay(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(uy(n,t,c))}h={arrayValue:{values:s}}}else h=uy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ay(o,i),h=id(e,"Query.where",o,"in"===i||"not-in"===i);var h=xu.create(r,i,h);return function(t,e){if(e.hn()){var n=gu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=vu(t);null!==n&&cy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.mf,this.firestore.af,this.firestore.c_,t,e,n);return new gy((n=this.mf,e=n.filters.concat([e]),new au(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.h_)},gy.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=cd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new ia(e,n);return n=e,null!==vu(t)||null!==(t=gu(t))&&cy(0,t,n.field),e}(this.mf,t,n);return new gy((n=this.mf,t=n.on.concat([t]),new au(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.h_)},gy.prototype.limit=function(t){return mp("Query.limit",t),new gy(Iu(this.mf,t,"F"),this.firestore,this.h_)},gy.prototype.limitToLast=function(t){return mp("Query.limitToLast",t),new gy(Iu(this.mf,t,"L"),this.firestore,this.h_)},gy.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Af("Query.startAt",t,e,!0);return new gy(Eu(this.mf,t),this.firestore,this.h_)},gy.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Af("Query.startAfter",t,e,!1);return new gy(Eu(this.mf,t),this.firestore,this.h_)},gy.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Af("Query.endBefore",t,e,!0);return new gy(Tu(this.mf,t),this.firestore,this.h_)},gy.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Af("Query.endAt",t,e,!1);return new gy(Tu(this.mf,t),this.firestore,this.h_)},gy.prototype.isEqual=function(t){return t instanceof gy&&this.firestore===t.firestore&&_u(this.mf,t.mf)&&this.h_===t.h_},gy.prototype.withConverter=function(t){return new gy(this.mf,this.firestore,t)},gy.prototype.Af=function(c,t,e,n){if(t instanceof Zd)return function(t,e,n,r){if(!n)throw new _r(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=wu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(No(e,n.key));else{var a=n.field(u.field);if(po(a))throw new _r(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.B();throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(this.mf,this.firestore.c_,t.Ef,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new _r(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!mu(t)&&-1!==c.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(si.q(c));if(!ci.X(h))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ci(h);u.push(No(e,h))}else{c=id(n,r,c);u.push(c)}}return new Xu(u,o)}(this.mf,this.firestore.c_,this.firestore.af,c,e,n)},gy.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||kd(n[o])||(i=n[o],o++),kd(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new py(e.firestore,e.mf,t,e.h_))},error:n[o+1],complete:n[o+2]};return hy(this.mf),Sd(Kd(this.firestore),this.mf,i,s)},gy.prototype.get=function(t){var e=this;hy(this.mf);var n=Kd(this.firestore);return(t&&"cache"===t.source?function(n,r){var t=this,i=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Wh(r,i,!0)];case 1:return n=t.sent(),e=new Wf(i,n.za),n=e.wh(n.documents),n=e.Di(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=ka(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,_d(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.mf):function(n,r,i){var t=this;void 0===i&&(i={});var o=new sa;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new ap({next:function(t){n.ws(function(){return Ca(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ua(t,o,{includeMetadataChanges:!0,Xs:!0});return Ra(e,s)},[4,Dd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.cs,r,i,o])]}})})}),o.promise}(n,this.mf,t)).then(function(t){return new py(e.firestore,e.mf,t,e.h_)})},gy),py=(Object.defineProperty(vy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"empty",{get:function(){return this.Pf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"size",{get:function(){return this.Pf.docs.size},enumerable:!1,configurable:!0}),vy.prototype.forEach=function(e,n){var r=this;this.Pf.docs.forEach(function(t){e.call(n,r.Vf(t,r.metadata.fromCache,r.Pf.Qt.has(t.key)))})},Object.defineProperty(vy.prototype,"query",{get:function(){return new ly(this.Rf,this.hf,this.h_)},enumerable:!1,configurable:!0}),vy.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.Pf.jt)throw new _r(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.gf&&this.yf===t||(this.gf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Pf,t,this.Vf.bind(this)),this.yf=t),this.gf},vy.prototype.isEqual=function(t){return t instanceof vy&&this.hf===t.hf&&_u(this.Rf,t.Rf)&&this.Pf.isEqual(t.Pf)&&this.h_===t.h_},vy.prototype.Vf=function(t,e,n){return new ty(this.hf,t.key,t,e,n,this.h_)},vy),dy=(n(yy,fy=ly),Object.defineProperty(yy.prototype,"id",{get:function(){return this.mf.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(yy.prototype,"parent",{get:function(){var t=this.mf.path.F();return t.P()?null:new Jd(new ci(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(yy.prototype,"path",{get:function(){return this.mf.path.B()},enumerable:!1,configurable:!0}),yy.prototype.doc=function(t){0===arguments.length&&(t=Cr.t()),dp("CollectionReference.doc","path",t);t=si.q(t);return Jd.uf(this.mf.path.child(t),this.firestore,this.h_)},yy.prototype.add=function(t){var t=this.h_?this.h_.toFirestore(t):t,e=this.doc();return new Jd(e.u_,this.firestore,null).set(t).then(function(){return e})},yy.prototype.withConverter=function(t){return new yy(this.pf,this.firestore,t)},yy);function yy(t,e,n){var r=this;if(((r=fy.call(this,pu(t),e,n)||this).pf=t).length%2!=1)throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function vy(t,e,n,r){this.hf=t,this.Rf=e,this.Pf=n,this.h_=r,this.gf=null,this.yf=null,this.metadata=new $d(n.hasPendingWrites,n.fromCache)}function gy(t,e,n){this.mf=t,this.firestore=e,this.h_=n}function my(t,e,n){e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new _r(Tr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=gp(t);throw new _r(Tr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,Jd);if(e.firestore!==n)throw new _r(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function wy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var by,Iy,Ee=(n(Ty,by=Mp),Ty.serverTimestamp=function(){var t=new Lp("serverTimestamp");return t.Jl="FieldValue.serverTimestamp",new Ty(t)},Ty.delete=function(){var t=new Ap("deleteField");return t.Jl="FieldValue.delete",new Ty(t)},Ty.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rp("arrayUnion",t)}.apply(void 0,t);return n.Jl="FieldValue.arrayUnion",new Ty(n)},Ty.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cp("arrayRemove",t)}.apply(void 0,t);return n.Jl="FieldValue.arrayRemove",new Ty(n)},Ty.increment=function(t){t=new Vp("increment",t);return t.Jl="FieldValue.increment",new Ty(t)},Ty.prototype.isEqual=function(t){return this.a_.isEqual(t.a_)},Ty),Ey={Firestore:jd,GeoPoint:Up,Timestamp:ii,Blob:Wr,Transaction:Yd,WriteBatch:Xd,DocumentReference:Jd,DocumentSnapshot:Zd,Query:ly,QueryDocumentSnapshot:ty,QuerySnapshot:py,CollectionReference:dy,FieldPath:Ep,FieldValue:Ee,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Ty(){return null!==by&&by.apply(this,arguments)||this}(Iy=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new jd(e,t,new Fd);var e},"PUBLIC").setServiceProps(Object.assign({},Ey))),Iy.registerVersion("@firebase/firestore","2.0.1-2020103231751")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
