!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(oy){"use strict";try{(function(){var f,t,e=(t=oy)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=f=f||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((me={})[f.DEBUG]="log",me[f.VERBOSE]="log",me[f.INFO]="info",me[f.WARN]="warn",me[f.ERROR]="error",me),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function D(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function x(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),P=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:R).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++P))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}var Q=N.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(Q=Q&&Q.userAgent)?Q:"";var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<J.length;i++)e=J[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=D;var tt,et=H(at,"Opera"),nt=H(at,"Trident")||H(at,"MSIE"),rt=H(at,"Edge"),it=rt||nt,ot=H(at,"Gecko")&&!(H(at.toLowerCase(),"webkit")&&!H(at,"Edge"))&&!(H(at,"Trident")||H(at,"MSIE"))&&!H(at,"Edge"),st=H(at.toLowerCase(),"webkit")&&!H(at,"Edge");function ut(){var t=N.document;return t?t.documentMode:void 0}var Q="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(Q=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(Q)?String(at):Q;var ct={};function ht(u){return t=u,e=function(){for(var t=0,e=K(String(tt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ct,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=N.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ht("9"),dt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",D,e),N.removeEventListener("test",D,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},M(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(It(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function _t(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=_t(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),Nt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[mt]?e.wa(n,r,x(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[mt]?t.va(e,n,x(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=x(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Lt(t);if(c||(t[At]=c=new Et(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(xt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(xt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):It(t)))}function xt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(ft)return kt(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new vt(e,this))}function Lt(t){return(t=t[At])instanceof Et?t:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==S(e)?e:(e[Rt]||(e[Rt]=function(t){return e.handleEvent(t)}),e[Rt])}function Vt(){q.call(this),this.c=new Et(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,$(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Vt,q),Vt.prototype[mt]=!0,(at=Vt.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=x(i)?!!i.capture:!!i,r=Ct(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=_t(s=e.a[n],r,i,o))&&(It(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=_t(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},at.G=function(){if(Vt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=N.JSON.stringify;function Ft(){this.b=this.a=null}var jt,Bt=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new zt},function(t){t.reset()},100));function Gt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Kt(t,e){var n;jt||(n=N.Promise.resolve(void 0),jt=function(){n.then(Qt)}),Ht||(jt(),Ht=!0),Wt.add(t,e)}Ft.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Wt=new Ft;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Wt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Yt(t,e){Vt.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Xa,this),this.g=U()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Jt(t,e,n){if("function"==S(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}M(Yt,Vt),(at=Yt.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Xt(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},at.G=function(){Yt.X.G.call(this),Xt(this),delete this.a};var $t,Zt,te=(T(Zt=ne,Q=$t=q),Zt.prototype=null===Q?Object.create(Q):(ee.prototype=Q.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Jt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){$t.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Zt}function ne(t,e,n){var r=$t.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){q.call(this),this.b=t,this.a={}}M(re,q);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var ce=null;function he(){return ce=ce||new Vt}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=he();Ut(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=he();Ut(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}M(le,yt),M(pe,yt),M(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}we.prototype.a=null;var Ee,A={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Te(){yt.call(this,"d")}function _e(){yt.call(this,"c")}function Ae(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=De,t=it?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Te,yt),M(_e,yt),M(Ae,we),Ee=new Ae;var De=45e3,Se={},Oe={};function xe(t,e,n){t.H=1,t.i=Je(Ke(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=U(),Le(t),t.l=Ke(t.i);var s,u,a,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(C(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Oe:(i=Number(u.substring(i,o)),isNaN(i)?Se:(o+=1)+i>u.length?Oe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Oe){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==Se){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),Ue(t),Ve(t))}function Le(t){t.T=U()+t.P,Re(t,t.P)}function Re(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Ta,t),e)}function Ce(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function Ue(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),jn(u)}Yn(u),de()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Xe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Le(o)),n.a=i):Qn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):Fn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);fe()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)j(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=Ne.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),Ue(this),Ve(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(Pe(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),Me(this,n)),4==e&&Ue(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),Ue(this),Ve(this)}}}catch(t){}var u,a,c,h,l,f},at.Ua=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Pe(this,t,e),this.b&&4!=t&&Le(this)))},at.cancel=function(){this.A=!0,Ue(this)},at.Ta=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),Ue(this),this.h=2,Ve(this)):Re(this,this.T-n)},(at=Fe.prototype).K=function(){je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return je(this),this.a.concat()},at.get=function(t,e){return Be(this.b,t)?this.b[t]:e},at.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,We(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Ye(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,He(this,n[1]||"",!0),this.j=$e(n[2]||""),We(this,n[3]||"",!0),Qe(this,n[4]),this.g=$e(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function Ke(t){return new ze(t)}function He(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function We(t,e,n){t.c=n?$e(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Xe(t,e,n){t.b.set(e,n)}function Je(t){return Xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new Fe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=fn(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&je(t)))}function hn(t,e){return an(t),e=fn(t,e),Be(t.a.b,e)}function ln(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){j(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=B(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,hn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function En(){}function Tn(){this.a=new En}function _n(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var An=N.JSON.parse;function Nn(t){Vt.call(this),this.headers=new Fe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Dn,this.D=this.F=!1}M(Nn,Vt);var Dn="",Sn=/^https?$/i,On=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Rn(t)}function Pn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function Ln(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Jt(t.za,0,t);else if(Ut(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!Sn.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Rn(t)}}}function Rn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Un(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xe(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Pa=Mn("retryDelaySeedMs",1e4,t),this.Ka=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new Tn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Fn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Xe(n=Ke(t.B),"SID",t.J),Xe(n,"RID",e),Xe(n,"TYPE","terminate"),Hn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Je(Ke(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),Le(e)),nr(t)}function jn(t){t.a&&(Xn(t),t.a.cancel(),t.a=null)}function Bn(t){jn(t),t.j&&(N.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);Xe(r,"SID",t.J),Xe(r,"RID",n),Xe(r,"AID",t.P),Hn(t,r),t.i&&t.l&&Un(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),xe(n,r,e)}function Hn(t,n){t.f&&qe({},function(t,e){Xe(n,e,t)})}function Wn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{qe(t,function(t,e){var n=t;x(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Qn(t){t.a||t.j||(t.T=1,Kt(t.Aa,t),t.o=0)}function Yn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Xn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);Xe(e,"RID","rpc"),Xe(e,"SID",t.J),Xe(e,"CI",t.H?"0":"1"),Xe(e,"AID",t.P),Hn(t,e),Xe(e,"TYPE","xmlhttp"),t.i&&t.l&&Un(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(Ke(e)),n.j=null,n.I=!0,ke(n,t)}function $n(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Xn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=he(),new ye(s)),zn(t)):Qn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Yn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Wa,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||He(r,"https"),Je(r)),n=r.toString(),r=o,o=new ue,N.Image?((i=new Image).onload=V(_n,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(_n,o,i,"TestLoadImage: error",!1,r),i.onabort=V(_n,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(_n,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?Ke(s):new ze(s,void 0);return""!=a.c?(e&&We(a,e+"."+a.c),Qe(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&He(u,r),i&&We(u,i),o&&Qe(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Xe(a,e,t)}),e=t.A,n=t.na,e&&n&&Xe(a,e,n),Xe(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Vt.call(this),this.a=new qn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){_e.call(this),this.status=1}function hr(t){this.a=t}(at=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ee),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Fe(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=F(On,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,nt&&ht(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Jt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Rn(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Rn(this,!0)),Nn.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Sa())},at.Sa=function(){Ln(this)},at.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=qn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),Xe(i=Ke(this.B),"RID",t),Xe(i,"CVER",22),this.A&&Xe(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&Un(i,this.i,r),wn(this.b,n),this.Ga&&Xe(i,"TYPE","init"),this.da?(Xe(i,"$req",e),Xe(i,"SID","null"),n.U=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||vn(this.b)||Kn(this))},at.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),jn(this),Jn(this))},at.Qa=function(){null!=this.m&&(this.m=null,jn(this),Yn(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Vt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){Fn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=qt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,Fn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Te),M(cr,_e),M(hr,or),hr.prototype.ta=function(){Ut(this.a,"a")},hr.prototype.sa=function(t){Ut(this.a,new ar(t))},hr.prototype.ra=function(t){Ut(this.a,new cr)},hr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ie.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Vt.prototype.listen=Vt.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Oa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Na,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var lr=ge,fr=me,pr=Ie,dr=Nn,A=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr,gr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},mr=(n(Ir,vr=Error),Ir),wr="8.0.1-2020103231751",br=new h("@firebase/firestore");function Ir(t,e){var n=this;return(n=vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Er(){return br.logLevel}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=f.DEBUG&&(e=n.map(Nr),br.debug.apply(br,i(["Firestore ("+wr+"): "+t],e)))}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=f.ERROR&&(e=n.map(Nr),br.error.apply(br,i(["Firestore ("+wr+"): "+t],e)))}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=f.WARN&&(e=n.map(Nr),br.warn.apply(br,i(["Firestore ("+wr+"): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Dr(t){throw void 0===t&&(t="Unexpected state"),_r(t="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Sr(t){t||Dr()}var Or=(xr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},xr);function xr(){}function kr(t,e){return t<e?-1:e<t?1:0}function Pr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Lr(t){return t+"\0"}var Rr=(Cr.fromBase64String=function(t){return new Cr(atob(t))},Cr.fromUint8Array=function(t){return new Cr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Cr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Cr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Cr.prototype.o=function(){return 2*this.i.length},Cr.prototype.u=function(t){return kr(this.i,t.i)},Cr.prototype.isEqual=function(t){return this.i===t.i},Cr);function Cr(t){this.i=t}Rr.h=new Rr("");var Vr=(Ur.fromBase64String=function(t){try{return new Ur(Rr.fromBase64String(t))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Ur.fromUint8Array=function(t){return new Ur(Rr.fromUint8Array(t))},Ur.prototype.toBase64=function(){return this.l.toBase64()},Ur.prototype.toUint8Array=function(){return this.l.toUint8Array()},Ur.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ur.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Ur);function Ur(t){this.l=t}function Mr(){if("undefined"==typeof Uint8Array)throw new mr(gr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qr(){if("undefined"==typeof atob)throw new mr(gr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Fr,jr=(n(Kr,Fr=Vr),Kr.fromBase64String=function(t){qr();try{return new Kr(Rr.fromBase64String(t))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Kr.fromUint8Array=function(t){return Mr(),new Kr(Rr.fromUint8Array(t))},Kr.prototype.toBase64=function(){return qr(),Fr.prototype.toBase64.call(this)},Kr.prototype.toUint8Array=function(){return Mr(),Fr.prototype.toUint8Array.call(this)},Kr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Kr),Br=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},Gr=(Object.defineProperty(zr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return t instanceof zr&&t.projectId===this.projectId&&t.database===this.database},zr.prototype.u=function(t){return kr(this.projectId,t.projectId)||kr(this.database,t.database)},zr);function zr(t,e){this.projectId=t,this.database=e||"(default)"}function Kr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Hr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Wr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Yr,Xr,Jr=(hi.prototype.get=function(t){var e=this.m(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},hi.prototype.has=function(t){return void 0!==this.get(t)},hi.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},hi.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},hi.prototype.forEach=function(s){Wr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},hi.prototype.P=function(){return Qr(this.R)},hi),$r=(ci.now=function(){return ci.fromMillis(Date.now())},ci.fromDate=function(t){return ci.fromMillis(t.getTime())},ci.fromMillis=function(t){var e=Math.floor(t/1e3);return new ci(e,1e6*(t-1e3*e))},ci.prototype.toDate=function(){return new Date(this.toMillis())},ci.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ci.prototype.g=function(t){return this.seconds===t.seconds?kr(this.nanoseconds,t.nanoseconds):kr(this.seconds,t.seconds)},ci.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ci.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ci.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ci.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ci),Zr=(ai.V=function(t){return new ai(t)},ai.min=function(){return new ai(new $r(0,0))},ai.prototype.u=function(t){return this.timestamp.g(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.v=function(){return this.timestamp},ai),ge=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.D(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},ui.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},ui.prototype.O=function(){return this.segments[this.offset]},ui.prototype.k=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype.P=function(){return 0===this.length},ui.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},ui.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Xr=ge),si.prototype.C=function(t,e,n){return new si(t,e,n)},si.prototype.B=function(){return this.L().join("/")},si.prototype.toString=function(){return this.B()},si.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new mr(gr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new si(n)},si.U=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Yr=ge),oi.prototype.C=function(t,e,n){return new oi(t,e,n)},oi.K=function(t){return ei.test(t)},oi.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.K(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.B()},oi.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},oi.j=function(){return new oi(["__name__"])},oi.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new mr(gr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new mr(gr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new mr(gr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.U=function(){return new oi([])},oi),ri=(ii.H=function(t){return new ii(ti.q(t))},ii.Y=function(t){return new ii(ti.q(t).N(5))},ii.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.D(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.D=function(t,e){return ti.D(t.path,e.path)},ii.X=function(t){return t.length%2==0},ii.Z=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Yr&&Yr.apply(this,arguments)||this}function si(){return null!==Xr&&Xr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.S=n}function ai(t){this.timestamp=t}function ci(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new mr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new mr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new mr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new mr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hi(t,e){this.m=t,this.A=e,this.R={}}function li(t){return null==t}function fi(t){return 0===t&&1/t==-1/0}function pi(t){return"number"==typeof t&&Number.isInteger(t)&&!fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var di=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function yi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new di(t,e,n,r,i,o,s)}function vi(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.B()+t.op.toString()+vo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.B()+t.dir}).join(","),li(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Wu(e.startAt)),e.endAt&&(t+="|ub:",t+=Wu(e.endAt)),e.tt=t),e.tt}function gi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!lo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Yu(t.startAt,e.startAt)&&Yu(t.endAt,e.endAt)}function mi(t){return ri.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function wi(t){this.count=t}var bi,Ii=(Ei.prototype.st=function(t){return new Ei(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ei.prototype.it=function(t,e){return new Ei(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ei.prototype.rt=function(t){return new Ei(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ei);function Ei(t,e,n,r,i,o,s){void 0===i&&(i=Zr.min()),void 0===o&&(o=Zr.min()),void 0===s&&(s=Rr.h),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ti(t){switch(t){case gr.OK:return Dr(),0;case gr.CANCELLED:case gr.UNKNOWN:case gr.DEADLINE_EXCEEDED:case gr.RESOURCE_EXHAUSTED:case gr.INTERNAL:case gr.UNAVAILABLE:case gr.UNAUTHENTICATED:return;case gr.INVALID_ARGUMENT:case gr.NOT_FOUND:case gr.ALREADY_EXISTS:case gr.PERMISSION_DENIED:case gr.FAILED_PRECONDITION:case gr.ABORTED:case gr.OUT_OF_RANGE:case gr.UNIMPLEMENTED:case gr.DATA_LOSS:return 1;default:return Dr(),0}}function _i(t){if(void 0===t)return _r("GRPC error has no .code"),gr.UNKNOWN;switch(t){case bi.OK:return gr.OK;case bi.CANCELLED:return gr.CANCELLED;case bi.UNKNOWN:return gr.UNKNOWN;case bi.DEADLINE_EXCEEDED:return gr.DEADLINE_EXCEEDED;case bi.RESOURCE_EXHAUSTED:return gr.RESOURCE_EXHAUSTED;case bi.INTERNAL:return gr.INTERNAL;case bi.UNAVAILABLE:return gr.UNAVAILABLE;case bi.UNAUTHENTICATED:return gr.UNAUTHENTICATED;case bi.INVALID_ARGUMENT:return gr.INVALID_ARGUMENT;case bi.NOT_FOUND:return gr.NOT_FOUND;case bi.ALREADY_EXISTS:return gr.ALREADY_EXISTS;case bi.PERMISSION_DENIED:return gr.PERMISSION_DENIED;case bi.FAILED_PRECONDITION:return gr.FAILED_PRECONDITION;case bi.ABORTED:return gr.ABORTED;case bi.OUT_OF_RANGE:return gr.OUT_OF_RANGE;case bi.UNIMPLEMENTED:return gr.UNIMPLEMENTED;case bi.DATA_LOSS:return gr.DATA_LOSS;default:return Dr()}}(me=bi={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Ai=(xi.prototype.ot=function(t,e){return new xi(this.D,this.root.ot(t,e,this.D).copy(null,null,Di.at,null,null))},xi.prototype.remove=function(t){return new xi(this.D,this.root.remove(t,this.D).copy(null,null,Di.at,null,null))},xi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},xi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},xi.prototype.P=function(){return this.root.P()},Object.defineProperty(xi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),xi.prototype.ct=function(){return this.root.ct()},xi.prototype.ut=function(){return this.root.ut()},xi.prototype.ht=function(t){return this.root.ht(t)},xi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},xi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},xi.prototype.lt=function(t){return this.root.lt(t)},xi.prototype._t=function(){return new Ni(this.root,null,this.D,!1)},xi.prototype.ft=function(t){return new Ni(this.root,t,this.D,!1)},xi.prototype.dt=function(){return new Ni(this.root,null,this.D,!0)},xi.prototype.wt=function(t){return new Ni(this.root,t,this.D,!0)},xi),Ni=(Oi.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Oi.prototype.At=function(){return 0<this.Tt.length},Oi.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Oi),Di=(Si.prototype.copy=function(t,e,n,r,i){return new Si(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Si.prototype.P=function(){return!1},Si.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Si.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Si.prototype.min=function(){return this.left.P()?this:this.left.min()},Si.prototype.ct=function(){return this.min().key},Si.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},Si.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Si.prototype.gt=function(){if(this.left.P())return Si.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Si.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.yt()||r.left.left.yt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.bt()),r.right.P()||r.right.yt()||r.right.left.yt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Si.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Si.prototype.yt=function(){return this.color},Si.prototype.Pt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},Si.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Si.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},Si.prototype.St=function(){var t=this.copy(null,null,Si.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Si.prototype.bt=function(){var t=this.copy(null,null,Si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Si.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Si.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Si.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw Dr();if(this.right.yt())throw Dr();var t=this.left.Nt();if(t!==this.right.Nt())throw Dr();return t+(this.yt()?0:1)},Si);function Si(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Si.RED,this.left=null!=r?r:Si.EMPTY,this.right=null!=i?i:Si.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function xi(t,e){this.D=t,this.root=e||Di.EMPTY}function ki(){this.size=0}Di.EMPTY=null,Di.RED=!0,Di.at=!1,Di.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.ot=function(t,e,n){return new Di(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype.P=function(){return!0},ki.prototype.ht=function(t){return!1},ki.prototype.lt=function(t){return!1},ki.prototype.ct=function(){return null},ki.prototype.ut=function(){return null},ki.prototype.yt=function(){return!1},ki.prototype.Ct=function(){return!0},ki.prototype.Nt=function(){return 0},new ki);var Pi=(Vi.prototype.has=function(t){return null!==this.data.get(t)},Vi.prototype.first=function(){return this.data.ct()},Vi.prototype.last=function(){return this.data.ut()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Vi.prototype.indexOf=function(t){return this.data.indexOf(t)},Vi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Vi.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},Vi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},Vi.prototype.Ot=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},Vi.prototype._t=function(){return new Li(this.data._t())},Vi.prototype.ft=function(t){return new Li(this.data.ft(t))},Vi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},Vi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Vi.prototype.P=function(){return this.data.P()},Vi.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Vi.prototype.isEqual=function(t){if(!(t instanceof Vi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},Vi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Vi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Vi.prototype.copy=function(t){var e=new Vi(this.D);return e.data=t,e},Vi),Li=(Ci.prototype.It=function(){return this.Mt.It().key},Ci.prototype.At=function(){return this.Mt.At()},Ci),Ri=new Ai(ri.D);function Ci(t){this.Mt=t}function Vi(t){this.D=t,this.data=new Ai(this.D)}var Ui=new Ai(ri.D),Mi=new Ai(ri.D),qi=new Pi(ri.D);function Fi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=qi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ji=new Pi(kr),Bi=(io.Bt=function(t){return new io(t.D)},io.prototype.has=function(t){return null!=this.$t.get(t)},io.prototype.get=function(t){return this.$t.get(t)},io.prototype.first=function(){return this.Lt.ct()},io.prototype.last=function(){return this.Lt.ut()},io.prototype.P=function(){return this.Lt.P()},io.prototype.indexOf=function(t){return(t=this.$t.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(io.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),io.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},io.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},io.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},io.prototype.isEqual=function(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},io.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},io.prototype.copy=function(t,e){var n=new io;return n.D=this.D,n.$t=t,n.Lt=e,n},io),Gi=(ro.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Dr()},ro.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},ro),zi=(no.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new no(t,e,Bi.Bt(e),i,n,r,!0,!1)},Object.defineProperty(no.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),no.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&vu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},no),Ki=(eo.Xt=function(t,e){var n=new Map;return n.set(t,Hi.Zt(t,e)),new eo(Zr.min(),n,ji,Ri,Fi())},eo),Hi=(to.Zt=function(t,e){return new to(Rr.h,e,Fi(),Fi(),Fi())},to),Wi=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Qi=function(t,e){this.targetId=t,this.oe=e},Yi=function(t,e,n,r){void 0===n&&(n=Rr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=(Object.defineProperty(Zi.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),Zi.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ue=t)},Zi.prototype.we=function(){var n=Fi(),r=Fi(),i=Fi();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Dr()}}),new Hi(this.ue,this.he,n,r,i)},Zi.prototype.Ee=function(){this.le=!1,this.ce=so()},Zi.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},Zi.prototype.Ie=function(t){this.le=!0,this.ce=this.ce.remove(t)},Zi.prototype.me=function(){this.ae+=1},Zi.prototype.Ae=function(){--this.ae},Zi.prototype.Re=function(){this.le=!0,this.he=!0},Zi),Ji=($i.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Js?this.ve(r,t.re):t.re instanceof $s&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},$i.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:Dr()}})},$i.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},$i.prototype.Oe=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(mi(t=t.target)?0===n?(t=new ri(t.path),this.Se(e,t,new $s(t,Zr.min()))):Sr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},$i.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&mi(n.target)&&(n=new ri(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Se(e,n,new $s(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=Fi();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Ki(r,o,this.pe,this.ye,s);return this.ye=Ri,this.Ve=oo(),this.pe=new Pi(kr),t},$i.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t)))},$i.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},$i.prototype.removeTarget=function(t){this.ge.delete(t)},$i.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},$i.prototype.me=function(t){this.Ne(t).me()},$i.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new Xi,this.ge.set(t,e)),e},$i.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new Pi(kr),this.Ve=this.Ve.ot(t,e)),e},$i.prototype.xe=function(t){var e=null!==this.ke(t);return e||Tr("WatchChangeAggregator","Detected inactive target",t),e},$i.prototype.ke=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},$i.prototype.Fe=function(e){var n=this;this.ge.set(e,new Xi),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},$i.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},$i);function $i(t){this.Pe=t,this.ge=new Map,this.ye=Ri,this.Ve=oo(),this.pe=new Pi(kr)}function Zi(){this.ae=0,this.ce=so(),this.ue=Rr.h,this.he=!1,this.le=!0}function to(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function eo(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function no(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function ro(){this.qt=new Ai(ri.D)}function io(n){this.D=n?function(t,e){return n(t,e)||ri.D(t.key,e.key)}:function(t,e){return ri.D(t.key,e.key)},this.$t=Ui,this.Lt=new Ai(this.D)}function oo(){return new Ai(ri.D)}function so(){return new Ai(ri.D)}function uo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ao(t){return t=go(t.mapValue.fields.__local_write_time__.timestampValue),new $r(t.seconds,t.nanos)}var co=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uo(t)?4:10:Dr()}function lo(r,i){var t,e=ho(r);if(e!==ho(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ao(r).isEqual(ao(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=go(r.timestampValue),t=go(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,wo(r.bytesValue).isEqual(wo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,mo((t=r).geoPointValue.latitude)===mo(e.geoPointValue.latitude)&&mo(t.geoPointValue.longitude)===mo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?mo(e.integerValue)===mo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=mo(e.doubleValue))===(t=mo(t.doubleValue))?fi(e)===fi(t):isNaN(e)&&isNaN(t));case 9:return Pr(r.arrayValue.values||[],i.arrayValue.values||[],lo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Hr(e)!==Hr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!lo(e[t],n[t])))return!1;return!0}();default:return Dr()}}function fo(t,e){return void 0!==(t.values||[]).find(function(t){return lo(t,e)})}function po(t,e){var n,r,i,o=ho(t),s=ho(e);if(o!==s)return kr(o,s);switch(o){case 0:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=mo(t.integerValue||t.doubleValue))<(n=mo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return yo(t.timestampValue,e.timestampValue);case 4:return yo(ao(t),ao(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=wo(i),s=wo(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=kr(n[i],r[i]);if(0!==o)return o}return kr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=kr(mo(o.latitude),mo(r.latitude)))?n:kr(mo(o.longitude),mo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=po(n[i],r[i]);if(o)return o}return kr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=kr(r[s],o[s]);if(0!==u)return u;if(0!==(u=po(n[r[s]],i[o[s]])))return u}return kr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function yo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return kr(t,e);var n=go(t),t=go(e);return 0!==(e=kr(n.seconds,t.seconds))?e:kr(n.nanos,t.nanos)}function vo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=go(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?wo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ri.Y(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Dr();var t,e}(t)}function go(t){if(Sr(!!t),"string"!=typeof t)return{seconds:mo(t.seconds),nanos:mo(t.nanos)};var e=0,n=co.exec(t);return Sr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function mo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wo(t){return"string"==typeof t?Rr.fromBase64String(t):Rr.fromUint8Array(t)}function bo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Io(t){return t&&"integerValue"in t}function Eo(t){return!!t&&"arrayValue"in t}function To(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ao(t){return t&&"mapValue"in t}var No={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},So=function(t,e){this._=t,this.Ke=e};function Oo(t){return{integerValue:""+t}}function xo(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function ko(t,e){return pi(e)?Oo(e):xo(t,e)}function Po(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Ro(t){return Sr(!!t),Zr.V((t=go(t),new $r(t.seconds,t.nanos)))}function Co(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function Vo(t){return Sr(Zo(t=ti.q(t))),t}function Uo(t,e){return Co(t._,e.path)}function Mo(t,e){return Sr((e=Vo(e)).get(1)===t._.projectId),Sr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ri(Bo(e))}function qo(t,e){return Co(t._,e)}function Fo(t){return 4===(t=Vo(t)).length?ti.U():Bo(t)}function jo(t){return new ti(["projects",t._.projectId,"databases",t._.database]).B()}function Bo(t){return Sr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Go(t,e,n){return{name:Uo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,r,i;if(e instanceof Os)n={update:Go(t,e.key,e.value)};else if(e instanceof Fs)n={delete:Uo(t,e.key)};else if(e instanceof xs)n={update:Go(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Cs)n={transform:{document:Uo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof rs)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof is)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof cs)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.B(),increment:e.We};throw Dr()})}};else{if(!(e instanceof js))return Dr();n={verify:Uo(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:Po(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:Dr()),n}function Ko(i,t){var e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Is.updateTime(Ro(o.updateTime)):void 0!==o.exists?Is.exists(o.exists):Is.ze():Is.ze();if(t.update){t.update.name;var n=Mo(i,t.update.name),r=new Bs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new gs(o.map(function(t){return ni.G(t)})));return new xs(n,r,o,e)}return new Os(n,r,e)}if(t.delete){var s=Mo(i,t.delete);return new Fs(s,e)}return t.transform?(r=Mo(i,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Sr("REQUEST_TIME"===t.setToServerValue),r=new rs):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new is(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new cs(n)):"increment"in t?r=new ps(e,t.increment):Dr(),t=ni.G(t.fieldPath),new ms(t,r);var e,n,r}),Sr(!0===e.exists),new Cs(r,s)):t.verify?(t=Mo(i,t.verify),new js(t,e)):Dr()}function Ho(t,e){return{documents:[qo(t,e.path)]}}function Wo(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=qo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=qo(t,r.F()),n.structuredQuery.from=[{collectionId:r.k()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NAN"}};if(To(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_o(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NAN"}};if(To(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(t.field),op:(e=t.op,Do[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Jo(t.field),direction:(t=t.dir,No[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ke||li(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Yo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Yo(e.endAt)),n}function Qo(t){var e=Fo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Sr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$o(t.unaryFilter.field);return Eu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=$o(t.unaryFilter.field);return Eu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=$o(t.unaryFilter.field),Eu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=$o(t.unaryFilter.field),Eu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Eu.create($o(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Dr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Ju($o((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=li(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Xo(n.startAt));var u=null;return n.endAt&&(u=Xo(n.endAt)),fu(iu(e,i,t,o,r,"F",s,u))}function Yo(t){return{before:t.before,values:t.position}}function Xo(t){var e=!!t.before,t=t.values||[];return new Bu(t,e)}function Jo(t){return{fieldPath:t.B()}}function $o(t){return ni.G(t.fieldPath)}function Zo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ts(t,e){return t instanceof ps?Io(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var es,ns,rs=(n(ss,ns=h=function(){this.He=void 0}),ss),is=(n(os,es=h),os);function os(t){var e=this;return(e=es.call(this)||this).elements=t,e}function ss(){return null!==ns&&ns.apply(this,arguments)||this}function us(t,e){for(var n=vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return lo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var as,cs=(n(hs,as=h),hs);function hs(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ls(t,e){for(var n=vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!lo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var fs,ps=(n(ds,fs=h),ds);function ds(t,e){var n=this;return(n=fs.call(this)||this).serializer=t,n.We=e,n}function ys(t){return mo(t.integerValue||t.doubleValue)}function vs(t){return Eo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var gs=(ws.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},ws.prototype.isEqual=function(t){return Pr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ws),ms=function(t,e){this.field=t,this.transform=e};function ws(t){(this.fields=t).sort(ni.D)}function bs(t,e){this.version=t,this.transformResults=e}var Is=(Es.ze=function(){return new Es},Es.exists=function(t){return new Es(void 0,t)},Es.updateTime=function(t){return new Es(t)},Object.defineProperty(Es.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Es.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Es);function Es(t,e){this.updateTime=t,this.exists=e}function Ts(t,e){return void 0!==t.updateTime?e instanceof Js&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Js}function _s(t,e,n,r){return t instanceof Os?(o=e,Ts((i=t).Ge,o)?(o=Ns(o),new Js(i.key,o,i.value,{Je:!0})):o):t instanceof xs?function(t,e){if(!Ts(t.Ge,e))return e;var n=Ns(e),e=Ls(t,e);return new Js(t.key,n,e,{Je:!0})}(t,e):t instanceof Cs?function(t,e,n,r){if(!Ts(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Js&&(h=n.field(a.field)),null===h&&r instanceof Js&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof rs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof is?us(c,i):c instanceof cs?ls(c,i):(i=ys(c=ts(h=c,i))+ys(h.We),Io(c)&&Io(h.We)?Oo(i):xo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Us(t,i.data(),r);return new Js(t.key,i.version,r,{Je:!0})}(t,e,r,n):Ts(t.Ge,e)?new $s(t.key,Zr.min()):e;var i,o}function As(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Pr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof is&&e instanceof is||t instanceof cs&&e instanceof cs?Pr(t.elements,e.elements,lo):t instanceof ps&&e instanceof ps?lo(t.We,e.We):t instanceof rs&&e instanceof rs)}))}function Ns(t){return t instanceof Js?t.version:Zr.min()}var Ds,Ss,Os=(n(Ps,Ss=ge=function(){}),Ps),xs=(n(ks,Ds=ge),ks);function ks(t,e,n,r){var i=this;return(i=Ds.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Ps(t,e,n){var r=this;return(r=Ss.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ls(t,e){return n=t,e=e instanceof Js?e.data():Bs.empty(),r=new Gs(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Rs,Cs=(n(Vs,Rs=ge),Vs);function Vs(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Is.exists(!0),n}function Us(t,e,n){for(var r=new Gs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Ms,qs,Fs=(n(Ws,qs=ge),Ws),js=(n(Hs,Ms=ge),Hs),Bs=(Ks.empty=function(){return new Ks({mapValue:{}})},Ks.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ao(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},Ks.prototype.isEqual=function(t){return lo(this.proto,t.proto)},Ks),Gs=(zs.prototype.set=function(t,e){return this.en(t,e),this},zs.prototype.delete=function(t){return this.en(t,null),this},zs.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ho(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},zs.prototype.Xe=function(){var t=this.nn(ni.U(),this.tn);return null!=t?new Bs(t):this.Ze},zs.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Ao(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},zs);function zs(t){void 0===t&&(t=Bs.empty()),this.Ze=t,this.tn=new Map}function Ks(t){this.proto=t}function Hs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Ge=e,n.type=4,n}function Ws(t,e){var n=this;return(n=qs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var Qs,Ys,Xs,Js=(n(ru,Xs=me=function(t,e){this.key=t,this.version=e}),ru.prototype.field=function(t){return this.sn.field(t)},ru.prototype.data=function(){return this.sn},ru.prototype.rn=function(){return this.sn.proto},ru.prototype.isEqual=function(t){return t instanceof ru&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},ru.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ru),$s=(n(nu,Ys=me),nu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),Zs=(n(eu,Qs=me),eu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),eu.prototype.isEqual=function(t){return t instanceof eu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},eu),tu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function eu(){return null!==Qs&&Qs.apply(this,arguments)||this}function nu(t,e,n){var r=this;return(r=Ys.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ru(t,e,n,r){var i=this;return(i=Xs.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function iu(t,e,n,r,i,o,s,u){return new tu(t,e,n,r,i,o,s,u)}function ou(t){return new tu(t)}function su(t){return!li(t.limit)&&"F"===t.an}function uu(t){return!li(t.limit)&&"L"===t.an}function au(t){return 0<t.on.length?t.on[0].field:null}function cu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function hu(t){return null!==t.collectionGroup}function lu(t){var e=t;if(null===e.cn){e.cn=[];var n=cu(e),t=au(e);if(null!==n&&null===t)n.W()||e.cn.push(new Ju(n)),e.cn.push(new Ju(ni.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new Ju(ni.j(),n)))}}return e.cn}function fu(t){var e=t;if(!e.un)if("F"===e.an)e.un=yi(e.path,e.collectionGroup,lu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=lu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ju(o.field,s))}var u=e.endAt?new Bu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Bu(e.startAt.position,!e.startAt.before):null;e.un=yi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function pu(t,e,n){return new tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function du(t,e){return new tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function yu(t,e){return new tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function vu(t,e){return gi(fu(t),fu(e))&&t.an===e.an}function gu(t){return vi(fu(t))+"|lt:"+t.an}function mu(t){return"Query(target="+(n=(e=fu(t)).path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.B()+" "+t.op+" "+vo(t.value)}).join(", ")+"]"),li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Wu(e.startAt)),e.endAt&&(n+=", endAt: "+Wu(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function wu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.M(n):ri.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Qu(t.startAt,lu(t),n))&&(!t.endAt||!Qu(t.endAt,lu(t),n)));var e,n}function bu(u){return function(t,e){for(var n=!1,r=0,i=lu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.W()?ri.D(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?po(e,r):Dr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Dr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Iu,Eu=(n(Tu,Iu=function(){}),Tu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Du(t,e,n):"array-contains"===e?new Mu(t,n):"in"===e?new qu(t,n):"not-in"===e?new Fu(t,n):"array-contains-any"===e?new ju(t,n):new Tu(t,e,n)},Tu.ln=function(t,e,n){return new("in"===e?Su:Ou)(t,n)},Tu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(po(t,this.value)):null!==t&&ho(this.value)===ho(t)&&this._n(po(t,this.value))},Tu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},Tu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Tu);function Tu(t,e,n){var r=this;return(r=Iu.call(this)||this).field=t,r.op=e,r.value=n,r}var _u,Au,Nu,Du=(n(Pu,Nu=Eu),Pu.prototype.matches=function(t){return t=ri.D(t.key,this.key),this._n(t)},Pu),Su=(n(ku,Au=Eu),ku.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ku),Ou=(n(xu,_u=Eu),xu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},xu);function xu(t,e){var n=this;return(n=_u.call(this,t,"not-in",e)||this).keys=Lu(0,e),n}function ku(t,e){var n=this;return(n=Au.call(this,t,"in",e)||this).keys=Lu(0,e),n}function Pu(t,e,n){var r=this;return(r=Nu.call(this,t,e,n)||this).key=ri.Y(n.referenceValue),r}function Lu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ri.Y(t.referenceValue)})}var Ru,Cu,Vu,Uu,Mu=(n(Hu,Uu=Eu),Hu.prototype.matches=function(t){return Eo(t=t.field(this.field))&&fo(t.arrayValue,this.value)},Hu),qu=(n(Ku,Vu=Eu),Ku.prototype.matches=function(t){return null!==(t=t.field(this.field))&&fo(this.value.arrayValue,t)},Ku),Fu=(n(zu,Cu=Eu),zu.prototype.matches=function(t){return!fo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!fo(this.value.arrayValue,t))},zu),ju=(n(Gu,Ru=Eu),Gu.prototype.matches=function(t){var e=this;return!(!Eo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return fo(e.value.arrayValue,t)})},Gu),Bu=function(t,e){this.position=t,this.before=e};function Gu(t,e){return Ru.call(this,t,"array-contains-any",e)||this}function zu(t,e){return Cu.call(this,t,"not-in",e)||this}function Ku(t,e){return Vu.call(this,t,"in",e)||this}function Hu(t,e){return Uu.call(this,t,"array-contains",e)||this}function Wu(t){return(t.before?"b":"a")+":"+t.position.map(vo).join(",")}function Qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ri.D(ri.Y(s.referenceValue),n.key):po(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Yu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!lo(t.position[n],e.position[n]))return!1;return!0}var Xu,Ju=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},$u=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Zu=(aa.prototype.reset=function(){this.In=0},aa.prototype.Rn=function(){this.In=this.Tn},aa.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Tr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},aa.prototype.Vn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},aa.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},aa.prototype.gn=function(){return(Math.random()-.5)*this.In},aa),ta=(ua.prototype.catch=function(t){return this.next(void 0,t)},ua.prototype.next=function(r,i){var o=this;return this.Dn&&Dr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new ua(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},ua.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ua.prototype.Fn=function(t){try{var e=t();return e instanceof ua?e:ua.resolve(e)}catch(t){return ua.reject(t)}},ua.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):ua.resolve(e)},ua.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):ua.reject(e)},ua.resolve=function(n){return new ua(function(t,e){t(n)})},ua.reject=function(n){return new ua(function(t,e){e(n)})},ua.On=function(t){return new ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ua.kn=function(t){for(var n=ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ua.resolve(t):e()})}(r[e]);return n},ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.On(i)},ua),ea=(sa.delete=function(t){return Tr("SimpleDb","Removing database:",t),da(window.indexedDB.deleteDatabase(t)).xn()},sa.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(sa.Bn())return!0;var t=p(),e=0<(n=sa.$n(t))&&n<10,n=0<(n=sa.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},sa.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},sa.Kn=function(t,e){return t.store(e)},sa.$n=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},sa.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},sa.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Tr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new ra(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new mr(gr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ra(o,t))},r.onupgradeneeded=function(t){Tr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Tr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},sa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},sa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=ha.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ta.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Tr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},sa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},sa),na=(Object.defineProperty(oa.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(oa.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(oa.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),oa.prototype.done=function(){this.Hn=!0},oa.prototype.Xn=function(t){this.Yn=t},oa.prototype.delete=function(){return da(this.zn.delete())},oa),ra=(n(ia,Xu=mr),ia);function ia(t,e){var n=this;return(n=Xu.call(this,gr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function oa(t){this.zn=t,this.Hn=!1,this.Yn=null}function sa(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===sa.$n(p())&&_r("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ua(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function aa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function ca(t){return"IndexedDbTransactionError"===t.name}var ha=(pa.open=function(t,e,n,r){try{return new pa(e,t.transaction(r,n))}catch(t){throw new ra(e,t)}},Object.defineProperty(pa.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),pa.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Tr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},pa.prototype.store=function(t){return t=this.transaction.objectStore(t),new la(t)},pa),la=(fa.prototype.put=function(t,e){return da(t=void 0!==e?(Tr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Tr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},fa.prototype.add=function(t){return Tr("SimpleDb","ADD",this.store.name,t,t),da(this.store.add(t))},fa.prototype.get=function(e){var n=this;return da(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Tr("SimpleDb","GET",n.store.name,e,t),t})},fa.prototype.delete=function(t){return Tr("SimpleDb","DELETE",this.store.name,t),da(this.store.delete(t))},fa.prototype.count=function(){return Tr("SimpleDb","COUNT",this.store.name),da(this.store.count())},fa.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},fa.prototype.ns=function(t,e){return Tr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},fa.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},fa.prototype.os=function(r){var t=this.cursor({});return new ta(function(n,e){t.onerror=function(t){t=va(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},fa.prototype.es=function(t,i){var o=[];return new ta(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new na(n),(t=i(n.primaryKey,n.value,e))instanceof ta&&(t=t.catch(function(t){return e.done(),ta.reject(t)}),o.push(t)),e.Sn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return ta.On(o)})},fa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},fa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},fa);function fa(t){this.store=t}function pa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new $u,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new ra(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=va(t.target.error),n.Zn.reject(new ra(e,t))}}function da(t){return new ta(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=va(t.target.error),n(t)}})}var ya=!1;function va(t){var e=ea.$n(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new mr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ya||(ya=!0,setTimeout(function(){throw n},0)),n}return t}function ga(){return"undefined"!=typeof window?window:null}function ma(){return"undefined"!=typeof document?document:null}var wa=(Ea._s=function(t,e,n,r,i){return(i=new Ea(t,e,Date.now()+n,r,i)).start(n),i},Ea.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Ea.prototype.pn=function(){return this.ds()},Ea.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new mr(gr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ea.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Ea.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},Ea),ba=(Object.defineProperty(Ia.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Ia.prototype.ws=function(t){this.enqueue(t)},Ia.prototype.bs=function(t){this.vs(),this.Ss(t)},Ia.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=ma())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs))},Ia.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Ia.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Ia.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.ys.reset(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Tr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.ys.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Ia.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,_r("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Ia.prototype.yn=function(t,e,n){var r=this;return this.vs(),-1<this.gs.indexOf(t)&&(e=0),n=wa._s(this,t,e,n,function(t){return r.xs(t)}),this.As.push(n),n},Ia.prototype.vs=function(){this.Rs&&Dr()},Ia.prototype.Fs=function(){},Ia.prototype.Os=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Ia.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Ia.prototype.Ms=function(r){var i=this;return this.Os().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.Os()})},Ia.prototype.$s=function(t){this.gs.push(t)},Ia.prototype.xs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},Ia);function Ia(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.ys=new Zu(this,"async_queue_retry"),this.Vs=function(){var t=ma();t&&Tr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ys.Vn()};var t=ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}function Ea(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new $u,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Ta(t,e){if(_r("AsyncQueue",e+": "+t),ca(t))return new mr(gr.UNAVAILABLE,e+": "+t);throw t}function _a(){this.Bs=new Jr(gu,vu),this.onlineState="Unknown",this.qs=new Set}var Aa=function(){this.Ls=void 0,this.listeners=[]};function Na(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Aa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Ta(o=t.sent(),"Initialization of query '"+mu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Sa(e),[2]}})})}function Da(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Sa(t){t.qs.forEach(function(t){t.next()})}var Oa=(Pa.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new zi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},Pa.prototype.onError=function(t){this.js.error(t)},Pa.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},Pa.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},Pa.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Pa.prototype.Js=function(t){t=zi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},Pa),xa=(ka.prototype.Zs=function(){return null!=this.uid},ka.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},ka.prototype.isEqual=function(t){return t.uid===this.uid},ka);function ka(t){this.uid=t}function Pa(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}function La(t,e){this.user=e,this.type="OAuth",this.si={},this.si.Authorization="Bearer "+t}xa.UNAUTHENTICATED=new xa(null),xa.ei=new xa("google-credentials-uid"),xa.ni=new xa("first-party-uid");var Ra=(tc.prototype.getToken=function(){return Promise.resolve(null)},tc.prototype.ri=function(){},tc.prototype.oi=function(t){(this.ii=t)(xa.UNAUTHENTICATED)},tc.prototype.ai=function(){this.ii=null},tc),Ca=(Za.prototype.getToken=function(){var e=this,n=this.hi,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.hi!==n?(Tr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Sr("string"==typeof t.accessToken),new La(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Za.prototype.ri=function(){this.forceRefresh=!0},Za.prototype.oi=function(t){this.ii=t,this.ui&&t(this.currentUser)},Za.prototype.ai=function(){this.auth&&this.auth.removeAuthTokenListener(this.ci),this.ci=null,this.ii=null},Za.prototype.li=function(){var t=this.auth&&this.auth.getUid();return Sr(null===t||"string"==typeof t),new xa(t)},Za),Va=(Object.defineProperty($a.prototype,"si",{get:function(){var t={"X-Goog-AuthUser":this.fi},e=this._i.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),$a),Ua=(Ja.prototype.getToken=function(){return Promise.resolve(new Va(this._i,this.fi))},Ja.prototype.oi=function(t){t(xa.ni)},Ja.prototype.ai=function(){},Ja.prototype.ri=function(){},Ja),Ma=(Xa.prototype.wi=function(t,e,n){for(var r,i,o,s,u,a=n.Ei,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof Os?new Js(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof xs?(u=i,h=o,Ts((s=r).Ge,u)?(u=Ls(s,u),new Js(s.key,h.version,u,{hasCommittedMutations:!0})):new Zs(s.key,h.version)):r instanceof Cs?function(t,e,n){if(Sr(null!=n.transformResults),!Ts(t.Ge,e))return new Zs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Sr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Js&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof is?us(o,s):o instanceof cs?ls(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Us(t,r.data(),e);return new Js(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new $s(r.key,o.version,{hasCommittedMutations:!0}))}return e},Xa.prototype.Ti=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=_s(i,e,e,this.di))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=_s(a,e,o,this.di))}return e},Xa.prototype.Ii=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ti(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Xa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Fi())},Xa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Pr(this.mutations,t.mutations,As)&&Pr(this.baseMutations,t.baseMutations,As)},Xa),qa=(Ya.from=function(t,e,n){Sr(t.mutations.length===n.length);for(var r=Mi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Ya(t,e,n,r)},Ya),h=(Object.defineProperty(Qa.prototype,"readTime",{get:function(){return this.gi},set:function(t){this.gi=t},enumerable:!1,configurable:!0}),Qa.prototype.yi=function(t,e){this.Vi(),this.readTime=e,this.Ri.set(t.key,t)},Qa.prototype.pi=function(t,e){this.Vi(),e&&(this.readTime=e),this.Ri.set(t,null)},Qa.prototype.bi=function(t,e){this.Vi();var n=this.Ri.get(e);return void 0!==n?ta.resolve(n):this.vi(t,e)},Qa.prototype.getEntries=function(t,e){return this.Si(t,e)},Qa.prototype.apply=function(t){return this.Vi(),this.Pi=!0,this.Di(t)},Qa.prototype.Vi=function(){},Qa),Fa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ge=(Wa.prototype.Ni=function(t){this.Ci.push(t)},Wa.prototype.xi=function(){this.Ci.forEach(function(t){return t()})},Wa),ja=(Ha.prototype.Mi=function(e,n){var r=this;return this.Oi.$i(e,n).next(function(t){return r.Li(e,n,t)})},Ha.prototype.Li=function(t,r,i){return this.Fi.bi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ti(r,t);return t})},Ha.prototype.Bi=function(t,e,i){var o=Ri;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ti(t,e);o=o.ot(t,e)}),o},Ha.prototype.qi=function(e,t){var n=this;return this.Fi.getEntries(e,t).next(function(t){return n.Ui(e,t)})},Ha.prototype.Ui=function(e,r){var i=this;return this.Oi.Ki(e,r).next(function(t){var t=i.Bi(e,r,t),n=Ri;return t.forEach(function(t,e){e=e||new $s(t,Zr.min()),n=n.ot(t,e)}),n})},Ha.prototype.Qi=function(t,e,n){return r=e,ri.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wi(t,e.path):hu(e)?this.ji(t,e,n):this.Gi(t,e,n);var r},Ha.prototype.Wi=function(t,e){return this.Mi(t,new ri(e)).next(function(t){var e=Ui;return t instanceof Js&&(e=e.ot(t.key,t)),e})},Ha.prototype.ji=function(n,r,i){var o=this,s=r.collectionGroup,u=Ui;return this.ki.zi(n,s).next(function(t){return ta.forEach(t,function(t){var e=(e=r,t=t.child(s),new tu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Ha.prototype.Gi=function(e,n,t){var a,c,r=this;return this.Fi.Qi(e,n,t).next(function(t){return a=t,r.Oi.Hi(e,n)}).next(function(t){return c=t,r.Yi(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=_s(s,s=a.get(u),s,r.di);a=s instanceof Js?a.ot(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){wu(n,e)||(a=a.remove(t))}),a})},Ha.prototype.Yi=function(t,e,n){for(var r=Fi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof xs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Fi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Js&&(c=c.ot(t,e))}),c})},Ha),Ba=(Ka.Zi=function(t,e){for(var n=Fi(),r=Fi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ka(t,e.fromCache,n,r)},Ka),Ga=(za.prototype.er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},za.prototype.next=function(){var t=++this.previousValue;return this.nr&&this.nr(t),t},za);function za(t,e){var n=this;this.previousValue=t,e&&(e.tr=function(t){return n.er(t)},this.nr=function(t){return e.sr(t)})}function Ka(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ji=n,this.Xi=r}function Ha(t,e,n){this.Fi=t,this.Oi=e,this.ki=n}function Wa(){this.Ci=[]}function Qa(){this.Ri=new Jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Pi=!1}function Ya(t,e,n,r){this.batch=t,this.mi=e,this.Ei=n,this.Ai=r}function Xa(t,e,n,r){this.batchId=t,this.di=e,this.baseMutations=n,this.mutations=r}function Ja(t,e){this._i=t,this.fi=e}function $a(t,e){this._i=t,this.fi=e,this.type="FirstParty",this.user=xa.ni}function Za(t){var e=this;this.ci=null,this.currentUser=xa.UNAUTHENTICATED,this.ui=!1,this.hi=0,this.ii=null,this.forceRefresh=!1,this.ci=function(){e.hi++,e.currentUser=e.li(),e.ui=!0,e.ii&&e.ii(e.currentUser)},this.hi=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ci):(this.ci(null),t.get().then(function(t){e.auth=t,e.ci&&e.auth.addAuthTokenListener(e.ci)},function(){}))}function tc(){this.ii=null}function ec(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=kr(n,t))?kr(r,e):t}Ga.ir=-1;var nc=(sc.prototype.cr=function(){return++this.ar},sc.prototype.ur=function(t){var e=[t,this.cr()];this.buffer.size<this.rr?this.buffer=this.buffer.add(e):ec(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(sc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),sc),rc={hr:!1,lr:0,_r:0,dr:0},ic=(oc.Ir=function(t){return new oc(t,oc.mr,oc.Ar)},oc);function oc(t,e,n){this.wr=t,this.Er=e,this.Tr=n}function sc(t){this.rr=t,this.buffer=new Pi(ec),this.ar=0}ic.mr=10,ic.Ar=1e3,ic.Rr=new ic(41943040,ic.mr,ic.Ar),ic.Pr=new ic(-1,0,0);var uc=(hc.prototype.start=function(t){-1!==this.gr.params.wr&&this.pr(t)},hc.prototype.stop=function(){this.Vr&&(this.Vr.cancel(),this.Vr=null)},Object.defineProperty(hc.prototype,"br",{get:function(){return null!==this.Vr},enumerable:!1,configurable:!0}),hc.prototype.pr=function(n){var t=this,e=this.yr?3e5:6e4;Tr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Vr=this.cs.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Vr=null,this.yr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.vr(this.gr)];case 2:return t.sent(),[3,7];case 3:return ca(e=t.sent())?(Tr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,qh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.pr(n)];case 8:return t.sent(),[2]}})})})},hc),ac=(cc.prototype.Dr=function(t,e){return this.Sr.Cr(t).next(function(t){return Math.floor(e/100*t)})},cc.prototype.Nr=function(t,e){var n=this;if(0===e)return ta.resolve(Ga.ir);var r=new nc(e);return this.Sr.Ce(t,function(t){return r.ur(t.sequenceNumber)}).next(function(){return n.Sr.Fr(t,function(t){return r.ur(t)})}).next(function(){return r.maxValue})},cc.prototype.Or=function(t,e,n){return this.Sr.Or(t,e,n)},cc.prototype.kr=function(t,e){return this.Sr.kr(t,e)},cc.prototype.Mr=function(e,n){var r=this;return-1===this.params.wr?(Tr("LruGarbageCollector","Garbage collection skipped; disabled"),ta.resolve(rc)):this.$r(e).next(function(t){return t<r.params.wr?(Tr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.wr),rc):r.Lr(e,n)})},cc.prototype.$r=function(t){return this.Sr.$r(t)},cc.prototype.Lr=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.Dr(e,this.params.Er).next(function(t){return i=t>h.params.Tr?(Tr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Tr+" from "+t),h.params.Tr):t,s=Date.now(),h.Nr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Or(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.kr(e,r)}).next(function(t){return c=Date.now(),Er()<=f.DEBUG&&Tr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),ta.resolve({hr:!0,lr:i,_r:o,dr:t})})},cc);function cc(t,e){this.Sr=t,this.params=e}function hc(t,e){this.gr=t,this.cs=e,this.yr=!1,this.Vr=null}function lc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=fc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return fc(o)}function fc(t){return t+""}function pc(t){var e=t.length;if(Sr(2<=e),2===e)return Sr(""===t.charAt(0)&&""===t.charAt(1)),ti.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Dr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Dr()}o=s+2}return new ti(r)}var dc=function(t){this.Br=t};function yc(t,e){if(e.document)return n=t.Br,r=e.document,i=!!e.hasCommittedMutations,t=Mo(n,r.name),n=Ro(r.updateTime),r=new Bs({mapValue:{fields:r.fields}}),new Js(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ri.Z(e.noDocument.path),o=bc(e.noDocument.readTime);return new $s(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=ri.Z(e.unknownDocument.path),e=bc(e.unknownDocument.version),new Zs(o,e)):Dr()}function vc(t,e,n){var r=gc(n),n=e.key.path.F().L();if(e instanceof Js){var i={name:Uo(i=t.Br,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Po(i,o.version.v())},o=e.hasCommittedMutations;return new th(null,null,i,o,r,n)}if(e instanceof $s){var i=e.key.path.L(),o=wc(e.version),s=e.hasCommittedMutations;return new th(null,new $c(i,o),null,s,r,n)}return e instanceof Zs?(s=e.key.path.L(),e=wc(e.version),new th(new Zc(s,e),null,null,!0,r,n)):Dr()}function gc(t){return[(t=t.v()).seconds,t.nanoseconds]}function mc(t){return t=new $r(t[0],t[1]),Zr.V(t)}function wc(t){return t=t.v(),new Gc(t.seconds,t.nanoseconds)}function bc(t){return t=new $r(t.seconds,t.nanoseconds),Zr.V(t)}function Ic(e,t){var n=(t.baseMutations||[]).map(function(t){return Ko(e.Br,t)}),r=t.mutations.map(function(t){return Ko(e.Br,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new Ma(t.batchId,i,n,r)}function Ec(t){var e=bc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?bc(t.lastLimboFreeSnapshotVersion):Zr.min(),r=void 0!==t.query.documents?(Sr(1===(r=t.query).documents.length),fu(ou(Fo(r.documents[0])))):Qo(t.query);return new Ii(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Rr.fromBase64String(t.resumeToken))}function Tc(t,e){var n=wc(e.nt),r=wc(e.lastLimboFreeSnapshotVersion),i=(mi(e.target)?Ho:Wo)(t.Br,e.target),t=e.resumeToken.toBase64();return new nh(e.targetId,vi(e.target),n,t,e.sequenceNumber,r,i)}var _c=(Ac.Kr=function(t,e,n,r){return Sr(""!==t.uid),new Ac(t.Zs()?t.uid:"",e,n,r)},Ac.prototype.Qr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Sc(t).rs({index:Yc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Ac.prototype.Wr=function(d,y,v,g){var m=this,w=Oc(d),b=Sc(d);return b.add({}).next(function(t){Sr("number"==typeof t);for(var e,n,r,i,o,s=new Ma(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return zo(e.Br,t)}),o=r.mutations.map(function(t){return zo(e.Br,t)}),new Yc(n,r.batchId,r.di.toMillis(),i,o)),a=[],c=new Pi(function(t,e){return kr(t.B(),e.B())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Xc.key(m.userId,f.key.path,t),c=c.add(f.key.path.F());a.push(b.put(u)),a.push(w.put(p,Xc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ki.jr(d,t))}),d.Ni(function(){m.Ur[t]=s.keys()}),ta.On(a).next(function(){return s})})},Ac.prototype.Gr=function(t,e){var n=this;return Sc(t).get(e).next(function(t){return t?(Sr(t.userId===n.userId),Ic(n.serializer,t)):null})},Ac.prototype.zr=function(t,e){var n=this;return this.Ur[e]?ta.resolve(this.Ur[e]):this.Gr(t,e).next(function(t){return t?(t=t.keys(),n.Ur[e]=t):null})},Ac.prototype.Hr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Sc(t).rs({index:Yc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Sr(e.batchId>=i),o=Ic(r.serializer,e)),n.done()}).next(function(){return o})},Ac.prototype.Yr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Sc(t).rs({index:Yc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Ac.prototype.Jr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Sc(t).ts(Yc.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ic(e.serializer,t)})})},Ac.prototype.$i=function(o,s){var u=this,t=Xc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Oc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=pc(i);if(r===u.userId&&s.path.isEqual(i))return Sc(o).get(t).next(function(t){if(!t)throw Dr();Sr(t.userId===u.userId),a.push(Ic(u.serializer,t))});n.done()}).next(function(){return a})},Ac.prototype.Ki=function(e,t){var s=this,u=new Pi(kr),n=[];return t.forEach(function(o){var t=Xc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Oc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=pc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ta.On(n).next(function(){return s.Xr(e,u)})},Ac.prototype.Hi=function(t,e){var o=this,s=e.path,u=s.length+1,e=Xc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Pi(kr);return Oc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=pc(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Xr(t,a)})},Ac.prototype.Xr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Sc(e).get(t).next(function(t){if(null===t)throw Dr();Sr(t.userId===n.userId),r.push(Ic(n.serializer,t))}))}),ta.On(i).next(function(){return r})},Ac.prototype.Zr=function(e,n){var r=this;return Dc(e.eo,this.userId,n).next(function(t){return e.Ni(function(){r.no(n.batchId)}),ta.forEach(t,function(t){return r.qr.so(e,t)})})},Ac.prototype.no=function(t){delete this.Ur[t]},Ac.prototype.io=function(e){var i=this;return this.Qr(e).next(function(t){if(!t)return ta.resolve();var t=IDBKeyRange.lowerBound(Xc.prefixForUser(i.userId)),r=[];return Oc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=pc(t[1]),r.push(t)):n.done()}).next(function(){Sr(0===r.length)})})},Ac.prototype.ro=function(t,e){return Nc(t,this.userId,e)},Ac.prototype.oo=function(t){var e=this;return xc(t).get(this.userId).next(function(t){return t||new Qc(e.userId,-1,"")})},Ac);function Ac(t,e,n,r){this.userId=t,this.serializer=e,this.ki=n,this.qr=r,this.Ur={}}function Nc(t,o,e){var s=(e=Xc.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Oc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Dc(t,e,n){var r=t.store(Yc.store),i=t.store(Xc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Sr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Xc.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return ta.On(o).next(function(){return u})}function Sc(t){return Eh.Kn(t,Yc.store)}function Oc(t){return Eh.Kn(t,Xc.store)}function xc(t){return Eh.Kn(t,Qc.store)}var kc,Pc=(Cc.prototype.yi=function(t,e,n){return Uc(t).put(Mc(e),n)},Cc.prototype.pi=function(t,e){return t=Uc(t),e=Mc(e),t.delete(e)},Cc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ao(e,t)})},Cc.prototype.bi=function(t,e){var n=this;return Uc(t).get(Mc(e)).next(function(t){return n.co(t)})},Cc.prototype.uo=function(t,e){var n=this;return Uc(t).get(Mc(e)).next(function(t){var e=n.co(t);return e?{ho:e,size:qc(t)}:null})},Cc.prototype.getEntries=function(t,e){var n=this,r=Ri;return this.lo(t,e,function(t,e){e=n.co(e),r=r.ot(t,e)}).next(function(){return r})},Cc.prototype._o=function(t,e){var r=this,i=Ri,o=new Ai(ri.D);return this.lo(t,e,function(t,e){var n=r.co(e);o=n?(i=i.ot(t,n),o.ot(t,qc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{fo:i,do:o}})},Cc.prototype.lo=function(t,e,i){if(e.P())return ta.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Uc(t).rs({range:n},function(t,e,n){for(var r=ri.Z(t);s&&ri.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Cc.prototype.Qi=function(t,r,e){var n,i=this,o=Ui,s=r.path.length+1,u={};return e.isEqual(Zr.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=gc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=th.collectionReadTimeIndex),Uc(t).rs(u,function(t,e,n){t.length===s&&(e=yc(i.serializer,e),r.path.M(e.key.path)?e instanceof Js&&wu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Cc.prototype.wo=function(t){return new Lc(this,!!t&&t.Eo)},Cc.prototype.To=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Cc.prototype.getMetadata=function(t){return Vc(t).get(eh.key).next(function(t){return Sr(!!t),t})},Cc.prototype.ao=function(t,e){return Vc(t).put(eh.key,e)},Cc.prototype.co=function(t){return!t||(t=yc(this.serializer,t))instanceof $s&&t.version.isEqual(Zr.min())?null:t},Cc),Lc=(n(Rc,kc=h),Rc.prototype.Di=function(i){var o=this,s=[],u=0,a=new Pi(function(t,e){return kr(t.B(),e.B())});return this.Ri.forEach(function(t,e){var n,r=o.mo.get(t);e?(n=vc(o.Io.serializer,e,o.readTime),a=a.add(t.path.F()),e=qc(n),u+=e-r,s.push(o.Io.yi(i,t,n))):(u-=r,o.Eo?(r=vc(o.Io.serializer,new $s(t,Zr.min()),o.readTime),s.push(o.Io.yi(i,t,r))):s.push(o.Io.pi(i,t)))}),a.forEach(function(t){s.push(o.Io.ki.jr(i,t))}),s.push(this.Io.updateMetadata(i,u)),ta.On(s)},Rc.prototype.vi=function(t,e){var n=this;return this.Io.uo(t,e).next(function(t){return null===t?(n.mo.set(e,0),null):(n.mo.set(e,t.size),t.ho)})},Rc.prototype.Si=function(t,e){var n=this;return this.Io._o(t,e).next(function(t){var e=t.fo;return t.do.forEach(function(t,e){n.mo.set(t,e)}),e})},Rc);function Rc(t,e){var n=this;return(n=kc.call(this)||this).Io=t,n.Eo=e,n.mo=new Jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Cc(t,e){this.serializer=t,this.ki=e}function Vc(t){return Eh.Kn(t,eh.store)}function Uc(t){return Eh.Kn(t,th.store)}function Mc(t){return t.path.L()}function qc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Dr();e=t.noDocument}return JSON.stringify(e).length}var Fc=(Wc.prototype.jr=function(t,e){return this.Ao.add(e),ta.resolve()},Wc.prototype.zi=function(t,e){return ta.resolve(this.Ao.getEntries(e))},Wc),jc=(Hc.prototype.add=function(t){var e=t.k(),n=t.F(),r=this.index[e]||new Pi(ti.D),t=!r.has(n);return this.index[e]=r.add(n),t},Hc.prototype.has=function(t){var e=t.k(),t=t.F();return(e=this.index[e])&&e.has(t)},Hc.prototype.getEntries=function(t){return(this.index[t]||new Pi(ti.D)).L()},Hc),Bc=(Kc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Sr(t<r&&0<=t&&r<=10);var o=new ha("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(zc.store),(s=e).createObjectStore(Qc.store,{keyPath:Qc.keyPath}),s.createObjectStore(Yc.store,{keyPath:Yc.keyPath,autoIncrement:!0}).createIndex(Yc.userMutationsIndex,Yc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Xc.store),sh(e),e.createObjectStore(th.store));var s,u=ta.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(rh.store),s.deleteObjectStore(nh.store),s.deleteObjectStore(ih.store),sh(e)),u=u.next(function(){return t=o.store(ih.store),e=new ih(0,0,Zr.min().v(),0),t.put(ih.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Yc.store).ts().next(function(t){n.deleteObjectStore(Yc.store),n.createObjectStore(Yc.store,{keyPath:Yc.keyPath,autoIncrement:!0}).createIndex(Yc.userMutationsIndex,Yc.userMutationsKeyPath,{unique:!0});var e=r.store(Yc.store),t=t.map(function(t){return e.put(t)});return ta.On(t)});var n,r})),u=u.next(function(){e.createObjectStore(uh.store,{keyPath:uh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(eh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(th.store)).createIndex(th.readTimeIndex,th.readTimeIndexPath,{unique:!1}),t.createIndex(th.collectionReadTimeIndex,th.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},Kc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(th.store).rs(function(t,e){n+=qc(e)}).next(function(){var t=new eh(n);return e.store(eh.store).put(eh.key,t)})},Kc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Qc.store),i=n.store(Yc.store);return t.ts().next(function(t){return ta.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(Yc.userMutationsIndex,t).next(function(t){return ta.forEach(t,function(t){return Sr(t.userId===e.userId),t=Ic(r.serializer,t),Dc(n,e.userId,t).next(function(){})})})})})},Kc.prototype.ensureSequenceNumbers=function(t){var o=t.store(rh.store),e=t.store(th.store);return t.store(ih.store).get(ih.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new ti(t),t=[0,lc(n)];i.push(o.get(t).next(function(t){return t?ta.resolve():o.put(new rh(0,lc(n),r.highestListenSequenceNumber))}))}).next(function(){return ta.On(i)})})},Kc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.k(),t=t.F();return n.put({collectionId:e,parent:lc(t)})}}t.createObjectStore(oh.store,{keyPath:oh.keyPath});var n=e.store(oh.store),i=new jc;return e.store(th.store).rs({ss:!0},function(t,e){return r((t=new ti(t)).F())}).next(function(){return e.store(Xc.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],pc(n))).F())})})},Kc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(nh.store);return r.rs(function(t,e){return e=Ec(e),e=Tc(n.serializer,e),r.put(e)})},Kc),Gc=function(t,e){this.seconds=t,this.nanoseconds=e},zc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Kc(t){this.serializer=t}function Hc(){this.index={}}function Wc(){this.Ao=new jc}zc.store="owner",zc.key="owner";var Qc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Qc.store="mutationQueues",Qc.keyPath="userId";var Yc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Yc.store="mutations",Yc.keyPath="batchId",Yc.userMutationsIndex="userMutationsIndex",Yc.userMutationsKeyPath=["userId","batchId"];var Xc=(Jc.prefixForUser=function(t){return[t]},Jc.prefixForPath=function(t,e){return[t,lc(e)]},Jc.key=function(t,e,n){return[t,lc(e),n]},Jc);function Jc(){}Xc.store="documentMutations",Xc.PLACEHOLDER=new Xc;var $c=function(t,e){this.path=t,this.readTime=e},Zc=function(t,e){this.path=t,this.version=e},th=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};th.store="remoteDocuments",th.readTimeIndex="readTimeIndex",th.readTimeIndexPath="readTime",th.collectionReadTimeIndex="collectionReadTimeIndex",th.collectionReadTimeIndexPath=["parentPath","readTime"];var eh=function(t){this.byteSize=t};eh.store="remoteDocumentGlobal",eh.key="remoteDocumentGlobalKey";var nh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};nh.store="targets",nh.keyPath="targetId",nh.queryTargetsIndexName="queryTargetsIndex",nh.queryTargetsKeyPath=["canonicalId","targetId"];var rh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};rh.store="targetDocuments",rh.keyPath=["targetId","path"],rh.documentTargetsIndex="documentTargetsIndex",rh.documentTargetsKeyPath=["path","targetId"];var ih=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ih.key="targetGlobalKey",ih.store="targetGlobal";var oh=function(t,e){this.collectionId=t,this.parent=e};function sh(t){t.createObjectStore(rh.store,{keyPath:rh.keyPath}).createIndex(rh.documentTargetsIndex,rh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(nh.store,{keyPath:nh.keyPath}).createIndex(nh.queryTargetsIndexName,nh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ih.store)}oh.store="collectionParents",oh.keyPath=["collectionId","parent"];var uh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};uh.store="clientMetadata",uh.keyPath="clientId";var ah=i(i(i([Qc.store,Yc.store,Xc.store,th.store,nh.store,zc.store,ih.store,rh.store],[uh.store]),[eh.store]),[oh.store]),ch=(hh.prototype.jr=function(t,e){var n=this;if(this.Ro.has(e))return ta.resolve();var r=e.k(),i=e.F();return t.Ni(function(){n.Ro.add(e)}),i={collectionId:r,parent:lc(i)},lh(t).put(i)},hh.prototype.zi=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Lr(i),""],!1,!0);return lh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(pc(r.parent))}return o})},hh);function hh(){this.Ro=new jc}function lh(t){return Eh.Kn(t,oh.store)}var fh=(yh.prototype.next=function(){return this.Po+=2,this.Po},yh.yo=function(){return new yh(0)},yh.Vo=function(){return new yh(-1)},yh),ph=(dh.prototype.po=function(n){var r=this;return this.bo(n).next(function(t){var e=new fh(t.highestTargetId);return t.highestTargetId=e.next(),r.vo(n,t).next(function(){return t.highestTargetId})})},dh.prototype.So=function(t){return this.bo(t).next(function(t){return Zr.V(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},dh.prototype.Do=function(t){return this.bo(t).next(function(t){return t.highestListenSequenceNumber})},dh.prototype.Co=function(e,n,r){var i=this;return this.bo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.vo(e,t)})},dh.prototype.No=function(e,n){var r=this;return this.xo(e,n).next(function(){return r.bo(e).next(function(t){return t.targetCount+=1,r.Fo(n,t),r.vo(e,t)})})},dh.prototype.Oo=function(t,e){return this.xo(t,e)},dh.prototype.ko=function(e,t){var n=this;return this.Mo(e,t.targetId).next(function(){return vh(e).delete(t.targetId)}).next(function(){return n.bo(e)}).next(function(t){return Sr(0<t.targetCount),--t.targetCount,n.vo(e,t)})},dh.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return vh(n).rs(function(t,e){(e=Ec(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ko(n,e)))}).next(function(){return ta.On(u)}).next(function(){return s})},dh.prototype.Ce=function(t,n){return vh(t).rs(function(t,e){e=Ec(e),n(e)})},dh.prototype.bo=function(t){return gh(t).get(ih.key).next(function(t){return Sr(null!==t),t})},dh.prototype.vo=function(t,e){return gh(t).put(ih.key,e)},dh.prototype.xo=function(t,e){return vh(t).put(Tc(this.serializer,e))},dh.prototype.Fo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},dh.prototype.$o=function(t){return this.bo(t).next(function(t){return t.targetCount})},dh.prototype.Lo=function(t,r){var e=vi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return vh(t).rs({range:e,index:nh.queryTargetsIndexName},function(t,e,n){e=Ec(e),gi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},dh.prototype.Bo=function(n,t,r){var i=this,o=[],s=mh(n);return t.forEach(function(t){var e=lc(t.path);o.push(s.put(new rh(r,e))),o.push(i.qr.qo(n,r,t))}),ta.On(o)},dh.prototype.Uo=function(n,t,r){var i=this,o=mh(n);return ta.forEach(t,function(t){var e=lc(t.path);return ta.On([o.delete([r,e]),i.qr.Ko(n,r,t)])})},dh.prototype.Mo=function(t,e){return t=mh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},dh.prototype.Qo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=mh(t),r=Fi();return t.rs({range:e,ss:!0},function(t,e,n){t=pc(t[1]),t=new ri(t),r=r.add(t)}).next(function(){return r})},dh.prototype.ro=function(t,e){var e=lc(e.path),e=IDBKeyRange.bound([e],[Lr(e)],!1,!0),i=0;return mh(t).rs({index:rh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},dh.prototype.Ue=function(t,e){return vh(t).get(e).next(function(t){return t?Ec(t):null})},dh);function dh(t,e){this.qr=t,this.serializer=e}function yh(t){this.Po=t}function vh(t){return Eh.Kn(t,nh.store)}function gh(t){return Eh.Kn(t,ih.store)}function mh(t){return Eh.Kn(t,rh.store)}var wh,bh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ih=(n(_h,wh=ge),_h),Eh=(Th.Kn=function(t,e){if(t instanceof Ih)return ea.Kn(t.eo,e);throw Dr()},Th.prototype.start=function(){var e=this;return this.ra().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new mr(gr.FAILED_PRECONDITION,bh);return e.oa(),e.aa(),e.ca(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.sa.Do(t)})}).then(function(t){e.zo=new Ga(t,e.jo)}).then(function(){e.Ho=!0}).catch(function(t){return e.na&&e.na.close(),Promise.reject(t)})},Th.prototype.ua=function(n){var t=this;return this.ta=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.br?[2,n(e)]:[2]})})},n(this.isPrimary)},Th.prototype.ha=function(n){var t=this;this.na.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Th.prototype.la=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.br?[4,this.ra()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Th.prototype.ra=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Nh(e).put(new uh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._a(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.ta(!1)}))})}).next(function(){return n.fa(e)}).next(function(t){return n.isPrimary&&!t?n.da(e).next(function(){return!1}):!!t&&n.wa(e).next(function(){return!0})})}).catch(function(t){if(ca(t))return Tr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Tr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.ta(t)}),n.isPrimary=t})},Th.prototype._a=function(t){var e=this;return Ah(t).get(zc.key).next(function(t){return ta.resolve(e.Ea(t))})},Th.prototype.Ta=function(t){return Nh(t).delete(this.clientId)},Th.prototype.Ia=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ma(this.Zo,18e5)?[3,2]:(this.Zo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Th.Kn(t,uh.store);return r.ts().next(function(t){var e=o.Aa(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ta.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ia)for(n=0,r=e;n<r.length;n++)i=r[n],this.ia.removeItem(this.Ra(i.clientId));t.label=2;case 2:return[2]}})})},Th.prototype.ca=function(){var t=this;this.Xo=this.fn.yn("client_metadata_refresh",4e3,function(){return t.ra().then(function(){return t.Ia()}).then(function(){return t.ca()})})},Th.prototype.Ea=function(t){return!!t&&t.ownerId===this.clientId},Th.prototype.fa=function(e){var r=this;return this.Go?ta.resolve(!0):Ah(e).get(zc.key).next(function(t){if(null!==t&&r.ma(t.leaseTimestampMs,5e3)&&!r.Pa(t.ownerId)){if(r.Ea(t)&&r.networkEnabled)return!0;if(!r.Ea(t)){if(!t.allowTabSynchronization)throw new mr(gr.FAILED_PRECONDITION,bh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Nh(e).ts().next(function(t){return void 0===r.Aa(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Tr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Th.prototype.ga=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Ho=!1,this.ya(),this.Xo&&(this.Xo.cancel(),this.Xo=null),this.Va(),this.pa(),[4,this.na.runTransaction("shutdown","readwrite",[zc.store,uh.store],function(t){var e=new Ih(t,Ga.ir);return n.da(e).next(function(){return n.Ta(e)})})];case 1:return t.sent(),this.na.close(),this.ba(),[2]}})})},Th.prototype.Aa=function(t,e){var n=this;return t.filter(function(t){return n.ma(t.updateTimeMs,e)&&!n.Pa(t.clientId)})},Th.prototype.va=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Nh(t).ts().next(function(t){return e.Aa(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Th.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),Th.prototype.Sa=function(t){return _c.Kr(t,this.serializer,this.ki,this.qr)},Th.prototype.Da=function(){return this.sa},Th.prototype.Ca=function(){return this.Fi},Th.prototype.Na=function(){return this.ki},Th.prototype.runTransaction=function(e,n,r){var i=this;Tr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.na.runTransaction(e,t,ah,function(t){return o=new Ih(t,i.zo?i.zo.next():Ga.ir),"readwrite-primary"===n?i._a(o).next(function(t){return!!t||i.fa(o)}).next(function(t){if(!t)throw _r("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.ta(!1)}),new mr(gr.FAILED_PRECONDITION,Fa);return r(o)}).next(function(t){return i.wa(o).next(function(){return t})}):i.xa(o).next(function(){return r(o)})}).then(function(t){return o.xi(),t})},Th.prototype.xa=function(t){var e=this;return Ah(t).get(zc.key).next(function(t){if(null!==t&&e.ma(t.leaseTimestampMs,5e3)&&!e.Pa(t.ownerId)&&!e.Ea(t)&&!(e.Go||e.allowTabSynchronization&&t.allowTabSynchronization))throw new mr(gr.FAILED_PRECONDITION,bh)})},Th.prototype.wa=function(t){var e=new zc(this.clientId,this.allowTabSynchronization,Date.now());return Ah(t).put(zc.key,e)},Th.Ln=function(){return ea.Ln()},Th.prototype.da=function(t){var e=this,n=Ah(t);return n.get(zc.key).next(function(t){return e.Ea(t)?(Tr("IndexedDbPersistence","Releasing primary lease."),n.delete(zc.key)):ta.resolve()})},Th.prototype.ma=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(_r("Detected an update time that is in the future: "+t+" > "+n),1))},Th.prototype.oa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Jo=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.ra()})},this.document.addEventListener("visibilitychange",this.Jo),this.inForeground="visible"===this.document.visibilityState)},Th.prototype.Va=function(){this.Jo&&(this.document.removeEventListener("visibilitychange",this.Jo),this.Jo=null)},Th.prototype.aa=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Yo=function(){e.ya(),e.fn.ws(function(){return e.ga()})},this.window.addEventListener("unload",this.Yo))},Th.prototype.pa=function(){this.Yo&&(this.window.removeEventListener("unload",this.Yo),this.Yo=null)},Th.prototype.Pa=function(t){try{var e=null!==(null===(e=this.ia)||void 0===e?void 0:e.getItem(this.Ra(t)));return Tr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return _r("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Th.prototype.ya=function(){if(this.ia)try{this.ia.setItem(this.Ra(this.clientId),String(Date.now()))}catch(t){_r("Failed to set zombie client id.",t)}},Th.prototype.ba=function(){if(this.ia)try{this.ia.removeItem(this.Ra(this.clientId))}catch(t){}},Th.prototype.Ra=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Th);function Th(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.jo=a,this.Go=c,this.zo=null,this.Ho=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Yo=null,this.inForeground=!1,this.Jo=null,this.Xo=null,this.Zo=Number.NEGATIVE_INFINITY,this.ta=function(t){return Promise.resolve()},!Th.Ln())throw new mr(gr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.qr=new Dh(this,r),this.ea=e+"main",this.serializer=new dc(u),this.na=new ea(this.ea,10,new Bc(this.serializer)),this.sa=new ph(this.qr,this.serializer),this.ki=new ch,this.Fi=(e=this.serializer,u=this.ki,new Pc(e,u)),this.window&&this.window.localStorage?this.ia=this.window.localStorage:(this.ia=null,!1===c&&_r("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function _h(t,e){var n=this;return(n=wh.call(this)||this).eo=t,n.Wo=e,n}function Ah(t){return Eh.Kn(t,zc.store)}function Nh(t){return Eh.Kn(t,uh.store)}var Dh=(Sh.prototype.Cr=function(t){var n=this.Fa(t);return this.db.Da().$o(t).next(function(e){return n.next(function(t){return e+t})})},Sh.prototype.Fa=function(t){var e=0;return this.Fr(t,function(t){e++}).next(function(){return e})},Sh.prototype.Ce=function(t,e){return this.db.Da().Ce(t,e)},Sh.prototype.Fr=function(t,n){return this.Oa(t,function(t,e){return n(e)})},Sh.prototype.qo=function(t,e,n){return Oh(t,n)},Sh.prototype.Ko=function(t,e,n){return Oh(t,n)},Sh.prototype.Or=function(t,e,n){return this.db.Da().Or(t,e,n)},Sh.prototype.so=Oh,Sh.prototype.ka=function(t,e){return r=e,i=!1,xc(n=t).os(function(t){return Nc(n,t,r).next(function(t){return t&&(i=!0),ta.resolve(!t)})}).next(function(){return i});var n,r,i},Sh.prototype.kr=function(n,r){var i=this,o=this.db.Ca().wo(),s=[],u=0;return this.Oa(n,function(e,t){t<=r&&(t=i.ka(n,e).next(function(t){if(!t)return u++,o.bi(n,e).next(function(){return o.pi(e),mh(n).delete([0,lc(e.path)])})}),s.push(t))}).next(function(){return ta.On(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Sh.prototype.removeTarget=function(t,e){return e=e.st(t.Wo),this.db.Da().Oo(t,e)},Sh.prototype.Ma=Oh,Sh.prototype.Oa=function(t,r){var i,t=mh(t),o=Ga.ir;return t.rs({index:rh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ga.ir&&r(new ri(pc(i)),o),o=e,i=t):o=Ga.ir}).next(function(){o!==Ga.ir&&r(new ri(pc(i)),o)})},Sh.prototype.$r=function(t){return this.db.Ca().To(t)},Sh);function Sh(t,e){this.db=t,this.gr=new ac(this,e)}function Oh(t,e){return mh(t).put((t=t.Wo,new rh(0,lc(e.path),t)))}function xh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var kh=(Ph.prototype.vr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Mr(t,n.La)})},Ph);function Ph(t,e,n){this.persistence=t,this.$a=e,this.La=new Ai(kr),this.Ba=new Jr(vi,gi),this.qa=Zr.min(),this.Oi=t.Sa(n),this.Ua=t.Ca(),this.sa=t.Da(),this.Ka=new ja(this.Ua,this.Oi,this.persistence.Na()),this.$a.Qa(this.Ka)}function Lh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Oi,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Oi.Jr(v).next(function(t){return g=t,n=e.persistence.Sa(o),m=new ja(e.Ua,n,e.persistence.Na()),n.Jr(v)}).next(function(t){for(var e=[],n=[],r=Fi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.qi(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Oi=n,e.Ka=m,e.$a.Qa(e.Ka),r)]}})})}function Rh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.sa.So(t)})}function Ch(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.sa.Lo(e,r).next(function(t){return t?(n=t,ta.resolve(n)):i.sa.po(e).next(function(t){return n=new Ii(r,t,0,e.Wo),i.sa.No(e,n).next(function(){return n})})})}).then(function(t){var e=i.La.get(t.targetId);return(null===e||0<t.nt.u(e.nt))&&(i.La=i.La.ot(t.targetId,t),i.Ba.set(r,t.targetId)),t})}function Vh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).La.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.qr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ca(r=t.sent()))throw r;return Tr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.La=e.La.remove(o),e.Ba.delete(n.target),[2]}})})}function Uh(t,o,s){var u=t,a=Zr.min(),c=Fi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=fu(o),(void 0!==(t=(i=t).Ba.get(r))?ta.resolve(i.La.get(t)):i.sa.Lo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.sa.Qo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.$a.Qi(e,o,s?a:Zr.min(),s?c:Fi())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}function Mh(t,e){var n=t,r=n.sa;return(t=n.La.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function qh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==gr.FAILED_PRECONDITION||e.message!==Fa)throw e;return Tr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Fh(t,e,n,r,i){var o=this;this.Bc=t,this.qc=e,this.cs=n,this.Uc={},this.Kc=[],this.Qc=new Map,this.Wc=new Set,this.jc=[],this.Gc=i,this.Gc.zc(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ul(this)?(Tr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(4),[4,tl(e)];case 1:return t.sent(),e.Hc.set("Unknown"),e.Wc.delete(4),[4,Zh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Hc=new Wh(n,r)}var jh,Bh,Gh,me=($h.prototype.ec=function(){return 1===this.state||2===this.state||4===this.state},$h.prototype.nc=function(){return 2===this.state},$h.prototype.start=function(){3!==this.state?this.auth():this.sc()},$h.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ec()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.ic=function(){this.state=0,this.ys.reset()},$h.prototype.rc=function(){var t=this;this.nc()&&null===this.tc&&(this.tc=this.fn.yn(this.Ya,6e4,function(){return t.oc()}))},$h.prototype.ac=function(t){this.cc(),this.stream.send(t)},$h.prototype.oc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.nc()?[2,this.close(0)]:[2]})})},$h.prototype.cc=function(){this.tc&&(this.tc.cancel(),this.tc=null)},$h.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc(),this.ys.cancel(),this.Za++,3!==e?this.ys.reset():n&&n.code===gr.RESOURCE_EXHAUSTED?(_r(n.toString()),_r("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===gr.UNAUTHENTICATED&&this.Xa.ri(),null!==this.stream&&(this.uc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.hc(n)];case 1:return t.sent(),[2]}})})},$h.prototype.uc=function(){},$h.prototype.auth=function(){var n=this;this.state=1;var t=this.lc(this.Za),e=this.Za;this.Xa.getToken().then(function(t){n.Za===e&&n._c(t)},function(e){t(function(){var t=new mr(gr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fc(t)})})},$h.prototype._c=function(t){var e=this,n=this.lc(this.Za);this.stream=this.dc(t),this.stream.wc(function(){n(function(){return e.state=2,e.listener.wc()})}),this.stream.hc(function(t){n(function(){return e.fc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$h.prototype.sc=function(){var t=this;this.state=4,this.ys.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},$h.prototype.fc=function(t){return Tr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$h.prototype.lc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.Za===e?t():(Tr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$h),zh=(n(Jh,Gh=me),Jh.prototype.dc=function(t){return this.Ja.Ec("Listen",t)},Jh.prototype.onMessage=function(t){this.ys.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Dr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Sr(void 0===o||"string"==typeof o),Rr.fromBase64String(o||"")):(Sr(void 0===o||o instanceof Uint8Array),Rr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?gr.UNKNOWN:_i(s.code),new mr(o,s.message||"")),r=new Yi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Mo(t,a.document.name),u=Ro(a.document.updateTime),s=new Bs({mapValue:{fields:a.document.fields}}),u=new Js(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Wi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Mo(t,a.document),c=a.readTime?Ro(a.readTime):Zr.min(),c=new $s(u,c),a=a.removedTargetIds||[];r=new Wi([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Mo(t,c.document),c=c.removedTargetIds||[];r=new Wi([],c,h,null)}else{if(!("filter"in e))return Dr();e.filter,(h=e.filter).targetId,e=new wi(e=h.count||0),h=h.targetId,r=new Qi(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Zr.min():Ro(e.readTime);return this.listener.Tc(n,t)},Jh.prototype.Ic=function(t){var e,n,r,i,o={};o.database=jo(this.serializer),o.addTarget=(e=this.serializer,(r=mi(r=(n=t).target)?{documents:Ho(e,r)}:{query:Wo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Lo(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.ac(o)},Jh.prototype.mc=function(t){var e={};e.database=jo(this.serializer),e.removeTarget=t,this.ac(e)},Jh),Kh=(n(Xh,Bh=me),Object.defineProperty(Xh.prototype,"Rc",{get:function(){return this.Ac},enumerable:!1,configurable:!0}),Xh.prototype.start=function(){this.Ac=!1,this.lastStreamToken=void 0,Bh.prototype.start.call(this)},Xh.prototype.uc=function(){this.Ac&&this.Pc([])},Xh.prototype.dc=function(t){return this.Ja.Ec("Write",t)},Xh.prototype.onMessage=function(t){if(Sr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ac){this.ys.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Sr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ro(e.updateTime):Ro(n)).isEqual(Zr.min())&&(t=Ro(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new bs(t,n);var e,n})):[]),n=Ro(t.commitTime);return this.listener.gc(n,e)}var r;return Sr(!t.writeResults||0===t.writeResults.length),this.Ac=!0,this.listener.yc()},Xh.prototype.Vc=function(){var t={};t.database=jo(this.serializer),this.ac(t)},Xh.prototype.Pc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.ac(t)},Xh),Hh=(n(Yh,jh=function(){}),Yh.prototype.vc=function(){if(this.bc)throw new mr(gr.FAILED_PRECONDITION,"The client has already been terminated.")},Yh.prototype.Sc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ja.Sc(e,n,r,t)}).catch(function(t){throw t.code===gr.UNAUTHENTICATED&&i.credentials.ri(),t})},Yh.prototype.Dc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ja.Dc(e,n,r,t)}).catch(function(t){throw t.code===gr.UNAUTHENTICATED&&i.credentials.ri(),t})},Yh.prototype.terminate=function(){this.bc=!1},Yh),Wh=(Qh.prototype.Oc=function(){var t=this;0===this.Nc&&(this.kc("Unknown"),this.xc=this.cs.yn("online_state_timeout",1e4,function(){return t.xc=null,t.Mc("Backend didn't respond within 10 seconds."),t.kc("Offline"),Promise.resolve()}))},Qh.prototype.$c=function(t){"Online"===this.state?this.kc("Unknown"):(this.Nc++,1<=this.Nc&&(this.Lc(),this.Mc("Connection failed 1 times. Most recent error: "+t.toString()),this.kc("Offline")))},Qh.prototype.set=function(t){this.Lc(),this.Nc=0,"Online"===t&&(this.Fc=!1),this.kc(t)},Qh.prototype.kc=function(t){t!==this.state&&(this.state=t,this.Cc(t))},Qh.prototype.Mc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Fc?(_r(t),this.Fc=!1):Tr("OnlineStateTracker",t)},Qh.prototype.Lc=function(){null!==this.xc&&(this.xc.cancel(),this.xc=null)},Qh);function Qh(t,e){this.cs=t,this.Cc=e,this.state="Unknown",this.Nc=0,this.xc=null,this.Fc=!0}function Yh(t,e,n){var r=this;return(r=jh.call(this)||this).credentials=t,r.Ja=e,r.serializer=n,r.bc=!1,r}function Xh(t,e,n,r,i){var o=this;return(o=Bh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ac=!1,o}function Jh(t,e,n,r,i){var o=this;return(o=Gh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $h(t,e,n,r,i,o){this.fn=t,this.Ya=n,this.Ja=r,this.Xa=i,this.listener=o,this.state=0,this.Za=0,this.tc=null,this.stream=null,this.ys=new Zu(t,e)}function Zh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ul(r))return[3,4];e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function tl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function el(t,e){t.Qc.has(e.targetId)||(t.Qc.set(e.targetId,e),sl(t)?ol(t):yl(t).nc()&&rl(t,e))}function nl(t,e){var n=t,t=yl(n);n.Qc.delete(e),t.nc()&&il(n,e),0===n.Qc.size&&(t.nc()?t.rc():ul(n)&&n.Hc.set("Unknown"))}function rl(t,e){t.Yc.me(e.targetId),yl(t).Ic(e)}function il(t,e){t.Yc.me(e),yl(t).mc(e)}function ol(e){e.Yc=new Ji({qe:function(t){return e.Uc.qe(t)},Ue:function(t){return e.Qc.get(t)||null}}),yl(e).start(),e.Hc.Oc()}function sl(t){return ul(t)&&!yl(t).ec()&&0<t.Qc.size}function ul(t){return 0===t.Wc.size}function al(t){t.Yc=void 0}function cl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ca(r))throw r;return n.Wc.add(1),[4,tl(n)];case 1:return t.sent(),n.Hc.set("Offline"),i=i||function(){return Rh(n.Bc)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Tr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Wc.delete(1),[4,Zh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function hl(e,n){return n().catch(function(t){return cl(e,t,n)})}function ll(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=vl(o=c),u=0<o.Kc.length?o.Kc[o.Kc.length-1].batchId:-1,t.label=1;case 1:if(!(ul(o)&&o.Kc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Bc,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Oi.Hr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kc.length&&s.rc(),[3,7]):(u=a.batchId,e=a,(n=o).Kc.push(e),(n=vl(n)).nc()&&n.Rc&&n.Pc(e.mutations),[3,6]);case 4:return a=t.sent(),[4,cl(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return fl(o)&&pl(o),[2]}var e,n,r,i})})}function fl(t){return ul(t)&&!vl(t).ec()&&0<t.Kc.length}function pl(t){vl(t).start()}function dl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Wc.delete(2),[4,Zh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Wc.add(2),[4,tl(e)]);case 3:t.sent(),e.Hc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function yl(n){var t,e,r,i=this;return n.eu||(n.eu=(t=n.qc,e=n.cs,r={wc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Qc.forEach(function(t,e){rl(n,t)}),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return al(e),sl(e)?(e.Hc.$c(n),ol(e)):e.Hc.set("Unknown"),[2]})})}.bind(null,n),Tc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Hc.set("Online"),!(u instanceof Yi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Qc.has(i)?[4,o.Uc.Jc(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Qc.delete(i),o.Yc.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Tr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,cl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Wi?s.Yc.be(u):u instanceof Qi?s.Yc.Oe(u):s.Yc.De(u),a.isEqual(Zr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Rh(s.Bc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yc.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Qc.get(e))&&r.Qc.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Qc.get(t);e&&(r.Qc.set(t,e.it(Rr.h,e.nt)),il(r,t),e=new Ii(e.target,t,1,e.sequenceNumber),rl(r,e))}),r.Uc.Xc(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Tr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,cl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.vc(),new zh(e,t.Ja,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.eu.ic(),sl(n)?ol(n):n.Hc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.eu.stop()];case 2:t.sent(),al(n),t.label=3;case 3:return[2]}})})})),n.eu}function vl(n){var t,e,r,i=this;return n.nu||(n.nu=(t=n.qc,e=n.cs,r={wc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return vl(e).Vc(),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&vl(e).Rc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ti(n=i.code)&&n!==gr.ABORTED?(e=r.Kc.shift(),vl(r).ic(),[4,hl(r,function(){return r.Uc.tu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ll(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return fl(e)&&pl(e),[2]}})})}.bind(null,n),yc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=vl(o),n=0,r=o.Kc;n<r.length;n++)i=r[n],e.Pc(i.mutations);return[2]})})}.bind(null,n),gc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kc.shift(),n=qa.from(e,i,o),[4,hl(r,function(){return r.Uc.Zc(n)})];case 1:return t.sent(),[4,ll(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.vc(),new Kh(e,t.Ja,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nu.ic(),[4,ll(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.nu.stop()];case 3:t.sent(),0<n.Kc.length&&(Tr("RemoteStore","Stopping write stream with "+n.Kc.length+" pending writes"),n.Kc=[]),t.label=4;case 4:return[2]}})})})),n.nu}var gl=(bl.prototype.P=function(){return this.su.P()},bl.prototype.qo=function(t,e){e=new ml(t,e),this.su=this.su.add(e),this.ru=this.ru.add(e)},bl.prototype.au=function(t,e){var n=this;t.forEach(function(t){return n.qo(t,e)})},bl.prototype.Ko=function(t,e){this.cu(new ml(t,e))},bl.prototype.uu=function(t,e){var n=this;t.forEach(function(t){return n.Ko(t,e)})},bl.prototype.hu=function(t){var e=this,n=new ri(new ti([])),r=new ml(n,t),t=new ml(n,t+1),i=[];return this.ru.xt([r,t],function(t){e.cu(t),i.push(t.key)}),i},bl.prototype.lu=function(){var e=this;this.su.forEach(function(t){return e.cu(t)})},bl.prototype.cu=function(t){this.su=this.su.delete(t),this.ru=this.ru.delete(t)},bl.prototype._u=function(t){var e=new ri(new ti([])),n=new ml(e,t),t=new ml(e,t+1),r=Fi();return this.ru.xt([n,t],function(t){r=r.add(t.key)}),r},bl.prototype.ro=function(t){var e=new ml(t,0);return null!==(e=this.su.Ot(e))&&t.isEqual(e.key)},bl),ml=(wl.iu=function(t,e){return ri.D(t.key,e.key)||kr(t.fu,e.fu)},wl.ou=function(t,e){return kr(t.fu,e.fu)||ri.D(t.key,e.key)},wl);function wl(t,e){this.key=t,this.fu=e}function bl(){this.su=new Pi(ml.iu),this.ru=new Pi(ml.ou)}function Il(t,e){return"firestore_clients_"+t+"_"+e}function El(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function Tl(t,e){return"firestore_targets_"+t+"_"+e}var _l=(Kl.du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new mr(r.error.code,r.error.message)),i?new Kl(t,e,r.state,o):(_r("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Kl.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Kl),Al=(zl.du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new mr(n.error.code,n.error.message)),r?new zl(t,n.state,i):(_r("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},zl.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},zl),Nl=(Gl.du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ji,o=0;r&&o<n.activeTargetIds.length;++o)r=pi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Gl(t,i):(_r("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Gl),Dl=(Bl.du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Bl(e.clientId,e.onlineState):(_r("SharedClientState","Failed to parse online state: "+t),null)},Bl),Sl=(jl.prototype.Eu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},jl.prototype.Tu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},jl.prototype.wu=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},jl),Ol=(Fl.Ln=function(t){return!(!t||!t.localStorage)},Fl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.mu.va()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Iu&&(i=this.getItem(Il(this.persistenceKey,r)))&&(o=Nl.du(r,i))&&(this.Pu=this.Pu.ot(o.clientId,o));for(this.Du(),(s=this.storage.getItem(this.Su))&&(u=this.Cu(s))&&this.Nu(u),a=0,c=this.gu;a<c.length;a++)h=c[a],this.Ru(h);return this.gu=[],this.window.addEventListener("unload",function(){return l.ga()}),this.br=!0,[2]}})})},Fl.prototype.sr=function(t){this.setItem(this.Vu,JSON.stringify(t))},Fl.prototype.xu=function(){return this.Fu(this.Pu)},Fl.prototype.Ou=function(n){var r=!1;return this.Pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Fl.prototype.ku=function(t){this.Mu(t,"pending")},Fl.prototype.$u=function(t,e,n){this.Mu(t,e,n),this.Lu(t)},Fl.prototype.Bu=function(t){var e,n="not-current";return this.Ou(t)&&(!(e=this.storage.getItem(Tl(this.persistenceKey,t)))||(e=Al.du(t,e))&&(n=e.state)),this.qu.Eu(t),this.Du(),n},Fl.prototype.Uu=function(t){this.qu.Tu(t),this.Du()},Fl.prototype.Ku=function(t){return this.qu.activeTargetIds.has(t)},Fl.prototype.Qu=function(t){this.removeItem(Tl(this.persistenceKey,t))},Fl.prototype.Wu=function(t,e,n){this.ju(t,e,n)},Fl.prototype.Gu=function(t,e,n){var r=this;e.forEach(function(t){r.Lu(t)}),this.currentUser=t,n.forEach(function(t){r.ku(t)})},Fl.prototype.zu=function(t){this.Hu(t)},Fl.prototype.ga=function(){this.br&&(this.window.removeEventListener("storage",this.Au),this.removeItem(this.yu),this.br=!1)},Fl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Tr("SharedClientState","READ",t,e),e},Fl.prototype.setItem=function(t,e){Tr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Fl.prototype.removeItem=function(t){Tr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Fl.prototype.Ru=function(t){var e=this,s=t;s.storageArea===this.storage&&(Tr("SharedClientState","EVENT",s.key,s.newValue),s.key!==this.yu?this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.br){if(null!==s.key)if(this.pu.test(s.key)){if(null==s.newValue)return e=this.Yu(s.key),[2,this.Ju(e,null)];if(e=this.Xu(s.key,s.newValue))return[2,this.Ju(e.clientId,e)]}else if(this.bu.test(s.key)){if(null!==s.newValue&&(n=this.Zu(s.key,s.newValue)))return[2,this.th(n)]}else if(this.vu.test(s.key)){if(null!==s.newValue&&(r=this.eh(s.key,s.newValue)))return[2,this.nh(r)]}else if(s.key===this.Su){if(null!==s.newValue&&(i=this.Cu(s.newValue)))return[2,this.Nu(i)]}else s.key===this.Vu&&(o=function(t){var e=Ga.ir;if(null!=t)try{var n=JSON.parse(t);Sr("number"==typeof n),e=n}catch(t){_r("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==Ga.ir&&this.tr(o)}else this.gu.push(s);return[2]})})}):_r("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Fl.prototype,"qu",{get:function(){return this.Pu.get(this.Iu)},enumerable:!1,configurable:!0}),Fl.prototype.Du=function(){this.setItem(this.yu,this.qu.wu())},Fl.prototype.Mu=function(t,e,n){n=new _l(this.currentUser,t,e,n),t=El(this.persistenceKey,this.currentUser,t),this.setItem(t,n.wu())},Fl.prototype.Lu=function(t){t=El(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Fl.prototype.Hu=function(t){t={clientId:this.Iu,onlineState:t},this.storage.setItem(this.Su,JSON.stringify(t))},Fl.prototype.ju=function(t,e,n){var r=Tl(this.persistenceKey,t),n=new Al(t,e,n);this.setItem(r,n.wu())},Fl.prototype.Yu=function(t){return(t=this.pu.exec(t))?t[1]:null},Fl.prototype.Xu=function(t,e){return t=this.Yu(t),Nl.du(t,e)},Fl.prototype.Zu=function(t,e){var n=this.bu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return _l.du(new xa(n),t,e)},Fl.prototype.eh=function(t,e){return t=this.vu.exec(t),t=Number(t[1]),Al.du(t,e)},Fl.prototype.Cu=function(t){return Dl.du(t)},Fl.prototype.th=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.mu.sh(e.batchId,e.state,e.error)]:(Tr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Fl.prototype.nh=function(t){return this.mu.ih(t.targetId,t.state,t.error)},Fl.prototype.Ju=function(t,e){var n=this,r=e?this.Pu.ot(t,e):this.Pu.remove(t),i=this.Fu(this.Pu),o=this.Fu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.mu.rh(s,u).then(function(){n.Pu=r})},Fl.prototype.Nu=function(t){this.Pu.get(t.clientId)&&this.Cc(t.onlineState)},Fl.prototype.Fu=function(t){var n=ji;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},Fl),xl=(ql.prototype.ku=function(t){},ql.prototype.$u=function(t,e,n){},ql.prototype.Bu=function(t){return this.oh.Eu(t),this.ah[t]||"not-current"},ql.prototype.Wu=function(t,e,n){this.ah[t]=e},ql.prototype.Uu=function(t){this.oh.Tu(t)},ql.prototype.Ku=function(t){return this.oh.activeTargetIds.has(t)},ql.prototype.Qu=function(t){delete this.ah[t]},ql.prototype.xu=function(){return this.oh.activeTargetIds},ql.prototype.Ou=function(t){return this.oh.activeTargetIds.has(t)},ql.prototype.start=function(){return this.oh=new Sl,Promise.resolve()},ql.prototype.Gu=function(t,e,n){},ql.prototype.zu=function(t){},ql.prototype.ga=function(){},ql.prototype.sr=function(t){},ql),kl=function(t){this.key=t},Pl=function(t){this.key=t},Ll=(Object.defineProperty(Ml.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),Ml.prototype.wh=function(t,e){var s=this,u=e?e.Eh:new Gi,a=(e||this).fh,c=(e||this).Qt,h=a,l=!1,f=su(this.query)&&a.size===this.query.limit?a.last():null,p=uu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof Js?e:null)&&(wu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s._h(r,f)||p&&s._h(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),su(this.query)||uu(this.query))for(;h.size>this.query.limit;){var n=su(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,Eh:u,Ih:l,Qt:c}},Ml.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Ml.prototype.Di=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Qt=t.Qt;var i=t.Eh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var r,i}),this.mh(n);var s=e?this.Ah():[],e=(n=0===this.lh.size&&this.te?1:0)!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new zi(this.query,t.fh,r,i,t.Qt,0==n,e,!1),Rh:s}:{Rh:s}},Ml.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Di({fh:this.fh,Eh:new Gi,Qt:this.Qt,Ih:!1},!1)):{Rh:[]}},Ml.prototype.Ph=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},Ml.prototype.mh=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},Ml.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=Fi(),this.fh.forEach(function(t){e.Ph(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new Pl(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new kl(t))}),r},Ml.prototype.gh=function(t){return this.uh=t.za,this.lh=Fi(),t=this.wh(t.documents),this.Di(t,!0)},Ml.prototype.yh=function(){return zi.Gt(this.query,this.fh,this.Qt,0===this.hh)},Ml),Rl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Cl=function(t){this.key=t,this.Vh=!1},Vl=(Object.defineProperty(Ul.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),Ul);function Ul(t,e,n,r,i,o){this.Bc=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new Jr(gu,vu),this.xh=new Map,this.Fh=[],this.Oh=new Ai(ri.D),this.kh=new Map,this.Mh=new gl,this.$h={},this.Lh=new Map,this.Bh=fh.Vo(),this.onlineState="Unknown",this.qh=void 0}function Ml(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=Fi(),this.Qt=Fi(),this._h=bu(t),this.fh=new Bi(this._h)}function ql(){this.oh=new Sl,this.ah={},this.Cc=null,this.tr=null}function Fl(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this.Iu=r,this.mu=null,this.Cc=null,this.tr=null,this.Au=this.Ru.bind(this),this.Pu=new Ai(kr),this.br=!1,this.gu=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.yu=Il(this.persistenceKey,this.Iu),this.Vu="firestore_sequence_number_"+this.persistenceKey,this.Pu=this.Pu.ot(this.Iu,new Sl),this.pu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.bu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.vu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Su="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Au)}function jl(){this.activeTargetIds=ji}function Bl(t,e){this.clientId=t,this.onlineState=e}function Gl(t,e){this.clientId=t,this.activeTargetIds=e}function zl(t,e,n){this.targetId=t,this.state=e,this.error=n}function Kl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Hl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Kh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Ih?[4,Uh(r.Bc,i.query,!1).then(function(t){return t=t.documents,i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Di(e,r.Uh,n),[2,(ef(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,Uh(i.Bc,o,!0)];case 1:return n=t.sent(),r=new Ll(o,n.za),e=r.wh(n.documents),n=Hi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Di(e,i.Uh,n),ef(i,s,n.Rh),r=new Rl(o,s,r),[2,(i.Nh.set(o,r),i.xh.has(s)?i.xh.get(s).push(o):i.xh.set(s,[o]),n.snapshot)]}})})}function Wl(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=af(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Bc,a=p,h=i,l=$r.now(),o=a.reduce(function(t,e){return t.add(e.key)},Fi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.qi(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Cs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Js?t.field(i.field):void 0;null!=(o=ts(i.transform,o||null))&&(e=(null==e?new Gs:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new xs(i.key,o,function s(t){var u=[];return Wr(t.fields||{},function(t,e){var n=new ni([t]);if(Ao(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new gs(u)}(o.proto.mapValue),Is.exists(!0)))}return h.Oi.Wr(u,l,e,a)})}).then(function(t){var e=t.Ii(c);return{batchId:t.batchId,Ri:e}}))];case 2:return s=t.sent(),u.Sh.ku(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$h[e.currentUser.ti()])||new Ai(kr)).ot(n,r),e.$h[e.currentUser.ti()]=i,[4,rf(u,s.Ri)];case 3:return t.sent(),[4,ll(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=Ta(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}function Ql(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,c=e,h=(a=o).nt,l=c.La,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ua.wo({Eo:!0});l=c.La;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(c.sa.Uo(s,t.se,e).next(function(){return c.sa.Bo(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Wo),l=l.ot(e,n),r=o,i=t,Sr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.sa.Oo(s,n))))});var t,o=Ri,n=Fi();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof $s&&e.version.isEqual(Zr.min())?(i.pi(t,h),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.yi(e,h),o=o.ot(t,e)):Tr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(c.persistence.qr.Ma(s,t))})})),h.isEqual(Zr.min())||(t=c.sa.So(s).next(function(t){return c.sa.Co(s,s.Wo,h)}),u.push(t)),ta.On(u).next(function(){return i.apply(s)}).next(function(){return c.Ka.Ui(s,o)})}).then(function(t){return c.La=l,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.kh.get(e))&&(Sr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Vh=!0:0<t.ne.size?Sr(e.Vh):0<t.se.size&&(Sr(e.Vh),e.Vh=!1))}),[4,rf(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,l})})}function Yl(t,n,e){var r;((t=t).Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){(e=e.view.Ks(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Sa(t)}(t.bh,n),r.length&&t.Ch.Tc(r),t.onlineState=n,t.Uh&&t.Sh.zu(n))}function Xl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ul((n=o).ph)||Tr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Oi.Yr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=Ta(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Jl(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function $l(t,e,n){var r=t,i=r.$h[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$h[r.currentUser.ti()]=i)}function Zl(e,t,n){void 0===n&&(n=null),e.Sh.Uu(t);for(var r=0,i=e.xh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Qh(o,n)}e.xh.delete(t),e.Uh&&e.Mh.hu(t).forEach(function(t){e.Mh.ro(t)||tf(e,t)})}function tf(t,e){var n=t.Oh.get(e);null!==n&&(nl(t.ph,n),t.Oh=t.Oh.remove(e),t.kh.delete(n),nf(t))}function ef(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof kl?(t.Mh.qo(u.key,e),r=t,i=(i=u).key,r.Oh.get(i)||(Tr("SyncEngine","New document in limbo: "+i),r.Fh.push(i),nf(r))):u instanceof Pl?(Tr("SyncEngine","Document no longer in limbo: "+u.key),t.Mh.Ko(u.key,e),t.Mh.ro(u.key)||tf(t,u.key)):Dr()}}function nf(t){for(;0<t.Fh.length&&t.Oh.size<t.Dh;){var e=t.Fh.shift(),n=t.Bh.next();t.kh.set(n,new Cl(e)),t.Oh=t.Oh.ot(e,n),el(t.ph,new Ii(fu(ou(e.path)),n,2,Ga.ir))}}function rf(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.P()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Kh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Wu(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ba.Zi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.Tc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ta.forEach(c,function(e){return ta.forEach(e.Ji,function(t){return r.persistence.qr.qo(n,e.targetId,t)}).next(function(){return ta.forEach(e.Xi,function(t){return r.persistence.qr.Ko(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Tr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.La.get(o),u=s.nt,u=s.rt(u),r.La=r.La.ot(o,u));return[2]}})})}(n.Bc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function of(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xh.get(s))&&0!==a.length?[4,Ch(e.Bc,fu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.Nh.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Uh((e=r).Bc,i.query,!0)];case 1:return n=t.sent(),n=i.view.gh(n),[2,(e.Uh&&ef(e,i.targetId,n.Rh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Mh(e.Bc,s)];case 8:return f=t.sent(),[4,Ch(e.Bc,f)];case 9:return u=t.sent(),[4,Hl(e,sf(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.Tc(r),n)]}})})}function sf(t){return iu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function uf(t){return t.ph.Uc.Xc=Ql.bind(null,t),t.ph.Uc.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.Vh)return Fi().add(t.key);var r=Fi();if(!(e=n.xh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Uc.Jc=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Wu(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new Ai(ri.D)).ot(n,new $s(n,Zr.min())),i=Fi().add(n),i=new Ki(Zr.min(),new Map,new Pi(kr),r,i),[4,Ql(e,i)]):[3,2];case 1:return t.sent(),e.Oh=e.Oh.remove(n),e.kh.delete(s),nf(e),[3,4];case 2:return[4,Vh(e.Bc,s,!1).then(function(){return Zl(e,s,u)}).catch(qh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.Tc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Sa(n)}.bind(null,t.bh),t.Ch.Qh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function af(t){return t.ph.Uc.Zc=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.Ua.wo({Eo:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ta.resolve();return a.forEach(function(n){c=c.next(function(){return s.bi(o,n)}).next(function(t){var e=t;Sr(null!==(t=r.Ai.get(n))),(!e||e.version.u(t)<0)&&(e=u.wi(n,e,r))&&s.yi(e,r.mi)})}),c.next(function(){return i.Oi.Zr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Oi.io(t)}).next(function(){return l.Ka.qi(t,e)})}))];case 2:return i=t.sent(),$l(n,r,null),Jl(n,r),n.Sh.$u(r,"acknowledged"),[4,rf(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,t),t.ph.Uc.tu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Oi.Gr(e,r).next(function(t){return Sr(null!==t),n=t.keys(),i.Oi.Zr(e,t)}).next(function(){return i.Oi.io(e)}).next(function(){return i.Ka.qi(e,n)})}))];case 2:return o=t.sent(),$l(n,u,a),Jl(n,u),n.Sh.$u(u,"rejected",a),[4,rf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,qh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var cf,hf,lf,ff=(Uf.prototype.Qa=function(t){this.Wh=t},Uf.prototype.Qi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(Zr.min())?this.jh(e,r):this.Wh.qi(e,o).next(function(t){var n=s.Gh(r,t);return(su(r)||uu(r))&&s.Ih(r.an,n,o,i)?s.jh(e,r):(Er()<=f.DEBUG&&Tr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mu(r)),s.Wh.Qi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Uf.prototype.Gh=function(n,t){var r=new Pi(bu(n));return t.forEach(function(t,e){e instanceof Js&&wu(n,e)&&(r=r.add(e))}),r},Uf.prototype.Ih=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},Uf.prototype.jh=function(t,e){return Er()<=f.DEBUG&&Tr("IndexFreeQueryEngine","Using full collection scan to execute query:",mu(e)),this.Wh.Qi(t,e,Zr.min())},Uf),pf=(Vf.prototype.Qr=function(t){return ta.resolve(0===this.Oi.length)},Vf.prototype.Wr=function(t,e,n,r){var i=this.zh;this.zh++,0<this.Oi.length&&this.Oi[this.Oi.length-1],n=new Ma(i,e,n,r),this.Oi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Hh=this.Hh.add(new ml(u.key,i)),this.ki.jr(t,u.key.path.F())}return ta.resolve(n)},Vf.prototype.Gr=function(t,e){return ta.resolve(this.Yh(e))},Vf.prototype.Hr=function(t,e){return e+=1,e=(e=this.Jh(e))<0?0:e,ta.resolve(this.Oi.length>e?this.Oi[e]:null)},Vf.prototype.Yr=function(){return ta.resolve(0===this.Oi.length?-1:this.zh-1)},Vf.prototype.Jr=function(t){return ta.resolve(this.Oi.slice())},Vf.prototype.$i=function(t,e){var n=this,r=new ml(e,0),e=new ml(e,Number.POSITIVE_INFINITY),i=[];return this.Hh.xt([r,e],function(t){t=n.Yh(t.fu),i.push(t)}),ta.resolve(i)},Vf.prototype.Ki=function(t,e){var n=this,r=new Pi(kr);return e.forEach(function(t){var e=new ml(t,0),t=new ml(t,Number.POSITIVE_INFINITY);n.Hh.xt([e,t],function(t){r=r.add(t.fu)})}),ta.resolve(this.Xh(r))},Vf.prototype.Hi=function(t,e){var n=e.path,r=n.length+1,e=n;ri.X(e)||(e=e.child(""));var e=new ml(new ri(e),0),i=new Pi(kr);return this.Hh.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.fu)),!0)},e),ta.resolve(this.Xh(i))},Vf.prototype.Xh=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Yh(t))&&n.push(t)}),n},Vf.prototype.Zr=function(n,r){var i=this;Sr(0===this.Zh(r.batchId,"removed")),this.Oi.shift();var o=this.Hh;return ta.forEach(r.mutations,function(t){var e=new ml(t.key,r.batchId);return o=o.delete(e),i.qr.so(n,t.key)}).next(function(){i.Hh=o})},Vf.prototype.no=function(t){},Vf.prototype.ro=function(t,e){var n=new ml(e,0),n=this.Hh.Ot(n);return ta.resolve(e.isEqual(n&&n.key))},Vf.prototype.io=function(t){return this.Oi.length,ta.resolve()},Vf.prototype.Zh=function(t,e){return this.Jh(t)},Vf.prototype.Jh=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},Vf.prototype.Yh=function(t){return(t=this.Jh(t))<0||t>=this.Oi.length?null:this.Oi[t]},Vf),df=(Cf.prototype.yi=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.tl(e);return this.docs=this.docs.ot(r,{ho:e,size:o,readTime:n}),this.size+=o-i,this.ki.jr(t,r.path.F())},Cf.prototype.pi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Cf.prototype.bi=function(t,e){return e=this.docs.get(e),ta.resolve(e?e.ho:null)},Cf.prototype.getEntries=function(t,e){var n=this,r=Ri;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ho:null)}),ta.resolve(r)},Cf.prototype.Qi=function(t,e,n){for(var r=Ui,i=new ri(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ho,a=a.readTime;if(!e.path.M(s.path))break;a.u(n)<=0||u instanceof Js&&wu(e,u)&&(r=r.ot(u.key,u))}return ta.resolve(r)},Cf.prototype.el=function(t,e){return ta.forEach(this.docs,function(t){return e(t)})},Cf.prototype.wo=function(t){return new yf(this)},Cf.prototype.To=function(t){return ta.resolve(this.size)},Cf),yf=(n(Rf,lf=h),Rf.prototype.Di=function(n){var r=this,i=[];return this.Ri.forEach(function(t,e){e?i.push(r.Io.yi(n,e,r.readTime)):r.Io.pi(t)}),ta.On(i)},Rf.prototype.vi=function(t,e){return this.Io.bi(t,e)},Rf.prototype.Si=function(t,e){return this.Io.getEntries(t,e)},Rf),vf=(Lf.prototype.Ce=function(t,n){return this.nl.forEach(function(t,e){return n(e)}),ta.resolve()},Lf.prototype.So=function(t){return ta.resolve(this.lastRemoteSnapshotVersion)},Lf.prototype.Do=function(t){return ta.resolve(this.sl)},Lf.prototype.po=function(t){return this.highestTargetId=this.rl.next(),ta.resolve(this.highestTargetId)},Lf.prototype.Co=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sl&&(this.sl=e),ta.resolve()},Lf.prototype.xo=function(t){this.nl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.rl=new fh(e),this.highestTargetId=e),t.sequenceNumber>this.sl&&(this.sl=t.sequenceNumber)},Lf.prototype.No=function(t,e){return this.xo(e),this.targetCount+=1,ta.resolve()},Lf.prototype.Oo=function(t,e){return this.xo(e),ta.resolve()},Lf.prototype.ko=function(t,e){return this.nl.delete(e.target),this.il.hu(e.targetId),--this.targetCount,ta.resolve()},Lf.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return this.nl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.nl.delete(t),u.push(o.Mo(n,e.targetId)),s++)}),ta.On(u).next(function(){return s})},Lf.prototype.$o=function(t){return ta.resolve(this.targetCount)},Lf.prototype.Lo=function(t,e){return e=this.nl.get(e)||null,ta.resolve(e)},Lf.prototype.Bo=function(t,e,n){return this.il.au(e,n),ta.resolve()},Lf.prototype.Uo=function(e,t,n){this.il.uu(t,n);var r=this.persistence.qr,i=[];return r&&t.forEach(function(t){i.push(r.so(e,t))}),ta.On(i)},Lf.prototype.Mo=function(t,e){return this.il.hu(e),ta.resolve()},Lf.prototype.Qo=function(t,e){return e=this.il._u(e),ta.resolve(e)},Lf.prototype.ro=function(t,e){return ta.resolve(this.il.ro(e))},Lf),gf=(Pf.prototype.start=function(){return Promise.resolve()},Pf.prototype.ga=function(){return this.Ho=!1,Promise.resolve()},Object.defineProperty(Pf.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),Pf.prototype.ha=function(){},Pf.prototype.la=function(){},Pf.prototype.Na=function(){return this.ki},Pf.prototype.Sa=function(t){var e=this.ol[t.ti()];return e||(e=new pf(this.ki,this.qr),this.ol[t.ti()]=e),e},Pf.prototype.Da=function(){return this.sa},Pf.prototype.Ca=function(){return this.Fi},Pf.prototype.runTransaction=function(t,e,n){var r=this;Tr("MemoryPersistence","Starting transaction:",t);var i=new mf(this.zo.next());return this.qr.cl(),n(i).next(function(t){return r.qr.ul(i).next(function(){return t})}).xn().then(function(t){return i.xi(),t})},Pf.prototype.hl=function(e,n){return ta.kn(Object.values(this.ol).map(function(t){return function(){return t.ro(e,n)}}))},Pf),mf=(n(kf,hf=ge),kf),wf=(xf.fl=function(t){return new xf(t)},Object.defineProperty(xf.prototype,"dl",{get:function(){if(this._l)return this._l;throw Dr()},enumerable:!1,configurable:!0}),xf.prototype.qo=function(t,e,n){return this.ll.qo(n,e),this.dl.delete(n.toString()),ta.resolve()},xf.prototype.Ko=function(t,e,n){return this.ll.Ko(n,e),this.dl.add(n.toString()),ta.resolve()},xf.prototype.so=function(t,e){return this.dl.add(e.toString()),ta.resolve()},xf.prototype.removeTarget=function(t,e){var n=this;this.ll.hu(e.targetId).forEach(function(t){return n.dl.add(t.toString())});var r=this.persistence.Da();return r.Qo(t,e.targetId).next(function(t){t.forEach(function(t){return n.dl.add(t.toString())})}).next(function(){return r.ko(t,e)})},xf.prototype.cl=function(){this._l=new Set},xf.prototype.ul=function(n){var r=this,i=this.persistence.Ca().wo();return ta.forEach(this.dl,function(t){var e=ri.H(t);return r.wl(n,e).next(function(t){t||i.pi(e)})}).next(function(){return r._l=null,i.apply(n)})},xf.prototype.Ma=function(t,e){var n=this;return this.wl(t,e).next(function(t){t?n.dl.delete(e.toString()):n.dl.add(e.toString())})},xf.prototype.al=function(t){return 0},xf.prototype.wl=function(t,e){var n=this;return ta.kn([function(){return ta.resolve(n.ll.ro(e))},function(){return n.persistence.Da().ro(t,e)},function(){return n.persistence.hl(t,e)}])},xf),bf=(Of.prototype.wc=function(t){this.Il=t},Of.prototype.hc=function(t){this.ml=t},Of.prototype.onMessage=function(t){this.Al=t},Of.prototype.close=function(){this.Tl()},Of.prototype.send=function(t){this.El(t)},Of.prototype.Rl=function(){this.Il()},Of.prototype.Pl=function(t){this.ml(t)},Of.prototype.gl=function(t){this.Al(t)},Of),If={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ef=(Sf.prototype.Sc=function(e,t,n,r){var i=this.bl(e,t);return Tr("RestConnection","Sending: ",i,n),t={},this.vl(t,r),this.Sl(e,i,t,n).then(function(t){return Tr("RestConnection","Received: ",t),t},function(t){throw Ar("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Sf.prototype.Dc=function(t,e,n,r){return this.Sc(t,e,n,r)},Sf.prototype.vl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.1-2020103231751",t["Content-Type"]="text/plain",e)for(var n in e.si)e.si.hasOwnProperty(n)&&(t[n]=e.si[n])},Sf.prototype.bl=function(t,e){return t=If[t],this.Vl+"/v1/"+e+":"+t},n(Df,cf=Sf),Df.prototype.Sl=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Tr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Tr("Connection",'RPC "'+o+'" timed out'),r(new mr(gr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Tr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(gr).indexOf(e)?e:gr.UNKNOWN,r(new mr(e,t.message))):r(new mr(gr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new mr(gr.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Tr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Df.prototype.Ec=function(t,e){var n,r=[this.Vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.vl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Tr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new bf({El:function(t){u?Tr("Connection","Not sending because WebChannel is closed:",t):(s||(Tr("Connection","Opening WebChannel transport."),o.open(),s=!0),Tr("Connection","WebChannel sending:",t),o.send(t))},Tl:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Tr("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Tr("Connection","WebChannel transport closed"),a.Pl())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Ar("Connection","WebChannel transport errored:",t),a.Pl(new mr(gr.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Sr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Tr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=bi[r];if(void 0!==t)return _i(t)}(),i=n.message,void 0===t&&(t=gr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Pl(new mr(t,i)),o.close()):(Tr("Connection","WebChannel received:",e),a.gl(e)))}),setTimeout(function(){a.Rl()},0),a},Df),Tf=(Nf.prototype.zc=function(t){this.Fl.push(t)},Nf.prototype.ga=function(){window.removeEventListener("online",this.Dl),window.removeEventListener("offline",this.Nl)},Nf.prototype.Ol=function(){window.addEventListener("online",this.Dl),window.addEventListener("offline",this.Nl)},Nf.prototype.Cl=function(){Tr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(0)},Nf.prototype.xl=function(){Tr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(1)},Nf.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Nf),_f=(Af.prototype.zc=function(t){},Af.prototype.ga=function(){},Af);function Af(){}function Nf(){var t=this;this.Dl=function(){return t.Cl()},this.Nl=function(){return t.xl()},this.Fl=[],this.Ol()}function Df(t){var e=this;return(e=cf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Sf(t){this.yl=t,this._=t._;var e=t.ssl?"https":"http";this.Vl=e+"://"+t.host,this.pl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Of(t){this.El=t.El,this.Tl=t.Tl}function xf(t){this.persistence=t,this.ll=new gl,this._l=null}function kf(t){var e=this;return(e=hf.call(this)||this).Wo=t,e}function Pf(t){var e=this;this.ol={},this.zo=new Ga(0),this.Ho=!1,this.Ho=!0,this.qr=t(this),this.sa=new vf(this),this.ki=new Fc,this.Fi=(t=this.ki,new df(t,function(t){return e.qr.al(t)}))}function Lf(t){this.persistence=t,this.nl=new Jr(vi,gi),this.lastRemoteSnapshotVersion=Zr.min(),this.highestTargetId=0,this.sl=0,this.il=new gl,this.targetCount=0,this.rl=fh.yo()}function Rf(t){var e=this;return(e=lf.call(this)||this).Io=t,e}function Cf(t,e){this.ki=t,this.tl=e,this.docs=new Ai(ri.D),this.size=0}function Vf(t,e){this.ki=t,this.qr=e,this.Oi=[],this.zh=1,this.Hh=new Pi(ml.iu)}function Uf(){}function Mf(t){return new So(t,!0)}var qf,Ff,jf=(Xf.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.kl(e),this.persistence=this.Ml(e),[4,this.persistence.start()];case 1:return t.sent(),this.$l=this.Ll(e),this.Bc=this.Bl(e),[2]}})})},Xf.prototype.Ll=function(t){return null},Xf.prototype.Bl=function(t){return e=this.persistence,n=new ff,t=t.ql,new kh(e,n,t);var e,n},Xf.prototype.Ml=function(t){return new gf(wf.fl)},Xf.prototype.kl=function(t){return new xl},Xf.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$l&&this.$l.stop(),[4,this.Sh.ga()];case 1:return t.sent(),[4,this.persistence.ga()];case 2:return t.sent(),[2]}})})},Xf),Bf=(n(Yf,Ff=jf),Yf.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ff.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Uc(t),r=Zr.min(),t.rs({index:th.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=mc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.qa=t})]})})}(this.Bc)];case 2:return t.sent(),[4,this.Ul.initialize(this,e)];case 3:return t.sent(),[4,af(this.Ul.mu)];case 4:return t.sent(),[4,ll(this.Ul.ph)];case 5:return t.sent(),[2]}})})},Yf.prototype.Ll=function(t){var e=this.persistence.qr.gr;return new uc(e,t.cs)},Yf.prototype.Ml=function(t){var e=xh(t.yl._,t.yl.persistenceKey),n=void 0!==this.cacheSizeBytes?ic.Ir(this.cacheSizeBytes):ic.Rr,r=Mf(t.yl._);return new Eh(this.synchronizeTabs,e,t.clientId,n,t.cs,ga(),ma(),r,this.Sh,!!this.forceOwnership)},Yf.prototype.kl=function(t){return new xl},Yf),Gf=(n(Qf,qf=Bf),Qf.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,qf.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Ul.mu,this.Sh instanceof Ol?(this.Sh.mu={sh:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Bc,n=a,i=(r=e).Oi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.zr(e,n).next(function(t){return t?r.Ka.qi(e,t):ta.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,ll(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?($l(o,a,h||null),Jl(o,a),o.Bc.Oi.no(a)):Dr(),t.label=4;case 4:return[4,rf(o,s)];case 5:return t.sent(),[3,7];case 6:Tr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),ih:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qh?(Tr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.xh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Bc,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ua,n=t,t=s.qa,r=e,i=Ri,o=gc(t),t=Uc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:th.readTimeIndex,range:n},function(t,e){var n=yc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{Ha:i,readTime:mc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Ha,t=t.readTime;return s.qa=t,e}))];case 3:return r=t.sent(),i=Ki.Xt(u,"current"===a),[4,rf(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,Vh(n.Bc,u,!0)];case 6:return t.sent(),Zl(n,u,c),[3,8];case 7:Dr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),rh:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=uf(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xh.has(r)?(Tr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Mh(n.Bc,r)]):[3,6];case 2:return i=t.sent(),[4,Ch(n.Bc,i)];case 3:return o=t.sent(),[4,Hl(n,sf(i),o.targetId,!1)];case 4:t.sent(),el(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xh.has(e)?[4,Vh(n.Bc,e,!1).then(function(){nl(n.ph,e),Zl(n,e)}).catch(qh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),va:function(t){return t.Bc.persistence.va()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.ua(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return uf(r=h),af(r),!0!==l||!0===r.qh?[3,3]:(e=r.Sh.xu(),[4,of(r,e.L())]);case 1:return i=t.sent(),r.qh=!0,[4,dl(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],el(r.ph,u);return[3,7];case 3:return!1!==l||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.xh.forEach(function(t,e){r.Sh.Ku(e)?a.push(e):c=c.then(function(){return Zl(r,e),Vh(r.Bc,e,!0)}),nl(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,of(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){nl(n.ph,e)}),n.Mh.lu(),n.kh=new Map,n.Oh=new Ai(ri.D),r.qh=!1,[4,dl(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Ul.mu,e)];case 1:return t.sent(),this.$l&&(e&&!this.$l.br?this.$l.start(this.Bc):e||this.$l.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Qf.prototype.kl=function(t){var e=ga();if(!Ol.Ln(e))throw new mr(gr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=xh(t.yl._,t.yl.persistenceKey);return new Ol(e,t.cs,n,t.clientId,t.ql)},Qf),zf=(Wf.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Bc?[3,2]:(this.Bc=n.Bc,this.Sh=n.Sh,this.qc=this.Kl(r),this.ph=this.Ql(r),this.bh=this.Wl(r),this.mu=this.jl(r,!n.synchronizeTabs),this.Sh.Cc=function(t){return Yl(e.mu,t,1)},this.ph.Uc.Gl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Tr("SyncEngine","User change. New user:",o.ti()),[4,Lh(n.Bc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new mr(gr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.Gu(o,r.ja,r.Ga),[4,rf(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.mu),[4,dl(this.ph,this.mu.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wf.prototype.Wl=function(t){return new _a},Wf.prototype.Kl=function(t){var e=Mf(t.yl._),n=(n=t.yl,new Ef(n));return t=t.credentials,new Hh(t,n,e)},Wf.prototype.Ql=function(t){var e=this;return new Fh(this.Bc,this.qc,t.cs,function(t){return Yl(e.mu,t,0)},t=new(Tf.Ln()?Tf:_f))},Wf.prototype.jl=function(t,e){return n=this.Bc,r=this.ph,i=this.bh,o=this.Sh,s=t.ql,t=t.Dh,e=e,t=new Vl(n,r,i,o,s,t),e&&(t.qh=!0),t;var n,r,i,o,s},Wf.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Tr("RemoteStore","RemoteStore shutting down."),e.Wc.add(5),[4,tl(e)];case 1:return t.sent(),e.Gc.ga(),e.Hc.set("Unknown"),[2]}})})}(this.ph)},Wf),Kf=(Hf.prototype.next=function(t){this.observer.next&&this.zl(this.observer.next,t)},Hf.prototype.error=function(t){this.observer.error?this.zl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Hf.prototype.Hl=function(){this.muted=!0},Hf.prototype.zl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Hf);function Hf(t){this.observer=t,this.muted=!1}function Wf(){}function Qf(t,e){var n=this;return(n=qf.call(this,t,e,!1)||this).Ul=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Yf(t,e,n){var r=this;return(r=Ff.call(this)||this).Ul=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Xf(){this.synchronizeTabs=!1}function Jf(t,e,n){if(!n)throw new mr(gr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function $f(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new mr(gr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zf(t,e,n,r){if(!0===e&&!0===r)throw new mr(gr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function tp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Dr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ep(t,e){if(e<=0)throw new mr(gr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var np,rp,ip=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new mr(gr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yl=new ni(t)},op=(n(hp,rp=ip),hp.documentId=function(){return new hp(ni.j().B())},hp.prototype.isEqual=function(t){return t instanceof hp&&this.Yl.isEqual(t.Yl)},hp),sp=new RegExp("[~\\*/\\[\\]]"),up=function(t){this.Jl=t},ap=(n(cp,np=up),cp.prototype.Xl=function(t){if(2!==t.Zl)throw 1===t.Zl?t.t_(this.Jl+"() can only appear at the top level of your update data"):t.t_(this.Jl+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},cp.prototype.isEqual=function(t){return t instanceof cp},cp);function cp(){return null!==np&&np.apply(this,arguments)||this}function hp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rp.call(this,t)||this}function lp(t,e,n){return new Rp({Zl:3,e_:e.settings.e_,methodName:t.Jl,n_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var fp,pp,dp,yp,vp=(n(Pp,yp=up),Pp.prototype.Xl=function(t){return new ms(t.path,new rs)},Pp.prototype.isEqual=function(t){return t instanceof Pp},Pp),gp=(n(kp,dp=up),kp.prototype.Xl=function(t){var e=lp(this,t,!0),n=this.s_.map(function(t){return Bp(t,e)}),n=new is(n);return new ms(t.path,n)},kp.prototype.isEqual=function(t){return this===t},kp),mp=(n(xp,pp=up),xp.prototype.Xl=function(t){var e=lp(this,t,!0),n=this.s_.map(function(t){return Bp(t,e)}),n=new cs(n);return new ms(t.path,n)},xp.prototype.isEqual=function(t){return this===t},xp),wp=(n(Op,fp=up),Op.prototype.Xl=function(t){var e=new ps(t.serializer,ko(t.serializer,this.i_));return new ms(t.path,e)},Op.prototype.isEqual=function(t){return this===t},Op),bp=(Object.defineProperty(Sp.prototype,"latitude",{get:function(){return this.r_},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"longitude",{get:function(){return this.o_},enumerable:!1,configurable:!0}),Sp.prototype.isEqual=function(t){return this.r_===t.r_&&this.o_===t.o_},Sp.prototype.toJSON=function(){return{latitude:this.r_,longitude:this.o_}},Sp.prototype.g=function(t){return kr(this.r_,t.r_)||kr(this.o_,t.o_)},Sp),Ip=function(t){this.a_=t},Ep=/^__.*__$/,Tp=function(t,e,n){this.c_=t,this.u_=e,this.h_=n},_p=(Dp.prototype.l_=function(t,e){var n=[];return null!==this.Qe?n.push(new xs(t,this.data,this.Qe,e)):n.push(new Os(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Cs(t,this.fieldTransforms)),n},Dp),Ap=(Np.prototype.l_=function(t,e){return e=[new xs(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Cs(t,this.fieldTransforms)),e},Np);function Np(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Dp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Sp(t,e){if(!isFinite(t)||t<-90||90<t)throw new mr(gr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new mr(gr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.r_=t,this.o_=e}function Op(t,e){var n=this;return(n=fp.call(this,t)||this).i_=e,n}function xp(t,e){var n=this;return(n=pp.call(this,t)||this).s_=e,n}function kp(t,e){var n=this;return(n=dp.call(this,t)||this).s_=e,n}function Pp(){return null!==yp&&yp.apply(this,arguments)||this}function Lp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var Rp=(Object.defineProperty(Up.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"Zl",{get:function(){return this.settings.Zl},enumerable:!1,configurable:!0}),Up.prototype.f_=function(t){return new Up(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Up.prototype.d_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.f_({path:e,n_:!1})).w_(t),e},Up.prototype.E_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.f_({path:t,n_:!1})).__(),t},Up.prototype.T_=function(t){return this.f_({path:void 0,n_:!0})},Up.prototype.t_=function(t){return Qp(t,this.settings.methodName,this.settings.I_||!1,this.path,this.settings.e_)},Up.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},Up.prototype.__=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.w_(this.path.get(t))},Up.prototype.w_=function(t){if(0===t.length)throw this.t_("Document fields must not be empty");if(Lp(this.Zl)&&Ep.test(t))throw this.t_('Document fields cannot begin and end with "__"')},Up),Cp=(Vp.prototype.m_=function(t,e,n,r){return void 0===r&&(r=!1),new Rp({Zl:t,methodName:e,e_:n,path:ni.U(),n_:!1,I_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Vp);function Vp(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Mf(t)}function Up(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.__(),this.fieldTransforms=i||[],this.Qe=o||[]}function Mp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.m_(o.merge||o.mergeFields?2:0,e,n,i);Kp("Data must be an object, but it was:",s,r);var u,a,r=Gp(r,s);if(o.merge)u=new gs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=l[h],p=void 0;if(f instanceof ip)p=f.Yl;else{if("string"!=typeof f)throw Dr();p=Wp(e,f,n)}if(!s.contains(p))throw new mr(gr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Yp(c,p)||c.push(p)}u=new gs(c),a=s.fieldTransforms.filter(function(t){return u.Ye(t.field)})}else u=null,a=s.fieldTransforms;return new _p(new Bs(r),u,a)}function qp(t,r,i,e){var o=t.m_(1,r,i);Kp("Data must be an object, but it was:",o,e);var s=[],u=new Gs;return Wr(e,function(t,e){var n=Wp(r,t,i),t=o.E_(n);e instanceof ap||e instanceof Ip&&e.a_ instanceof ap?s.push(n):null!=(t=Bp(e,t))&&(s.push(n),u.set(n,t))}),e=new gs(s),new Ap(u.Xe(),e,o.fieldTransforms)}function Fp(t,e,n,r,i,o){var s=t.m_(1,e,n),u=[Hp(e,r,n)],a=[i];if(o.length%2!=0)throw new mr(gr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Hp(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new Gs,y=u.length-1;0<=y;--y)Yp(p,u[y])||(h=u[y],l=a[y],f=s.E_(h),l instanceof ap||l instanceof Ip&&l.a_ instanceof ap?p.push(h):null!=(f=Bp(l,f))&&(p.push(h),d.set(h,f)));return i=new gs(p),new Ap(d.Xe(),i,s.fieldTransforms)}function jp(t,e,n,r){return void 0===r&&(r=!1),Bp(n,t.m_(r?4:3,e))}function Bp(s,t){if(s instanceof Ip&&(s=s.a_),zp(s))return Kp("Unsupported field value:",t,s),Gp(s,t);if(s instanceof up)return function(t,e){if(!Lp(e.Zl))throw e.t_(t.Jl+"() can only be used with update() and set()");if(!e.path)throw e.t_(t.Jl+"() is not currently supported inside arrays");(t=t.Xl(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.n_&&4!==t.Zl)throw t.t_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Bp(i[r],t.T_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Po(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Po(e.serializer,r)}}if(t instanceof bp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vr)return{bytesValue:Lo(e.serializer,t.l)};if(t instanceof Tp){if(n=e._,!(r=t.c_).isEqual(n))throw e.t_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Co(t.c_||e._,t.u_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.t_("Unsupported field value: "+tp(t))}(s,t)}function Gp(t,n){var r={};return Qr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Wr(t,function(t,e){null!=(e=Bp(e,n.d_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function zp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof bp||t instanceof Vr||t instanceof Tp||t instanceof up)}function Kp(t,e,n){if(!zp(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=tp(n))?e.t_(t+" a custom object"):e.t_(t+" "+n);var r}function Hp(t,e,n){if(e instanceof ip)return e.Yl;if("string"==typeof e)return Wp(t,e);throw Qp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Wp(t,e,n){try{return function(e){if(0<=e.search(sp))throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(op.bind.apply(op,i([void 0],e.split("."))))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yl}catch(e){throw Qp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Qp(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new mr(gr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Yp(t,e){return t.some(function(t){return t.isEqual(e)})}var Xp=(ed.prototype.y_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),0<this.mutations.length)throw new mr(gr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=jo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Uo(r.serializer,t)})},[4,r.Dc("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Sr(!!e.found),e.found.name,e.found.updateTime;var n=Mo(t,e.found.name),t=Ro(e.found.updateTime),e=new Bs({mapValue:{fields:e.found.fields}});return new Js(n,t,e,{})}(n,t):"missing"in t?(e=n,Sr(!!(n=t).missing),Sr(!!n.readTime),e=Mo(e,n.missing),n=Ro(n.readTime),new $s(e,n)):Dr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Sr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.qc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Js?n.p_(t):Dr()}),e)]}})})},ed.prototype.set=function(t,e){this.write(e.l_(t,this.Ge(t))),this.g_.add(t.toString())},ed.prototype.update=function(t,e){try{this.write(e.l_(t,this.b_(t)))}catch(t){this.P_=t}this.g_.add(t.toString())},ed.prototype.delete=function(t){this.write([new Fs(t,this.Ge(t))]),this.g_.add(t.toString())},ed.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),this.P_)throw this.P_;return e=this.A_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ri.H(e),n.mutations.push(new js(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=jo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return zo(e.serializer,t)})},[4,e.Sc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qc,this.mutations)];case 1:return t.sent(),this.R_=!0,[2]}})})},ed.prototype.p_=function(t){var e;if(t instanceof Js)e=t.version;else{if(!(t instanceof $s))throw Dr();e=Zr.min()}var n=this.A_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new mr(gr.ABORTED,"Document version changed between two reads.")}else this.A_.set(t.key.toString(),e)},ed.prototype.Ge=function(t){var e=this.A_.get(t.toString());return!this.g_.has(t.toString())&&e?Is.updateTime(e):Is.ze()},ed.prototype.b_=function(t){var e=this.A_.get(t.toString());if(this.g_.has(t.toString())||!e)return Is.exists(!0);if(e.isEqual(Zr.min()))throw new mr(gr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Is.updateTime(e)},ed.prototype.write=function(t){this.V_(),this.mutations=this.mutations.concat(t)},ed.prototype.V_=function(){},ed),Jp=(td.prototype.run=function(){this.S_()},td.prototype.S_=function(){var t=this;this.ys.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Xp(this.qc),(n=this.D_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.C_(t)})})}).catch(function(t){r.C_(t)}),[2]})})})},td.prototype.D_=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},td.prototype.C_=function(t){var e=this;0<this.v_&&this.N_(t)?(--this.v_,this.cs.ws(function(){return e.S_(),Promise.resolve()})):this.ls.reject(t)},td.prototype.N_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ti(t))},td),$p=(Zp.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.ui.promise];case 1:return[2,(t.sent(),{cs:this.cs,yl:this.yl,clientId:this.clientId,credentials:this.credentials,ql:this.user,Dh:100})]}})})},Zp.prototype.F_=function(t){var e=this;this.x_=t,this.ui.promise.then(function(){return e.x_(e.user)})},Zp.prototype.O_=function(){if(this.cs.ps)throw new mr(gr.FAILED_PRECONDITION,"The client has already been terminated.")},Zp.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new $u;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.k_?[4,this.k_.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.M_?[4,this.M_.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ai(),n.resolve(),[3,6];case 5:return e=Ta(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Zp);function Zp(t,e,n){var r=this;this.credentials=t,this.cs=e,this.yl=n,this.user=xa.UNAUTHENTICATED,this.clientId=Or.t(),this.x_=function(){},this.ui=new $u,this.credentials.oi(function(t){Tr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.x_(t)),r.ui.resolve()})}function td(t,e,n,r){this.cs=t,this.qc=e,this.updateFunction=n,this.ls=r,this.v_=5,this.ys=new Zu(this.cs,"transaction_retry")}function ed(t){this.qc=t,this.A_=new Map,this.mutations=[],this.R_=!1,this.P_=null,this.g_=new Set}function nd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),Tr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.F_(function(e){return r.cs.Cs(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Lh(i.Bc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.ha(function(){return r.terminate()}),r.M_=i,[2]}})})}function rd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),[4,id(r)];case 1:return e=t.sent(),Tr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.F_(function(t){return r.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.Fs(),Tr("RemoteStore","RemoteStore received new credentials"),n=ul(e),e.Wc.add(3),[4,tl(e)];case 1:return t.sent(),n&&e.Hc.set("Unknown"),[4,e.Uc.Gl(i)];case 2:return t.sent(),e.Wc.delete(3),[4,Zh(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)})}),r.k_=i,[2]}})})}function id(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.M_?[3,2]:(Tr("FirestoreClient","Using default OfflineComponentProvider"),[4,nd(e,new jf)]);case 1:t.sent(),t.label=2;case 2:return[2,e.M_]}})})}function od(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.k_?[3,2]:(Tr("FirestoreClient","Using default OnlineComponentProvider"),[4,rd(e,new zf)]);case 1:t.sent(),t.label=2;case 2:return[2,e.k_]}})})}function sd(t){return id(t).then(function(t){return t.persistence})}function ud(t){return id(t).then(function(t){return t.Bc})}function ad(t){return od(t).then(function(t){return t.ph})}function cd(t){return od(t).then(function(t){return t.mu})}function hd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,od(r)];case 1:return e=t.sent(),[2,((n=e.bh).Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=uf(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Bu(n),r=o.view.yh(),[3,4]):[3,1];case 1:return[4,Ch(e.Bc,fu(u))];case 2:return i=t.sent(),o=e.Sh.Bu(i.targetId),n=i.targetId,[4,Hl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&el(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.mu),n.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.xh.get(n.targetId)).length?[2,(e.xh.set(n.targetId,r.filter(function(t){return!vu(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Uu(n.targetId),e.Sh.Ou(n.targetId)?[3,2]:[4,Vh(e.Bc,n.targetId,!1).then(function(){e.Sh.Qu(n.targetId),nl(e.ph,n.targetId),Zl(e,n.targetId)}).catch(qh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Zl(e,n.targetId),[4,Vh(e.Bc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.mu),n)]}})})}function ld(n,t,e,r){var i=this,o=new Kf(r),s=new Oa(t,o,e);return n.cs.ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Na,[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})}),function(){o.Hl(),n.cs.ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Da,[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})})}}function fd(n,r){var t=this,i=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Wl,[4,cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function pd(n,t){var e=this,r=new Kf(t);return n.cs.ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.add(e),e.next()},[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Hl(),n.cs.ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.delete(e)},[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}function dd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var yd=(md.prototype.U_=function(t){switch(ho(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mo(t.integerValue||t.doubleValue);case 3:return this.K_(t.timestampValue);case 4:return this.Q_(t);case 5:return t.stringValue;case 6:return this.q_(wo(t.bytesValue));case 7:return this.W_(t.referenceValue);case 8:return this.j_(t.geoPointValue);case 9:return this.G_(t.arrayValue);case 10:return this.z_(t.mapValue);default:throw Dr()}},md.prototype.z_=function(t){var n=this,r={};return Wr(t.fields||{},function(t,e){r[t]=n.U_(e)}),r},md.prototype.j_=function(t){return new bp(mo(t.latitude),mo(t.longitude))},md.prototype.G_=function(t){var e=this;return(t.values||[]).map(function(t){return e.U_(t)})},md.prototype.Q_=function(t){switch(this.L_){case"previous":var e=function t(e){return uo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.U_(e);case"estimate":return this.K_(ao(t));default:return null}},md.prototype.K_=function(t){return t=go(t),new $r(t.seconds,t.nanos)},md.prototype.W_=function(t){var e=ti.q(t);return Sr(Zo(e)),t=new Gr(e.get(1),e.get(3)),e=new ri(e.N(5)),t.isEqual(this._)||_r("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.B_(e)},md),vd=(gd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},gd);function gd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new mr(gr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new mr(gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Zf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function md(t,e,n,r){this._=t,this.L_=e,this.B_=n,this.q_=r}function wd(n,r,i){var t=this,o=new $u;return n.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,nd(n,i)];case 1:return t.sent(),[4,rd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===gr.FAILED_PRECONDITION||t.code===gr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function bd(t){if(t.Y_||t.J_)throw new mr(gr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Id="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Ed=(Dd.prototype.enableIndexedDbPersistence=function(t,e){throw new mr(gr.FAILED_PRECONDITION,Id)},Dd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new mr(gr.FAILED_PRECONDITION,Id)},Dd.prototype.clearIndexedDbPersistence=function(t){throw new mr(gr.FAILED_PRECONDITION,Id)},Dd),Td=(Nd.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){bd(t);var n=Sd(t),r=t.H_();return wd(n,t=new zf,new Bf(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t,{forceOwnership:e})},Nd),_d=(Object.defineProperty(Ad.prototype,"Y_",{get:function(){return!!this.nf},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"J_",{get:function(){return this.X_.ps},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"af",{get:function(){return this.cf||(this.cf=new Cp(this.c_,this.rf.ignoreUndefinedProperties)),this.cf},enumerable:!1,configurable:!0}),Ad.prototype.settings=function(t){if(t.merge&&delete(t=Object.assign(Object.assign({},this.rf),t)).merge,t=new vd(t),this.nf&&!this.rf.isEqual(t))throw new mr(gr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.rf=t).credentials&&(this.if=function(t){if(!t)return new Ra;switch(t.type){case"gapi":var e=t.client;return Sr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ua(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new mr(gr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Ad.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.rf.host&&Ar("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Ad.prototype.enableNetwork=function(){return Sd(this),function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,sd(r)];case 1:return e=t.sent(),[4,ad(r)];case 2:return n=t.sent(),[2,(e.la(!0),(t=n).Wc.delete(0),Zh(t))]}})})})}(this.nf)},Ad.prototype.disableNetwork=function(){return Sd(this),function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,sd(r)];case 1:return e=t.sent(),[4,ad(r)];case 2:return n=t.sent(),[2,(e.la(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(0),[4,tl(e)];case 1:return t.sent(),e.Hc.set("Offline"),[2]}})})}(n))]}})})})}(this.nf)},Ad.prototype.enablePersistence=function(t){if(this.nf)throw new mr(gr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&Zf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.tf.enableMultiTabIndexedDbPersistence(this):this.tf.enableIndexedDbPersistence(this,n)},Ad.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.tf.clearIndexedDbPersistence(this)]})})},Ad.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Ad.prototype.waitForPendingWrites=function(){return Sd(this),function(n){var t=this,r=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Xl,[4,cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(this.nf)},Ad.prototype.onSnapshotsInSync=function(t){return Sd(this),dd(t)||(t={next:t}),pd(this.nf,t)},Ad.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new mr(gr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new mr(gr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Gr(t)},Object.defineProperty(Ad.prototype,"app",{get:function(){if(!this.ef)throw new mr(gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ef},enumerable:!1,configurable:!0}),Ad.prototype.collection=function(t){return Jf("Firestore.collection","path",t),Sd(this),new Jd(ti.q(t),this,null)},Ad.prototype.doc=function(t){return Jf("Firestore.doc","path",t),Sd(this),Rd.uf(ti.q(t),this,null)},Ad.prototype.collectionGroup=function(t){if(Jf("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Sd(this),new Yd(new tu(ti.U(),t),this,null)},Ad.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,od(n).then(function(t){return t.qc})];case 1:return e=t.sent(),new Jp(n.cs,e,r,i).run(),[2]}})})}),i.promise}(Sd(this),function(t){return e(new Pd(n,t))})},Ad.prototype.batch=function(){return Sd(this),new Ld(this)},Ad.prototype.H_=function(){return this.rf},Ad);function Ad(t,e,n){var r=this;if(void 0===n&&(n=new Ed),this.tf=n,this.ef=null,this.X_=new ba,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nf||Od(this),[4,this.nf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)n=t,this.ef=n,this.c_=Ad.sf(n),this.Z_=n.name,this.if=new Ca(e);else{if(!t.projectId)throw new mr(gr.INVALID_ARGUMENT,"Must provide projectId");this.c_=new Gr(t.projectId,t.database),this.Z_="[DEFAULT]",this.if=new Ra}this.rf=new vd({})}function Nd(){this.enableMultiTabIndexedDbPersistence=function(t){bd(t);var e=Sd(t),n=t.H_();return wd(e,t=new zf,new Gf(t,n.cacheSizeBytes))}.bind(null),this.clearIndexedDbPersistence=function(n){var t=this;if(n.Y_&&!n.J_)throw new mr(gr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new $u;return n.X_.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ea.Ln()?(e=n+"main",[4,ea.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(xh(n.c_,n.Z_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}.bind(null)}function Dd(){}function Sd(t){return t.nf||Od(t),t.nf.O_(),t.nf}function Od(t){var e,n,r=t.H_(),r=(e=t.c_,n=t.Z_,new Br(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.nf=new $p(t.if,t.X_,r)}var xd,kd,Pd=(Gd.prototype.get=function(t){var e=this,n=ey(0,t,this.hf);return this.lf.y_([n.u_]).then(function(t){if(!t||1!==t.length)return Dr();if((t=t[0])instanceof $s)return new Vd(e.hf,n.u_,null,!1,!1,n.h_);if(t instanceof Js)return new Vd(e.hf,n.u_,t,!1,!1,n.h_);throw Dr()})},Gd.prototype.set=function(t,e,n){return t=ey(0,t,this.hf),n=$f("Transaction.set",n),e=ny(t.h_,e,n),n=Mp(this.hf.af,"Transaction.set",t.u_,e,null!==t.h_,n),this.lf.set(t.u_,n),this},Gd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof op?(r=ey(0,t,this.hf),Fp(this.hf.af,"Transaction.update",r.u_,e,n,i)):(r=ey(0,t,this.hf),qp(this.hf.af,"Transaction.update",r.u_,e)),this.lf.update(r.u_,e),this},Gd.prototype.delete=function(t){return t=ey(0,t,this.hf),this.lf.delete(t.u_),this},Gd),Ld=(Bd.prototype.set=function(t,e,n){return this.df(),t=ey(0,t,this.hf),n=$f("WriteBatch.set",n),e=ny(t.h_,e,n),n=Mp(this.hf.af,"WriteBatch.set",t.u_,e,null!==t.h_,n),this._f=this._f.concat(n.l_(t.u_,Is.ze())),this},Bd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.df(),e="string"==typeof e||e instanceof op?(r=ey(0,t,this.hf),Fp(this.hf.af,"WriteBatch.update",r.u_,e,n,i)):(r=ey(0,t,this.hf),qp(this.hf.af,"WriteBatch.update",r.u_,e)),this._f=this._f.concat(e.l_(r.u_,Is.exists(!0))),this},Bd.prototype.delete=function(t){return this.df(),t=ey(0,t,this.hf),this._f=this._f.concat(new Fs(t.u_,Is.ze())),this},Bd.prototype.commit=function(){return this.df(),this.ff=!0,0<this._f.length?fd(Sd(this.hf),this._f):Promise.resolve()},Bd.prototype.df=function(){if(this.ff)throw new mr(gr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Bd),Rd=(n(jd,kd=Tp),jd.uf=function(t,e,n){if(t.length%2!=0)throw new mr(gr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new jd(new ri(t),e,n)},Object.defineProperty(jd.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"parent",{get:function(){return new Jd(this.u_.path.F(),this.firestore,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(jd.prototype,"path",{get:function(){return this.u_.path.B()},enumerable:!1,configurable:!0}),jd.prototype.collection=function(t){if(Jf("DocumentReference.collection","path",t),!t)throw new mr(gr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=ti.q(t),new Jd(this.u_.path.child(t),this.firestore,null)},jd.prototype.isEqual=function(t){return t instanceof jd&&this.firestore===t.firestore&&this.u_.isEqual(t.u_)&&this.h_===t.h_},jd.prototype.set=function(t,e){return e=$f("DocumentReference.set",e),t=ny(this.h_,t,e),e=Mp(this.firestore.af,"DocumentReference.set",this.u_,t,null!==this.h_,e),fd(this.nf,e.l_(this.u_,Is.ze()))},jd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof op?Fp(this.firestore.af,"DocumentReference.update",this.u_,t,e,n):qp(this.firestore.af,"DocumentReference.update",this.u_,t),fd(this.nf,t.l_(this.u_,Is.exists(!0)))},jd.prototype.delete=function(){return fd(this.nf,[new Fs(this.u_,Is.ze())])},jd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||dd(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};dd(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.wf(t))},error:n[i+1],complete:n[i+2]};return ld(this.nf,ou(this.u_.path),o,s)},jd.prototype.get=function(t){var e=this;return t&&"cache"===t.source?function(n,r){var t=this,i=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Mi(t,e)}))];case 1:return(r=t.sent())instanceof Js?s.resolve(r):r instanceof $s?s.resolve(null):s.reject(new mr(gr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ta(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,ud(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(this.nf,this.u_).then(function(t){return new Vd(e.firestore,e.u_,t,!0,t instanceof Js&&t.Je,e.h_)}):function(n,r,i){var t=this;void 0===i&&(i={});var o=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Kf({next:function(t){r.ws(function(){return Da(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new mr(gr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new mr(gr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Oa(ou(i.path),t,{includeMetadataChanges:!0,Xs:!0});return Na(n,u)},[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.cs,r,i,o])]}})})}),o.promise}(this.nf,this.u_,t).then(function(t){return e.wf(t)})},jd.prototype.withConverter=function(t){return new jd(this.u_,this.firestore,t)},jd.prototype.wf=function(t){var e=t.docs.get(this.u_);return new Vd(this.firestore,this.u_,e,t.fromCache,t.hasPendingWrites,this.h_)},jd),Cd=(Fd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Fd),Vd=(qd.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.Ef){if(this.h_){var n=new Ud(this.hf,this.u_,this.Ef,this.Tf,this.If,null);return this.h_.fromFirestore(n,t)}return new yd(this.hf.c_,t.serverTimestamps||"none",function(t){return new Rd(t,e.hf,null)},function(t){return new jr(t)}).U_(this.Ef.rn())}},qd.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.Ef&&null!==(t=this.Ef.data().field(Hp("DocumentSnapshot.get",t,this.u_))))return new yd(this.hf.c_,e.serverTimestamps||"none",function(t){return new Rd(t,n.hf,n.h_)},function(t){return new jr(t)}).U_(t)},Object.defineProperty(qd.prototype,"id",{get:function(){return this.u_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"ref",{get:function(){return new Rd(this.u_,this.hf,this.h_)},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"exists",{get:function(){return null!==this.Ef},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"metadata",{get:function(){return new Cd(this.If,this.Tf)},enumerable:!1,configurable:!0}),qd.prototype.isEqual=function(t){return t instanceof qd&&this.hf===t.hf&&this.Tf===t.Tf&&this.u_.isEqual(t.u_)&&(null===this.Ef?null===t.Ef:this.Ef.isEqual(t.Ef))&&this.h_===t.h_},qd),Ud=(n(Md,xd=Vd),Md.prototype.data=function(t){return xd.prototype.data.call(this,t)},Md);function Md(){return null!==xd&&xd.apply(this,arguments)||this}function qd(t,e,n,r,i,o){this.hf=t,this.u_=e,this.Ef=n,this.Tf=r,this.If=i,this.h_=o}function Fd(t,e){this.hasPendingWrites=t,this.fromCache=e}function jd(t,e,n){var r=this;return(r=kd.call(this,e.c_,t,n)||this).u_=t,r.firestore=e,r.h_=n,r.nf=Sd(e),r}function Bd(t){this.hf=t,this._f=[],this.ff=!1}function Gd(t,e){this.hf=t,this.lf=e}function zd(t,e,n){if("string"==typeof n){if(""===n)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!hu(e)&&-1!==n.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ti.q(n)),!ri.X(e))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return bo(t,new ri(e))}if(n instanceof Tp)return bo(t,n.u_);throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tp(n)+".")}function Kd(t,e){if(!Array.isArray(t)||0===t.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Hd(t,e,n){if(!n.isEqual(e))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Wd(t){if(uu(t)&&0===t.on.length)throw new mr(gr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Qd,Yd=(ty.prototype.where=function(t,e,n){return t=Hp("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Kd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(zd(n,t,c))}h={arrayValue:{values:s}}}else h=zd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Kd(o,i),h=jp(e,"Query.where",o,"in"===i||"not-in"===i);var h=Eu.create(r,i,h);return function(t,e){if(e.hn()){var n=cu(t);if(null!==n&&!n.isEqual(e.field))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=au(t))&&Hd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new mr(gr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new mr(gr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.mf,this.firestore.af,this.firestore.c_,t,e,n),new ty((e=(n=this.mf).filters.concat([e]),new tu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.h_)},ty.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new mr(gr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Hp("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new Ju(e,n),null!==au(t)||null!==(t=cu(t))&&Hd(0,t,n.field),e}(this.mf,t,n);return new ty((t=(n=this.mf).on.concat([t]),new tu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.h_)},ty.prototype.limit=function(t){return ep("Query.limit",t),new ty(pu(this.mf,t,"F"),this.firestore,this.h_)},ty.prototype.limitToLast=function(t){return ep("Query.limitToLast",t),new ty(pu(this.mf,t,"L"),this.firestore,this.h_)},ty.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Af("Query.startAt",t,e,!0),new ty(du(this.mf,t),this.firestore,this.h_)},ty.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Af("Query.startAfter",t,e,!1),new ty(du(this.mf,t),this.firestore,this.h_)},ty.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Af("Query.endBefore",t,e,!0),new ty(yu(this.mf,t),this.firestore,this.h_)},ty.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Af("Query.endAt",t,e,!1),new ty(yu(this.mf,t),this.firestore,this.h_)},ty.prototype.isEqual=function(t){return t instanceof ty&&this.firestore===t.firestore&&vu(this.mf,t.mf)&&this.h_===t.h_},ty.prototype.withConverter=function(t){return new ty(this.mf,this.firestore,t)},ty.prototype.Af=function(c,t,e,n){return t instanceof Vd?function(t,e,n,r){if(!n)throw new mr(gr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=lu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(bo(e,n.key));else{var a=n.field(u.field);if(uo(a))throw new mr(gr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.B(),new mr(gr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Bu(i,r)}(this.mf,this.firestore.c_,t.Ef,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new mr(gr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!hu(t)&&-1!==c.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ti.q(c));if(!ri.X(h))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ri(h),u.push(bo(e,h))}else c=jp(n,r,c),u.push(c)}return new Bu(u,o)}(this.mf,this.firestore.c_,this.firestore.af,c,e,n))},ty.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||dd(n[o])||(i=n[o],o++),dd(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Xd(e.firestore,e.mf,t,e.h_))},error:n[o+1],complete:n[o+2]};return Wd(this.mf),ld(Sd(this.firestore),this.mf,i,s)},ty.prototype.get=function(t){var e=this;Wd(this.mf);var n=Sd(this.firestore);return(t&&"cache"===t.source?function(n,r){var t=this,i=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Uh(r,i,!0)];case 1:return n=t.sent(),e=new Ll(i,n.za),n=e.wh(n.documents),n=e.Di(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ta(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,ud(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.mf):function(n,r,i){var t=this;void 0===i&&(i={});var o=new $u;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Kf({next:function(t){n.ws(function(){return Da(e,s)}),t.fromCache&&"server"===r.source?i.reject(new mr(gr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Oa(t,o,{includeMetadataChanges:!0,Xs:!0});return Na(e,s)},[4,hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.cs,r,i,o])]}})})}),o.promise}(n,this.mf,t)).then(function(t){return new Xd(e.firestore,e.mf,t,e.h_)})},ty),Xd=(Object.defineProperty(Zd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Zd.prototype,"empty",{get:function(){return this.Pf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Zd.prototype,"size",{get:function(){return this.Pf.docs.size},enumerable:!1,configurable:!0}),Zd.prototype.forEach=function(e,n){var r=this;this.Pf.docs.forEach(function(t){e.call(n,r.Vf(t,r.metadata.fromCache,r.Pf.Qt.has(t.key)))})},Object.defineProperty(Zd.prototype,"query",{get:function(){return new Yd(this.Rf,this.hf,this.h_)},enumerable:!1,configurable:!0}),Zd.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.Pf.jt)throw new mr(gr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.gf&&this.yf===t||(this.gf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Pf,t,this.Vf.bind(this)),this.yf=t),this.gf},Zd.prototype.isEqual=function(t){return t instanceof Zd&&this.hf===t.hf&&vu(this.Rf,t.Rf)&&this.Pf.isEqual(t.Pf)&&this.h_===t.h_},Zd.prototype.Vf=function(t,e,n){return new Ud(this.hf,t.key,t,e,n,this.h_)},Zd),Jd=(n($d,Qd=Yd),Object.defineProperty($d.prototype,"id",{get:function(){return this.mf.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"parent",{get:function(){var t=this.mf.path.F();return t.P()?null:new Rd(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"path",{get:function(){return this.mf.path.B()},enumerable:!1,configurable:!0}),$d.prototype.doc=function(t){return 0===arguments.length&&(t=Or.t()),Jf("CollectionReference.doc","path",t),t=ti.q(t),Rd.uf(this.mf.path.child(t),this.firestore,this.h_)},$d.prototype.add=function(t){var t=this.h_?this.h_.toFirestore(t):t,e=this.doc();return new Rd(e.u_,this.firestore,null).set(t).then(function(){return e})},$d.prototype.withConverter=function(t){return new $d(this.pf,this.firestore,t)},$d);function $d(t,e,n){var r=this;if(((r=Qd.call(this,ou(t),e,n)||this).pf=t).length%2!=1)throw new mr(gr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function Zd(t,e,n,r){this.hf=t,this.Rf=e,this.Pf=n,this.h_=r,this.gf=null,this.yf=null,this.metadata=new Cd(n.hasPendingWrites,n.fromCache)}function ty(t,e,n){this.mf=t,this.firestore=e,this.h_=n}function ey(t,e,n){if((e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new mr(gr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=tp(t),new mr(gr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,Rd)).firestore!==n)throw new mr(gr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function ny(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ry,ge=(n(iy,ry=Ip),iy.serverTimestamp=function(){var t=new vp("serverTimestamp");return t.Jl="FieldValue.serverTimestamp",new iy(t)},iy.delete=function(){var t=new ap("deleteField");return t.Jl="FieldValue.delete",new iy(t)},iy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gp("arrayUnion",t)}.apply(void 0,t);return n.Jl="FieldValue.arrayUnion",new iy(n)},iy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("arrayRemove",t)}.apply(void 0,t);return n.Jl="FieldValue.arrayRemove",new iy(n)},iy.increment=function(t){return(t=new wp("increment",t)).Jl="FieldValue.increment",new iy(t)},iy.prototype.isEqual=function(t){return this.a_.isEqual(t.a_)},iy),ge={Firestore:_d,GeoPoint:bp,Timestamp:$r,Blob:jr,Transaction:Pd,WriteBatch:Ld,DocumentReference:Rd,DocumentSnapshot:Vd,Query:Yd,QueryDocumentSnapshot:Ud,QuerySnapshot:Xd,CollectionReference:Jd,FieldPath:op,FieldValue:ge,setLogLevel:function(t){br.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function iy(){return null!==ry&&ry.apply(this,arguments)||this}(e=e.default).INTERNAL.registerComponent(new A("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new _d(e,t,new Td);var e},"PUBLIC").setServiceProps(Object.assign({},ge))),e.registerVersion("@firebase/firestore","2.0.1-2020103231751")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});