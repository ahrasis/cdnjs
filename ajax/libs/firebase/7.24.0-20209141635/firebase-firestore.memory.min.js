!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(xf){"use strict";try{(function(){var u,t,e=(t=xf)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=R||self;function S(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),U=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function j(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function P(t,e,n){return(P=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:j).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function x(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,_)&&this[_]||(this[_]=++U))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var Q,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var Y=O.navigator;function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}Q=(Y=Y&&Y.userAgent)?Y:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt=X(Q,"Opera"),it=X(Q,"Trident")||X(Q,"MSIE"),ot=X(Q,"Edge"),st=ot||it,ut=X(Q,"Gecko")&&!(X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge"))&&!(X(Q,"Trident")||X(Q,"MSIE"))&&!X(Q,"Edge"),at=X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge");function ht(){var t=O.document;return t?t.documentMode:void 0}var ct="",lt=(lt=Q,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=O.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",S,e),O.removeEventListener("test",S,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},x(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,V(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,V(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=V(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Pt(t);if(h||(t[St]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[St]=null)):At(t)))}function Ut(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(yt)return kt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new wt(e,this))}function Pt(t){return(t=t[St])instanceof Nt?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==D(e)?e:(e[Ct]||(e[Ct]=function(t){return e.handleEvent(t)}),e[Ct])}function xt(){F.call(this),this.c=new Nt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(xt,F),xt.prototype[Et]=!0,(N=xt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=V(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(xt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=O.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,zt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Qt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Gt||(n=O.Promise.resolve(void 0),Gt=function(){n.then(Yt)}),Xt||(Gt(),Xt=!0),Kt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Bt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){xt.call(this),this.b=t||1,this.a=e||O,this.f=P(this.Ya,this),this.g=M()}function Jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==D(t))n&&(t=P(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=P(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}x($t,xt),(N=$t.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Jt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){$t.S.G.call(this),Jt(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=F),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){F.call(this),this.b=t,this.a={}}x(se,F);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new xt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}x(de,mt),x(ve,mt),x(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){mt.call(this,"d")}function Oe(){mt.call(this,"c")}function Se(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Le,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}x(Re,mt),x(Oe,mt),x(Se,Ie),Ne=new Se;var Le=45e3,Ve={},_e={};function Ue(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=M(),Pe(t),t.l=Xe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(P(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?Ve:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),xe(t))}function Pe(t){t.U=M()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(P(t.Ua,t),e)}function Me(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||nr(t.g,t)}function Fe(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Jt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}Jn(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(P(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Pe(o)),n.a=i):$n(n),0<u.g.length&&Hn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Gn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),Fe(this),xe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(je(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),qe(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Pe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),Fe(this),xe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),je(this,t,e),this.b&&4!=t&&Pe(this)))},N.cancel=function(){this.A=!0,Fe(this)},N.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),Fe(this),this.h=2,xe(this)):Ce(this,this.U-n)},(N=Ge.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return We(this.b,t)?this.b[t]:e},N.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Ye(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),$e(this,n[4]),this.g=en(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Xe(t){return new He(t)}function Ke(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return ln(t),e=yn(t,e),We(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Rn(){this.a=new Nn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Sn=O.JSON.parse;function Dn(t){xt.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}x(Dn,xt);var Ln="",Vn=/^https?$/i,_n=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Cn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pn(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.X()))if(t.l&&4==xn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,Ze(n=Xe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Kn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Pe(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Wn(t){zn(t),t.j&&(O.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){wn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Ue(n,r,e)}function Kn(t,n){t.f&&Be({},function(t,e){Ze(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?P(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Be(t,function(t,e){var n=t;V(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function Jn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(P(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Kn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,ke(n,t)}function er(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Hn(t)):$n(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(P(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Jn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=P(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Ke(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,O.Image?((i=new Image).onload=C(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(On,o,i,"TestLoadImage: error",!1,r),i.onabort=C(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(On,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Wn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?Xe(s):new He(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),$e(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Ke(u,r),i&&Ye(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Kn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){xt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Oe.call(this),this.status=1}function pr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=P(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=P(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Cn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Dn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Pn(this):this.Ta())},N.Ta=function(){Pn(this)},N.X=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ze(i=Xe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Fn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(P(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),Jn(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,xt),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Hn(t)},N.close=function(){Gn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=qt(t),Qn(this.a,e)):Qn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,cr.S.G.call(this)},x(lr,Re),x(fr,Oe),x(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",xt.prototype.listen=xt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var dr=be,yr=Ee,vr=Ae,gr=Dn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=(n(Nr,br=Error),Nr),Tr="7.24.0-20209141635",Ar=new l("@firebase/firestore");function Nr(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Rr(){return Ar.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,i(["Firestore ("+Tr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){throw void 0===t&&(t="Unexpected state"),Sr(t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function _r(t){t||Vr()}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function kr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Pr,Cr,l=(Object.defineProperty(Wr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return 0===Wr.i(this,t)},Wr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Wr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Wr.prototype.limit=function(){return this.offset+this.length},Wr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Wr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Wr.prototype.l=function(){return this.segments[this.offset]},Wr.prototype._=function(){return this.get(this.length-1)},Wr.prototype.get=function(t){return this.segments[this.offset+t]},Wr.prototype.m=function(){return 0===this.length},Wr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Wr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Wr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Wr),Mr=(n(zr,Cr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.prototype.R=function(){return this.A().join("/")},zr.prototype.toString=function(){return this.R()},zr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new zr(n)},zr.g=function(){return new zr([])},zr),xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fr=(n(Gr,Pr=l),Gr.prototype.o=function(t,e,n){return new Gr(t,e,n)},Gr.p=function(t){return xr.test(t)},Gr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Gr.p(t)||(t="`"+t+"`"),t}).join(".")},Gr.prototype.toString=function(){return this.R()},Gr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Gr.v=function(){return new Gr(["__name__"])},Gr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gr(e)},Gr.g=function(){return new Gr([])},Gr),qr=(Br.D=function(t){return new Br(Mr.P(t))},Br.C=function(t){return new Br(Mr.P(t).u(5))},Br.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Mr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Mr.i(t.path,e.path)},Br.$=function(t){return t.length%2==0},Br.N=function(t){return new Br(new Mr(t.slice()))},Br);function Br(t){this.path=t}function Gr(){return null!==Pr&&Pr.apply(this,arguments)||this}function zr(){return null!==Cr&&Cr.apply(this,arguments)||this}function Wr(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.t=n}function Qr(t,e){if(0!==e.length)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ci(e.length,"argument")+".")}function Hr(t,e,n){if(e.length!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Kr(t,e,n,r){if(e.length<n||e.length>r)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ci(e.length,"argument")+".")}function Yr(t,e,n,r){ni(t,e,hi(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Yr(t,e,n,r)}function Jr(t,e,n,r){ni(t,e,n+" option",r)}function Zr(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function ti(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ii(s))}var u=ii(n);throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ei(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+ii(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ni(t,e,n,r){if(!("object"===e?ri(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=ii(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ri(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ii(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function oi(t,e,n){if(void 0===n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function si(n,t,r){kr(t,function(t,e){if(r.indexOf(t)<0)throw new Ir(Er.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ui(t,e,n,r){return r=ii(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ai(t,e,n){if(n<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ci(t,e){return t+" "+e+(1===t?"":"s")}var li=(fi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},fi);function fi(){}function pi(t,e){return t<e?-1:e<t?1:0}function di(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},vi.prototype.L=function(){return 2*this.O.length},vi.prototype.M=function(t){return pi(this.O,t.O)},vi.prototype.isEqual=function(t){return this.O===t.O},vi);function vi(t){this.O=t}yi.q=new yi("");var gi=(mi.fromBase64String=function(t){try{return new mi(yi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},mi.fromUint8Array=function(t){return new mi(yi.fromUint8Array(t))},mi.prototype.toBase64=function(){return this.U.toBase64()},mi.prototype.toUint8Array=function(){return this.U.toUint8Array()},mi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},mi.prototype.isEqual=function(t){return this.U.isEqual(t.U)},mi);function mi(t){this.U=t}function wi(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function bi(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ei(t,e,n,r,i,o){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.j=o}var Ii,Ti=(n(_i,Ii=gi),_i.fromBase64String=function(t){Hr("Blob.fromBase64String",arguments,1),Yr("Blob.fromBase64String","string",1,t),bi();try{return new _i(yi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},_i.fromUint8Array=function(t){if(Hr("Blob.fromUint8Array",arguments,1),wi(),!(t instanceof Uint8Array))throw ui("Blob.fromUint8Array","Uint8Array",1,t);return new _i(yi.fromUint8Array(t))},_i.prototype.toBase64=function(){return Hr("Blob.toBase64",arguments,0),bi(),Ii.prototype.toBase64.call(this)},_i.prototype.toUint8Array=function(){return Hr("Blob.toUint8Array",arguments,0),wi(),Ii.prototype.toUint8Array.call(this)},_i.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},_i),Ai=(Object.defineProperty(Vi.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Vi.prototype.isEqual=function(t){return t instanceof Vi&&t.projectId===this.projectId&&t.database===this.database},Vi.prototype.M=function(t){return pi(this.projectId,t.projectId)||pi(this.database,t.database)},Vi),Ni=(Li.prototype.get=function(t){var e=this.G(t);if(void 0!==(e=this.H[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.K(i,t))return o}},Li.prototype.has=function(t){return void 0!==this.get(t)},Li.prototype.set=function(t,e){var n=this.G(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},Li.prototype.delete=function(t){var e=this.G(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},Li.prototype.forEach=function(s){kr(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Li.prototype.m=function(){return jr(this.H)},Li),Ri=(Di.now=function(){return Di.fromMillis(Date.now())},Di.fromDate=function(t){return Di.fromMillis(t.getTime())},Di.fromMillis=function(t){var e=Math.floor(t/1e3);return new Di(e,1e6*(t-1e3*e))},Di.prototype.toDate=function(){return new Date(this.toMillis())},Di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Di.prototype.Y=function(t){return this.seconds===t.seconds?pi(this.nanoseconds,t.nanoseconds):pi(this.seconds,t.seconds)},Di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Di),Oi=(Si.J=function(t){return new Si(t)},Si.min=function(){return new Si(new Ri(0,0))},Si.prototype.M=function(t){return this.timestamp.Y(t.timestamp)},Si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Si.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Si.prototype.Z=function(){return this.timestamp},Si);function Si(t){this.timestamp=t}function Di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Li(t,e){this.G=t,this.K=e,this.H={}}function Vi(t,e){this.projectId=t,this.database=e||"(default)"}function _i(){return null!==Ii&&Ii.apply(this,arguments)||this}function Ui(t){return null==t}function ki(t){return 0===t&&1/t==-1/0}var ji=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Pi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ji(t,e,n,r,i,o,s)}function Ci(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Co(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ia(e.startAt)),e.endAt&&(t+="|ub:",t+=ia(e.endAt)),e.tt=t),e.tt}function Mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sa(t.startAt,e.startAt)&&sa(t.endAt,e.endAt)}function xi(t){return qr.$(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Fi(t){this.count=t}var qi,Bi=(Gi.prototype.st=function(t){return new Gi(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Gi.prototype.it=function(t,e){return new Gi(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Gi.prototype.rt=function(t){return new Gi(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Gi);function Gi(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=yi.q),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function zi(t){switch(t){case Er.OK:return Vr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return Vr(),0}}function Wi(t){if(void 0===t)return Sr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case qi.OK:return Er.OK;case qi.CANCELLED:return Er.CANCELLED;case qi.UNKNOWN:return Er.UNKNOWN;case qi.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case qi.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case qi.INTERNAL:return Er.INTERNAL;case qi.UNAVAILABLE:return Er.UNAVAILABLE;case qi.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case qi.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case qi.NOT_FOUND:return Er.NOT_FOUND;case qi.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case qi.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case qi.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case qi.ABORTED:return Er.ABORTED;case qi.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case qi.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case qi.DATA_LOSS:return Er.DATA_LOSS;default:return Vr()}}(l=qi=qi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Qi=($i.prototype.ot=function(t,e){return new $i(this.i,this.root.ot(t,e,this.i).copy(null,null,Xi.ut,null,null))},$i.prototype.remove=function(t){return new $i(this.i,this.root.remove(t,this.i).copy(null,null,Xi.ut,null,null))},$i.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},$i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},$i.prototype.m=function(){return this.root.m()},Object.defineProperty($i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),$i.prototype.ct=function(){return this.root.ct()},$i.prototype.at=function(){return this.root.at()},$i.prototype.ht=function(t){return this.root.ht(t)},$i.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},$i.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},$i.prototype.lt=function(t){return this.root.lt(t)},$i.prototype._t=function(){return new Hi(this.root,null,this.i,!1)},$i.prototype.ft=function(t){return new Hi(this.root,t,this.i,!1)},$i.prototype.dt=function(){return new Hi(this.root,null,this.i,!0)},$i.prototype.wt=function(t){return new Hi(this.root,t,this.i,!0)},$i),Hi=(Yi.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Yi.prototype.At=function(){return 0<this.Et.length},Yi.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Yi),Xi=(Ki.prototype.copy=function(t,e,n,r,i){return new Ki(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ki.prototype.m=function(){return!1},Ki.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ki.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ki.prototype.min=function(){return this.left.m()?this:this.left.min()},Ki.prototype.ct=function(){return this.min().key},Ki.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Ki.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).yt()},Ki.prototype.Pt=function(){if(this.left.m())return Ki.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).yt()},Ki.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Ki.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.yt()},Ki.prototype.gt=function(){return this.color},Ki.prototype.yt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.St()),t.left.gt()&&t.left.left.gt()&&(t=t.vt()),t.left.gt()&&t.right.gt()&&(t=t.Dt()),t},Ki.prototype.Vt=function(){var t=this.Dt();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).St()).Dt()),t},Ki.prototype.bt=function(){var t=this.Dt();return t.left.left.gt()&&(t=(t=t.vt()).Dt()),t},Ki.prototype.St=function(){var t=this.copy(null,null,Ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ki.prototype.vt=function(){var t=this.copy(null,null,Ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ki.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ki.prototype.Ct=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Ki.prototype.Ft=function(){if(this.gt()&&this.left.gt())throw Vr();if(this.right.gt())throw Vr();var t=this.left.Ft();if(t!==this.right.Ft())throw Vr();return t+(this.gt()?0:1)},Ki);function Ki(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ki.RED,this.left=null!=r?r:Ki.EMPTY,this.right=null!=i?i:Ki.EMPTY,this.size=this.left.size+1+this.right.size}function Yi(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function $i(t,e){this.i=t,this.root=e||Xi.EMPTY}function Ji(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.ut=!1,Xi.EMPTY=(Object.defineProperty(Ji.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Ji.prototype.copy=function(t,e,n,r,i){return this},Ji.prototype.ot=function(t,e,n){return new Xi(t,e)},Ji.prototype.remove=function(t,e){return this},Ji.prototype.m=function(){return!0},Ji.prototype.ht=function(t){return!1},Ji.prototype.lt=function(t){return!1},Ji.prototype.ct=function(){return null},Ji.prototype.at=function(){return null},Ji.prototype.gt=function(){return!1},Ji.prototype.Ct=function(){return!0},Ji.prototype.Ft=function(){return 0},new Ji);var Zi=(ro.prototype.has=function(t){return null!==this.data.get(t)},ro.prototype.first=function(){return this.data.ct()},ro.prototype.last=function(){return this.data.at()},Object.defineProperty(ro.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ro.prototype.indexOf=function(t){return this.data.indexOf(t)},ro.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},ro.prototype.$t=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},ro.prototype.Nt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},ro.prototype.xt=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},ro.prototype._t=function(){return new to(this.data._t())},ro.prototype.ft=function(t){return new to(this.data.ft(t))},ro.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},ro.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ro.prototype.m=function(){return this.data.m()},ro.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ro.prototype.isEqual=function(t){if(!(t instanceof ro))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},ro.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ro.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ro.prototype.copy=function(t){var e=new ro(this.i);return e.data=t,e},ro),to=(no.prototype.It=function(){return this.Ot.It().key},no.prototype.At=function(){return this.Ot.At()},no),eo=new Qi(qr.i);function no(t){this.Ot=t}function ro(t){this.i=t,this.data=new Qi(this.i)}var io=new Qi(qr.i),oo=new Qi(qr.i),so=new Zi(qr.i);function uo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=so,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ao=new Zi(pi),ho=(Ro.qt=function(t){return new Ro(t.i)},Ro.prototype.has=function(t){return null!=this.Lt.get(t)},Ro.prototype.get=function(t){return this.Lt.get(t)},Ro.prototype.first=function(){return this.Mt.ct()},Ro.prototype.last=function(){return this.Mt.at()},Ro.prototype.m=function(){return this.Mt.m()},Ro.prototype.indexOf=function(t){return(t=this.Lt.get(t))?this.Mt.indexOf(t):-1},Object.defineProperty(Ro.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Ro.prototype.forEach=function(n){this.Mt.ht(function(t,e){return n(t),!1})},Ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Lt.ot(t.key,t),e.Mt.ot(t,null))},Ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Lt.remove(t),this.Mt.remove(e)):this},Ro.prototype.isEqual=function(t){if(!(t instanceof Ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt._t(),n=t.Mt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},Ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ro.prototype.copy=function(t,e){var n=new Ro;return n.i=this.i,n.Lt=t,n.Mt=e,n},Ro),co=(No.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Vr()},No.prototype.Bt=function(){var n=[];return this.Ut.ht(function(t,e){n.push(e)}),n},No),lo=(Ao.zt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ao(t,e,ho.qt(e),i,n,r,!0,!1)},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return!this.jt.m()},enumerable:!1,configurable:!0}),Ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.jt.isEqual(t.jt)&&Ou(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ao),fo=(To.Xt=function(t,e){var n=new Map;return n.set(t,po.Zt(t,e)),new To(Oi.min(),n,ao,eo,uo())},To),po=(Io.Zt=function(t,e){return new Io(yi.q,e,uo(),uo(),uo())},Io),yo=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},vo=function(t,e){this.targetId=t,this.oe=e},go=function(t,e,n,r){void 0===n&&(n=yi.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mo=(Object.defineProperty(Eo.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"_e",{get:function(){return 0!==this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),Eo.prototype.de=function(t){0<t.L()&&(this.le=!0,this.ae=t)},Eo.prototype.we=function(){var n=uo(),r=uo(),i=uo();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new po(this.ae,this.he,n,r,i)},Eo.prototype.me=function(){this.le=!1,this.ce=So()},Eo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},Eo.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},Eo.prototype.Ie=function(){this.ue+=1},Eo.prototype.Ae=function(){--this.ue},Eo.prototype.Re=function(){this.le=!0,this.he=!0},Eo),wo=(bo.prototype.ve=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof hu?this.be(r,t.re):t.re instanceof cu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},bo.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Fe(t);switch(n.state){case 0:r.$e(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.$e(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.$e(t)&&(r.Ne(t),e.de(n.resumeToken));break;default:Vr()}})},bo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.$e(e)&&n(e)})},bo.prototype.xe=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(xi(t=t.target)?0===n?(t=new qr(t.path),this.Se(e,t,new cu(t,Oi.min()))):_r(1===n):this.Oe(e)!==n&&(this.Ne(e),this.Ve=this.Ve.add(e)))},bo.prototype.Le=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&xi(n.target)&&(n=new qr(n.target.path),null!==i.ge.get(n)||i.Me(e,n)||i.Se(e,n,new cu(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=uo();this.pe.forEach(function(t,e){var n=!0;e.Nt(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new fo(r,o,this.Ve,this.ge,s);return this.ge=eo,this.pe=Oo(),this.Ve=new Zi(pi),t},bo.prototype.be=function(t,e){var n;this.$e(t)&&(n=this.Me(t,e.key)?2:0,this.Fe(t).Te(e.key,n),this.ge=this.ge.ot(e.key,e),this.pe=this.pe.ot(e.key,this.qe(e.key).add(t)))},bo.prototype.Se=function(t,e,n){var r;this.$e(t)&&(r=this.Fe(t),this.Me(t,e)?r.Te(e,1):r.Ee(e),this.pe=this.pe.ot(e,this.qe(e).delete(t)),n&&(this.ge=this.ge.ot(e,n)))},bo.prototype.removeTarget=function(t){this.Pe.delete(t)},bo.prototype.Oe=function(t){var e=this.Fe(t).we();return this.ye.Ue(t).size+e.ee.size-e.se.size},bo.prototype.Ie=function(t){this.Fe(t).Ie()},bo.prototype.Fe=function(t){var e=this.Pe.get(t);return e||(e=new mo,this.Pe.set(t,e)),e},bo.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new Zi(pi),this.pe=this.pe.ot(t,e)),e},bo.prototype.$e=function(t){var e=null!==this.ke(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},bo.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ye.Be(t)},bo.prototype.Ne=function(e){var n=this;this.Pe.set(e,new mo),this.ye.Ue(e).forEach(function(t){n.Se(e,t,null)})},bo.prototype.Me=function(t,e){return this.ye.Ue(t).has(e)},bo);function bo(t){this.ye=t,this.Pe=new Map,this.ge=eo,this.pe=Oo(),this.Ve=new Zi(pi)}function Eo(){this.ue=0,this.ce=So(),this.ae=yi.q,this.he=!1,this.le=!0}function Io(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function To(t,e,n,r,i){this.nt=t,this.Kt=e,this.Ht=n,this.Yt=r,this.Jt=i}function Ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.jt=i,this.fromCache=o,this.Wt=s,this.Gt=u}function No(){this.Ut=new Qi(qr.i)}function Ro(n){this.i=n?function(t,e){return n(t,e)||qr.i(t.key,e.key)}:function(t,e){return qr.i(t.key,e.key)},this.Lt=io,this.Mt=new Qi(this.i)}function Oo(){return new Qi(qr.i)}function So(){return new Qi(qr.i)}function Do(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Lo(t){return t=Mo(t.mapValue.fields.__local_write_time__.timestampValue),new Ri(t.seconds,t.nanos)}var Vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Do(t)?4:10:Vr()}function Uo(r,i){var t,e,n,o=_o(r);if(o!==_o(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Lo(r).isEqual(Lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Mo(r.timestampValue),t=Mo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Fo(r.bytesValue).isEqual(Fo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,xo((t=r).geoPointValue.latitude)===xo(o.geoPointValue.latitude)&&xo(t.geoPointValue.longitude)===xo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?xo(e.integerValue)===xo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=xo(e.doubleValue))===(n=xo(n.doubleValue))?ki(e)===ki(n):isNaN(e)&&isNaN(n));case 9:return di(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return Vr()}}function ko(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function jo(t,e){var n,r,i,o,s=_o(t),u=_o(e);if(s!==u)return pi(s,u);switch(s){case 0:return 0;case 1:return pi(t.booleanValue,e.booleanValue);case 2:return n=e,(r=xo(t.integerValue||t.doubleValue))<(n=xo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Po(t.timestampValue,e.timestampValue);case 4:return Po(Lo(t),Lo(e));case 5:return pi(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Fo(i),o=Fo(o),i.M(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=pi(n[i],r[i]);if(0!==o)return o}return pi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=pi(xo(s.latitude),xo(r.latitude)))?n:pi(xo(s.longitude),xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=jo(n[i],r[i]);if(o)return o}return pi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=pi(r[s],o[s]);if(0!==u)return u;if(0!==(u=jo(n[r[s]],i[o[s]])))return u}return pi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function Po(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return pi(t,e);var n=Mo(t),t=Mo(e);return 0!==(e=pi(n.seconds,t.seconds))?e:pi(n.nanos,t.nanos)}function Co(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Mo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Fo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,qr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Vr();var t,e}(t)}function Mo(t){if(_r(!!t),"string"!=typeof t)return{seconds:xo(t.seconds),nanos:xo(t.nanos)};var e=0,n=Vo.exec(t);return _r(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Fo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function qo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Bo(t){return t&&"integerValue"in t}function Go(t){return!!t&&"arrayValue"in t}function zo(t){return t&&"nullValue"in t}function Wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qo(t){return t&&"mapValue"in t}var Ho={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ko=function(t,e){this.B=t,this.Qe=e};function Yo(t){return{integerValue:""+t}}function $o(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(e)?"-0":e}}function Jo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ki(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Yo(e):$o(t,e);var n}function Zo(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ts(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function es(t){return _r(!!t),Oi.J((t=Mo(t),new Ri(t.seconds,t.nanos)))}function ns(t,e){return new Mr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function rs(t,e){return ns(t.B,e.path)}function is(t,e){return _r(ls(e=Mr.P(e))),_r(e.get(1)===t.B.projectId),_r(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new qr((_r(4<(e=e).length&&"documents"===e.get(4)),e.u(5)))}function os(t,e){return ns(t.B,e)}function ss(t){return new Mr(["projects",t.B.projectId,"databases",t.B.database]).R()}function us(t,e,n){return{name:rs(t,e),fields:n.proto.mapValue.fields}}function as(t,e){var n,r,i;if(e instanceof qs)n={update:us(t,e.key,e.value)};else if(e instanceof Js)n={delete:rs(t,e.key)};else if(e instanceof Bs)n={update:us(t,e.key,e.data),updateMask:(i=e.je,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Hs)n={transform:{document:rs(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ns)return{fieldPath:t.field.R(),increment:e.We};throw Vr()})}};else{if(!(e instanceof Zs))return Vr();n={verify:rs(t,e.key)}}return e.ze.Ge||(n.currentDocument=void 0!==(i=e.ze).updateTime?{updateTime:Zo(e=t,(t=i.updateTime).Z())}:void 0!==i.exists?{exists:i.exists}:Vr()),n}function hs(t){return{before:t.before,values:t.position}}function cs(t){return{fieldPath:t.R()}}function ls(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function fs(t,e){return t instanceof Ns?Bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(n(ms,ds=l=function(){this.Ke=void 0}),ms),vs=(n(gs,ps=l),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,Es=(n(Is,bs=l),Is);function Is(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function Ts(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var As,Ns=(n(Rs,As=l),Rs);function Rs(t,e){var n=this;return(n=As.call(this)||this).serializer=t,n.We=e,n}function Os(t){return xo(t.integerValue||t.doubleValue)}function Ss(t){return Go(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ds(t,e){this.field=t,this.transform=e}var Ls=(Vs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Vs.prototype.isEqual=function(t){return di(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Vs);function Vs(t){(this.fields=t).sort(Fr.i)}function _s(t,e){this.version=t,this.transformResults=e}var Us=(ks.Ye=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"Ge",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function js(t,e){return void 0!==t.updateTime?e instanceof hu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof hu}function Ps(t,e,n,r){return t instanceof qs?(o=e,js((i=t).ze,o)?(o=Ms(o),new hu(i.key,o,i.value,{Je:!0})):o):t instanceof Bs?function(t,e){if(!js(t.ze,e))return e;var n=Ms(e),e=Ws(t,e);return new hu(t.key,n,e,{Je:!0})}(t,e):t instanceof Hs?function(t,e,n,r){if(!js(t.ze,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof hu&&(c=n.field(a.field)),null===c&&r instanceof hu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ys?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof vs?ws(h,i):h instanceof Es?Ts(h,i):(i=Os(h=fs(c=h,i))+Os(c.We),Bo(h)&&Bo(c.We)?Yo(i):$o(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ks(t,i.data(),r);return new hu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,js((t=t).ze,e)?new cu(t.key,Oi.min()):e);var i,o}function Cs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.ze.isEqual(e.ze)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.je.isEqual(e.je):2!==t.type||di(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof Es&&e instanceof Es?di(t.elements,e.elements,Uo):t instanceof Ns&&e instanceof Ns?Uo(t.We,e.We):t instanceof ys&&e instanceof ys)}))}function Ms(t){return t instanceof hu?t.version:Oi.min()}var xs,Fs,qs=(n(zs,Fs=l=function(){}),zs),Bs=(n(Gs,xs=l),Gs);function Gs(t,e,n,r){var i=this;return(i=xs.call(this)||this).key=t,i.data=e,i.je=n,i.ze=r,i.type=1,i}function zs(t,e,n){var r=this;return(r=Fs.call(this)||this).key=t,r.value=e,r.ze=n,r.type=0,r}function Ws(t,e){return n=t,e=e instanceof hu?e.data():tu.empty(),r=new eu(e),n.je.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Qs,Hs=(n(Xs,Qs=l),Xs);function Xs(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.ze=Us.exists(!0),n}function Ks(t,e,n){for(var r=new eu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Ys,$s,Js=(n(ou,$s=l),ou),Zs=(n(iu,Ys=l),iu),tu=(ru.empty=function(){return new ru({mapValue:{}})},ru.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},ru.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},ru),eu=(nu.prototype.set=function(t,e){return this.en(t,e),this},nu.prototype.delete=function(t){return this.en(t,null),this},nu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===_o(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},nu.prototype.Xe=function(){var t=this.nn(Fr.g(),this.tn);return null!=t?new tu(t):this.Ze},nu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Qo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},nu);function nu(t){void 0===t&&(t=tu.empty()),this.Ze=t,this.tn=new Map}function ru(t){this.proto=t}function iu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.ze=e,n.type=4,n}function ou(t,e){var n=this;return(n=$s.call(this)||this).key=t,n.ze=e,n.type=3,n}var su,uu,au,hu=(n(yu,au=l=function(t,e){this.key=t,this.version=e}),yu.prototype.field=function(t){return this.sn.field(t)},yu.prototype.data=function(){return this.sn},yu.prototype.rn=function(){return this.sn.proto},yu.prototype.isEqual=function(t){return t instanceof yu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},yu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu),cu=(n(du,uu=l),du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),lu=(n(pu,su=l),pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),fu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.un=o,this.startAt=s,this.endAt=u,this.cn=null,this.an=null,this.startAt,this.endAt};function pu(){return null!==su&&su.apply(this,arguments)||this}function du(t,e,n){var r=this;return(r=uu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function yu(t,e,n,r){var i=this;return(i=au.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function vu(t){return new fu(t)}function gu(t){return!Ui(t.limit)&&"F"===t.un}function mu(t){return!Ui(t.limit)&&"L"===t.un}function wu(t){return 0<t.on.length?t.on[0].field:null}function bu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Eu(t){return null!==t.collectionGroup}function Iu(t){var e=t;if(null===e.cn){e.cn=[];var n=bu(e),t=wu(e);if(null!==n&&null===t)n.V()||e.cn.push(new ua(n)),e.cn.push(new ua(Fr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.V()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new ua(Fr.v(),n)))}}return e.cn}function Tu(t){var e=t;if(!e.an)if("F"===e.un)e.an=Pi(e.path,e.collectionGroup,Iu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Iu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ua(o.field,s))}var u=e.endAt?new Zu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Zu(e.startAt.position,!e.startAt.before):null;e.an=Pi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function Au(t,e,n){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nu(t,e){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,e,t.endAt)}function Ru(t,e){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,t.startAt,e)}function Ou(t,e){return Mi(Tu(t),Tu(e))&&t.un===e.un}function Su(t){return Ci(Tu(t))+"|lt:"+t.un}function Du(t){return"Query(target="+(n=(e=Tu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Co(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ia(e.startAt)),e.endAt&&(n+=", endAt: "+ia(e.endAt)),"Target("+n+")")+"; limitType="+t.un+")";var e,n}function Lu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.F(e.collectionGroup)&&e.path.T(n):qr.$(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||oa(t.startAt,Iu(t),n))&&(!t.endAt||!oa(t.endAt,Iu(t),n)));var e,n}function Vu(u){return function(t,e){for(var n=!1,r=0,i=Iu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.V()?qr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?jo(o,r):Vr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var _u,Uu=(n(ku,_u=function(){}),ku.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.ln(t,e,n):new Mu(t,e,n);if(zo(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new ku(t,e,n)}if(Wo(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new ku(t,e,n)}return"array-contains"===e?new Ku(t,n):"in"===e?new Yu(t,n):"not-in"===e?new $u(t,n):"array-contains-any"===e?new Ju(t,n):new ku(t,e,n)},ku.ln=function(t,e,n){return new("in"===e?xu:Fu)(t,n)},ku.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(jo(t,this.value)):null!==t&&_o(this.value)===_o(t)&&this._n(jo(t,this.value))},ku.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},ku.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ku);function ku(t,e,n){var r=this;return(r=_u.call(this)||this).field=t,r.op=e,r.value=n,r}var ju,Pu,Cu,Mu=(n(Gu,Cu=Uu),Gu.prototype.matches=function(t){return t=qr.i(t.key,this.key),this._n(t)},Gu),xu=(n(Bu,Pu=Uu),Bu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bu),Fu=(n(qu,ju=Uu),qu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},qu);function qu(t,e){var n=this;return(n=ju.call(this,t,"not-in",e)||this).keys=zu(0,e),n}function Bu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=zu(0,e),n}function Gu(t,e,n){var r=this;return(r=Cu.call(this,t,e,n)||this).key=qr.C(n.referenceValue),r}function zu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return qr.C(t.referenceValue)})}var Wu,Qu,Hu,Xu,Ku=(n(ra,Xu=Uu),ra.prototype.matches=function(t){return Go(t=t.field(this.field))&&ko(t.arrayValue,this.value)},ra),Yu=(n(na,Hu=Uu),na.prototype.matches=function(t){return null!==(t=t.field(this.field))&&ko(this.value.arrayValue,t)},na),$u=(n(ea,Qu=Uu),ea.prototype.matches=function(t){return!ko(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!ko(this.value.arrayValue,t))},ea),Ju=(n(ta,Wu=Uu),ta.prototype.matches=function(t){var e=this;return!(!Go(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ko(e.value.arrayValue,t)})},ta),Zu=function(t,e){this.position=t,this.before=e};function ta(t,e){return Wu.call(this,t,"array-contains-any",e)||this}function ea(t,e){return Qu.call(this,t,"not-in",e)||this}function na(t,e){return Hu.call(this,t,"in",e)||this}function ra(t,e){return Xu.call(this,t,"array-contains",e)||this}function ia(t){return(t.before?"b":"a")+":"+t.position.map(Co).join(",")}function oa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?qr.i(qr.C(s.referenceValue),n.key):jo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var ua=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function aa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ha=(fa.prototype.reset=function(){this.En=0},fa.prototype.Rn=function(){this.En=this.Tn},fa.prototype.yn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.gn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},fa.prototype.pn=function(){null!==this.In&&(this.In.Vn(),this.In=null)},fa.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},fa.prototype.Pn=function(){return(Math.random()-.5)*this.En},fa),ca=(la.prototype.catch=function(t){return this.next(void 0,t)},la.prototype.next=function(r,i){var o=this;return this.Dn&&Vr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Fn(r,this.result):new la(function(e,n){o.vn=function(t){o.Fn(r,t).next(e,n)},o.bn=function(t){o.Cn(i,t).next(e,n)}})},la.prototype.$n=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},la.prototype.Nn=function(t){try{var e=t();return e instanceof la?e:la.resolve(e)}catch(t){return la.reject(t)}},la.prototype.Fn=function(t,e){return t?this.Nn(function(){return t(e)}):la.resolve(e)},la.prototype.Cn=function(t,e){return t?this.Nn(function(){return t(e)}):la.reject(e)},la.resolve=function(n){return new la(function(t,e){t(n)})},la.reject=function(n){return new la(function(t,e){e(n)})},la.xn=function(t){return new la(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},la.kn=function(t){for(var n=la.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?la.resolve(t):e()})}(r[e]);return n},la.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},la);function la(t){var e=this;this.vn=null,this.bn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.vn&&e.vn(t)},function(t){e.Sn=!0,e.error=t,e.bn&&e.bn(t)})}function fa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function pa(t){return"IndexedDbTransactionError"===t.name}function da(){return"undefined"!=typeof document?document:null}var ya=(ma.Un=function(t,e,n,r,i){return(i=new ma(t,e,Date.now()+n,r,i)).start(n),i},ma.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.Qn()},t)},ma.prototype.Vn=function(){return this.Qn()},ma.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ma.prototype.Qn=function(){var e=this;this.On.jn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},ma.prototype.clearTimeout=function(){null!==this.Bn&&(this.Mn(this),clearTimeout(this.Bn),this.Bn=null)},ma),va=(Object.defineProperty(ga.prototype,"ts",{get:function(){return this.zn},enumerable:!1,configurable:!0}),ga.prototype.jn=function(t){this.enqueue(t)},ga.prototype.es=function(t){this.ns(),this.ss(t)},ga.prototype.rs=function(){var t;this.zn||(this.zn=!0,(t=da())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Zn))},ga.prototype.enqueue=function(t){return this.ns(),this.zn?new Promise(function(t){}):this.ss(t)},ga.prototype.os=function(t){var e=this;this.jn(function(){return e.Gn.push(t),e.us()})},ga.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Gn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Gn[0]()];case 2:return t.sent(),this.Gn.shift(),this.Xn.reset(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Gn.length&&this.Xn.yn(function(){return n.us()}),t.label=5;case 5:return[2]}})})},ga.prototype.ss=function(t){var r=this,e=this.Wn.then(function(){return r.Yn=!0,t().catch(function(t){throw r.Hn=t,r.Yn=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Yn=!1,t})});return this.Wn=e},ga.prototype.gn=function(t,e,n){var r=this;return this.ns(),-1<this.Jn.indexOf(t)&&(e=0),n=ya.Un(this,t,e,n,function(t){return r.cs(t)}),this.Kn.push(n),n},ga.prototype.ns=function(){this.Hn&&Vr()},ga.prototype.hs=function(){},ga.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Wn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Wn)return[3,0];t.label=3;case 3:return[2]}})})},ga.prototype._s=function(t){for(var e=0,n=this.Kn;e<n.length;e++)if(n[e].dn===t)return!0;return!1},ga.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.Kn.sort(function(t,e){return t.Ln-e.Ln});for(var t=0,e=i.Kn;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.dn===r)break}return i.ls()})},ga.prototype.ds=function(t){this.Jn.push(t)},ga.prototype.cs=function(t){t=this.Kn.indexOf(t),this.Kn.splice(t,1)},ga);function ga(){var e=this;this.Wn=Promise.resolve(),this.Gn=[],this.zn=!1,this.Kn=[],this.Hn=null,this.Yn=!1,this.Jn=[],this.Xn=new ha(this,"async_queue_retry"),this.Zn=function(){var t=da();t&&Or("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Xn.pn()};var t=da();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Zn)}function ma(t,e,n,r,i){this.On=t,this.dn=e,this.Ln=n,this.op=r,this.Mn=i,this.qn=new aa,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function wa(t,e){if(Sr("AsyncQueue",e+": "+t),pa(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}function ba(){this.ws=void 0,this.listeners=[]}function Ea(){this.Ts=new Ni(Su,Ou),this.onlineState="Unknown",this.Es=new Set}function Ia(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ts.get(n))||(r=!0,i=new ba),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=wa(o=t.sent(),"Initialization of query '"+Du(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ts.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&Aa(e),[2]}})})}function Ta(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ts.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ts.delete(n),e.ys(n))]:[2]})})}function Aa(t){t.Es.forEach(function(t){t.next()})}var Na=(Sa.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lo(t.query,t.docs,t.Qt,e,t.jt,t.fromCache,t.Wt,!0)}var o=!1;return this.gs?this.Vs(t)&&(this.Ps.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.ps=t,o},Sa.prototype.onError=function(t){this.Ps.error(t)},Sa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.gs&&this.vs(this.ps,t)&&(this.bs(this.ps),e=!0),e},Sa.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ss&&n||t.docs.m()&&"Offline"!==e)},Sa.prototype.Vs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Sa.prototype.bs=function(t){t=lo.zt(t.query,t.docs,t.jt,t.fromCache),this.gs=!0,this.Ps.next(t)},Sa),Ra=(Oa.prototype.Ds=function(){return null!=this.uid},Oa.prototype.Cs=function(){return this.Ds()?"uid:"+this.uid:"anonymous-user"},Oa.prototype.isEqual=function(t){return t.uid===this.uid},Oa);function Oa(t){this.uid=t}function Sa(t,e,n){this.query=t,this.Ps=e,this.gs=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}Ra.UNAUTHENTICATED=new Ra(null),Ra.Fs=new Ra("google-credentials-uid"),Ra.$s=new Ra("first-party-uid");var Da=(La.prototype.xs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},La.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},La);function La(t,e){var n=this;this.previousValue=t,e&&(e.Ns=function(t){return n.xs(t)},this.ks=function(t){return e.Os(t)})}Da.Ls=-1;var Va=(za.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},za.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},za.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},za),_a=(Ga.prototype.Ws=function(t){},Ga.prototype.Gs=function(t,e,n){},Ga.prototype.zs=function(t){return this.Bs.Ms(t),this.Qs[t]||"not-current"},Ga.prototype.Ks=function(t,e,n){this.Qs[t]=e},Ga.prototype.Hs=function(t){this.Bs.qs(t)},Ga.prototype.Ys=function(t){return this.Bs.activeTargetIds.has(t)},Ga.prototype.Js=function(t){delete this.Qs[t]},Ga.prototype.Xs=function(){return this.Bs.activeTargetIds},Ga.prototype.Zs=function(t){return this.Bs.activeTargetIds.has(t)},Ga.prototype.start=function(){return this.Bs=new Va,Promise.resolve()},Ga.prototype.ti=function(t,e,n){},Ga.prototype.ei=function(t){},Ga.prototype.ni=function(){},Ga.prototype.Os=function(t){},Ga),Ua=(Ba.prototype.ii=function(t,e,n){for(var r,i,o,s,u,a,h=n.ri,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof qs?new hu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Bs?(u=i,a=o,js((s=r).ze,u)?(u=Ws(s,u),new hu(s.key,a.version,u,{hasCommittedMutations:!0})):new lu(s.key,a.version)):r instanceof Hs?function(t,e,n){if(_r(null!=n.transformResults),!js(t.ze,e))return new lu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof hu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof Es?Ts(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ks(t,r.data(),e);return new hu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new cu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ba.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.si))}return e},Ba.prototype.ui=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},uo())},Ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&di(this.mutations,t.mutations,Cs)&&di(this.baseMutations,t.baseMutations,Cs)},Ba),ka=(qa.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=oo,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new qa(t,e,n,r)},qa),ja=(Fa.prototype.fi=function(e,n){var r=this;return this.li.di(e,n).next(function(t){return r.wi(e,n,t)})},Fa.prototype.wi=function(t,r,i){return this.hi.mi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},Fa.prototype.Ti=function(t,e,i){var o=eo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.ot(t,e)}),o},Fa.prototype.Ei=function(e,t){var n=this;return this.hi.getEntries(e,t).next(function(t){return n.Ii(e,t)})},Fa.prototype.Ii=function(e,r){var i=this;return this.li.Ai(e,r).next(function(t){var t=i.Ti(e,r,t),n=eo;return t.forEach(function(t,e){e=e||new cu(t,Oi.min()),n=n.ot(t,e)}),n})},Fa.prototype.Ri=function(t,e,n){return r=e,qr.$(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.yi(t,e.path):Eu(e)?this.Pi(t,e,n):this.gi(t,e,n);var r},Fa.prototype.yi=function(t,e){return this.fi(t,new qr(e)).next(function(t){var e=io;return t instanceof hu&&(e=e.ot(t.key,t)),e})},Fa.prototype.Pi=function(n,r,i){var o=this,s=r.collectionGroup,u=io;return this._i.pi(n,s).next(function(t){return ca.forEach(t,function(t){var e=(e=r,t=t.child(s),new fu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.un,e.startAt,e.endAt));return o.gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Fa.prototype.gi=function(e,n,t){var h,c,r=this;return this.hi.Ri(e,n,t).next(function(t){return h=t,r.li.Vi(e,n)}).next(function(t){return c=t,r.vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Ps(s,a=h.get(u),a,r.si);h=a instanceof hu?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Lu(n,e)||(h=h.remove(t))}),h})},Fa.prototype.vi=function(t,e,n){for(var r=uo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.hi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof hu&&(h=h.ot(t,e))}),h})},Fa),Pa=(xa.Di=function(t,e){for(var n=uo(),r=uo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new xa(t,e.fromCache,n,r)},xa),Ca=(Ma.Ni=function(t){return new Ma(t,Ma.xi,Ma.ki)},Ma);function Ma(t,e,n){this.Ci=t,this.Fi=e,this.$i=n}function xa(t,e,n,r){this.targetId=t,this.fromCache=e,this.bi=n,this.Si=r}function Fa(t,e,n){this.hi=t,this.li=e,this._i=n}function qa(t,e,n,r){this.batch=t,this.ci=e,this.ri=n,this.ai=r}function Ba(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Ga(){this.Bs=new Va,this.Qs={},this.js=null,this.Ns=null}function za(){this.activeTargetIds=ao}Ca.Oi=-1,Ca.Li=1048576,Ca.Mi=41943040,Ca.xi=10,Ca.ki=1e3,Ca.qi=new Ca(Ca.Mi,Ca.xi,Ca.ki),Ca.Ui=new Ca(Ca.Oi,0,0);var Wa=(Ja.prototype.Qi=function(t,e){return this.Bi.add(e),ca.resolve()},Ja.prototype.pi=function(t,e){return ca.resolve(this.Bi.getEntries(e))},Ja),Qa=($a.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new Zi(Mr.i),t=!r.has(n);return this.index[e]=r.add(n),t},$a.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},$a.prototype.getEntries=function(t){return(this.index[t]||new Zi(Mr.i)).A()},$a),Ha=(Ya.prototype.next=function(){return this.ji+=2,this.ji},Ya.Wi=function(){return new Ya(0)},Ya.Gi=function(){return new Ya(-1)},Ya),Xa=(Ka.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Ki)})},Ka);function Ka(t,e,n){this.persistence=t,this.zi=e,this.Ki=new Qi(pi),this.Hi=new Ni(Ci,Mi),this.Yi=Oi.min(),this.li=t.Ji(n),this.Xi=t.Zi(),this.tr=t.er(),this.nr=new ja(this.Xi,this.li,this.persistence.sr()),this.zi.ir(this.nr)}function Ya(t){this.ji=t}function $a(){this.index={}}function Ja(){this.Bi=new Qa}function Za(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.tr.dr(t)})}function th(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ki.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!pa(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ki=e.Ki.remove(o),e.Hi.delete(n.target),[2]}})})}function eh(t,o,s){var u=t,a=Oi.min(),h=uo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Tu(o),(void 0!==(t=(i=t).Hi.get(r))?ca.resolve(i.Ki.get(t)):i.tr.gr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.tr.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.zi.Ri(e,o,s?a:Oi.min(),s?h:uo())}).next(function(t){return{documents:t,Vr:h}});var t,n,r,i})}function nh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function rh(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}function ih(t,e,n,r,i){var o=this;this.Qo=t,this.jo=e,this.On=n,this.Wo={},this.Go=[],this.zo=new Map,this.Ko=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.jn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Mh(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(4),[4,Lh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.Ko.delete(4),[4,Dh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new gh(n,r)}var oh,sh,uh,ah=(Sh.prototype.m=function(){return this.vr.m()},Sh.prototype.Cr=function(t,e){e=new hh(t,e),this.vr=this.vr.add(e),this.Sr=this.Sr.add(e)},Sh.prototype.Fr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Sh.prototype.$r=function(t,e){this.Nr(new hh(t,e))},Sh.prototype.kr=function(t,e){var n=this;t.forEach(function(t){return n.$r(t,e)})},Sh.prototype.Or=function(t){var e=this,n=new qr(new Mr([])),r=new hh(n,t),t=new hh(n,t+1),i=[];return this.Sr.$t([r,t],function(t){e.Nr(t),i.push(t.key)}),i},Sh.prototype.Lr=function(){var e=this;this.vr.forEach(function(t){return e.Nr(t)})},Sh.prototype.Nr=function(t){this.vr=this.vr.delete(t),this.Sr=this.Sr.delete(t)},Sh.prototype.Mr=function(t){var e=new qr(new Mr([])),n=new hh(e,t),t=new hh(e,t+1),r=uo();return this.Sr.$t([n,t],function(t){r=r.add(t.key)}),r},Sh.prototype.qr=function(t){var e=new hh(t,0);return null!==(e=this.vr.xt(e))&&t.isEqual(e.key)},Sh),hh=(Oh.br=function(t,e){return qr.i(t.key,e.key)||pi(t.Ur,e.Ur)},Oh.Dr=function(t,e){return pi(t.Ur,e.Ur)||qr.i(t.key,e.key)},Oh),ch=(Rh.prototype.getToken=function(){return Promise.resolve(null)},Rh.prototype.jr=function(){},Rh.prototype.Wr=function(t){(this.Qr=t)(Ra.UNAUTHENTICATED)},Rh.prototype.Gr=function(){this.Qr=null},Rh),lh=(Nh.prototype.getToken=function(){var e=this,n=this.Hr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Hr!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new rh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Nh.prototype.jr=function(){this.forceRefresh=!0},Nh.prototype.Wr=function(t){this.Qr=t,this.Kr&&t(this.currentUser)},Nh.prototype.Gr=function(){this.auth&&this.auth.removeAuthTokenListener(this.zr),this.zr=null,this.Qr=null},Nh.prototype.Yr=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Ra(t)},Nh),fh=(Object.defineProperty(Ah.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Xr},e=this.Jr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ah),ph=(Th.prototype.getToken=function(){return Promise.resolve(new fh(this.Jr,this.Xr))},Th.prototype.Wr=function(t){t(Ra.$s)},Th.prototype.Gr=function(){},Th.prototype.jr=function(){},Th),l=(Ih.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},Ih.prototype.oo=function(){return 2===this.state},Ih.prototype.start=function(){3!==this.state?this.auth():this.uo()},Ih.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ih.prototype.co=function(){this.state=0,this.Xn.reset()},Ih.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this.fn.gn(this.Zr,6e4,function(){return t.ho()}))},Ih.prototype.lo=function(t){this._o(),this.stream.send(t)},Ih.prototype.ho=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},Ih.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},Ih.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._o(),this.Xn.cancel(),this.so++,3!==e?this.Xn.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.Xn.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.no.jr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},Ih.prototype.fo=function(){},Ih.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},Ih.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ih.prototype.uo=function(){var t=this;this.state=4,this.Xn.yn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Ih.prototype.To=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ih.prototype.wo=function(e){var n=this;return function(t){n.fn.jn(function(){return n.so===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ih),dh=(n(Eh,uh=l),Eh.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},Eh.prototype.onMessage=function(t){this.Xn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Vr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(_r(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(_r(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Wi(s.code),new Ir(o,s.message||"")),r=new go(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=is(t,a.document.name),u=es(a.document.updateTime),s=new tu({mapValue:{fields:a.document.fields}}),u=new hu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new yo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=is(t,a.document),h=a.readTime?es(a.readTime):Oi.min(),h=new cu(u,h),a=a.removedTargetIds||[];r=new yo([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=is(t,h.document),h=h.removedTargetIds||[];r=new yo([],h,c,null)}else{if(!("filter"in e))return Vr();e.filter,(c=e.filter).targetId,e=new Fi(e=c.count||0),c=c.targetId,r=new vo(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Oi.min():es(e.readTime);return this.listener.Ro(n,t)},Eh.prototype.yo=function(t){var e,n,r,i,o,s,u,a,h={};h.database=ss(this.serializer),h.addTarget=(e=this.serializer,(r=xi(r=(n=t).target)?{documents:{documents:[os(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=os(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=os(i,u.h()),s.structuredQuery.from=[{collectionId:u._()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(zo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(zo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:cs((t=t).field),direction:(t=t.dir,Ho[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Qe||Ui(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=hs(o.startAt)),o.endAt&&(s.structuredQuery.endAt=hs(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.L()&&(r.resumeToken=ts(e,n.resumeToken)),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.lo(h)},Eh.prototype.Po=function(t){var e={};e.database=ss(this.serializer),e.removeTarget=t,this.lo(e)},Eh),yh=(n(bh,sh=l),Object.defineProperty(bh.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),bh.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,sh.prototype.start.call(this)},bh.prototype.fo=function(){this.po&&this.vo([])},bh.prototype.Eo=function(t){return this.eo.Ao("Write",t)},bh.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Xn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(_r(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?es(e.updateTime):es(n)).isEqual(Oi.min())&&(r=es(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new _s(r,n);var e,n,r})):[]),n=es(t.commitTime);return this.listener.bo(n,e)}var i;return _r(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},bh.prototype.Do=function(){var t={};t.database=ss(this.serializer),this.lo(t)},bh.prototype.vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return as(e.serializer,t)})};this.lo(t)},bh),vh=(n(wh,oh=function(){}),wh.prototype.Fo=function(){if(this.Co)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},wh.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.jr(),t})},wh.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.jr(),t})},wh.prototype.terminate=function(){this.Co=!1},wh),gh=(mh.prototype.Lo=function(){var t=this;0===this.xo&&(this.Mo("Unknown"),this.ko=this.On.gn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},mh.prototype.Uo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.xo++,1<=this.xo&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},mh.prototype.set=function(t){this.Bo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.Mo(t)},mh.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.js(t))},mh.prototype.qo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Oo?(Sr(t),this.Oo=!1):Or("OnlineStateTracker",t)},mh.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},mh);function mh(t,e){this.On=t,this.js=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function wh(t,e,n){var r=this;return(r=oh.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Co=!1,r}function bh(t,e,n,r,i){var o=this;return(o=sh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function Eh(t,e,n,r,i){var o=this;return(o=uh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ih(t,e,n,r,i,o){this.fn=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Xn=new ha(t,e)}function Th(t,e){this.Jr=t,this.Xr=e}function Ah(t,e){this.Jr=t,this.Xr=e,this.type="FirstParty",this.user=Ra.$s}function Nh(t){var e=this;this.zr=null,this.currentUser=Ra.UNAUTHENTICATED,this.Kr=!1,this.Hr=0,this.Qr=null,this.forceRefresh=!1,this.zr=function(){e.Hr++,e.currentUser=e.Yr(),e.Kr=!0,e.Qr&&e.Qr(e.currentUser)},this.Hr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.zr):(this.zr(null),t.get().then(function(t){e.auth=t,e.zr&&e.auth.addAuthTokenListener(e.zr)},function(){}))}function Rh(){this.Qr=null}function Oh(t,e){this.key=t,this.Ur=e}function Sh(){this.vr=new Zi(hh.br),this.Sr=new Zi(hh.Dr)}function Dh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Mh(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Lh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Vh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Ko.add(5),[4,Lh(e)];case 1:return t.sent(),e.Yo.ni(),e.Xo.set("Unknown"),[2]}})})}function _h(t,e){t.zo.has(e.targetId)||(t.zo.set(e.targetId,e),Ch(t)?Ph(t):Wh(t).oo()&&kh(t,e))}function Uh(t,e){var n=t,t=Wh(n);n.zo.delete(e),t.oo()&&jh(n,e),0===n.zo.size&&(t.oo()?t.ao():Mh(n)&&n.Xo.set("Unknown"))}function kh(t,e){t.Zo.Ie(e.targetId),Wh(t).yo(e)}function jh(t,e){t.Zo.Ie(e),Wh(t).Po(e)}function Ph(e){e.Zo=new wo({Ue:function(t){return e.Wo.Ue(t)},Be:function(t){return e.zo.get(t)||null}}),Wh(e).start(),e.Xo.Lo()}function Ch(t){return Mh(t)&&!Wh(t).ro()&&0<t.zo.size}function Mh(t){return 0===t.Ko.size}function xh(t){t.Zo=void 0}function Fh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!pa(r))throw r;return n.Ko.add(1),[4,Lh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return Za(n.Qo)},n.On.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ko.delete(1),[4,Dh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function qh(e,n){return n().catch(function(t){return Fh(e,t,n)})}function Bh(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=Qh(s=c),a=0<s.Go.length?s.Go[s.Go.length-1].batchId:-1,t.label=1;case 1:if(!(Mh(s)&&s.Go.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Qo,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.li.Pr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.Go.length&&u.ao(),[3,7]):(a=h.batchId,n=h,(e=s).Go.push(n),(e=Qh(e)).oo()&&e.Vo&&e.vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,Fh(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Gh(s)&&zh(s),[2]}var e,n,r,i,o})})}function Gh(t){return Mh(t)&&!Qh(t).ro()&&0<t.Go.length}function zh(t){Qh(t).start()}function Wh(n){var t,e,r,i=this;return n.iu||(n.iu=(t=n.jo,e=n.On,r={Io:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zo.forEach(function(t,e){kh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return xh(e),Ch(e)?(e.Xo.Uo(n),Ph(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Xo.set("Online"),!(u instanceof go&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zo.has(i)?[4,o.Wo.tu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zo.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Fh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof yo?s.Zo.ve(u):u instanceof vo?s.Zo.xe(u):s.Zo.De(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Za(s.Qo)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).Zo.Le(i)).Kt.forEach(function(t,e){var n;0<t.resumeToken.L()&&(n=r.zo.get(e))&&r.zo.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.zo.get(t);e&&(r.zo.set(t,e.it(yi.q,e.nt)),jh(r,t),e=new Bi(e.target,t,1,e.sequenceNumber),kh(r,e))}),r.Wo.eu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Fh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Fo(),new dh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.iu.co(),Ch(n)?Ph(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.iu.stop()];case 2:t.sent(),xh(n),t.label=3;case 3:return[2]}})})})),n.iu}function Qh(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.jo,e=n.On,r={Io:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Qh(e).Do(),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Qh(e).Vo?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return zi(n=i.code)&&n!==Er.ABORTED?(e=r.Go.shift(),Qh(r).co(),[4,qh(r,function(){return r.Wo.su(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Bh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Gh(e)&&zh(e),[2]}})})}.bind(null,n),So:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Qh(o),n=0,r=o.Go;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Go.shift(),n=ka.from(e,i,o),[4,qh(r,function(){return r.Wo.nu(n)})];case 1:return t.sent(),[4,Bh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fo(),new yh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.co(),[4,Bh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ru.stop()];case 3:t.sent(),0<n.Go.length&&(Or("RemoteStore","Stopping write stream with "+n.Go.length+" pending writes"),n.Go=[]),t.label=4;case 4:return[2]}})})})),n.ru}function Hh(t,e,n){this.query=t,this.targetId=e,this.view=n}var Xh=function(t){this.key=t},Kh=function(t){this.key=t},Yh=(Object.defineProperty(tc.prototype,"lu",{get:function(){return this.ou},enumerable:!1,configurable:!0}),tc.prototype._u=function(t,e){var s=this,u=e?e.fu:new co,a=(e||this).hu,h=(e||this).jt,c=a,l=!1,f=gu(this.query)&&a.size===this.query.limit?a.last():null,p=mu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof hu?e:null)&&(Lu(s.query,r)?r:null),i=!!n&&s.jt.has(n.key),o=!!r&&(r.Je||s.jt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.du(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.au(r,f)||p&&s.au(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),gu(this.query)||mu(this.query))for(;c.size>this.query.limit;){var n=gu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{hu:c,fu:u,wu:l,jt:h}},tc.prototype.du=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},tc.prototype.mu=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.jt=t.jt;var i=t.fu.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.au(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this.Tu(n);var s=e?this.Eu():[],e=(n=0===this.cu.size&&this.te?1:0)!==this.uu;return this.uu=n,0!==i.length||e?{snapshot:new lo(this.query,t.hu,r,i,t.jt,0==n,e,!1),Iu:s}:{Iu:s}},tc.prototype.As=function(t){return this.te&&"Offline"===t?(this.te=!1,this.mu({hu:this.hu,fu:new co,jt:this.jt,wu:!1},!1)):{Iu:[]}},tc.prototype.Au=function(t){return!this.ou.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).Je},tc.prototype.Tu=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.ou=e.ou.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.ou=e.ou.delete(t)}),this.te=t.te)},tc.prototype.Eu=function(){var e=this;if(!this.te)return[];var n=this.cu;this.cu=uo(),this.hu.forEach(function(t){e.Au(t.key)&&(e.cu=e.cu.add(t.key))});var r=[];return n.forEach(function(t){e.cu.has(t)||r.push(new Kh(t))}),this.cu.forEach(function(t){n.has(t)||r.push(new Xh(t))}),r},tc.prototype.Ru=function(t){return this.ou=t.Vr,this.cu=uo(),t=this._u(t.documents),this.mu(t,!0)},tc.prototype.yu=function(){return lo.zt(this.query,this.hu,this.jt,0===this.uu)},tc),$h=function(t){this.key=t,this.Pu=!1},Jh=(Object.defineProperty(Zh.prototype,"Mu",{get:function(){return!0===this.Lu},enumerable:!1,configurable:!0}),Zh);function Zh(t,e,n,r,i,o){this.Qo=t,this.gu=e,this.pu=n,this.Vu=r,this.currentUser=i,this.vu=o,this.bu={},this.Su=new Ni(Su,Ou),this.Du=new Map,this.Cu=[],this.Fu=new Qi(qr.i),this.$u=new Map,this.Nu=new ah,this.xu={},this.ku=new Map,this.Ou=Ha.Gi(),this.onlineState="Unknown",this.Lu=void 0}function tc(t,e){this.query=t,this.ou=e,this.uu=null,this.te=!1,this.cu=uo(),this.jt=uo(),this.au=Vu(t),this.hu=new ho(this.au)}function ec(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).gu.Wo.nu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Xi.cr({ar:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=ca.resolve();return a.forEach(function(n){h=h.next(function(){return s.mi(o,n)}).next(function(t){var e=t;_r(null!==(t=r.ai.get(n))),(!e||e.version.M(t)<0)&&(e=u.ii(n,e,r))&&s.hr(e,r.ci)})}),h.next(function(){return i.li.lr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.li._r(t)}).next(function(){return l.nr.Ei(t,e)})}))];case 2:return i=t.sent(),oc(n,r,null),ic(n,r),n.Vu.Gs(r,"acknowledged"),[4,cc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.gu.Wo.su=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.li.Gu(e,r).next(function(t){return _r(null!==t),n=t.keys(),i.li.lr(e,t)}).next(function(){return i.li._r(e)}).next(function(){return i.nr.Ei(e,n)})}))];case 2:return o=t.sent(),oc(n,u,a),ic(n,u),n.Vu.Gs(u,"rejected",a),[4,cc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Qo,a=p,c=r,l=Ri.now(),i=a.reduce(function(t,e){return t.add(e.key)},uo()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.nr.Ei(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Hs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof hu?t.field(i.field):void 0;null!=(o=fs(i.transform,o||null))&&(e=(null==e?new eu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Bs(i.key,o,function s(t){var u=[];return kr(t.fields||{},function(t,e){var n=new Fr([t]);if(Qo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ls(u)}(o.proto.mapValue),Us.exists(!0)))}return c.li.ju(u,l,e,a)})}).then(function(t){var e=t.ui(h);return{batchId:t.batchId,Wu:e}}))];case 2:return s=t.sent(),u.Vu.Ws(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.xu[e.currentUser.Cs()])||new Qi(pi)).ot(n,o),e.xu[e.currentUser.Cs()]=r,[4,cc(u,s.Wu)];case 3:return t.sent(),[4,Bh(u.gu)];case 4:return t.sent(),[3,6];case 5:return u=wa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function nc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,h=e,c=(a=o).nt,l=h.Ki,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Xi.cr({ar:!0});l=h.Ki;var u=[];a.Kt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.tr.wr(s,t.se,e).next(function(){return h.tr.mr(s,t.ee,e)})),0<(i=t.resumeToken).L()&&(n=o.it(i,c).st(s.Tr),l=l.ot(e,n),r=o,i=t,_r(0<(o=n).resumeToken.L()),(0===r.resumeToken.L()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(h.tr.Er(s,n))))});var t,o=eo,n=uo();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof cu&&e.version.isEqual(Oi.min())?(i.Ir(t,c),o=o.ot(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(i.hr(e,c),o=o.ot(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.Rr.Ar(s,t))})})),c.isEqual(Oi.min())||(t=h.tr.dr(s).next(function(t){return h.tr.yr(s,s.Tr,c)}),u.push(t)),ca.xn(u).next(function(){return i.apply(s)}).next(function(){return h.nr.Ii(s,o)})}).then(function(t){return h.Ki=l,t}))];case 2:return r=t.sent(),o.Kt.forEach(function(t,e){(e=n.$u.get(e))&&(_r(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Pu=!0:0<t.ne.size?_r(e.Pu):0<t.se.size&&(_r(e.Pu),e.Pu=!1))}),[4,cc(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,h,c,l})})}function rc(t,n,e){var r;((t=t).Mu&&0===e||!t.Mu&&1===e)&&(r=[],t.Su.forEach(function(t,e){(e=e.view.As(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ts.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&Aa(t)}(t.pu,n),r.length&&t.bu.Ro(r),t.onlineState=n,t.Mu&&t.Vu.ei(n))}function ic(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function oc(t,e,n){var r=t,i=r.xu[r.currentUser.Cs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xu[r.currentUser.Cs()]=i)}function sc(e,t,n){void 0===n&&(n=null),e.Vu.Hs(t);for(var r=0,i=e.Du.get(t);r<i.length;r++){var o=i[r];e.Su.delete(o),n&&e.bu.qu(o,n)}e.Du.delete(t),e.Mu&&e.Nu.Or(t).forEach(function(t){e.Nu.qr(t)||uc(e,t)})}function uc(t,e){var n=t.Fu.get(e);null!==n&&(Uh(t.gu,n),t.Fu=t.Fu.remove(e),t.$u.delete(n),hc(t))}function ac(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Xh?(t.Nu.Cr(u.key,e),r=t,i=(i=u).key,r.Fu.get(i)||(Or("SyncEngine","New document in limbo: "+i),r.Cu.push(i),hc(r))):u instanceof Kh?(Or("SyncEngine","Document no longer in limbo: "+u.key),t.Nu.$r(u.key,e),t.Nu.qr(u.key)||uc(t,u.key)):Vr()}}function hc(t){for(;0<t.Cu.length&&t.Fu.size<t.vu;){var e=t.Cu.shift(),n=t.Ou.next();t.$u.set(n,new $h(e)),t.Fu=t.Fu.ot(e,n),_h(t.gu,new Bi(Tu(vu(e.path)),n,2,Da.Ls))}}function cc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Su.m()?[3,3]:(n.Su.forEach(function(t,e){o.push(n.Qu(e,s,u).then(function(t){t&&(n.Mu&&n.Vu.Ks(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Pa.Di(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bu.Ro(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ca.forEach(h,function(e){return ca.forEach(e.bi,function(t){return r.persistence.Rr.Cr(n,e.targetId,t)}).next(function(){return ca.forEach(e.Si,function(t){return r.persistence.Rr.$r(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ki.get(o),u=s.nt,u=s.rt(u),r.Ki=r.Ki.ot(o,u));return[2]}})})}(n.Qo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var lc,fc,pc,dc=(qc.prototype.ir=function(t){this.Xu=t},qc.prototype.Ri=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.V())||i.isEqual(Oi.min())?this.Zu(e,r):this.Xu.Ei(e,o).next(function(t){var n=s.tc(r,t);return(gu(r)||mu(r))&&s.wu(r.un,n,o,i)?s.Zu(e,r):(Rr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Du(r)),s.Xu.Ri(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},qc.prototype.tc=function(n,t){var r=new Zi(Vu(n));return t.forEach(function(t,e){e instanceof hu&&Lu(n,e)&&(r=r.add(e))}),r},qc.prototype.wu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.M(r))},qc.prototype.Zu=function(t,e){return Rr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",Du(e)),this.Xu.Ri(t,e,Oi.min())},qc),yc=(Fc.prototype.sc=function(t){return ca.resolve(0===this.li.length)},Fc.prototype.ju=function(t,e,n,r){var i=this.ec;this.ec++,0<this.li.length&&this.li[this.li.length-1],n=new Ua(i,e,n,r),this.li.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.nc=this.nc.add(new hh(u.key,i)),this._i.Qi(t,u.key.path.h())}return ca.resolve(n)},Fc.prototype.Gu=function(t,e){return ca.resolve(this.ic(e))},Fc.prototype.Pr=function(t,e){return e+=1,e=(e=this.rc(e))<0?0:e,ca.resolve(this.li.length>e?this.li[e]:null)},Fc.prototype.zu=function(){return ca.resolve(0===this.li.length?-1:this.ec-1)},Fc.prototype.Ku=function(t){return ca.resolve(this.li.slice())},Fc.prototype.di=function(t,e){var n=this,r=new hh(e,0),e=new hh(e,Number.POSITIVE_INFINITY),i=[];return this.nc.$t([r,e],function(t){t=n.ic(t.Ur),i.push(t)}),ca.resolve(i)},Fc.prototype.Ai=function(t,e){var n=this,r=new Zi(pi);return e.forEach(function(t){var e=new hh(t,0),t=new hh(t,Number.POSITIVE_INFINITY);n.nc.$t([e,t],function(t){r=r.add(t.Ur)})}),ca.resolve(this.oc(r))},Fc.prototype.Vi=function(t,e){var n=e.path,r=n.length+1,e=n;qr.$(e)||(e=e.child(""));var e=new hh(new qr(e),0),i=new Zi(pi);return this.nc.Nt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Ur)),!0)},e),ca.resolve(this.oc(i))},Fc.prototype.oc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.ic(t))&&n.push(t)}),n},Fc.prototype.lr=function(n,r){var i=this;_r(0===this.uc(r.batchId,"removed")),this.li.shift();var o=this.nc;return ca.forEach(r.mutations,function(t){var e=new hh(t.key,r.batchId);return o=o.delete(e),i.Rr.cc(n,t.key)}).next(function(){i.nc=o})},Fc.prototype.ac=function(t){},Fc.prototype.qr=function(t,e){var n=new hh(e,0),n=this.nc.xt(n);return ca.resolve(e.isEqual(n&&n.key))},Fc.prototype._r=function(t){return this.li.length,ca.resolve()},Fc.prototype.uc=function(t,e){return this.rc(t)},Fc.prototype.rc=function(t){return 0===this.li.length?0:t-this.li[0].batchId},Fc.prototype.ic=function(t){return(t=this.rc(t))<0||t>=this.li.length?null:this.li[t]},Fc),vc=(xc.prototype.hr=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.hc(e);return this.docs=this.docs.ot(r,{lc:e,size:o,readTime:n}),this.size+=o-i,this._i.Qi(t,r.path.h())},xc.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},xc.prototype.mi=function(t,e){return e=this.docs.get(e),ca.resolve(e?e.lc:null)},xc.prototype.getEntries=function(t,e){var n=this,r=eo;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.lc:null)}),ca.resolve(r)},xc.prototype.Ri=function(t,e,n){for(var r=io,i=new qr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).lc,a=a.readTime;if(!e.path.T(s.path))break;a.M(n)<=0||u instanceof hu&&Lu(e,u)&&(r=r.ot(u.key,u))}return ca.resolve(r)},xc.prototype._c=function(t,e){return ca.forEach(this.docs,function(t){return e(t)})},xc.prototype.cr=function(t){return new gc(this)},xc.prototype.fc=function(t){return ca.resolve(this.size)},xc),gc=(Object.defineProperty(Mc.prototype,"readTime",{get:function(){return this.wc},set:function(t){this.wc=t},enumerable:!1,configurable:!0}),Mc.prototype.hr=function(t,e){this.mc(),this.readTime=e,this.Wu.set(t.key,t)},Mc.prototype.Ir=function(t,e){this.mc(),e&&(this.readTime=e),this.Wu.set(t,null)},Mc.prototype.mi=function(t,e){this.mc();var n=this.Wu.get(e);return void 0!==n?ca.resolve(n):this.Tc(t,e)},Mc.prototype.getEntries=function(t,e){return this.Ec(t,e)},Mc.prototype.apply=function(t){return this.mc(),this.dc=!0,this.mu(t)},Mc.prototype.mc=function(){},n(Cc,pc=Mc),Cc.prototype.mu=function(n){var r=this,i=[];return this.Wu.forEach(function(t,e){e?i.push(r.Ic.hr(n,e,r.readTime)):r.Ic.Ir(t)}),ca.xn(i)},Cc.prototype.Tc=function(t,e){return this.Ic.mi(t,e)},Cc.prototype.Ec=function(t,e){return this.Ic.getEntries(t,e)},Cc),mc=(Pc.prototype.Ce=function(t,n){return this.Ac.forEach(function(t,e){return n(e)}),ca.resolve()},Pc.prototype.dr=function(t){return ca.resolve(this.lastRemoteSnapshotVersion)},Pc.prototype.gc=function(t){return ca.resolve(this.Rc)},Pc.prototype.Uu=function(t){return this.highestTargetId=this.Pc.next(),ca.resolve(this.highestTargetId)},Pc.prototype.yr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Rc&&(this.Rc=e),ca.resolve()},Pc.prototype.Vc=function(t){this.Ac.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pc=new Ha(e),this.highestTargetId=e),t.sequenceNumber>this.Rc&&(this.Rc=t.sequenceNumber)},Pc.prototype.Bu=function(t,e){return this.Vc(e),this.targetCount+=1,ca.resolve()},Pc.prototype.Er=function(t,e){return this.Vc(e),ca.resolve()},Pc.prototype.vc=function(t,e){return this.Ac.delete(e.target),this.yc.Or(e.targetId),--this.targetCount,ca.resolve()},Pc.prototype.bc=function(n,r,i){var o=this,s=0,u=[];return this.Ac.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ac.delete(t),u.push(o.Sc(n,e.targetId)),s++)}),ca.xn(u).next(function(){return s})},Pc.prototype.Dc=function(t){return ca.resolve(this.targetCount)},Pc.prototype.gr=function(t,e){return e=this.Ac.get(e)||null,ca.resolve(e)},Pc.prototype.mr=function(t,e,n){return this.yc.Fr(e,n),ca.resolve()},Pc.prototype.wr=function(e,t,n){this.yc.kr(t,n);var r=this.persistence.Rr,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),ca.xn(i)},Pc.prototype.Sc=function(t,e){return this.yc.Or(e),ca.resolve()},Pc.prototype.pr=function(t,e){return e=this.yc.Mr(e),ca.resolve(e)},Pc.prototype.qr=function(t,e){return ca.resolve(this.yc.qr(e))},Pc),wc=(jc.prototype.start=function(){return Promise.resolve()},jc.prototype.ni=function(){return this.$c=!1,Promise.resolve()},Object.defineProperty(jc.prototype,"xc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),jc.prototype.kc=function(){},jc.prototype.Oc=function(){},jc.prototype.sr=function(){return this._i},jc.prototype.Ji=function(t){var e=this.Cc[t.Cs()];return e||(e=new yc(this._i,this.Rr),this.Cc[t.Cs()]=e),e},jc.prototype.er=function(){return this.tr},jc.prototype.Zi=function(){return this.hi},jc.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new bc(this.Fc.next());return this.Rr.Lc(),n(i).next(function(t){return r.Rr.Mc(i).next(function(){return t})}).$n().then(function(t){return i.qc(),t})},jc.prototype.Uc=function(e,n){return ca.kn(Object.values(this.Cc).map(function(t){return function(){return t.qr(e,n)}}))},jc),bc=(kc.prototype.Qc=function(t){this.Bc.push(t)},kc.prototype.qc=function(){this.Bc.forEach(function(t){return t()})},n(Uc,fc=kc),Uc),Ec=(_c.Gc=function(t){return new _c(t)},Object.defineProperty(_c.prototype,"zc",{get:function(){if(this.Wc)return this.Wc;throw Vr()},enumerable:!1,configurable:!0}),_c.prototype.Cr=function(t,e,n){return this.jc.Cr(n,e),this.zc.delete(n.toString()),ca.resolve()},_c.prototype.$r=function(t,e,n){return this.jc.$r(n,e),this.zc.add(n.toString()),ca.resolve()},_c.prototype.cc=function(t,e){return this.zc.add(e.toString()),ca.resolve()},_c.prototype.removeTarget=function(t,e){var n=this;this.jc.Or(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.er();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.vc(t,e)})},_c.prototype.Lc=function(){this.Wc=new Set},_c.prototype.Mc=function(n){var r=this,i=this.persistence.Zi().cr();return ca.forEach(this.zc,function(t){var e=qr.D(t);return r.Kc(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Wc=null,i.apply(n)})},_c.prototype.Ar=function(t,e){var n=this;return this.Kc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},_c.prototype.Nc=function(t){return 0},_c.prototype.Kc=function(t,e){var n=this;return ca.kn([function(){return ca.resolve(n.jc.qr(e))},function(){return n.persistence.er().qr(t,e)},function(){return n.persistence.Uc(t,e)}])},_c),Ic=(Vc.prototype.Io=function(t){this.Jc=t},Vc.prototype.do=function(t){this.Xc=t},Vc.prototype.onMessage=function(t){this.Zc=t},Vc.prototype.close=function(){this.Yc()},Vc.prototype.send=function(t){this.Hc(t)},Vc.prototype.ta=function(){this.Jc()},Vc.prototype.ea=function(t){this.Xc(t)},Vc.prototype.na=function(t){this.Zc(t)},Vc),Tc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ac=(Lc.prototype.$o=function(e,t,n,r){var i=this.oa(e,t);return Or("RestConnection","Sending: ",i,n),t={},this.ua(t,r),this.ca(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Lc.prototype.No=function(t,e,n,r){return this.$o(t,e,n,r)},Lc.prototype.ua=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0-20209141635",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},Lc.prototype.oa=function(t,e){return t=Tc[t],this.ia+"/v1/"+e+":"+t},n(Dc,lc=Lc),Dc.prototype.ca=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new Ir(e,t.message))):r(new Ir(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Dc.prototype.Ao=function(t,e){var n,r=[this.ia,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.j};this.ua(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Or("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Ic({Hc:function(t){u?Or("Connection","Not sending because WebChannel is closed:",t):(s||(Or("Connection","Opening WebChannel transport."),o.open(),s=!0),Or("Connection","WebChannel sending:",t),o.send(t))},Yc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Or("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Or("Connection","WebChannel transport closed"),a.ea())}),t(vr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.ea(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(_r(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=qi[r];if(void 0!==t)return Wi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.ea(new Ir(t,i)),o.close()):(Or("Connection","WebChannel received:",e),a.na(e)))}),setTimeout(function(){a.ta()},0),a},Dc),Nc=(Sc.prototype.Jo=function(t){this.fa.push(t)},Sc.prototype.ni=function(){window.removeEventListener("online",this.aa),window.removeEventListener("offline",this.la)},Sc.prototype.da=function(){window.addEventListener("online",this.aa),window.addEventListener("offline",this.la)},Sc.prototype.ha=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(0)},Sc.prototype._a=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(1)},Sc.wa=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Sc),Rc=(Oc.prototype.Jo=function(t){},Oc.prototype.ni=function(){},Oc);function Oc(){}function Sc(){var t=this;this.aa=function(){return t.ha()},this.la=function(){return t._a()},this.fa=[],this.da()}function Dc(t){var e=this;return(e=lc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.j=t.j,e}function Lc(t){this.sa=t,this.B=t.B;var e=t.ssl?"https":"http";this.ia=e+"://"+t.host,this.ra="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Vc(t){this.Hc=t.Hc,this.Yc=t.Yc}function _c(t){this.persistence=t,this.jc=new ah,this.Wc=null}function Uc(t){var e=this;return(e=fc.call(this)||this).Tr=t,e}function kc(){this.Bc=[]}function jc(t){var e=this;this.Cc={},this.Fc=new Da(0),this.$c=!1,this.$c=!0,this.Rr=t(this),this.tr=new mc(this),this._i=new Wa,this.hi=(t=this._i,new vc(t,function(t){return e.Rr.Nc(t)}))}function Pc(t){this.persistence=t,this.Ac=new Ni(Ci,Mi),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Rc=0,this.yc=new ah,this.targetCount=0,this.Pc=Ha.Wi()}function Cc(t){var e=this;return(e=pc.call(this)||this).Ic=t,e}function Mc(){this.Wu=new Ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dc=!1}function xc(t,e){this._i=t,this.hc=e,this.docs=new Qi(qr.i),this.size=0}function Fc(t,e){this._i=t,this.Rr=e,this.li=[],this.ec=1,this.nc=new Zi(hh.br)}function qc(){}function Bc(t){return new Ko(t,!0)}var Gc,zc,Wc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Qc=(il.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Vu=this.ma(e),this.persistence=this.Ta(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ea=this.Ia(e),this.Qo=this.Aa(e),[2]}})})},il.prototype.Ia=function(t){return null},il.prototype.Aa=function(t){return e=this.persistence,n=new dc,t=t.Ra,new Xa(e,n,t);var e,n},il.prototype.Ta=function(t){if(t.persistenceSettings.ya)throw new Ir(Er.FAILED_PRECONDITION,Wc);return new wc(Ec.Gc)},il.prototype.ma=function(t){return new _a},il.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ea&&this.Ea.stop(),[4,this.Vu.ni()];case 1:return t.sent(),[4,this.persistence.ni()];case 2:return t.sent(),[2]}})})},il.prototype.clearPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,Wc)},il),Hc=(rl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.Vu=n.Vu,this.jo=this.Pa(r),this.gu=this.ga(r),this.pu=this.pa(r),this.Va=this.va(r),this.Vu.js=function(t){return rc(e.Va,t,1)},this.gu.Wo.ba=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).li,m=e.nr,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.li.Ku(v).next(function(t){return g=t,n=e.persistence.Ji(o),m=new ja(e.Xi,n,e.persistence.sr()),n.Ku(v)}).next(function(t){for(var e=[],n=[],r=uo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Ei(v,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.li=n,e.nr=m,e.zi.ir(e.nr),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.Vu.ti(o,r.Yu,r.Ju),[4,cc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Va),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ko.delete(2),[4,Dh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ko.add(2),[4,Lh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.gu,this.Va.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},rl.prototype.pa=function(t){return new Ea},rl.prototype.Pa=function(t){var e=Bc(t.sa.B),n=(n=t.sa,new Ac(n));return t=t.credentials,new vh(t,n,e)},rl.prototype.ga=function(t){var e=this;return new ih(this.Qo,this.jo,t.On,function(t){return rc(e.Va,t,0)},t=new(Nc.wa()?Nc:Rc))},rl.prototype.va=function(t){return e=this.Qo,n=this.gu,r=this.pu,i=this.Vu,o=t.Ra,s=t.vu,u=!t.persistenceSettings.ya||!t.persistenceSettings.synchronizeTabs,s=new Jh(e,n,r,i,o,s),u&&(s.Lu=!0),s;var e,n,r,i,o,s,u},rl.prototype.terminate=function(){return Vh(this.gu)},rl),Xc=(nl.prototype.next=function(t){this.observer.next&&this.Sa(this.observer.next,t)},nl.prototype.error=function(t){this.observer.error?this.Sa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},nl.prototype.Da=function(){this.muted=!0},nl.prototype.Sa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},nl),Kc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ir(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Yr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ca=new Fr(t)},Yc=(n(el,zc=Kc),el.documentId=function(){return new el(Fr.v().R())},el.prototype.isEqual=function(t){if(!(t instanceof el))throw ui("isEqual","FieldPath",1,t);return this.Ca.isEqual(t.Ca)},el),$c=new RegExp("[~\\*/\\[\\]]"),Jc=function(t){this.Fa=t},Zc=(n(tl,Gc=Jc),tl.prototype.$a=function(t){if(2!==t.Na)throw 1===t.Na?t.xa(this.Fa+"() can only appear at the top level of your update data"):t.xa(this.Fa+"() cannot be used with set() unless you pass {merge:true}");return t.je.push(t.path),null},tl.prototype.isEqual=function(t){return t instanceof tl},tl);function tl(){return null!==Gc&&Gc.apply(this,arguments)||this}function el(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return zc.call(this,t)||this}function nl(t){this.observer=t,this.muted=!1}function rl(){}function il(){}function ol(t,e,n){return new Sl({Na:3,ka:e.settings.ka,methodName:t.Fa,Oa:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var sl,ul,al,hl,cl=(n(Rl,hl=Jc),Rl.prototype.$a=function(t){return new Ds(t.path,new ys)},Rl.prototype.isEqual=function(t){return t instanceof Rl},Rl),ll=(n(Nl,al=Jc),Nl.prototype.$a=function(t){var e=ol(this,t,!0),n=this.La.map(function(t){return Pl(t,e)}),n=new vs(n);return new Ds(t.path,n)},Nl.prototype.isEqual=function(t){return this===t},Nl),fl=(n(Al,ul=Jc),Al.prototype.$a=function(t){var e=ol(this,t,!0),n=this.La.map(function(t){return Pl(t,e)}),n=new Es(n);return new Ds(t.path,n)},Al.prototype.isEqual=function(t){return this===t},Al),pl=(n(Tl,sl=Jc),Tl.prototype.$a=function(t){var e=new Ns(t.serializer,Jo(t.serializer,this.Ma));return new Ds(t.path,e)},Tl.prototype.isEqual=function(t){return this===t},Tl),dl=(Object.defineProperty(Il.prototype,"latitude",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"longitude",{get:function(){return this.Ua},enumerable:!1,configurable:!0}),Il.prototype.isEqual=function(t){return this.qa===t.qa&&this.Ua===t.Ua},Il.prototype.toJSON=function(){return{latitude:this.qa,longitude:this.Ua}},Il.prototype.Y=function(t){return pi(this.qa,t.qa)||pi(this.Ua,t.Ua)},Il),yl=function(t){this.Ba=t},vl=/^__.*__$/,gl=function(t,e,n){this.Qa=t,this.ja=e,this.Wa=n},ml=(El.prototype.Ga=function(t,e){var n=[];return null!==this.je?n.push(new Bs(t,this.data,this.je,e)):n.push(new qs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Hs(t,this.fieldTransforms)),n},El),wl=(bl.prototype.Ga=function(t,e){return e=[new Bs(t,this.data,this.je,e)],0<this.fieldTransforms.length&&e.push(new Hs(t,this.fieldTransforms)),e},bl);function bl(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function El(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function Il(t,e){if(Hr("GeoPoint",arguments,2),Yr("GeoPoint","number",1,t),Yr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qa=t,this.Ua=e}function Tl(t,e){var n=this;return(n=sl.call(this,t)||this).Ma=e,n}function Al(t,e){var n=this;return(n=ul.call(this,t)||this).La=e,n}function Nl(t,e){var n=this;return(n=al.call(this,t)||this).La=e,n}function Rl(){return null!==hl&&hl.apply(this,arguments)||this}function Ol(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var Sl=(Object.defineProperty(Vl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"Na",{get:function(){return this.settings.Na},enumerable:!1,configurable:!0}),Vl.prototype.Ka=function(t){return new Vl(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.je)},Vl.prototype.Ha=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Ka({path:e,Oa:!1})).Ya(t),e},Vl.prototype.Ja=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Ka({path:t,Oa:!1})).za(),t},Vl.prototype.Xa=function(t){return this.Ka({path:void 0,Oa:!0})},Vl.prototype.xa=function(t){return Bl(t,this.settings.methodName,this.settings.Za||!1,this.path,this.settings.ka)},Vl.prototype.contains=function(e){return void 0!==this.je.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Vl.prototype.za=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ya(this.path.get(t))},Vl.prototype.Ya=function(t){if(0===t.length)throw this.xa("Document fields must not be empty");if(Ol(this.Na)&&vl.test(t))throw this.xa('Document fields cannot begin and end with "__"')},Vl),Dl=(Ll.prototype.th=function(t,e,n,r){return void 0===r&&(r=!1),new Sl({Na:t,methodName:e,ka:n,path:Fr.g(),Oa:!1,Za:r},this.B,this.serializer,this.ignoreUndefinedProperties)},Ll);function Ll(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Bc(t)}function Vl(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.za(),this.fieldTransforms=i||[],this.je=o||[]}function _l(t,e,n,r,i,o){void 0===o&&(o={});var s=t.th(o.merge||o.mergeFields?2:0,e,n,i);xl("Data must be an object, but it was:",s,r);var u,a,r=Cl(r,s);if(o.merge)u=new Ls(s.je),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof Kc)p=f.Ca;else{if("string"!=typeof f)throw Vr();p=ql(e,f,n)}if(!s.contains(p))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Gl(h,p)||h.push(p)}u=new Ls(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new ml(new tu(r),u,a)}function Ul(t,r,i,e){var o=t.th(1,r,i);xl("Data must be an object, but it was:",o,e);var s=[],u=new eu;return kr(e,function(t,e){var n=ql(r,t,i),t=o.Ja(n);e instanceof Zc||e instanceof yl&&e.Ba instanceof Zc?s.push(n):null!=(t=Pl(e,t))&&(s.push(n),u.set(n,t))}),e=new Ls(s),new wl(u.Xe(),e,o.fieldTransforms)}function kl(t,e,n,r,i,o){var s=t.th(1,e,n),u=[Fl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Fl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new eu,y=u.length-1;0<=y;--y)Gl(p,u[y])||(c=u[y],l=a[y],f=s.Ja(c),l instanceof Zc||l instanceof yl&&l.Ba instanceof Zc?p.push(c):null!=(f=Pl(l,f))&&(p.push(c),d.set(c,f)));return i=new Ls(p),new wl(d.Xe(),i,s.fieldTransforms)}function jl(t,e,n,r){return void 0===r&&(r=!1),Pl(n,t.th(r?4:3,e))}function Pl(s,t){if(s instanceof yl&&(s=s.Ba),Ml(s))return xl("Unsupported field value:",t,s),Cl(s,t);if(s instanceof Jc)return function(t,e){if(!Ol(e.Na))throw e.xa(t.Fa+"() can only be used with update() and set()");if(!e.path)throw e.xa(t.Fa+"() is not currently supported inside arrays");(t=t.$a(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.je.push(t.path),s instanceof Array){if(t.settings.Oa&&4!==t.Na)throw t.xa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Pl(i[r],t.Xa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Jo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ri.fromDate(t);return{timestampValue:Zo(e.serializer,n)}}if(t instanceof Ri){var r=new Ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Zo(e.serializer,r)}}if(t instanceof dl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gi)return{bytesValue:ts(e.serializer,t.U)};if(t instanceof gl){if(n=e.B,!(r=t.Qa).isEqual(n))throw e.xa("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ns(t.Qa||e.B,t.ja.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.xa("Unsupported field value: "+ii(t))}(s,t)}function Cl(t,n){var r={};return jr(t)?n.path&&0<n.path.length&&n.je.push(n.path):kr(t,function(t,e){null!=(e=Pl(e,n.Ha(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ml(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ri||t instanceof dl||t instanceof gi||t instanceof gl||t instanceof Jc)}function xl(t,e,n){if(!Ml(n)||!ri(n))throw"an object"===(n=ii(n))?e.xa(t+" a custom object"):e.xa(t+" "+n)}function Fl(t,e,n){if(e instanceof Kc)return e.Ca;if("string"==typeof e)return ql(t,e);throw Bl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ql(t,e,n){try{return function(e){if(0<=e.search($c))throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Yc.bind.apply(Yc,i([void 0],e.split("."))))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ca}catch(e){throw Bl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Bl(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ir(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function Gl(t,e){return t.some(function(t){return t.isEqual(e)})}var zl=(Kl.prototype.rh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),0<this.mutations.length)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=ss((i=s).serializer)+"/documents",n={documents:u.map(function(t){return rs(i.serializer,t)})},[4,i.No("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=is(t,e.found.name),t=es(e.found.updateTime),e=new tu({mapValue:{fields:e.found.fields}});return new hu(n,t,e,{})}(e,t):"missing"in t?(n=e,_r(!!(r=t).missing),_r(!!r.readTime),n=is(n,r.missing),r=es(r.readTime),new cu(n,r)):Vr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){_r(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof cu||t instanceof hu?n.uh(t):Vr()}),e)]}})})},Kl.prototype.set=function(t,e){this.write(e.Ga(t,this.ze(t))),this.ih.add(t.toString())},Kl.prototype.update=function(t,e){try{this.write(e.Ga(t,this.ah(t)))}catch(t){this.sh=t}this.ih.add(t.toString())},Kl.prototype.delete=function(t){this.write([new Js(t,this.ze(t))]),this.ih.add(t.toString())},Kl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),this.sh)throw this.sh;return e=this.eh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=qr.D(e),n.mutations.push(new Zs(e,n.ze(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ss((e=i).serializer)+"/documents",r={writes:o.map(function(t){return as(e.serializer,t)})},[4,e.$o("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.nh=!0,[2]}})})},Kl.prototype.uh=function(t){var e;if(t instanceof hu)e=t.version;else{if(!(t instanceof cu))throw Vr();e=Oi.min()}var n=this.eh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.eh.set(t.key.toString(),e)},Kl.prototype.ze=function(t){var e=this.eh.get(t.toString());return!this.ih.has(t.toString())&&e?Us.updateTime(e):Us.Ye()},Kl.prototype.ah=function(t){var e=this.eh.get(t.toString());if(this.ih.has(t.toString())||!e)return Us.exists(!0);if(e.isEqual(Oi.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Us.updateTime(e)},Kl.prototype.write=function(t){this.oh(),this.mutations=this.mutations.concat(t)},Kl.prototype.oh=function(){},Kl),Wl=(Xl.prototype.run=function(){this.lh()},Xl.prototype.lh=function(){var t=this;this.Xn.yn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new zl(this.jo),(n=this._h(e))&&n.then(function(t){r.On.jn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.fh(t)})})}).catch(function(t){r.fh(t)}),[2]})})})},Xl.prototype._h=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},Xl.prototype.fh=function(t){var e=this;0<this.hh&&this.dh(t)?(--this.hh,this.On.jn(function(){return e.lh(),Promise.resolve()})):this.qn.reject(t)},Xl.prototype.dh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!zi(t))},Xl),Ql=(Hl.prototype.start=function(t,e,n,r){var i=this;this.mh(),this.sa=t;var o=new aa,s=!1;return this.credentials.Wr(function(t){return s?void i.On.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.hs(),Or("RemoteStore","RemoteStore received new credentials"),n=Mh(e),e.Ko.add(3),[4,Lh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Wo.ba(i)];case 2:return t.sent(),e.Ko.delete(3),[4,Dh(e)];case 3:return t.sent(),[2]}})})}(i.gu,t)}):(s=!0,Or("FirestoreClient","Initializing. user=",t.uid),i.Th(e,n,r,t,o).then(i.wh.resolve,i.wh.reject))}),this.On.jn(function(){return i.wh.promise}),o.promise},Hl.prototype.enableNetwork=function(){var e=this;return this.mh(),this.On.enqueue(function(){return e.persistence.Oc(!0),(t=e.gu).Ko.delete(0),Dh(t);var t})},Hl.prototype.Th=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,sa:this.sa,clientId:this.clientId,credentials:this.credentials,Ra:s,vu:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Vu=r.Vu,this.Qo=r.Qo,this.Ea=r.Ea,this.jo=i.jo,this.gu=i.gu,this.Va=i.Va,this.Eh=i.pu,this.Eh.Is=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).gu.Wo.eu=nc.bind(null,e),e.gu.Wo.Ue=function(t,e){var n=t;if((t=n.$u.get(e))&&t.Pu)return uo().add(t.key);var r=uo();if(!(e=n.Du.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Su.get(s),r=r.kt(s.view.lu);return r}.bind(null,e),e.gu.Wo.tu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vu.Ks(s,"rejected",u),i=e.$u.get(s),(n=i&&i.key)?(r=(r=new Qi(qr.i)).ot(n,new cu(n,Oi.min())),i=uo().add(n),i=new fo(Oi.min(),new Map,new Zi(pi),r,i),[4,nc(e,i)]):[3,2];case 1:return t.sent(),e.Fu=e.Fu.remove(n),e.$u.delete(s),hc(e),[3,4];case 2:return[4,th(e.Qo,s,!1).then(function(){return sc(e,s,u)}).catch(nh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.bu.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Ts.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&Aa(n)}.bind(null,e.pu),e.bu.qu=function(t,e,n){var r=t;if(t=r.Ts.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ts.delete(e)}.bind(null,e.pu),(a=(n=e).Su.get(c))?(o=a.targetId,n.Vu.zs(o),s=a.view.yu(),[3,4]):[3,1];case 1:return[4,(e=n.Qo,r=Tu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.tr.gr(e,r).next(function(t){return t?(n=t,ca.resolve(n)):i.tr.Uu(e).next(function(t){return n=new Bi(r,t,0,e.Tr),i.tr.Bu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ki.get(t.targetId);return(null===e||0<t.nt.M(e.nt))&&(i.Ki=i.Ki.ot(t.targetId,t),i.Hi.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Vu.zs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view._u(o)).wu?[4,eh(r.Qo,i.query,!1).then(function(t){return t=t.documents,i.view._u(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Kt.get(i.targetId),n=i.view.mu(e,r.Mu,n),[2,(ac(r,i.targetId,n.Iu),n.snapshot)]}})})}(i,t,e,n)},[4,eh(i.Qo,o,!0)];case 1:return n=t.sent(),r=new Yh(o,n.Vr),e=r._u(n.documents),n=po.Zt(s,u&&"Offline"!==i.onlineState),n=r.mu(e,i.Mu,n),ac(i,s,n.Iu),r=new Hh(o,s,r),i.Su.set(o,r),i.Du.has(s)?i.Du.get(s).push(o):i.Du.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Mu&&_h(n.gu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,this.Va),this.Eh.ys=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Su.get(o),1<(r=e.Du.get(n.targetId)).length?[2,(e.Du.set(n.targetId,r.filter(function(t){return!Ou(t,o)})),void e.Su.delete(o))]:e.Mu?(e.Vu.Hs(n.targetId),e.Vu.Zs(n.targetId)?[3,2]:[4,th(e.Qo,n.targetId,!1).then(function(){e.Vu.Js(n.targetId),Uh(e.gu,n.targetId),sc(e,n.targetId)}).catch(nh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return sc(e,n.targetId),[4,th(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.Va),this.persistence.kc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Ih(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Th(new Qc,new Hc,{ya:!1},s,u))];case 4:return[2]}})})},Hl.prototype.Ih=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Hl.prototype.mh=function(){if(this.On.ts)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},Hl.prototype.disableNetwork=function(){var t=this;return this.mh(),this.On.enqueue(function(){return t.persistence.Oc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(0),[4,Lh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.gu)})},Hl.prototype.terminate=function(){var t=this;this.On.rs();var n=new aa;return this.On.es(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ea&&this.Ea.stop(),[4,Vh(this.gu)];case 1:return t.sent(),[4,this.Vu.ni()];case 2:return t.sent(),[4,this.persistence.ni()];case 3:return t.sent(),this.credentials.Gr(),n.resolve(),[3,5];case 4:return e=wa(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Hl.prototype.waitForPendingWrites=function(){var t=this;this.mh();var e=new aa;return this.On.jn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Mh((n=o).gu)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.li.zu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ku.get(r)||[]).push(s),n.ku.set(r,i),[3,4]);case 3:return i=wa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.Va,e)}),e.promise},Hl.prototype.listen=function(t,e,n){var r=this;this.mh();var i=new Xc(n),o=new Na(t,i,e);return this.On.jn(function(){return Ia(r.Eh,o)}),function(){i.Da(),r.On.jn(function(){return Ta(r.Eh,o)})}},Hl.prototype.Ah=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new aa,[2,(this.On.jn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.nr.fi(t,e)}))];case 1:return(r=t.sent())instanceof hu?s.resolve(r):r instanceof cu?s.resolve(null):s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=wa(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Qo,r,e)}),e.promise)]}})})},Hl.prototype.Rh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new aa,[2,(this.On.jn(function(){return n=a.Eh,r=a.On,i=h,o=c,s=e,t=new Xc({next:function(t){r.jn(function(){return Ta(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Na(vu(i.path),t,{includeMetadataChanges:!0,Ss:!0}),Ia(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Hl.prototype.yh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new aa,[2,(this.On.jn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,eh(r,i,!0)];case 1:return n=t.sent(),e=new Yh(i,n.Vr),n=e._u(n.documents),n=e.mu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=wa(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Qo,r,e)}),e.promise)]}})})},Hl.prototype.Ph=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),u=new aa,[2,(this.On.jn(function(){return e=a.Eh,n=a.On,t=h,r=c,i=u,o=new Xc({next:function(t){n.jn(function(){return Ta(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Na(t,o,{includeMetadataChanges:!0,Ss:!0}),Ia(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Hl.prototype.write=function(t){var e=this;this.mh();var n=new aa;return this.On.jn(function(){return ec(e.Va,t,n)}),n.promise},Hl.prototype.B=function(){return this.sa.B},Hl.prototype.gh=function(t){var e=this;this.mh();var r=new Xc(t);return this.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Eh,n=r,e.Es.add(n),void n.next())];var e,n})})}),function(){r.Da(),e.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Eh.Es.delete(r)]})})})}},Object.defineProperty(Hl.prototype,"ph",{get:function(){return this.On.ts},enumerable:!1,configurable:!0}),Hl.prototype.transaction=function(t){var e=this;this.mh();var n=new aa;return this.On.jn(function(){return new Wl(e.On,e.jo,t,n).run(),Promise.resolve()}),n.promise},Hl);function Hl(t,e){this.credentials=t,this.On=e,this.clientId=li.k(),this.wh=new aa}function Xl(t,e,n,r){this.On=t,this.jo=e,this.updateFunction=n,this.qn=r,this.hh=5,this.Xn=new ha(this.On,"transaction_retry")}function Kl(t){this.jo=t,this.eh=new Map,this.mutations=[],this.nh=!1,this.sh=null,this.ih=new Set}function Yl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var $l,Jl,Zl=(mf.prototype.Dh=function(t){switch(_o(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xo(t.integerValue||t.doubleValue);case 3:return this.Ch(t.timestampValue);case 4:return this.Fh(t);case 5:return t.stringValue;case 6:return this.Sh(Fo(t.bytesValue));case 7:return this.$h(t.referenceValue);case 8:return this.Nh(t.geoPointValue);case 9:return this.xh(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Vr()}},mf.prototype.kh=function(t){var n=this,r={};return kr(t.fields||{},function(t,e){r[t]=n.Dh(e)}),r},mf.prototype.Nh=function(t){return new dl(xo(t.latitude),xo(t.longitude))},mf.prototype.xh=function(t){var e=this;return(t.values||[]).map(function(t){return e.Dh(t)})},mf.prototype.Fh=function(t){switch(this.Vh){case"previous":var e=function t(e){return Do(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.Dh(e);case"estimate":return this.Ch(Lo(t));default:return null}},mf.prototype.Ch=function(t){return t=Mo(t),t=new Ri(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},mf.prototype.$h=function(t){var e=Mr.P(t);return _r(ls(e)),t=new Ai(e.get(1),e.get(3)),e=new qr(e.u(5)),t.isEqual(this.B)||Sr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.bh(e)},mf),tf=Ca.Oi,ef=(gf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},gf),nf=(Object.defineProperty(vf.prototype,"zh",{get:function(){return this.Kh||(this.Kh=new Dl(this.Qa,this.Gh.ignoreUndefinedProperties)),this.Kh},enumerable:!1,configurable:!0}),vf.prototype.settings=function(t){if(Hr("Firestore.settings",arguments,1),Yr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Gh),t)).merge,t=new ef(t),this.Bh&&!this.Gh.isEqual(t))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Gh=t).credentials&&(this.Wh=function(t){if(!t)return new ch;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ph(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},vf.prototype.enableNetwork=function(){return this.Uh(),this.Bh.enableNetwork()},vf.prototype.disableNetwork=function(){return this.Uh(),this.Bh.disableNetwork()},vf.prototype.enablePersistence=function(t){var e;if(this.Bh)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Sr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ir(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hh(this.Oh,this.Lh,{ya:!0,cacheSizeBytes:this.Gh.cacheSizeBytes,synchronizeTabs:n,Yh:r})},vf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Bh&&!this.Bh.ph)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new aa,[2,(this.qh.es(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Oh.clearPersistence(this.Qa,this.jh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},vf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(vf.prototype,"Jh",{get:function(){return this.Uh(),this.Bh.ph},enumerable:!1,configurable:!0}),vf.prototype.waitForPendingWrites=function(){return this.Uh(),this.Bh.waitForPendingWrites()},vf.prototype.onSnapshotsInSync=function(t){return this.Uh(),Yl(t)||(Yr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Bh.gh(t)},vf.prototype.Uh=function(){return this.Bh||this.Hh(new Qc,new Hc,{ya:!1}),this.Bh},vf.prototype.Xh=function(){return new Ei(this.Qa,this.jh,this.Gh.host,this.Gh.ssl,this.Gh.experimentalForceLongPolling,this.Gh.experimentalAutoDetectLongPolling)},vf.prototype.Hh=function(t,e,n){var r=this.Xh();return this.Bh=new Ql(this.Wh,this.qh),this.Bh.start(r,t,e,n)},vf.Qh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ai(t)},Object.defineProperty(vf.prototype,"app",{get:function(){if(!this.Mh)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Mh},enumerable:!1,configurable:!0}),vf.prototype.collection=function(t){return Hr("Firestore.collection",arguments,1),Yr("Firestore.collection","non-empty string",1,t),this.Uh(),new Rf(Mr.P(t),this,null)},vf.prototype.doc=function(t){return Hr("Firestore.doc",arguments,1),Yr("Firestore.doc","non-empty string",1,t),this.Uh(),sf.Zh(Mr.P(t),this,null)},vf.prototype.collectionGroup=function(t){if(Hr("Firestore.collectionGroup",arguments,1),Yr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Uh(),new Af((t=t,new fu(Mr.g(),t)),this,null)},vf.prototype.runTransaction=function(e){var n=this;return Hr("Firestore.runTransaction",arguments,1),Yr("Firestore.runTransaction","function",1,e),this.Uh().transaction(function(t){return e(new rf(n,t))})},vf.prototype.batch=function(){return this.Uh(),new of(this)},Object.defineProperty(vf,"logLevel",{get:function(){switch(Rr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),vf.setLogLevel=function(t){Hr("Firestore.setLogLevel",arguments,1),ei("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},vf.prototype.tl=function(){return this.Gh.timestampsInSnapshots},vf.prototype.el=function(){return this.Gh},vf),rf=(yf.prototype.get=function(t){var e=this;Hr("Transaction.get",arguments,1);var n=Uf("Transaction.get",t,this.nl);return this.sl.rh([n.ja]).then(function(t){if(!t||1!==t.length)return Vr();if((t=t[0])instanceof cu)return new af(e.nl,n.ja,null,!1,!1,n.Wa);if(t instanceof hu)return new af(e.nl,n.ja,t,!1,!1,n.Wa);throw Vr()})},yf.prototype.set=function(t,e,n){return Kr("Transaction.set",arguments,2,3),t=Uf("Transaction.set",t,this.nl),n=Lf("Transaction.set",n),e=kf(t.Wa,e,n),n=_l(this.nl.zh,"Transaction.set",t.ja,e,null!==t.Wa,n),this.sl.set(t.ja,n),this},yf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Yc?(Xr("Transaction.update",arguments,3),r=Uf("Transaction.update",t,this.nl),kl(this.nl.zh,"Transaction.update",r.ja,e,n,i)):(Hr("Transaction.update",arguments,2),r=Uf("Transaction.update",t,this.nl),Ul(this.nl.zh,"Transaction.update",r.ja,e)),this.sl.update(r.ja,e),this},yf.prototype.delete=function(t){return Hr("Transaction.delete",arguments,1),t=Uf("Transaction.delete",t,this.nl),this.sl.delete(t.ja),this},yf),of=(df.prototype.set=function(t,e,n){return Kr("WriteBatch.set",arguments,2,3),this.ol(),t=Uf("WriteBatch.set",t,this.nl),n=Lf("WriteBatch.set",n),e=kf(t.Wa,e,n),n=_l(this.nl.zh,"WriteBatch.set",t.ja,e,null!==t.Wa,n),this.il=this.il.concat(n.Ga(t.ja,Us.Ye())),this},df.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ol(),e="string"==typeof e||e instanceof Yc?(Xr("WriteBatch.update",arguments,3),r=Uf("WriteBatch.update",t,this.nl),kl(this.nl.zh,"WriteBatch.update",r.ja,e,n,i)):(Hr("WriteBatch.update",arguments,2),r=Uf("WriteBatch.update",t,this.nl),Ul(this.nl.zh,"WriteBatch.update",r.ja,e)),this.il=this.il.concat(e.Ga(r.ja,Us.exists(!0))),this},df.prototype.delete=function(t){return Hr("WriteBatch.delete",arguments,1),this.ol(),t=Uf("WriteBatch.delete",t,this.nl),this.il=this.il.concat(new Js(t.ja,Us.Ye())),this},df.prototype.commit=function(){return this.ol(),this.rl=!0,0<this.il.length?this.nl.Uh().write(this.il):Promise.resolve()},df.prototype.ol=function(){if(this.rl)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},df),sf=(n(pf,Jl=gl),pf.Zh=function(t,e,n){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new pf(new qr(t),e,n)},Object.defineProperty(pf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"parent",{get:function(){return new Rf(this.ja.path.h(),this.firestore,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"path",{get:function(){return this.ja.path.R()},enumerable:!1,configurable:!0}),pf.prototype.collection=function(t){if(Hr("DocumentReference.collection",arguments,1),Yr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Mr.P(t),new Rf(this.ja.path.child(t),this.firestore,null)},pf.prototype.isEqual=function(t){if(!(t instanceof pf))throw ui("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ja.isEqual(t.ja)&&this.Wa===t.Wa},pf.prototype.set=function(t,e){return Kr("DocumentReference.set",arguments,1,2),e=Lf("DocumentReference.set",e),t=kf(this.Wa,t,e),e=_l(this.firestore.zh,"DocumentReference.set",this.ja,t,null!==this.Wa,e),this.Bh.write(e.Ga(this.ja,Us.Ye()))},pf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Yc?(Xr("DocumentReference.update",arguments,2),kl(this.firestore.zh,"DocumentReference.update",this.ja,t,e,n)):(Hr("DocumentReference.update",arguments,1),Ul(this.firestore.zh,"DocumentReference.update",this.ja,t)),this.Bh.write(t.Ga(this.ja,Us.exists(!0)))},pf.prototype.delete=function(){return Hr("DocumentReference.delete",arguments,0),this.Bh.write([new Js(this.ja,Us.Ye())])},pf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Kr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Yl(n[i])||(si("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),Zr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Yl(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Yr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.ul(t))},error:n[i+1],complete:n[i+2]};return this.Bh.listen(vu(this.ja.path),o,s)},pf.prototype.get=function(t){var e=this;Kr("DocumentReference.get",arguments,0,1),_f("DocumentReference.get",t);var n=this.firestore.Uh();return t&&"cache"===t.source?n.Ah(this.ja).then(function(t){return new af(e.firestore,e.ja,t,!0,t instanceof hu&&t.Je,e.Wa)}):n.Rh(this.ja,t).then(function(t){return e.ul(t)})},pf.prototype.withConverter=function(t){return new pf(this.ja,this.firestore,t)},pf.prototype.ul=function(t){var e=t.docs.get(this.ja);return new af(this.firestore,this.ja,e,t.fromCache,t.hasPendingWrites,this.Wa)},pf),uf=(ff.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ff),af=(lf.prototype.data=function(t){var e=this;if(Kr("DocumentSnapshot.data",arguments,0,1),t=Vf("DocumentSnapshot.data",t),this.cl){if(this.Wa){var n=new hf(this.nl,this.ja,this.cl,this.al,this.hl,null);return this.Wa.fromFirestore(n,t)}return new Zl(this.nl.Qa,this.nl.tl(),t.serverTimestamps||"none",function(t){return new sf(t,e.nl,null)},function(t){return new Ti(t)}).Dh(this.cl.rn())}},lf.prototype.get=function(t,e){var n=this;if(Kr("DocumentSnapshot.get",arguments,1,2),e=Vf("DocumentSnapshot.get",e),this.cl&&null!==(t=this.cl.data().field(Fl("DocumentSnapshot.get",t,this.ja))))return new Zl(this.nl.Qa,this.nl.tl(),e.serverTimestamps||"none",function(t){return new sf(t,n.nl,n.Wa)},function(t){return new Ti(t)}).Dh(t)},Object.defineProperty(lf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"ref",{get:function(){return new sf(this.ja,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"exists",{get:function(){return null!==this.cl},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"metadata",{get:function(){return new uf(this.hl,this.al)},enumerable:!1,configurable:!0}),lf.prototype.isEqual=function(t){if(!(t instanceof lf))throw ui("isEqual","DocumentSnapshot",1,t);return this.nl===t.nl&&this.al===t.al&&this.ja.isEqual(t.ja)&&(null===this.cl?null===t.cl:this.cl.isEqual(t.cl))&&this.Wa===t.Wa},lf),hf=(n(cf,$l=af),cf.prototype.data=function(t){return $l.prototype.data.call(this,t)},cf);function cf(){return null!==$l&&$l.apply(this,arguments)||this}function lf(t,e,n,r,i,o){this.nl=t,this.ja=e,this.cl=n,this.al=r,this.hl=i,this.Wa=o}function ff(t,e){this.hasPendingWrites=t,this.fromCache=e}function pf(t,e,n){var r=this;return(r=Jl.call(this,e.Qa,t,n)||this).ja=t,r.firestore=e,r.Wa=n,r.Bh=r.firestore.Uh(),r}function df(t){this.nl=t,this.il=[],this.rl=!1}function yf(t,e){this.nl=t,this.sl=e}function vf(t,e,n,r){var i=this;if(void 0===n&&(n=new Qc),void 0===r&&(r=new Hc),this.Oh=n,this.Lh=r,this.Mh=null,this.qh=new va,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Uh(),[4,this.Bh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.Mh=r,this.Qa=vf.Qh(r),this.jh=r.name,this.Wh=new lh(e);else{if(!(t=t).projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.Qa=new Ai(t.projectId,t.database),this.jh="[DEFAULT]",this.Wh=new ch}this.Gh=new ef({})}function gf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Jr("settings","non-empty string","host",t.host),this.host=t.host,Zr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(si("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),Zr("settings","object","credentials",t.credentials),this.credentials=t.credentials,Zr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Zr("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Sr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Sr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,Zr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ca.Mi;else{if(t.cacheSizeBytes!==tf&&t.cacheSizeBytes<Ca.Li)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ca.Li);this.cacheSizeBytes=t.cacheSizeBytes}Zr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,Zr("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Ir(Er.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function mf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.Vh=n,this.bh=r,this.Sh=i}function wf(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eu(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Mr.P(n)),!qr.$(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qo(t,new qr(e))}if(n instanceof gl)return qo(t,n.ja);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ii(n)+".")}function bf(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Ef(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function If(t){if(mu(t)&&0===t.on.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tf,Af=(Df.prototype.where=function(t,e,n){return Hr("Query.where",arguments,3),oi("Query.where",3,n),e=ei("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Fl("Query.where",t),e=function(t,e,n,r,i,o){if(r.V()){if("array-contains"===i||"array-contains-any"===i)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){bf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(wf(n,t,h))}c={arrayValue:{values:s}}}else c=wf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||bf(o,i),c=jl(e,"Query.where",o,"in"===i||"not-in"===i);var c=Uu.create(r,i,c);return function(t,e){if(e.hn()){var n=bu(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=wu(t))&&Ef(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.ll,this.firestore.zh,this.firestore.Qa,t,e,n),new Df((e=(n=this.ll).filters.concat([e]),new fu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Df.prototype.orderBy=function(t,e){if(Kr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Fl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ua(e,n);return e=r,null!==wu(n=t)||null!==(t=bu(n))&&Ef(0,t,e.field),r}(this.ll,t,n);return new Df((t=(n=this.ll).on.concat([t]),new fu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Df.prototype.limit=function(t){return Hr("Query.limit",arguments,1),Yr("Query.limit","number",1,t),ai("Query.limit",1,t),new Df(Au(this.ll,t,"F"),this.firestore,this.Wa)},Df.prototype.limitToLast=function(t){return Hr("Query.limitToLast",arguments,1),Yr("Query.limitToLast","number",1,t),ai("Query.limitToLast",1,t),new Df(Au(this.ll,t,"L"),this.firestore,this.Wa)},Df.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAt",arguments,1),t=this._l("Query.startAt",t,e,!0),new Df(Nu(this.ll,t),this.firestore,this.Wa)},Df.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAfter",arguments,1),t=this._l("Query.startAfter",t,e,!1),new Df(Nu(this.ll,t),this.firestore,this.Wa)},Df.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endBefore",arguments,1),t=this._l("Query.endBefore",t,e,!0),new Df(Ru(this.ll,t),this.firestore,this.Wa)},Df.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endAt",arguments,1),t=this._l("Query.endAt",t,e,!1),new Df(Ru(this.ll,t),this.firestore,this.Wa)},Df.prototype.isEqual=function(t){if(!(t instanceof Df))throw ui("isEqual","Query",1,t);return this.firestore===t.firestore&&Ou(this.ll,t.ll)&&this.Wa===t.Wa},Df.prototype.withConverter=function(t){return new Df(this.ll,this.firestore,t)},Df.prototype._l=function(h,t,e,n){return oi(h,1,t),t instanceof af?(Hr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Iu(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(qo(e,n.key));else{var a=n.field(u.field);if(Do(a))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Zu(i,r)}(this.ll,this.firestore.Qa,t.cl,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Eu(t)&&-1!==h.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Mr.P(h));if(!qr.$(c))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new qr(c),u.push(qo(e,c))}else h=jl(n,r,h),u.push(h)}return new Zu(u,o)}(this.ll,this.firestore.Qa,this.firestore.zh,h,e,n))},Df.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Kr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Yl(n[o])||(si("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),Zr("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Yl(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Yr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Nf(e.firestore,e.ll,t,e.Wa))},error:n[o+1],complete:n[o+2]};return If(this.ll),this.firestore.Uh().listen(this.ll,i,s)},Df.prototype.get=function(t){var e=this;Kr("Query.get",arguments,0,1),_f("Query.get",t),If(this.ll);var n=this.firestore.Uh();return(t&&"cache"===t.source?n.yh(this.ll):n.Ph(this.ll,t)).then(function(t){return new Nf(e.firestore,e.ll,t,e.Wa)})},Df),Nf=(Object.defineProperty(Sf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"empty",{get:function(){return this.dl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"size",{get:function(){return this.dl.docs.size},enumerable:!1,configurable:!0}),Sf.prototype.forEach=function(e,n){var r=this;Kr("QuerySnapshot.forEach",arguments,1,2),Yr("QuerySnapshot.forEach","function",1,e),this.dl.docs.forEach(function(t){e.call(n,r.Tl(t,r.metadata.fromCache,r.dl.jt.has(t.key)))})},Object.defineProperty(Sf.prototype,"query",{get:function(){return new Af(this.fl,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Sf.prototype.docChanges=function(t){if(t&&(si("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Zr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.dl.Gt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.wl&&this.ml===t||(this.wl=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.dl,t,this.Tl.bind(this)),this.ml=t),this.wl},Sf.prototype.isEqual=function(t){if(!(t instanceof Sf))throw ui("isEqual","QuerySnapshot",1,t);return this.nl===t.nl&&Ou(this.fl,t.fl)&&this.dl.isEqual(t.dl)&&this.Wa===t.Wa},Sf.prototype.Tl=function(t,e,n){return new hf(this.nl,t.key,t,e,n,this.Wa)},Sf),Rf=(n(Of,Tf=Af),Object.defineProperty(Of.prototype,"id",{get:function(){return this.ll.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"parent",{get:function(){var t=this.ll.path.h();return t.m()?null:new sf(new qr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"path",{get:function(){return this.ll.path.R()},enumerable:!1,configurable:!0}),Of.prototype.doc=function(t){return Kr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=li.k()),Yr("CollectionReference.doc","non-empty string",1,t),t=Mr.P(t),sf.Zh(this.ll.path.child(t),this.firestore,this.Wa)},Of.prototype.add=function(t){Hr("CollectionReference.add",arguments,1),Yr("CollectionReference.add","object",1,t=this.Wa?this.Wa.toFirestore(t):t);var e=this.doc();return new sf(e.ja,this.firestore,null).set(t).then(function(){return e})},Of.prototype.withConverter=function(t){return new Of(this.El,this.firestore,t)},Of);function Of(t,e,n){var r=this;if(((r=Tf.call(this,vu(t),e,n)||this).El=t).length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Sf(t,e,n,r){this.nl=t,this.fl=e,this.dl=n,this.Wa=r,this.wl=null,this.ml=null,this.metadata=new uf(n.hasPendingWrites,n.fromCache)}function Df(t,e,n){this.ll=t,this.firestore=e,this.Wa=n}function Lf(t,e){if(void 0===e)return{merge:!1};if(si(t,e,["merge","mergeFields"]),Zr(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ii(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Yc))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ii(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Vf(t,e){return void 0===e?{}:(si(t,e,["serverTimestamps"]),ti(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function _f(t,e){$r(t,"object",1,e),e&&(si(t,e,["source"]),ti(t,0,"source",e.source,["default","server","cache"]))}function Uf(t,e,n){if(e instanceof gl){if(e.firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ui(t,"DocumentReference",1,e)}function kf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var jf,Pf,l=(n(Mf,jf=yl),Mf.serverTimestamp=function(){Qr("FieldValue.serverTimestamp",arguments);var t=new cl("serverTimestamp");return t.Fa="FieldValue.serverTimestamp",new Mf(t)},Mf.delete=function(){Qr("FieldValue.delete",arguments);var t=new Zc("deleteField");return t.Fa="FieldValue.delete",new Mf(t)},Mf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new ll("arrayUnion",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayUnion",new Mf(n)},Mf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new fl("arrayRemove",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayRemove",new Mf(n)},Mf.increment=function(t){return Yr("FieldValue.increment","number",1,t),Hr("FieldValue.increment",arguments,1),(t=new pl("increment",t)).Fa="FieldValue.increment",new Mf(t)},Mf.prototype.isEqual=function(t){return this.Ba.isEqual(t.Ba)},Mf),Cf={Firestore:nf,GeoPoint:dl,Timestamp:Ri,Blob:Ti,Transaction:rf,WriteBatch:of,DocumentReference:sf,DocumentSnapshot:af,Query:Af,QueryDocumentSnapshot:hf,QuerySnapshot:Nf,CollectionReference:Rf,FieldPath:Yc,FieldValue:l,setLogLevel:nf.setLogLevel,CACHE_SIZE_UNLIMITED:tf};function Mf(){return null!==jf&&jf.apply(this,arguments)||this}(Pf=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new nf(e,t,new Qc,new Hc);var e},"PUBLIC").setServiceProps(Object.assign({},Cf))),Pf.registerVersion("@firebase/firestore","1.18.0-20209141635")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});