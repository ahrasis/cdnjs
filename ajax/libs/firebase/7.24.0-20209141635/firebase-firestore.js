!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(my){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(my),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=l=l||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},D=N||self;function x(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++P))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){J=J.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=x;var rt,it=X(W,"Opera"),ot=X(W,"Trident")||X(W,"MSIE"),st=X(W,"Edge"),ut=st||ot,at=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ct=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=W,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=D.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",x,e),D.removeEventListener("test",x,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Lt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ft(r);return e&&e[It]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[It]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Vt(t);if(c||(t[xt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(St(n,t),0==n.b&&(n.src=null,e[xt]=null)):At(t)))}function Pt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(vt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function Vt(t){return(t=t[xt])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==L(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new Nt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Ft(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=D.JSON.stringify;function Bt(){this.b=this.a=null}var zt,Ht=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Wt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Qt(t,e){var n;zt||(n=D.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Xt||(zt(),Xt=!0),Yt.add(t,e)}Bt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||D,this.f=V(this.Ya,this),this.g=F()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==L(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},A.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe=null;function de(){return pe=pe||new jt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}j(ye,wt),j(ge,wt),j(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Te.prototype.a=null;var Ne,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function xe(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=ke,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Se,wt),j(De,wt),j(xe,Te),Ne=new xe;var ke=45e3,Oe={},Re={};function Pe(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Ce(t,null)}function Ce(t,e){t.u=F(),Ve(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?Oe:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,me(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Oe){t.h=4,me(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),je(t))}function Ve(t){t.U=F()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(V(t.Ua,t),e)}function Fe(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Hn(u)}Zn(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(V(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=F()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Ve(o)),n.a=i):$n(n),0<u.g.length&&Qn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ke(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),Fe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),qe(this),je(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Ve(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),je(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ue(this,t,e),this.b&&4!=t&&Ve(this)))},A.cancel=function(){this.A=!0,qe(this)},A.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,je(this)):Me(this,this.U-n)},(A=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},A.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Xe(t){return new Qe(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Ke(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),H(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var xn=D.JSON.parse;function Ln(t){jt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}j(Ln,jt);var kn="",On=/^https?$/i,Rn=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Mn(t)}function Un(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Vn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Un(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Yn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=F(),Ve(e)),sr(t)}function Hn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Kn(t){Hn(t),t.j&&(D.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Qn(t)}function Qn(t){bn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Pe(n,r,e)}function Yn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;O(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Qt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(V(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Yn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Ce(n,t)}function nr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Qn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(V(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Xa,t),r||(r=new Qe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ye(r,"https"),en(r)),n=r.toString(),r=o,o=new fe,D.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Kn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Qe?Xe(s):new Qe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Qe(null,void 0),r&&Ye(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Yn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function cr(){}function hr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function fr(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ne),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Cn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=G(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Vn(this):this.Ta())},A.Ta=function(){Vn(this)},A.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Pe(n,i,null)):Pe(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||bn(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(V(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Hn(this),er(this))},A.Ra=function(){null!=this.m&&(this.m=null,Hn(this),Zn(this),me(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new fr(t,e)},j(fr,jt),(A=fr.prototype).addEventListener=function(t,e,n,r){fr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){fr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Qn(t)},A.close=function(){zn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.S.G.call(this)},j(lr,Se),j(pr,De),j(dr,cr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,fr.prototype.send=fr.prototype.Pa,fr.prototype.open=fr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ae.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var yr=Ee,vr=Ie,gr=Ae,mr=Ln,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Nr,Er=Error),Nr),_r="7.24.0-20209141635",Ar=new h("@firebase/firestore");function Nr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Ar.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.DEBUG&&(e=n.map(kr),Ar.debug.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.ERROR&&(e=n.map(kr),Ar.error.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.WARN&&(e=n.map(kr),Ar.warn.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Or(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t;throw xr(t),new Error(t)}function Rr(t){t||Or()}function Pr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ur(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Vr,Mr,Ee=(Object.defineProperty(Kr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Kr.prototype.isEqual=function(t){return 0===Kr.i(this,t)},Kr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Kr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Kr.prototype.limit=function(){return this.offset+this.length},Kr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Kr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Kr.prototype.l=function(){return this.segments[this.offset]},Kr.prototype._=function(){return this.get(this.length-1)},Kr.prototype.get=function(t){return this.segments[this.offset+t]},Kr.prototype.m=function(){return 0===this.length},Kr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Kr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Kr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Kr),Fr=(n(Hr,Mr=Ee),Hr.prototype.o=function(t,e,n){return new Hr(t,e,n)},Hr.prototype.R=function(){return this.A().join("/")},Hr.prototype.toString=function(){return this.R()},Hr.g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Hr(n)},Hr.P=function(){return new Hr([])},Hr),jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(zr,Vr=Ee),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.V=function(t){return jr.test(t)},zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.V(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.P=function(){return new zr([])},zr),Gr=(Br.D=function(t){return new Br(Fr.g(t))},Br.C=function(t){return new Br(Fr.g(t).u(5))},Br.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Fr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Fr.i(t.path,e.path)},Br.F=function(t){return t.length%2==0},Br.$=function(t){return new Br(new Fr(t.slice()))},Br);function Br(t){this.path=t}function zr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Hr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Kr(t,e,n){void 0===e?e=0:e>t.length&&Or(),void 0===n?n=t.length-e:n>t.length-e&&Or(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Qr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Yr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n,r){ri(t,e,hi(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function Zr(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=oi(r);throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Or();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function ui(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){r=oi(r);return new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var li=(pi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function vi(t){return t+"\0"}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},mi.prototype.O=function(){return 2*this.M.length},mi.prototype.L=function(t){return di(this.M,t.M)},mi.prototype.isEqual=function(t){return this.M===t.M},mi);function mi(t){this.M=t}gi.B=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i,o){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o}var _i,Ai=(n(Pi,_i=wi),Pi.fromBase64String=function(t){Qr("Blob.fromBase64String",arguments,1),Jr("Blob.fromBase64String","string",1,t),Ii();try{return new Pi(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Pi.fromUint8Array=function(t){if(Qr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new Pi(gi.fromUint8Array(t))},Pi.prototype.toBase64=function(){return Qr("Blob.toBase64",arguments,0),Ii(),_i.prototype.toBase64.call(this)},Pi.prototype.toUint8Array=function(){return Qr("Blob.toUint8Array",arguments,0),Ei(),_i.prototype.toUint8Array.call(this)},Pi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Pi),Ni=(Object.defineProperty(Ri.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ri.prototype.isEqual=function(t){return t instanceof Ri&&t.projectId===this.projectId&&t.database===this.database},Ri.prototype.L=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},Ri),Si=(Oi.prototype.get=function(t){var e=this.K(t),e=this.H[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.G(o,t))return i}},Oi.prototype.has=function(t){return void 0!==this.get(t)},Oi.prototype.set=function(t,e){var n=this.K(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},Oi.prototype.delete=function(t){var e=this.K(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},Oi.prototype.forEach=function(s){Cr(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Oi.prototype.m=function(){return Ur(this.H)},Oi),Di=(ki.now=function(){return ki.fromMillis(Date.now())},ki.fromDate=function(t){return ki.fromMillis(t.getTime())},ki.fromMillis=function(t){var e=Math.floor(t/1e3);return new ki(e,1e6*(t-1e3*e))},ki.prototype.toDate=function(){return new Date(this.toMillis())},ki.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ki.prototype.Y=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},ki.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ki.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ki.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ki.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ki),xi=(Li.J=function(t){return new Li(t)},Li.min=function(){return new Li(new Di(0,0))},Li.prototype.L=function(t){return this.timestamp.Y(t.timestamp)},Li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Li.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Li.prototype.Z=function(){return this.timestamp},Li);function Li(t){this.timestamp=t}function ki(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Oi(t,e){this.K=t,this.G=e,this.H={}}function Ri(t,e){this.projectId=t,this.database=e||"(default)"}function Pi(){return null!==_i&&_i.apply(this,arguments)||this}function Ci(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}function Vi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mi(t,e,n,r,i,o,s)}function ji(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+jo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=wa(e.startAt)),e.endAt&&(t+="|ub:",t+=wa(e.endAt)),e.tt=t),e.tt}function qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ea(t.startAt,e.startAt)&&Ea(t.endAt,e.endAt)}function Gi(t){return Gr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Bi(t){this.count=t}var zi,Hi=(Ki.prototype.st=function(t){return new Ki(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ki.prototype.it=function(t,e){return new Ki(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ki.prototype.rt=function(t){return new Ki(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ki);function Ki(t,e,n,r,i,o,s){void 0===i&&(i=xi.min()),void 0===o&&(o=xi.min()),void 0===s&&(s=gi.B),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Wi(t){switch(t){case Ir.OK:return Or(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Or(),0}}function Qi(t){if(void 0===t)return xr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case zi.OK:return Ir.OK;case zi.CANCELLED:return Ir.CANCELLED;case zi.UNKNOWN:return Ir.UNKNOWN;case zi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case zi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case zi.INTERNAL:return Ir.INTERNAL;case zi.UNAVAILABLE:return Ir.UNAVAILABLE;case zi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case zi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case zi.NOT_FOUND:return Ir.NOT_FOUND;case zi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case zi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case zi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case zi.ABORTED:return Ir.ABORTED;case zi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case zi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case zi.DATA_LOSS:return Ir.DATA_LOSS;default:return Or()}}(Ie=zi=zi||{})[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var Xi=(to.prototype.ot=function(t,e){return new to(this.i,this.root.ot(t,e,this.i).copy(null,null,Ji.at,null,null))},to.prototype.remove=function(t){return new to(this.i,this.root.remove(t,this.i).copy(null,null,Ji.at,null,null))},to.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},to.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},to.prototype.m=function(){return this.root.m()},Object.defineProperty(to.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),to.prototype.ct=function(){return this.root.ct()},to.prototype.ut=function(){return this.root.ut()},to.prototype.ht=function(t){return this.root.ht(t)},to.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},to.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},to.prototype.lt=function(t){return this.root.lt(t)},to.prototype._t=function(){return new Yi(this.root,null,this.i,!1)},to.prototype.ft=function(t){return new Yi(this.root,t,this.i,!1)},to.prototype.dt=function(){return new Yi(this.root,null,this.i,!0)},to.prototype.wt=function(t){return new Yi(this.root,t,this.i,!0)},to),Yi=(Zi.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Zi.prototype.At=function(){return 0<this.Et.length},Zi.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Zi),Ji=($i.prototype.copy=function(t,e,n,r,i){return new $i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},$i.prototype.m=function(){return!1},$i.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},$i.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},$i.prototype.min=function(){return this.left.m()?this:this.left.min()},$i.prototype.ct=function(){return this.min().key},$i.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},$i.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).gt()},$i.prototype.Pt=function(){if(this.left.m())return $i.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).gt()},$i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.bt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return $i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.gt()},$i.prototype.yt=function(){return this.color},$i.prototype.gt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},$i.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},$i.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},$i.prototype.St=function(){var t=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},$i.prototype.bt=function(){var t=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},$i.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},$i.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},$i.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw Or();if(this.right.yt())throw Or();var t=this.left.Nt();if(t!==this.right.Nt())throw Or();return t+(this.yt()?0:1)},$i);function $i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$i.RED,this.left=null!=r?r:$i.EMPTY,this.right=null!=i?i:$i.EMPTY,this.size=this.left.size+1+this.right.size}function Zi(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function to(t,e){this.i=t,this.root=e||Ji.EMPTY}function eo(){this.size=0}Ji.EMPTY=null,Ji.RED=!0,Ji.at=!1,Ji.EMPTY=(Object.defineProperty(eo.prototype,"key",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"value",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"color",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"left",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"right",{get:function(){throw Or()},enumerable:!1,configurable:!0}),eo.prototype.copy=function(t,e,n,r,i){return this},eo.prototype.ot=function(t,e,n){return new Ji(t,e)},eo.prototype.remove=function(t,e){return this},eo.prototype.m=function(){return!0},eo.prototype.ht=function(t){return!1},eo.prototype.lt=function(t){return!1},eo.prototype.ct=function(){return null},eo.prototype.ut=function(){return null},eo.prototype.yt=function(){return!1},eo.prototype.Ct=function(){return!0},eo.prototype.Nt=function(){return 0},new eo);var no=(so.prototype.has=function(t){return null!==this.data.get(t)},so.prototype.first=function(){return this.data.ct()},so.prototype.last=function(){return this.data.ut()},Object.defineProperty(so.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),so.prototype.indexOf=function(t){return this.data.indexOf(t)},so.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},so.prototype.Ft=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},so.prototype.$t=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},so.prototype.xt=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},so.prototype._t=function(){return new ro(this.data._t())},so.prototype.ft=function(t){return new ro(this.data.ft(t))},so.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},so.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},so.prototype.m=function(){return this.data.m()},so.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},so.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},so.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},so.prototype.copy=function(t){var e=new so(this.i);return e.data=t,e},so),ro=(oo.prototype.It=function(){return this.Mt.It().key},oo.prototype.At=function(){return this.Mt.At()},oo),io=new Xi(Gr.i);function oo(t){this.Mt=t}function so(t){this.i=t,this.data=new Xi(this.i)}var uo=new Xi(Gr.i);var ao=new Xi(Gr.i),co=new no(Gr.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=co,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var fo=new no(di);var lo=(xo.Bt=function(t){return new xo(t.i)},xo.prototype.has=function(t){return null!=this.Ot.get(t)},xo.prototype.get=function(t){return this.Ot.get(t)},xo.prototype.first=function(){return this.Lt.ct()},xo.prototype.last=function(){return this.Lt.ut()},xo.prototype.m=function(){return this.Lt.m()},xo.prototype.indexOf=function(t){t=this.Ot.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(xo.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),xo.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},xo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.ot(t.key,t),e.Lt.ot(t,null))},xo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Lt.remove(e)):this},xo.prototype.isEqual=function(t){if(!(t instanceof xo))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},xo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},xo.prototype.copy=function(t,e){var n=new xo;return n.i=this.i,n.Ot=t,n.Lt=e,n},xo),po=(Do.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Or()},Do.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},Do),yo=(So.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new So(t,e,lo.Bt(e),i,n,r,!0,!1)},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),So.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Wt.isEqual(t.Wt)&&Gu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},So),vo=(No.Xt=function(t,e){var n=new Map;return n.set(t,go.Zt(t,e)),new No(xi.min(),n,fo,io,ho())},No),go=(Ao.Zt=function(t,e){return new Ao(gi.B,e,ho(),ho(),ho())},Ao),mo=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},wo=function(t,e){this.targetId=t,this.oe=e},bo=function(t,e,n,r){void 0===n&&(n=gi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Eo=(Object.defineProperty(_o.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),_o.prototype.de=function(t){0<t.O()&&(this.le=!0,this.ue=t)},_o.prototype.we=function(){var n=ho(),r=ho(),i=ho();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Or()}}),new go(this.ue,this.he,n,r,i)},_o.prototype.me=function(){this.le=!1,this.ce=ko()},_o.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},_o.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},_o.prototype.Ie=function(){this.ae+=1},_o.prototype.Ae=function(){--this.ae},_o.prototype.Re=function(){this.le=!0,this.he=!0},_o),Io=(To.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof Tu?this.ve(r,t.re):t.re instanceof _u&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},To.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.Fe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Fe(t)&&(r.$e(t),e.de(n.resumeToken));break;default:Or()}})},To.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Fe(e)&&n(e)})},To.prototype.xe=function(t){var e=t.targetId,n=t.oe.count,t=this.ke(e);t&&(Gi(t=t.target)?0===n?(t=new Gr(t.path),this.Se(e,t,new _u(t,xi.min()))):Rr(1===n):this.Me(e)!==n&&(this.$e(e),this.pe=this.pe.add(e)))},To.prototype.Oe=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&Gi(n.target)&&(n=new Gr(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Se(e,n,new _u(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=ho();this.Ve.forEach(function(t,e){var n=!0;e.$t(function(t){t=i.ke(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new vo(r,o,this.pe,this.ye,s);return this.ye=io,this.Ve=Lo(),this.pe=new no(di),t},To.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t)))},To.prototype.Se=function(t,e,n){var r;this.Fe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},To.prototype.removeTarget=function(t){this.Pe.delete(t)},To.prototype.Me=function(t){var e=this.Ne(t).we();return this.ge.qe(t).size+e.ee.size-e.se.size},To.prototype.Ie=function(t){this.Ne(t).Ie()},To.prototype.Ne=function(t){var e=this.Pe.get(t);return e||(e=new Eo,this.Pe.set(t,e)),e},To.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new no(di),this.Ve=this.Ve.ot(t,e)),e},To.prototype.Fe=function(t){var e=null!==this.ke(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},To.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ge.Ue(t)},To.prototype.$e=function(e){var n=this;this.Pe.set(e,new Eo),this.ge.qe(e).forEach(function(t){n.Se(e,t,null)})},To.prototype.Le=function(t,e){return this.ge.qe(t).has(e)},To);function To(t){this.ge=t,this.Pe=new Map,this.ye=io,this.Ve=Lo(),this.pe=new no(di)}function _o(){this.ae=0,this.ce=ko(),this.ue=gi.B,this.he=!1,this.le=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function No(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function So(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=s,this.Kt=u}function Do(){this.qt=new Xi(Gr.i)}function xo(n){this.i=n?function(t,e){return n(t,e)||Gr.i(t.key,e.key)}:function(t,e){return Gr.i(t.key,e.key)},this.Ot=uo,this.Lt=new Xi(this.i)}function Lo(){return new Xi(Gr.i)}function ko(){return new Xi(Gr.i)}function Oo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ro(t){t=qo(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(t.seconds,t.nanos)}var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Oo(t)?4:10:Or()}function Uo(r,i){var t,e=Co(r);if(e!==Co(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Ro(r).isEqual(Ro(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=qo(r.timestampValue),t=qo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Bo(r.bytesValue).isEqual(Bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Go((t=r).geoPointValue.latitude)===Go(e.geoPointValue.latitude)&&Go(t.geoPointValue.longitude)===Go(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Go(t.integerValue)===Go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Go(t.doubleValue),e=Go(e.doubleValue);return t===e?Ui(t)===Ui(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Pr(e)!==Pr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return Or()}}function Vo(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function Mo(t,e){var n,r,i=Co(t),o=Co(e);if(i!==o)return di(i,o);switch(i){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,r=Go(t.integerValue||t.doubleValue),n=Go(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Fo(t.timestampValue,e.timestampValue);case 4:return Fo(Ro(t),Ro(e));case 5:return di(t.stringValue,e.stringValue);case 6:return function(t,e){t=Bo(t),e=Bo(e);return t.L(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=di(Go(i.latitude),Go(r.latitude)))?n:di(Go(i.longitude),Go(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mo(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;u=Mo(n[r[s]],i[o[s]]);if(0!==u)return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Or()}}function Fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=qo(t),t=qo(e),e=di(n.seconds,t.seconds);return 0!==e?e:di(n.nanos,t.nanos)}function jo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=qo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Gr.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Or();var e}(t)}function qo(t){if(Rr(!!t),"string"!=typeof t)return{seconds:Go(t.seconds),nanos:Go(t.nanos)};var e=0,n=Po.exec(t);Rr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Ho(t){return t&&"integerValue"in t}function Ko(t){return!!t&&"arrayValue"in t}function Wo(t){return t&&"nullValue"in t}function Qo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xo(t){return t&&"mapValue"in t}var Yo={asc:"ASCENDING",desc:"DESCENDING"},Jo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$o=function(t,e){this.U=t,this.Qe=e};function Zo(t){return{integerValue:""+t}}function ts(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function es(t,e){return Vi(e)?Zo(e):ts(t,e)}function ns(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function rs(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function is(t){return Rr(!!t),xi.J((t=qo(t),new Di(t.seconds,t.nanos)))}function os(t,e){return new Fr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ss(t){t=Fr.g(t);return Rr(_s(t)),t}function us(t,e){return os(t.U,e.path)}function as(t,e){e=ss(e);return Rr(e.get(1)===t.U.projectId),Rr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new Gr(ls(e))}function cs(t,e){return os(t.U,e)}function hs(t){t=ss(t);return 4===t.length?Fr.P():ls(t)}function fs(t){return new Fr(["projects",t.U.projectId,"databases",t.U.database]).R()}function ls(t){return Rr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ps(t,e,n){return{name:us(t,e),fields:n.proto.mapValue.fields}}function ds(t,e){var n,r,i;if(e instanceof eu)n={update:ps(t,e.key,e.value)};else if(e instanceof lu)n={delete:us(t,e.key)};else if(e instanceof nu)n={update:ps(t,e.key,e.data),updateMask:(i=e.We,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof uu)n={transform:{document:us(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ds)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof xs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ps)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ms)return{fieldPath:t.field.R(),increment:e.je};throw Or()})}};else{if(!(e instanceof pu))return Or();n={verify:us(t,e.key)}}return e.Ge.Ke||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,ns(e,t.Z()))}:void 0!==i.exists?{exists:i.exists}:Or()),n}function ys(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ks.updateTime(is(o.updateTime)):void 0!==o.exists?Ks.exists(o.exists):Ks.ze():Ks.ze();if(t.update){t.update.name;var r=as(e,t.update.name),i=new du({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Gs(o.map(function(t){return qr.S(t)})));return new nu(r,i,o,n)}return new eu(r,i,n)}if(t.delete){var s=as(e,t.delete);return new lu(s,n)}if(t.transform){i=as(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Rr("REQUEST_TIME"===e.setToServerValue),r=new Ds):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new xs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Ps(n)):"increment"in e?r=new Ms(t,e.increment):Or();e=qr.S(e.fieldPath);return new Bs(e,r)}(e,t)});return Rr(!0===n.exists),new uu(i,s)}if(t.verify){t=as(e,t.verify);return new pu(t,n)}return Or()}function vs(t,e){return{documents:[cs(t,e.path)]}}function gs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=cs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Qo(t.value))return{unaryFilter:{field:Es(t.field),op:"IS_NAN"}};if(Wo(t.value))return{unaryFilter:{field:Es(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Qo(t.value))return{unaryFilter:{field:Es(t.field),op:"IS_NOT_NAN"}};if(Wo(t.value))return{unaryFilter:{field:Es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Es(t.field),op:(e=t.op,Jo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Es((t=t).field),direction:(t=t.dir,Yo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Qe||Ci(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ws(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ws(e.endAt)),n}function ms(t){var e=hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Rr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Ts(t)]:void 0!==t.fieldFilter?[(n=t,Qu.create(Is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Or()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Or():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Ia(Is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ci(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=bs(n.startAt));var u=null;return n.endAt&&(u=bs(n.endAt)),Mu(Lu(e,i,t,o,r,"F",s,u))}function ws(t){return{before:t.before,values:t.position}}function bs(t){var e=!!t.before,t=t.values||[];return new da(t,e)}function Es(t){return{fieldPath:t.R()}}function Is(t){return qr.S(t.fieldPath)}function Ts(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Is(t.unaryFilter.field);return Qu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Is(t.unaryFilter.field);return Qu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=Is(t.unaryFilter.field);return Qu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=Is(t.unaryFilter.field);return Qu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Or()}}function _s(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.He=void 0};function As(t,e){return t instanceof Ms?Ho(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ns,Ss,Ds=(n(ks,Ss=h),ks),xs=(n(Ls,Ns=h),Ls);function Ls(t){var e=this;return(e=Ns.call(this)||this).elements=t,e}function ks(){return null!==Ss&&Ss.apply(this,arguments)||this}function Os(t,e){for(var n=qs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Rs,Ps=(n(Cs,Rs=h),Cs);function Cs(t){var e=this;return(e=Rs.call(this)||this).elements=t,e}function Us(t,e){for(var n=qs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Vs,Ms=(n(Fs,Vs=h),Fs);function Fs(t,e){var n=this;return(n=Vs.call(this)||this).serializer=t,n.je=e,n}function js(t){return Go(t.integerValue||t.doubleValue)}function qs(t){return Ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Gs=(zs.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},zs.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},zs),Bs=function(t,e){this.field=t,this.transform=e};function zs(t){(this.fields=t).sort(qr.i)}function Hs(t,e){this.version=t,this.transformResults=e}var Ks=(Ws.ze=function(){return new Ws},Ws.exists=function(t){return new Ws(void 0,t)},Ws.updateTime=function(t){return new Ws(t)},Object.defineProperty(Ws.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ws.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ws);function Ws(t,e){this.updateTime=t,this.exists=e}function Qs(t,e){return void 0!==t.updateTime?e instanceof Tu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Tu}Ee=function(){};function Xs(t,e,n){return t instanceof eu?new Tu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof nu?function(t,e,n){if(!Qs(t.Ge,e))return new Au(t.key,n.version);e=ou(t,e);return new Tu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof uu?function(t,e,n){if(Rr(null!=n.transformResults),!Qs(t.Ge,e))return new Au(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Rr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Tu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof xs?Os(o,s):o instanceof Ps?Us(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=cu(t,r.data(),e);return new Tu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new _u(t.key,n.version,{hasCommittedMutations:!0})}function Ys(t,e,n,r){return t instanceof eu?function(t,e){if(!Qs(t.Ge,e))return e;e=$s(e);return new Tu(t.key,e,t.value,{Je:!0})}(t,e):t instanceof nu?function(t,e){if(!Qs(t.Ge,e))return e;var n=$s(e),e=ou(t,e);return new Tu(t.key,n,e,{Je:!0})}(t,e):t instanceof uu?function(t,e,n,r){if(!Qs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Tu&&(h=n.field(a.field)),null===h&&r instanceof Tu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ds?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof xs?Os(c,i):c instanceof Ps?Us(c,i):(c=As(h=c,i),i=js(c)+js(h.je),Ho(c)&&Ho(h.je)?Zo(i):ts(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=cu(t,i.data(),r);return new Tu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Qs((t=t).Ge,e)?new _u(t.key,xi.min()):e)}function Js(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof xs&&e instanceof xs||t instanceof Ps&&e instanceof Ps?yi(t.elements,e.elements,Uo):t instanceof Ms&&e instanceof Ms?Uo(t.je,e.je):t instanceof Ds&&e instanceof Ds)}))}function $s(t){return t instanceof Tu?t.version:xi.min()}var Zs,tu,eu=(n(iu,tu=Ee),iu),nu=(n(ru,Zs=Ee),ru);function ru(t,e,n,r){var i=this;return(i=Zs.call(this)||this).key=t,i.data=e,i.We=n,i.Ge=r,i.type=1,i}function iu(t,e,n){var r=this;return(r=tu.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function ou(t,e){return n=t,e=e instanceof Tu?e.data():du.empty(),r=new yu(e),n.We.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var su,uu=(n(au,su=Ee),au);function au(t,e){var n=this;return(n=su.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ks.exists(!0),n}function cu(t,e,n){for(var r=new yu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var hu,fu,lu=(n(wu,fu=Ee),wu),pu=(n(mu,hu=Ee),mu),du=(gu.empty=function(){return new gu({mapValue:{}})},gu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},gu.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},gu),yu=(vu.prototype.set=function(t,e){return this.en(t,e),this},vu.prototype.delete=function(t){return this.en(t,null),this},vu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Co(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},vu.prototype.Xe=function(){var t=this.nn(qr.P(),this.tn);return null!=t?new du(t):this.Ze},vu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},vu);function vu(t){void 0===t&&(t=du.empty()),this.Ze=t,this.tn=new Map}function gu(t){this.proto=t}function mu(t,e){var n=this;return(n=hu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function wu(t,e){var n=this;return(n=fu.call(this)||this).key=t,n.Ge=e,n.type=3,n}var bu,Eu,Iu,Ie=function(t,e){this.key=t,this.version=e},Tu=(n(xu,Iu=Ie),xu.prototype.field=function(t){return this.sn.field(t)},xu.prototype.data=function(){return this.sn},xu.prototype.rn=function(){return this.sn.proto},xu.prototype.isEqual=function(t){return t instanceof xu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},xu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(xu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),xu),_u=(n(Du,Eu=Ie),Du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Du.prototype.isEqual=function(t){return t instanceof Du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Du),Au=(n(Su,bu=Ie),Su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Su.prototype.isEqual=function(t){return t instanceof Su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Su),Nu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function Su(){return null!==bu&&bu.apply(this,arguments)||this}function Du(t,e,n){var r=this;return(r=Eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function xu(t,e,n,r){var i=this;return(i=Iu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Lu(t,e,n,r,i,o,s,u){return new Nu(t,e,n,r,i,o,s,u)}function ku(t){return new Nu(t)}function Ou(t){return!Ci(t.limit)&&"F"===t.an}function Ru(t){return!Ci(t.limit)&&"L"===t.an}function Pu(t){return 0<t.on.length?t.on[0].field:null}function Cu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Uu(t){return null!==t.collectionGroup}function Vu(t){var e=t;if(null===e.cn){e.cn=[];var n=Cu(e),t=Pu(e);if(null!==n&&null===t)n.p()||e.cn.push(new Ia(n)),e.cn.push(new Ia(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.p()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new Ia(qr.v(),n)))}}return e.cn}function Mu(t){var e=t;if(!e.un)if("F"===e.an)e.un=Fi(e.path,e.collectionGroup,Vu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Vu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ia(o.field,s))}var u=e.endAt?new da(e.endAt.position,!e.endAt.before):null,t=e.startAt?new da(e.startAt.position,!e.startAt.before):null;e.un=Fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Fu(t,e,n){return new Nu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ju(t,e){return new Nu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function qu(t,e){return new Nu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Gu(t,e){return qi(Mu(t),Mu(e))&&t.an===e.an}function Bu(t){return ji(Mu(t))+"|lt:"+t.an}function zu(t){return"Query(target="+(e=Mu(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+jo(t.value)}).join(", ")+"]"),Ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+wa(e.startAt)),e.endAt&&(n+=", endAt: "+wa(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Hu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Gr.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ba(t.startAt,Vu(t),n))&&(!t.endAt||!ba(t.endAt,Vu(t),n)));var e,n}function Ku(u){return function(t,e){for(var n=!1,r=0,i=Vu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.p()?Gr.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Mo(n,t):Or()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Or()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Wu,Qu=(n(Xu,Wu=function(){}),Xu.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.ln(t,e,n):new Zu(t,e,n);if(Wo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Xu(t,e,n)}if(Qo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Xu(t,e,n)}return"array-contains"===e?new ha(t,n):"in"===e?new fa(t,n):"not-in"===e?new la(t,n):"array-contains-any"===e?new pa(t,n):new Xu(t,e,n)},Xu.ln=function(t,e,n){return new("in"===e?ta:ea)(t,n)},Xu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(Mo(t,this.value)):null!==t&&Co(this.value)===Co(t)&&this._n(Mo(t,this.value))},Xu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Or()}},Xu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Xu);function Xu(t,e,n){var r=this;return(r=Wu.call(this)||this).field=t,r.op=e,r.value=n,r}var Yu,Ju,$u,Zu=(n(ia,$u=Qu),ia.prototype.matches=function(t){t=Gr.i(t.key,this.key);return this._n(t)},ia),ta=(n(ra,Ju=Qu),ra.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ra),ea=(n(na,Yu=Qu),na.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},na);function na(t,e){var n=this;return(n=Yu.call(this,t,"not-in",e)||this).keys=oa(0,e),n}function ra(t,e){var n=this;return(n=Ju.call(this,t,"in",e)||this).keys=oa(0,e),n}function ia(t,e,n){var r=this;return(r=$u.call(this,t,e,n)||this).key=Gr.C(n.referenceValue),r}function oa(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Gr.C(t.referenceValue)})}var sa,ua,aa,ca,ha=(n(ma,ca=Qu),ma.prototype.matches=function(t){t=t.field(this.field);return Ko(t)&&Vo(t.arrayValue,this.value)},ma),fa=(n(ga,aa=Qu),ga.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Vo(this.value.arrayValue,t)},ga),la=(n(va,ua=Qu),va.prototype.matches=function(t){if(Vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Vo(this.value.arrayValue,t)},va),pa=(n(ya,sa=Qu),ya.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vo(e.value.arrayValue,t)})},ya),da=function(t,e){this.position=t,this.before=e};function ya(t,e){return sa.call(this,t,"array-contains-any",e)||this}function va(t,e){return ua.call(this,t,"not-in",e)||this}function ga(t,e){return aa.call(this,t,"in",e)||this}function ma(t,e){return ca.call(this,t,"array-contains",e)||this}function wa(t){return(t.before?"b":"a")+":"+t.position.map(jo).join(",")}function ba(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Gr.i(Gr.C(s.referenceValue),n.key):Mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ea(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var Ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ta(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var _a,Aa=(Pa.prototype.reset=function(){this.En=0},Pa.prototype.Rn=function(){this.En=this.Tn},Pa.prototype.gn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},Pa.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},Pa.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},Pa.prototype.Pn=function(){return(Math.random()-.5)*this.En},Pa),Na=(Ra.prototype.catch=function(t){return this.next(void 0,t)},Ra.prototype.next=function(r,i){var o=this;return this.Dn&&Or(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new Ra(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},Ra.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ra.prototype.$n=function(t){try{var e=t();return e instanceof Ra?e:Ra.resolve(e)}catch(t){return Ra.reject(t)}},Ra.prototype.Nn=function(t,e){return t?this.$n(function(){return t(e)}):Ra.resolve(e)},Ra.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):Ra.reject(e)},Ra.resolve=function(n){return new Ra(function(t,e){t(n)})},Ra.reject=function(n){return new Ra(function(t,e){e(n)})},Ra.xn=function(t){return new Ra(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ra.kn=function(t){for(var n=Ra.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ra.resolve(t):e()})}(r[e]);return n},Ra.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},Ra),Sa=(Oa.delete=function(t){return Dr("SimpleDb","Removing database:",t),ja(window.indexedDB.deleteDatabase(t)).Fn()},Oa.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(Oa.Bn())return!0;var t=p(),e=Oa.On(t),n=0<e&&e<10,e=Oa.qn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Oa.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},Oa.Qn=function(t,e){return t.store(e)},Oa.On=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Oa.qn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Oa.prototype.Wn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new xa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Tr(Ir.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new xa(o,t))},r.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Dr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(t){return i.jn(t)}),this.db)]}})})},Oa.prototype.Kn=function(e){this.jn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Oa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Wn(u)];case 2:return s.db=t.sent(),e=Ua.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Na.reject(t)}).Fn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Dr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Oa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Oa),Da=(Object.defineProperty(ka.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),ka.prototype.done=function(){this.Hn=!0},ka.prototype.Xn=function(t){this.Yn=t},ka.prototype.delete=function(){return ja(this.zn.delete())},ka),xa=(n(La,_a=Tr),La);function La(t,e){var n=this;return(n=_a.call(this,Ir.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ka(t){this.zn=t,this.Hn=!1,this.Yn=null}function Oa(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===Oa.On(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ra(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function Pa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function Ca(t){return"IndexedDbTransactionError"===t.name}var Ua=(Fa.open=function(t,e,n,r){try{return new Fa(e,t.transaction(r,n))}catch(t){throw new xa(e,t)}},Object.defineProperty(Fa.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),Fa.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Fa.prototype.store=function(t){t=this.transaction.objectStore(t);return new Va(t)},Fa),Va=(Ma.prototype.put=function(t,e){t=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return ja(t)},Ma.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),ja(this.store.add(t))},Ma.prototype.get=function(e){var n=this;return ja(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},Ma.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),ja(this.store.delete(t))},Ma.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),ja(this.store.count())},Ma.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},Ma.prototype.ns=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.ss=!1;e=this.cursor(e);return this.es(e,function(t,e,n){return n.delete()})},Ma.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},Ma.prototype.os=function(r){var t=this.cursor({});return new Na(function(n,e){t.onerror=function(t){t=Ga(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ma.prototype.es=function(t,i){var o=[];return new Na(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Da(n),(t=i(n.primaryKey,n.value,e))instanceof Na&&(t=t.catch(function(t){return e.done(),Na.reject(t)}),o.push(t)),e.Sn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return Na.xn(o)})},Ma.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ma.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ma);function Ma(t){this.store=t}function Fa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new Ta,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new xa(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=Ga(t.target.error);n.Zn.reject(new xa(e,t))}}function ja(t){return new Na(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ga(t.target.error);n(t)}})}var qa=!1;function Ga(t){var e=Sa.On(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Tr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return qa||(qa=!0,setTimeout(function(){throw n},0)),n}}return t}function Ba(){return"undefined"!=typeof window?window:null}function za(){return"undefined"!=typeof document?document:null}var Ha=(Qa._s=function(t,e,n,r,i){i=new Qa(t,e,Date.now()+n,r,i);return i.start(n),i},Qa.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Qa.prototype.pn=function(){return this.ds()},Qa.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Qa.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Qa.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},Qa),Ka=(Object.defineProperty(Wa.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Wa.prototype.ws=function(t){this.enqueue(t)},Wa.prototype.bs=function(t){this.vs(),this.Ss(t)},Wa.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=za())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs))},Wa.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Wa.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Es.push(t),e.Ns()})},Wa.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Es.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return t.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Es.length&&this.ys.gn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Wa.prototype.Ss=function(t){var r=this,e=this.Ts.then(function(){return r.gs=!0,t().catch(function(t){throw r.Rs=t,r.gs=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.gs=!1,t})});return this.Ts=e},Wa.prototype.yn=function(t,e,n){var r=this;this.vs(),-1<this.Ps.indexOf(t)&&(e=0);n=Ha._s(this,t,e,n,function(t){return r.Fs(t)});return this.As.push(n),n},Wa.prototype.vs=function(){this.Rs&&Or()},Wa.prototype.$s=function(){},Wa.prototype.xs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Ts];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ts)return[3,0];t.label=3;case 3:return[2]}})})},Wa.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Wa.prototype.Ms=function(r){var i=this;return this.xs().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.xs()})},Wa.prototype.Os=function(t){this.Ps.push(t)},Wa.prototype.Fs=function(t){t=this.As.indexOf(t);this.As.splice(t,1)},Wa);function Wa(){var e=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new Aa(this,"async_queue_retry"),this.Vs=function(){var t=za();t&&Dr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.Vn()};var t=za();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}function Qa(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new Ta,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Xa(t,e){if(xr("AsyncQueue",e+": "+t),Ca(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Ya(){this.Ls=void 0,this.listeners=[]}function Ja(){this.Bs=new Si(Bu,Gu),this.onlineState="Unknown",this.qs=new Set}function $a(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Ya),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=t.sent(),o=Xa(o,"Initialization of query '"+zu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Qs(e.onlineState),i.Ls&&u.Ws(i.Ls)&&tc(e),[2]}})})}function Za(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.js(n))]:[2]})})}function tc(t){t.qs.forEach(function(t){t.next()})}var ec=(ic.prototype.Ws=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new yo(t.query,t.docs,t.Qt,e,t.Wt,t.fromCache,t.jt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.Ks.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},ic.prototype.onError=function(t){this.Ks.error(t)},ic.prototype.Qs=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},ic.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.m()&&"Offline"!==e)},ic.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},ic.prototype.Js=function(t){t=yo.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Gs=!0,this.Ks.next(t)},ic),nc=(rc.prototype.Zs=function(){return null!=this.uid},rc.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},rc.prototype.isEqual=function(t){return t.uid===this.uid},rc);function rc(t){this.uid=t}function ic(t,e,n){this.query=t,this.Ks=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}nc.UNAUTHENTICATED=new nc(null),nc.ei=new nc("google-credentials-uid"),nc.ni=new nc("first-party-uid");var oc=(sc.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},sc.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},sc);function sc(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function uc(t,e){return"firestore_clients_"+t+"_"+e}function ac(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Zs()&&(n+="_"+e.uid),n}function cc(t,e){return"firestore_targets_"+t+"_"+e}oc.ai=-1;var hc=(Pc.ci=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Tr(r.error.code,r.error.message)),i?new Pc(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Pc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Pc),fc=(Rc.ci=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Tr(n.error.code,n.error.message)),r?new Rc(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Rc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rc),lc=(Oc.ci=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=fo,o=0;r&&o<n.activeTargetIds.length;++o)r=Vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Oc(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Oc),pc=(kc.ci=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new kc(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},kc),dc=(Lc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Lc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Lc.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Lc),yc=(xc.Ln=function(t){return!(!t||!t.localStorage)},xc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(uc(this.persistenceKey,r)))&&(o=lc.ci(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.Vi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.Ii;a<c.length;a++)h=c[a],this.mi(h);return this.Ii=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ei=!0,[2]}})})},xc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},xc.prototype.Ci=function(){return this.Ni(this.Ti)},xc.prototype.Fi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},xc.prototype.$i=function(t){this.xi(t,"pending")},xc.prototype.ki=function(t,e,n){this.xi(t,e,n),this.Mi(t)},xc.prototype.Oi=function(t){var e,n="not-current";return this.Fi(t)&&(!(e=this.storage.getItem(cc(this.persistenceKey,t)))||(e=fc.ci(t,e))&&(n=e.state)),this.Li.hi(t),this.bi(),n},xc.prototype.Bi=function(t){this.Li.li(t),this.bi()},xc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},xc.prototype.Ui=function(t){this.removeItem(cc(this.persistenceKey,t))},xc.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},xc.prototype.ji=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.$i(t)})},xc.prototype.Ki=function(t){this.Gi(t)},xc.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},xc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},xc.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},xc.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},xc.prototype.mi=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Dr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ei){if(null!==s.key)if(this.gi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Yi(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Pi.test(s.key)){if(null!==s.newValue&&(n=this.Ji(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.yi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.Vi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=oc.ai;if(null!=t)try{var n=JSON.parse(t);Rr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==oc.ai&&this.si(o)}else this.Ii.push(s);return[2]})})})}},Object.defineProperty(xc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),xc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},xc.prototype.xi=function(t,e,n){n=new hc(this.currentUser,t,e,n),t=ac(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ui())},xc.prototype.Mi=function(t){t=ac(this.persistenceKey,this.currentUser,t);this.removeItem(t)},xc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t};this.storage.setItem(this.Vi,JSON.stringify(t))},xc.prototype.Wi=function(t,e,n){var r=cc(this.persistenceKey,t),n=new fc(t,e,n);this.setItem(r,n.ui())},xc.prototype.zi=function(t){t=this.gi.exec(t);return t?t[1]:null},xc.prototype.Yi=function(t,e){t=this.zi(t);return lc.ci(t,e)},xc.prototype.Ji=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return hc.ci(new nc(n),t,e)},xc.prototype.Zi=function(t,e){t=this.yi.exec(t),t=Number(t[1]);return fc.ci(t,e)},xc.prototype.vi=function(t){return pc.ci(t)},xc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},xc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},xc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},xc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},xc.prototype.Ni=function(t){var n=fo;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},xc),vc=(Dc.prototype.$i=function(t){},Dc.prototype.ki=function(t,e,n){},Dc.prototype.Oi=function(t){return this.ir.hi(t),this.rr[t]||"not-current"},Dc.prototype.Qi=function(t,e,n){this.rr[t]=e},Dc.prototype.Bi=function(t){this.ir.li(t)},Dc.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},Dc.prototype.Ui=function(t){delete this.rr[t]},Dc.prototype.Ci=function(){return this.ir.activeTargetIds},Dc.prototype.Fi=function(t){return this.ir.activeTargetIds.has(t)},Dc.prototype.start=function(){return this.ir=new dc,Promise.resolve()},Dc.prototype.ji=function(t,e,n){},Dc.prototype.Ki=function(t){},Dc.prototype.Di=function(){},Dc.prototype.oi=function(t){},Dc),gc=(Sc.prototype.cr=function(t,e,n){for(var r=n.ur,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Xs(o,e,r[i]))}return e},Sc.prototype.hr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ys(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ys(a,e,o,this.ar))}return e},Sc.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.hr(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Sc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},Sc.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Js)&&yi(this.baseMutations,t.baseMutations,Js)},Sc),mc=(Nc.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=ao,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Nc(t,e,n,r)},Nc),h=(Object.defineProperty(Ac.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),Ac.prototype.Er=function(t,e){this.Ir(),this.readTime=e,this.wr.set(t.key,t)},Ac.prototype.Ar=function(t,e){this.Ir(),e&&(this.readTime=e),this.wr.set(t,null)},Ac.prototype.Rr=function(t,e){this.Ir();var n=this.wr.get(e);return void 0!==n?Na.resolve(n):this.gr(t,e)},Ac.prototype.getEntries=function(t,e){return this.Pr(t,e)},Ac.prototype.apply=function(t){return this.Ir(),this.mr=!0,this.yr(t)},Ac.prototype.Ir=function(){},Ac),wc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(_c.prototype.pr=function(t){this.Vr.push(t)},_c.prototype.br=function(){this.Vr.forEach(function(t){return t()})},_c),bc=(Tc.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},Tc.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].hr(r,t);return t})},Tc.prototype.$r=function(t,e,i){var o=io;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].hr(t,e);o=o.ot(t,e)}),o},Tc.prototype.kr=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},Tc.prototype.Mr=function(e,r){var i=this;return this.Sr.Or(e,r).next(function(t){var t=i.$r(e,r,t),n=io;return t.forEach(function(t,e){e=e||new _u(t,xi.min()),n=n.ot(t,e)}),n})},Tc.prototype.Lr=function(t,e,n){return r=e,Gr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):Uu(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},Tc.prototype.Br=function(t,e){return this.Cr(t,new Gr(e)).next(function(t){var e=uo;return t instanceof Tu&&(e=e.ot(t.key,t)),e})},Tc.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=uo;return this.Dr.Qr(n,s).next(function(t){return Na.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Nu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Tc.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Wr(e,n)}).next(function(t){return h=t,r.jr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ys(s,a,a,r.ar);c=a instanceof Tu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Hu(n,e)||(c=c.remove(t))}),c})},Tc.prototype.jr=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof nu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Tu&&(c=c.ot(t,e))}),c})},Tc),Ec=(Ic.zr=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ic(t,e.fromCache,n,r)},Ic);function Ic(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kr=n,this.Gr=r}function Tc(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function _c(){this.Vr=[]}function Ac(){this.wr=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mr=!1}function Nc(t,e,n,r){this.batch=t,this._r=e,this.ur=n,this.dr=r}function Sc(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function Dc(){this.ir=new dc,this.rr={},this.di=null,this.si=null}function xc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new Xi(di),this.Ei=!1,this.Ii=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=uc(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new dc),this.gi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Vi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function Lc(){this.activeTargetIds=fo}function kc(t,e){this.clientId=t,this.onlineState=e}function Oc(t,e){this.clientId=t,this.activeTargetIds=e}function Rc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Pc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Cc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=di(n,t);return 0===t?di(r,e):t}var Uc=(jc.prototype.Jr=function(){return++this.Yr},jc.prototype.Xr=function(t){var e=[t,this.Jr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):Cc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(jc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),jc),Vc={Zr:!1,eo:0,no:0,so:0},Mc=(Fc.ao=function(t){return new Fc(t,Fc.co,Fc.uo)},Fc);function Fc(t,e,n){this.io=t,this.ro=e,this.oo=n}function jc(t){this.Hr=t,this.buffer=new no(Cc),this.Yr=0}Mc.ho=-1,Mc.lo=1048576,Mc._o=41943040,Mc.co=10,Mc.uo=1e3,Mc.fo=new Mc(Mc._o,Mc.co,Mc.uo),Mc.do=new Mc(Mc.ho,0,0);var qc=(zc.prototype.start=function(t){this.wo.params.io!==Mc.ho&&this.Eo(t)},zc.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(zc.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),zc.prototype.Eo=function(n){var t=this,e=this.mo?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.cs.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.mo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Io(this.wo)];case 2:return t.sent(),[3,7];case 3:return Ca(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Tf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Eo(n)];case 8:return t.sent(),[2]}})})})},zc),Gc=(Bc.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},Bc.prototype.yo=function(t,e){var n=this;if(0===e)return Na.resolve(oc.ai);var r=new Uc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.Vo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},Bc.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},Bc.prototype.bo=function(t,e){return this.Ao.bo(t,e)},Bc.prototype.vo=function(e,n){var r=this;return this.params.io===Mc.ho?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),Na.resolve(Vc)):this.So(e).next(function(t){return t<r.params.io?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),Vc):r.Do(e,n)})},Bc.prototype.So=function(t){return this.Ao.So(t)},Bc.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.yo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Na.resolve({Zr:!0,eo:i,no:o,so:t})})},Bc);function Bc(t,e){this.Ao=t,this.params=e}function zc(t,e){this.wo=t,this.cs=e,this.mo=!1,this.To=null}function Hc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Kc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Kc(e)}function Kc(t){return t+"\x01\x01"}function Wc(t){var e=t.length;if(Rr(2<=e),2===e)return Rr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Fr.P();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Or(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Or()}o=s+2}return new Fr(r)}var Qc=function(t){this.Co=t};function Xc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=as(n,r.name),n=is(r.updateTime),r=new du({mapValue:{fields:r.fields}}),new Tu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=Gr.$(e.noDocument.path),o=th(e.noDocument.readTime);return new _u(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=Gr.$(e.unknownDocument.path),e=th(e.unknownDocument.version);return new Au(o,e)}return Or()}function Yc(t,e,n){var r=Jc(n),n=e.key.path.h().A();if(e instanceof Tu){var i={name:us(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:ns(i,o.version.Z())},o=e.hasCommittedMutations;return new Ph(null,null,i,o,r,n)}if(e instanceof _u){var i=e.key.path.A(),o=Zc(e.version),s=e.hasCommittedMutations;return new Ph(null,new Oh(i,o),null,s,r,n)}if(e instanceof Au){s=e.key.path.A(),e=Zc(e.version);return new Ph(new Rh(s,e),null,null,!0,r,n)}return Or()}function Jc(t){t=t.Z();return[t.seconds,t.nanoseconds]}function $c(t){t=new Di(t[0],t[1]);return xi.J(t)}function Zc(t){t=t.Z();return new Th(t.seconds,t.nanoseconds)}function th(t){t=new Di(t.seconds,t.nanoseconds);return xi.J(t)}function eh(e,t){var n=(t.baseMutations||[]).map(function(t){return ys(e.Co,t)}),r=t.mutations.map(function(t){return ys(e.Co,t)}),i=Di.fromMillis(t.localWriteTimeMs);return new gc(t.batchId,i,n,r)}function nh(t){var e=th(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?th(t.lastLimboFreeSnapshotVersion):xi.min(),r=void 0!==t.query.documents?(Rr(1===(r=t.query).documents.length),Mu(ku(hs(r.documents[0])))):ms(t.query);return new Hi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,gi.fromBase64String(t.resumeToken))}function rh(t,e){var n=Zc(e.nt),r=Zc(e.lastLimboFreeSnapshotVersion),i=(Gi(e.target)?vs:gs)(t.Co,e.target),t=e.resumeToken.toBase64();return new Uh(e.targetId,ji(e.target),n,t,e.sequenceNumber,r,i)}var ih=(oh.$o=function(t,e,n,r){return Rr(""!==t.uid),new oh(t.Zs()?t.uid:"",e,n,r)},oh.prototype.xo=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).rs({index:xh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},oh.prototype.ko=function(d,y,v,g){var m=this,w=ch(d),b=ah(d);return b.add({}).next(function(t){Rr("number"==typeof t);for(var e,n,r,i,o,s=new gc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ds(e.Co,t)}),o=r.mutations.map(function(t){return ds(e.Co,t)}),new xh(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new no(function(t,e){return di(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Lh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,Lh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.Fo[t]=s.keys()}),Na.xn(a).next(function(){return s})})},oh.prototype.Oo=function(t,e){var n=this;return ah(t).get(e).next(function(t){return t?(Rr(t.userId===n.userId),eh(n.serializer,t)):null})},oh.prototype.Lo=function(t,e){var n=this;return this.Fo[e]?Na.resolve(this.Fo[e]):this.Oo(t,e).next(function(t){if(t){t=t.keys();return n.Fo[e]=t}return null})},oh.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return ah(t).rs({index:xh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Rr(e.batchId>=i),o=eh(r.serializer,e)),n.done()}).next(function(){return o})},oh.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ah(t).rs({index:xh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},oh.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).ts(xh.userMutationsIndex,n).next(function(t){return t.map(function(t){return eh(e.serializer,t)})})},oh.prototype.Nr=function(o,s){var u=this,t=Lh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return ch(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);if(r===u.userId&&s.path.isEqual(i))return ah(o).get(t).next(function(t){if(!t)throw Or();Rr(t.userId===u.userId),a.push(eh(u.serializer,t))});n.done()}).next(function(){return a})},oh.prototype.Or=function(e,t){var s=this,u=new no(di),n=[];return t.forEach(function(o){var t=Lh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=ch(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Na.xn(n).next(function(){return s.Qo(e,u)})},oh.prototype.Wr=function(t,e){var o=this,s=e.path,u=s.length+1,e=Lh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new no(di);return ch(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Qo(t,a)})},oh.prototype.Qo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(ah(e).get(t).next(function(t){if(null===t)throw Or();Rr(t.userId===n.userId),r.push(eh(n.serializer,t))}))}),Na.xn(i).next(function(){return r})},oh.prototype.Wo=function(e,n){var r=this;return uh(e.jo,this.userId,n).next(function(t){return e.pr(function(){r.Ko(n.batchId)}),Na.forEach(t,function(t){return r.No.Go(e,t)})})},oh.prototype.Ko=function(t){delete this.Fo[t]},oh.prototype.zo=function(e){var i=this;return this.xo(e).next(function(t){if(!t)return Na.resolve();var t=IDBKeyRange.lowerBound(Lh.prefixForUser(i.userId)),r=[];return ch(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Wc(t[1]),r.push(t)):n.done()}).next(function(){Rr(0===r.length)})})},oh.prototype.Ho=function(t,e){return sh(t,this.userId,e)},oh.prototype.Yo=function(t){var e=this;return hh(t).get(this.userId).next(function(t){return t||new Dh(e.userId,-1,"")})},oh);function oh(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.Fo={}}function sh(t,o,e){var e=Lh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return ch(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function uh(t,e,n){var r=t.store(xh.store),i=t.store(Lh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Rr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Lh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return Na.xn(o).next(function(){return u})}function ah(t){return nf.Qn(t,xh.store)}function ch(t){return nf.Qn(t,Lh.store)}function hh(t){return nf.Qn(t,Dh.store)}var fh,lh=(yh.prototype.Er=function(t,e,n){return gh(t).put(mh(e),n)},yh.prototype.Ar=function(t,e){t=gh(t),e=mh(e);return t.delete(e)},yh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Jo(e,t)})},yh.prototype.Rr=function(t,e){var n=this;return gh(t).get(mh(e)).next(function(t){return n.Xo(t)})},yh.prototype.Zo=function(t,e){var n=this;return gh(t).get(mh(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:wh(t)}:null})},yh.prototype.getEntries=function(t,e){var n=this,r=io;return this.ea(t,e,function(t,e){e=n.Xo(e);r=r.ot(t,e)}).next(function(){return r})},yh.prototype.na=function(t,e){var r=this,i=io,o=new Xi(Gr.i);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,wh(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},yh.prototype.ea=function(t,e,i){if(e.m())return Na.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e._t(),s=o.It();return gh(t).rs({range:n},function(t,e,n){for(var r=Gr.$(t);s&&Gr.i(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},yh.prototype.Lr=function(t,r,e){var n,i=this,o=uo,s=r.path.length+1,u={};return e.isEqual(xi.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=Jc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Ph.collectionReadTimeIndex),gh(t).rs(u,function(t,e,n){t.length===s&&(e=Xc(i.serializer,e),r.path.T(e.key.path)?e instanceof Tu&&Hu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},yh.prototype.ra=function(t){return new ph(this,!!t&&t.oa)},yh.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},yh.prototype.getMetadata=function(t){return vh(t).get(Ch.key).next(function(t){return Rr(!!t),t})},yh.prototype.Jo=function(t,e){return vh(t).put(Ch.key,e)},yh.prototype.Xo=function(t){if(t){t=Xc(this.serializer,t);return t instanceof _u&&t.version.isEqual(xi.min())?null:t}return null},yh),ph=(n(dh,fh=h),dh.prototype.yr=function(i){var o=this,s=[],u=0,a=new no(function(t,e){return di(t.R(),e.R())});return this.wr.forEach(function(t,e){var n,r=o.ua.get(t);e?(n=Yc(o.ca.serializer,e,o.readTime),a=a.add(t.path.h()),e=wh(n),u+=e-r,s.push(o.ca.Er(i,t,n))):(u-=r,o.oa?(r=Yc(o.ca.serializer,new _u(t,xi.min()),o.readTime),s.push(o.ca.Er(i,t,r))):s.push(o.ca.Ar(i,t)))}),a.forEach(function(t){s.push(o.ca.Dr.Mo(i,t))}),s.push(this.ca.updateMetadata(i,u)),Na.xn(s)},dh.prototype.gr=function(t,e){var n=this;return this.ca.Zo(t,e).next(function(t){return null===t?(n.ua.set(e,0),null):(n.ua.set(e,t.size),t.ta)})},dh.prototype.Pr=function(t,e){var n=this;return this.ca.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ua.set(t,e)}),e})},dh);function dh(t,e){var n=this;return(n=fh.call(this)||this).ca=t,n.oa=e,n.ua=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function yh(t,e){this.serializer=t,this.Dr=e}function vh(t){return nf.Qn(t,Ch.store)}function gh(t){return nf.Qn(t,Ph.store)}function mh(t){return t.path.A()}function wh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Or();e=t.noDocument}return JSON.stringify(e).length}var bh=(Sh.prototype.Mo=function(t,e){return this.ha.add(e),Na.resolve()},Sh.prototype.Qr=function(t,e){return Na.resolve(this.ha.getEntries(e))},Sh),Eh=(Nh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new no(Fr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Nh.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},Nh.prototype.getEntries=function(t){return(this.index[t]||new no(Fr.i)).A()},Nh),Ih=(Ah.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Rr(t<r&&0<=t&&r<=10);var o=new Ua("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(_h.store),(s=e).createObjectStore(Dh.store,{keyPath:Dh.keyPath}),s.createObjectStore(xh.store,{keyPath:xh.keyPath,autoIncrement:!0}).createIndex(xh.userMutationsIndex,xh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Lh.store),jh(e),e.createObjectStore(Ph.store));var s,u=Na.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Vh.store),s.deleteObjectStore(Uh.store),s.deleteObjectStore(Mh.store),jh(e)),u=u.next(function(){return t=o.store(Mh.store),e=new Mh(0,0,xi.min().Z(),0),t.put(Mh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(xh.store).ts().next(function(t){n.deleteObjectStore(xh.store),n.createObjectStore(xh.store,{keyPath:xh.keyPath,autoIncrement:!0}).createIndex(xh.userMutationsIndex,xh.userMutationsKeyPath,{unique:!0});var e=r.store(xh.store),t=t.map(function(t){return e.put(t)});return Na.xn(t)});var n,r})),u=u.next(function(){e.createObjectStore(qh.store,{keyPath:qh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Ch.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Ph.store)).createIndex(Ph.readTimeIndex,Ph.readTimeIndexPath,{unique:!1}),t.createIndex(Ph.collectionReadTimeIndex,Ph.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},Ah.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Ph.store).rs(function(t,e){n+=wh(e)}).next(function(){var t=new Ch(n);return e.store(Ch.store).put(Ch.key,t)})},Ah.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Dh.store),i=n.store(xh.store);return t.ts().next(function(t){return Na.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(xh.userMutationsIndex,t).next(function(t){return Na.forEach(t,function(t){Rr(t.userId===e.userId);t=eh(r.serializer,t);return uh(n,e.userId,t).next(function(){})})})})})},Ah.prototype.ensureSequenceNumbers=function(t){var o=t.store(Vh.store),e=t.store(Ph.store);return t.store(Mh.store).get(Mh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new Fr(t),t=[0,Hc(n)];i.push(o.get(t).next(function(t){return t?Na.resolve():o.put(new Vh(0,Hc(n),r.highestListenSequenceNumber))}))}).next(function(){return Na.xn(i)})})},Ah.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Fh.store,{keyPath:Fh.keyPath});function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:Hc(t)})}}var n=e.store(Fh.store),i=new Eh;return e.store(Ph.store).rs({ss:!0},function(t,e){t=new Fr(t);return r(t.h())}).next(function(){return e.store(Lh.store).rs({ss:!0},function(t,e){t[0];var n=t[1],n=(t[2],Wc(n));return r(n.h())})})},Ah.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Uh.store);return r.rs(function(t,e){e=nh(e),e=rh(n.serializer,e);return r.put(e)})},Ah),Th=function(t,e){this.seconds=t,this.nanoseconds=e},_h=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ah(t){this.serializer=t}function Nh(){this.index={}}function Sh(){this.ha=new Eh}_h.store="owner",_h.key="owner";var Dh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Dh.store="mutationQueues",Dh.keyPath="userId";var xh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};xh.store="mutations",xh.keyPath="batchId",xh.userMutationsIndex="userMutationsIndex",xh.userMutationsKeyPath=["userId","batchId"];var Lh=(kh.prefixForUser=function(t){return[t]},kh.prefixForPath=function(t,e){return[t,Hc(e)]},kh.key=function(t,e,n){return[t,Hc(e),n]},kh);function kh(){}Lh.store="documentMutations",Lh.PLACEHOLDER=new Lh;var Oh=function(t,e){this.path=t,this.readTime=e},Rh=function(t,e){this.path=t,this.version=e},Ph=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ph.store="remoteDocuments",Ph.readTimeIndex="readTimeIndex",Ph.readTimeIndexPath="readTime",Ph.collectionReadTimeIndex="collectionReadTimeIndex",Ph.collectionReadTimeIndexPath=["parentPath","readTime"];var Ch=function(t){this.byteSize=t};Ch.store="remoteDocumentGlobal",Ch.key="remoteDocumentGlobalKey";var Uh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Uh.store="targets",Uh.keyPath="targetId",Uh.queryTargetsIndexName="queryTargetsIndex",Uh.queryTargetsKeyPath=["canonicalId","targetId"];var Vh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Vh.store="targetDocuments",Vh.keyPath=["targetId","path"],Vh.documentTargetsIndex="documentTargetsIndex",Vh.documentTargetsKeyPath=["path","targetId"];var Mh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Mh.key="targetGlobalKey",Mh.store="targetGlobal";var Fh=function(t,e){this.collectionId=t,this.parent=e};function jh(t){t.createObjectStore(Vh.store,{keyPath:Vh.keyPath}).createIndex(Vh.documentTargetsIndex,Vh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Uh.store,{keyPath:Uh.keyPath}).createIndex(Uh.queryTargetsIndexName,Uh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Mh.store)}Fh.store="collectionParents",Fh.keyPath=["collectionId","parent"];var qh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};qh.store="clientMetadata",qh.keyPath="clientId";var Gh=i(i(i([Dh.store,xh.store,Lh.store,Ph.store,Uh.store,_h.store,Mh.store,Vh.store],[qh.store]),[Ch.store]),[Fh.store]),Bh=(zh.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return Na.resolve();var r=e._(),i=e.h();t.pr(function(){n.la.add(e)});i={collectionId:r,parent:Hc(i)};return Hh(t).put(i)},zh.prototype.Qr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[vi(i),""],!1,!0);return Hh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Wc(r.parent))}return o})},zh);function zh(){this.la=new Eh}function Hh(t){return nf.Qn(t,Fh.store)}var Kh=(Xh.prototype.next=function(){return this._a+=2,this._a},Xh.fa=function(){return new Xh(0)},Xh.da=function(){return new Xh(-1)},Xh),Wh=(Qh.prototype.wa=function(n){var r=this;return this.ma(n).next(function(t){var e=new Kh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},Qh.prototype.Ea=function(t){return this.ma(t).next(function(t){return xi.J(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Qh.prototype.Ia=function(t){return this.ma(t).next(function(t){return t.highestListenSequenceNumber})},Qh.prototype.Aa=function(e,n,r){var i=this;return this.ma(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.Z()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},Qh.prototype.Ra=function(e,n){var r=this;return this.ga(e,n).next(function(){return r.ma(e).next(function(t){return t.targetCount+=1,r.Pa(n,t),r.Ta(e,t)})})},Qh.prototype.ya=function(t,e){return this.ga(t,e)},Qh.prototype.Va=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Yh(e).delete(t.targetId)}).next(function(){return n.ma(e)}).next(function(t){return Rr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},Qh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Yh(n).rs(function(t,e){e=nh(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Va(n,e)))}).next(function(){return Na.xn(u)}).next(function(){return s})},Qh.prototype.Ce=function(t,n){return Yh(t).rs(function(t,e){e=nh(e);n(e)})},Qh.prototype.ma=function(t){return Jh(t).get(Mh.key).next(function(t){return Rr(null!==t),t})},Qh.prototype.Ta=function(t,e){return Jh(t).put(Mh.key,e)},Qh.prototype.ga=function(t,e){return Yh(t).put(rh(this.serializer,e))},Qh.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Qh.prototype.ba=function(t){return this.ma(t).next(function(t){return t.targetCount})},Qh.prototype.va=function(t,r){var e=ji(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Yh(t).rs({range:e,index:Uh.queryTargetsIndexName},function(t,e,n){e=nh(e);qi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Qh.prototype.Sa=function(n,t,r){var i=this,o=[],s=$h(n);return t.forEach(function(t){var e=Hc(t.path);o.push(s.put(new Vh(r,e))),o.push(i.No.Da(n,r,t))}),Na.xn(o)},Qh.prototype.Ca=function(n,t,r){var i=this,o=$h(n);return Na.forEach(t,function(t){var e=Hc(t.path);return Na.xn([o.delete([r,e]),i.No.Na(n,r,t)])})},Qh.prototype.pa=function(t,e){t=$h(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Qh.prototype.Fa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=$h(t),r=ho();return t.rs({range:e,ss:!0},function(t,e,n){t=Wc(t[1]),t=new Gr(t);r=r.add(t)}).next(function(){return r})},Qh.prototype.Ho=function(t,e){var e=Hc(e.path),e=IDBKeyRange.bound([e],[vi(e)],!1,!0),i=0;return $h(t).rs({index:Vh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Qh.prototype.Ue=function(t,e){return Yh(t).get(e).next(function(t){return t?nh(t):null})},Qh);function Qh(t,e){this.No=t,this.serializer=e}function Xh(t){this._a=t}function Yh(t){return nf.Qn(t,Uh.store)}function Jh(t){return nf.Qn(t,Mh.store)}function $h(t){return nf.Qn(t,Vh.store)}var Zh,tf="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ef=(n(of,Zh=Ee),of),nf=(rf.Qn=function(t,e){if(t instanceof ef)return Sa.Qn(t.jo,e);throw Or()},rf.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,tf);return e.Ha(),e.Ya(),e.Ja(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ka.Ia(t)})}).then(function(t){e.Ma=new oc(t,e.xa)}).then(function(){e.Oa=!0}).catch(function(t){return e.ja&&e.ja.close(),Promise.reject(t)})},rf.prototype.Xa=function(n){var t=this;return this.Qa=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ei?[2,n(e)]:[2]})})},n(this.isPrimary)},rf.prototype.Za=function(n){var t=this;this.ja.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},rf.prototype.tc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},rf.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return uf(e).put(new qh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ec(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Qa(!1)}))})}).next(function(){return n.nc(e)}).next(function(t){return n.isPrimary&&!t?n.sc(e).next(function(){return!1}):!!t&&n.ic(e).next(function(){return!0})})}).catch(function(t){if(Ca(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Qa(t)}),n.isPrimary=t})},rf.prototype.ec=function(t){var e=this;return sf(t).get(_h.key).next(function(t){return Na.resolve(e.rc(t))})},rf.prototype.oc=function(t){return uf(t).delete(this.clientId)},rf.prototype.ac=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=rf.Qn(t,qh.store);return r.ts().next(function(t){var e=o.uc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Na.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.hc(i.clientId));t.label=2;case 2:return[2]}})})},rf.prototype.Ja=function(){var t=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ac()}).then(function(){return t.Ja()})})},rf.prototype.rc=function(t){return!!t&&t.ownerId===this.clientId},rf.prototype.nc=function(e){var r=this;return this.ka?Na.resolve(!0):sf(e).get(_h.key).next(function(t){if(null!==t&&r.cc(t.leaseTimestampMs,5e3)&&!r.lc(t.ownerId)){if(r.rc(t)&&r.networkEnabled)return!0;if(!r.rc(t)){if(!t.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,tf);return!1}}return!(!r.networkEnabled||!r.inForeground)||uf(e).ts().next(function(t){return void 0===r.uc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},rf.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[_h.store,qh.store],function(t){var e=new ef(t,oc.ai);return n.sc(e).next(function(){return n.oc(e)})})];case 1:return t.sent(),this.ja.close(),this.wc(),[2]}})})},rf.prototype.uc=function(t,e){var n=this;return t.filter(function(t){return n.cc(t.updateTimeMs,e)&&!n.lc(t.clientId)})},rf.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return uf(t).ts().next(function(t){return e.uc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(rf.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),rf.prototype.mc=function(t){return ih.$o(t,this.serializer,this.Dr,this.No)},rf.prototype.Tc=function(){return this.Ka},rf.prototype.Ec=function(){return this.vr},rf.prototype.Ic=function(){return this.Dr},rf.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ja.runTransaction(e,t,Gh,function(t){return o=new ef(t,i.Ma?i.Ma.next():oc.ai),"readwrite-primary"===n?i.ec(o).next(function(t){return!!t||i.nc(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Qa(!1)}),new Tr(Ir.FAILED_PRECONDITION,wc);return r(o)}).next(function(t){return i.ic(o).next(function(){return t})}):i.Ac(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},rf.prototype.Ac=function(t){var e=this;return sf(t).get(_h.key).next(function(t){if(null!==t&&e.cc(t.leaseTimestampMs,5e3)&&!e.lc(t.ownerId)&&!e.rc(t)&&!(e.ka||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Tr(Ir.FAILED_PRECONDITION,tf)})},rf.prototype.ic=function(t){var e=new _h(this.clientId,this.allowTabSynchronization,Date.now());return sf(t).put(_h.key,e)},rf.Ln=function(){return Sa.Ln()},rf.prototype.sc=function(t){var e=this,n=sf(t);return n.get(_h.key).next(function(t){return e.rc(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(_h.key)):Na.resolve()})},rf.prototype.cc=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},rf.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},rf.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},rf.prototype.Ya=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e._c(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},rf.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},rf.prototype.lc=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.hc(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},rf.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},rf.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(t){}},rf.prototype.hc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},rf);function rf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.xa=a,this.ka=c,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(t){return Promise.resolve()},!rf.Ln())throw new Tr(Ir.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new af(this,r),this.Wa=e+"main",this.serializer=new Qc(u),this.ja=new Sa(this.Wa,10,new Ih(this.serializer)),this.Ka=new Wh(this.No,this.serializer),this.Dr=new Bh,this.vr=(e=this.serializer,u=this.Dr,new lh(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function of(t,e){var n=this;return(n=Zh.call(this)||this).jo=t,n.$a=e,n}function sf(t){return nf.Qn(t,_h.store)}function uf(t){return nf.Qn(t,qh.store)}var af=(cf.prototype.Po=function(t){var n=this.Rc(t);return this.db.Tc().ba(t).next(function(e){return n.next(function(t){return e+t})})},cf.prototype.Rc=function(t){var e=0;return this.Vo(t,function(t){e++}).next(function(){return e})},cf.prototype.Ce=function(t,e){return this.db.Tc().Ce(t,e)},cf.prototype.Vo=function(t,n){return this.gc(t,function(t,e){return n(e)})},cf.prototype.Da=function(t,e,n){return hf(t,n)},cf.prototype.Na=function(t,e,n){return hf(t,n)},cf.prototype.po=function(t,e,n){return this.db.Tc().po(t,e,n)},cf.prototype.Go=hf,cf.prototype.Pc=function(t,e){return r=e,i=!1,hh(n=t).os(function(t){return sh(n,t,r).next(function(t){return t&&(i=!0),Na.resolve(!t)})}).next(function(){return i});var n,r,i},cf.prototype.bo=function(n,r){var i=this,o=this.db.Ec().ra(),s=[],u=0;return this.gc(n,function(e,t){t<=r&&(t=i.Pc(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),$h(n).delete([0,Hc(e.path)])})}),s.push(t))}).next(function(){return Na.xn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},cf.prototype.removeTarget=function(t,e){e=e.st(t.$a);return this.db.Tc().ya(t,e)},cf.prototype.yc=hf,cf.prototype.gc=function(t,r){var i,t=$h(t),o=oc.ai;return t.rs({index:Vh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==oc.ai&&r(new Gr(Wc(i)),o),o=e,i=t):o=oc.ai}).next(function(){o!==oc.ai&&r(new Gr(Wc(i)),o)})},cf.prototype.So=function(t){return this.db.Ec().aa(t)},cf);function cf(t,e){this.db=t,this.wo=new Gc(this,e)}function hf(t,e){return $h(t).put((t=t.$a,new Vh(0,Hc(e.path),t)))}function ff(t,e){var n=t.projectId;return t.j||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var lf=(pf.prototype.Io=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bc)})},pf);function pf(t,e,n){this.persistence=t,this.Vc=e,this.bc=new Xi(di),this.vc=new Si(ji,qi),this.Sc=xi.min(),this.Sr=t.mc(n),this.Dc=t.Ec(),this.Ka=t.Tc(),this.Cc=new bc(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}function df(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Dc.ra({oa:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=Na.resolve(),n.forEach(function(n){u=u.next(function(){return o.Rr(r,n)}).next(function(t){var e=t,t=i.dr.get(n);Rr(null!==t),(!e||e.version.L(t)<0)&&(e=s.cr(n,e,i))&&o.Er(e,i._r)})}),u.next(function(){return e.Sr.Wo(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Cc.kr(t,a)})})}function yf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ka.Ea(t)})}function vf(t,a){var c=t,h=a.nt,f=c.bc;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Dc.ra({oa:!0});f=c.bc;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ka.Ca(s,t.se,e).next(function(){return c.Ka.Sa(s,t.ee,e)})),0<(i=t.resumeToken).O()&&(n=o.it(i,h).st(s.$a),f=f.ot(e,n),r=o,i=t,Rr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.Ka.ya(s,n))))});var t,o=io,n=ho();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof _u&&e.version.isEqual(xi.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Er(e,h),o=o.ot(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(c.persistence.No.yc(s,t))})})),h.isEqual(xi.min())||(t=c.Ka.Ea(s).next(function(t){return c.Ka.Aa(s,s.$a,h)}),u.push(t)),Na.xn(u).next(function(){return i.apply(s)}).next(function(){return c.Cc.Mr(s,o)})}).then(function(t){return c.bc=f,t})}function gf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ka.va(e,r).next(function(t){return t?(n=t,Na.resolve(n)):i.Ka.wa(e).next(function(t){return n=new Hi(r,t,0,e.$a),i.Ka.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bc.get(t.targetId);return(null===e||0<t.nt.L(e.nt))&&(i.bc=i.bc.ot(t.targetId,t),i.vc.set(r,t.targetId)),t})}function mf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ca(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bc=e.bc.remove(o),e.vc.delete(n.target),[2]}})})}function wf(t,o,s){var u=t,a=xi.min(),c=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Mu(o),(void 0!==(t=(i=t).vc.get(r))?Na.resolve(i.bc.get(t)):i.Ka.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ka.Fa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Vc.Lr(e,o,s?a:xi.min(),s?c:ho())}).next(function(t){return{documents:t,Fc:c}});var t,n,r,i})}function bf(t,e){var n=t,r=n.Ka,t=n.bc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function Ef(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Dc,n=t,t=s.Sc,r=e,i=io,o=Jc(t),t=gh(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:Ph.readTimeIndex,range:n},function(t,e){var n=Xc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{$c:i,readTime:$c(o)}});var e,n,r,i,o}).then(function(t){var e=t.$c,t=t.readTime;return s.Sc=t,e})}function If(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=gh(t),r=xi.min(),t.rs({index:Ph.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=$c(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Sc=t})]})})}function Tf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==wc)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function _f(t,e){this.user=e,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+t}function Af(t,e,n,r,i){var o=this;this.ju=t,this.Ku=e,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=i,this.Xu.Zu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ol(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(4),[4,Jf(e)];case 1:return t.sent(),e.th.set("Unknown"),e.Yu.delete(4),[4,Yf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.th=new Mf(n,r)}var Nf,Sf,Df,xf=(Xf.prototype.m=function(){return this.xc.m()},Xf.prototype.Da=function(t,e){e=new Lf(t,e);this.xc=this.xc.add(e),this.Mc=this.Mc.add(e)},Xf.prototype.Lc=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},Xf.prototype.Na=function(t,e){this.Bc(new Lf(t,e))},Xf.prototype.qc=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},Xf.prototype.Uc=function(t){var e=this,n=new Gr(new Fr([])),r=new Lf(n,t),t=new Lf(n,t+1),i=[];return this.Mc.Ft([r,t],function(t){e.Bc(t),i.push(t.key)}),i},Xf.prototype.Qc=function(){var e=this;this.xc.forEach(function(t){return e.Bc(t)})},Xf.prototype.Bc=function(t){this.xc=this.xc.delete(t),this.Mc=this.Mc.delete(t)},Xf.prototype.Wc=function(t){var e=new Gr(new Fr([])),n=new Lf(e,t),t=new Lf(e,t+1),r=ho();return this.Mc.Ft([n,t],function(t){r=r.add(t.key)}),r},Xf.prototype.Ho=function(t){var e=new Lf(t,0),e=this.xc.xt(e);return null!==e&&t.isEqual(e.key)},Xf),Lf=(Qf.kc=function(t,e){return Gr.i(t.key,e.key)||di(t.jc,e.jc)},Qf.Oc=function(t,e){return di(t.jc,e.jc)||Gr.i(t.key,e.key)},Qf),kf=(Wf.prototype.getToken=function(){return Promise.resolve(null)},Wf.prototype.zc=function(){},Wf.prototype.Hc=function(t){(this.Gc=t)(nc.UNAUTHENTICATED)},Wf.prototype.Yc=function(){this.Gc=null},Wf),Of=(Kf.prototype.getToken=function(){var e=this,n=this.Zc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Zc!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new _f(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Kf.prototype.zc=function(){this.forceRefresh=!0},Kf.prototype.Hc=function(t){this.Gc=t,this.Xc&&t(this.currentUser)},Kf.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},Kf.prototype.tu=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new nc(t)},Kf),Rf=(Object.defineProperty(Hf.prototype,"Kc",{get:function(){var t={"X-Goog-AuthUser":this.nu},e=this.eu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Hf),Pf=(zf.prototype.getToken=function(){return Promise.resolve(new Rf(this.eu,this.nu))},zf.prototype.Hc=function(t){t(nc.ni)},zf.prototype.Yc=function(){},zf.prototype.zc=function(){},zf),Ie=(Bf.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},Bf.prototype.uu=function(){return 2===this.state},Bf.prototype.start=function(){3!==this.state?this.auth():this.hu()},Bf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bf.prototype.lu=function(){this.state=0,this.ys.reset()},Bf.prototype._u=function(){var t=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,function(){return t.fu()}))},Bf.prototype.du=function(t){this.wu(),this.stream.send(t)},Bf.prototype.fu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uu()?[2,this.close(0)]:[2]})})},Bf.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},Bf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==e?this.ys.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===Ir.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},Bf.prototype.mu=function(){},Bf.prototype.auth=function(){var n=this;this.state=1;var t=this.Eu(this.ou),e=this.ou;this.ru.getToken().then(function(t){n.ou===e&&n.Iu(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Au(t)})})},Bf.prototype.Iu=function(t){var e=this,n=this.Eu(this.ou);this.stream=this.Ru(t),this.stream.gu(function(){n(function(){return e.state=2,e.listener.gu()})}),this.stream.Tu(function(t){n(function(){return e.Au(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Bf.prototype.hu=function(){var t=this;this.state=4,this.ys.gn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Bf.prototype.Au=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Bf.prototype.Eu=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ou===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Bf),Cf=(n(Gf,Df=Ie),Gf.prototype.Ru=function(t){return this.iu.Pu("Listen",t)},Gf.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Or(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(Rr(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(Rr(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Qi(s.code),new Tr(o,s.message||"")),r=new bo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=as(t,u.document.name),a=is(u.document.updateTime),s=new du({mapValue:{fields:u.document.fields}}),a=new Tu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new mo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=as(t,u.document),c=u.readTime?is(u.readTime):xi.min(),c=new _u(a,c),u=u.removedTargetIds||[];r=new mo([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=as(t,c.document),c=c.removedTargetIds||[];r=new mo([],c,h,null)}else{if(!("filter"in e))return Or();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Bi(e),h=h.targetId;r=new wo(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return xi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?is(t.readTime):xi.min()}(t);return this.listener.yu(e,t)},Gf.prototype.Vu=function(t){var e,n,r,i={};i.database=fs(this.serializer),i.addTarget=(e=this.serializer,(r=Gi(r=(n=t).target)?{documents:vs(e,r)}:{query:gs(e,r)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=rs(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.du(i)},Gf.prototype.pu=function(t){var e={};e.database=fs(this.serializer),e.removeTarget=t,this.du(e)},Gf),Uf=(n(qf,Sf=Ie),Object.defineProperty(qf.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),qf.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,Sf.prototype.start.call(this)},qf.prototype.mu=function(){this.bu&&this.Su([])},qf.prototype.Ru=function(t){return this.iu.Pu("Write",t)},qf.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.bu){this.ys.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Rr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?is(t.updateTime):is(e);n.isEqual(xi.min())&&(n=is(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Hs(n,e)}(t,r)})):[]),n=is(t.commitTime);return this.listener.Du(n,e)}var n,r;return Rr(!t.writeResults||0===t.writeResults.length),this.bu=!0,this.listener.Cu()},qf.prototype.Nu=function(){var t={};t.database=fs(this.serializer),this.du(t)},qf.prototype.Su=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ds(e.serializer,t)})};this.du(t)},qf),Vf=(n(jf,Nf=function(){}),jf.prototype.$u=function(){if(this.Fu)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},jf.prototype.xu=function(e,n,r){var i=this;return this.$u(),this.credentials.getToken().then(function(t){return i.iu.xu(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.zc(),t})},jf.prototype.ku=function(e,n,r){var i=this;return this.$u(),this.credentials.getToken().then(function(t){return i.iu.ku(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.zc(),t})},jf.prototype.terminate=function(){this.Fu=!1},jf),Mf=(Ff.prototype.Bu=function(){var t=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,function(){return t.Ou=null,t.Uu("Backend didn't respond within 10 seconds."),t.qu("Offline"),Promise.resolve()}))},Ff.prototype.Qu=function(t){"Online"===this.state?this.qu("Unknown"):(this.Mu++,1<=this.Mu&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.qu("Offline")))},Ff.prototype.set=function(t){this.Wu(),this.Mu=0,"Online"===t&&(this.Lu=!1),this.qu(t)},Ff.prototype.qu=function(t){t!==this.state&&(this.state=t,this.di(t))},Ff.prototype.Uu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Lu?(xr(t),this.Lu=!1):Dr("OnlineStateTracker",t)},Ff.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},Ff);function Ff(t,e){this.cs=t,this.di=e,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}function jf(t,e,n){var r=this;return(r=Nf.call(this)||this).credentials=t,r.iu=e,r.serializer=n,r.Fu=!1,r}function qf(t,e,n,r,i){var o=this;return(o=Sf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.bu=!1,o}function Gf(t,e,n,r,i){var o=this;return(o=Df.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Bf(t,e,n,r,i,o){this.fn=t,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new Aa(t,e)}function zf(t,e){this.eu=t,this.nu=e}function Hf(t,e){this.eu=t,this.nu=e,this.type="FirstParty",this.user=nc.ni}function Kf(t){var e=this;this.Jc=null,this.currentUser=nc.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){e.Zc++,e.currentUser=e.tu(),e.Xc=!0,e.Gc&&e.Gc(e.currentUser)},this.Zc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),t.get().then(function(t){e.auth=t,e.Jc&&e.auth.addAuthTokenListener(e.Jc)},function(){}))}function Wf(){this.Gc=null}function Qf(t,e){this.key=t,this.jc=e}function Xf(){this.xc=new no(Lf.kc),this.Mc=new no(Lf.Oc)}function Yf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ol(r))return[3,4];e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Jf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $f(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Yu.add(5),[4,Jf(e)];case 1:return t.sent(),e.Xu.Di(),e.th.set("Unknown"),[2]}})})}function Zf(t,e){t.Hu.has(e.targetId)||(t.Hu.set(e.targetId,e),il(t)?rl(t):dl(t).uu()&&el(t,e))}function tl(t,e){var n=t,t=dl(n);n.Hu.delete(e),t.uu()&&nl(n,e),0===n.Hu.size&&(t.uu()?t._u():ol(n)&&n.th.set("Unknown"))}function el(t,e){t.eh.Ie(e.targetId),dl(t).Vu(e)}function nl(t,e){t.eh.Ie(e),dl(t).pu(e)}function rl(e){e.eh=new Io({qe:function(t){return e.Gu.qe(t)},Ue:function(t){return e.Hu.get(t)||null}}),dl(e).start(),e.th.Bu()}function il(t){return ol(t)&&!dl(t).cu()&&0<t.Hu.size}function ol(t){return 0===t.Yu.size}function sl(t){t.eh=void 0}function ul(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.th.set("Online"),!(u instanceof bo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Hu.has(i)?[4,o.Gu.nh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Hu.delete(i),o.eh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,al(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof mo?s.eh.be(u):u instanceof wo?s.eh.xe(u):s.eh.De(u),a.isEqual(xi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,yf(s.ju)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).eh.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.O()&&((n=r.Hu.get(e))&&r.Hu.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.Hu.get(t);e&&(r.Hu.set(t,e.it(gi.B,e.nt)),nl(r,t),e=new Hi(e.target,t,1,e.sequenceNumber),el(r,e))}),r.Gu.sh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,al(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function al(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ca(r))throw r;return n.Yu.add(1),[4,Jf(n)];case 1:return t.sent(),n.th.set("Offline"),i=i||function(){return yf(n.ju)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Yu.delete(1),[4,Yf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function cl(e,n){return n().catch(function(t){return al(e,t,n)})}function hl(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=yl(i=a),s=0<i.zu.length?i.zu[i.zu.length-1].batchId:-1,t.label=1;case 1:if(!(ol(i)&&i.zu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.ju,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Sr.Bo(t,n)}))];case 3:return null===(u=t.sent())?(0===i.zu.length&&o._u(),[3,7]):(s=u.batchId,function(t,e){t.zu.push(e);t=yl(t);t.uu()&&t.vu&&t.Su(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,al(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return fl(i)&&ll(i),[2]}var e,n,r})})}function fl(t){return ol(t)&&!yl(t).cu()&&0<t.zu.length}function ll(t){yl(t).start()}function pl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Yu.delete(2),[4,Yf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Yu.add(2),[4,Jf(e)]);case 3:t.sent(),e.th.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function dl(n){var t,e,r,i=this;return n.oh||(n.oh=(t=n.Ku,e=n.cs,r={gu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Hu.forEach(function(t,e){el(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return sl(e),il(e)?(e.th.Qu(n),rl(e)):e.th.set("Unknown"),[2]})})}.bind(null,n),yu:ul.bind(null,n)},t.$u(),new Cf(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oh.lu(),il(n)?rl(n):n.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oh.stop()];case 2:t.sent(),sl(n),t.label=3;case 3:return[2]}})})})),n.oh}function yl(n){var t,e,r,i=this;return n.ah||(n.ah=(t=n.Ku,e=n.cs,r={gu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return yl(e).Nu(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&yl(e).vu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Wi(n=i.code)&&n!==Ir.ABORTED?(e=r.zu.shift(),yl(r).lu(),[4,cl(r,function(){return r.Gu.rh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,hl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return fl(e)&&ll(e),[2]}})})}.bind(null,n),Cu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=yl(o),n=0,r=o.zu;n<r.length;n++)i=r[n],e.Su(i.mutations);return[2]})})}.bind(null,n),Du:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.zu.shift(),n=mc.from(e,i,o),[4,cl(r,function(){return r.Gu.ih(n)})];case 1:return t.sent(),[4,hl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.$u(),new Uf(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ah.lu(),[4,hl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ah.stop()];case 3:t.sent(),0<n.zu.length&&(Dr("RemoteStore","Stopping write stream with "+n.zu.length+" pending writes"),n.zu=[]),t.label=4;case 4:return[2]}})})})),n.ah}var vl=function(t){this.key=t},gl=function(t){this.key=t},ml=(Object.defineProperty(Tl.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),Tl.prototype.wh=function(t,e){var s=this,u=e?e.mh:new po,a=(e||this).fh,c=(e||this).Wt,h=a,f=!1,l=Ou(this.query)&&a.size===this.query.limit?a.last():null,p=Ru(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof Tu?e:null)&&(Hu(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Je||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s._h(r,l)||p&&s._h(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Ou(this.query)||Ru(this.query))for(;h.size>this.query.limit;){var n=Ou(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,mh:u,Eh:f,Wt:c}},Tl.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Tl.prototype.yr=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Wt=t.Wt;var i=t.mh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}}var r,i}),this.Ih(n);var s=e?this.Ah():[],n=0===this.lh.size&&this.te?1:0,e=n!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new yo(this.query,t.fh,r,i,t.Wt,0==n,e,!1),Rh:s}:{Rh:s}},Tl.prototype.Qs=function(t){return this.te&&"Offline"===t?(this.te=!1,this.yr({fh:this.fh,mh:new po,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},Tl.prototype.gh=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},Tl.prototype.Ih=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},Tl.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=ho(),this.fh.forEach(function(t){e.gh(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new gl(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new vl(t))}),r},Tl.prototype.Ph=function(t){this.uh=t.Fc,this.lh=ho();t=this.wh(t.documents);return this.yr(t,!0)},Tl.prototype.yh=function(){return yo.Gt(this.query,this.fh,this.Wt,0===this.hh)},Tl),wl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},bl=function(t){this.key=t,this.Vh=!1},El=(Object.defineProperty(Il.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),Il);function Il(t,e,n,r,i,o){this.ju=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new Si(Bu,Gu),this.Fh=new Map,this.$h=[],this.xh=new Xi(Gr.i),this.kh=new Map,this.Mh=new xf,this.Oh={},this.Lh=new Map,this.Bh=Kh.da(),this.onlineState="Unknown",this.qh=void 0}function Tl(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=ho(),this.Wt=ho(),this._h=Ku(t),this.fh=new lo(this._h)}function _l(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Eh?[4,wf(r.ju,i.query,!1).then(function(t){t=t.documents;return i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.yr(e,r.Uh,n),[2,(Ol(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,wf(i.ju,o,!0)];case 1:return n=t.sent(),r=new ml(o,n.Fc),e=r.wh(n.documents),n=go.Zt(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Uh,n),Ol(i,s,n.Rh),r=new wl(o,s,r),[2,(i.Nh.set(o,r),i.Fh.has(s)?i.Fh.get(s).push(o):i.Fh.set(s,[o]),n.snapshot)]}})})}function Al(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,vf(n.ju,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.kh.get(e);e&&(Rr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Vh=!0:0<t.ne.size?Rr(e.Vh):0<t.se.size&&(Rr(e.Vh),e.Vh=!1))}),[4,Pl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Nl(t,n,e){var r,t=t;(t.Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){e=e.view.Qs(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Qs(i)&&(o=!0)}),o&&tc(t)}(t.bh,n),r.length&&t.Ch.yu(r),t.onlineState=n,t.Uh&&t.Sh.Ki(n))}function Sl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.Oo(e,r).next(function(t){return Rr(null!==t),n=t.keys(),i.Sr.Wo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Cc.kr(e,n)})}))];case 2:return o=t.sent(),xl(n,u,a),Dl(n,u),n.Sh.ki(u,"rejected",a),[4,Pl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Dl(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function xl(t,e,n){var r=t,i=r.Oh[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Oh[r.currentUser.ti()]=i)}function Ll(e,t,n){void 0===n&&(n=null),e.Sh.Bi(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Wh(o,n)}e.Fh.delete(t),e.Uh&&e.Mh.Uc(t).forEach(function(t){e.Mh.Ho(t)||kl(e,t)})}function kl(t,e){var n=t.xh.get(e);null!==n&&(tl(t.ph,n),t.xh=t.xh.remove(e),t.kh.delete(n),Rl(t))}function Ol(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof vl?(t.Mh.Da(o.key,e),function(t,e){e=e.key;t.xh.get(e)||(Dr("SyncEngine","New document in limbo: "+e),t.$h.push(e),Rl(t))}(t,o)):o instanceof gl?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Mh.Na(o.key,e),t.Mh.Ho(o.key)||kl(t,o.key)):Or()}}function Rl(t){for(;0<t.$h.length&&t.xh.size<t.Dh;){var e=t.$h.shift(),n=t.Bh.next();t.kh.set(n,new bl(e)),t.xh=t.xh.ot(e,n),Zf(t.ph,new Hi(Mu(ku(e.path)),n,2,oc.ai))}}function Pl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.m()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Qh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ec.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.yu(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Na.forEach(c,function(e){return Na.forEach(e.Kr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return Na.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bc.get(o),u=s.nt,u=s.rt(u),r.bc=r.bc.ot(o,u));return[2]}})})}(n.ju,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Cl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Cc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new bc(e.Dc,n,e.persistence.Ic()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.kr(v,r).next(function(t){return{jh:t,Kh:e,Gh:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Cc=m,e.Vc.Nc(e.Cc),r)]}})})}(n.ju,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.ji(o,r.Kh,r.Gh),[4,Pl(n,r.jh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Ul(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).ju,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Cc.kr(e,t):Na.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,hl(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(xl(o,a,h||null),Dl(o,a),o.ju.Sr.Ko(a)):Or(),t.label=4;case 4:return[4,Pl(o,s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Vl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return jl(r=h),ql(r),!0!==f||!0===r.qh?[3,3]:(e=r.Sh.Ci(),[4,Ml(r,e.A())]);case 1:return i=t.sent(),r.qh=!0,[4,pl(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Zf(r.ph,u);return[3,7];case 3:return!1!==f||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.Fh.forEach(function(t,e){r.Sh.qi(e)?a.push(e):c=c.then(function(){return Ll(r,e),mf(r.ju,e,!0)}),tl(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,Ml(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){tl(n.ph,e)}),n.Mh.Qc(),n.kh=new Map,n.xh=new Xi(Gr.i),r.qh=!1,[4,pl(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Ml(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Fh.get(s))&&0!==a.length?[4,gf(e.ju,Mu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,wf((e=r).ju,i.query,!0)];case 1:return n=t.sent(),n=i.view.Ph(n),[2,(e.Uh&&Ol(e,i.targetId,n.Rh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,bf(e.ju,s)];case 8:return l=t.sent(),[4,gf(e.ju,l)];case 9:return u=t.sent(),[4,_l(e,Fl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.yu(r),n)]}})})}function Fl(t){return Lu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function jl(t){return t.ph.Gu.sh=Al.bind(null,t),t.ph.Gu.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.Vh)return ho().add(t.key);var r=ho();if(!(e=n.Fh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Gu.nh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Qi(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new Xi(Gr.i)).ot(n,new _u(n,xi.min())),i=ho().add(n),i=new vo(xi.min(),new Map,new no(di),r,i),[4,Al(e,i)]):[3,2];case 1:return t.sent(),e.xh=e.xh.remove(n),e.kh.delete(s),Rl(e),[3,4];case 2:return[4,mf(e.ju,s,!1).then(function(){return Ll(e,s,u)}).catch(Tf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.yu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Bs.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ws(s)&&(r=!0);u.Ls=s}}r&&tc(n)}.bind(null,t.bh),t.Ch.Wh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function ql(t){return t.ph.Gu.ih=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,df(e.ju,o)];case 2:return r=t.sent(),xl(e,n,null),Dl(e,n),e.Sh.ki(n,"acknowledged"),[4,Pl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Tf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.ph.Gu.rh=Sl.bind(null,t),t}var Gl,Bl,zl,Hl=(vp.prototype.Nc=function(t){this.zh=t},vp.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.p())||i.isEqual(xi.min())?this.Hh(e,r):this.zh.kr(e,o).next(function(t){var n=s.Yh(r,t);return(Ou(r)||Ru(r))&&s.Eh(r.an,n,o,i)?s.Hh(e,r):(Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zu(r)),s.zh.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},vp.prototype.Yh=function(n,t){var r=new no(Ku(n));return t.forEach(function(t,e){e instanceof Tu&&Hu(n,e)&&(r=r.add(e))}),r},vp.prototype.Eh=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.L(r))},vp.prototype.Hh=function(t,e){return Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",zu(e)),this.zh.Lr(t,e,xi.min())},vp),Kl=(yp.prototype.xo=function(t){return Na.resolve(0===this.Sr.length)},yp.prototype.ko=function(t,e,n,r){var i=this.Jh;this.Jh++,0<this.Sr.length&&this.Sr[this.Sr.length-1];n=new gc(i,e,n,r);this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xh=this.Xh.add(new Lf(u.key,i)),this.Dr.Mo(t,u.key.path.h())}return Na.resolve(n)},yp.prototype.Oo=function(t,e){return Na.resolve(this.Zh(e))},yp.prototype.Bo=function(t,e){e+=1,e=this.tl(e),e=e<0?0:e;return Na.resolve(this.Sr.length>e?this.Sr[e]:null)},yp.prototype.qo=function(){return Na.resolve(0===this.Sr.length?-1:this.Jh-1)},yp.prototype.Uo=function(t){return Na.resolve(this.Sr.slice())},yp.prototype.Nr=function(t,e){var n=this,r=new Lf(e,0),e=new Lf(e,Number.POSITIVE_INFINITY),i=[];return this.Xh.Ft([r,e],function(t){t=n.Zh(t.jc);i.push(t)}),Na.resolve(i)},yp.prototype.Or=function(t,e){var n=this,r=new no(di);return e.forEach(function(t){var e=new Lf(t,0),t=new Lf(t,Number.POSITIVE_INFINITY);n.Xh.Ft([e,t],function(t){r=r.add(t.jc)})}),Na.resolve(this.el(r))},yp.prototype.Wr=function(t,e){var n=e.path,r=n.length+1,e=n;Gr.F(e)||(e=e.child(""));var e=new Lf(new Gr(e),0),i=new no(di);return this.Xh.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.jc)),!0)},e),Na.resolve(this.el(i))},yp.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Zh(t);null!==t&&n.push(t)}),n},yp.prototype.Wo=function(n,r){var i=this;Rr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xh;return Na.forEach(r.mutations,function(t){var e=new Lf(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xh=o})},yp.prototype.Ko=function(t){},yp.prototype.Ho=function(t,e){var n=new Lf(e,0),n=this.Xh.xt(n);return Na.resolve(e.isEqual(n&&n.key))},yp.prototype.zo=function(t){return this.Sr.length,Na.resolve()},yp.prototype.nl=function(t,e){return this.tl(t)},yp.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},yp.prototype.Zh=function(t){t=this.tl(t);return t<0||t>=this.Sr.length?null:this.Sr[t]},yp),Wl=(dp.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:i,readTime:n}),this.size+=i-o,this.Dr.Mo(t,r.path.h())},dp.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dp.prototype.Rr=function(t,e){e=this.docs.get(e);return Na.resolve(e?e.ta:null)},dp.prototype.getEntries=function(t,e){var n=this,r=io;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),Na.resolve(r)},dp.prototype.Lr=function(t,e,n){for(var r=uo,i=new Gr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.ta,a=a.readTime;if(!e.path.T(u.path))break;a.L(n)<=0||s instanceof Tu&&Hu(e,s)&&(r=r.ot(s.key,s))}return Na.resolve(r)},dp.prototype.il=function(t,e){return Na.forEach(this.docs,function(t){return e(t)})},dp.prototype.ra=function(t){return new Ql(this)},dp.prototype.aa=function(t){return Na.resolve(this.size)},dp),Ql=(n(pp,zl=h),pp.prototype.yr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ca.Er(n,e,r.readTime)):r.ca.Ar(t)}),Na.xn(i)},pp.prototype.gr=function(t,e){return this.ca.Rr(t,e)},pp.prototype.Pr=function(t,e){return this.ca.getEntries(t,e)},pp),Xl=(lp.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),Na.resolve()},lp.prototype.Ea=function(t){return Na.resolve(this.lastRemoteSnapshotVersion)},lp.prototype.Ia=function(t){return Na.resolve(this.ol)},lp.prototype.wa=function(t){return this.highestTargetId=this.cl.next(),Na.resolve(this.highestTargetId)},lp.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),Na.resolve()},lp.prototype.ga=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cl=new Kh(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},lp.prototype.Ra=function(t,e){return this.ga(e),this.targetCount+=1,Na.resolve()},lp.prototype.ya=function(t,e){return this.ga(e),Na.resolve()},lp.prototype.Va=function(t,e){return this.rl.delete(e.target),this.al.Uc(e.targetId),--this.targetCount,Na.resolve()},lp.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),Na.xn(u).next(function(){return s})},lp.prototype.ba=function(t){return Na.resolve(this.targetCount)},lp.prototype.va=function(t,e){e=this.rl.get(e)||null;return Na.resolve(e)},lp.prototype.Sa=function(t,e,n){return this.al.Lc(e,n),Na.resolve()},lp.prototype.Ca=function(e,t,n){this.al.qc(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),Na.xn(i)},lp.prototype.pa=function(t,e){return this.al.Uc(e),Na.resolve()},lp.prototype.Fa=function(t,e){e=this.al.Wc(e);return Na.resolve(e)},lp.prototype.Ho=function(t,e){return Na.resolve(this.al.Ho(e))},lp),Yl=(fp.prototype.start=function(){return Promise.resolve()},fp.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty(fp.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),fp.prototype.Za=function(){},fp.prototype.tc=function(){},fp.prototype.Ic=function(){return this.Dr},fp.prototype.mc=function(t){var e=this.ul[t.ti()];return e||(e=new Kl(this.Dr,this.No),this.ul[t.ti()]=e),e},fp.prototype.Tc=function(){return this.Ka},fp.prototype.Ec=function(){return this.vr},fp.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Jl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).Fn().then(function(t){return i.br(),t})},fp.prototype.fl=function(e,n){return Na.kn(Object.values(this.ul).map(function(t){return function(){return t.Ho(e,n)}}))},fp),Jl=(n(hp,Bl=Ee),hp),$l=(cp.ml=function(t){return new cp(t)},Object.defineProperty(cp.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw Or()},enumerable:!1,configurable:!0}),cp.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),Na.resolve()},cp.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),Na.resolve()},cp.prototype.Go=function(t,e){return this.Tl.add(e.toString()),Na.resolve()},cp.prototype.removeTarget=function(t,e){var n=this;this.dl.Uc(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Tc();return r.Fa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.Va(t,e)})},cp.prototype.ll=function(){this.wl=new Set},cp.prototype._l=function(n){var r=this,i=this.persistence.Ec().ra();return Na.forEach(this.Tl,function(t){var e=Gr.D(t);return r.El(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},cp.prototype.yc=function(t,e){var n=this;return this.El(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},cp.prototype.hl=function(t){return 0},cp.prototype.El=function(t,e){var n=this;return Na.kn([function(){return Na.resolve(n.dl.Ho(e))},function(){return n.persistence.Tc().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},cp),Zl=(ap.prototype.gu=function(t){this.Rl=t},ap.prototype.Tu=function(t){this.gl=t},ap.prototype.onMessage=function(t){this.Pl=t},ap.prototype.close=function(){this.Al()},ap.prototype.send=function(t){this.Il(t)},ap.prototype.yl=function(){this.Rl()},ap.prototype.Vl=function(t){this.gl(t)},ap.prototype.pl=function(t){this.Pl(t)},ap),tp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ep=(up.prototype.xu=function(e,t,n,r){var i=this.Dl(e,t);Dr("RestConnection","Sending: ",i,n);t={};return this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw Lr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},up.prototype.ku=function(t,e,n,r){return this.xu(t,e,n,r)},up.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0-20209141635",t["Content-Type"]="text/plain",e)for(var n in e.Kc)e.Kc.hasOwnProperty(n)&&(t[n]=e.Kc[n])},up.prototype.Dl=function(t,e){t=tp[t];return this.vl+"/v1/"+e+":"+t},n(sp,Gl=up),sp.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},sp.prototype.Pu=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Dr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Zl({Il:function(t){u?Dr("Connection","Not sending because WebChannel is closed:",t):(s||(Dr("Connection","Opening WebChannel transport."),o.open(),s=!0),Dr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(gr.EventType.OPEN,function(){u||Dr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Dr("Connection","WebChannel transport closed"),a.Vl())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Lr("Connection","WebChannel transport errored:",t),a.Vl(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Rr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zi[r];if(void 0!==t)return Qi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Vl(new Tr(t,i)),o.close()):(Dr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.yl()},0),a},sp),np=(op.prototype.Zu=function(t){this.Ml.push(t)},op.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.xl)},op.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.xl)},op.prototype.$l=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},op.prototype.kl=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},op.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},op),rp=(ip.prototype.Zu=function(t){},ip.prototype.Di=function(){},ip);function ip(){}function op(){var t=this;this.Fl=function(){return t.$l()},this.xl=function(){return t.kl()},this.Ml=[],this.Ol()}function sp(t){var e=this;return(e=Gl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.W=t.W,e}function up(t){this.bl=t,this.U=t.U;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function ap(t){this.Il=t.Il,this.Al=t.Al}function cp(t){this.persistence=t,this.dl=new xf,this.wl=null}function hp(t){var e=this;return(e=Bl.call(this)||this).$a=t,e}function fp(t){var e=this;this.ul={},this.Ma=new oc(0),this.Oa=!1,this.Oa=!0,this.No=t(this),this.Ka=new Xl(this),this.Dr=new bh,this.vr=(t=this.Dr,new Wl(t,function(t){return e.No.hl(t)}))}function lp(t){this.persistence=t,this.rl=new Si(ji,qi),this.lastRemoteSnapshotVersion=xi.min(),this.highestTargetId=0,this.ol=0,this.al=new xf,this.targetCount=0,this.cl=Kh.fa()}function pp(t){var e=this;return(e=zl.call(this)||this).ca=t,e}function dp(t,e){this.Dr=t,this.sl=e,this.docs=new Xi(Gr.i),this.size=0}function yp(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Jh=1,this.Xh=new no(Lf.kc)}function vp(){}function gp(t){return new $o(t,!0)}var mp,wp,bp,Ep,Ip="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tp=(Mp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.ju=this.Ql(e),[2]}})})},Mp.prototype.Ul=function(t){return null},Mp.prototype.Ql=function(t){return e=this.persistence,n=new Hl,t=t.Wl,new lf(e,n,t);var e,n},Mp.prototype.Bl=function(t){if(t.persistenceSettings.jl)throw new Tr(Ir.FAILED_PRECONDITION,Ip);return new Yl($l.ml)},Mp.prototype.Ll=function(t){return new vc},Mp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Mp.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,Ip)},Mp),_p=(n(Vp,Ep=Tp),Vp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ep.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,If(this.ju)];case 2:return t.sent(),[4,this.Kl.initialize(this,e)];case 3:return t.sent(),[4,ql(this.Kl.fi)];case 4:return t.sent(),[4,hl(this.Kl.ph)];case 5:return t.sent(),[2]}})})},Vp.prototype.Ul=function(t){var e=this.persistence.No.wo;return new qc(e,t.cs)},Vp.prototype.Bl=function(t){var e=ff(t.bl.U,t.bl.persistenceKey),n=gp(t.bl.U);return new nf(t.persistenceSettings.synchronizeTabs,e,t.clientId,Mc.ao(t.persistenceSettings.cacheSizeBytes),t.cs,Ba(),za(),n,this.Sh,t.persistenceSettings.ka)},Vp.prototype.Ll=function(t){return new vc},Vp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Sa.Ln()?(e=n+"main",[4,Sa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(ff(t,e))},n(Up,bp=Vp),Up.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,bp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Kl.fi,this.Sh instanceof yc?(this.Sh.fi={er:Ul.bind(null,e),nr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).qh?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Fh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Ef(e.ju)];case 3:return n=t.sent(),r=vo.Xt(o,"current"===s),[4,Pl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,mf(e.ju,o,!0)];case 6:return t.sent(),Ll(e,o,u),[3,8];case 7:Or(),t.label=8;case 8:return[2]}})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=jl(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Fh.has(r)?(Dr("SyncEngine","Adding an already active target "+r),[3,5]):[4,bf(n.ju,r)]):[3,6];case 2:return i=t.sent(),[4,gf(n.ju,i)];case 3:return o=t.sent(),[4,_l(n,Fl(i),o.targetId,!1)];case 4:t.sent(),Zf(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Fh.has(e)?[4,mf(n.ju,e,!1).then(function(){tl(n.ph,e),Ll(n,e)}).catch(Tf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.ju.persistence.pi()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Vl(this.Kl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ei?this.ql.start(this.ju):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Up.prototype.Ll=function(t){if(t.persistenceSettings.jl&&t.persistenceSettings.synchronizeTabs){var e=Ba();if(!yc.Ln(e))throw new Tr(Ir.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ff(t.bl.U,t.bl.persistenceKey);return new yc(e,t.cs,n,t.clientId,t.Wl)}return new vc},Up),Ap=(Cp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.ju?[3,2]:(this.ju=n.ju,this.Sh=n.Sh,this.Ku=this.Gl(r),this.ph=this.zl(r),this.bh=this.Hl(r),this.fi=this.Yl(r),this.Sh.di=function(t){return Nl(e.fi,t,1)},this.ph.Gu.Jl=Cl.bind(null,this.fi),[4,pl(this.ph,this.fi.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cp.prototype.Hl=function(t){return new Ja},Cp.prototype.Gl=function(t){var e=gp(t.bl.U),n=(n=t.bl,new ep(n));return t=t.credentials,new Vf(t,n,e)},Cp.prototype.zl=function(t){var e=this,n=this.ju,r=this.Ku,i=t.cs,o=function(t){return Nl(e.fi,t,0)},t=new(np.Ln()?np:rp);return new Af(n,r,i,o,t)},Cp.prototype.Yl=function(t){return function(t,e,n,r,i,o,s){o=new El(t,e,n,r,i,o);return s&&(o.qh=!0),o}(this.ju,this.ph,this.bh,this.Sh,t.Wl,t.Dh,!t.persistenceSettings.jl||!t.persistenceSettings.synchronizeTabs)},Cp.prototype.terminate=function(){return $f(this.ph)},Cp),Np=(Pp.prototype.next=function(t){this.observer.next&&this.Xl(this.observer.next,t)},Pp.prototype.error=function(t){this.observer.error?this.Xl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Pp.prototype.Zl=function(){this.muted=!0},Pp.prototype.Xl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Pp),Sp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Jr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new qr(t)},Dp=(n(Rp,wp=Sp),Rp.documentId=function(){return new Rp(qr.v().R())},Rp.prototype.isEqual=function(t){if(!(t instanceof Rp))throw ai("isEqual","FieldPath",1,t);return this.t_.isEqual(t.t_)},Rp),xp=new RegExp("[~\\*/\\[\\]]"),Lp=function(t){this.e_=t},kp=(n(Op,mp=Lp),Op.prototype.n_=function(t){if(2!==t.s_)throw 1===t.s_?t.i_(this.e_+"() can only appear at the top level of your update data"):t.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},Op.prototype.isEqual=function(t){return t instanceof Op},Op);function Op(){return null!==mp&&mp.apply(this,arguments)||this}function Rp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wp.call(this,t)||this}function Pp(t){this.observer=t,this.muted=!1}function Cp(){}function Up(){return null!==bp&&bp.apply(this,arguments)||this}function Vp(t){var e=this;return(e=Ep.call(this)||this).Kl=t,e}function Mp(){}function Fp(t,e,n){return new ad({s_:3,r_:e.settings.r_,methodName:t.e_,o_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var jp,qp,Gp,Bp,zp=(n(sd,Bp=Lp),sd.prototype.n_=function(t){return new Bs(t.path,new Ds)},sd.prototype.isEqual=function(t){return t instanceof sd},sd),Hp=(n(od,Gp=Lp),od.prototype.n_=function(t){var e=Fp(this,t,!0),n=this.a_.map(function(t){return vd(t,e)}),n=new xs(n);return new Bs(t.path,n)},od.prototype.isEqual=function(t){return this===t},od),Kp=(n(id,qp=Lp),id.prototype.n_=function(t){var e=Fp(this,t,!0),n=this.a_.map(function(t){return vd(t,e)}),n=new Ps(n);return new Bs(t.path,n)},id.prototype.isEqual=function(t){return this===t},id),Wp=(n(rd,jp=Lp),rd.prototype.n_=function(t){var e=new Ms(t.serializer,es(t.serializer,this.c_));return new Bs(t.path,e)},rd.prototype.isEqual=function(t){return this===t},rd),Qp=(Object.defineProperty(nd.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),nd.prototype.isEqual=function(t){return this.u_===t.u_&&this.h_===t.h_},nd.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},nd.prototype.Y=function(t){return di(this.u_,t.u_)||di(this.h_,t.h_)},nd),Xp=function(t){this.l_=t},Yp=/^__.*__$/,Jp=function(t,e,n){this.__=t,this.f_=e,this.d_=n},$p=(ed.prototype.w_=function(t,e){var n=[];return null!==this.We?n.push(new nu(t,this.data,this.We,e)):n.push(new eu(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new uu(t,this.fieldTransforms)),n},ed),Zp=(td.prototype.w_=function(t,e){e=[new nu(t,this.data,this.We,e)];return 0<this.fieldTransforms.length&&e.push(new uu(t,this.fieldTransforms)),e},td);function td(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function ed(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function nd(t,e){if(Qr("GeoPoint",arguments,2),Jr("GeoPoint","number",1,t),Jr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.u_=t,this.h_=e}function rd(t,e){var n=this;return(n=jp.call(this,t)||this).c_=e,n}function id(t,e){var n=this;return(n=qp.call(this,t)||this).a_=e,n}function od(t,e){var n=this;return(n=Gp.call(this,t)||this).a_=e,n}function sd(){return null!==Bp&&Bp.apply(this,arguments)||this}function ud(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Or()}}var ad=(Object.defineProperty(fd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),fd.prototype.T_=function(t){return new fd(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},fd.prototype.E_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.T_({path:e,o_:!1});return e.I_(t),e},fd.prototype.A_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.T_({path:t,o_:!1});return t.m_(),t},fd.prototype.R_=function(t){return this.T_({path:void 0,o_:!0})},fd.prototype.i_=function(t){return Id(t,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},fd.prototype.contains=function(e){return void 0!==this.We.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},fd.prototype.m_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},fd.prototype.I_=function(t){if(0===t.length)throw this.i_("Document fields must not be empty");if(ud(this.s_)&&Yp.test(t))throw this.i_('Document fields cannot begin and end with "__"')},fd),cd=(hd.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new ad({s_:t,methodName:e,r_:n,path:qr.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},hd);function hd(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||gp(t)}function fd(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}function ld(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);wd("Data must be an object, but it was:",s,r);var u,a,r=gd(r,s);if(o.merge)u=new Gs(s.We),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof Sp)p=l.t_;else{if("string"!=typeof l)throw Or();p=Ed(e,l,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Td(c,p)||c.push(p)}u=new Gs(c),a=s.fieldTransforms.filter(function(t){return u.Ye(t.field)})}else u=null,a=s.fieldTransforms;return new $p(new du(r),u,a)}function pd(t,r,i,e){var o=t.P_(1,r,i);wd("Data must be an object, but it was:",o,e);var s=[],u=new yu;Cr(e,function(t,e){var n=Ed(r,t,i),t=o.A_(n);e instanceof kp||e instanceof Xp&&e.l_ instanceof kp?s.push(n):null!=(t=vd(e,t))&&(s.push(n),u.set(n,t))});e=new Gs(s);return new Zp(u.Xe(),e,o.fieldTransforms)}function dd(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[bd(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(bd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new yu,y=u.length-1;0<=y;--y){Td(p,u[y])||(h=u[y],f=a[y],l=s.A_(h),f instanceof kp||f instanceof Xp&&f.l_ instanceof kp?p.push(h):null!=(l=vd(f,l))&&(p.push(h),d.set(h,l)))}i=new Gs(p);return new Zp(d.Xe(),i,s.fieldTransforms)}function yd(t,e,n,r){return void 0===r&&(r=!1),vd(n,t.P_(r?4:3,e))}function vd(s,t){if(s instanceof Xp&&(s=s.l_),md(s))return wd("Unsupported field value:",t,s),gd(s,t);if(s instanceof Lp)return function(t,e){if(!ud(e.s_))throw e.i_(t.e_+"() can only be used with update() and set()");if(!e.path)throw e.i_(t.e_+"() is not currently supported inside arrays");t=t.n_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.We.push(t.path),s instanceof Array){if(t.settings.o_&&4!==t.s_)throw t.i_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=vd(i[r],t.R_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return es(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:ns(e.serializer,n)}}if(t instanceof Di){var r=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ns(e.serializer,r)}}if(t instanceof Qp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:rs(e.serializer,t.q)};if(t instanceof Jp){n=e.U,r=t.__;if(!r.isEqual(n))throw e.i_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:os(t.__||e.U,t.f_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.i_("Unsupported field value: "+oi(t))}(s,t)}function gd(t,n){var r={};return Ur(t)?n.path&&0<n.path.length&&n.We.push(n.path):Cr(t,function(t,e){e=vd(e,n.E_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function md(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof Qp||t instanceof wi||t instanceof Jp||t instanceof Lp)}function wd(t,e,n){if(!md(n)||!ii(n)){n=oi(n);throw"an object"===n?e.i_(t+" a custom object"):e.i_(t+" "+n)}}function bd(t,e,n){if(e instanceof Sp)return e.t_;if("string"==typeof e)return Ed(t,e);throw Id("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ed(t,e,n){try{return function(e){if(0<=e.search(xp))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Dp.bind.apply(Dp,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).t_}catch(e){throw Id(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Id(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Td(t,e){return t.some(function(t){return t.isEqual(e)})}var _d=(xd.prototype.v_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return us(n.serializer,t)})},[4,n.ku("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=as(t,e.found.name),t=is(e.found.updateTime),e=new du({mapValue:{fields:e.found.fields}});return new Tu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);t=as(t,e.missing),e=is(e.readTime);return new _u(t,e)}(e,t):Or());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Rr(!!t),o.push(t)}),o)]}})})}(this.Ku,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof _u||t instanceof Tu?n.D_(t):Or()}),e)]}})})},xd.prototype.set=function(t,e){this.write(e.w_(t,this.Ge(t))),this.b_.add(t.toString())},xd.prototype.update=function(t,e){try{this.write(e.w_(t,this.C_(t)))}catch(t){this.p_=t}this.b_.add(t.toString())},xd.prototype.delete=function(t){this.write([new lu(t,this.Ge(t))]),this.b_.add(t.toString())},xd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),this.p_)throw this.p_;return e=this.y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Gr.D(e);n.mutations.push(new pu(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=fs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ds(e.serializer,t)})},[4,e.xu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Ku,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},xd.prototype.D_=function(t){var e;if(t instanceof Tu)e=t.version;else{if(!(t instanceof _u))throw Or();e=xi.min()}var n=this.y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.y_.set(t.key.toString(),e)},xd.prototype.Ge=function(t){var e=this.y_.get(t.toString());return!this.b_.has(t.toString())&&e?Ks.updateTime(e):Ks.ze()},xd.prototype.C_=function(t){var e=this.y_.get(t.toString());if(this.b_.has(t.toString())||!e)return Ks.exists(!0);if(e.isEqual(xi.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ks.updateTime(e)},xd.prototype.write=function(t){this.S_(),this.mutations=this.mutations.concat(t)},xd.prototype.S_=function(){},xd),Ad=(Dd.prototype.run=function(){this.F_()},Dd.prototype.F_=function(){var t=this;this.ys.gn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new _d(this.Ku),(n=this.x_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.k_(t)})})}).catch(function(t){r.k_(t)}),[2]})})})},Dd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!Ci(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},Dd.prototype.k_=function(t){var e=this;0<this.N_&&this.M_(t)?(--this.N_,this.cs.ws(function(){return e.F_(),Promise.resolve()})):this.ls.reject(t)},Dd.prototype.M_=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Wi(t)},Dd),Nd=(Sd.prototype.start=function(t,e,n,r){var i=this;this.L_(),this.bl=t;var o=new Ta,s=!1;return this.credentials.Hc(function(t){return s?void i.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.$s(),Dr("RemoteStore","RemoteStore received new credentials"),n=ol(e),e.Yu.add(3),[4,Jf(e)];case 1:return t.sent(),n&&e.th.set("Unknown"),[4,e.Gu.Jl(i)];case 2:return t.sent(),e.Yu.delete(3),[4,Yf(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)}):(s=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.B_(e,n,r,t,o).then(i.O_.resolve,i.O_.reject))}),this.cs.ws(function(){return i.O_.promise}),o.promise},Sd.prototype.enableNetwork=function(){var e=this;return this.L_(),this.cs.enqueue(function(){return e.persistence.tc(!0),(t=e.ph).Yu.delete(0),Yf(t);var t})},Sd.prototype.B_=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:s,Dh:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Sh=r.Sh,this.ju=r.ju,this.ql=r.ql,this.Ku=i.Ku,this.ph=i.ph,this.fi=i.fi,this.q_=i.bh,this.q_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=jl(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Oi(n),r=o.view.yh(),[3,4]):[3,1];case 1:return[4,gf(e.ju,Mu(u))];case 2:return i=t.sent(),o=e.Sh.Oi(i.targetId),n=i.targetId,[4,_l(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&Zf(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.q_.js=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.Fh.get(n.targetId)).length?[2,(e.Fh.set(n.targetId,r.filter(function(t){return!Gu(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Bi(n.targetId),e.Sh.Fi(n.targetId)?[3,2]:[4,mf(e.ju,n.targetId,!1).then(function(){e.Sh.Ui(n.targetId),tl(e.ph,n.targetId),Ll(e,n.targetId)}).catch(Tf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ll(e,n.targetId),[4,mf(e.ju,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.U_(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.B_(new Tp,new Ap,{jl:!1},s,u))];case 4:return[2]}})})},Sd.prototype.U_=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Sd.prototype.L_=function(){if(this.cs.ps)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Sd.prototype.disableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue(function(){return t.persistence.tc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(0),[4,Jf(e)];case 1:return t.sent(),e.th.set("Offline"),[2]}})})}(t.ph)})},Sd.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new Ta;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,$f(this.ph)];case 1:return t.sent(),[4,this.Sh.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yc(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Xa(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Sd.prototype.waitForPendingWrites=function(){var t=this;this.L_();var e=new Ta;return this.cs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ol((n=o).ph)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.ju).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Xa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},Sd.prototype.listen=function(t,e,n){var r=this;this.L_();var i=new Np(n),o=new ec(t,i,e);return this.cs.ws(function(){return $a(r.q_,o)}),function(){i.Zl(),r.cs.ws(function(){return Za(r.q_,o)})}},Sd.prototype.Q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new Ta,[2,(this.cs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Cc.Cr(t,e)}))];case 1:return(r=t.sent())instanceof Tu?s.resolve(r):r instanceof _u?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Xa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.ju,r,e)}),e.promise)]}})})},Sd.prototype.W_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new Ta,[2,(this.cs.ws(function(){return n=a.q_,r=a.cs,i=c,o=h,s=e,t=new Np({next:function(t){r.ws(function(){return Za(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ec(ku(i.path),t,{includeMetadataChanges:!0,Xs:!0}),$a(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Sd.prototype.j_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new Ta,[2,(this.cs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,wf(r,i,!0)];case 1:return n=t.sent(),e=new ml(i,n.Fc),n=e.wh(n.documents),n=e.yr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Xa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.ju,r,e)}),e.promise)]}})})},Sd.prototype.K_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),u=new Ta,[2,(this.cs.ws(function(){return e=a.q_,n=a.cs,t=c,r=h,i=u,o=new Np({next:function(t){n.ws(function(){return Za(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ec(t,o,{includeMetadataChanges:!0,Xs:!0}),$a(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Sd.prototype.write=function(t){var e=this;this.L_();var n=new Ta;return this.cs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=ql(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.ju,a=p,h=i,f=Di.now(),o=a.reduce(function(t,e){return t.add(e.key)},ho()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Cc.kr(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof uu?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Tu?t.field(i.field):void 0,o=As(i.transform,o||null);null!=o&&(e=(null==e?new yu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new nu(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new qr([t]);if(Xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Gs(u)}(o.proto.mapValue),Ks.exists(!0)))}return h.Sr.ko(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Sh.$i(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Oh[e.currentUser.ti()])||new Xi(di)).ot(n,r),e.Oh[e.currentUser.ti()]=i,[4,Pl(u,s.wr)];case 3:return t.sent(),[4,hl(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Xa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},Sd.prototype.U=function(){return this.bl.U},Sd.prototype.G_=function(t){var e=this;this.L_();var r=new Np(t);return this.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.q_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Zl(),e.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.q_.qs.delete(r)]})})})}},Object.defineProperty(Sd.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),Sd.prototype.transaction=function(t){var e=this;this.L_();var n=new Ta;return this.cs.ws(function(){return new Ad(e.cs,e.Ku,t,n).run(),Promise.resolve()}),n.promise},Sd);function Sd(t,e){this.credentials=t,this.cs=e,this.clientId=li.k(),this.O_=new Ta}function Dd(t,e,n,r){this.cs=t,this.Ku=e,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new Aa(this.cs,"transaction_retry")}function xd(t){this.Ku=t,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}function Ld(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var kd,Od,Rd=(Jd.prototype.X_=function(t){switch(Co(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Go(t.integerValue||t.doubleValue);case 3:return this.Z_(t.timestampValue);case 4:return this.tf(t);case 5:return t.stringValue;case 6:return this.J_(Bo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue);case 10:return this.if(t.mapValue);default:throw Or()}},Jd.prototype.if=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.X_(e)}),r},Jd.prototype.nf=function(t){return new Qp(Go(t.latitude),Go(t.longitude))},Jd.prototype.sf=function(t){var e=this;return(t.values||[]).map(function(t){return e.X_(t)})},Jd.prototype.tf=function(t){switch(this.H_){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Oo(e)?t(e):e}(t);return null==e?null:this.X_(e);case"estimate":return this.Z_(Ro(t));default:return null}},Jd.prototype.Z_=function(t){t=qo(t),t=new Di(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},Jd.prototype.ef=function(t){var e=Fr.g(t);Rr(_s(e));t=new Ni(e.get(1),e.get(3)),e=new Gr(e.u(5));return t.isEqual(this.U)||xr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(e)},Jd),Pd=Mc.ho,Cd=(Yd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Yd),Ud=(Object.defineProperty(Xd.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new cd(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),Xd.prototype.settings=function(t){Qr("Firestore.settings",arguments,1),Jr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.wf),t)).merge;t=new Cd(t);if(this.lf&&!this.wf.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.wf=t).credentials&&(this.df=function(t){if(!t)return new kf;switch(t.type){case"gapi":var e=t.client;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Xd.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},Xd.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},Xd.prototype.enablePersistence=function(t){var e;if(this.lf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:n,ka:r})},Xd.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.lf&&!this.lf.z_)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ta,[2,(this.uf.bs(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Xd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Xd.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),Xd.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},Xd.prototype.onSnapshotsInSync=function(t){if(this.hf(),Ld(t))return this.lf.G_(t);Jr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.lf.G_(t)},Xd.prototype.hf=function(){return this.lf||this.Ef(new Tp,new Ap,{jl:!1}),this.lf},Xd.prototype.Af=function(){return new Ti(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},Xd.prototype.Ef=function(t,e,n){var r=this.Af();return this.lf=new Nd(this.df,this.uf),this.lf.start(r,t,e,n)},Xd._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ni(t)},Object.defineProperty(Xd.prototype,"app",{get:function(){if(!this.cf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Xd.prototype.collection=function(t){return Qr("Firestore.collection",arguments,1),Jr("Firestore.collection","non-empty string",1,t),this.hf(),new oy(Fr.g(t),this,null)},Xd.prototype.doc=function(t){return Qr("Firestore.doc",arguments,1),Jr("Firestore.doc","non-empty string",1,t),this.hf(),Fd.Rf(Fr.g(t),this,null)},Xd.prototype.collectionGroup=function(t){if(Qr("Firestore.collectionGroup",arguments,1),Jr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new ry((t=t,new Nu(Fr.P(),t)),this,null)},Xd.prototype.runTransaction=function(e){var n=this;return Qr("Firestore.runTransaction",arguments,1),Jr("Firestore.runTransaction","function",1,e),this.hf().transaction(function(t){return e(new Vd(n,t))})},Xd.prototype.batch=function(){return this.hf(),new Md(this)},Object.defineProperty(Xd,"logLevel",{get:function(){switch(Sr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Xd.setLogLevel=function(t){Qr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},Xd.prototype.gf=function(){return this.wf.timestampsInSnapshots},Xd.prototype.Pf=function(){return this.wf},Xd),Vd=(Qd.prototype.get=function(t){var e=this;Qr("Transaction.get",arguments,1);var n=ly("Transaction.get",t,this.yf);return this.Vf.v_([n.f_]).then(function(t){if(!t||1!==t.length)return Or();t=t[0];if(t instanceof _u)return new qd(e.yf,n.f_,null,!1,!1,n.d_);if(t instanceof Tu)return new qd(e.yf,n.f_,t,!1,!1,n.d_);throw Or()})},Qd.prototype.set=function(t,e,n){Yr("Transaction.set",arguments,2,3);t=ly("Transaction.set",t,this.yf);n=cy("Transaction.set",n);e=py(t.d_,e,n),n=ld(this.yf.mf,"Transaction.set",t.f_,e,null!==t.d_,n);return this.Vf.set(t.f_,n),this},Qd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Dp?(Xr("Transaction.update",arguments,3),r=ly("Transaction.update",t,this.yf),dd(this.yf.mf,"Transaction.update",r.f_,e,n,i)):(Qr("Transaction.update",arguments,2),r=ly("Transaction.update",t,this.yf),pd(this.yf.mf,"Transaction.update",r.f_,e)),this.Vf.update(r.f_,e),this},Qd.prototype.delete=function(t){Qr("Transaction.delete",arguments,1);t=ly("Transaction.delete",t,this.yf);return this.Vf.delete(t.f_),this},Qd),Md=(Wd.prototype.set=function(t,e,n){Yr("WriteBatch.set",arguments,2,3),this.vf();t=ly("WriteBatch.set",t,this.yf);n=cy("WriteBatch.set",n);e=py(t.d_,e,n),n=ld(this.yf.mf,"WriteBatch.set",t.f_,e,null!==t.d_,n);return this.pf=this.pf.concat(n.w_(t.f_,Ks.ze())),this},Wd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.vf(),e="string"==typeof e||e instanceof Dp?(Xr("WriteBatch.update",arguments,3),r=ly("WriteBatch.update",t,this.yf),dd(this.yf.mf,"WriteBatch.update",r.f_,e,n,i)):(Qr("WriteBatch.update",arguments,2),r=ly("WriteBatch.update",t,this.yf),pd(this.yf.mf,"WriteBatch.update",r.f_,e)),this.pf=this.pf.concat(e.w_(r.f_,Ks.exists(!0))),this},Wd.prototype.delete=function(t){Qr("WriteBatch.delete",arguments,1),this.vf();t=ly("WriteBatch.delete",t,this.yf);return this.pf=this.pf.concat(new lu(t.f_,Ks.ze())),this},Wd.prototype.commit=function(){return this.vf(),this.bf=!0,0<this.pf.length?this.yf.hf().write(this.pf):Promise.resolve()},Wd.prototype.vf=function(){if(this.bf)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Wd),Fd=(n(Kd,Od=Jp),Kd.Rf=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Kd(new Gr(t),e,n)},Object.defineProperty(Kd.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Kd.prototype,"parent",{get:function(){return new oy(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(Kd.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),Kd.prototype.collection=function(t){if(Qr("DocumentReference.collection",arguments,1),Jr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Fr.g(t);return new oy(this.f_.path.child(t),this.firestore,null)},Kd.prototype.isEqual=function(t){if(!(t instanceof Kd))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.f_.isEqual(t.f_)&&this.d_===t.d_},Kd.prototype.set=function(t,e){Yr("DocumentReference.set",arguments,1,2),e=cy("DocumentReference.set",e);t=py(this.d_,t,e),e=ld(this.firestore.mf,"DocumentReference.set",this.f_,t,null!==this.d_,e);return this.lf.write(e.w_(this.f_,Ks.ze()))},Kd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Dp?(Xr("DocumentReference.update",arguments,2),dd(this.firestore.mf,"DocumentReference.update",this.f_,t,e,n)):(Qr("DocumentReference.update",arguments,1),pd(this.firestore.mf,"DocumentReference.update",this.f_,t)),this.lf.write(t.w_(this.f_,Ks.exists(!0)))},Kd.prototype.delete=function(){return Qr("DocumentReference.delete",arguments,0),this.lf.write([new lu(this.f_,Ks.ze())])},Kd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Yr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ld(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Ld(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Jr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Sf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(ku(this.f_.path),o,s)},Kd.prototype.get=function(t){var e=this;Yr("DocumentReference.get",arguments,0,1),fy("DocumentReference.get",t);var n=this.firestore.hf();return t&&"cache"===t.source?n.Q_(this.f_).then(function(t){return new qd(e.firestore,e.f_,t,!0,t instanceof Tu&&t.Je,e.d_)}):n.W_(this.f_,t).then(function(t){return e.Sf(t)})},Kd.prototype.withConverter=function(t){return new Kd(this.f_,this.firestore,t)},Kd.prototype.Sf=function(t){var e=t.docs.get(this.f_);return new qd(this.firestore,this.f_,e,t.fromCache,t.hasPendingWrites,this.d_)},Kd),jd=(Hd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hd),qd=(zd.prototype.data=function(t){var e=this;if(Yr("DocumentSnapshot.data",arguments,0,1),t=hy("DocumentSnapshot.data",t),this.Df){if(this.d_){var n=new Gd(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,t)}return new Rd(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",function(t){return new Fd(t,e.yf,null)},function(t){return new Ai(t)}).X_(this.Df.rn())}},zd.prototype.get=function(t,e){var n=this;if(Yr("DocumentSnapshot.get",arguments,1,2),e=hy("DocumentSnapshot.get",e),this.Df){t=this.Df.data().field(bd("DocumentSnapshot.get",t,this.f_));if(null!==t)return new Rd(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",function(t){return new Fd(t,n.yf,n.d_)},function(t){return new Ai(t)}).X_(t)}},Object.defineProperty(zd.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"ref",{get:function(){return new Fd(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"metadata",{get:function(){return new jd(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),zd.prototype.isEqual=function(t){if(!(t instanceof zd))throw ai("isEqual","DocumentSnapshot",1,t);return this.yf===t.yf&&this.Cf===t.Cf&&this.f_.isEqual(t.f_)&&(null===this.Df?null===t.Df:this.Df.isEqual(t.Df))&&this.d_===t.d_},zd),Gd=(n(Bd,kd=qd),Bd.prototype.data=function(t){return kd.prototype.data.call(this,t)},Bd);function Bd(){return null!==kd&&kd.apply(this,arguments)||this}function zd(t,e,n,r,i,o){this.yf=t,this.f_=e,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}function Hd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Kd(t,e,n){var r=this;return(r=Od.call(this,e.__,t,n)||this).f_=t,r.firestore=e,r.d_=n,r.lf=r.firestore.hf(),r}function Wd(t){this.yf=t,this.pf=[],this.bf=!1}function Qd(t,e){this.yf=t,this.Vf=e}function Xd(t,e,n,r){var i=this;if(void 0===n&&(n=new Tp),void 0===r&&(r=new Ap),this.rf=n,this.af=r,this.cf=null,this.uf=new Ka,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.cf=r,this.__=Xd._f(r),this.ff=r.name,this.df=new Of(e)}else{t=t;if(!t.projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.__=new Ni(t.projectId,t.database),this.ff="[DEFAULT]",this.df=new kf}this.wf=new Cd({})}function Yd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Zr("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Mc._o;else{if(t.cacheSizeBytes!==Pd&&t.cacheSizeBytes<Mc.lo)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Mc.lo);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,ti("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Tr(Ir.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function Jd(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.H_=n,this.Y_=r,this.J_=i}function $d(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Fr.g(n));if(!Gr.F(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return zo(t,new Gr(e))}if(n instanceof Jp)return zo(t,n.f_);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function Zd(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function ty(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ey(t){if(Ru(t)&&0===t.on.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ny,ry=(ay.prototype.where=function(t,e,n){Qr("Query.where",arguments,3),si("Query.where",3,n);e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=bd("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Zd(s,o);for(var u=[],a=0,c=s;a<c.length;a++){var h=c[a];u.push($d(r,t,h))}f={arrayValue:{values:u}}}else f=$d(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Zd(s,o),f=yd(n,e,s,"in"===o||"not-in"===o);var f=Qu.create(i,o,f);return function(t,e){if(e.hn()){var n=Cu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Pu(t);null!==n&&ty(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,f),f}(this.Ff,"Query.where",this.firestore.mf,this.firestore.__,t,e,n);return new ay((n=this.Ff,e=n.filters.concat([e]),new Nu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},ay.prototype.orderBy=function(t,e){if(Yr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=bd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ia(e,n);return e=r,null!==Pu(n=t)||null!==(t=Cu(n))&&ty(0,t,e.field),r}(this.Ff,t,n);return new ay((n=this.Ff,t=n.on.concat([t]),new Nu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},ay.prototype.limit=function(t){return Qr("Query.limit",arguments,1),Jr("Query.limit","number",1,t),ci("Query.limit",1,t),new ay(Fu(this.Ff,t,"F"),this.firestore,this.d_)},ay.prototype.limitToLast=function(t){return Qr("Query.limitToLast",arguments,1),Jr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new ay(Fu(this.Ff,t,"L"),this.firestore,this.d_)},ay.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAt",arguments,1);t=this.$f("Query.startAt",t,e,!0);return new ay(ju(this.Ff,t),this.firestore,this.d_)},ay.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAfter",arguments,1);t=this.$f("Query.startAfter",t,e,!1);return new ay(ju(this.Ff,t),this.firestore,this.d_)},ay.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endBefore",arguments,1);t=this.$f("Query.endBefore",t,e,!0);return new ay(qu(this.Ff,t),this.firestore,this.d_)},ay.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endAt",arguments,1);t=this.$f("Query.endAt",t,e,!1);return new ay(qu(this.Ff,t),this.firestore,this.d_)},ay.prototype.isEqual=function(t){if(!(t instanceof ay))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&Gu(this.Ff,t.Ff)&&this.d_===t.d_},ay.prototype.withConverter=function(t){return new ay(this.Ff,this.firestore,t)},ay.prototype.$f=function(c,t,e,n){if(si(c,1,t),t instanceof qd)return Qr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Vu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(zo(e,n.key));else{var a=n.field(u.field);if(Oo(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new da(i,r)}(this.Ff,this.firestore.__,t.Df,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Uu(t)&&-1!==c.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Fr.g(c));if(!Gr.F(h))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Gr(h);u.push(zo(e,h))}else{c=yd(n,r,c);u.push(c)}}return new da(u,o)}(this.Ff,this.firestore.__,this.firestore.mf,c,e,n)},ay.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Yr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Ld(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Ld(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Jr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new iy(e.firestore,e.Ff,t,e.d_))},error:n[o+1],complete:n[o+2]};return ey(this.Ff),this.firestore.hf().listen(this.Ff,i,s)},ay.prototype.get=function(t){var e=this;Yr("Query.get",arguments,0,1),fy("Query.get",t),ey(this.Ff);var n=this.firestore.hf();return(t&&"cache"===t.source?n.j_(this.Ff):n.K_(this.Ff,t)).then(function(t){return new iy(e.firestore,e.Ff,t,e.d_)})},ay),iy=(Object.defineProperty(uy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),uy.prototype.forEach=function(e,n){var r=this;Yr("QuerySnapshot.forEach",arguments,1,2),Jr("QuerySnapshot.forEach","function",1,e),this.kf.docs.forEach(function(t){e.call(n,r.Lf(t,r.metadata.fromCache,r.kf.Wt.has(t.key)))})},Object.defineProperty(uy.prototype,"query",{get:function(){return new ry(this.xf,this.yf,this.d_)},enumerable:!1,configurable:!0}),uy.prototype.docChanges=function(t){t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.kf.Kt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===t||(this.Mf=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.kf,t,this.Lf.bind(this)),this.Of=t),this.Mf},uy.prototype.isEqual=function(t){if(!(t instanceof uy))throw ai("isEqual","QuerySnapshot",1,t);return this.yf===t.yf&&Gu(this.xf,t.xf)&&this.kf.isEqual(t.kf)&&this.d_===t.d_},uy.prototype.Lf=function(t,e,n){return new Gd(this.yf,t.key,t,e,n,this.d_)},uy),oy=(n(sy,ny=ry),Object.defineProperty(sy.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(sy.prototype,"parent",{get:function(){var t=this.Ff.path.h();return t.m()?null:new Fd(new Gr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(sy.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),sy.prototype.doc=function(t){Yr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=li.k()),Jr("CollectionReference.doc","non-empty string",1,t);t=Fr.g(t);return Fd.Rf(this.Ff.path.child(t),this.firestore,this.d_)},sy.prototype.add=function(t){Qr("CollectionReference.add",arguments,1);t=this.d_?this.d_.toFirestore(t):t;Jr("CollectionReference.add","object",1,t);var e=this.doc();return new Fd(e.f_,this.firestore,null).set(t).then(function(){return e})},sy.prototype.withConverter=function(t){return new sy(this.Bf,this.firestore,t)},sy);function sy(t,e,n){var r=this;if(((r=ny.call(this,ku(t),e,n)||this).Bf=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function uy(t,e,n,r){this.yf=t,this.xf=e,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new jd(n.hasPendingWrites,n.fromCache)}function ay(t,e,n){this.Ff=t,this.firestore=e,this.d_=n}function cy(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Dp}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function hy(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function fy(t,e){$r(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function ly(t,e,n){if(e instanceof Jp){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function py(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var dy,yy,Ee=(n(gy,dy=Xp),gy.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new zp("serverTimestamp");return t.e_="FieldValue.serverTimestamp",new gy(t)},gy.delete=function(){Wr("FieldValue.delete",arguments);var t=new kp("deleteField");return t.e_="FieldValue.delete",new gy(t)},gy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new Hp("arrayUnion",t)}.apply(void 0,t);return n.e_="FieldValue.arrayUnion",new gy(n)},gy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new Kp("arrayRemove",t)}.apply(void 0,t);return n.e_="FieldValue.arrayRemove",new gy(n)},gy.increment=function(t){Jr("FieldValue.increment","number",1,t),Qr("FieldValue.increment",arguments,1);t=new Wp("increment",t);return t.e_="FieldValue.increment",new gy(t)},gy.prototype.isEqual=function(t){return this.l_.isEqual(t.l_)},gy),vy={Firestore:Ud,GeoPoint:Qp,Timestamp:Di,Blob:Ai,Transaction:Vd,WriteBatch:Md,DocumentReference:Fd,DocumentSnapshot:qd,Query:ry,QueryDocumentSnapshot:Gd,QuerySnapshot:iy,CollectionReference:oy,FieldPath:Dp,FieldValue:Ee,setLogLevel:Ud.setLogLevel,CACHE_SIZE_UNLIMITED:Pd};function gy(){return null!==dy&&dy.apply(this,arguments)||this}(yy=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Ap,t=new _p(r),new Ud(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},vy))),yy.registerVersion("@firebase/firestore","1.18.0-20209141635")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
