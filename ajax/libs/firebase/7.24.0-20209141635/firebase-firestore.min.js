!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(sy){"use strict";try{(function(){var l,t,e=(t=sy)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=l=l||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),R=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:C).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++R))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}K=(Y=Y&&Y.userAgent)?Y:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Q(K,"Opera"),it=Q(K,"Trident")||Q(K,"MSIE"),ot=Q(K,"Edge"),st=ot||it,ut=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),at=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);ft&&(ht=ft?ft[1]:""),nt=it&&null!=(ft=ct())&&ft>parseFloat(ht)?String(ft):ht;var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),xt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ut(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):_t(t)))}function Rt(t){return t in xt?xt[t]:xt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function Ut(t){return(t=t[Dt])instanceof At?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==x(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ft(){j.call(this),this.c=new At(this),(this.J=this).C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=jt(o,r,!0,t)&&s;if(s=jt(o=t.a=n,r,!0,t)&&s,s=jt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=jt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Kt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Wt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Yt)}),Qt||(Bt(),Qt=!0),Xt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Gt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function Jt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=U(this.Ya,this),this.g=M()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==x(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Jt,Ft),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){j.call(this),this.b=t,this.a={}}F(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le=null;function pe(){return le=le||new Ft}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(de,mt),F(ve,mt),F(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ie.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Le,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Ne,mt),F(Se,mt),F(De,Ie),Ae=new De;var Le=45e3,ke={},Oe={};function Re(t,e,n){t.H=1,t.i=tn(Qe(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=M(),Ue(t),t.l=Qe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(U(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Oe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Oe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Oe){4==e&&(t.h=4,ge(),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,ge(),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Fe(t))}function Ue(t){t.U=M()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(U(t.Ua,t),e)}function Me(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}$n(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(U(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Ue(o)),n.a=i):Jn(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=xe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),je(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ce(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),qe(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),je(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),Ce(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,je(this)},A.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),je(this),this.h=2,Fe(this)):Ve(this,this.U-n)},(A=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ye(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Qe(t){return new We(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function xn(t){Ft.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}F(xn,Ft);var Ln="",kn=/^https?$/i,On=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Vn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ze(n=Qe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Xn(t,n),(e=new xe(t,t.c,e,void 0)).H=2,e.i=tn(Qe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Ue(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Xn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Re(n,r,e)}function Xn(t,n){t.f&&Ge({},function(t,e){Ze(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(U(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new xe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Xn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Qe(e)),n.j=null,n.I=!0,Pe(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Wn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(U(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=V(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Qe(s):new We(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Xe(u,r),i&&Ye(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=xn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ae),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(On,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),xn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ta())},A.Ta=function(){Un(this)},A.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ze(i=Qe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||wn(this.b)||Qn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(U(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},F(hr,Ft),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},A.close=function(){Bn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=qt(t),Kn(this.a,e)):Kn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},F(fr,Ne),F(lr,Se),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new lr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,xn.prototype.listenOnce=xn.prototype.wa,xn.prototype.getLastError=xn.prototype.Qa,xn.prototype.getLastErrorCode=xn.prototype.ua,xn.prototype.getStatus=xn.prototype.X,xn.prototype.getResponseJson=xn.prototype.Na,xn.prototype.getResponseText=xn.prototype.$,xn.prototype.send=xn.prototype.ba;var dr=be,yr=Ee,vr=_e,gr=xn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=(n(Ar,br=Error),Ar),Tr="7.24.0-20209141635",_r=new h("@firebase/firestore");function Ar(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Nr(){return _r.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.DEBUG&&(e=n.map(Lr),_r.debug.apply(_r,i(["Firestore ("+Tr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.ERROR&&(e=n.map(Lr),_r.error.apply(_r,i(["Firestore ("+Tr+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.WARN&&(e=n.map(Lr),_r.warn.apply(_r,i(["Firestore ("+Tr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){throw void 0===t&&(t="Unexpected state"),Dr(t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Or(t){t||kr()}function Rr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Pr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Cr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ur,Vr,be=(Object.defineProperty(Hr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return 0===Hr.i(this,t)},Hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Hr.prototype.limit=function(){return this.offset+this.length},Hr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Hr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Hr.prototype.l=function(){return this.segments[this.offset]},Hr.prototype._=function(){return this.get(this.length-1)},Hr.prototype.get=function(t){return this.segments[this.offset+t]},Hr.prototype.m=function(){return 0===this.length},Hr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Hr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hr),Mr=(n(zr,Vr=be),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.prototype.R=function(){return this.A().join("/")},zr.prototype.toString=function(){return this.R()},zr.g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new zr(n)},zr.P=function(){return new zr([])},zr),Fr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,jr=(n(Br,Ur=be),Br.prototype.o=function(t,e,n){return new Br(t,e,n)},Br.V=function(t){return Fr.test(t)},Br.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Br.V(t)||(t="`"+t+"`"),t}).join(".")},Br.prototype.toString=function(){return this.R()},Br.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},Br.v=function(){return new Br(["__name__"])},Br.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Br(e)},Br.P=function(){return new Br([])},Br),qr=(Gr.D=function(t){return new Gr(Mr.g(t))},Gr.C=function(t){return new Gr(Mr.g(t).u(5))},Gr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Gr.prototype.isEqual=function(t){return null!==t&&0===Mr.i(this.path,t.path)},Gr.prototype.toString=function(){return this.path.toString()},Gr.i=function(t,e){return Mr.i(t.path,e.path)},Gr.F=function(t){return t.length%2==0},Gr.$=function(t){return new Gr(new Mr(t.slice()))},Gr);function Gr(t){this.path=t}function Br(){return null!==Ur&&Ur.apply(this,arguments)||this}function zr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Hr(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.t=n}function Kr(t,e){if(0!==e.length)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+hi(e.length,"argument")+".")}function Wr(t,e,n){if(e.length!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+hi(n,"argument")+", but was called with "+hi(e.length,"argument")+".")}function Qr(t,e,n){if(e.length<n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+hi(n,"argument")+", but was called with "+hi(e.length,"argument")+".")}function Xr(t,e,n,r){if(e.length<n||e.length>r)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+hi(e.length,"argument")+".")}function Yr(t,e,n,r){ni(t,e,ci(n)+" argument",r)}function Jr(t,e,n,r){void 0!==r&&Yr(t,e,n,r)}function $r(t,e,n,r){ni(t,e,n+" option",r)}function Zr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function ti(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ii(s))}var u=ii(n);throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ei(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+ii(r)+" provided to function "+t+"() for its "+ci(n)+" argument. Acceptable values: "+e.join(", "));return r}function ni(t,e,n,r){if(!("object"===e?ri(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=ii(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ri(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ii(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function oi(t,e,n){if(void 0===n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ci(e)+" argument, but it was undefined.")}function si(n,t,r){Pr(t,function(t,e){if(r.indexOf(t)<0)throw new Ir(Er.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ui(t,e,n,r){return r=ii(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(n)+" argument to be a "+e+", but it was: "+r)}function ai(t,e,n){if(n<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(e)+" argument to be a positive number, but it was: "+n+".")}function ci(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function hi(t,e){return t+" "+e+(1===t?"":"s")}var fi=(li.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},li);function li(){}function pi(t,e){return t<e?-1:e<t?1:0}function di(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function yi(t){return t+"\0"}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},gi.prototype.O=function(){return 2*this.M.length},gi.prototype.L=function(t){return pi(this.M,t.M)},gi.prototype.isEqual=function(t){return this.M===t.M},gi);function gi(t){this.M=t}vi.B=new vi("");var mi=(wi.fromBase64String=function(t){try{return new wi(vi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},wi.fromUint8Array=function(t){return new wi(vi.fromUint8Array(t))},wi.prototype.toBase64=function(){return this.q.toBase64()},wi.prototype.toUint8Array=function(){return this.q.toUint8Array()},wi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},wi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},wi);function wi(t){this.q=t}function bi(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ei(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ii(t,e,n,r,i,o){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o}var Ti,_i=(n(Ri,Ti=mi),Ri.fromBase64String=function(t){Wr("Blob.fromBase64String",arguments,1),Yr("Blob.fromBase64String","string",1,t),Ei();try{return new Ri(vi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ri.fromUint8Array=function(t){if(Wr("Blob.fromUint8Array",arguments,1),bi(),!(t instanceof Uint8Array))throw ui("Blob.fromUint8Array","Uint8Array",1,t);return new Ri(vi.fromUint8Array(t))},Ri.prototype.toBase64=function(){return Wr("Blob.toBase64",arguments,0),Ei(),Ti.prototype.toBase64.call(this)},Ri.prototype.toUint8Array=function(){return Wr("Blob.toUint8Array",arguments,0),bi(),Ti.prototype.toUint8Array.call(this)},Ri.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ri),Ai=(Object.defineProperty(Oi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Oi.prototype.isEqual=function(t){return t instanceof Oi&&t.projectId===this.projectId&&t.database===this.database},Oi.prototype.L=function(t){return pi(this.projectId,t.projectId)||pi(this.database,t.database)},Oi),Ni=(ki.prototype.get=function(t){var e=this.K(t);if(void 0!==(e=this.H[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.G(i,t))return o}},ki.prototype.has=function(t){return void 0!==this.get(t)},ki.prototype.set=function(t,e){var n=this.K(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},ki.prototype.delete=function(t){var e=this.K(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},ki.prototype.forEach=function(s){Pr(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},ki.prototype.m=function(){return Cr(this.H)},ki),Si=(Li.now=function(){return Li.fromMillis(Date.now())},Li.fromDate=function(t){return Li.fromMillis(t.getTime())},Li.fromMillis=function(t){var e=Math.floor(t/1e3);return new Li(e,1e6*(t-1e3*e))},Li.prototype.toDate=function(){return new Date(this.toMillis())},Li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Li.prototype.Y=function(t){return this.seconds===t.seconds?pi(this.nanoseconds,t.nanoseconds):pi(this.seconds,t.seconds)},Li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Li),Di=(xi.J=function(t){return new xi(t)},xi.min=function(){return new xi(new Si(0,0))},xi.prototype.L=function(t){return this.timestamp.Y(t.timestamp)},xi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},xi.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},xi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},xi.prototype.Z=function(){return this.timestamp},xi);function xi(t){this.timestamp=t}function Li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ki(t,e){this.K=t,this.G=e,this.H={}}function Oi(t,e){this.projectId=t,this.database=e||"(default)"}function Ri(){return null!==Ti&&Ti.apply(this,arguments)||this}function Pi(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}function Ui(t){return"number"==typeof t&&Number.isInteger(t)&&!Ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Vi(t,e,n,r,i,o,s)}function Fi(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Pi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=va(e.startAt)),e.endAt&&(t+="|ub:",t+=va(e.endAt)),e.tt=t),e.tt}function ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Co(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ma(t.startAt,e.startAt)&&ma(t.endAt,e.endAt)}function qi(t){return qr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Gi(t){this.count=t}var Bi,zi=(Hi.prototype.st=function(t){return new Hi(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Hi.prototype.it=function(t,e){return new Hi(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Hi.prototype.rt=function(t){return new Hi(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Hi);function Hi(t,e,n,r,i,o,s){void 0===i&&(i=Di.min()),void 0===o&&(o=Di.min()),void 0===s&&(s=vi.B),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ki(t){switch(t){case Er.OK:return kr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return kr(),0}}function Wi(t){if(void 0===t)return Dr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Bi.OK:return Er.OK;case Bi.CANCELLED:return Er.CANCELLED;case Bi.UNKNOWN:return Er.UNKNOWN;case Bi.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Bi.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Bi.INTERNAL:return Er.INTERNAL;case Bi.UNAVAILABLE:return Er.UNAVAILABLE;case Bi.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Bi.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Bi.NOT_FOUND:return Er.NOT_FOUND;case Bi.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Bi.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Bi.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Bi.ABORTED:return Er.ABORTED;case Bi.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Bi.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Bi.DATA_LOSS:return Er.DATA_LOSS;default:return kr()}}(Ee=Bi=Bi||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Qi=(Zi.prototype.ot=function(t,e){return new Zi(this.i,this.root.ot(t,e,this.i).copy(null,null,Yi.at,null,null))},Zi.prototype.remove=function(t){return new Zi(this.i,this.root.remove(t,this.i).copy(null,null,Yi.at,null,null))},Zi.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zi.prototype.m=function(){return this.root.m()},Object.defineProperty(Zi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Zi.prototype.ct=function(){return this.root.ct()},Zi.prototype.ut=function(){return this.root.ut()},Zi.prototype.ht=function(t){return this.root.ht(t)},Zi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Zi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Zi.prototype.lt=function(t){return this.root.lt(t)},Zi.prototype._t=function(){return new Xi(this.root,null,this.i,!1)},Zi.prototype.ft=function(t){return new Xi(this.root,t,this.i,!1)},Zi.prototype.dt=function(){return new Xi(this.root,null,this.i,!0)},Zi.prototype.wt=function(t){return new Xi(this.root,t,this.i,!0)},Zi),Xi=($i.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},$i.prototype.At=function(){return 0<this.Et.length},$i.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},$i),Yi=(Ji.prototype.copy=function(t,e,n,r,i){return new Ji(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ji.prototype.m=function(){return!1},Ji.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ji.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ji.prototype.min=function(){return this.left.m()?this:this.left.min()},Ji.prototype.ct=function(){return this.min().key},Ji.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},Ji.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).gt()},Ji.prototype.Pt=function(){if(this.left.m())return Ji.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).gt()},Ji.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.bt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Ji.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.gt()},Ji.prototype.yt=function(){return this.color},Ji.prototype.gt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},Ji.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Ji.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},Ji.prototype.St=function(){var t=this.copy(null,null,Ji.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ji.prototype.bt=function(){var t=this.copy(null,null,Ji.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ji.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ji.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Ji.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw kr();if(this.right.yt())throw kr();var t=this.left.Nt();if(t!==this.right.Nt())throw kr();return t+(this.yt()?0:1)},Ji);function Ji(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ji.RED,this.left=null!=r?r:Ji.EMPTY,this.right=null!=i?i:Ji.EMPTY,this.size=this.left.size+1+this.right.size}function $i(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function Zi(t,e){this.i=t,this.root=e||Yi.EMPTY}function to(){this.size=0}Yi.EMPTY=null,Yi.RED=!0,Yi.at=!1,Yi.EMPTY=(Object.defineProperty(to.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),to.prototype.copy=function(t,e,n,r,i){return this},to.prototype.ot=function(t,e,n){return new Yi(t,e)},to.prototype.remove=function(t,e){return this},to.prototype.m=function(){return!0},to.prototype.ht=function(t){return!1},to.prototype.lt=function(t){return!1},to.prototype.ct=function(){return null},to.prototype.ut=function(){return null},to.prototype.yt=function(){return!1},to.prototype.Ct=function(){return!0},to.prototype.Nt=function(){return 0},new to);var eo=(oo.prototype.has=function(t){return null!==this.data.get(t)},oo.prototype.first=function(){return this.data.ct()},oo.prototype.last=function(){return this.data.ut()},Object.defineProperty(oo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),oo.prototype.indexOf=function(t){return this.data.indexOf(t)},oo.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},oo.prototype.Ft=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},oo.prototype.$t=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},oo.prototype.xt=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},oo.prototype._t=function(){return new no(this.data._t())},oo.prototype.ft=function(t){return new no(this.data.ft(t))},oo.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},oo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},oo.prototype.m=function(){return this.data.m()},oo.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},oo.prototype.isEqual=function(t){if(!(t instanceof oo))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},oo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},oo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},oo.prototype.copy=function(t){var e=new oo(this.i);return e.data=t,e},oo),no=(io.prototype.It=function(){return this.Mt.It().key},io.prototype.At=function(){return this.Mt.At()},io),ro=new Qi(qr.i);function io(t){this.Mt=t}function oo(t){this.i=t,this.data=new Qi(this.i)}var so=new Qi(qr.i),uo=new Qi(qr.i),ao=new eo(qr.i);function co(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ao,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ho=new eo(pi),fo=(Do.Bt=function(t){return new Do(t.i)},Do.prototype.has=function(t){return null!=this.Ot.get(t)},Do.prototype.get=function(t){return this.Ot.get(t)},Do.prototype.first=function(){return this.Lt.ct()},Do.prototype.last=function(){return this.Lt.ut()},Do.prototype.m=function(){return this.Lt.m()},Do.prototype.indexOf=function(t){return(t=this.Ot.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(Do.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),Do.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},Do.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.ot(t.key,t),e.Lt.ot(t,null))},Do.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Lt.remove(e)):this},Do.prototype.isEqual=function(t){if(!(t instanceof Do))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},Do.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Do.prototype.copy=function(t,e){var n=new Do;return n.i=this.i,n.Ot=t,n.Lt=e,n},Do),lo=(So.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):kr()},So.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},So),po=(No.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new No(t,e,fo.Bt(e),i,n,r,!0,!1)},Object.defineProperty(No.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),No.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Wt.isEqual(t.Wt)&&Fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},No),yo=(Ao.Xt=function(t,e){var n=new Map;return n.set(t,vo.Zt(t,e)),new Ao(Di.min(),n,ho,ro,co())},Ao),vo=(_o.Zt=function(t,e){return new _o(vi.B,e,co(),co(),co())},_o),go=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},mo=function(t,e){this.targetId=t,this.oe=e},wo=function(t,e,n,r){void 0===n&&(n=vi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bo=(Object.defineProperty(To.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),To.prototype.de=function(t){0<t.O()&&(this.le=!0,this.ue=t)},To.prototype.we=function(){var n=co(),r=co(),i=co();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new vo(this.ue,this.he,n,r,i)},To.prototype.me=function(){this.le=!1,this.ce=Lo()},To.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},To.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},To.prototype.Ie=function(){this.ae+=1},To.prototype.Ae=function(){--this.ae},To.prototype.Re=function(){this.le=!0,this.he=!0},To),Eo=(Io.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof bu?this.ve(r,t.re):t.re instanceof Eu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},Io.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.Fe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Fe(t)&&(r.$e(t),e.de(n.resumeToken));break;default:kr()}})},Io.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Fe(e)&&n(e)})},Io.prototype.xe=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(qi(t=t.target)?0===n?(t=new qr(t.path),this.Se(e,t,new Eu(t,Di.min()))):Or(1===n):this.Me(e)!==n&&(this.$e(e),this.pe=this.pe.add(e)))},Io.prototype.Oe=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&qi(n.target)&&(n=new qr(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Se(e,n,new Eu(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=co();this.Ve.forEach(function(t,e){var n=!0;e.$t(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new yo(r,o,this.pe,this.ye,s);return this.ye=ro,this.Ve=xo(),this.pe=new eo(pi),t},Io.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t)))},Io.prototype.Se=function(t,e,n){var r;this.Fe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},Io.prototype.removeTarget=function(t){this.Pe.delete(t)},Io.prototype.Me=function(t){var e=this.Ne(t).we();return this.ge.qe(t).size+e.ee.size-e.se.size},Io.prototype.Ie=function(t){this.Ne(t).Ie()},Io.prototype.Ne=function(t){var e=this.Pe.get(t);return e||(e=new bo,this.Pe.set(t,e)),e},Io.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new eo(pi),this.Ve=this.Ve.ot(t,e)),e},Io.prototype.Fe=function(t){var e=null!==this.ke(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},Io.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ge.Ue(t)},Io.prototype.$e=function(e){var n=this;this.Pe.set(e,new bo),this.ge.qe(e).forEach(function(t){n.Se(e,t,null)})},Io.prototype.Le=function(t,e){return this.ge.qe(t).has(e)},Io);function Io(t){this.ge=t,this.Pe=new Map,this.ye=ro,this.Ve=xo(),this.pe=new eo(pi)}function To(){this.ae=0,this.ce=Lo(),this.ue=vi.B,this.he=!1,this.le=!0}function _o(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function Ao(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function No(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=s,this.Kt=u}function So(){this.qt=new Qi(qr.i)}function Do(n){this.i=n?function(t,e){return n(t,e)||qr.i(t.key,e.key)}:function(t,e){return qr.i(t.key,e.key)},this.Ot=so,this.Lt=new Qi(this.i)}function xo(){return new Qi(qr.i)}function Lo(){return new Qi(qr.i)}function ko(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oo(t){return t=jo(t.mapValue.fields.__local_write_time__.timestampValue),new Si(t.seconds,t.nanos)}var Ro=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ko(t)?4:10:kr()}function Co(r,i){var t,e,n,o=Po(r);if(o!==Po(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oo(r).isEqual(Oo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=jo(r.timestampValue),t=jo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Go(r.bytesValue).isEqual(Go(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,qo((t=r).geoPointValue.latitude)===qo(o.geoPointValue.latitude)&&qo(t.geoPointValue.longitude)===qo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?qo(e.integerValue)===qo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=qo(e.doubleValue))===(n=qo(n.doubleValue))?Ci(e)===Ci(n):isNaN(e)&&isNaN(n));case 9:return di(r.arrayValue.values||[],i.arrayValue.values||[],Co);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Rr(e)!==Rr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Co(e[t],n[t])))return!1;return!0}();default:return kr()}}function Uo(t,e){return void 0!==(t.values||[]).find(function(t){return Co(t,e)})}function Vo(t,e){var n,r,i,o,s=Po(t),u=Po(e);if(s!==u)return pi(s,u);switch(s){case 0:return 0;case 1:return pi(t.booleanValue,e.booleanValue);case 2:return n=e,(r=qo(t.integerValue||t.doubleValue))<(n=qo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Mo(t.timestampValue,e.timestampValue);case 4:return Mo(Oo(t),Oo(e));case 5:return pi(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Go(i),o=Go(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=pi(n[i],r[i]);if(0!==o)return o}return pi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=pi(qo(s.latitude),qo(r.latitude)))?n:pi(qo(s.longitude),qo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vo(n[i],r[i]);if(o)return o}return pi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=pi(r[s],o[s]);if(0!==u)return u;if(0!==(u=Vo(n[r[s]],i[o[s]])))return u}return pi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function Mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return pi(t,e);var n=jo(t),t=jo(e);return 0!==(e=pi(n.seconds,t.seconds))?e:pi(n.nanos,t.nanos)}function Fo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=jo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Go(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,qr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e}(t)}function jo(t){if(Or(!!t),"string"!=typeof t)return{seconds:qo(t.seconds),nanos:qo(t.nanos)};var e=0,n=Ro.exec(t);return Or(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function qo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Go(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function Bo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function zo(t){return t&&"integerValue"in t}function Ho(t){return!!t&&"arrayValue"in t}function Ko(t){return t&&"nullValue"in t}function Wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qo(t){return t&&"mapValue"in t}var Xo={asc:"ASCENDING",desc:"DESCENDING"},Yo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jo=function(t,e){this.U=t,this.Qe=e};function $o(t){return{integerValue:""+t}}function Zo(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function ts(t,e){return Ui(e)?$o(e):Zo(t,e)}function es(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ns(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function rs(t){return Or(!!t),Di.J((t=jo(t),new Si(t.seconds,t.nanos)))}function is(t,e){return new Mr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function os(t){return Or(Is(t=Mr.g(t))),t}function ss(t,e){return is(t.U,e.path)}function us(t,e){return Or((e=os(e)).get(1)===t.U.projectId),Or(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new qr(fs(e))}function as(t,e){return is(t.U,e)}function cs(t){return 4===(t=os(t)).length?Mr.P():fs(t)}function hs(t){return new Mr(["projects",t.U.projectId,"databases",t.U.database]).R()}function fs(t){return Or(4<t.length&&"documents"===t.get(4)),t.u(5)}function ls(t,e,n){return{name:ss(t,e),fields:n.proto.mapValue.fields}}function ps(t,e){var n,r,i;if(e instanceof $s)n={update:ls(t,e.key,e.value)};else if(e instanceof cu)n={delete:ss(t,e.key)};else if(e instanceof Zs)n={update:ls(t,e.key,e.data),updateMask:(i=e.We,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof iu)n={transform:{document:ss(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ns)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ss)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Os)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.R(),increment:e.je};throw kr()})}};else{if(!(e instanceof hu))return kr();n={verify:ss(t,e.key)}}return e.Ge.Ke||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:es(e=t,(t=i.updateTime).Z())}:void 0!==i.exists?{exists:i.exists}:kr()),n}function ds(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?zs.updateTime(rs(i.updateTime)):void 0!==i.exists?zs.exists(i.exists):zs.ze():zs.ze();if(t.update){t.update.name;var n=us(o,t.update.name),r=new fu({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new js(i.map(function(t){return jr.S(t)})));return new Zs(n,r,i,e)}return new $s(n,r,e)}if(t.delete){var s=us(o,t.delete);return new cu(s,e)}return t.transform?(r=us(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(Or("REQUEST_TIME"===n.setToServerValue),i=new Ns):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new Ss(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new Os(r)):"increment"in n?i=new Us(e,n.increment):kr(),n=jr.S(n.fieldPath),new qs(n,i);var e,n,r,i}),Or(!0===e.exists),new iu(r,s)):t.verify?(t=us(o,t.verify),new hu(t,e)):kr()}function ys(t,e){return{documents:[as(t,e.path)]}}function vs(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=as(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=as(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NAN"}};if(Ko(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NAN"}};if(Ko(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bs(t.field),op:(e=t.op,Yo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:bs((t=t).field),direction:(t=t.dir,Xo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Qe||Pi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ms(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ms(e.endAt)),n}function gs(t){var e=cs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Or(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Es(t.unaryFilter.field);return Hu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Es(t.unaryFilter.field);return Hu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Es(t.unaryFilter.field),Hu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Es(t.unaryFilter.field),Hu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Hu.create(Es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new wa(Es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Pi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ws(n.startAt));var u=null;return n.endAt&&(u=ws(n.endAt)),Cu(Su(e,i,t,o,r,"F",s,u))}function ms(t){return{before:t.before,values:t.position}}function ws(t){var e=!!t.before,t=t.values||[];return new fa(t,e)}function bs(t){return{fieldPath:t.R()}}function Es(t){return jr.S(t.fieldPath)}function Is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ts(t,e){return t instanceof Us?zo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var _s,As,Ns=(n(xs,As=h=function(){this.He=void 0}),xs),Ss=(n(Ds,_s=h),Ds);function Ds(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function xs(){return null!==As&&As.apply(this,arguments)||this}function Ls(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Co(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ks,Os=(n(Rs,ks=h),Rs);function Rs(t){var e=this;return(e=ks.call(this)||this).elements=t,e}function Ps(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Co(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Cs,Us=(n(Vs,Cs=h),Vs);function Vs(t,e){var n=this;return(n=Cs.call(this)||this).serializer=t,n.je=e,n}function Ms(t){return qo(t.integerValue||t.doubleValue)}function Fs(t){return Ho(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var js=(Gs.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Gs.prototype.isEqual=function(t){return di(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Gs),qs=function(t,e){this.field=t,this.transform=e};function Gs(t){(this.fields=t).sort(jr.i)}function Bs(t,e){this.version=t,this.transformResults=e}var zs=(Hs.ze=function(){return new Hs},Hs.exists=function(t){return new Hs(void 0,t)},Hs.updateTime=function(t){return new Hs(t)},Object.defineProperty(Hs.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Hs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Hs);function Hs(t,e){this.updateTime=t,this.exists=e}function Ks(t,e){return void 0!==t.updateTime?e instanceof bu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof bu}function Ws(t,e,n,r){return t instanceof $s?(o=e,Ks((i=t).Ge,o)?(o=Xs(o),new bu(i.key,o,i.value,{Je:!0})):o):t instanceof Zs?function(t,e){if(!Ks(t.Ge,e))return e;var n=Xs(e),e=nu(t,e);return new bu(t.key,n,e,{Je:!0})}(t,e):t instanceof iu?function(t,e,n,r){if(!Ks(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof bu&&(h=n.field(a.field)),null===h&&r instanceof bu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ns?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Ss?Ls(c,i):c instanceof Os?Ps(c,i):(i=Ms(c=Ts(h=c,i))+Ms(h.je),zo(c)&&zo(h.je)?$o(i):Zo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=su(t,i.data(),r);return new bu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Ks((t=t).Ge,e)?new Eu(t.key,Di.min()):e);var i,o}function Qs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||di(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ss&&e instanceof Ss||t instanceof Os&&e instanceof Os?di(t.elements,e.elements,Co):t instanceof Us&&e instanceof Us?Co(t.je,e.je):t instanceof Ns&&e instanceof Ns)}))}function Xs(t){return t instanceof bu?t.version:Di.min()}var Ys,Js,$s=(n(eu,Js=be=function(){}),eu),Zs=(n(tu,Ys=be),tu);function tu(t,e,n,r){var i=this;return(i=Ys.call(this)||this).key=t,i.data=e,i.We=n,i.Ge=r,i.type=1,i}function eu(t,e,n){var r=this;return(r=Js.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function nu(t,e){return n=t,e=e instanceof bu?e.data():fu.empty(),r=new lu(e),n.We.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var ru,iu=(n(ou,ru=be),ou);function ou(t,e){var n=this;return(n=ru.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=zs.exists(!0),n}function su(t,e,n){for(var r=new lu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var uu,au,cu=(n(vu,au=be),vu),hu=(n(yu,uu=be),yu),fu=(du.empty=function(){return new du({mapValue:{}})},du.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},du.prototype.isEqual=function(t){return Co(this.proto,t.proto)},du),lu=(pu.prototype.set=function(t,e){return this.en(t,e),this},pu.prototype.delete=function(t){return this.en(t,null),this},pu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},pu.prototype.Xe=function(){var t=this.nn(jr.P(),this.tn);return null!=t?new fu(t):this.Ze},pu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Qo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},pu);function pu(t){void 0===t&&(t=fu.empty()),this.Ze=t,this.tn=new Map}function du(t){this.proto=t}function yu(t,e){var n=this;return(n=uu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function vu(t,e){var n=this;return(n=au.call(this)||this).key=t,n.Ge=e,n.type=3,n}var gu,mu,wu,bu=(n(Nu,wu=Ee=function(t,e){this.key=t,this.version=e}),Nu.prototype.field=function(t){return this.sn.field(t)},Nu.prototype.data=function(){return this.sn},Nu.prototype.rn=function(){return this.sn.proto},Nu.prototype.isEqual=function(t){return t instanceof Nu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},Nu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Nu),Eu=(n(Au,mu=Ee),Au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Au.prototype.isEqual=function(t){return t instanceof Au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Au),Iu=(n(_u,gu=Ee),_u.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(_u.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),_u.prototype.isEqual=function(t){return t instanceof _u&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},_u),Tu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function _u(){return null!==gu&&gu.apply(this,arguments)||this}function Au(t,e,n){var r=this;return(r=mu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Nu(t,e,n,r){var i=this;return(i=wu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Su(t,e,n,r,i,o,s,u){return new Tu(t,e,n,r,i,o,s,u)}function Du(t){return new Tu(t)}function xu(t){return!Pi(t.limit)&&"F"===t.an}function Lu(t){return!Pi(t.limit)&&"L"===t.an}function ku(t){return 0<t.on.length?t.on[0].field:null}function Ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Ru(t){return null!==t.collectionGroup}function Pu(t){var e=t;if(null===e.cn){e.cn=[];var n=Ou(e),t=ku(e);if(null!==n&&null===t)n.p()||e.cn.push(new wa(n)),e.cn.push(new wa(jr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.p()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new wa(jr.v(),n)))}}return e.cn}function Cu(t){var e=t;if(!e.un)if("F"===e.an)e.un=Mi(e.path,e.collectionGroup,Pu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Pu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new wa(o.field,s))}var u=e.endAt?new fa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new fa(e.startAt.position,!e.startAt.before):null;e.un=Mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Uu(t,e,n){return new Tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Vu(t,e){return new Tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Mu(t,e){return new Tu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Fu(t,e){return ji(Cu(t),Cu(e))&&t.an===e.an}function ju(t){return Fi(Cu(t))+"|lt:"+t.an}function qu(t){return"Query(target="+(n=(e=Cu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Fo(t.value)}).join(", ")+"]"),Pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+va(e.startAt)),e.endAt&&(n+=", endAt: "+va(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Gu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):qr.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ga(t.startAt,Pu(t),n))&&(!t.endAt||!ga(t.endAt,Pu(t),n)));var e,n}function Bu(u){return function(t,e){for(var n=!1,r=0,i=Pu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.p()?qr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Vo(o,r):kr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var zu,Hu=(n(Ku,zu=function(){}),Ku.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.ln(t,e,n):new Yu(t,e,n);if(Ko(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Ku(t,e,n)}if(Wo(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Ku(t,e,n)}return"array-contains"===e?new ua(t,n):"in"===e?new aa(t,n):"not-in"===e?new ca(t,n):"array-contains-any"===e?new ha(t,n):new Ku(t,e,n)},Ku.ln=function(t,e,n){return new("in"===e?Ju:$u)(t,n)},Ku.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(Vo(t,this.value)):null!==t&&Po(this.value)===Po(t)&&this._n(Vo(t,this.value))},Ku.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},Ku.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ku);function Ku(t,e,n){var r=this;return(r=zu.call(this)||this).field=t,r.op=e,r.value=n,r}var Wu,Qu,Xu,Yu=(n(ea,Xu=Hu),ea.prototype.matches=function(t){return t=qr.i(t.key,this.key),this._n(t)},ea),Ju=(n(ta,Qu=Hu),ta.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ta),$u=(n(Zu,Wu=Hu),Zu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Zu);function Zu(t,e){var n=this;return(n=Wu.call(this,t,"not-in",e)||this).keys=na(0,e),n}function ta(t,e){var n=this;return(n=Qu.call(this,t,"in",e)||this).keys=na(0,e),n}function ea(t,e,n){var r=this;return(r=Xu.call(this,t,e,n)||this).key=qr.C(n.referenceValue),r}function na(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return qr.C(t.referenceValue)})}var ra,ia,oa,sa,ua=(n(ya,sa=Hu),ya.prototype.matches=function(t){return Ho(t=t.field(this.field))&&Uo(t.arrayValue,this.value)},ya),aa=(n(da,oa=Hu),da.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Uo(this.value.arrayValue,t)},da),ca=(n(pa,ia=Hu),pa.prototype.matches=function(t){return!Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Uo(this.value.arrayValue,t))},pa),ha=(n(la,ra=Hu),la.prototype.matches=function(t){var e=this;return!(!Ho(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Uo(e.value.arrayValue,t)})},la),fa=function(t,e){this.position=t,this.before=e};function la(t,e){return ra.call(this,t,"array-contains-any",e)||this}function pa(t,e){return ia.call(this,t,"not-in",e)||this}function da(t,e){return oa.call(this,t,"in",e)||this}function ya(t,e){return sa.call(this,t,"array-contains",e)||this}function va(t){return(t.before?"b":"a")+":"+t.position.map(Fo).join(",")}function ga(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?qr.i(qr.C(s.referenceValue),n.key):Vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ma(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Co(t.position[n],e.position[n]))return!1;return!0}var wa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ba(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ea,Ia=(ka.prototype.reset=function(){this.En=0},ka.prototype.Rn=function(){this.En=this.Tn},ka.prototype.gn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},ka.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},ka.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},ka.prototype.Pn=function(){return(Math.random()-.5)*this.En},ka),Ta=(La.prototype.catch=function(t){return this.next(void 0,t)},La.prototype.next=function(r,i){var o=this;return this.Dn&&kr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new La(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},La.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},La.prototype.$n=function(t){try{var e=t();return e instanceof La?e:La.resolve(e)}catch(t){return La.reject(t)}},La.prototype.Nn=function(t,e){return t?this.$n(function(){return t(e)}):La.resolve(e)},La.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):La.reject(e)},La.resolve=function(n){return new La(function(t,e){t(n)})},La.reject=function(n){return new La(function(t,e){e(n)})},La.xn=function(t){return new La(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},La.kn=function(t){for(var n=La.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?La.resolve(t):e()})}(r[e]);return n},La.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},La),_a=(xa.delete=function(t){return Sr("SimpleDb","Removing database:",t),Va(window.indexedDB.deleteDatabase(t)).Fn()},xa.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(xa.Bn())return!0;var t=p(),e=0<(n=xa.On(t))&&n<10,n=0<(n=xa.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},xa.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},xa.Qn=function(t,e){return t.store(e)},xa.On=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},xa.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},xa.prototype.Wn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Na(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Ir(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Na(o,t))},r.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Sr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(t){return i.jn(t)}),this.db)]}})})},xa.prototype.Kn=function(e){this.jn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},xa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Wn(u)];case 2:return s.db=t.sent(),e=Ra.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Ta.reject(t)}).Fn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Sr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},xa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},xa),Aa=(Object.defineProperty(Da.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),Da.prototype.done=function(){this.Hn=!0},Da.prototype.Xn=function(t){this.Yn=t},Da.prototype.delete=function(){return Va(this.zn.delete())},Da),Na=(n(Sa,Ea=Ir),Sa);function Sa(t,e){var n=this;return(n=Ea.call(this,Er.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Da(t){this.zn=t,this.Hn=!1,this.Yn=null}function xa(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===xa.On(p())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function La(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function Oa(t){return"IndexedDbTransactionError"===t.name}var Ra=(Ua.open=function(t,e,n,r){try{return new Ua(e,t.transaction(r,n))}catch(t){throw new Na(e,t)}},Object.defineProperty(Ua.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){return t=this.transaction.objectStore(t),new Pa(t)},Ua),Pa=(Ca.prototype.put=function(t,e){return Va(t=void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ca.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),Va(this.store.add(t))},Ca.prototype.get=function(e){var n=this;return Va(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},Ca.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),Va(this.store.delete(t))},Ca.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),Va(this.store.count())},Ca.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},Ca.prototype.ns=function(t,e){return Sr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},Ca.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},Ca.prototype.os=function(r){var t=this.cursor({});return new Ta(function(n,e){t.onerror=function(t){t=Fa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ca.prototype.es=function(t,i){var o=[];return new Ta(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Aa(n),(t=i(n.primaryKey,n.value,e))instanceof Ta&&(t=t.catch(function(t){return e.done(),Ta.reject(t)}),o.push(t)),e.Sn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return Ta.xn(o)})},Ca.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ca.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ca);function Ca(t){this.store=t}function Ua(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ba,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new Na(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=Fa(t.target.error),n.Zn.reject(new Na(e,t))}}function Va(t){return new Ta(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Fa(t.target.error),n(t)}})}var Ma=!1;function Fa(t){var e=_a.On(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Ir("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ma||(Ma=!0,setTimeout(function(){throw n},0)),n}return t}function ja(){return"undefined"!=typeof window?window:null}function qa(){return"undefined"!=typeof document?document:null}var Ga=(Ha._s=function(t,e,n,r,i){return(i=new Ha(t,e,Date.now()+n,r,i)).start(n),i},Ha.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Ha.prototype.pn=function(){return this.ds()},Ha.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ha.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Ha.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},Ha),Ba=(Object.defineProperty(za.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),za.prototype.ws=function(t){this.enqueue(t)},za.prototype.bs=function(t){this.vs(),this.Ss(t)},za.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=qa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs))},za.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},za.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Es.push(t),e.Ns()})},za.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Es.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return t.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!Oa(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Es.length&&this.ys.gn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},za.prototype.Ss=function(t){var r=this,e=this.Ts.then(function(){return r.gs=!0,t().catch(function(t){throw r.Rs=t,r.gs=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.gs=!1,t})});return this.Ts=e},za.prototype.yn=function(t,e,n){var r=this;return this.vs(),-1<this.Ps.indexOf(t)&&(e=0),n=Ga._s(this,t,e,n,function(t){return r.Fs(t)}),this.As.push(n),n},za.prototype.vs=function(){this.Rs&&kr()},za.prototype.$s=function(){},za.prototype.xs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Ts];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ts)return[3,0];t.label=3;case 3:return[2]}})})},za.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},za.prototype.Ms=function(r){var i=this;return this.xs().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.xs()})},za.prototype.Os=function(t){this.Ps.push(t)},za.prototype.Fs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},za);function za(){var e=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new Ia(this,"async_queue_retry"),this.Vs=function(){var t=qa();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.Vn()};var t=qa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}function Ha(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new ba,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Ka(t,e){if(Dr("AsyncQueue",e+": "+t),Oa(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}function Wa(){this.Ls=void 0,this.listeners=[]}function Qa(){this.Bs=new Ni(ju,Fu),this.onlineState="Unknown",this.qs=new Set}function Xa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Wa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Ka(o=t.sent(),"Initialization of query '"+qu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Qs(e.onlineState),i.Ls&&u.Ws(i.Ls)&&Ja(e),[2]}})})}function Ya(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.js(n))]:[2]})})}function Ja(t){t.qs.forEach(function(t){t.next()})}var $a=(ec.prototype.Ws=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new po(t.query,t.docs,t.Qt,e,t.Wt,t.fromCache,t.jt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.Ks.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},ec.prototype.onError=function(t){this.Ks.error(t)},ec.prototype.Qs=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},ec.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.m()&&"Offline"!==e)},ec.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},ec.prototype.Js=function(t){t=po.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Gs=!0,this.Ks.next(t)},ec),Za=(tc.prototype.Zs=function(){return null!=this.uid},tc.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},tc.prototype.isEqual=function(t){return t.uid===this.uid},tc);function tc(t){this.uid=t}function ec(t,e,n){this.query=t,this.Ks=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}Za.UNAUTHENTICATED=new Za(null),Za.ei=new Za("google-credentials-uid"),Za.ni=new Za("first-party-uid");var nc=(rc.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},rc.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},rc);function rc(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function ic(t,e){return"firestore_clients_"+t+"_"+e}function oc(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function sc(t,e){return"firestore_targets_"+t+"_"+e}nc.ai=-1;var uc=(kc.ci=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ir(r.error.code,r.error.message)),i?new kc(t,e,r.state,o):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},kc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},kc),ac=(Lc.ci=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Ir(n.error.code,n.error.message)),r?new Lc(t,n.state,i):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Lc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Lc),cc=(xc.ci=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ho,o=0;r&&o<n.activeTargetIds.length;++o)r=Ui(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xc(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xc),hc=(Dc.ci=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Dc(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},Dc),fc=(Sc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Sc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Sc.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Sc),lc=(Nc.Ln=function(t){return!(!t||!t.localStorage)},Nc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(ic(this.persistenceKey,r)))&&(o=cc.ci(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.Vi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.Ii;a<c.length;a++)h=c[a],this.mi(h);return this.Ii=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ei=!0,[2]}})})},Nc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},Nc.prototype.Ci=function(){return this.Ni(this.Ti)},Nc.prototype.Fi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Nc.prototype.$i=function(t){this.xi(t,"pending")},Nc.prototype.ki=function(t,e,n){this.xi(t,e,n),this.Mi(t)},Nc.prototype.Oi=function(t){var e,n="not-current";return this.Fi(t)&&(!(e=this.storage.getItem(sc(this.persistenceKey,t)))||(e=ac.ci(t,e))&&(n=e.state)),this.Li.hi(t),this.bi(),n},Nc.prototype.Bi=function(t){this.Li.li(t),this.bi()},Nc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},Nc.prototype.Ui=function(t){this.removeItem(sc(this.persistenceKey,t))},Nc.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},Nc.prototype.ji=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.$i(t)})},Nc.prototype.Ki=function(t){this.Gi(t)},Nc.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},Nc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},Nc.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Nc.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Nc.prototype.mi=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Sr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ei){if(null!==s.key)if(this.gi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Yi(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Pi.test(s.key)){if(null!==s.newValue&&(n=this.Ji(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.yi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.Vi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=nc.ai;if(null!=t)try{var n=JSON.parse(t);Or("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==nc.ai&&this.si(o)}else this.Ii.push(s);return[2]})})})}},Object.defineProperty(Nc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),Nc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},Nc.prototype.xi=function(t,e,n){n=new uc(this.currentUser,t,e,n),t=oc(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ui())},Nc.prototype.Mi=function(t){t=oc(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Nc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t},this.storage.setItem(this.Vi,JSON.stringify(t))},Nc.prototype.Wi=function(t,e,n){var r=sc(this.persistenceKey,t),n=new ac(t,e,n);this.setItem(r,n.ui())},Nc.prototype.zi=function(t){return(t=this.gi.exec(t))?t[1]:null},Nc.prototype.Yi=function(t,e){return t=this.zi(t),cc.ci(t,e)},Nc.prototype.Ji=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return uc.ci(new Za(n),t,e)},Nc.prototype.Zi=function(t,e){return t=this.yi.exec(t),t=Number(t[1]),ac.ci(t,e)},Nc.prototype.vi=function(t){return hc.ci(t)},Nc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Nc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},Nc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},Nc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},Nc.prototype.Ni=function(t){var n=ho;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},Nc),pc=(Ac.prototype.$i=function(t){},Ac.prototype.ki=function(t,e,n){},Ac.prototype.Oi=function(t){return this.ir.hi(t),this.rr[t]||"not-current"},Ac.prototype.Qi=function(t,e,n){this.rr[t]=e},Ac.prototype.Bi=function(t){this.ir.li(t)},Ac.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},Ac.prototype.Ui=function(t){delete this.rr[t]},Ac.prototype.Ci=function(){return this.ir.activeTargetIds},Ac.prototype.Fi=function(t){return this.ir.activeTargetIds.has(t)},Ac.prototype.start=function(){return this.ir=new fc,Promise.resolve()},Ac.prototype.ji=function(t,e,n){},Ac.prototype.Ki=function(t){},Ac.prototype.Di=function(){},Ac.prototype.oi=function(t){},Ac),dc=(_c.prototype.cr=function(t,e,n){for(var r,i,o,s,u,a,c=n.ur,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],a=u=s=void 0,e=r instanceof $s?new bu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Zs?(u=i,a=o,Ks((s=r).Ge,u)?(u=nu(s,u),new bu(s.key,a.version,u,{hasCommittedMutations:!0})):new Iu(s.key,a.version)):r instanceof iu?function(t,e,n){if(Or(null!=n.transformResults),!Ks(t.Ge,e))return new Iu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Or(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof bu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ss?Ls(o,s):o instanceof Os?Ps(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=su(t,r.data(),e);return new bu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Eu(r.key,o.version,{hasCommittedMutations:!0}))}return e},_c.prototype.hr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ws(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ws(a,e,o,this.ar))}return e},_c.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.hr(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},_c.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},co())},_c.prototype.isEqual=function(t){return this.batchId===t.batchId&&di(this.mutations,t.mutations,Qs)&&di(this.baseMutations,t.baseMutations,Qs)},_c),yc=(Tc.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=uo,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Tc(t,e,n,r)},Tc),h=(Object.defineProperty(Ic.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),Ic.prototype.Er=function(t,e){this.Ir(),this.readTime=e,this.wr.set(t.key,t)},Ic.prototype.Ar=function(t,e){this.Ir(),e&&(this.readTime=e),this.wr.set(t,null)},Ic.prototype.Rr=function(t,e){this.Ir();var n=this.wr.get(e);return void 0!==n?Ta.resolve(n):this.gr(t,e)},Ic.prototype.getEntries=function(t,e){return this.Pr(t,e)},Ic.prototype.apply=function(t){return this.Ir(),this.mr=!0,this.yr(t)},Ic.prototype.Ir=function(){},Ic),vc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",be=(Ec.prototype.pr=function(t){this.Vr.push(t)},Ec.prototype.br=function(){this.Vr.forEach(function(t){return t()})},Ec),gc=(bc.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},bc.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].hr(r,t);return t})},bc.prototype.$r=function(t,e,i){var o=ro;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].hr(t,e);o=o.ot(t,e)}),o},bc.prototype.kr=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},bc.prototype.Mr=function(e,r){var i=this;return this.Sr.Or(e,r).next(function(t){var t=i.$r(e,r,t),n=ro;return t.forEach(function(t,e){e=e||new Eu(t,Di.min()),n=n.ot(t,e)}),n})},bc.prototype.Lr=function(t,e,n){return r=e,qr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):Ru(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},bc.prototype.Br=function(t,e){return this.Cr(t,new qr(e)).next(function(t){var e=so;return t instanceof bu&&(e=e.ot(t.key,t)),e})},bc.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=so;return this.Dr.Qr(n,s).next(function(t){return Ta.forEach(t,function(t){var e=(e=r,t=t.child(s),new Tu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},bc.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Wr(e,n)}).next(function(t){return h=t,r.jr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Ws(s,a=c.get(u),a,r.ar);c=a instanceof bu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Gu(n,e)||(c=c.remove(t))}),c})},bc.prototype.jr=function(t,e,n){for(var r=co(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Zs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof bu&&(c=c.ot(t,e))}),c})},bc),mc=(wc.zr=function(t,e){for(var n=co(),r=co(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new wc(t,e.fromCache,n,r)},wc);function wc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kr=n,this.Gr=r}function bc(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function Ec(){this.Vr=[]}function Ic(){this.wr=new Ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mr=!1}function Tc(t,e,n,r){this.batch=t,this._r=e,this.ur=n,this.dr=r}function _c(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function Ac(){this.ir=new fc,this.rr={},this.di=null,this.si=null}function Nc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new Qi(pi),this.Ei=!1,this.Ii=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ai=ic(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new fc),this.gi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Vi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function Sc(){this.activeTargetIds=ho}function Dc(t,e){this.clientId=t,this.onlineState=e}function xc(t,e){this.clientId=t,this.activeTargetIds=e}function Lc(t,e,n){this.targetId=t,this.state=e,this.error=n}function kc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Oc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=pi(n,t))?pi(r,e):t}var Rc=(Vc.prototype.Jr=function(){return++this.Yr},Vc.prototype.Xr=function(t){var e=[t,this.Jr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):Oc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Vc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Vc),Pc={Zr:!1,eo:0,no:0,so:0},Cc=(Uc.ao=function(t){return new Uc(t,Uc.co,Uc.uo)},Uc);function Uc(t,e,n){this.io=t,this.ro=e,this.oo=n}function Vc(t){this.Hr=t,this.buffer=new eo(Oc),this.Yr=0}Cc.ho=-1,Cc.lo=1048576,Cc._o=41943040,Cc.co=10,Cc.uo=1e3,Cc.fo=new Cc(Cc._o,Cc.co,Cc.uo),Cc.do=new Cc(Cc.ho,0,0);var Mc=(qc.prototype.start=function(t){this.wo.params.io!==Cc.ho&&this.Eo(t)},qc.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(qc.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),qc.prototype.Eo=function(n){var t=this,e=this.mo?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.cs.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.mo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Io(this.wo)];case 2:return t.sent(),[3,7];case 3:return Oa(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,vf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Eo(n)];case 8:return t.sent(),[2]}})})})},qc),Fc=(jc.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},jc.prototype.yo=function(t,e){var n=this;if(0===e)return Ta.resolve(nc.ai);var r=new Rc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.Vo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},jc.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},jc.prototype.bo=function(t,e){return this.Ao.bo(t,e)},jc.prototype.vo=function(e,n){var r=this;return this.params.io===Cc.ho?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),Ta.resolve(Pc)):this.So(e).next(function(t){return t<r.params.io?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),Pc):r.Do(e,n)})},jc.prototype.So=function(t){return this.Ao.So(t)},jc.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.yo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Nr()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Ta.resolve({Zr:!0,eo:i,no:o,so:t})})},jc);function jc(t,e){this.Ao=t,this.params=e}function qc(t,e){this.wo=t,this.cs=e,this.mo=!1,this.To=null}function Gc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Bc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Bc(o)}function Bc(t){return t+""}function zc(t){var e=t.length;if(Or(2<=e),2===e)return Or(""===t.charAt(0)&&""===t.charAt(1)),Mr.P();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&kr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:kr()}o=s+2}return new Mr(r)}var Hc=function(t){this.Co=t};function Kc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=us(n,r.name),n=rs(r.updateTime),r=new fu({mapValue:{fields:r.fields}}),new bu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=qr.$(e.noDocument.path),o=Jc(e.noDocument.readTime);return new Eu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=qr.$(e.unknownDocument.path),e=Jc(e.unknownDocument.version),new Iu(o,e)):kr()}function Wc(t,e,n){var r=Qc(n),n=e.key.path.h().A();if(e instanceof bu){var i={name:ss(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:es(i,o.version.Z())},o=e.hasCommittedMutations;return new kh(null,null,i,o,r,n)}if(e instanceof Eu){var i=e.key.path.A(),o=Yc(e.version),s=e.hasCommittedMutations;return new kh(null,new xh(i,o),null,s,r,n)}return e instanceof Iu?(s=e.key.path.A(),e=Yc(e.version),new kh(new Lh(s,e),null,null,!0,r,n)):kr()}function Qc(t){return[(t=t.Z()).seconds,t.nanoseconds]}function Xc(t){return t=new Si(t[0],t[1]),Di.J(t)}function Yc(t){return t=t.Z(),new bh(t.seconds,t.nanoseconds)}function Jc(t){return t=new Si(t.seconds,t.nanoseconds),Di.J(t)}function $c(e,t){var n=(t.baseMutations||[]).map(function(t){return ds(e.Co,t)}),r=t.mutations.map(function(t){return ds(e.Co,t)}),i=Si.fromMillis(t.localWriteTimeMs);return new dc(t.batchId,i,n,r)}function Zc(t){var e=Jc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Jc(t.lastLimboFreeSnapshotVersion):Di.min(),r=void 0!==t.query.documents?(Or(1===(r=t.query).documents.length),Cu(Du(cs(r.documents[0])))):gs(t.query);return new zi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,vi.fromBase64String(t.resumeToken))}function th(t,e){var n=Yc(e.nt),r=Yc(e.lastLimboFreeSnapshotVersion),i=(qi(e.target)?ys:vs)(t.Co,e.target),t=e.resumeToken.toBase64();return new Rh(e.targetId,Fi(e.target),n,t,e.sequenceNumber,r,i)}var eh=(nh.$o=function(t,e,n,r){return Or(""!==t.uid),new nh(t.Zs()?t.uid:"",e,n,r)},nh.prototype.xo=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oh(t).rs({index:Nh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},nh.prototype.ko=function(d,y,v,g){var m=this,w=sh(d),b=oh(d);return b.add({}).next(function(t){Or("number"==typeof t);for(var e,n,r,i,o,s=new dc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ps(e.Co,t)}),o=r.mutations.map(function(t){return ps(e.Co,t)}),new Nh(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new eo(function(t,e){return pi(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Sh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,Sh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.Fo[t]=s.keys()}),Ta.xn(a).next(function(){return s})})},nh.prototype.Oo=function(t,e){var n=this;return oh(t).get(e).next(function(t){return t?(Or(t.userId===n.userId),$c(n.serializer,t)):null})},nh.prototype.Lo=function(t,e){var n=this;return this.Fo[e]?Ta.resolve(this.Fo[e]):this.Oo(t,e).next(function(t){return t?(t=t.keys(),n.Fo[e]=t):null})},nh.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return oh(t).rs({index:Nh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Or(e.batchId>=i),o=$c(r.serializer,e)),n.done()}).next(function(){return o})},nh.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return oh(t).rs({index:Nh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},nh.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oh(t).ts(Nh.userMutationsIndex,n).next(function(t){return t.map(function(t){return $c(e.serializer,t)})})},nh.prototype.Nr=function(o,s){var u=this,t=Sh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return sh(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=zc(i);if(r===u.userId&&s.path.isEqual(i))return oh(o).get(t).next(function(t){if(!t)throw kr();Or(t.userId===u.userId),a.push($c(u.serializer,t))});n.done()}).next(function(){return a})},nh.prototype.Or=function(e,t){var s=this,u=new eo(pi),n=[];return t.forEach(function(o){var t=Sh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=sh(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=zc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Ta.xn(n).next(function(){return s.Qo(e,u)})},nh.prototype.Wr=function(t,e){var o=this,s=e.path,u=s.length+1,e=Sh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new eo(pi);return sh(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=zc(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Qo(t,a)})},nh.prototype.Qo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(oh(e).get(t).next(function(t){if(null===t)throw kr();Or(t.userId===n.userId),r.push($c(n.serializer,t))}))}),Ta.xn(i).next(function(){return r})},nh.prototype.Wo=function(e,n){var r=this;return ih(e.jo,this.userId,n).next(function(t){return e.pr(function(){r.Ko(n.batchId)}),Ta.forEach(t,function(t){return r.No.Go(e,t)})})},nh.prototype.Ko=function(t){delete this.Fo[t]},nh.prototype.zo=function(e){var i=this;return this.xo(e).next(function(t){if(!t)return Ta.resolve();var t=IDBKeyRange.lowerBound(Sh.prefixForUser(i.userId)),r=[];return sh(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=zc(t[1]),r.push(t)):n.done()}).next(function(){Or(0===r.length)})})},nh.prototype.Ho=function(t,e){return rh(t,this.userId,e)},nh.prototype.Yo=function(t){var e=this;return uh(t).get(this.userId).next(function(t){return t||new Ah(e.userId,-1,"")})},nh);function nh(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.Fo={}}function rh(t,o,e){var s=(e=Sh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return sh(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ih(t,e,n){var r=t.store(Nh.store),i=t.store(Sh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Or(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Sh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return Ta.xn(o).next(function(){return u})}function oh(t){return Zh.Qn(t,Nh.store)}function sh(t){return Zh.Qn(t,Sh.store)}function uh(t){return Zh.Qn(t,Ah.store)}var ah,ch=(lh.prototype.Er=function(t,e,n){return dh(t).put(yh(e),n)},lh.prototype.Ar=function(t,e){return t=dh(t),e=yh(e),t.delete(e)},lh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Jo(e,t)})},lh.prototype.Rr=function(t,e){var n=this;return dh(t).get(yh(e)).next(function(t){return n.Xo(t)})},lh.prototype.Zo=function(t,e){var n=this;return dh(t).get(yh(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:vh(t)}:null})},lh.prototype.getEntries=function(t,e){var n=this,r=ro;return this.ea(t,e,function(t,e){e=n.Xo(e),r=r.ot(t,e)}).next(function(){return r})},lh.prototype.na=function(t,e){var r=this,i=ro,o=new Qi(qr.i);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,vh(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},lh.prototype.ea=function(t,e,i){if(e.m())return Ta.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e._t(),s=o.It();return dh(t).rs({range:n},function(t,e,n){for(var r=qr.$(t);s&&qr.i(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},lh.prototype.Lr=function(t,r,e){var n,i=this,o=so,s=r.path.length+1,u={};return e.isEqual(Di.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=Qc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=kh.collectionReadTimeIndex),dh(t).rs(u,function(t,e,n){t.length===s&&(e=Kc(i.serializer,e),r.path.T(e.key.path)?e instanceof bu&&Gu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},lh.prototype.ra=function(t){return new hh(this,!!t&&t.oa)},lh.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},lh.prototype.getMetadata=function(t){return ph(t).get(Oh.key).next(function(t){return Or(!!t),t})},lh.prototype.Jo=function(t,e){return ph(t).put(Oh.key,e)},lh.prototype.Xo=function(t){return!t||(t=Kc(this.serializer,t))instanceof Eu&&t.version.isEqual(Di.min())?null:t},lh),hh=(n(fh,ah=h),fh.prototype.yr=function(i){var o=this,s=[],u=0,a=new eo(function(t,e){return pi(t.R(),e.R())});return this.wr.forEach(function(t,e){var n,r=o.ua.get(t);e?(n=Wc(o.ca.serializer,e,o.readTime),a=a.add(t.path.h()),e=vh(n),u+=e-r,s.push(o.ca.Er(i,t,n))):(u-=r,o.oa?(r=Wc(o.ca.serializer,new Eu(t,Di.min()),o.readTime),s.push(o.ca.Er(i,t,r))):s.push(o.ca.Ar(i,t)))}),a.forEach(function(t){s.push(o.ca.Dr.Mo(i,t))}),s.push(this.ca.updateMetadata(i,u)),Ta.xn(s)},fh.prototype.gr=function(t,e){var n=this;return this.ca.Zo(t,e).next(function(t){return null===t?(n.ua.set(e,0),null):(n.ua.set(e,t.size),t.ta)})},fh.prototype.Pr=function(t,e){var n=this;return this.ca.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ua.set(t,e)}),e})},fh);function fh(t,e){var n=this;return(n=ah.call(this)||this).ca=t,n.oa=e,n.ua=new Ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function lh(t,e){this.serializer=t,this.Dr=e}function ph(t){return Zh.Qn(t,Oh.store)}function dh(t){return Zh.Qn(t,kh.store)}function yh(t){return t.path.A()}function vh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}var gh=(_h.prototype.Mo=function(t,e){return this.ha.add(e),Ta.resolve()},_h.prototype.Qr=function(t,e){return Ta.resolve(this.ha.getEntries(e))},_h),mh=(Th.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new eo(Mr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Th.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Th.prototype.getEntries=function(t){return(this.index[t]||new eo(Mr.i)).A()},Th),wh=(Ih.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Or(t<r&&0<=t&&r<=10);var o=new Ra("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Eh.store),(s=e).createObjectStore(Ah.store,{keyPath:Ah.keyPath}),s.createObjectStore(Nh.store,{keyPath:Nh.keyPath,autoIncrement:!0}).createIndex(Nh.userMutationsIndex,Nh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Sh.store),Vh(e),e.createObjectStore(kh.store));var s,u=Ta.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Ph.store),s.deleteObjectStore(Rh.store),s.deleteObjectStore(Ch.store),Vh(e)),u=u.next(function(){return t=o.store(Ch.store),e=new Ch(0,0,Di.min().Z(),0),t.put(Ch.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Nh.store).ts().next(function(t){n.deleteObjectStore(Nh.store),n.createObjectStore(Nh.store,{keyPath:Nh.keyPath,autoIncrement:!0}).createIndex(Nh.userMutationsIndex,Nh.userMutationsKeyPath,{unique:!0});var e=r.store(Nh.store),t=t.map(function(t){return e.put(t)});return Ta.xn(t)});var n,r})),u=u.next(function(){e.createObjectStore(Mh.store,{keyPath:Mh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Oh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(kh.store)).createIndex(kh.readTimeIndex,kh.readTimeIndexPath,{unique:!1}),t.createIndex(kh.collectionReadTimeIndex,kh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},Ih.prototype.addDocumentGlobal=function(e){var n=0;return e.store(kh.store).rs(function(t,e){n+=vh(e)}).next(function(){var t=new Oh(n);return e.store(Oh.store).put(Oh.key,t)})},Ih.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Ah.store),i=n.store(Nh.store);return t.ts().next(function(t){return Ta.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(Nh.userMutationsIndex,t).next(function(t){return Ta.forEach(t,function(t){return Or(t.userId===e.userId),t=$c(r.serializer,t),ih(n,e.userId,t).next(function(){})})})})})},Ih.prototype.ensureSequenceNumbers=function(t){var o=t.store(Ph.store),e=t.store(kh.store);return t.store(Ch.store).get(Ch.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new Mr(t),t=[0,Gc(n)];i.push(o.get(t).next(function(t){return t?Ta.resolve():o.put(new Ph(0,Gc(n),r.highestListenSequenceNumber))}))}).next(function(){return Ta.xn(i)})})},Ih.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:Gc(t)})}}t.createObjectStore(Uh.store,{keyPath:Uh.keyPath});var n=e.store(Uh.store),i=new mh;return e.store(kh.store).rs({ss:!0},function(t,e){return r((t=new Mr(t)).h())}).next(function(){return e.store(Sh.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],zc(n))).h())})})},Ih.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Rh.store);return r.rs(function(t,e){return e=Zc(e),e=th(n.serializer,e),r.put(e)})},Ih),bh=function(t,e){this.seconds=t,this.nanoseconds=e},Eh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ih(t){this.serializer=t}function Th(){this.index={}}function _h(){this.ha=new mh}Eh.store="owner",Eh.key="owner";var Ah=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ah.store="mutationQueues",Ah.keyPath="userId";var Nh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Nh.store="mutations",Nh.keyPath="batchId",Nh.userMutationsIndex="userMutationsIndex",Nh.userMutationsKeyPath=["userId","batchId"];var Sh=(Dh.prefixForUser=function(t){return[t]},Dh.prefixForPath=function(t,e){return[t,Gc(e)]},Dh.key=function(t,e,n){return[t,Gc(e),n]},Dh);function Dh(){}Sh.store="documentMutations",Sh.PLACEHOLDER=new Sh;var xh=function(t,e){this.path=t,this.readTime=e},Lh=function(t,e){this.path=t,this.version=e},kh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};kh.store="remoteDocuments",kh.readTimeIndex="readTimeIndex",kh.readTimeIndexPath="readTime",kh.collectionReadTimeIndex="collectionReadTimeIndex",kh.collectionReadTimeIndexPath=["parentPath","readTime"];var Oh=function(t){this.byteSize=t};Oh.store="remoteDocumentGlobal",Oh.key="remoteDocumentGlobalKey";var Rh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Rh.store="targets",Rh.keyPath="targetId",Rh.queryTargetsIndexName="queryTargetsIndex",Rh.queryTargetsKeyPath=["canonicalId","targetId"];var Ph=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ph.store="targetDocuments",Ph.keyPath=["targetId","path"],Ph.documentTargetsIndex="documentTargetsIndex",Ph.documentTargetsKeyPath=["path","targetId"];var Ch=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ch.key="targetGlobalKey",Ch.store="targetGlobal";var Uh=function(t,e){this.collectionId=t,this.parent=e};function Vh(t){t.createObjectStore(Ph.store,{keyPath:Ph.keyPath}).createIndex(Ph.documentTargetsIndex,Ph.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Rh.store,{keyPath:Rh.keyPath}).createIndex(Rh.queryTargetsIndexName,Rh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ch.store)}Uh.store="collectionParents",Uh.keyPath=["collectionId","parent"];var Mh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Mh.store="clientMetadata",Mh.keyPath="clientId";var Fh=i(i(i([Ah.store,Nh.store,Sh.store,kh.store,Rh.store,Eh.store,Ch.store,Ph.store],[Mh.store]),[Oh.store]),[Uh.store]),jh=(qh.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return Ta.resolve();var r=e._(),i=e.h();return t.pr(function(){n.la.add(e)}),i={collectionId:r,parent:Gc(i)},Gh(t).put(i)},qh.prototype.Qr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[yi(i),""],!1,!0);return Gh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(zc(r.parent))}return o})},qh);function qh(){this.la=new mh}function Gh(t){return Zh.Qn(t,Uh.store)}var Bh=(Kh.prototype.next=function(){return this._a+=2,this._a},Kh.fa=function(){return new Kh(0)},Kh.da=function(){return new Kh(-1)},Kh),zh=(Hh.prototype.wa=function(n){var r=this;return this.ma(n).next(function(t){var e=new Bh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},Hh.prototype.Ea=function(t){return this.ma(t).next(function(t){return Di.J(new Si(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Hh.prototype.Ia=function(t){return this.ma(t).next(function(t){return t.highestListenSequenceNumber})},Hh.prototype.Aa=function(e,n,r){var i=this;return this.ma(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.Z()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},Hh.prototype.Ra=function(e,n){var r=this;return this.ga(e,n).next(function(){return r.ma(e).next(function(t){return t.targetCount+=1,r.Pa(n,t),r.Ta(e,t)})})},Hh.prototype.ya=function(t,e){return this.ga(t,e)},Hh.prototype.Va=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Wh(e).delete(t.targetId)}).next(function(){return n.ma(e)}).next(function(t){return Or(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},Hh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Wh(n).rs(function(t,e){(e=Zc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Va(n,e)))}).next(function(){return Ta.xn(u)}).next(function(){return s})},Hh.prototype.Ce=function(t,n){return Wh(t).rs(function(t,e){e=Zc(e),n(e)})},Hh.prototype.ma=function(t){return Qh(t).get(Ch.key).next(function(t){return Or(null!==t),t})},Hh.prototype.Ta=function(t,e){return Qh(t).put(Ch.key,e)},Hh.prototype.ga=function(t,e){return Wh(t).put(th(this.serializer,e))},Hh.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Hh.prototype.ba=function(t){return this.ma(t).next(function(t){return t.targetCount})},Hh.prototype.va=function(t,r){var e=Fi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Wh(t).rs({range:e,index:Rh.queryTargetsIndexName},function(t,e,n){e=Zc(e),ji(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Hh.prototype.Sa=function(n,t,r){var i=this,o=[],s=Xh(n);return t.forEach(function(t){var e=Gc(t.path);o.push(s.put(new Ph(r,e))),o.push(i.No.Da(n,r,t))}),Ta.xn(o)},Hh.prototype.Ca=function(n,t,r){var i=this,o=Xh(n);return Ta.forEach(t,function(t){var e=Gc(t.path);return Ta.xn([o.delete([r,e]),i.No.Na(n,r,t)])})},Hh.prototype.pa=function(t,e){return t=Xh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Hh.prototype.Fa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Xh(t),r=co();return t.rs({range:e,ss:!0},function(t,e,n){t=zc(t[1]),t=new qr(t),r=r.add(t)}).next(function(){return r})},Hh.prototype.Ho=function(t,e){var e=Gc(e.path),e=IDBKeyRange.bound([e],[yi(e)],!1,!0),i=0;return Xh(t).rs({index:Ph.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Hh.prototype.Ue=function(t,e){return Wh(t).get(e).next(function(t){return t?Zc(t):null})},Hh);function Hh(t,e){this.No=t,this.serializer=e}function Kh(t){this._a=t}function Wh(t){return Zh.Qn(t,Rh.store)}function Qh(t){return Zh.Qn(t,Ch.store)}function Xh(t){return Zh.Qn(t,Ph.store)}var Yh,Jh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$h=(n(ef,Yh=be),ef),Zh=(tf.Qn=function(t,e){if(t instanceof $h)return _a.Qn(t.jo,e);throw kr()},tf.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,Jh);return e.Ha(),e.Ya(),e.Ja(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ka.Ia(t)})}).then(function(t){e.Ma=new nc(t,e.xa)}).then(function(){e.Oa=!0}).catch(function(t){return e.ja&&e.ja.close(),Promise.reject(t)})},tf.prototype.Xa=function(n){var t=this;return this.Qa=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ei?[2,n(e)]:[2]})})},n(this.isPrimary)},tf.prototype.Za=function(n){var t=this;this.ja.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},tf.prototype.tc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},tf.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return rf(e).put(new Mh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ec(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Qa(!1)}))})}).next(function(){return n.nc(e)}).next(function(t){return n.isPrimary&&!t?n.sc(e).next(function(){return!1}):!!t&&n.ic(e).next(function(){return!0})})}).catch(function(t){if(Oa(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Qa(t)}),n.isPrimary=t})},tf.prototype.ec=function(t){var e=this;return nf(t).get(Eh.key).next(function(t){return Ta.resolve(e.rc(t))})},tf.prototype.oc=function(t){return rf(t).delete(this.clientId)},tf.prototype.ac=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=tf.Qn(t,Mh.store);return r.ts().next(function(t){var e=o.uc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ta.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.hc(i.clientId));t.label=2;case 2:return[2]}})})},tf.prototype.Ja=function(){var t=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ac()}).then(function(){return t.Ja()})})},tf.prototype.rc=function(t){return!!t&&t.ownerId===this.clientId},tf.prototype.nc=function(e){var r=this;return this.ka?Ta.resolve(!0):nf(e).get(Eh.key).next(function(t){if(null!==t&&r.cc(t.leaseTimestampMs,5e3)&&!r.lc(t.ownerId)){if(r.rc(t)&&r.networkEnabled)return!0;if(!r.rc(t)){if(!t.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,Jh);return!1}}return!(!r.networkEnabled||!r.inForeground)||rf(e).ts().next(function(t){return void 0===r.uc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},tf.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[Eh.store,Mh.store],function(t){var e=new $h(t,nc.ai);return n.sc(e).next(function(){return n.oc(e)})})];case 1:return t.sent(),this.ja.close(),this.wc(),[2]}})})},tf.prototype.uc=function(t,e){var n=this;return t.filter(function(t){return n.cc(t.updateTimeMs,e)&&!n.lc(t.clientId)})},tf.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return rf(t).ts().next(function(t){return e.uc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(tf.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),tf.prototype.mc=function(t){return eh.$o(t,this.serializer,this.Dr,this.No)},tf.prototype.Tc=function(){return this.Ka},tf.prototype.Ec=function(){return this.vr},tf.prototype.Ic=function(){return this.Dr},tf.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ja.runTransaction(e,t,Fh,function(t){return o=new $h(t,i.Ma?i.Ma.next():nc.ai),"readwrite-primary"===n?i.ec(o).next(function(t){return!!t||i.nc(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Qa(!1)}),new Ir(Er.FAILED_PRECONDITION,vc);return r(o)}).next(function(t){return i.ic(o).next(function(){return t})}):i.Ac(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},tf.prototype.Ac=function(t){var e=this;return nf(t).get(Eh.key).next(function(t){if(null!==t&&e.cc(t.leaseTimestampMs,5e3)&&!e.lc(t.ownerId)&&!e.rc(t)&&!(e.ka||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ir(Er.FAILED_PRECONDITION,Jh)})},tf.prototype.ic=function(t){var e=new Eh(this.clientId,this.allowTabSynchronization,Date.now());return nf(t).put(Eh.key,e)},tf.Ln=function(){return _a.Ln()},tf.prototype.sc=function(t){var e=this,n=nf(t);return n.get(Eh.key).next(function(t){return e.rc(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(Eh.key)):Ta.resolve()})},tf.prototype.cc=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},tf.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},tf.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},tf.prototype.Ya=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e._c(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},tf.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},tf.prototype.lc=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.hc(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},tf.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},tf.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(t){}},tf.prototype.hc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},tf);function tf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.xa=a,this.ka=c,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(t){return Promise.resolve()},!tf.Ln())throw new Ir(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new of(this,r),this.Wa=e+"main",this.serializer=new Hc(u),this.ja=new _a(this.Wa,10,new wh(this.serializer)),this.Ka=new zh(this.No,this.serializer),this.Dr=new jh,this.vr=(e=this.serializer,u=this.Dr,new ch(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function ef(t,e){var n=this;return(n=Yh.call(this)||this).jo=t,n.$a=e,n}function nf(t){return Zh.Qn(t,Eh.store)}function rf(t){return Zh.Qn(t,Mh.store)}var of=(sf.prototype.Po=function(t){var n=this.Rc(t);return this.db.Tc().ba(t).next(function(e){return n.next(function(t){return e+t})})},sf.prototype.Rc=function(t){var e=0;return this.Vo(t,function(t){e++}).next(function(){return e})},sf.prototype.Ce=function(t,e){return this.db.Tc().Ce(t,e)},sf.prototype.Vo=function(t,n){return this.gc(t,function(t,e){return n(e)})},sf.prototype.Da=function(t,e,n){return uf(t,n)},sf.prototype.Na=function(t,e,n){return uf(t,n)},sf.prototype.po=function(t,e,n){return this.db.Tc().po(t,e,n)},sf.prototype.Go=uf,sf.prototype.Pc=function(t,e){return r=e,i=!1,uh(n=t).os(function(t){return rh(n,t,r).next(function(t){return t&&(i=!0),Ta.resolve(!t)})}).next(function(){return i});var n,r,i},sf.prototype.bo=function(n,r){var i=this,o=this.db.Ec().ra(),s=[],u=0;return this.gc(n,function(e,t){t<=r&&(t=i.Pc(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),Xh(n).delete([0,Gc(e.path)])})}),s.push(t))}).next(function(){return Ta.xn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},sf.prototype.removeTarget=function(t,e){return e=e.st(t.$a),this.db.Tc().ya(t,e)},sf.prototype.yc=uf,sf.prototype.gc=function(t,r){var i,t=Xh(t),o=nc.ai;return t.rs({index:Ph.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==nc.ai&&r(new qr(zc(i)),o),o=e,i=t):o=nc.ai}).next(function(){o!==nc.ai&&r(new qr(zc(i)),o)})},sf.prototype.So=function(t){return this.db.Ec().aa(t)},sf);function sf(t,e){this.db=t,this.wo=new Fc(this,e)}function uf(t,e){return Xh(t).put((t=t.$a,new Ph(0,Gc(e.path),t)))}function af(t,e){var n=t.projectId;return t.j||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var cf=(hf.prototype.Io=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bc)})},hf);function hf(t,e,n){this.persistence=t,this.Vc=e,this.bc=new Qi(pi),this.vc=new Ni(Fi,ji),this.Sc=Di.min(),this.Sr=t.mc(n),this.Dc=t.Ec(),this.Ka=t.Tc(),this.Cc=new gc(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}function ff(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ka.Ea(t)})}function lf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ka.va(e,r).next(function(t){return t?(n=t,Ta.resolve(n)):i.Ka.wa(e).next(function(t){return n=new zi(r,t,0,e.$a),i.Ka.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bc.get(t.targetId);return(null===e||0<t.nt.L(e.nt))&&(i.bc=i.bc.ot(t.targetId,t),i.vc.set(r,t.targetId)),t})}function pf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Oa(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bc=e.bc.remove(o),e.vc.delete(n.target),[2]}})})}function df(t,o,s){var u=t,a=Di.min(),c=co();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Cu(o),(void 0!==(t=(i=t).vc.get(r))?Ta.resolve(i.bc.get(t)):i.Ka.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ka.Fa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Vc.Lr(e,o,s?a:Di.min(),s?c:co())}).next(function(t){return{documents:t,Fc:c}});var t,n,r,i})}function yf(t,e){var n=t,r=n.Ka;return(t=n.bc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function vf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||e.message!==vc)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function gf(t,e){this.user=e,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+t}function mf(t,e,n,r,i){var o=this;this.ju=t,this.Ku=e,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=i,this.Xu.Zu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return $f(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(4),[4,zf(e)];case 1:return t.sent(),e.th.set("Unknown"),e.Yu.delete(4),[4,Bf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.th=new kf(n,r)}var wf,bf,Ef,If=(Gf.prototype.m=function(){return this.xc.m()},Gf.prototype.Da=function(t,e){e=new Tf(t,e),this.xc=this.xc.add(e),this.Mc=this.Mc.add(e)},Gf.prototype.Lc=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},Gf.prototype.Na=function(t,e){this.Bc(new Tf(t,e))},Gf.prototype.qc=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},Gf.prototype.Uc=function(t){var e=this,n=new qr(new Mr([])),r=new Tf(n,t),t=new Tf(n,t+1),i=[];return this.Mc.Ft([r,t],function(t){e.Bc(t),i.push(t.key)}),i},Gf.prototype.Qc=function(){var e=this;this.xc.forEach(function(t){return e.Bc(t)})},Gf.prototype.Bc=function(t){this.xc=this.xc.delete(t),this.Mc=this.Mc.delete(t)},Gf.prototype.Wc=function(t){var e=new qr(new Mr([])),n=new Tf(e,t),t=new Tf(e,t+1),r=co();return this.Mc.Ft([n,t],function(t){r=r.add(t.key)}),r},Gf.prototype.Ho=function(t){var e=new Tf(t,0);return null!==(e=this.xc.xt(e))&&t.isEqual(e.key)},Gf),Tf=(qf.kc=function(t,e){return qr.i(t.key,e.key)||pi(t.jc,e.jc)},qf.Oc=function(t,e){return pi(t.jc,e.jc)||qr.i(t.key,e.key)},qf),_f=(jf.prototype.getToken=function(){return Promise.resolve(null)},jf.prototype.zc=function(){},jf.prototype.Hc=function(t){(this.Gc=t)(Za.UNAUTHENTICATED)},jf.prototype.Yc=function(){this.Gc=null},jf),Af=(Ff.prototype.getToken=function(){var e=this,n=this.Zc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Zc!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Or("string"==typeof t.accessToken),new gf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ff.prototype.zc=function(){this.forceRefresh=!0},Ff.prototype.Hc=function(t){this.Gc=t,this.Xc&&t(this.currentUser)},Ff.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},Ff.prototype.tu=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new Za(t)},Ff),Nf=(Object.defineProperty(Mf.prototype,"Kc",{get:function(){var t={"X-Goog-AuthUser":this.nu},e=this.eu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Mf),Sf=(Vf.prototype.getToken=function(){return Promise.resolve(new Nf(this.eu,this.nu))},Vf.prototype.Hc=function(t){t(Za.ni)},Vf.prototype.Yc=function(){},Vf.prototype.zc=function(){},Vf),Ee=(Uf.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},Uf.prototype.uu=function(){return 2===this.state},Uf.prototype.start=function(){3!==this.state?this.auth():this.hu()},Uf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Uf.prototype.lu=function(){this.state=0,this.ys.reset()},Uf.prototype._u=function(){var t=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,function(){return t.fu()}))},Uf.prototype.du=function(t){this.wu(),this.stream.send(t)},Uf.prototype.fu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uu()?[2,this.close(0)]:[2]})})},Uf.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},Uf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==e?this.ys.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},Uf.prototype.mu=function(){},Uf.prototype.auth=function(){var n=this;this.state=1;var t=this.Eu(this.ou),e=this.ou;this.ru.getToken().then(function(t){n.ou===e&&n.Iu(t)},function(e){t(function(){var t=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Au(t)})})},Uf.prototype.Iu=function(t){var e=this,n=this.Eu(this.ou);this.stream=this.Ru(t),this.stream.gu(function(){n(function(){return e.state=2,e.listener.gu()})}),this.stream.Tu(function(t){n(function(){return e.Au(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Uf.prototype.hu=function(){var t=this;this.state=4,this.ys.gn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Uf.prototype.Au=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Uf.prototype.Eu=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ou===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Uf),Df=(n(Cf,Ef=Ee),Cf.prototype.Ru=function(t){return this.iu.Pu("Listen",t)},Cf.prototype.onMessage=function(t){this.ys.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(Or(void 0===o||"string"==typeof o),vi.fromBase64String(o||"")):(Or(void 0===o||o instanceof Uint8Array),vi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Wi(s.code),new Ir(o,s.message||"")),r=new wo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=us(t,a.document.name),u=rs(a.document.updateTime),s=new fu({mapValue:{fields:a.document.fields}}),u=new bu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new go(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=us(t,a.document),c=a.readTime?rs(a.readTime):Di.min(),c=new Eu(u,c),a=a.removedTargetIds||[];r=new go([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=us(t,c.document),c=c.removedTargetIds||[];r=new go([],c,h,null)}else{if(!("filter"in e))return kr();e.filter,(h=e.filter).targetId,e=new Gi(e=h.count||0),h=h.targetId,r=new mo(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Di.min():rs(e.readTime);return this.listener.yu(n,t)},Cf.prototype.Vu=function(t){var e,n,r,i,o={};o.database=hs(this.serializer),o.addTarget=(e=this.serializer,(r=qi(r=(n=t).target)?{documents:ys(e,r)}:{query:vs(e,r)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=ns(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.du(o)},Cf.prototype.pu=function(t){var e={};e.database=hs(this.serializer),e.removeTarget=t,this.du(e)},Cf),xf=(n(Pf,bf=Ee),Object.defineProperty(Pf.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),Pf.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,bf.prototype.start.call(this)},Pf.prototype.mu=function(){this.bu&&this.Su([])},Pf.prototype.Ru=function(t){return this.iu.Pu("Write",t)},Pf.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this.bu){this.ys.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(Or(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?rs(e.updateTime):rs(n)).isEqual(Di.min())&&(r=rs(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Bs(r,n);var e,n,r})):[]),n=rs(t.commitTime);return this.listener.Du(n,e)}var i;return Or(!t.writeResults||0===t.writeResults.length),this.bu=!0,this.listener.Cu()},Pf.prototype.Nu=function(){var t={};t.database=hs(this.serializer),this.du(t)},Pf.prototype.Su=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ps(e.serializer,t)})};this.du(t)},Pf),Lf=(n(Rf,wf=function(){}),Rf.prototype.$u=function(){if(this.Fu)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},Rf.prototype.xu=function(e,n,r){var i=this;return this.$u(),this.credentials.getToken().then(function(t){return i.iu.xu(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.zc(),t})},Rf.prototype.ku=function(e,n,r){var i=this;return this.$u(),this.credentials.getToken().then(function(t){return i.iu.ku(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.zc(),t})},Rf.prototype.terminate=function(){this.Fu=!1},Rf),kf=(Of.prototype.Bu=function(){var t=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,function(){return t.Ou=null,t.Uu("Backend didn't respond within 10 seconds."),t.qu("Offline"),Promise.resolve()}))},Of.prototype.Qu=function(t){"Online"===this.state?this.qu("Unknown"):(this.Mu++,1<=this.Mu&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.qu("Offline")))},Of.prototype.set=function(t){this.Wu(),this.Mu=0,"Online"===t&&(this.Lu=!1),this.qu(t)},Of.prototype.qu=function(t){t!==this.state&&(this.state=t,this.di(t))},Of.prototype.Uu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Lu?(Dr(t),this.Lu=!1):Sr("OnlineStateTracker",t)},Of.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},Of);function Of(t,e){this.cs=t,this.di=e,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}function Rf(t,e,n){var r=this;return(r=wf.call(this)||this).credentials=t,r.iu=e,r.serializer=n,r.Fu=!1,r}function Pf(t,e,n,r,i){var o=this;return(o=bf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.bu=!1,o}function Cf(t,e,n,r,i){var o=this;return(o=Ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Uf(t,e,n,r,i,o){this.fn=t,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new Ia(t,e)}function Vf(t,e){this.eu=t,this.nu=e}function Mf(t,e){this.eu=t,this.nu=e,this.type="FirstParty",this.user=Za.ni}function Ff(t){var e=this;this.Jc=null,this.currentUser=Za.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){e.Zc++,e.currentUser=e.tu(),e.Xc=!0,e.Gc&&e.Gc(e.currentUser)},this.Zc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),t.get().then(function(t){e.auth=t,e.Jc&&e.auth.addAuthTokenListener(e.Jc)},function(){}))}function jf(){this.Gc=null}function qf(t,e){this.key=t,this.jc=e}function Gf(){this.xc=new eo(Tf.kc),this.Mc=new eo(Tf.Oc)}function Bf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!$f(r))return[3,4];e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function zf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Hf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Yu.add(5),[4,zf(e)];case 1:return t.sent(),e.Xu.Di(),e.th.set("Unknown"),[2]}})})}function Kf(t,e){t.Hu.has(e.targetId)||(t.Hu.set(e.targetId,e),Jf(t)?Yf(t):sl(t).uu()&&Qf(t,e))}function Wf(t,e){var n=t,t=sl(n);n.Hu.delete(e),t.uu()&&Xf(n,e),0===n.Hu.size&&(t.uu()?t._u():$f(n)&&n.th.set("Unknown"))}function Qf(t,e){t.eh.Ie(e.targetId),sl(t).Vu(e)}function Xf(t,e){t.eh.Ie(e),sl(t).pu(e)}function Yf(e){e.eh=new Eo({qe:function(t){return e.Gu.qe(t)},Ue:function(t){return e.Hu.get(t)||null}}),sl(e).start(),e.th.Bu()}function Jf(t){return $f(t)&&!sl(t).cu()&&0<t.Hu.size}function $f(t){return 0===t.Yu.size}function Zf(t){t.eh=void 0}function tl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Oa(r))throw r;return n.Yu.add(1),[4,zf(n)];case 1:return t.sent(),n.th.set("Offline"),i=i||function(){return ff(n.ju)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Yu.delete(1),[4,Bf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function el(e,n){return n().catch(function(t){return tl(e,t,n)})}function nl(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=ul(s=h),a=0<s.zu.length?s.zu[s.zu.length-1].batchId:-1,t.label=1;case 1:if(!($f(s)&&s.zu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.ju,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Sr.Bo(t,i)}))];case 3:return null===(c=t.sent())?(0===s.zu.length&&u._u(),[3,7]):(a=c.batchId,n=c,(e=s).zu.push(n),(e=ul(e)).uu()&&e.vu&&e.Su(n.mutations),[3,6]);case 4:return c=t.sent(),[4,tl(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return rl(s)&&il(s),[2]}var e,n,r,i,o})})}function rl(t){return $f(t)&&!ul(t).cu()&&0<t.zu.length}function il(t){ul(t).start()}function ol(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Yu.delete(2),[4,Bf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Yu.add(2),[4,zf(e)]);case 3:t.sent(),e.th.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function sl(n){var t,e,r,i=this;return n.oh||(n.oh=(t=n.Ku,e=n.cs,r={gu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Hu.forEach(function(t,e){Qf(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Zf(e),Jf(e)?(e.th.Qu(n),Yf(e)):e.th.set("Unknown"),[2]})})}.bind(null,n),yu:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.th.set("Online"),!(u instanceof wo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Hu.has(i)?[4,o.Gu.nh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Hu.delete(i),o.eh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,tl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof go?s.eh.be(u):u instanceof mo?s.eh.xe(u):s.eh.De(u),a.isEqual(Di.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ff(s.ju)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).eh.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.Hu.get(e))&&r.Hu.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Hu.get(t);e&&(r.Hu.set(t,e.it(vi.B,e.nt)),Xf(r,t),e=new zi(e.target,t,1,e.sequenceNumber),Qf(r,e))}),r.Gu.sh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,tl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.$u(),new Df(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oh.lu(),Jf(n)?Yf(n):n.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oh.stop()];case 2:t.sent(),Zf(n),t.label=3;case 3:return[2]}})})})),n.oh}function ul(n){var t,e,r,i=this;return n.ah||(n.ah=(t=n.Ku,e=n.cs,r={gu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ul(e).Nu(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ul(e).vu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ki(n=i.code)&&n!==Er.ABORTED?(e=r.zu.shift(),ul(r).lu(),[4,el(r,function(){return r.Gu.rh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,nl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return rl(e)&&il(e),[2]}})})}.bind(null,n),Cu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ul(o),n=0,r=o.zu;n<r.length;n++)i=r[n],e.Su(i.mutations);return[2]})})}.bind(null,n),Du:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.zu.shift(),n=yc.from(e,i,o),[4,el(r,function(){return r.Gu.ih(n)})];case 1:return t.sent(),[4,nl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.$u(),new xf(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ah.lu(),[4,nl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ah.stop()];case 3:t.sent(),0<n.zu.length&&(Sr("RemoteStore","Stopping write stream with "+n.zu.length+" pending writes"),n.zu=[]),t.label=4;case 4:return[2]}})})})),n.ah}var al=function(t){this.key=t},cl=function(t){this.key=t},hl=(Object.defineProperty(yl.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),yl.prototype.wh=function(t,e){var s=this,u=e?e.mh:new lo,a=(e||this).fh,c=(e||this).Wt,h=a,f=!1,l=xu(this.query)&&a.size===this.query.limit?a.last():null,p=Lu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof bu?e:null)&&(Gu(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Je||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s._h(r,l)||p&&s._h(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),xu(this.query)||Lu(this.query))for(;h.size>this.query.limit;){var n=xu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,mh:u,Eh:f,Wt:c}},yl.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},yl.prototype.yr=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Wt=t.Wt;var i=t.mh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Ih(n);var s=e?this.Ah():[],e=(n=0===this.lh.size&&this.te?1:0)!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new po(this.query,t.fh,r,i,t.Wt,0==n,e,!1),Rh:s}:{Rh:s}},yl.prototype.Qs=function(t){return this.te&&"Offline"===t?(this.te=!1,this.yr({fh:this.fh,mh:new lo,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},yl.prototype.gh=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},yl.prototype.Ih=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},yl.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=co(),this.fh.forEach(function(t){e.gh(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new cl(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new al(t))}),r},yl.prototype.Ph=function(t){return this.uh=t.Fc,this.lh=co(),t=this.wh(t.documents),this.yr(t,!0)},yl.prototype.yh=function(){return po.Gt(this.query,this.fh,this.Wt,0===this.hh)},yl),fl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ll=function(t){this.key=t,this.Vh=!1},pl=(Object.defineProperty(dl.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),dl);function dl(t,e,n,r,i,o){this.ju=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new Ni(ju,Fu),this.Fh=new Map,this.$h=[],this.xh=new Qi(qr.i),this.kh=new Map,this.Mh=new If,this.Oh={},this.Lh=new Map,this.Bh=Bh.da(),this.onlineState="Unknown",this.qh=void 0}function yl(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=co(),this.Wt=co(),this._h=Bu(t),this.fh=new fo(this._h)}function vl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Eh?[4,df(r.ju,i.query,!1).then(function(t){return t=t.documents,i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.yr(e,r.Uh,n),[2,(Tl(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,df(i.ju,o,!0)];case 1:return n=t.sent(),r=new hl(o,n.Fc),e=r.wh(n.documents),n=vo.Zt(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Uh,n),Tl(i,s,n.Rh),r=new fl(o,s,r),[2,(i.Nh.set(o,r),i.Fh.has(s)?i.Fh.get(s).push(o):i.Fh.set(s,[o]),n.snapshot)]}})})}function gl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,c=e,h=(a=o).nt,f=c.bc,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Dc.ra({oa:!0});f=c.bc;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ka.Ca(s,t.se,e).next(function(){return c.Ka.Sa(s,t.ee,e)})),0<(i=t.resumeToken).O()&&(n=o.it(i,h).st(s.$a),f=f.ot(e,n),r=o,i=t,Or(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.Ka.ya(s,n))))});var t,o=ro,n=co();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof Eu&&e.version.isEqual(Di.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Er(e,h),o=o.ot(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(c.persistence.No.yc(s,t))})})),h.isEqual(Di.min())||(t=c.Ka.Ea(s).next(function(t){return c.Ka.Aa(s,s.$a,h)}),u.push(t)),Ta.xn(u).next(function(){return i.apply(s)}).next(function(){return c.Cc.Mr(s,o)})}).then(function(t){return c.bc=f,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.kh.get(e))&&(Or(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Vh=!0:0<t.ne.size?Or(e.Vh):0<t.se.size&&(Or(e.Vh),e.Vh=!1))}),[4,Al(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,vf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,f})})}function ml(t,n,e){var r;((t=t).Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){(e=e.view.Qs(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Qs(i)&&(o=!0)}),o&&Ja(t)}(t.bh,n),r.length&&t.Ch.yu(r),t.onlineState=n,t.Uh&&t.Sh.Ki(n))}function wl(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function bl(t,e,n){var r=t,i=r.Oh[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Oh[r.currentUser.ti()]=i)}function El(e,t,n){void 0===n&&(n=null),e.Sh.Bi(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Wh(o,n)}e.Fh.delete(t),e.Uh&&e.Mh.Uc(t).forEach(function(t){e.Mh.Ho(t)||Il(e,t)})}function Il(t,e){var n=t.xh.get(e);null!==n&&(Wf(t.ph,n),t.xh=t.xh.remove(e),t.kh.delete(n),_l(t))}function Tl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof al?(t.Mh.Da(u.key,e),r=t,i=(i=u).key,r.xh.get(i)||(Sr("SyncEngine","New document in limbo: "+i),r.$h.push(i),_l(r))):u instanceof cl?(Sr("SyncEngine","Document no longer in limbo: "+u.key),t.Mh.Na(u.key,e),t.Mh.Ho(u.key)||Il(t,u.key)):kr()}}function _l(t){for(;0<t.$h.length&&t.xh.size<t.Dh;){var e=t.$h.shift(),n=t.Bh.next();t.kh.set(n,new ll(e)),t.xh=t.xh.ot(e,n),Kf(t.ph,new zi(Cu(Du(e.path)),n,2,nc.ai))}}function Al(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.m()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Qh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=mc.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.yu(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ta.forEach(c,function(e){return Ta.forEach(e.Kr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return Ta.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Oa(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bc.get(o),u=s.nt,u=s.rt(u),r.bc=r.bc.ot(o,u));return[2]}})})}(n.ju,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Nl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Fh.get(s))&&0!==a.length?[4,lf(e.ju,Cu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,df((e=r).ju,i.query,!0)];case 1:return n=t.sent(),n=i.view.Ph(n),[2,(e.Uh&&Tl(e,i.targetId,n.Rh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,yf(e.ju,s)];case 8:return l=t.sent(),[4,lf(e.ju,l)];case 9:return u=t.sent(),[4,vl(e,Sl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.yu(r),n)]}})})}function Sl(t){return Su(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Dl(t){return t.ph.Gu.sh=gl.bind(null,t),t.ph.Gu.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.Vh)return co().add(t.key);var r=co();if(!(e=n.Fh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Gu.nh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Qi(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new Qi(qr.i)).ot(n,new Eu(n,Di.min())),i=co().add(n),i=new yo(Di.min(),new Map,new eo(pi),r,i),[4,gl(e,i)]):[3,2];case 1:return t.sent(),e.xh=e.xh.remove(n),e.kh.delete(s),_l(e),[3,4];case 2:return[4,pf(e.ju,s,!1).then(function(){return El(e,s,u)}).catch(vf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.yu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ws(s)&&(r=!0);u.Ls=s}}r&&Ja(n)}.bind(null,t.bh),t.Ch.Wh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function xl(t){return t.ph.Gu.ih=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Dc.ra({oa:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Ta.resolve();return a.forEach(function(n){c=c.next(function(){return s.Rr(o,n)}).next(function(t){var e=t;Or(null!==(t=r.dr.get(n))),(!e||e.version.L(t)<0)&&(e=u.cr(n,e,r))&&s.Er(e,r._r)})}),c.next(function(){return i.Sr.Wo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Cc.kr(t,e)})}))];case 2:return i=t.sent(),bl(n,r,null),wl(n,r),n.Sh.ki(r,"acknowledged"),[4,Al(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,vf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.ph.Gu.rh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.Oo(e,r).next(function(t){return Or(null!==t),n=t.keys(),i.Sr.Wo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Cc.kr(e,n)})}))];case 2:return o=t.sent(),bl(n,u,a),wl(n,u),n.Sh.ki(u,"rejected",a),[4,Al(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,vf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var Ll,kl,Ol,Rl=(ip.prototype.Nc=function(t){this.zh=t},ip.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.p())||i.isEqual(Di.min())?this.Hh(e,r):this.zh.kr(e,o).next(function(t){var n=s.Yh(r,t);return(xu(r)||Lu(r))&&s.Eh(r.an,n,o,i)?s.Hh(e,r):(Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qu(r)),s.zh.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},ip.prototype.Yh=function(n,t){var r=new eo(Bu(n));return t.forEach(function(t,e){e instanceof bu&&Gu(n,e)&&(r=r.add(e))}),r},ip.prototype.Eh=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},ip.prototype.Hh=function(t,e){return Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",qu(e)),this.zh.Lr(t,e,Di.min())},ip),Pl=(rp.prototype.xo=function(t){return Ta.resolve(0===this.Sr.length)},rp.prototype.ko=function(t,e,n,r){var i=this.Jh;this.Jh++,0<this.Sr.length&&this.Sr[this.Sr.length-1],n=new dc(i,e,n,r),this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xh=this.Xh.add(new Tf(u.key,i)),this.Dr.Mo(t,u.key.path.h())}return Ta.resolve(n)},rp.prototype.Oo=function(t,e){return Ta.resolve(this.Zh(e))},rp.prototype.Bo=function(t,e){return e+=1,e=(e=this.tl(e))<0?0:e,Ta.resolve(this.Sr.length>e?this.Sr[e]:null)},rp.prototype.qo=function(){return Ta.resolve(0===this.Sr.length?-1:this.Jh-1)},rp.prototype.Uo=function(t){return Ta.resolve(this.Sr.slice())},rp.prototype.Nr=function(t,e){var n=this,r=new Tf(e,0),e=new Tf(e,Number.POSITIVE_INFINITY),i=[];return this.Xh.Ft([r,e],function(t){t=n.Zh(t.jc),i.push(t)}),Ta.resolve(i)},rp.prototype.Or=function(t,e){var n=this,r=new eo(pi);return e.forEach(function(t){var e=new Tf(t,0),t=new Tf(t,Number.POSITIVE_INFINITY);n.Xh.Ft([e,t],function(t){r=r.add(t.jc)})}),Ta.resolve(this.el(r))},rp.prototype.Wr=function(t,e){var n=e.path,r=n.length+1,e=n;qr.F(e)||(e=e.child(""));var e=new Tf(new qr(e),0),i=new eo(pi);return this.Xh.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.jc)),!0)},e),Ta.resolve(this.el(i))},rp.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Zh(t))&&n.push(t)}),n},rp.prototype.Wo=function(n,r){var i=this;Or(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xh;return Ta.forEach(r.mutations,function(t){var e=new Tf(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xh=o})},rp.prototype.Ko=function(t){},rp.prototype.Ho=function(t,e){var n=new Tf(e,0),n=this.Xh.xt(n);return Ta.resolve(e.isEqual(n&&n.key))},rp.prototype.zo=function(t){return this.Sr.length,Ta.resolve()},rp.prototype.nl=function(t,e){return this.tl(t)},rp.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},rp.prototype.Zh=function(t){return(t=this.tl(t))<0||t>=this.Sr.length?null:this.Sr[t]},rp),Cl=(np.prototype.Er=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:o,readTime:n}),this.size+=o-i,this.Dr.Mo(t,r.path.h())},np.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},np.prototype.Rr=function(t,e){return e=this.docs.get(e),Ta.resolve(e?e.ta:null)},np.prototype.getEntries=function(t,e){var n=this,r=ro;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),Ta.resolve(r)},np.prototype.Lr=function(t,e,n){for(var r=so,i=new qr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ta,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof bu&&Gu(e,u)&&(r=r.ot(u.key,u))}return Ta.resolve(r)},np.prototype.il=function(t,e){return Ta.forEach(this.docs,function(t){return e(t)})},np.prototype.ra=function(t){return new Ul(this)},np.prototype.aa=function(t){return Ta.resolve(this.size)},np),Ul=(n(ep,Ol=h),ep.prototype.yr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ca.Er(n,e,r.readTime)):r.ca.Ar(t)}),Ta.xn(i)},ep.prototype.gr=function(t,e){return this.ca.Rr(t,e)},ep.prototype.Pr=function(t,e){return this.ca.getEntries(t,e)},ep),Vl=(tp.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),Ta.resolve()},tp.prototype.Ea=function(t){return Ta.resolve(this.lastRemoteSnapshotVersion)},tp.prototype.Ia=function(t){return Ta.resolve(this.ol)},tp.prototype.wa=function(t){return this.highestTargetId=this.cl.next(),Ta.resolve(this.highestTargetId)},tp.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),Ta.resolve()},tp.prototype.ga=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cl=new Bh(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},tp.prototype.Ra=function(t,e){return this.ga(e),this.targetCount+=1,Ta.resolve()},tp.prototype.ya=function(t,e){return this.ga(e),Ta.resolve()},tp.prototype.Va=function(t,e){return this.rl.delete(e.target),this.al.Uc(e.targetId),--this.targetCount,Ta.resolve()},tp.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),Ta.xn(u).next(function(){return s})},tp.prototype.ba=function(t){return Ta.resolve(this.targetCount)},tp.prototype.va=function(t,e){return e=this.rl.get(e)||null,Ta.resolve(e)},tp.prototype.Sa=function(t,e,n){return this.al.Lc(e,n),Ta.resolve()},tp.prototype.Ca=function(e,t,n){this.al.qc(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),Ta.xn(i)},tp.prototype.pa=function(t,e){return this.al.Uc(e),Ta.resolve()},tp.prototype.Fa=function(t,e){return e=this.al.Wc(e),Ta.resolve(e)},tp.prototype.Ho=function(t,e){return Ta.resolve(this.al.Ho(e))},tp),Ml=(Zl.prototype.start=function(){return Promise.resolve()},Zl.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty(Zl.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),Zl.prototype.Za=function(){},Zl.prototype.tc=function(){},Zl.prototype.Ic=function(){return this.Dr},Zl.prototype.mc=function(t){var e=this.ul[t.ti()];return e||(e=new Pl(this.Dr,this.No),this.ul[t.ti()]=e),e},Zl.prototype.Tc=function(){return this.Ka},Zl.prototype.Ec=function(){return this.vr},Zl.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Fl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).Fn().then(function(t){return i.br(),t})},Zl.prototype.fl=function(e,n){return Ta.kn(Object.values(this.ul).map(function(t){return function(){return t.Ho(e,n)}}))},Zl),Fl=(n($l,kl=be),$l),jl=(Jl.ml=function(t){return new Jl(t)},Object.defineProperty(Jl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw kr()},enumerable:!1,configurable:!0}),Jl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),Ta.resolve()},Jl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),Ta.resolve()},Jl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),Ta.resolve()},Jl.prototype.removeTarget=function(t,e){var n=this;this.dl.Uc(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Tc();return r.Fa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.Va(t,e)})},Jl.prototype.ll=function(){this.wl=new Set},Jl.prototype._l=function(n){var r=this,i=this.persistence.Ec().ra();return Ta.forEach(this.Tl,function(t){var e=qr.D(t);return r.El(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},Jl.prototype.yc=function(t,e){var n=this;return this.El(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},Jl.prototype.hl=function(t){return 0},Jl.prototype.El=function(t,e){var n=this;return Ta.kn([function(){return Ta.resolve(n.dl.Ho(e))},function(){return n.persistence.Tc().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},Jl),ql=(Yl.prototype.gu=function(t){this.Rl=t},Yl.prototype.Tu=function(t){this.gl=t},Yl.prototype.onMessage=function(t){this.Pl=t},Yl.prototype.close=function(){this.Al()},Yl.prototype.send=function(t){this.Il(t)},Yl.prototype.yl=function(){this.Rl()},Yl.prototype.Vl=function(t){this.gl(t)},Yl.prototype.pl=function(t){this.Pl(t)},Yl),Gl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bl=(Xl.prototype.xu=function(e,t,n,r){var i=this.Dl(e,t);return Sr("RestConnection","Sending: ",i,n),t={},this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Xl.prototype.ku=function(t,e,n,r){return this.xu(t,e,n,r)},Xl.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0-20209141635",t["Content-Type"]="text/plain",e)for(var n in e.Kc)e.Kc.hasOwnProperty(n)&&(t[n]=e.Kc[n])},Xl.prototype.Dl=function(t,e){return t=Gl[t],this.vl+"/v1/"+e+":"+t},n(Ql,Ll=Xl),Ql.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new Ir(e,t.message))):r(new Ir(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Ql.prototype.Pu=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Sr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new ql({Il:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.Vl())}),t(vr.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),a.Vl(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Or(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Bi[r];if(void 0!==t)return Wi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Vl(new Ir(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.yl()},0),a},Ql),zl=(Wl.prototype.Zu=function(t){this.Ml.push(t)},Wl.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.xl)},Wl.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.xl)},Wl.prototype.$l=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},Wl.prototype.kl=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},Wl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Wl),Hl=(Kl.prototype.Zu=function(t){},Kl.prototype.Di=function(){},Kl);function Kl(){}function Wl(){var t=this;this.Fl=function(){return t.$l()},this.xl=function(){return t.kl()},this.Ml=[],this.Ol()}function Ql(t){var e=this;return(e=Ll.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.W=t.W,e}function Xl(t){this.bl=t,this.U=t.U;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function Yl(t){this.Il=t.Il,this.Al=t.Al}function Jl(t){this.persistence=t,this.dl=new If,this.wl=null}function $l(t){var e=this;return(e=kl.call(this)||this).$a=t,e}function Zl(t){var e=this;this.ul={},this.Ma=new nc(0),this.Oa=!1,this.Oa=!0,this.No=t(this),this.Ka=new Vl(this),this.Dr=new gh,this.vr=(t=this.Dr,new Cl(t,function(t){return e.No.hl(t)}))}function tp(t){this.persistence=t,this.rl=new Ni(Fi,ji),this.lastRemoteSnapshotVersion=Di.min(),this.highestTargetId=0,this.ol=0,this.al=new If,this.targetCount=0,this.cl=Bh.fa()}function ep(t){var e=this;return(e=Ol.call(this)||this).ca=t,e}function np(t,e){this.Dr=t,this.sl=e,this.docs=new Qi(qr.i),this.size=0}function rp(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Jh=1,this.Xh=new eo(Tf.kc)}function ip(){}function op(t){return new Jo(t,!0)}var sp,up,ap,cp,hp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",fp=(Np.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.ju=this.Ql(e),[2]}})})},Np.prototype.Ul=function(t){return null},Np.prototype.Ql=function(t){return e=this.persistence,n=new Rl,t=t.Wl,new cf(e,n,t);var e,n},Np.prototype.Bl=function(t){if(t.persistenceSettings.jl)throw new Ir(Er.FAILED_PRECONDITION,hp);return new Ml(jl.ml)},Np.prototype.Ll=function(t){return new pc},Np.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Np.prototype.clearPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,hp)},Np),lp=(n(Ap,cp=fp),Ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,cp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=dh(t),r=Di.min(),t.rs({index:kh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Xc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Sc=t})]})})}(this.ju)];case 2:return t.sent(),[4,this.Kl.initialize(this,e)];case 3:return t.sent(),[4,xl(this.Kl.fi)];case 4:return t.sent(),[4,nl(this.Kl.ph)];case 5:return t.sent(),[2]}})})},Ap.prototype.Ul=function(t){var e=this.persistence.No.wo;return new Mc(e,t.cs)},Ap.prototype.Bl=function(t){var e=af(t.bl.U,t.bl.persistenceKey),n=op(t.bl.U);return new Zh(t.persistenceSettings.synchronizeTabs,e,t.clientId,Cc.ao(t.persistenceSettings.cacheSizeBytes),t.cs,ja(),qa(),n,this.Sh,t.persistenceSettings.ka)},Ap.prototype.Ll=function(t){return new pc},Ap.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return _a.Ln()?(e=n+"main",[4,_a.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(af(t,e))},n(_p,ap=Ap),_p.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,ap.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Kl.fi,this.Sh instanceof lc?(this.Sh.fi={er:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).ju,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Cc.kr(e,t):Ta.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,nl(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(bl(o,a,h||null),wl(o,a),o.ju.Sr.Ko(a)):kr(),t.label=4;case 4:return[4,Al(o,s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),nr:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qh?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Fh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.ju,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Dc,n=t,t=s.Sc,r=e,i=ro,o=Qc(t),t=dh(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:kh.readTimeIndex,range:n},function(t,e){var n=Kc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{$c:i,readTime:Xc(o)}});var e,n,r,i,o}).then(function(t){var e=t.$c,t=t.readTime;return s.Sc=t,e}))];case 3:return r=t.sent(),i=yo.Xt(u,"current"===a),[4,Al(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,pf(n.ju,u,!0)];case 6:return t.sent(),El(n,u,c),[3,8];case 7:kr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Dl(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Fh.has(r)?(Sr("SyncEngine","Adding an already active target "+r),[3,5]):[4,yf(n.ju,r)]):[3,6];case 2:return i=t.sent(),[4,lf(n.ju,i)];case 3:return o=t.sent(),[4,vl(n,Sl(i),o.targetId,!1)];case 4:t.sent(),Kf(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Fh.has(e)?[4,pf(n.ju,e,!1).then(function(){Wf(n.ph,e),El(n,e)}).catch(vf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.ju.persistence.pi()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Dl(r=h),xl(r),!0!==f||!0===r.qh?[3,3]:(e=r.Sh.Ci(),[4,Nl(r,e.A())]);case 1:return i=t.sent(),r.qh=!0,[4,ol(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Kf(r.ph,u);return[3,7];case 3:return!1!==f||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.Fh.forEach(function(t,e){r.Sh.qi(e)?a.push(e):c=c.then(function(){return El(r,e),pf(r.ju,e,!0)}),Wf(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,Nl(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){Wf(n.ph,e)}),n.Mh.Qc(),n.kh=new Map,n.xh=new Qi(qr.i),r.qh=!1,[4,ol(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Kl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ei?this.ql.start(this.ju):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},_p.prototype.Ll=function(t){if(t.persistenceSettings.jl&&t.persistenceSettings.synchronizeTabs){var e=ja();if(!lc.Ln(e))throw new Ir(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=af(t.bl.U,t.bl.persistenceKey);return new lc(e,t.cs,n,t.clientId,t.Wl)}return new pc},_p),pp=(Tp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.ju?[3,2]:(this.ju=n.ju,this.Sh=n.Sh,this.Ku=this.Gl(r),this.ph=this.zl(r),this.bh=this.Hl(r),this.fi=this.Yl(r),this.Sh.di=function(t){return ml(e.fi,t,1)},this.ph.Gu.Jl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Cc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new gc(e.Dc,n,e.persistence.Ic()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=co(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.kr(v,r).next(function(t){return{jh:t,Kh:e,Gh:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Cc=m,e.Vc.Nc(e.Cc),r)]}})})}(n.ju,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.ji(o,r.Kh,r.Gh),[4,Al(n,r.jh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fi),[4,ol(this.ph,this.fi.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tp.prototype.Hl=function(t){return new Qa},Tp.prototype.Gl=function(t){var e=op(t.bl.U),n=(n=t.bl,new Bl(n));return t=t.credentials,new Lf(t,n,e)},Tp.prototype.zl=function(t){var e=this;return new mf(this.ju,this.Ku,t.cs,function(t){return ml(e.fi,t,0)},t=new(zl.Ln()?zl:Hl))},Tp.prototype.Yl=function(t){return e=this.ju,n=this.ph,r=this.bh,i=this.Sh,o=t.Wl,s=t.Dh,u=!t.persistenceSettings.jl||!t.persistenceSettings.synchronizeTabs,s=new pl(e,n,r,i,o,s),u&&(s.qh=!0),s;var e,n,r,i,o,s,u},Tp.prototype.terminate=function(){return Hf(this.ph)},Tp),dp=(Ip.prototype.next=function(t){this.observer.next&&this.Xl(this.observer.next,t)},Ip.prototype.error=function(t){this.observer.error?this.Xl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ip.prototype.Zl=function(){this.muted=!0},Ip.prototype.Xl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ip),yp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ir(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Yr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new jr(t)},vp=(n(Ep,up=yp),Ep.documentId=function(){return new Ep(jr.v().R())},Ep.prototype.isEqual=function(t){if(!(t instanceof Ep))throw ui("isEqual","FieldPath",1,t);return this.t_.isEqual(t.t_)},Ep),gp=new RegExp("[~\\*/\\[\\]]"),mp=function(t){this.e_=t},wp=(n(bp,sp=mp),bp.prototype.n_=function(t){if(2!==t.s_)throw 1===t.s_?t.i_(this.e_+"() can only appear at the top level of your update data"):t.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},bp.prototype.isEqual=function(t){return t instanceof bp},bp);function bp(){return null!==sp&&sp.apply(this,arguments)||this}function Ep(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return up.call(this,t)||this}function Ip(t){this.observer=t,this.muted=!1}function Tp(){}function _p(){return null!==ap&&ap.apply(this,arguments)||this}function Ap(t){var e=this;return(e=cp.call(this)||this).Kl=t,e}function Np(){}function Sp(t,e,n){return new Yp({s_:3,r_:e.settings.r_,methodName:t.e_,o_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Dp,xp,Lp,kp,Op=(n(Qp,kp=mp),Qp.prototype.n_=function(t){return new qs(t.path,new Ns)},Qp.prototype.isEqual=function(t){return t instanceof Qp},Qp),Rp=(n(Wp,Lp=mp),Wp.prototype.n_=function(t){var e=Sp(this,t,!0),n=this.a_.map(function(t){return id(t,e)}),n=new Ss(n);return new qs(t.path,n)},Wp.prototype.isEqual=function(t){return this===t},Wp),Pp=(n(Kp,xp=mp),Kp.prototype.n_=function(t){var e=Sp(this,t,!0),n=this.a_.map(function(t){return id(t,e)}),n=new Os(n);return new qs(t.path,n)},Kp.prototype.isEqual=function(t){return this===t},Kp),Cp=(n(Hp,Dp=mp),Hp.prototype.n_=function(t){var e=new Us(t.serializer,ts(t.serializer,this.c_));return new qs(t.path,e)},Hp.prototype.isEqual=function(t){return this===t},Hp),Up=(Object.defineProperty(zp.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(zp.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),zp.prototype.isEqual=function(t){return this.u_===t.u_&&this.h_===t.h_},zp.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},zp.prototype.Y=function(t){return pi(this.u_,t.u_)||pi(this.h_,t.h_)},zp),Vp=function(t){this.l_=t},Mp=/^__.*__$/,Fp=function(t,e,n){this.__=t,this.f_=e,this.d_=n},jp=(Bp.prototype.w_=function(t,e){var n=[];return null!==this.We?n.push(new Zs(t,this.data,this.We,e)):n.push(new $s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new iu(t,this.fieldTransforms)),n},Bp),qp=(Gp.prototype.w_=function(t,e){return e=[new Zs(t,this.data,this.We,e)],0<this.fieldTransforms.length&&e.push(new iu(t,this.fieldTransforms)),e},Gp);function Gp(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function Bp(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function zp(t,e){if(Wr("GeoPoint",arguments,2),Yr("GeoPoint","number",1,t),Yr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.u_=t,this.h_=e}function Hp(t,e){var n=this;return(n=Dp.call(this,t)||this).c_=e,n}function Kp(t,e){var n=this;return(n=xp.call(this,t)||this).a_=e,n}function Wp(t,e){var n=this;return(n=Lp.call(this,t)||this).a_=e,n}function Qp(){return null!==kp&&kp.apply(this,arguments)||this}function Xp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Yp=(Object.defineProperty(Zp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),Zp.prototype.T_=function(t){return new Zp(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},Zp.prototype.E_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.T_({path:e,o_:!1})).I_(t),e},Zp.prototype.A_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.T_({path:t,o_:!1})).m_(),t},Zp.prototype.R_=function(t){return this.T_({path:void 0,o_:!0})},Zp.prototype.i_=function(t){return hd(t,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},Zp.prototype.contains=function(e){return void 0!==this.We.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Zp.prototype.m_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},Zp.prototype.I_=function(t){if(0===t.length)throw this.i_("Document fields must not be empty");if(Xp(this.s_)&&Mp.test(t))throw this.i_('Document fields cannot begin and end with "__"')},Zp),Jp=($p.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Yp({s_:t,methodName:e,r_:n,path:jr.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},$p);function $p(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||op(t)}function Zp(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}function td(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);ud("Data must be an object, but it was:",s,r);var u,a,r=od(r,s);if(o.merge)u=new js(s.We),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof yp)p=l.t_;else{if("string"!=typeof l)throw kr();p=cd(e,l,n)}if(!s.contains(p))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");fd(c,p)||c.push(p)}u=new js(c),a=s.fieldTransforms.filter(function(t){return u.Ye(t.field)})}else u=null,a=s.fieldTransforms;return new jp(new fu(r),u,a)}function ed(t,r,i,e){var o=t.P_(1,r,i);ud("Data must be an object, but it was:",o,e);var s=[],u=new lu;return Pr(e,function(t,e){var n=cd(r,t,i),t=o.A_(n);e instanceof wp||e instanceof Vp&&e.l_ instanceof wp?s.push(n):null!=(t=id(e,t))&&(s.push(n),u.set(n,t))}),e=new js(s),new qp(u.Xe(),e,o.fieldTransforms)}function nd(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[ad(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(ad(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new lu,y=u.length-1;0<=y;--y)fd(p,u[y])||(h=u[y],f=a[y],l=s.A_(h),f instanceof wp||f instanceof Vp&&f.l_ instanceof wp?p.push(h):null!=(l=id(f,l))&&(p.push(h),d.set(h,l)));return i=new js(p),new qp(d.Xe(),i,s.fieldTransforms)}function rd(t,e,n,r){return void 0===r&&(r=!1),id(n,t.P_(r?4:3,e))}function id(s,t){if(s instanceof Vp&&(s=s.l_),sd(s))return ud("Unsupported field value:",t,s),od(s,t);if(s instanceof mp)return function(t,e){if(!Xp(e.s_))throw e.i_(t.e_+"() can only be used with update() and set()");if(!e.path)throw e.i_(t.e_+"() is not currently supported inside arrays");(t=t.n_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.We.push(t.path),s instanceof Array){if(t.settings.o_&&4!==t.s_)throw t.i_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=id(i[r],t.R_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ts(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Si.fromDate(t);return{timestampValue:es(e.serializer,n)}}if(t instanceof Si){var r=new Si(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:es(e.serializer,r)}}if(t instanceof Up)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof mi)return{bytesValue:ns(e.serializer,t.q)};if(t instanceof Fp){if(n=e.U,!(r=t.__).isEqual(n))throw e.i_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:is(t.__||e.U,t.f_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.i_("Unsupported field value: "+ii(t))}(s,t)}function od(t,n){var r={};return Cr(t)?n.path&&0<n.path.length&&n.We.push(n.path):Pr(t,function(t,e){null!=(e=id(e,n.E_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function sd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Si||t instanceof Up||t instanceof mi||t instanceof Fp||t instanceof mp)}function ud(t,e,n){if(!sd(n)||!ri(n))throw"an object"===(n=ii(n))?e.i_(t+" a custom object"):e.i_(t+" "+n)}function ad(t,e,n){if(e instanceof yp)return e.t_;if("string"==typeof e)return cd(t,e);throw hd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function cd(t,e,n){try{return function(e){if(0<=e.search(gp))throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(vp.bind.apply(vp,i([void 0],e.split("."))))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).t_}catch(e){throw hd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function hd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ir(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function fd(t,e){return t.some(function(t){return t.isEqual(e)})}var ld=(gd.prototype.v_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),0<this.mutations.length)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=hs((i=s).serializer)+"/documents",n={documents:u.map(function(t){return ss(i.serializer,t)})},[4,i.ku("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=us(t,e.found.name),t=rs(e.found.updateTime),e=new fu({mapValue:{fields:e.found.fields}});return new bu(n,t,e,{})}(e,t):"missing"in t?(n=e,Or(!!(r=t).missing),Or(!!r.readTime),n=us(n,r.missing),r=rs(r.readTime),new Eu(n,r)):kr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){Or(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Ku,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Eu||t instanceof bu?n.D_(t):kr()}),e)]}})})},gd.prototype.set=function(t,e){this.write(e.w_(t,this.Ge(t))),this.b_.add(t.toString())},gd.prototype.update=function(t,e){try{this.write(e.w_(t,this.C_(t)))}catch(t){this.p_=t}this.b_.add(t.toString())},gd.prototype.delete=function(t){this.write([new cu(t,this.Ge(t))]),this.b_.add(t.toString())},gd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),this.p_)throw this.p_;return e=this.y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=qr.D(e),n.mutations.push(new hu(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=hs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ps(e.serializer,t)})},[4,e.xu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Ku,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},gd.prototype.D_=function(t){var e;if(t instanceof bu)e=t.version;else{if(!(t instanceof Eu))throw kr();e=Di.min()}var n=this.y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.y_.set(t.key.toString(),e)},gd.prototype.Ge=function(t){var e=this.y_.get(t.toString());return!this.b_.has(t.toString())&&e?zs.updateTime(e):zs.ze()},gd.prototype.C_=function(t){var e=this.y_.get(t.toString());if(this.b_.has(t.toString())||!e)return zs.exists(!0);if(e.isEqual(Di.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zs.updateTime(e)},gd.prototype.write=function(t){this.S_(),this.mutations=this.mutations.concat(t)},gd.prototype.S_=function(){},gd),pd=(vd.prototype.run=function(){this.F_()},vd.prototype.F_=function(){var t=this;this.ys.gn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new ld(this.Ku),(n=this.x_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.k_(t)})})}).catch(function(t){r.k_(t)}),[2]})})})},vd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!Pi(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},vd.prototype.k_=function(t){var e=this;0<this.N_&&this.M_(t)?(--this.N_,this.cs.ws(function(){return e.F_(),Promise.resolve()})):this.ls.reject(t)},vd.prototype.M_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ki(t))},vd),dd=(yd.prototype.start=function(t,e,n,r){var i=this;this.L_(),this.bl=t;var o=new ba,s=!1;return this.credentials.Hc(function(t){return s?void i.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.$s(),Sr("RemoteStore","RemoteStore received new credentials"),n=$f(e),e.Yu.add(3),[4,zf(e)];case 1:return t.sent(),n&&e.th.set("Unknown"),[4,e.Gu.Jl(i)];case 2:return t.sent(),e.Yu.delete(3),[4,Bf(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)}):(s=!0,Sr("FirestoreClient","Initializing. user=",t.uid),i.B_(e,n,r,t,o).then(i.O_.resolve,i.O_.reject))}),this.cs.ws(function(){return i.O_.promise}),o.promise},yd.prototype.enableNetwork=function(){var e=this;return this.L_(),this.cs.enqueue(function(){return e.persistence.tc(!0),(t=e.ph).Yu.delete(0),Bf(t);var t})},yd.prototype.B_=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:s,Dh:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Sh=r.Sh,this.ju=r.ju,this.ql=r.ql,this.Ku=i.Ku,this.ph=i.ph,this.fi=i.fi,this.q_=i.bh,this.q_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Dl(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Oi(n),r=o.view.yh(),[3,4]):[3,1];case 1:return[4,lf(e.ju,Cu(u))];case 2:return i=t.sent(),o=e.Sh.Oi(i.targetId),n=i.targetId,[4,vl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&Kf(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.q_.js=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.Fh.get(n.targetId)).length?[2,(e.Fh.set(n.targetId,r.filter(function(t){return!Fu(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Bi(n.targetId),e.Sh.Fi(n.targetId)?[3,2]:[4,pf(e.ju,n.targetId,!1).then(function(){e.Sh.Ui(n.targetId),Wf(e.ph,n.targetId),El(e,n.targetId)}).catch(vf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return El(e,n.targetId),[4,pf(e.ju,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.U_(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.B_(new fp,new pp,{jl:!1},s,u))];case 4:return[2]}})})},yd.prototype.U_=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},yd.prototype.L_=function(){if(this.cs.ps)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},yd.prototype.disableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue(function(){return t.persistence.tc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(0),[4,zf(e)];case 1:return t.sent(),e.th.set("Offline"),[2]}})})}(t.ph)})},yd.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new ba;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Hf(this.ph)];case 1:return t.sent(),[4,this.Sh.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yc(),n.resolve(),[3,5];case 4:return e=Ka(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},yd.prototype.waitForPendingWrites=function(){var t=this;this.L_();var e=new ba;return this.cs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:$f((n=o).ph)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.ju).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=Ka(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},yd.prototype.listen=function(t,e,n){var r=this;this.L_();var i=new dp(n),o=new $a(t,i,e);return this.cs.ws(function(){return Xa(r.q_,o)}),function(){i.Zl(),r.cs.ws(function(){return Ya(r.q_,o)})}},yd.prototype.Q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new ba,[2,(this.cs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Cc.Cr(t,e)}))];case 1:return(r=t.sent())instanceof bu?s.resolve(r):r instanceof Eu?s.resolve(null):s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ka(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.ju,r,e)}),e.promise)]}})})},yd.prototype.W_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new ba,[2,(this.cs.ws(function(){return n=a.q_,r=a.cs,i=c,o=h,s=e,t=new dp({next:function(t){r.ws(function(){return Ya(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new $a(Du(i.path),t,{includeMetadataChanges:!0,Xs:!0}),Xa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},yd.prototype.j_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new ba,[2,(this.cs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,df(r,i,!0)];case 1:return n=t.sent(),e=new hl(i,n.Fc),n=e.wh(n.documents),n=e.yr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ka(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.ju,r,e)}),e.promise)]}})})},yd.prototype.K_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),u=new ba,[2,(this.cs.ws(function(){return e=a.q_,n=a.cs,t=c,r=h,i=u,o=new dp({next:function(t){n.ws(function(){return Ya(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new $a(t,o,{includeMetadataChanges:!0,Xs:!0}),Xa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},yd.prototype.write=function(t){var e=this;this.L_();var n=new ba;return this.cs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=xl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.ju,a=p,h=i,f=Si.now(),o=a.reduce(function(t,e){return t.add(e.key)},co()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Cc.kr(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof iu?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof bu?t.field(i.field):void 0;null!=(o=Ts(i.transform,o||null))&&(e=(null==e?new lu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Zs(i.key,o,function s(t){var u=[];return Pr(t.fields||{},function(t,e){var n=new jr([t]);if(Qo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new js(u)}(o.proto.mapValue),zs.exists(!0)))}return h.Sr.ko(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Sh.$i(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Oh[e.currentUser.ti()])||new Qi(pi)).ot(n,r),e.Oh[e.currentUser.ti()]=i,[4,Al(u,s.wr)];case 3:return t.sent(),[4,nl(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=Ka(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},yd.prototype.U=function(){return this.bl.U},yd.prototype.G_=function(t){var e=this;this.L_();var r=new dp(t);return this.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.q_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Zl(),e.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.q_.qs.delete(r)]})})})}},Object.defineProperty(yd.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),yd.prototype.transaction=function(t){var e=this;this.L_();var n=new ba;return this.cs.ws(function(){return new pd(e.cs,e.Ku,t,n).run(),Promise.resolve()}),n.promise},yd);function yd(t,e){this.credentials=t,this.cs=e,this.clientId=fi.k(),this.O_=new ba}function vd(t,e,n,r){this.cs=t,this.Ku=e,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new Ia(this.cs,"transaction_retry")}function gd(t){this.Ku=t,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}function md(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var wd,bd,Ed=(Fd.prototype.X_=function(t){switch(Po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qo(t.integerValue||t.doubleValue);case 3:return this.Z_(t.timestampValue);case 4:return this.tf(t);case 5:return t.stringValue;case 6:return this.J_(Go(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue);case 10:return this.if(t.mapValue);default:throw kr()}},Fd.prototype.if=function(t){var n=this,r={};return Pr(t.fields||{},function(t,e){r[t]=n.X_(e)}),r},Fd.prototype.nf=function(t){return new Up(qo(t.latitude),qo(t.longitude))},Fd.prototype.sf=function(t){var e=this;return(t.values||[]).map(function(t){return e.X_(t)})},Fd.prototype.tf=function(t){switch(this.H_){case"previous":var e=function t(e){return ko(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.X_(e);case"estimate":return this.Z_(Oo(t));default:return null}},Fd.prototype.Z_=function(t){return t=jo(t),t=new Si(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},Fd.prototype.ef=function(t){var e=Mr.g(t);return Or(Is(e)),t=new Ai(e.get(1),e.get(3)),e=new qr(e.u(5)),t.isEqual(this.U)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(e)},Fd),Id=Cc.ho,Td=(Md.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Md),_d=(Object.defineProperty(Vd.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new Jp(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),Vd.prototype.settings=function(t){if(Wr("Firestore.settings",arguments,1),Yr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.wf),t)).merge,t=new Td(t),this.lf&&!this.wf.isEqual(t))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.wf=t).credentials&&(this.df=function(t){if(!t)return new _f;switch(t.type){case"gapi":var e=t.client;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Sf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Vd.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},Vd.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},Vd.prototype.enablePersistence=function(t){var e;if(this.lf)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Dr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ir(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:n,ka:r})},Vd.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.lf&&!this.lf.z_)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ba,[2,(this.uf.bs(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Vd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Vd.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),Vd.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},Vd.prototype.onSnapshotsInSync=function(t){return this.hf(),md(t)||(Yr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.lf.G_(t)},Vd.prototype.hf=function(){return this.lf||this.Ef(new fp,new pp,{jl:!1}),this.lf},Vd.prototype.Af=function(){return new Ii(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},Vd.prototype.Ef=function(t,e,n){var r=this.Af();return this.lf=new dd(this.df,this.uf),this.lf.start(r,t,e,n)},Vd._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ai(t)},Object.defineProperty(Vd.prototype,"app",{get:function(){if(!this.cf)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Vd.prototype.collection=function(t){return Wr("Firestore.collection",arguments,1),Yr("Firestore.collection","non-empty string",1,t),this.hf(),new Wd(Mr.g(t),this,null)},Vd.prototype.doc=function(t){return Wr("Firestore.doc",arguments,1),Yr("Firestore.doc","non-empty string",1,t),this.hf(),Sd.Rf(Mr.g(t),this,null)},Vd.prototype.collectionGroup=function(t){if(Wr("Firestore.collectionGroup",arguments,1),Yr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new Hd((t=t,new Tu(Mr.P(),t)),this,null)},Vd.prototype.runTransaction=function(e){var n=this;return Wr("Firestore.runTransaction",arguments,1),Yr("Firestore.runTransaction","function",1,e),this.hf().transaction(function(t){return e(new Ad(n,t))})},Vd.prototype.batch=function(){return this.hf(),new Nd(this)},Object.defineProperty(Vd,"logLevel",{get:function(){switch(Nr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Vd.setLogLevel=function(t){Wr("Firestore.setLogLevel",arguments,1),ei("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_r.setLogLevel(t)},Vd.prototype.gf=function(){return this.wf.timestampsInSnapshots},Vd.prototype.Pf=function(){return this.wf},Vd),Ad=(Ud.prototype.get=function(t){var e=this;Wr("Transaction.get",arguments,1);var n=ty("Transaction.get",t,this.yf);return this.Vf.v_([n.f_]).then(function(t){if(!t||1!==t.length)return kr();if((t=t[0])instanceof Eu)return new xd(e.yf,n.f_,null,!1,!1,n.d_);if(t instanceof bu)return new xd(e.yf,n.f_,t,!1,!1,n.d_);throw kr()})},Ud.prototype.set=function(t,e,n){return Xr("Transaction.set",arguments,2,3),t=ty("Transaction.set",t,this.yf),n=Jd("Transaction.set",n),e=ey(t.d_,e,n),n=td(this.yf.mf,"Transaction.set",t.f_,e,null!==t.d_,n),this.Vf.set(t.f_,n),this},Ud.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof vp?(Qr("Transaction.update",arguments,3),r=ty("Transaction.update",t,this.yf),nd(this.yf.mf,"Transaction.update",r.f_,e,n,i)):(Wr("Transaction.update",arguments,2),r=ty("Transaction.update",t,this.yf),ed(this.yf.mf,"Transaction.update",r.f_,e)),this.Vf.update(r.f_,e),this},Ud.prototype.delete=function(t){return Wr("Transaction.delete",arguments,1),t=ty("Transaction.delete",t,this.yf),this.Vf.delete(t.f_),this},Ud),Nd=(Cd.prototype.set=function(t,e,n){return Xr("WriteBatch.set",arguments,2,3),this.vf(),t=ty("WriteBatch.set",t,this.yf),n=Jd("WriteBatch.set",n),e=ey(t.d_,e,n),n=td(this.yf.mf,"WriteBatch.set",t.f_,e,null!==t.d_,n),this.pf=this.pf.concat(n.w_(t.f_,zs.ze())),this},Cd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.vf(),e="string"==typeof e||e instanceof vp?(Qr("WriteBatch.update",arguments,3),r=ty("WriteBatch.update",t,this.yf),nd(this.yf.mf,"WriteBatch.update",r.f_,e,n,i)):(Wr("WriteBatch.update",arguments,2),r=ty("WriteBatch.update",t,this.yf),ed(this.yf.mf,"WriteBatch.update",r.f_,e)),this.pf=this.pf.concat(e.w_(r.f_,zs.exists(!0))),this},Cd.prototype.delete=function(t){return Wr("WriteBatch.delete",arguments,1),this.vf(),t=ty("WriteBatch.delete",t,this.yf),this.pf=this.pf.concat(new cu(t.f_,zs.ze())),this},Cd.prototype.commit=function(){return this.vf(),this.bf=!0,0<this.pf.length?this.yf.hf().write(this.pf):Promise.resolve()},Cd.prototype.vf=function(){if(this.bf)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Cd),Sd=(n(Pd,bd=Fp),Pd.Rf=function(t,e,n){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Pd(new qr(t),e,n)},Object.defineProperty(Pd.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"parent",{get:function(){return new Wd(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),Pd.prototype.collection=function(t){if(Wr("DocumentReference.collection",arguments,1),Yr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Mr.g(t),new Wd(this.f_.path.child(t),this.firestore,null)},Pd.prototype.isEqual=function(t){if(!(t instanceof Pd))throw ui("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.f_.isEqual(t.f_)&&this.d_===t.d_},Pd.prototype.set=function(t,e){return Xr("DocumentReference.set",arguments,1,2),e=Jd("DocumentReference.set",e),t=ey(this.d_,t,e),e=td(this.firestore.mf,"DocumentReference.set",this.f_,t,null!==this.d_,e),this.lf.write(e.w_(this.f_,zs.ze()))},Pd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof vp?(Qr("DocumentReference.update",arguments,2),nd(this.firestore.mf,"DocumentReference.update",this.f_,t,e,n)):(Wr("DocumentReference.update",arguments,1),ed(this.firestore.mf,"DocumentReference.update",this.f_,t)),this.lf.write(t.w_(this.f_,zs.exists(!0)))},Pd.prototype.delete=function(){return Wr("DocumentReference.delete",arguments,0),this.lf.write([new cu(this.f_,zs.ze())])},Pd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Xr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||md(n[i])||(si("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),Zr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};md(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Yr("DocumentReference.onSnapshot","function",i,n[i]),Jr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Jr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Sf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(Du(this.f_.path),o,s)},Pd.prototype.get=function(t){var e=this;Xr("DocumentReference.get",arguments,0,1),Zd("DocumentReference.get",t);var n=this.firestore.hf();return t&&"cache"===t.source?n.Q_(this.f_).then(function(t){return new xd(e.firestore,e.f_,t,!0,t instanceof bu&&t.Je,e.d_)}):n.W_(this.f_,t).then(function(t){return e.Sf(t)})},Pd.prototype.withConverter=function(t){return new Pd(this.f_,this.firestore,t)},Pd.prototype.Sf=function(t){var e=t.docs.get(this.f_);return new xd(this.firestore,this.f_,e,t.fromCache,t.hasPendingWrites,this.d_)},Pd),Dd=(Rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Rd),xd=(Od.prototype.data=function(t){var e=this;if(Xr("DocumentSnapshot.data",arguments,0,1),t=$d("DocumentSnapshot.data",t),this.Df){if(this.d_){var n=new Ld(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,t)}return new Ed(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",function(t){return new Sd(t,e.yf,null)},function(t){return new _i(t)}).X_(this.Df.rn())}},Od.prototype.get=function(t,e){var n=this;if(Xr("DocumentSnapshot.get",arguments,1,2),e=$d("DocumentSnapshot.get",e),this.Df&&null!==(t=this.Df.data().field(ad("DocumentSnapshot.get",t,this.f_))))return new Ed(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",function(t){return new Sd(t,n.yf,n.d_)},function(t){return new _i(t)}).X_(t)},Object.defineProperty(Od.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"ref",{get:function(){return new Sd(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"metadata",{get:function(){return new Dd(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),Od.prototype.isEqual=function(t){if(!(t instanceof Od))throw ui("isEqual","DocumentSnapshot",1,t);return this.yf===t.yf&&this.Cf===t.Cf&&this.f_.isEqual(t.f_)&&(null===this.Df?null===t.Df:this.Df.isEqual(t.Df))&&this.d_===t.d_},Od),Ld=(n(kd,wd=xd),kd.prototype.data=function(t){return wd.prototype.data.call(this,t)},kd);function kd(){return null!==wd&&wd.apply(this,arguments)||this}function Od(t,e,n,r,i,o){this.yf=t,this.f_=e,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}function Rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Pd(t,e,n){var r=this;return(r=bd.call(this,e.__,t,n)||this).f_=t,r.firestore=e,r.d_=n,r.lf=r.firestore.hf(),r}function Cd(t){this.yf=t,this.pf=[],this.bf=!1}function Ud(t,e){this.yf=t,this.Vf=e}function Vd(t,e,n,r){var i=this;if(void 0===n&&(n=new fp),void 0===r&&(r=new pp),this.rf=n,this.af=r,this.cf=null,this.uf=new Ba,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.cf=r,this.__=Vd._f(r),this.ff=r.name,this.df=new Af(e);else{if(!(t=t).projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.__=new Ai(t.projectId,t.database),this.ff="[DEFAULT]",this.df=new _f}this.wf=new Td({})}function Md(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $r("settings","non-empty string","host",t.host),this.host=t.host,Zr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(si("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),Zr("settings","object","credentials",t.credentials),this.credentials=t.credentials,Zr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Zr("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Dr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Dr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,Zr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Cc._o;else{if(t.cacheSizeBytes!==Id&&t.cacheSizeBytes<Cc.lo)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Cc.lo);this.cacheSizeBytes=t.cacheSizeBytes}Zr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,Zr("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Ir(Er.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function Fd(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.H_=n,this.Y_=r,this.J_=i}function jd(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ru(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Mr.g(n)),!qr.F(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Bo(t,new qr(e))}if(n instanceof Fp)return Bo(t,n.f_);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ii(n)+".")}function qd(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Gd(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Bd(t){if(Lu(t)&&0===t.on.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zd,Hd=(Yd.prototype.where=function(t,e,n){return Wr("Query.where",arguments,3),oi("Query.where",3,n),e=ei("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=ad("Query.where",t),e=function(t,e,n,r,i,o){if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){qd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(jd(n,t,c))}h={arrayValue:{values:s}}}else h=jd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||qd(o,i),h=rd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Hu.create(r,i,h);return function(t,e){if(e.hn()){var n=Ou(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ku(t))&&Gd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Ff,this.firestore.mf,this.firestore.__,t,e,n),new Yd((e=(n=this.Ff).filters.concat([e]),new Tu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},Yd.prototype.orderBy=function(t,e){if(Xr("Query.orderBy",arguments,1,2),Jr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=ad("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new wa(e,n);return e=r,null!==ku(n=t)||null!==(t=Ou(n))&&Gd(0,t,e.field),r}(this.Ff,t,n);return new Yd((t=(n=this.Ff).on.concat([t]),new Tu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},Yd.prototype.limit=function(t){return Wr("Query.limit",arguments,1),Yr("Query.limit","number",1,t),ai("Query.limit",1,t),new Yd(Uu(this.Ff,t,"F"),this.firestore,this.d_)},Yd.prototype.limitToLast=function(t){return Wr("Query.limitToLast",arguments,1),Yr("Query.limitToLast","number",1,t),ai("Query.limitToLast",1,t),new Yd(Uu(this.Ff,t,"L"),this.firestore,this.d_)},Yd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qr("Query.startAt",arguments,1),t=this.$f("Query.startAt",t,e,!0),new Yd(Vu(this.Ff,t),this.firestore,this.d_)},Yd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qr("Query.startAfter",arguments,1),t=this.$f("Query.startAfter",t,e,!1),new Yd(Vu(this.Ff,t),this.firestore,this.d_)},Yd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qr("Query.endBefore",arguments,1),t=this.$f("Query.endBefore",t,e,!0),new Yd(Mu(this.Ff,t),this.firestore,this.d_)},Yd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qr("Query.endAt",arguments,1),t=this.$f("Query.endAt",t,e,!1),new Yd(Mu(this.Ff,t),this.firestore,this.d_)},Yd.prototype.isEqual=function(t){if(!(t instanceof Yd))throw ui("isEqual","Query",1,t);return this.firestore===t.firestore&&Fu(this.Ff,t.Ff)&&this.d_===t.d_},Yd.prototype.withConverter=function(t){return new Yd(this.Ff,this.firestore,t)},Yd.prototype.$f=function(c,t,e,n){return oi(c,1,t),t instanceof xd?(Wr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Pu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Bo(e,n.key));else{var a=n.field(u.field);if(ko(a))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new fa(i,r)}(this.Ff,this.firestore.__,t.Df,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ru(t)&&-1!==c.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Mr.g(c));if(!qr.F(h))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new qr(h),u.push(Bo(e,h))}else c=rd(n,r,c),u.push(c)}return new fa(u,o)}(this.Ff,this.firestore.__,this.firestore.mf,c,e,n))},Yd.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Xr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||md(n[o])||(si("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),Zr("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),md(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Yr("Query.onSnapshot","function",o,n[o]),Jr("Query.onSnapshot","function",o+1,n[o+1]),Jr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Kd(e.firestore,e.Ff,t,e.d_))},error:n[o+1],complete:n[o+2]};return Bd(this.Ff),this.firestore.hf().listen(this.Ff,i,s)},Yd.prototype.get=function(t){var e=this;Xr("Query.get",arguments,0,1),Zd("Query.get",t),Bd(this.Ff);var n=this.firestore.hf();return(t&&"cache"===t.source?n.j_(this.Ff):n.K_(this.Ff,t)).then(function(t){return new Kd(e.firestore,e.Ff,t,e.d_)})},Yd),Kd=(Object.defineProperty(Xd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Xd.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Xd.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),Xd.prototype.forEach=function(e,n){var r=this;Xr("QuerySnapshot.forEach",arguments,1,2),Yr("QuerySnapshot.forEach","function",1,e),this.kf.docs.forEach(function(t){e.call(n,r.Lf(t,r.metadata.fromCache,r.kf.Wt.has(t.key)))})},Object.defineProperty(Xd.prototype,"query",{get:function(){return new Hd(this.xf,this.yf,this.d_)},enumerable:!1,configurable:!0}),Xd.prototype.docChanges=function(t){if(t&&(si("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Zr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.kf.Kt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===t||(this.Mf=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.kf,t,this.Lf.bind(this)),this.Of=t),this.Mf},Xd.prototype.isEqual=function(t){if(!(t instanceof Xd))throw ui("isEqual","QuerySnapshot",1,t);return this.yf===t.yf&&Fu(this.xf,t.xf)&&this.kf.isEqual(t.kf)&&this.d_===t.d_},Xd.prototype.Lf=function(t,e,n){return new Ld(this.yf,t.key,t,e,n,this.d_)},Xd),Wd=(n(Qd,zd=Hd),Object.defineProperty(Qd.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"parent",{get:function(){var t=this.Ff.path.h();return t.m()?null:new Sd(new qr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),Qd.prototype.doc=function(t){return Xr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=fi.k()),Yr("CollectionReference.doc","non-empty string",1,t),t=Mr.g(t),Sd.Rf(this.Ff.path.child(t),this.firestore,this.d_)},Qd.prototype.add=function(t){Wr("CollectionReference.add",arguments,1),Yr("CollectionReference.add","object",1,t=this.d_?this.d_.toFirestore(t):t);var e=this.doc();return new Sd(e.f_,this.firestore,null).set(t).then(function(){return e})},Qd.prototype.withConverter=function(t){return new Qd(this.Bf,this.firestore,t)},Qd);function Qd(t,e,n){var r=this;if(((r=zd.call(this,Du(t),e,n)||this).Bf=t).length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Xd(t,e,n,r){this.yf=t,this.xf=e,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new Dd(n.hasPendingWrites,n.fromCache)}function Yd(t,e,n){this.Ff=t,this.firestore=e,this.d_=n}function Jd(t,e){if(void 0===e)return{merge:!1};if(si(t,e,["merge","mergeFields"]),Zr(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ii(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof vp))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ii(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function $d(t,e){return void 0===e?{}:(si(t,e,["serverTimestamps"]),ti(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Zd(t,e){Jr(t,"object",1,e),e&&(si(t,e,["source"]),ti(t,0,"source",e.source,["default","server","cache"]))}function ty(t,e,n){if(e instanceof Fp){if(e.firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ui(t,"DocumentReference",1,e)}function ey(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ny,ry,be=(n(oy,ny=Vp),oy.serverTimestamp=function(){Kr("FieldValue.serverTimestamp",arguments);var t=new Op("serverTimestamp");return t.e_="FieldValue.serverTimestamp",new oy(t)},oy.delete=function(){Kr("FieldValue.delete",arguments);var t=new wp("deleteField");return t.e_="FieldValue.delete",new oy(t)},oy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qr("arrayUnion()",arguments,1),new Rp("arrayUnion",t)}.apply(void 0,t);return n.e_="FieldValue.arrayUnion",new oy(n)},oy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qr("arrayRemove()",arguments,1),new Pp("arrayRemove",t)}.apply(void 0,t);return n.e_="FieldValue.arrayRemove",new oy(n)},oy.increment=function(t){return Yr("FieldValue.increment","number",1,t),Wr("FieldValue.increment",arguments,1),(t=new Cp("increment",t)).e_="FieldValue.increment",new oy(t)},oy.prototype.isEqual=function(t){return this.l_.isEqual(t.l_)},oy),iy={Firestore:_d,GeoPoint:Up,Timestamp:Si,Blob:_i,Transaction:Ad,WriteBatch:Nd,DocumentReference:Sd,DocumentSnapshot:xd,Query:Hd,QueryDocumentSnapshot:Ld,QuerySnapshot:Kd,CollectionReference:Wd,FieldPath:vp,FieldValue:be,setLogLevel:_d.setLogLevel,CACHE_SIZE_UNLIMITED:Id};function oy(){return null!==ny&&ny.apply(this,arguments)||this}(ry=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new pp,t=new lp(r),new _d(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},iy))),ry.registerVersion("@firebase/firestore","1.18.0-20209141635")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});