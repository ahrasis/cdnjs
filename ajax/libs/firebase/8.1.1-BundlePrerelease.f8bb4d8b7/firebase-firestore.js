!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ag){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(Ag);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((Te={})[l.DEBUG]="log",Te[l.VERBOSE]="log",Te[l.INFO]="info",Te[l.WARN]="warn",Te[l.ERROR]="error",Te),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},x={},S=N||self;function D(){}function O(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Z=S.navigator;if(Z){Z=Z.userAgent;if(Z){H=Z;break t}}H=""}function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Y(H,"Opera"),it=Y(H,"Trident")||Y(H,"MSIE"),ot=Y(H,"Edge"),st=ot||it,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),at=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=H,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=S.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[Et]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[Et]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):_t(t)))}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Lt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new wt(e,this))}function Vt(t){return(t=t[St])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[Et]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function zt(){this.b=this.a=null}var Gt,Kt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Wt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Qt)}),Xt||(Gt(),Xt=!0),Zt.add(t,e)}zt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new zt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Kt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=U()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(A=Jt.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){Jt.X.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function _e(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}_e.prototype.a=null;var xe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){mt.call(this,"d")}function De(){mt.call(this,"c")}function Oe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Se,mt),j(De,mt),j(Oe,_e),xe=new Oe;var Pe=45e3,Re={},Le={};function Ce(t,e,n){t.H=1,t.i=nn(Ze(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=Ze(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=U()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(V(t.Va,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(V(u.Sa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(_n(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=Ke.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return We(this.b,t)?this.b[t]:e},A.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ze(t){return new Xe(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function Sn(){this.a=new xn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var On=S.JSON.parse;function kn(t){jt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}j(kn,jt);var Pn="",Rn=/^https?$/i,Ln=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==x&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,en(n=Ze(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Wn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){En(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ce(n,r,e)}function Qn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ze(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,qt(i=ye(),new be(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ee(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,S.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Wn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ze(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(xe),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==x&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},A.Ua=function(){Un(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(i=Ze(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Bn(i,this.i,r),_n(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||En(this.b)||Zn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Se),j(dr,De),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr,gr=ye,mr=Ie,wr=Te,br=pe,Er=10,Ir=11,Tr=Ne,_r=kn,Ar={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=(h(Dr,vr=Error),Dr),xr="8.1.1-BundlePrerelease.f8bb4d8b7",Sr=new o("@firebase/firestore");function Dr(t,e){var n=this;return(n=vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Or(){return Sr.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.DEBUG&&(e=n.map(Lr),Sr.debug.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.ERROR&&(e=n.map(Lr),Sr.error.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.WARN&&(e=n.map(Lr),Sr.warn.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+xr+") INTERNAL ASSERTION FAILED: "+t;throw Pr(t),new Error(t)}function Vr(t){t||Cr()}var Mr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function jr(t,e){return t<e?-1:e<t?1:0}function qr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Fr(t){return t+"\0"}var Br=(zr.fromBase64String=function(t){return new zr(atob(t))},zr.fromUint8Array=function(t){return new zr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},zr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},zr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},zr.prototype.o=function(){return 2*this.i.length},zr.prototype.u=function(t){return jr(this.i,t.i)},zr.prototype.isEqual=function(t){return this.i===t.i},zr);function zr(t){this.i=t}Br.h=new Br("");var Gr=(Hr.fromBase64String=function(t){try{return new Hr(Br.fromBase64String(t))}catch(t){throw new Nr(Ar.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Hr.fromUint8Array=function(t){return new Hr(Br.fromUint8Array(t))},Hr.prototype.toBase64=function(){return this.l.toBase64()},Hr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Hr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Hr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Hr),Kr=function(t){this._=t};function Hr(t){this.l=t}function Wr(){if("undefined"==typeof Uint8Array)throw new Nr(Ar.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Yr(){if("undefined"==typeof atob)throw new Nr(Ar.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xr,Zr=(h(ni,Xr=Kr),ni.fromBase64String=function(t){return Yr(),new ni(Gr.fromBase64String(t))},ni.fromUint8Array=function(t){return Wr(),new ni(Gr.fromUint8Array(t))},ni.prototype.toBase64=function(){return Yr(),this._.toBase64()},ni.prototype.toUint8Array=function(){return Wr(),this._.toUint8Array()},ni.prototype.isEqual=function(t){return this._.isEqual(t._)},ni.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ni),Qr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},Jr=(Object.defineProperty(ei.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return t instanceof ei&&t.projectId===this.projectId&&t.database===this.database},ei),$r=(ti.prototype.A=function(){return null!=this.uid},ti.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},ti.prototype.isEqual=function(t){return t.uid===this.uid},ti);function ti(t){this.uid=t}function ei(t,e){this.projectId=t,this.database=e||"(default)"}function ni(){return null!==Xr&&Xr.apply(this,arguments)||this}$r.UNAUTHENTICATED=new $r(null),$r.P=new $r("google-credentials-uid"),$r.g=new $r("first-party-uid");function ri(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ii,oi,si=(Ai.prototype.getToken=function(){return Promise.resolve(null)},Ai.prototype.v=function(){},Ai.prototype.S=function(t){(this.p=t)($r.UNAUTHENTICATED)},Ai.prototype.D=function(){this.p=null},Ai),ui=(_i.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new ri(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},_i.prototype.v=function(){this.forceRefresh=!0},_i.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},_i.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},_i.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new $r(t)},_i),ai=(Object.defineProperty(Ti.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ti),ci=(Ii.prototype.getToken=function(){return Promise.resolve(new ai(this.k,this.M))},Ii.prototype.S=function(t){t($r.g)},Ii.prototype.D=function(){},Ii.prototype.v=function(){},Ii),hi=(Ei.now=function(){return Ei.fromMillis(Date.now())},Ei.fromDate=function(t){return Ei.fromMillis(t.getTime())},Ei.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ei(e,1e6*(t-1e3*e))},Ei.prototype.toDate=function(){return new Date(this.toMillis())},Ei.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ei.prototype.$=function(t){return this.seconds===t.seconds?jr(this.nanoseconds,t.nanoseconds):jr(this.seconds,t.seconds)},Ei.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ei.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ei.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ei.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ei),fi=(bi.L=function(t){return new bi(t)},bi.min=function(){return new bi(new hi(0,0))},bi.prototype.u=function(t){return this.timestamp.$(t.timestamp)},bi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},bi.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},bi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},bi.prototype.q=function(){return this.timestamp},bi),Ie=(Object.defineProperty(wi.prototype,"length",{get:function(){return this.U},enumerable:!1,configurable:!0}),wi.prototype.isEqual=function(t){return 0===wi.K(this,t)},wi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof wi?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},wi.prototype.limit=function(){return this.offset+this.length},wi.prototype.j=function(t){return t=void 0===t?1:t,this.W(this.segments,this.offset+t,this.length-t)},wi.prototype.G=function(){return this.W(this.segments,this.offset,this.length-1)},wi.prototype.H=function(){return this.segments[this.offset]},wi.prototype.J=function(){return this.get(this.length-1)},wi.prototype.get=function(t){return this.segments[this.offset+t]},wi.prototype.Y=function(){return 0===this.length},wi.prototype.X=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},wi.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},wi.K=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},wi),li=(h(mi,oi=Ie),mi.prototype.W=function(t,e,n){return new mi(t,e,n)},mi.prototype.et=function(){return this.tt().join("/")},mi.prototype.toString=function(){return this.et()},mi.nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new mi(n)},mi.st=function(){return new mi([])},mi),pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,di=(h(gi,ii=Ie),gi.prototype.W=function(t,e,n){return new gi(t,e,n)},gi.it=function(t){return pi.test(t)},gi.prototype.et=function(){return this.tt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gi.it(t)||(t="`"+t+"`"),t}).join(".")},gi.prototype.toString=function(){return this.et()},gi.prototype.rt=function(){return 1===this.length&&"__name__"===this.get(0)},gi.ot=function(){return new gi(["__name__"])},gi.ct=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Nr(Ar.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Nr(Ar.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new gi(e)},gi.st=function(){return new gi([])},gi),yi=(vi.at=function(t){return new vi(li.nt(t))},vi.ut=function(t){return new vi(li.nt(t).j(5))},vi.prototype.ht=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},vi.prototype.isEqual=function(t){return null!==t&&0===li.K(this.path,t.path)},vi.prototype.toString=function(){return this.path.toString()},vi.K=function(t,e){return li.K(t.path,e.path)},vi.lt=function(t){return t.length%2==0},vi._t=function(t){return new vi(new li(t.slice()))},vi);function vi(t){this.path=t}function gi(){return null!==ii&&ii.apply(this,arguments)||this}function mi(){return null!==oi&&oi.apply(this,arguments)||this}function wi(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.U=n}function bi(t){this.timestamp=t}function Ei(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ii(t,e){this.k=t,this.M=e}function Ti(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=$r.g}function _i(t){var e=this;this.C=null,this.currentUser=$r.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function Ai(){this.p=null}function Ni(t){return null==t}function xi(t){return 0===t&&1/t==-1/0}function Si(t){return"number"==typeof t&&Number.isInteger(t)&&!xi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Di=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ft=null};function Oi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Di(t,e,n,r,i,o,s)}function ki(t){var e=t;return null===e.ft&&(t=e.path.et(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.et()+t.op.toString()+Lo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.et()+t.dir}).join(","),Ni(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=la(e.startAt)),e.endAt&&(t+="|ub:",t+=la(e.endAt)),e.ft=t),e.ft}function Pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Oo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!da(t.startAt,e.startAt)&&da(t.endAt,e.endAt)}function Ri(t){return yi.lt(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Li(t){this.count=t}var Ci,Vi=(Mi.prototype.Et=function(t){return new Mi(this.target,this.targetId,this.dt,t,this.wt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Mi.prototype.Tt=function(t,e){return new Mi(this.target,this.targetId,this.dt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Mi.prototype.It=function(t){return new Mi(this.target,this.targetId,this.dt,this.sequenceNumber,this.wt,t,this.resumeToken)},Mi);function Mi(t,e,n,r,i,o,s){void 0===i&&(i=fi.min()),void 0===o&&(o=fi.min()),void 0===s&&(s=Br.h),this.target=t,this.targetId=e,this.dt=n,this.sequenceNumber=r,this.wt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ui(t){switch(t){case Ar.OK:return Cr(),0;case Ar.CANCELLED:case Ar.UNKNOWN:case Ar.DEADLINE_EXCEEDED:case Ar.RESOURCE_EXHAUSTED:case Ar.INTERNAL:case Ar.UNAVAILABLE:case Ar.UNAUTHENTICATED:return;case Ar.INVALID_ARGUMENT:case Ar.NOT_FOUND:case Ar.ALREADY_EXISTS:case Ar.PERMISSION_DENIED:case Ar.FAILED_PRECONDITION:case Ar.ABORTED:case Ar.OUT_OF_RANGE:case Ar.UNIMPLEMENTED:case Ar.DATA_LOSS:return 1;default:return Cr(),0}}function ji(t){if(void 0===t)return Pr("GRPC error has no .code"),Ar.UNKNOWN;switch(t){case Ci.OK:return Ar.OK;case Ci.CANCELLED:return Ar.CANCELLED;case Ci.UNKNOWN:return Ar.UNKNOWN;case Ci.DEADLINE_EXCEEDED:return Ar.DEADLINE_EXCEEDED;case Ci.RESOURCE_EXHAUSTED:return Ar.RESOURCE_EXHAUSTED;case Ci.INTERNAL:return Ar.INTERNAL;case Ci.UNAVAILABLE:return Ar.UNAVAILABLE;case Ci.UNAUTHENTICATED:return Ar.UNAUTHENTICATED;case Ci.INVALID_ARGUMENT:return Ar.INVALID_ARGUMENT;case Ci.NOT_FOUND:return Ar.NOT_FOUND;case Ci.ALREADY_EXISTS:return Ar.ALREADY_EXISTS;case Ci.PERMISSION_DENIED:return Ar.PERMISSION_DENIED;case Ci.FAILED_PRECONDITION:return Ar.FAILED_PRECONDITION;case Ci.ABORTED:return Ar.ABORTED;case Ci.OUT_OF_RANGE:return Ar.OUT_OF_RANGE;case Ci.UNIMPLEMENTED:return Ar.UNIMPLEMENTED;case Ci.DATA_LOSS:return Ar.DATA_LOSS;default:return Cr()}}(Te=Ci=Ci||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var qi=(Ki.prototype.At=function(t,e){return new Ki(this.K,this.root.At(t,e,this.K).copy(null,null,Bi.Rt,null,null))},Ki.prototype.remove=function(t){return new Ki(this.K,this.root.remove(t,this.K).copy(null,null,Bi.Rt,null,null))},Ki.prototype.get=function(t){for(var e=this.root;!e.Y();){var n=this.K(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ki.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.Y();){var r=this.K(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ki.prototype.Y=function(){return this.root.Y()},Object.defineProperty(Ki.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ki.prototype.Pt=function(){return this.root.Pt()},Ki.prototype.yt=function(){return this.root.yt()},Ki.prototype.gt=function(t){return this.root.gt(t)},Ki.prototype.forEach=function(n){this.gt(function(t,e){return n(t,e),!1})},Ki.prototype.toString=function(){var n=[];return this.gt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ki.prototype.Vt=function(t){return this.root.Vt(t)},Ki.prototype.bt=function(){return new Fi(this.root,null,this.K,!1)},Ki.prototype.vt=function(t){return new Fi(this.root,t,this.K,!1)},Ki.prototype.St=function(){return new Fi(this.root,null,this.K,!0)},Ki.prototype.Dt=function(t){return new Fi(this.root,t,this.K,!0)},Ki),Fi=(Gi.prototype.Nt=function(){var t=this.xt.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.Y();)this.xt.push(t),t=t.right;else for(t=t.right;!t.Y();)this.xt.push(t),t=t.left;return e},Gi.prototype.Ft=function(){return 0<this.xt.length},Gi.prototype.Ot=function(){if(0===this.xt.length)return null;var t=this.xt[this.xt.length-1];return{key:t.key,value:t.value}},Gi),Bi=(zi.prototype.copy=function(t,e,n,r,i){return new zi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},zi.prototype.Y=function(){return!1},zi.prototype.gt=function(t){return this.left.gt(t)||t(this.key,this.value)||this.right.gt(t)},zi.prototype.Vt=function(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)},zi.prototype.min=function(){return this.left.Y()?this:this.left.min()},zi.prototype.Pt=function(){return this.min().key},zi.prototype.yt=function(){return this.right.Y()?this.key:this.right.yt()},zi.prototype.At=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.At(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.At(t,e,n))).kt()},zi.prototype.Mt=function(){if(this.left.Y())return zi.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Mt(),null)).kt()},zi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.Y()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.Bt()),r.right.Y()||r.right.$t()||r.right.left.$t()||(r=r.qt()),0===e(t,r.key)){if(r.right.Y())return zi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Mt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.kt()},zi.prototype.$t=function(){return this.color},zi.prototype.kt=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.Bt()),t.left.$t()&&t.right.$t()&&(t=t.Qt()),t},zi.prototype.Lt=function(){var t=this.Qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Bt())).Ut()).Qt()),t},zi.prototype.qt=function(){var t=this.Qt();return t.left.left.$t()&&(t=(t=t.Bt()).Qt()),t},zi.prototype.Ut=function(){var t=this.copy(null,null,zi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},zi.prototype.Bt=function(){var t=this.copy(null,null,zi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},zi.prototype.Qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},zi.prototype.Kt=function(){var t=this.Wt();return Math.pow(2,t)<=this.size+1},zi.prototype.Wt=function(){if(this.$t()&&this.left.$t())throw Cr();if(this.right.$t())throw Cr();var t=this.left.Wt();if(t!==this.right.Wt())throw Cr();return t+(this.$t()?0:1)},zi);function zi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:zi.RED,this.left=null!=r?r:zi.EMPTY,this.right=null!=i?i:zi.EMPTY,this.size=this.left.size+1+this.right.size}function Gi(t,e,n,r){this.Ct=r,this.xt=[];for(var i=1;!t.Y();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.xt.push(t);break}this.xt.push(t),t=this.Ct?t.right:t.left}}function Ki(t,e){this.K=t,this.root=e||Bi.EMPTY}function Hi(){this.size=0}Bi.EMPTY=null,Bi.RED=!0,Bi.Rt=!1,Bi.EMPTY=(Object.defineProperty(Hi.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Hi.prototype.copy=function(t,e,n,r,i){return this},Hi.prototype.At=function(t,e,n){return new Bi(t,e)},Hi.prototype.remove=function(t,e){return this},Hi.prototype.Y=function(){return!0},Hi.prototype.gt=function(t){return!1},Hi.prototype.Vt=function(t){return!1},Hi.prototype.Pt=function(){return null},Hi.prototype.yt=function(){return null},Hi.prototype.$t=function(){return!1},Hi.prototype.Kt=function(){return!0},Hi.prototype.Wt=function(){return 0},new Hi);var Wi=(Qi.prototype.has=function(t){return null!==this.data.get(t)},Qi.prototype.first=function(){return this.data.Pt()},Qi.prototype.last=function(){return this.data.yt()},Object.defineProperty(Qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Qi.prototype.indexOf=function(t){return this.data.indexOf(t)},Qi.prototype.forEach=function(n){this.data.gt(function(t,e){return n(t),!1})},Qi.prototype.jt=function(t,e){for(var n=this.data.vt(t[0]);n.Ft();){var r=n.Nt();if(0<=this.K(r.key,t[1]))return;e(r.key)}},Qi.prototype.Gt=function(t,e){for(var n=void 0!==e?this.data.vt(e):this.data.bt();n.Ft();)if(!t(n.Nt().key))return},Qi.prototype.zt=function(t){t=this.data.vt(t);return t.Ft()?t.Nt().key:null},Qi.prototype.bt=function(){return new Yi(this.data.bt())},Qi.prototype.vt=function(t){return new Yi(this.data.vt(t))},Qi.prototype.add=function(t){return this.copy(this.data.remove(t).At(t,!0))},Qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Qi.prototype.Y=function(){return this.data.Y()},Qi.prototype.Ht=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Qi.prototype.isEqual=function(t){if(!(t instanceof Qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(0!==this.K(r,i))return!1}return!0},Qi.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Qi.prototype.copy=function(t){var e=new Qi(this.K);return e.data=t,e},Qi),Yi=(Zi.prototype.Nt=function(){return this.Jt.Nt().key},Zi.prototype.Ft=function(){return this.Jt.Ft()},Zi),Xi=new qi(yi.K);function Zi(t){this.Jt=t}function Qi(t){this.K=t,this.data=new qi(this.K)}var Ji=new qi(yi.K);var $i=new qi(yi.K);var to=new Wi(yi.K);function eo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=to,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var no=new Wi(jr);var ro=(bo.Zt=function(t){return new bo(t.K)},bo.prototype.has=function(t){return null!=this.Yt.get(t)},bo.prototype.get=function(t){return this.Yt.get(t)},bo.prototype.first=function(){return this.Xt.Pt()},bo.prototype.last=function(){return this.Xt.yt()},bo.prototype.Y=function(){return this.Xt.Y()},bo.prototype.indexOf=function(t){t=this.Yt.get(t);return t?this.Xt.indexOf(t):-1},Object.defineProperty(bo.prototype,"size",{get:function(){return this.Xt.size},enumerable:!1,configurable:!0}),bo.prototype.forEach=function(n){this.Xt.gt(function(t,e){return n(t),!1})},bo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Yt.At(t.key,t),e.Xt.At(t,null))},bo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Yt.remove(t),this.Xt.remove(e)):this},bo.prototype.isEqual=function(t){if(!(t instanceof bo))return!1;if(this.size!==t.size)return!1;for(var e=this.Xt.bt(),n=t.Xt.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(!r.isEqual(i))return!1}return!0},bo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},bo.prototype.copy=function(t,e){var n=new bo;return n.K=this.K,n.Yt=t,n.Xt=e,n},bo),io=(wo.prototype.track=function(t){var e=t.doc.key,n=this.te.get(e);!n||0!==t.type&&3===n.type?this.te=this.te.At(e,t):3===t.type&&1!==n.type?this.te=this.te.At(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.te=this.te.At(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.te=this.te.remove(e):1===t.type&&2===n.type?this.te=this.te.At(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):Cr()},wo.prototype.ee=function(){var n=[];return this.te.gt(function(t,e){n.push(e)}),n},wo),oo=(mo.oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new mo(t,e,ro.Zt(e),i,n,r,!0,!1)},Object.defineProperty(mo.prototype,"hasPendingWrites",{get:function(){return!this.se.Y()},enumerable:!1,configurable:!0}),mo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ie===t.ie&&this.se.isEqual(t.se)&&Cu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.ne.isEqual(t.ne)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},mo),so=(go.le=function(t,e){var n=new Map;return n.set(t,uo._e(t,e)),new go(fi.min(),n,no,Xi,eo())},go),uo=(vo._e=function(t,e){return new vo(Br.h,e,eo(),eo(),eo())},vo),ao=function(t,e,n,r){this.Te=t,this.removedTargetIds=e,this.key=n,this.me=r},co=function(t,e){this.targetId=t,this.Ie=e},ho=function(t,e,n,r){void 0===n&&(n=Br.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},fo=(Object.defineProperty(yo.prototype,"fe",{get:function(){return this.ye},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"resumeToken",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"Ve",{get:function(){return 0!==this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"pe",{get:function(){return this.ge},enumerable:!1,configurable:!0}),yo.prototype.be=function(t){0<t.o()&&(this.ge=!0,this.Pe=t)},yo.prototype.ve=function(){var n=eo(),r=eo(),i=eo();return this.Re.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new uo(this.Pe,this.ye,n,r,i)},yo.prototype.Se=function(){this.ge=!1,this.Re=Io()},yo.prototype.De=function(t,e){this.ge=!0,this.Re=this.Re.At(t,e)},yo.prototype.Ce=function(t){this.ge=!0,this.Re=this.Re.remove(t)},yo.prototype.xe=function(){this.Ae+=1},yo.prototype.Ne=function(){--this.Ae},yo.prototype.Fe=function(){this.ge=!0,this.ye=!0},yo),lo=(po.prototype.Be=function(t){for(var e=0,n=t.Te;e<n.length;e++){var r=n[e];t.me instanceof mu?this.qe(r,t.me):t.me instanceof wu&&this.Ue(r,t.key,t.me)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.me)},po.prototype.Qe=function(n){var r=this;this.Ke(n,function(t){var e=r.We(t);switch(n.state){case 0:r.je(t)&&e.be(n.resumeToken);break;case 1:e.Ne(),e.Ve||e.Se(),e.be(n.resumeToken);break;case 2:e.Ne(),e.Ve||r.removeTarget(t);break;case 3:r.je(t)&&(e.Fe(),e.be(n.resumeToken));break;case 4:r.je(t)&&(r.Ge(t),e.be(n.resumeToken));break;default:Cr()}})},po.prototype.Ke=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ke.forEach(function(t,e){r.je(e)&&n(e)})},po.prototype.ze=function(t){var e=t.targetId,n=t.Ie.count,t=this.He(e);t&&(Ri(t=t.target)?0===n?(t=new yi(t.path),this.Ue(e,t,new wu(t,fi.min()))):Vr(1===n):this.Je(e)!==n&&(this.Ge(e),this.Le=this.Le.add(e)))},po.prototype.Ye=function(r){var i=this,o=new Map;this.ke.forEach(function(t,e){var n=i.He(e);n&&(t.fe&&Ri(n.target)&&(n=new yi(n.target.path),null!==i.Me.get(n)||i.Xe(e,n)||i.Ue(e,n,new wu(n,r))),t.pe&&(o.set(e,t.ve()),t.Se()))});var s=eo();this.$e.forEach(function(t,e){var n=!0;e.Gt(function(t){t=i.He(t);return!t||2===t.dt||(n=!1)}),n&&(s=s.add(t))});var t=new so(r,o,this.Le,this.Me,s);return this.Me=Xi,this.$e=Eo(),this.Le=new Wi(jr),t},po.prototype.qe=function(t,e){var n;this.je(t)&&(n=this.Xe(t,e.key)?2:0,this.We(t).De(e.key,n),this.Me=this.Me.At(e.key,e),this.$e=this.$e.At(e.key,this.Ze(e.key).add(t)))},po.prototype.Ue=function(t,e,n){var r;this.je(t)&&(r=this.We(t),this.Xe(t,e)?r.De(e,1):r.Ce(e),this.$e=this.$e.At(e,this.Ze(e).delete(t)),n&&(this.Me=this.Me.At(e,n)))},po.prototype.removeTarget=function(t){this.ke.delete(t)},po.prototype.Je=function(t){var e=this.We(t).ve();return this.Oe.tn(t).size+e.de.size-e.Ee.size},po.prototype.xe=function(t){this.We(t).xe()},po.prototype.We=function(t){var e=this.ke.get(t);return e||(e=new fo,this.ke.set(t,e)),e},po.prototype.Ze=function(t){var e=this.$e.get(t);return e||(e=new Wi(jr),this.$e=this.$e.At(t,e)),e},po.prototype.je=function(t){var e=null!==this.He(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},po.prototype.He=function(t){var e=this.ke.get(t);return e&&e.Ve?null:this.Oe.en(t)},po.prototype.Ge=function(e){var n=this;this.ke.set(e,new fo),this.Oe.tn(e).forEach(function(t){n.Ue(e,t,null)})},po.prototype.Xe=function(t,e){return this.Oe.tn(t).has(e)},po);function po(t){this.Oe=t,this.ke=new Map,this.Me=Xi,this.$e=Eo(),this.Le=new Wi(jr)}function yo(){this.Ae=0,this.Re=Io(),this.Pe=Br.h,this.ye=!1,this.ge=!0}function vo(t,e,n,r,i){this.resumeToken=t,this.fe=e,this.de=n,this.we=r,this.Ee=i}function go(t,e,n,r,i){this.wt=t,this.ce=e,this.ae=n,this.ue=r,this.he=i}function mo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ne=n,this.docChanges=r,this.se=i,this.fromCache=o,this.ie=s,this.re=u}function wo(){this.te=new qi(yi.K)}function bo(n){this.K=n?function(t,e){return n(t,e)||yi.K(t.key,e.key)}:function(t,e){return yi.K(t.key,e.key)},this.Yt=Ji,this.Xt=new qi(this.K)}function Eo(){return new qi(yi.K)}function Io(){return new qi(yi.K)}function To(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _o(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ao(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function No(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function xo(t){t=Co(t.mapValue.fields.__local_write_time__.timestampValue);return new hi(t.seconds,t.nanos)}var So=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Do(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?No(t)?4:10:Cr()}function Oo(r,i){var t,e=Do(r);if(e!==Do(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return xo(r).isEqual(xo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Co(r.timestampValue),t=Co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Mo(r.bytesValue).isEqual(Mo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Vo((t=r).geoPointValue.latitude)===Vo(e.geoPointValue.latitude)&&Vo(t.geoPointValue.longitude)===Vo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Vo(t.integerValue)===Vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Vo(t.doubleValue),e=Vo(e.doubleValue);return t===e?xi(t)===xi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return qr(r.arrayValue.values||[],i.arrayValue.values||[],Oo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(To(e)!==To(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Oo(e[t],n[t])))return!1;return!0}();default:return Cr()}}function ko(t,e){return void 0!==(t.values||[]).find(function(t){return Oo(t,e)})}function Po(t,e){var n,r,i=Do(t),o=Do(e);if(i!==o)return jr(i,o);switch(i){case 0:return 0;case 1:return jr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Vo(t.integerValue||t.doubleValue),n=Vo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ro(t.timestampValue,e.timestampValue);case 4:return Ro(xo(t),xo(e));case 5:return jr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Mo(t),e=Mo(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=jr(n[i],r[i]);if(0!==o)return o}return jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=jr(Vo(i.latitude),Vo(r.latitude)))?n:jr(Vo(i.longitude),Vo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Po(n[i],r[i]);if(o)return o}return jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=jr(r[s],o[s]);if(0!==u)return u;u=Po(n[r[s]],i[o[s]]);if(0!==u)return u}return jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Ro(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return jr(t,e);var n=Co(t),t=Co(e),e=jr(n.seconds,t.seconds);return 0!==e?e:jr(n.nanos,t.nanos)}function Lo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Co(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Mo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,yi.ut(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e}(t)}function Co(t){if(Vr(!!t),"string"!=typeof t)return{seconds:Vo(t.seconds),nanos:Vo(t.nanos)};var e=0,n=So.exec(t);Vr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mo(t){return"string"==typeof t?Br.fromBase64String(t):Br.fromUint8Array(t)}function Uo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.et()}}function jo(t){return t&&"integerValue"in t}function qo(t){return!!t&&"arrayValue"in t}function Fo(t){return t&&"nullValue"in t}function Bo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zo(t){return t&&"mapValue"in t}var Go={asc:"ASCENDING",desc:"DESCENDING"},Ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ho=function(t,e){this.T=t,this.nn=e};function Wo(t){return{integerValue:""+t}}function Yo(t,e){if(t.nn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xi(e)?"-0":e}}function Xo(t,e){return Si(e)?Wo(e):Yo(t,e)}function Zo(t,e){return t.nn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qo(t,e){return t.nn?e.toBase64():e.toUint8Array()}function Jo(t){return Vr(!!t),fi.L((t=Co(t),new hi(t.seconds,t.nanos)))}function $o(t,e){return new li(["projects",t.projectId,"databases",t.database]).child("documents").child(e).et()}function ts(t){t=li.nt(t);return Vr(ws(t)),t}function es(t,e){return $o(t.T,e.path)}function ns(t,e){e=ts(e);if(e.get(1)!==t.T.projectId)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new yi(ss(e))}function rs(t,e){return $o(t.T,e)}function is(t){t=ts(t);return 4===t.length?li.st():ss(t)}function os(t){return new li(["projects",t.T.projectId,"databases",t.T.database]).et()}function ss(t){return Vr(4<t.length&&"documents"===t.get(4)),t.j(5)}function us(t,e,n){return{name:es(t,e),fields:n.proto.mapValue.fields}}function as(t,e,n){var r=ns(t,e.name),t=Jo(e.updateTime),e=new cu({mapValue:{fields:e.fields}});return new mu(r,t,e,{hasCommittedMutations:!!n})}function cs(t,e){var n,r,i;if(e instanceof Zs)n={update:us(t,e.key,e.value)};else if(e instanceof uu)n={delete:es(t,e.key)};else if(e instanceof Qs)n={update:us(t,e.key,e.data),updateMask:(i=e.sn,r=[],i.fields.forEach(function(t){return r.push(t.et())}),{fieldPaths:r})};else if(e instanceof nu)n={transform:{document:es(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ts)return{fieldPath:t.field.et(),setToServerValue:"REQUEST_TIME"};if(e instanceof _s)return{fieldPath:t.field.et(),appendMissingElements:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.et(),removeAllFromArray:{values:e.elements}};if(e instanceof Rs)return{fieldPath:t.field.et(),increment:e.rn};throw Cr()})}};else{if(!(e instanceof au))return Cr();n={verify:es(t,e.key)}}return e.cn.on||(n.currentDocument=void 0!==(i=e.cn).updateTime?{updateTime:(e=t,t=i.updateTime,Zo(e,t.q()))}:void 0!==i.exists?{exists:i.exists}:Cr()),n}function hs(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Fs.updateTime(Jo(o.updateTime)):void 0!==o.exists?Fs.exists(o.exists):Fs.an():Fs.an();if(t.update){t.update.name;var r=ns(e,t.update.name),i=new cu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Ms(o.map(function(t){return di.ct(t)})));return new Qs(r,i,o,n)}return new Zs(r,i,n)}return t.delete?(r=ns(e,t.delete),new uu(r,n)):t.transform?(r=ns(e,t.transform.document),i=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Vr("REQUEST_TIME"===e.setToServerValue),r=new Ts):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new _s(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Ds(n)):"increment"in e?r=new Rs(t,e.increment):Cr();e=di.ct(e.fieldPath);return new Us(e,r)}(e,t)}),Vr(!0===n.exists),new nu(r,i)):t.verify?(r=ns(e,t.verify),new au(r,n)):Cr()}function fs(t,e){return{documents:[rs(t,e.path)]}}function ls(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=rs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=rs(t,r.G()),n.structuredQuery.from=[{collectionId:r.J()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Bo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NAN"}};if(Fo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Bo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NAN"}};if(Fo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vs(t.field),op:(e=t.op,Ko[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:vs((t=t).field),direction:(t=t.dir,Go[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.nn||Ni(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ds(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ds(e.endAt)),n}function ps(t){var e=is(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Vr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ms(t)]:void 0!==t.fieldFilter?[(n=t,Fu.create(gs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ya(gs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ni(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ys(n.startAt));var u=null;return n.endAt&&(u=ys(n.endAt)),Au(e,i,t,o,r,"F",s,u)}function ds(t){return{before:t.before,values:t.position}}function ys(t){var e=!!t.before,t=t.values||[];return new ua(t,e)}function vs(t){return{fieldPath:t.et()}}function gs(t){return di.ct(t.fieldPath)}function ms(t){switch(t.unaryFilter.op){case"IS_NAN":var e=gs(t.unaryFilter.field);return Fu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=gs(t.unaryFilter.field);return Fu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=gs(t.unaryFilter.field);return Fu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=gs(t.unaryFilter.field);return Fu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function ws(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}o=function(){this.un=void 0};function bs(t,e){return t instanceof Rs?jo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Es,Is,Ts=(h(Ns,Is=o),Ns),_s=(h(As,Es=o),As);function As(t){var e=this;return(e=Es.call(this)||this).elements=t,e}function Ns(){return null!==Is&&Is.apply(this,arguments)||this}function xs(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Oo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ss,Ds=(h(Os,Ss=o),Os);function Os(t){var e=this;return(e=Ss.call(this)||this).elements=t,e}function ks(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Oo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ps,Rs=(h(Ls,Ps=o),Ls);function Ls(t,e){var n=this;return(n=Ps.call(this)||this).serializer=t,n.rn=e,n}function Cs(t){return Vo(t.integerValue||t.doubleValue)}function Vs(t){return qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ms=(js.prototype.hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].X(t))return!0;return!1},js.prototype.isEqual=function(t){return qr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},js),Us=function(t,e){this.field=t,this.transform=e};function js(t){(this.fields=t).sort(di.K)}function qs(t,e){this.version=t,this.transformResults=e}var Fs=(Bs.an=function(){return new Bs},Bs.exists=function(t){return new Bs(void 0,t)},Bs.updateTime=function(t){return new Bs(t)},Object.defineProperty(Bs.prototype,"on",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Bs);function Bs(t,e){this.updateTime=t,this.exists=e}function zs(t,e){return void 0!==t.updateTime?e instanceof mu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof mu}Ie=function(){};function Gs(t,e,n){return t instanceof Zs?new mu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Qs?function(t,e,n){if(!zs(t.cn,e))return new bu(t.key,n.version);e=tu(t,e);return new mu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof nu?function(t,e,n){if(Vr(null!=n.transformResults),!zs(t.cn,e))return new bu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof mu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof _s?xs(o,s):o instanceof Ds?ks(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=iu(t,r.data(),e);return new mu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new wu(t.key,n.version,{hasCommittedMutations:!0})}function Ks(t,e,n,r){return t instanceof Zs?function(t,e){if(!zs(t.cn,e))return e;e=Ws(e);return new mu(t.key,e,t.value,{ln:!0})}(t,e):t instanceof Qs?function(t,e){if(!zs(t.cn,e))return e;var n=Ws(e),e=tu(t,e);return new mu(t.key,n,e,{ln:!0})}(t,e):t instanceof nu?function(t,e,n,r){if(!zs(t.cn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof mu&&(h=n.field(a.field)),null===h&&r instanceof mu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ts?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof _s?xs(c,i):c instanceof Ds?ks(c,i):(c=bs(h=c,i),i=Cs(c)+Cs(h.rn),jo(c)&&jo(h.rn)?Wo(i):Yo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=iu(t,i.data(),r);return new mu(t.key,i.version,r,{ln:!0})}(t,e,r,n):(e=e,zs((t=t).cn,e)?new wu(t.key,fi.min()):e)}function Hs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.cn.isEqual(e.cn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.sn.isEqual(e.sn):2!==t.type||qr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof _s&&e instanceof _s||t instanceof Ds&&e instanceof Ds?qr(t.elements,e.elements,Oo):t instanceof Rs&&e instanceof Rs?Oo(t.rn,e.rn):t instanceof Ts&&e instanceof Ts)}))}function Ws(t){return t instanceof mu?t.version:fi.min()}var Ys,Xs,Zs=(h($s,Xs=Ie),$s),Qs=(h(Js,Ys=Ie),Js);function Js(t,e,n,r){var i=this;return(i=Ys.call(this)||this).key=t,i.data=e,i.sn=n,i.cn=r,i.type=1,i}function $s(t,e,n){var r=this;return(r=Xs.call(this)||this).key=t,r.value=e,r.cn=n,r.type=0,r}function tu(t,e){return n=t,e=e instanceof mu?e.data():cu.empty(),r=new hu(e),n.sn.fields.forEach(function(t){var e;t.Y()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r._n();var n,r}var eu,nu=(h(ru,eu=Ie),ru);function ru(t,e){var n=this;return(n=eu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.cn=Fs.exists(!0),n}function iu(t,e,n){for(var r=new hu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r._n()}var ou,su,uu=(h(du,su=Ie),du),au=(h(pu,ou=Ie),pu),cu=(lu.empty=function(){return new lu({mapValue:{}})},lu.prototype.field=function(t){if(t.Y())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.J()])||null},lu.prototype.isEqual=function(t){return Oo(this.proto,t.proto)},lu),hu=(fu.prototype.set=function(t,e){return this.wn(t,e),this},fu.prototype.delete=function(t){return this.wn(t,null),this},fu.prototype.wn=function(t,e){for(var n=this.dn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Do(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.J(),e)},fu.prototype._n=function(){var t=this.En(di.st(),this.dn);return null!=t?new cu(t):this.fn},fu.prototype.En=function(r,t){var i=this,o=!1,e=this.fn.field(r),s=zo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.En(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},fu);function fu(t){void 0===t&&(t=cu.empty()),this.fn=t,this.dn=new Map}function lu(t){this.proto=t}function pu(t,e){var n=this;return(n=ou.call(this)||this).key=t,n.cn=e,n.type=4,n}function du(t,e){var n=this;return(n=su.call(this)||this).key=t,n.cn=e,n.type=3,n}var yu,vu,gu,Te=function(t,e){this.key=t,this.version=e},mu=(h(_u,gu=Te),_u.prototype.field=function(t){return this.Tn.field(t)},_u.prototype.data=function(){return this.Tn},_u.prototype.mn=function(){return this.Tn.proto},_u.prototype.isEqual=function(t){return t instanceof _u&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ln===t.ln&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Tn.isEqual(t.Tn)},_u.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Tn.toString()+", {hasLocalMutations: "+this.ln+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(_u.prototype,"hasPendingWrites",{get:function(){return this.ln||this.hasCommittedMutations},enumerable:!1,configurable:!0}),_u),wu=(h(Tu,vu=Te),Tu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){return t instanceof Tu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Tu),bu=(h(Iu,yu=Te),Iu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Iu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Iu.prototype.isEqual=function(t){return t instanceof Iu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Iu),Eu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.In=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.An=null,this.Rn=null,this.startAt,this.endAt};function Iu(){return null!==yu&&yu.apply(this,arguments)||this}function Tu(t,e,n){var r=this;return(r=vu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function _u(t,e,n,r){var i=this;return(i=gu.call(this,t,e)||this).Tn=n,i.ln=!!r.ln,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Au(t,e,n,r,i,o,s,u){return new Eu(t,e,n,r,i,o,s,u)}function Nu(t){return new Eu(t)}function xu(t){return!Ni(t.limit)&&"F"===t.limitType}function Su(t){return!Ni(t.limit)&&"L"===t.limitType}function Du(t){return 0<t.In.length?t.In[0].field:null}function Ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Pn())return r.field}return null}function ku(t){return null!==t.collectionGroup}function Pu(t){var e=t;if(null===e.An){e.An=[];var n=Ou(e),t=Du(e);if(null!==n&&null===t)n.rt()||e.An.push(new ya(n)),e.An.push(new ya(di.ot(),"asc"));else{for(var r=!1,i=0,o=e.In;i<o.length;i++){var s=o[i];e.An.push(s),s.field.rt()&&(r=!0)}r||(n=0<e.In.length?e.In[e.In.length-1].dir:"asc",e.An.push(new ya(di.ot(),n)))}}return e.An}function Ru(t){var e=t;if(!e.Rn)if("F"===e.limitType)e.Rn=Oi(e.path,e.collectionGroup,Pu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Pu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ya(o.field,s))}var u=e.endAt?new ua(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ua(e.startAt.position,!e.startAt.before):null;e.Rn=Oi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Rn}function Lu(t,e,n){return new Eu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cu(t,e){return Pi(Ru(t),Ru(e))&&t.limitType===e.limitType}function Vu(t){return ki(Ru(t))+"|lt:"+t.limitType}function Mu(t){return"Query(target="+(e=Ru(t),n=e.path.et(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.et()+" "+t.op+" "+Lo(t.value)}).join(", ")+"]"),Ni(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.et()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+la(e.startAt)),e.endAt&&(n+=", endAt: "+la(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Uu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.ht(e.collectionGroup)&&e.path.X(n):yi.lt(e.path)?e.path.isEqual(n):e.path.Z(n))&&function(t){for(var e=0,n=i.In;e<n.length;e++){var r=n[e];if(!r.field.rt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||pa(t.startAt,Pu(t),n))&&(!t.endAt||!pa(t.endAt,Pu(t),n)));var e,n}function ju(u){return function(t,e){for(var n=!1,r=0,i=Pu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.rt()?yi.K(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Po(n,t):Cr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.rt()}return 0}}var qu,Fu=(h(Bu,qu=function(){}),Bu.create=function(t,e,n){return t.rt()?"in"===e||"not-in"===e?this.yn(t,e,n):new Hu(t,e,n):"array-contains"===e?new ra(t,n):"in"===e?new ia(t,n):"not-in"===e?new oa(t,n):"array-contains-any"===e?new sa(t,n):new Bu(t,e,n)},Bu.yn=function(t,e,n){return new("in"===e?Wu:Yu)(t,n)},Bu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.gn(Po(t,this.value)):null!==t&&Do(this.value)===Do(t)&&this.gn(Po(t,this.value))},Bu.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},Bu.prototype.Pn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Bu);function Bu(t,e,n){var r=this;return(r=qu.call(this)||this).field=t,r.op=e,r.value=n,r}var zu,Gu,Ku,Hu=(h(Qu,Ku=Fu),Qu.prototype.matches=function(t){t=yi.K(t.key,this.key);return this.gn(t)},Qu),Wu=(h(Zu,Gu=Fu),Zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Zu),Yu=(h(Xu,zu=Fu),Xu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Xu);function Xu(t,e){var n=this;return(n=zu.call(this,t,"not-in",e)||this).keys=Ju(0,e),n}function Zu(t,e){var n=this;return(n=Gu.call(this,t,"in",e)||this).keys=Ju(0,e),n}function Qu(t,e,n){var r=this;return(r=Ku.call(this,t,e,n)||this).key=yi.ut(n.referenceValue),r}function Ju(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return yi.ut(t.referenceValue)})}var $u,ta,ea,na,ra=(h(fa,na=Fu),fa.prototype.matches=function(t){t=t.field(this.field);return qo(t)&&ko(t.arrayValue,this.value)},fa),ia=(h(ha,ea=Fu),ha.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ko(this.value.arrayValue,t)},ha),oa=(h(ca,ta=Fu),ca.prototype.matches=function(t){if(ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ko(this.value.arrayValue,t)},ca),sa=(h(aa,$u=Fu),aa.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!qo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ko(e.value.arrayValue,t)})},aa),ua=function(t,e){this.position=t,this.before=e};function aa(t,e){return $u.call(this,t,"array-contains-any",e)||this}function ca(t,e){return ta.call(this,t,"not-in",e)||this}function ha(t,e){return ea.call(this,t,"in",e)||this}function fa(t,e){return na.call(this,t,"array-contains",e)||this}function la(t){return(t.before?"b":"a")+":"+t.position.map(Lo).join(",")}function pa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.rt()?yi.K(yi.ut(s.referenceValue),n.key):Po(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function da(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Oo(t.position[n],e.position[n]))return!1;return!0}var ya=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var va=(Pa.prototype.pn=function(t,e,n){for(var r=n.bn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Gs(o,e,r[i]))}return e},Pa.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ks(i,e,e,this.Vn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ks(a,e,o,this.Vn))}return e},Pa.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.At(t.key,e))}),i},Pa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},eo())},Pa.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,Hs)&&qr(this.baseMutations,t.baseMutations,Hs)},Pa),ga=(ka.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=$i,i=t.mutations,o=0;o<i.length;o++)r=r.At(i[o].key,n[o].version);return new ka(t,e,n,r)},ka),ma=(Oa.prototype.get=function(t){var e=this.xn(t),e=this.Fn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Nn(o,t))return i}},Oa.prototype.has=function(t){return void 0!==this.get(t)},Oa.prototype.set=function(t,e){var n=this.xn(t),r=this.Fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Nn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Fn[n]=[[t,e]]},Oa.prototype.delete=function(t){var e=this.xn(t),n=this.Fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Nn(n[r][0],t))return 1===n.length?delete this.Fn[e]:n.splice(r,1),!0;return!1},Oa.prototype.forEach=function(s){_o(this.Fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Oa.prototype.Y=function(){return Ao(this.Fn)},Oa),wa=(Da.prototype.catch=function(t){return this.next(void 0,t)},Da.prototype.next=function(r,i){var o=this;return this.$n&&Cr(),this.$n=!0,this.Mn?this.error?this.Ln(i,this.error):this.Bn(r,this.result):new Da(function(e,n){o.On=function(t){o.Bn(r,t).next(e,n)},o.kn=function(t){o.Ln(i,t).next(e,n)}})},Da.prototype.qn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Da.prototype.Un=function(t){try{var e=t();return e instanceof Da?e:Da.resolve(e)}catch(t){return Da.reject(t)}},Da.prototype.Bn=function(t,e){return t?this.Un(function(){return t(e)}):Da.resolve(e)},Da.prototype.Ln=function(t,e){return t?this.Un(function(){return t(e)}):Da.reject(e)},Da.resolve=function(n){return new Da(function(t,e){t(n)})},Da.reject=function(n){return new Da(function(t,e){e(n)})},Da.Qn=function(t){return new Da(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Da.Kn=function(t){for(var n=Da.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Da.resolve(t):e()})}(r[e]);return n},Da.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Qn(i)},Da),o=(Sa.prototype.Gn=function(t){t=this.Wn.get(t);return t?t.readTime:fi.min()},Sa.prototype.zn=function(t,e){this.Hn(),this.Wn.set(t.key,{Jn:t,readTime:e})},Sa.prototype.Yn=function(t,e){void 0===e&&(e=null),this.Hn(),this.Wn.set(t,{Jn:null,readTime:e})},Sa.prototype.Xn=function(t,e){this.Hn();var n=this.Wn.get(e);return void 0!==n?wa.resolve(n.Jn):this.Zn(t,e)},Sa.prototype.getEntries=function(t,e){return this.ts(t,e)},Sa.prototype.apply=function(t){return this.Hn(),this.jn=!0,this.es(t)},Sa.prototype.Hn=function(){},Sa),ba="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(xa.prototype.ss=function(t){this.ns.push(t)},xa.prototype.rs=function(){this.ns.forEach(function(t){return t()})},xa),Ea=(Na.prototype.hs=function(e,n){var r=this;return this.cs.ls(e,n).next(function(t){return r._s(e,n,t)})},Na.prototype._s=function(t,r,i){return this.os.Xn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},Na.prototype.fs=function(t,e,i){var o=Xi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.At(t,e)}),o},Na.prototype.ds=function(e,t){var n=this;return this.os.getEntries(e,t).next(function(t){return n.ws(e,t)})},Na.prototype.ws=function(e,r){var i=this;return this.cs.Es(e,r).next(function(t){var t=i.fs(e,r,t),n=Xi;return t.forEach(function(t,e){e=e||new wu(t,fi.min()),n=n.At(t,e)}),n})},Na.prototype.Ts=function(t,e,n){return r=e,yi.lt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Is(t,e.path):ku(e)?this.As(t,e,n):this.Rs(t,e,n);var r},Na.prototype.Is=function(t,e){return this.hs(t,new yi(e)).next(function(t){var e=Ji;return t instanceof mu&&(e=e.At(t.key,t)),e})},Na.prototype.As=function(n,r,i){var o=this,s=r.collectionGroup,u=Ji;return this.us.Ps(n,s).next(function(t){return wa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Eu(t,null,e.In.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.At(t,e)})})}).next(function(){return u})})},Na.prototype.Rs=function(e,n,t){var c,h,r=this;return this.os.Ts(e,n,t).next(function(t){return c=t,r.cs.ys(e,n)}).next(function(t){return h=t,r.gs(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ks(s,a,a,r.Vn);c=a instanceof mu?c.At(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Uu(n,e)||(c=c.remove(t))}),c})},Na.prototype.gs=function(t,e,n){for(var r=eo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Qs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.os.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof mu&&(c=c.At(t,e))}),c})},Na),Ia=(Aa.bs=function(t,e){for(var n=eo(),r=eo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Aa(t,e.fromCache,n,r)},Aa),Ta=(_a.prototype.Ss=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},_a.prototype.next=function(){var t=++this.previousValue;return this.Ds&&this.Ds(t),t},_a);function _a(t,e){var n=this;this.previousValue=t,e&&(e.vs=function(t){return n.Ss(t)},this.Ds=function(t){return e.Cs(t)})}function Aa(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.ps=r}function Na(t,e,n){this.os=t,this.cs=e,this.us=n}function xa(){this.ns=[]}function Sa(){this.Wn=new ma(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.jn=!1}function Da(t){var e=this;this.On=null,this.kn=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.$n=!1,t(function(t){e.Mn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Mn=!0,e.error=t,e.kn&&e.kn(t)})}function Oa(t,e){this.xn=t,this.Nn=e,this.Fn={}}function ka(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function Pa(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}Ta.xs=-1;var Ra,La=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Ca=(Ba.prototype.reset=function(){this.$s=0},Ba.prototype.qs=function(){this.$s=this.Ms},Ba.prototype.Us=function(t){var e=this;this.cancel();var n=Math.floor(this.$s+this.Qs()),r=Math.max(0,Date.now()-this.Bs),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.$s+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ls=this.Ns.Ks(this.Fs,i,function(){return e.Bs=Date.now(),t()}),this.$s*=this.ks,this.$s<this.Os&&(this.$s=this.Os),this.$s>this.Ms&&(this.$s=this.Ms)},Ba.prototype.Ws=function(){null!==this.Ls&&(this.Ls.js(),this.Ls=null)},Ba.prototype.cancel=function(){null!==this.Ls&&(this.Ls.cancel(),this.Ls=null)},Ba.prototype.Qs=function(){return(Math.random()-.5)*this.$s},Ba),Va=(Fa.delete=function(t){return kr("SimpleDb","Removing database:",t),Ya(window.indexedDB.deleteDatabase(t)).qn()},Fa.Hs=function(){if("undefined"==typeof indexedDB)return!1;if(Fa.Js())return!0;var t=p(),e=Fa.zs(t),n=0<e&&e<10,e=Fa.Ys(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Fa.Js=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Xs)},Fa.Zs=function(t,e){return t.store(e)},Fa.zs=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Fa.Ys=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Fa.prototype.ti=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Ua(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Nr(Ar.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Ua(o,t))},r.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Gs.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){kr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.ei&&(this.db.onversionchange=function(t){return i.ei(t)}),this.db)]}})})},Fa.prototype.ni=function(e){this.ei=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Fa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.ti(u)];case 2:return s.db=t.sent(),e=Ga.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),wa.reject(t)}).qn(),r={},n.catch(function(){}),[4,e.si];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,kr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Fa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Fa),Ma=(Object.defineProperty(qa.prototype,"Mn",{get:function(){return this.ri},enumerable:!1,configurable:!0}),Object.defineProperty(qa.prototype,"ci",{get:function(){return this.oi},enumerable:!1,configurable:!0}),Object.defineProperty(qa.prototype,"cursor",{set:function(t){this.ii=t},enumerable:!1,configurable:!0}),qa.prototype.done=function(){this.ri=!0},qa.prototype.ai=function(t){this.oi=t},qa.prototype.delete=function(){return Ya(this.ii.delete())},qa),Ua=(h(ja,Ra=Nr),ja);function ja(t,e){var n=this;return(n=Ra.call(this,Ar.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function qa(t){this.ii=t,this.ri=!1,this.oi=null}function Fa(t,e,n){this.name=t,this.version=e,this.Gs=n,12.2===Fa.zs(p())&&Pr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ba(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ns=t,this.Fs=e,this.Os=n,this.ks=r,this.Ms=i,this.$s=0,this.Ls=null,this.Bs=Date.now(),this.reset()}function za(t){return"IndexedDbTransactionError"===t.name}var Ga=(Wa.open=function(t,e,n,r){try{return new Wa(e,t.transaction(r,n))}catch(t){throw new Ua(e,t)}},Object.defineProperty(Wa.prototype,"si",{get:function(){return this.ui.promise},enumerable:!1,configurable:!0}),Wa.prototype.abort=function(t){t&&this.ui.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Wa.prototype.store=function(t){t=this.transaction.objectStore(t);return new Ka(t)},Wa),Ka=(Ha.prototype.put=function(t,e){t=void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ya(t)},Ha.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Ya(this.store.add(t))},Ha.prototype.get=function(e){var n=this;return Ya(this.store.get(e)).next(function(t){return void 0===t&&(t=null),kr("SimpleDb","GET",n.store.name,e,t),t})},Ha.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Ya(this.store.delete(t))},Ha.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Ya(this.store.count())},Ha.prototype.hi=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.li(e,function(t,e){n.push(e)}).next(function(){return n})},Ha.prototype._i=function(t,e){kr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.fi=!1;e=this.cursor(e);return this.li(e,function(t,e,n){return n.delete()})},Ha.prototype.di=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.li(n,e)},Ha.prototype.wi=function(r){var t=this.cursor({});return new wa(function(n,e){t.onerror=function(t){t=Za(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ha.prototype.li=function(t,i){var o=[];return new wa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Ma(n),(t=i(n.primaryKey,n.value,e))instanceof wa&&(t=t.catch(function(t){return e.done(),wa.reject(t)}),o.push(t)),e.Mn?r():null===e.ci?n.continue():n.continue(e.ci)):r()}}).next(function(){return wa.Qn(o)})},Ha.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ha.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.fi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ha);function Ha(t){this.store=t}function Wa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ui=new La,this.transaction.oncomplete=function(){n.ui.resolve()},this.transaction.onabort=function(){t.error?n.ui.reject(new Ua(e,t.error)):n.ui.resolve()},this.transaction.onerror=function(t){t=Za(t.target.error);n.ui.reject(new Ua(e,t))}}function Ya(t){return new wa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Za(t.target.error);n(t)}})}var Xa=!1;function Za(t){var e=Va.zs(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Nr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xa||(Xa=!0,setTimeout(function(){throw n},0)),n}}return t}function Qa(){return"undefined"!=typeof window?window:null}function Ja(){return"undefined"!=typeof document?document:null}var $a=(nc.Ai=function(t,e,n,r,i){i=new nc(t,e,Date.now()+n,r,i);return i.start(n),i},nc.prototype.start=function(t){var e=this;this.Ri=setTimeout(function(){return e.Pi()},t)},nc.prototype.js=function(){return this.Pi()},nc.prototype.cancel=function(t){null!==this.Ri&&(this.clearTimeout(),this.Ii.reject(new Nr(Ar.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},nc.prototype.Pi=function(){var e=this;this.Ei.yi(function(){return null!==e.Ri?(e.clearTimeout(),e.op().then(function(t){return e.Ii.resolve(t)})):Promise.resolve()})},nc.prototype.clearTimeout=function(){null!==this.Ri&&(this.mi(this),clearTimeout(this.Ri),this.Ri=null)},nc),tc=(Object.defineProperty(ec.prototype,"Ni",{get:function(){return this.pi},enumerable:!1,configurable:!0}),ec.prototype.yi=function(t){this.enqueue(t)},ec.prototype.Fi=function(t){this.Oi(),this.ki(t)},ec.prototype.Mi=function(){var t;this.pi||(this.pi=!0,(t=Ja())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.xi))},ec.prototype.enqueue=function(t){return this.Oi(),this.pi?new Promise(function(t){}):this.ki(t)},ec.prototype.$i=function(t){var e=this;this.yi(function(){return e.Vi.push(t),e.Li()})},ec.prototype.Li=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Vi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Vi[0]()];case 2:return t.sent(),this.Vi.shift(),this.Ci.reset(),[3,4];case 3:if(!za(e=t.sent()))throw e;return kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Vi.length&&this.Ci.Us(function(){return n.Li()}),t.label=5;case 5:return[2]}})})},ec.prototype.ki=function(t){var r=this,e=this.gi.then(function(){return r.Si=!0,t().catch(function(t){throw r.vi=t,r.Si=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Si=!1,t})});return this.gi=e},ec.prototype.Ks=function(t,e,n){var r=this;this.Oi(),-1<this.Di.indexOf(t)&&(e=0);n=$a.Ai(this,t,e,n,function(t){return r.Bi(t)});return this.bi.push(n),n},ec.prototype.Oi=function(){this.vi&&Cr()},ec.prototype.qi=function(){},ec.prototype.Ui=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.gi];case 1:t.sent(),t.label=2;case 2:if(e!==this.gi)return[3,0];t.label=3;case 3:return[2]}})})},ec.prototype.Qi=function(t){for(var e=0,n=this.bi;e<n.length;e++)if(n[e].Fs===t)return!0;return!1},ec.prototype.Ki=function(r){var i=this;return this.Ui().then(function(){i.bi.sort(function(t,e){return t.Ti-e.Ti});for(var t=0,e=i.bi;t<e.length;t++){var n=e[t];if(n.js(),"all"!==r&&n.Fs===r)break}return i.Ui()})},ec.prototype.Wi=function(t){this.Di.push(t)},ec.prototype.Bi=function(t){t=this.bi.indexOf(t);this.bi.splice(t,1)},ec);function ec(){var e=this;this.gi=Promise.resolve(),this.Vi=[],this.pi=!1,this.bi=[],this.vi=null,this.Si=!1,this.Di=[],this.Ci=new Ca(this,"async_queue_retry"),this.xi=function(){var t=Ja();t&&kr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ci.Ws()};var t=Ja();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.xi)}function nc(t,e,n,r,i){this.Ei=t,this.Fs=e,this.Ti=n,this.op=r,this.mi=i,this.Ii=new La,this.then=this.Ii.promise.then.bind(this.Ii.promise),this.Ii.promise.catch(function(t){})}function rc(t,e){if(Pr("AsyncQueue",e+": "+t),za(t))return new Nr(Ar.UNAVAILABLE,e+": "+t);throw t}function ic(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=jr(n,t);return 0===t?jr(r,e):t}var oc=(cc.prototype.zi=function(){return++this.Gi},cc.prototype.Hi=function(t){var e=[t,this.zi()];this.buffer.size<this.ji?this.buffer=this.buffer.add(e):ic(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(cc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),cc),sc={Ji:!1,Yi:0,Xi:0,Zi:0},uc=(ac.sr=function(t){return new ac(t,ac.ir,ac.rr)},ac);function ac(t,e,n){this.tr=t,this.er=e,this.nr=n}function cc(t){this.ji=t,this.buffer=new Wi(ic),this.Gi=0}uc.ir=10,uc.rr=1e3,uc.cr=new uc(41943040,uc.ir,uc.rr),uc.ar=new uc(-1,0,0);var hc=(yc.prototype.start=function(t){-1!==this.ur.params.tr&&this._r(t)},yc.prototype.stop=function(){this.lr&&(this.lr.cancel(),this.lr=null)},Object.defineProperty(yc.prototype,"dr",{get:function(){return null!==this.lr},enumerable:!1,configurable:!0}),yc.prototype._r=function(n){var t=this,e=this.hr?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.lr=this.Ei.Ks("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.lr=null,this.hr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.wr(this.ur)];case 2:return t.sent(),[3,7];case 3:return za(e=t.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this._r(n)];case 8:return t.sent(),[2]}})})})},yc),fc=(dc.prototype.Tr=function(t,e){return this.Er.mr(t).next(function(t){return Math.floor(e/100*t)})},dc.prototype.Ir=function(t,e){var n=this;if(0===e)return wa.resolve(Ta.xs);var r=new oc(e);return this.Er.Ke(t,function(t){return r.Hi(t.sequenceNumber)}).next(function(){return n.Er.Ar(t,function(t){return r.Hi(t)})}).next(function(){return r.maxValue})},dc.prototype.Rr=function(t,e,n){return this.Er.Rr(t,e,n)},dc.prototype.Pr=function(t,e){return this.Er.Pr(t,e)},dc.prototype.yr=function(e,n){var r=this;return-1===this.params.tr?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),wa.resolve(sc)):this.gr(e).next(function(t){return t<r.params.tr?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.tr),sc):r.Vr(e,n)})},dc.prototype.gr=function(t){return this.Er.gr(t)},dc.prototype.Vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Tr(e,this.params.er).next(function(t){return i=t>h.params.nr?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.nr+" from "+t),h.params.nr):t,s=Date.now(),h.Ir(e,i)}).next(function(t){return r=t,u=Date.now(),h.Rr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Pr(e,r)}).next(function(t){return c=Date.now(),Or()<=l.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),wa.resolve({Ji:!0,Yi:i,Xi:o,Zi:t})})},dc),lc=(pc.prototype.pr=function(t){this.br=t},pc.prototype.Ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.In.length||1===r.In.length&&r.In[0].field.rt())||i.isEqual(fi.min())?this.vr(e,r):this.br.ds(e,o).next(function(t){var n=s.Sr(r,t);return(xu(r)||Su(r))&&s.Dr(r.limitType,n,o,i)?s.vr(e,r):(Or()<=l.DEBUG&&kr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mu(r)),s.br.Ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.At(t.key,t)}),e}))})},pc.prototype.Sr=function(n,t){var r=new Wi(ju(n));return t.forEach(function(t,e){e instanceof mu&&Uu(n,e)&&(r=r.add(e))}),r},pc.prototype.Dr=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},pc.prototype.vr=function(t,e){return Or()<=l.DEBUG&&kr("QueryEngine","Using full collection scan to execute query:",Mu(e)),this.br.Ts(t,e,fi.min())},pc);function pc(){}function dc(t,e){this.Er=t,this.params=e}function yc(t,e){this.ur=t,this.Ei=e,this.hr=!1,this.lr=null}function vc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=gc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return gc(e)}function gc(t){return t+"\x01\x01"}function mc(t){var e=t.length;if(Vr(2<=e),2===e)return Vr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),li.st();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Cr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Cr()}o=s+2}return new li(r)}var wc=function(t){this.Cr=t};function bc(t,e){if(e.document)return as(t.Cr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=yi._t(e.noDocument.path),r=Ac(e.noDocument.readTime);return new wu(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=yi._t(e.unknownDocument.path),r=Ac(e.unknownDocument.version);return new bu(n,r)}return Cr()}function Ec(t,e,n){var r=Ic(n),n=e.key.path.G().tt();if(e instanceof mu){var i={name:es(o=t.Cr,(s=e).key),fields:s.mn().mapValue.fields,updateTime:Zo(o,s.version.q())},o=e.hasCommittedMutations;return new sh(null,null,i,o,r,n)}if(e instanceof wu){var s=e.key.path.tt(),i=_c(e.version),o=e.hasCommittedMutations;return new sh(null,new ih(s,i),null,o,r,n)}if(e instanceof bu){o=e.key.path.tt(),e=_c(e.version);return new sh(new oh(o,e),null,null,!0,r,n)}return Cr()}function Ic(t){t=t.q();return[t.seconds,t.nanoseconds]}function Tc(t){t=new hi(t[0],t[1]);return fi.L(t)}function _c(t){t=t.q();return new Xc(t.seconds,t.nanoseconds)}function Ac(t){t=new hi(t.seconds,t.nanoseconds);return fi.L(t)}function Nc(e,t){var n=(t.baseMutations||[]).map(function(t){return hs(e.Cr,t)}),r=t.mutations.map(function(t){return hs(e.Cr,t)}),i=hi.fromMillis(t.localWriteTimeMs);return new va(t.batchId,i,n,r)}function xc(t){var e=Ac(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Ac(t.lastLimboFreeSnapshotVersion):fi.min(),r=void 0!==t.query.documents?(Vr(1===(r=t.query).documents.length),Ru(Nu(is(r.documents[0])))):Ru(ps(t.query));return new Vi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Br.fromBase64String(t.resumeToken))}function Sc(t,e){var n=_c(e.wt),r=_c(e.lastLimboFreeSnapshotVersion),i=(Ri(e.target)?fs:ls)(t.Cr,e.target),t=e.resumeToken.toBase64();return new ah(e.targetId,ki(e.target),n,t,e.sequenceNumber,r,i)}function Dc(t){var e=ps({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Lu(e,e.limit,"L"):e}var Oc=(kc.Or=function(t,e,n,r){return Vr(""!==t.uid),new kc(t.A()?t.uid:"",e,n,r)},kc.prototype.kr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Lc(t).di({index:eh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},kc.prototype.Mr=function(d,y,v,g){var m=this,w=Cc(d),b=Lc(d);return b.add({}).next(function(t){Vr("number"==typeof t);for(var e,n,r,i,o,s=new va(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return cs(e.Cr,t)}),o=r.mutations.map(function(t){return cs(e.Cr,t)}),new eh(n,r.batchId,r.Vn.toMillis(),i,o)),a=[],c=new Wi(function(t,e){return jr(t.et(),e.et())}),h=0,f=g;h<f.length;h++){var l=f[h],p=nh.key(m.userId,l.key.path,t),c=c.add(l.key.path.G());a.push(b.put(u)),a.push(w.put(p,nh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.us.$r(d,t))}),d.ss(function(){m.Fr[t]=s.keys()}),wa.Qn(a).next(function(){return s})})},kc.prototype.Lr=function(t,e){var n=this;return Lc(t).get(e).next(function(t){return t?(Vr(t.userId===n.userId),Nc(n.serializer,t)):null})},kc.prototype.Br=function(t,e){var n=this;return this.Fr[e]?wa.resolve(this.Fr[e]):this.Lr(t,e).next(function(t){if(t){t=t.keys();return n.Fr[e]=t}return null})},kc.prototype.qr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Lc(t).di({index:eh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Vr(e.batchId>=i),o=Nc(r.serializer,e)),n.done()}).next(function(){return o})},kc.prototype.Ur=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Lc(t).di({index:eh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},kc.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Lc(t).hi(eh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Nc(e.serializer,t)})})},kc.prototype.ls=function(o,s){var u=this,t=nh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Cc(o).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=mc(i);if(r===u.userId&&s.path.isEqual(i))return Lc(o).get(t).next(function(t){if(!t)throw Cr();Vr(t.userId===u.userId),a.push(Nc(u.serializer,t))});n.done()}).next(function(){return a})},kc.prototype.Es=function(e,t){var s=this,u=new Wi(jr),n=[];return t.forEach(function(o){var t=nh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Cc(e).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=mc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),wa.Qn(n).next(function(){return s.Kr(e,u)})},kc.prototype.ys=function(t,e){var o=this,s=e.path,u=s.length+1,e=nh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Wi(jr);return Cc(t).di({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=mc(i);r===o.userId&&s.X(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Kr(t,a)})},kc.prototype.Kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Lc(e).get(t).next(function(t){if(null===t)throw Cr();Vr(t.userId===n.userId),r.push(Nc(n.serializer,t))}))}),wa.Qn(i).next(function(){return r})},kc.prototype.Wr=function(e,n){var r=this;return Rc(e.jr,this.userId,n).next(function(t){return e.ss(function(){r.Gr(n.batchId)}),wa.forEach(t,function(t){return r.Nr.zr(e,t)})})},kc.prototype.Gr=function(t){delete this.Fr[t]},kc.prototype.Hr=function(e){var i=this;return this.kr(e).next(function(t){if(!t)return wa.resolve();var t=IDBKeyRange.lowerBound(nh.prefixForUser(i.userId)),r=[];return Cc(e).di({range:t},function(t,e,n){t[0]===i.userId?(t=mc(t[1]),r.push(t)):n.done()}).next(function(){Vr(0===r.length)})})},kc.prototype.Jr=function(t,e){return Pc(t,this.userId,e)},kc.prototype.Yr=function(t){var e=this;return Vc(t).get(this.userId).next(function(t){return t||new th(e.userId,-1,"")})},kc);function kc(t,e,n,r){this.userId=t,this.serializer=e,this.us=n,this.Nr=r,this.Fr={}}function Pc(t,o,e){var e=nh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Cc(t).di({range:e,fi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Rc(t,e,n){var r=t.store(eh.store),i=t.store(nh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.di({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Vr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=nh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return wa.Qn(o).next(function(){return u})}function Lc(t){return Lh.Zs(t,eh.store)}function Cc(t){return Lh.Zs(t,nh.store)}function Vc(t){return Lh.Zs(t,th.store)}var Mc,Uc=(Fc.prototype.zn=function(t,e,n){return zc(t).put(Gc(e),n)},Fc.prototype.Yn=function(t,e){t=zc(t),e=Gc(e);return t.delete(e)},Fc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Xr(e,t)})},Fc.prototype.Xn=function(t,e){var n=this;return zc(t).get(Gc(e)).next(function(t){return n.Zr(t)})},Fc.prototype.eo=function(t,e){var n=this;return zc(t).get(Gc(e)).next(function(t){var e=n.Zr(t);return e?{Jn:e,size:Kc(t)}:null})},Fc.prototype.getEntries=function(t,e){var n=this,r=Xi;return this.no(t,e,function(t,e){e=n.Zr(e);r=r.At(t,e)}).next(function(){return r})},Fc.prototype.so=function(t,e){var r=this,i=Xi,o=new qi(yi.K);return this.no(t,e,function(t,e){var n=r.Zr(e);o=n?(i=i.At(t,n),o.At(t,Kc(e))):(i=i.At(t,null),o.At(t,0))}).next(function(){return{io:i,ro:o}})},Fc.prototype.no=function(t,e,i){if(e.Y())return wa.resolve();var n=IDBKeyRange.bound(e.first().path.tt(),e.last().path.tt()),o=e.bt(),s=o.Nt();return zc(t).di({range:n},function(t,e,n){for(var r=yi._t(t);s&&yi.K(s,r)<0;)i(s,null),s=o.Nt();s&&s.isEqual(r)&&(i(s,e),s=o.Ft()?o.Nt():null),s?n.ai(s.path.tt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Ft()?o.Nt():null})},Fc.prototype.Ts=function(t,r,e){var n,i=this,o=Ji,s=r.path.length+1,u={};return e.isEqual(fi.min())?(n=r.path.tt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.tt(),e=Ic(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=sh.collectionReadTimeIndex),zc(t).di(u,function(t,e,n){t.length===s&&(e=bc(i.serializer,e),r.path.X(e.key.path)?e instanceof mu&&Uu(r,e)&&(o=o.At(e.key,e)):n.done())}).next(function(){return o})},Fc.prototype.oo=function(t){return new jc(this,!!t&&t.co)},Fc.prototype.ao=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Fc.prototype.getMetadata=function(t){return Bc(t).get(uh.key).next(function(t){return Vr(!!t),t})},Fc.prototype.Xr=function(t,e){return Bc(t).put(uh.key,e)},Fc.prototype.Zr=function(t){if(t){t=bc(this.serializer,t);return t instanceof wu&&t.version.isEqual(fi.min())?null:t}return null},Fc),jc=(h(qc,Mc=o),qc.prototype.es=function(i){var o=this,s=[],u=0,a=new Wi(function(t,e){return jr(t.et(),e.et())});return this.Wn.forEach(function(t,e){var n,r=o.ho.get(t);e.Jn?(n=Ec(o.uo.serializer,e.Jn,o.Gn(t)),a=a.add(t.path.G()),e=Kc(n),u+=e-r,s.push(o.uo.zn(i,t,n))):(u-=r,o.co?(r=Ec(o.uo.serializer,new wu(t,fi.min()),o.Gn(t)),s.push(o.uo.zn(i,t,r))):s.push(o.uo.Yn(i,t)))}),a.forEach(function(t){s.push(o.uo.us.$r(i,t))}),s.push(this.uo.updateMetadata(i,u)),wa.Qn(s)},qc.prototype.Zn=function(t,e){var n=this;return this.uo.eo(t,e).next(function(t){return null===t?(n.ho.set(e,0),null):(n.ho.set(e,t.size),t.Jn)})},qc.prototype.ts=function(t,e){var n=this;return this.uo.so(t,e).next(function(t){var e=t.io;return t.ro.forEach(function(t,e){n.ho.set(t,e)}),e})},qc);function qc(t,e){var n=this;return(n=Mc.call(this)||this).uo=t,n.co=e,n.ho=new ma(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Fc(t,e){this.serializer=t,this.us=e}function Bc(t){return Lh.Zs(t,uh.store)}function zc(t){return Lh.Zs(t,sh.store)}function Gc(t){return t.path.tt()}function Kc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}var Hc=($c.prototype.$r=function(t,e){return this.lo.add(e),wa.resolve()},$c.prototype.Ps=function(t,e){return wa.resolve(this.lo.getEntries(e))},$c),Wc=(Jc.prototype.add=function(t){var e=t.J(),n=t.G(),r=this.index[e]||new Wi(li.K),t=!r.has(n);return this.index[e]=r.add(n),t},Jc.prototype.has=function(t){var e=t.J(),t=t.G(),e=this.index[e];return e&&e.has(t)},Jc.prototype.getEntries=function(t){return(this.index[t]||new Wi(li.K)).tt()},Jc),Yc=(Qc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Vr(t<r&&0<=t&&r<=11);var o=new Ga("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Zc.store),(s=e).createObjectStore(th.store,{keyPath:th.keyPath}),s.createObjectStore(eh.store,{keyPath:eh.keyPath,autoIncrement:!0}).createIndex(eh.userMutationsIndex,eh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(nh.store),lh(e),e.createObjectStore(sh.store));var s,u=wa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(ch.store),s.deleteObjectStore(ah.store),s.deleteObjectStore(hh.store),lh(e)),u=u.next(function(){return t=o.store(hh.store),e=new hh(0,0,fi.min().q(),0),t.put(hh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(eh.store).hi().next(function(t){n.deleteObjectStore(eh.store),n.createObjectStore(eh.store,{keyPath:eh.keyPath,autoIncrement:!0}).createIndex(eh.userMutationsIndex,eh.userMutationsKeyPath,{unique:!0});var e=r.store(eh.store),t=t.map(function(t){return e.put(t)});return wa.Qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(ph.store,{keyPath:ph.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(uh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(sh.store)).createIndex(sh.readTimeIndex,sh.readTimeIndexPath,{unique:!1}),t.createIndex(sh.collectionReadTimeIndex,sh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(dh.store,{keyPath:dh.keyPath}),e.createObjectStore(yh.store,{keyPath:yh.keyPath})})),u},Qc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(sh.store).di(function(t,e){n+=Kc(e)}).next(function(){var t=new uh(n);return e.store(uh.store).put(uh.key,t)})},Qc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(th.store),i=n.store(eh.store);return t.hi().next(function(t){return wa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.hi(eh.userMutationsIndex,t).next(function(t){return wa.forEach(t,function(t){Vr(t.userId===e.userId);t=Nc(r.serializer,t);return Rc(n,e.userId,t).next(function(){})})})})})},Qc.prototype.ensureSequenceNumbers=function(t){var o=t.store(ch.store),e=t.store(sh.store);return t.store(hh.store).get(hh.key).next(function(r){var i=[];return e.di(function(t,e){var n=new li(t),t=[0,vc(n)];i.push(o.get(t).next(function(t){return t?wa.resolve():o.put(new ch(0,vc(n),r.highestListenSequenceNumber))}))}).next(function(){return wa.Qn(i)})})},Qc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(fh.store,{keyPath:fh.keyPath});function r(t){if(i.add(t)){var e=t.J(),t=t.G();return n.put({collectionId:e,parent:vc(t)})}}var n=e.store(fh.store),i=new Wc;return e.store(sh.store).di({fi:!0},function(t,e){t=new li(t);return r(t.G())}).next(function(){return e.store(nh.store).di({fi:!0},function(t,e){t[0];var n=t[1],n=(t[2],mc(n));return r(n.G())})})},Qc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(ah.store);return r.di(function(t,e){e=xc(e),e=Sc(n.serializer,e);return r.put(e)})},Qc),Xc=function(t,e){this.seconds=t,this.nanoseconds=e},Zc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Qc(t){this.serializer=t}function Jc(){this.index={}}function $c(){this.lo=new Wc}Zc.store="owner",Zc.key="owner";var th=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};th.store="mutationQueues",th.keyPath="userId";var eh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};eh.store="mutations",eh.keyPath="batchId",eh.userMutationsIndex="userMutationsIndex",eh.userMutationsKeyPath=["userId","batchId"];var nh=(rh.prefixForUser=function(t){return[t]},rh.prefixForPath=function(t,e){return[t,vc(e)]},rh.key=function(t,e,n){return[t,vc(e),n]},rh);function rh(){}nh.store="documentMutations",nh.PLACEHOLDER=new nh;var ih=function(t,e){this.path=t,this.readTime=e},oh=function(t,e){this.path=t,this.version=e},sh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};sh.store="remoteDocuments",sh.readTimeIndex="readTimeIndex",sh.readTimeIndexPath="readTime",sh.collectionReadTimeIndex="collectionReadTimeIndex",sh.collectionReadTimeIndexPath=["parentPath","readTime"];var uh=function(t){this.byteSize=t};uh.store="remoteDocumentGlobal",uh.key="remoteDocumentGlobalKey";var ah=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ah.store="targets",ah.keyPath="targetId",ah.queryTargetsIndexName="queryTargetsIndex",ah.queryTargetsKeyPath=["canonicalId","targetId"];var ch=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ch.store="targetDocuments",ch.keyPath=["targetId","path"],ch.documentTargetsIndex="documentTargetsIndex",ch.documentTargetsKeyPath=["path","targetId"];var hh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};hh.key="targetGlobalKey",hh.store="targetGlobal";var fh=function(t,e){this.collectionId=t,this.parent=e};function lh(t){t.createObjectStore(ch.store,{keyPath:ch.keyPath}).createIndex(ch.documentTargetsIndex,ch.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ah.store,{keyPath:ah.keyPath}).createIndex(ah.queryTargetsIndexName,ah.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(hh.store)}fh.store="collectionParents",fh.keyPath=["collectionId","parent"];var ph=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ph.store="clientMetadata",ph.keyPath="clientId";var dh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};dh.store="bundles",dh.keyPath="bundleId";var yh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};yh.store="namedQueries",yh.keyPath="name";var vh=f(f(f(f([th.store,eh.store,nh.store,sh.store,ah.store,Zc.store,hh.store,ch.store],[ph.store]),[uh.store]),[fh.store]),[dh.store,yh.store]),gh=(mh.prototype._o=function(t,e){return wh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:Ac(t.createTime),version:t.version}})},mh.prototype.fo=function(t,e){return wh(t).put({bundleId:(e=e).id,createTime:_c(Jo(e.createTime)),version:e.version})},mh.prototype.wo=function(t,e){return bh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Dc(t.bundledQuery),readTime:Ac(t.readTime)}})},mh.prototype.Eo=function(t,e){return bh(t).put({name:(e=e).name,readTime:_c(Jo(e.readTime)),bundledQuery:e.bundledQuery})},mh);function mh(t){this.serializer=t}function wh(t){return Lh.Zs(t,dh.store)}function bh(t){return Lh.Zs(t,yh.store)}var Eh=(Ih.prototype.$r=function(t,e){var n=this;if(this.To.has(e))return wa.resolve();var r=e.J(),i=e.G();t.ss(function(){n.To.add(e)});i={collectionId:r,parent:vc(i)};return Th(t).put(i)},Ih.prototype.Ps=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Fr(i),""],!1,!0);return Th(t).hi(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(mc(r.parent))}return o})},Ih);function Ih(){this.To=new Wc}function Th(t){return Lh.Zs(t,fh.store)}var _h=(xh.prototype.next=function(){return this.mo+=2,this.mo},xh.Io=function(){return new xh(0)},xh.Ao=function(){return new xh(-1)},xh),Ah=(Nh.prototype.Ro=function(n){var r=this;return this.Po(n).next(function(t){var e=new _h(t.highestTargetId);return t.highestTargetId=e.next(),r.yo(n,t).next(function(){return t.highestTargetId})})},Nh.prototype.Vo=function(t){return this.Po(t).next(function(t){return fi.L(new hi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Nh.prototype.po=function(t){return this.Po(t).next(function(t){return t.highestListenSequenceNumber})},Nh.prototype.bo=function(e,n,r){var i=this;return this.Po(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.q()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.yo(e,t)})},Nh.prototype.vo=function(e,n){var r=this;return this.So(e,n).next(function(){return r.Po(e).next(function(t){return t.targetCount+=1,r.Do(n,t),r.yo(e,t)})})},Nh.prototype.Co=function(t,e){return this.So(t,e)},Nh.prototype.xo=function(e,t){var n=this;return this.No(e,t.targetId).next(function(){return Sh(e).delete(t.targetId)}).next(function(){return n.Po(e)}).next(function(t){return Vr(0<t.targetCount),--t.targetCount,n.yo(e,t)})},Nh.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return Sh(n).di(function(t,e){e=xc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.xo(n,e)))}).next(function(){return wa.Qn(u)}).next(function(){return s})},Nh.prototype.Ke=function(t,n){return Sh(t).di(function(t,e){e=xc(e);n(e)})},Nh.prototype.Po=function(t){return Dh(t).get(hh.key).next(function(t){return Vr(null!==t),t})},Nh.prototype.yo=function(t,e){return Dh(t).put(hh.key,e)},Nh.prototype.So=function(t,e){return Sh(t).put(Sc(this.serializer,e))},Nh.prototype.Do=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Nh.prototype.Fo=function(t){return this.Po(t).next(function(t){return t.targetCount})},Nh.prototype.Oo=function(t,r){var e=ki(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Sh(t).di({range:e,index:ah.queryTargetsIndexName},function(t,e,n){e=xc(e);Pi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Nh.prototype.ko=function(n,t,r){var i=this,o=[],s=Oh(n);return t.forEach(function(t){var e=vc(t.path);o.push(s.put(new ch(r,e))),o.push(i.Nr.Mo(n,r,t))}),wa.Qn(o)},Nh.prototype.$o=function(n,t,r){var i=this,o=Oh(n);return wa.forEach(t,function(t){var e=vc(t.path);return wa.Qn([o.delete([r,e]),i.Nr.Lo(n,r,t)])})},Nh.prototype.No=function(t,e){t=Oh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Nh.prototype.Bo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Oh(t),r=eo();return t.di({range:e,fi:!0},function(t,e,n){t=mc(t[1]),t=new yi(t);r=r.add(t)}).next(function(){return r})},Nh.prototype.Jr=function(t,e){var e=vc(e.path),e=IDBKeyRange.bound([e],[Fr(e)],!1,!0),i=0;return Oh(t).di({index:ch.documentTargetsIndex,fi:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Nh.prototype.en=function(t,e){return Sh(t).get(e).next(function(t){return t?xc(t):null})},Nh);function Nh(t,e){this.Nr=t,this.serializer=e}function xh(t){this.mo=t}function Sh(t){return Lh.Zs(t,ah.store)}function Dh(t){return Lh.Zs(t,hh.store)}function Oh(t){return Lh.Zs(t,ch.store)}var kh,Ph="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Rh=(h(Vh,kh=Ie),Vh),Lh=(Ch.Zs=function(t,e){if(t instanceof Rh)return Va.Zs(t.jr,e);throw Cr()},Ch.prototype.start=function(){var e=this;return this.nc().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Ph);return e.sc(),e.ic(),e.rc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Zo.po(t)})}).then(function(t){e.Ko=new Ta(t,e.Uo)}).then(function(){e.Wo=!0}).catch(function(t){return e.Xo&&e.Xo.close(),Promise.reject(t)})},Ch.prototype.oc=function(n){var t=this;return this.Jo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.dr?[2,n(e)]:[2]})})},n(this.isPrimary)},Ch.prototype.cc=function(n){var t=this;this.Xo.ni(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ch.prototype.ac=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ns.yi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.dr?[4,this.nc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ch.prototype.nc=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Uh(e).put(new ph(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.uc(e).next(function(t){t||(n.isPrimary=!1,n.Ns.$i(function(){return n.Jo(!1)}))})}).next(function(){return n.hc(e)}).next(function(t){return n.isPrimary&&!t?n.lc(e).next(function(){return!1}):!!t&&n._c(e).next(function(){return!0})})}).catch(function(t){if(za(t))return kr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ns.$i(function(){return n.Jo(t)}),n.isPrimary=t})},Ch.prototype.uc=function(t){var e=this;return Mh(t).get(Zc.key).next(function(t){return wa.resolve(e.fc(t))})},Ch.prototype.dc=function(t){return Uh(t).delete(this.clientId)},Ch.prototype.wc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ec(this.Ho,18e5)?[3,2]:(this.Ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ch.Zs(t,ph.store);return r.hi().next(function(t){var e=o.Tc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return wa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ec)for(n=0,r=e;n<r.length;n++)i=r[n],this.ec.removeItem(this.mc(i.clientId));t.label=2;case 2:return[2]}})})},Ch.prototype.rc=function(){var t=this;this.zo=this.Ns.Ks("client_metadata_refresh",4e3,function(){return t.nc().then(function(){return t.wc()}).then(function(){return t.rc()})})},Ch.prototype.fc=function(t){return!!t&&t.ownerId===this.clientId},Ch.prototype.hc=function(e){var r=this;return this.Qo?wa.resolve(!0):Mh(e).get(Zc.key).next(function(t){if(null!==t&&r.Ec(t.leaseTimestampMs,5e3)&&!r.Ic(t.ownerId)){if(r.fc(t)&&r.networkEnabled)return!0;if(!r.fc(t)){if(!t.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Ph);return!1}}return!(!r.networkEnabled||!r.inForeground)||Uh(e).hi().next(function(t){return void 0===r.Tc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ch.prototype.Ac=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Wo=!1,this.Rc(),this.zo&&(this.zo.cancel(),this.zo=null),this.Pc(),this.yc(),[4,this.Xo.runTransaction("shutdown","readwrite",[Zc.store,ph.store],function(t){var e=new Rh(t,Ta.xs);return n.lc(e).next(function(){return n.dc(e)})})];case 1:return t.sent(),this.Xo.close(),this.gc(),[2]}})})},Ch.prototype.Tc=function(t,e){var n=this;return t.filter(function(t){return n.Ec(t.updateTimeMs,e)&&!n.Ic(t.clientId)})},Ch.prototype.Vc=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Uh(t).hi().next(function(t){return e.Tc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ch.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Ch.prototype.bc=function(t){return Oc.Or(t,this.serializer,this.us,this.Nr)},Ch.prototype.vc=function(){return this.Zo},Ch.prototype.Sc=function(){return this.os},Ch.prototype.Dc=function(){return this.us},Ch.prototype.Cc=function(){return this.tc},Ch.prototype.runTransaction=function(e,n,r){var i=this;kr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Xo.runTransaction(e,t,vh,function(t){return o=new Rh(t,i.Ko?i.Ko.next():Ta.xs),"readwrite-primary"===n?i.uc(o).next(function(t){return!!t||i.hc(o)}).next(function(t){if(!t)throw Pr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ns.$i(function(){return i.Jo(!1)}),new Nr(Ar.FAILED_PRECONDITION,ba);return r(o)}).next(function(t){return i._c(o).next(function(){return t})}):i.xc(o).next(function(){return r(o)})}).then(function(t){return o.rs(),t})},Ch.prototype.xc=function(t){var e=this;return Mh(t).get(Zc.key).next(function(t){if(null!==t&&e.Ec(t.leaseTimestampMs,5e3)&&!e.Ic(t.ownerId)&&!e.fc(t)&&!(e.Qo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Nr(Ar.FAILED_PRECONDITION,Ph)})},Ch.prototype._c=function(t){var e=new Zc(this.clientId,this.allowTabSynchronization,Date.now());return Mh(t).put(Zc.key,e)},Ch.Hs=function(){return Va.Hs()},Ch.prototype.lc=function(t){var e=this,n=Mh(t);return n.get(Zc.key).next(function(t){return e.fc(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(Zc.key)):wa.resolve()})},Ch.prototype.Ec=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Pr("Detected an update time that is in the future: "+t+" > "+n),1))},Ch.prototype.sc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Go=function(){t.Ns.yi(function(){return t.inForeground="visible"===t.document.visibilityState,t.nc()})},this.document.addEventListener("visibilitychange",this.Go),this.inForeground="visible"===this.document.visibilityState)},Ch.prototype.Pc=function(){this.Go&&(this.document.removeEventListener("visibilitychange",this.Go),this.Go=null)},Ch.prototype.ic=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.jo=function(){e.Rc(),e.Ns.yi(function(){return e.Ac()})},this.window.addEventListener("unload",this.jo))},Ch.prototype.yc=function(){this.jo&&(this.window.removeEventListener("unload",this.jo),this.jo=null)},Ch.prototype.Ic=function(t){try{var e=null!==(null===(e=this.ec)||void 0===e?void 0:e.getItem(this.mc(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Pr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ch.prototype.Rc=function(){if(this.ec)try{this.ec.setItem(this.mc(this.clientId),String(Date.now()))}catch(t){Pr("Failed to set zombie client id.",t)}},Ch.prototype.gc=function(){if(this.ec)try{this.ec.removeItem(this.mc(this.clientId))}catch(t){}},Ch.prototype.mc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ch);function Ch(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ns=i,this.window=o,this.document=s,this.Uo=a,this.Qo=c,this.Ko=null,this.Wo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.jo=null,this.inForeground=!1,this.Go=null,this.zo=null,this.Ho=Number.NEGATIVE_INFINITY,this.Jo=function(t){return Promise.resolve()},!Ch.Hs())throw new Nr(Ar.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Nr=new jh(this,r),this.Yo=e+"main",this.serializer=new wc(u),this.Xo=new Va(this.Yo,11,new Yc(this.serializer)),this.Zo=new Ah(this.Nr,this.serializer),this.us=new Eh,this.os=(e=this.serializer,u=this.us,new Uc(e,u)),this.tc=new gh(this.serializer),this.window&&this.window.localStorage?this.ec=this.window.localStorage:(this.ec=null,!1===c&&Pr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Vh(t,e){var n=this;return(n=kh.call(this)||this).jr=t,n.qo=e,n}function Mh(t){return Lh.Zs(t,Zc.store)}function Uh(t){return Lh.Zs(t,ph.store)}var jh=(qh.prototype.mr=function(t){var n=this.Nc(t);return this.db.vc().Fo(t).next(function(e){return n.next(function(t){return e+t})})},qh.prototype.Nc=function(t){var e=0;return this.Ar(t,function(t){e++}).next(function(){return e})},qh.prototype.Ke=function(t,e){return this.db.vc().Ke(t,e)},qh.prototype.Ar=function(t,n){return this.Fc(t,function(t,e){return n(e)})},qh.prototype.Mo=function(t,e,n){return Fh(t,n)},qh.prototype.Lo=function(t,e,n){return Fh(t,n)},qh.prototype.Rr=function(t,e,n){return this.db.vc().Rr(t,e,n)},qh.prototype.zr=Fh,qh.prototype.Oc=function(t,e){return r=e,i=!1,Vc(n=t).wi(function(t){return Pc(n,t,r).next(function(t){return t&&(i=!0),wa.resolve(!t)})}).next(function(){return i});var n,r,i},qh.prototype.Pr=function(n,r){var i=this,o=this.db.Sc().oo(),s=[],u=0;return this.Fc(n,function(e,t){t<=r&&(t=i.Oc(n,e).next(function(t){if(!t)return u++,o.Xn(n,e).next(function(){return o.Yn(e),Oh(n).delete([0,vc(e.path)])})}),s.push(t))}).next(function(){return wa.Qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},qh.prototype.removeTarget=function(t,e){e=e.Et(t.qo);return this.db.vc().Co(t,e)},qh.prototype.kc=Fh,qh.prototype.Fc=function(t,r){var i,t=Oh(t),o=Ta.xs;return t.di({index:ch.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ta.xs&&r(new yi(mc(i)),o),o=e,i=t):o=Ta.xs}).next(function(){o!==Ta.xs&&r(new yi(mc(i)),o)})},qh.prototype.gr=function(t){return this.db.Sc().ao(t)},qh);function qh(t,e){this.db=t,this.ur=new fc(this,e)}function Fh(t,e){return Oh(t).put((t=t.qo,new ch(0,vc(e.path),t)))}function Bh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function zh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Gh(t,e){if(t instanceof Uint8Array)return zh(t,e);if(t instanceof ArrayBuffer)return zh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Kh(t){return new Ho(t,!0)}var Hh=(Qh.prototype.Mc=function(){return"metadata"in this.payload},Qh),Wh=(Zh.qc=function(t,e){return new Zh(Gh(t,10240),e)},Zh.prototype.close=function(){return this.$c.cancel()},Zh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Zh.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Bc())]}})})},Zh.prototype.Bc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Lc.decode(e),n=Number(r),isNaN(n)&&this.Kc("length string ("+r+") is not valid number"),[4,this.Wc(n)]);case 2:return r=t.sent(),[2,new Hh(JSON.parse(r),e.length+n)]}})})},Zh.prototype.jc=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Zh.prototype.Qc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.jc()<0?[4,this.Gc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.jc())<0&&this.Kc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Zh.prototype.Wc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Gc()]:[3,3];case 1:t.sent()&&this.Kc("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Lc.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Zh.prototype.Kc=function(t){throw this.$c.cancel(),new Error("Invalid bundle format: "+t)},Zh.prototype.Gc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.$c.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Zh),Yh=(Xh.prototype.zc=function(t){return ns(this.serializer,t)},Xh.prototype.Hc=function(t){return t.metadata.exists?as(this.serializer,t.document,!1):new wu(this.zc(t.metadata.name),this.Jc(t.metadata.readTime))},Xh.prototype.Jc=Jo,Xh);function Xh(t){this.serializer=t}function Zh(t,e){var n=this;this.$c=t,this.serializer=e,this.metadata=new La,this.buffer=new Uint8Array,this.Lc=new TextDecoder("utf-8"),this.Bc().then(function(t){t&&t.Mc()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Qh(t,e){this.payload=t,this.byteLength=e}function Jh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function $h(t,e){this.progress=t,this.Yc=e}var tf=(rf.prototype.ta=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},rf.prototype.ea=function(t){for(var e=new Map,n=new Yh(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.zc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||eo()).add(s);e.set(c,h)}}return e},rf.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:for(e=new Yh((n=l).serializer),r=eo(),i=Xi,o=$i,s=0,u=p;s<u.length;s++)a=u[s],c=e.zc(a.metadata.name),a.document&&(r=r.add(c)),i=i.At(c,e.Hc(a)),o=o.At(c,e.Jc(a.metadata.readTime));return h=n.na.oo({co:!0}),[4,ff(n,Ru(Nu(li.nt("__bundle__/docs/"+d))))];case 1:return f=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return hf(e,h,i,fi.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Zo.No(e,f.targetId).next(function(){return n.Zo.ko(e,r,f.targetId)}).next(function(){return n.sa.ws(e,t)})})})]}})})}(this.Zc,this.documents,this.Xc.id)];case 1:e=t.sent(),n=this.ea(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=eo()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,ff(e,Ru(Dc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Jo(i.readTime);if(0<=n.wt.u(e))return r.tc.Eo(t,i);e=n.Tt(Br.h,e);return r.ra=r.ra.At(e.targetId,e),r.Zo.Co(t,e).next(function(){return r.Zo.No(t,n.targetId)}).next(function(){return r.Zo.ko(t,o,n.targetId)}).next(function(){return r.tc.Eo(t,i)})})]}})})}(this.Zc,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new $h(Object.assign({},this.progress),e))]}})})},rf),ef=(nf.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.yr(t,n.ra)})},nf);function nf(t,e,n,r){this.persistence=t,this.ia=e,this.serializer=r,this.ra=new qi(jr),this.oa=new ma(ki,Pi),this.ca=fi.min(),this.cs=t.bc(n),this.na=t.Sc(),this.Zo=t.vc(),this.sa=new Ea(this.na,this.cs,this.persistence.Dc()),this.tc=t.Cc(),this.ia.pr(this.sa)}function rf(t,e,n){this.Xc=t,this.Zc=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=Jh(t)}function of(t,e,n,r){return new ef(t,e,n,r)}function sf(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).cs,m=e.sa,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.cs.Qr(v).next(function(t){return g=t,n=e.persistence.bc(o),m=new Ea(e.na,n,e.persistence.Dc()),n.Qr(v)}).next(function(t){for(var e=[],n=[],r=eo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.ds(v,r).next(function(t){return{aa:t,ua:e,ha:n}})})})];case 1:return r=t.sent(),[2,(e.cs=n,e.sa=m,e.ia.pr(e.sa),r)]}})})}function uf(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.na.oo({co:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=wa.resolve(),n.forEach(function(n){u=u.next(function(){return o.Xn(r,n)}).next(function(t){var e=t,t=i.Cn.get(n);Vr(null!==t),(!e||e.version.u(t)<0)&&(e=s.pn(n,e,i))&&o.zn(e,i.Dn)})}),u.next(function(){return e.cs.Wr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.cs.Hr(t)}).next(function(){return f.sa.ds(t,a)})})}function af(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zo.Vo(t)})}function cf(t,r){var a=t,c=r.wt,h=a.ra;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.na.oo({co:!0});h=a.ra;var u=[];r.ce.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Zo.$o(s,t.Ee,e).next(function(){return a.Zo.ko(s,t.de,e)})),0<(i=t.resumeToken).o()&&(n=o.Tt(i,c).Et(s.qo),h=h.At(e,n),r=o,i=t,Vr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.wt.B()-r.wt.B()||0<i.de.size+i.we.size+i.Ee.size)&&u.push(a.Zo.Co(s,n))))});var e,n=Xi;return r.ue.forEach(function(t,e){r.he.has(t)&&u.push(a.persistence.Nr.kc(s,t))}),u.push(hf(s,t,r.ue,c,void 0).next(function(t){n=t})),c.isEqual(fi.min())||(e=a.Zo.Vo(s).next(function(t){return a.Zo.bo(s,s.qo,c)}),u.push(e)),wa.Qn(u).next(function(){return t.apply(s)}).next(function(){return a.sa.ws(s,n)})}).then(function(t){return a.ra=h,t})}function hf(t,s,e,u,a){var n=eo();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Xi;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof wu&&e.version.isEqual(fi.min())?(s.Yn(t,r),o=o.At(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.zn(e,r),o=o.At(t,e)):kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function ff(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zo.Oo(e,r).next(function(t){return t?(n=t,wa.resolve(n)):i.Zo.Ro(e).next(function(t){return n=new Vi(r,t,0,e.qo),i.Zo.vo(e,n).next(function(){return n})})})}).then(function(t){var e=i.ra.get(t.targetId);return(null===e||0<t.wt.u(e.wt))&&(i.ra=i.ra.At(t.targetId,t),i.oa.set(r,t.targetId)),t})}function lf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ra.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Nr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!za(r=t.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ra=e.ra.remove(o),e.oa.delete(n.target),[2]}})})}function pf(t,o,s){var u=t,a=fi.min(),c=eo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Ru(o),(void 0!==(t=(i=t).oa.get(r))?wa.resolve(i.ra.get(t)):i.Zo.Oo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zo.Bo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ia.Ts(e,o,s?a:fi.min(),s?c:eo())}).next(function(t){return{documents:t,la:c}});var t,n,r,i})}function df(t,e){var n=t,r=n.Zo,t=n.ra.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.en(t,e).next(function(t){return t?t.target:null})})}function yf(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.na,n=t,t=s.ca,r=e,i=Xi,o=Ic(t),t=zc(n),n=IDBKeyRange.lowerBound(o,!0),t.di({index:sh.readTimeIndex,range:n},function(t,e){var n=bc(r.serializer,e);i=i.At(n.key,n),o=e.readTime}).next(function(){return{Yc:i,readTime:Tc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Yc,t=t.readTime;return s.ca=t,e})}function vf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=zc(t),r=fi.min(),t.di({index:sh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Tc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.ca=t})]})})}function gf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ar.FAILED_PRECONDITION||e.message!==ba)throw e;return kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function mf(t,e,n,r,i){var o=this;this.Zc=t,this.eu=e,this.Ei=n,this.nu={},this.su=[],this.iu=new Map,this.ru=new Set,this.ou=[],this.cu=i,this.cu.au(function(t){n.yi(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return jf(this)?(kr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(4),[4,Pf(e)];case 1:return t.sent(),e.uu.set("Unknown"),e.ru.delete(4),[4,kf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.uu=new Af(n,r)}var wf,bf,Ef,Te=(Of.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},Of.prototype.ma=function(){return 2===this.state},Of.prototype.start=function(){3!==this.state?this.auth():this.Ia()},Of.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Of.prototype.Aa=function(){this.state=0,this.Ci.reset()},Of.prototype.Ra=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Ns.Ks(this._a,6e4,function(){return t.Pa()}))},Of.prototype.ya=function(t){this.ga(),this.stream.send(t)},Of.prototype.Pa=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Of.prototype.ga=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Of.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ga(),this.Ci.cancel(),this.wa++,3!==e?this.Ci.reset():n&&n.code===Ar.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Ci.qs()):n&&n.code===Ar.UNAUTHENTICATED&&this.da.v(),null!==this.stream&&(this.Va(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.pa(n)];case 1:return t.sent(),[2]}})})},Of.prototype.Va=function(){},Of.prototype.auth=function(){var n=this;this.state=1;var t=this.ba(this.wa),e=this.wa;this.da.getToken().then(function(t){n.wa===e&&n.va(t)},function(e){t(function(){var t=new Nr(Ar.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sa(t)})})},Of.prototype.va=function(t){var e=this,n=this.ba(this.wa);this.stream=this.Da(t),this.stream.Ca(function(){n(function(){return e.state=2,e.listener.Ca()})}),this.stream.pa(function(t){n(function(){return e.Sa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Of.prototype.Ia=function(){var t=this;this.state=4,this.Ci.Us(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Of.prototype.Sa=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Of.prototype.ba=function(e){var n=this;return function(t){n.Ns.yi(function(){return n.wa===e?t():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Of),If=(h(Df,Ef=Te),Df.prototype.Da=function(t){return this.fa.xa("Listen",t)},Df.prototype.onMessage=function(t){this.Ci.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.nn?(Vr(void 0===s||"string"==typeof s),Br.fromBase64String(s||"")):(Vr(void 0===s||s instanceof Uint8Array),Br.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Ar.UNKNOWN:ji(c.code),new Nr(a,c.message||"")),s=new ho(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=ns(t,n.document.name),i=Jo(n.document.updateTime);var u=new cu({mapValue:{fields:n.document.fields}}),a=(o=new mu(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new ao(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=ns(t,n.document),i=n.readTime?Jo(n.readTime):fi.min(),u=new wu(r,i),o=n.removedTargetIds||[],s=new ao([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=ns(t,n.document),i=n.removedTargetIds||[],s=new ao([],i,r,null);else{if(!("filter"in e))return Cr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Li(n),i=e.targetId,s=new co(i,r)}return s}(this.serializer,t),t=function(t){if(!("targetChange"in t))return fi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Jo(t.readTime):fi.min()}(t);return this.listener.Na(e,t)},Df.prototype.Fa=function(t){var e,n,r,i={};i.database=os(this.serializer),i.addTarget=(e=this.serializer,(r=Ri(r=(n=t).target)?{documents:fs(e,r)}:{query:ls(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Qo(e,n.resumeToken):0<n.wt.u(fi.min())&&(r.readTime=Zo(e,n.wt.q())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.dt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ya(i)},Df.prototype.Oa=function(t){var e={};e.database=os(this.serializer),e.removeTarget=t,this.ya(e)},Df),Tf=(h(Sf,bf=Te),Object.defineProperty(Sf.prototype,"Ma",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Sf.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,bf.prototype.start.call(this)},Sf.prototype.Va=function(){this.ka&&this.$a([])},Sf.prototype.Da=function(t){return this.fa.xa("Write",t)},Sf.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Ci.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Vr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Jo(t.updateTime):Jo(e);n.isEqual(fi.min())&&(n=Jo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new qs(n,e)}(t,r)})):[]),n=Jo(t.commitTime);return this.listener.La(n,e)}var n,r;return Vr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Ba()},Sf.prototype.qa=function(){var t={};t.database=os(this.serializer),this.ya(t)},Sf.prototype.$a=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return cs(e.serializer,t)})};this.ya(t)},Sf),_f=(h(xf,wf=function(){}),xf.prototype.Qa=function(){if(this.Ua)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},xf.prototype.Ka=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,r,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&i.credentials.v(),t})},xf.prototype.Wa=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Wa(e,n,r,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&i.credentials.v(),t})},xf.prototype.terminate=function(){this.Ua=!1},xf),Af=(Nf.prototype.Ja=function(){var t=this;0===this.Ga&&(this.Ya("Unknown"),this.za=this.Ei.Ks("online_state_timeout",1e4,function(){return t.za=null,t.Xa("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},Nf.prototype.Za=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ga++,1<=this.Ga&&(this.tu(),this.Xa("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},Nf.prototype.set=function(t){this.tu(),this.Ga=0,"Online"===t&&(this.Ha=!1),this.Ya(t)},Nf.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},Nf.prototype.Xa=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ha?(Pr(t),this.Ha=!1):kr("OnlineStateTracker",t)},Nf.prototype.tu=function(){null!==this.za&&(this.za.cancel(),this.za=null)},Nf);function Nf(t,e){this.Ei=t,this.ja=e,this.state="Unknown",this.Ga=0,this.za=null,this.Ha=!0}function xf(t,e,n){var r=this;return(r=wf.call(this)||this).credentials=t,r.fa=e,r.serializer=n,r.Ua=!1,r}function Sf(t,e,n,r,i){var o=this;return(o=bf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function Df(t,e,n,r,i){var o=this;return(o=Ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Of(t,e,n,r,i,o){this.Ns=t,this._a=n,this.fa=r,this.da=i,this.listener=o,this.state=0,this.wa=0,this.Ea=null,this.stream=null,this.Ci=new Ca(t,e)}function kf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!jf(r))return[3,4];e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Pf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Rf(t,e){t.iu.has(e.targetId)||(t.iu.set(e.targetId,e),Uf(t)?Mf(t):Yf(t).ma()&&Cf(t,e))}function Lf(t,e){var n=t,t=Yf(n);n.iu.delete(e),t.ma()&&Vf(n,e),0===n.iu.size&&(t.ma()?t.Ra():jf(n)&&n.uu.set("Unknown"))}function Cf(t,e){t.hu.xe(e.targetId),Yf(t).Fa(e)}function Vf(t,e){t.hu.xe(e),Yf(t).Oa(e)}function Mf(e){e.hu=new lo({tn:function(t){return e.nu.tn(t)},en:function(t){return e.iu.get(t)||null}}),Yf(e).start(),e.uu.Ja()}function Uf(t){return jf(t)&&!Yf(t).Ta()&&0<t.iu.size}function jf(t){return 0===t.ru.size}function qf(t){t.hu=void 0}function Ff(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.uu.set("Online"),!(u instanceof ho&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.iu.has(i)?[4,o.nu.lu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.iu.delete(i),o.hu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Bf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof ao?s.hu.Be(u):u instanceof co?s.hu.ze(u):s.hu.Qe(u),a.isEqual(fi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,af(s.Zc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).hu.Ye(i)).ce.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.iu.get(e))&&r.iu.set(e,n.Tt(t.resumeToken,i)))}),e.ae.forEach(function(t){var e=r.iu.get(t);e&&(r.iu.set(t,e.Tt(Br.h,e.wt)),Vf(r,t),e=new Vi(e.target,t,1,e.sequenceNumber),Cf(r,e))}),r.nu._u(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Bf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Bf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!za(r))throw r;return n.ru.add(1),[4,Pf(n)];case 1:return t.sent(),n.uu.set("Offline"),i=i||function(){return af(n.Zc)},n.Ei.$i(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ru.delete(1),[4,kf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function zf(e,n){return n().catch(function(t){return Bf(e,t,n)})}function Gf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Xf(i=a),s=0<i.su.length?i.su[i.su.length-1].batchId:-1,t.label=1;case 1:if(!(jf(i)&&i.su.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Zc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.cs.qr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.su.length&&o.Ra(),[3,7]):(s=u.batchId,function(t,e){t.su.push(e);t=Xf(t);t.ma()&&t.Ma&&t.$a(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Bf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Kf(i)&&Hf(i),[2]}var e,n,r})})}function Kf(t){return jf(t)&&!Xf(t).Ta()&&0<t.su.length}function Hf(t){Xf(t).start()}function Wf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ru.delete(2),[4,kf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ru.add(2),[4,Pf(e)]);case 3:t.sent(),e.uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Yf(n){var t,e,r,i=this;return n.wu||(n.wu=(t=n.eu,e=n.Ei,r={Ca:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.iu.forEach(function(t,e){Cf(n,t)}),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return qf(e),Uf(e)?(e.uu.Za(n),Mf(e)):e.uu.set("Unknown"),[2]})})}.bind(null,n),Na:Ff.bind(null,n)},t.Qa(),new If(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.wu.Aa(),Uf(n)?Mf(n):n.uu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.wu.stop()];case 2:t.sent(),qf(n),t.label=3;case 3:return[2]}})})})),n.wu}function Xf(n){var t,e,r,i=this;return n.Eu||(n.Eu=(t=n.eu,e=n.Ei,r={Ca:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Xf(e).qa(),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Xf(e).Ma?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ui(n=i.code)&&n!==Ar.ABORTED?(e=r.su.shift(),Xf(r).Aa(),[4,zf(r,function(){return r.nu.du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Gf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Kf(e)&&Hf(e),[2]}})})}.bind(null,n),Ba:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Xf(o),n=0,r=o.su;n<r.length;n++)i=r[n],e.$a(i.mutations);return[2]})})}.bind(null,n),La:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.su.shift(),n=ga.from(e,i,o),[4,zf(r,function(){return r.nu.fu(n)})];case 1:return t.sent(),[4,Gf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qa(),new Tf(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Eu.Aa(),[4,Gf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Eu.stop()];case 3:t.sent(),0<n.su.length&&(kr("RemoteStore","Stopping write stream with "+n.su.length+" pending writes"),n.su=[]),t.label=4;case 4:return[2]}})})})),n.Eu}function Zf(){this.queries=new ma(Vu,Cu),this.onlineState="Unknown",this.mu=new Set}var Qf=function(){this.Tu=void 0,this.listeners=[]};function Jf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Qf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Iu(n)];case 2:return o.Tu=t.sent(),[3,4];case 3:return o=t.sent(),o=rc(o,"Initialization of query '"+Mu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Au(e.onlineState),i.Tu&&u.Ru(i.Tu)&&tl(e),[2]}})})}function $f(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Pu(n))]:[2]})})}function tl(t){t.mu.forEach(function(t){t.next()})}var el=(sl.prototype.Ru=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new oo(t.query,t.docs,t.ne,e,t.se,t.fromCache,t.ie,!0)}var o=!1;return this.gu?this.pu(t)&&(this.yu.next(t),o=!0):this.bu(t,this.onlineState)&&(this.vu(t),o=!0),this.Vu=t,o},sl.prototype.onError=function(t){this.yu.error(t)},sl.prototype.Au=function(t){this.onlineState=t;var e=!1;return this.Vu&&!this.gu&&this.bu(this.Vu,t)&&(this.vu(this.Vu),e=!0),e},sl.prototype.bu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Su&&n||t.docs.Y()&&"Offline"!==e)},sl.prototype.pu=function(t){if(0<t.docChanges.length)return!0;var e=this.Vu&&this.Vu.hasPendingWrites!==t.hasPendingWrites;return!(!t.ie&&!e)&&!0===this.options.includeMetadataChanges},sl.prototype.vu=function(t){t=oo.oe(t.query,t.docs,t.se,t.fromCache),this.gu=!0,this.yu.next(t)},sl),nl=(ol.prototype.Y=function(){return this.Du.Y()},ol.prototype.Mo=function(t,e){e=new rl(t,e);this.Du=this.Du.add(e),this.xu=this.xu.add(e)},ol.prototype.Fu=function(t,e){var n=this;t.forEach(function(t){return n.Mo(t,e)})},ol.prototype.Lo=function(t,e){this.Ou(new rl(t,e))},ol.prototype.ku=function(t,e){var n=this;t.forEach(function(t){return n.Lo(t,e)})},ol.prototype.Mu=function(t){var e=this,n=new yi(new li([])),r=new rl(n,t),t=new rl(n,t+1),i=[];return this.xu.jt([r,t],function(t){e.Ou(t),i.push(t.key)}),i},ol.prototype.$u=function(){var e=this;this.Du.forEach(function(t){return e.Ou(t)})},ol.prototype.Ou=function(t){this.Du=this.Du.delete(t),this.xu=this.xu.delete(t)},ol.prototype.Lu=function(t){var e=new yi(new li([])),n=new rl(e,t),t=new rl(e,t+1),r=eo();return this.xu.jt([n,t],function(t){r=r.add(t.key)}),r},ol.prototype.Jr=function(t){var e=new rl(t,0),e=this.Du.zt(e);return null!==e&&t.isEqual(e.key)},ol),rl=(il.Cu=function(t,e){return yi.K(t.key,e.key)||jr(t.Bu,e.Bu)},il.Nu=function(t,e){return jr(t.Bu,e.Bu)||yi.K(t.key,e.key)},il);function il(t,e){this.key=t,this.Bu=e}function ol(){this.Du=new Wi(rl.Cu),this.xu=new Wi(rl.Nu)}function sl(t,e,n){this.query=t,this.yu=e,this.gu=!1,this.Vu=null,this.onlineState="Unknown",this.options=n||{}}function ul(t,e){return"firestore_clients_"+t+"_"+e}function al(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.A()&&(n+="_"+e.uid),n}function cl(t,e){return"firestore_targets_"+t+"_"+e}var hl=(kl.qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Nr(r.error.code,r.error.message)),i?new kl(t,e,r.state,o):(Pr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},kl.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},kl),fl=(Ol.qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Nr(n.error.code,n.error.message)),r?new Ol(t,n.state,i):(Pr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Ol.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Ol),ll=(Dl.qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=no,o=0;r&&o<n.activeTargetIds.length;++o)r=Si(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Dl(t,i):(Pr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Dl),pl=(Sl.qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sl(e.clientId,e.onlineState):(Pr("SharedClientState","Failed to parse online state: "+t),null)},Sl),dl=(xl.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},xl.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},xl.prototype.Uu=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},xl),yl=(Nl.Hs=function(t){return!(!t||!t.localStorage)},Nl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ju.Vc()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Wu&&(i=this.getItem(ul(this.persistenceKey,r)))&&(o=ll.qu(r,i))&&(this.Hu=this.Hu.At(o.clientId,o));for(this.ih(),(s=this.storage.getItem(this.nh))&&(u=this.rh(s))&&this.oh(u),a=0,c=this.Ju;a<c.length;a++)h=c[a],this.zu(h);return this.Ju=[],this.window.addEventListener("unload",function(){return f.Ac()}),this.dr=!0,[2]}})})},Nl.prototype.Cs=function(t){this.setItem(this.Xu,JSON.stringify(t))},Nl.prototype.ah=function(){return this.uh(this.Hu)},Nl.prototype.hh=function(n){var r=!1;return this.Hu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Nl.prototype.lh=function(t){this._h(t,"pending")},Nl.prototype.fh=function(t,e,n){this._h(t,e,n),this.dh(t)},Nl.prototype.wh=function(t){var e,n="not-current";return this.hh(t)&&(!(e=this.storage.getItem(cl(this.persistenceKey,t)))||(e=fl.qu(t,e))&&(n=e.state)),this.Eh.Qu(t),this.ih(),n},Nl.prototype.Th=function(t){this.Eh.Ku(t),this.ih()},Nl.prototype.mh=function(t){return this.Eh.activeTargetIds.has(t)},Nl.prototype.Ih=function(t){this.removeItem(cl(this.persistenceKey,t))},Nl.prototype.Ah=function(t,e,n){this.Rh(t,e,n)},Nl.prototype.Ph=function(t,e,n){var r=this;e.forEach(function(t){r.dh(t)}),this.currentUser=t,n.forEach(function(t){r.lh(t)})},Nl.prototype.yh=function(t){this.gh(t)},Nl.prototype.Vh=function(){this.ph()},Nl.prototype.Ac=function(){this.dr&&(this.window.removeEventListener("storage",this.Gu),this.removeItem(this.Yu),this.dr=!1)},Nl.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},Nl.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Nl.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Nl.prototype.zu=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(kr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Yu)return void Pr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ns.$i(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.dr){if(null!==o.key)if(this.Zu.test(o.key)){if(null==o.newValue)return e=this.bh(o.key),[2,this.Sh(e,null)];if(e=this.Dh(o.key,o.newValue))return[2,this.Sh(e.clientId,e)]}else if(this.th.test(o.key)){if(null!==o.newValue&&(n=this.Ch(o.key,o.newValue)))return[2,this.xh(n)]}else if(this.eh.test(o.key)){if(null!==o.newValue&&(r=this.Nh(o.key,o.newValue)))return[2,this.Fh(r)]}else if(o.key===this.nh){if(null!==o.newValue&&(i=this.rh(o.newValue)))return[2,this.oh(i)]}else if(o.key===this.Xu)(i=function(t){var e=Ta.xs;if(null!=t)try{var n=JSON.parse(t);Vr("number"==typeof n),e=n}catch(t){Pr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Ta.xs&&this.vs(i);else if(o.key===this.sh)return[2,this.ju.Oh()]}else this.Ju.push(o);return[2]})})})}},Object.defineProperty(Nl.prototype,"Eh",{get:function(){return this.Hu.get(this.Wu)},enumerable:!1,configurable:!0}),Nl.prototype.ih=function(){this.setItem(this.Yu,this.Eh.Uu())},Nl.prototype._h=function(t,e,n){n=new hl(this.currentUser,t,e,n),t=al(this.persistenceKey,this.currentUser,t);this.setItem(t,n.Uu())},Nl.prototype.dh=function(t){t=al(this.persistenceKey,this.currentUser,t);this.removeItem(t)},Nl.prototype.gh=function(t){t={clientId:this.Wu,onlineState:t};this.storage.setItem(this.nh,JSON.stringify(t))},Nl.prototype.Rh=function(t,e,n){var r=cl(this.persistenceKey,t),n=new fl(t,e,n);this.setItem(r,n.Uu())},Nl.prototype.ph=function(){this.setItem(this.sh,"value-not-used")},Nl.prototype.bh=function(t){t=this.Zu.exec(t);return t?t[1]:null},Nl.prototype.Dh=function(t,e){t=this.bh(t);return ll.qu(t,e)},Nl.prototype.Ch=function(t,e){var n=this.th.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return hl.qu(new $r(n),t,e)},Nl.prototype.Nh=function(t,e){t=this.eh.exec(t),t=Number(t[1]);return fl.qu(t,e)},Nl.prototype.rh=function(t){return pl.qu(t)},Nl.prototype.xh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ju.kh(e.batchId,e.state,e.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Nl.prototype.Fh=function(t){return this.ju.Mh(t.targetId,t.state,t.error)},Nl.prototype.Sh=function(t,e){var n=this,r=e?this.Hu.At(t,e):this.Hu.remove(t),i=this.uh(this.Hu),o=this.uh(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ju.$h(s,u).then(function(){n.Hu=r})},Nl.prototype.oh=function(t){this.Hu.get(t.clientId)&&this.ja(t.onlineState)},Nl.prototype.uh=function(t){var n=no;return t.forEach(function(t,e){n=n.Ht(e.activeTargetIds)}),n},Nl),vl=(Al.prototype.lh=function(t){},Al.prototype.fh=function(t,e,n){},Al.prototype.wh=function(t){return this.Lh.Qu(t),this.Bh[t]||"not-current"},Al.prototype.Ah=function(t,e,n){this.Bh[t]=e},Al.prototype.Th=function(t){this.Lh.Ku(t)},Al.prototype.mh=function(t){return this.Lh.activeTargetIds.has(t)},Al.prototype.Ih=function(t){delete this.Bh[t]},Al.prototype.ah=function(){return this.Lh.activeTargetIds},Al.prototype.hh=function(t){return this.Lh.activeTargetIds.has(t)},Al.prototype.start=function(){return this.Lh=new dl,Promise.resolve()},Al.prototype.Ph=function(t,e,n){},Al.prototype.yh=function(t){},Al.prototype.Ac=function(){},Al.prototype.Cs=function(t){},Al.prototype.Vh=function(){},Al),gl=function(t){this.key=t},ml=function(t){this.key=t},wl=(Object.defineProperty(_l.prototype,"jh",{get:function(){return this.qh},enumerable:!1,configurable:!0}),_l.prototype.Gh=function(t,e){var s=this,u=e?e.zh:new io,a=(e||this).Wh,c=(e||this).se,h=a,f=!1,l=xu(this.query)&&a.size===this.query.limit?a.last():null,p=Su(this.query)&&a.size===this.query.limit?a.first():null;if(t.gt(function(t,e){var n=a.get(t),r=(r=e instanceof mu?e:null)&&(Uu(s.query,r)?r:null),i=!!n&&s.se.has(n.key),o=!!r&&(r.ln||s.se.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Hh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Kh(r,l)||p&&s.Kh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),xu(this.query)||Su(this.query))for(;h.size>this.query.limit;){var n=xu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Wh:h,zh:u,Dr:f,se:c}},_l.prototype.Hh=function(t,e){return t.ln&&e.hasCommittedMutations&&!e.ln},_l.prototype.es=function(t,e,n){var o=this,r=this.Wh;this.Wh=t.Wh,this.se=t.se;var i=t.zh.ee();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Kh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Jh(n);var s=e?this.Yh():[],n=0===this.Qh.size&&this.fe?1:0,e=n!==this.Uh;return this.Uh=n,0!==i.length||e?{snapshot:new oo(this.query,t.Wh,r,i,t.se,0==n,e,!1),Xh:s}:{Xh:s}},_l.prototype.Au=function(t){return this.fe&&"Offline"===t?(this.fe=!1,this.es({Wh:this.Wh,zh:new io,se:this.se,Dr:!1},!1)):{Xh:[]}},_l.prototype.Zh=function(t){return!this.qh.has(t)&&!!this.Wh.has(t)&&!this.Wh.get(t).ln},_l.prototype.Jh=function(t){var e=this;t&&(t.de.forEach(function(t){return e.qh=e.qh.add(t)}),t.we.forEach(function(t){}),t.Ee.forEach(function(t){return e.qh=e.qh.delete(t)}),this.fe=t.fe)},_l.prototype.Yh=function(){var e=this;if(!this.fe)return[];var n=this.Qh;this.Qh=eo(),this.Wh.forEach(function(t){e.Zh(t.key)&&(e.Qh=e.Qh.add(t.key))});var r=[];return n.forEach(function(t){e.Qh.has(t)||r.push(new ml(t))}),this.Qh.forEach(function(t){n.has(t)||r.push(new gl(t))}),r},_l.prototype.tl=function(t){this.qh=t.la,this.Qh=eo();t=this.Gh(t.documents);return this.es(t,!0)},_l.prototype.el=function(){return oo.oe(this.query,this.Wh,this.se,0===this.Uh)},_l),bl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},El=function(t){this.key=t,this.nl=!1},Il=(Object.defineProperty(Tl.prototype,"ml",{get:function(){return!0===this.Tl},enumerable:!1,configurable:!0}),Tl);function Tl(t,e,n,r,i,o){this.Zc=t,this.sl=e,this.il=n,this.rl=r,this.currentUser=i,this.ol=o,this.cl={},this.al=new ma(Vu,Cu),this.ul=new Map,this.hl=[],this.ll=new qi(yi.K),this._l=new Map,this.fl=new nl,this.dl={},this.wl=new Map,this.El=_h.Ao(),this.onlineState="Unknown",this.Tl=void 0}function _l(t,e){this.query=t,this.qh=e,this.Uh=null,this.fe=!1,this.Qh=eo(),this.se=eo(),this.Kh=ju(t),this.Wh=new ro(this.Kh)}function Al(){this.Lh=new dl,this.Bh={},this.ja=null,this.vs=null}function Nl(t,e,n,r,i){this.window=t,this.Ns=e,this.persistenceKey=n,this.Wu=r,this.ju=null,this.ja=null,this.vs=null,this.Gu=this.zu.bind(this),this.Hu=new qi(jr),this.dr=!1,this.Ju=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Yu=ul(this.persistenceKey,this.Wu),this.Xu="firestore_sequence_number_"+this.persistenceKey,this.Hu=this.Hu.At(this.Wu,new dl),this.Zu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.th=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.eh=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.nh="firestore_online_state_"+this.persistenceKey,this.sh="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Gu)}function xl(){this.activeTargetIds=no}function Sl(t,e){this.clientId=t,this.onlineState=e}function Dl(t,e){this.clientId=t,this.activeTargetIds=e}function Ol(t,e,n){this.targetId=t,this.state=e,this.error=n}function kl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Pl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Il=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Gh(o)).Dr?[4,pf(r.Zc,i.query,!1).then(function(t){t=t.documents;return i.view.Gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.ce.get(i.targetId),n=i.view.es(e,r.ml,n),[2,(Bl(r,i.targetId,n.Xh),n.snapshot)]}})})}(i,t,e,n)},[4,pf(i.Zc,o,!0)];case 1:return n=t.sent(),r=new wl(o,n.la),e=r.Gh(n.documents),n=uo._e(s,u&&"Offline"!==i.onlineState),n=r.es(e,i.ml,n),Bl(i,s,n.Xh),r=new bl(o,s,r),[2,(i.al.set(o,r),i.ul.has(s)?i.ul.get(s).push(o):i.ul.set(s,[o]),n.snapshot)]}})})}function Rl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Ql(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Zc,a=p,h=i,f=hi.now(),o=a.reduce(function(t,e){return t.add(e.key)},eo()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.sa.ds(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof nu?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof mu?t.field(i.field):void 0,o=bs(i.transform,o||null);null!=o&&(e=(null==e?new hu:e).set(i.field,o))}return e?e._n():null}(o):null);null!=o&&e.push(new Qs(i.key,o,function s(t){var u=[];return _o(t.fields||{},function(t,e){var n=new di([t]);if(zo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ms(u)}(o.proto.mapValue),Fs.exists(!0)))}return h.cs.Mr(u,f,e,a)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Wn:e}}))];case 2:return s=t.sent(),u.rl.lh(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.dl[e.currentUser.R()])||new qi(jr)).At(n,r),e.dl[e.currentUser.R()]=i,[4,Gl(u,s.Wn)];case 3:return t.sent(),[4,Gf(u.sl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=rc(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Ll(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,cf(n.Zc,i)];case 2:return e=t.sent(),i.ce.forEach(function(t,e){e=n._l.get(e);e&&(Vr(t.de.size+t.we.size+t.Ee.size<=1),0<t.de.size?e.nl=!0:0<t.we.size?Vr(e.nl):0<t.Ee.size&&(Vr(e.nl),e.nl=!1))}),[4,Gl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Cl(t,n,e){var r,t=t;(t.ml&&0===e||!t.ml&&1===e)&&(r=[],t.al.forEach(function(t,e){e=e.view.Au(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Au(i)&&(o=!0)}),o&&tl(t)}(t.il,n),r.length&&t.cl.Na(r),t.onlineState=n,t.ml&&t.rl.yh(n))}function Vl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.cs.Lr(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.cs.Wr(e,t)}).next(function(){return i.cs.Hr(e)}).next(function(){return i.sa.ds(e,n)})}))];case 2:return o=t.sent(),jl(n,u,a),Ul(n,u),n.rl.fh(u,"rejected",a),[4,Gl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Ml(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:jf((n=o).sl)||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Zc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.cs.Ur(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.wl.get(r)||[]).push(s),n.wl.set(r,i),[3,4]);case 3:return i=t.sent(),i=rc(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Ul(t,e){(t.wl.get(e)||[]).forEach(function(t){t.resolve()}),t.wl.delete(e)}function jl(t,e,n){var r=t,i=r.dl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.dl[r.currentUser.R()]=i)}function ql(e,t,n){void 0===n&&(n=null),e.rl.Th(t);for(var r=0,i=e.ul.get(t);r<i.length;r++){var o=i[r];e.al.delete(o),n&&e.cl.Al(o,n)}e.ul.delete(t),e.ml&&e.fl.Mu(t).forEach(function(t){e.fl.Jr(t)||Fl(e,t)})}function Fl(t,e){var n=t.ll.get(e);null!==n&&(Lf(t.sl,n),t.ll=t.ll.remove(e),t._l.delete(n),zl(t))}function Bl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof gl?(t.fl.Mo(o.key,e),function(t,e){e=e.key;t.ll.get(e)||(kr("SyncEngine","New document in limbo: "+e),t.hl.push(e),zl(t))}(t,o)):o instanceof ml?(kr("SyncEngine","Document no longer in limbo: "+o.key),t.fl.Lo(o.key,e),t.fl.Jr(o.key)||Fl(t,o.key)):Cr()}}function zl(t){for(;0<t.hl.length&&t.ll.size<t.ol;){var e=t.hl.shift(),n=t.El.next();t._l.set(n,new El(e)),t.ll=t.ll.At(e,n),Rf(t.sl,new Vi(Ru(Nu(e.path)),n,2,Ta.xs))}}function Gl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).al.Y()?[3,3]:(n.al.forEach(function(t,e){o.push(n.Il(e,s,u).then(function(t){t&&(n.ml&&n.rl.Ah(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ia.bs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.cl.Na(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return wa.forEach(c,function(e){return wa.forEach(e.Vs,function(t){return r.persistence.Nr.Mo(n,e.targetId,t)}).next(function(){return wa.forEach(e.ps,function(t){return r.persistence.Nr.Lo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!za(e=t.sent()))throw e;return kr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ra.get(o),u=s.wt,u=s.It(u),r.ra=r.ra.At(o,u));return[2]}})})}(n.Zc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Kl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(kr("SyncEngine","User change. New user:",o.R()),[4,sf(n.Zc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).wl.forEach(function(t){t.forEach(function(t){t.reject(new Nr(Ar.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.wl.clear(),n.rl.Ph(o,r.ua,r.ha),[4,Gl(n,r.aa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Hl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Zc,n=a,i=(r=e).cs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.sa.ds(e,t):wa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Gf(o.sl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(jl(o,a,h||null),Ul(o,a),o.Zc.cs.Gr(a)):Cr(),t.label=4;case 4:return[4,Gl(o,s)];case 5:return t.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Wl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Zl(r=h),Ql(r),!0!==f||!0===r.Tl?[3,3]:(e=r.rl.ah(),[4,Yl(r,e.tt())]);case 1:return i=t.sent(),r.Tl=!0,[4,Wf(r.sl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Rf(r.sl,u);return[3,7];case 3:return!1!==f||!1===r.Tl?[3,7]:(a=[],c=Promise.resolve(),r.ul.forEach(function(t,e){r.rl.mh(e)?a.push(e):c=c.then(function(){return ql(r,e),lf(r.Zc,e,!0)}),Lf(r.sl,e)}),[4,c]);case 4:return t.sent(),[4,Yl(r,a)];case 5:return t.sent(),(n=r)._l.forEach(function(t,e){Lf(n.sl,e)}),n.fl.$u(),n._l=new Map,n.ll=new qi(yi.K),r.Tl=!1,[4,Wf(r.sl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Yl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.ul.get(s))&&0!==a.length?[4,ff(e.Zc,Ru(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.al.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,pf((e=r).Zc,i.query,!0)];case 1:return n=t.sent(),n=i.view.tl(n),[2,(e.ml&&Bl(e,i.targetId,n.Xh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,df(e.Zc,s)];case 8:return l=t.sent(),[4,ff(e.Zc,l)];case 9:return u=t.sent(),[4,Pl(e,Xl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.cl.Na(r),n)]}})})}function Xl(t){return Au(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Zl(t){return t.sl.nu._u=Ll.bind(null,t),t.sl.nu.tn=function(t,e){var n=t;if((t=n._l.get(e))&&t.nl)return eo().add(t.key);var r=eo();if(!(e=n.ul.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.al.get(s),r=r.Ht(s.view.jh);return r}.bind(null,t),t.sl.nu.lu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).rl.Ah(s,"rejected",u),i=e._l.get(s),(n=i&&i.key)?(r=(r=new qi(yi.K)).At(n,new wu(n,fi.min())),i=eo().add(n),i=new so(fi.min(),new Map,new Wi(jr),r,i),[4,Ll(e,i)]):[3,2];case 1:return t.sent(),e.ll=e.ll.remove(n),e._l.delete(s),zl(e),[3,4];case 2:return[4,lf(e.Zc,s,!1).then(function(){return ql(e,s,u)}).catch(gf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.cl.Na=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ru(s)&&(r=!0);u.Tu=s}}r&&tl(n)}.bind(null,t.il),t.cl.Al=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.il),t}function Ql(t){return t.sl.nu.fu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,uf(e.Zc,o)];case 2:return r=t.sent(),jl(e,n,null),Ul(e,n),e.rl.fh(n,"acknowledged"),[4,Gl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.sl.nu.du=Vl.bind(null,t),t}function Jl(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Zc,i=u,s=new Yh((o=r).serializer).Jc(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.tc._o(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Rl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Pl(Jh(u)),a=new tf(u,l.Zc,p.serializer),[4,p.Uc()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ta(c)]:[3,10];case 7:return(h=t.sent())&&d.Pl(h),[4,p.Uc()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Gl(l,f.Yc,void 0)];case 12:return t.sent(),[4,(r=l.Zc,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.tc.fo(t,e)}))];case 13:return t.sent(),d.Rl(f.progress),[3,15];case 14:return Rr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.yl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.rl.Vh()})}var $l,tp,ep,np,rp,ip=(jp.prototype.kr=function(t){return wa.resolve(0===this.cs.length)},jp.prototype.Mr=function(t,e,n,r){var i=this.gl;this.gl++,0<this.cs.length&&this.cs[this.cs.length-1];n=new va(i,e,n,r);this.cs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Vl=this.Vl.add(new rl(u.key,i)),this.us.$r(t,u.key.path.G())}return wa.resolve(n)},jp.prototype.Lr=function(t,e){return wa.resolve(this.pl(e))},jp.prototype.qr=function(t,e){e+=1,e=this.bl(e),e=e<0?0:e;return wa.resolve(this.cs.length>e?this.cs[e]:null)},jp.prototype.Ur=function(){return wa.resolve(0===this.cs.length?-1:this.gl-1)},jp.prototype.Qr=function(t){return wa.resolve(this.cs.slice())},jp.prototype.ls=function(t,e){var n=this,r=new rl(e,0),e=new rl(e,Number.POSITIVE_INFINITY),i=[];return this.Vl.jt([r,e],function(t){t=n.pl(t.Bu);i.push(t)}),wa.resolve(i)},jp.prototype.Es=function(t,e){var n=this,r=new Wi(jr);return e.forEach(function(t){var e=new rl(t,0),t=new rl(t,Number.POSITIVE_INFINITY);n.Vl.jt([e,t],function(t){r=r.add(t.Bu)})}),wa.resolve(this.vl(r))},jp.prototype.ys=function(t,e){var n=e.path,r=n.length+1,e=n;yi.lt(e)||(e=e.child(""));var e=new rl(new yi(e),0),i=new Wi(jr);return this.Vl.Gt(function(t){var e=t.key.path;return!!n.X(e)&&(e.length===r&&(i=i.add(t.Bu)),!0)},e),wa.resolve(this.vl(i))},jp.prototype.vl=function(t){var e=this,n=[];return t.forEach(function(t){t=e.pl(t);null!==t&&n.push(t)}),n},jp.prototype.Wr=function(n,r){var i=this;Vr(0===this.Sl(r.batchId,"removed")),this.cs.shift();var o=this.Vl;return wa.forEach(r.mutations,function(t){var e=new rl(t.key,r.batchId);return o=o.delete(e),i.Nr.zr(n,t.key)}).next(function(){i.Vl=o})},jp.prototype.Gr=function(t){},jp.prototype.Jr=function(t,e){var n=new rl(e,0),n=this.Vl.zt(n);return wa.resolve(e.isEqual(n&&n.key))},jp.prototype.Hr=function(t){return this.cs.length,wa.resolve()},jp.prototype.Sl=function(t,e){return this.bl(t)},jp.prototype.bl=function(t){return 0===this.cs.length?0:t-this.cs[0].batchId},jp.prototype.pl=function(t){t=this.bl(t);return t<0||t>=this.cs.length?null:this.cs[t]},jp),op=(Up.prototype.zn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Dl(e);return this.docs=this.docs.At(r,{Jn:e,size:i,readTime:n}),this.size+=i-o,this.us.$r(t,r.path.G())},Up.prototype.Yn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Up.prototype.Xn=function(t,e){e=this.docs.get(e);return wa.resolve(e?e.Jn:null)},Up.prototype.getEntries=function(t,e){var n=this,r=Xi;return e.forEach(function(t){var e=n.docs.get(t);r=r.At(t,e?e.Jn:null)}),wa.resolve(r)},Up.prototype.Ts=function(t,e,n){for(var r=Ji,i=new yi(e.path.child("")),o=this.docs.vt(i);o.Ft();){var s=o.Nt(),u=s.key,a=s.value,s=a.Jn,a=a.readTime;if(!e.path.X(u.path))break;a.u(n)<=0||s instanceof mu&&Uu(e,s)&&(r=r.At(s.key,s))}return wa.resolve(r)},Up.prototype.Cl=function(t,e){return wa.forEach(this.docs,function(t){return e(t)})},Up.prototype.oo=function(t){return new sp(this)},Up.prototype.ao=function(t){return wa.resolve(this.size)},Up),sp=(h(Mp,rp=o),Mp.prototype.es=function(n){var r=this,i=[];return this.Wn.forEach(function(t,e){e&&e.Jn?i.push(r.uo.zn(n,e.Jn,r.Gn(t))):r.uo.Yn(t)}),wa.Qn(i)},Mp.prototype.Zn=function(t,e){return this.uo.Xn(t,e)},Mp.prototype.ts=function(t,e){return this.uo.getEntries(t,e)},Mp),up=(Vp.prototype.Ke=function(t,n){return this.xl.forEach(function(t,e){return n(e)}),wa.resolve()},Vp.prototype.Vo=function(t){return wa.resolve(this.lastRemoteSnapshotVersion)},Vp.prototype.po=function(t){return wa.resolve(this.Nl)},Vp.prototype.Ro=function(t){return this.highestTargetId=this.Ol.next(),wa.resolve(this.highestTargetId)},Vp.prototype.bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Nl&&(this.Nl=e),wa.resolve()},Vp.prototype.So=function(t){this.xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ol=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.Nl&&(this.Nl=t.sequenceNumber)},Vp.prototype.vo=function(t,e){return this.So(e),this.targetCount+=1,wa.resolve()},Vp.prototype.Co=function(t,e){return this.So(e),wa.resolve()},Vp.prototype.xo=function(t,e){return this.xl.delete(e.target),this.Fl.Mu(e.targetId),--this.targetCount,wa.resolve()},Vp.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return this.xl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.xl.delete(t),u.push(o.No(n,e.targetId)),s++)}),wa.Qn(u).next(function(){return s})},Vp.prototype.Fo=function(t){return wa.resolve(this.targetCount)},Vp.prototype.Oo=function(t,e){e=this.xl.get(e)||null;return wa.resolve(e)},Vp.prototype.ko=function(t,e,n){return this.Fl.Fu(e,n),wa.resolve()},Vp.prototype.$o=function(e,t,n){this.Fl.ku(t,n);var r=this.persistence.Nr,i=[];return r&&t.forEach(function(t){i.push(r.zr(e,t))}),wa.Qn(i)},Vp.prototype.No=function(t,e){return this.Fl.Mu(e),wa.resolve()},Vp.prototype.Bo=function(t,e){e=this.Fl.Lu(e);return wa.resolve(e)},Vp.prototype.Jr=function(t,e){return wa.resolve(this.Fl.Jr(e))},Vp),ap=(Cp.prototype._o=function(t,e){return wa.resolve(this.kl.get(e))},Cp.prototype.fo=function(t,e){return this.kl.set(e.id,{id:e.id,version:e.version,createTime:Jo(e.createTime)}),wa.resolve()},Cp.prototype.wo=function(t,e){return wa.resolve(this.Ml.get(e))},Cp.prototype.Eo=function(t,e){return this.Ml.set(e.name,{name:(e=e).name,query:Dc(e.bundledQuery),readTime:Jo(e.readTime)}),wa.resolve()},Cp),cp=(Lp.prototype.start=function(){return Promise.resolve()},Lp.prototype.Ac=function(){return this.Wo=!1,Promise.resolve()},Object.defineProperty(Lp.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Lp.prototype.cc=function(){},Lp.prototype.ac=function(){},Lp.prototype.Dc=function(){return this.us},Lp.prototype.bc=function(t){var e=this.$l[t.R()];return e||(e=new ip(this.us,this.Nr),this.$l[t.R()]=e),e},Lp.prototype.vc=function(){return this.Zo},Lp.prototype.Sc=function(){return this.os},Lp.prototype.Cc=function(){return this.tc},Lp.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new hp(this.Ko.next());return this.Nr.Bl(),n(i).next(function(t){return r.Nr.ql(i).next(function(){return t})}).qn().then(function(t){return i.rs(),t})},Lp.prototype.Ul=function(e,n){return wa.Kn(Object.values(this.$l).map(function(t){return function(){return t.Jr(e,n)}}))},Lp),hp=(h(Rp,np=Ie),Rp),fp=(Pp.Wl=function(t){return new Pp(t)},Object.defineProperty(Pp.prototype,"jl",{get:function(){if(this.Kl)return this.Kl;throw Cr()},enumerable:!1,configurable:!0}),Pp.prototype.Mo=function(t,e,n){return this.Ql.Mo(n,e),this.jl.delete(n.toString()),wa.resolve()},Pp.prototype.Lo=function(t,e,n){return this.Ql.Lo(n,e),this.jl.add(n.toString()),wa.resolve()},Pp.prototype.zr=function(t,e){return this.jl.add(e.toString()),wa.resolve()},Pp.prototype.removeTarget=function(t,e){var n=this;this.Ql.Mu(e.targetId).forEach(function(t){return n.jl.add(t.toString())});var r=this.persistence.vc();return r.Bo(t,e.targetId).next(function(t){t.forEach(function(t){return n.jl.add(t.toString())})}).next(function(){return r.xo(t,e)})},Pp.prototype.Bl=function(){this.Kl=new Set},Pp.prototype.ql=function(n){var r=this,i=this.persistence.Sc().oo();return wa.forEach(this.jl,function(t){var e=yi.at(t);return r.Gl(n,e).next(function(t){t||i.Yn(e)})}).next(function(){return r.Kl=null,i.apply(n)})},Pp.prototype.kc=function(t,e){var n=this;return this.Gl(t,e).next(function(t){t?n.jl.delete(e.toString()):n.jl.add(e.toString())})},Pp.prototype.Ll=function(t){return 0},Pp.prototype.Gl=function(t,e){var n=this;return wa.Kn([function(){return wa.resolve(n.Ql.Jr(e))},function(){return n.persistence.vc().Jr(t,e)},function(){return n.persistence.Ul(t,e)}])},Pp),lp=(kp.prototype.Ca=function(t){this.Jl=t},kp.prototype.pa=function(t){this.Yl=t},kp.prototype.onMessage=function(t){this.Xl=t},kp.prototype.close=function(){this.Hl()},kp.prototype.send=function(t){this.zl(t)},kp.prototype.Zl=function(){this.Jl()},kp.prototype.t_=function(t){this.Yl(t)},kp.prototype.e_=function(t){this.Xl(t)},kp),pp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},dp=(Op.prototype.Ka=function(e,t,n,r){var i=this.r_(e,t);kr("RestConnection","Sending: ",i,n);t={};return this.o_(t,r),this.c_(e,i,t,n).then(function(t){return kr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Op.prototype.Wa=function(t,e,n,r){return this.Ka(t,e,n,r)},Op.prototype.o_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-BundlePrerelease.f8bb4d8b7",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Op.prototype.r_=function(t,e){t=pp[t];return this.s_+"/v1/"+e+":"+t},h(Dp,ep=Op),Dp.prototype.c_=function(o,e,s,u){return new Promise(function(n,r){var i=new _r;i.listenOnce(wr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case mr.NO_ERROR:var t=i.getResponseJson();kr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case mr.TIMEOUT:kr("Connection",'RPC "'+o+'" timed out'),r(new Nr(Ar.DEADLINE_EXCEEDED,"Request time out"));break;case mr.HTTP_ERROR:var e=i.getStatus();kr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Ar).indexOf(e)?e:Ar.UNKNOWN,r(new Nr(e,t.message))):r(new Nr(Ar.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Nr(Ar.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{kr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Dp.prototype.xa=function(t,e){var n,r=[this.s_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=gr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.o_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");kr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new lp({zl:function(t){a?kr("Connection","Not sending because WebChannel is closed:",t):(u||(kr("Connection","Opening WebChannel transport."),s.open(),u=!0),kr("Connection","WebChannel sending:",t),s.send(t))},Hl:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Tr.EventType.OPEN,function(){a||kr("Connection","WebChannel transport opened.")}),t(s,Tr.EventType.CLOSE,function(){a||(a=!0,kr("Connection","WebChannel transport closed"),c.t_())}),t(s,Tr.EventType.ERROR,function(t){a||(a=!0,Rr("Connection","WebChannel transport errored:",t),c.t_(new Nr(Ar.UNAVAILABLE,"The operation could not be completed")))}),t(s,Tr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Vr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(kr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ci[r];if(void 0!==t)return ji(t)}(),i=n.message,void 0===t&&(t=Ar.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.t_(new Nr(t,i)),s.close()):(kr("Connection","WebChannel received:",e),c.e_(e)))}),t(o,br.STAT_EVENT,function(t){t.stat===Er?kr("Connection","Detected buffering proxy"):t.stat===Ir&&kr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Zl()},0),c},Dp),yp=(Sp.prototype.au=function(t){this.__.push(t)},Sp.prototype.Ac=function(){window.removeEventListener("online",this.a_),window.removeEventListener("offline",this.h_)},Sp.prototype.f_=function(){window.addEventListener("online",this.a_),window.addEventListener("offline",this.h_)},Sp.prototype.u_=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(0)},Sp.prototype.l_=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(1)},Sp.Hs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Sp),vp=(xp.prototype.au=function(t){},xp.prototype.Ac=function(){},xp),gp=(Np.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Kh(e.n_.T),this.rl=this.d_(e),this.persistence=this.w_(e),[4,this.persistence.start()];case 1:return t.sent(),this.E_=this.T_(e),this.Zc=this.m_(e),[2]}})})},Np.prototype.T_=function(t){return null},Np.prototype.m_=function(t){return of(this.persistence,new lc,t.I_,this.serializer)},Np.prototype.w_=function(t){return new cp(fp.Wl,this.serializer)},Np.prototype.d_=function(t){return new vl},Np.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.E_&&this.E_.stop(),[4,this.rl.Ac()];case 1:return t.sent(),[4,this.persistence.Ac()];case 2:return t.sent(),[2]}})})},Np),mp=(h(Ap,tp=gp),Ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,vf(this.Zc)];case 2:return t.sent(),[4,this.A_.initialize(this,e)];case 3:return t.sent(),[4,Ql(this.A_.ju)];case 4:return t.sent(),[4,Gf(this.A_.sl)];case 5:return t.sent(),[2]}})})},Ap.prototype.m_=function(t){return of(this.persistence,new lc,t.I_,this.serializer)},Ap.prototype.T_=function(t){var e=this.persistence.Nr.ur;return new hc(e,t.Ei)},Ap.prototype.w_=function(t){var e=Bh(t.n_.T,t.n_.persistenceKey),n=void 0!==this.cacheSizeBytes?uc.sr(this.cacheSizeBytes):uc.cr;return new Lh(this.synchronizeTabs,e,t.clientId,n,t.Ei,Qa(),Ja(),this.serializer,this.rl,!!this.forceOwnership)},Ap.prototype.d_=function(t){return new vl},Ap),wp=(h(_p,$l=mp),_p.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,$l.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.A_.ju,this.rl instanceof yl?(this.rl.ju={kh:Hl.bind(null,e),Mh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Tl?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.ul.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,yf(e.Zc)];case 3:return n=t.sent(),r=so.le(o,"current"===s),[4,Gl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,lf(e.Zc,o,!0)];case 6:return t.sent(),ql(e,o,u),[3,8];case 7:Cr(),t.label=8;case 8:return[2]}})})}.bind(null,e),$h:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Zl(c)).Tl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.ul.has(r)?(kr("SyncEngine","Adding an already active target "+r),[3,5]):[4,df(n.Zc,r)]):[3,6];case 2:return i=t.sent(),[4,ff(n.Zc,i)];case 3:return o=t.sent(),[4,Pl(n,Xl(i),o.targetId,!1)];case 4:t.sent(),Rf(n.sl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.ul.has(e)?[4,lf(n.Zc,e,!1).then(function(){Lf(n.sl,e),ql(n,e)}).catch(gf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Vc:function(t){return t.Zc.persistence.Vc()}.bind(null,e),Oh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,yf((e=n).Zc).then(function(t){return Gl(e,t)})]})})}.bind(null,e)},[4,this.rl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.oc(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Wl(this.A_.ju,e)];case 1:return t.sent(),this.E_&&(e&&!this.E_.dr?this.E_.start(this.Zc):e||this.E_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},_p.prototype.d_=function(t){var e=Qa();if(!yl.Hs(e))throw new Nr(Ar.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Bh(t.n_.T,t.n_.persistenceKey);return new yl(e,t.Ei,n,t.clientId,t.I_)},_p),bp=(Tp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Zc?[3,2]:(this.Zc=n.Zc,this.rl=n.rl,this.eu=this.R_(r),this.sl=this.P_(r),this.il=this.y_(r),this.ju=this.g_(r,!n.synchronizeTabs),this.rl.ja=function(t){return Cl(e.ju,t,1)},this.sl.nu.V_=Kl.bind(null,this.ju),[4,Wf(this.sl,this.ju.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tp.prototype.y_=function(t){return new Zf},Tp.prototype.R_=function(t){var e=Kh(t.n_.T),n=(n=t.n_,new dp(n));return t=t.credentials,new _f(t,n,e)},Tp.prototype.P_=function(t){var e=this,n=this.Zc,r=this.eu,i=t.Ei,o=function(t){return Cl(e.ju,t,0)},t=new(yp.Hs()?yp:vp);return new mf(n,r,i,o,t)},Tp.prototype.g_=function(t,e){return function(t,e,n,r,i,o,s){o=new Il(t,e,n,r,i,o);return s&&(o.Tl=!0),o}(this.Zc,this.sl,this.il,this.rl,t.I_,t.ol,e)},Tp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,kr("RemoteStore","RemoteStore shutting down."),e.ru.add(5),[4,Pf(e)];case 1:return t.sent(),e.cu.Ac(),e.uu.set("Unknown"),[2]}})})}(this.sl)},Tp),Ep=(Ip.prototype.next=function(t){this.observer.next&&this.p_(this.observer.next,t)},Ip.prototype.error=function(t){this.observer.error?this.p_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ip.prototype.b_=function(){this.muted=!0},Ip.prototype.p_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ip);function Ip(t){this.observer=t,this.muted=!1}function Tp(){}function _p(t,e){var n=this;return(n=$l.call(this,t,e,!1)||this).A_=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Ap(t,e,n){var r=this;return(r=tp.call(this)||this).A_=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Np(){this.synchronizeTabs=!1}function xp(){}function Sp(){var t=this;this.a_=function(){return t.u_()},this.h_=function(){return t.l_()},this.__=[],this.f_()}function Dp(t){var e=this;return(e=ep.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function Op(t){this.n_=t,this.T=t.T;var e=t.ssl?"https":"http";this.s_=e+"://"+t.host,this.i_="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function kp(t){this.zl=t.zl,this.Hl=t.Hl}function Pp(t){this.persistence=t,this.Ql=new nl,this.Kl=null}function Rp(t){var e=this;return(e=np.call(this)||this).qo=t,e}function Lp(t,e){var n=this;this.$l={},this.Ko=new Ta(0),this.Wo=!1,this.Wo=!0,this.Nr=t(this),this.Zo=new up(this),this.us=new Hc,this.os=(t=this.us,new op(t,function(t){return n.Nr.Ll(t)})),this.serializer=new wc(e),this.tc=new ap(this.serializer)}function Cp(t){this.serializer=t,this.kl=new Map,this.Ml=new Map}function Vp(t){this.persistence=t,this.xl=new ma(ki,Pi),this.lastRemoteSnapshotVersion=fi.min(),this.highestTargetId=0,this.Nl=0,this.Fl=new nl,this.targetCount=0,this.Ol=_h.Io()}function Mp(t){var e=this;return(e=rp.call(this)||this).uo=t,e}function Up(t,e){this.us=t,this.Dl=e,this.docs=new qi(yi.K),this.size=0}function jp(t,e){this.us=t,this.Nr=e,this.cs=[],this.gl=1,this.Vl=new Wi(rl.Cu)}function qp(t,e,n){if(!n)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Fp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bp(t,e,n,r){if(!0===e&&!0===r)throw new Nr(Ar.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function zp(t){if(!yi.lt(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Gp(t){if(yi.lt(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Kp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Hp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Nr(Ar.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Kp(t);throw new Nr(Ar.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Wp(t,e){if(e<=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Yp,Xp=function(t){this._methodName=t},Zp=(h(Qp,Yp=Xp),Qp.prototype.v_=function(t){if(2!==t.S_)throw 1===t.S_?t.D_(this._methodName+"() can only appear at the top level of your update data"):t.D_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.sn.push(t.path),null},Qp.prototype.isEqual=function(t){return t instanceof Qp},Qp);function Qp(){return null!==Yp&&Yp.apply(this,arguments)||this}function Jp(t,e,n){return new qy({S_:3,C_:e.settings.C_,methodName:t._methodName,x_:n},e.T,e.serializer,e.ignoreUndefinedProperties)}var $p,td,ed,nd,rd,id,od=(h(Nd,id=Xp),Nd.prototype.v_=function(t){return new Us(t.path,new Ts)},Nd.prototype.isEqual=function(t){return t instanceof Nd},Nd),sd=(h(Ad,rd=Xp),Ad.prototype.v_=function(t){var e=Jp(this,t,!0),n=this.N_.map(function(t){return Yy(t,e)}),n=new _s(n);return new Us(t.path,n)},Ad.prototype.isEqual=function(t){return this===t},Ad),ud=(h(_d,nd=Xp),_d.prototype.v_=function(t){var e=Jp(this,t,!0),n=this.N_.map(function(t){return Yy(t,e)}),n=new Ds(n);return new Us(t.path,n)},_d.prototype.isEqual=function(t){return this===t},_d),ad=(h(Td,ed=Xp),Td.prototype.v_=function(t){var e=new Rs(t.serializer,Xo(t.serializer,this.F_));return new Us(t.path,e)},Td.prototype.isEqual=function(t){return this===t},Td),cd=(Object.defineProperty(Id.prototype,"latitude",{get:function(){return this.O_},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"longitude",{get:function(){return this.k_},enumerable:!1,configurable:!0}),Id.prototype.isEqual=function(t){return this.O_===t.O_&&this.k_===t.k_},Id.prototype.toJSON=function(){return{latitude:this.O_,longitude:this.k_}},Id.prototype.$=function(t){return jr(this.O_,t.O_)||jr(this.k_,t.k_)},Id),hd=new Map,fd=(Ed.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ed),ld=(Object.defineProperty(bd.prototype,"app",{get:function(){if(!this.Q_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"K_",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"W_",{get:function(){return void 0!==this.j_},enumerable:!1,configurable:!0}),bd.prototype.G_=function(t){if(this.B_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.L_=new fd(t),void 0!==t.credentials&&(this.U_=function(t){if(!t)return new si;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ci(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Nr(Ar.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},bd.prototype.z_=function(){return this.L_},bd.prototype.H_=function(){return this.B_=!0,this.L_},bd.prototype._delete=function(){return this.j_||(this.j_=this.J_()),this.j_},bd.prototype.J_=function(){return(t=hd.get(this))&&(kr("ComponentProvider","Removing Datastore"),hd.delete(this),t.terminate()),Promise.resolve();var t},bd),o=(wd.prototype.Y_=function(t,e){switch(void 0===e&&(e="none"),Do(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vo(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t,e);case 5:return t.stringValue;case 6:return this.tf(Mo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue,e);case 10:return this.rf(t.mapValue,e);default:throw Cr()}},wd.prototype.rf=function(t,n){var r=this,i={};return _o(t.fields||{},function(t,e){i[t]=r.Y_(e,n)}),i},wd.prototype.nf=function(t){return new cd(Vo(t.latitude),Vo(t.longitude))},wd.prototype.sf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Y_(t,e)})},wd.prototype.Z_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return No(e)?t(e):e}(t);return null==n?null:this.Y_(n,e);case"estimate":return this.X_(xo(t));default:return null}},wd.prototype.X_=function(t){t=Co(t);return new hi(t.seconds,t.nanos)},wd.prototype.cf=function(t,e){var n=li.nt(t);Vr(ws(n));t=new Jr(n.get(1),n.get(3)),n=new yi(n.j(5));return t.isEqual(e)||Pr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},wd),pd=(h(md,td=o),md.prototype.tf=function(t){return new Zr(new Gr(t))},md.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return jv.af(t,this.firestore,null)},md),dd=(Object.defineProperty(gd.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"ref",{get:function(){return new Jd(this.uf,this.ff,this.lf)},enumerable:!1,configurable:!0}),gd.prototype.exists=function(){return null!==this._f},gd.prototype.data=function(){if(this._f){if(this.ff){var t=new yd(this.uf,this.hf,this.lf,this._f,null);return this.ff.fromFirestore(t)}return this.hf.Y_(this._f.mn())}},gd.prototype.get=function(t){if(this._f){t=this._f.data().field(xd("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t)}},gd),yd=(h(vd,$p=dd),vd.prototype.data=function(){return $p.prototype.data.call(this)},vd);function vd(){return null!==$p&&$p.apply(this,arguments)||this}function gd(t,e,n,r,i){this.uf=t,this.hf=e,this.lf=n,this._f=r,this.ff=i}function md(t){var e=this;return(e=td.call(this)||this).firestore=t,e}function wd(){}function bd(t,e){this.M_="(lite)",this.L_=new fd({}),this.B_=!1,t instanceof Jr?(this.q_=t,this.U_=new si):(this.Q_=t,this.q_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Nr(Ar.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jr(t.options.projectId)}(t),this.U_=new ui(e))}function Ed(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(Ar.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Nr(Ar.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Bp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Id(t,e){if(!isFinite(t)||t<-90||90<t)throw new Nr(Ar.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Nr(Ar.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O_=t,this.k_=e}function Td(t,e){var n=this;return(n=ed.call(this,t)||this).F_=e,n}function _d(t,e){var n=this;return(n=nd.call(this,t)||this).N_=e,n}function Ad(t,e){var n=this;return(n=rd.call(this,t)||this).N_=e,n}function Nd(){return null!==id&&id.apply(this,arguments)||this}function xd(t,e){return"string"==typeof e?tv(t,e):(e instanceof Kr?e._:e).df}var Sd,Dd=(Pd.prototype.isEqual=function(t){return this.df.isEqual(t.df)},Pd),Od=(h(kd,Sd=ld),kd.prototype.J_=function(){return this.Ef||Rv(this),this.Ef.terminate()},kd);function kd(t,e){var n=this;return(n=Sd.call(this,t,e)||this).wf=new tc,n.M_="name"in t?t.name:"[DEFAULT]",n}function Pd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.df=new di(t)}function Rd(n,r,i){var t=this,o=new La;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,cv(n,i)];case 1:return t.sent(),[4,hv(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Ar.FAILED_PRECONDITION||t.code===Ar.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Ld(t){if(t.K_||t.W_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Cd,Vd,Md=(h(Bd,Vd=dd),Bd.prototype.exists=function(){return Vd.prototype.exists.call(this)},Bd.prototype.data=function(t){if(void 0===t&&(t={}),this._f){if(this.ff){var e=new Ud(this.uf,this.hf,this.lf,this._f,this.metadata,null);return this.ff.fromFirestore(e,t)}return this.hf.Y_(this._f.mn(),t.serverTimestamps)}},Bd.prototype.get=function(t,e){if(void 0===e&&(e={}),this._f){t=this._f.data().field(xd("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t,e.serverTimestamps)}},Bd),Ud=(h(Fd,Cd=Md),Fd.prototype.data=function(t){return void 0===t&&(t={}),Cd.prototype.data.call(this,t)},Fd),jd=(Object.defineProperty(qd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"size",{get:function(){return this.mf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(qd.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),qd.prototype.forEach=function(e,n){var r=this;this.mf.docs.forEach(function(t){e.call(n,new Ud(r.uf,r.hf,t.key,t,new Jv(r.mf.se.has(t.key),r.mf.fromCache),r.query.ff))})},qd.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.mf.re)throw new Nr(Ar.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.If&&this.Af===t||(this.If=function(i,e){if(i.mf.ne.Y()){var n=0;return i.mf.docChanges.map(function(t){var e=new Ud(i.uf,i.hf,t.doc.key,t.doc,new Jv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.mf.ne;return i.mf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ud(i.uf,i.hf,t.doc.key,t.doc,new Jv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Af=t),this.If},qd);function qd(t,e,n,r){this.uf=t,this.hf=e,this.mf=r,this.metadata=new Jv(r.hasPendingWrites,r.fromCache),this.query=n}function Fd(){return null!==Cd&&Cd.apply(this,arguments)||this}function Bd(t,e,n,r,i,o){var s=this;return(s=Vd.call(this,t,e,n,r,o)||this).uf=t,s.Tf=t,s.metadata=i,s}function zd(t,e){return t instanceof Md&&e instanceof Md?t.uf===e.uf&&t.lf.isEqual(e.lf)&&(null===t._f?null===e._f:t._f.isEqual(e._f))&&t.ff===e.ff:t instanceof jd&&e instanceof jd&&t.uf===e.uf&&Py(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.mf.isEqual(e.mf)}function Gd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Kd,Hd=(h(Wd,Kd=o),Wd.prototype.tf=function(t){return new Gr(t)},Wd.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new Jd(this.firestore,null,t)},Wd);function Wd(t){var e=this;return(e=Kd.call(this)||this).firestore=t,e}function Yd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Hp(t,Jd);var o=Hp(t.firestore,Od),s=Ry(o);return e instanceof Kr&&(e=e._),Zd(o,("string"==typeof e||e instanceof Dd?Hy(s,"updateDoc",t.lf,e,n,r):Ky(s,"updateDoc",t.lf,e)).Pf(t.lf,Fs.exists(!0)))}function Xd(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Kr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Gd(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Gd(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Jd?(u=Hp(e.firestore,Od),a=Nu(e.lf.path),h={next:function(t){n[i]&&n[i](Qd(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Hp(e,$d),u=Hp(s.firestore,Od),a=s.Rf,c=new Hd(u),h={next:function(t){n[i]&&n[i](new jd(u,c,s,t))},error:n[i+1],complete:n[i+2]},Iy(e.Rf)),function(n,t,e){var r=this,i=new Ep(h),o=new el(t,i,e);return n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Jf,[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.b_(),n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=$f,[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Pv(u),a,f)}function Zd(t,e){return function(n,r){var t=this,i=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rl,[4,vv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Pv(t),e)}function Qd(t,e,n){var r=n.docs.get(e.lf),i=new Hd(t);return new Md(t,i,e.lf,r,new Jv(n.hasPendingWrites,n.fromCache),e.ff)}var Jd=(Object.defineProperty(ey.prototype,"yf",{get:function(){return this.lf.path},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"path",{get:function(){return this.lf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(ey.prototype,"parent",{get:function(){return new _y(this.firestore,this.ff,this.lf.path.G())},enumerable:!1,configurable:!0}),ey.prototype.withConverter=function(t){return new ey(this.firestore,t,this.lf)},ey),$d=(ty.prototype.withConverter=function(t){return new ty(this.firestore,t,this.Rf)},ty),Ie=function(){};function ty(t,e,n){this.ff=e,this.Rf=n,this.type="query",this.firestore=t}function ey(t,e,n){this.ff=e,this.lf=n,this.type="document",this.firestore=t}function ny(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].gf(t)}return t}var ry,iy,oy,sy,uy,ay=(h(gy,uy=Ie),gy.prototype.gf=function(t){var e=Ry(t.firestore),e=function(t,e,n,r,i,o){if(r.rt()){if("array-contains"===i||"array-contains-any"===i)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){by(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(wy(n,t,c))}h={arrayValue:{values:s}}}else h=wy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||by(o,i),h=Wy(e,"where",o,"in"===i||"not-in"===i);var h=Fu.create(r,i,h);return function(t,e){if(e.Pn()){var n=Ou(t);if(null!==n&&!n.isEqual(e.field))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Du(t);null!==n&&Ey(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.Rf,e,t.firestore.q_,this.Vf,this.pf,this.bf);return new $d(t.firestore,t.ff,(t=t.Rf,e=t.filters.concat([e]),new Eu(t.path,t.collectionGroup,t.In.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},gy),cy=(h(vy,sy=Ie),vy.prototype.gf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ya(e,n);return e=r,null!==Du(n=t)||null!==(t=Ou(n))&&Ey(0,t,e.field),r}(t.Rf,this.Vf,this.vf);return new $d(t.firestore,t.ff,(t=t.Rf,e=t.In.concat([e]),new Eu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},vy),hy=(h(yy,oy=Ie),yy.prototype.gf=function(t){return new $d(t.firestore,t.ff,Lu(t.Rf,this.Sf,this.Df))},yy),fy=(h(dy,iy=Ie),dy.prototype.gf=function(t){var e=my(t,this.type,this.Cf,this.xf);return new $d(t.firestore,t.ff,(t=t.Rf,e=e,new Eu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},dy),ly=(h(py,ry=Ie),py.prototype.gf=function(t){var e=my(t,this.type,this.Cf,this.xf);return new $d(t.firestore,t.ff,(t=t.Rf,e=e,new Eu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},py);function py(t,e,n){var r=this;return(r=ry.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function dy(t,e,n){var r=this;return(r=iy.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function yy(t,e,n){var r=this;return(r=oy.call(this)||this).type=t,r.Sf=e,r.Df=n,r}function vy(t,e){var n=this;return(n=sy.call(this)||this).Vf=t,n.vf=e,n.type="orderBy",n}function gy(t,e,n){var r=this;return(r=uy.call(this)||this).Vf=t,r.pf=e,r.bf=n,r.type="where",r}function my(t,c,e,n){if(e[0]instanceof Kr&&(e[0]=e[0]._),e[0]instanceof dd)return function(t,e,n,r){if(!n)throw new Nr(Ar.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Pu(t);o<s.length;o++){var u=s[o];if(u.field.rt())i.push(Uo(e,n.key));else{var a=n.field(u.field);if(No(a))throw new Nr(Ar.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.et();throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ua(i,r)}(t.Rf,t.firestore.q_,e[0]._f,n);var r=Ry(t.firestore);return function(t,e,n,r,i,o){var s=t.In;if(i.length>s.length)throw new Nr(Ar.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.rt()){if("string"!=typeof c)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ku(t)&&-1!==c.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(li.nt(c));if(!yi.lt(h))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new yi(h);u.push(Uo(e,h))}else{c=Wy(n,r,c);u.push(c)}}return new ua(u,o)}(t.Rf,t.firestore.q_,r,c,e,n)}function wy(t,e,n){if(n instanceof Kr&&(n=n._),"string"==typeof n){if(""===n)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ku(e)&&-1!==n.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(li.nt(n));if(!yi.lt(e))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Uo(t,new yi(e))}if(n instanceof Jd)return Uo(t,n.lf);throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Kp(n)+".")}function by(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ey(t,e,n){if(!n.isEqual(e))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Iy(t){if(Su(t)&&0===t.In.length)throw new Nr(Ar.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ty,_y=(h(Ay,Ty=$d),Object.defineProperty(Ay.prototype,"id",{get:function(){return this.Rf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Ay.prototype,"path",{get:function(){return this.Rf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ay.prototype,"parent",{get:function(){var t=this.yf.G();return t.Y()?null:new Jd(this.firestore,null,new yi(t))},enumerable:!1,configurable:!0}),Ay.prototype.withConverter=function(t){return new Ay(this.firestore,t,this.yf)},Ay);function Ay(t,e,n){var r=this;return(r=Ty.call(this,t,e,Nu(n))||this).firestore=t,r.yf=n,r.type="collection",r}function Ny(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Kr&&(t=t._),qp("collection","path",e),t instanceof ld)return Gp(n=li.nt.apply(li,f([e],r))),new _y(t,null,n);if(!(t instanceof Jd||t instanceof _y))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Gp(n=li.nt.apply(li,f([t.path],r)).child(li.nt(e))),new _y(t.firestore,null,n)}function xy(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Kr&&(t=t._),1===arguments.length&&(e=Mr.t()),qp("doc","path",e),t instanceof ld)return zp(n=li.nt.apply(li,f([e],r))),new Jd(t,null,new yi(n));if(!(t instanceof Jd||t instanceof _y))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return zp(n=t.yf.child(li.nt.apply(li,f([e],r)))),new Jd(t.firestore,t instanceof _y?t.ff:null,new yi(n))}var Sy,Dy=(h(Oy,Sy=o),Oy.prototype.tf=function(t){return new Gr(t)},Oy.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new Jd(this.firestore,null,t)},Oy);function Oy(t){var e=this;return(e=Sy.call(this)||this).firestore=t,e}function ky(t,e){return t instanceof Kr&&(t=t._),e instanceof Kr&&(e=e._),(t instanceof Jd||t instanceof _y)&&(e instanceof Jd||e instanceof _y)&&t.firestore===e.firestore&&t.path===e.path&&t.ff===e.ff}function Py(t,e){return t instanceof Kr&&(t=t._),e instanceof Kr&&(e=e._),t instanceof $d&&e instanceof $d&&t.firestore===e.firestore&&Cu(t.Rf,e.Rf)&&t.ff===e.ff}function Ry(t){var e=t.H_(),n=Kh(t.q_);return new Fy(t.q_,!!e.ignoreUndefinedProperties,n)}var Ly=/^__.*__$/,Cy=(Uy.prototype.Pf=function(t,e){var n=[];return null!==this.sn?n.push(new Qs(t,this.data,this.sn,e)):n.push(new Zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new nu(t,this.fieldTransforms)),n},Uy),Vy=(My.prototype.Pf=function(t,e){e=[new Qs(t,this.data,this.sn,e)];return 0<this.fieldTransforms.length&&e.push(new nu(t,this.fieldTransforms)),e},My);function My(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Uy(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function jy(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var qy=(Object.defineProperty(zy.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(zy.prototype,"S_",{get:function(){return this.settings.S_},enumerable:!1,configurable:!0}),zy.prototype.Ff=function(t){return new zy(Object.assign(Object.assign({},this.settings),t),this.T,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.sn)},zy.prototype.Of=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Ff({path:e,x_:!1});return e.kf(t),e},zy.prototype.Mf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Ff({path:t,x_:!1});return t.Nf(),t},zy.prototype.$f=function(t){return this.Ff({path:void 0,x_:!0})},zy.prototype.D_=function(t){return ev(t,this.settings.methodName,this.settings.Lf||!1,this.path,this.settings.C_)},zy.prototype.contains=function(e){return void 0!==this.sn.find(function(t){return e.X(t)})||void 0!==this.fieldTransforms.find(function(t){return e.X(t.field)})},zy.prototype.Nf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kf(this.path.get(t))},zy.prototype.kf=function(t){if(0===t.length)throw this.D_("Document fields must not be empty");if(jy(this.S_)&&Ly.test(t))throw this.D_('Document fields cannot begin and end with "__"')},zy),Fy=(By.prototype.Bf=function(t,e,n,r){return void 0===r&&(r=!1),new qy({S_:t,methodName:e,C_:n,path:di.st(),x_:!1,Lf:r},this.T,this.serializer,this.ignoreUndefinedProperties)},By);function By(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.serializer=n||Kh(t)}function zy(t,e,n,r,i,o){this.settings=t,this.T=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nf(),this.fieldTransforms=i||[],this.sn=o||[]}function Gy(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bf(o.merge||o.mergeFields?2:0,e,n,i);Qy("Data must be an object, but it was:",s,r);var u,a,r=Xy(r,s);if(o.merge)u=new Ms(s.sn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Jy(e,f[h],n);if(!s.contains(l))throw new Nr(Ar.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");nv(c,l)||c.push(l)}u=new Ms(c),a=s.fieldTransforms.filter(function(t){return u.hn(t.field)})}else u=null,a=s.fieldTransforms;return new Cy(new cu(r),u,a)}function Ky(t,r,i,e){var o=t.Bf(1,r,i);Qy("Data must be an object, but it was:",o,e);var s=[],u=new hu;_o(e,function(t,e){var n=tv(r,t,i);e instanceof Kr&&(e=e._);t=o.Mf(n);e instanceof Zp?s.push(n):null!=(t=Yy(e,t))&&(s.push(n),u.set(n,t))});e=new Ms(s);return new Vy(u._n(),e,o.fieldTransforms)}function Hy(t,e,n,r,i,o){var s=t.Bf(1,e,n),u=[Jy(e,r,n)],a=[i];if(o.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Jy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new hu,y=u.length-1;0<=y;--y){nv(p,u[y])||(h=u[y],(f=a[y])instanceof Kr&&(f=f._),l=s.Mf(h),f instanceof Zp?p.push(h):null!=(l=Yy(f,l))&&(p.push(h),d.set(h,l)))}i=new Ms(p);return new Vy(d._n(),i,s.fieldTransforms)}function Wy(t,e,n,r){return void 0===r&&(r=!1),Yy(n,t.Bf(r?4:3,e))}function Yy(s,t){if(s instanceof Kr&&(s=s._),Zy(s))return Qy("Unsupported field value:",t,s),Xy(s,t);if(s instanceof Xp)return function(t,e){if(!jy(e.S_))throw e.D_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.D_(t._methodName+"() is not currently supported inside arrays");t=t.v_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.sn.push(t.path),s instanceof Array){if(t.settings.x_&&4!==t.S_)throw t.D_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Yy(i[r],t.$f(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Kr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Xo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hi.fromDate(t);return{timestampValue:Zo(e.serializer,n)}}if(t instanceof hi)return n=new hi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Zo(e.serializer,n)};if(t instanceof cd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gr)return{bytesValue:Qo(e.serializer,t.l)};if(t instanceof Jd){n=e.T;var r=t.firestore.q_;if(!r.isEqual(n))throw e.D_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:$o(t.firestore.q_||e.T,t.lf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.D_("Unsupported field value: "+Kp(t))}(s,t)}function Xy(t,n){var r={};return Ao(t)?n.path&&0<n.path.length&&n.sn.push(n.path):_o(t,function(t,e){e=Yy(e,n.Of(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Zy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hi||t instanceof cd||t instanceof Gr||t instanceof Jd||t instanceof Xp)}function Qy(t,e,n){if(!Zy(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Kp(n);throw"an object"===n?e.D_(t+" a custom object"):e.D_(t+" "+n)}var r}function Jy(t,e,n){if(e instanceof Kr&&(e=e._),e instanceof Dd)return e.df;if("string"==typeof e)return tv(t,e);throw ev("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var $y=new RegExp("[~\\*/\\[\\]]");function tv(e,n,r){if(0<=n.search($y))throw ev("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Dd.bind.apply(Dd,f([void 0],n.split("."))))).df}catch(t){throw ev("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function ev(t,e,n,r,i){var o=r&&!r.Y(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Nr(Ar.INVALID_ARGUMENT,(e+=". ")+t+n)}function nv(t,e){return t.some(function(t){return t.isEqual(e)})}var rv=(av.prototype.Wf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),0<this.mutations.length)throw new Nr(Ar.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=os((n=s).serializer)+"/documents",r={documents:u.map(function(t){return es(n.serializer,t)})},[4,n.Wa("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=ns(t,e.found.name),t=Jo(e.found.updateTime),e=new cu({mapValue:{fields:e.found.fields}});return new mu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);t=ns(t,e.missing),e=Jo(e.readTime);return new wu(t,e)}(e,t):Cr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Vr(!!t),o.push(t)}),o)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof wu||t instanceof mu?n.Gf(t):Cr()}),e)]}})})},av.prototype.set=function(t,e){this.write(e.Pf(t,this.cn(t))),this.Kf.add(t.toString())},av.prototype.update=function(t,e){try{this.write(e.Pf(t,this.zf(t)))}catch(t){this.Qf=t}this.Kf.add(t.toString())},av.prototype.delete=function(t){this.write([new uu(t,this.cn(t))]),this.Kf.add(t.toString())},av.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),this.Qf)throw this.Qf;return e=this.qf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=yi.at(e);n.mutations.push(new au(e,n.cn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=os((e=i).serializer)+"/documents",r={writes:o.map(function(t){return cs(e.serializer,t)})},[4,e.Ka("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.Uf=!0,[2]}})})},av.prototype.Gf=function(t){var e;if(t instanceof mu)e=t.version;else{if(!(t instanceof wu))throw Cr();e=fi.min()}var n=this.qf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Nr(Ar.ABORTED,"Document version changed between two reads.")}else this.qf.set(t.key.toString(),e)},av.prototype.cn=function(t){var e=this.qf.get(t.toString());return!this.Kf.has(t.toString())&&e?Fs.updateTime(e):Fs.an()},av.prototype.zf=function(t){var e=this.qf.get(t.toString());if(this.Kf.has(t.toString())||!e)return Fs.exists(!0);if(e.isEqual(fi.min()))throw new Nr(Ar.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fs.updateTime(e)},av.prototype.write=function(t){this.jf(),this.mutations=this.mutations.concat(t)},av.prototype.jf=function(){},av),iv=(uv.prototype.run=function(){this.Jf()},uv.prototype.Jf=function(){var t=this;this.Ci.Us(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new rv(this.eu),(n=this.Yf(e))&&n.then(function(t){r.Ei.yi(function(){return e.commit().then(function(){r.Ii.resolve(t)}).catch(function(t){r.Xf(t)})})}).catch(function(t){r.Xf(t)}),[2]})})})},uv.prototype.Yf=function(t){try{var e=this.updateFunction(t);return!Ni(e)&&e.catch&&e.then?e:(this.Ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ii.reject(t),null}},uv.prototype.Xf=function(t){var e=this;0<this.Hf&&this.Zf(t)?(--this.Hf,this.Ei.yi(function(){return e.Jf(),Promise.resolve()})):this.Ii.reject(t)},uv.prototype.Zf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ui(t)},uv),ov=(sv.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{Ei:this.Ei,n_:this.n_,clientId:this.clientId,credentials:this.credentials,I_:this.user,ol:100})]}})})},sv.prototype.ed=function(t){var e=this;this.td=t,this.N.promise.then(function(){return e.td(e.user)})},sv.prototype.nd=function(){if(this.Ei.Ni)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},sv.prototype.terminate=function(){var t=this;this.Ei.Mi();var n=new La;return this.Ei.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sd?[4,this.sd.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rd?[4,this.rd.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=rc(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},sv);function sv(t,e,n){var r=this;this.credentials=t,this.Ei=e,this.n_=n,this.user=$r.UNAUTHENTICATED,this.clientId=Mr.t(),this.td=function(){},this.N=new La,this.credentials.S(function(t){kr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.td(t)),r.N.resolve()})}function uv(t,e,n,r){this.Ei=t,this.eu=e,this.updateFunction=n,this.Ii=r,this.Hf=5,this.Ci=new Ca(this.Ei,"transaction_retry")}function av(t){this.eu=t,this.qf=new Map,this.mutations=[],this.Uf=!1,this.Qf=null,this.Kf=new Set}function cv(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ed(function(e){return r.Ei.$i(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sf(i.Zc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.cc(function(){return r.terminate()}),r.rd=i,[2]}})})}function hv(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),[4,fv(r)];case 1:return e=t.sent(),kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ed(function(t){return r.Ei.$i(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ei.qi(),kr("RemoteStore","RemoteStore received new credentials"),n=jf(e),e.ru.add(3),[4,Pf(e)];case 1:return t.sent(),n&&e.uu.set("Unknown"),[4,e.nu.V_(i)];case 2:return t.sent(),e.ru.delete(3),[4,kf(e)];case 3:return t.sent(),[2]}})})}(i.sl,t)})}),r.sd=i,[2]}})})}function fv(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rd?[3,2]:(kr("FirestoreClient","Using default OfflineComponentProvider"),[4,cv(e,new gp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rd]}})})}function lv(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sd?[3,2]:(kr("FirestoreClient","Using default OnlineComponentProvider"),[4,hv(e,new bp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sd]}})})}function pv(t){return fv(t).then(function(t){return t.persistence})}function dv(t){return fv(t).then(function(t){return t.Zc})}function yv(t){return lv(t).then(function(t){return t.sl})}function vv(t){return lv(t).then(function(t){return t.ju})}function gv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,lv(r)];case 1:return e=t.sent(),[2,((n=e.il).Iu=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Zl(s),(o=e.al.get(u))?(n=o.targetId,e.rl.wh(n),r=o.view.el(),[3,4]):[3,1];case 1:return[4,ff(e.Zc,Ru(u))];case 2:return i=t.sent(),o=e.rl.wh(i.targetId),n=i.targetId,[4,Pl(e,u,n,"current"===o)];case 3:r=t.sent(),e.ml&&Rf(e.sl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ju),n.Pu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).al.get(o),1<(r=e.ul.get(n.targetId)).length?[2,(e.ul.set(n.targetId,r.filter(function(t){return!Cu(t,o)})),void e.al.delete(o))]:e.ml?(e.rl.Th(n.targetId),e.rl.hh(n.targetId)?[3,2]:[4,lf(e.Zc,n.targetId,!1).then(function(){e.rl.Ih(n.targetId),Lf(e.sl,n.targetId),ql(e,n.targetId)}).catch(gf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ql(e,n.targetId),[4,lf(e.Zc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ju),n)]}})})}function mv(n,r,i){var t=this;void 0===i&&(i={});var o=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Ep({next:function(t){r.yi(function(){return $f(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Nr(Ar.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new el(Nu(i.path),t,{includeMetadataChanges:!0,Su:!0});return Jf(n,u)},[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}function wv(n,r,i){var t=this;void 0===i&&(i={});var o=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Ep({next:function(t){n.yi(function(){return $f(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Nr(Ar.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new el(t,o,{includeMetadataChanges:!0,Su:!0});return Jf(e,s)},[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}var bv=(Ev.prototype.set=function(t,e,n){this.ld();t=Iv(t,this.uf),e=pg(t.ff,e,n),n=Gy(this.hd,"WriteBatch.set",t.lf,e,null!==t.ff,n);return this.ad=this.ad.concat(n.Pf(t.lf,Fs.an())),this},Ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.ld();t=Iv(t,this.uf);return e instanceof Kr&&(e=e._),e="string"==typeof e||e instanceof Dd?Hy(this.hd,"WriteBatch.update",t.lf,e,n,r):Ky(this.hd,"WriteBatch.update",t.lf,e),this.ad=this.ad.concat(e.Pf(t.lf,Fs.exists(!0))),this},Ev.prototype.delete=function(t){this.ld();t=Iv(t,this.uf);return this.ad=this.ad.concat(new uu(t.lf,Fs.an())),this},Ev.prototype.commit=function(){return this.ld(),this.ud=!0,0<this.ad.length?this.od(this.ad):Promise.resolve()},Ev.prototype.ld=function(){if(this.ud)throw new Nr(Ar.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ev);function Ev(t,e){this.uf=t,this.od=e,this.ad=[],this.ud=!1,this.hd=Ry(t)}function Iv(t,e){if(t instanceof Kr&&(t=t._),t.firestore!==e)throw new Nr(Ar.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Tv,_v,Av=(kv.prototype.get=function(t){var e=this,n=Iv(t,this.uf),r=new Dy(this.uf);return this._d.Wf([n.lf]).then(function(t){if(!t||1!==t.length)return Cr();t=t[0];if(t instanceof wu)return new dd(e.uf,r,n.lf,null,n.ff);if(t instanceof mu)return new dd(e.uf,r,t.key,t,n.ff);throw Cr()})},kv.prototype.set=function(t,e,n){t=Iv(t,this.uf),e=pg(t.ff,e,n),n=Gy(this.hd,"Transaction.set",t.lf,e,null!==t.ff,n);return this._d.set(t.lf,n),this},kv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Iv(t,this.uf);return e instanceof Kr&&(e=e._),e="string"==typeof e||e instanceof Dd?Hy(this.hd,"Transaction.update",t.lf,e,n,r):Ky(this.hd,"Transaction.update",t.lf,e),this._d.update(t.lf,e),this},kv.prototype.delete=function(t){t=Iv(t,this.uf);return this._d.delete(t.lf),this},h(Ov,_v=kv),Ov.prototype.get=function(t){var e=this,n=Iv(t,this.uf),r=new Hd(this.uf);return _v.prototype.get.call(this,t).then(function(t){return new Md(e.uf,r,n.lf,t._f,new Jv(!1,!1),n.ff)})},Ov),Nv=(Dv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Ld(t=Hp(t,Od));var n=Pv(t),r=t.H_(),t=new bp;return Rd(n,t,new mp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},Dv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Ld(t=Hp(t,Od));var e=Pv(t),n=t.H_(),t=new bp;return Rd(e,t,new wp(t,n.cacheSizeBytes))}(t._)},Dv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.K_&&!n.W_)throw new Nr(Ar.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new La;return n.wf.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Va.Hs()?(e=n+"main",[4,Va.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Bh(n.q_,n.M_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},Dv),xv=(h(Sv,Tv=Kr),Object.defineProperty(Sv.prototype,"q_",{get:function(){return this._.q_},enumerable:!1,configurable:!0}),Sv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.z_()),t)).merge,this._.G_(t)},Sv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.z_().host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Sv.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,pv(r)];case 1:return e=t.sent(),[4,yv(r)];case 2:return n=t.sent(),[2,(e.ac(!0),(t=n).ru.delete(0),kf(t))]}})})})}(Pv(Hp(this._,Od)))},Sv.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,pv(r)];case 1:return e=t.sent(),[4,yv(r)];case 2:return n=t.sent(),[2,(e.ac(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(0),[4,Pf(e)];case 1:return t.sent(),e.uu.set("Offline"),[2]}})})}(n))]}})})})}(Pv(Hp(this._,Od)))},Sv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.fd.enableMultiTabIndexedDbPersistence(this):this.fd.enableIndexedDbPersistence(this,n)},Sv.prototype.clearPersistence=function(){return this.fd.clearIndexedDbPersistence(this)},Sv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Sv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ml,[4,vv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Pv(Hp(this._,Od)))},Sv.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new Ep(t);return n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.add(e),e.next()},[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.b_(),n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.delete(e)},[4,gv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Pv(Hp(e,Od)),Gd(t)?t:{next:t});var e},Object.defineProperty(Sv.prototype,"app",{get:function(){if(!this.dd)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!1,configurable:!0}),Sv.prototype.collection=function(t){try{return new ig(this,Ny(this._,t))}catch(t){throw zv(t,"collection()","Firestore.collection()")}},Sv.prototype.doc=function(t){try{return new jv(this,xy(this._,t))}catch(t){throw zv(t,"doc()","Firestore.doc()")}},Sv.prototype.collectionGroup=function(t){try{return new eg(this,function(t,e){if(t=Hp(t,ld),qp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new $d(t,null,(e=e,new Eu(li.st(),e)))}(this._,t))}catch(t){throw zv(t,"collectionGroup()","Firestore.collectionGroup()")}},Sv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,lv(n).then(function(t){return t.eu})];case 1:return e=t.sent(),new iv(n.Ei,e,r,i).run(),[2]}})})}),i.promise}(Pv(n=this._),function(t){return t=new Av(n,t),e(new Mv(r,t))})},Sv.prototype.batch=function(){var e=this;return Pv(this._),new Uv(new bv(this._,function(t){return Zd(e._,t)}))},Sv.prototype.loadBundle=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Sv.prototype.namedQuery=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Sv);function Sv(t,e,n){var r=this;return(r=Tv.call(this,e)||this).fd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Jr||(r.dd=t),r}function Dv(){}function Ov(t,e){var n=this;return(n=_v.call(this,t,e)||this).uf=t,n}function kv(t,e){this.uf=t,this._d=e,this.hd=Ry(t)}function Pv(t){return t.Ef||Rv(t),t.Ef.nd(),t.Ef}function Rv(t){var e,n,r=t.H_(),r=(e=t.q_,n=t.M_,new Qr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ef=new ov(t.U_,t.wf,r)}var Lv,Cv,Vv,Mv=(h(Bv,Vv=Kr),Bv.prototype.get=function(t){var e=this,t=lg(t);return this._.get(t).then(function(t){return new $v(e.uf,t)})},Bv.prototype.set=function(t,e,n){t=lg(t);return n?(Fp("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Bv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=lg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Bv.prototype.delete=function(t){t=lg(t);return this._.delete(t),this},Bv),Uv=(h(Fv,Cv=Kr),Fv.prototype.set=function(t,e,n){t=lg(t);return n?(Fp("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Fv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=lg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Fv.prototype.delete=function(t){t=lg(t);return this._.delete(t),this},Fv.prototype.commit=function(){return this._.commit()},Fv),jv=(h(qv,Lv=Kr),qv.wd=function(t,e,n){if(t.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.et()+" has "+t.length);return new qv(e,new Jd(e._,n,new yi(t)))},qv.af=function(t,e,n){return new qv(e,new Jd(e._,n,t))},Object.defineProperty(qv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(qv.prototype,"parent",{get:function(){return new ig(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(qv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),qv.prototype.collection=function(t){try{return new ig(this.firestore,Ny(this._,t))}catch(t){throw zv(t,"collection()","DocumentReference.collection()")}},qv.prototype.isEqual=function(t){return t instanceof Kr&&(t=t._),t instanceof Jd&&ky(this._,t)},qv.prototype.set=function(t,e){e=Fp("DocumentReference.set",e);try{return function(t,e,n){t=Hp(t,Jd);var r=Hp(t.firestore,Od),e=pg(t.ff,e,n);return Zd(r,Gy(Ry(r),"setDoc",t.lf,e,null!==t.ff,n).Pf(t.lf,Fs.an()))}(this._,t,e)}catch(t){throw zv(t,"setDoc()","DocumentReference.set()")}},qv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Yd(this._,t):Yd.apply(void 0,f([this._,t,e],n))}catch(t){throw zv(t,"updateDoc()","DocumentReference.update()")}},qv.prototype.delete=function(){return Zd(Hp((t=this._).firestore,Od),[new uu(t.lf,Fs.an())]);var t},qv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Gv(t),i=Kv(t,function(t){return new $v(e.firestore,new Md(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))});return Xd(this._,r,i)},qv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Hp(e,Jd);var n=Hp(e.firestore,Od),t=Pv(n),r=new Hd(n);return function(n,r){var t=this,i=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.sa.hs(t,e)}))];case 1:return(r=t.sent())instanceof mu?s.resolve(r):r instanceof wu?s.resolve(null):s.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=rc(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,dv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.lf).then(function(t){return new Md(n,r,e.lf,t,new Jv(t instanceof mu&&t.ln,!0),e.ff)})}:"server"===(null==t?void 0:t.source)?function(e){e=Hp(e,Jd);var n=Hp(e.firestore,Od);return mv(Pv(n),e.lf,{source:"server"}).then(function(t){return Qd(n,e,t)})}:function(e){e=Hp(e,Jd);var n=Hp(e.firestore,Od);return mv(Pv(n),e.lf).then(function(t){return Qd(n,e,t)})})(this._).then(function(t){return new $v(e.firestore,new Md(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))})},qv.prototype.withConverter=function(t){return new qv(this.firestore,this._.withConverter(t))},qv);function qv(t,e){var n=this;return(n=Lv.call(this,e)||this).firestore=t,n.hf=new pd(t),n}function Fv(){return null!==Cv&&Cv.apply(this,arguments)||this}function Bv(t,e){var n=this;return(n=Vv.call(this,e)||this).uf=t,n}function zv(t,e,n){return t.message=t.message.replace(e,n),t}function Gv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Gd(r))return r}return{}}function Kv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Gd(t[0])?t[0]:Gd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Hv,Wv,Yv,Xv,Zv,Qv,Jv=(fg.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},fg),$v=(h(hg,Qv=Kr),Object.defineProperty(hg.prototype,"ref",{get:function(){return new jv(this.uf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),hg.prototype.data=function(t){return this._.data(t)},hg.prototype.get=function(t,e){return this._.get(t,e)},hg.prototype.isEqual=function(t){return zd(this._,t._)},hg),tg=(h(cg,Zv=$v),cg.prototype.data=function(t){return this._.data(t)},cg),eg=(h(ag,Xv=Kr),ag.prototype.where=function(t,e,n){try{return new ag(this.firestore,ny(this._,(r=n,i=e,o=xd("where",t),new ay(o,i,r))))}catch(t){throw zv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},ag.prototype.orderBy=function(n,t){try{return new ag(this.firestore,ny(this._,function(t){void 0===t&&(t="asc");var e=t,t=xd("orderBy",n);return new cy(t,e)}(t)))}catch(n){throw zv(n,/(orderBy|where)\(\)/,"Query.$1()")}},ag.prototype.limit=function(t){try{return new ag(this.firestore,ny(this._,(Wp("limit",e=t),new hy("limit",e,"F"))))}catch(t){throw zv(t,"limit()","Query.limit()")}var e},ag.prototype.limitToLast=function(t){try{return new ag(this.firestore,ny(this._,(Wp("limitToLast",e=t),new hy("limitToLast",e,"L"))))}catch(t){throw zv(t,"limitToLast()","Query.limitToLast()")}var e},ag.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ny(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw zv(t,"startAt()","Query.startAt()")}},ag.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ny(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw zv(t,"startAfter()","Query.startAfter()")}},ag.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ny(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ly("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw zv(t,"endBefore()","Query.endBefore()")}},ag.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ag(this.firestore,ny(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ly("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw zv(t,"endAt()","Query.endAt()")}},ag.prototype.isEqual=function(t){return Py(this._,t._)},ag.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Hp(e,$d);var n=Hp(e.firestore,Od),t=Pv(n),r=new Hd(n);return function(n,r){var t=this,i=new La;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,pf(r,i,!0)];case 1:return n=t.sent(),e=new wl(i,n.la),n=e.Gh(n.documents),n=e.es(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=rc(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,dv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Rf).then(function(t){return new jd(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Hp(e,$d);var n=Hp(e.firestore,Od),t=Pv(n),r=new Hd(n);return wv(t,e.Rf,{source:"server"}).then(function(t){return new jd(n,r,e,t)})}:function(e){e=Hp(e,$d);var n=Hp(e.firestore,Od),t=Pv(n),r=new Hd(n);return Iy(e.Rf),wv(t,e.Rf).then(function(t){return new jd(n,r,e,t)})})(this._).then(function(t){return new rg(e.firestore,new jd(e.firestore._,e.hf,e._,t.mf))})},ag.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Gv(t),i=Kv(t,function(t){return new rg(e.firestore,new jd(e.firestore._,e.hf,e._,t.mf))});return Xd(this._,r,i)},ag.prototype.withConverter=function(t){return new ag(this.firestore,this._.withConverter(t))},ag),ng=(h(ug,Yv=Kr),Object.defineProperty(ug.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"doc",{get:function(){return new tg(this.uf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ug.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),ug),rg=(h(sg,Wv=Kr),Object.defineProperty(sg.prototype,"query",{get:function(){return new eg(this.uf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(sg.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new tg(e.uf,t)})},enumerable:!1,configurable:!0}),sg.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new ng(e.uf,t)})},sg.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new tg(r.uf,t))})},sg.prototype.isEqual=function(t){return zd(this._,t._)},sg),ig=(h(og,Hv=eg),Object.defineProperty(og.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"parent",{get:function(){var t=this._.parent;return t?new jv(this.firestore,t):null},enumerable:!1,configurable:!0}),og.prototype.doc=function(t){try{return new jv(this.firestore,void 0===t?xy(this._):xy(this._,t))}catch(t){throw zv(t,"doc()","CollectionReference.doc()")}},og.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=Hp(e.firestore,Od),r=xy(e),n=pg(e.ff,n),Zd(t,Gy(Ry(e.firestore),"addDoc",r.lf,n,null!==e.ff,{}).Pf(r.lf,Fs.exists(!1))).then(function(){return r}).then(function(t){return new jv(i.firestore,t)})},og.prototype.isEqual=function(t){return ky(this._,t._)},og.prototype.withConverter=function(t){return new og(this.firestore,this._.withConverter(t))},og);function og(t,e){var n=this;return(n=Hv.call(this,t,e)||this).firestore=t,n._=e,n}function sg(t,e){var n=this;return(n=Wv.call(this,e)||this).uf=t,n}function ug(t,e){var n=this;return(n=Yv.call(this,e)||this).uf=t,n}function ag(t,e){var n=this;return(n=Xv.call(this,e)||this).firestore=t,n.hf=new pd(t),n}function cg(){return null!==Zv&&Zv.apply(this,arguments)||this}function hg(t,e){var n=this;return(n=Qv.call(this,e)||this).uf=t,n}function fg(t,e){this.hasPendingWrites=t,this.fromCache=e}function lg(t){return t instanceof Kr&&(t=t._),Hp(t,Jd)}function pg(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var dg,yg,Ie=(h(wg,yg=Kr),wg.documentId=function(){return new wg(di.ot().et())},wg.prototype.isEqual=function(t){return t instanceof Kr&&(t=t._),t instanceof Dd&&this._.df.isEqual(t.df)},wg),o=(h(mg,dg=Kr),mg.serverTimestamp=function(){var t=new od("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new mg(t)},mg.delete=function(){var t=new Zp("deleteField");return t._methodName="FieldValue.delete",new mg(t)},mg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new mg(n)},mg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ud("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new mg(n)},mg.increment=function(t){t=new ad("increment",t);return t._methodName="FieldValue.increment",new mg(t)},mg.prototype.isEqual=function(t){return this._.isEqual(t._)},mg),vg=(gg.prototype.onProgress=function(t,e,n){this.Ed={next:t,error:e,complete:n}},gg.prototype.catch=function(t){return this.Td.promise.catch(t)},gg.prototype.then=function(t,e){return this.Td.promise.then(t,e)},gg.prototype.Rl=function(t){this.Pl(t),this.Ed.complete&&this.Ed.complete(),this.Td.resolve(t)},gg.prototype.yl=function(t){this.md.taskState="Error",this.Ed.next&&this.Ed.next(this.md),this.Ed.error&&this.Ed.error(t),this.Td.reject(t)},gg.prototype.Pl=function(t){this.md=t,this.Ed.next&&this.Ed.next(t)},gg);function gg(){this.Ed={},this.Td=new La,this.md={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function mg(){return null!==dg&&dg.apply(this,arguments)||this}function wg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return yg.call(this,new(Dd.bind.apply(Dd,f([void 0],t))))||this}var bg=(Eg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Eg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Eg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Eg);function Eg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ig,Tg,_g={Firestore:xv,GeoPoint:cd,Timestamp:hi,Blob:Zr,Transaction:Mv,WriteBatch:Uv,DocumentReference:jv,DocumentSnapshot:$v,Query:eg,QueryDocumentSnapshot:tg,QuerySnapshot:rg,CollectionReference:ig,FieldPath:Ie,FieldValue:o,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Ig=e.default).INTERNAL.registerComponent(new bg("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new xv(e,new Od(e,t),new Nv)},"PUBLIC").setServiceProps(Object.assign({},_g))),Ig.registerVersion("@firebase/firestore","2.0.4-BundlePrerelease.f8bb4d8b7"),(Tg=xv).prototype.loadBundle=function(t){return e=this,o=t,t=new vg,function(n,t,r){var e=this,i=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Wh(Gh(t),e)}(o,Kh(t));n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Jl,[4,vv(n)];case 1:return e.apply(void 0,[t.sent(),i,r]),[2]}})})})}(Pv(e._),e.q_,t),t;var e,o},Tg.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.tc.wo(t,e)})},[4,dv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Pv((e=this)._),t).then(function(t){return t?new eg(e,new $d(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
