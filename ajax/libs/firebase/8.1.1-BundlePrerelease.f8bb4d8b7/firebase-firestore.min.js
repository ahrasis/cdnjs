!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ig){"use strict";try{(function(){var l,t,e=(t=ig)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function x(){}function S(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function L(t,e,n){return(L=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:R).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++k))},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var G=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function H(t,e){return t<e?-1:e<t?1:0}var W=N.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(W=W&&W.userAgent)?W:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function J(t){return J[" "](t),t}J[" "]=x;var $,tt=K(ut,"Opera"),et=K(ut,"Trident")||K(ut,"MSIE"),nt=K(ut,"Edge"),rt=nt||et,it=K(ut,"Gecko")&&!(K(ut.toLowerCase(),"webkit")&&!K(ut,"Edge"))&&!(K(ut,"Trident")||K(ut,"MSIE"))&&!K(ut,"Edge"),ot=K(ut.toLowerCase(),"webkit")&&!K(ut,"Edge");function st(){var t=N.document;return t?t.documentMode:void 0}var W="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(W=ut?ut[1]:""),$=et&&null!=(ut=st())&&ut>parseFloat(W)?String(ut):W;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=G(String($)).split("."),n=G(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=H(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||H(0==o[2].length,0==s[2].length)||H(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=N.document&&et&&(st()||parseInt($,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",x,e),N.removeEventListener("test",x,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{J(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},M(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Tt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Tt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var _t="closure_lm_"+(1e6*Math.random()|0),At={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Lt(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):xt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Lt(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):xt(t,e,n,!1,r,i)}function xt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Pt(t);if(c||(t[_t]=c=new Et(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function St(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(It(n,t),0==n.b&&(n.src=null,e[_t]=null)):bt(t)))}function Dt(t){return t in At?At[t]:At[t]="on"+t}function Ot(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&St(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return Ot(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ot(t,e=new yt(e,this))}function Pt(t){return(t=t[_t])instanceof Et?t:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lt(e){return"function"==typeof e?e:(e[Rt]||(e[Rt]=function(t){return e.handleEvent(t)}),e[Rt])}function Ct(){U.call(this),this.c=new Et(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,Q(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Ct,U),Ct.prototype[gt]=!0,(ut=Ct.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Lt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Tt(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Tt(n,r,i,o)),(r=-1<e?n[e]:null)&&St(r))}(this,t,e,n,r)},ut.G=function(){if(Ct.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=N.JSON.stringify;function jt(){this.b=this.a=null}var qt,Ft=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new zt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Gt(t,e){var n;qt||(n=N.Promise.resolve(void 0),qt=function(){n.then(Wt)}),Kt||(qt(),Kt=!0),Ht.add(t,e)}jt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Ht=new jt;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Ht).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function Yt(t,e){Ct.call(this),this.b=t||1,this.a=e||N,this.f=L(this.Za,this),this.g=V()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==typeof t)n&&(t=L(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=L(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}M(Yt,Ct),(ut=Yt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Xt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Yt.X.G.call(this),Xt(this),delete this.a};var Qt,Jt,$t=(T(Jt=ee,W=Qt=U),Jt.prototype=null===W?Object.create(W):(te.prototype=W.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Qt.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=Jt}function ee(t,e){var n=Qt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){U.call(this),this.b=t,this.a={}}M(ne,U);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&St(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ut(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Ct}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ae.Fa="serverreachability",M(fe,dt),ae.STAT_EVENT="statevent",M(pe,dt),ae.Ga="timingevent",M(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Ie,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Te(){dt.call(this,"d")}function _e(){dt.call(this,"c")}function Ae(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=xe,t=rt?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Te,dt),M(_e,dt),M(Ae,we),Ie=new Ae;var xe=45e3,Se={},De={};function Oe(t,e,n){t.H=1,t.i=Qe(Ke(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=V(),Re(t),t.l=Ke(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new $t(L(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?Se:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Se){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Re(t){t.T=V()+t.P,Le(t,t.P)}function Le(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(L(t.Va,t),e)}function Ce(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||$n(t.g,t)}function Me(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Jn(u),Fn(u)}Xn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(L(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Jn(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Re(o)),n.a=i):Yn(n),0<u.g.length&&Gn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):qn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Me(this),Ve(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,s)}this.I?(Pe(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Ue(this,n)),4==e&&Me(this),this.b&&!this.A&&(4==e?$n(this.g,this):(this.b=!1,Re(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Me(this),Ve(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Pe(this,t,e),this.b&&4!=t&&Re(this)))},ut.cancel=function(){this.A=!0,Me(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Me(this),this.h=2,Ve(this)):Le(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ge(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ge?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,We(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Xe(this,n),this.i=t.i):t&&(n=String(t).match(ze))?(this.a=!!e,He(this,n[1]||"",!0),this.j=Je(n[2]||""),We(this,n[3]||"",!0),Ye(this,n[4]),this.g=Je(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=Je(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function Ke(t){return new Ge(t)}function He(t,e,n){t.f=n?Je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function We(t,e,n){t.c=n?Je(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=$e(e,on)),t.b=new un(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function Qe(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function Je(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $e(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ge.prototype.toString=function(){var t=[],e=this.f;e&&t.push($e(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push($e(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push($e(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",$e(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=F(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function In(){}function Tn(){this.a=new In}function _n(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},In.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},In.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var An=N.JSON.parse;function Nn(t){Ct.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=xn,this.D=this.F=!1}M(Nn,Ct);var xn="",Sn=/^https?$/i,Dn=["POST","PUT"];function On(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Ln(t)}function Pn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Rn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Zt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(ze)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!Sn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Un("baseRetryDelayMs",5e3,t),this.Ra=Un("retryDelaySeedMs",1e4,t),this.Ma=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new Tn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Ze(n=Ke(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Hn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Qe(Ke(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Re(e)),nr(t)}function Fn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Bn(t){Fn(t),t.j&&(N.clearTimeout(t.j),t.j=null),Jn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function zn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){vn(t.b)||t.h||(t.h=!0,Gt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Hn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Oe(n,r,e)}function Hn(t,n){t.f&&je({},function(t,e){Ze(n,e,t)})}function Wn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?L(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;D(t)&&(n=Ut(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,Gt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(L(t.Aa,t),tr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Hn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(Ke(e)),n.j=null,n.I=!0,ke(n,t)}function Jn(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function $n(t,e){var n,r,i,o=null;if(t.a==e){Jn(t),Zn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),Gn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(L(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Xn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=L(t.Ya,t),r||(r=new Ge("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||He(r,"https"),Qe(r)),n=r.toString(),r=o,o=new se,N.Image?((i=new Image).onload=C(_n,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(_n,o,i,"TestLoadImage: error",!1,r),i.onabort=C(_n,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(_n,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ge?Ke(s):new Ge(s,void 0);return""!=a.c?(e&&We(a,e+"."+a.c),Ye(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ge(null,void 0),r&&He(u,r),i&&We(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ct.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){_e.call(this),this.status=1}function hr(t){this.a=t}(ut=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ie),this.a.onreadystatechange=L(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=On,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=j(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=L(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Ln(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ln(this,!0)),Nn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Rn(this):this.Ua())},ut.Ua=function(){Rn(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Q(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),Ze(i=Ke(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&Mn(i,this.i,r),wn(this.b,n),this.Ia&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.U=!0,Oe(n,i,null)):Oe(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||vn(this.b)||Kn(this))},ut.Aa=function(){var t;this.j=null,Qn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(L(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Qn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Xn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Ct),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Gn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,zn(this.a,e)):this.l?((e={}).__data__=Ut(t),zn(this.a,e)):zn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Te),M(cr,_e),M(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Ct.prototype.listen=Ct.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Qa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Pa,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var fr,lr=he,pr=ge,dr=me,yr=ae,vr=Ee,gr=Nn,mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},wr=(h(Ir,fr=Error),Ir),br="8.1.1-BundlePrerelease.f8bb4d8b7",Er=new o("@firebase/firestore");function Ir(t,e){var n=this;return(n=fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Tr(){return Er.logLevel}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=l.DEBUG&&(e=n.map(xr),Er.debug.apply(Er,f(["Firestore ("+br+"): "+t],e)))}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=l.ERROR&&(e=n.map(xr),Er.error.apply(Er,f(["Firestore ("+br+"): "+t],e)))}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=l.WARN&&(e=n.map(xr),Er.warn.apply(Er,f(["Firestore ("+br+"): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Sr(t){throw void 0===t&&(t="Unexpected state"),Ar(t="FIRESTORE ("+br+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Dr(t){t||Sr()}var Or=(kr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},kr);function kr(){}function Pr(t,e){return t<e?-1:e<t?1:0}function Rr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Lr(t){return t+"\0"}var Cr=(Vr.fromBase64String=function(t){return new Vr(atob(t))},Vr.fromUint8Array=function(t){return new Vr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Vr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Vr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Vr.prototype.o=function(){return 2*this.i.length},Vr.prototype.u=function(t){return Pr(this.i,t.i)},Vr.prototype.isEqual=function(t){return this.i===t.i},Vr);function Vr(t){this.i=t}Cr.h=new Cr("");var Mr=(jr.fromBase64String=function(t){try{return new jr(Cr.fromBase64String(t))}catch(t){throw new wr(mr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},jr.fromUint8Array=function(t){return new jr(Cr.fromUint8Array(t))},jr.prototype.toBase64=function(){return this.l.toBase64()},jr.prototype.toUint8Array=function(){return this.l.toUint8Array()},jr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},jr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},jr),Ur=function(t){this._=t};function jr(t){this.l=t}function qr(){if("undefined"==typeof Uint8Array)throw new wr(mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Fr(){if("undefined"==typeof atob)throw new wr(mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Br,zr=(h(Xr,Br=Ur),Xr.fromBase64String=function(t){return Fr(),new Xr(Mr.fromBase64String(t))},Xr.fromUint8Array=function(t){return qr(),new Xr(Mr.fromUint8Array(t))},Xr.prototype.toBase64=function(){return Fr(),this._.toBase64()},Xr.prototype.toUint8Array=function(){return qr(),this._.toUint8Array()},Xr.prototype.isEqual=function(t){return this._.isEqual(t._)},Xr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xr),Gr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},Kr=(Object.defineProperty(Yr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Yr.prototype.isEqual=function(t){return t instanceof Yr&&t.projectId===this.projectId&&t.database===this.database},Yr),Hr=(Wr.prototype.A=function(){return null!=this.uid},Wr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Wr.prototype.isEqual=function(t){return t.uid===this.uid},Wr);function Wr(t){this.uid=t}function Yr(t,e){this.projectId=t,this.database=e||"(default)"}function Xr(){return null!==Br&&Br.apply(this,arguments)||this}function Zr(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}Hr.UNAUTHENTICATED=new Hr(null),Hr.P=new Hr("google-credentials-uid"),Hr.g=new Hr("first-party-uid");var Qr,Jr,$r=(mi.prototype.getToken=function(){return Promise.resolve(null)},mi.prototype.v=function(){},mi.prototype.S=function(t){(this.p=t)(Hr.UNAUTHENTICATED)},mi.prototype.D=function(){this.p=null},mi),ti=(gi.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(_r("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new Zr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},gi.prototype.v=function(){this.forceRefresh=!0},gi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},gi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},gi.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new Hr(t)},gi),ei=(Object.defineProperty(vi.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),vi),ni=(yi.prototype.getToken=function(){return Promise.resolve(new ei(this.k,this.M))},yi.prototype.S=function(t){t(Hr.g)},yi.prototype.D=function(){},yi.prototype.v=function(){},yi),ri=(di.now=function(){return di.fromMillis(Date.now())},di.fromDate=function(t){return di.fromMillis(t.getTime())},di.fromMillis=function(t){var e=Math.floor(t/1e3);return new di(e,1e6*(t-1e3*e))},di.prototype.toDate=function(){return new Date(this.toMillis())},di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},di.prototype.$=function(t){return this.seconds===t.seconds?Pr(this.nanoseconds,t.nanoseconds):Pr(this.seconds,t.seconds)},di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},di),ii=(pi.L=function(t){return new pi(t)},pi.min=function(){return new pi(new ri(0,0))},pi.prototype.u=function(t){return this.timestamp.$(t.timestamp)},pi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},pi.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},pi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},pi.prototype.q=function(){return this.timestamp},pi),ge=(Object.defineProperty(li.prototype,"length",{get:function(){return this.U},enumerable:!1,configurable:!0}),li.prototype.isEqual=function(t){return 0===li.K(this,t)},li.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof li?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},li.prototype.limit=function(){return this.offset+this.length},li.prototype.j=function(t){return t=void 0===t?1:t,this.W(this.segments,this.offset+t,this.length-t)},li.prototype.G=function(){return this.W(this.segments,this.offset,this.length-1)},li.prototype.H=function(){return this.segments[this.offset]},li.prototype.J=function(){return this.get(this.length-1)},li.prototype.get=function(t){return this.segments[this.offset+t]},li.prototype.Y=function(){return 0===this.length},li.prototype.X=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},li.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},li.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},li.K=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},li),oi=(h(fi,Jr=ge),fi.prototype.W=function(t,e,n){return new fi(t,e,n)},fi.prototype.et=function(){return this.tt().join("/")},fi.prototype.toString=function(){return this.et()},fi.nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new wr(mr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new fi(n)},fi.st=function(){return new fi([])},fi),si=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ui=(h(hi,Qr=ge),hi.prototype.W=function(t,e,n){return new hi(t,e,n)},hi.it=function(t){return si.test(t)},hi.prototype.et=function(){return this.tt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hi.it(t)||(t="`"+t+"`"),t}).join(".")},hi.prototype.toString=function(){return this.et()},hi.prototype.rt=function(){return 1===this.length&&"__name__"===this.get(0)},hi.ot=function(){return new hi(["__name__"])},hi.ct=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new wr(mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new wr(mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new wr(mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new hi(e)},hi.st=function(){return new hi([])},hi),ai=(ci.at=function(t){return new ci(oi.nt(t))},ci.ut=function(t){return new ci(oi.nt(t).j(5))},ci.prototype.ht=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ci.prototype.isEqual=function(t){return null!==t&&0===oi.K(this.path,t.path)},ci.prototype.toString=function(){return this.path.toString()},ci.K=function(t,e){return oi.K(t.path,e.path)},ci.lt=function(t){return t.length%2==0},ci._t=function(t){return new ci(new oi(t.slice()))},ci);function ci(t){this.path=t}function hi(){return null!==Qr&&Qr.apply(this,arguments)||this}function fi(){return null!==Jr&&Jr.apply(this,arguments)||this}function li(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.U=n}function pi(t){this.timestamp=t}function di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new wr(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new wr(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new wr(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new wr(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function yi(t,e){this.k=t,this.M=e}function vi(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Hr.g}function gi(t){var e=this;this.C=null,this.currentUser=Hr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function mi(){this.p=null}function wi(t){return null==t}function bi(t){return 0===t&&1/t==-1/0}function Ei(t){return"number"==typeof t&&Number.isInteger(t)&&!bi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ii=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ft=null};function Ti(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ii(t,e,n,r,i,o,s)}function _i(t){var e=t;return null===e.ft&&(t=e.path.et(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.et()+t.op.toString()+xo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.et()+t.dir}).join(","),wi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ra(e.startAt)),e.endAt&&(t+="|ub:",t+=ra(e.endAt)),e.ft=t),e.ft}function Ai(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!To(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oa(t.startAt,e.startAt)&&oa(t.endAt,e.endAt)}function Ni(t){return ai.lt(t.path)&&null===t.collectionGroup&&0===t.filters.length}function xi(t){this.count=t}var Si,Di=(Oi.prototype.Et=function(t){return new Oi(this.target,this.targetId,this.dt,t,this.wt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Oi.prototype.Tt=function(t,e){return new Oi(this.target,this.targetId,this.dt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Oi.prototype.It=function(t){return new Oi(this.target,this.targetId,this.dt,this.sequenceNumber,this.wt,t,this.resumeToken)},Oi);function Oi(t,e,n,r,i,o,s){void 0===i&&(i=ii.min()),void 0===o&&(o=ii.min()),void 0===s&&(s=Cr.h),this.target=t,this.targetId=e,this.dt=n,this.sequenceNumber=r,this.wt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case mr.OK:return Sr(),0;case mr.CANCELLED:case mr.UNKNOWN:case mr.DEADLINE_EXCEEDED:case mr.RESOURCE_EXHAUSTED:case mr.INTERNAL:case mr.UNAVAILABLE:case mr.UNAUTHENTICATED:return;case mr.INVALID_ARGUMENT:case mr.NOT_FOUND:case mr.ALREADY_EXISTS:case mr.PERMISSION_DENIED:case mr.FAILED_PRECONDITION:case mr.ABORTED:case mr.OUT_OF_RANGE:case mr.UNIMPLEMENTED:case mr.DATA_LOSS:return 1;default:return Sr(),0}}function Pi(t){if(void 0===t)return Ar("GRPC error has no .code"),mr.UNKNOWN;switch(t){case Si.OK:return mr.OK;case Si.CANCELLED:return mr.CANCELLED;case Si.UNKNOWN:return mr.UNKNOWN;case Si.DEADLINE_EXCEEDED:return mr.DEADLINE_EXCEEDED;case Si.RESOURCE_EXHAUSTED:return mr.RESOURCE_EXHAUSTED;case Si.INTERNAL:return mr.INTERNAL;case Si.UNAVAILABLE:return mr.UNAVAILABLE;case Si.UNAUTHENTICATED:return mr.UNAUTHENTICATED;case Si.INVALID_ARGUMENT:return mr.INVALID_ARGUMENT;case Si.NOT_FOUND:return mr.NOT_FOUND;case Si.ALREADY_EXISTS:return mr.ALREADY_EXISTS;case Si.PERMISSION_DENIED:return mr.PERMISSION_DENIED;case Si.FAILED_PRECONDITION:return mr.FAILED_PRECONDITION;case Si.ABORTED:return mr.ABORTED;case Si.OUT_OF_RANGE:return mr.OUT_OF_RANGE;case Si.UNIMPLEMENTED:return mr.UNIMPLEMENTED;case Si.DATA_LOSS:return mr.DATA_LOSS;default:return Sr()}}(me=Si={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Ri=(Ui.prototype.At=function(t,e){return new Ui(this.K,this.root.At(t,e,this.K).copy(null,null,Ci.Rt,null,null))},Ui.prototype.remove=function(t){return new Ui(this.K,this.root.remove(t,this.K).copy(null,null,Ci.Rt,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e.Y();){var n=this.K(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.Y();){var r=this.K(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype.Y=function(){return this.root.Y()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.Pt=function(){return this.root.Pt()},Ui.prototype.yt=function(){return this.root.yt()},Ui.prototype.gt=function(t){return this.root.gt(t)},Ui.prototype.forEach=function(n){this.gt(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.gt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.Vt=function(t){return this.root.Vt(t)},Ui.prototype.bt=function(){return new Li(this.root,null,this.K,!1)},Ui.prototype.vt=function(t){return new Li(this.root,t,this.K,!1)},Ui.prototype.St=function(){return new Li(this.root,null,this.K,!0)},Ui.prototype.Dt=function(t){return new Li(this.root,t,this.K,!0)},Ui),Li=(Mi.prototype.Nt=function(){var t=this.xt.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.Y();)this.xt.push(t),t=t.right;else for(t=t.right;!t.Y();)this.xt.push(t),t=t.left;return e},Mi.prototype.Ft=function(){return 0<this.xt.length},Mi.prototype.Ot=function(){if(0===this.xt.length)return null;var t=this.xt[this.xt.length-1];return{key:t.key,value:t.value}},Mi),Ci=(Vi.prototype.copy=function(t,e,n,r,i){return new Vi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Vi.prototype.Y=function(){return!1},Vi.prototype.gt=function(t){return this.left.gt(t)||t(this.key,this.value)||this.right.gt(t)},Vi.prototype.Vt=function(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)},Vi.prototype.min=function(){return this.left.Y()?this:this.left.min()},Vi.prototype.Pt=function(){return this.min().key},Vi.prototype.yt=function(){return this.right.Y()?this.key:this.right.yt()},Vi.prototype.At=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.At(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.At(t,e,n))).kt()},Vi.prototype.Mt=function(){if(this.left.Y())return Vi.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Mt(),null)).kt()},Vi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.Y()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.Bt()),r.right.Y()||r.right.$t()||r.right.left.$t()||(r=r.qt()),0===e(t,r.key)){if(r.right.Y())return Vi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Mt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.kt()},Vi.prototype.$t=function(){return this.color},Vi.prototype.kt=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.Bt()),t.left.$t()&&t.right.$t()&&(t=t.Qt()),t},Vi.prototype.Lt=function(){var t=this.Qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Bt())).Ut()).Qt()),t},Vi.prototype.qt=function(){var t=this.Qt();return t.left.left.$t()&&(t=(t=t.Bt()).Qt()),t},Vi.prototype.Ut=function(){var t=this.copy(null,null,Vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Vi.prototype.Bt=function(){var t=this.copy(null,null,Vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Vi.prototype.Qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Vi.prototype.Kt=function(){var t=this.Wt();return Math.pow(2,t)<=this.size+1},Vi.prototype.Wt=function(){if(this.$t()&&this.left.$t())throw Sr();if(this.right.$t())throw Sr();var t=this.left.Wt();if(t!==this.right.Wt())throw Sr();return t+(this.$t()?0:1)},Vi);function Vi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Vi.RED,this.left=null!=r?r:Vi.EMPTY,this.right=null!=i?i:Vi.EMPTY,this.size=this.left.size+1+this.right.size}function Mi(t,e,n,r){this.Ct=r,this.xt=[];for(var i=1;!t.Y();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.xt.push(t);break}this.xt.push(t),t=this.Ct?t.right:t.left}}function Ui(t,e){this.K=t,this.root=e||Ci.EMPTY}function ji(){this.size=0}Ci.EMPTY=null,Ci.RED=!0,Ci.Rt=!1,Ci.EMPTY=(Object.defineProperty(ji.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),ji.prototype.copy=function(t,e,n,r,i){return this},ji.prototype.At=function(t,e,n){return new Ci(t,e)},ji.prototype.remove=function(t,e){return this},ji.prototype.Y=function(){return!0},ji.prototype.gt=function(t){return!1},ji.prototype.Vt=function(t){return!1},ji.prototype.Pt=function(){return null},ji.prototype.yt=function(){return null},ji.prototype.$t=function(){return!1},ji.prototype.Kt=function(){return!0},ji.prototype.Wt=function(){return 0},new ji);var qi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.Pt()},Gi.prototype.last=function(){return this.data.yt()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.gt(function(t,e){return n(t),!1})},Gi.prototype.jt=function(t,e){for(var n=this.data.vt(t[0]);n.Ft();){var r=n.Nt();if(0<=this.K(r.key,t[1]))return;e(r.key)}},Gi.prototype.Gt=function(t,e){for(var n=void 0!==e?this.data.vt(e):this.data.bt();n.Ft();)if(!t(n.Nt().key))return},Gi.prototype.zt=function(t){return(t=this.data.vt(t)).Ft()?t.Nt().key:null},Gi.prototype.bt=function(){return new Fi(this.data.bt())},Gi.prototype.vt=function(t){return new Fi(this.data.vt(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).At(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype.Y=function(){return this.data.Y()},Gi.prototype.Ht=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(0!==this.K(r,i))return!1}return!0},Gi.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.K);return e.data=t,e},Gi),Fi=(zi.prototype.Nt=function(){return this.Jt.Nt().key},zi.prototype.Ft=function(){return this.Jt.Ft()},zi),Bi=new Ri(ai.K);function zi(t){this.Jt=t}function Gi(t){this.K=t,this.data=new Ri(this.K)}var Ki=new Ri(ai.K),Hi=new Ri(ai.K),Wi=new qi(ai.K);function Yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Wi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Xi=new qi(Pr),Zi=(lo.Zt=function(t){return new lo(t.K)},lo.prototype.has=function(t){return null!=this.Yt.get(t)},lo.prototype.get=function(t){return this.Yt.get(t)},lo.prototype.first=function(){return this.Xt.Pt()},lo.prototype.last=function(){return this.Xt.yt()},lo.prototype.Y=function(){return this.Xt.Y()},lo.prototype.indexOf=function(t){return(t=this.Yt.get(t))?this.Xt.indexOf(t):-1},Object.defineProperty(lo.prototype,"size",{get:function(){return this.Xt.size},enumerable:!1,configurable:!0}),lo.prototype.forEach=function(n){this.Xt.gt(function(t,e){return n(t),!1})},lo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Yt.At(t.key,t),e.Xt.At(t,null))},lo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Yt.remove(t),this.Xt.remove(e)):this},lo.prototype.isEqual=function(t){if(!(t instanceof lo))return!1;if(this.size!==t.size)return!1;for(var e=this.Xt.bt(),n=t.Xt.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(!r.isEqual(i))return!1}return!0},lo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},lo.prototype.copy=function(t,e){var n=new lo;return n.K=this.K,n.Yt=t,n.Xt=e,n},lo),Qi=(fo.prototype.track=function(t){var e=t.doc.key,n=this.te.get(e);!n||0!==t.type&&3===n.type?this.te=this.te.At(e,t):3===t.type&&1!==n.type?this.te=this.te.At(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.te=this.te.At(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.te=this.te.remove(e):1===t.type&&2===n.type?this.te=this.te.At(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):Sr()},fo.prototype.ee=function(){var n=[];return this.te.gt(function(t,e){n.push(e)}),n},fo),Ji=(ho.oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ho(t,e,Zi.Zt(e),i,n,r,!0,!1)},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return!this.se.Y()},enumerable:!1,configurable:!0}),ho.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ie===t.ie&&this.se.isEqual(t.se)&&Nu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.ne.isEqual(t.ne)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ho),$i=(co.le=function(t,e){var n=new Map;return n.set(t,to._e(t,e)),new co(ii.min(),n,Xi,Bi,Yi())},co),to=(ao._e=function(t,e){return new ao(Cr.h,e,Yi(),Yi(),Yi())},ao),eo=function(t,e,n,r){this.Te=t,this.removedTargetIds=e,this.key=n,this.me=r},no=function(t,e){this.targetId=t,this.Ie=e},ro=function(t,e,n,r){void 0===n&&(n=Cr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},io=(Object.defineProperty(uo.prototype,"fe",{get:function(){return this.ye},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"resumeToken",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"Ve",{get:function(){return 0!==this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"pe",{get:function(){return this.ge},enumerable:!1,configurable:!0}),uo.prototype.be=function(t){0<t.o()&&(this.ge=!0,this.Pe=t)},uo.prototype.ve=function(){var n=Yi(),r=Yi(),i=Yi();return this.Re.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Sr()}}),new to(this.Pe,this.ye,n,r,i)},uo.prototype.Se=function(){this.ge=!1,this.Re=yo()},uo.prototype.De=function(t,e){this.ge=!0,this.Re=this.Re.At(t,e)},uo.prototype.Ce=function(t){this.ge=!0,this.Re=this.Re.remove(t)},uo.prototype.xe=function(){this.Ae+=1},uo.prototype.Ne=function(){--this.Ae},uo.prototype.Fe=function(){this.ge=!0,this.ye=!0},uo),oo=(so.prototype.Be=function(t){for(var e=0,n=t.Te;e<n.length;e++){var r=n[e];t.me instanceof cu?this.qe(r,t.me):t.me instanceof hu&&this.Ue(r,t.key,t.me)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.me)},so.prototype.Qe=function(n){var r=this;this.Ke(n,function(t){var e=r.We(t);switch(n.state){case 0:r.je(t)&&e.be(n.resumeToken);break;case 1:e.Ne(),e.Ve||e.Se(),e.be(n.resumeToken);break;case 2:e.Ne(),e.Ve||r.removeTarget(t);break;case 3:r.je(t)&&(e.Fe(),e.be(n.resumeToken));break;case 4:r.je(t)&&(r.Ge(t),e.be(n.resumeToken));break;default:Sr()}})},so.prototype.Ke=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ke.forEach(function(t,e){r.je(e)&&n(e)})},so.prototype.ze=function(t){var e=t.targetId,n=t.Ie.count;(t=this.He(e))&&(Ni(t=t.target)?0===n?(t=new ai(t.path),this.Ue(e,t,new hu(t,ii.min()))):Dr(1===n):this.Je(e)!==n&&(this.Ge(e),this.Le=this.Le.add(e)))},so.prototype.Ye=function(r){var i=this,o=new Map;this.ke.forEach(function(t,e){var n=i.He(e);n&&(t.fe&&Ni(n.target)&&(n=new ai(n.target.path),null!==i.Me.get(n)||i.Xe(e,n)||i.Ue(e,n,new hu(n,r))),t.pe&&(o.set(e,t.ve()),t.Se()))});var s=Yi();this.$e.forEach(function(t,e){var n=!0;e.Gt(function(t){return!(t=i.He(t))||2===t.dt||(n=!1)}),n&&(s=s.add(t))});var t=new $i(r,o,this.Le,this.Me,s);return this.Me=Bi,this.$e=po(),this.Le=new qi(Pr),t},so.prototype.qe=function(t,e){var n;this.je(t)&&(n=this.Xe(t,e.key)?2:0,this.We(t).De(e.key,n),this.Me=this.Me.At(e.key,e),this.$e=this.$e.At(e.key,this.Ze(e.key).add(t)))},so.prototype.Ue=function(t,e,n){var r;this.je(t)&&(r=this.We(t),this.Xe(t,e)?r.De(e,1):r.Ce(e),this.$e=this.$e.At(e,this.Ze(e).delete(t)),n&&(this.Me=this.Me.At(e,n)))},so.prototype.removeTarget=function(t){this.ke.delete(t)},so.prototype.Je=function(t){var e=this.We(t).ve();return this.Oe.tn(t).size+e.de.size-e.Ee.size},so.prototype.xe=function(t){this.We(t).xe()},so.prototype.We=function(t){var e=this.ke.get(t);return e||(e=new io,this.ke.set(t,e)),e},so.prototype.Ze=function(t){var e=this.$e.get(t);return e||(e=new qi(Pr),this.$e=this.$e.At(t,e)),e},so.prototype.je=function(t){var e=null!==this.He(t);return e||_r("WatchChangeAggregator","Detected inactive target",t),e},so.prototype.He=function(t){var e=this.ke.get(t);return e&&e.Ve?null:this.Oe.en(t)},so.prototype.Ge=function(e){var n=this;this.ke.set(e,new io),this.Oe.tn(e).forEach(function(t){n.Ue(e,t,null)})},so.prototype.Xe=function(t,e){return this.Oe.tn(t).has(e)},so);function so(t){this.Oe=t,this.ke=new Map,this.Me=Bi,this.$e=po(),this.Le=new qi(Pr)}function uo(){this.Ae=0,this.Re=yo(),this.Pe=Cr.h,this.ye=!1,this.ge=!0}function ao(t,e,n,r,i){this.resumeToken=t,this.fe=e,this.de=n,this.we=r,this.Ee=i}function co(t,e,n,r,i){this.wt=t,this.ce=e,this.ae=n,this.ue=r,this.he=i}function ho(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ne=n,this.docChanges=r,this.se=i,this.fromCache=o,this.ie=s,this.re=u}function fo(){this.te=new Ri(ai.K)}function lo(n){this.K=n?function(t,e){return n(t,e)||ai.K(t.key,e.key)}:function(t,e){return ai.K(t.key,e.key)},this.Yt=Ki,this.Xt=new Ri(this.K)}function po(){return new Ri(ai.K)}function yo(){return new Ri(ai.K)}function vo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function go(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function bo(t){return t=So(t.mapValue.fields.__local_write_time__.timestampValue),new ri(t.seconds,t.nanos)}var Eo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wo(t)?4:10:Sr()}function To(r,i){var t,e=Io(r);if(e!==Io(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return bo(r).isEqual(bo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=So(r.timestampValue),t=So(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Oo(r.bytesValue).isEqual(Oo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Do((t=r).geoPointValue.latitude)===Do(e.geoPointValue.latitude)&&Do(t.geoPointValue.longitude)===Do(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Do(e.integerValue)===Do(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Do(e.doubleValue))===(t=Do(t.doubleValue))?bi(e)===bi(t):isNaN(e)&&isNaN(t));case 9:return Rr(r.arrayValue.values||[],i.arrayValue.values||[],To);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(vo(e)!==vo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!To(e[t],n[t])))return!1;return!0}();default:return Sr()}}function _o(t,e){return void 0!==(t.values||[]).find(function(t){return To(t,e)})}function Ao(t,e){var n,r,i,o=Io(t),s=Io(e);if(o!==s)return Pr(o,s);switch(o){case 0:return 0;case 1:return Pr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Do(t.integerValue||t.doubleValue))<(n=Do(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return No(t.timestampValue,e.timestampValue);case 4:return No(bo(t),bo(e));case 5:return Pr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Oo(i),s=Oo(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Pr(n[i],r[i]);if(0!==o)return o}return Pr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Pr(Do(o.latitude),Do(r.latitude)))?n:Pr(Do(o.longitude),Do(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ao(n[i],r[i]);if(o)return o}return Pr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Pr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Ao(n[r[s]],i[o[s]])))return u}return Pr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function No(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Pr(t,e);var n=So(t),t=So(e);return 0!==(e=Pr(n.seconds,t.seconds))?e:Pr(n.nanos,t.nanos)}function xo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=So(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Oo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ai.ut(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Sr();var t,e}(t)}function So(t){if(Dr(!!t),"string"!=typeof t)return{seconds:Do(t.seconds),nanos:Do(t.nanos)};var e=0,n=Eo.exec(t);return Dr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Do(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Oo(t){return"string"==typeof t?Cr.fromBase64String(t):Cr.fromUint8Array(t)}function ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.et()}}function Po(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function Lo(t){return t&&"nullValue"in t}function Co(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vo(t){return t&&"mapValue"in t}var Mo={asc:"ASCENDING",desc:"DESCENDING"},Uo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jo=function(t,e){this.T=t,this.nn=e};function qo(t){return{integerValue:""+t}}function Fo(t,e){if(t.nn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bi(e)?"-0":e}}function Bo(t,e){return Ei(e)?qo(e):Fo(t,e)}function zo(t,e){return t.nn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Go(t,e){return t.nn?e.toBase64():e.toUint8Array()}function Ko(t){return Dr(!!t),ii.L((t=So(t),new ri(t.seconds,t.nanos)))}function Ho(t,e){return new oi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).et()}function Wo(t){return Dr(fs(t=oi.nt(t))),t}function Yo(t,e){return Ho(t.T,e.path)}function Xo(t,e){if((e=Wo(e)).get(1)!==t.T.projectId)throw new wr(mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new wr(mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new ai($o(e))}function Zo(t,e){return Ho(t.T,e)}function Qo(t){return 4===(t=Wo(t)).length?oi.st():$o(t)}function Jo(t){return new oi(["projects",t.T.projectId,"databases",t.T.database]).et()}function $o(t){return Dr(4<t.length&&"documents"===t.get(4)),t.j(5)}function ts(t,e,n){return{name:Yo(t,e),fields:n.proto.mapValue.fields}}function es(t,e,n){var r=Xo(t,e.name),t=Ko(e.updateTime),e=new tu({mapValue:{fields:e.fields}});return new cu(r,t,e,{hasCommittedMutations:!!n})}function ns(t,e){var n,r,i;if(e instanceof Fs)n={update:ts(t,e.key,e.value)};else if(e instanceof Js)n={delete:Yo(t,e.key)};else if(e instanceof Bs)n={update:ts(t,e.key,e.data),updateMask:(i=e.sn,r=[],i.fields.forEach(function(t){return r.push(t.et())}),{fieldPaths:r})};else if(e instanceof Ws)n={transform:{document:Yo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.et(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.et(),appendMissingElements:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.et(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.et(),increment:e.rn};throw Sr()})}};else{if(!(e instanceof $s))return Sr();n={verify:Yo(t,e.key)}}return e.cn.on||(n.currentDocument=void 0!==(i=e.cn).updateTime?{updateTime:zo(e=t,(t=i.updateTime).q())}:void 0!==i.exists?{exists:i.exists}:Sr()),n}function rs(i,t){var e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Rs.updateTime(Ko(o.updateTime)):void 0!==o.exists?Rs.exists(o.exists):Rs.an():Rs.an();if(t.update){t.update.name;var n=Xo(i,t.update.name),r=new tu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Ds(o.map(function(t){return ui.ct(t)})));return new Bs(n,r,o,e)}return new Fs(n,r,e)}return t.delete?(n=Xo(i,t.delete),new Js(n,e)):t.transform?(n=Xo(i,t.transform.document),r=t.transform.fieldTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Dr("REQUEST_TIME"===t.setToServerValue),r=new ys):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new vs(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new Es(n)):"increment"in t?r=new As(e,t.increment):Sr(),t=ui.ct(t.fieldPath),new Os(t,r);var e,n,r}),Dr(!0===e.exists),new Ws(n,r)):t.verify?(n=Xo(i,t.verify),new $s(n,e)):Sr()}function is(t,e){return{documents:[Zo(t,e.path)]}}function os(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Zo(t,r.G()),n.structuredQuery.from=[{collectionId:r.J()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Co(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(Lo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Co(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(Lo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:(e=t.op,Uo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:cs(t.field),direction:(t=t.dir,Mo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.nn||wi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=us(e.startAt)),e.endAt&&(n.structuredQuery.endAt=us(e.endAt)),n}function ss(t){var e=Qo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Dr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=hs(t.unaryFilter.field);return Pu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=hs(t.unaryFilter.field);return Pu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=hs(t.unaryFilter.field),Pu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=hs(t.unaryFilter.field),Pu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Pu.create(hs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Sr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new sa(hs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=wi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=as(n.startAt));var u=null;return n.endAt&&(u=as(n.endAt)),vu(e,i,t,o,r,"F",s,u)}function us(t){return{before:t.before,values:t.position}}function as(t){var e=!!t.before,t=t.values||[];return new Ju(t,e)}function cs(t){return{fieldPath:t.et()}}function hs(t){return ui.ct(t.fieldPath)}function fs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ls(t,e){return t instanceof As?Po(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(h(ms,ds=o=function(){this.un=void 0}),ms),vs=(h(gs,ps=o),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return To(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,Es=(h(Is,bs=o),Is);function Is(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function Ts(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!To(t,e)})}(i[r]);return{arrayValue:{values:n}}}var _s,As=(h(Ns,_s=o),Ns);function Ns(t,e){var n=this;return(n=_s.call(this)||this).serializer=t,n.rn=e,n}function xs(t){return Do(t.integerValue||t.doubleValue)}function Ss(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ds=(ks.prototype.hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].X(t))return!0;return!1},ks.prototype.isEqual=function(t){return Rr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ks),Os=function(t,e){this.field=t,this.transform=e};function ks(t){(this.fields=t).sort(ui.K)}function Ps(t,e){this.version=t,this.transformResults=e}var Rs=(Ls.an=function(){return new Ls},Ls.exists=function(t){return new Ls(void 0,t)},Ls.updateTime=function(t){return new Ls(t)},Object.defineProperty(Ls.prototype,"on",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ls.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ls);function Ls(t,e){this.updateTime=t,this.exists=e}function Cs(t,e){return void 0!==t.updateTime?e instanceof cu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof cu}function Vs(t,e,n,r){return t instanceof Fs?(o=e,Cs((i=t).cn,o)?(o=Us(o),new cu(i.key,o,i.value,{ln:!0})):o):t instanceof Bs?function(t,e){if(!Cs(t.cn,e))return e;var n=Us(e),e=Ks(t,e);return new cu(t.key,n,e,{ln:!0})}(t,e):t instanceof Ws?function(t,e,n,r){if(!Cs(t.cn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof cu&&(h=n.field(a.field)),null===h&&r instanceof cu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof ys?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof vs?ws(c,i):c instanceof Es?Ts(c,i):(i=xs(c=ls(h=c,i))+xs(h.rn),Po(c)&&Po(h.rn)?qo(i):Fo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Xs(t,i.data(),r);return new cu(t.key,i.version,r,{ln:!0})}(t,e,r,n):Cs(t.cn,e)?new hu(t.key,ii.min()):e;var i,o}function Ms(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.cn.isEqual(e.cn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.sn.isEqual(e.sn):2!==t.type||Rr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof Es&&e instanceof Es?Rr(t.elements,e.elements,To):t instanceof As&&e instanceof As?To(t.rn,e.rn):t instanceof ys&&e instanceof ys)}))}function Us(t){return t instanceof cu?t.version:ii.min()}var js,qs,Fs=(h(Gs,qs=ge=function(){}),Gs),Bs=(h(zs,js=ge),zs);function zs(t,e,n,r){var i=this;return(i=js.call(this)||this).key=t,i.data=e,i.sn=n,i.cn=r,i.type=1,i}function Gs(t,e,n){var r=this;return(r=qs.call(this)||this).key=t,r.value=e,r.cn=n,r.type=0,r}function Ks(t,e){return n=t,e=e instanceof cu?e.data():tu.empty(),r=new eu(e),n.sn.fields.forEach(function(t){var e;t.Y()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r._n();var n,r}var Hs,Ws=(h(Ys,Hs=ge),Ys);function Ys(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.cn=Rs.exists(!0),n}function Xs(t,e,n){for(var r=new eu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r._n()}var Zs,Qs,Js=(h(ou,Qs=ge),ou),$s=(h(iu,Zs=ge),iu),tu=(ru.empty=function(){return new ru({mapValue:{}})},ru.prototype.field=function(t){if(t.Y())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Vo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.J()])||null},ru.prototype.isEqual=function(t){return To(this.proto,t.proto)},ru),eu=(nu.prototype.set=function(t,e){return this.wn(t,e),this},nu.prototype.delete=function(t){return this.wn(t,null),this},nu.prototype.wn=function(t,e){for(var n=this.dn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Io(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.J(),e)},nu.prototype._n=function(){var t=this.En(ui.st(),this.dn);return null!=t?new tu(t):this.fn},nu.prototype.En=function(r,t){var i=this,o=!1,e=this.fn.field(r),s=Vo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.En(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},nu);function nu(t){void 0===t&&(t=tu.empty()),this.fn=t,this.dn=new Map}function ru(t){this.proto=t}function iu(t,e){var n=this;return(n=Zs.call(this)||this).key=t,n.cn=e,n.type=4,n}function ou(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.cn=e,n.type=3,n}var su,uu,au,cu=(h(yu,au=me=function(t,e){this.key=t,this.version=e}),yu.prototype.field=function(t){return this.Tn.field(t)},yu.prototype.data=function(){return this.Tn},yu.prototype.mn=function(){return this.Tn.proto},yu.prototype.isEqual=function(t){return t instanceof yu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ln===t.ln&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Tn.isEqual(t.Tn)},yu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Tn.toString()+", {hasLocalMutations: "+this.ln+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.ln||this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu),hu=(h(du,uu=me),du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),fu=(h(pu,su=me),pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),lu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.In=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.An=null,this.Rn=null,this.startAt,this.endAt};function pu(){return null!==su&&su.apply(this,arguments)||this}function du(t,e,n){var r=this;return(r=uu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function yu(t,e,n,r){var i=this;return(i=au.call(this,t,e)||this).Tn=n,i.ln=!!r.ln,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function vu(t,e,n,r,i,o,s,u){return new lu(t,e,n,r,i,o,s,u)}function gu(t){return new lu(t)}function mu(t){return!wi(t.limit)&&"F"===t.limitType}function wu(t){return!wi(t.limit)&&"L"===t.limitType}function bu(t){return 0<t.In.length?t.In[0].field:null}function Eu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Pn())return r.field}return null}function Iu(t){return null!==t.collectionGroup}function Tu(t){var e=t;if(null===e.An){e.An=[];var n=Eu(e),t=bu(e);if(null!==n&&null===t)n.rt()||e.An.push(new sa(n)),e.An.push(new sa(ui.ot(),"asc"));else{for(var r=!1,i=0,o=e.In;i<o.length;i++){var s=o[i];e.An.push(s),s.field.rt()&&(r=!0)}r||(n=0<e.In.length?e.In[e.In.length-1].dir:"asc",e.An.push(new sa(ui.ot(),n)))}}return e.An}function _u(t){var e=t;if(!e.Rn)if("F"===e.limitType)e.Rn=Ti(e.path,e.collectionGroup,Tu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Tu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new sa(o.field,s))}var u=e.endAt?new Ju(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Ju(e.startAt.position,!e.startAt.before):null;e.Rn=Ti(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Rn}function Au(t,e,n){return new lu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nu(t,e){return Ai(_u(t),_u(e))&&t.limitType===e.limitType}function xu(t){return _i(_u(t))+"|lt:"+t.limitType}function Su(t){return"Query(target="+(n=(e=_u(t)).path.et(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.et()+" "+t.op+" "+xo(t.value)}).join(", ")+"]"),wi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.et()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ra(e.startAt)),e.endAt&&(n+=", endAt: "+ra(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Du(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.ht(e.collectionGroup)&&e.path.X(n):ai.lt(e.path)?e.path.isEqual(n):e.path.Z(n))&&function(t){for(var e=0,n=i.In;e<n.length;e++){var r=n[e];if(!r.field.rt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ia(t.startAt,Tu(t),n))&&(!t.endAt||!ia(t.endAt,Tu(t),n)));var e,n}function Ou(u){return function(t,e){for(var n=!1,r=0,i=Tu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.rt()?ai.K(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?Ao(e,r):Sr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Sr()}}(o,t,e);if(0!==s)return s;n=n||o.field.rt()}return 0}}var ku,Pu=(h(Ru,ku=function(){}),Ru.create=function(t,e,n){return t.rt()?"in"===e||"not-in"===e?this.yn(t,e,n):new Mu(t,e,n):"array-contains"===e?new Yu(t,n):"in"===e?new Xu(t,n):"not-in"===e?new Zu(t,n):"array-contains-any"===e?new Qu(t,n):new Ru(t,e,n)},Ru.yn=function(t,e,n){return new("in"===e?Uu:ju)(t,n)},Ru.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.gn(Ao(t,this.value)):null!==t&&Io(this.value)===Io(t)&&this.gn(Ao(t,this.value))},Ru.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Sr()}},Ru.prototype.Pn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ru);function Ru(t,e,n){var r=this;return(r=ku.call(this)||this).field=t,r.op=e,r.value=n,r}var Lu,Cu,Vu,Mu=(h(Bu,Vu=Pu),Bu.prototype.matches=function(t){return t=ai.K(t.key,this.key),this.gn(t)},Bu),Uu=(h(Fu,Cu=Pu),Fu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Fu),ju=(h(qu,Lu=Pu),qu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},qu);function qu(t,e){var n=this;return(n=Lu.call(this,t,"not-in",e)||this).keys=zu(0,e),n}function Fu(t,e){var n=this;return(n=Cu.call(this,t,"in",e)||this).keys=zu(0,e),n}function Bu(t,e,n){var r=this;return(r=Vu.call(this,t,e,n)||this).key=ai.ut(n.referenceValue),r}function zu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ai.ut(t.referenceValue)})}var Gu,Ku,Hu,Wu,Yu=(h(na,Wu=Pu),na.prototype.matches=function(t){return Ro(t=t.field(this.field))&&_o(t.arrayValue,this.value)},na),Xu=(h(ea,Hu=Pu),ea.prototype.matches=function(t){return null!==(t=t.field(this.field))&&_o(this.value.arrayValue,t)},ea),Zu=(h(ta,Ku=Pu),ta.prototype.matches=function(t){return!_o(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!_o(this.value.arrayValue,t))},ta),Qu=(h($u,Gu=Pu),$u.prototype.matches=function(t){var e=this;return!(!Ro(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return _o(e.value.arrayValue,t)})},$u),Ju=function(t,e){this.position=t,this.before=e};function $u(t,e){return Gu.call(this,t,"array-contains-any",e)||this}function ta(t,e){return Ku.call(this,t,"not-in",e)||this}function ea(t,e){return Hu.call(this,t,"in",e)||this}function na(t,e){return Wu.call(this,t,"array-contains",e)||this}function ra(t){return(t.before?"b":"a")+":"+t.position.map(xo).join(",")}function ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.rt()?ai.K(ai.ut(s.referenceValue),n.key):Ao(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function oa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!To(t.position[n],e.position[n]))return!1;return!0}var sa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ua=(Ta.prototype.pn=function(t,e,n){for(var r,i,o,s,u,a=n.bn,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof Fs?new cu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Bs?(u=i,h=o,Cs((s=r).cn,u)?(u=Ks(s,u),new cu(s.key,h.version,u,{hasCommittedMutations:!0})):new fu(s.key,h.version)):r instanceof Ws?function(t,e,n){if(Dr(null!=n.transformResults),!Cs(t.cn,e))return new fu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof cu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof Es?Ts(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Xs(t,r.data(),e);return new cu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new hu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ta.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Vs(i,e,e,this.Vn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Vs(a,e,o,this.Vn))}return e},Ta.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.At(t.key,e))}),i},Ta.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Yi())},Ta.prototype.isEqual=function(t){return this.batchId===t.batchId&&Rr(this.mutations,t.mutations,Ms)&&Rr(this.baseMutations,t.baseMutations,Ms)},Ta),aa=(Ia.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Hi,i=t.mutations,o=0;o<i.length;o++)r=r.At(i[o].key,n[o].version);return new Ia(t,e,n,r)},Ia),ca=(Ea.prototype.get=function(t){var e=this.xn(t);if(void 0!==(e=this.Fn[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.Nn(i,t))return o}},Ea.prototype.has=function(t){return void 0!==this.get(t)},Ea.prototype.set=function(t,e){var n=this.xn(t),r=this.Fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Nn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Fn[n]=[[t,e]]},Ea.prototype.delete=function(t){var e=this.xn(t),n=this.Fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Nn(n[r][0],t))return 1===n.length?delete this.Fn[e]:n.splice(r,1),!0;return!1},Ea.prototype.forEach=function(s){go(this.Fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ea.prototype.Y=function(){return mo(this.Fn)},Ea),ha=(ba.prototype.catch=function(t){return this.next(void 0,t)},ba.prototype.next=function(r,i){var o=this;return this.$n&&Sr(),this.$n=!0,this.Mn?this.error?this.Ln(i,this.error):this.Bn(r,this.result):new ba(function(e,n){o.On=function(t){o.Bn(r,t).next(e,n)},o.kn=function(t){o.Ln(i,t).next(e,n)}})},ba.prototype.qn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ba.prototype.Un=function(t){try{var e=t();return e instanceof ba?e:ba.resolve(e)}catch(t){return ba.reject(t)}},ba.prototype.Bn=function(t,e){return t?this.Un(function(){return t(e)}):ba.resolve(e)},ba.prototype.Ln=function(t,e){return t?this.Un(function(){return t(e)}):ba.reject(e)},ba.resolve=function(n){return new ba(function(t,e){t(n)})},ba.reject=function(n){return new ba(function(t,e){e(n)})},ba.Qn=function(t){return new ba(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ba.Kn=function(t){for(var n=ba.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ba.resolve(t):e()})}(r[e]);return n},ba.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Qn(i)},ba),o=(wa.prototype.Gn=function(t){return(t=this.Wn.get(t))?t.readTime:ii.min()},wa.prototype.zn=function(t,e){this.Hn(),this.Wn.set(t.key,{Jn:t,readTime:e})},wa.prototype.Yn=function(t,e){void 0===e&&(e=null),this.Hn(),this.Wn.set(t,{Jn:null,readTime:e})},wa.prototype.Xn=function(t,e){this.Hn();var n=this.Wn.get(e);return void 0!==n?ha.resolve(n.Jn):this.Zn(t,e)},wa.prototype.getEntries=function(t,e){return this.ts(t,e)},wa.prototype.apply=function(t){return this.Hn(),this.jn=!0,this.es(t)},wa.prototype.Hn=function(){},wa),fa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ge=(ma.prototype.ss=function(t){this.ns.push(t)},ma.prototype.rs=function(){this.ns.forEach(function(t){return t()})},ma),la=(ga.prototype.hs=function(e,n){var r=this;return this.cs.ls(e,n).next(function(t){return r._s(e,n,t)})},ga.prototype._s=function(t,r,i){return this.os.Xn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},ga.prototype.fs=function(t,e,i){var o=Bi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.At(t,e)}),o},ga.prototype.ds=function(e,t){var n=this;return this.os.getEntries(e,t).next(function(t){return n.ws(e,t)})},ga.prototype.ws=function(e,r){var i=this;return this.cs.Es(e,r).next(function(t){var t=i.fs(e,r,t),n=Bi;return t.forEach(function(t,e){e=e||new hu(t,ii.min()),n=n.At(t,e)}),n})},ga.prototype.Ts=function(t,e,n){return r=e,ai.lt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Is(t,e.path):Iu(e)?this.As(t,e,n):this.Rs(t,e,n);var r},ga.prototype.Is=function(t,e){return this.hs(t,new ai(e)).next(function(t){var e=Ki;return t instanceof cu&&(e=e.At(t.key,t)),e})},ga.prototype.As=function(n,r,i){var o=this,s=r.collectionGroup,u=Ki;return this.us.Ps(n,s).next(function(t){return ha.forEach(t,function(t){var e=(e=r,t=t.child(s),new lu(t,null,e.In.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.At(t,e)})})}).next(function(){return u})})},ga.prototype.Rs=function(e,n,t){var a,c,r=this;return this.os.Ts(e,n,t).next(function(t){return a=t,r.cs.ys(e,n)}).next(function(t){return c=t,r.gs(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Vs(s,s=a.get(u),s,r.Vn);a=s instanceof cu?a.At(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Du(n,e)||(a=a.remove(t))}),a})},ga.prototype.gs=function(t,e,n){for(var r=Yi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.os.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof cu&&(c=c.At(t,e))}),c})},ga),pa=(va.bs=function(t,e){for(var n=Yi(),r=Yi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new va(t,e.fromCache,n,r)},va),da=(ya.prototype.Ss=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ya.prototype.next=function(){var t=++this.previousValue;return this.Ds&&this.Ds(t),t},ya);function ya(t,e){var n=this;this.previousValue=t,e&&(e.vs=function(t){return n.Ss(t)},this.Ds=function(t){return e.Cs(t)})}function va(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.ps=r}function ga(t,e,n){this.os=t,this.cs=e,this.us=n}function ma(){this.ns=[]}function wa(){this.Wn=new ca(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.jn=!1}function ba(t){var e=this;this.On=null,this.kn=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.$n=!1,t(function(t){e.Mn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Mn=!0,e.error=t,e.kn&&e.kn(t)})}function Ea(t,e){this.xn=t,this.Nn=e,this.Fn={}}function Ia(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function Ta(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}da.xs=-1;var _a,Aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Na=(Ra.prototype.reset=function(){this.$s=0},Ra.prototype.qs=function(){this.$s=this.Ms},Ra.prototype.Us=function(t){var e=this;this.cancel();var n=Math.floor(this.$s+this.Qs()),r=Math.max(0,Date.now()-this.Bs),i=Math.max(0,n-r);0<i&&_r("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.$s+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ls=this.Ns.Ks(this.Fs,i,function(){return e.Bs=Date.now(),t()}),this.$s*=this.ks,this.$s<this.Os&&(this.$s=this.Os),this.$s>this.Ms&&(this.$s=this.Ms)},Ra.prototype.Ws=function(){null!==this.Ls&&(this.Ls.js(),this.Ls=null)},Ra.prototype.cancel=function(){null!==this.Ls&&(this.Ls.cancel(),this.Ls=null)},Ra.prototype.Qs=function(){return(Math.random()-.5)*this.$s},Ra),xa=(Pa.delete=function(t){return _r("SimpleDb","Removing database:",t),ja(window.indexedDB.deleteDatabase(t)).qn()},Pa.Hs=function(){if("undefined"==typeof indexedDB)return!1;if(Pa.Js())return!0;var t=p(),e=0<(n=Pa.zs(t))&&n<10,n=0<(n=Pa.Ys(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Pa.Js=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Xs)},Pa.Zs=function(t,e){return t.store(e)},Pa.zs=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Pa.Ys=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Pa.prototype.ti=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(_r("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Da(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new wr(mr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Da(o,t))},r.onupgradeneeded=function(t){_r("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Gs.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){_r("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.ei&&(this.db.onversionchange=function(t){return i.ei(t)}),this.db)]}})})},Pa.prototype.ni=function(e){this.ei=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Pa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.ti(u)];case 2:return s.db=t.sent(),e=Ca.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ha.reject(t)}).qn(),r={},n.catch(function(){}),[4,e.si];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,_r("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Pa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Pa),Sa=(Object.defineProperty(ka.prototype,"Mn",{get:function(){return this.ri},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"ci",{get:function(){return this.oi},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"cursor",{set:function(t){this.ii=t},enumerable:!1,configurable:!0}),ka.prototype.done=function(){this.ri=!0},ka.prototype.ai=function(t){this.oi=t},ka.prototype.delete=function(){return ja(this.ii.delete())},ka),Da=(h(Oa,_a=wr),Oa);function Oa(t,e){var n=this;return(n=_a.call(this,mr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ka(t){this.ii=t,this.ri=!1,this.oi=null}function Pa(t,e,n){this.name=t,this.version=e,this.Gs=n,12.2===Pa.zs(p())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ra(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ns=t,this.Fs=e,this.Os=n,this.ks=r,this.Ms=i,this.$s=0,this.Ls=null,this.Bs=Date.now(),this.reset()}function La(t){return"IndexedDbTransactionError"===t.name}var Ca=(Ua.open=function(t,e,n,r){try{return new Ua(e,t.transaction(r,n))}catch(t){throw new Da(e,t)}},Object.defineProperty(Ua.prototype,"si",{get:function(){return this.ui.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this.ui.reject(t),this.aborted||(_r("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){return t=this.transaction.objectStore(t),new Va(t)},Ua),Va=(Ma.prototype.put=function(t,e){return ja(t=void 0!==e?(_r("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(_r("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ma.prototype.add=function(t){return _r("SimpleDb","ADD",this.store.name,t,t),ja(this.store.add(t))},Ma.prototype.get=function(e){var n=this;return ja(this.store.get(e)).next(function(t){return void 0===t&&(t=null),_r("SimpleDb","GET",n.store.name,e,t),t})},Ma.prototype.delete=function(t){return _r("SimpleDb","DELETE",this.store.name,t),ja(this.store.delete(t))},Ma.prototype.count=function(){return _r("SimpleDb","COUNT",this.store.name),ja(this.store.count())},Ma.prototype.hi=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.li(e,function(t,e){n.push(e)}).next(function(){return n})},Ma.prototype._i=function(t,e){return _r("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).fi=!1,e=this.cursor(e),this.li(e,function(t,e,n){return n.delete()})},Ma.prototype.di=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.li(n,e)},Ma.prototype.wi=function(r){var t=this.cursor({});return new ha(function(n,e){t.onerror=function(t){t=Fa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ma.prototype.li=function(t,i){var o=[];return new ha(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Sa(n),(t=i(n.primaryKey,n.value,e))instanceof ha&&(t=t.catch(function(t){return e.done(),ha.reject(t)}),o.push(t)),e.Mn?r():null===e.ci?n.continue():n.continue(e.ci)):r()}}).next(function(){return ha.Qn(o)})},Ma.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ma.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.fi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ma);function Ma(t){this.store=t}function Ua(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ui=new Aa,this.transaction.oncomplete=function(){n.ui.resolve()},this.transaction.onabort=function(){t.error?n.ui.reject(new Da(e,t.error)):n.ui.resolve()},this.transaction.onerror=function(t){t=Fa(t.target.error),n.ui.reject(new Da(e,t))}}function ja(t){return new ha(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Fa(t.target.error),n(t)}})}var qa=!1;function Fa(t){var e=xa.zs(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new wr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return qa||(qa=!0,setTimeout(function(){throw n},0)),n}return t}function Ba(){return"undefined"!=typeof window?window:null}function za(){return"undefined"!=typeof document?document:null}var Ga=(Wa.Ai=function(t,e,n,r,i){return(i=new Wa(t,e,Date.now()+n,r,i)).start(n),i},Wa.prototype.start=function(t){var e=this;this.Ri=setTimeout(function(){return e.Pi()},t)},Wa.prototype.js=function(){return this.Pi()},Wa.prototype.cancel=function(t){null!==this.Ri&&(this.clearTimeout(),this.Ii.reject(new wr(mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Wa.prototype.Pi=function(){var e=this;this.Ei.yi(function(){return null!==e.Ri?(e.clearTimeout(),e.op().then(function(t){return e.Ii.resolve(t)})):Promise.resolve()})},Wa.prototype.clearTimeout=function(){null!==this.Ri&&(this.mi(this),clearTimeout(this.Ri),this.Ri=null)},Wa),Ka=(Object.defineProperty(Ha.prototype,"Ni",{get:function(){return this.pi},enumerable:!1,configurable:!0}),Ha.prototype.yi=function(t){this.enqueue(t)},Ha.prototype.Fi=function(t){this.Oi(),this.ki(t)},Ha.prototype.Mi=function(){var t;this.pi||(this.pi=!0,(t=za())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.xi))},Ha.prototype.enqueue=function(t){return this.Oi(),this.pi?new Promise(function(t){}):this.ki(t)},Ha.prototype.$i=function(t){var e=this;this.yi(function(){return e.Vi.push(t),e.Li()})},Ha.prototype.Li=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Vi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Vi[0]()];case 2:return t.sent(),this.Vi.shift(),this.Ci.reset(),[3,4];case 3:if(!La(e=t.sent()))throw e;return _r("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Vi.length&&this.Ci.Us(function(){return n.Li()}),t.label=5;case 5:return[2]}})})},Ha.prototype.ki=function(t){var r=this,e=this.gi.then(function(){return r.Si=!0,t().catch(function(t){throw r.vi=t,r.Si=!1,Ar("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Si=!1,t})});return this.gi=e},Ha.prototype.Ks=function(t,e,n){var r=this;return this.Oi(),-1<this.Di.indexOf(t)&&(e=0),n=Ga.Ai(this,t,e,n,function(t){return r.Bi(t)}),this.bi.push(n),n},Ha.prototype.Oi=function(){this.vi&&Sr()},Ha.prototype.qi=function(){},Ha.prototype.Ui=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.gi];case 1:t.sent(),t.label=2;case 2:if(e!==this.gi)return[3,0];t.label=3;case 3:return[2]}})})},Ha.prototype.Qi=function(t){for(var e=0,n=this.bi;e<n.length;e++)if(n[e].Fs===t)return!0;return!1},Ha.prototype.Ki=function(r){var i=this;return this.Ui().then(function(){i.bi.sort(function(t,e){return t.Ti-e.Ti});for(var t=0,e=i.bi;t<e.length;t++){var n=e[t];if(n.js(),"all"!==r&&n.Fs===r)break}return i.Ui()})},Ha.prototype.Wi=function(t){this.Di.push(t)},Ha.prototype.Bi=function(t){t=this.bi.indexOf(t),this.bi.splice(t,1)},Ha);function Ha(){var e=this;this.gi=Promise.resolve(),this.Vi=[],this.pi=!1,this.bi=[],this.vi=null,this.Si=!1,this.Di=[],this.Ci=new Na(this,"async_queue_retry"),this.xi=function(){var t=za();t&&_r("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ci.Ws()};var t=za();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.xi)}function Wa(t,e,n,r,i){this.Ei=t,this.Fs=e,this.Ti=n,this.op=r,this.mi=i,this.Ii=new Aa,this.then=this.Ii.promise.then.bind(this.Ii.promise),this.Ii.promise.catch(function(t){})}function Ya(t,e){if(Ar("AsyncQueue",e+": "+t),La(t))return new wr(mr.UNAVAILABLE,e+": "+t);throw t}function Xa(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Pr(n,t))?Pr(r,e):t}var Za=(tc.prototype.zi=function(){return++this.Gi},tc.prototype.Hi=function(t){var e=[t,this.zi()];this.buffer.size<this.ji?this.buffer=this.buffer.add(e):Xa(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(tc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),tc),Qa={Ji:!1,Yi:0,Xi:0,Zi:0},Ja=($a.sr=function(t){return new $a(t,$a.ir,$a.rr)},$a);function $a(t,e,n){this.tr=t,this.er=e,this.nr=n}function tc(t){this.ji=t,this.buffer=new qi(Xa),this.Gi=0}Ja.ir=10,Ja.rr=1e3,Ja.cr=new Ja(41943040,Ja.ir,Ja.rr),Ja.ar=new Ja(-1,0,0);var ec=(sc.prototype.start=function(t){-1!==this.ur.params.tr&&this._r(t)},sc.prototype.stop=function(){this.lr&&(this.lr.cancel(),this.lr=null)},Object.defineProperty(sc.prototype,"dr",{get:function(){return null!==this.lr},enumerable:!1,configurable:!0}),sc.prototype._r=function(n){var t=this,e=this.hr?3e5:6e4;_r("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.lr=this.Ei.Ks("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.lr=null,this.hr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.wr(this.ur)];case 2:return t.sent(),[3,7];case 3:return La(e=t.sent())?(_r("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,of(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this._r(n)];case 8:return t.sent(),[2]}})})})},sc),nc=(oc.prototype.Tr=function(t,e){return this.Er.mr(t).next(function(t){return Math.floor(e/100*t)})},oc.prototype.Ir=function(t,e){var n=this;if(0===e)return ha.resolve(da.xs);var r=new Za(e);return this.Er.Ke(t,function(t){return r.Hi(t.sequenceNumber)}).next(function(){return n.Er.Ar(t,function(t){return r.Hi(t)})}).next(function(){return r.maxValue})},oc.prototype.Rr=function(t,e,n){return this.Er.Rr(t,e,n)},oc.prototype.Pr=function(t,e){return this.Er.Pr(t,e)},oc.prototype.yr=function(e,n){var r=this;return-1===this.params.tr?(_r("LruGarbageCollector","Garbage collection skipped; disabled"),ha.resolve(Qa)):this.gr(e).next(function(t){return t<r.params.tr?(_r("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.tr),Qa):r.Vr(e,n)})},oc.prototype.gr=function(t){return this.Er.gr(t)},oc.prototype.Vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Tr(e,this.params.er).next(function(t){return i=t>h.params.nr?(_r("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.nr+" from "+t),h.params.nr):t,s=Date.now(),h.Ir(e,i)}).next(function(t){return r=t,u=Date.now(),h.Rr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Pr(e,r)}).next(function(t){return c=Date.now(),Tr()<=l.DEBUG&&_r("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ha.resolve({Ji:!0,Yi:i,Xi:o,Zi:t})})},oc),rc=(ic.prototype.pr=function(t){this.br=t},ic.prototype.Ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.In.length||1===r.In.length&&r.In[0].field.rt())||i.isEqual(ii.min())?this.vr(e,r):this.br.ds(e,o).next(function(t){var n=s.Sr(r,t);return(mu(r)||wu(r))&&s.Dr(r.limitType,n,o,i)?s.vr(e,r):(Tr()<=l.DEBUG&&_r("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Su(r)),s.br.Ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.At(t.key,t)}),e}))})},ic.prototype.Sr=function(n,t){var r=new qi(Ou(n));return t.forEach(function(t,e){e instanceof cu&&Du(n,e)&&(r=r.add(e))}),r},ic.prototype.Dr=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},ic.prototype.vr=function(t,e){return Tr()<=l.DEBUG&&_r("QueryEngine","Using full collection scan to execute query:",Su(e)),this.br.Ts(t,e,ii.min())},ic);function ic(){}function oc(t,e){this.Er=t,this.params=e}function sc(t,e){this.ur=t,this.Ei=e,this.hr=!1,this.lr=null}function uc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ac(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ac(o)}function ac(t){return t+""}function cc(t){var e=t.length;if(Dr(2<=e),2===e)return Dr(""===t.charAt(0)&&""===t.charAt(1)),oi.st();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Sr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Sr()}o=s+2}return new oi(r)}var hc=function(t){this.Cr=t};function fc(t,e){if(e.document)return es(t.Cr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ai._t(e.noDocument.path),r=vc(e.noDocument.readTime);return new hu(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=ai._t(e.unknownDocument.path),r=vc(e.unknownDocument.version),new fu(n,r)):Sr()}function lc(t,e,n){var r=pc(n),n=e.key.path.G().tt();if(e instanceof cu){var i={name:Yo(o=t.Cr,(s=e).key),fields:s.mn().mapValue.fields,updateTime:zo(o,s.version.q())},o=e.hasCommittedMutations;return new Qc(null,null,i,o,r,n)}if(e instanceof hu){var s=e.key.path.tt(),i=yc(e.version),o=e.hasCommittedMutations;return new Qc(null,new Xc(s,i),null,o,r,n)}return e instanceof fu?(o=e.key.path.tt(),e=yc(e.version),new Qc(new Zc(o,e),null,null,!0,r,n)):Sr()}function pc(t){return[(t=t.q()).seconds,t.nanoseconds]}function dc(t){return t=new ri(t[0],t[1]),ii.L(t)}function yc(t){return t=t.q(),new qc(t.seconds,t.nanoseconds)}function vc(t){return t=new ri(t.seconds,t.nanoseconds),ii.L(t)}function gc(e,t){var n=(t.baseMutations||[]).map(function(t){return rs(e.Cr,t)}),r=t.mutations.map(function(t){return rs(e.Cr,t)}),i=ri.fromMillis(t.localWriteTimeMs);return new ua(t.batchId,i,n,r)}function mc(t){var e=vc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?vc(t.lastLimboFreeSnapshotVersion):ii.min(),r=void 0!==t.query.documents?(Dr(1===(r=t.query).documents.length),_u(gu(Qo(r.documents[0])))):_u(ss(t.query));return new Di(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Cr.fromBase64String(t.resumeToken))}function wc(t,e){var n=yc(e.wt),r=yc(e.lastLimboFreeSnapshotVersion),i=(Ni(e.target)?is:os)(t.Cr,e.target),t=e.resumeToken.toBase64();return new $c(e.targetId,_i(e.target),n,t,e.sequenceNumber,r,i)}function bc(t){var e=ss({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Au(e,e.limit,"L"):e}var Ec=(Ic.Or=function(t,e,n,r){return Dr(""!==t.uid),new Ic(t.A()?t.uid:"",e,n,r)},Ic.prototype.kr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ac(t).di({index:Hc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Ic.prototype.Mr=function(d,y,v,g){var m=this,w=Nc(d),b=Ac(d);return b.add({}).next(function(t){Dr("number"==typeof t);for(var e,n,r,i,o,s=new ua(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ns(e.Cr,t)}),o=r.mutations.map(function(t){return ns(e.Cr,t)}),new Hc(n,r.batchId,r.Vn.toMillis(),i,o)),a=[],c=new qi(function(t,e){return Pr(t.et(),e.et())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Wc.key(m.userId,l.key.path,t),c=c.add(l.key.path.G());a.push(b.put(u)),a.push(w.put(p,Wc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.us.$r(d,t))}),d.ss(function(){m.Fr[t]=s.keys()}),ha.Qn(a).next(function(){return s})})},Ic.prototype.Lr=function(t,e){var n=this;return Ac(t).get(e).next(function(t){return t?(Dr(t.userId===n.userId),gc(n.serializer,t)):null})},Ic.prototype.Br=function(t,e){var n=this;return this.Fr[e]?ha.resolve(this.Fr[e]):this.Lr(t,e).next(function(t){return t?(t=t.keys(),n.Fr[e]=t):null})},Ic.prototype.qr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Ac(t).di({index:Hc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Dr(e.batchId>=i),o=gc(r.serializer,e)),n.done()}).next(function(){return o})},Ic.prototype.Ur=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ac(t).di({index:Hc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Ic.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ac(t).hi(Hc.userMutationsIndex,n).next(function(t){return t.map(function(t){return gc(e.serializer,t)})})},Ic.prototype.ls=function(o,s){var u=this,t=Wc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Nc(o).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=cc(i);if(r===u.userId&&s.path.isEqual(i))return Ac(o).get(t).next(function(t){if(!t)throw Sr();Dr(t.userId===u.userId),a.push(gc(u.serializer,t))});n.done()}).next(function(){return a})},Ic.prototype.Es=function(e,t){var s=this,u=new qi(Pr),n=[];return t.forEach(function(o){var t=Wc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Nc(e).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=cc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ha.Qn(n).next(function(){return s.Kr(e,u)})},Ic.prototype.ys=function(t,e){var o=this,s=e.path,u=s.length+1,e=Wc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new qi(Pr);return Nc(t).di({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=cc(i);r===o.userId&&s.X(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Kr(t,a)})},Ic.prototype.Kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ac(e).get(t).next(function(t){if(null===t)throw Sr();Dr(t.userId===n.userId),r.push(gc(n.serializer,t))}))}),ha.Qn(i).next(function(){return r})},Ic.prototype.Wr=function(e,n){var r=this;return _c(e.jr,this.userId,n).next(function(t){return e.ss(function(){r.Gr(n.batchId)}),ha.forEach(t,function(t){return r.Nr.zr(e,t)})})},Ic.prototype.Gr=function(t){delete this.Fr[t]},Ic.prototype.Hr=function(e){var i=this;return this.kr(e).next(function(t){if(!t)return ha.resolve();var t=IDBKeyRange.lowerBound(Wc.prefixForUser(i.userId)),r=[];return Nc(e).di({range:t},function(t,e,n){t[0]===i.userId?(t=cc(t[1]),r.push(t)):n.done()}).next(function(){Dr(0===r.length)})})},Ic.prototype.Jr=function(t,e){return Tc(t,this.userId,e)},Ic.prototype.Yr=function(t){var e=this;return xc(t).get(this.userId).next(function(t){return t||new Kc(e.userId,-1,"")})},Ic);function Ic(t,e,n,r){this.userId=t,this.serializer=e,this.us=n,this.Nr=r,this.Fr={}}function Tc(t,o,e){var s=(e=Wc.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Nc(t).di({range:e,fi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function _c(t,e,n){var r=t.store(Hc.store),i=t.store(Wc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.di({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Dr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Wc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ha.Qn(o).next(function(){return u})}function Ac(t){return Ah.Zs(t,Hc.store)}function Nc(t){return Ah.Zs(t,Wc.store)}function xc(t){return Ah.Zs(t,Kc.store)}var Sc,Dc=(Pc.prototype.zn=function(t,e,n){return Lc(t).put(Cc(e),n)},Pc.prototype.Yn=function(t,e){return t=Lc(t),e=Cc(e),t.delete(e)},Pc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Xr(e,t)})},Pc.prototype.Xn=function(t,e){var n=this;return Lc(t).get(Cc(e)).next(function(t){return n.Zr(t)})},Pc.prototype.eo=function(t,e){var n=this;return Lc(t).get(Cc(e)).next(function(t){var e=n.Zr(t);return e?{Jn:e,size:Vc(t)}:null})},Pc.prototype.getEntries=function(t,e){var n=this,r=Bi;return this.no(t,e,function(t,e){e=n.Zr(e),r=r.At(t,e)}).next(function(){return r})},Pc.prototype.so=function(t,e){var r=this,i=Bi,o=new Ri(ai.K);return this.no(t,e,function(t,e){var n=r.Zr(e);o=n?(i=i.At(t,n),o.At(t,Vc(e))):(i=i.At(t,null),o.At(t,0))}).next(function(){return{io:i,ro:o}})},Pc.prototype.no=function(t,e,i){if(e.Y())return ha.resolve();var n=IDBKeyRange.bound(e.first().path.tt(),e.last().path.tt()),o=e.bt(),s=o.Nt();return Lc(t).di({range:n},function(t,e,n){for(var r=ai._t(t);s&&ai.K(s,r)<0;)i(s,null),s=o.Nt();s&&s.isEqual(r)&&(i(s,e),s=o.Ft()?o.Nt():null),s?n.ai(s.path.tt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Ft()?o.Nt():null})},Pc.prototype.Ts=function(t,r,e){var n,i=this,o=Ki,s=r.path.length+1,u={};return e.isEqual(ii.min())?(n=r.path.tt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.tt(),e=pc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Qc.collectionReadTimeIndex),Lc(t).di(u,function(t,e,n){t.length===s&&(e=fc(i.serializer,e),r.path.X(e.key.path)?e instanceof cu&&Du(r,e)&&(o=o.At(e.key,e)):n.done())}).next(function(){return o})},Pc.prototype.oo=function(t){return new Oc(this,!!t&&t.co)},Pc.prototype.ao=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Pc.prototype.getMetadata=function(t){return Rc(t).get(Jc.key).next(function(t){return Dr(!!t),t})},Pc.prototype.Xr=function(t,e){return Rc(t).put(Jc.key,e)},Pc.prototype.Zr=function(t){return!t||(t=fc(this.serializer,t))instanceof hu&&t.version.isEqual(ii.min())?null:t},Pc),Oc=(h(kc,Sc=o),kc.prototype.es=function(i){var o=this,s=[],u=0,a=new qi(function(t,e){return Pr(t.et(),e.et())});return this.Wn.forEach(function(t,e){var n,r=o.ho.get(t);e.Jn?(n=lc(o.uo.serializer,e.Jn,o.Gn(t)),a=a.add(t.path.G()),e=Vc(n),u+=e-r,s.push(o.uo.zn(i,t,n))):(u-=r,o.co?(r=lc(o.uo.serializer,new hu(t,ii.min()),o.Gn(t)),s.push(o.uo.zn(i,t,r))):s.push(o.uo.Yn(i,t)))}),a.forEach(function(t){s.push(o.uo.us.$r(i,t))}),s.push(this.uo.updateMetadata(i,u)),ha.Qn(s)},kc.prototype.Zn=function(t,e){var n=this;return this.uo.eo(t,e).next(function(t){return null===t?(n.ho.set(e,0),null):(n.ho.set(e,t.size),t.Jn)})},kc.prototype.ts=function(t,e){var n=this;return this.uo.so(t,e).next(function(t){var e=t.io;return t.ro.forEach(function(t,e){n.ho.set(t,e)}),e})},kc);function kc(t,e){var n=this;return(n=Sc.call(this)||this).uo=t,n.co=e,n.ho=new ca(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Pc(t,e){this.serializer=t,this.us=e}function Rc(t){return Ah.Zs(t,Jc.store)}function Lc(t){return Ah.Zs(t,Qc.store)}function Cc(t){return t.path.tt()}function Vc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Sr();e=t.noDocument}return JSON.stringify(e).length}var Mc=(Gc.prototype.$r=function(t,e){return this.lo.add(e),ha.resolve()},Gc.prototype.Ps=function(t,e){return ha.resolve(this.lo.getEntries(e))},Gc),Uc=(zc.prototype.add=function(t){var e=t.J(),n=t.G(),r=this.index[e]||new qi(oi.K),t=!r.has(n);return this.index[e]=r.add(n),t},zc.prototype.has=function(t){var e=t.J(),t=t.G();return(e=this.index[e])&&e.has(t)},zc.prototype.getEntries=function(t){return(this.index[t]||new qi(oi.K)).tt()},zc),jc=(Bc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Dr(t<r&&0<=t&&r<=11);var o=new Ca("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Fc.store),(s=e).createObjectStore(Kc.store,{keyPath:Kc.keyPath}),s.createObjectStore(Hc.store,{keyPath:Hc.keyPath,autoIncrement:!0}).createIndex(Hc.userMutationsIndex,Hc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Wc.store),rh(e),e.createObjectStore(Qc.store));var s,u=ha.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(th.store),s.deleteObjectStore($c.store),s.deleteObjectStore(eh.store),rh(e)),u=u.next(function(){return t=o.store(eh.store),e=new eh(0,0,ii.min().q(),0),t.put(eh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Hc.store).hi().next(function(t){n.deleteObjectStore(Hc.store),n.createObjectStore(Hc.store,{keyPath:Hc.keyPath,autoIncrement:!0}).createIndex(Hc.userMutationsIndex,Hc.userMutationsKeyPath,{unique:!0});var e=r.store(Hc.store),t=t.map(function(t){return e.put(t)});return ha.Qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(ih.store,{keyPath:ih.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Jc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Qc.store)).createIndex(Qc.readTimeIndex,Qc.readTimeIndexPath,{unique:!1}),t.createIndex(Qc.collectionReadTimeIndex,Qc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(oh.store,{keyPath:oh.keyPath}),e.createObjectStore(sh.store,{keyPath:sh.keyPath})})),u},Bc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Qc.store).di(function(t,e){n+=Vc(e)}).next(function(){var t=new Jc(n);return e.store(Jc.store).put(Jc.key,t)})},Bc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Kc.store),i=n.store(Hc.store);return t.hi().next(function(t){return ha.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.hi(Hc.userMutationsIndex,t).next(function(t){return ha.forEach(t,function(t){return Dr(t.userId===e.userId),t=gc(r.serializer,t),_c(n,e.userId,t).next(function(){})})})})})},Bc.prototype.ensureSequenceNumbers=function(t){var o=t.store(th.store),e=t.store(Qc.store);return t.store(eh.store).get(eh.key).next(function(r){var i=[];return e.di(function(t,e){var n=new oi(t),t=[0,uc(n)];i.push(o.get(t).next(function(t){return t?ha.resolve():o.put(new th(0,uc(n),r.highestListenSequenceNumber))}))}).next(function(){return ha.Qn(i)})})},Bc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.J(),t=t.G();return n.put({collectionId:e,parent:uc(t)})}}t.createObjectStore(nh.store,{keyPath:nh.keyPath});var n=e.store(nh.store),i=new Uc;return e.store(Qc.store).di({fi:!0},function(t,e){return r((t=new oi(t)).G())}).next(function(){return e.store(Wc.store).di({fi:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],cc(n))).G())})})},Bc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store($c.store);return r.di(function(t,e){return e=mc(e),e=wc(n.serializer,e),r.put(e)})},Bc),qc=function(t,e){this.seconds=t,this.nanoseconds=e},Fc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Bc(t){this.serializer=t}function zc(){this.index={}}function Gc(){this.lo=new Uc}Fc.store="owner",Fc.key="owner";var Kc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Kc.store="mutationQueues",Kc.keyPath="userId";var Hc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Hc.store="mutations",Hc.keyPath="batchId",Hc.userMutationsIndex="userMutationsIndex",Hc.userMutationsKeyPath=["userId","batchId"];var Wc=(Yc.prefixForUser=function(t){return[t]},Yc.prefixForPath=function(t,e){return[t,uc(e)]},Yc.key=function(t,e,n){return[t,uc(e),n]},Yc);function Yc(){}Wc.store="documentMutations",Wc.PLACEHOLDER=new Wc;var Xc=function(t,e){this.path=t,this.readTime=e},Zc=function(t,e){this.path=t,this.version=e},Qc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Qc.store="remoteDocuments",Qc.readTimeIndex="readTimeIndex",Qc.readTimeIndexPath="readTime",Qc.collectionReadTimeIndex="collectionReadTimeIndex",Qc.collectionReadTimeIndexPath=["parentPath","readTime"];var Jc=function(t){this.byteSize=t};Jc.store="remoteDocumentGlobal",Jc.key="remoteDocumentGlobalKey";var $c=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};$c.store="targets",$c.keyPath="targetId",$c.queryTargetsIndexName="queryTargetsIndex",$c.queryTargetsKeyPath=["canonicalId","targetId"];var th=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};th.store="targetDocuments",th.keyPath=["targetId","path"],th.documentTargetsIndex="documentTargetsIndex",th.documentTargetsKeyPath=["path","targetId"];var eh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};eh.key="targetGlobalKey",eh.store="targetGlobal";var nh=function(t,e){this.collectionId=t,this.parent=e};function rh(t){t.createObjectStore(th.store,{keyPath:th.keyPath}).createIndex(th.documentTargetsIndex,th.documentTargetsKeyPath,{unique:!0}),t.createObjectStore($c.store,{keyPath:$c.keyPath}).createIndex($c.queryTargetsIndexName,$c.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(eh.store)}nh.store="collectionParents",nh.keyPath=["collectionId","parent"];var ih=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ih.store="clientMetadata",ih.keyPath="clientId";var oh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};oh.store="bundles",oh.keyPath="bundleId";var sh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};sh.store="namedQueries",sh.keyPath="name";var uh=f(f(f(f([Kc.store,Hc.store,Wc.store,Qc.store,$c.store,Fc.store,eh.store,th.store],[ih.store]),[Jc.store]),[nh.store]),[oh.store,sh.store]),ah=(ch.prototype._o=function(t,e){return hh(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:vc(t.createTime),version:t.version}})},ch.prototype.fo=function(t,e){return hh(t).put({bundleId:e.id,createTime:yc(Ko(e.createTime)),version:e.version})},ch.prototype.wo=function(t,e){return fh(t).get(e).next(function(t){if(t)return{name:t.name,query:bc(t.bundledQuery),readTime:vc(t.readTime)}})},ch.prototype.Eo=function(t,e){return fh(t).put({name:e.name,readTime:yc(Ko(e.readTime)),bundledQuery:e.bundledQuery})},ch);function ch(t){this.serializer=t}function hh(t){return Ah.Zs(t,oh.store)}function fh(t){return Ah.Zs(t,sh.store)}var lh=(ph.prototype.$r=function(t,e){var n=this;if(this.To.has(e))return ha.resolve();var r=e.J(),i=e.G();return t.ss(function(){n.To.add(e)}),i={collectionId:r,parent:uc(i)},dh(t).put(i)},ph.prototype.Ps=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Lr(i),""],!1,!0);return dh(t).hi(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(cc(r.parent))}return o})},ph);function ph(){this.To=new Uc}function dh(t){return Ah.Zs(t,nh.store)}var yh=(mh.prototype.next=function(){return this.mo+=2,this.mo},mh.Io=function(){return new mh(0)},mh.Ao=function(){return new mh(-1)},mh),vh=(gh.prototype.Ro=function(n){var r=this;return this.Po(n).next(function(t){var e=new yh(t.highestTargetId);return t.highestTargetId=e.next(),r.yo(n,t).next(function(){return t.highestTargetId})})},gh.prototype.Vo=function(t){return this.Po(t).next(function(t){return ii.L(new ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},gh.prototype.po=function(t){return this.Po(t).next(function(t){return t.highestListenSequenceNumber})},gh.prototype.bo=function(e,n,r){var i=this;return this.Po(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.q()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.yo(e,t)})},gh.prototype.vo=function(e,n){var r=this;return this.So(e,n).next(function(){return r.Po(e).next(function(t){return t.targetCount+=1,r.Do(n,t),r.yo(e,t)})})},gh.prototype.Co=function(t,e){return this.So(t,e)},gh.prototype.xo=function(e,t){var n=this;return this.No(e,t.targetId).next(function(){return wh(e).delete(t.targetId)}).next(function(){return n.Po(e)}).next(function(t){return Dr(0<t.targetCount),--t.targetCount,n.yo(e,t)})},gh.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return wh(n).di(function(t,e){(e=mc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.xo(n,e)))}).next(function(){return ha.Qn(u)}).next(function(){return s})},gh.prototype.Ke=function(t,n){return wh(t).di(function(t,e){e=mc(e),n(e)})},gh.prototype.Po=function(t){return bh(t).get(eh.key).next(function(t){return Dr(null!==t),t})},gh.prototype.yo=function(t,e){return bh(t).put(eh.key,e)},gh.prototype.So=function(t,e){return wh(t).put(wc(this.serializer,e))},gh.prototype.Do=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},gh.prototype.Fo=function(t){return this.Po(t).next(function(t){return t.targetCount})},gh.prototype.Oo=function(t,r){var e=_i(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return wh(t).di({range:e,index:$c.queryTargetsIndexName},function(t,e,n){e=mc(e),Ai(r,e.target)&&(i=e,n.done())}).next(function(){return i})},gh.prototype.ko=function(n,t,r){var i=this,o=[],s=Eh(n);return t.forEach(function(t){var e=uc(t.path);o.push(s.put(new th(r,e))),o.push(i.Nr.Mo(n,r,t))}),ha.Qn(o)},gh.prototype.$o=function(n,t,r){var i=this,o=Eh(n);return ha.forEach(t,function(t){var e=uc(t.path);return ha.Qn([o.delete([r,e]),i.Nr.Lo(n,r,t)])})},gh.prototype.No=function(t,e){return t=Eh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},gh.prototype.Bo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Eh(t),r=Yi();return t.di({range:e,fi:!0},function(t,e,n){t=cc(t[1]),t=new ai(t),r=r.add(t)}).next(function(){return r})},gh.prototype.Jr=function(t,e){var e=uc(e.path),e=IDBKeyRange.bound([e],[Lr(e)],!1,!0),i=0;return Eh(t).di({index:th.documentTargetsIndex,fi:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},gh.prototype.en=function(t,e){return wh(t).get(e).next(function(t){return t?mc(t):null})},gh);function gh(t,e){this.Nr=t,this.serializer=e}function mh(t){this.mo=t}function wh(t){return Ah.Zs(t,$c.store)}function bh(t){return Ah.Zs(t,eh.store)}function Eh(t){return Ah.Zs(t,th.store)}var Ih,Th="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_h=(h(xh,Ih=ge),xh),Ah=(Nh.Zs=function(t,e){if(t instanceof _h)return xa.Zs(t.jr,e);throw Sr()},Nh.prototype.start=function(){var e=this;return this.nc().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new wr(mr.FAILED_PRECONDITION,Th);return e.sc(),e.ic(),e.rc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Zo.po(t)})}).then(function(t){e.Ko=new da(t,e.Uo)}).then(function(){e.Wo=!0}).catch(function(t){return e.Xo&&e.Xo.close(),Promise.reject(t)})},Nh.prototype.oc=function(n){var t=this;return this.Jo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.dr?[2,n(e)]:[2]})})},n(this.isPrimary)},Nh.prototype.cc=function(n){var t=this;this.Xo.ni(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Nh.prototype.ac=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ns.yi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.dr?[4,this.nc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Nh.prototype.nc=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Dh(e).put(new ih(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.uc(e).next(function(t){t||(n.isPrimary=!1,n.Ns.$i(function(){return n.Jo(!1)}))})}).next(function(){return n.hc(e)}).next(function(t){return n.isPrimary&&!t?n.lc(e).next(function(){return!1}):!!t&&n._c(e).next(function(){return!0})})}).catch(function(t){if(La(t))return _r("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return _r("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ns.$i(function(){return n.Jo(t)}),n.isPrimary=t})},Nh.prototype.uc=function(t){var e=this;return Sh(t).get(Fc.key).next(function(t){return ha.resolve(e.fc(t))})},Nh.prototype.dc=function(t){return Dh(t).delete(this.clientId)},Nh.prototype.wc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ec(this.Ho,18e5)?[3,2]:(this.Ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Nh.Zs(t,ih.store);return r.hi().next(function(t){var e=o.Tc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ha.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ec)for(n=0,r=e;n<r.length;n++)i=r[n],this.ec.removeItem(this.mc(i.clientId));t.label=2;case 2:return[2]}})})},Nh.prototype.rc=function(){var t=this;this.zo=this.Ns.Ks("client_metadata_refresh",4e3,function(){return t.nc().then(function(){return t.wc()}).then(function(){return t.rc()})})},Nh.prototype.fc=function(t){return!!t&&t.ownerId===this.clientId},Nh.prototype.hc=function(e){var r=this;return this.Qo?ha.resolve(!0):Sh(e).get(Fc.key).next(function(t){if(null!==t&&r.Ec(t.leaseTimestampMs,5e3)&&!r.Ic(t.ownerId)){if(r.fc(t)&&r.networkEnabled)return!0;if(!r.fc(t)){if(!t.allowTabSynchronization)throw new wr(mr.FAILED_PRECONDITION,Th);return!1}}return!(!r.networkEnabled||!r.inForeground)||Dh(e).hi().next(function(t){return void 0===r.Tc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&_r("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Nh.prototype.Ac=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Wo=!1,this.Rc(),this.zo&&(this.zo.cancel(),this.zo=null),this.Pc(),this.yc(),[4,this.Xo.runTransaction("shutdown","readwrite",[Fc.store,ih.store],function(t){var e=new _h(t,da.xs);return n.lc(e).next(function(){return n.dc(e)})})];case 1:return t.sent(),this.Xo.close(),this.gc(),[2]}})})},Nh.prototype.Tc=function(t,e){var n=this;return t.filter(function(t){return n.Ec(t.updateTimeMs,e)&&!n.Ic(t.clientId)})},Nh.prototype.Vc=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Dh(t).hi().next(function(t){return e.Tc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Nh.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Nh.prototype.bc=function(t){return Ec.Or(t,this.serializer,this.us,this.Nr)},Nh.prototype.vc=function(){return this.Zo},Nh.prototype.Sc=function(){return this.os},Nh.prototype.Dc=function(){return this.us},Nh.prototype.Cc=function(){return this.tc},Nh.prototype.runTransaction=function(e,n,r){var i=this;_r("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Xo.runTransaction(e,t,uh,function(t){return o=new _h(t,i.Ko?i.Ko.next():da.xs),"readwrite-primary"===n?i.uc(o).next(function(t){return!!t||i.hc(o)}).next(function(t){if(!t)throw Ar("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ns.$i(function(){return i.Jo(!1)}),new wr(mr.FAILED_PRECONDITION,fa);return r(o)}).next(function(t){return i._c(o).next(function(){return t})}):i.xc(o).next(function(){return r(o)})}).then(function(t){return o.rs(),t})},Nh.prototype.xc=function(t){var e=this;return Sh(t).get(Fc.key).next(function(t){if(null!==t&&e.Ec(t.leaseTimestampMs,5e3)&&!e.Ic(t.ownerId)&&!e.fc(t)&&!(e.Qo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new wr(mr.FAILED_PRECONDITION,Th)})},Nh.prototype._c=function(t){var e=new Fc(this.clientId,this.allowTabSynchronization,Date.now());return Sh(t).put(Fc.key,e)},Nh.Hs=function(){return xa.Hs()},Nh.prototype.lc=function(t){var e=this,n=Sh(t);return n.get(Fc.key).next(function(t){return e.fc(t)?(_r("IndexedDbPersistence","Releasing primary lease."),n.delete(Fc.key)):ha.resolve()})},Nh.prototype.Ec=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},Nh.prototype.sc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Go=function(){t.Ns.yi(function(){return t.inForeground="visible"===t.document.visibilityState,t.nc()})},this.document.addEventListener("visibilitychange",this.Go),this.inForeground="visible"===this.document.visibilityState)},Nh.prototype.Pc=function(){this.Go&&(this.document.removeEventListener("visibilitychange",this.Go),this.Go=null)},Nh.prototype.ic=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.jo=function(){e.Rc(),e.Ns.yi(function(){return e.Ac()})},this.window.addEventListener("unload",this.jo))},Nh.prototype.yc=function(){this.jo&&(this.window.removeEventListener("unload",this.jo),this.jo=null)},Nh.prototype.Ic=function(t){try{var e=null!==(null===(e=this.ec)||void 0===e?void 0:e.getItem(this.mc(t)));return _r("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Nh.prototype.Rc=function(){if(this.ec)try{this.ec.setItem(this.mc(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},Nh.prototype.gc=function(){if(this.ec)try{this.ec.removeItem(this.mc(this.clientId))}catch(t){}},Nh.prototype.mc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Nh);function Nh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ns=i,this.window=o,this.document=s,this.Uo=a,this.Qo=c,this.Ko=null,this.Wo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.jo=null,this.inForeground=!1,this.Go=null,this.zo=null,this.Ho=Number.NEGATIVE_INFINITY,this.Jo=function(t){return Promise.resolve()},!Nh.Hs())throw new wr(mr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Nr=new Oh(this,r),this.Yo=e+"main",this.serializer=new hc(u),this.Xo=new xa(this.Yo,11,new jc(this.serializer)),this.Zo=new vh(this.Nr,this.serializer),this.us=new lh,this.os=(e=this.serializer,u=this.us,new Dc(e,u)),this.tc=new ah(this.serializer),this.window&&this.window.localStorage?this.ec=this.window.localStorage:(this.ec=null,!1===c&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function xh(t,e){var n=this;return(n=Ih.call(this)||this).jr=t,n.qo=e,n}function Sh(t){return Ah.Zs(t,Fc.store)}function Dh(t){return Ah.Zs(t,ih.store)}var Oh=(kh.prototype.mr=function(t){var n=this.Nc(t);return this.db.vc().Fo(t).next(function(e){return n.next(function(t){return e+t})})},kh.prototype.Nc=function(t){var e=0;return this.Ar(t,function(t){e++}).next(function(){return e})},kh.prototype.Ke=function(t,e){return this.db.vc().Ke(t,e)},kh.prototype.Ar=function(t,n){return this.Fc(t,function(t,e){return n(e)})},kh.prototype.Mo=function(t,e,n){return Ph(t,n)},kh.prototype.Lo=function(t,e,n){return Ph(t,n)},kh.prototype.Rr=function(t,e,n){return this.db.vc().Rr(t,e,n)},kh.prototype.zr=Ph,kh.prototype.Oc=function(t,e){return r=e,i=!1,xc(n=t).wi(function(t){return Tc(n,t,r).next(function(t){return t&&(i=!0),ha.resolve(!t)})}).next(function(){return i});var n,r,i},kh.prototype.Pr=function(n,r){var i=this,o=this.db.Sc().oo(),s=[],u=0;return this.Fc(n,function(e,t){t<=r&&(t=i.Oc(n,e).next(function(t){if(!t)return u++,o.Xn(n,e).next(function(){return o.Yn(e),Eh(n).delete([0,uc(e.path)])})}),s.push(t))}).next(function(){return ha.Qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},kh.prototype.removeTarget=function(t,e){return e=e.Et(t.qo),this.db.vc().Co(t,e)},kh.prototype.kc=Ph,kh.prototype.Fc=function(t,r){var i,t=Eh(t),o=da.xs;return t.di({index:th.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==da.xs&&r(new ai(cc(i)),o),o=e,i=t):o=da.xs}).next(function(){o!==da.xs&&r(new ai(cc(i)),o)})},kh.prototype.gr=function(t){return this.db.Sc().ao(t)},kh);function kh(t,e){this.db=t,this.ur=new nc(this,e)}function Ph(t,e){return Eh(t).put((t=t.qo,new th(0,uc(e.path),t)))}function Rh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Lh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Ch(t,e){if(t instanceof Uint8Array)return Lh(t,e);if(t instanceof ArrayBuffer)return Lh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Vh(t){return new jo(t,!0)}var Mh=(Bh.prototype.Mc=function(){return"metadata"in this.payload},Bh),Uh=(Fh.qc=function(t,e){return new Fh(Ch(t,10240),e)},Fh.prototype.close=function(){return this.$c.cancel()},Fh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Fh.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Bc())]}})})},Fh.prototype.Bc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Lc.decode(e),n=Number(r),isNaN(n)&&this.Kc("length string ("+r+") is not valid number"),[4,this.Wc(n)]);case 2:return r=t.sent(),[2,new Mh(JSON.parse(r),e.length+n)]}})})},Fh.prototype.jc=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Fh.prototype.Qc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.jc()<0?[4,this.Gc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.jc())<0&&this.Kc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Fh.prototype.Wc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Gc()]:[3,3];case 1:t.sent()&&this.Kc("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Lc.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Fh.prototype.Kc=function(t){throw this.$c.cancel(),new Error("Invalid bundle format: "+t)},Fh.prototype.Gc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.$c.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Fh),jh=(qh.prototype.zc=function(t){return Xo(this.serializer,t)},qh.prototype.Hc=function(t){return t.metadata.exists?es(this.serializer,t.document,!1):new hu(this.zc(t.metadata.name),this.Jc(t.metadata.readTime))},qh.prototype.Jc=Ko,qh);function qh(t){this.serializer=t}function Fh(t,e){var n=this;this.$c=t,this.serializer=e,this.metadata=new Aa,this.buffer=new Uint8Array,this.Lc=new TextDecoder("utf-8"),this.Bc().then(function(t){t&&t.Mc()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Bh(t,e){this.payload=t,this.byteLength=e}function zh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Gh(t,e){this.progress=t,this.Yc=e}var Kh=(Yh.prototype.ta=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Yh.prototype.ea=function(t){for(var e=new Map,n=new jh(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.zc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Yi()).add(s);e.set(c,h)}}return e},Yh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:for(e=new jh((n=l).serializer),r=Yi(),i=Bi,o=Hi,s=0,u=p;s<u.length;s++)a=u[s],c=e.zc(a.metadata.name),a.document&&(r=r.add(c)),i=i.At(c,e.Hc(a)),o=o.At(c,e.Jc(a.metadata.readTime));return h=n.na.oo({co:!0}),[4,$h(n,_u(gu(oi.nt("__bundle__/docs/"+d))))];case 1:return f=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Jh(e,h,i,ii.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Zo.No(e,f.targetId).next(function(){return n.Zo.ko(e,r,f.targetId)}).next(function(){return n.sa.ws(e,t)})})})]}})})}(this.Zc,this.documents,this.Xc.id)];case 1:e=t.sent(),n=this.ea(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Yi()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,$h(e,_u(bc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Ko(i.readTime);return 0<=n.wt.u(e)?r.tc.Eo(t,i):(e=n.Tt(Cr.h,e),r.ra=r.ra.At(e.targetId,e),r.Zo.Co(t,e).next(function(){return r.Zo.No(t,n.targetId)}).next(function(){return r.Zo.ko(t,o,n.targetId)}).next(function(){return r.tc.Eo(t,i)}))})]}})})}(this.Zc,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Gh(Object.assign({},this.progress),e))]}})})},Yh),Hh=(Wh.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.yr(t,n.ra)})},Wh);function Wh(t,e,n,r){this.persistence=t,this.ia=e,this.serializer=r,this.ra=new Ri(Pr),this.oa=new ca(_i,Ai),this.ca=ii.min(),this.cs=t.bc(n),this.na=t.Sc(),this.Zo=t.vc(),this.sa=new la(this.na,this.cs,this.persistence.Dc()),this.tc=t.Cc(),this.ia.pr(this.sa)}function Yh(t,e,n){this.Xc=t,this.Zc=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=zh(t)}function Xh(t,e,n,r){return new Hh(t,e,n,r)}function Zh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).cs,m=e.sa,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.cs.Qr(v).next(function(t){return g=t,n=e.persistence.bc(o),m=new la(e.na,n,e.persistence.Dc()),n.Qr(v)}).next(function(t){for(var e=[],n=[],r=Yi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.ds(v,r).next(function(t){return{aa:t,ua:e,ha:n}})})})];case 1:return r=t.sent(),[2,(e.cs=n,e.sa=m,e.ia.pr(e.sa),r)]}})})}function Qh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zo.Vo(t)})}function Jh(t,s,e,u,a){var n=Yi();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Bi;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof hu&&e.version.isEqual(ii.min())?(s.Yn(t,r),o=o.At(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.zn(e,r),o=o.At(t,e)):_r("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function $h(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zo.Oo(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.Zo.Ro(e).next(function(t){return n=new Di(r,t,0,e.qo),i.Zo.vo(e,n).next(function(){return n})})})}).then(function(t){var e=i.ra.get(t.targetId);return(null===e||0<t.wt.u(e.wt))&&(i.ra=i.ra.At(t.targetId,t),i.oa.set(r,t.targetId)),t})}function tf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ra.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Nr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!La(r=t.sent()))throw r;return _r("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ra=e.ra.remove(o),e.oa.delete(n.target),[2]}})})}function ef(t,o,s){var u=t,a=ii.min(),c=Yi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=_u(o),(void 0!==(t=(i=t).oa.get(r))?ha.resolve(i.ra.get(t)):i.Zo.Oo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zo.Bo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ia.Ts(e,o,s?a:ii.min(),s?c:Yi())}).next(function(t){return{documents:t,la:c}});var t,n,r,i})}function nf(t,e){var n=t,r=n.Zo;return(t=n.ra.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.en(t,e).next(function(t){return t?t.target:null})})}function rf(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.na,n=t,t=s.ca,r=e,i=Bi,o=pc(t),t=Lc(n),n=IDBKeyRange.lowerBound(o,!0),t.di({index:Qc.readTimeIndex,range:n},function(t,e){var n=fc(r.serializer,e);i=i.At(n.key,n),o=e.readTime}).next(function(){return{Yc:i,readTime:dc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Yc,t=t.readTime;return s.ca=t,e})}function of(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==mr.FAILED_PRECONDITION||e.message!==fa)throw e;return _r("LocalStore","Unexpectedly lost primary lease"),[2]})})}function sf(t,e,n,r,i){var o=this;this.Zc=t,this.eu=e,this.Ei=n,this.nu={},this.su=[],this.iu=new Map,this.ru=new Set,this.ou=[],this.cu=i,this.cu.au(function(t){n.yi(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return xf(this)?(_r("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(4),[4,bf(e)];case 1:return t.sent(),e.uu.set("Unknown"),e.ru.delete(4),[4,wf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.uu=new pf(n,r)}var uf,af,cf,me=(mf.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},mf.prototype.ma=function(){return 2===this.state},mf.prototype.start=function(){3!==this.state?this.auth():this.Ia()},mf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},mf.prototype.Aa=function(){this.state=0,this.Ci.reset()},mf.prototype.Ra=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Ns.Ks(this._a,6e4,function(){return t.Pa()}))},mf.prototype.ya=function(t){this.ga(),this.stream.send(t)},mf.prototype.Pa=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},mf.prototype.ga=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},mf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ga(),this.Ci.cancel(),this.wa++,3!==e?this.Ci.reset():n&&n.code===mr.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Ci.qs()):n&&n.code===mr.UNAUTHENTICATED&&this.da.v(),null!==this.stream&&(this.Va(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.pa(n)];case 1:return t.sent(),[2]}})})},mf.prototype.Va=function(){},mf.prototype.auth=function(){var n=this;this.state=1;var t=this.ba(this.wa),e=this.wa;this.da.getToken().then(function(t){n.wa===e&&n.va(t)},function(e){t(function(){var t=new wr(mr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sa(t)})})},mf.prototype.va=function(t){var e=this,n=this.ba(this.wa);this.stream=this.Da(t),this.stream.Ca(function(){n(function(){return e.state=2,e.listener.Ca()})}),this.stream.pa(function(t){n(function(){return e.Sa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},mf.prototype.Ia=function(){var t=this;this.state=4,this.Ci.Us(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},mf.prototype.Sa=function(t){return _r("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},mf.prototype.ba=function(e){var n=this;return function(t){n.Ns.yi(function(){return n.wa===e?t():(_r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},mf),hf=(h(gf,cf=me),gf.prototype.Da=function(t){return this.fa.xa("Listen",t)},gf.prototype.onMessage=function(t){this.Ci.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Sr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.nn?(Dr(void 0===s||"string"==typeof s),Cr.fromBase64String(s||"")):(Dr(void 0===s||s instanceof Uint8Array),Cr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?mr.UNKNOWN:Pi(c.code),new wr(a,c.message||"")),s=new ro(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Xo(t,n.document.name),i=Ko(n.document.updateTime);var u=new tu({mapValue:{fields:n.document.fields}}),a=(o=new cu(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new eo(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Xo(t,n.document),i=n.readTime?Ko(n.readTime):ii.min(),u=new hu(r,i),o=n.removedTargetIds||[],s=new eo([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Xo(t,n.document),i=n.removedTargetIds||[],s=new eo([],i,r,null);else{if(!("filter"in e))return Sr();e.filter,(e=e.filter).targetId,r=new xi(n=e.count||0),i=e.targetId,s=new no(i,r)}return s}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ii.min():Ko(e.readTime);return this.listener.Na(n,t)},gf.prototype.Fa=function(t){var e,n,r,i,o={};o.database=Jo(this.serializer),o.addTarget=(e=this.serializer,(r=Ni(r=(n=t).target)?{documents:is(e,r)}:{query:os(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Go(e,n.resumeToken):0<n.wt.u(ii.min())&&(r.readTime=zo(e,n.wt.q())),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.dt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.ya(o)},gf.prototype.Oa=function(t){var e={};e.database=Jo(this.serializer),e.removeTarget=t,this.ya(e)},gf),ff=(h(vf,af=me),Object.defineProperty(vf.prototype,"Ma",{get:function(){return this.ka},enumerable:!1,configurable:!0}),vf.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,af.prototype.start.call(this)},vf.prototype.Va=function(){this.ka&&this.$a([])},vf.prototype.Da=function(t){return this.fa.xa("Write",t)},vf.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Ci.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Dr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ko(e.updateTime):Ko(n)).isEqual(ii.min())&&(t=Ko(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ps(t,n);var e,n})):[]),n=Ko(t.commitTime);return this.listener.La(n,e)}var r;return Dr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Ba()},vf.prototype.qa=function(){var t={};t.database=Jo(this.serializer),this.ya(t)},vf.prototype.$a=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ns(e.serializer,t)})};this.ya(t)},vf),lf=(h(yf,uf=function(){}),yf.prototype.Qa=function(){if(this.Ua)throw new wr(mr.FAILED_PRECONDITION,"The client has already been terminated.")},yf.prototype.Ka=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,r,t)}).catch(function(t){throw t.code===mr.UNAUTHENTICATED&&i.credentials.v(),t})},yf.prototype.Wa=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Wa(e,n,r,t)}).catch(function(t){throw t.code===mr.UNAUTHENTICATED&&i.credentials.v(),t})},yf.prototype.terminate=function(){this.Ua=!1},yf),pf=(df.prototype.Ja=function(){var t=this;0===this.Ga&&(this.Ya("Unknown"),this.za=this.Ei.Ks("online_state_timeout",1e4,function(){return t.za=null,t.Xa("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},df.prototype.Za=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ga++,1<=this.Ga&&(this.tu(),this.Xa("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},df.prototype.set=function(t){this.tu(),this.Ga=0,"Online"===t&&(this.Ha=!1),this.Ya(t)},df.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},df.prototype.Xa=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ha?(Ar(t),this.Ha=!1):_r("OnlineStateTracker",t)},df.prototype.tu=function(){null!==this.za&&(this.za.cancel(),this.za=null)},df);function df(t,e){this.Ei=t,this.ja=e,this.state="Unknown",this.Ga=0,this.za=null,this.Ha=!0}function yf(t,e,n){var r=this;return(r=uf.call(this)||this).credentials=t,r.fa=e,r.serializer=n,r.Ua=!1,r}function vf(t,e,n,r,i){var o=this;return(o=af.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function gf(t,e,n,r,i){var o=this;return(o=cf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function mf(t,e,n,r,i,o){this.Ns=t,this._a=n,this.fa=r,this.da=i,this.listener=o,this.state=0,this.wa=0,this.Ea=null,this.stream=null,this.Ci=new Na(t,e)}function wf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!xf(r))return[3,4];e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function bf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ef(t,e){t.iu.has(e.targetId)||(t.iu.set(e.targetId,e),Nf(t)?Af(t):Cf(t).ma()&&Tf(t,e))}function If(t,e){var n=t,t=Cf(n);n.iu.delete(e),t.ma()&&_f(n,e),0===n.iu.size&&(t.ma()?t.Ra():xf(n)&&n.uu.set("Unknown"))}function Tf(t,e){t.hu.xe(e.targetId),Cf(t).Fa(e)}function _f(t,e){t.hu.xe(e),Cf(t).Oa(e)}function Af(e){e.hu=new oo({tn:function(t){return e.nu.tn(t)},en:function(t){return e.iu.get(t)||null}}),Cf(e).start(),e.uu.Ja()}function Nf(t){return xf(t)&&!Cf(t).Ta()&&0<t.iu.size}function xf(t){return 0===t.ru.size}function Sf(t){t.hu=void 0}function Df(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!La(r))throw r;return n.ru.add(1),[4,bf(n)];case 1:return t.sent(),n.uu.set("Offline"),i=i||function(){return Qh(n.Zc)},n.Ei.$i(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return _r("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ru.delete(1),[4,wf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Of(e,n){return n().catch(function(t){return Df(e,t,n)})}function kf(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=Vf(o=c),u=0<o.su.length?o.su[o.su.length-1].batchId:-1,t.label=1;case 1:if(!(xf(o)&&o.su.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Zc,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.cs.qr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.su.length&&s.Ra(),[3,7]):(u=a.batchId,e=a,(n=o).su.push(e),(n=Vf(n)).ma()&&n.Ma&&n.$a(e.mutations),[3,6]);case 4:return a=t.sent(),[4,Df(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Pf(o)&&Rf(o),[2]}var e,n,r,i})})}function Pf(t){return xf(t)&&!Vf(t).Ta()&&0<t.su.length}function Rf(t){Vf(t).start()}function Lf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ru.delete(2),[4,wf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ru.add(2),[4,bf(e)]);case 3:t.sent(),e.uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Cf(n){var t,e,r,i=this;return n.wu||(n.wu=(t=n.eu,e=n.Ei,r={Ca:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.iu.forEach(function(t,e){Tf(n,t)}),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Sf(e),Nf(e)?(e.uu.Za(n),Af(e)):e.uu.set("Unknown"),[2]})})}.bind(null,n),Na:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.uu.set("Online"),!(u instanceof ro&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.iu.has(i)?[4,o.nu.lu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.iu.delete(i),o.hu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),_r("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Df(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof eo?s.hu.Be(u):u instanceof no?s.hu.ze(u):s.hu.Qe(u),a.isEqual(ii.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Qh(s.Zc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).hu.Ye(i)).ce.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.iu.get(e))&&r.iu.set(e,n.Tt(t.resumeToken,i))}),e.ae.forEach(function(t){var e=r.iu.get(t);e&&(r.iu.set(t,e.Tt(Cr.h,e.wt)),_f(r,t),e=new Di(e.target,t,1,e.sequenceNumber),Tf(r,e))}),r.nu._u(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return _r("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Df(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Qa(),new hf(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.wu.Aa(),Nf(n)?Af(n):n.uu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.wu.stop()];case 2:t.sent(),Sf(n),t.label=3;case 3:return[2]}})})})),n.wu}function Vf(n){var t,e,r,i=this;return n.Eu||(n.Eu=(t=n.eu,e=n.Ei,r={Ca:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Vf(e).qa(),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Vf(e).Ma?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==mr.ABORTED?(e=r.su.shift(),Vf(r).Aa(),[4,Of(r,function(){return r.nu.du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,kf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Pf(e)&&Rf(e),[2]}})})}.bind(null,n),Ba:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Vf(o),n=0,r=o.su;n<r.length;n++)i=r[n],e.$a(i.mutations);return[2]})})}.bind(null,n),La:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.su.shift(),n=aa.from(e,i,o),[4,Of(r,function(){return r.nu.fu(n)})];case 1:return t.sent(),[4,kf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qa(),new ff(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Eu.Aa(),[4,kf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Eu.stop()];case 3:t.sent(),0<n.su.length&&(_r("RemoteStore","Stopping write stream with "+n.su.length+" pending writes"),n.su=[]),t.label=4;case 4:return[2]}})})})),n.Eu}function Mf(){this.queries=new ca(xu,Nu),this.onlineState="Unknown",this.mu=new Set}var Uf=function(){this.Tu=void 0,this.listeners=[]};function jf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Uf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Iu(n)];case 2:return o.Tu=t.sent(),[3,4];case 3:return o=Ya(o=t.sent(),"Initialization of query '"+Su(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Au(e.onlineState),i.Tu&&u.Ru(i.Tu)&&Ff(e),[2]}})})}function qf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Pu(n))]:[2]})})}function Ff(t){t.mu.forEach(function(t){t.next()})}var Bf=(Wf.prototype.Ru=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ji(t.query,t.docs,t.ne,e,t.se,t.fromCache,t.ie,!0)}var o=!1;return this.gu?this.pu(t)&&(this.yu.next(t),o=!0):this.bu(t,this.onlineState)&&(this.vu(t),o=!0),this.Vu=t,o},Wf.prototype.onError=function(t){this.yu.error(t)},Wf.prototype.Au=function(t){this.onlineState=t;var e=!1;return this.Vu&&!this.gu&&this.bu(this.Vu,t)&&(this.vu(this.Vu),e=!0),e},Wf.prototype.bu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Su&&n||t.docs.Y()&&"Offline"!==e)},Wf.prototype.pu=function(t){if(0<t.docChanges.length)return!0;var e=this.Vu&&this.Vu.hasPendingWrites!==t.hasPendingWrites;return!(!t.ie&&!e)&&!0===this.options.includeMetadataChanges},Wf.prototype.vu=function(t){t=Ji.oe(t.query,t.docs,t.se,t.fromCache),this.gu=!0,this.yu.next(t)},Wf),zf=(Hf.prototype.Y=function(){return this.Du.Y()},Hf.prototype.Mo=function(t,e){e=new Gf(t,e),this.Du=this.Du.add(e),this.xu=this.xu.add(e)},Hf.prototype.Fu=function(t,e){var n=this;t.forEach(function(t){return n.Mo(t,e)})},Hf.prototype.Lo=function(t,e){this.Ou(new Gf(t,e))},Hf.prototype.ku=function(t,e){var n=this;t.forEach(function(t){return n.Lo(t,e)})},Hf.prototype.Mu=function(t){var e=this,n=new ai(new oi([])),r=new Gf(n,t),t=new Gf(n,t+1),i=[];return this.xu.jt([r,t],function(t){e.Ou(t),i.push(t.key)}),i},Hf.prototype.$u=function(){var e=this;this.Du.forEach(function(t){return e.Ou(t)})},Hf.prototype.Ou=function(t){this.Du=this.Du.delete(t),this.xu=this.xu.delete(t)},Hf.prototype.Lu=function(t){var e=new ai(new oi([])),n=new Gf(e,t),t=new Gf(e,t+1),r=Yi();return this.xu.jt([n,t],function(t){r=r.add(t.key)}),r},Hf.prototype.Jr=function(t){var e=new Gf(t,0);return null!==(e=this.Du.zt(e))&&t.isEqual(e.key)},Hf),Gf=(Kf.Cu=function(t,e){return ai.K(t.key,e.key)||Pr(t.Bu,e.Bu)},Kf.Nu=function(t,e){return Pr(t.Bu,e.Bu)||ai.K(t.key,e.key)},Kf);function Kf(t,e){this.key=t,this.Bu=e}function Hf(){this.Du=new qi(Gf.Cu),this.xu=new qi(Gf.Nu)}function Wf(t,e,n){this.query=t,this.yu=e,this.gu=!1,this.Vu=null,this.onlineState="Unknown",this.options=n||{}}function Yf(t,e){return"firestore_clients_"+t+"_"+e}function Xf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.A()&&(n+="_"+e.uid),n}function Zf(t,e){return"firestore_targets_"+t+"_"+e}var Qf=(ml.qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new wr(r.error.code,r.error.message)),i?new ml(t,e,r.state,o):(Ar("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},ml.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ml),Jf=(gl.qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new wr(n.error.code,n.error.message)),r?new gl(t,n.state,i):(Ar("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},gl.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},gl),$f=(vl.qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Xi,o=0;r&&o<n.activeTargetIds.length;++o)r=Ei(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new vl(t,i):(Ar("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},vl),tl=(yl.qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new yl(e.clientId,e.onlineState):(Ar("SharedClientState","Failed to parse online state: "+t),null)},yl),el=(dl.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},dl.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},dl.prototype.Uu=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},dl),nl=(pl.Hs=function(t){return!(!t||!t.localStorage)},pl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ju.Vc()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Wu&&(i=this.getItem(Yf(this.persistenceKey,r)))&&(o=$f.qu(r,i))&&(this.Hu=this.Hu.At(o.clientId,o));for(this.ih(),(s=this.storage.getItem(this.nh))&&(u=this.rh(s))&&this.oh(u),a=0,c=this.Ju;a<c.length;a++)h=c[a],this.zu(h);return this.Ju=[],this.window.addEventListener("unload",function(){return f.Ac()}),this.dr=!0,[2]}})})},pl.prototype.Cs=function(t){this.setItem(this.Xu,JSON.stringify(t))},pl.prototype.ah=function(){return this.uh(this.Hu)},pl.prototype.hh=function(n){var r=!1;return this.Hu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},pl.prototype.lh=function(t){this._h(t,"pending")},pl.prototype.fh=function(t,e,n){this._h(t,e,n),this.dh(t)},pl.prototype.wh=function(t){var e,n="not-current";return this.hh(t)&&(!(e=this.storage.getItem(Zf(this.persistenceKey,t)))||(e=Jf.qu(t,e))&&(n=e.state)),this.Eh.Qu(t),this.ih(),n},pl.prototype.Th=function(t){this.Eh.Ku(t),this.ih()},pl.prototype.mh=function(t){return this.Eh.activeTargetIds.has(t)},pl.prototype.Ih=function(t){this.removeItem(Zf(this.persistenceKey,t))},pl.prototype.Ah=function(t,e,n){this.Rh(t,e,n)},pl.prototype.Ph=function(t,e,n){var r=this;e.forEach(function(t){r.dh(t)}),this.currentUser=t,n.forEach(function(t){r.lh(t)})},pl.prototype.yh=function(t){this.gh(t)},pl.prototype.Vh=function(){this.ph()},pl.prototype.Ac=function(){this.dr&&(this.window.removeEventListener("storage",this.Gu),this.removeItem(this.Yu),this.dr=!1)},pl.prototype.getItem=function(t){var e=this.storage.getItem(t);return _r("SharedClientState","READ",t,e),e},pl.prototype.setItem=function(t,e){_r("SharedClientState","SET",t,e),this.storage.setItem(t,e)},pl.prototype.removeItem=function(t){_r("SharedClientState","REMOVE",t),this.storage.removeItem(t)},pl.prototype.zu=function(t){var e=this,o=t;o.storageArea===this.storage&&(_r("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.Yu?this.Ns.$i(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.dr){if(null!==o.key)if(this.Zu.test(o.key)){if(null==o.newValue)return e=this.bh(o.key),[2,this.Sh(e,null)];if(e=this.Dh(o.key,o.newValue))return[2,this.Sh(e.clientId,e)]}else if(this.th.test(o.key)){if(null!==o.newValue&&(n=this.Ch(o.key,o.newValue)))return[2,this.xh(n)]}else if(this.eh.test(o.key)){if(null!==o.newValue&&(r=this.Nh(o.key,o.newValue)))return[2,this.Fh(r)]}else if(o.key===this.nh){if(null!==o.newValue&&(i=this.rh(o.newValue)))return[2,this.oh(i)]}else if(o.key===this.Xu)(i=function(t){var e=da.xs;if(null!=t)try{var n=JSON.parse(t);Dr("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==da.xs&&this.vs(i);else if(o.key===this.sh)return[2,this.ju.Oh()]}else this.Ju.push(o);return[2]})})}):Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(pl.prototype,"Eh",{get:function(){return this.Hu.get(this.Wu)},enumerable:!1,configurable:!0}),pl.prototype.ih=function(){this.setItem(this.Yu,this.Eh.Uu())},pl.prototype._h=function(t,e,n){n=new Qf(this.currentUser,t,e,n),t=Xf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.Uu())},pl.prototype.dh=function(t){t=Xf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},pl.prototype.gh=function(t){t={clientId:this.Wu,onlineState:t},this.storage.setItem(this.nh,JSON.stringify(t))},pl.prototype.Rh=function(t,e,n){var r=Zf(this.persistenceKey,t),n=new Jf(t,e,n);this.setItem(r,n.Uu())},pl.prototype.ph=function(){this.setItem(this.sh,"value-not-used")},pl.prototype.bh=function(t){return(t=this.Zu.exec(t))?t[1]:null},pl.prototype.Dh=function(t,e){return t=this.bh(t),$f.qu(t,e)},pl.prototype.Ch=function(t,e){var n=this.th.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Qf.qu(new Hr(n),t,e)},pl.prototype.Nh=function(t,e){return t=this.eh.exec(t),t=Number(t[1]),Jf.qu(t,e)},pl.prototype.rh=function(t){return tl.qu(t)},pl.prototype.xh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ju.kh(e.batchId,e.state,e.error)]:(_r("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},pl.prototype.Fh=function(t){return this.ju.Mh(t.targetId,t.state,t.error)},pl.prototype.Sh=function(t,e){var n=this,r=e?this.Hu.At(t,e):this.Hu.remove(t),i=this.uh(this.Hu),o=this.uh(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ju.$h(s,u).then(function(){n.Hu=r})},pl.prototype.oh=function(t){this.Hu.get(t.clientId)&&this.ja(t.onlineState)},pl.prototype.uh=function(t){var n=Xi;return t.forEach(function(t,e){n=n.Ht(e.activeTargetIds)}),n},pl),rl=(ll.prototype.lh=function(t){},ll.prototype.fh=function(t,e,n){},ll.prototype.wh=function(t){return this.Lh.Qu(t),this.Bh[t]||"not-current"},ll.prototype.Ah=function(t,e,n){this.Bh[t]=e},ll.prototype.Th=function(t){this.Lh.Ku(t)},ll.prototype.mh=function(t){return this.Lh.activeTargetIds.has(t)},ll.prototype.Ih=function(t){delete this.Bh[t]},ll.prototype.ah=function(){return this.Lh.activeTargetIds},ll.prototype.hh=function(t){return this.Lh.activeTargetIds.has(t)},ll.prototype.start=function(){return this.Lh=new el,Promise.resolve()},ll.prototype.Ph=function(t,e,n){},ll.prototype.yh=function(t){},ll.prototype.Ac=function(){},ll.prototype.Cs=function(t){},ll.prototype.Vh=function(){},ll),il=function(t){this.key=t},ol=function(t){this.key=t},sl=(Object.defineProperty(fl.prototype,"jh",{get:function(){return this.qh},enumerable:!1,configurable:!0}),fl.prototype.Gh=function(t,e){var s=this,u=e?e.zh:new Qi,a=(e||this).Wh,c=(e||this).se,h=a,f=!1,l=mu(this.query)&&a.size===this.query.limit?a.last():null,p=wu(this.query)&&a.size===this.query.limit?a.first():null;if(t.gt(function(t,e){var n=a.get(t),r=(r=e instanceof cu?e:null)&&(Du(s.query,r)?r:null),i=!!n&&s.se.has(n.key),o=!!r&&(r.ln||s.se.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Hh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Kh(r,l)||p&&s.Kh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),mu(this.query)||wu(this.query))for(;h.size>this.query.limit;){var n=mu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Wh:h,zh:u,Dr:f,se:c}},fl.prototype.Hh=function(t,e){return t.ln&&e.hasCommittedMutations&&!e.ln},fl.prototype.es=function(t,e,n){var o=this,r=this.Wh;this.Wh=t.Wh,this.se=t.se;var i=t.zh.ee();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Kh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}}var r,i}),this.Jh(n);var s=e?this.Yh():[],e=(n=0===this.Qh.size&&this.fe?1:0)!==this.Uh;return this.Uh=n,0!==i.length||e?{snapshot:new Ji(this.query,t.Wh,r,i,t.se,0==n,e,!1),Xh:s}:{Xh:s}},fl.prototype.Au=function(t){return this.fe&&"Offline"===t?(this.fe=!1,this.es({Wh:this.Wh,zh:new Qi,se:this.se,Dr:!1},!1)):{Xh:[]}},fl.prototype.Zh=function(t){return!this.qh.has(t)&&!!this.Wh.has(t)&&!this.Wh.get(t).ln},fl.prototype.Jh=function(t){var e=this;t&&(t.de.forEach(function(t){return e.qh=e.qh.add(t)}),t.we.forEach(function(t){}),t.Ee.forEach(function(t){return e.qh=e.qh.delete(t)}),this.fe=t.fe)},fl.prototype.Yh=function(){var e=this;if(!this.fe)return[];var n=this.Qh;this.Qh=Yi(),this.Wh.forEach(function(t){e.Zh(t.key)&&(e.Qh=e.Qh.add(t.key))});var r=[];return n.forEach(function(t){e.Qh.has(t)||r.push(new ol(t))}),this.Qh.forEach(function(t){n.has(t)||r.push(new il(t))}),r},fl.prototype.tl=function(t){return this.qh=t.la,this.Qh=Yi(),t=this.Gh(t.documents),this.es(t,!0)},fl.prototype.el=function(){return Ji.oe(this.query,this.Wh,this.se,0===this.Uh)},fl),ul=function(t,e,n){this.query=t,this.targetId=e,this.view=n},al=function(t){this.key=t,this.nl=!1},cl=(Object.defineProperty(hl.prototype,"ml",{get:function(){return!0===this.Tl},enumerable:!1,configurable:!0}),hl);function hl(t,e,n,r,i,o){this.Zc=t,this.sl=e,this.il=n,this.rl=r,this.currentUser=i,this.ol=o,this.cl={},this.al=new ca(xu,Nu),this.ul=new Map,this.hl=[],this.ll=new Ri(ai.K),this._l=new Map,this.fl=new zf,this.dl={},this.wl=new Map,this.El=yh.Ao(),this.onlineState="Unknown",this.Tl=void 0}function fl(t,e){this.query=t,this.qh=e,this.Uh=null,this.fe=!1,this.Qh=Yi(),this.se=Yi(),this.Kh=Ou(t),this.Wh=new Zi(this.Kh)}function ll(){this.Lh=new el,this.Bh={},this.ja=null,this.vs=null}function pl(t,e,n,r,i){this.window=t,this.Ns=e,this.persistenceKey=n,this.Wu=r,this.ju=null,this.ja=null,this.vs=null,this.Gu=this.zu.bind(this),this.Hu=new Ri(Pr),this.dr=!1,this.Ju=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Yu=Yf(this.persistenceKey,this.Wu),this.Xu="firestore_sequence_number_"+this.persistenceKey,this.Hu=this.Hu.At(this.Wu,new el),this.Zu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.th=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.eh=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.nh="firestore_online_state_"+this.persistenceKey,this.sh="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Gu)}function dl(){this.activeTargetIds=Xi}function yl(t,e){this.clientId=t,this.onlineState=e}function vl(t,e){this.clientId=t,this.activeTargetIds=e}function gl(t,e,n){this.targetId=t,this.state=e,this.error=n}function ml(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function wl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Il=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Gh(o)).Dr?[4,ef(r.Zc,i.query,!1).then(function(t){return t=t.documents,i.view.Gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.ce.get(i.targetId),n=i.view.es(e,r.ml,n),[2,(Sl(r,i.targetId,n.Xh),n.snapshot)]}})})}(i,t,e,n)},[4,ef(i.Zc,o,!0)];case 1:return n=t.sent(),r=new sl(o,n.la),e=r.Gh(n.documents),n=to._e(s,u&&"Offline"!==i.onlineState),n=r.es(e,i.ml,n),Sl(i,s,n.Xh),r=new ul(o,s,r),[2,(i.al.set(o,r),i.ul.has(s)?i.ul.get(s).push(o):i.ul.set(s,[o]),n.snapshot)]}})})}function bl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Ll(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Zc,a=p,h=i,f=ri.now(),o=a.reduce(function(t,e){return t.add(e.key)},Yi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.sa.ds(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ws?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof cu?t.field(i.field):void 0;null!=(o=ls(i.transform,o||null))&&(e=(null==e?new eu:e).set(i.field,o))}return e?e._n():null}(o):null);null!=o&&e.push(new Bs(i.key,o,function s(t){var u=[];return go(t.fields||{},function(t,e){var n=new ui([t]);if(Vo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ds(u)}(o.proto.mapValue),Rs.exists(!0)))}return h.cs.Mr(u,f,e,a)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Wn:e}}))];case 2:return s=t.sent(),u.rl.lh(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.dl[e.currentUser.R()])||new Ri(Pr)).At(n,r),e.dl[e.currentUser.R()]=i,[4,Ol(u,s.Wn)];case 3:return t.sent(),[4,kf(u.sl)];case 4:return t.sent(),[3,6];case 5:return u=Ya(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function El(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,a=e,c=(r=s).wt,h=a.ra,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.na.oo({co:!0});h=a.ra;var u=[];r.ce.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Zo.$o(s,t.Ee,e).next(function(){return a.Zo.ko(s,t.de,e)})),0<(i=t.resumeToken).o()&&(n=o.Tt(i,c).Et(s.qo),h=h.At(e,n),r=o,i=t,Dr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.wt.B()-r.wt.B()||0<i.de.size+i.we.size+i.Ee.size)&&u.push(a.Zo.Co(s,n))))});var e,n=Bi;return r.ue.forEach(function(t,e){r.he.has(t)&&u.push(a.persistence.Nr.kc(s,t))}),u.push(Jh(s,t,r.ue,c,void 0).next(function(t){n=t})),c.isEqual(ii.min())||(e=a.Zo.Vo(s).next(function(t){return a.Zo.bo(s,s.qo,c)}),u.push(e)),ha.Qn(u).next(function(){return t.apply(s)}).next(function(){return a.sa.ws(s,n)})}).then(function(t){return a.ra=h,t}))];case 2:return i=t.sent(),s.ce.forEach(function(t,e){(e=n._l.get(e))&&(Dr(t.de.size+t.we.size+t.Ee.size<=1),0<t.de.size?e.nl=!0:0<t.we.size?Dr(e.nl):0<t.Ee.size&&(Dr(e.nl),e.nl=!1))}),[4,Ol(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,of(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function Il(t,n,e){var r;((t=t).ml&&0===e||!t.ml&&1===e)&&(r=[],t.al.forEach(function(t,e){(e=e.view.Au(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Au(i)&&(o=!0)}),o&&Ff(t)}(t.il,n),r.length&&t.cl.Na(r),t.onlineState=n,t.ml&&t.rl.yh(n))}function Tl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:xf((n=o).sl)||_r("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Zc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.cs.Ur(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.wl.get(r)||[]).push(s),n.wl.set(r,i),[3,4]);case 3:return i=Ya(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function _l(t,e){(t.wl.get(e)||[]).forEach(function(t){t.resolve()}),t.wl.delete(e)}function Al(t,e,n){var r=t,i=r.dl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.dl[r.currentUser.R()]=i)}function Nl(e,t,n){void 0===n&&(n=null),e.rl.Th(t);for(var r=0,i=e.ul.get(t);r<i.length;r++){var o=i[r];e.al.delete(o),n&&e.cl.Al(o,n)}e.ul.delete(t),e.ml&&e.fl.Mu(t).forEach(function(t){e.fl.Jr(t)||xl(e,t)})}function xl(t,e){var n=t.ll.get(e);null!==n&&(If(t.sl,n),t.ll=t.ll.remove(e),t._l.delete(n),Dl(t))}function Sl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof il?(t.fl.Mo(u.key,e),r=t,i=(i=u).key,r.ll.get(i)||(_r("SyncEngine","New document in limbo: "+i),r.hl.push(i),Dl(r))):u instanceof ol?(_r("SyncEngine","Document no longer in limbo: "+u.key),t.fl.Lo(u.key,e),t.fl.Jr(u.key)||xl(t,u.key)):Sr()}}function Dl(t){for(;0<t.hl.length&&t.ll.size<t.ol;){var e=t.hl.shift(),n=t.El.next();t._l.set(n,new al(e)),t.ll=t.ll.At(e,n),Ef(t.sl,new Di(_u(gu(e.path)),n,2,da.xs))}}function Ol(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).al.Y()?[3,3]:(n.al.forEach(function(t,e){o.push(n.Il(e,s,u).then(function(t){t&&(n.ml&&n.rl.Ah(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=pa.bs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.cl.Na(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(c,function(e){return ha.forEach(e.Vs,function(t){return r.persistence.Nr.Mo(n,e.targetId,t)}).next(function(){return ha.forEach(e.ps,function(t){return r.persistence.Nr.Lo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!La(e=t.sent()))throw e;return _r("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ra.get(o),u=s.wt,u=s.It(u),r.ra=r.ra.At(o,u));return[2]}})})}(n.Zc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function kl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.ul.get(s))&&0!==a.length?[4,$h(e.Zc,_u(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.al.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ef((e=r).Zc,i.query,!0)];case 1:return n=t.sent(),n=i.view.tl(n),[2,(e.ml&&Sl(e,i.targetId,n.Xh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,nf(e.Zc,s)];case 8:return l=t.sent(),[4,$h(e.Zc,l)];case 9:return u=t.sent(),[4,wl(e,Pl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.cl.Na(r),n)]}})})}function Pl(t){return vu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Rl(t){return t.sl.nu._u=El.bind(null,t),t.sl.nu.tn=function(t,e){var n=t;if((t=n._l.get(e))&&t.nl)return Yi().add(t.key);var r=Yi();if(!(e=n.ul.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.al.get(s),r=r.Ht(s.view.jh);return r}.bind(null,t),t.sl.nu.lu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).rl.Ah(s,"rejected",u),i=e._l.get(s),(n=i&&i.key)?(r=(r=new Ri(ai.K)).At(n,new hu(n,ii.min())),i=Yi().add(n),i=new $i(ii.min(),new Map,new qi(Pr),r,i),[4,El(e,i)]):[3,2];case 1:return t.sent(),e.ll=e.ll.remove(n),e._l.delete(s),Dl(e),[3,4];case 2:return[4,tf(e.Zc,s,!1).then(function(){return Nl(e,s,u)}).catch(of)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.cl.Na=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ru(s)&&(r=!0);u.Tu=s}}r&&Ff(n)}.bind(null,t.il),t.cl.Al=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.il),t}function Ll(t){return t.sl.nu.fu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.na.oo({co:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ha.resolve();return a.forEach(function(n){c=c.next(function(){return s.Xn(o,n)}).next(function(t){var e=t;Dr(null!==(t=r.Cn.get(n))),(!e||e.version.u(t)<0)&&(e=u.pn(n,e,r))&&s.zn(e,r.Dn)})}),c.next(function(){return i.cs.Wr(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.cs.Hr(t)}).next(function(){return f.sa.ds(t,e)})}))];case 2:return i=t.sent(),Al(n,r,null),_l(n,r),n.rl.fh(r,"acknowledged"),[4,Ol(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,of(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.sl.nu.du=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.cs.Lr(e,r).next(function(t){return Dr(null!==t),n=t.keys(),i.cs.Wr(e,t)}).next(function(){return i.cs.Hr(e)}).next(function(){return i.sa.ds(e,n)})}))];case 2:return o=t.sent(),Al(n,u,a),_l(n,u),n.rl.fh(u,"rejected",a),[4,Ol(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,of(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}function Cl(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Zc,i=u,s=new jh((o=r).serializer).Jc(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.tc._o(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Rl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Pl(zh(u)),a=new Kh(u,l.Zc,p.serializer),[4,p.Uc()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ta(c)]:[3,10];case 7:return(h=t.sent())&&d.Pl(h),[4,p.Uc()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Ol(l,f.Yc,void 0)];case 12:return t.sent(),[4,(r=l.Zc,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.tc.fo(t,e)}))];case 13:return t.sent(),d.Rl(f.progress),[3,15];case 14:return Nr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.yl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.rl.Vh()})}var Vl,Ml,Ul,jl,ql,Fl=(Ip.prototype.kr=function(t){return ha.resolve(0===this.cs.length)},Ip.prototype.Mr=function(t,e,n,r){var i=this.gl;this.gl++,0<this.cs.length&&this.cs[this.cs.length-1],n=new ua(i,e,n,r),this.cs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Vl=this.Vl.add(new Gf(u.key,i)),this.us.$r(t,u.key.path.G())}return ha.resolve(n)},Ip.prototype.Lr=function(t,e){return ha.resolve(this.pl(e))},Ip.prototype.qr=function(t,e){return e+=1,e=(e=this.bl(e))<0?0:e,ha.resolve(this.cs.length>e?this.cs[e]:null)},Ip.prototype.Ur=function(){return ha.resolve(0===this.cs.length?-1:this.gl-1)},Ip.prototype.Qr=function(t){return ha.resolve(this.cs.slice())},Ip.prototype.ls=function(t,e){var n=this,r=new Gf(e,0),e=new Gf(e,Number.POSITIVE_INFINITY),i=[];return this.Vl.jt([r,e],function(t){t=n.pl(t.Bu),i.push(t)}),ha.resolve(i)},Ip.prototype.Es=function(t,e){var n=this,r=new qi(Pr);return e.forEach(function(t){var e=new Gf(t,0),t=new Gf(t,Number.POSITIVE_INFINITY);n.Vl.jt([e,t],function(t){r=r.add(t.Bu)})}),ha.resolve(this.vl(r))},Ip.prototype.ys=function(t,e){var n=e.path,r=n.length+1,e=n;ai.lt(e)||(e=e.child(""));var e=new Gf(new ai(e),0),i=new qi(Pr);return this.Vl.Gt(function(t){var e=t.key.path;return!!n.X(e)&&(e.length===r&&(i=i.add(t.Bu)),!0)},e),ha.resolve(this.vl(i))},Ip.prototype.vl=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.pl(t))&&n.push(t)}),n},Ip.prototype.Wr=function(n,r){var i=this;Dr(0===this.Sl(r.batchId,"removed")),this.cs.shift();var o=this.Vl;return ha.forEach(r.mutations,function(t){var e=new Gf(t.key,r.batchId);return o=o.delete(e),i.Nr.zr(n,t.key)}).next(function(){i.Vl=o})},Ip.prototype.Gr=function(t){},Ip.prototype.Jr=function(t,e){var n=new Gf(e,0),n=this.Vl.zt(n);return ha.resolve(e.isEqual(n&&n.key))},Ip.prototype.Hr=function(t){return this.cs.length,ha.resolve()},Ip.prototype.Sl=function(t,e){return this.bl(t)},Ip.prototype.bl=function(t){return 0===this.cs.length?0:t-this.cs[0].batchId},Ip.prototype.pl=function(t){return(t=this.bl(t))<0||t>=this.cs.length?null:this.cs[t]},Ip),Bl=(Ep.prototype.zn=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Dl(e);return this.docs=this.docs.At(r,{Jn:e,size:o,readTime:n}),this.size+=o-i,this.us.$r(t,r.path.G())},Ep.prototype.Yn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ep.prototype.Xn=function(t,e){return e=this.docs.get(e),ha.resolve(e?e.Jn:null)},Ep.prototype.getEntries=function(t,e){var n=this,r=Bi;return e.forEach(function(t){var e=n.docs.get(t);r=r.At(t,e?e.Jn:null)}),ha.resolve(r)},Ep.prototype.Ts=function(t,e,n){for(var r=Ki,i=new ai(e.path.child("")),o=this.docs.vt(i);o.Ft();){var s=(u=o.Nt()).key,u=(a=u.value).Jn,a=a.readTime;if(!e.path.X(s.path))break;a.u(n)<=0||u instanceof cu&&Du(e,u)&&(r=r.At(u.key,u))}return ha.resolve(r)},Ep.prototype.Cl=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},Ep.prototype.oo=function(t){return new zl(this)},Ep.prototype.ao=function(t){return ha.resolve(this.size)},Ep),zl=(h(bp,ql=o),bp.prototype.es=function(n){var r=this,i=[];return this.Wn.forEach(function(t,e){e&&e.Jn?i.push(r.uo.zn(n,e.Jn,r.Gn(t))):r.uo.Yn(t)}),ha.Qn(i)},bp.prototype.Zn=function(t,e){return this.uo.Xn(t,e)},bp.prototype.ts=function(t,e){return this.uo.getEntries(t,e)},bp),Gl=(wp.prototype.Ke=function(t,n){return this.xl.forEach(function(t,e){return n(e)}),ha.resolve()},wp.prototype.Vo=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},wp.prototype.po=function(t){return ha.resolve(this.Nl)},wp.prototype.Ro=function(t){return this.highestTargetId=this.Ol.next(),ha.resolve(this.highestTargetId)},wp.prototype.bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Nl&&(this.Nl=e),ha.resolve()},wp.prototype.So=function(t){this.xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ol=new yh(e),this.highestTargetId=e),t.sequenceNumber>this.Nl&&(this.Nl=t.sequenceNumber)},wp.prototype.vo=function(t,e){return this.So(e),this.targetCount+=1,ha.resolve()},wp.prototype.Co=function(t,e){return this.So(e),ha.resolve()},wp.prototype.xo=function(t,e){return this.xl.delete(e.target),this.Fl.Mu(e.targetId),--this.targetCount,ha.resolve()},wp.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return this.xl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.xl.delete(t),u.push(o.No(n,e.targetId)),s++)}),ha.Qn(u).next(function(){return s})},wp.prototype.Fo=function(t){return ha.resolve(this.targetCount)},wp.prototype.Oo=function(t,e){return e=this.xl.get(e)||null,ha.resolve(e)},wp.prototype.ko=function(t,e,n){return this.Fl.Fu(e,n),ha.resolve()},wp.prototype.$o=function(e,t,n){this.Fl.ku(t,n);var r=this.persistence.Nr,i=[];return r&&t.forEach(function(t){i.push(r.zr(e,t))}),ha.Qn(i)},wp.prototype.No=function(t,e){return this.Fl.Mu(e),ha.resolve()},wp.prototype.Bo=function(t,e){return e=this.Fl.Lu(e),ha.resolve(e)},wp.prototype.Jr=function(t,e){return ha.resolve(this.Fl.Jr(e))},wp),Kl=(mp.prototype._o=function(t,e){return ha.resolve(this.kl.get(e))},mp.prototype.fo=function(t,e){return this.kl.set(e.id,{id:e.id,version:e.version,createTime:Ko(e.createTime)}),ha.resolve()},mp.prototype.wo=function(t,e){return ha.resolve(this.Ml.get(e))},mp.prototype.Eo=function(t,e){return this.Ml.set(e.name,{name:e.name,query:bc(e.bundledQuery),readTime:Ko(e.readTime)}),ha.resolve()},mp),Hl=(gp.prototype.start=function(){return Promise.resolve()},gp.prototype.Ac=function(){return this.Wo=!1,Promise.resolve()},Object.defineProperty(gp.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),gp.prototype.cc=function(){},gp.prototype.ac=function(){},gp.prototype.Dc=function(){return this.us},gp.prototype.bc=function(t){var e=this.$l[t.R()];return e||(e=new Fl(this.us,this.Nr),this.$l[t.R()]=e),e},gp.prototype.vc=function(){return this.Zo},gp.prototype.Sc=function(){return this.os},gp.prototype.Cc=function(){return this.tc},gp.prototype.runTransaction=function(t,e,n){var r=this;_r("MemoryPersistence","Starting transaction:",t);var i=new Wl(this.Ko.next());return this.Nr.Bl(),n(i).next(function(t){return r.Nr.ql(i).next(function(){return t})}).qn().then(function(t){return i.rs(),t})},gp.prototype.Ul=function(e,n){return ha.Kn(Object.values(this.$l).map(function(t){return function(){return t.Jr(e,n)}}))},gp),Wl=(h(vp,jl=ge),vp),Yl=(yp.Wl=function(t){return new yp(t)},Object.defineProperty(yp.prototype,"jl",{get:function(){if(this.Kl)return this.Kl;throw Sr()},enumerable:!1,configurable:!0}),yp.prototype.Mo=function(t,e,n){return this.Ql.Mo(n,e),this.jl.delete(n.toString()),ha.resolve()},yp.prototype.Lo=function(t,e,n){return this.Ql.Lo(n,e),this.jl.add(n.toString()),ha.resolve()},yp.prototype.zr=function(t,e){return this.jl.add(e.toString()),ha.resolve()},yp.prototype.removeTarget=function(t,e){var n=this;this.Ql.Mu(e.targetId).forEach(function(t){return n.jl.add(t.toString())});var r=this.persistence.vc();return r.Bo(t,e.targetId).next(function(t){t.forEach(function(t){return n.jl.add(t.toString())})}).next(function(){return r.xo(t,e)})},yp.prototype.Bl=function(){this.Kl=new Set},yp.prototype.ql=function(n){var r=this,i=this.persistence.Sc().oo();return ha.forEach(this.jl,function(t){var e=ai.at(t);return r.Gl(n,e).next(function(t){t||i.Yn(e)})}).next(function(){return r.Kl=null,i.apply(n)})},yp.prototype.kc=function(t,e){var n=this;return this.Gl(t,e).next(function(t){t?n.jl.delete(e.toString()):n.jl.add(e.toString())})},yp.prototype.Ll=function(t){return 0},yp.prototype.Gl=function(t,e){var n=this;return ha.Kn([function(){return ha.resolve(n.Ql.Jr(e))},function(){return n.persistence.vc().Jr(t,e)},function(){return n.persistence.Ul(t,e)}])},yp),Xl=(dp.prototype.Ca=function(t){this.Jl=t},dp.prototype.pa=function(t){this.Yl=t},dp.prototype.onMessage=function(t){this.Xl=t},dp.prototype.close=function(){this.Hl()},dp.prototype.send=function(t){this.zl(t)},dp.prototype.Zl=function(){this.Jl()},dp.prototype.t_=function(t){this.Yl(t)},dp.prototype.e_=function(t){this.Xl(t)},dp),Zl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ql=(pp.prototype.Ka=function(e,t,n,r){var i=this.r_(e,t);return _r("RestConnection","Sending: ",i,n),t={},this.o_(t,r),this.c_(e,i,t,n).then(function(t){return _r("RestConnection","Received: ",t),t},function(t){throw Nr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},pp.prototype.Wa=function(t,e,n,r){return this.Ka(t,e,n,r)},pp.prototype.o_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-BundlePrerelease.f8bb4d8b7",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},pp.prototype.r_=function(t,e){return t=Zl[t],this.s_+"/v1/"+e+":"+t},h(lp,Ul=pp),lp.prototype.c_=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(dr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case pr.NO_ERROR:var t=i.getResponseJson();_r("Connection","XHR received:",JSON.stringify(t)),n(t);break;case pr.TIMEOUT:_r("Connection",'RPC "'+o+'" timed out'),r(new wr(mr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e=i.getStatus();_r("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(mr).indexOf(e)?e:mr.UNKNOWN,r(new wr(e,t.message))):r(new wr(mr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new wr(mr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{_r("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},lp.prototype.xa=function(t,e){var n,r=[this.s_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=lr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.o_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),_r("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Xl({zl:function(t){a?_r("Connection","Not sending because WebChannel is closed:",t):(u||(_r("Connection","Opening WebChannel transport."),s.open(),u=!0),_r("Connection","WebChannel sending:",t),s.send(t))},Hl:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,vr.EventType.OPEN,function(){a||_r("Connection","WebChannel transport opened.")}),t(s,vr.EventType.CLOSE,function(){a||(a=!0,_r("Connection","WebChannel transport closed"),c.t_())}),t(s,vr.EventType.ERROR,function(t){a||(a=!0,Nr("Connection","WebChannel transport errored:",t),c.t_(new wr(mr.UNAVAILABLE,"The operation could not be completed")))}),t(s,vr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Dr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(_r("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Si[r];if(void 0!==t)return Pi(t)}(),i=n.message,void 0===t&&(t=mr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.t_(new wr(t,i)),s.close()):(_r("Connection","WebChannel received:",e),c.e_(e)))}),t(o,yr.STAT_EVENT,function(t){10===t.stat?_r("Connection","Detected buffering proxy"):11===t.stat&&_r("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Zl()},0),c},lp),Jl=(fp.prototype.au=function(t){this.__.push(t)},fp.prototype.Ac=function(){window.removeEventListener("online",this.a_),window.removeEventListener("offline",this.h_)},fp.prototype.f_=function(){window.addEventListener("online",this.a_),window.addEventListener("offline",this.h_)},fp.prototype.u_=function(){_r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(0)},fp.prototype.l_=function(){_r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(1)},fp.Hs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fp),$l=(hp.prototype.au=function(t){},hp.prototype.Ac=function(){},hp),tp=(cp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Vh(e.n_.T),this.rl=this.d_(e),this.persistence=this.w_(e),[4,this.persistence.start()];case 1:return t.sent(),this.E_=this.T_(e),this.Zc=this.m_(e),[2]}})})},cp.prototype.T_=function(t){return null},cp.prototype.m_=function(t){return Xh(this.persistence,new rc,t.I_,this.serializer)},cp.prototype.w_=function(t){return new Hl(Yl.Wl,this.serializer)},cp.prototype.d_=function(t){return new rl},cp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.E_&&this.E_.stop(),[4,this.rl.Ac()];case 1:return t.sent(),[4,this.persistence.Ac()];case 2:return t.sent(),[2]}})})},cp),ep=(h(ap,Ml=tp),ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ml.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Lc(t),r=ii.min(),t.di({index:Qc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=dc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.ca=t})]})})}(this.Zc)];case 2:return t.sent(),[4,this.A_.initialize(this,e)];case 3:return t.sent(),[4,Ll(this.A_.ju)];case 4:return t.sent(),[4,kf(this.A_.sl)];case 5:return t.sent(),[2]}})})},ap.prototype.m_=function(t){return Xh(this.persistence,new rc,t.I_,this.serializer)},ap.prototype.T_=function(t){var e=this.persistence.Nr.ur;return new ec(e,t.Ei)},ap.prototype.w_=function(t){var e=Rh(t.n_.T,t.n_.persistenceKey),n=void 0!==this.cacheSizeBytes?Ja.sr(this.cacheSizeBytes):Ja.cr;return new Ah(this.synchronizeTabs,e,t.clientId,n,t.Ei,Ba(),za(),this.serializer,this.rl,!!this.forceOwnership)},ap.prototype.d_=function(t){return new rl},ap),np=(h(up,Vl=ep),up.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Vl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.A_.ju,this.rl instanceof nl?(this.rl.ju={kh:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Zc,n=a,i=(r=e).cs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.sa.ds(e,t):ha.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,kf(o.sl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Al(o,a,h||null),_l(o,a),o.Zc.cs.Gr(a)):Sr(),t.label=4;case 4:return[4,Ol(o,s)];case 5:return t.sent(),[3,7];case 6:_r("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),Mh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Tl?(_r("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.ul.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,rf(e.Zc)];case 3:return n=t.sent(),r=$i.le(o,"current"===s),[4,Ol(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,tf(e.Zc,o,!0)];case 6:return t.sent(),Nl(e,o,u),[3,8];case 7:Sr(),t.label=8;case 8:return[2]}})})}.bind(null,e),$h:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Rl(c)).Tl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.ul.has(r)?(_r("SyncEngine","Adding an already active target "+r),[3,5]):[4,nf(n.Zc,r)]):[3,6];case 2:return i=t.sent(),[4,$h(n.Zc,i)];case 3:return o=t.sent(),[4,wl(n,Pl(i),o.targetId,!1)];case 4:t.sent(),Ef(n.sl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.ul.has(e)?[4,tf(n.Zc,e,!1).then(function(){If(n.sl,e),Nl(n,e)}).catch(of)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Vc:function(t){return t.Zc.persistence.Vc()}.bind(null,e),Oh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,rf((e=n).Zc).then(function(t){return Ol(e,t)})]})})}.bind(null,e)},[4,this.rl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.oc(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Rl(r=h),Ll(r),!0!==f||!0===r.Tl?[3,3]:(e=r.rl.ah(),[4,kl(r,e.tt())]);case 1:return i=t.sent(),r.Tl=!0,[4,Lf(r.sl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Ef(r.sl,u);return[3,7];case 3:return!1!==f||!1===r.Tl?[3,7]:(a=[],c=Promise.resolve(),r.ul.forEach(function(t,e){r.rl.mh(e)?a.push(e):c=c.then(function(){return Nl(r,e),tf(r.Zc,e,!0)}),If(r.sl,e)}),[4,c]);case 4:return t.sent(),[4,kl(r,a)];case 5:return t.sent(),(n=r)._l.forEach(function(t,e){If(n.sl,e)}),n.fl.$u(),n._l=new Map,n.ll=new Ri(ai.K),r.Tl=!1,[4,Lf(r.sl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.A_.ju,e)];case 1:return t.sent(),this.E_&&(e&&!this.E_.dr?this.E_.start(this.Zc):e||this.E_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},up.prototype.d_=function(t){var e=Ba();if(!nl.Hs(e))throw new wr(mr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Rh(t.n_.T,t.n_.persistenceKey);return new nl(e,t.Ei,n,t.clientId,t.I_)},up),rp=(sp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Zc?[3,2]:(this.Zc=n.Zc,this.rl=n.rl,this.eu=this.R_(r),this.sl=this.P_(r),this.il=this.y_(r),this.ju=this.g_(r,!n.synchronizeTabs),this.rl.ja=function(t){return Il(e.ju,t,1)},this.sl.nu.V_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(_r("SyncEngine","User change. New user:",o.R()),[4,Zh(n.Zc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).wl.forEach(function(t){t.forEach(function(t){t.reject(new wr(mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.wl.clear(),n.rl.Ph(o,r.ua,r.ha),[4,Ol(n,r.aa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.ju),[4,Lf(this.sl,this.ju.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},sp.prototype.y_=function(t){return new Mf},sp.prototype.R_=function(t){var e=Vh(t.n_.T),n=(n=t.n_,new Ql(n));return t=t.credentials,new lf(t,n,e)},sp.prototype.P_=function(t){var e=this;return new sf(this.Zc,this.eu,t.Ei,function(t){return Il(e.ju,t,0)},t=new(Jl.Hs()?Jl:$l))},sp.prototype.g_=function(t,e){return n=this.Zc,r=this.sl,i=this.il,o=this.rl,s=t.I_,t=t.ol,e=e,t=new cl(n,r,i,o,s,t),e&&(t.Tl=!0),t;var n,r,i,o,s},sp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,_r("RemoteStore","RemoteStore shutting down."),e.ru.add(5),[4,bf(e)];case 1:return t.sent(),e.cu.Ac(),e.uu.set("Unknown"),[2]}})})}(this.sl)},sp),ip=(op.prototype.next=function(t){this.observer.next&&this.p_(this.observer.next,t)},op.prototype.error=function(t){this.observer.error?this.p_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},op.prototype.b_=function(){this.muted=!0},op.prototype.p_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},op);function op(t){this.observer=t,this.muted=!1}function sp(){}function up(t,e){var n=this;return(n=Vl.call(this,t,e,!1)||this).A_=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ap(t,e,n){var r=this;return(r=Ml.call(this)||this).A_=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function cp(){this.synchronizeTabs=!1}function hp(){}function fp(){var t=this;this.a_=function(){return t.u_()},this.h_=function(){return t.l_()},this.__=[],this.f_()}function lp(t){var e=this;return(e=Ul.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function pp(t){this.n_=t,this.T=t.T;var e=t.ssl?"https":"http";this.s_=e+"://"+t.host,this.i_="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function dp(t){this.zl=t.zl,this.Hl=t.Hl}function yp(t){this.persistence=t,this.Ql=new zf,this.Kl=null}function vp(t){var e=this;return(e=jl.call(this)||this).qo=t,e}function gp(t,e){var n=this;this.$l={},this.Ko=new da(0),this.Wo=!1,this.Wo=!0,this.Nr=t(this),this.Zo=new Gl(this),this.us=new Mc,this.os=(t=this.us,new Bl(t,function(t){return n.Nr.Ll(t)})),this.serializer=new hc(e),this.tc=new Kl(this.serializer)}function mp(t){this.serializer=t,this.kl=new Map,this.Ml=new Map}function wp(t){this.persistence=t,this.xl=new ca(_i,Ai),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.Nl=0,this.Fl=new zf,this.targetCount=0,this.Ol=yh.Io()}function bp(t){var e=this;return(e=ql.call(this)||this).uo=t,e}function Ep(t,e){this.us=t,this.Dl=e,this.docs=new Ri(ai.K),this.size=0}function Ip(t,e){this.us=t,this.Nr=e,this.cs=[],this.gl=1,this.Vl=new qi(Gf.Cu)}function Tp(t,e,n){if(!n)throw new wr(mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function _p(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new wr(mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ap(t,e,n,r){if(!0===e&&!0===r)throw new wr(mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Np(t){if(!ai.lt(t))throw new wr(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function xp(t){if(ai.lt(t))throw new wr(mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Sp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Sr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Dp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new wr(mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Sp(t),new wr(mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Op(t,e){if(e<=0)throw new wr(mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var kp,Pp=function(t){this._methodName=t},Rp=(h(Lp,kp=Pp),Lp.prototype.v_=function(t){if(2!==t.S_)throw 1===t.S_?t.D_(this._methodName+"() can only appear at the top level of your update data"):t.D_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.sn.push(t.path),null},Lp.prototype.isEqual=function(t){return t instanceof Lp},Lp);function Lp(){return null!==kp&&kp.apply(this,arguments)||this}function Cp(t,e,n){return new Ty({S_:3,C_:e.settings.C_,methodName:t._methodName,x_:n},e.T,e.serializer,e.ignoreUndefinedProperties)}var Vp,Mp,Up,jp,qp,Fp,Bp=(h(cd,Fp=Pp),cd.prototype.v_=function(t){return new Os(t.path,new ys)},cd.prototype.isEqual=function(t){return t instanceof cd},cd),zp=(h(ad,qp=Pp),ad.prototype.v_=function(t){var e=Cp(this,t,!0),n=this.N_.map(function(t){return ky(t,e)}),n=new vs(n);return new Os(t.path,n)},ad.prototype.isEqual=function(t){return this===t},ad),Gp=(h(ud,jp=Pp),ud.prototype.v_=function(t){var e=Cp(this,t,!0),n=this.N_.map(function(t){return ky(t,e)}),n=new Es(n);return new Os(t.path,n)},ud.prototype.isEqual=function(t){return this===t},ud),Kp=(h(sd,Up=Pp),sd.prototype.v_=function(t){var e=new As(t.serializer,Bo(t.serializer,this.F_));return new Os(t.path,e)},sd.prototype.isEqual=function(t){return this===t},sd),Hp=(Object.defineProperty(od.prototype,"latitude",{get:function(){return this.O_},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"longitude",{get:function(){return this.k_},enumerable:!1,configurable:!0}),od.prototype.isEqual=function(t){return this.O_===t.O_&&this.k_===t.k_},od.prototype.toJSON=function(){return{latitude:this.O_,longitude:this.k_}},od.prototype.$=function(t){return Pr(this.O_,t.O_)||Pr(this.k_,t.k_)},od),Wp=new Map,Yp=(id.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},id),Xp=(Object.defineProperty(rd.prototype,"app",{get:function(){if(!this.Q_)throw new wr(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"K_",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"W_",{get:function(){return void 0!==this.j_},enumerable:!1,configurable:!0}),rd.prototype.G_=function(t){if(this.B_)throw new wr(mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.L_=new Yp(t),void 0!==t.credentials&&(this.U_=function(t){if(!t)return new $r;switch(t.type){case"gapi":var e=t.client;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ni(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new wr(mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},rd.prototype.z_=function(){return this.L_},rd.prototype.H_=function(){return this.B_=!0,this.L_},rd.prototype._delete=function(){return this.j_||(this.j_=this.J_()),this.j_},rd.prototype.J_=function(){return(t=Wp.get(this))&&(_r("ComponentProvider","Removing Datastore"),Wp.delete(this),t.terminate()),Promise.resolve();var t},rd),o=(nd.prototype.Y_=function(t,e){switch(void 0===e&&(e="none"),Io(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Do(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t,e);case 5:return t.stringValue;case 6:return this.tf(Oo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue,e);case 10:return this.rf(t.mapValue,e);default:throw Sr()}},nd.prototype.rf=function(t,n){var r=this,i={};return go(t.fields||{},function(t,e){i[t]=r.Y_(e,n)}),i},nd.prototype.nf=function(t){return new Hp(Do(t.latitude),Do(t.longitude))},nd.prototype.sf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Y_(t,e)})},nd.prototype.Z_=function(t,e){switch(e){case"previous":var n=function t(e){return wo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Y_(n,e);case"estimate":return this.X_(bo(t));default:return null}},nd.prototype.X_=function(t){return t=So(t),new ri(t.seconds,t.nanos)},nd.prototype.cf=function(t,e){var n=oi.nt(t);return Dr(fs(n)),t=new Kr(n.get(1),n.get(3)),n=new ai(n.j(5)),t.isEqual(e)||Ar("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},nd),Zp=(h(ed,Mp=o),ed.prototype.tf=function(t){return new zr(new Mr(t))},ed.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),Iv.af(t,this.firestore,null)},ed),Qp=(Object.defineProperty(td.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"ref",{get:function(){return new Cd(this.uf,this.ff,this.lf)},enumerable:!1,configurable:!0}),td.prototype.exists=function(){return null!==this._f},td.prototype.data=function(){if(this._f){if(this.ff){var t=new Jp(this.uf,this.hf,this.lf,this._f,null);return this.ff.fromFirestore(t)}return this.hf.Y_(this._f.mn())}},td.prototype.get=function(t){if(this._f&&null!==(t=this._f.data().field(hd("DocumentSnapshot.get",t))))return this.hf.Y_(t)},td),Jp=(h($p,Vp=Qp),$p.prototype.data=function(){return Vp.prototype.data.call(this)},$p);function $p(){return null!==Vp&&Vp.apply(this,arguments)||this}function td(t,e,n,r,i){this.uf=t,this.hf=e,this.lf=n,this._f=r,this.ff=i}function ed(t){var e=this;return(e=Mp.call(this)||this).firestore=t,e}function nd(){}function rd(t,e){this.M_="(lite)",this.L_=new Yp({}),this.B_=!1,t instanceof Kr?(this.q_=t,this.U_=new $r):(this.Q_=t,this.q_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new wr(mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kr(t.options.projectId)}(t),this.U_=new ti(e))}function id(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new wr(mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new wr(mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ap("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function od(t,e){if(!isFinite(t)||t<-90||90<t)throw new wr(mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new wr(mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O_=t,this.k_=e}function sd(t,e){var n=this;return(n=Up.call(this,t)||this).F_=e,n}function ud(t,e){var n=this;return(n=jp.call(this,t)||this).N_=e,n}function ad(t,e){var n=this;return(n=qp.call(this,t)||this).N_=e,n}function cd(){return null!==Fp&&Fp.apply(this,arguments)||this}function hd(t,e){return"string"==typeof e?My(t,e):(e instanceof Ur?e._:e).df}var fd,ld=(yd.prototype.isEqual=function(t){return this.df.isEqual(t.df)},yd),pd=(h(dd,fd=Xp),dd.prototype.J_=function(){return this.Ef||vv(this),this.Ef.terminate()},dd);function dd(t,e){var n=this;return(n=fd.call(this,t,e)||this).wf=new Ka,n.M_="name"in t?t.name:"[DEFAULT]",n}function yd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new wr(mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.df=new ui(t)}function vd(n,r,i){var t=this,o=new Aa;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Hy(n,i)];case 1:return t.sent(),[4,Wy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===mr.FAILED_PRECONDITION||t.code===mr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function gd(t){if(t.K_||t.W_)throw new wr(mr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var md,wd,bd=(h(Ad,wd=Qp),Ad.prototype.exists=function(){return wd.prototype.exists.call(this)},Ad.prototype.data=function(t){if(void 0===t&&(t={}),this._f){if(this.ff){var e=new Ed(this.uf,this.hf,this.lf,this._f,this.metadata,null);return this.ff.fromFirestore(e,t)}return this.hf.Y_(this._f.mn(),t.serverTimestamps)}},Ad.prototype.get=function(t,e){if(void 0===e&&(e={}),this._f&&null!==(t=this._f.data().field(hd("DocumentSnapshot.get",t))))return this.hf.Y_(t,e.serverTimestamps)},Ad),Ed=(h(_d,md=bd),_d.prototype.data=function(t){return void 0===t&&(t={}),md.prototype.data.call(this,t)},_d),Id=(Object.defineProperty(Td.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"size",{get:function(){return this.mf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Td.prototype.forEach=function(e,n){var r=this;this.mf.docs.forEach(function(t){e.call(n,new Ed(r.uf,r.hf,t.key,t,new Cv(r.mf.se.has(t.key),r.mf.fromCache),r.query.ff))})},Td.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.mf.re)throw new wr(mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.If&&this.Af===t||(this.If=function(i,e){if(i.mf.ne.Y()){var n=0;return i.mf.docChanges.map(function(t){var e=new Ed(i.uf,i.hf,t.doc.key,t.doc,new Cv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.mf.ne;return i.mf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ed(i.uf,i.hf,t.doc.key,t.doc,new Cv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Af=t),this.If},Td);function Td(t,e,n,r){this.uf=t,this.hf=e,this.mf=r,this.metadata=new Cv(r.hasPendingWrites,r.fromCache),this.query=n}function _d(){return null!==md&&md.apply(this,arguments)||this}function Ad(t,e,n,r,i,o){var s=this;return(s=wd.call(this,t,e,n,r,o)||this).uf=t,s.Tf=t,s.metadata=i,s}function Nd(t,e){return t instanceof bd&&e instanceof bd?t.uf===e.uf&&t.lf.isEqual(e.lf)&&(null===t._f?null===e._f:t._f.isEqual(e._f))&&t.ff===e.ff:t instanceof Id&&e instanceof Id&&t.uf===e.uf&&yy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.mf.isEqual(e.mf)}function xd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Sd,Dd=(h(Od,Sd=o),Od.prototype.tf=function(t){return new Mr(t)},Od.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),new Cd(this.firestore,null,t)},Od);function Od(t){var e=this;return(e=Sd.call(this)||this).firestore=t,e}function kd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Dp(t,Cd);var o=Dp(t.firestore,pd),s=vy(o);return e instanceof Ur&&(e=e._),Rd(o,("string"==typeof e||e instanceof ld?Dy(s,"updateDoc",t.lf,e,n,r):Sy(s,"updateDoc",t.lf,e)).Pf(t.lf,Rs.exists(!0)))}function Pd(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Ur&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||xd(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return xd(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Cd?(u=Dp(e.firestore,pd),a=gu(e.lf.path),h={next:function(t){n[i]&&n[i](Ld(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Dp(e,Vd),u=Dp(s.firestore,pd),a=s.Rf,c=new Dd(u),h={next:function(t){n[i]&&n[i](new Id(u,c,s,t))},error:n[i+1],complete:n[i+2]},oy(e.Rf)),function(n,t,e){var r=this,i=new ip(h),o=new Bf(t,i,e);return n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=jf,[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.b_(),n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=qf,[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(yv(u),a,f)}function Rd(t,e){return function(n,r){var t=this,i=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=bl,[4,$y(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(yv(t),e)}function Ld(t,e,n){var r=n.docs.get(e.lf),i=new Dd(t);return new bd(t,i,e.lf,r,new Cv(n.hasPendingWrites,n.fromCache),e.ff)}var Cd=(Object.defineProperty(Ud.prototype,"yf",{get:function(){return this.lf.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"path",{get:function(){return this.lf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"parent",{get:function(){return new uy(this.firestore,this.ff,this.lf.path.G())},enumerable:!1,configurable:!0}),Ud.prototype.withConverter=function(t){return new Ud(this.firestore,t,this.lf)},Ud),Vd=(Md.prototype.withConverter=function(t){return new Md(this.firestore,t,this.Rf)},Md);function Md(t,e,n){this.ff=e,this.Rf=n,this.type="query",this.firestore=t}function Ud(t,e,n){this.ff=e,this.lf=n,this.type="document",this.firestore=t}function jd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].gf(t);return t}var qd,Fd,Bd,zd,Gd,Kd=(h(ty,Gd=ge=function(){}),ty.prototype.gf=function(t){var e=vy(t.firestore),e=function(t,e,n,r,i,o){if(r.rt()){if("array-contains"===i||"array-contains-any"===i)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ry(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(ny(n,t,c))}h={arrayValue:{values:s}}}else h=ny(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ry(o,i),h=Oy(e,"where",o,"in"===i||"not-in"===i);var h=Pu.create(r,i,h);return function(t,e){if(e.Pn()){var n=Eu(t);if(null!==n&&!n.isEqual(e.field))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=bu(t))&&iy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new wr(mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new wr(mr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.Rf,e,t.firestore.q_,this.Vf,this.pf,this.bf);return new Vd(t.firestore,t.ff,(e=(t=t.Rf).filters.concat([e]),new lu(t.path,t.collectionGroup,t.In.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ty),Hd=(h($d,zd=ge),$d.prototype.gf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new sa(e,n);return e=r,null!==bu(n=t)||null!==(t=Eu(n))&&iy(0,t,e.field),r}(t.Rf,this.Vf,this.vf);return new Vd(t.firestore,t.ff,(e=(t=t.Rf).In.concat([e]),new lu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},$d),Wd=(h(Jd,Bd=ge),Jd.prototype.gf=function(t){return new Vd(t.firestore,t.ff,Au(t.Rf,this.Sf,this.Df))},Jd),Yd=(h(Qd,Fd=ge),Qd.prototype.gf=function(t){var e=ey(t,this.type,this.Cf,this.xf);return new Vd(t.firestore,t.ff,(t=t.Rf,new lu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Qd),Xd=(h(Zd,qd=ge),Zd.prototype.gf=function(t){var e=ey(t,this.type,this.Cf,this.xf);return new Vd(t.firestore,t.ff,(t=t.Rf,new lu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Zd);function Zd(t,e,n){var r=this;return(r=qd.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function Qd(t,e,n){var r=this;return(r=Fd.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function Jd(t,e,n){var r=this;return(r=Bd.call(this)||this).type=t,r.Sf=e,r.Df=n,r}function $d(t,e){var n=this;return(n=zd.call(this)||this).Vf=t,n.vf=e,n.type="orderBy",n}function ty(t,e,n){var r=this;return(r=Gd.call(this)||this).Vf=t,r.pf=e,r.bf=n,r.type="where",r}function ey(t,c,e,n){if(e[0]instanceof Ur&&(e[0]=e[0]._),e[0]instanceof Qp)return function(t,e,n,r){if(!n)throw new wr(mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Tu(t);o<s.length;o++){var u=s[o];if(u.field.rt())i.push(ko(e,n.key));else{var a=n.field(u.field);if(wo(a))throw new wr(mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.et(),new wr(mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Ju(i,r)}(t.Rf,t.firestore.q_,e[0]._f,n);var r=vy(t.firestore);return function(t,e,n,r,i,o){var s=t.In;if(i.length>s.length)throw new wr(mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.rt()){if("string"!=typeof c)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Iu(t)&&-1!==c.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(oi.nt(c));if(!ai.lt(h))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ai(h),u.push(ko(e,h))}else c=Oy(n,r,c),u.push(c)}return new Ju(u,o)}(t.Rf,t.firestore.q_,r,c,e,n)}function ny(t,e,n){if(n instanceof Ur&&(n=n._),"string"==typeof n){if(""===n)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Iu(e)&&-1!==n.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(oi.nt(n)),!ai.lt(e))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ko(t,new ai(e))}if(n instanceof Cd)return ko(t,n.lf);throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Sp(n)+".")}function ry(t,e){if(!Array.isArray(t)||0===t.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function iy(t,e,n){if(!n.isEqual(e))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function oy(t){if(wu(t)&&0===t.In.length)throw new wr(mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sy,uy=(h(ay,sy=Vd),Object.defineProperty(ay.prototype,"id",{get:function(){return this.Rf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"path",{get:function(){return this.Rf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"parent",{get:function(){var t=this.yf.G();return t.Y()?null:new Cd(this.firestore,null,new ai(t))},enumerable:!1,configurable:!0}),ay.prototype.withConverter=function(t){return new ay(this.firestore,t,this.yf)},ay);function ay(t,e,n){var r=this;return(r=sy.call(this,t,e,gu(n))||this).firestore=t,r.yf=n,r.type="collection",r}function cy(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),Tp("collection","path",e),t instanceof Xp)return xp(n=oi.nt.apply(oi,f([e],r))),new uy(t,null,n);if(!(t instanceof Cd||t instanceof uy))throw new wr(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return xp(n=oi.nt.apply(oi,f([t.path],r)).child(oi.nt(e))),new uy(t.firestore,null,n)}function hy(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),1===arguments.length&&(e=Or.t()),Tp("doc","path",e),t instanceof Xp)return Np(n=oi.nt.apply(oi,f([e],r))),new Cd(t,null,new ai(n));if(!(t instanceof Cd||t instanceof uy))throw new wr(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Np(n=t.yf.child(oi.nt.apply(oi,f([e],r)))),new Cd(t.firestore,t instanceof uy?t.ff:null,new ai(n))}var fy,ly=(h(py,fy=o),py.prototype.tf=function(t){return new Mr(t)},py.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),new Cd(this.firestore,null,t)},py);function py(t){var e=this;return(e=fy.call(this)||this).firestore=t,e}function dy(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),(t instanceof Cd||t instanceof uy)&&(e instanceof Cd||e instanceof uy)&&t.firestore===e.firestore&&t.path===e.path&&t.ff===e.ff}function yy(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),t instanceof Vd&&e instanceof Vd&&t.firestore===e.firestore&&Nu(t.Rf,e.Rf)&&t.ff===e.ff}function vy(t){var e=t.H_(),n=Vh(t.q_);return new _y(t.q_,!!e.ignoreUndefinedProperties,n)}var gy=/^__.*__$/,my=(Ey.prototype.Pf=function(t,e){var n=[];return null!==this.sn?n.push(new Bs(t,this.data,this.sn,e)):n.push(new Fs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ws(t,this.fieldTransforms)),n},Ey),wy=(by.prototype.Pf=function(t,e){return e=[new Bs(t,this.data,this.sn,e)],0<this.fieldTransforms.length&&e.push(new Ws(t,this.fieldTransforms)),e},by);function by(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Ey(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Iy(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Sr()}}var Ty=(Object.defineProperty(Ny.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ny.prototype,"S_",{get:function(){return this.settings.S_},enumerable:!1,configurable:!0}),Ny.prototype.Ff=function(t){return new Ny(Object.assign(Object.assign({},this.settings),t),this.T,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.sn)},Ny.prototype.Of=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Ff({path:e,x_:!1})).kf(t),e},Ny.prototype.Mf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Ff({path:t,x_:!1})).Nf(),t},Ny.prototype.$f=function(t){return this.Ff({path:void 0,x_:!0})},Ny.prototype.D_=function(t){return Uy(t,this.settings.methodName,this.settings.Lf||!1,this.path,this.settings.C_)},Ny.prototype.contains=function(e){return void 0!==this.sn.find(function(t){return e.X(t)})||void 0!==this.fieldTransforms.find(function(t){return e.X(t.field)})},Ny.prototype.Nf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kf(this.path.get(t))},Ny.prototype.kf=function(t){if(0===t.length)throw this.D_("Document fields must not be empty");if(Iy(this.S_)&&gy.test(t))throw this.D_('Document fields cannot begin and end with "__"')},Ny),_y=(Ay.prototype.Bf=function(t,e,n,r){return void 0===r&&(r=!1),new Ty({S_:t,methodName:e,C_:n,path:ui.st(),x_:!1,Lf:r},this.T,this.serializer,this.ignoreUndefinedProperties)},Ay);function Ay(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.serializer=n||Vh(t)}function Ny(t,e,n,r,i,o){this.settings=t,this.T=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nf(),this.fieldTransforms=i||[],this.sn=o||[]}function xy(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bf(o.merge||o.mergeFields?2:0,e,n,i);Ly("Data must be an object, but it was:",s,r);var u,a,r=Py(r,s);if(o.merge)u=new Ds(s.sn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Cy(e,f[h],n);if(!s.contains(l))throw new wr(mr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");jy(c,l)||c.push(l)}u=new Ds(c),a=s.fieldTransforms.filter(function(t){return u.hn(t.field)})}else u=null,a=s.fieldTransforms;return new my(new tu(r),u,a)}function Sy(t,r,i,e){var o=t.Bf(1,r,i);Ly("Data must be an object, but it was:",o,e);var s=[],u=new eu;return go(e,function(t,e){var n=My(r,t,i);e instanceof Ur&&(e=e._),t=o.Mf(n),e instanceof Rp?s.push(n):null!=(t=ky(e,t))&&(s.push(n),u.set(n,t))}),e=new Ds(s),new wy(u._n(),e,o.fieldTransforms)}function Dy(t,e,n,r,i,o){var s=t.Bf(1,e,n),u=[Cy(e,r,n)],a=[i];if(o.length%2!=0)throw new wr(mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Cy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new eu,y=u.length-1;0<=y;--y)jy(p,u[y])||(h=u[y],(f=a[y])instanceof Ur&&(f=f._),l=s.Mf(h),f instanceof Rp?p.push(h):null!=(l=ky(f,l))&&(p.push(h),d.set(h,l)));return i=new Ds(p),new wy(d._n(),i,s.fieldTransforms)}function Oy(t,e,n,r){return void 0===r&&(r=!1),ky(n,t.Bf(r?4:3,e))}function ky(s,t){if(s instanceof Ur&&(s=s._),Ry(s))return Ly("Unsupported field value:",t,s),Py(s,t);if(s instanceof Pp)return function(t,e){if(!Iy(e.S_))throw e.D_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.D_(t._methodName+"() is not currently supported inside arrays");(t=t.v_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.sn.push(t.path),s instanceof Array){if(t.settings.x_&&4!==t.S_)throw t.D_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ky(i[r],t.$f(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Ur&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Bo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ri.fromDate(t);return{timestampValue:zo(e.serializer,n)}}if(t instanceof ri)return n=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:zo(e.serializer,n)};if(t instanceof Hp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Mr)return{bytesValue:Go(e.serializer,t.l)};if(t instanceof Cd){n=e.T;var r=t.firestore.q_;if(!r.isEqual(n))throw e.D_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ho(t.firestore.q_||e.T,t.lf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.D_("Unsupported field value: "+Sp(t))}(s,t)}function Py(t,n){var r={};return mo(t)?n.path&&0<n.path.length&&n.sn.push(n.path):go(t,function(t,e){null!=(e=ky(e,n.Of(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ry(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof Hp||t instanceof Mr||t instanceof Cd||t instanceof Pp)}function Ly(t,e,n){if(!Ry(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Sp(n))?e.D_(t+" a custom object"):e.D_(t+" "+n);var r}function Cy(t,e,n){if(e instanceof Ur&&(e=e._),e instanceof ld)return e.df;if("string"==typeof e)return My(t,e);throw Uy("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Vy=new RegExp("[~\\*/\\[\\]]");function My(e,n,r){if(0<=n.search(Vy))throw Uy("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(ld.bind.apply(ld,f([void 0],n.split("."))))).df}catch(t){throw Uy("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Uy(t,e,n,r,i){var o=r&&!r.Y(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new wr(mr.INVALID_ARGUMENT,(e+=". ")+t+n)}function jy(t,e){return t.some(function(t){return t.isEqual(e)})}var qy=(Ky.prototype.Wf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),0<this.mutations.length)throw new wr(mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Jo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Yo(r.serializer,t)})},[4,r.Wa("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=Xo(t,e.found.name),t=Ko(e.found.updateTime),e=new tu({mapValue:{fields:e.found.fields}});return new cu(n,t,e,{})}(n,t):"missing"in t?(e=n,Dr(!!(n=t).missing),Dr(!!n.readTime),e=Xo(e,n.missing),n=Ko(n.readTime),new hu(e,n)):Sr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Dr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof hu||t instanceof cu?n.Gf(t):Sr()}),e)]}})})},Ky.prototype.set=function(t,e){this.write(e.Pf(t,this.cn(t))),this.Kf.add(t.toString())},Ky.prototype.update=function(t,e){try{this.write(e.Pf(t,this.zf(t)))}catch(t){this.Qf=t}this.Kf.add(t.toString())},Ky.prototype.delete=function(t){this.write([new Js(t,this.cn(t))]),this.Kf.add(t.toString())},Ky.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),this.Qf)throw this.Qf;return e=this.qf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ai.at(e),n.mutations.push(new $s(e,n.cn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Jo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ns(e.serializer,t)})},[4,e.Ka("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.Uf=!0,[2]}})})},Ky.prototype.Gf=function(t){var e;if(t instanceof cu)e=t.version;else{if(!(t instanceof hu))throw Sr();e=ii.min()}var n=this.qf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new wr(mr.ABORTED,"Document version changed between two reads.")}else this.qf.set(t.key.toString(),e)},Ky.prototype.cn=function(t){var e=this.qf.get(t.toString());return!this.Kf.has(t.toString())&&e?Rs.updateTime(e):Rs.an()},Ky.prototype.zf=function(t){var e=this.qf.get(t.toString());if(this.Kf.has(t.toString())||!e)return Rs.exists(!0);if(e.isEqual(ii.min()))throw new wr(mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rs.updateTime(e)},Ky.prototype.write=function(t){this.jf(),this.mutations=this.mutations.concat(t)},Ky.prototype.jf=function(){},Ky),Fy=(Gy.prototype.run=function(){this.Jf()},Gy.prototype.Jf=function(){var t=this;this.Ci.Us(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new qy(this.eu),(n=this.Yf(e))&&n.then(function(t){r.Ei.yi(function(){return e.commit().then(function(){r.Ii.resolve(t)}).catch(function(t){r.Xf(t)})})}).catch(function(t){r.Xf(t)}),[2]})})})},Gy.prototype.Yf=function(t){try{var e=this.updateFunction(t);return!wi(e)&&e.catch&&e.then?e:(this.Ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ii.reject(t),null}},Gy.prototype.Xf=function(t){var e=this;0<this.Hf&&this.Zf(t)?(--this.Hf,this.Ei.yi(function(){return e.Jf(),Promise.resolve()})):this.Ii.reject(t)},Gy.prototype.Zf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!ki(t))},Gy),By=(zy.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{Ei:this.Ei,n_:this.n_,clientId:this.clientId,credentials:this.credentials,I_:this.user,ol:100})]}})})},zy.prototype.ed=function(t){var e=this;this.td=t,this.N.promise.then(function(){return e.td(e.user)})},zy.prototype.nd=function(){if(this.Ei.Ni)throw new wr(mr.FAILED_PRECONDITION,"The client has already been terminated.")},zy.prototype.terminate=function(){var t=this;this.Ei.Mi();var n=new Aa;return this.Ei.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sd?[4,this.sd.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rd?[4,this.rd.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=Ya(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},zy);function zy(t,e,n){var r=this;this.credentials=t,this.Ei=e,this.n_=n,this.user=Hr.UNAUTHENTICATED,this.clientId=Or.t(),this.td=function(){},this.N=new Aa,this.credentials.S(function(t){_r("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.td(t)),r.N.resolve()})}function Gy(t,e,n,r){this.Ei=t,this.eu=e,this.updateFunction=n,this.Ii=r,this.Hf=5,this.Ci=new Na(this.Ei,"transaction_retry")}function Ky(t){this.eu=t,this.qf=new Map,this.mutations=[],this.Uf=!1,this.Qf=null,this.Kf=new Set}function Hy(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),_r("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ed(function(e){return r.Ei.$i(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zh(i.Zc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.cc(function(){return r.terminate()}),r.rd=i,[2]}})})}function Wy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),[4,Yy(r)];case 1:return e=t.sent(),_r("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ed(function(t){return r.Ei.$i(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ei.qi(),_r("RemoteStore","RemoteStore received new credentials"),n=xf(e),e.ru.add(3),[4,bf(e)];case 1:return t.sent(),n&&e.uu.set("Unknown"),[4,e.nu.V_(i)];case 2:return t.sent(),e.ru.delete(3),[4,wf(e)];case 3:return t.sent(),[2]}})})}(i.sl,t)})}),r.sd=i,[2]}})})}function Yy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rd?[3,2]:(_r("FirestoreClient","Using default OfflineComponentProvider"),[4,Hy(e,new tp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rd]}})})}function Xy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sd?[3,2]:(_r("FirestoreClient","Using default OnlineComponentProvider"),[4,Wy(e,new rp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sd]}})})}function Zy(t){return Yy(t).then(function(t){return t.persistence})}function Qy(t){return Yy(t).then(function(t){return t.Zc})}function Jy(t){return Xy(t).then(function(t){return t.sl})}function $y(t){return Xy(t).then(function(t){return t.ju})}function tv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xy(r)];case 1:return e=t.sent(),[2,((n=e.il).Iu=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Rl(s),(o=e.al.get(u))?(n=o.targetId,e.rl.wh(n),r=o.view.el(),[3,4]):[3,1];case 1:return[4,$h(e.Zc,_u(u))];case 2:return i=t.sent(),o=e.rl.wh(i.targetId),n=i.targetId,[4,wl(e,u,n,"current"===o)];case 3:r=t.sent(),e.ml&&Ef(e.sl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ju),n.Pu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).al.get(o),1<(r=e.ul.get(n.targetId)).length?[2,(e.ul.set(n.targetId,r.filter(function(t){return!Nu(t,o)})),void e.al.delete(o))]:e.ml?(e.rl.Th(n.targetId),e.rl.hh(n.targetId)?[3,2]:[4,tf(e.Zc,n.targetId,!1).then(function(){e.rl.Ih(n.targetId),If(e.sl,n.targetId),Nl(e,n.targetId)}).catch(of)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Nl(e,n.targetId),[4,tf(e.Zc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ju),n)]}})})}function ev(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new ip({next:function(t){r.yi(function(){return qf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new wr(mr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new wr(mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Bf(gu(i.path),t,{includeMetadataChanges:!0,Su:!0});return jf(n,u)},[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}function nv(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new ip({next:function(t){n.yi(function(){return qf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new wr(mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Bf(t,o,{includeMetadataChanges:!0,Su:!0});return jf(e,s)},[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}var rv=(iv.prototype.set=function(t,e,n){return this.ld(),e=Zv((t=ov(t,this.uf)).ff,e,n),n=xy(this.hd,"WriteBatch.set",t.lf,e,null!==t.ff,n),this.ad=this.ad.concat(n.Pf(t.lf,Rs.an())),this},iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.ld(),t=ov(t,this.uf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof ld?Dy(this.hd,"WriteBatch.update",t.lf,e,n,r):Sy(this.hd,"WriteBatch.update",t.lf,e),this.ad=this.ad.concat(e.Pf(t.lf,Rs.exists(!0))),this},iv.prototype.delete=function(t){return this.ld(),t=ov(t,this.uf),this.ad=this.ad.concat(new Js(t.lf,Rs.an())),this},iv.prototype.commit=function(){return this.ld(),this.ud=!0,0<this.ad.length?this.od(this.ad):Promise.resolve()},iv.prototype.ld=function(){if(this.ud)throw new wr(mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},iv);function iv(t,e){this.uf=t,this.od=e,this.ad=[],this.ud=!1,this.hd=vy(t)}function ov(t,e){if(t instanceof Ur&&(t=t._),t.firestore!==e)throw new wr(mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var sv,uv,av=(dv.prototype.get=function(t){var e=this,n=ov(t,this.uf),r=new ly(this.uf);return this._d.Wf([n.lf]).then(function(t){if(!t||1!==t.length)return Sr();if((t=t[0])instanceof hu)return new Qp(e.uf,r,n.lf,null,n.ff);if(t instanceof cu)return new Qp(e.uf,r,t.key,t,n.ff);throw Sr()})},dv.prototype.set=function(t,e,n){return e=Zv((t=ov(t,this.uf)).ff,e,n),n=xy(this.hd,"Transaction.set",t.lf,e,null!==t.ff,n),this._d.set(t.lf,n),this},dv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=ov(t,this.uf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof ld?Dy(this.hd,"Transaction.update",t.lf,e,n,r):Sy(this.hd,"Transaction.update",t.lf,e),this._d.update(t.lf,e),this},dv.prototype.delete=function(t){return t=ov(t,this.uf),this._d.delete(t.lf),this},h(pv,uv=dv),pv.prototype.get=function(t){var e=this,n=ov(t,this.uf),r=new Dd(this.uf);return uv.prototype.get.call(this,t).then(function(t){return new bd(e.uf,r,n.lf,t._f,new Cv(!1,!1),n.ff)})},pv),cv=(lv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){gd(t=Dp(t,pd));var n=yv(t),r=t.H_();return vd(n,t=new rp,new ep(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},lv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){gd(t=Dp(t,pd));var e=yv(t),n=t.H_();return vd(e,t=new rp,new np(t,n.cacheSizeBytes))}(t._)},lv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.K_&&!n.W_)throw new wr(mr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Aa;return n.wf.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return xa.Hs()?(e=n+"main",[4,xa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Rh(n.q_,n.M_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},lv),hv=(h(fv,sv=Ur),Object.defineProperty(fv.prototype,"q_",{get:function(){return this._.q_},enumerable:!1,configurable:!0}),fv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.z_()),t)).merge,this._.G_(t)},fv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.z_().host&&Nr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},fv.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return e=t.sent(),[4,Jy(r)];case 2:return n=t.sent(),[2,(e.ac(!0),(t=n).ru.delete(0),wf(t))]}})})})}(yv(Dp(this._,pd)))},fv.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return e=t.sent(),[4,Jy(r)];case 2:return n=t.sent(),[2,(e.ac(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(0),[4,bf(e)];case 1:return t.sent(),e.uu.set("Offline"),[2]}})})}(n))]}})})})}(yv(Dp(this._,pd)))},fv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ap("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.fd.enableMultiTabIndexedDbPersistence(this):this.fd.enableIndexedDbPersistence(this,n)},fv.prototype.clearPersistence=function(){return this.fd.clearIndexedDbPersistence(this)},fv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},fv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Tl,[4,$y(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(yv(Dp(this._,pd)))},fv.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new ip(t);return n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.add(e),e.next()},[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.b_(),n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.delete(e)},[4,tv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(yv(Dp(this._,pd)),xd(t)?t:{next:t})},Object.defineProperty(fv.prototype,"app",{get:function(){if(!this.dd)throw new wr(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!1,configurable:!0}),fv.prototype.collection=function(t){try{return new Fv(this,cy(this._,t))}catch(t){throw Nv(t,"collection()","Firestore.collection()")}},fv.prototype.doc=function(t){try{return new Iv(this,hy(this._,t))}catch(t){throw Nv(t,"doc()","Firestore.doc()")}},fv.prototype.collectionGroup=function(t){try{return new Uv(this,function(t,e){if(t=Dp(t,Xp),Tp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Vd(t,null,new lu(oi.st(),e))}(this._,t))}catch(t){throw Nv(t,"collectionGroup()","Firestore.collectionGroup()")}},fv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Xy(n).then(function(t){return t.eu})];case 1:return e=t.sent(),new Fy(n.Ei,e,r,i).run(),[2]}})})}),i.promise}(yv(n=this._),function(t){return t=new av(n,t),e(new bv(r,t))})},fv.prototype.batch=function(){var e=this;return yv(this._),new Ev(new rv(this._,function(t){return Rd(e._,t)}))},fv.prototype.loadBundle=function(t){throw new wr(mr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},fv.prototype.namedQuery=function(t){throw new wr(mr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},fv);function fv(t,e,n){var r=this;return(r=sv.call(this,e)||this).fd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Kr||(r.dd=t),r}function lv(){}function pv(t,e){var n=this;return(n=uv.call(this,t,e)||this).uf=t,n}function dv(t,e){this.uf=t,this._d=e,this.hd=vy(t)}function yv(t){return t.Ef||vv(t),t.Ef.nd(),t.Ef}function vv(t){var e,n,r=t.H_(),r=(e=t.q_,n=t.M_,new Gr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ef=new By(t.U_,t.wf,r)}var gv,mv,wv,bv=(h(Av,wv=Ur),Av.prototype.get=function(t){var e=this,t=Xv(t);return this._.get(t).then(function(t){return new Vv(e.uf,t)})},Av.prototype.set=function(t,e,n){return t=Xv(t),n?(_p("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Av.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Xv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Av.prototype.delete=function(t){return t=Xv(t),this._.delete(t),this},Av),Ev=(h(_v,mv=Ur),_v.prototype.set=function(t,e,n){return t=Xv(t),n?(_p("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},_v.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Xv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},_v.prototype.delete=function(t){return t=Xv(t),this._.delete(t),this},_v.prototype.commit=function(){return this._.commit()},_v),Iv=(h(Tv,gv=Ur),Tv.wd=function(t,e,n){if(t.length%2!=0)throw new wr(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.et()+" has "+t.length);return new Tv(e,new Cd(e._,n,new ai(t)))},Tv.af=function(t,e,n){return new Tv(e,new Cd(e._,n,t))},Object.defineProperty(Tv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"parent",{get:function(){return new Fv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Tv.prototype.collection=function(t){try{return new Fv(this.firestore,cy(this._,t))}catch(t){throw Nv(t,"collection()","DocumentReference.collection()")}},Tv.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof Cd&&dy(this._,t)},Tv.prototype.set=function(t,e){e=_p("DocumentReference.set",e);try{return function(t,e,n){t=Dp(t,Cd);var r=Dp(t.firestore,pd),e=Zv(t.ff,e,n);return Rd(r,xy(vy(r),"setDoc",t.lf,e,null!==t.ff,n).Pf(t.lf,Rs.an()))}(this._,t,e)}catch(t){throw Nv(t,"setDoc()","DocumentReference.set()")}},Tv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?kd(this._,t):kd.apply(void 0,f([this._,t,e],n))}catch(t){throw Nv(t,"updateDoc()","DocumentReference.update()")}},Tv.prototype.delete=function(){return Rd(Dp((t=this._).firestore,pd),[new Js(t.lf,Rs.an())]);var t},Tv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=Sv(t,function(t){return new Vv(e.firestore,new bd(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))});return Pd(this._,r,i)},Tv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Dp(e,Cd);var n=Dp(e.firestore,pd),t=yv(n),r=new Dd(n);return function(n,r){var t=this,i=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.sa.hs(t,e)}))];case 1:return(r=t.sent())instanceof cu?s.resolve(r):r instanceof hu?s.resolve(null):s.reject(new wr(mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ya(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,Qy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.lf).then(function(t){return new bd(n,r,e.lf,t,new Cv(t instanceof cu&&t.ln,!0),e.ff)})}:"server"===(null==t?void 0:t.source)?function(e){e=Dp(e,Cd);var n=Dp(e.firestore,pd);return ev(yv(n),e.lf,{source:"server"}).then(function(t){return Ld(n,e,t)})}:function(e){e=Dp(e,Cd);var n=Dp(e.firestore,pd);return ev(yv(n),e.lf).then(function(t){return Ld(n,e,t)})})(this._).then(function(t){return new Vv(e.firestore,new bd(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))})},Tv.prototype.withConverter=function(t){return new Tv(this.firestore,this._.withConverter(t))},Tv);function Tv(t,e){var n=this;return(n=gv.call(this,e)||this).firestore=t,n.hf=new Zp(t),n}function _v(){return null!==mv&&mv.apply(this,arguments)||this}function Av(t,e){var n=this;return(n=wv.call(this,e)||this).uf=t,n}function Nv(t,e,n){return t.message=t.message.replace(e,n),t}function xv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!xd(r))return r}return{}}function Sv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=xd(t[0])?t[0]:xd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Dv,Ov,kv,Pv,Rv,Lv,Cv=(Yv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yv),Vv=(h(Wv,Lv=Ur),Object.defineProperty(Wv.prototype,"ref",{get:function(){return new Iv(this.uf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Wv.prototype.data=function(t){return this._.data(t)},Wv.prototype.get=function(t,e){return this._.get(t,e)},Wv.prototype.isEqual=function(t){return Nd(this._,t._)},Wv),Mv=(h(Hv,Rv=Vv),Hv.prototype.data=function(t){return this._.data(t)},Hv),Uv=(h(Kv,Pv=Ur),Kv.prototype.where=function(t,e,n){try{return new Kv(this.firestore,jd(this._,(r=n,i=e,o=hd("where",t),new Kd(o,i,r))))}catch(t){throw Nv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Kv.prototype.orderBy=function(n,t){try{return new Kv(this.firestore,jd(this._,function(t){void 0===t&&(t="asc");var e=t,t=hd("orderBy",n);return new Hd(t,e)}(t)))}catch(n){throw Nv(n,/(orderBy|where)\(\)/,"Query.$1()")}},Kv.prototype.limit=function(t){try{return new Kv(this.firestore,jd(this._,(Op("limit",e=t),new Wd("limit",e,"F"))))}catch(t){throw Nv(t,"limit()","Query.limit()")}var e},Kv.prototype.limitToLast=function(t){try{return new Kv(this.firestore,jd(this._,(Op("limitToLast",e=t),new Wd("limitToLast",e,"L"))))}catch(t){throw Nv(t,"limitToLast()","Query.limitToLast()")}var e},Kv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Nv(t,"startAt()","Query.startAt()")}},Kv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Nv(t,"startAfter()","Query.startAfter()")}},Kv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xd("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Nv(t,"endBefore()","Query.endBefore()")}},Kv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xd("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Nv(t,"endAt()","Query.endAt()")}},Kv.prototype.isEqual=function(t){return yy(this._,t._)},Kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Dp(e,Vd);var n=Dp(e.firestore,pd),t=yv(n),r=new Dd(n);return function(n,r){var t=this,i=new Aa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ef(r,i,!0)];case 1:return n=t.sent(),e=new sl(i,n.la),n=e.Gh(n.documents),n=e.es(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ya(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Qy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Rf).then(function(t){return new Id(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Dp(e,Vd);var n=Dp(e.firestore,pd),t=yv(n),r=new Dd(n);return nv(t,e.Rf,{source:"server"}).then(function(t){return new Id(n,r,e,t)})}:function(e){e=Dp(e,Vd);var n=Dp(e.firestore,pd),t=yv(n),r=new Dd(n);return oy(e.Rf),nv(t,e.Rf).then(function(t){return new Id(n,r,e,t)})})(this._).then(function(t){return new qv(e.firestore,new Id(e.firestore._,e.hf,e._,t.mf))})},Kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=Sv(t,function(t){return new qv(e.firestore,new Id(e.firestore._,e.hf,e._,t.mf))});return Pd(this._,r,i)},Kv.prototype.withConverter=function(t){return new Kv(this.firestore,this._.withConverter(t))},Kv),jv=(h(Gv,kv=Ur),Object.defineProperty(Gv.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"doc",{get:function(){return new Mv(this.uf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Gv),qv=(h(zv,Ov=Ur),Object.defineProperty(zv.prototype,"query",{get:function(){return new Uv(this.uf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Mv(e.uf,t)})},enumerable:!1,configurable:!0}),zv.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new jv(e.uf,t)})},zv.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Mv(r.uf,t))})},zv.prototype.isEqual=function(t){return Nd(this._,t._)},zv),Fv=(h(Bv,Dv=Uv),Object.defineProperty(Bv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"parent",{get:function(){var t=this._.parent;return t?new Iv(this.firestore,t):null},enumerable:!1,configurable:!0}),Bv.prototype.doc=function(t){try{return new Iv(this.firestore,void 0===t?hy(this._):hy(this._,t))}catch(t){throw Nv(t,"doc()","CollectionReference.doc()")}},Bv.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=Dp(r.firestore,pd),e=hy(r),i=Zv(r.ff,i),Rd(t,xy(vy(r.firestore),"addDoc",e.lf,i,null!==r.ff,{}).Pf(e.lf,Rs.exists(!1))).then(function(){return e}).then(function(t){return new Iv(n.firestore,t)})},Bv.prototype.isEqual=function(t){return dy(this._,t._)},Bv.prototype.withConverter=function(t){return new Bv(this.firestore,this._.withConverter(t))},Bv);function Bv(t,e){var n=this;return(n=Dv.call(this,t,e)||this).firestore=t,n._=e,n}function zv(t,e){var n=this;return(n=Ov.call(this,e)||this).uf=t,n}function Gv(t,e){var n=this;return(n=kv.call(this,e)||this).uf=t,n}function Kv(t,e){var n=this;return(n=Pv.call(this,e)||this).firestore=t,n.hf=new Zp(t),n}function Hv(){return null!==Rv&&Rv.apply(this,arguments)||this}function Wv(t,e){var n=this;return(n=Lv.call(this,e)||this).uf=t,n}function Yv(t,e){this.hasPendingWrites=t,this.fromCache=e}function Xv(t){return t instanceof Ur&&(t=t._),Dp(t,Cd)}function Zv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Qv,Jv,ge=(h(ng,Jv=Ur),ng.documentId=function(){return new ng(ui.ot().et())},ng.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof ld&&this._.df.isEqual(t.df)},ng),o=(h(eg,Qv=Ur),eg.serverTimestamp=function(){var t=new Bp("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new eg(t)},eg.delete=function(){var t=new Rp("deleteField");return t._methodName="FieldValue.delete",new eg(t)},eg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zp("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new eg(n)},eg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Gp("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new eg(n)},eg.increment=function(t){return(t=new Kp("increment",t))._methodName="FieldValue.increment",new eg(t)},eg.prototype.isEqual=function(t){return this._.isEqual(t._)},eg),$v=(tg.prototype.onProgress=function(t,e,n){this.Ed={next:t,error:e,complete:n}},tg.prototype.catch=function(t){return this.Td.promise.catch(t)},tg.prototype.then=function(t,e){return this.Td.promise.then(t,e)},tg.prototype.Rl=function(t){this.Pl(t),this.Ed.complete&&this.Ed.complete(),this.Td.resolve(t)},tg.prototype.yl=function(t){this.md.taskState="Error",this.Ed.next&&this.Ed.next(this.md),this.Ed.error&&this.Ed.error(t),this.Td.reject(t)},tg.prototype.Pl=function(t){this.md=t,this.Ed.next&&this.Ed.next(t)},tg);function tg(){this.Ed={},this.Td=new Aa,this.md={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function eg(){return null!==Qv&&Qv.apply(this,arguments)||this}function ng(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jv.call(this,new(ld.bind.apply(ld,f([void 0],t))))||this}rg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},rg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},rg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},me=rg;function rg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:hv,GeoPoint:Hp,Timestamp:ri,Blob:zr,Transaction:bv,WriteBatch:Ev,DocumentReference:Iv,DocumentSnapshot:Vv,Query:Uv,QueryDocumentSnapshot:Mv,QuerySnapshot:qv,CollectionReference:Fv,FieldPath:ge,FieldValue:o,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new me("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new hv(e,new pd(e,t),new cv)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.0.4-BundlePrerelease.f8bb4d8b7"),hv.prototype.loadBundle=function(t){return s=t,t=new $v,function(n,t,r){var e,i=this,o=(e=s,t=Vh(t),e="string"==typeof e?(new TextEncoder).encode(e):e,new Uh(Ch(e),t));n.Ei.yi(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Cl,[4,$y(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(yv(this._),this.q_,t),t;var s},hv.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.tc.wo(t,e)})},[4,Qy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(yv((e=this)._),t).then(function(t){return t?new Uv(e,new Vd(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});