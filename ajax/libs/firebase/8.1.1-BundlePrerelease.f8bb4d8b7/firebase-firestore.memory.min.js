!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Rd){"use strict";try{(function(){var u,t,e=(t=Rd)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=I||self;function O(){}function R(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),S=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:P).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function x(){return Date.now()}function U(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++S))},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var W=N.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(W=W&&W.userAgent)?W:"";var Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Q.length;i++)e=Q[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=O;var J,tt=H(ut,"Opera"),et=H(ut,"Trident")||H(ut,"MSIE"),nt=H(ut,"Edge"),rt=nt||et,it=H(ut,"Gecko")&&!(H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge"))&&!(H(ut,"Trident")||H(ut,"MSIE"))&&!H(ut,"Edge"),ot=H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge");function st(){var t=N.document;return t?t.documentMode:void 0}var W="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(W=ut?ut[1]:""),J=et&&null!=(ut=st())&&ut>parseFloat(W)?String(ut):W;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String(J)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=N.document&&et&&(st()||parseInt(J,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",O,e),N.removeEventListener("test",O,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},U(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function _t(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Tt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Tt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),It={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[gt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[gt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=kt(t);if(c||(t[At]=c=new Et(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=St,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?_t(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=kt(e))?(_t(n,t),0==n.b&&(n.src=null,e[At]=null)):bt(t)))}function Lt(t){return t in It?It[t]:It[t]="on"+t}function Dt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function St(t,e){if(t.Y)return!0;if(ft)return Dt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Dt(t,e=new yt(e,this))}function kt(t){return(t=t[At])instanceof Et?t:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==typeof e?e:(e[Pt]||(e[Pt]=function(t){return e.handleEvent(t)}),e[Pt])}function Vt(){M.call(this),this.c=new Et(this),(this.J=this).C=null}function xt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,$(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ut(o,r,!0,e)&&s;if(s=Ut(o=e.a=t,r,!0,e)&&s,s=Ut(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ut(o=e.a=n[i],r,!1,e)&&s}function Ut(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&_t(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(Vt,M),Vt.prototype[gt]=!0,(ut=Vt.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Ct(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Tt(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&kt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Tt(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},ut.G=function(){if(Vt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Mt=N.JSON.stringify;function jt(){this.b=this.a=null}var qt,Ft=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Gt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Gt(){this.next=this.b=this.a=null}function zt(t,e){var n;qt||(n=N.Promise.resolve(void 0),qt=function(){n.then(Wt)}),Ht||(qt(),Ht=!0),Kt.add(t,e)}jt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Gt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new jt;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Yt(t,e){Vt.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Za,this),this.g=x()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Qt(t,e,n){if("function"==typeof t)n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}U(Yt,Vt),(ut=Yt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),xt(this,"tick"),this.aa&&(Xt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},ut.G=function(){Yt.X.G.call(this),Xt(this),delete this.a};var $t,Zt,Jt=(T(Zt=ee,W=$t=M),Zt.prototype=null===W?Object.create(W):(te.prototype=W.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Qt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){$t.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=Zt}function ee(t,e){var n=$t.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){M.call(this),this.b=t,this.a={}}U(ne,M);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Mt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Vt}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();xt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();xt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ae.Fa="serverreachability",U(fe,dt),ae.STAT_EVENT="statevent",U(pe,dt),ae.Ga="timingevent",U(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var _e,I={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Te(){dt.call(this,"d")}function Ae(){dt.call(this,"c")}function Ie(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Oe,t=rt?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}U(Te,dt),U(Ae,dt),U(Ie,we),_e=new Ie;var Oe=45e3,Re={},Le={};function De(t,e,n){t.H=1,t.i=$e(He(e)),t.j=n,t.I=!0,Se(t,null)}function Se(t,e){t.u=x(),Pe(t),t.l=He(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Jt(C(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function ke(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Ue(t),xe(t))}function Pe(t){t.T=x()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Va,t),e)}function Ve(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||Jn(t.g,t)}function Ue(t){Ve(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Zn(u),Fn(u)}Xn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Zn(u),!G(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Qe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ve(o),Pe(o)),n.a=i):Yn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):qn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Ve(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Ue(this),xe(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(ke(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Me(this,n)),4==e&&Ue(this),this.b&&!this.A&&(4==e?Jn(this.g,this):(this.b=!1,Pe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Ue(this),xe(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(Ve(this),ke(this,t,e),this.b&&4!=t&&Pe(this)))},ut.cancel=function(){this.A=!0,Ue(this)},ut.Va=function(){this.o=null;var t,e,n=x();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Ue(this),this.h=2,xe(this)):Ce(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,We(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Xe(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=Ze(n[2]||""),We(this,n[3]||"",!0),Ye(this,n[4]),this.g=Ze(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new ze(t)}function Ke(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function We(t,e,n){t.c=n?Ze(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Je(e,on)),t.b=new un(e,t.a))}function Qe(t,e,n){t.b.set(e,n)}function $e(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Je(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Je(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Je(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Je(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Je(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=F(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function Tn(){this.a=new _n}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var In=N.JSON.parse;function Nn(t){Vt.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}U(Nn,Vt);var On="",Rn=/^https?$/i,Ln=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,kn(t),Cn(t)}function kn(t){t.u||(t.u=!0,xt(t,"complete"),xt(t,"error"))}function Pn(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.W()))if(t.l&&4==xn(t))Qt(t.za,0,t);else if(xt(t,"readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n),e)xt(t,"complete"),xt(t,"success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",kn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Vn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||xt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Vn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function Un(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Qe(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Mn("baseRetryDelayMs",5e3,t),this.Ra=Mn("retryDelaySeedMs",1e4,t),this.Ma=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new Tn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Qe(n=He(t.B),"SID",t.J),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Kn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=$e(He(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=x(),Pe(e)),nr(t)}function Fn(t){t.a&&(Qn(t),t.a.cancel(),t.a=null)}function Bn(t){Fn(t),t.j&&(N.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Qe(r,"SID",t.J),Qe(r,"RID",n),Qe(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Un(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),De(n,r,e)}function Kn(t,n){t.f&&je({},function(t,e){Qe(n,e,t)})}function Wn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;L(t)&&(n=Mt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Qn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function $n(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Qe(e,"RID","rpc"),Qe(e,"SID",t.J),Qe(e,"CI",t.H?"0":"1"),Qe(e,"AID",t.P),Kn(t,e),Qe(e,"TYPE","xmlhttp"),t.i&&t.l&&Un(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=$e(He(e)),n.j=null,n.I=!0,Se(n,t)}function Zn(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function Jn(t,e){var n,r,i,o=null;if(t.a==e){Zn(t),Qn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=x()-e.u,n=t.u,xt(s=he(),new ye(s)),zn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Xn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Ya,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||Ke(r,"https"),$e(r)),n=r.toString(),r=o,o=new se,N.Image?((i=new Image).onload=V(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(An,o,i,"TestLoadImage: error",!1,r),i.onabort=V(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(An,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?He(s):new ze(s,void 0);return""!=a.c?(e&&We(a,e+"."+a.c),Ye(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&Ke(u,r),i&&We(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Qe(a,e,t)}),e=t.A,n=t.na,e&&n&&Qe(a,e,n),Qe(a,"VER",t.ha),Kn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Vt.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Ae.call(this),this.status=1}function hr(t){this.a=t}(ut=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(_e),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Dn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=j(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Vn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,xt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,xt(this,"complete"),xt(this,"abort"),Cn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Nn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Pn(this):this.Ua())},ut.Ua=function(){Pn(this)},ut.W=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),In(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),Qe(i=He(this.B),"RID",t),Qe(i,"CVER",22),this.A&&Qe(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Un(i,this.i,r),wn(this.b,n),this.Ia&&Qe(i,"TYPE","init"),this.da?(Qe(i,"$req",e),Qe(i,"SID","null"),n.U=!0,De(n,i,null)):De(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},ut.Aa=function(){var t;this.j=null,$n(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),$n(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Xn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},U(ur,Vt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=Mt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},U(ar,Te),U(cr,Ae),U(hr,or),hr.prototype.ta=function(){xt(this.a,"a")},hr.prototype.sa=function(t){xt(this.a,new ar(t))},hr.prototype.ra=function(t){xt(this.a,new cr)},hr.prototype.qa=function(){xt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=I).OPEN="a",I.CLOSE="b",I.ERROR="c",I.MESSAGE="d",Vt.prototype.listen=Vt.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Qa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Pa,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var fr,lr=he,pr=ge,dr=me,yr=ae,vr=Ee,gr=Nn,mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},wr=(f(_r,fr=Error),_r),br="8.1.1-BundlePrerelease.f8bb4d8b7",Er=new o("@firebase/firestore");function _r(t,e){var n=this;return(n=fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Tr(){return Er.logLevel}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.DEBUG&&(e=n.map(Or),Er.debug.apply(Er,l(["Firestore ("+br+"): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.ERROR&&(e=n.map(Or),Er.error.apply(Er,l(["Firestore ("+br+"): "+t],e)))}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Er.logLevel<=u.WARN&&(e=n.map(Or),Er.warn.apply(Er,l(["Firestore ("+br+"): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){throw void 0===t&&(t="Unexpected state"),Ir(t="FIRESTORE ("+br+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Lr(t){t||Rr()}var Dr=(Sr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Sr);function Sr(){}function kr(t,e){return t<e?-1:e<t?1:0}function Pr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Cr=(Vr.fromBase64String=function(t){return new Vr(atob(t))},Vr.fromUint8Array=function(t){return new Vr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Vr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Vr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Vr.prototype.o=function(){return 2*this.i.length},Vr.prototype.u=function(t){return kr(this.i,t.i)},Vr.prototype.isEqual=function(t){return this.i===t.i},Vr);function Vr(t){this.i=t}Cr.h=new Cr("");var xr=(Mr.fromBase64String=function(t){try{return new Mr(Cr.fromBase64String(t))}catch(t){throw new wr(mr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Mr.fromUint8Array=function(t){return new Mr(Cr.fromUint8Array(t))},Mr.prototype.toBase64=function(){return this.l.toBase64()},Mr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Mr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Mr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Mr),Ur=function(t){this._=t};function Mr(t){this.l=t}function jr(){if("undefined"==typeof Uint8Array)throw new wr(mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qr(){if("undefined"==typeof atob)throw new wr(mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Fr,Br=(f(Yr,Fr=Ur),Yr.fromBase64String=function(t){return qr(),new Yr(xr.fromBase64String(t))},Yr.fromUint8Array=function(t){return jr(),new Yr(xr.fromUint8Array(t))},Yr.prototype.toBase64=function(){return qr(),this._.toBase64()},Yr.prototype.toUint8Array=function(){return jr(),this._.toUint8Array()},Yr.prototype.isEqual=function(t){return this._.isEqual(t._)},Yr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yr),Gr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},zr=(Object.defineProperty(Wr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return t instanceof Wr&&t.projectId===this.projectId&&t.database===this.database},Wr),Hr=(Kr.prototype.A=function(){return null!=this.uid},Kr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Kr.prototype.isEqual=function(t){return t.uid===this.uid},Kr);function Kr(t){this.uid=t}function Wr(t,e){this.projectId=t,this.database=e||"(default)"}function Yr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Xr(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}Hr.UNAUTHENTICATED=new Hr(null),Hr.P=new Hr("google-credentials-uid"),Hr.g=new Hr("first-party-uid");var Qr,$r,Zr=(gi.prototype.getToken=function(){return Promise.resolve(null)},gi.prototype.v=function(){},gi.prototype.S=function(t){(this.p=t)(Hr.UNAUTHENTICATED)},gi.prototype.D=function(){this.p=null},gi),Jr=(vi.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Xr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},vi.prototype.v=function(){this.forceRefresh=!0},vi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},vi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},vi.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Hr(t)},vi),ti=(Object.defineProperty(yi.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),yi),ei=(di.prototype.getToken=function(){return Promise.resolve(new ti(this.k,this.M))},di.prototype.S=function(t){t(Hr.g)},di.prototype.D=function(){},di.prototype.v=function(){},di),ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.$=function(t){return this.seconds===t.seconds?kr(this.nanoseconds,t.nanoseconds):kr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(li.L=function(t){return new li(t)},li.min=function(){return new li(new ni(0,0))},li.prototype.u=function(t){return this.timestamp.$(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.q=function(){return this.timestamp},li),ge=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.U},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.K(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.j=function(t){return t=void 0===t?1:t,this.W(this.segments,this.offset+t,this.length-t)},fi.prototype.G=function(){return this.W(this.segments,this.offset,this.length-1)},fi.prototype.H=function(){return this.segments[this.offset]},fi.prototype.J=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.Y=function(){return 0===this.length},fi.prototype.X=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},fi.K=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(f(hi,$r=ge),hi.prototype.W=function(t,e,n){return new hi(t,e,n)},hi.prototype.et=function(){return this.tt().join("/")},hi.prototype.toString=function(){return this.et()},hi.nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new wr(mr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.st=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(f(ci,Qr=ge),ci.prototype.W=function(t,e,n){return new ci(t,e,n)},ci.it=function(t){return oi.test(t)},ci.prototype.et=function(){return this.tt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ci.it(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.et()},ci.prototype.rt=function(){return 1===this.length&&"__name__"===this.get(0)},ci.ot=function(){return new ci(["__name__"])},ci.ct=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new wr(mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new wr(mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new wr(mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.st=function(){return new ci([])},ci),ui=(ai.at=function(t){return new ai(ii.nt(t))},ai.ut=function(t){return new ai(ii.nt(t).j(5))},ai.prototype.ht=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.K(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.K=function(t,e){return ii.K(t.path,e.path)},ai.lt=function(t){return t.length%2==0},ai._t=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==Qr&&Qr.apply(this,arguments)||this}function hi(){return null!==$r&&$r.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.U=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new wr(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new wr(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new wr(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new wr(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t,e){this.k=t,this.M=e}function yi(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Hr.g}function vi(t){var e=this;this.C=null,this.currentUser=Hr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function gi(){this.p=null}function mi(t){return null==t}function wi(t){return 0===t&&1/t==-1/0}var bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ft=null};function Ei(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new bi(t,e,n,r,i,o,s)}function _i(t){var e=t;return null===e.ft&&(t=e.path.et(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.et()+t.op.toString()+Io(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.et()+t.dir}).join(","),mi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Xu(e.startAt)),e.endAt&&(t+="|ub:",t+=Xu(e.endAt)),e.ft=t),e.ft}function Ti(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Eo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$u(t.startAt,e.startAt)&&$u(t.endAt,e.endAt)}function Ai(t){return ui.lt(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ii(t){this.count=t}var Ni,Oi=(Ri.prototype.Et=function(t){return new Ri(this.target,this.targetId,this.dt,t,this.wt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ri.prototype.Tt=function(t,e){return new Ri(this.target,this.targetId,this.dt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ri.prototype.It=function(t){return new Ri(this.target,this.targetId,this.dt,this.sequenceNumber,this.wt,t,this.resumeToken)},Ri);function Ri(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=Cr.h),this.target=t,this.targetId=e,this.dt=n,this.sequenceNumber=r,this.wt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Li(t){switch(t){case mr.OK:return Rr(),0;case mr.CANCELLED:case mr.UNKNOWN:case mr.DEADLINE_EXCEEDED:case mr.RESOURCE_EXHAUSTED:case mr.INTERNAL:case mr.UNAVAILABLE:case mr.UNAUTHENTICATED:return;case mr.INVALID_ARGUMENT:case mr.NOT_FOUND:case mr.ALREADY_EXISTS:case mr.PERMISSION_DENIED:case mr.FAILED_PRECONDITION:case mr.ABORTED:case mr.OUT_OF_RANGE:case mr.UNIMPLEMENTED:case mr.DATA_LOSS:return 1;default:return Rr(),0}}function Di(t){if(void 0===t)return Ir("GRPC error has no .code"),mr.UNKNOWN;switch(t){case Ni.OK:return mr.OK;case Ni.CANCELLED:return mr.CANCELLED;case Ni.UNKNOWN:return mr.UNKNOWN;case Ni.DEADLINE_EXCEEDED:return mr.DEADLINE_EXCEEDED;case Ni.RESOURCE_EXHAUSTED:return mr.RESOURCE_EXHAUSTED;case Ni.INTERNAL:return mr.INTERNAL;case Ni.UNAVAILABLE:return mr.UNAVAILABLE;case Ni.UNAUTHENTICATED:return mr.UNAUTHENTICATED;case Ni.INVALID_ARGUMENT:return mr.INVALID_ARGUMENT;case Ni.NOT_FOUND:return mr.NOT_FOUND;case Ni.ALREADY_EXISTS:return mr.ALREADY_EXISTS;case Ni.PERMISSION_DENIED:return mr.PERMISSION_DENIED;case Ni.FAILED_PRECONDITION:return mr.FAILED_PRECONDITION;case Ni.ABORTED:return mr.ABORTED;case Ni.OUT_OF_RANGE:return mr.OUT_OF_RANGE;case Ni.UNIMPLEMENTED:return mr.UNIMPLEMENTED;case Ni.DATA_LOSS:return mr.DATA_LOSS;default:return Rr()}}(me=Ni={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Si=(xi.prototype.At=function(t,e){return new xi(this.K,this.root.At(t,e,this.K).copy(null,null,Pi.Rt,null,null))},xi.prototype.remove=function(t){return new xi(this.K,this.root.remove(t,this.K).copy(null,null,Pi.Rt,null,null))},xi.prototype.get=function(t){for(var e=this.root;!e.Y();){var n=this.K(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},xi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.Y();){var r=this.K(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},xi.prototype.Y=function(){return this.root.Y()},Object.defineProperty(xi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),xi.prototype.Pt=function(){return this.root.Pt()},xi.prototype.yt=function(){return this.root.yt()},xi.prototype.gt=function(t){return this.root.gt(t)},xi.prototype.forEach=function(n){this.gt(function(t,e){return n(t,e),!1})},xi.prototype.toString=function(){var n=[];return this.gt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},xi.prototype.Vt=function(t){return this.root.Vt(t)},xi.prototype.bt=function(){return new ki(this.root,null,this.K,!1)},xi.prototype.vt=function(t){return new ki(this.root,t,this.K,!1)},xi.prototype.St=function(){return new ki(this.root,null,this.K,!0)},xi.prototype.Dt=function(t){return new ki(this.root,t,this.K,!0)},xi),ki=(Vi.prototype.Nt=function(){var t=this.xt.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.Y();)this.xt.push(t),t=t.right;else for(t=t.right;!t.Y();)this.xt.push(t),t=t.left;return e},Vi.prototype.Ft=function(){return 0<this.xt.length},Vi.prototype.Ot=function(){if(0===this.xt.length)return null;var t=this.xt[this.xt.length-1];return{key:t.key,value:t.value}},Vi),Pi=(Ci.prototype.copy=function(t,e,n,r,i){return new Ci(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ci.prototype.Y=function(){return!1},Ci.prototype.gt=function(t){return this.left.gt(t)||t(this.key,this.value)||this.right.gt(t)},Ci.prototype.Vt=function(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)},Ci.prototype.min=function(){return this.left.Y()?this:this.left.min()},Ci.prototype.Pt=function(){return this.min().key},Ci.prototype.yt=function(){return this.right.Y()?this.key:this.right.yt()},Ci.prototype.At=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.At(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.At(t,e,n))).kt()},Ci.prototype.Mt=function(){if(this.left.Y())return Ci.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Mt(),null)).kt()},Ci.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.Y()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.Bt()),r.right.Y()||r.right.$t()||r.right.left.$t()||(r=r.qt()),0===e(t,r.key)){if(r.right.Y())return Ci.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Mt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.kt()},Ci.prototype.$t=function(){return this.color},Ci.prototype.kt=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.Bt()),t.left.$t()&&t.right.$t()&&(t=t.Qt()),t},Ci.prototype.Lt=function(){var t=this.Qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Bt())).Ut()).Qt()),t},Ci.prototype.qt=function(){var t=this.Qt();return t.left.left.$t()&&(t=(t=t.Bt()).Qt()),t},Ci.prototype.Ut=function(){var t=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ci.prototype.Bt=function(){var t=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ci.prototype.Qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ci.prototype.Kt=function(){var t=this.Wt();return Math.pow(2,t)<=this.size+1},Ci.prototype.Wt=function(){if(this.$t()&&this.left.$t())throw Rr();if(this.right.$t())throw Rr();var t=this.left.Wt();if(t!==this.right.Wt())throw Rr();return t+(this.$t()?0:1)},Ci);function Ci(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ci.RED,this.left=null!=r?r:Ci.EMPTY,this.right=null!=i?i:Ci.EMPTY,this.size=this.left.size+1+this.right.size}function Vi(t,e,n,r){this.Ct=r,this.xt=[];for(var i=1;!t.Y();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.xt.push(t);break}this.xt.push(t),t=this.Ct?t.right:t.left}}function xi(t,e){this.K=t,this.root=e||Pi.EMPTY}function Ui(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.Rt=!1,Pi.EMPTY=(Object.defineProperty(Ui.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Ui.prototype.copy=function(t,e,n,r,i){return this},Ui.prototype.At=function(t,e,n){return new Pi(t,e)},Ui.prototype.remove=function(t,e){return this},Ui.prototype.Y=function(){return!0},Ui.prototype.gt=function(t){return!1},Ui.prototype.Vt=function(t){return!1},Ui.prototype.Pt=function(){return null},Ui.prototype.yt=function(){return null},Ui.prototype.$t=function(){return!1},Ui.prototype.Kt=function(){return!0},Ui.prototype.Wt=function(){return 0},new Ui);var Mi=(Bi.prototype.has=function(t){return null!==this.data.get(t)},Bi.prototype.first=function(){return this.data.Pt()},Bi.prototype.last=function(){return this.data.yt()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Bi.prototype.indexOf=function(t){return this.data.indexOf(t)},Bi.prototype.forEach=function(n){this.data.gt(function(t,e){return n(t),!1})},Bi.prototype.jt=function(t,e){for(var n=this.data.vt(t[0]);n.Ft();){var r=n.Nt();if(0<=this.K(r.key,t[1]))return;e(r.key)}},Bi.prototype.Gt=function(t,e){for(var n=void 0!==e?this.data.vt(e):this.data.bt();n.Ft();)if(!t(n.Nt().key))return},Bi.prototype.zt=function(t){return(t=this.data.vt(t)).Ft()?t.Nt().key:null},Bi.prototype.bt=function(){return new ji(this.data.bt())},Bi.prototype.vt=function(t){return new ji(this.data.vt(t))},Bi.prototype.add=function(t){return this.copy(this.data.remove(t).At(t,!0))},Bi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Bi.prototype.Y=function(){return this.data.Y()},Bi.prototype.Ht=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Bi.prototype.isEqual=function(t){if(!(t instanceof Bi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(0!==this.K(r,i))return!1}return!0},Bi.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Bi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Bi.prototype.copy=function(t){var e=new Bi(this.K);return e.data=t,e},Bi),ji=(Fi.prototype.Nt=function(){return this.Jt.Nt().key},Fi.prototype.Ft=function(){return this.Jt.Ft()},Fi),qi=new Si(ui.K);function Fi(t){this.Jt=t}function Bi(t){this.K=t,this.data=new Si(this.K)}var Gi=new Si(ui.K),zi=new Si(ui.K),Hi=new Mi(ui.K);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Mi(kr),Yi=(ho.Zt=function(t){return new ho(t.K)},ho.prototype.has=function(t){return null!=this.Yt.get(t)},ho.prototype.get=function(t){return this.Yt.get(t)},ho.prototype.first=function(){return this.Xt.Pt()},ho.prototype.last=function(){return this.Xt.yt()},ho.prototype.Y=function(){return this.Xt.Y()},ho.prototype.indexOf=function(t){return(t=this.Yt.get(t))?this.Xt.indexOf(t):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.Xt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.Xt.gt(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Yt.At(t.key,t),e.Xt.At(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Yt.remove(t),this.Xt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.Xt.bt(),n=t.Xt.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(!r.isEqual(i))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.K=this.K,n.Yt=t,n.Xt=e,n},ho),Xi=(co.prototype.track=function(t){var e=t.doc.key,n=this.te.get(e);!n||0!==t.type&&3===n.type?this.te=this.te.At(e,t):3===t.type&&1!==n.type?this.te=this.te.At(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.te=this.te.At(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.te=this.te.remove(e):1===t.type&&2===n.type?this.te=this.te.At(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):Rr()},co.prototype.ee=function(){var n=[];return this.te.gt(function(t,e){n.push(e)}),n},co),Qi=(ao.oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Yi.Zt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.se.Y()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ie===t.ie&&this.se.isEqual(t.se)&&mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.ne.isEqual(t.ne)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),$i=(uo.le=function(t,e){var n=new Map;return n.set(t,Zi._e(t,e)),new uo(ri.min(),n,Wi,qi,Ki())},uo),Zi=(so._e=function(t,e){return new so(Cr.h,e,Ki(),Ki(),Ki())},so),Ji=function(t,e,n,r){this.Te=t,this.removedTargetIds=e,this.key=n,this.me=r},to=function(t,e){this.targetId=t,this.Ie=e},eo=function(t,e,n,r){void 0===n&&(n=Cr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},no=(Object.defineProperty(oo.prototype,"fe",{get:function(){return this.ye},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"Ve",{get:function(){return 0!==this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"pe",{get:function(){return this.ge},enumerable:!1,configurable:!0}),oo.prototype.be=function(t){0<t.o()&&(this.ge=!0,this.Pe=t)},oo.prototype.ve=function(){var n=Ki(),r=Ki(),i=Ki();return this.Re.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Zi(this.Pe,this.ye,n,r,i)},oo.prototype.Se=function(){this.ge=!1,this.Re=lo()},oo.prototype.De=function(t,e){this.ge=!0,this.Re=this.Re.At(t,e)},oo.prototype.Ce=function(t){this.ge=!0,this.Re=this.Re.remove(t)},oo.prototype.xe=function(){this.Ae+=1},oo.prototype.Ne=function(){--this.Ae},oo.prototype.Fe=function(){this.ge=!0,this.ye=!0},oo),ro=(io.prototype.Be=function(t){for(var e=0,n=t.Te;e<n.length;e++){var r=n[e];t.me instanceof nu?this.qe(r,t.me):t.me instanceof ru&&this.Ue(r,t.key,t.me)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.me)},io.prototype.Qe=function(n){var r=this;this.Ke(n,function(t){var e=r.We(t);switch(n.state){case 0:r.je(t)&&e.be(n.resumeToken);break;case 1:e.Ne(),e.Ve||e.Se(),e.be(n.resumeToken);break;case 2:e.Ne(),e.Ve||r.removeTarget(t);break;case 3:r.je(t)&&(e.Fe(),e.be(n.resumeToken));break;case 4:r.je(t)&&(r.Ge(t),e.be(n.resumeToken));break;default:Rr()}})},io.prototype.Ke=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ke.forEach(function(t,e){r.je(e)&&n(e)})},io.prototype.ze=function(t){var e=t.targetId,n=t.Ie.count;(t=this.He(e))&&(Ai(t=t.target)?0===n?(t=new ui(t.path),this.Ue(e,t,new ru(t,ri.min()))):Lr(1===n):this.Je(e)!==n&&(this.Ge(e),this.Le=this.Le.add(e)))},io.prototype.Ye=function(r){var i=this,o=new Map;this.ke.forEach(function(t,e){var n=i.He(e);n&&(t.fe&&Ai(n.target)&&(n=new ui(n.target.path),null!==i.Me.get(n)||i.Xe(e,n)||i.Ue(e,n,new ru(n,r))),t.pe&&(o.set(e,t.ve()),t.Se()))});var s=Ki();this.$e.forEach(function(t,e){var n=!0;e.Gt(function(t){return!(t=i.He(t))||2===t.dt||(n=!1)}),n&&(s=s.add(t))});var t=new $i(r,o,this.Le,this.Me,s);return this.Me=qi,this.$e=fo(),this.Le=new Mi(kr),t},io.prototype.qe=function(t,e){var n;this.je(t)&&(n=this.Xe(t,e.key)?2:0,this.We(t).De(e.key,n),this.Me=this.Me.At(e.key,e),this.$e=this.$e.At(e.key,this.Ze(e.key).add(t)))},io.prototype.Ue=function(t,e,n){var r;this.je(t)&&(r=this.We(t),this.Xe(t,e)?r.De(e,1):r.Ce(e),this.$e=this.$e.At(e,this.Ze(e).delete(t)),n&&(this.Me=this.Me.At(e,n)))},io.prototype.removeTarget=function(t){this.ke.delete(t)},io.prototype.Je=function(t){var e=this.We(t).ve();return this.Oe.tn(t).size+e.de.size-e.Ee.size},io.prototype.xe=function(t){this.We(t).xe()},io.prototype.We=function(t){var e=this.ke.get(t);return e||(e=new no,this.ke.set(t,e)),e},io.prototype.Ze=function(t){var e=this.$e.get(t);return e||(e=new Mi(kr),this.$e=this.$e.At(t,e)),e},io.prototype.je=function(t){var e=null!==this.He(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.He=function(t){var e=this.ke.get(t);return e&&e.Ve?null:this.Oe.en(t)},io.prototype.Ge=function(e){var n=this;this.ke.set(e,new no),this.Oe.tn(e).forEach(function(t){n.Ue(e,t,null)})},io.prototype.Xe=function(t,e){return this.Oe.tn(t).has(e)},io);function io(t){this.Oe=t,this.ke=new Map,this.Me=qi,this.$e=fo(),this.Le=new Mi(kr)}function oo(){this.Ae=0,this.Re=lo(),this.Pe=Cr.h,this.ye=!1,this.ge=!0}function so(t,e,n,r,i){this.resumeToken=t,this.fe=e,this.de=n,this.we=r,this.Ee=i}function uo(t,e,n,r,i){this.wt=t,this.ce=e,this.ae=n,this.ue=r,this.he=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ne=n,this.docChanges=r,this.se=i,this.fromCache=o,this.ie=s,this.re=u}function co(){this.te=new Si(ui.K)}function ho(n){this.K=n?function(t,e){return n(t,e)||ui.K(t.key,e.key)}:function(t,e){return ui.K(t.key,e.key)},this.Yt=Gi,this.Xt=new Si(this.K)}function fo(){return new Si(ui.K)}function lo(){return new Si(ui.K)}function po(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function yo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function vo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function go(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function mo(t){return t=No(t.mapValue.fields.__local_write_time__.timestampValue),new ni(t.seconds,t.nanos)}var wo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?go(t)?4:10:Rr()}function Eo(r,i){var t,e=bo(r);if(e!==bo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return mo(r).isEqual(mo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=No(r.timestampValue),t=No(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Ro(r.bytesValue).isEqual(Ro(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Oo((t=r).geoPointValue.latitude)===Oo(e.geoPointValue.latitude)&&Oo(t.geoPointValue.longitude)===Oo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Oo(e.integerValue)===Oo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Oo(e.doubleValue))===(t=Oo(t.doubleValue))?wi(e)===wi(t):isNaN(e)&&isNaN(t));case 9:return Pr(r.arrayValue.values||[],i.arrayValue.values||[],Eo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(po(e)!==po(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Eo(e[t],n[t])))return!1;return!0}();default:return Rr()}}function _o(t,e){return void 0!==(t.values||[]).find(function(t){return Eo(t,e)})}function To(t,e){var n,r,i,o=bo(t),s=bo(e);if(o!==s)return kr(o,s);switch(o){case 0:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Oo(t.integerValue||t.doubleValue))<(n=Oo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ao(t.timestampValue,e.timestampValue);case 4:return Ao(mo(t),mo(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Ro(i),s=Ro(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=kr(n[i],r[i]);if(0!==o)return o}return kr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=kr(Oo(o.latitude),Oo(r.latitude)))?n:kr(Oo(o.longitude),Oo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=To(n[i],r[i]);if(o)return o}return kr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=kr(r[s],o[s]);if(0!==u)return u;if(0!==(u=To(n[r[s]],i[o[s]])))return u}return kr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function Ao(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return kr(t,e);var n=No(t),t=No(e);return 0!==(e=kr(n.seconds,t.seconds))?e:kr(n.nanos,t.nanos)}function Io(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=No(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ro(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ui.ut(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e}(t)}function No(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Oo(t.seconds),nanos:Oo(t.nanos)};var e=0,n=wo.exec(t);return Lr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Oo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ro(t){return"string"==typeof t?Cr.fromBase64String(t):Cr.fromUint8Array(t)}function Lo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.et()}}function Do(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function Po(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Co(t){return t&&"mapValue"in t}var Vo={asc:"ASCENDING",desc:"DESCENDING"},xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uo=function(t,e){this.T=t,this.nn=e};function Mo(t){return{integerValue:""+t}}function jo(t,e){if(t.nn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wi(e)?"-0":e}}function qo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!wi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Mo(e):jo(t,e);var n}function Fo(t,e){return t.nn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bo(t,e){return t.nn?e.toBase64():e.toUint8Array()}function Go(t){return Lr(!!t),ri.L((t=No(t),new ni(t.seconds,t.nanos)))}function zo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).et()}function Ho(t){return Lr(is(t=ii.nt(t))),t}function Ko(t,e){return zo(t.T,e.path)}function Wo(t,e){if((e=Ho(e)).get(1)!==t.T.projectId)throw new wr(mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new wr(mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new ui(Qo(e))}function Yo(t,e){return zo(t.T,e)}function Xo(t){return new ii(["projects",t.T.projectId,"databases",t.T.database]).et()}function Qo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.j(5)}function $o(t,e,n){return{name:Ko(t,e),fields:n.proto.mapValue.fields}}function Zo(t,e){var n,r,i;if(e instanceof Cs)n={update:$o(t,e.key,e.value)};else if(e instanceof Hs)n={delete:Ko(t,e.key)};else if(e instanceof Vs)n={update:$o(t,e.key,e.data),updateMask:(i=e.sn,r=[],i.fields.forEach(function(t){return r.push(t.et())}),{fieldPaths:r})};else if(e instanceof qs)n={transform:{document:Ko(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.et(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.et(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.et(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.et(),increment:e.rn};throw Rr()})}};else{if(!(e instanceof Ks))return Rr();n={verify:Ko(t,e.key)}}return e.cn.on||(n.currentDocument=void 0!==(i=e.cn).updateTime?{updateTime:Fo(e=t,(t=i.updateTime).q())}:void 0!==i.exists?{exists:i.exists}:Rr()),n}function Jo(t){var e=4===(o=Ho(t.parent)).length?ii.st():Qo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return Au.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return Au.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=rs(t.unaryFilter.field),Au.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=rs(t.unaryFilter.field),Au.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Au.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Zu(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=mi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=es(n.startAt));var u=null;return n.endAt&&(u=es(n.endAt)),new ou(e,i,t,o,r,"F",s,u)}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,t=t.values||[];return new zu(t,e)}function ns(t){return{fieldPath:t.et()}}function rs(t){return si.ct(t.fieldPath)}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function os(t,e){return t instanceof ms?Do(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ss,us,as=(f(fs,us=o=function(){this.un=void 0}),fs),cs=(f(hs,ss=o),hs);function hs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Eo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ps,ds=(f(ys,ps=o),ys);function ys(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function vs(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Eo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(f(ws,gs=o),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).serializer=t,n.rn=e,n}function bs(t){return Oo(t.integerValue||t.doubleValue)}function Es(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function _s(t,e){this.field=t,this.transform=e}var Ts=(As.prototype.hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].X(t))return!0;return!1},As.prototype.isEqual=function(t){return Pr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As);function As(t){(this.fields=t).sort(si.K)}function Is(t,e){this.version=t,this.transformResults=e}var Ns=(Os.an=function(){return new Os},Os.exists=function(t){return new Os(void 0,t)},Os.updateTime=function(t){return new Os(t)},Object.defineProperty(Os.prototype,"on",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Os.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Os);function Os(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof nu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof nu}function Ls(t,e,n,r){return t instanceof Cs?(o=e,Rs((i=t).cn,o)?(o=Ss(o),new nu(i.key,o,i.value,{ln:!0})):o):t instanceof Vs?function(t,e){if(!Rs(t.cn,e))return e;var n=Ss(e),e=Ms(t,e);return new nu(t.key,n,e,{ln:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Rs(t.cn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof nu&&(h=n.field(a.field)),null===h&&r instanceof nu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof as?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof cs?ls(c,i):c instanceof ds?vs(c,i):(i=bs(c=os(h=c,i))+bs(h.rn),Do(c)&&Do(h.rn)?Mo(i):jo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Bs(t,i.data(),r);return new nu(t.key,i.version,r,{ln:!0})}(t,e,r,n):Rs(t.cn,e)?new ru(t.key,ri.min()):e;var i,o}function Ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.cn.isEqual(e.cn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.sn.isEqual(e.sn):2!==t.type||Pr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof cs&&e instanceof cs||t instanceof ds&&e instanceof ds?Pr(t.elements,e.elements,Eo):t instanceof ms&&e instanceof ms?Eo(t.rn,e.rn):t instanceof as&&e instanceof as)}))}function Ss(t){return t instanceof nu?t.version:ri.min()}var ks,Ps,Cs=(f(Us,Ps=ge=function(){}),Us),Vs=(f(xs,ks=ge),xs);function xs(t,e,n,r){var i=this;return(i=ks.call(this)||this).key=t,i.data=e,i.sn=n,i.cn=r,i.type=1,i}function Us(t,e,n){var r=this;return(r=Ps.call(this)||this).key=t,r.value=e,r.cn=n,r.type=0,r}function Ms(t,e){return n=t,e=e instanceof nu?e.data():Ws.empty(),r=new Ys(e),n.sn.fields.forEach(function(t){var e;t.Y()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r._n();var n,r}var js,qs=(f(Fs,js=ge),Fs);function Fs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.cn=Ns.exists(!0),n}function Bs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r._n()}var Gs,zs,Hs=(f(Zs,zs=ge),Zs),Ks=(f($s,Gs=ge),$s),Ws=(Qs.empty=function(){return new Qs({mapValue:{}})},Qs.prototype.field=function(t){if(t.Y())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Co(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.J()])||null},Qs.prototype.isEqual=function(t){return Eo(this.proto,t.proto)},Qs),Ys=(Xs.prototype.set=function(t,e){return this.wn(t,e),this},Xs.prototype.delete=function(t){return this.wn(t,null),this},Xs.prototype.wn=function(t,e){for(var n=this.dn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===bo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.J(),e)},Xs.prototype._n=function(){var t=this.En(si.st(),this.dn);return null!=t?new Ws(t):this.fn},Xs.prototype.En=function(r,t){var i=this,o=!1,e=this.fn.field(r),s=Co(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.En(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xs);function Xs(t){void 0===t&&(t=Ws.empty()),this.fn=t,this.dn=new Map}function Qs(t){this.proto=t}function $s(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.cn=e,n.type=4,n}function Zs(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.cn=e,n.type=3,n}var Js,tu,eu,nu=(f(au,eu=me=function(t,e){this.key=t,this.version=e}),au.prototype.field=function(t){return this.Tn.field(t)},au.prototype.data=function(){return this.Tn},au.prototype.mn=function(){return this.Tn.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ln===t.ln&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Tn.isEqual(t.Tn)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Tn.toString()+", {hasLocalMutations: "+this.ln+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.ln||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),ru=(f(uu,tu=me),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),iu=(f(su,Js=me),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su),ou=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.In=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.An=null,this.Rn=null,this.startAt,this.endAt};function su(){return null!==Js&&Js.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=tu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=eu.call(this,t,e)||this).Tn=n,i.ln=!!r.ln,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function cu(t){return new ou(t)}function hu(t){return!mi(t.limit)&&"F"===t.limitType}function fu(t){return!mi(t.limit)&&"L"===t.limitType}function lu(t){return 0<t.In.length?t.In[0].field:null}function pu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Pn())return r.field}return null}function du(t){return null!==t.collectionGroup}function yu(t){var e=t;if(null===e.An){e.An=[];var n=pu(e),t=lu(e);if(null!==n&&null===t)n.rt()||e.An.push(new Zu(n)),e.An.push(new Zu(si.ot(),"asc"));else{for(var r=!1,i=0,o=e.In;i<o.length;i++){var s=o[i];e.An.push(s),s.field.rt()&&(r=!0)}r||(n=0<e.In.length?e.In[e.In.length-1].dir:"asc",e.An.push(new Zu(si.ot(),n)))}}return e.An}function vu(t){var e=t;if(!e.Rn)if("F"===e.limitType)e.Rn=Ei(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Zu(o.field,s))}var u=e.endAt?new zu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new zu(e.startAt.position,!e.startAt.before):null;e.Rn=Ei(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Rn}function gu(t,e,n){return new ou(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return Ti(vu(t),vu(e))&&t.limitType===e.limitType}function wu(t){return _i(vu(t))+"|lt:"+t.limitType}function bu(t){return"Query(target="+(n=(e=vu(t)).path.et(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.et()+" "+t.op+" "+Io(t.value)}).join(", ")+"]"),mi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.et()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Xu(e.startAt)),e.endAt&&(n+=", endAt: "+Xu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Eu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.ht(e.collectionGroup)&&e.path.X(n):ui.lt(e.path)?e.path.isEqual(n):e.path.Z(n))&&function(t){for(var e=0,n=i.In;e<n.length;e++){var r=n[e];if(!r.field.rt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Qu(t.startAt,yu(t),n))&&(!t.endAt||!Qu(t.endAt,yu(t),n)));var e,n}function _u(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.rt()?ui.K(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?To(e,r):Rr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.rt()}return 0}}var Tu,Au=(f(Iu,Tu=function(){}),Iu.create=function(t,e,n){return t.rt()?"in"===e||"not-in"===e?this.yn(t,e,n):new Lu(t,e,n):"array-contains"===e?new qu(t,n):"in"===e?new Fu(t,n):"not-in"===e?new Bu(t,n):"array-contains-any"===e?new Gu(t,n):new Iu(t,e,n)},Iu.yn=function(t,e,n){return new("in"===e?Du:Su)(t,n)},Iu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.gn(To(t,this.value)):null!==t&&bo(this.value)===bo(t)&&this.gn(To(t,this.value))},Iu.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},Iu.prototype.Pn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Iu);function Iu(t,e,n){var r=this;return(r=Tu.call(this)||this).field=t,r.op=e,r.value=n,r}var Nu,Ou,Ru,Lu=(f(Cu,Ru=Au),Cu.prototype.matches=function(t){return t=ui.K(t.key,this.key),this.gn(t)},Cu),Du=(f(Pu,Ou=Au),Pu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Pu),Su=(f(ku,Nu=Au),ku.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ku);function ku(t,e){var n=this;return(n=Nu.call(this,t,"not-in",e)||this).keys=Vu(0,e),n}function Pu(t,e){var n=this;return(n=Ou.call(this,t,"in",e)||this).keys=Vu(0,e),n}function Cu(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=ui.ut(n.referenceValue),r}function Vu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.ut(t.referenceValue)})}var xu,Uu,Mu,ju,qu=(f(Yu,ju=Au),Yu.prototype.matches=function(t){return So(t=t.field(this.field))&&_o(t.arrayValue,this.value)},Yu),Fu=(f(Wu,Mu=Au),Wu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&_o(this.value.arrayValue,t)},Wu),Bu=(f(Ku,Uu=Au),Ku.prototype.matches=function(t){return!_o(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!_o(this.value.arrayValue,t))},Ku),Gu=(f(Hu,xu=Au),Hu.prototype.matches=function(t){var e=this;return!(!So(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return _o(e.value.arrayValue,t)})},Hu),zu=function(t,e){this.position=t,this.before=e};function Hu(t,e){return xu.call(this,t,"array-contains-any",e)||this}function Ku(t,e){return Uu.call(this,t,"not-in",e)||this}function Wu(t,e){return Mu.call(this,t,"in",e)||this}function Yu(t,e){return ju.call(this,t,"array-contains",e)||this}function Xu(t){return(t.before?"b":"a")+":"+t.position.map(Io).join(",")}function Qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.rt()?ui.K(ui.ut(s.referenceValue),n.key):To(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function $u(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Eo(t.position[n],e.position[n]))return!1;return!0}var Zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Ju=(da.prototype.pn=function(t,e,n){for(var r,i,o,s,u,a=n.bn,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof Cs?new nu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Vs?(u=i,h=o,Rs((s=r).cn,u)?(u=Ms(s,u),new nu(s.key,h.version,u,{hasCommittedMutations:!0})):new iu(s.key,h.version)):r instanceof qs?function(t,e,n){if(Lr(null!=n.transformResults),!Rs(t.cn,e))return new iu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof nu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof cs?ls(o,s):o instanceof ds?vs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Bs(t,r.data(),e);return new nu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new ru(r.key,o.version,{hasCommittedMutations:!0}))}return e},da.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ls(i,e,e,this.Vn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ls(a,e,o,this.Vn))}return e},da.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.At(t.key,e))}),i},da.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},da.prototype.isEqual=function(t){return this.batchId===t.batchId&&Pr(this.mutations,t.mutations,Ds)&&Pr(this.baseMutations,t.baseMutations,Ds)},da),ta=(pa.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.At(i[o].key,n[o].version);return new pa(t,e,n,r)},pa),ea=(la.prototype.get=function(t){var e=this.xn(t);if(void 0!==(e=this.Fn[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.Nn(i,t))return o}},la.prototype.has=function(t){return void 0!==this.get(t)},la.prototype.set=function(t,e){var n=this.xn(t),r=this.Fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Nn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Fn[n]=[[t,e]]},la.prototype.delete=function(t){var e=this.xn(t),n=this.Fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Nn(n[r][0],t))return 1===n.length?delete this.Fn[e]:n.splice(r,1),!0;return!1},la.prototype.forEach=function(s){yo(this.Fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},la.prototype.Y=function(){return vo(this.Fn)},la),na=(fa.prototype.catch=function(t){return this.next(void 0,t)},fa.prototype.next=function(r,i){var o=this;return this.$n&&Rr(),this.$n=!0,this.Mn?this.error?this.Ln(i,this.error):this.Bn(r,this.result):new fa(function(e,n){o.On=function(t){o.Bn(r,t).next(e,n)},o.kn=function(t){o.Ln(i,t).next(e,n)}})},fa.prototype.qn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},fa.prototype.Un=function(t){try{var e=t();return e instanceof fa?e:fa.resolve(e)}catch(t){return fa.reject(t)}},fa.prototype.Bn=function(t,e){return t?this.Un(function(){return t(e)}):fa.resolve(e)},fa.prototype.Ln=function(t,e){return t?this.Un(function(){return t(e)}):fa.reject(e)},fa.resolve=function(n){return new fa(function(t,e){t(n)})},fa.reject=function(n){return new fa(function(t,e){e(n)})},fa.Qn=function(t){return new fa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},fa.Kn=function(t){for(var n=fa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?fa.resolve(t):e()})}(r[e]);return n},fa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Qn(i)},fa),o=(ha.prototype.Gn=function(t){return(t=this.Wn.get(t))?t.readTime:ri.min()},ha.prototype.zn=function(t,e){this.Hn(),this.Wn.set(t.key,{Jn:t,readTime:e})},ha.prototype.Yn=function(t,e){void 0===e&&(e=null),this.Hn(),this.Wn.set(t,{Jn:null,readTime:e})},ha.prototype.Xn=function(t,e){this.Hn();var n=this.Wn.get(e);return void 0!==n?na.resolve(n.Jn):this.Zn(t,e)},ha.prototype.getEntries=function(t,e){return this.ts(t,e)},ha.prototype.apply=function(t){return this.Hn(),this.jn=!0,this.es(t)},ha.prototype.Hn=function(){},ha),ge=(ca.prototype.ss=function(t){this.ns.push(t)},ca.prototype.rs=function(){this.ns.forEach(function(t){return t()})},ca),ra=(aa.prototype.hs=function(e,n){var r=this;return this.cs.ls(e,n).next(function(t){return r._s(e,n,t)})},aa.prototype._s=function(t,r,i){return this.os.Xn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},aa.prototype.fs=function(t,e,i){var o=qi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.At(t,e)}),o},aa.prototype.ds=function(e,t){var n=this;return this.os.getEntries(e,t).next(function(t){return n.ws(e,t)})},aa.prototype.ws=function(e,r){var i=this;return this.cs.Es(e,r).next(function(t){var t=i.fs(e,r,t),n=qi;return t.forEach(function(t,e){e=e||new ru(t,ri.min()),n=n.At(t,e)}),n})},aa.prototype.Ts=function(t,e,n){return r=e,ui.lt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Is(t,e.path):du(e)?this.As(t,e,n):this.Rs(t,e,n);var r},aa.prototype.Is=function(t,e){return this.hs(t,new ui(e)).next(function(t){var e=Gi;return t instanceof nu&&(e=e.At(t.key,t)),e})},aa.prototype.As=function(n,r,i){var o=this,s=r.collectionGroup,u=Gi;return this.us.Ps(n,s).next(function(t){return na.forEach(t,function(t){var e=(e=r,t=t.child(s),new ou(t,null,e.In.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.At(t,e)})})}).next(function(){return u})})},aa.prototype.Rs=function(e,n,t){var a,c,r=this;return this.os.Ts(e,n,t).next(function(t){return a=t,r.cs.ys(e,n)}).next(function(t){return c=t,r.gs(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Ls(s,s=a.get(u),s,r.Vn);a=s instanceof nu?a.At(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Eu(n,e)||(a=a.remove(t))}),a})},aa.prototype.gs=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.os.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof nu&&(c=c.At(t,e))}),c})},aa),ia=(ua.bs=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ua(t,e.fromCache,n,r)},ua),oa=(sa.prototype.Ss=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},sa.prototype.next=function(){var t=++this.previousValue;return this.Ds&&this.Ds(t),t},sa);function sa(t,e){var n=this;this.previousValue=t,e&&(e.vs=function(t){return n.Ss(t)},this.Ds=function(t){return e.Cs(t)})}function ua(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.ps=r}function aa(t,e,n){this.os=t,this.cs=e,this.us=n}function ca(){this.ns=[]}function ha(){this.Wn=new ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.jn=!1}function fa(t){var e=this;this.On=null,this.kn=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.$n=!1,t(function(t){e.Mn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Mn=!0,e.error=t,e.kn&&e.kn(t)})}function la(t,e){this.xn=t,this.Nn=e,this.Fn={}}function pa(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function da(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}oa.xs=-1;var ya=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},va=(ga.prototype.reset=function(){this.$s=0},ga.prototype.qs=function(){this.$s=this.Ms},ga.prototype.Us=function(t){var e=this;this.cancel();var n=Math.floor(this.$s+this.Qs()),r=Math.max(0,Date.now()-this.Bs),i=Math.max(0,n-r);0<i&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.$s+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ls=this.Ns.Ks(this.Fs,i,function(){return e.Bs=Date.now(),t()}),this.$s*=this.ks,this.$s<this.Os&&(this.$s=this.Os),this.$s>this.Ms&&(this.$s=this.Ms)},ga.prototype.Ws=function(){null!==this.Ls&&(this.Ls.js(),this.Ls=null)},ga.prototype.cancel=function(){null!==this.Ls&&(this.Ls.cancel(),this.Ls=null)},ga.prototype.Qs=function(){return(Math.random()-.5)*this.$s},ga);function ga(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ns=t,this.Fs=e,this.Os=n,this.ks=r,this.Ms=i,this.$s=0,this.Ls=null,this.Bs=Date.now(),this.reset()}function ma(t){return"IndexedDbTransactionError"===t.name}function wa(){return"undefined"!=typeof document?document:null}var ba=(Ta.Ai=function(t,e,n,r,i){return(i=new Ta(t,e,Date.now()+n,r,i)).start(n),i},Ta.prototype.start=function(t){var e=this;this.Ri=setTimeout(function(){return e.Pi()},t)},Ta.prototype.js=function(){return this.Pi()},Ta.prototype.cancel=function(t){null!==this.Ri&&(this.clearTimeout(),this.Ii.reject(new wr(mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ta.prototype.Pi=function(){var e=this;this.Ei.yi(function(){return null!==e.Ri?(e.clearTimeout(),e.op().then(function(t){return e.Ii.resolve(t)})):Promise.resolve()})},Ta.prototype.clearTimeout=function(){null!==this.Ri&&(this.mi(this),clearTimeout(this.Ri),this.Ri=null)},Ta),Ea=(Object.defineProperty(_a.prototype,"Ni",{get:function(){return this.pi},enumerable:!1,configurable:!0}),_a.prototype.yi=function(t){this.enqueue(t)},_a.prototype.Fi=function(t){this.Oi(),this.ki(t)},_a.prototype.Mi=function(){var t;this.pi||(this.pi=!0,(t=wa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.xi))},_a.prototype.enqueue=function(t){return this.Oi(),this.pi?new Promise(function(t){}):this.ki(t)},_a.prototype.$i=function(t){var e=this;this.yi(function(){return e.Vi.push(t),e.Li()})},_a.prototype.Li=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Vi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Vi[0]()];case 2:return t.sent(),this.Vi.shift(),this.Ci.reset(),[3,4];case 3:if(!ma(e=t.sent()))throw e;return Ar("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Vi.length&&this.Ci.Us(function(){return n.Li()}),t.label=5;case 5:return[2]}})})},_a.prototype.ki=function(t){var r=this,e=this.gi.then(function(){return r.Si=!0,t().catch(function(t){throw r.vi=t,r.Si=!1,Ir("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Si=!1,t})});return this.gi=e},_a.prototype.Ks=function(t,e,n){var r=this;return this.Oi(),-1<this.Di.indexOf(t)&&(e=0),n=ba.Ai(this,t,e,n,function(t){return r.Bi(t)}),this.bi.push(n),n},_a.prototype.Oi=function(){this.vi&&Rr()},_a.prototype.qi=function(){},_a.prototype.Ui=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.gi];case 1:t.sent(),t.label=2;case 2:if(e!==this.gi)return[3,0];t.label=3;case 3:return[2]}})})},_a.prototype.Qi=function(t){for(var e=0,n=this.bi;e<n.length;e++)if(n[e].Fs===t)return!0;return!1},_a.prototype.Ki=function(r){var i=this;return this.Ui().then(function(){i.bi.sort(function(t,e){return t.Ti-e.Ti});for(var t=0,e=i.bi;t<e.length;t++){var n=e[t];if(n.js(),"all"!==r&&n.Fs===r)break}return i.Ui()})},_a.prototype.Wi=function(t){this.Di.push(t)},_a.prototype.Bi=function(t){t=this.bi.indexOf(t),this.bi.splice(t,1)},_a);function _a(){var e=this;this.gi=Promise.resolve(),this.Vi=[],this.pi=!1,this.bi=[],this.vi=null,this.Si=!1,this.Di=[],this.Ci=new va(this,"async_queue_retry"),this.xi=function(){var t=wa();t&&Ar("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ci.Ws()};var t=wa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.xi)}function Ta(t,e,n,r,i){this.Ei=t,this.Fs=e,this.Ti=n,this.op=r,this.mi=i,this.Ii=new ya,this.then=this.Ii.promise.then.bind(this.Ii.promise),this.Ii.promise.catch(function(t){})}function Aa(t,e){if(Ir("AsyncQueue",e+": "+t),ma(t))return new wr(mr.UNAVAILABLE,e+": "+t);throw t}function Ia(t){this.Cr=t}var Na=(Oa.prototype.pr=function(t){this.br=t},Oa.prototype.Ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.In.length||1===r.In.length&&r.In[0].field.rt())||i.isEqual(ri.min())?this.vr(e,r):this.br.ds(e,o).next(function(t){var n=s.Sr(r,t);return(hu(r)||fu(r))&&s.Dr(r.limitType,n,o,i)?s.vr(e,r):(Tr()<=u.DEBUG&&Ar("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bu(r)),s.br.Ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.At(t.key,t)}),e}))})},Oa.prototype.Sr=function(n,t){var r=new Mi(_u(n));return t.forEach(function(t,e){e instanceof nu&&Eu(n,e)&&(r=r.add(e))}),r},Oa.prototype.Dr=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},Oa.prototype.vr=function(t,e){return Tr()<=u.DEBUG&&Ar("QueryEngine","Using full collection scan to execute query:",bu(e)),this.br.Ts(t,e,ri.min())},Oa);function Oa(){}function Ra(t){var e=Jo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?gu(e,e.limit,"L"):e}var La=(Ca.prototype.$r=function(t,e){return this.lo.add(e),na.resolve()},Ca.prototype.Ps=function(t,e){return na.resolve(this.lo.getEntries(e))},Ca),Da=(Pa.prototype.add=function(t){var e=t.J(),n=t.G(),r=this.index[e]||new Mi(ii.K),t=!r.has(n);return this.index[e]=r.add(n),t},Pa.prototype.has=function(t){var e=t.J(),t=t.G();return(e=this.index[e])&&e.has(t)},Pa.prototype.getEntries=function(t){return(this.index[t]||new Mi(ii.K)).tt()},Pa),Sa=(ka.prototype.next=function(){return this.mo+=2,this.mo},ka.Io=function(){return new ka(0)},ka.Ao=function(){return new ka(-1)},ka);function ka(t){this.mo=t}function Pa(){this.index={}}function Ca(){this.lo=new Da}function Va(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function xa(t,e){if(t instanceof Uint8Array)return Va(t,e);if(t instanceof ArrayBuffer)return Va(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Ua(t){return new Uo(t,!0)}var Ma=(Ga.prototype.Mc=function(){return"metadata"in this.payload},Ga),ja=(Ba.qc=function(t,e){return new Ba(xa(t,10240),e)},Ba.prototype.close=function(){return this.$c.cancel()},Ba.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Ba.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Bc())]}})})},Ba.prototype.Bc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Lc.decode(e),n=Number(r),isNaN(n)&&this.Kc("length string ("+r+") is not valid number"),[4,this.Wc(n)]);case 2:return r=t.sent(),[2,new Ma(JSON.parse(r),e.length+n)]}})})},Ba.prototype.jc=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Ba.prototype.Qc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.jc()<0?[4,this.Gc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.jc())<0&&this.Kc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Ba.prototype.Wc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Gc()]:[3,3];case 1:t.sent()&&this.Kc("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Lc.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Ba.prototype.Kc=function(t){throw this.$c.cancel(),new Error("Invalid bundle format: "+t)},Ba.prototype.Gc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.$c.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Ba),qa=(Fa.prototype.zc=function(t){return Wo(this.serializer,t)},Fa.prototype.Hc=function(t){return t.metadata.exists?(r=Wo(this.serializer,(n=t.document).name),e=Go(n.updateTime),n=new Ws({mapValue:{fields:n.fields}}),new nu(r,e,n,{hasCommittedMutations:!1})):new ru(this.zc(t.metadata.name),this.Jc(t.metadata.readTime));var e,n,r},Fa.prototype.Jc=Go,Fa);function Fa(t){this.serializer=t}function Ba(t,e){var n=this;this.$c=t,this.serializer=e,this.metadata=new ya,this.buffer=new Uint8Array,this.Lc=new TextDecoder("utf-8"),this.Bc().then(function(t){t&&t.Mc()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Ga(t,e){this.payload=t,this.byteLength=e}function za(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Ha(t,e){this.progress=t,this.Yc=e}var Ka=(Xa.prototype.ta=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Xa.prototype.ea=function(t){for(var e=new Map,n=new qa(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.zc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Ki()).add(s);e.set(c,h)}}return e},Xa.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:for(e=new qa((n=l).serializer),r=Ki(),i=qi,o=zi,s=0,u=p;s<u.length;s++)a=u[s],c=e.zc(a.metadata.name),a.document&&(r=r.add(c)),i=i.At(c,e.Hc(a)),o=o.At(c,e.Jc(a.metadata.readTime));return h=n.na.oo({co:!0}),[4,Ja(n,vu(cu(ii.nt("__bundle__/docs/"+d))))];case 1:return f=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Za(e,h,i,ri.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Zo.No(e,f.targetId).next(function(){return n.Zo.ko(e,r,f.targetId)}).next(function(){return n.sa.ws(e,t)})})})]}})})}(this.Zc,this.documents,this.Xc.id)];case 1:e=t.sent(),n=this.ea(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Ki()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ja(e,vu(Ra(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Go(i.readTime);return 0<=n.wt.u(e)?r.tc.Eo(t,i):(e=n.Tt(Cr.h,e),r.ra=r.ra.At(e.targetId,e),r.Zo.Co(t,e).next(function(){return r.Zo.No(t,n.targetId)}).next(function(){return r.Zo.ko(t,o,n.targetId)}).next(function(){return r.tc.Eo(t,i)}))})]}})})}(this.Zc,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ha(Object.assign({},this.progress),e))]}})})},Xa),Wa=(Ya.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.yr(t,n.ra)})},Ya);function Ya(t,e,n,r){this.persistence=t,this.ia=e,this.serializer=r,this.ra=new Si(kr),this.oa=new ea(_i,Ti),this.ca=ri.min(),this.cs=t.bc(n),this.na=t.Sc(),this.Zo=t.vc(),this.sa=new ra(this.na,this.cs,this.persistence.Dc()),this.tc=t.Cc(),this.ia.pr(this.sa)}function Xa(t,e,n){this.Xc=t,this.Zc=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=za(t)}function Qa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).cs,m=e.sa,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.cs.Qr(v).next(function(t){return g=t,n=e.persistence.bc(o),m=new ra(e.na,n,e.persistence.Dc()),n.Qr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.ds(v,r).next(function(t){return{aa:t,ua:e,ha:n}})})})];case 1:return r=t.sent(),[2,(e.cs=n,e.sa=m,e.ia.pr(e.sa),r)]}})})}function $a(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zo.Vo(t)})}function Za(t,s,e,u,a){var n=Ki();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=qi;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof ru&&e.version.isEqual(ri.min())?(s.Yn(t,r),o=o.At(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.zn(e,r),o=o.At(t,e)):Ar("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ja(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zo.Oo(e,r).next(function(t){return t?(n=t,na.resolve(n)):i.Zo.Ro(e).next(function(t){return n=new Oi(r,t,0,e.qo),i.Zo.vo(e,n).next(function(){return n})})})}).then(function(t){var e=i.ra.get(t.targetId);return(null===e||0<t.wt.u(e.wt))&&(i.ra=i.ra.At(t.targetId,t),i.oa.set(r,t.targetId)),t})}function tc(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ra.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Nr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ma(r=t.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ra=e.ra.remove(o),e.oa.delete(n.target),[2]}})})}function ec(t,o,s){var u=t,a=ri.min(),c=Ki();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=vu(o),(void 0!==(t=(i=t).oa.get(r))?na.resolve(i.ra.get(t)):i.Zo.Oo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zo.Bo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ia.Ts(e,o,s?a:ri.min(),s?c:Ki())}).next(function(t){return{documents:t,la:c}});var t,n,r,i})}function nc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==mr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}function rc(t,e,n,r,i){var o=this;this.Zc=t,this.eu=e,this.Ei=n,this.nu={},this.su=[],this.iu=new Map,this.ru=new Set,this.ou=[],this.cu=i,this.cu.au(function(t){n.yi(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ac(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(4),[4,gc(e)];case 1:return t.sent(),e.uu.set("Unknown"),e.ru.delete(4),[4,vc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.uu=new hc(n,r)}var ic,oc,sc,me=(yc.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},yc.prototype.ma=function(){return 2===this.state},yc.prototype.start=function(){3!==this.state?this.auth():this.Ia()},yc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},yc.prototype.Aa=function(){this.state=0,this.Ci.reset()},yc.prototype.Ra=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Ns.Ks(this._a,6e4,function(){return t.Pa()}))},yc.prototype.ya=function(t){this.ga(),this.stream.send(t)},yc.prototype.Pa=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},yc.prototype.ga=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},yc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ga(),this.Ci.cancel(),this.wa++,3!==e?this.Ci.reset():n&&n.code===mr.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.Ci.qs()):n&&n.code===mr.UNAUTHENTICATED&&this.da.v(),null!==this.stream&&(this.Va(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.pa(n)];case 1:return t.sent(),[2]}})})},yc.prototype.Va=function(){},yc.prototype.auth=function(){var n=this;this.state=1;var t=this.ba(this.wa),e=this.wa;this.da.getToken().then(function(t){n.wa===e&&n.va(t)},function(e){t(function(){var t=new wr(mr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sa(t)})})},yc.prototype.va=function(t){var e=this,n=this.ba(this.wa);this.stream=this.Da(t),this.stream.Ca(function(){n(function(){return e.state=2,e.listener.Ca()})}),this.stream.pa(function(t){n(function(){return e.Sa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},yc.prototype.Ia=function(){var t=this;this.state=4,this.Ci.Us(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},yc.prototype.Sa=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},yc.prototype.ba=function(e){var n=this;return function(t){n.Ns.yi(function(){return n.wa===e?t():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},yc),uc=(f(dc,sc=me),dc.prototype.Da=function(t){return this.fa.xa("Listen",t)},dc.prototype.onMessage=function(t){this.Ci.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Rr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.nn?(Lr(void 0===s||"string"==typeof s),Cr.fromBase64String(s||"")):(Lr(void 0===s||s instanceof Uint8Array),Cr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?mr.UNKNOWN:Di(c.code),new wr(a,c.message||"")),s=new eo(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Wo(t,n.document.name),i=Go(n.document.updateTime);var u=new Ws({mapValue:{fields:n.document.fields}}),a=(o=new nu(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new Ji(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Wo(t,n.document),i=n.readTime?Go(n.readTime):ri.min(),u=new ru(r,i),o=n.removedTargetIds||[],s=new Ji([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Wo(t,n.document),i=n.removedTargetIds||[],s=new Ji([],i,r,null);else{if(!("filter"in e))return Rr();e.filter,(e=e.filter).targetId,r=new Ii(n=e.count||0),i=e.targetId,s=new to(i,r)}return s}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ri.min():Go(e.readTime);return this.listener.Na(n,t)},dc.prototype.Fa=function(t){var e,n,r,i,o,s,u,a,c={};c.database=Xo(this.serializer),c.addTarget=(e=this.serializer,(r=Ai(r=(n=t).target)?{documents:{documents:[Yo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Yo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Yo(i,u.G()),s.structuredQuery.from=[{collectionId:u.J()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Po(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Po(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,xo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:ns(t.field),direction:(t=t.dir,Vo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.nn||mi(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=ts(o.startAt)),o.endAt&&(s.structuredQuery.endAt=ts(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Bo(e,n.resumeToken):0<n.wt.u(ri.min())&&(r.readTime=Fo(e,n.wt.q())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.dt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":t}))&&(c.labels=t),this.ya(c)},dc.prototype.Oa=function(t){var e={};e.database=Xo(this.serializer),e.removeTarget=t,this.ya(e)},dc),ac=(f(pc,oc=me),Object.defineProperty(pc.prototype,"Ma",{get:function(){return this.ka},enumerable:!1,configurable:!0}),pc.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,oc.prototype.start.call(this)},pc.prototype.Va=function(){this.ka&&this.$a([])},pc.prototype.Da=function(t){return this.fa.xa("Write",t)},pc.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Ci.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Go(e.updateTime):Go(n)).isEqual(ri.min())&&(t=Go(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Is(t,n);var e,n})):[]),n=Go(t.commitTime);return this.listener.La(n,e)}var r;return Lr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Ba()},pc.prototype.qa=function(){var t={};t.database=Xo(this.serializer),this.ya(t)},pc.prototype.$a=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Zo(e.serializer,t)})};this.ya(t)},pc),cc=(f(lc,ic=function(){}),lc.prototype.Qa=function(){if(this.Ua)throw new wr(mr.FAILED_PRECONDITION,"The client has already been terminated.")},lc.prototype.Ka=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,r,t)}).catch(function(t){throw t.code===mr.UNAUTHENTICATED&&i.credentials.v(),t})},lc.prototype.Wa=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Wa(e,n,r,t)}).catch(function(t){throw t.code===mr.UNAUTHENTICATED&&i.credentials.v(),t})},lc.prototype.terminate=function(){this.Ua=!1},lc),hc=(fc.prototype.Ja=function(){var t=this;0===this.Ga&&(this.Ya("Unknown"),this.za=this.Ei.Ks("online_state_timeout",1e4,function(){return t.za=null,t.Xa("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},fc.prototype.Za=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ga++,1<=this.Ga&&(this.tu(),this.Xa("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},fc.prototype.set=function(t){this.tu(),this.Ga=0,"Online"===t&&(this.Ha=!1),this.Ya(t)},fc.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},fc.prototype.Xa=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ha?(Ir(t),this.Ha=!1):Ar("OnlineStateTracker",t)},fc.prototype.tu=function(){null!==this.za&&(this.za.cancel(),this.za=null)},fc);function fc(t,e){this.Ei=t,this.ja=e,this.state="Unknown",this.Ga=0,this.za=null,this.Ha=!0}function lc(t,e,n){var r=this;return(r=ic.call(this)||this).credentials=t,r.fa=e,r.serializer=n,r.Ua=!1,r}function pc(t,e,n,r,i){var o=this;return(o=oc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function dc(t,e,n,r,i){var o=this;return(o=sc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function yc(t,e,n,r,i,o){this.Ns=t,this._a=n,this.fa=r,this.da=i,this.listener=o,this.state=0,this.wa=0,this.Ea=null,this.stream=null,this.Ci=new va(t,e)}function vc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Ac(r))return[3,4];e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function gc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function mc(t,e){t.iu.has(e.targetId)||(t.iu.set(e.targetId,e),Tc(t)?_c(t):Sc(t).ma()&&bc(t,e))}function wc(t,e){var n=t,t=Sc(n);n.iu.delete(e),t.ma()&&Ec(n,e),0===n.iu.size&&(t.ma()?t.Ra():Ac(n)&&n.uu.set("Unknown"))}function bc(t,e){t.hu.xe(e.targetId),Sc(t).Fa(e)}function Ec(t,e){t.hu.xe(e),Sc(t).Oa(e)}function _c(e){e.hu=new ro({tn:function(t){return e.nu.tn(t)},en:function(t){return e.iu.get(t)||null}}),Sc(e).start(),e.uu.Ja()}function Tc(t){return Ac(t)&&!Sc(t).Ta()&&0<t.iu.size}function Ac(t){return 0===t.ru.size}function Ic(t){t.hu=void 0}function Nc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ma(r))throw r;return n.ru.add(1),[4,gc(n)];case 1:return t.sent(),n.uu.set("Offline"),i=i||function(){return $a(n.Zc)},n.Ei.$i(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ru.delete(1),[4,vc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Oc(e,n){return n().catch(function(t){return Nc(e,t,n)})}function Rc(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=kc(o=c),u=0<o.su.length?o.su[o.su.length-1].batchId:-1,t.label=1;case 1:if(!(Ac(o)&&o.su.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Zc,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.cs.qr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.su.length&&s.Ra(),[3,7]):(u=a.batchId,e=a,(n=o).su.push(e),(n=kc(n)).ma()&&n.Ma&&n.$a(e.mutations),[3,6]);case 4:return a=t.sent(),[4,Nc(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Lc(o)&&Dc(o),[2]}var e,n,r,i})})}function Lc(t){return Ac(t)&&!kc(t).Ta()&&0<t.su.length}function Dc(t){kc(t).start()}function Sc(n){var t,e,r,i=this;return n.wu||(n.wu=(t=n.eu,e=n.Ei,r={Ca:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.iu.forEach(function(t,e){bc(n,t)}),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Ic(e),Tc(e)?(e.uu.Za(n),_c(e)):e.uu.set("Unknown"),[2]})})}.bind(null,n),Na:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.uu.set("Online"),!(u instanceof eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.iu.has(i)?[4,o.nu.lu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.iu.delete(i),o.hu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Nc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ji?s.hu.Be(u):u instanceof to?s.hu.ze(u):s.hu.Qe(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,$a(s.Zc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).hu.Ye(i)).ce.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.iu.get(e))&&r.iu.set(e,n.Tt(t.resumeToken,i))}),e.ae.forEach(function(t){var e=r.iu.get(t);e&&(r.iu.set(t,e.Tt(Cr.h,e.wt)),Ec(r,t),e=new Oi(e.target,t,1,e.sequenceNumber),bc(r,e))}),r.nu._u(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Nc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Qa(),new uc(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.wu.Aa(),Tc(n)?_c(n):n.uu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.wu.stop()];case 2:t.sent(),Ic(n),t.label=3;case 3:return[2]}})})})),n.wu}function kc(n){var t,e,r,i=this;return n.Eu||(n.Eu=(t=n.eu,e=n.Ei,r={Ca:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return kc(e).qa(),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&kc(e).Ma?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Li(n=i.code)&&n!==mr.ABORTED?(e=r.su.shift(),kc(r).Aa(),[4,Oc(r,function(){return r.nu.du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Rc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Lc(e)&&Dc(e),[2]}})})}.bind(null,n),Ba:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=kc(o),n=0,r=o.su;n<r.length;n++)i=r[n],e.$a(i.mutations);return[2]})})}.bind(null,n),La:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.su.shift(),n=ta.from(e,i,o),[4,Oc(r,function(){return r.nu.fu(n)})];case 1:return t.sent(),[4,Rc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qa(),new ac(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Eu.Aa(),[4,Rc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Eu.stop()];case 3:t.sent(),0<n.su.length&&(Ar("RemoteStore","Stopping write stream with "+n.su.length+" pending writes"),n.su=[]),t.label=4;case 4:return[2]}})})})),n.Eu}function Pc(){this.queries=new ea(wu,mu),this.onlineState="Unknown",this.mu=new Set}var Cc=function(){this.Tu=void 0,this.listeners=[]};function Vc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Cc),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Iu(n)];case 2:return o.Tu=t.sent(),[3,4];case 3:return o=Aa(o=t.sent(),"Initialization of query '"+bu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Au(e.onlineState),i.Tu&&u.Ru(i.Tu)&&Uc(e),[2]}})})}function xc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Pu(n))]:[2]})})}function Uc(t){t.mu.forEach(function(t){t.next()})}var Mc=(eh.prototype.Ru=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Qi(t.query,t.docs,t.ne,e,t.se,t.fromCache,t.ie,!0)}var o=!1;return this.gu?this.pu(t)&&(this.yu.next(t),o=!0):this.bu(t,this.onlineState)&&(this.vu(t),o=!0),this.Vu=t,o},eh.prototype.onError=function(t){this.yu.error(t)},eh.prototype.Au=function(t){this.onlineState=t;var e=!1;return this.Vu&&!this.gu&&this.bu(this.Vu,t)&&(this.vu(this.Vu),e=!0),e},eh.prototype.bu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Su&&n||t.docs.Y()&&"Offline"!==e)},eh.prototype.pu=function(t){if(0<t.docChanges.length)return!0;var e=this.Vu&&this.Vu.hasPendingWrites!==t.hasPendingWrites;return!(!t.ie&&!e)&&!0===this.options.includeMetadataChanges},eh.prototype.vu=function(t){t=Qi.oe(t.query,t.docs,t.se,t.fromCache),this.gu=!0,this.yu.next(t)},eh),jc=(th.prototype.Y=function(){return this.Du.Y()},th.prototype.Mo=function(t,e){e=new qc(t,e),this.Du=this.Du.add(e),this.xu=this.xu.add(e)},th.prototype.Fu=function(t,e){var n=this;t.forEach(function(t){return n.Mo(t,e)})},th.prototype.Lo=function(t,e){this.Ou(new qc(t,e))},th.prototype.ku=function(t,e){var n=this;t.forEach(function(t){return n.Lo(t,e)})},th.prototype.Mu=function(t){var e=this,n=new ui(new ii([])),r=new qc(n,t),t=new qc(n,t+1),i=[];return this.xu.jt([r,t],function(t){e.Ou(t),i.push(t.key)}),i},th.prototype.$u=function(){var e=this;this.Du.forEach(function(t){return e.Ou(t)})},th.prototype.Ou=function(t){this.Du=this.Du.delete(t),this.xu=this.xu.delete(t)},th.prototype.Lu=function(t){var e=new ui(new ii([])),n=new qc(e,t),t=new qc(e,t+1),r=Ki();return this.xu.jt([n,t],function(t){r=r.add(t.key)}),r},th.prototype.Jr=function(t){var e=new qc(t,0);return null!==(e=this.Du.zt(e))&&t.isEqual(e.key)},th),qc=(Jc.Cu=function(t,e){return ui.K(t.key,e.key)||kr(t.Bu,e.Bu)},Jc.Nu=function(t,e){return kr(t.Bu,e.Bu)||ui.K(t.key,e.key)},Jc),Fc=(Zc.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Zc.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Zc.prototype.Uu=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Zc),Bc=($c.prototype.lh=function(t){},$c.prototype.fh=function(t,e,n){},$c.prototype.wh=function(t){return this.Lh.Qu(t),this.Bh[t]||"not-current"},$c.prototype.Ah=function(t,e,n){this.Bh[t]=e},$c.prototype.Th=function(t){this.Lh.Ku(t)},$c.prototype.mh=function(t){return this.Lh.activeTargetIds.has(t)},$c.prototype.Ih=function(t){delete this.Bh[t]},$c.prototype.ah=function(){return this.Lh.activeTargetIds},$c.prototype.hh=function(t){return this.Lh.activeTargetIds.has(t)},$c.prototype.start=function(){return this.Lh=new Fc,Promise.resolve()},$c.prototype.Ph=function(t,e,n){},$c.prototype.yh=function(t){},$c.prototype.Ac=function(){},$c.prototype.Cs=function(t){},$c.prototype.Vh=function(){},$c),Gc=function(t){this.key=t},zc=function(t){this.key=t},Hc=(Object.defineProperty(Qc.prototype,"jh",{get:function(){return this.qh},enumerable:!1,configurable:!0}),Qc.prototype.Gh=function(t,e){var s=this,u=e?e.zh:new Xi,a=(e||this).Wh,c=(e||this).se,h=a,f=!1,l=hu(this.query)&&a.size===this.query.limit?a.last():null,p=fu(this.query)&&a.size===this.query.limit?a.first():null;if(t.gt(function(t,e){var n=a.get(t),r=(r=e instanceof nu?e:null)&&(Eu(s.query,r)?r:null),i=!!n&&s.se.has(n.key),o=!!r&&(r.ln||s.se.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Hh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Kh(r,l)||p&&s.Kh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),hu(this.query)||fu(this.query))for(;h.size>this.query.limit;){var n=hu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Wh:h,zh:u,Dr:f,se:c}},Qc.prototype.Hh=function(t,e){return t.ln&&e.hasCommittedMutations&&!e.ln},Qc.prototype.es=function(t,e,n){var o=this,r=this.Wh;this.Wh=t.Wh,this.se=t.se;var i=t.zh.ee();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Kh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.Jh(n);var s=e?this.Yh():[],e=(n=0===this.Qh.size&&this.fe?1:0)!==this.Uh;return this.Uh=n,0!==i.length||e?{snapshot:new Qi(this.query,t.Wh,r,i,t.se,0==n,e,!1),Xh:s}:{Xh:s}},Qc.prototype.Au=function(t){return this.fe&&"Offline"===t?(this.fe=!1,this.es({Wh:this.Wh,zh:new Xi,se:this.se,Dr:!1},!1)):{Xh:[]}},Qc.prototype.Zh=function(t){return!this.qh.has(t)&&!!this.Wh.has(t)&&!this.Wh.get(t).ln},Qc.prototype.Jh=function(t){var e=this;t&&(t.de.forEach(function(t){return e.qh=e.qh.add(t)}),t.we.forEach(function(t){}),t.Ee.forEach(function(t){return e.qh=e.qh.delete(t)}),this.fe=t.fe)},Qc.prototype.Yh=function(){var e=this;if(!this.fe)return[];var n=this.Qh;this.Qh=Ki(),this.Wh.forEach(function(t){e.Zh(t.key)&&(e.Qh=e.Qh.add(t.key))});var r=[];return n.forEach(function(t){e.Qh.has(t)||r.push(new zc(t))}),this.Qh.forEach(function(t){n.has(t)||r.push(new Gc(t))}),r},Qc.prototype.tl=function(t){return this.qh=t.la,this.Qh=Ki(),t=this.Gh(t.documents),this.es(t,!0)},Qc.prototype.el=function(){return Qi.oe(this.query,this.Wh,this.se,0===this.Uh)},Qc),Kc=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wc=function(t){this.key=t,this.nl=!1},Yc=(Object.defineProperty(Xc.prototype,"ml",{get:function(){return!0===this.Tl},enumerable:!1,configurable:!0}),Xc);function Xc(t,e,n,r,i,o){this.Zc=t,this.sl=e,this.il=n,this.rl=r,this.currentUser=i,this.ol=o,this.cl={},this.al=new ea(wu,mu),this.ul=new Map,this.hl=[],this.ll=new Si(ui.K),this._l=new Map,this.fl=new jc,this.dl={},this.wl=new Map,this.El=Sa.Ao(),this.onlineState="Unknown",this.Tl=void 0}function Qc(t,e){this.query=t,this.qh=e,this.Uh=null,this.fe=!1,this.Qh=Ki(),this.se=Ki(),this.Kh=_u(t),this.Wh=new Yi(this.Kh)}function $c(){this.Lh=new Fc,this.Bh={},this.ja=null,this.vs=null}function Zc(){this.activeTargetIds=Wi}function Jc(t,e){this.key=t,this.Bu=e}function th(){this.Du=new Mi(qc.Cu),this.xu=new Mi(qc.Nu)}function eh(t,e,n){this.query=t,this.yu=e,this.gu=!1,this.Vu=null,this.onlineState="Unknown",this.options=n||{}}function nh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).sl.nu.fu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.na.oo({co:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=na.resolve();return a.forEach(function(n){c=c.next(function(){return s.Xn(o,n)}).next(function(t){var e=t;Lr(null!==(t=r.Cn.get(n))),(!e||e.version.u(t)<0)&&(e=u.pn(n,e,r))&&s.zn(e,r.Dn)})}),c.next(function(){return i.cs.Wr(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.cs.Hr(t)}).next(function(){return f.sa.ds(t,e)})}))];case 2:return i=t.sent(),uh(n,r,null),sh(n,r),n.rl.fh(r,"acknowledged"),[4,lh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,o),o.sl.nu.du=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.cs.Lr(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.cs.Wr(e,t)}).next(function(){return i.cs.Hr(e)}).next(function(){return i.sa.ds(e,n)})}))];case 2:return o=t.sent(),uh(n,u,a),sh(n,u),n.rl.fh(u,"rejected",a),[4,lh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Zc,a=p,h=r,f=ni.now(),i=a.reduce(function(t,e){return t.add(e.key)},Ki()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.sa.ds(u,i).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof qs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof nu?t.field(i.field):void 0;null!=(o=os(i.transform,o||null))&&(e=(null==e?new Ys:e).set(i.field,o))}return e?e._n():null}(o):null);null!=o&&e.push(new Vs(i.key,o,function s(t){var u=[];return yo(t.fields||{},function(t,e){var n=new si([t]);if(Co(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ts(u)}(o.proto.mapValue),Ns.exists(!0)))}return h.cs.Mr(u,f,e,a)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Wn:e}}))];case 2:return s=t.sent(),u.rl.lh(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.dl[e.currentUser.R()])||new Si(kr)).At(n,o),e.dl[e.currentUser.R()]=r,[4,lh(u,s.Wn)];case 3:return t.sent(),[4,Rc(u.sl)];case 4:return t.sent(),[3,6];case 5:return u=Aa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function rh(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,a=e,c=(r=s).wt,h=a.ra,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.na.oo({co:!0});h=a.ra;var u=[];r.ce.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Zo.$o(s,t.Ee,e).next(function(){return a.Zo.ko(s,t.de,e)})),0<(i=t.resumeToken).o()&&(n=o.Tt(i,c).Et(s.qo),h=h.At(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.wt.B()-r.wt.B()||0<i.de.size+i.we.size+i.Ee.size)&&u.push(a.Zo.Co(s,n))))});var e,n=qi;return r.ue.forEach(function(t,e){r.he.has(t)&&u.push(a.persistence.Nr.kc(s,t))}),u.push(Za(s,t,r.ue,c,void 0).next(function(t){n=t})),c.isEqual(ri.min())||(e=a.Zo.Vo(s).next(function(t){return a.Zo.bo(s,s.qo,c)}),u.push(e)),na.Qn(u).next(function(){return t.apply(s)}).next(function(){return a.sa.ws(s,n)})}).then(function(t){return a.ra=h,t}))];case 2:return i=t.sent(),s.ce.forEach(function(t,e){(e=n._l.get(e))&&(Lr(t.de.size+t.we.size+t.Ee.size<=1),0<t.de.size?e.nl=!0:0<t.we.size?Lr(e.nl):0<t.Ee.size&&(Lr(e.nl),e.nl=!1))}),[4,lh(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function ih(t,n,e){var r;((t=t).ml&&0===e||!t.ml&&1===e)&&(r=[],t.al.forEach(function(t,e){(e=e.view.Au(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Au(i)&&(o=!0)}),o&&Uc(t)}(t.il,n),r.length&&t.cl.Na(r),t.onlineState=n,t.ml&&t.rl.yh(n))}function oh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Ac((n=o).sl)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Zc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.cs.Ur(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.wl.get(r)||[]).push(s),n.wl.set(r,i),[3,4]);case 3:return i=Aa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function sh(t,e){(t.wl.get(e)||[]).forEach(function(t){t.resolve()}),t.wl.delete(e)}function uh(t,e,n){var r=t,i=r.dl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.dl[r.currentUser.R()]=i)}function ah(e,t,n){void 0===n&&(n=null),e.rl.Th(t);for(var r=0,i=e.ul.get(t);r<i.length;r++){var o=i[r];e.al.delete(o),n&&e.cl.Al(o,n)}e.ul.delete(t),e.ml&&e.fl.Mu(t).forEach(function(t){e.fl.Jr(t)||ch(e,t)})}function ch(t,e){var n=t.ll.get(e);null!==n&&(wc(t.sl,n),t.ll=t.ll.remove(e),t._l.delete(n),fh(t))}function hh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Gc?(t.fl.Mo(u.key,e),r=t,i=(i=u).key,r.ll.get(i)||(Ar("SyncEngine","New document in limbo: "+i),r.hl.push(i),fh(r))):u instanceof zc?(Ar("SyncEngine","Document no longer in limbo: "+u.key),t.fl.Lo(u.key,e),t.fl.Jr(u.key)||ch(t,u.key)):Rr()}}function fh(t){for(;0<t.hl.length&&t.ll.size<t.ol;){var e=t.hl.shift(),n=t.El.next();t._l.set(n,new Wc(e)),t.ll=t.ll.At(e,n),mc(t.sl,new Oi(vu(cu(e.path)),n,2,oa.xs))}}function lh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).al.Y()?[3,3]:(n.al.forEach(function(t,e){o.push(n.Il(e,s,u).then(function(t){t&&(n.ml&&n.rl.Ah(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ia.bs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.cl.Na(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return na.forEach(c,function(e){return na.forEach(e.Vs,function(t){return r.persistence.Nr.Mo(n,e.targetId,t)}).next(function(){return na.forEach(e.ps,function(t){return r.persistence.Nr.Lo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ma(e=t.sent()))throw e;return Ar("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ra.get(o),u=s.wt,u=s.It(u),r.ra=r.ra.At(o,u));return[2]}})})}(n.Zc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function ph(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Zc,i=u,s=new qa((o=r).serializer).Jc(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.tc._o(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Rl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Pl(za(u)),a=new Ka(u,l.Zc,p.serializer),[4,p.Uc()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ta(c)]:[3,10];case 7:return(h=t.sent())&&d.Pl(h),[4,p.Uc()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,lh(l,f.Yc,void 0)];case 12:return t.sent(),[4,(r=l.Zc,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.tc.fo(t,e)}))];case 13:return t.sent(),d.Rl(f.progress),[3,15];case 14:return Nr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.yl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.rl.Vh()})}var dh,yh,vh,gh=(Yh.prototype.kr=function(t){return na.resolve(0===this.cs.length)},Yh.prototype.Mr=function(t,e,n,r){var i=this.gl;this.gl++,0<this.cs.length&&this.cs[this.cs.length-1],n=new Ju(i,e,n,r),this.cs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Vl=this.Vl.add(new qc(u.key,i)),this.us.$r(t,u.key.path.G())}return na.resolve(n)},Yh.prototype.Lr=function(t,e){return na.resolve(this.pl(e))},Yh.prototype.qr=function(t,e){return e+=1,e=(e=this.bl(e))<0?0:e,na.resolve(this.cs.length>e?this.cs[e]:null)},Yh.prototype.Ur=function(){return na.resolve(0===this.cs.length?-1:this.gl-1)},Yh.prototype.Qr=function(t){return na.resolve(this.cs.slice())},Yh.prototype.ls=function(t,e){var n=this,r=new qc(e,0),e=new qc(e,Number.POSITIVE_INFINITY),i=[];return this.Vl.jt([r,e],function(t){t=n.pl(t.Bu),i.push(t)}),na.resolve(i)},Yh.prototype.Es=function(t,e){var n=this,r=new Mi(kr);return e.forEach(function(t){var e=new qc(t,0),t=new qc(t,Number.POSITIVE_INFINITY);n.Vl.jt([e,t],function(t){r=r.add(t.Bu)})}),na.resolve(this.vl(r))},Yh.prototype.ys=function(t,e){var n=e.path,r=n.length+1,e=n;ui.lt(e)||(e=e.child(""));var e=new qc(new ui(e),0),i=new Mi(kr);return this.Vl.Gt(function(t){var e=t.key.path;return!!n.X(e)&&(e.length===r&&(i=i.add(t.Bu)),!0)},e),na.resolve(this.vl(i))},Yh.prototype.vl=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.pl(t))&&n.push(t)}),n},Yh.prototype.Wr=function(n,r){var i=this;Lr(0===this.Sl(r.batchId,"removed")),this.cs.shift();var o=this.Vl;return na.forEach(r.mutations,function(t){var e=new qc(t.key,r.batchId);return o=o.delete(e),i.Nr.zr(n,t.key)}).next(function(){i.Vl=o})},Yh.prototype.Gr=function(t){},Yh.prototype.Jr=function(t,e){var n=new qc(e,0),n=this.Vl.zt(n);return na.resolve(e.isEqual(n&&n.key))},Yh.prototype.Hr=function(t){return this.cs.length,na.resolve()},Yh.prototype.Sl=function(t,e){return this.bl(t)},Yh.prototype.bl=function(t){return 0===this.cs.length?0:t-this.cs[0].batchId},Yh.prototype.pl=function(t){return(t=this.bl(t))<0||t>=this.cs.length?null:this.cs[t]},Yh),mh=(Wh.prototype.zn=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Dl(e);return this.docs=this.docs.At(r,{Jn:e,size:o,readTime:n}),this.size+=o-i,this.us.$r(t,r.path.G())},Wh.prototype.Yn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Wh.prototype.Xn=function(t,e){return e=this.docs.get(e),na.resolve(e?e.Jn:null)},Wh.prototype.getEntries=function(t,e){var n=this,r=qi;return e.forEach(function(t){var e=n.docs.get(t);r=r.At(t,e?e.Jn:null)}),na.resolve(r)},Wh.prototype.Ts=function(t,e,n){for(var r=Gi,i=new ui(e.path.child("")),o=this.docs.vt(i);o.Ft();){var s=(u=o.Nt()).key,u=(a=u.value).Jn,a=a.readTime;if(!e.path.X(s.path))break;a.u(n)<=0||u instanceof nu&&Eu(e,u)&&(r=r.At(u.key,u))}return na.resolve(r)},Wh.prototype.Cl=function(t,e){return na.forEach(this.docs,function(t){return e(t)})},Wh.prototype.oo=function(t){return new wh(this)},Wh.prototype.ao=function(t){return na.resolve(this.size)},Wh),wh=(f(Kh,vh=o),Kh.prototype.es=function(n){var r=this,i=[];return this.Wn.forEach(function(t,e){e&&e.Jn?i.push(r.uo.zn(n,e.Jn,r.Gn(t))):r.uo.Yn(t)}),na.Qn(i)},Kh.prototype.Zn=function(t,e){return this.uo.Xn(t,e)},Kh.prototype.ts=function(t,e){return this.uo.getEntries(t,e)},Kh),bh=(Hh.prototype.Ke=function(t,n){return this.xl.forEach(function(t,e){return n(e)}),na.resolve()},Hh.prototype.Vo=function(t){return na.resolve(this.lastRemoteSnapshotVersion)},Hh.prototype.po=function(t){return na.resolve(this.Nl)},Hh.prototype.Ro=function(t){return this.highestTargetId=this.Ol.next(),na.resolve(this.highestTargetId)},Hh.prototype.bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Nl&&(this.Nl=e),na.resolve()},Hh.prototype.So=function(t){this.xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ol=new Sa(e),this.highestTargetId=e),t.sequenceNumber>this.Nl&&(this.Nl=t.sequenceNumber)},Hh.prototype.vo=function(t,e){return this.So(e),this.targetCount+=1,na.resolve()},Hh.prototype.Co=function(t,e){return this.So(e),na.resolve()},Hh.prototype.xo=function(t,e){return this.xl.delete(e.target),this.Fl.Mu(e.targetId),--this.targetCount,na.resolve()},Hh.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return this.xl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.xl.delete(t),u.push(o.No(n,e.targetId)),s++)}),na.Qn(u).next(function(){return s})},Hh.prototype.Fo=function(t){return na.resolve(this.targetCount)},Hh.prototype.Oo=function(t,e){return e=this.xl.get(e)||null,na.resolve(e)},Hh.prototype.ko=function(t,e,n){return this.Fl.Fu(e,n),na.resolve()},Hh.prototype.$o=function(e,t,n){this.Fl.ku(t,n);var r=this.persistence.Nr,i=[];return r&&t.forEach(function(t){i.push(r.zr(e,t))}),na.Qn(i)},Hh.prototype.No=function(t,e){return this.Fl.Mu(e),na.resolve()},Hh.prototype.Bo=function(t,e){return e=this.Fl.Lu(e),na.resolve(e)},Hh.prototype.Jr=function(t,e){return na.resolve(this.Fl.Jr(e))},Hh),Eh=(zh.prototype._o=function(t,e){return na.resolve(this.kl.get(e))},zh.prototype.fo=function(t,e){return this.kl.set(e.id,{id:e.id,version:e.version,createTime:Go(e.createTime)}),na.resolve()},zh.prototype.wo=function(t,e){return na.resolve(this.Ml.get(e))},zh.prototype.Eo=function(t,e){return this.Ml.set(e.name,{name:e.name,query:Ra(e.bundledQuery),readTime:Go(e.readTime)}),na.resolve()},zh),_h=(Gh.prototype.start=function(){return Promise.resolve()},Gh.prototype.Ac=function(){return this.Wo=!1,Promise.resolve()},Object.defineProperty(Gh.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Gh.prototype.cc=function(){},Gh.prototype.ac=function(){},Gh.prototype.Dc=function(){return this.us},Gh.prototype.bc=function(t){var e=this.$l[t.R()];return e||(e=new gh(this.us,this.Nr),this.$l[t.R()]=e),e},Gh.prototype.vc=function(){return this.Zo},Gh.prototype.Sc=function(){return this.os},Gh.prototype.Cc=function(){return this.tc},Gh.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new Th(this.Ko.next());return this.Nr.Bl(),n(i).next(function(t){return r.Nr.ql(i).next(function(){return t})}).qn().then(function(t){return i.rs(),t})},Gh.prototype.Ul=function(e,n){return na.Kn(Object.values(this.$l).map(function(t){return function(){return t.Jr(e,n)}}))},Gh),Th=(f(Bh,yh=ge),Bh),Ah=(Fh.Wl=function(t){return new Fh(t)},Object.defineProperty(Fh.prototype,"jl",{get:function(){if(this.Kl)return this.Kl;throw Rr()},enumerable:!1,configurable:!0}),Fh.prototype.Mo=function(t,e,n){return this.Ql.Mo(n,e),this.jl.delete(n.toString()),na.resolve()},Fh.prototype.Lo=function(t,e,n){return this.Ql.Lo(n,e),this.jl.add(n.toString()),na.resolve()},Fh.prototype.zr=function(t,e){return this.jl.add(e.toString()),na.resolve()},Fh.prototype.removeTarget=function(t,e){var n=this;this.Ql.Mu(e.targetId).forEach(function(t){return n.jl.add(t.toString())});var r=this.persistence.vc();return r.Bo(t,e.targetId).next(function(t){t.forEach(function(t){return n.jl.add(t.toString())})}).next(function(){return r.xo(t,e)})},Fh.prototype.Bl=function(){this.Kl=new Set},Fh.prototype.ql=function(n){var r=this,i=this.persistence.Sc().oo();return na.forEach(this.jl,function(t){var e=ui.at(t);return r.Gl(n,e).next(function(t){t||i.Yn(e)})}).next(function(){return r.Kl=null,i.apply(n)})},Fh.prototype.kc=function(t,e){var n=this;return this.Gl(t,e).next(function(t){t?n.jl.delete(e.toString()):n.jl.add(e.toString())})},Fh.prototype.Ll=function(t){return 0},Fh.prototype.Gl=function(t,e){var n=this;return na.Kn([function(){return na.resolve(n.Ql.Jr(e))},function(){return n.persistence.vc().Jr(t,e)},function(){return n.persistence.Ul(t,e)}])},Fh),Ih=(qh.prototype.Ca=function(t){this.Jl=t},qh.prototype.pa=function(t){this.Yl=t},qh.prototype.onMessage=function(t){this.Xl=t},qh.prototype.close=function(){this.Hl()},qh.prototype.send=function(t){this.zl(t)},qh.prototype.Zl=function(){this.Jl()},qh.prototype.t_=function(t){this.Yl(t)},qh.prototype.e_=function(t){this.Xl(t)},qh),Nh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Oh=(jh.prototype.Ka=function(e,t,n,r){var i=this.r_(e,t);return Ar("RestConnection","Sending: ",i,n),t={},this.o_(t,r),this.c_(e,i,t,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(t){throw Nr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},jh.prototype.Wa=function(t,e,n,r){return this.Ka(t,e,n,r)},jh.prototype.o_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-BundlePrerelease.f8bb4d8b7",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},jh.prototype.r_=function(t,e){return t=Nh[t],this.s_+"/v1/"+e+":"+t},f(Mh,dh=jh),Mh.prototype.c_=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(dr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case pr.NO_ERROR:var t=i.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(t)),n(t);break;case pr.TIMEOUT:Ar("Connection",'RPC "'+o+'" timed out'),r(new wr(mr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e=i.getStatus();Ar("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(mr).indexOf(e)?e:mr.UNKNOWN,r(new wr(e,t.message))):r(new wr(mr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new wr(mr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Ar("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Mh.prototype.xa=function(t,e){var n,r=[this.s_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=lr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.o_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Ar("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Ih({zl:function(t){a?Ar("Connection","Not sending because WebChannel is closed:",t):(u||(Ar("Connection","Opening WebChannel transport."),s.open(),u=!0),Ar("Connection","WebChannel sending:",t),s.send(t))},Hl:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,vr.EventType.OPEN,function(){a||Ar("Connection","WebChannel transport opened.")}),t(s,vr.EventType.CLOSE,function(){a||(a=!0,Ar("Connection","WebChannel transport closed"),c.t_())}),t(s,vr.EventType.ERROR,function(t){a||(a=!0,Nr("Connection","WebChannel transport errored:",t),c.t_(new wr(mr.UNAVAILABLE,"The operation could not be completed")))}),t(s,vr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ar("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ni[r];if(void 0!==t)return Di(t)}(),i=n.message,void 0===t&&(t=mr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.t_(new wr(t,i)),s.close()):(Ar("Connection","WebChannel received:",e),c.e_(e)))}),t(o,yr.STAT_EVENT,function(t){10===t.stat?Ar("Connection","Detected buffering proxy"):11===t.stat&&Ar("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Zl()},0),c},Mh),Rh=(Uh.prototype.au=function(t){this.__.push(t)},Uh.prototype.Ac=function(){window.removeEventListener("online",this.a_),window.removeEventListener("offline",this.h_)},Uh.prototype.f_=function(){window.addEventListener("online",this.a_),window.addEventListener("offline",this.h_)},Uh.prototype.u_=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(0)},Uh.prototype.l_=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(1)},Uh.Hs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Uh),Lh=(xh.prototype.au=function(t){},xh.prototype.Ac=function(){},xh),Dh=(Vh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Ua(e.n_.T),this.rl=this.d_(e),this.persistence=this.w_(e),[4,this.persistence.start()];case 1:return t.sent(),this.E_=this.T_(e),this.Zc=this.m_(e),[2]}})})},Vh.prototype.T_=function(t){return null},Vh.prototype.m_=function(t){return e=this.persistence,n=new Na,r=t.I_,t=this.serializer,new Wa(e,n,r,t);var e,n,r},Vh.prototype.w_=function(t){return new _h(Ah.Wl,this.serializer)},Vh.prototype.d_=function(t){return new Bc},Vh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.E_&&this.E_.stop(),[4,this.rl.Ac()];case 1:return t.sent(),[4,this.persistence.Ac()];case 2:return t.sent(),[2]}})})},Vh),Sh=(Ch.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Zc?[3,2]:(this.Zc=n.Zc,this.rl=n.rl,this.eu=this.R_(r),this.sl=this.P_(r),this.il=this.y_(r),this.ju=this.g_(r,!n.synchronizeTabs),this.rl.ja=function(t){return ih(e.ju,t,1)},this.sl.nu.V_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ar("SyncEngine","User change. New user:",o.R()),[4,Qa(n.Zc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).wl.forEach(function(t){t.forEach(function(t){t.reject(new wr(mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.wl.clear(),n.rl.Ph(o,r.ua,r.ha),[4,lh(n,r.aa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.ju),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ru.delete(2),[4,vc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ru.add(2),[4,gc(e)]);case 3:t.sent(),e.uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.sl,this.ju.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ch.prototype.y_=function(t){return new Pc},Ch.prototype.R_=function(t){var e=Ua(t.n_.T),n=(n=t.n_,new Oh(n));return t=t.credentials,new cc(t,n,e)},Ch.prototype.P_=function(t){var e=this;return new rc(this.Zc,this.eu,t.Ei,function(t){return ih(e.ju,t,0)},t=new(Rh.Hs()?Rh:Lh))},Ch.prototype.g_=function(t,e){return n=this.Zc,r=this.sl,i=this.il,o=this.rl,s=t.I_,t=t.ol,e=e,t=new Yc(n,r,i,o,s,t),e&&(t.Tl=!0),t;var n,r,i,o,s},Ch.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ar("RemoteStore","RemoteStore shutting down."),e.ru.add(5),[4,gc(e)];case 1:return t.sent(),e.cu.Ac(),e.uu.set("Unknown"),[2]}})})}(this.sl)},Ch),kh=(Ph.prototype.next=function(t){this.observer.next&&this.p_(this.observer.next,t)},Ph.prototype.error=function(t){this.observer.error?this.p_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ph.prototype.b_=function(){this.muted=!0},Ph.prototype.p_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ph);function Ph(t){this.observer=t,this.muted=!1}function Ch(){}function Vh(){this.synchronizeTabs=!1}function xh(){}function Uh(){var t=this;this.a_=function(){return t.u_()},this.h_=function(){return t.l_()},this.__=[],this.f_()}function Mh(t){var e=this;return(e=dh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function jh(t){this.n_=t,this.T=t.T;var e=t.ssl?"https":"http";this.s_=e+"://"+t.host,this.i_="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function qh(t){this.zl=t.zl,this.Hl=t.Hl}function Fh(t){this.persistence=t,this.Ql=new jc,this.Kl=null}function Bh(t){var e=this;return(e=yh.call(this)||this).qo=t,e}function Gh(t,e){var n=this;this.$l={},this.Ko=new oa(0),this.Wo=!1,this.Wo=!0,this.Nr=t(this),this.Zo=new bh(this),this.us=new La,this.os=(t=this.us,new mh(t,function(t){return n.Nr.Ll(t)})),this.serializer=new Ia(e),this.tc=new Eh(this.serializer)}function zh(t){this.serializer=t,this.kl=new Map,this.Ml=new Map}function Hh(t){this.persistence=t,this.xl=new ea(_i,Ti),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.Nl=0,this.Fl=new jc,this.targetCount=0,this.Ol=Sa.Io()}function Kh(t){var e=this;return(e=vh.call(this)||this).uo=t,e}function Wh(t,e){this.us=t,this.Dl=e,this.docs=new Si(ui.K),this.size=0}function Yh(t,e){this.us=t,this.Nr=e,this.cs=[],this.gl=1,this.Vl=new Mi(qc.Cu)}function Xh(t,e,n){if(!n)throw new wr(mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Qh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new wr(mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function $h(t,e,n,r){if(!0===e&&!0===r)throw new wr(mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Zh(t){if(!ui.lt(t))throw new wr(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Jh(t){if(ui.lt(t))throw new wr(mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function tf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ef(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new wr(mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=tf(t),new wr(mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function nf(t,e){if(e<=0)throw new wr(mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var rf,of=function(t){this._methodName=t},sf=(f(uf,rf=of),uf.prototype.v_=function(t){if(2!==t.S_)throw 1===t.S_?t.D_(this._methodName+"() can only appear at the top level of your update data"):t.D_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.sn.push(t.path),null},uf.prototype.isEqual=function(t){return t instanceof uf},uf);function uf(){return null!==rf&&rf.apply(this,arguments)||this}function af(t,e,n){return new Yl({S_:3,C_:e.settings.C_,methodName:t._methodName,x_:n},e.T,e.serializer,e.ignoreUndefinedProperties)}var cf,hf,ff,lf,pf,df,yf=(f(xf,df=of),xf.prototype.v_=function(t){return new _s(t.path,new as)},xf.prototype.isEqual=function(t){return t instanceof xf},xf),vf=(f(Vf,pf=of),Vf.prototype.v_=function(t){var e=af(this,t,!0),n=this.N_.map(function(t){return np(t,e)}),n=new cs(n);return new _s(t.path,n)},Vf.prototype.isEqual=function(t){return this===t},Vf),gf=(f(Cf,lf=of),Cf.prototype.v_=function(t){var e=af(this,t,!0),n=this.N_.map(function(t){return np(t,e)}),n=new ds(n);return new _s(t.path,n)},Cf.prototype.isEqual=function(t){return this===t},Cf),mf=(f(Pf,ff=of),Pf.prototype.v_=function(t){var e=new ms(t.serializer,qo(t.serializer,this.F_));return new _s(t.path,e)},Pf.prototype.isEqual=function(t){return this===t},Pf),wf=(Object.defineProperty(kf.prototype,"latitude",{get:function(){return this.O_},enumerable:!1,configurable:!0}),Object.defineProperty(kf.prototype,"longitude",{get:function(){return this.k_},enumerable:!1,configurable:!0}),kf.prototype.isEqual=function(t){return this.O_===t.O_&&this.k_===t.k_},kf.prototype.toJSON=function(){return{latitude:this.O_,longitude:this.k_}},kf.prototype.$=function(t){return kr(this.O_,t.O_)||kr(this.k_,t.k_)},kf),bf=new Map,Ef=(Sf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Sf),_f=(Object.defineProperty(Df.prototype,"app",{get:function(){if(!this.Q_)throw new wr(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"K_",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"W_",{get:function(){return void 0!==this.j_},enumerable:!1,configurable:!0}),Df.prototype.G_=function(t){if(this.B_)throw new wr(mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.L_=new Ef(t),void 0!==t.credentials&&(this.U_=function(t){if(!t)return new Zr;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ei(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new wr(mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Df.prototype.z_=function(){return this.L_},Df.prototype.H_=function(){return this.B_=!0,this.L_},Df.prototype._delete=function(){return this.j_||(this.j_=this.J_()),this.j_},Df.prototype.J_=function(){return(t=bf.get(this))&&(Ar("ComponentProvider","Removing Datastore"),bf.delete(this),t.terminate()),Promise.resolve();var t},Df),o=(Lf.prototype.Y_=function(t,e){switch(void 0===e&&(e="none"),bo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Oo(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t,e);case 5:return t.stringValue;case 6:return this.tf(Ro(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue,e);case 10:return this.rf(t.mapValue,e);default:throw Rr()}},Lf.prototype.rf=function(t,n){var r=this,i={};return yo(t.fields||{},function(t,e){i[t]=r.Y_(e,n)}),i},Lf.prototype.nf=function(t){return new wf(Oo(t.latitude),Oo(t.longitude))},Lf.prototype.sf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Y_(t,e)})},Lf.prototype.Z_=function(t,e){switch(e){case"previous":var n=function t(e){return go(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Y_(n,e);case"estimate":return this.X_(mo(t));default:return null}},Lf.prototype.X_=function(t){return t=No(t),new ni(t.seconds,t.nanos)},Lf.prototype.cf=function(t,e){var n=ii.nt(t);return Lr(is(n)),t=new zr(n.get(1),n.get(3)),n=new ui(n.j(5)),t.isEqual(e)||Ir("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Lf),Tf=(f(Rf,hf=o),Rf.prototype.tf=function(t){return new Br(new xr(t))},Rf.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),Kp.af(t,this.firestore,null)},Rf),Af=(Object.defineProperty(Of.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"ref",{get:function(){return new sl(this.uf,this.ff,this.lf)},enumerable:!1,configurable:!0}),Of.prototype.exists=function(){return null!==this._f},Of.prototype.data=function(){if(this._f){if(this.ff){var t=new If(this.uf,this.hf,this.lf,this._f,null);return this.ff.fromFirestore(t)}return this.hf.Y_(this._f.mn())}},Of.prototype.get=function(t){if(this._f&&null!==(t=this._f.data().field(Uf("DocumentSnapshot.get",t))))return this.hf.Y_(t)},Of),If=(f(Nf,cf=Af),Nf.prototype.data=function(){return cf.prototype.data.call(this)},Nf);function Nf(){return null!==cf&&cf.apply(this,arguments)||this}function Of(t,e,n,r,i){this.uf=t,this.hf=e,this.lf=n,this._f=r,this.ff=i}function Rf(t){var e=this;return(e=hf.call(this)||this).firestore=t,e}function Lf(){}function Df(t,e){this.M_="(lite)",this.L_=new Ef({}),this.B_=!1,t instanceof zr?(this.q_=t,this.U_=new Zr):(this.Q_=t,this.q_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new wr(mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zr(t.options.projectId)}(t),this.U_=new Jr(e))}function Sf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new wr(mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new wr(mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,$h("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function kf(t,e){if(!isFinite(t)||t<-90||90<t)throw new wr(mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new wr(mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O_=t,this.k_=e}function Pf(t,e){var n=this;return(n=ff.call(this,t)||this).F_=e,n}function Cf(t,e){var n=this;return(n=lf.call(this,t)||this).N_=e,n}function Vf(t,e){var n=this;return(n=pf.call(this,t)||this).N_=e,n}function xf(){return null!==df&&df.apply(this,arguments)||this}function Uf(t,e){return"string"==typeof e?ap(t,e):(e instanceof Ur?e._:e).df}var Mf,jf=(Bf.prototype.isEqual=function(t){return this.df.isEqual(t.df)},Bf),qf=(f(Ff,Mf=_f),Ff.prototype.J_=function(){return this.Ef||qp(this),this.Ef.terminate()},Ff);function Ff(t,e){var n=this;return(n=Mf.call(this,t,e)||this).wf=new Ea,n.M_="name"in t?t.name:"[DEFAULT]",n}function Bf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new wr(mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.df=new si(t)}var Gf,zf,Hf=(f(Qf,zf=Af),Qf.prototype.exists=function(){return zf.prototype.exists.call(this)},Qf.prototype.data=function(t){if(void 0===t&&(t={}),this._f){if(this.ff){var e=new Kf(this.uf,this.hf,this.lf,this._f,this.metadata,null);return this.ff.fromFirestore(e,t)}return this.hf.Y_(this._f.mn(),t.serverTimestamps)}},Qf.prototype.get=function(t,e){if(void 0===e&&(e={}),this._f&&null!==(t=this._f.data().field(Uf("DocumentSnapshot.get",t))))return this.hf.Y_(t,e.serverTimestamps)},Qf),Kf=(f(Xf,Gf=Hf),Xf.prototype.data=function(t){return void 0===t&&(t={}),Gf.prototype.data.call(this,t)},Xf),Wf=(Object.defineProperty(Yf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Yf.prototype,"size",{get:function(){return this.mf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Yf.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Yf.prototype.forEach=function(e,n){var r=this;this.mf.docs.forEach(function(t){e.call(n,new Kf(r.uf,r.hf,t.key,t,new od(r.mf.se.has(t.key),r.mf.fromCache),r.query.ff))})},Yf.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.mf.re)throw new wr(mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.If&&this.Af===t||(this.If=function(i,e){if(i.mf.ne.Y()){var n=0;return i.mf.docChanges.map(function(t){var e=new Kf(i.uf,i.hf,t.doc.key,t.doc,new od(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.mf.ne;return i.mf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Kf(i.uf,i.hf,t.doc.key,t.doc,new od(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Af=t),this.If},Yf);function Yf(t,e,n,r){this.uf=t,this.hf=e,this.mf=r,this.metadata=new od(r.hasPendingWrites,r.fromCache),this.query=n}function Xf(){return null!==Gf&&Gf.apply(this,arguments)||this}function Qf(t,e,n,r,i,o){var s=this;return(s=zf.call(this,t,e,n,r,o)||this).uf=t,s.Tf=t,s.metadata=i,s}function $f(t,e){return t instanceof Hf&&e instanceof Hf?t.uf===e.uf&&t.lf.isEqual(e.lf)&&(null===t._f?null===e._f:t._f.isEqual(e._f))&&t.ff===e.ff:t instanceof Wf&&e instanceof Wf&&t.uf===e.uf&&ql(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.mf.isEqual(e.mf)}function Zf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Jf,tl=(f(el,Jf=o),el.prototype.tf=function(t){return new xr(t)},el.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),new sl(this.firestore,null,t)},el);function el(t){var e=this;return(e=Jf.call(this)||this).firestore=t,e}function nl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=ef(t,sl);var o=ef(t.firestore,qf),s=Fl(o);return e instanceof Ur&&(e=e._),il(o,("string"==typeof e||e instanceof jf?tp(s,"updateDoc",t.lf,e,n,r):Jl(s,"updateDoc",t.lf,e)).Pf(t.lf,Ns.exists(!0)))}function rl(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Ur&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Zf(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Zf(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof sl?(u=ef(e.firestore,qf),a=cu(e.lf.path),h={next:function(t){n[i]&&n[i](ol(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=ef(e,ul),u=ef(s.firestore,qf),a=s.Rf,c=new tl(u),h={next:function(t){n[i]&&n[i](new Wf(u,c,s,t))},error:n[i+1],complete:n[i+2]},Dl(e.Rf)),function(n,t,e){var r=this,i=new kh(h),o=new Mc(t,i,e);return n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Vc,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.b_(),n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xc,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(jp(u),a,f)}function il(t,e){return function(n,r){var t=this,i=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=nh,[4,_p(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(jp(t),e)}function ol(t,e,n){var r=n.docs.get(e.lf),i=new tl(t);return new Hf(t,i,e.lf,r,new od(n.hasPendingWrites,n.fromCache),e.ff)}var sl=(Object.defineProperty(cl.prototype,"yf",{get:function(){return this.lf.path},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"path",{get:function(){return this.lf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"parent",{get:function(){return new kl(this.firestore,this.ff,this.lf.path.G())},enumerable:!1,configurable:!0}),cl.prototype.withConverter=function(t){return new cl(this.firestore,t,this.lf)},cl),ul=(al.prototype.withConverter=function(t){return new al(this.firestore,t,this.Rf)},al);function al(t,e,n){this.ff=e,this.Rf=n,this.type="query",this.firestore=t}function cl(t,e,n){this.ff=e,this.lf=n,this.type="document",this.firestore=t}function hl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].gf(t);return t}var fl,ll,pl,dl,yl,vl=(f(Il,yl=ge=function(){}),Il.prototype.gf=function(t){var e=Fl(t.firestore),e=function(t,e,n,r,i,o){if(r.rt()){if("array-contains"===i||"array-contains-any"===i)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Rl(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Ol(n,t,c))}h={arrayValue:{values:s}}}else h=Ol(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Rl(o,i),h=ep(e,"where",o,"in"===i||"not-in"===i);var h=Au.create(r,i,h);return function(t,e){if(e.Pn()){var n=pu(t);if(null!==n&&!n.isEqual(e.field))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=lu(t))&&Ll(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new wr(mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new wr(mr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.Rf,e,t.firestore.q_,this.Vf,this.pf,this.bf);return new ul(t.firestore,t.ff,(e=(t=t.Rf).filters.concat([e]),new ou(t.path,t.collectionGroup,t.In.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Il),gl=(f(Al,dl=ge),Al.prototype.gf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Zu(e,n);return e=r,null!==lu(n=t)||null!==(t=pu(n))&&Ll(0,t,e.field),r}(t.Rf,this.Vf,this.vf);return new ul(t.firestore,t.ff,(e=(t=t.Rf).In.concat([e]),new ou(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Al),ml=(f(Tl,pl=ge),Tl.prototype.gf=function(t){return new ul(t.firestore,t.ff,gu(t.Rf,this.Sf,this.Df))},Tl),wl=(f(_l,ll=ge),_l.prototype.gf=function(t){var e=Nl(t,this.type,this.Cf,this.xf);return new ul(t.firestore,t.ff,(t=t.Rf,new ou(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},_l),bl=(f(El,fl=ge),El.prototype.gf=function(t){var e=Nl(t,this.type,this.Cf,this.xf);return new ul(t.firestore,t.ff,(t=t.Rf,new ou(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},El);function El(t,e,n){var r=this;return(r=fl.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function _l(t,e,n){var r=this;return(r=ll.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function Tl(t,e,n){var r=this;return(r=pl.call(this)||this).type=t,r.Sf=e,r.Df=n,r}function Al(t,e){var n=this;return(n=dl.call(this)||this).Vf=t,n.vf=e,n.type="orderBy",n}function Il(t,e,n){var r=this;return(r=yl.call(this)||this).Vf=t,r.pf=e,r.bf=n,r.type="where",r}function Nl(t,c,e,n){if(e[0]instanceof Ur&&(e[0]=e[0]._),e[0]instanceof Af)return function(t,e,n,r){if(!n)throw new wr(mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.rt())i.push(Lo(e,n.key));else{var a=n.field(u.field);if(go(a))throw new wr(mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.et(),new wr(mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new zu(i,r)}(t.Rf,t.firestore.q_,e[0]._f,n);var r=Fl(t.firestore);return function(t,e,n,r,i,o){var s=t.In;if(i.length>s.length)throw new wr(mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.rt()){if("string"!=typeof c)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!du(t)&&-1!==c.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.nt(c));if(!ui.lt(h))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ui(h),u.push(Lo(e,h))}else c=ep(n,r,c),u.push(c)}return new zu(u,o)}(t.Rf,t.firestore.q_,r,c,e,n)}function Ol(t,e,n){if(n instanceof Ur&&(n=n._),"string"==typeof n){if(""===n)throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ii.nt(n)),!ui.lt(e))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Lo(t,new ui(e))}if(n instanceof sl)return Lo(t,n.lf);throw new wr(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tf(n)+".")}function Rl(t,e){if(!Array.isArray(t)||0===t.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new wr(mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ll(t,e,n){if(!n.isEqual(e))throw new wr(mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Dl(t){if(fu(t)&&0===t.In.length)throw new wr(mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sl,kl=(f(Pl,Sl=ul),Object.defineProperty(Pl.prototype,"id",{get:function(){return this.Rf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"path",{get:function(){return this.Rf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"parent",{get:function(){var t=this.yf.G();return t.Y()?null:new sl(this.firestore,null,new ui(t))},enumerable:!1,configurable:!0}),Pl.prototype.withConverter=function(t){return new Pl(this.firestore,t,this.yf)},Pl);function Pl(t,e,n){var r=this;return(r=Sl.call(this,t,e,cu(n))||this).firestore=t,r.yf=n,r.type="collection",r}function Cl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),Xh("collection","path",e),t instanceof _f)return Jh(n=ii.nt.apply(ii,l([e],r))),new kl(t,null,n);if(!(t instanceof sl||t instanceof kl))throw new wr(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Jh(n=ii.nt.apply(ii,l([t.path],r)).child(ii.nt(e))),new kl(t.firestore,null,n)}function Vl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),1===arguments.length&&(e=Dr.t()),Xh("doc","path",e),t instanceof _f)return Zh(n=ii.nt.apply(ii,l([e],r))),new sl(t,null,new ui(n));if(!(t instanceof sl||t instanceof kl))throw new wr(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Zh(n=t.yf.child(ii.nt.apply(ii,l([e],r)))),new sl(t.firestore,t instanceof kl?t.ff:null,new ui(n))}var xl,Ul=(f(Ml,xl=o),Ml.prototype.tf=function(t){return new xr(t)},Ml.prototype.ef=function(t){return t=this.cf(t,this.firestore.q_),new sl(this.firestore,null,t)},Ml);function Ml(t){var e=this;return(e=xl.call(this)||this).firestore=t,e}function jl(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),(t instanceof sl||t instanceof kl)&&(e instanceof sl||e instanceof kl)&&t.firestore===e.firestore&&t.path===e.path&&t.ff===e.ff}function ql(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),t instanceof ul&&e instanceof ul&&t.firestore===e.firestore&&mu(t.Rf,e.Rf)&&t.ff===e.ff}function Fl(t){var e=t.H_(),n=Ua(t.q_);return new Xl(t.q_,!!e.ignoreUndefinedProperties,n)}var Bl=/^__.*__$/,Gl=(Kl.prototype.Pf=function(t,e){var n=[];return null!==this.sn?n.push(new Vs(t,this.data,this.sn,e)):n.push(new Cs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},Kl),zl=(Hl.prototype.Pf=function(t,e){return e=[new Vs(t,this.data,this.sn,e)],0<this.fieldTransforms.length&&e.push(new qs(t,this.fieldTransforms)),e},Hl);function Hl(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Kl(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Wl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Yl=(Object.defineProperty($l.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty($l.prototype,"S_",{get:function(){return this.settings.S_},enumerable:!1,configurable:!0}),$l.prototype.Ff=function(t){return new $l(Object.assign(Object.assign({},this.settings),t),this.T,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.sn)},$l.prototype.Of=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Ff({path:e,x_:!1})).kf(t),e},$l.prototype.Mf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Ff({path:t,x_:!1})).Nf(),t},$l.prototype.$f=function(t){return this.Ff({path:void 0,x_:!0})},$l.prototype.D_=function(t){return cp(t,this.settings.methodName,this.settings.Lf||!1,this.path,this.settings.C_)},$l.prototype.contains=function(e){return void 0!==this.sn.find(function(t){return e.X(t)})||void 0!==this.fieldTransforms.find(function(t){return e.X(t.field)})},$l.prototype.Nf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kf(this.path.get(t))},$l.prototype.kf=function(t){if(0===t.length)throw this.D_("Document fields must not be empty");if(Wl(this.S_)&&Bl.test(t))throw this.D_('Document fields cannot begin and end with "__"')},$l),Xl=(Ql.prototype.Bf=function(t,e,n,r){return void 0===r&&(r=!1),new Yl({S_:t,methodName:e,C_:n,path:si.st(),x_:!1,Lf:r},this.T,this.serializer,this.ignoreUndefinedProperties)},Ql);function Ql(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ua(t)}function $l(t,e,n,r,i,o){this.settings=t,this.T=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nf(),this.fieldTransforms=i||[],this.sn=o||[]}function Zl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bf(o.merge||o.mergeFields?2:0,e,n,i);op("Data must be an object, but it was:",s,r);var u,a,r=rp(r,s);if(o.merge)u=new Ts(s.sn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=sp(e,f[h],n);if(!s.contains(l))throw new wr(mr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");hp(c,l)||c.push(l)}u=new Ts(c),a=s.fieldTransforms.filter(function(t){return u.hn(t.field)})}else u=null,a=s.fieldTransforms;return new Gl(new Ws(r),u,a)}function Jl(t,r,i,e){var o=t.Bf(1,r,i);op("Data must be an object, but it was:",o,e);var s=[],u=new Ys;return yo(e,function(t,e){var n=ap(r,t,i);e instanceof Ur&&(e=e._),t=o.Mf(n),e instanceof sf?s.push(n):null!=(t=np(e,t))&&(s.push(n),u.set(n,t))}),e=new Ts(s),new zl(u._n(),e,o.fieldTransforms)}function tp(t,e,n,r,i,o){var s=t.Bf(1,e,n),u=[sp(e,r,n)],a=[i];if(o.length%2!=0)throw new wr(mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(sp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Ys,y=u.length-1;0<=y;--y)hp(p,u[y])||(h=u[y],(f=a[y])instanceof Ur&&(f=f._),l=s.Mf(h),f instanceof sf?p.push(h):null!=(l=np(f,l))&&(p.push(h),d.set(h,l)));return i=new Ts(p),new zl(d._n(),i,s.fieldTransforms)}function ep(t,e,n,r){return void 0===r&&(r=!1),np(n,t.Bf(r?4:3,e))}function np(s,t){if(s instanceof Ur&&(s=s._),ip(s))return op("Unsupported field value:",t,s),rp(s,t);if(s instanceof of)return function(t,e){if(!Wl(e.S_))throw e.D_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.D_(t._methodName+"() is not currently supported inside arrays");(t=t.v_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.sn.push(t.path),s instanceof Array){if(t.settings.x_&&4!==t.S_)throw t.D_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=np(i[r],t.$f(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Ur&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return qo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:Fo(e.serializer,n)}}if(t instanceof ni)return n=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fo(e.serializer,n)};if(t instanceof wf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xr)return{bytesValue:Bo(e.serializer,t.l)};if(t instanceof sl){n=e.T;var r=t.firestore.q_;if(!r.isEqual(n))throw e.D_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:zo(t.firestore.q_||e.T,t.lf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.D_("Unsupported field value: "+tf(t))}(s,t)}function rp(t,n){var r={};return vo(t)?n.path&&0<n.path.length&&n.sn.push(n.path):yo(t,function(t,e){null!=(e=np(e,n.Of(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function ip(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof wf||t instanceof xr||t instanceof sl||t instanceof of)}function op(t,e,n){if(!ip(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=tf(n))?e.D_(t+" a custom object"):e.D_(t+" "+n);var r}function sp(t,e,n){if(e instanceof Ur&&(e=e._),e instanceof jf)return e.df;if("string"==typeof e)return ap(t,e);throw cp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var up=new RegExp("[~\\*/\\[\\]]");function ap(e,n,r){if(0<=n.search(up))throw cp("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(jf.bind.apply(jf,l([void 0],n.split("."))))).df}catch(t){throw cp("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function cp(t,e,n,r,i){var o=r&&!r.Y(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new wr(mr.INVALID_ARGUMENT,(e+=". ")+t+n)}function hp(t,e){return t.some(function(t){return t.isEqual(e)})}var fp=(vp.prototype.Wf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),0<this.mutations.length)throw new wr(mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Xo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Ko(r.serializer,t)})},[4,r.Wa("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Wo(t,e.found.name),t=Go(e.found.updateTime),e=new Ws({mapValue:{fields:e.found.fields}});return new nu(n,t,e,{})}(n,t):"missing"in t?(e=n,Lr(!!(n=t).missing),Lr(!!n.readTime),e=Wo(e,n.missing),n=Go(n.readTime),new ru(e,n)):Rr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Lr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ru||t instanceof nu?n.Gf(t):Rr()}),e)]}})})},vp.prototype.set=function(t,e){this.write(e.Pf(t,this.cn(t))),this.Kf.add(t.toString())},vp.prototype.update=function(t,e){try{this.write(e.Pf(t,this.zf(t)))}catch(t){this.Qf=t}this.Kf.add(t.toString())},vp.prototype.delete=function(t){this.write([new Hs(t,this.cn(t))]),this.Kf.add(t.toString())},vp.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),this.Qf)throw this.Qf;return e=this.qf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui.at(e),n.mutations.push(new Ks(e,n.cn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Xo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Zo(e.serializer,t)})},[4,e.Ka("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.Uf=!0,[2]}})})},vp.prototype.Gf=function(t){var e;if(t instanceof nu)e=t.version;else{if(!(t instanceof ru))throw Rr();e=ri.min()}var n=this.qf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new wr(mr.ABORTED,"Document version changed between two reads.")}else this.qf.set(t.key.toString(),e)},vp.prototype.cn=function(t){var e=this.qf.get(t.toString());return!this.Kf.has(t.toString())&&e?Ns.updateTime(e):Ns.an()},vp.prototype.zf=function(t){var e=this.qf.get(t.toString());if(this.Kf.has(t.toString())||!e)return Ns.exists(!0);if(e.isEqual(ri.min()))throw new wr(mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ns.updateTime(e)},vp.prototype.write=function(t){this.jf(),this.mutations=this.mutations.concat(t)},vp.prototype.jf=function(){},vp),lp=(yp.prototype.run=function(){this.Jf()},yp.prototype.Jf=function(){var t=this;this.Ci.Us(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new fp(this.eu),(n=this.Yf(e))&&n.then(function(t){r.Ei.yi(function(){return e.commit().then(function(){r.Ii.resolve(t)}).catch(function(t){r.Xf(t)})})}).catch(function(t){r.Xf(t)}),[2]})})})},yp.prototype.Yf=function(t){try{var e=this.updateFunction(t);return!mi(e)&&e.catch&&e.then?e:(this.Ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ii.reject(t),null}},yp.prototype.Xf=function(t){var e=this;0<this.Hf&&this.Zf(t)?(--this.Hf,this.Ei.yi(function(){return e.Jf(),Promise.resolve()})):this.Ii.reject(t)},yp.prototype.Zf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Li(t))},yp),pp=(dp.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{Ei:this.Ei,n_:this.n_,clientId:this.clientId,credentials:this.credentials,I_:this.user,ol:100})]}})})},dp.prototype.ed=function(t){var e=this;this.td=t,this.N.promise.then(function(){return e.td(e.user)})},dp.prototype.nd=function(){if(this.Ei.Ni)throw new wr(mr.FAILED_PRECONDITION,"The client has already been terminated.")},dp.prototype.terminate=function(){var t=this;this.Ei.Mi();var n=new ya;return this.Ei.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sd?[4,this.sd.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rd?[4,this.rd.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=Aa(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},dp);function dp(t,e,n){var r=this;this.credentials=t,this.Ei=e,this.n_=n,this.user=Hr.UNAUTHENTICATED,this.clientId=Dr.t(),this.td=function(){},this.N=new ya,this.credentials.S(function(t){Ar("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.td(t)),r.N.resolve()})}function yp(t,e,n,r){this.Ei=t,this.eu=e,this.updateFunction=n,this.Ii=r,this.Hf=5,this.Ci=new va(this.Ei,"transaction_retry")}function vp(t){this.eu=t,this.qf=new Map,this.mutations=[],this.Uf=!1,this.Qf=null,this.Kf=new Set}function gp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rd?[3,2]:(Ar("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),Ar("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ed(function(e){return r.Ei.$i(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Qa(i.Zc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.cc(function(){return r.terminate()}),r.rd=i,[2]}})})}(e,new Dh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rd]}})})}function mp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sd?[3,2]:(Ar("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),[4,gp(r)];case 1:return e=t.sent(),Ar("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ed(function(t){return r.Ei.$i(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ei.qi(),Ar("RemoteStore","RemoteStore received new credentials"),n=Ac(e),e.ru.add(3),[4,gc(e)];case 1:return t.sent(),n&&e.uu.set("Unknown"),[4,e.nu.V_(i)];case 2:return t.sent(),e.ru.delete(3),[4,vc(e)];case 3:return t.sent(),[2]}})})}(i.sl,t)})}),r.sd=i,[2]}})})}(e,new Sh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sd]}})})}function wp(t){return gp(t).then(function(t){return t.persistence})}function bp(t){return gp(t).then(function(t){return t.Zc})}function Ep(t){return mp(t).then(function(t){return t.sl})}function _p(t){return mp(t).then(function(t){return t.ju})}function Tp(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,mp(r)];case 1:return e=t.sent(),[2,((n=e.il).Iu=function(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).sl.nu._u=rh.bind(null,e),e.sl.nu.tn=function(t,e){var n=t;if((t=n._l.get(e))&&t.nl)return Ki().add(t.key);var r=Ki();if(!(e=n.ul.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.al.get(s),r=r.Ht(s.view.jh);return r}.bind(null,e),e.sl.nu.lu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).rl.Ah(s,"rejected",u),i=e._l.get(s),(n=i&&i.key)?(r=(r=new Si(ui.K)).At(n,new ru(n,ri.min())),i=Ki().add(n),i=new $i(ri.min(),new Map,new Mi(kr),r,i),[4,rh(e,i)]):[3,2];case 1:return t.sent(),e.ll=e.ll.remove(n),e._l.delete(s),fh(e),[3,4];case 2:return[4,tc(e.Zc,s,!1).then(function(){return ah(e,s,u)}).catch(nc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.cl.Na=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ru(s)&&(r=!0);u.Tu=s}}r&&Uc(n)}.bind(null,e.il),e.cl.Al=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.il),(s=(n=e).al.get(a))?(r=s.targetId,n.rl.wh(r),i=s.view.el(),[3,4]):[3,1];case 1:return[4,Ja(n.Zc,vu(a))];case 2:return o=t.sent(),s=n.rl.wh(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Il=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Gh(o)).Dr?[4,ec(r.Zc,i.query,!1).then(function(t){return t=t.documents,i.view.Gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.ce.get(i.targetId),n=i.view.es(e,r.ml,n),[2,(hh(r,i.targetId,n.Xh),n.snapshot)]}})})}(i,t,e,n)},[4,ec(i.Zc,o,!0)];case 1:return n=t.sent(),r=new Hc(o,n.la),e=r.Gh(n.documents),n=Zi._e(s,u&&"Offline"!==i.onlineState),n=r.es(e,i.ml,n),hh(i,s,n.Xh),r=new Kc(o,s,r),[2,(i.al.set(o,r),i.ul.has(s)?i.ul.get(s).push(o):i.ul.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.ml&&mc(n.sl,o),t.label=4;case 4:return[2,i]}var e})})}.bind(null,e.ju),n.Pu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).al.get(o),1<(r=e.ul.get(n.targetId)).length?[2,(e.ul.set(n.targetId,r.filter(function(t){return!mu(t,o)})),void e.al.delete(o))]:e.ml?(e.rl.Th(n.targetId),e.rl.hh(n.targetId)?[3,2]:[4,tc(e.Zc,n.targetId,!1).then(function(){e.rl.Ih(n.targetId),wc(e.sl,n.targetId),ah(e,n.targetId)}).catch(nc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ah(e,n.targetId),[4,tc(e.Zc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ju),n)]}})})}function Ap(n,r,i){var t=this;void 0===i&&(i={});var o=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new kh({next:function(t){r.yi(function(){return xc(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new wr(mr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new wr(mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Mc(cu(i.path),t,{includeMetadataChanges:!0,Su:!0});return Vc(n,u)},[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}function Ip(n,r,i){var t=this;void 0===i&&(i={});var o=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new kh({next:function(t){n.yi(function(){return xc(e,s)}),t.fromCache&&"server"===r.source?i.reject(new wr(mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Mc(t,o,{includeMetadataChanges:!0,Su:!0});return Vc(e,s)},[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}var Np=(Op.prototype.set=function(t,e,n){return this.ld(),e=bd((t=Rp(t,this.uf)).ff,e,n),n=Zl(this.hd,"WriteBatch.set",t.lf,e,null!==t.ff,n),this.ad=this.ad.concat(n.Pf(t.lf,Ns.an())),this},Op.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.ld(),t=Rp(t,this.uf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof jf?tp(this.hd,"WriteBatch.update",t.lf,e,n,r):Jl(this.hd,"WriteBatch.update",t.lf,e),this.ad=this.ad.concat(e.Pf(t.lf,Ns.exists(!0))),this},Op.prototype.delete=function(t){return this.ld(),t=Rp(t,this.uf),this.ad=this.ad.concat(new Hs(t.lf,Ns.an())),this},Op.prototype.commit=function(){return this.ld(),this.ud=!0,0<this.ad.length?this.od(this.ad):Promise.resolve()},Op.prototype.ld=function(){if(this.ud)throw new wr(mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Op);function Op(t,e){this.uf=t,this.od=e,this.ad=[],this.ud=!1,this.hd=Fl(t)}function Rp(t,e){if(t instanceof Ur&&(t=t._),t.firestore!==e)throw new wr(mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Lp,Dp,Sp=(Mp.prototype.get=function(t){var e=this,n=Rp(t,this.uf),r=new Ul(this.uf);return this._d.Wf([n.lf]).then(function(t){if(!t||1!==t.length)return Rr();if((t=t[0])instanceof ru)return new Af(e.uf,r,n.lf,null,n.ff);if(t instanceof nu)return new Af(e.uf,r,t.key,t,n.ff);throw Rr()})},Mp.prototype.set=function(t,e,n){return e=bd((t=Rp(t,this.uf)).ff,e,n),n=Zl(this.hd,"Transaction.set",t.lf,e,null!==t.ff,n),this._d.set(t.lf,n),this},Mp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Rp(t,this.uf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof jf?tp(this.hd,"Transaction.update",t.lf,e,n,r):Jl(this.hd,"Transaction.update",t.lf,e),this._d.update(t.lf,e),this},Mp.prototype.delete=function(t){return t=Rp(t,this.uf),this._d.delete(t.lf),this},f(Up,Dp=Mp),Up.prototype.get=function(t){var e=this,n=Rp(t,this.uf),r=new tl(this.uf);return Dp.prototype.get.call(this,t).then(function(t){return new Hf(e.uf,r,n.lf,t._f,new od(!1,!1),n.ff)})},Up),kp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Pp=(xp.prototype.enableIndexedDbPersistence=function(t,e){throw new wr(mr.FAILED_PRECONDITION,kp)},xp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new wr(mr.FAILED_PRECONDITION,kp)},xp.prototype.clearIndexedDbPersistence=function(t){throw new wr(mr.FAILED_PRECONDITION,kp)},xp),Cp=(f(Vp,Lp=Ur),Object.defineProperty(Vp.prototype,"q_",{get:function(){return this._.q_},enumerable:!1,configurable:!0}),Vp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.z_()),t)).merge,this._.G_(t)},Vp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.z_().host&&Nr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Vp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.ac(!0),(t=n).ru.delete(0),vc(t))]}})})})}(jp(ef(this._,qf)))},Vp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.ac(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(0),[4,gc(e)];case 1:return t.sent(),e.uu.set("Offline"),[2]}})})}(n))]}})})})}(jp(ef(this._,qf)))},Vp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&$h("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.fd.enableMultiTabIndexedDbPersistence(this):this.fd.enableIndexedDbPersistence(this,n)},Vp.prototype.clearPersistence=function(){return this.fd.clearIndexedDbPersistence(this)},Vp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Vp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=oh,[4,_p(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(jp(ef(this._,qf)))},Vp.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new kh(t);return n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.add(e),e.next()},[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.b_(),n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.delete(e)},[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(jp(ef(this._,qf)),Zf(t)?t:{next:t})},Object.defineProperty(Vp.prototype,"app",{get:function(){if(!this.dd)throw new wr(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!1,configurable:!0}),Vp.prototype.collection=function(t){try{return new fd(this,Cl(this._,t))}catch(t){throw Qp(t,"collection()","Firestore.collection()")}},Vp.prototype.doc=function(t){try{return new Kp(this,Vl(this._,t))}catch(t){throw Qp(t,"doc()","Firestore.doc()")}},Vp.prototype.collectionGroup=function(t){try{return new ad(this,function(t,e){if(t=ef(t,_f),Xh("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new wr(mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ul(t,null,new ou(ii.st(),e))}(this._,t))}catch(t){throw Qp(t,"collectionGroup()","Firestore.collectionGroup()")}},Vp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,mp(n).then(function(t){return t.eu})];case 1:return e=t.sent(),new lp(n.Ei,e,r,i).run(),[2]}})})}),i.promise}(jp(n=this._),function(t){return t=new Sp(n,t),e(new zp(r,t))})},Vp.prototype.batch=function(){var e=this;return jp(this._),new Hp(new Np(this._,function(t){return il(e._,t)}))},Vp.prototype.loadBundle=function(t){throw new wr(mr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Vp.prototype.namedQuery=function(t){throw new wr(mr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Vp);function Vp(t,e,n){var r=this;return(r=Lp.call(this,e)||this).fd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof zr||(r.dd=t),r}function xp(){}function Up(t,e){var n=this;return(n=Dp.call(this,t,e)||this).uf=t,n}function Mp(t,e){this.uf=t,this._d=e,this.hd=Fl(t)}function jp(t){return t.Ef||qp(t),t.Ef.nd(),t.Ef}function qp(t){var e,n,r=t.H_(),r=(e=t.q_,n=t.M_,new Gr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ef=new pp(t.U_,t.wf,r)}var Fp,Bp,Gp,zp=(f(Xp,Gp=Ur),Xp.prototype.get=function(t){var e=this,t=wd(t);return this._.get(t).then(function(t){return new sd(e.uf,t)})},Xp.prototype.set=function(t,e,n){return t=wd(t),n?(Qh("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Xp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},Xp.prototype.delete=function(t){return t=wd(t),this._.delete(t),this},Xp),Hp=(f(Yp,Bp=Ur),Yp.prototype.set=function(t,e,n){return t=wd(t),n?(Qh("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Yp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},Yp.prototype.delete=function(t){return t=wd(t),this._.delete(t),this},Yp.prototype.commit=function(){return this._.commit()},Yp),Kp=(f(Wp,Fp=Ur),Wp.wd=function(t,e,n){if(t.length%2!=0)throw new wr(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.et()+" has "+t.length);return new Wp(e,new sl(e._,n,new ui(t)))},Wp.af=function(t,e,n){return new Wp(e,new sl(e._,n,t))},Object.defineProperty(Wp.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"parent",{get:function(){return new fd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Wp.prototype.collection=function(t){try{return new fd(this.firestore,Cl(this._,t))}catch(t){throw Qp(t,"collection()","DocumentReference.collection()")}},Wp.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof sl&&jl(this._,t)},Wp.prototype.set=function(t,e){e=Qh("DocumentReference.set",e);try{return function(t,e,n){t=ef(t,sl);var r=ef(t.firestore,qf),e=bd(t.ff,e,n);return il(r,Zl(Fl(r),"setDoc",t.lf,e,null!==t.ff,n).Pf(t.lf,Ns.an()))}(this._,t,e)}catch(t){throw Qp(t,"setDoc()","DocumentReference.set()")}},Wp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?nl(this._,t):nl.apply(void 0,l([this._,t,e],n))}catch(t){throw Qp(t,"updateDoc()","DocumentReference.update()")}},Wp.prototype.delete=function(){return il(ef((t=this._).firestore,qf),[new Hs(t.lf,Ns.an())]);var t},Wp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=$p(t),i=Zp(t,function(t){return new sd(e.firestore,new Hf(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))});return rl(this._,r,i)},Wp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=ef(e,sl);var n=ef(e.firestore,qf),t=jp(n),r=new tl(n);return function(n,r){var t=this,i=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.sa.hs(t,e)}))];case 1:return(r=t.sent())instanceof nu?s.resolve(r):r instanceof ru?s.resolve(null):s.reject(new wr(mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Aa(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,bp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.lf).then(function(t){return new Hf(n,r,e.lf,t,new od(t instanceof nu&&t.ln,!0),e.ff)})}:"server"===(null==t?void 0:t.source)?function(e){e=ef(e,sl);var n=ef(e.firestore,qf);return Ap(jp(n),e.lf,{source:"server"}).then(function(t){return ol(n,e,t)})}:function(e){e=ef(e,sl);var n=ef(e.firestore,qf);return Ap(jp(n),e.lf).then(function(t){return ol(n,e,t)})})(this._).then(function(t){return new sd(e.firestore,new Hf(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))})},Wp.prototype.withConverter=function(t){return new Wp(this.firestore,this._.withConverter(t))},Wp);function Wp(t,e){var n=this;return(n=Fp.call(this,e)||this).firestore=t,n.hf=new Tf(t),n}function Yp(){return null!==Bp&&Bp.apply(this,arguments)||this}function Xp(t,e){var n=this;return(n=Gp.call(this,e)||this).uf=t,n}function Qp(t,e,n){return t.message=t.message.replace(e,n),t}function $p(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Zf(r))return r}return{}}function Zp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Zf(t[0])?t[0]:Zf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Jp,td,ed,nd,rd,id,od=(md.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},md),sd=(f(gd,id=Ur),Object.defineProperty(gd.prototype,"ref",{get:function(){return new Kp(this.uf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),gd.prototype.data=function(t){return this._.data(t)},gd.prototype.get=function(t,e){return this._.get(t,e)},gd.prototype.isEqual=function(t){return $f(this._,t._)},gd),ud=(f(vd,rd=sd),vd.prototype.data=function(t){return this._.data(t)},vd),ad=(f(yd,nd=Ur),yd.prototype.where=function(t,e,n){try{return new yd(this.firestore,hl(this._,(r=n,i=e,o=Uf("where",t),new vl(o,i,r))))}catch(t){throw Qp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},yd.prototype.orderBy=function(n,t){try{return new yd(this.firestore,hl(this._,function(t){void 0===t&&(t="asc");var e=t,t=Uf("orderBy",n);return new gl(t,e)}(t)))}catch(n){throw Qp(n,/(orderBy|where)\(\)/,"Query.$1()")}},yd.prototype.limit=function(t){try{return new yd(this.firestore,hl(this._,(nf("limit",e=t),new ml("limit",e,"F"))))}catch(t){throw Qp(t,"limit()","Query.limit()")}var e},yd.prototype.limitToLast=function(t){try{return new yd(this.firestore,hl(this._,(nf("limitToLast",e=t),new ml("limitToLast",e,"L"))))}catch(t){throw Qp(t,"limitToLast()","Query.limitToLast()")}var e},yd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,hl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wl("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Qp(t,"startAt()","Query.startAt()")}},yd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,hl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wl("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Qp(t,"startAfter()","Query.startAfter()")}},yd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,hl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Qp(t,"endBefore()","Query.endBefore()")}},yd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,hl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Qp(t,"endAt()","Query.endAt()")}},yd.prototype.isEqual=function(t){return ql(this._,t._)},yd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=ef(e,ul);var n=ef(e.firestore,qf),t=jp(n),r=new tl(n);return function(n,r){var t=this,i=new ya;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ec(r,i,!0)];case 1:return n=t.sent(),e=new Hc(i,n.la),n=e.Gh(n.documents),n=e.es(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Aa(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,bp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Rf).then(function(t){return new Wf(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=ef(e,ul);var n=ef(e.firestore,qf),t=jp(n),r=new tl(n);return Ip(t,e.Rf,{source:"server"}).then(function(t){return new Wf(n,r,e,t)})}:function(e){e=ef(e,ul);var n=ef(e.firestore,qf),t=jp(n),r=new tl(n);return Dl(e.Rf),Ip(t,e.Rf).then(function(t){return new Wf(n,r,e,t)})})(this._).then(function(t){return new hd(e.firestore,new Wf(e.firestore._,e.hf,e._,t.mf))})},yd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=$p(t),i=Zp(t,function(t){return new hd(e.firestore,new Wf(e.firestore._,e.hf,e._,t.mf))});return rl(this._,r,i)},yd.prototype.withConverter=function(t){return new yd(this.firestore,this._.withConverter(t))},yd),cd=(f(dd,ed=Ur),Object.defineProperty(dd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"doc",{get:function(){return new ud(this.uf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),dd),hd=(f(pd,td=Ur),Object.defineProperty(pd.prototype,"query",{get:function(){return new ad(this.uf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new ud(e.uf,t)})},enumerable:!1,configurable:!0}),pd.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new cd(e.uf,t)})},pd.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new ud(r.uf,t))})},pd.prototype.isEqual=function(t){return $f(this._,t._)},pd),fd=(f(ld,Jp=ad),Object.defineProperty(ld.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"parent",{get:function(){var t=this._.parent;return t?new Kp(this.firestore,t):null},enumerable:!1,configurable:!0}),ld.prototype.doc=function(t){try{return new Kp(this.firestore,void 0===t?Vl(this._):Vl(this._,t))}catch(t){throw Qp(t,"doc()","CollectionReference.doc()")}},ld.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=ef(r.firestore,qf),e=Vl(r),i=bd(r.ff,i),il(t,Zl(Fl(r.firestore),"addDoc",e.lf,i,null!==r.ff,{}).Pf(e.lf,Ns.exists(!1))).then(function(){return e}).then(function(t){return new Kp(n.firestore,t)})},ld.prototype.isEqual=function(t){return jl(this._,t._)},ld.prototype.withConverter=function(t){return new ld(this.firestore,this._.withConverter(t))},ld);function ld(t,e){var n=this;return(n=Jp.call(this,t,e)||this).firestore=t,n._=e,n}function pd(t,e){var n=this;return(n=td.call(this,e)||this).uf=t,n}function dd(t,e){var n=this;return(n=ed.call(this,e)||this).uf=t,n}function yd(t,e){var n=this;return(n=nd.call(this,e)||this).firestore=t,n.hf=new Tf(t),n}function vd(){return null!==rd&&rd.apply(this,arguments)||this}function gd(t,e){var n=this;return(n=id.call(this,e)||this).uf=t,n}function md(t,e){this.hasPendingWrites=t,this.fromCache=e}function wd(t){return t instanceof Ur&&(t=t._),ef(t,sl)}function bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ed,_d,ge=(f(Nd,_d=Ur),Nd.documentId=function(){return new Nd(si.ot().et())},Nd.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof jf&&this._.df.isEqual(t.df)},Nd),o=(f(Id,Ed=Ur),Id.serverTimestamp=function(){var t=new yf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Id(t)},Id.delete=function(){var t=new sf("deleteField");return t._methodName="FieldValue.delete",new Id(t)},Id.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Id(n)},Id.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Id(n)},Id.increment=function(t){return(t=new mf("increment",t))._methodName="FieldValue.increment",new Id(t)},Id.prototype.isEqual=function(t){return this._.isEqual(t._)},Id),Td=(Ad.prototype.onProgress=function(t,e,n){this.Ed={next:t,error:e,complete:n}},Ad.prototype.catch=function(t){return this.Td.promise.catch(t)},Ad.prototype.then=function(t,e){return this.Td.promise.then(t,e)},Ad.prototype.Rl=function(t){this.Pl(t),this.Ed.complete&&this.Ed.complete(),this.Td.resolve(t)},Ad.prototype.yl=function(t){this.md.taskState="Error",this.Ed.next&&this.Ed.next(this.md),this.Ed.error&&this.Ed.error(t),this.Td.reject(t)},Ad.prototype.Pl=function(t){this.md=t,this.Ed.next&&this.Ed.next(t)},Ad);function Ad(){this.Ed={},this.Td=new ya,this.md={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Id(){return null!==Ed&&Ed.apply(this,arguments)||this}function Nd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _d.call(this,new(jf.bind.apply(jf,l([void 0],t))))||this}Od.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Od.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Od.prototype.setServiceProps=function(t){return this.serviceProps=t,this},me=Od;function Od(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:Cp,GeoPoint:wf,Timestamp:ni,Blob:Br,Transaction:zp,WriteBatch:Hp,DocumentReference:Kp,DocumentSnapshot:sd,Query:ad,QueryDocumentSnapshot:ud,QuerySnapshot:hd,CollectionReference:fd,FieldPath:ge,FieldValue:o,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new me("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new Cp(e,new qf(e,t),new Pp)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.0.4-BundlePrerelease.f8bb4d8b7"),Cp.prototype.loadBundle=function(t){return s=t,t=new Td,function(n,t,r){var e,i=this,o=(e=s,t=Ua(t),e="string"==typeof e?(new TextEncoder).encode(e):e,new ja(xa(e),t));n.Ei.yi(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ph,[4,_p(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(jp(this._),this.q_,t),t;var s},Cp.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.tc.wo(t,e)})},[4,bp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(jp((e=this)._),t).then(function(t){return t?new ad(e,new ul(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});