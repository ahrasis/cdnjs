!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Wd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Wd);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(_e=u=u||{})[_e.DEBUG=0]="DEBUG",_e[_e.VERBOSE=1]="VERBOSE",_e[_e.INFO=2]="INFO",_e[_e.WARN=3]="WARN",_e[_e.ERROR=4]="ERROR",_e[_e.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},R=N||self;function L(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,k)&&t[k]||(t[k]=++P))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Q=R.navigator;if(Q){Q=Q.userAgent;if(Q){K=Q;break t}}K=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<J.length;i++)e=J[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=L;var nt,rt=Y(K,"Opera"),it=Y(K,"Trident")||Y(K,"MSIE"),ot=Y(K,"Edge"),st=ot||it,ut=Y(K,"Gecko")&&!(Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge"))&&!(Y(K,"Trident")||Y(K,"MSIE"))&&!Y(K,"Edge"),at=Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge");function ct(){var t=R.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=R.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",L,e),R.removeEventListener("test",L,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[Et]?e.wa(n,r,S(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,S(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=S(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=xt(t);if(c||(t[Rt]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Rt]=null)):At(t)))}function Pt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Ct(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new wt(e,this))}function xt(t){return(t=t[Rt])instanceof It?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function jt(){q.call(this),this.c=new It(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[Et]=!0,(I=jt.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},I.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=S(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&kt(r))}(this,t,e,n,r)},I.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},I.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},I.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=R.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Ht=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Wt},function(t){t.reset()}));function Kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;zt||(n=R.Promise.resolve(void 0),zt=function(){n.then($t)}),Xt||(zt(),Xt=!0),Qt.add(t,e)}Gt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Gt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){jt.call(this),this.b=t||1,this.a=e||R,this.f=x(this.Za,this),this.g=M()}function Jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}j(Zt,jt),(I=Zt.prototype).aa=!1,I.M=null,I.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Jt(this),this.start())))},I.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},I.G=function(){Zt.X.G.call(this),Jt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var _e={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ae(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ae.prototype.a=null;var Oe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Re(){mt.call(this,"d")}function Le(){mt.call(this,"c")}function De(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=ke,t=st?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Re,mt),j(Le,mt),j(De,Ae),Oe=new De;var ke=45e3,Pe={},Ce={};function Ve(t,e,n){t.H=1,t.i=nn(Qe(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=M(),Me(t),t.l=Qe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(x(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Me(t){t.T=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(x(t.Va,t),e)}function qe(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Jt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Kn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(x(u.Sa,u),6e3));if(_n(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(In(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Jn(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Hn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Se.prototype).setTimeout=function(t){this.P=t},I.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},I.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},I.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},I.cancel=function(){this.A=!0,Be(this)},I.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(I=He.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.L=function(){return Ke(this),this.a.concat()},I.get=function(t,e){return We(this.b,t)?this.b[t]:e},I.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Ze(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=rn(n[2]||""),Ze(this,n[3]||"",!0),Je(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Qe(t){return new Xe(t)}function $e(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?rn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(I=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},I.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},I.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},I.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Rn(){this.a=new On}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Dn=R.JSON.parse;function Sn(t){jt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}j(Sn,jt);var kn="",Pn=/^https?$/i,Cn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),jn(t)}function Un(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Mn(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,en(n=Qe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),$n(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=nn(Qe(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.i.toString(),"")),!n&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Kn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Wn(t){Kn(t),t.j&&(R.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){En(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),$n(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ve(n,r,e)}function $n(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function Zn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;S(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(x(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),$n(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Qe(e)),n.j=null,n.I=!0,xe(n,t)}function rr(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,In(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,qt(i=ye(),new be(i)),Xn(t)):Jn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(_n(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ee(x(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||$e(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,R.Image?((i=new Image).onload=U(Ln,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Ln,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Ln,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Ln,o,i,"TestLoadImage: timeout",!1,r),R.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Wn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Qe(s):new Xe(s,void 0);return""!=a.c?(e&&Ze(a,e+"."+a.c),Je(a,a.h)):(u=R.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&$e(u,r),i&&Ze(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),$n(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Le.call(this),this.status=1}function yr(t){this.a=t}(I=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(Oe),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},I.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Sn.X.G.call(this)},I.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},I.Ua=function(){Mn(this)},I.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},I.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},I.ua=function(){return this.h},I.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(I=zn.prototype).ha=8,I.v=1,I.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),en(i=Qe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),$n(this,i),this.i&&r&&Bn(i,this.i,r),An(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||En(this.b)||Qn(this))},I.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(x(this.Ta,this),t))},I.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Kn(this),nr(this))},I.Sa=function(){null!=this.m&&(this.m=null,Kn(this),tr(this),we(19))},I.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(I=hr.prototype).ta=function(){},I.sa=function(){},I.ra=function(){},I.qa=function(){},I.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){Hn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Re),j(dr,Le),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Qa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Pa,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var vr,gr=ye,mr=_e,wr=Te,br=pe,Er=10,_r=11,Tr=Ne,Ar=Sn,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=(f(Lr,vr=Error),Lr),Or="8.1.1-BundlePrerelease.f8bb4d8b7",Rr=new o("@firebase/firestore");function Lr(t,e){var n=this;return(n=vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Dr(){return Rr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.DEBUG&&(e=n.map(Cr),Rr.debug.apply(Rr,l(["Firestore ("+Or+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.ERROR&&(e=n.map(Cr),Rr.error.apply(Rr,l(["Firestore ("+Or+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.WARN&&(e=n.map(Cr),Rr.warn.apply(Rr,l(["Firestore ("+Or+"): "+t],e)))}function Cr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Or+") INTERNAL ASSERTION FAILED: "+t;throw kr(t),new Error(t)}function xr(t){t||Vr()}var Ur=(Mr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Mr);function Mr(){}function jr(t,e){return t<e?-1:e<t?1:0}function qr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Fr=(Br.fromBase64String=function(t){return new Br(atob(t))},Br.fromUint8Array=function(t){return new Br(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Br.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Br.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Br.prototype.o=function(){return 2*this.i.length},Br.prototype.u=function(t){return jr(this.i,t.i)},Br.prototype.isEqual=function(t){return this.i===t.i},Br);function Br(t){this.i=t}Fr.h=new Fr("");var Gr=(Hr.fromBase64String=function(t){try{return new Hr(Fr.fromBase64String(t))}catch(t){throw new Nr(Ir.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Hr.fromUint8Array=function(t){return new Hr(Fr.fromUint8Array(t))},Hr.prototype.toBase64=function(){return this.l.toBase64()},Hr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Hr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Hr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Hr),zr=function(t){this._=t};function Hr(t){this.l=t}function Kr(){if("undefined"==typeof Uint8Array)throw new Nr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wr(){if("undefined"==typeof atob)throw new Nr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Yr,Xr=(f(ei,Yr=zr),ei.fromBase64String=function(t){return Wr(),new ei(Gr.fromBase64String(t))},ei.fromUint8Array=function(t){return Kr(),new ei(Gr.fromUint8Array(t))},ei.prototype.toBase64=function(){return Wr(),this._.toBase64()},ei.prototype.toUint8Array=function(){return Kr(),this._.toUint8Array()},ei.prototype.isEqual=function(t){return this._.isEqual(t._)},ei.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ei),Qr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},$r=(Object.defineProperty(ti.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ti.prototype.isEqual=function(t){return t instanceof ti&&t.projectId===this.projectId&&t.database===this.database},ti),Zr=(Jr.prototype.A=function(){return null!=this.uid},Jr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Jr.prototype.isEqual=function(t){return t.uid===this.uid},Jr);function Jr(t){this.uid=t}function ti(t,e){this.projectId=t,this.database=e||"(default)"}function ei(){return null!==Yr&&Yr.apply(this,arguments)||this}Zr.UNAUTHENTICATED=new Zr(null),Zr.P=new Zr("google-credentials-uid"),Zr.g=new Zr("first-party-uid");function ni(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ri,ii,oi=(Ai.prototype.getToken=function(){return Promise.resolve(null)},Ai.prototype.v=function(){},Ai.prototype.S=function(t){(this.p=t)(Zr.UNAUTHENTICATED)},Ai.prototype.D=function(){this.p=null},Ai),si=(Ti.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(xr("string"==typeof t.accessToken),new ni(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ti.prototype.v=function(){this.forceRefresh=!0},Ti.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},Ti.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},Ti.prototype.O=function(){var t=this.auth&&this.auth.getUid();return xr(null===t||"string"==typeof t),new Zr(t)},Ti),ui=(Object.defineProperty(_i.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),_i),ai=(Ei.prototype.getToken=function(){return Promise.resolve(new ui(this.k,this.M))},Ei.prototype.S=function(t){t(Zr.g)},Ei.prototype.D=function(){},Ei.prototype.v=function(){},Ei),ci=(bi.now=function(){return bi.fromMillis(Date.now())},bi.fromDate=function(t){return bi.fromMillis(t.getTime())},bi.fromMillis=function(t){var e=Math.floor(t/1e3);return new bi(e,1e6*(t-1e3*e))},bi.prototype.toDate=function(){return new Date(this.toMillis())},bi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},bi.prototype.$=function(t){return this.seconds===t.seconds?jr(this.nanoseconds,t.nanoseconds):jr(this.seconds,t.seconds)},bi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},bi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},bi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},bi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},bi),hi=(wi.L=function(t){return new wi(t)},wi.min=function(){return new wi(new ci(0,0))},wi.prototype.u=function(t){return this.timestamp.$(t.timestamp)},wi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},wi.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},wi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},wi.prototype.q=function(){return this.timestamp},wi),_e=(Object.defineProperty(mi.prototype,"length",{get:function(){return this.U},enumerable:!1,configurable:!0}),mi.prototype.isEqual=function(t){return 0===mi.K(this,t)},mi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof mi?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},mi.prototype.limit=function(){return this.offset+this.length},mi.prototype.j=function(t){return t=void 0===t?1:t,this.W(this.segments,this.offset+t,this.length-t)},mi.prototype.G=function(){return this.W(this.segments,this.offset,this.length-1)},mi.prototype.H=function(){return this.segments[this.offset]},mi.prototype.J=function(){return this.get(this.length-1)},mi.prototype.get=function(t){return this.segments[this.offset+t]},mi.prototype.Y=function(){return 0===this.length},mi.prototype.X=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},mi.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},mi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},mi.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},mi.K=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},mi),fi=(f(gi,ii=_e),gi.prototype.W=function(t,e,n){return new gi(t,e,n)},gi.prototype.et=function(){return this.tt().join("/")},gi.prototype.toString=function(){return this.et()},gi.nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new gi(n)},gi.st=function(){return new gi([])},gi),li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pi=(f(vi,ri=_e),vi.prototype.W=function(t,e,n){return new vi(t,e,n)},vi.it=function(t){return li.test(t)},vi.prototype.et=function(){return this.tt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vi.it(t)||(t="`"+t+"`"),t}).join(".")},vi.prototype.toString=function(){return this.et()},vi.prototype.rt=function(){return 1===this.length&&"__name__"===this.get(0)},vi.ot=function(){return new vi(["__name__"])},vi.ct=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Nr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Nr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Nr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new vi(e)},vi.st=function(){return new vi([])},vi),di=(yi.at=function(t){return new yi(fi.nt(t))},yi.ut=function(t){return new yi(fi.nt(t).j(5))},yi.prototype.ht=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},yi.prototype.isEqual=function(t){return null!==t&&0===fi.K(this.path,t.path)},yi.prototype.toString=function(){return this.path.toString()},yi.K=function(t,e){return fi.K(t.path,e.path)},yi.lt=function(t){return t.length%2==0},yi._t=function(t){return new yi(new fi(t.slice()))},yi);function yi(t){this.path=t}function vi(){return null!==ri&&ri.apply(this,arguments)||this}function gi(){return null!==ii&&ii.apply(this,arguments)||this}function mi(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.U=n}function wi(t){this.timestamp=t}function bi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Nr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Nr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Nr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ei(t,e){this.k=t,this.M=e}function _i(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Zr.g}function Ti(t){var e=this;this.C=null,this.currentUser=Zr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function Ai(){this.p=null}function Ii(t){return null==t}function Ni(t){return 0===t&&1/t==-1/0}var Oi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ft=null};function Ri(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Oi(t,e,n,r,i,o,s)}function Li(t){var e=t;return null===e.ft&&(t=e.path.et(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.et()+t.op.toString()+ko(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.et()+t.dir}).join(","),Ii(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=oa(e.startAt)),e.endAt&&(t+="|ub:",t+=oa(e.endAt)),e.ft=t),e.ft}function Di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Ro(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ua(t.startAt,e.startAt)&&ua(t.endAt,e.endAt)}function Si(t){return di.lt(t.path)&&null===t.collectionGroup&&0===t.filters.length}function ki(t){this.count=t}var Pi,Ci=(Vi.prototype.Et=function(t){return new Vi(this.target,this.targetId,this.dt,t,this.wt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Vi.prototype.Tt=function(t,e){return new Vi(this.target,this.targetId,this.dt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Vi.prototype.It=function(t){return new Vi(this.target,this.targetId,this.dt,this.sequenceNumber,this.wt,t,this.resumeToken)},Vi);function Vi(t,e,n,r,i,o,s){void 0===i&&(i=hi.min()),void 0===o&&(o=hi.min()),void 0===s&&(s=Fr.h),this.target=t,this.targetId=e,this.dt=n,this.sequenceNumber=r,this.wt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function xi(t){switch(t){case Ir.OK:return Vr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Vr(),0}}function Ui(t){if(void 0===t)return kr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Pi.OK:return Ir.OK;case Pi.CANCELLED:return Ir.CANCELLED;case Pi.UNKNOWN:return Ir.UNKNOWN;case Pi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Pi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Pi.INTERNAL:return Ir.INTERNAL;case Pi.UNAVAILABLE:return Ir.UNAVAILABLE;case Pi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Pi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Pi.NOT_FOUND:return Ir.NOT_FOUND;case Pi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Pi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Pi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Pi.ABORTED:return Ir.ABORTED;case Pi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Pi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Pi.DATA_LOSS:return Ir.DATA_LOSS;default:return Vr()}}(Te=Pi=Pi||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var Mi=(Gi.prototype.At=function(t,e){return new Gi(this.K,this.root.At(t,e,this.K).copy(null,null,qi.Rt,null,null))},Gi.prototype.remove=function(t){return new Gi(this.K,this.root.remove(t,this.K).copy(null,null,qi.Rt,null,null))},Gi.prototype.get=function(t){for(var e=this.root;!e.Y();){var n=this.K(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Gi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.Y();){var r=this.K(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Gi.prototype.Y=function(){return this.root.Y()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Gi.prototype.Pt=function(){return this.root.Pt()},Gi.prototype.yt=function(){return this.root.yt()},Gi.prototype.gt=function(t){return this.root.gt(t)},Gi.prototype.forEach=function(n){this.gt(function(t,e){return n(t,e),!1})},Gi.prototype.toString=function(){var n=[];return this.gt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Gi.prototype.Vt=function(t){return this.root.Vt(t)},Gi.prototype.bt=function(){return new ji(this.root,null,this.K,!1)},Gi.prototype.vt=function(t){return new ji(this.root,t,this.K,!1)},Gi.prototype.St=function(){return new ji(this.root,null,this.K,!0)},Gi.prototype.Dt=function(t){return new ji(this.root,t,this.K,!0)},Gi),ji=(Bi.prototype.Nt=function(){var t=this.xt.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.Y();)this.xt.push(t),t=t.right;else for(t=t.right;!t.Y();)this.xt.push(t),t=t.left;return e},Bi.prototype.Ft=function(){return 0<this.xt.length},Bi.prototype.Ot=function(){if(0===this.xt.length)return null;var t=this.xt[this.xt.length-1];return{key:t.key,value:t.value}},Bi),qi=(Fi.prototype.copy=function(t,e,n,r,i){return new Fi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Fi.prototype.Y=function(){return!1},Fi.prototype.gt=function(t){return this.left.gt(t)||t(this.key,this.value)||this.right.gt(t)},Fi.prototype.Vt=function(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)},Fi.prototype.min=function(){return this.left.Y()?this:this.left.min()},Fi.prototype.Pt=function(){return this.min().key},Fi.prototype.yt=function(){return this.right.Y()?this.key:this.right.yt()},Fi.prototype.At=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.At(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.At(t,e,n))).kt()},Fi.prototype.Mt=function(){if(this.left.Y())return Fi.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Mt(),null)).kt()},Fi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.Y()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.Bt()),r.right.Y()||r.right.$t()||r.right.left.$t()||(r=r.qt()),0===e(t,r.key)){if(r.right.Y())return Fi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Mt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.kt()},Fi.prototype.$t=function(){return this.color},Fi.prototype.kt=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.Bt()),t.left.$t()&&t.right.$t()&&(t=t.Qt()),t},Fi.prototype.Lt=function(){var t=this.Qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Bt())).Ut()).Qt()),t},Fi.prototype.qt=function(){var t=this.Qt();return t.left.left.$t()&&(t=(t=t.Bt()).Qt()),t},Fi.prototype.Ut=function(){var t=this.copy(null,null,Fi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Fi.prototype.Bt=function(){var t=this.copy(null,null,Fi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Fi.prototype.Qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Fi.prototype.Kt=function(){var t=this.Wt();return Math.pow(2,t)<=this.size+1},Fi.prototype.Wt=function(){if(this.$t()&&this.left.$t())throw Vr();if(this.right.$t())throw Vr();var t=this.left.Wt();if(t!==this.right.Wt())throw Vr();return t+(this.$t()?0:1)},Fi);function Fi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Fi.RED,this.left=null!=r?r:Fi.EMPTY,this.right=null!=i?i:Fi.EMPTY,this.size=this.left.size+1+this.right.size}function Bi(t,e,n,r){this.Ct=r,this.xt=[];for(var i=1;!t.Y();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.xt.push(t);break}this.xt.push(t),t=this.Ct?t.right:t.left}}function Gi(t,e){this.K=t,this.root=e||qi.EMPTY}function zi(){this.size=0}qi.EMPTY=null,qi.RED=!0,qi.Rt=!1,qi.EMPTY=(Object.defineProperty(zi.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),zi.prototype.copy=function(t,e,n,r,i){return this},zi.prototype.At=function(t,e,n){return new qi(t,e)},zi.prototype.remove=function(t,e){return this},zi.prototype.Y=function(){return!0},zi.prototype.gt=function(t){return!1},zi.prototype.Vt=function(t){return!1},zi.prototype.Pt=function(){return null},zi.prototype.yt=function(){return null},zi.prototype.$t=function(){return!1},zi.prototype.Kt=function(){return!0},zi.prototype.Wt=function(){return 0},new zi);var Hi=(Xi.prototype.has=function(t){return null!==this.data.get(t)},Xi.prototype.first=function(){return this.data.Pt()},Xi.prototype.last=function(){return this.data.yt()},Object.defineProperty(Xi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Xi.prototype.indexOf=function(t){return this.data.indexOf(t)},Xi.prototype.forEach=function(n){this.data.gt(function(t,e){return n(t),!1})},Xi.prototype.jt=function(t,e){for(var n=this.data.vt(t[0]);n.Ft();){var r=n.Nt();if(0<=this.K(r.key,t[1]))return;e(r.key)}},Xi.prototype.Gt=function(t,e){for(var n=void 0!==e?this.data.vt(e):this.data.bt();n.Ft();)if(!t(n.Nt().key))return},Xi.prototype.zt=function(t){t=this.data.vt(t);return t.Ft()?t.Nt().key:null},Xi.prototype.bt=function(){return new Ki(this.data.bt())},Xi.prototype.vt=function(t){return new Ki(this.data.vt(t))},Xi.prototype.add=function(t){return this.copy(this.data.remove(t).At(t,!0))},Xi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Xi.prototype.Y=function(){return this.data.Y()},Xi.prototype.Ht=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Xi.prototype.isEqual=function(t){if(!(t instanceof Xi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(0!==this.K(r,i))return!1}return!0},Xi.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Xi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Xi.prototype.copy=function(t){var e=new Xi(this.K);return e.data=t,e},Xi),Ki=(Yi.prototype.Nt=function(){return this.Jt.Nt().key},Yi.prototype.Ft=function(){return this.Jt.Ft()},Yi),Wi=new Mi(di.K);function Yi(t){this.Jt=t}function Xi(t){this.K=t,this.data=new Mi(this.K)}var Qi=new Mi(di.K);var $i=new Mi(di.K);var Zi=new Hi(di.K);function Ji(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var to=new Hi(jr);var eo=(mo.Zt=function(t){return new mo(t.K)},mo.prototype.has=function(t){return null!=this.Yt.get(t)},mo.prototype.get=function(t){return this.Yt.get(t)},mo.prototype.first=function(){return this.Xt.Pt()},mo.prototype.last=function(){return this.Xt.yt()},mo.prototype.Y=function(){return this.Xt.Y()},mo.prototype.indexOf=function(t){t=this.Yt.get(t);return t?this.Xt.indexOf(t):-1},Object.defineProperty(mo.prototype,"size",{get:function(){return this.Xt.size},enumerable:!1,configurable:!0}),mo.prototype.forEach=function(n){this.Xt.gt(function(t,e){return n(t),!1})},mo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Yt.At(t.key,t),e.Xt.At(t,null))},mo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Yt.remove(t),this.Xt.remove(e)):this},mo.prototype.isEqual=function(t){if(!(t instanceof mo))return!1;if(this.size!==t.size)return!1;for(var e=this.Xt.bt(),n=t.Xt.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(!r.isEqual(i))return!1}return!0},mo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},mo.prototype.copy=function(t,e){var n=new mo;return n.K=this.K,n.Yt=t,n.Xt=e,n},mo),no=(go.prototype.track=function(t){var e=t.doc.key,n=this.te.get(e);!n||0!==t.type&&3===n.type?this.te=this.te.At(e,t):3===t.type&&1!==n.type?this.te=this.te.At(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.te=this.te.At(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.te=this.te.remove(e):1===t.type&&2===n.type?this.te=this.te.At(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):Vr()},go.prototype.ee=function(){var n=[];return this.te.gt(function(t,e){n.push(e)}),n},go),ro=(vo.oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new vo(t,e,eo.Zt(e),i,n,r,!0,!1)},Object.defineProperty(vo.prototype,"hasPendingWrites",{get:function(){return!this.se.Y()},enumerable:!1,configurable:!0}),vo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ie===t.ie&&this.se.isEqual(t.se)&&Ru(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.ne.isEqual(t.ne)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},vo),io=(yo.le=function(t,e){var n=new Map;return n.set(t,oo._e(t,e)),new yo(hi.min(),n,to,Wi,Ji())},yo),oo=(po._e=function(t,e){return new po(Fr.h,e,Ji(),Ji(),Ji())},po),so=function(t,e,n,r){this.Te=t,this.removedTargetIds=e,this.key=n,this.me=r},uo=function(t,e){this.targetId=t,this.Ie=e},ao=function(t,e,n,r){void 0===n&&(n=Fr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},co=(Object.defineProperty(lo.prototype,"fe",{get:function(){return this.ye},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"resumeToken",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"Ve",{get:function(){return 0!==this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"pe",{get:function(){return this.ge},enumerable:!1,configurable:!0}),lo.prototype.be=function(t){0<t.o()&&(this.ge=!0,this.Pe=t)},lo.prototype.ve=function(){var n=Ji(),r=Ji(),i=Ji();return this.Re.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new oo(this.Pe,this.ye,n,r,i)},lo.prototype.Se=function(){this.ge=!1,this.Re=bo()},lo.prototype.De=function(t,e){this.ge=!0,this.Re=this.Re.At(t,e)},lo.prototype.Ce=function(t){this.ge=!0,this.Re=this.Re.remove(t)},lo.prototype.xe=function(){this.Ae+=1},lo.prototype.Ne=function(){--this.Ae},lo.prototype.Fe=function(){this.ge=!0,this.ye=!0},lo),ho=(fo.prototype.Be=function(t){for(var e=0,n=t.Te;e<n.length;e++){var r=n[e];t.me instanceof lu?this.qe(r,t.me):t.me instanceof pu&&this.Ue(r,t.key,t.me)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.me)},fo.prototype.Qe=function(n){var r=this;this.Ke(n,function(t){var e=r.We(t);switch(n.state){case 0:r.je(t)&&e.be(n.resumeToken);break;case 1:e.Ne(),e.Ve||e.Se(),e.be(n.resumeToken);break;case 2:e.Ne(),e.Ve||r.removeTarget(t);break;case 3:r.je(t)&&(e.Fe(),e.be(n.resumeToken));break;case 4:r.je(t)&&(r.Ge(t),e.be(n.resumeToken));break;default:Vr()}})},fo.prototype.Ke=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ke.forEach(function(t,e){r.je(e)&&n(e)})},fo.prototype.ze=function(t){var e=t.targetId,n=t.Ie.count,t=this.He(e);t&&(Si(t=t.target)?0===n?(t=new di(t.path),this.Ue(e,t,new pu(t,hi.min()))):xr(1===n):this.Je(e)!==n&&(this.Ge(e),this.Le=this.Le.add(e)))},fo.prototype.Ye=function(r){var i=this,o=new Map;this.ke.forEach(function(t,e){var n=i.He(e);n&&(t.fe&&Si(n.target)&&(n=new di(n.target.path),null!==i.Me.get(n)||i.Xe(e,n)||i.Ue(e,n,new pu(n,r))),t.pe&&(o.set(e,t.ve()),t.Se()))});var s=Ji();this.$e.forEach(function(t,e){var n=!0;e.Gt(function(t){t=i.He(t);return!t||2===t.dt||(n=!1)}),n&&(s=s.add(t))});var t=new io(r,o,this.Le,this.Me,s);return this.Me=Wi,this.$e=wo(),this.Le=new Hi(jr),t},fo.prototype.qe=function(t,e){var n;this.je(t)&&(n=this.Xe(t,e.key)?2:0,this.We(t).De(e.key,n),this.Me=this.Me.At(e.key,e),this.$e=this.$e.At(e.key,this.Ze(e.key).add(t)))},fo.prototype.Ue=function(t,e,n){var r;this.je(t)&&(r=this.We(t),this.Xe(t,e)?r.De(e,1):r.Ce(e),this.$e=this.$e.At(e,this.Ze(e).delete(t)),n&&(this.Me=this.Me.At(e,n)))},fo.prototype.removeTarget=function(t){this.ke.delete(t)},fo.prototype.Je=function(t){var e=this.We(t).ve();return this.Oe.tn(t).size+e.de.size-e.Ee.size},fo.prototype.xe=function(t){this.We(t).xe()},fo.prototype.We=function(t){var e=this.ke.get(t);return e||(e=new co,this.ke.set(t,e)),e},fo.prototype.Ze=function(t){var e=this.$e.get(t);return e||(e=new Hi(jr),this.$e=this.$e.At(t,e)),e},fo.prototype.je=function(t){var e=null!==this.He(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},fo.prototype.He=function(t){var e=this.ke.get(t);return e&&e.Ve?null:this.Oe.en(t)},fo.prototype.Ge=function(e){var n=this;this.ke.set(e,new co),this.Oe.tn(e).forEach(function(t){n.Ue(e,t,null)})},fo.prototype.Xe=function(t,e){return this.Oe.tn(t).has(e)},fo);function fo(t){this.Oe=t,this.ke=new Map,this.Me=Wi,this.$e=wo(),this.Le=new Hi(jr)}function lo(){this.Ae=0,this.Re=bo(),this.Pe=Fr.h,this.ye=!1,this.ge=!0}function po(t,e,n,r,i){this.resumeToken=t,this.fe=e,this.de=n,this.we=r,this.Ee=i}function yo(t,e,n,r,i){this.wt=t,this.ce=e,this.ae=n,this.ue=r,this.he=i}function vo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ne=n,this.docChanges=r,this.se=i,this.fromCache=o,this.ie=s,this.re=u}function go(){this.te=new Mi(di.K)}function mo(n){this.K=n?function(t,e){return n(t,e)||di.K(t.key,e.key)}:function(t,e){return di.K(t.key,e.key)},this.Yt=Qi,this.Xt=new Mi(this.K)}function wo(){return new Mi(di.K)}function bo(){return new Mi(di.K)}function Eo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _o(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function To(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ao(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Io(t){t=Po(t.mapValue.fields.__local_write_time__.timestampValue);return new ci(t.seconds,t.nanos)}var No=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ao(t)?4:10:Vr()}function Ro(r,i){var t,e=Oo(r);if(e!==Oo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Io(r).isEqual(Io(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Po(r.timestampValue),t=Po(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Vo(r.bytesValue).isEqual(Vo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Co((t=r).geoPointValue.latitude)===Co(e.geoPointValue.latitude)&&Co(t.geoPointValue.longitude)===Co(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Co(t.integerValue)===Co(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Co(t.doubleValue),e=Co(e.doubleValue);return t===e?Ni(t)===Ni(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return qr(r.arrayValue.values||[],i.arrayValue.values||[],Ro);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Eo(e)!==Eo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Ro(e[t],n[t])))return!1;return!0}();default:return Vr()}}function Lo(t,e){return void 0!==(t.values||[]).find(function(t){return Ro(t,e)})}function Do(t,e){var n,r,i=Oo(t),o=Oo(e);if(i!==o)return jr(i,o);switch(i){case 0:return 0;case 1:return jr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Co(t.integerValue||t.doubleValue),n=Co(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return So(t.timestampValue,e.timestampValue);case 4:return So(Io(t),Io(e));case 5:return jr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Vo(t),e=Vo(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=jr(n[i],r[i]);if(0!==o)return o}return jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=jr(Co(i.latitude),Co(r.latitude)))?n:jr(Co(i.longitude),Co(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Do(n[i],r[i]);if(o)return o}return jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=jr(r[s],o[s]);if(0!==u)return u;u=Do(n[r[s]],i[o[s]]);if(0!==u)return u}return jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function So(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return jr(t,e);var n=Po(t),t=Po(e),e=jr(n.seconds,t.seconds);return 0!==e?e:jr(n.nanos,t.nanos)}function ko(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Po(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Vo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,di.ut(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Vr();var e}(t)}function Po(t){if(xr(!!t),"string"!=typeof t)return{seconds:Co(t.seconds),nanos:Co(t.nanos)};var e=0,n=No.exec(t);xr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Co(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Vo(t){return"string"==typeof t?Fr.fromBase64String(t):Fr.fromUint8Array(t)}function xo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.et()}}function Uo(t){return t&&"integerValue"in t}function Mo(t){return!!t&&"arrayValue"in t}function jo(t){return t&&"nullValue"in t}function qo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fo(t){return t&&"mapValue"in t}var Bo={asc:"ASCENDING",desc:"DESCENDING"},Go={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zo=function(t,e){this.T=t,this.nn=e};function Ho(t){return{integerValue:""+t}}function Ko(t,e){if(t.nn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ni(e)?"-0":e}}function Wo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ni(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ho(e):Ko(t,e);var n}function Yo(t,e){return t.nn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Xo(t,e){return t.nn?e.toBase64():e.toUint8Array()}function Qo(t){return xr(!!t),hi.L((t=Po(t),new ci(t.seconds,t.nanos)))}function $o(t,e){return new fi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).et()}function Zo(t){t=fi.nt(t);return xr(ps(t)),t}function Jo(t,e){return $o(t.T,e.path)}function ts(t,e){e=Zo(e);if(e.get(1)!==t.T.projectId)throw new Nr(Ir.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Nr(Ir.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new di(rs(e))}function es(t,e){return $o(t.T,e)}function ns(t){return new fi(["projects",t.T.projectId,"databases",t.T.database]).et()}function rs(t){return xr(4<t.length&&"documents"===t.get(4)),t.j(5)}function is(t,e,n){return{name:Jo(t,e),fields:n.proto.mapValue.fields}}function os(t,e){var n,r,i;if(e instanceof zs)n={update:is(t,e.key,e.value)};else if(e instanceof eu)n={delete:Jo(t,e.key)};else if(e instanceof Hs)n={update:is(t,e.key,e.data),updateMask:(i=e.sn,r=[],i.fields.forEach(function(t){return r.push(t.et())}),{fieldPaths:r})};else if(e instanceof Qs)n={transform:{document:Jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof gs)return{fieldPath:t.field.et(),setToServerValue:"REQUEST_TIME"};if(e instanceof ms)return{fieldPath:t.field.et(),appendMissingElements:{values:e.elements}};if(e instanceof Ts)return{fieldPath:t.field.et(),removeAllFromArray:{values:e.elements}};if(e instanceof Os)return{fieldPath:t.field.et(),increment:e.rn};throw Vr()})}};else{if(!(e instanceof nu))return Vr();n={verify:Jo(t,e.key)}}return e.cn.on||(n.currentDocument=void 0!==(i=e.cn).updateTime?{updateTime:(e=t,t=i.updateTime,Yo(e,t.q()))}:void 0!==i.exists?{exists:i.exists}:Vr()),n}function ss(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=es(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=es(t,r.G()),n.structuredQuery.from=[{collectionId:r.J()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(qo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NAN"}};if(jo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(qo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NAN"}};if(jo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hs(t.field),op:(e=t.op,Go[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:hs((t=t).field),direction:(t=t.dir,Bo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.nn||Ii(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=as(e.startAt)),e.endAt&&(n.structuredQuery.endAt=as(e.endAt)),n}function us(t){var e=4===(o=Zo(t.parent)).length?fi.st():rs(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(xr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ls(t)]:void 0!==t.fieldFilter?[(n=t,Cu.create(fs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Vr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Vr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new aa(fs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ii(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=cs(n.startAt));var u=null;return n.endAt&&(u=cs(n.endAt)),new yu(e,i,t,o,r,"F",s,u)}function as(t){return{before:t.before,values:t.position}}function cs(t){var e=!!t.before,t=t.values||[];return new ta(t,e)}function hs(t){return{fieldPath:t.et()}}function fs(t){return pi.ct(t.fieldPath)}function ls(t){switch(t.unaryFilter.op){case"IS_NAN":var e=fs(t.unaryFilter.field);return Cu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=fs(t.unaryFilter.field);return Cu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=fs(t.unaryFilter.field);return Cu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=fs(t.unaryFilter.field);return Cu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Vr()}}function ps(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}o=function(){this.un=void 0};function ds(t,e){return t instanceof Os?Uo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ys,vs,gs=(f(bs,vs=o),bs),ms=(f(ws,ys=o),ws);function ws(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function bs(){return null!==vs&&vs.apply(this,arguments)||this}function Es(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Ro(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var _s,Ts=(f(As,_s=o),As);function As(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function Is(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Ro(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ns,Os=(f(Rs,Ns=o),Rs);function Rs(t,e){var n=this;return(n=Ns.call(this)||this).serializer=t,n.rn=e,n}function Ls(t){return Co(t.integerValue||t.doubleValue)}function Ds(t){return Mo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ss(t,e){this.field=t,this.transform=e}var ks=(Ps.prototype.hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].X(t))return!0;return!1},Ps.prototype.isEqual=function(t){return qr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ps);function Ps(t){(this.fields=t).sort(pi.K)}function Cs(t,e){this.version=t,this.transformResults=e}var Vs=(xs.an=function(){return new xs},xs.exists=function(t){return new xs(void 0,t)},xs.updateTime=function(t){return new xs(t)},Object.defineProperty(xs.prototype,"on",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},xs);function xs(t,e){this.updateTime=t,this.exists=e}function Us(t,e){return void 0!==t.updateTime?e instanceof lu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof lu}_e=function(){};function Ms(t,e,n){return t instanceof zs?new lu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Hs?function(t,e,n){if(!Us(t.cn,e))return new du(t.key,n.version);e=Ys(t,e);return new lu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Qs?function(t,e,n){if(xr(null!=n.transformResults),!Us(t.cn,e))return new du(t.key,n.version);var r=e,e=function(t,e,n){var r=[];xr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof lu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ms?Es(o,s):o instanceof Ts?Is(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Zs(t,r.data(),e);return new lu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new pu(t.key,n.version,{hasCommittedMutations:!0})}function js(t,e,n,r){return t instanceof zs?function(t,e){if(!Us(t.cn,e))return e;e=Fs(e);return new lu(t.key,e,t.value,{ln:!0})}(t,e):t instanceof Hs?function(t,e){if(!Us(t.cn,e))return e;var n=Fs(e),e=Ys(t,e);return new lu(t.key,n,e,{ln:!0})}(t,e):t instanceof Qs?function(t,e,n,r){if(!Us(t.cn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof lu&&(h=n.field(a.field)),null===h&&r instanceof lu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof gs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof ms?Es(c,i):c instanceof Ts?Is(c,i):(c=ds(h=c,i),i=Ls(c)+Ls(h.rn),Uo(c)&&Uo(h.rn)?Ho(i):Ko(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Zs(t,i.data(),r);return new lu(t.key,i.version,r,{ln:!0})}(t,e,r,n):(e=e,Us((t=t).cn,e)?new pu(t.key,hi.min()):e)}function qs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.cn.isEqual(e.cn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.sn.isEqual(e.sn):2!==t.type||qr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ms&&e instanceof ms||t instanceof Ts&&e instanceof Ts?qr(t.elements,e.elements,Ro):t instanceof Os&&e instanceof Os?Ro(t.rn,e.rn):t instanceof gs&&e instanceof gs)}))}function Fs(t){return t instanceof lu?t.version:hi.min()}var Bs,Gs,zs=(f(Ws,Gs=_e),Ws),Hs=(f(Ks,Bs=_e),Ks);function Ks(t,e,n,r){var i=this;return(i=Bs.call(this)||this).key=t,i.data=e,i.sn=n,i.cn=r,i.type=1,i}function Ws(t,e,n){var r=this;return(r=Gs.call(this)||this).key=t,r.value=e,r.cn=n,r.type=0,r}function Ys(t,e){return n=t,e=e instanceof lu?e.data():ru.empty(),r=new iu(e),n.sn.fields.forEach(function(t){var e;t.Y()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r._n();var n,r}var Xs,Qs=(f($s,Xs=_e),$s);function $s(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.cn=Vs.exists(!0),n}function Zs(t,e,n){for(var r=new iu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r._n()}var Js,tu,eu=(f(au,tu=_e),au),nu=(f(uu,Js=_e),uu),ru=(su.empty=function(){return new su({mapValue:{}})},su.prototype.field=function(t){if(t.Y())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Fo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.J()])||null},su.prototype.isEqual=function(t){return Ro(this.proto,t.proto)},su),iu=(ou.prototype.set=function(t,e){return this.wn(t,e),this},ou.prototype.delete=function(t){return this.wn(t,null),this},ou.prototype.wn=function(t,e){for(var n=this.dn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Oo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.J(),e)},ou.prototype._n=function(){var t=this.En(pi.st(),this.dn);return null!=t?new ru(t):this.fn},ou.prototype.En=function(r,t){var i=this,o=!1,e=this.fn.field(r),s=Fo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.En(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},ou);function ou(t){void 0===t&&(t=ru.empty()),this.fn=t,this.dn=new Map}function su(t){this.proto=t}function uu(t,e){var n=this;return(n=Js.call(this)||this).key=t,n.cn=e,n.type=4,n}function au(t,e){var n=this;return(n=tu.call(this)||this).key=t,n.cn=e,n.type=3,n}var cu,hu,fu,Te=function(t,e){this.key=t,this.version=e},lu=(f(mu,fu=Te),mu.prototype.field=function(t){return this.Tn.field(t)},mu.prototype.data=function(){return this.Tn},mu.prototype.mn=function(){return this.Tn.proto},mu.prototype.isEqual=function(t){return t instanceof mu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ln===t.ln&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Tn.isEqual(t.Tn)},mu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Tn.toString()+", {hasLocalMutations: "+this.ln+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(mu.prototype,"hasPendingWrites",{get:function(){return this.ln||this.hasCommittedMutations},enumerable:!1,configurable:!0}),mu),pu=(f(gu,hu=Te),gu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(gu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),gu.prototype.isEqual=function(t){return t instanceof gu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},gu),du=(f(vu,cu=Te),vu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(vu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),vu.prototype.isEqual=function(t){return t instanceof vu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},vu),yu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.In=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.An=null,this.Rn=null,this.startAt,this.endAt};function vu(){return null!==cu&&cu.apply(this,arguments)||this}function gu(t,e,n){var r=this;return(r=hu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function mu(t,e,n,r){var i=this;return(i=fu.call(this,t,e)||this).Tn=n,i.ln=!!r.ln,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function wu(t){return new yu(t)}function bu(t){return!Ii(t.limit)&&"F"===t.limitType}function Eu(t){return!Ii(t.limit)&&"L"===t.limitType}function _u(t){return 0<t.In.length?t.In[0].field:null}function Tu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Pn())return r.field}return null}function Au(t){return null!==t.collectionGroup}function Iu(t){var e=t;if(null===e.An){e.An=[];var n=Tu(e),t=_u(e);if(null!==n&&null===t)n.rt()||e.An.push(new aa(n)),e.An.push(new aa(pi.ot(),"asc"));else{for(var r=!1,i=0,o=e.In;i<o.length;i++){var s=o[i];e.An.push(s),s.field.rt()&&(r=!0)}r||(n=0<e.In.length?e.In[e.In.length-1].dir:"asc",e.An.push(new aa(pi.ot(),n)))}}return e.An}function Nu(t){var e=t;if(!e.Rn)if("F"===e.limitType)e.Rn=Ri(e.path,e.collectionGroup,Iu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Iu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new aa(o.field,s))}var u=e.endAt?new ta(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ta(e.startAt.position,!e.startAt.before):null;e.Rn=Ri(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Rn}function Ou(t,e,n){return new yu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ru(t,e){return Di(Nu(t),Nu(e))&&t.limitType===e.limitType}function Lu(t){return Li(Nu(t))+"|lt:"+t.limitType}function Du(t){return"Query(target="+(e=Nu(t),n=e.path.et(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.et()+" "+t.op+" "+ko(t.value)}).join(", ")+"]"),Ii(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.et()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+oa(e.startAt)),e.endAt&&(n+=", endAt: "+oa(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Su(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.ht(e.collectionGroup)&&e.path.X(n):di.lt(e.path)?e.path.isEqual(n):e.path.Z(n))&&function(t){for(var e=0,n=i.In;e<n.length;e++){var r=n[e];if(!r.field.rt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||sa(t.startAt,Iu(t),n))&&(!t.endAt||!sa(t.endAt,Iu(t),n)));var e,n}function ku(u){return function(t,e){for(var n=!1,r=0,i=Iu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.rt()?di.K(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Do(n,t):Vr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.rt()}return 0}}var Pu,Cu=(f(Vu,Pu=function(){}),Vu.create=function(t,e,n){return t.rt()?"in"===e||"not-in"===e?this.yn(t,e,n):new ju(t,e,n):"array-contains"===e?new Qu(t,n):"in"===e?new $u(t,n):"not-in"===e?new Zu(t,n):"array-contains-any"===e?new Ju(t,n):new Vu(t,e,n)},Vu.yn=function(t,e,n){return new("in"===e?qu:Fu)(t,n)},Vu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.gn(Do(t,this.value)):null!==t&&Oo(this.value)===Oo(t)&&this.gn(Do(t,this.value))},Vu.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},Vu.prototype.Pn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Vu);function Vu(t,e,n){var r=this;return(r=Pu.call(this)||this).field=t,r.op=e,r.value=n,r}var xu,Uu,Mu,ju=(f(zu,Mu=Cu),zu.prototype.matches=function(t){t=di.K(t.key,this.key);return this.gn(t)},zu),qu=(f(Gu,Uu=Cu),Gu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Gu),Fu=(f(Bu,xu=Cu),Bu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Bu);function Bu(t,e){var n=this;return(n=xu.call(this,t,"not-in",e)||this).keys=Hu(0,e),n}function Gu(t,e){var n=this;return(n=Uu.call(this,t,"in",e)||this).keys=Hu(0,e),n}function zu(t,e,n){var r=this;return(r=Mu.call(this,t,e,n)||this).key=di.ut(n.referenceValue),r}function Hu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return di.ut(t.referenceValue)})}var Ku,Wu,Yu,Xu,Qu=(f(ia,Xu=Cu),ia.prototype.matches=function(t){t=t.field(this.field);return Mo(t)&&Lo(t.arrayValue,this.value)},ia),$u=(f(ra,Yu=Cu),ra.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Lo(this.value.arrayValue,t)},ra),Zu=(f(na,Wu=Cu),na.prototype.matches=function(t){if(Lo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Lo(this.value.arrayValue,t)},na),Ju=(f(ea,Ku=Cu),ea.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Mo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Lo(e.value.arrayValue,t)})},ea),ta=function(t,e){this.position=t,this.before=e};function ea(t,e){return Ku.call(this,t,"array-contains-any",e)||this}function na(t,e){return Wu.call(this,t,"not-in",e)||this}function ra(t,e){return Yu.call(this,t,"in",e)||this}function ia(t,e){return Xu.call(this,t,"array-contains",e)||this}function oa(t){return(t.before?"b":"a")+":"+t.position.map(ko).join(",")}function sa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.rt()?di.K(di.ut(s.referenceValue),n.key):Do(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ua(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ro(t.position[n],e.position[n]))return!1;return!0}var aa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var ca=(Aa.prototype.pn=function(t,e,n){for(var r=n.bn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ms(o,e,r[i]))}return e},Aa.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=js(i,e,e,this.Vn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=js(a,e,o,this.Vn))}return e},Aa.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.At(t.key,e))}),i},Aa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ji())},Aa.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,qs)&&qr(this.baseMutations,t.baseMutations,qs)},Aa),ha=(Ta.from=function(t,e,n){xr(t.mutations.length===n.length);for(var r=$i,i=t.mutations,o=0;o<i.length;o++)r=r.At(i[o].key,n[o].version);return new Ta(t,e,n,r)},Ta),fa=(_a.prototype.get=function(t){var e=this.xn(t),e=this.Fn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Nn(o,t))return i}},_a.prototype.has=function(t){return void 0!==this.get(t)},_a.prototype.set=function(t,e){var n=this.xn(t),r=this.Fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Nn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Fn[n]=[[t,e]]},_a.prototype.delete=function(t){var e=this.xn(t),n=this.Fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Nn(n[r][0],t))return 1===n.length?delete this.Fn[e]:n.splice(r,1),!0;return!1},_a.prototype.forEach=function(s){_o(this.Fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},_a.prototype.Y=function(){return To(this.Fn)},_a),la=(Ea.prototype.catch=function(t){return this.next(void 0,t)},Ea.prototype.next=function(r,i){var o=this;return this.$n&&Vr(),this.$n=!0,this.Mn?this.error?this.Ln(i,this.error):this.Bn(r,this.result):new Ea(function(e,n){o.On=function(t){o.Bn(r,t).next(e,n)},o.kn=function(t){o.Ln(i,t).next(e,n)}})},Ea.prototype.qn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ea.prototype.Un=function(t){try{var e=t();return e instanceof Ea?e:Ea.resolve(e)}catch(t){return Ea.reject(t)}},Ea.prototype.Bn=function(t,e){return t?this.Un(function(){return t(e)}):Ea.resolve(e)},Ea.prototype.Ln=function(t,e){return t?this.Un(function(){return t(e)}):Ea.reject(e)},Ea.resolve=function(n){return new Ea(function(t,e){t(n)})},Ea.reject=function(n){return new Ea(function(t,e){e(n)})},Ea.Qn=function(t){return new Ea(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ea.Kn=function(t){for(var n=Ea.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ea.resolve(t):e()})}(r[e]);return n},Ea.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Qn(i)},Ea),o=(ba.prototype.Gn=function(t){t=this.Wn.get(t);return t?t.readTime:hi.min()},ba.prototype.zn=function(t,e){this.Hn(),this.Wn.set(t.key,{Jn:t,readTime:e})},ba.prototype.Yn=function(t,e){void 0===e&&(e=null),this.Hn(),this.Wn.set(t,{Jn:null,readTime:e})},ba.prototype.Xn=function(t,e){this.Hn();var n=this.Wn.get(e);return void 0!==n?la.resolve(n.Jn):this.Zn(t,e)},ba.prototype.getEntries=function(t,e){return this.ts(t,e)},ba.prototype.apply=function(t){return this.Hn(),this.jn=!0,this.es(t)},ba.prototype.Hn=function(){},ba),_e=(wa.prototype.ss=function(t){this.ns.push(t)},wa.prototype.rs=function(){this.ns.forEach(function(t){return t()})},wa),pa=(ma.prototype.hs=function(e,n){var r=this;return this.cs.ls(e,n).next(function(t){return r._s(e,n,t)})},ma.prototype._s=function(t,r,i){return this.os.Xn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},ma.prototype.fs=function(t,e,i){var o=Wi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.At(t,e)}),o},ma.prototype.ds=function(e,t){var n=this;return this.os.getEntries(e,t).next(function(t){return n.ws(e,t)})},ma.prototype.ws=function(e,r){var i=this;return this.cs.Es(e,r).next(function(t){var t=i.fs(e,r,t),n=Wi;return t.forEach(function(t,e){e=e||new pu(t,hi.min()),n=n.At(t,e)}),n})},ma.prototype.Ts=function(t,e,n){return r=e,di.lt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Is(t,e.path):Au(e)?this.As(t,e,n):this.Rs(t,e,n);var r},ma.prototype.Is=function(t,e){return this.hs(t,new di(e)).next(function(t){var e=Qi;return t instanceof lu&&(e=e.At(t.key,t)),e})},ma.prototype.As=function(n,r,i){var o=this,s=r.collectionGroup,u=Qi;return this.us.Ps(n,s).next(function(t){return la.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new yu(t,null,e.In.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.At(t,e)})})}).next(function(){return u})})},ma.prototype.Rs=function(e,n,t){var c,h,r=this;return this.os.Ts(e,n,t).next(function(t){return c=t,r.cs.ys(e,n)}).next(function(t){return h=t,r.gs(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=js(s,a,a,r.Vn);c=a instanceof lu?c.At(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Su(n,e)||(c=c.remove(t))}),c})},ma.prototype.gs=function(t,e,n){for(var r=Ji(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Hs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.os.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof lu&&(c=c.At(t,e))}),c})},ma),da=(ga.bs=function(t,e){for(var n=Ji(),r=Ji(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ga(t,e.fromCache,n,r)},ga),ya=(va.prototype.Ss=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},va.prototype.next=function(){var t=++this.previousValue;return this.Ds&&this.Ds(t),t},va);function va(t,e){var n=this;this.previousValue=t,e&&(e.vs=function(t){return n.Ss(t)},this.Ds=function(t){return e.Cs(t)})}function ga(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.ps=r}function ma(t,e,n){this.os=t,this.cs=e,this.us=n}function wa(){this.ns=[]}function ba(){this.Wn=new fa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.jn=!1}function Ea(t){var e=this;this.On=null,this.kn=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.$n=!1,t(function(t){e.Mn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Mn=!0,e.error=t,e.kn&&e.kn(t)})}function _a(t,e){this.xn=t,this.Nn=e,this.Fn={}}function Ta(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function Aa(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}ya.xs=-1;var Ia=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Na=(Oa.prototype.reset=function(){this.$s=0},Oa.prototype.qs=function(){this.$s=this.Ms},Oa.prototype.Us=function(t){var e=this;this.cancel();var n=Math.floor(this.$s+this.Qs()),r=Math.max(0,Date.now()-this.Bs),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.$s+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ls=this.Ns.Ks(this.Fs,i,function(){return e.Bs=Date.now(),t()}),this.$s*=this.ks,this.$s<this.Os&&(this.$s=this.Os),this.$s>this.Ms&&(this.$s=this.Ms)},Oa.prototype.Ws=function(){null!==this.Ls&&(this.Ls.js(),this.Ls=null)},Oa.prototype.cancel=function(){null!==this.Ls&&(this.Ls.cancel(),this.Ls=null)},Oa.prototype.Qs=function(){return(Math.random()-.5)*this.$s},Oa);function Oa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ns=t,this.Fs=e,this.Os=n,this.ks=r,this.Ms=i,this.$s=0,this.Ls=null,this.Bs=Date.now(),this.reset()}function Ra(t){return"IndexedDbTransactionError"===t.name}function La(){return"undefined"!=typeof document?document:null}var Da=(Pa.Ai=function(t,e,n,r,i){i=new Pa(t,e,Date.now()+n,r,i);return i.start(n),i},Pa.prototype.start=function(t){var e=this;this.Ri=setTimeout(function(){return e.Pi()},t)},Pa.prototype.js=function(){return this.Pi()},Pa.prototype.cancel=function(t){null!==this.Ri&&(this.clearTimeout(),this.Ii.reject(new Nr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Pa.prototype.Pi=function(){var e=this;this.Ei.yi(function(){return null!==e.Ri?(e.clearTimeout(),e.op().then(function(t){return e.Ii.resolve(t)})):Promise.resolve()})},Pa.prototype.clearTimeout=function(){null!==this.Ri&&(this.mi(this),clearTimeout(this.Ri),this.Ri=null)},Pa),Sa=(Object.defineProperty(ka.prototype,"Ni",{get:function(){return this.pi},enumerable:!1,configurable:!0}),ka.prototype.yi=function(t){this.enqueue(t)},ka.prototype.Fi=function(t){this.Oi(),this.ki(t)},ka.prototype.Mi=function(){var t;this.pi||(this.pi=!0,(t=La())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.xi))},ka.prototype.enqueue=function(t){return this.Oi(),this.pi?new Promise(function(t){}):this.ki(t)},ka.prototype.$i=function(t){var e=this;this.yi(function(){return e.Vi.push(t),e.Li()})},ka.prototype.Li=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Vi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Vi[0]()];case 2:return t.sent(),this.Vi.shift(),this.Ci.reset(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Vi.length&&this.Ci.Us(function(){return n.Li()}),t.label=5;case 5:return[2]}})})},ka.prototype.ki=function(t){var r=this,e=this.gi.then(function(){return r.Si=!0,t().catch(function(t){throw r.vi=t,r.Si=!1,kr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Si=!1,t})});return this.gi=e},ka.prototype.Ks=function(t,e,n){var r=this;this.Oi(),-1<this.Di.indexOf(t)&&(e=0);n=Da.Ai(this,t,e,n,function(t){return r.Bi(t)});return this.bi.push(n),n},ka.prototype.Oi=function(){this.vi&&Vr()},ka.prototype.qi=function(){},ka.prototype.Ui=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.gi];case 1:t.sent(),t.label=2;case 2:if(e!==this.gi)return[3,0];t.label=3;case 3:return[2]}})})},ka.prototype.Qi=function(t){for(var e=0,n=this.bi;e<n.length;e++)if(n[e].Fs===t)return!0;return!1},ka.prototype.Ki=function(r){var i=this;return this.Ui().then(function(){i.bi.sort(function(t,e){return t.Ti-e.Ti});for(var t=0,e=i.bi;t<e.length;t++){var n=e[t];if(n.js(),"all"!==r&&n.Fs===r)break}return i.Ui()})},ka.prototype.Wi=function(t){this.Di.push(t)},ka.prototype.Bi=function(t){t=this.bi.indexOf(t);this.bi.splice(t,1)},ka);function ka(){var e=this;this.gi=Promise.resolve(),this.Vi=[],this.pi=!1,this.bi=[],this.vi=null,this.Si=!1,this.Di=[],this.Ci=new Na(this,"async_queue_retry"),this.xi=function(){var t=La();t&&Sr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ci.Ws()};var t=La();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.xi)}function Pa(t,e,n,r,i){this.Ei=t,this.Fs=e,this.Ti=n,this.op=r,this.mi=i,this.Ii=new Ia,this.then=this.Ii.promise.then.bind(this.Ii.promise),this.Ii.promise.catch(function(t){})}function Ca(t,e){if(kr("AsyncQueue",e+": "+t),Ra(t))return new Nr(Ir.UNAVAILABLE,e+": "+t);throw t}function Va(t){this.Cr=t}var xa=(Ua.prototype.pr=function(t){this.br=t},Ua.prototype.Ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.In.length||1===r.In.length&&r.In[0].field.rt())||i.isEqual(hi.min())?this.vr(e,r):this.br.ds(e,o).next(function(t){var n=s.Sr(r,t);return(bu(r)||Eu(r))&&s.Dr(r.limitType,n,o,i)?s.vr(e,r):(Dr()<=u.DEBUG&&Sr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Du(r)),s.br.Ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.At(t.key,t)}),e}))})},Ua.prototype.Sr=function(n,t){var r=new Hi(ku(n));return t.forEach(function(t,e){e instanceof lu&&Su(n,e)&&(r=r.add(e))}),r},Ua.prototype.Dr=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},Ua.prototype.vr=function(t,e){return Dr()<=u.DEBUG&&Sr("QueryEngine","Using full collection scan to execute query:",Du(e)),this.br.Ts(t,e,hi.min())},Ua);function Ua(){}function Ma(t){var e=us({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ou(e,e.limit,"L"):e}var ja=(za.prototype.$r=function(t,e){return this.lo.add(e),la.resolve()},za.prototype.Ps=function(t,e){return la.resolve(this.lo.getEntries(e))},za),qa=(Ga.prototype.add=function(t){var e=t.J(),n=t.G(),r=this.index[e]||new Hi(fi.K),t=!r.has(n);return this.index[e]=r.add(n),t},Ga.prototype.has=function(t){var e=t.J(),t=t.G(),e=this.index[e];return e&&e.has(t)},Ga.prototype.getEntries=function(t){return(this.index[t]||new Hi(fi.K)).tt()},Ga),Fa=(Ba.prototype.next=function(){return this.mo+=2,this.mo},Ba.Io=function(){return new Ba(0)},Ba.Ao=function(){return new Ba(-1)},Ba);function Ba(t){this.mo=t}function Ga(){this.index={}}function za(){this.lo=new qa}function Ha(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Ka(t,e){if(t instanceof Uint8Array)return Ha(t,e);if(t instanceof ArrayBuffer)return Ha(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Wa(t){return new zo(t,!0)}var Ya=(Ja.prototype.Mc=function(){return"metadata"in this.payload},Ja),Xa=(Za.qc=function(t,e){return new Za(Ka(t,10240),e)},Za.prototype.close=function(){return this.$c.cancel()},Za.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Za.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Bc())]}})})},Za.prototype.Bc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Lc.decode(e),n=Number(r),isNaN(n)&&this.Kc("length string ("+r+") is not valid number"),[4,this.Wc(n)]);case 2:return r=t.sent(),[2,new Ya(JSON.parse(r),e.length+n)]}})})},Za.prototype.jc=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Za.prototype.Qc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.jc()<0?[4,this.Gc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.jc())<0&&this.Kc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Za.prototype.Wc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Gc()]:[3,3];case 1:t.sent()&&this.Kc("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Lc.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Za.prototype.Kc=function(t){throw this.$c.cancel(),new Error("Invalid bundle format: "+t)},Za.prototype.Gc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.$c.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Za),Qa=($a.prototype.zc=function(t){return ts(this.serializer,t)},$a.prototype.Hc=function(t){return t.metadata.exists?(e=this.serializer,n=t.document,r=ts(e,n.name),e=Qo(n.updateTime),n=new ru({mapValue:{fields:n.fields}}),new lu(r,e,n,{hasCommittedMutations:!1})):new pu(this.zc(t.metadata.name),this.Jc(t.metadata.readTime));var e,n,r},$a.prototype.Jc=Qo,$a);function $a(t){this.serializer=t}function Za(t,e){var n=this;this.$c=t,this.serializer=e,this.metadata=new Ia,this.buffer=new Uint8Array,this.Lc=new TextDecoder("utf-8"),this.Bc().then(function(t){t&&t.Mc()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Ja(t,e){this.payload=t,this.byteLength=e}function tc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function ec(t,e){this.progress=t,this.Yc=e}var nc=(oc.prototype.ta=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},oc.prototype.ea=function(t){for(var e=new Map,n=new Qa(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.zc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Ji()).add(s);e.set(c,h)}}return e},oc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:for(e=new Qa((n=l).serializer),r=Ji(),i=Wi,o=$i,s=0,u=p;s<u.length;s++)a=u[s],c=e.zc(a.metadata.name),a.document&&(r=r.add(c)),i=i.At(c,e.Hc(a)),o=o.At(c,e.Jc(a.metadata.readTime));return h=n.na.oo({co:!0}),[4,fc(n,Nu(wu(fi.nt("__bundle__/docs/"+d))))];case 1:return f=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return hc(e,h,i,hi.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Zo.No(e,f.targetId).next(function(){return n.Zo.ko(e,r,f.targetId)}).next(function(){return n.sa.ws(e,t)})})})]}})})}(this.Zc,this.documents,this.Xc.id)];case 1:e=t.sent(),n=this.ea(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Ji()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,fc(e,Nu(Ma(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Qo(i.readTime);if(0<=n.wt.u(e))return r.tc.Eo(t,i);e=n.Tt(Fr.h,e);return r.ra=r.ra.At(e.targetId,e),r.Zo.Co(t,e).next(function(){return r.Zo.No(t,n.targetId)}).next(function(){return r.Zo.ko(t,o,n.targetId)}).next(function(){return r.tc.Eo(t,i)})})]}})})}(this.Zc,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ec(Object.assign({},this.progress),e))]}})})},oc),rc=(ic.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.yr(t,n.ra)})},ic);function ic(t,e,n,r){this.persistence=t,this.ia=e,this.serializer=r,this.ra=new Mi(jr),this.oa=new fa(Li,Di),this.ca=hi.min(),this.cs=t.bc(n),this.na=t.Sc(),this.Zo=t.vc(),this.sa=new pa(this.na,this.cs,this.persistence.Dc()),this.tc=t.Cc(),this.ia.pr(this.sa)}function oc(t,e,n){this.Xc=t,this.Zc=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=tc(t)}function sc(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).cs,m=e.sa,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.cs.Qr(v).next(function(t){return g=t,n=e.persistence.bc(o),m=new pa(e.na,n,e.persistence.Dc()),n.Qr(v)}).next(function(t){for(var e=[],n=[],r=Ji(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.ds(v,r).next(function(t){return{aa:t,ua:e,ha:n}})})})];case 1:return r=t.sent(),[2,(e.cs=n,e.sa=m,e.ia.pr(e.sa),r)]}})})}function uc(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.na.oo({co:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=la.resolve(),n.forEach(function(n){u=u.next(function(){return o.Xn(r,n)}).next(function(t){var e=t,t=i.Cn.get(n);xr(null!==t),(!e||e.version.u(t)<0)&&(e=s.pn(n,e,i))&&o.zn(e,i.Dn)})}),u.next(function(){return e.cs.Wr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.cs.Hr(t)}).next(function(){return f.sa.ds(t,a)})})}function ac(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zo.Vo(t)})}function cc(t,r){var a=t,c=r.wt,h=a.ra;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.na.oo({co:!0});h=a.ra;var u=[];r.ce.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Zo.$o(s,t.Ee,e).next(function(){return a.Zo.ko(s,t.de,e)})),0<(i=t.resumeToken).o()&&(n=o.Tt(i,c).Et(s.qo),h=h.At(e,n),r=o,i=t,xr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.wt.B()-r.wt.B()||0<i.de.size+i.we.size+i.Ee.size)&&u.push(a.Zo.Co(s,n))))});var e,n=Wi;return r.ue.forEach(function(t,e){r.he.has(t)&&u.push(a.persistence.Nr.kc(s,t))}),u.push(hc(s,t,r.ue,c,void 0).next(function(t){n=t})),c.isEqual(hi.min())||(e=a.Zo.Vo(s).next(function(t){return a.Zo.bo(s,s.qo,c)}),u.push(e)),la.Qn(u).next(function(){return t.apply(s)}).next(function(){return a.sa.ws(s,n)})}).then(function(t){return a.ra=h,t})}function hc(t,s,e,u,a){var n=Ji();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Wi;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof pu&&e.version.isEqual(hi.min())?(s.Yn(t,r),o=o.At(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.zn(e,r),o=o.At(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function fc(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zo.Oo(e,r).next(function(t){return t?(n=t,la.resolve(n)):i.Zo.Ro(e).next(function(t){return n=new Ci(r,t,0,e.qo),i.Zo.vo(e,n).next(function(){return n})})})}).then(function(t){var e=i.ra.get(t.targetId);return(null===e||0<t.wt.u(e.wt))&&(i.ra=i.ra.At(t.targetId,t),i.oa.set(r,t.targetId)),t})}function lc(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ra.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Nr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ra(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ra=e.ra.remove(o),e.oa.delete(n.target),[2]}})})}function pc(t,o,s){var u=t,a=hi.min(),c=Ji();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Nu(o),(void 0!==(t=(i=t).oa.get(r))?la.resolve(i.ra.get(t)):i.Zo.Oo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zo.Bo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ia.Ts(e,o,s?a:hi.min(),s?c:Ji())}).next(function(t){return{documents:t,la:c}});var t,n,r,i})}function dc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function yc(t,e,n,r,i){var o=this;this.Zc=t,this.eu=e,this.Ei=n,this.nu={},this.su=[],this.iu=new Map,this.ru=new Set,this.ou=[],this.cu=i,this.cu.au(function(t){n.yi(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return xc(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(4),[4,Lc(e)];case 1:return t.sent(),e.uu.set("Unknown"),e.ru.delete(4),[4,Rc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.uu=new _c(n,r)}var vc,gc,mc,Te=(Oc.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},Oc.prototype.ma=function(){return 2===this.state},Oc.prototype.start=function(){3!==this.state?this.auth():this.Ia()},Oc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Oc.prototype.Aa=function(){this.state=0,this.Ci.reset()},Oc.prototype.Ra=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Ns.Ks(this._a,6e4,function(){return t.Pa()}))},Oc.prototype.ya=function(t){this.ga(),this.stream.send(t)},Oc.prototype.Pa=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Oc.prototype.ga=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Oc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ga(),this.Ci.cancel(),this.wa++,3!==e?this.Ci.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(kr(n.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),this.Ci.qs()):n&&n.code===Ir.UNAUTHENTICATED&&this.da.v(),null!==this.stream&&(this.Va(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.pa(n)];case 1:return t.sent(),[2]}})})},Oc.prototype.Va=function(){},Oc.prototype.auth=function(){var n=this;this.state=1;var t=this.ba(this.wa),e=this.wa;this.da.getToken().then(function(t){n.wa===e&&n.va(t)},function(e){t(function(){var t=new Nr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sa(t)})})},Oc.prototype.va=function(t){var e=this,n=this.ba(this.wa);this.stream=this.Da(t),this.stream.Ca(function(){n(function(){return e.state=2,e.listener.Ca()})}),this.stream.pa(function(t){n(function(){return e.Sa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Oc.prototype.Ia=function(){var t=this;this.state=4,this.Ci.Us(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Oc.prototype.Sa=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Oc.prototype.ba=function(e){var n=this;return function(t){n.Ns.yi(function(){return n.wa===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Oc),wc=(f(Nc,mc=Te),Nc.prototype.Da=function(t){return this.fa.xa("Listen",t)},Nc.prototype.onMessage=function(t){this.Ci.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Vr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.nn?(xr(void 0===s||"string"==typeof s),Fr.fromBase64String(s||"")):(xr(void 0===s||s instanceof Uint8Array),Fr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Ir.UNKNOWN:Ui(c.code),new Nr(a,c.message||"")),s=new ao(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=ts(t,n.document.name),i=Qo(n.document.updateTime);var u=new ru({mapValue:{fields:n.document.fields}}),a=(o=new lu(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new so(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=ts(t,n.document),i=n.readTime?Qo(n.readTime):hi.min(),u=new pu(r,i),o=n.removedTargetIds||[],s=new so([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=ts(t,n.document),i=n.removedTargetIds||[],s=new so([],i,r,null);else{if(!("filter"in e))return Vr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new ki(n),i=e.targetId,s=new uo(i,r)}return s}(this.serializer,t),t=function(t){if(!("targetChange"in t))return hi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Qo(t.readTime):hi.min()}(t);return this.listener.Na(e,t)},Nc.prototype.Fa=function(t){var e,n,r,i={};i.database=ns(this.serializer),i.addTarget=(e=this.serializer,(r=Si(r=(n=t).target)?{documents:{documents:[es(e,r.path)]}}:{query:ss(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Xo(e,n.resumeToken):0<n.wt.u(hi.min())&&(r.readTime=Yo(e,n.wt.q())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.dt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ya(i)},Nc.prototype.Oa=function(t){var e={};e.database=ns(this.serializer),e.removeTarget=t,this.ya(e)},Nc),bc=(f(Ic,gc=Te),Object.defineProperty(Ic.prototype,"Ma",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Ic.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,gc.prototype.start.call(this)},Ic.prototype.Va=function(){this.ka&&this.$a([])},Ic.prototype.Da=function(t){return this.fa.xa("Write",t)},Ic.prototype.onMessage=function(t){if(xr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Ci.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(xr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Qo(t.updateTime):Qo(e);n.isEqual(hi.min())&&(n=Qo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Cs(n,e)}(t,r)})):[]),n=Qo(t.commitTime);return this.listener.La(n,e)}var n,r;return xr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Ba()},Ic.prototype.qa=function(){var t={};t.database=ns(this.serializer),this.ya(t)},Ic.prototype.$a=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return os(e.serializer,t)})};this.ya(t)},Ic),Ec=(f(Ac,vc=function(){}),Ac.prototype.Qa=function(){if(this.Ua)throw new Nr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Ac.prototype.Ka=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.v(),t})},Ac.prototype.Wa=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Wa(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.v(),t})},Ac.prototype.terminate=function(){this.Ua=!1},Ac),_c=(Tc.prototype.Ja=function(){var t=this;0===this.Ga&&(this.Ya("Unknown"),this.za=this.Ei.Ks("online_state_timeout",1e4,function(){return t.za=null,t.Xa("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},Tc.prototype.Za=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ga++,1<=this.Ga&&(this.tu(),this.Xa("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},Tc.prototype.set=function(t){this.tu(),this.Ga=0,"Online"===t&&(this.Ha=!1),this.Ya(t)},Tc.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},Tc.prototype.Xa=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ha?(kr(t),this.Ha=!1):Sr("OnlineStateTracker",t)},Tc.prototype.tu=function(){null!==this.za&&(this.za.cancel(),this.za=null)},Tc);function Tc(t,e){this.Ei=t,this.ja=e,this.state="Unknown",this.Ga=0,this.za=null,this.Ha=!0}function Ac(t,e,n){var r=this;return(r=vc.call(this)||this).credentials=t,r.fa=e,r.serializer=n,r.Ua=!1,r}function Ic(t,e,n,r,i){var o=this;return(o=gc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function Nc(t,e,n,r,i){var o=this;return(o=mc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Oc(t,e,n,r,i,o){this.Ns=t,this._a=n,this.fa=r,this.da=i,this.listener=o,this.state=0,this.wa=0,this.Ea=null,this.stream=null,this.Ci=new Na(t,e)}function Rc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!xc(r))return[3,4];e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Lc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Dc(t,e){t.iu.has(e.targetId)||(t.iu.set(e.targetId,e),Vc(t)?Cc(t):zc(t).ma()&&kc(t,e))}function Sc(t,e){var n=t,t=zc(n);n.iu.delete(e),t.ma()&&Pc(n,e),0===n.iu.size&&(t.ma()?t.Ra():xc(n)&&n.uu.set("Unknown"))}function kc(t,e){t.hu.xe(e.targetId),zc(t).Fa(e)}function Pc(t,e){t.hu.xe(e),zc(t).Oa(e)}function Cc(e){e.hu=new ho({tn:function(t){return e.nu.tn(t)},en:function(t){return e.iu.get(t)||null}}),zc(e).start(),e.uu.Ja()}function Vc(t){return xc(t)&&!zc(t).Ta()&&0<t.iu.size}function xc(t){return 0===t.ru.size}function Uc(t){t.hu=void 0}function Mc(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.uu.set("Online"),!(u instanceof ao&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.iu.has(i)?[4,o.nu.lu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.iu.delete(i),o.hu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,jc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof so?s.hu.Be(u):u instanceof uo?s.hu.ze(u):s.hu.Qe(u),a.isEqual(hi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ac(s.Zc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).hu.Ye(i)).ce.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.iu.get(e))&&r.iu.set(e,n.Tt(t.resumeToken,i)))}),e.ae.forEach(function(t){var e=r.iu.get(t);e&&(r.iu.set(t,e.Tt(Fr.h,e.wt)),Pc(r,t),e=new Ci(e.target,t,1,e.sequenceNumber),kc(r,e))}),r.nu._u(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,jc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function jc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ra(r))throw r;return n.ru.add(1),[4,Lc(n)];case 1:return t.sent(),n.uu.set("Offline"),i=i||function(){return ac(n.Zc)},n.Ei.$i(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ru.delete(1),[4,Rc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function qc(e,n){return n().catch(function(t){return jc(e,t,n)})}function Fc(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Hc(i=a),s=0<i.su.length?i.su[i.su.length-1].batchId:-1,t.label=1;case 1:if(!(xc(i)&&i.su.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Zc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.cs.qr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.su.length&&o.Ra(),[3,7]):(s=u.batchId,function(t,e){t.su.push(e);t=Hc(t);t.ma()&&t.Ma&&t.$a(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,jc(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Bc(i)&&Gc(i),[2]}var e,n,r})})}function Bc(t){return xc(t)&&!Hc(t).Ta()&&0<t.su.length}function Gc(t){Hc(t).start()}function zc(n){var t,e,r,i=this;return n.wu||(n.wu=(t=n.eu,e=n.Ei,r={Ca:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.iu.forEach(function(t,e){kc(n,t)}),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Uc(e),Vc(e)?(e.uu.Za(n),Cc(e)):e.uu.set("Unknown"),[2]})})}.bind(null,n),Na:Mc.bind(null,n)},t.Qa(),new wc(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.wu.Aa(),Vc(n)?Cc(n):n.uu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.wu.stop()];case 2:t.sent(),Uc(n),t.label=3;case 3:return[2]}})})})),n.wu}function Hc(n){var t,e,r,i=this;return n.Eu||(n.Eu=(t=n.eu,e=n.Ei,r={Ca:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Hc(e).qa(),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Hc(e).Ma?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return xi(n=i.code)&&n!==Ir.ABORTED?(e=r.su.shift(),Hc(r).Aa(),[4,qc(r,function(){return r.nu.du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Fc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Bc(e)&&Gc(e),[2]}})})}.bind(null,n),Ba:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Hc(o),n=0,r=o.su;n<r.length;n++)i=r[n],e.$a(i.mutations);return[2]})})}.bind(null,n),La:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.su.shift(),n=ha.from(e,i,o),[4,qc(r,function(){return r.nu.fu(n)})];case 1:return t.sent(),[4,Fc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qa(),new bc(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Eu.Aa(),[4,Fc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Eu.stop()];case 3:t.sent(),0<n.su.length&&(Sr("RemoteStore","Stopping write stream with "+n.su.length+" pending writes"),n.su=[]),t.label=4;case 4:return[2]}})})})),n.Eu}function Kc(){this.queries=new fa(Lu,Ru),this.onlineState="Unknown",this.mu=new Set}var Wc=function(){this.Tu=void 0,this.listeners=[]};function Yc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Wc),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Iu(n)];case 2:return o.Tu=t.sent(),[3,4];case 3:return o=t.sent(),o=Ca(o,"Initialization of query '"+Du(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Au(e.onlineState),i.Tu&&u.Ru(i.Tu)&&Qc(e),[2]}})})}function Xc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Pu(n))]:[2]})})}function Qc(t){t.mu.forEach(function(t){t.next()})}var $c=(dh.prototype.Ru=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ro(t.query,t.docs,t.ne,e,t.se,t.fromCache,t.ie,!0)}var o=!1;return this.gu?this.pu(t)&&(this.yu.next(t),o=!0):this.bu(t,this.onlineState)&&(this.vu(t),o=!0),this.Vu=t,o},dh.prototype.onError=function(t){this.yu.error(t)},dh.prototype.Au=function(t){this.onlineState=t;var e=!1;return this.Vu&&!this.gu&&this.bu(this.Vu,t)&&(this.vu(this.Vu),e=!0),e},dh.prototype.bu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Su&&n||t.docs.Y()&&"Offline"!==e)},dh.prototype.pu=function(t){if(0<t.docChanges.length)return!0;var e=this.Vu&&this.Vu.hasPendingWrites!==t.hasPendingWrites;return!(!t.ie&&!e)&&!0===this.options.includeMetadataChanges},dh.prototype.vu=function(t){t=ro.oe(t.query,t.docs,t.se,t.fromCache),this.gu=!0,this.yu.next(t)},dh),Zc=(ph.prototype.Y=function(){return this.Du.Y()},ph.prototype.Mo=function(t,e){e=new Jc(t,e);this.Du=this.Du.add(e),this.xu=this.xu.add(e)},ph.prototype.Fu=function(t,e){var n=this;t.forEach(function(t){return n.Mo(t,e)})},ph.prototype.Lo=function(t,e){this.Ou(new Jc(t,e))},ph.prototype.ku=function(t,e){var n=this;t.forEach(function(t){return n.Lo(t,e)})},ph.prototype.Mu=function(t){var e=this,n=new di(new fi([])),r=new Jc(n,t),t=new Jc(n,t+1),i=[];return this.xu.jt([r,t],function(t){e.Ou(t),i.push(t.key)}),i},ph.prototype.$u=function(){var e=this;this.Du.forEach(function(t){return e.Ou(t)})},ph.prototype.Ou=function(t){this.Du=this.Du.delete(t),this.xu=this.xu.delete(t)},ph.prototype.Lu=function(t){var e=new di(new fi([])),n=new Jc(e,t),t=new Jc(e,t+1),r=Ji();return this.xu.jt([n,t],function(t){r=r.add(t.key)}),r},ph.prototype.Jr=function(t){var e=new Jc(t,0),e=this.Du.zt(e);return null!==e&&t.isEqual(e.key)},ph),Jc=(lh.Cu=function(t,e){return di.K(t.key,e.key)||jr(t.Bu,e.Bu)},lh.Nu=function(t,e){return jr(t.Bu,e.Bu)||di.K(t.key,e.key)},lh),th=(fh.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},fh.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},fh.prototype.Uu=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},fh),eh=(hh.prototype.lh=function(t){},hh.prototype.fh=function(t,e,n){},hh.prototype.wh=function(t){return this.Lh.Qu(t),this.Bh[t]||"not-current"},hh.prototype.Ah=function(t,e,n){this.Bh[t]=e},hh.prototype.Th=function(t){this.Lh.Ku(t)},hh.prototype.mh=function(t){return this.Lh.activeTargetIds.has(t)},hh.prototype.Ih=function(t){delete this.Bh[t]},hh.prototype.ah=function(){return this.Lh.activeTargetIds},hh.prototype.hh=function(t){return this.Lh.activeTargetIds.has(t)},hh.prototype.start=function(){return this.Lh=new th,Promise.resolve()},hh.prototype.Ph=function(t,e,n){},hh.prototype.yh=function(t){},hh.prototype.Ac=function(){},hh.prototype.Cs=function(t){},hh.prototype.Vh=function(){},hh),nh=function(t){this.key=t},rh=function(t){this.key=t},ih=(Object.defineProperty(ch.prototype,"jh",{get:function(){return this.qh},enumerable:!1,configurable:!0}),ch.prototype.Gh=function(t,e){var s=this,u=e?e.zh:new no,a=(e||this).Wh,c=(e||this).se,h=a,f=!1,l=bu(this.query)&&a.size===this.query.limit?a.last():null,p=Eu(this.query)&&a.size===this.query.limit?a.first():null;if(t.gt(function(t,e){var n=a.get(t),r=(r=e instanceof lu?e:null)&&(Su(s.query,r)?r:null),i=!!n&&s.se.has(n.key),o=!!r&&(r.ln||s.se.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Hh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Kh(r,l)||p&&s.Kh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),bu(this.query)||Eu(this.query))for(;h.size>this.query.limit;){var n=bu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Wh:h,zh:u,Dr:f,se:c}},ch.prototype.Hh=function(t,e){return t.ln&&e.hasCommittedMutations&&!e.ln},ch.prototype.es=function(t,e,n){var o=this,r=this.Wh;this.Wh=t.Wh,this.se=t.se;var i=t.zh.ee();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Kh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this.Jh(n);var s=e?this.Yh():[],n=0===this.Qh.size&&this.fe?1:0,e=n!==this.Uh;return this.Uh=n,0!==i.length||e?{snapshot:new ro(this.query,t.Wh,r,i,t.se,0==n,e,!1),Xh:s}:{Xh:s}},ch.prototype.Au=function(t){return this.fe&&"Offline"===t?(this.fe=!1,this.es({Wh:this.Wh,zh:new no,se:this.se,Dr:!1},!1)):{Xh:[]}},ch.prototype.Zh=function(t){return!this.qh.has(t)&&!!this.Wh.has(t)&&!this.Wh.get(t).ln},ch.prototype.Jh=function(t){var e=this;t&&(t.de.forEach(function(t){return e.qh=e.qh.add(t)}),t.we.forEach(function(t){}),t.Ee.forEach(function(t){return e.qh=e.qh.delete(t)}),this.fe=t.fe)},ch.prototype.Yh=function(){var e=this;if(!this.fe)return[];var n=this.Qh;this.Qh=Ji(),this.Wh.forEach(function(t){e.Zh(t.key)&&(e.Qh=e.Qh.add(t.key))});var r=[];return n.forEach(function(t){e.Qh.has(t)||r.push(new rh(t))}),this.Qh.forEach(function(t){n.has(t)||r.push(new nh(t))}),r},ch.prototype.tl=function(t){this.qh=t.la,this.Qh=Ji();t=this.Gh(t.documents);return this.es(t,!0)},ch.prototype.el=function(){return ro.oe(this.query,this.Wh,this.se,0===this.Uh)},ch),oh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},sh=function(t){this.key=t,this.nl=!1},uh=(Object.defineProperty(ah.prototype,"ml",{get:function(){return!0===this.Tl},enumerable:!1,configurable:!0}),ah);function ah(t,e,n,r,i,o){this.Zc=t,this.sl=e,this.il=n,this.rl=r,this.currentUser=i,this.ol=o,this.cl={},this.al=new fa(Lu,Ru),this.ul=new Map,this.hl=[],this.ll=new Mi(di.K),this._l=new Map,this.fl=new Zc,this.dl={},this.wl=new Map,this.El=Fa.Ao(),this.onlineState="Unknown",this.Tl=void 0}function ch(t,e){this.query=t,this.qh=e,this.Uh=null,this.fe=!1,this.Qh=Ji(),this.se=Ji(),this.Kh=ku(t),this.Wh=new eo(this.Kh)}function hh(){this.Lh=new th,this.Bh={},this.ja=null,this.vs=null}function fh(){this.activeTargetIds=to}function lh(t,e){this.key=t,this.Bu=e}function ph(){this.Du=new Hi(Jc.Cu),this.xu=new Hi(Jc.Nu)}function dh(t,e,n){this.query=t,this.yu=e,this.gu=!1,this.Vu=null,this.onlineState="Unknown",this.options=n||{}}function yh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).sl.nu._u=gh.bind(null,e),e.sl.nu.tn=function(t,e){var n=t,t=n._l.get(e);if(t&&t.nl)return Ji().add(t.key);var r=Ji(),e=n.ul.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.al.get(s);r=r.Ht(s.view.jh)}return r}.bind(null,e),e.sl.nu.lu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).rl.Ah(s,"rejected",u),i=e._l.get(s),(n=i&&i.key)?(r=(r=new Mi(di.K)).At(n,new pu(n,hi.min())),i=Ji().add(n),i=new io(hi.min(),new Map,new Hi(jr),r,i),[4,gh(e,i)]):[3,2];case 1:return t.sent(),e.ll=e.ll.remove(n),e._l.delete(s),Ih(e),[3,4];case 2:return[4,lc(e.Zc,s,!1).then(function(){return _h(e,s,u)}).catch(dc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.cl.Na=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ru(s)&&(r=!0);u.Tu=s}}r&&Qc(n)}.bind(null,e.il),e.cl.Al=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.il),(s=(n=e).al.get(a))?(r=s.targetId,n.rl.wh(r),i=s.view.el(),[3,4]):[3,1];case 1:return[4,fc(n.Zc,Nu(a))];case 2:return o=t.sent(),s=n.rl.wh(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Il=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Gh(o)).Dr?[4,pc(r.Zc,i.query,!1).then(function(t){t=t.documents;return i.view.Gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.ce.get(i.targetId),n=i.view.es(e,r.ml,n),[2,(Ah(r,i.targetId,n.Xh),n.snapshot)]}})})}(i,t,e,n)},[4,pc(i.Zc,o,!0)];case 1:return n=t.sent(),r=new ih(o,n.la),e=r.Gh(n.documents),n=oo._e(s,u&&"Offline"!==i.onlineState),n=r.es(e,i.ml,n),Ah(i,s,n.Xh),r=new oh(o,s,r),[2,(i.al.set(o,r),i.ul.has(s)?i.ul.get(s).push(o):i.ul.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.ml&&Dc(n.sl,o),t.label=4;case 4:return[2,i]}var e})})}function vh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).sl.nu.fu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,uc(e.Zc,o)];case 2:return r=t.sent(),Eh(e,n,null),bh(e,n),e.rl.fh(n,"acknowledged"),[4,Nh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.sl.nu.du=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.cs.Lr(e,r).next(function(t){return xr(null!==t),n=t.keys(),i.cs.Wr(e,t)}).next(function(){return i.cs.Hr(e)}).next(function(){return i.sa.ds(e,n)})}))];case 2:return o=t.sent(),Eh(n,u,a),bh(n,u),n.rl.fh(u,"rejected",a),[4,Nh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Zc,a=p,h=r,f=ci.now(),i=a.reduce(function(t,e){return t.add(e.key)},Ji()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.sa.ds(u,i).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Qs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof lu?t.field(i.field):void 0,o=ds(i.transform,o||null);null!=o&&(e=(null==e?new iu:e).set(i.field,o))}return e?e._n():null}(o):null);null!=o&&e.push(new Hs(i.key,o,function s(t){var u=[];return _o(t.fields||{},function(t,e){var n=new pi([t]);if(Fo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ks(u)}(o.proto.mapValue),Vs.exists(!0)))}return h.cs.Mr(u,f,e,a)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Wn:e}}))];case 2:return s=t.sent(),u.rl.lh(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.dl[e.currentUser.R()])||new Mi(jr)).At(n,o),e.dl[e.currentUser.R()]=r,[4,Nh(u,s.Wn)];case 3:return t.sent(),[4,Fc(u.sl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ca(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function gh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,cc(n.Zc,i)];case 2:return e=t.sent(),i.ce.forEach(function(t,e){e=n._l.get(e);e&&(xr(t.de.size+t.we.size+t.Ee.size<=1),0<t.de.size?e.nl=!0:0<t.we.size?xr(e.nl):0<t.Ee.size&&(xr(e.nl),e.nl=!1))}),[4,Nh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function mh(t,n,e){var r,t=t;(t.ml&&0===e||!t.ml&&1===e)&&(r=[],t.al.forEach(function(t,e){e=e.view.Au(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Au(i)&&(o=!0)}),o&&Qc(t)}(t.il,n),r.length&&t.cl.Na(r),t.onlineState=n,t.ml&&t.rl.yh(n))}function wh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:xc((n=o).sl)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Zc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.cs.Ur(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.wl.get(r)||[]).push(s),n.wl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ca(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function bh(t,e){(t.wl.get(e)||[]).forEach(function(t){t.resolve()}),t.wl.delete(e)}function Eh(t,e,n){var r=t,i=r.dl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.dl[r.currentUser.R()]=i)}function _h(e,t,n){void 0===n&&(n=null),e.rl.Th(t);for(var r=0,i=e.ul.get(t);r<i.length;r++){var o=i[r];e.al.delete(o),n&&e.cl.Al(o,n)}e.ul.delete(t),e.ml&&e.fl.Mu(t).forEach(function(t){e.fl.Jr(t)||Th(e,t)})}function Th(t,e){var n=t.ll.get(e);null!==n&&(Sc(t.sl,n),t.ll=t.ll.remove(e),t._l.delete(n),Ih(t))}function Ah(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof nh?(t.fl.Mo(o.key,e),function(t,e){e=e.key;t.ll.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.hl.push(e),Ih(t))}(t,o)):o instanceof rh?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.fl.Lo(o.key,e),t.fl.Jr(o.key)||Th(t,o.key)):Vr()}}function Ih(t){for(;0<t.hl.length&&t.ll.size<t.ol;){var e=t.hl.shift(),n=t.El.next();t._l.set(n,new sh(e)),t.ll=t.ll.At(e,n),Dc(t.sl,new Ci(Nu(wu(e.path)),n,2,ya.xs))}}function Nh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).al.Y()?[3,3]:(n.al.forEach(function(t,e){o.push(n.Il(e,s,u).then(function(t){t&&(n.ml&&n.rl.Ah(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=da.bs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.cl.Na(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return la.forEach(c,function(e){return la.forEach(e.Vs,function(t){return r.persistence.Nr.Mo(n,e.targetId,t)}).next(function(){return la.forEach(e.ps,function(t){return r.persistence.Nr.Lo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ra.get(o),u=s.wt,u=s.It(u),r.ra=r.ra.At(o,u));return[2]}})})}(n.Zc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Oh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.R()),[4,sc(n.Zc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).wl.forEach(function(t){t.forEach(function(t){t.reject(new Nr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.wl.clear(),n.rl.Ph(o,r.ua,r.ha),[4,Nh(n,r.aa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Rh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Zc,i=u,s=new Qa((o=r).serializer).Jc(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.tc._o(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Rl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Pl(tc(u)),a=new nc(u,l.Zc,p.serializer),[4,p.Uc()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ta(c)]:[3,10];case 7:return(h=t.sent())&&d.Pl(h),[4,p.Uc()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Nh(l,f.Yc,void 0)];case 12:return t.sent(),[4,(r=l.Zc,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.tc.fo(t,e)}))];case 13:return t.sent(),d.Rl(f.progress),[3,15];case 14:return Pr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.yl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.rl.Vh()})}var Lh,Dh,Sh,kh=(hf.prototype.kr=function(t){return la.resolve(0===this.cs.length)},hf.prototype.Mr=function(t,e,n,r){var i=this.gl;this.gl++,0<this.cs.length&&this.cs[this.cs.length-1];n=new ca(i,e,n,r);this.cs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Vl=this.Vl.add(new Jc(u.key,i)),this.us.$r(t,u.key.path.G())}return la.resolve(n)},hf.prototype.Lr=function(t,e){return la.resolve(this.pl(e))},hf.prototype.qr=function(t,e){e+=1,e=this.bl(e),e=e<0?0:e;return la.resolve(this.cs.length>e?this.cs[e]:null)},hf.prototype.Ur=function(){return la.resolve(0===this.cs.length?-1:this.gl-1)},hf.prototype.Qr=function(t){return la.resolve(this.cs.slice())},hf.prototype.ls=function(t,e){var n=this,r=new Jc(e,0),e=new Jc(e,Number.POSITIVE_INFINITY),i=[];return this.Vl.jt([r,e],function(t){t=n.pl(t.Bu);i.push(t)}),la.resolve(i)},hf.prototype.Es=function(t,e){var n=this,r=new Hi(jr);return e.forEach(function(t){var e=new Jc(t,0),t=new Jc(t,Number.POSITIVE_INFINITY);n.Vl.jt([e,t],function(t){r=r.add(t.Bu)})}),la.resolve(this.vl(r))},hf.prototype.ys=function(t,e){var n=e.path,r=n.length+1,e=n;di.lt(e)||(e=e.child(""));var e=new Jc(new di(e),0),i=new Hi(jr);return this.Vl.Gt(function(t){var e=t.key.path;return!!n.X(e)&&(e.length===r&&(i=i.add(t.Bu)),!0)},e),la.resolve(this.vl(i))},hf.prototype.vl=function(t){var e=this,n=[];return t.forEach(function(t){t=e.pl(t);null!==t&&n.push(t)}),n},hf.prototype.Wr=function(n,r){var i=this;xr(0===this.Sl(r.batchId,"removed")),this.cs.shift();var o=this.Vl;return la.forEach(r.mutations,function(t){var e=new Jc(t.key,r.batchId);return o=o.delete(e),i.Nr.zr(n,t.key)}).next(function(){i.Vl=o})},hf.prototype.Gr=function(t){},hf.prototype.Jr=function(t,e){var n=new Jc(e,0),n=this.Vl.zt(n);return la.resolve(e.isEqual(n&&n.key))},hf.prototype.Hr=function(t){return this.cs.length,la.resolve()},hf.prototype.Sl=function(t,e){return this.bl(t)},hf.prototype.bl=function(t){return 0===this.cs.length?0:t-this.cs[0].batchId},hf.prototype.pl=function(t){t=this.bl(t);return t<0||t>=this.cs.length?null:this.cs[t]},hf),Ph=(cf.prototype.zn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Dl(e);return this.docs=this.docs.At(r,{Jn:e,size:i,readTime:n}),this.size+=i-o,this.us.$r(t,r.path.G())},cf.prototype.Yn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},cf.prototype.Xn=function(t,e){e=this.docs.get(e);return la.resolve(e?e.Jn:null)},cf.prototype.getEntries=function(t,e){var n=this,r=Wi;return e.forEach(function(t){var e=n.docs.get(t);r=r.At(t,e?e.Jn:null)}),la.resolve(r)},cf.prototype.Ts=function(t,e,n){for(var r=Qi,i=new di(e.path.child("")),o=this.docs.vt(i);o.Ft();){var s=o.Nt(),u=s.key,a=s.value,s=a.Jn,a=a.readTime;if(!e.path.X(u.path))break;a.u(n)<=0||s instanceof lu&&Su(e,s)&&(r=r.At(s.key,s))}return la.resolve(r)},cf.prototype.Cl=function(t,e){return la.forEach(this.docs,function(t){return e(t)})},cf.prototype.oo=function(t){return new Ch(this)},cf.prototype.ao=function(t){return la.resolve(this.size)},cf),Ch=(f(af,Sh=o),af.prototype.es=function(n){var r=this,i=[];return this.Wn.forEach(function(t,e){e&&e.Jn?i.push(r.uo.zn(n,e.Jn,r.Gn(t))):r.uo.Yn(t)}),la.Qn(i)},af.prototype.Zn=function(t,e){return this.uo.Xn(t,e)},af.prototype.ts=function(t,e){return this.uo.getEntries(t,e)},af),Vh=(uf.prototype.Ke=function(t,n){return this.xl.forEach(function(t,e){return n(e)}),la.resolve()},uf.prototype.Vo=function(t){return la.resolve(this.lastRemoteSnapshotVersion)},uf.prototype.po=function(t){return la.resolve(this.Nl)},uf.prototype.Ro=function(t){return this.highestTargetId=this.Ol.next(),la.resolve(this.highestTargetId)},uf.prototype.bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Nl&&(this.Nl=e),la.resolve()},uf.prototype.So=function(t){this.xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ol=new Fa(e),this.highestTargetId=e),t.sequenceNumber>this.Nl&&(this.Nl=t.sequenceNumber)},uf.prototype.vo=function(t,e){return this.So(e),this.targetCount+=1,la.resolve()},uf.prototype.Co=function(t,e){return this.So(e),la.resolve()},uf.prototype.xo=function(t,e){return this.xl.delete(e.target),this.Fl.Mu(e.targetId),--this.targetCount,la.resolve()},uf.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return this.xl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.xl.delete(t),u.push(o.No(n,e.targetId)),s++)}),la.Qn(u).next(function(){return s})},uf.prototype.Fo=function(t){return la.resolve(this.targetCount)},uf.prototype.Oo=function(t,e){e=this.xl.get(e)||null;return la.resolve(e)},uf.prototype.ko=function(t,e,n){return this.Fl.Fu(e,n),la.resolve()},uf.prototype.$o=function(e,t,n){this.Fl.ku(t,n);var r=this.persistence.Nr,i=[];return r&&t.forEach(function(t){i.push(r.zr(e,t))}),la.Qn(i)},uf.prototype.No=function(t,e){return this.Fl.Mu(e),la.resolve()},uf.prototype.Bo=function(t,e){e=this.Fl.Lu(e);return la.resolve(e)},uf.prototype.Jr=function(t,e){return la.resolve(this.Fl.Jr(e))},uf),xh=(sf.prototype._o=function(t,e){return la.resolve(this.kl.get(e))},sf.prototype.fo=function(t,e){return this.kl.set(e.id,{id:e.id,version:e.version,createTime:Qo(e.createTime)}),la.resolve()},sf.prototype.wo=function(t,e){return la.resolve(this.Ml.get(e))},sf.prototype.Eo=function(t,e){return this.Ml.set(e.name,{name:(e=e).name,query:Ma(e.bundledQuery),readTime:Qo(e.readTime)}),la.resolve()},sf),Uh=(of.prototype.start=function(){return Promise.resolve()},of.prototype.Ac=function(){return this.Wo=!1,Promise.resolve()},Object.defineProperty(of.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),of.prototype.cc=function(){},of.prototype.ac=function(){},of.prototype.Dc=function(){return this.us},of.prototype.bc=function(t){var e=this.$l[t.R()];return e||(e=new kh(this.us,this.Nr),this.$l[t.R()]=e),e},of.prototype.vc=function(){return this.Zo},of.prototype.Sc=function(){return this.os},of.prototype.Cc=function(){return this.tc},of.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Mh(this.Ko.next());return this.Nr.Bl(),n(i).next(function(t){return r.Nr.ql(i).next(function(){return t})}).qn().then(function(t){return i.rs(),t})},of.prototype.Ul=function(e,n){return la.Kn(Object.values(this.$l).map(function(t){return function(){return t.Jr(e,n)}}))},of),Mh=(f(rf,Dh=_e),rf),jh=(nf.Wl=function(t){return new nf(t)},Object.defineProperty(nf.prototype,"jl",{get:function(){if(this.Kl)return this.Kl;throw Vr()},enumerable:!1,configurable:!0}),nf.prototype.Mo=function(t,e,n){return this.Ql.Mo(n,e),this.jl.delete(n.toString()),la.resolve()},nf.prototype.Lo=function(t,e,n){return this.Ql.Lo(n,e),this.jl.add(n.toString()),la.resolve()},nf.prototype.zr=function(t,e){return this.jl.add(e.toString()),la.resolve()},nf.prototype.removeTarget=function(t,e){var n=this;this.Ql.Mu(e.targetId).forEach(function(t){return n.jl.add(t.toString())});var r=this.persistence.vc();return r.Bo(t,e.targetId).next(function(t){t.forEach(function(t){return n.jl.add(t.toString())})}).next(function(){return r.xo(t,e)})},nf.prototype.Bl=function(){this.Kl=new Set},nf.prototype.ql=function(n){var r=this,i=this.persistence.Sc().oo();return la.forEach(this.jl,function(t){var e=di.at(t);return r.Gl(n,e).next(function(t){t||i.Yn(e)})}).next(function(){return r.Kl=null,i.apply(n)})},nf.prototype.kc=function(t,e){var n=this;return this.Gl(t,e).next(function(t){t?n.jl.delete(e.toString()):n.jl.add(e.toString())})},nf.prototype.Ll=function(t){return 0},nf.prototype.Gl=function(t,e){var n=this;return la.Kn([function(){return la.resolve(n.Ql.Jr(e))},function(){return n.persistence.vc().Jr(t,e)},function(){return n.persistence.Ul(t,e)}])},nf),qh=(ef.prototype.Ca=function(t){this.Jl=t},ef.prototype.pa=function(t){this.Yl=t},ef.prototype.onMessage=function(t){this.Xl=t},ef.prototype.close=function(){this.Hl()},ef.prototype.send=function(t){this.zl(t)},ef.prototype.Zl=function(){this.Jl()},ef.prototype.t_=function(t){this.Yl(t)},ef.prototype.e_=function(t){this.Xl(t)},ef),Fh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bh=(tf.prototype.Ka=function(e,t,n,r){var i=this.r_(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.o_(t,r),this.c_(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},tf.prototype.Wa=function(t,e,n,r){return this.Ka(t,e,n,r)},tf.prototype.o_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1-BundlePrerelease.f8bb4d8b7",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},tf.prototype.r_=function(t,e){t=Fh[t];return this.s_+"/v1/"+e+":"+t},f(Jh,Lh=tf),Jh.prototype.c_=function(o,e,s,u){return new Promise(function(n,r){var i=new Ar;i.listenOnce(wr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case mr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case mr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Nr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case mr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Nr(e,t.message))):r(new Nr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Nr(Ir.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Jh.prototype.xa=function(t,e){var n,r=[this.s_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=gr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.o_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new qh({zl:function(t){a?Sr("Connection","Not sending because WebChannel is closed:",t):(u||(Sr("Connection","Opening WebChannel transport."),s.open(),u=!0),Sr("Connection","WebChannel sending:",t),s.send(t))},Hl:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Tr.EventType.OPEN,function(){a||Sr("Connection","WebChannel transport opened.")}),t(s,Tr.EventType.CLOSE,function(){a||(a=!0,Sr("Connection","WebChannel transport closed"),c.t_())}),t(s,Tr.EventType.ERROR,function(t){a||(a=!0,Pr("Connection","WebChannel transport errored:",t),c.t_(new Nr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(s,Tr.EventType.MESSAGE,function(t){var e,n,r,i;a||(xr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Pi[r];if(void 0!==t)return Ui(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.t_(new Nr(t,i)),s.close()):(Sr("Connection","WebChannel received:",e),c.e_(e)))}),t(o,br.STAT_EVENT,function(t){t.stat===Er?Sr("Connection","Detected buffering proxy"):t.stat===_r&&Sr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Zl()},0),c},Jh),Gh=(Zh.prototype.au=function(t){this.__.push(t)},Zh.prototype.Ac=function(){window.removeEventListener("online",this.a_),window.removeEventListener("offline",this.h_)},Zh.prototype.f_=function(){window.addEventListener("online",this.a_),window.addEventListener("offline",this.h_)},Zh.prototype.u_=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(0)},Zh.prototype.l_=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(1)},Zh.Hs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Zh),zh=($h.prototype.au=function(t){},$h.prototype.Ac=function(){},$h),Hh=(Qh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Wa(e.n_.T),this.rl=this.d_(e),this.persistence=this.w_(e),[4,this.persistence.start()];case 1:return t.sent(),this.E_=this.T_(e),this.Zc=this.m_(e),[2]}})})},Qh.prototype.T_=function(t){return null},Qh.prototype.m_=function(t){return e=this.persistence,n=new xa,r=t.I_,t=this.serializer,new rc(e,n,r,t);var e,n,r},Qh.prototype.w_=function(t){return new Uh(jh.Wl,this.serializer)},Qh.prototype.d_=function(t){return new eh},Qh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.E_&&this.E_.stop(),[4,this.rl.Ac()];case 1:return t.sent(),[4,this.persistence.Ac()];case 2:return t.sent(),[2]}})})},Qh),Kh=(Xh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Zc?[3,2]:(this.Zc=n.Zc,this.rl=n.rl,this.eu=this.R_(r),this.sl=this.P_(r),this.il=this.y_(r),this.ju=this.g_(r,!n.synchronizeTabs),this.rl.ja=function(t){return mh(e.ju,t,1)},this.sl.nu.V_=Oh.bind(null,this.ju),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ru.delete(2),[4,Rc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ru.add(2),[4,Lc(e)]);case 3:t.sent(),e.uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.sl,this.ju.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xh.prototype.y_=function(t){return new Kc},Xh.prototype.R_=function(t){var e=Wa(t.n_.T),n=(n=t.n_,new Bh(n));return t=t.credentials,new Ec(t,n,e)},Xh.prototype.P_=function(t){var e=this,n=this.Zc,r=this.eu,i=t.Ei,o=function(t){return mh(e.ju,t,0)},t=new(Gh.Hs()?Gh:zh);return new yc(n,r,i,o,t)},Xh.prototype.g_=function(t,e){return function(t,e,n,r,i,o,s){o=new uh(t,e,n,r,i,o);return s&&(o.Tl=!0),o}(this.Zc,this.sl,this.il,this.rl,t.I_,t.ol,e)},Xh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.ru.add(5),[4,Lc(e)];case 1:return t.sent(),e.cu.Ac(),e.uu.set("Unknown"),[2]}})})}(this.sl)},Xh),Wh=(Yh.prototype.next=function(t){this.observer.next&&this.p_(this.observer.next,t)},Yh.prototype.error=function(t){this.observer.error?this.p_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Yh.prototype.b_=function(){this.muted=!0},Yh.prototype.p_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Yh);function Yh(t){this.observer=t,this.muted=!1}function Xh(){}function Qh(){this.synchronizeTabs=!1}function $h(){}function Zh(){var t=this;this.a_=function(){return t.u_()},this.h_=function(){return t.l_()},this.__=[],this.f_()}function Jh(t){var e=this;return(e=Lh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function tf(t){this.n_=t,this.T=t.T;var e=t.ssl?"https":"http";this.s_=e+"://"+t.host,this.i_="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function ef(t){this.zl=t.zl,this.Hl=t.Hl}function nf(t){this.persistence=t,this.Ql=new Zc,this.Kl=null}function rf(t){var e=this;return(e=Dh.call(this)||this).qo=t,e}function of(t,e){var n=this;this.$l={},this.Ko=new ya(0),this.Wo=!1,this.Wo=!0,this.Nr=t(this),this.Zo=new Vh(this),this.us=new ja,this.os=(t=this.us,new Ph(t,function(t){return n.Nr.Ll(t)})),this.serializer=new Va(e),this.tc=new xh(this.serializer)}function sf(t){this.serializer=t,this.kl=new Map,this.Ml=new Map}function uf(t){this.persistence=t,this.xl=new fa(Li,Di),this.lastRemoteSnapshotVersion=hi.min(),this.highestTargetId=0,this.Nl=0,this.Fl=new Zc,this.targetCount=0,this.Ol=Fa.Io()}function af(t){var e=this;return(e=Sh.call(this)||this).uo=t,e}function cf(t,e){this.us=t,this.Dl=e,this.docs=new Mi(di.K),this.size=0}function hf(t,e){this.us=t,this.Nr=e,this.cs=[],this.gl=1,this.Vl=new Hi(Jc.Cu)}function ff(t,e,n){if(!n)throw new Nr(Ir.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function lf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function pf(t,e,n,r){if(!0===e&&!0===r)throw new Nr(Ir.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function df(t){if(!di.lt(t))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function yf(t){if(di.lt(t))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function vf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function gf(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Nr(Ir.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=vf(t);throw new Nr(Ir.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function mf(t,e){if(e<=0)throw new Nr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var wf,bf=function(t){this._methodName=t},Ef=(f(_f,wf=bf),_f.prototype.v_=function(t){if(2!==t.S_)throw 1===t.S_?t.D_(this._methodName+"() can only appear at the top level of your update data"):t.D_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.sn.push(t.path),null},_f.prototype.isEqual=function(t){return t instanceof _f},_f);function _f(){return null!==wf&&wf.apply(this,arguments)||this}function Tf(t,e,n){return new cp({S_:3,C_:e.settings.C_,methodName:t._methodName,x_:n},e.T,e.serializer,e.ignoreUndefinedProperties)}var Af,If,Nf,Of,Rf,Lf,Df=(f($f,Lf=bf),$f.prototype.v_=function(t){return new Ss(t.path,new gs)},$f.prototype.isEqual=function(t){return t instanceof $f},$f),Sf=(f(Qf,Rf=bf),Qf.prototype.v_=function(t){var e=Tf(this,t,!0),n=this.N_.map(function(t){return gp(t,e)}),n=new ms(n);return new Ss(t.path,n)},Qf.prototype.isEqual=function(t){return this===t},Qf),kf=(f(Xf,Of=bf),Xf.prototype.v_=function(t){var e=Tf(this,t,!0),n=this.N_.map(function(t){return gp(t,e)}),n=new Ts(n);return new Ss(t.path,n)},Xf.prototype.isEqual=function(t){return this===t},Xf),Pf=(f(Yf,Nf=bf),Yf.prototype.v_=function(t){var e=new Os(t.serializer,Wo(t.serializer,this.F_));return new Ss(t.path,e)},Yf.prototype.isEqual=function(t){return this===t},Yf),Cf=(Object.defineProperty(Wf.prototype,"latitude",{get:function(){return this.O_},enumerable:!1,configurable:!0}),Object.defineProperty(Wf.prototype,"longitude",{get:function(){return this.k_},enumerable:!1,configurable:!0}),Wf.prototype.isEqual=function(t){return this.O_===t.O_&&this.k_===t.k_},Wf.prototype.toJSON=function(){return{latitude:this.O_,longitude:this.k_}},Wf.prototype.$=function(t){return jr(this.O_,t.O_)||jr(this.k_,t.k_)},Wf),Vf=new Map,xf=(Kf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Kf),Uf=(Object.defineProperty(Hf.prototype,"app",{get:function(){if(!this.Q_)throw new Nr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"K_",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"W_",{get:function(){return void 0!==this.j_},enumerable:!1,configurable:!0}),Hf.prototype.G_=function(t){if(this.B_)throw new Nr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.L_=new xf(t),void 0!==t.credentials&&(this.U_=function(t){if(!t)return new oi;switch(t.type){case"gapi":var e=t.client;return xr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ai(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Nr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Hf.prototype.z_=function(){return this.L_},Hf.prototype.H_=function(){return this.B_=!0,this.L_},Hf.prototype._delete=function(){return this.j_||(this.j_=this.J_()),this.j_},Hf.prototype.J_=function(){return(t=Vf.get(this))&&(Sr("ComponentProvider","Removing Datastore"),Vf.delete(this),t.terminate()),Promise.resolve();var t},Hf),o=(zf.prototype.Y_=function(t,e){switch(void 0===e&&(e="none"),Oo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Co(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t,e);case 5:return t.stringValue;case 6:return this.tf(Vo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue,e);case 10:return this.rf(t.mapValue,e);default:throw Vr()}},zf.prototype.rf=function(t,n){var r=this,i={};return _o(t.fields||{},function(t,e){i[t]=r.Y_(e,n)}),i},zf.prototype.nf=function(t){return new Cf(Co(t.latitude),Co(t.longitude))},zf.prototype.sf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Y_(t,e)})},zf.prototype.Z_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Ao(e)?t(e):e}(t);return null==n?null:this.Y_(n,e);case"estimate":return this.X_(Io(t));default:return null}},zf.prototype.X_=function(t){t=Po(t);return new ci(t.seconds,t.nanos)},zf.prototype.cf=function(t,e){var n=fi.nt(t);xr(ps(n));t=new $r(n.get(1),n.get(3)),n=new di(n.j(5));return t.isEqual(e)||kr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},zf),Mf=(f(Gf,If=o),Gf.prototype.tf=function(t){return new Xr(new Gr(t))},Gf.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return ud.af(t,this.firestore,null)},Gf),jf=(Object.defineProperty(Bf.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Bf.prototype,"ref",{get:function(){return new El(this.uf,this.ff,this.lf)},enumerable:!1,configurable:!0}),Bf.prototype.exists=function(){return null!==this._f},Bf.prototype.data=function(){if(this._f){if(this.ff){var t=new qf(this.uf,this.hf,this.lf,this._f,null);return this.ff.fromFirestore(t)}return this.hf.Y_(this._f.mn())}},Bf.prototype.get=function(t){if(this._f){t=this._f.data().field(Zf("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t)}},Bf),qf=(f(Ff,Af=jf),Ff.prototype.data=function(){return Af.prototype.data.call(this)},Ff);function Ff(){return null!==Af&&Af.apply(this,arguments)||this}function Bf(t,e,n,r,i){this.uf=t,this.hf=e,this.lf=n,this._f=r,this.ff=i}function Gf(t){var e=this;return(e=If.call(this)||this).firestore=t,e}function zf(){}function Hf(t,e){this.M_="(lite)",this.L_=new xf({}),this.B_=!1,t instanceof $r?(this.q_=t,this.U_=new oi):(this.Q_=t,this.q_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Nr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(t.options.projectId)}(t),this.U_=new si(e))}function Kf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Nr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,pf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Wf(t,e){if(!isFinite(t)||t<-90||90<t)throw new Nr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Nr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O_=t,this.k_=e}function Yf(t,e){var n=this;return(n=Nf.call(this,t)||this).F_=e,n}function Xf(t,e){var n=this;return(n=Of.call(this,t)||this).N_=e,n}function Qf(t,e){var n=this;return(n=Rf.call(this,t)||this).N_=e,n}function $f(){return null!==Lf&&Lf.apply(this,arguments)||this}function Zf(t,e){return"string"==typeof e?Tp(t,e):(e instanceof zr?e._:e).df}var Jf,tl=(rl.prototype.isEqual=function(t){return this.df.isEqual(t.df)},rl),el=(f(nl,Jf=Uf),nl.prototype.J_=function(){return this.Ef||ed(this),this.Ef.terminate()},nl);function nl(t,e){var n=this;return(n=Jf.call(this,t,e)||this).wf=new Sa,n.M_="name"in t?t.name:"[DEFAULT]",n}function rl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.df=new pi(t)}var il,ol,sl=(f(fl,ol=jf),fl.prototype.exists=function(){return ol.prototype.exists.call(this)},fl.prototype.data=function(t){if(void 0===t&&(t={}),this._f){if(this.ff){var e=new ul(this.uf,this.hf,this.lf,this._f,this.metadata,null);return this.ff.fromFirestore(e,t)}return this.hf.Y_(this._f.mn(),t.serverTimestamps)}},fl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._f){t=this._f.data().field(Zf("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t,e.serverTimestamps)}},fl),ul=(f(hl,il=sl),hl.prototype.data=function(t){return void 0===t&&(t={}),il.prototype.data.call(this,t)},hl),al=(Object.defineProperty(cl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"size",{get:function(){return this.mf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),cl.prototype.forEach=function(e,n){var r=this;this.mf.docs.forEach(function(t){e.call(n,new ul(r.uf,r.hf,t.key,t,new bd(r.mf.se.has(t.key),r.mf.fromCache),r.query.ff))})},cl.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.mf.re)throw new Nr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.If&&this.Af===t||(this.If=function(i,e){if(i.mf.ne.Y()){var n=0;return i.mf.docChanges.map(function(t){var e=new ul(i.uf,i.hf,t.doc.key,t.doc,new bd(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.mf.ne;return i.mf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new ul(i.uf,i.hf,t.doc.key,t.doc,new bd(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Af=t),this.If},cl);function cl(t,e,n,r){this.uf=t,this.hf=e,this.mf=r,this.metadata=new bd(r.hasPendingWrites,r.fromCache),this.query=n}function hl(){return null!==il&&il.apply(this,arguments)||this}function fl(t,e,n,r,i,o){var s=this;return(s=ol.call(this,t,e,n,r,o)||this).uf=t,s.Tf=t,s.metadata=i,s}function ll(t,e){return t instanceof sl&&e instanceof sl?t.uf===e.uf&&t.lf.isEqual(e.lf)&&(null===t._f?null===e._f:t._f.isEqual(e._f))&&t.ff===e.ff:t instanceof al&&e instanceof al&&t.uf===e.uf&&ep(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.mf.isEqual(e.mf)}function pl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var dl,yl=(f(vl,dl=o),vl.prototype.tf=function(t){return new Gr(t)},vl.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new El(this.firestore,null,t)},vl);function vl(t){var e=this;return(e=dl.call(this)||this).firestore=t,e}function gl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=gf(t,El);var o=gf(t.firestore,el),s=np(o);return e instanceof zr&&(e=e._),wl(o,("string"==typeof e||e instanceof tl?yp(s,"updateDoc",t.lf,e,n,r):dp(s,"updateDoc",t.lf,e)).Pf(t.lf,Vs.exists(!0)))}function ml(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof zr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||pl(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return pl(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof El?(u=gf(e.firestore,el),a=wu(e.lf.path),h={next:function(t){n[i]&&n[i](bl(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=gf(e,_l),u=gf(s.firestore,el),a=s.Rf,c=new yl(u),h={next:function(t){n[i]&&n[i](new al(u,c,s,t))},error:n[i+1],complete:n[i+2]},Hl(e.Rf)),function(n,t,e){var r=this,i=new Wh(h),o=new $c(t,i,e);return n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Yc,[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.b_(),n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Xc,[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(td(u),a,f)}function wl(t,e){return function(n,r){var t=this,i=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vh,[4,Up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(td(t),e)}function bl(t,e,n){var r=n.docs.get(e.lf),i=new yl(t);return new sl(t,i,e.lf,r,new bd(n.hasPendingWrites,n.fromCache),e.ff)}var El=(Object.defineProperty(Al.prototype,"yf",{get:function(){return this.lf.path},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"path",{get:function(){return this.lf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"parent",{get:function(){return new Wl(this.firestore,this.ff,this.lf.path.G())},enumerable:!1,configurable:!0}),Al.prototype.withConverter=function(t){return new Al(this.firestore,t,this.lf)},Al),_l=(Tl.prototype.withConverter=function(t){return new Tl(this.firestore,t,this.Rf)},Tl),_e=function(){};function Tl(t,e,n){this.ff=e,this.Rf=n,this.type="query",this.firestore=t}function Al(t,e,n){this.ff=e,this.lf=n,this.type="document",this.firestore=t}function Il(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].gf(t)}return t}var Nl,Ol,Rl,Ll,Dl,Sl=(f(ql,Dl=_e),ql.prototype.gf=function(t){var e=np(t.firestore),e=function(t,e,n,r,i,o){if(r.rt()){if("array-contains"===i||"array-contains-any"===i)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Gl(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Bl(n,t,c))}h={arrayValue:{values:s}}}else h=Bl(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Gl(o,i),h=vp(e,"where",o,"in"===i||"not-in"===i);var h=Cu.create(r,i,h);return function(t,e){if(e.Pn()){var n=Tu(t);if(null!==n&&!n.isEqual(e.field))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=_u(t);null!==n&&zl(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.Rf,e,t.firestore.q_,this.Vf,this.pf,this.bf);return new _l(t.firestore,t.ff,(t=t.Rf,e=t.filters.concat([e]),new yu(t.path,t.collectionGroup,t.In.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ql),kl=(f(jl,Ll=_e),jl.prototype.gf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new aa(e,n);return e=r,null!==_u(n=t)||null!==(t=Tu(n))&&zl(0,t,e.field),r}(t.Rf,this.Vf,this.vf);return new _l(t.firestore,t.ff,(t=t.Rf,e=t.In.concat([e]),new yu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},jl),Pl=(f(Ml,Rl=_e),Ml.prototype.gf=function(t){return new _l(t.firestore,t.ff,Ou(t.Rf,this.Sf,this.Df))},Ml),Cl=(f(Ul,Ol=_e),Ul.prototype.gf=function(t){var e=Fl(t,this.type,this.Cf,this.xf);return new _l(t.firestore,t.ff,(t=t.Rf,e=e,new yu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Ul),Vl=(f(xl,Nl=_e),xl.prototype.gf=function(t){var e=Fl(t,this.type,this.Cf,this.xf);return new _l(t.firestore,t.ff,(t=t.Rf,e=e,new yu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},xl);function xl(t,e,n){var r=this;return(r=Nl.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function Ul(t,e,n){var r=this;return(r=Ol.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function Ml(t,e,n){var r=this;return(r=Rl.call(this)||this).type=t,r.Sf=e,r.Df=n,r}function jl(t,e){var n=this;return(n=Ll.call(this)||this).Vf=t,n.vf=e,n.type="orderBy",n}function ql(t,e,n){var r=this;return(r=Dl.call(this)||this).Vf=t,r.pf=e,r.bf=n,r.type="where",r}function Fl(t,c,e,n){if(e[0]instanceof zr&&(e[0]=e[0]._),e[0]instanceof jf)return function(t,e,n,r){if(!n)throw new Nr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Iu(t);o<s.length;o++){var u=s[o];if(u.field.rt())i.push(xo(e,n.key));else{var a=n.field(u.field);if(Ao(a))throw new Nr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.et();throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ta(i,r)}(t.Rf,t.firestore.q_,e[0]._f,n);var r=np(t.firestore);return function(t,e,n,r,i,o){var s=t.In;if(i.length>s.length)throw new Nr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.rt()){if("string"!=typeof c)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Au(t)&&-1!==c.indexOf("/"))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(fi.nt(c));if(!di.lt(h))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new di(h);u.push(xo(e,h))}else{c=vp(n,r,c);u.push(c)}}return new ta(u,o)}(t.Rf,t.firestore.q_,r,c,e,n)}function Bl(t,e,n){if(n instanceof zr&&(n=n._),"string"==typeof n){if(""===n)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Au(e)&&-1!==n.indexOf("/"))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(fi.nt(n));if(!di.lt(e))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return xo(t,new di(e))}if(n instanceof El)return xo(t,n.lf);throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+vf(n)+".")}function Gl(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function zl(t,e,n){if(!n.isEqual(e))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Hl(t){if(Eu(t)&&0===t.In.length)throw new Nr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kl,Wl=(f(Yl,Kl=_l),Object.defineProperty(Yl.prototype,"id",{get:function(){return this.Rf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"path",{get:function(){return this.Rf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"parent",{get:function(){var t=this.yf.G();return t.Y()?null:new El(this.firestore,null,new di(t))},enumerable:!1,configurable:!0}),Yl.prototype.withConverter=function(t){return new Yl(this.firestore,t,this.yf)},Yl);function Yl(t,e,n){var r=this;return(r=Kl.call(this,t,e,wu(n))||this).firestore=t,r.yf=n,r.type="collection",r}function Xl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),ff("collection","path",e),t instanceof Uf)return yf(n=fi.nt.apply(fi,l([e],r))),new Wl(t,null,n);if(!(t instanceof El||t instanceof Wl))throw new Nr(Ir.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return yf(n=fi.nt.apply(fi,l([t.path],r)).child(fi.nt(e))),new Wl(t.firestore,null,n)}function Ql(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zr&&(t=t._),1===arguments.length&&(e=Ur.t()),ff("doc","path",e),t instanceof Uf)return df(n=fi.nt.apply(fi,l([e],r))),new El(t,null,new di(n));if(!(t instanceof El||t instanceof Wl))throw new Nr(Ir.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return df(n=t.yf.child(fi.nt.apply(fi,l([e],r)))),new El(t.firestore,t instanceof Wl?t.ff:null,new di(n))}var $l,Zl=(f(Jl,$l=o),Jl.prototype.tf=function(t){return new Gr(t)},Jl.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new El(this.firestore,null,t)},Jl);function Jl(t){var e=this;return(e=$l.call(this)||this).firestore=t,e}function tp(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),(t instanceof El||t instanceof Wl)&&(e instanceof El||e instanceof Wl)&&t.firestore===e.firestore&&t.path===e.path&&t.ff===e.ff}function ep(t,e){return t instanceof zr&&(t=t._),e instanceof zr&&(e=e._),t instanceof _l&&e instanceof _l&&t.firestore===e.firestore&&Ru(t.Rf,e.Rf)&&t.ff===e.ff}function np(t){var e=t.H_(),n=Wa(t.q_);return new hp(t.q_,!!e.ignoreUndefinedProperties,n)}var rp=/^__.*__$/,ip=(up.prototype.Pf=function(t,e){var n=[];return null!==this.sn?n.push(new Hs(t,this.data,this.sn,e)):n.push(new zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Qs(t,this.fieldTransforms)),n},up),op=(sp.prototype.Pf=function(t,e){e=[new Hs(t,this.data,this.sn,e)];return 0<this.fieldTransforms.length&&e.push(new Qs(t,this.fieldTransforms)),e},sp);function sp(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function up(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function ap(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var cp=(Object.defineProperty(lp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(lp.prototype,"S_",{get:function(){return this.settings.S_},enumerable:!1,configurable:!0}),lp.prototype.Ff=function(t){return new lp(Object.assign(Object.assign({},this.settings),t),this.T,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.sn)},lp.prototype.Of=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Ff({path:e,x_:!1});return e.kf(t),e},lp.prototype.Mf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Ff({path:t,x_:!1});return t.Nf(),t},lp.prototype.$f=function(t){return this.Ff({path:void 0,x_:!0})},lp.prototype.D_=function(t){return Ap(t,this.settings.methodName,this.settings.Lf||!1,this.path,this.settings.C_)},lp.prototype.contains=function(e){return void 0!==this.sn.find(function(t){return e.X(t)})||void 0!==this.fieldTransforms.find(function(t){return e.X(t.field)})},lp.prototype.Nf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kf(this.path.get(t))},lp.prototype.kf=function(t){if(0===t.length)throw this.D_("Document fields must not be empty");if(ap(this.S_)&&rp.test(t))throw this.D_('Document fields cannot begin and end with "__"')},lp),hp=(fp.prototype.Bf=function(t,e,n,r){return void 0===r&&(r=!1),new cp({S_:t,methodName:e,C_:n,path:pi.st(),x_:!1,Lf:r},this.T,this.serializer,this.ignoreUndefinedProperties)},fp);function fp(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.serializer=n||Wa(t)}function lp(t,e,n,r,i,o){this.settings=t,this.T=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nf(),this.fieldTransforms=i||[],this.sn=o||[]}function pp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bf(o.merge||o.mergeFields?2:0,e,n,i);bp("Data must be an object, but it was:",s,r);var u,a,r=mp(r,s);if(o.merge)u=new ks(s.sn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Ep(e,f[h],n);if(!s.contains(l))throw new Nr(Ir.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Ip(c,l)||c.push(l)}u=new ks(c),a=s.fieldTransforms.filter(function(t){return u.hn(t.field)})}else u=null,a=s.fieldTransforms;return new ip(new ru(r),u,a)}function dp(t,r,i,e){var o=t.Bf(1,r,i);bp("Data must be an object, but it was:",o,e);var s=[],u=new iu;_o(e,function(t,e){var n=Tp(r,t,i);e instanceof zr&&(e=e._);t=o.Mf(n);e instanceof Ef?s.push(n):null!=(t=gp(e,t))&&(s.push(n),u.set(n,t))});e=new ks(s);return new op(u._n(),e,o.fieldTransforms)}function yp(t,e,n,r,i,o){var s=t.Bf(1,e,n),u=[Ep(e,r,n)],a=[i];if(o.length%2!=0)throw new Nr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Ep(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new iu,y=u.length-1;0<=y;--y){Ip(p,u[y])||(h=u[y],(f=a[y])instanceof zr&&(f=f._),l=s.Mf(h),f instanceof Ef?p.push(h):null!=(l=gp(f,l))&&(p.push(h),d.set(h,l)))}i=new ks(p);return new op(d._n(),i,s.fieldTransforms)}function vp(t,e,n,r){return void 0===r&&(r=!1),gp(n,t.Bf(r?4:3,e))}function gp(s,t){if(s instanceof zr&&(s=s._),wp(s))return bp("Unsupported field value:",t,s),mp(s,t);if(s instanceof bf)return function(t,e){if(!ap(e.S_))throw e.D_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.D_(t._methodName+"() is not currently supported inside arrays");t=t.v_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.sn.push(t.path),s instanceof Array){if(t.settings.x_&&4!==t.S_)throw t.D_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=gp(i[r],t.$f(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof zr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Wo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ci.fromDate(t);return{timestampValue:Yo(e.serializer,n)}}if(t instanceof ci)return n=new ci(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Yo(e.serializer,n)};if(t instanceof Cf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gr)return{bytesValue:Xo(e.serializer,t.l)};if(t instanceof El){n=e.T;var r=t.firestore.q_;if(!r.isEqual(n))throw e.D_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:$o(t.firestore.q_||e.T,t.lf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.D_("Unsupported field value: "+vf(t))}(s,t)}function mp(t,n){var r={};return To(t)?n.path&&0<n.path.length&&n.sn.push(n.path):_o(t,function(t,e){e=gp(e,n.Of(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function wp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ci||t instanceof Cf||t instanceof Gr||t instanceof El||t instanceof bf)}function bp(t,e,n){if(!wp(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=vf(n);throw"an object"===n?e.D_(t+" a custom object"):e.D_(t+" "+n)}var r}function Ep(t,e,n){if(e instanceof zr&&(e=e._),e instanceof tl)return e.df;if("string"==typeof e)return Tp(t,e);throw Ap("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var _p=new RegExp("[~\\*/\\[\\]]");function Tp(e,n,r){if(0<=n.search(_p))throw Ap("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(tl.bind.apply(tl,l([void 0],n.split("."))))).df}catch(t){throw Ap("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Ap(t,e,n,r,i){var o=r&&!r.Y(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Nr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Ip(t,e){return t.some(function(t){return t.isEqual(e)})}var Np=(Sp.prototype.Wf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),0<this.mutations.length)throw new Nr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=ns((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Jo(n.serializer,t)})},[4,n.Wa("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){xr(!!e.found),e.found.name,e.found.updateTime;var n=ts(t,e.found.name),t=Qo(e.found.updateTime),e=new ru({mapValue:{fields:e.found.fields}});return new lu(n,t,e,{})}(e,t):"missing"in t?function(t,e){xr(!!e.missing),xr(!!e.readTime);t=ts(t,e.missing),e=Qo(e.readTime);return new pu(t,e)}(e,t):Vr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());xr(!!t),o.push(t)}),o)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof pu||t instanceof lu?n.Gf(t):Vr()}),e)]}})})},Sp.prototype.set=function(t,e){this.write(e.Pf(t,this.cn(t))),this.Kf.add(t.toString())},Sp.prototype.update=function(t,e){try{this.write(e.Pf(t,this.zf(t)))}catch(t){this.Qf=t}this.Kf.add(t.toString())},Sp.prototype.delete=function(t){this.write([new eu(t,this.cn(t))]),this.Kf.add(t.toString())},Sp.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),this.Qf)throw this.Qf;return e=this.qf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=di.at(e);n.mutations.push(new nu(e,n.cn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ns((e=i).serializer)+"/documents",r={writes:o.map(function(t){return os(e.serializer,t)})},[4,e.Ka("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.Uf=!0,[2]}})})},Sp.prototype.Gf=function(t){var e;if(t instanceof lu)e=t.version;else{if(!(t instanceof pu))throw Vr();e=hi.min()}var n=this.qf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Nr(Ir.ABORTED,"Document version changed between two reads.")}else this.qf.set(t.key.toString(),e)},Sp.prototype.cn=function(t){var e=this.qf.get(t.toString());return!this.Kf.has(t.toString())&&e?Vs.updateTime(e):Vs.an()},Sp.prototype.zf=function(t){var e=this.qf.get(t.toString());if(this.Kf.has(t.toString())||!e)return Vs.exists(!0);if(e.isEqual(hi.min()))throw new Nr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vs.updateTime(e)},Sp.prototype.write=function(t){this.jf(),this.mutations=this.mutations.concat(t)},Sp.prototype.jf=function(){},Sp),Op=(Dp.prototype.run=function(){this.Jf()},Dp.prototype.Jf=function(){var t=this;this.Ci.Us(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Np(this.eu),(n=this.Yf(e))&&n.then(function(t){r.Ei.yi(function(){return e.commit().then(function(){r.Ii.resolve(t)}).catch(function(t){r.Xf(t)})})}).catch(function(t){r.Xf(t)}),[2]})})})},Dp.prototype.Yf=function(t){try{var e=this.updateFunction(t);return!Ii(e)&&e.catch&&e.then?e:(this.Ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ii.reject(t),null}},Dp.prototype.Xf=function(t){var e=this;0<this.Hf&&this.Zf(t)?(--this.Hf,this.Ei.yi(function(){return e.Jf(),Promise.resolve()})):this.Ii.reject(t)},Dp.prototype.Zf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!xi(t)},Dp),Rp=(Lp.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{Ei:this.Ei,n_:this.n_,clientId:this.clientId,credentials:this.credentials,I_:this.user,ol:100})]}})})},Lp.prototype.ed=function(t){var e=this;this.td=t,this.N.promise.then(function(){return e.td(e.user)})},Lp.prototype.nd=function(){if(this.Ei.Ni)throw new Nr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Lp.prototype.terminate=function(){var t=this;this.Ei.Mi();var n=new Ia;return this.Ei.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sd?[4,this.sd.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rd?[4,this.rd.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ca(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Lp);function Lp(t,e,n){var r=this;this.credentials=t,this.Ei=e,this.n_=n,this.user=Zr.UNAUTHENTICATED,this.clientId=Ur.t(),this.td=function(){},this.N=new Ia,this.credentials.S(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.td(t)),r.N.resolve()})}function Dp(t,e,n,r){this.Ei=t,this.eu=e,this.updateFunction=n,this.Ii=r,this.Hf=5,this.Ci=new Na(this.Ei,"transaction_retry")}function Sp(t){this.eu=t,this.qf=new Map,this.mutations=[],this.Uf=!1,this.Qf=null,this.Kf=new Set}function kp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rd?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ed(function(e){return r.Ei.$i(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sc(i.Zc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.cc(function(){return r.terminate()}),r.rd=i,[2]}})})}(e,new Hh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rd]}})})}function Pp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sd?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),[4,kp(r)];case 1:return e=t.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ed(function(t){return r.Ei.$i(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ei.qi(),Sr("RemoteStore","RemoteStore received new credentials"),n=xc(e),e.ru.add(3),[4,Lc(e)];case 1:return t.sent(),n&&e.uu.set("Unknown"),[4,e.nu.V_(i)];case 2:return t.sent(),e.ru.delete(3),[4,Rc(e)];case 3:return t.sent(),[2]}})})}(i.sl,t)})}),r.sd=i,[2]}})})}(e,new Kh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sd]}})})}function Cp(t){return kp(t).then(function(t){return t.persistence})}function Vp(t){return kp(t).then(function(t){return t.Zc})}function xp(t){return Pp(t).then(function(t){return t.sl})}function Up(t){return Pp(t).then(function(t){return t.ju})}function Mp(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Pp(r)];case 1:return e=t.sent(),[2,((n=e.il).Iu=yh.bind(null,e.ju),n.Pu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).al.get(o),1<(r=e.ul.get(n.targetId)).length?[2,(e.ul.set(n.targetId,r.filter(function(t){return!Ru(t,o)})),void e.al.delete(o))]:e.ml?(e.rl.Th(n.targetId),e.rl.hh(n.targetId)?[3,2]:[4,lc(e.Zc,n.targetId,!1).then(function(){e.rl.Ih(n.targetId),Sc(e.sl,n.targetId),_h(e,n.targetId)}).catch(dc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return _h(e,n.targetId),[4,lc(e.Zc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ju),n)]}})})}function jp(n,r,i){var t=this;void 0===i&&(i={});var o=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Wh({next:function(t){r.yi(function(){return Xc(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Nr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Nr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new $c(wu(i.path),t,{includeMetadataChanges:!0,Su:!0});return Yc(n,u)},[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}function qp(n,r,i){var t=this;void 0===i&&(i={});var o=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Wh({next:function(t){n.yi(function(){return Xc(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Nr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new $c(t,o,{includeMetadataChanges:!0,Su:!0});return Yc(e,s)},[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}var Fp=(Bp.prototype.set=function(t,e,n){this.ld();t=Gp(t,this.uf),e=Vd(t.ff,e,n),n=pp(this.hd,"WriteBatch.set",t.lf,e,null!==t.ff,n);return this.ad=this.ad.concat(n.Pf(t.lf,Vs.an())),this},Bp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.ld();t=Gp(t,this.uf);return e instanceof zr&&(e=e._),e="string"==typeof e||e instanceof tl?yp(this.hd,"WriteBatch.update",t.lf,e,n,r):dp(this.hd,"WriteBatch.update",t.lf,e),this.ad=this.ad.concat(e.Pf(t.lf,Vs.exists(!0))),this},Bp.prototype.delete=function(t){this.ld();t=Gp(t,this.uf);return this.ad=this.ad.concat(new eu(t.lf,Vs.an())),this},Bp.prototype.commit=function(){return this.ld(),this.ud=!0,0<this.ad.length?this.od(this.ad):Promise.resolve()},Bp.prototype.ld=function(){if(this.ud)throw new Nr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Bp);function Bp(t,e){this.uf=t,this.od=e,this.ad=[],this.ud=!1,this.hd=np(t)}function Gp(t,e){if(t instanceof zr&&(t=t._),t.firestore!==e)throw new Nr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var zp,Hp,Kp=(Jp.prototype.get=function(t){var e=this,n=Gp(t,this.uf),r=new Zl(this.uf);return this._d.Wf([n.lf]).then(function(t){if(!t||1!==t.length)return Vr();t=t[0];if(t instanceof pu)return new jf(e.uf,r,n.lf,null,n.ff);if(t instanceof lu)return new jf(e.uf,r,t.key,t,n.ff);throw Vr()})},Jp.prototype.set=function(t,e,n){t=Gp(t,this.uf),e=Vd(t.ff,e,n),n=pp(this.hd,"Transaction.set",t.lf,e,null!==t.ff,n);return this._d.set(t.lf,n),this},Jp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Gp(t,this.uf);return e instanceof zr&&(e=e._),e="string"==typeof e||e instanceof tl?yp(this.hd,"Transaction.update",t.lf,e,n,r):dp(this.hd,"Transaction.update",t.lf,e),this._d.update(t.lf,e),this},Jp.prototype.delete=function(t){t=Gp(t,this.uf);return this._d.delete(t.lf),this},f(Zp,Hp=Jp),Zp.prototype.get=function(t){var e=this,n=Gp(t,this.uf),r=new yl(this.uf);return Hp.prototype.get.call(this,t).then(function(t){return new sl(e.uf,r,n.lf,t._f,new bd(!1,!1),n.ff)})},Zp),Wp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Yp=($p.prototype.enableIndexedDbPersistence=function(t,e){throw new Nr(Ir.FAILED_PRECONDITION,Wp)},$p.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Nr(Ir.FAILED_PRECONDITION,Wp)},$p.prototype.clearIndexedDbPersistence=function(t){throw new Nr(Ir.FAILED_PRECONDITION,Wp)},$p),Xp=(f(Qp,zp=zr),Object.defineProperty(Qp.prototype,"q_",{get:function(){return this._.q_},enumerable:!1,configurable:!0}),Qp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.z_()),t)).merge,this._.G_(t)},Qp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.z_().host&&Pr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Qp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Cp(r)];case 1:return e=t.sent(),[4,xp(r)];case 2:return n=t.sent(),[2,(e.ac(!0),(t=n).ru.delete(0),Rc(t))]}})})})}(td(gf(this._,el)))},Qp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Cp(r)];case 1:return e=t.sent(),[4,xp(r)];case 2:return n=t.sent(),[2,(e.ac(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(0),[4,Lc(e)];case 1:return t.sent(),e.uu.set("Offline"),[2]}})})}(n))]}})})})}(td(gf(this._,el)))},Qp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&pf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.fd.enableMultiTabIndexedDbPersistence(this):this.fd.enableIndexedDbPersistence(this,n)},Qp.prototype.clearPersistence=function(){return this.fd.clearIndexedDbPersistence(this)},Qp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Qp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=wh,[4,Up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(td(gf(this._,el)))},Qp.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new Wh(t);return n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.add(e),e.next()},[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.b_(),n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.delete(e)},[4,Mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(td(gf(e,el)),pl(t)?t:{next:t});var e},Object.defineProperty(Qp.prototype,"app",{get:function(){if(!this.dd)throw new Nr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!1,configurable:!0}),Qp.prototype.collection=function(t){try{return new Nd(this,Xl(this._,t))}catch(t){throw fd(t,"collection()","Firestore.collection()")}},Qp.prototype.doc=function(t){try{return new ud(this,Ql(this._,t))}catch(t){throw fd(t,"doc()","Firestore.doc()")}},Qp.prototype.collectionGroup=function(t){try{return new Td(this,function(t,e){if(t=gf(t,Uf),ff("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Nr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new _l(t,null,(e=e,new yu(fi.st(),e)))}(this._,t))}catch(t){throw fd(t,"collectionGroup()","Firestore.collectionGroup()")}},Qp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Pp(n).then(function(t){return t.eu})];case 1:return e=t.sent(),new Op(n.Ei,e,r,i).run(),[2]}})})}),i.promise}(td(n=this._),function(t){return t=new Kp(n,t),e(new od(r,t))})},Qp.prototype.batch=function(){var e=this;return td(this._),new sd(new Fp(this._,function(t){return wl(e._,t)}))},Qp.prototype.loadBundle=function(t){throw new Nr(Ir.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp.prototype.namedQuery=function(t){throw new Nr(Ir.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp);function Qp(t,e,n){var r=this;return(r=zp.call(this,e)||this).fd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof $r||(r.dd=t),r}function $p(){}function Zp(t,e){var n=this;return(n=Hp.call(this,t,e)||this).uf=t,n}function Jp(t,e){this.uf=t,this._d=e,this.hd=np(t)}function td(t){return t.Ef||ed(t),t.Ef.nd(),t.Ef}function ed(t){var e,n,r=t.H_(),r=(e=t.q_,n=t.M_,new Qr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ef=new Rp(t.U_,t.wf,r)}var nd,rd,id,od=(f(hd,id=zr),hd.prototype.get=function(t){var e=this,t=Cd(t);return this._.get(t).then(function(t){return new Ed(e.uf,t)})},hd.prototype.set=function(t,e,n){t=Cd(t);return n?(lf("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},hd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Cd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},hd.prototype.delete=function(t){t=Cd(t);return this._.delete(t),this},hd),sd=(f(cd,rd=zr),cd.prototype.set=function(t,e,n){t=Cd(t);return n?(lf("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},cd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Cd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},cd.prototype.delete=function(t){t=Cd(t);return this._.delete(t),this},cd.prototype.commit=function(){return this._.commit()},cd),ud=(f(ad,nd=zr),ad.wd=function(t,e,n){if(t.length%2!=0)throw new Nr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.et()+" has "+t.length);return new ad(e,new El(e._,n,new di(t)))},ad.af=function(t,e,n){return new ad(e,new El(e._,n,t))},Object.defineProperty(ad.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"parent",{get:function(){return new Nd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),ad.prototype.collection=function(t){try{return new Nd(this.firestore,Xl(this._,t))}catch(t){throw fd(t,"collection()","DocumentReference.collection()")}},ad.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof El&&tp(this._,t)},ad.prototype.set=function(t,e){e=lf("DocumentReference.set",e);try{return function(t,e,n){t=gf(t,El);var r=gf(t.firestore,el),e=Vd(t.ff,e,n);return wl(r,pp(np(r),"setDoc",t.lf,e,null!==t.ff,n).Pf(t.lf,Vs.an()))}(this._,t,e)}catch(t){throw fd(t,"setDoc()","DocumentReference.set()")}},ad.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?gl(this._,t):gl.apply(void 0,l([this._,t,e],n))}catch(t){throw fd(t,"updateDoc()","DocumentReference.update()")}},ad.prototype.delete=function(){return wl(gf((t=this._).firestore,el),[new eu(t.lf,Vs.an())]);var t},ad.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ld(t),i=pd(t,function(t){return new Ed(e.firestore,new sl(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))});return ml(this._,r,i)},ad.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=gf(e,El);var n=gf(e.firestore,el),t=td(n),r=new yl(n);return function(n,r){var t=this,i=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.sa.hs(t,e)}))];case 1:return(r=t.sent())instanceof lu?s.resolve(r):r instanceof pu?s.resolve(null):s.reject(new Nr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ca(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,Vp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.lf).then(function(t){return new sl(n,r,e.lf,t,new bd(t instanceof lu&&t.ln,!0),e.ff)})}:"server"===(null==t?void 0:t.source)?function(e){e=gf(e,El);var n=gf(e.firestore,el);return jp(td(n),e.lf,{source:"server"}).then(function(t){return bl(n,e,t)})}:function(e){e=gf(e,El);var n=gf(e.firestore,el);return jp(td(n),e.lf).then(function(t){return bl(n,e,t)})})(this._).then(function(t){return new Ed(e.firestore,new sl(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))})},ad.prototype.withConverter=function(t){return new ad(this.firestore,this._.withConverter(t))},ad);function ad(t,e){var n=this;return(n=nd.call(this,e)||this).firestore=t,n.hf=new Mf(t),n}function cd(){return null!==rd&&rd.apply(this,arguments)||this}function hd(t,e){var n=this;return(n=id.call(this,e)||this).uf=t,n}function fd(t,e,n){return t.message=t.message.replace(e,n),t}function ld(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!pl(r))return r}return{}}function pd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=pl(t[0])?t[0]:pl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var dd,yd,vd,gd,md,wd,bd=(Pd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Pd),Ed=(f(kd,wd=zr),Object.defineProperty(kd.prototype,"ref",{get:function(){return new ud(this.uf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),kd.prototype.data=function(t){return this._.data(t)},kd.prototype.get=function(t,e){return this._.get(t,e)},kd.prototype.isEqual=function(t){return ll(this._,t._)},kd),_d=(f(Sd,md=Ed),Sd.prototype.data=function(t){return this._.data(t)},Sd),Td=(f(Dd,gd=zr),Dd.prototype.where=function(t,e,n){try{return new Dd(this.firestore,Il(this._,(r=n,i=e,o=Zf("where",t),new Sl(o,i,r))))}catch(t){throw fd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Dd.prototype.orderBy=function(n,t){try{return new Dd(this.firestore,Il(this._,function(t){void 0===t&&(t="asc");var e=t,t=Zf("orderBy",n);return new kl(t,e)}(t)))}catch(n){throw fd(n,/(orderBy|where)\(\)/,"Query.$1()")}},Dd.prototype.limit=function(t){try{return new Dd(this.firestore,Il(this._,(mf("limit",e=t),new Pl("limit",e,"F"))))}catch(t){throw fd(t,"limit()","Query.limit()")}var e},Dd.prototype.limitToLast=function(t){try{return new Dd(this.firestore,Il(this._,(mf("limitToLast",e=t),new Pl("limitToLast",e,"L"))))}catch(t){throw fd(t,"limitToLast()","Query.limitToLast()")}var e},Dd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Dd(this.firestore,Il(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cl("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw fd(t,"startAt()","Query.startAt()")}},Dd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Dd(this.firestore,Il(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cl("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw fd(t,"startAfter()","Query.startAfter()")}},Dd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Dd(this.firestore,Il(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw fd(t,"endBefore()","Query.endBefore()")}},Dd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Dd(this.firestore,Il(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw fd(t,"endAt()","Query.endAt()")}},Dd.prototype.isEqual=function(t){return ep(this._,t._)},Dd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=gf(e,_l);var n=gf(e.firestore,el),t=td(n),r=new yl(n);return function(n,r){var t=this,i=new Ia;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,pc(r,i,!0)];case 1:return n=t.sent(),e=new ih(i,n.la),n=e.Gh(n.documents),n=e.es(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ca(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Vp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Rf).then(function(t){return new al(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=gf(e,_l);var n=gf(e.firestore,el),t=td(n),r=new yl(n);return qp(t,e.Rf,{source:"server"}).then(function(t){return new al(n,r,e,t)})}:function(e){e=gf(e,_l);var n=gf(e.firestore,el),t=td(n),r=new yl(n);return Hl(e.Rf),qp(t,e.Rf).then(function(t){return new al(n,r,e,t)})})(this._).then(function(t){return new Id(e.firestore,new al(e.firestore._,e.hf,e._,t.mf))})},Dd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ld(t),i=pd(t,function(t){return new Id(e.firestore,new al(e.firestore._,e.hf,e._,t.mf))});return ml(this._,r,i)},Dd.prototype.withConverter=function(t){return new Dd(this.firestore,this._.withConverter(t))},Dd),Ad=(f(Ld,vd=zr),Object.defineProperty(Ld.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"doc",{get:function(){return new _d(this.uf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Ld),Id=(f(Rd,yd=zr),Object.defineProperty(Rd.prototype,"query",{get:function(){return new Td(this.uf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new _d(e.uf,t)})},enumerable:!1,configurable:!0}),Rd.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Ad(e.uf,t)})},Rd.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new _d(r.uf,t))})},Rd.prototype.isEqual=function(t){return ll(this._,t._)},Rd),Nd=(f(Od,dd=Td),Object.defineProperty(Od.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"parent",{get:function(){var t=this._.parent;return t?new ud(this.firestore,t):null},enumerable:!1,configurable:!0}),Od.prototype.doc=function(t){try{return new ud(this.firestore,void 0===t?Ql(this._):Ql(this._,t))}catch(t){throw fd(t,"doc()","CollectionReference.doc()")}},Od.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=gf(e.firestore,el),r=Ql(e),n=Vd(e.ff,n),wl(t,pp(np(e.firestore),"addDoc",r.lf,n,null!==e.ff,{}).Pf(r.lf,Vs.exists(!1))).then(function(){return r}).then(function(t){return new ud(i.firestore,t)})},Od.prototype.isEqual=function(t){return tp(this._,t._)},Od.prototype.withConverter=function(t){return new Od(this.firestore,this._.withConverter(t))},Od);function Od(t,e){var n=this;return(n=dd.call(this,t,e)||this).firestore=t,n._=e,n}function Rd(t,e){var n=this;return(n=yd.call(this,e)||this).uf=t,n}function Ld(t,e){var n=this;return(n=vd.call(this,e)||this).uf=t,n}function Dd(t,e){var n=this;return(n=gd.call(this,e)||this).firestore=t,n.hf=new Mf(t),n}function Sd(){return null!==md&&md.apply(this,arguments)||this}function kd(t,e){var n=this;return(n=wd.call(this,e)||this).uf=t,n}function Pd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Cd(t){return t instanceof zr&&(t=t._),gf(t,El)}function Vd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var xd,Ud,_e=(f(Fd,Ud=zr),Fd.documentId=function(){return new Fd(pi.ot().et())},Fd.prototype.isEqual=function(t){return t instanceof zr&&(t=t._),t instanceof tl&&this._.df.isEqual(t.df)},Fd),o=(f(qd,xd=zr),qd.serverTimestamp=function(){var t=new Df("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new qd(t)},qd.delete=function(){var t=new Ef("deleteField");return t._methodName="FieldValue.delete",new qd(t)},qd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new qd(n)},qd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new qd(n)},qd.increment=function(t){t=new Pf("increment",t);return t._methodName="FieldValue.increment",new qd(t)},qd.prototype.isEqual=function(t){return this._.isEqual(t._)},qd),Md=(jd.prototype.onProgress=function(t,e,n){this.Ed={next:t,error:e,complete:n}},jd.prototype.catch=function(t){return this.Td.promise.catch(t)},jd.prototype.then=function(t,e){return this.Td.promise.then(t,e)},jd.prototype.Rl=function(t){this.Pl(t),this.Ed.complete&&this.Ed.complete(),this.Td.resolve(t)},jd.prototype.yl=function(t){this.md.taskState="Error",this.Ed.next&&this.Ed.next(this.md),this.Ed.error&&this.Ed.error(t),this.Td.reject(t)},jd.prototype.Pl=function(t){this.md=t,this.Ed.next&&this.Ed.next(t)},jd);function jd(){this.Ed={},this.Td=new Ia,this.md={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function qd(){return null!==xd&&xd.apply(this,arguments)||this}function Fd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ud.call(this,new(tl.bind.apply(tl,l([void 0],t))))||this}var Bd=(Gd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Gd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Gd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Gd);function Gd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var zd,Hd,Kd={Firestore:Xp,GeoPoint:Cf,Timestamp:ci,Blob:Xr,Transaction:od,WriteBatch:sd,DocumentReference:ud,DocumentSnapshot:Ed,Query:Td,QueryDocumentSnapshot:_d,QuerySnapshot:Id,CollectionReference:Nd,FieldPath:_e,FieldValue:o,setLogLevel:function(t){Rr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(zd=e.default).INTERNAL.registerComponent(new Bd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Xp(e,new el(e,t),new Yp)},"PUBLIC").setServiceProps(Object.assign({},Kd))),zd.registerVersion("@firebase/firestore","2.0.4-BundlePrerelease.f8bb4d8b7"),(Hd=Xp).prototype.loadBundle=function(t){return e=this,o=t,t=new Md,function(n,t,r){var e=this,i=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Xa(Ka(t),e)}(o,Wa(t));n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rh,[4,Up(n)];case 1:return e.apply(void 0,[t.sent(),i,r]),[2]}})})})}(td(e._),e.q_,t),t;var e,o},Hd.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.tc.wo(t,e)})},[4,Vp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(td((e=this)._),t).then(function(t){return t?new Td(e,new _l(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
